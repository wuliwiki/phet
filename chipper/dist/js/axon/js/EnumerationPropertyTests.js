// Copyright 2022-2023, University of Colorado Boulder

/**
 * QUnit Tests for EnumerationProperty
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Enumeration from '../../phet-core/js/Enumeration.js';
import EnumerationValue from '../../phet-core/js/EnumerationValue.js';
import EnumerationIO from '../../tandem/js/types/EnumerationIO.js';
import EnumerationProperty from './EnumerationProperty.js';
QUnit.module('EnumerationProperty');
QUnit.test('EnumerationProperty', assert => {
  class Bird extends EnumerationValue {
    static ROBIN = new Bird();
    static JAY = new Bird();
    static WREN = new Bird();
    static enumeration = new Enumeration(Bird);
  }
  let birdProperty;

  // constructor value
  assert.ok(() => {
    birdProperty = new EnumerationProperty(Bird.ROBIN);
  }, 'good constructor value');
  window.assert && assert.throws(() => {
    // @ts-expect-error INTENTIONAL testing behavior of passing in the wrong value
    birdProperty = new EnumerationProperty(true);
  }, 'invalid constructor value');

  // set value
  assert.ok(() => {
    birdProperty.set(Bird.JAY);
  }, 'good set value');
  window.assert && assert.throws(() => {
    // @ts-expect-error INTENTIONAL testing behavior of passing in the wrong value
    birdProperty.set(5);
  }, 'bad set value');
  window.assert && assert.throws(() => {
    // @ts-expect-error INTENTIONAL testing set of phetioType
    birdProperty = new EnumerationProperty(Bird.ROBIN, {
      phetioType: EnumerationIO
    });
  }, 'EnumerationProperty sets phetioType');
  window.assert && assert.throws(() => {
    // @ts-expect-error INTENTIONAL testing behavior of passing in the wrong value
    birdProperty = new EnumerationProperty(Bird, {
      phetioType: EnumerationIO
    });
  }, 'Not the Enumeration, but a value as first arg');
  window.assert && assert.throws(() => {
    // @ts-expect-error INTENTIONAL testing behavior of passing in the wrong value
    birdProperty = new EnumerationProperty({});
  }, 'That is not an enumeration');
});
QUnit.test('EnumerationIO validation', assert => {
  class Bird1 extends EnumerationValue {
    static ROBIN = new Bird1();
    static JAY = new Bird1();
    static WREN = new Bird1();
    static GOAT = new Bird1();
    static enumeration = new Enumeration(Bird1);
  }
  class Bird2 extends EnumerationValue {
    static ROBIN = new Bird2();
    static JAY = new Bird2();
    static WREN = new Bird2();
    static OTHER_WREN = new Bird2();
    static enumeration = new Enumeration(Bird2, {
      phetioDocumentation: 'the second one'
    });
  }

  // @ts-expect-error INTENTIONAL checking these are indeed different enumerations
  assert.ok(Bird1 !== Bird2, 'different Enumerations');
  assert.ok(Bird1.ROBIN !== Bird2.ROBIN, 'different Enumerations');
  let birdProperty = new EnumerationProperty(Bird1.ROBIN);
  const bird2Property = new EnumerationProperty(Bird2.ROBIN);

  // constructor value
  window.assert && assert.throws(() => {
    birdProperty.set(Bird2.ROBIN);
  }, 'cannot use same string value from other EnumerationDeprecated instance');

  // new instance of birdProperty since it got messed up in the above assert.
  birdProperty = new EnumerationProperty(Bird1.ROBIN);
  birdProperty.set(Bird1.WREN);

  // This should not fail! If it does then EnumerationIO and PropertyIO caching isn't working, see https://github.com/phetsims/phet-core/issues/79
  bird2Property.set(Bird2.WREN);
});
QUnit.test('validValues as a subset of Enumeration values', assert => {
  class Bird1 extends EnumerationValue {
    static ROBIN = new Bird1();
    static JAY = new Bird1();
    static WREN = new Bird1();
    static WREN_2 = new Bird1();
    static enumeration = new Enumeration(Bird1);
  }
  class Bird2 extends EnumerationValue {
    static ROBIN = new Bird2();
    static JAY = new Bird2();
    static WREN = new Bird2();
    static WREN_3 = new Bird2();
    static enumeration = new Enumeration(Bird2, {
      phetioDocumentation: 'the second one'
    });
  }

  // @ts-expect-error INTENTIONAL testing these are indeed different enumerations
  assert.ok(Bird1 !== Bird2, 'different Enumerations');
  assert.ok(Bird1.ROBIN !== Bird2.ROBIN, 'different Enumerations');
  const enumeration1Property = new EnumerationProperty(Bird1.ROBIN, {
    validValues: [Bird1.ROBIN, Bird1.JAY]
  });
  enumeration1Property.value = Bird1.JAY;
  assert.ok(enumeration1Property.value === Bird1.JAY, 'basic test for when assertions are not enabled');
  assert.ok(enumeration1Property.getInitialValue() === Bird1.ROBIN, 'basic test for when assertions are not enabled for initialValue');
  window.assert && assert.throws(() => {
    enumeration1Property.value = Bird1.WREN;
  }, 'not a valid value');
  window.assert && assert.throws(() => {
    enumeration1Property.value = Bird2.ROBIN;
  }, 'not a valid value, from a different Enumeration');
});
QUnit.test('Subtyping EnumerationValues', assert => {
  class Raptor extends EnumerationValue {
    static HAWK = new Raptor();
    static EAGLE = new Raptor();
    static enumeration = new Enumeration(Raptor, {
      phetioDocumentation: 'the second one'
    });
  }
  class Bird extends Raptor {
    static ROBIN = new Bird();
    static JAY = new Bird();
    static WREN = new Bird();
    static enumeration = new Enumeration(Bird, {
      instanceType: Raptor
    });
  }
  let enumerationProperty = new EnumerationProperty(Raptor.HAWK);
  assert.ok(true, 'when assertions are not enabled');

  // This is unfortunate, but the enumeration is by default gathered by the initial value of EnumerationProperty
  window.assert && assert.throws(() => {
    enumerationProperty.value = Bird.ROBIN;
  });
  enumerationProperty = new EnumerationProperty(Raptor.HAWK, {
    enumeration: Bird.enumeration
  });
  enumerationProperty.value = Bird.ROBIN;
  enumerationProperty.value = Bird.HAWK;
  enumerationProperty.value = Raptor.EAGLE;
  enumerationProperty.value = Bird.WREN;
  enumerationProperty.value = Bird.EAGLE;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFbnVtZXJhdGlvbiIsIkVudW1lcmF0aW9uVmFsdWUiLCJFbnVtZXJhdGlvbklPIiwiRW51bWVyYXRpb25Qcm9wZXJ0eSIsIlFVbml0IiwibW9kdWxlIiwidGVzdCIsImFzc2VydCIsIkJpcmQiLCJST0JJTiIsIkpBWSIsIldSRU4iLCJlbnVtZXJhdGlvbiIsImJpcmRQcm9wZXJ0eSIsIm9rIiwid2luZG93IiwidGhyb3dzIiwic2V0IiwicGhldGlvVHlwZSIsIkJpcmQxIiwiR09BVCIsIkJpcmQyIiwiT1RIRVJfV1JFTiIsInBoZXRpb0RvY3VtZW50YXRpb24iLCJiaXJkMlByb3BlcnR5IiwiV1JFTl8yIiwiV1JFTl8zIiwiZW51bWVyYXRpb24xUHJvcGVydHkiLCJ2YWxpZFZhbHVlcyIsInZhbHVlIiwiZ2V0SW5pdGlhbFZhbHVlIiwiUmFwdG9yIiwiSEFXSyIsIkVBR0xFIiwiaW5zdGFuY2VUeXBlIiwiZW51bWVyYXRpb25Qcm9wZXJ0eSJdLCJzb3VyY2VzIjpbIkVudW1lcmF0aW9uUHJvcGVydHlUZXN0cy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMi0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBRVW5pdCBUZXN0cyBmb3IgRW51bWVyYXRpb25Qcm9wZXJ0eVxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBFbnVtZXJhdGlvbiBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvRW51bWVyYXRpb24uanMnO1xyXG5pbXBvcnQgRW51bWVyYXRpb25WYWx1ZSBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvRW51bWVyYXRpb25WYWx1ZS5qcyc7XHJcbmltcG9ydCBFbnVtZXJhdGlvbklPIGZyb20gJy4uLy4uL3RhbmRlbS9qcy90eXBlcy9FbnVtZXJhdGlvbklPLmpzJztcclxuaW1wb3J0IEVudW1lcmF0aW9uUHJvcGVydHkgZnJvbSAnLi9FbnVtZXJhdGlvblByb3BlcnR5LmpzJztcclxuXHJcblFVbml0Lm1vZHVsZSggJ0VudW1lcmF0aW9uUHJvcGVydHknICk7XHJcblFVbml0LnRlc3QoICdFbnVtZXJhdGlvblByb3BlcnR5JywgYXNzZXJ0ID0+IHtcclxuXHJcbiAgY2xhc3MgQmlyZCBleHRlbmRzIEVudW1lcmF0aW9uVmFsdWUge1xyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBST0JJTiA9IG5ldyBCaXJkKCk7XHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEpBWSA9IG5ldyBCaXJkKCk7XHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFdSRU4gPSBuZXcgQmlyZCgpO1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgZW51bWVyYXRpb24gPSBuZXcgRW51bWVyYXRpb24oIEJpcmQgKTtcclxuICB9XHJcblxyXG4gIGxldCBiaXJkUHJvcGVydHk6IEVudW1lcmF0aW9uUHJvcGVydHk8QmlyZD47XHJcblxyXG4gIC8vIGNvbnN0cnVjdG9yIHZhbHVlXHJcbiAgYXNzZXJ0Lm9rKCAoKSA9PiB7XHJcbiAgICBiaXJkUHJvcGVydHkgPSBuZXcgRW51bWVyYXRpb25Qcm9wZXJ0eSggQmlyZC5ST0JJTiApO1xyXG4gIH0sICdnb29kIGNvbnN0cnVjdG9yIHZhbHVlJyApO1xyXG4gIHdpbmRvdy5hc3NlcnQgJiYgYXNzZXJ0LnRocm93cyggKCkgPT4ge1xyXG5cclxuICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgSU5URU5USU9OQUwgdGVzdGluZyBiZWhhdmlvciBvZiBwYXNzaW5nIGluIHRoZSB3cm9uZyB2YWx1ZVxyXG4gICAgYmlyZFByb3BlcnR5ID0gbmV3IEVudW1lcmF0aW9uUHJvcGVydHkoIHRydWUgKTtcclxuICB9LCAnaW52YWxpZCBjb25zdHJ1Y3RvciB2YWx1ZScgKTtcclxuXHJcbiAgLy8gc2V0IHZhbHVlXHJcbiAgYXNzZXJ0Lm9rKCAoKSA9PiB7XHJcbiAgICBiaXJkUHJvcGVydHkuc2V0KCBCaXJkLkpBWSApO1xyXG4gIH0sICdnb29kIHNldCB2YWx1ZScgKTtcclxuICB3aW5kb3cuYXNzZXJ0ICYmIGFzc2VydC50aHJvd3MoICgpID0+IHtcclxuXHJcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yIElOVEVOVElPTkFMIHRlc3RpbmcgYmVoYXZpb3Igb2YgcGFzc2luZyBpbiB0aGUgd3JvbmcgdmFsdWVcclxuICAgIGJpcmRQcm9wZXJ0eS5zZXQoIDUgKTtcclxuICB9LCAnYmFkIHNldCB2YWx1ZScgKTtcclxuXHJcblxyXG4gIHdpbmRvdy5hc3NlcnQgJiYgYXNzZXJ0LnRocm93cyggKCkgPT4ge1xyXG5cclxuICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgSU5URU5USU9OQUwgdGVzdGluZyBzZXQgb2YgcGhldGlvVHlwZVxyXG4gICAgYmlyZFByb3BlcnR5ID0gbmV3IEVudW1lcmF0aW9uUHJvcGVydHkoIEJpcmQuUk9CSU4sIHsgcGhldGlvVHlwZTogRW51bWVyYXRpb25JTyB9ICk7XHJcbiAgfSwgJ0VudW1lcmF0aW9uUHJvcGVydHkgc2V0cyBwaGV0aW9UeXBlJyApO1xyXG4gIHdpbmRvdy5hc3NlcnQgJiYgYXNzZXJ0LnRocm93cyggKCkgPT4ge1xyXG5cclxuICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgSU5URU5USU9OQUwgdGVzdGluZyBiZWhhdmlvciBvZiBwYXNzaW5nIGluIHRoZSB3cm9uZyB2YWx1ZVxyXG4gICAgYmlyZFByb3BlcnR5ID0gbmV3IEVudW1lcmF0aW9uUHJvcGVydHkoIEJpcmQsIHsgcGhldGlvVHlwZTogRW51bWVyYXRpb25JTyB9ICk7XHJcbiAgfSwgJ05vdCB0aGUgRW51bWVyYXRpb24sIGJ1dCBhIHZhbHVlIGFzIGZpcnN0IGFyZycgKTtcclxuICB3aW5kb3cuYXNzZXJ0ICYmIGFzc2VydC50aHJvd3MoICgpID0+IHtcclxuXHJcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yIElOVEVOVElPTkFMIHRlc3RpbmcgYmVoYXZpb3Igb2YgcGFzc2luZyBpbiB0aGUgd3JvbmcgdmFsdWVcclxuICAgIGJpcmRQcm9wZXJ0eSA9IG5ldyBFbnVtZXJhdGlvblByb3BlcnR5KCB7fSApO1xyXG4gIH0sICdUaGF0IGlzIG5vdCBhbiBlbnVtZXJhdGlvbicgKTtcclxufSApO1xyXG5cclxuUVVuaXQudGVzdCggJ0VudW1lcmF0aW9uSU8gdmFsaWRhdGlvbicsIGFzc2VydCA9PiB7XHJcblxyXG4gICAgY2xhc3MgQmlyZDEgZXh0ZW5kcyBFbnVtZXJhdGlvblZhbHVlIHtcclxuICAgICAgcHVibGljIHN0YXRpYyByZWFkb25seSBST0JJTiA9IG5ldyBCaXJkMSgpO1xyXG4gICAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEpBWSA9IG5ldyBCaXJkMSgpO1xyXG4gICAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFdSRU4gPSBuZXcgQmlyZDEoKTtcclxuICAgICAgcHVibGljIHN0YXRpYyByZWFkb25seSBHT0FUID0gbmV3IEJpcmQxKCk7XHJcbiAgICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgZW51bWVyYXRpb24gPSBuZXcgRW51bWVyYXRpb24oIEJpcmQxICk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xhc3MgQmlyZDIgZXh0ZW5kcyBFbnVtZXJhdGlvblZhbHVlIHtcclxuICAgICAgcHVibGljIHN0YXRpYyByZWFkb25seSBST0JJTiA9IG5ldyBCaXJkMigpO1xyXG4gICAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEpBWSA9IG5ldyBCaXJkMigpO1xyXG4gICAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFdSRU4gPSBuZXcgQmlyZDIoKTtcclxuICAgICAgcHVibGljIHN0YXRpYyByZWFkb25seSBPVEhFUl9XUkVOID0gbmV3IEJpcmQyKCk7XHJcbiAgICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgZW51bWVyYXRpb24gPSBuZXcgRW51bWVyYXRpb24oIEJpcmQyLCB7IHBoZXRpb0RvY3VtZW50YXRpb246ICd0aGUgc2Vjb25kIG9uZScgfSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgSU5URU5USU9OQUwgY2hlY2tpbmcgdGhlc2UgYXJlIGluZGVlZCBkaWZmZXJlbnQgZW51bWVyYXRpb25zXHJcbiAgICBhc3NlcnQub2soIEJpcmQxICE9PSBCaXJkMiwgJ2RpZmZlcmVudCBFbnVtZXJhdGlvbnMnICk7XHJcbiAgICBhc3NlcnQub2soIEJpcmQxLlJPQklOICE9PSBCaXJkMi5ST0JJTiwgJ2RpZmZlcmVudCBFbnVtZXJhdGlvbnMnICk7XHJcbiAgICBsZXQgYmlyZFByb3BlcnR5ID0gbmV3IEVudW1lcmF0aW9uUHJvcGVydHkoIEJpcmQxLlJPQklOICk7XHJcbiAgICBjb25zdCBiaXJkMlByb3BlcnR5ID0gbmV3IEVudW1lcmF0aW9uUHJvcGVydHkoIEJpcmQyLlJPQklOICk7XHJcblxyXG4gICAgLy8gY29uc3RydWN0b3IgdmFsdWVcclxuICAgIHdpbmRvdy5hc3NlcnQgJiYgYXNzZXJ0LnRocm93cyggKCkgPT4ge1xyXG4gICAgICBiaXJkUHJvcGVydHkuc2V0KCBCaXJkMi5ST0JJTiApO1xyXG4gICAgfSwgJ2Nhbm5vdCB1c2Ugc2FtZSBzdHJpbmcgdmFsdWUgZnJvbSBvdGhlciBFbnVtZXJhdGlvbkRlcHJlY2F0ZWQgaW5zdGFuY2UnICk7XHJcblxyXG4gICAgLy8gbmV3IGluc3RhbmNlIG9mIGJpcmRQcm9wZXJ0eSBzaW5jZSBpdCBnb3QgbWVzc2VkIHVwIGluIHRoZSBhYm92ZSBhc3NlcnQuXHJcbiAgICBiaXJkUHJvcGVydHkgPSBuZXcgRW51bWVyYXRpb25Qcm9wZXJ0eSggQmlyZDEuUk9CSU4gKTtcclxuXHJcbiAgICBiaXJkUHJvcGVydHkuc2V0KCBCaXJkMS5XUkVOICk7XHJcblxyXG4gICAgLy8gVGhpcyBzaG91bGQgbm90IGZhaWwhIElmIGl0IGRvZXMgdGhlbiBFbnVtZXJhdGlvbklPIGFuZCBQcm9wZXJ0eUlPIGNhY2hpbmcgaXNuJ3Qgd29ya2luZywgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9waGV0LWNvcmUvaXNzdWVzLzc5XHJcbiAgICBiaXJkMlByb3BlcnR5LnNldCggQmlyZDIuV1JFTiApO1xyXG4gIH1cclxuKTtcclxuXHJcblFVbml0LnRlc3QoICd2YWxpZFZhbHVlcyBhcyBhIHN1YnNldCBvZiBFbnVtZXJhdGlvbiB2YWx1ZXMnLCBhc3NlcnQgPT4ge1xyXG5cclxuXHJcbiAgY2xhc3MgQmlyZDEgZXh0ZW5kcyBFbnVtZXJhdGlvblZhbHVlIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgUk9CSU4gPSBuZXcgQmlyZDEoKTtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgSkFZID0gbmV3IEJpcmQxKCk7XHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFdSRU4gPSBuZXcgQmlyZDEoKTtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgV1JFTl8yID0gbmV3IEJpcmQxKCk7XHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IGVudW1lcmF0aW9uID0gbmV3IEVudW1lcmF0aW9uKCBCaXJkMSApO1xyXG4gIH1cclxuXHJcbiAgY2xhc3MgQmlyZDIgZXh0ZW5kcyBFbnVtZXJhdGlvblZhbHVlIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgUk9CSU4gPSBuZXcgQmlyZDIoKTtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgSkFZID0gbmV3IEJpcmQyKCk7XHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFdSRU4gPSBuZXcgQmlyZDIoKTtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgV1JFTl8zID0gbmV3IEJpcmQyKCk7XHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IGVudW1lcmF0aW9uID0gbmV3IEVudW1lcmF0aW9uKCBCaXJkMiwgeyBwaGV0aW9Eb2N1bWVudGF0aW9uOiAndGhlIHNlY29uZCBvbmUnIH0gKTtcclxuICB9XHJcblxyXG4gIC8vIEB0cy1leHBlY3QtZXJyb3IgSU5URU5USU9OQUwgdGVzdGluZyB0aGVzZSBhcmUgaW5kZWVkIGRpZmZlcmVudCBlbnVtZXJhdGlvbnNcclxuICBhc3NlcnQub2soIEJpcmQxICE9PSBCaXJkMiwgJ2RpZmZlcmVudCBFbnVtZXJhdGlvbnMnICk7XHJcbiAgYXNzZXJ0Lm9rKCBCaXJkMS5ST0JJTiAhPT0gQmlyZDIuUk9CSU4sICdkaWZmZXJlbnQgRW51bWVyYXRpb25zJyApO1xyXG5cclxuXHJcbiAgY29uc3QgZW51bWVyYXRpb24xUHJvcGVydHkgPSBuZXcgRW51bWVyYXRpb25Qcm9wZXJ0eSggQmlyZDEuUk9CSU4sIHsgdmFsaWRWYWx1ZXM6IFsgQmlyZDEuUk9CSU4sIEJpcmQxLkpBWSBdIH0gKTtcclxuXHJcbiAgZW51bWVyYXRpb24xUHJvcGVydHkudmFsdWUgPSBCaXJkMS5KQVk7XHJcbiAgYXNzZXJ0Lm9rKCBlbnVtZXJhdGlvbjFQcm9wZXJ0eS52YWx1ZSA9PT0gQmlyZDEuSkFZLCAnYmFzaWMgdGVzdCBmb3Igd2hlbiBhc3NlcnRpb25zIGFyZSBub3QgZW5hYmxlZCcgKTtcclxuICBhc3NlcnQub2soIGVudW1lcmF0aW9uMVByb3BlcnR5LmdldEluaXRpYWxWYWx1ZSgpID09PSBCaXJkMS5ST0JJTiwgJ2Jhc2ljIHRlc3QgZm9yIHdoZW4gYXNzZXJ0aW9ucyBhcmUgbm90IGVuYWJsZWQgZm9yIGluaXRpYWxWYWx1ZScgKTtcclxuXHJcbiAgd2luZG93LmFzc2VydCAmJiBhc3NlcnQudGhyb3dzKCAoKSA9PiB7XHJcbiAgICBlbnVtZXJhdGlvbjFQcm9wZXJ0eS52YWx1ZSA9IEJpcmQxLldSRU47XHJcbiAgfSwgJ25vdCBhIHZhbGlkIHZhbHVlJyApO1xyXG5cclxuICB3aW5kb3cuYXNzZXJ0ICYmIGFzc2VydC50aHJvd3MoICgpID0+IHtcclxuICAgIGVudW1lcmF0aW9uMVByb3BlcnR5LnZhbHVlID0gQmlyZDIuUk9CSU47XHJcbiAgfSwgJ25vdCBhIHZhbGlkIHZhbHVlLCBmcm9tIGEgZGlmZmVyZW50IEVudW1lcmF0aW9uJyApO1xyXG59ICk7XHJcblxyXG5cclxuUVVuaXQudGVzdCggJ1N1YnR5cGluZyBFbnVtZXJhdGlvblZhbHVlcycsIGFzc2VydCA9PiB7XHJcblxyXG4gIGNsYXNzIFJhcHRvciBleHRlbmRzIEVudW1lcmF0aW9uVmFsdWUge1xyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBIQVdLID0gbmV3IFJhcHRvcigpO1xyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBFQUdMRSA9IG5ldyBSYXB0b3IoKTtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgZW51bWVyYXRpb24gPSBuZXcgRW51bWVyYXRpb24oIFJhcHRvciwgeyBwaGV0aW9Eb2N1bWVudGF0aW9uOiAndGhlIHNlY29uZCBvbmUnIH0gKTtcclxuICB9XHJcblxyXG4gIGNsYXNzIEJpcmQgZXh0ZW5kcyBSYXB0b3Ige1xyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBST0JJTiA9IG5ldyBCaXJkKCk7XHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEpBWSA9IG5ldyBCaXJkKCk7XHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFdSRU4gPSBuZXcgQmlyZCgpO1xyXG4gICAgcHVibGljIHN0YXRpYyBvdmVycmlkZSByZWFkb25seSBlbnVtZXJhdGlvbiA9IG5ldyBFbnVtZXJhdGlvbiggQmlyZCwge1xyXG4gICAgICBpbnN0YW5jZVR5cGU6IFJhcHRvclxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgbGV0IGVudW1lcmF0aW9uUHJvcGVydHkgPSBuZXcgRW51bWVyYXRpb25Qcm9wZXJ0eSggUmFwdG9yLkhBV0sgKTtcclxuXHJcbiAgYXNzZXJ0Lm9rKCB0cnVlLCAnd2hlbiBhc3NlcnRpb25zIGFyZSBub3QgZW5hYmxlZCcgKTtcclxuXHJcbiAgLy8gVGhpcyBpcyB1bmZvcnR1bmF0ZSwgYnV0IHRoZSBlbnVtZXJhdGlvbiBpcyBieSBkZWZhdWx0IGdhdGhlcmVkIGJ5IHRoZSBpbml0aWFsIHZhbHVlIG9mIEVudW1lcmF0aW9uUHJvcGVydHlcclxuICB3aW5kb3cuYXNzZXJ0ICYmIGFzc2VydC50aHJvd3MoICgpID0+IHtcclxuICAgIGVudW1lcmF0aW9uUHJvcGVydHkudmFsdWUgPSBCaXJkLlJPQklOO1xyXG4gIH0gKTtcclxuXHJcbiAgZW51bWVyYXRpb25Qcm9wZXJ0eSA9IG5ldyBFbnVtZXJhdGlvblByb3BlcnR5KCBSYXB0b3IuSEFXSywge1xyXG4gICAgZW51bWVyYXRpb246IEJpcmQuZW51bWVyYXRpb25cclxuICB9ICk7XHJcblxyXG4gIGVudW1lcmF0aW9uUHJvcGVydHkudmFsdWUgPSBCaXJkLlJPQklOO1xyXG4gIGVudW1lcmF0aW9uUHJvcGVydHkudmFsdWUgPSBCaXJkLkhBV0s7XHJcbiAgZW51bWVyYXRpb25Qcm9wZXJ0eS52YWx1ZSA9IFJhcHRvci5FQUdMRTtcclxuICBlbnVtZXJhdGlvblByb3BlcnR5LnZhbHVlID0gQmlyZC5XUkVOO1xyXG4gIGVudW1lcmF0aW9uUHJvcGVydHkudmFsdWUgPSBCaXJkLkVBR0xFO1xyXG59ICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFdBQVcsTUFBTSxtQ0FBbUM7QUFDM0QsT0FBT0MsZ0JBQWdCLE1BQU0sd0NBQXdDO0FBQ3JFLE9BQU9DLGFBQWEsTUFBTSx3Q0FBd0M7QUFDbEUsT0FBT0MsbUJBQW1CLE1BQU0sMEJBQTBCO0FBRTFEQyxLQUFLLENBQUNDLE1BQU0sQ0FBRSxxQkFBc0IsQ0FBQztBQUNyQ0QsS0FBSyxDQUFDRSxJQUFJLENBQUUscUJBQXFCLEVBQUVDLE1BQU0sSUFBSTtFQUUzQyxNQUFNQyxJQUFJLFNBQVNQLGdCQUFnQixDQUFDO0lBQ2xDLE9BQXVCUSxLQUFLLEdBQUcsSUFBSUQsSUFBSSxDQUFDLENBQUM7SUFDekMsT0FBdUJFLEdBQUcsR0FBRyxJQUFJRixJQUFJLENBQUMsQ0FBQztJQUN2QyxPQUF1QkcsSUFBSSxHQUFHLElBQUlILElBQUksQ0FBQyxD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