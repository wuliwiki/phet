// Copyright 2014-2022, University of Colorado Boulder

/**
 * Particle, represented as a circle with a gradient.  This type does not
 * track a particle, use ParticleView for that.
 */

import Utils from '../../../dot/js/Utils.js';
import merge from '../../../phet-core/js/merge.js';
import PhetColorScheme from '../../../scenery-phet/js/PhetColorScheme.js';
import { Circle, Color, RadialGradient } from '../../../scenery/js/imports.js';
import Tandem from '../../../tandem/js/Tandem.js';
import shred from '../shred.js';

// constants
const DEFAULT_LINE_WIDTH = 0.5;
const HIGH_CONTRAST_LINE_WIDTH = 2;

// map of particle type to color information
const PARTICLE_COLORS = {
  proton: PhetColorScheme.RED_COLORBLIND,
  neutron: Color.GRAY,
  electron: Color.BLUE,
  positron: Color.GREEN
};

// color gradient between the color of a proton and a neutron
const NUCLEON_COLOR_GRADIENT = [PARTICLE_COLORS.proton, new Color('#e06020'),
// 1/4 point
new Color('#c06b40'),
// half-way point
new Color('#a07660'),
// 3/4 point
PARTICLE_COLORS.neutron];
class ParticleNode extends Circle {
  /**
   * @param {string} particleType - proton, neutron, or electron
   * @param {number} radius
   * @param {Object} [options]
   */
  constructor(particleType, radius, options) {
    options = merge({
      cursor: 'pointer',
      // {BooleanProperty|null} - if provided, this is used to set the particle node into and out of high contrast mode
      highContrastProperty: null,
      typeProperty: null,
      colorGradientIndexNumberProperty: null,
      // phet-io
      tandem: Tandem.OPTIONAL
    }, options);
    assert && assert(options.fill === undefined, 'fill will be set programmatically and should not be specified');
    assert && assert(options.stroke === undefined, 'stroke will be set programmatically and should not be specified');
    assert && assert(options.lineWidth === undefined, 'line width will be set programmatically and should not be specified');

    // Get the color to use as the basis for the gradients, fills, strokes and such.
    const baseColor = PARTICLE_COLORS[particleType];
    assert && assert(baseColor, `Unrecognized particle type: ${particleType}`);

    // Create the fill that will be used to make the particles look 3D when not in high-contrast mode.
    const gradientFill = new RadialGradient(-radius * 0.4, -radius * 0.4, 0, -radius * 0.4, -radius * 0.4, radius * 1.6).addColorStop(0, 'white').addColorStop(1, baseColor);

    // Set the options for the default look.
    const nonHighContrastStroke = baseColor.colorUtilsDarker(0.33);
    options.fill = gradientFill;
    options.stroke = nonHighContrastStroke;
    options.lineWidth = DEFAULT_LINE_WIDTH;
    super(radius, options);

    // function to change the color of a particle
    const changeParticleColor = newColor => {
      // Create the fill that will be used to make the particles look 3D when not in high-contrast mode.
      const gradientFill = new RadialGradient(-radius * 0.4, -radius * 0.4, 0, -radius * 0.4, -radius * 0.4, radius * 1.6).addColorStop(0, 'white').addColorStop(1, newColor);

      // Set the options for the default look.
      const nonHighContrastStroke = newColor.colorUtilsDarker(0.33);
      const newOptions = {};
      newOptions.fill = gradientFill;
      newOptions.stroke = nonHighContrastStroke;
      this.mutate(newOptions);
    };

    // change the color of the particle
    options.colorGradientIndexNumberProperty && options.colorGradientIndexNumberProperty.link(indexValue => {
      if (options.typeProperty.value === 'proton' || options.typeProperty.value === 'neutron') {
        let nucleonChangeColorChange;
        if (options.typeProperty.value === 'proton') {
          nucleonChangeColorChange = NUCLEON_COLOR_GRADIENT.slice().reverse();
        } else if (options.typeProperty.value === 'neutron') {
          nucleonChangeColorChange = NUCLEON_COLOR_GRADIENT.slice();
        }

        // the value is close to an integer
        if (Math.floor(indexValue * 10) / 10 % 1 === 0) {
          changeParticleColor(nucleonChangeColorChange[Utils.toFixed(indexValue, 0)]);
        }
      }
    });

    // If a highContrastProperty is provided, update the particle appearance based on its value.
    // Set up the fill and the strokes based on whether the highContrastProperty option is provided.
    let highContrastListener = null;
    if (options.highContrastProperty) {
      highContrastListener = highContrast => {
        this.fill = highContrast ? baseColor : gradientFill;
        this.stroke = highContrast ? baseColor.colorUtilsDarker(0.5) : nonHighContrastStroke;
        this.lineWidth = highContrast ? HIGH_CONTRAST_LINE_WIDTH : DEFAULT_LINE_WIDTH;
      };
      options.highContrastProperty.link(highContrastListener);
    }

    // @private - internal dispose function
    this.disposeParticleNode = () => {
      if (highContrastListener) {
        options.highContrastProperty.unlink(highContrastListener);
      }
    };
  }

  /**
   * release memory references
   * @public
   */
  dispose() {
    this.disposeParticleNode();
    super.dispose();
  }
}
shred.register('ParticleNode', ParticleNode);
export default ParticleNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIm1lcmdlIiwiUGhldENvbG9yU2NoZW1lIiwiQ2lyY2xlIiwiQ29sb3IiLCJSYWRpYWxHcmFkaWVudCIsIlRhbmRlbSIsInNocmVkIiwiREVGQVVMVF9MSU5FX1dJRFRIIiwiSElHSF9DT05UUkFTVF9MSU5FX1dJRFRIIiwiUEFSVElDTEVfQ09MT1JTIiwicHJvdG9uIiwiUkVEX0NPTE9SQkxJTkQiLCJuZXV0cm9uIiwiR1JBWSIsImVsZWN0cm9uIiwiQkxVRSIsInBvc2l0cm9uIiwiR1JFRU4iLCJOVUNMRU9OX0NPTE9SX0dSQURJRU5UIiwiUGFydGljbGVOb2RlIiwiY29uc3RydWN0b3IiLCJwYXJ0aWNsZVR5cGUiLCJyYWRpdXMiLCJvcHRpb25zIiwiY3Vyc29yIiwiaGlnaENvbnRyYXN0UHJvcGVydHkiLCJ0eXBlUHJvcGVydHkiLCJjb2xvckdyYWRpZW50SW5kZXhOdW1iZXJQcm9wZXJ0eSIsInRhbmRlbSIsIk9QVElPTkFMIiwiYXNzZXJ0IiwiZmlsbCIsInVuZGVmaW5lZCIsInN0cm9rZSIsImxpbmVXaWR0aCIsImJhc2VDb2xvciIsImdyYWRpZW50RmlsbCIsImFkZENvbG9yU3RvcCIsIm5vbkhpZ2hDb250cmFzdFN0cm9rZSIsImNvbG9yVXRpbHNEYXJrZXIiLCJjaGFuZ2VQYXJ0aWNsZUNvbG9yIiwibmV3Q29sb3IiLCJuZXdPcHRpb25zIiwibXV0YXRlIiwibGluayIsImluZGV4VmFsdWUiLCJ2YWx1ZSIsIm51Y2xlb25DaGFuZ2VDb2xvckNoYW5nZSIsInNsaWNlIiwicmV2ZXJzZSIsIk1hdGgiLCJmbG9vciIsInRvRml4ZWQiLCJoaWdoQ29udHJhc3RMaXN0ZW5lciIsImhpZ2hDb250cmFzdCIsImRpc3Bvc2VQYXJ0aWNsZU5vZGUiLCJ1bmxpbmsiLCJkaXNwb3NlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJQYXJ0aWNsZU5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTQtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogUGFydGljbGUsIHJlcHJlc2VudGVkIGFzIGEgY2lyY2xlIHdpdGggYSBncmFkaWVudC4gIFRoaXMgdHlwZSBkb2VzIG5vdFxyXG4gKiB0cmFjayBhIHBhcnRpY2xlLCB1c2UgUGFydGljbGVWaWV3IGZvciB0aGF0LlxyXG4gKi9cclxuXHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IFBoZXRDb2xvclNjaGVtZSBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldENvbG9yU2NoZW1lLmpzJztcclxuaW1wb3J0IHsgQ2lyY2xlLCBDb2xvciwgUmFkaWFsR3JhZGllbnQgfSBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgc2hyZWQgZnJvbSAnLi4vc2hyZWQuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IERFRkFVTFRfTElORV9XSURUSCA9IDAuNTtcclxuY29uc3QgSElHSF9DT05UUkFTVF9MSU5FX1dJRFRIID0gMjtcclxuXHJcbi8vIG1hcCBvZiBwYXJ0aWNsZSB0eXBlIHRvIGNvbG9yIGluZm9ybWF0aW9uXHJcbmNvbnN0IFBBUlRJQ0xFX0NPTE9SUyA9IHtcclxuICBwcm90b246IFBoZXRDb2xvclNjaGVtZS5SRURfQ09MT1JCTElORCxcclxuICBuZXV0cm9uOiBDb2xvci5HUkFZLFxyXG4gIGVsZWN0cm9uOiBDb2xvci5CTFVFLFxyXG4gIHBvc2l0cm9uOiBDb2xvci5HUkVFTlxyXG59O1xyXG5cclxuLy8gY29sb3IgZ3JhZGllbnQgYmV0d2VlbiB0aGUgY29sb3Igb2YgYSBwcm90b24gYW5kIGEgbmV1dHJvblxyXG5jb25zdCBOVUNMRU9OX0NPTE9SX0dSQURJRU5UID0gW1xyXG4gIFBBUlRJQ0xFX0NPTE9SUy5wcm90b24sXHJcbiAgbmV3IENvbG9yKCAnI2UwNjAyMCcgKSwgLy8gMS80IHBvaW50XHJcbiAgbmV3IENvbG9yKCAnI2MwNmI0MCcgKSwgLy8gaGFsZi13YXkgcG9pbnRcclxuICBuZXcgQ29sb3IoICcjYTA3NjYwJyApLCAvLyAzLzQgcG9pbnRcclxuICBQQVJUSUNMRV9DT0xPUlMubmV1dHJvblxyXG5dO1xyXG5cclxuY2xhc3MgUGFydGljbGVOb2RlIGV4dGVuZHMgQ2lyY2xlIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBhcnRpY2xlVHlwZSAtIHByb3RvbiwgbmV1dHJvbiwgb3IgZWxlY3Ryb25cclxuICAgKiBAcGFyYW0ge251bWJlcn0gcmFkaXVzXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBwYXJ0aWNsZVR5cGUsIHJhZGl1cywgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuXHJcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG5cclxuICAgICAgLy8ge0Jvb2xlYW5Qcm9wZXJ0eXxudWxsfSAtIGlmIHByb3ZpZGVkLCB0aGlzIGlzIHVzZWQgdG8gc2V0IHRoZSBwYXJ0aWNsZSBub2RlIGludG8gYW5kIG91dCBvZiBoaWdoIGNvbnRyYXN0IG1vZGVcclxuICAgICAgaGlnaENvbnRyYXN0UHJvcGVydHk6IG51bGwsXHJcblxyXG4gICAgICB0eXBlUHJvcGVydHk6IG51bGwsXHJcblxyXG4gICAgICBjb2xvckdyYWRpZW50SW5kZXhOdW1iZXJQcm9wZXJ0eTogbnVsbCxcclxuXHJcbiAgICAgIC8vIHBoZXQtaW9cclxuICAgICAgdGFuZGVtOiBUYW5kZW0uT1BUSU9OQUxcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvcHRpb25zLmZpbGwgPT09IHVuZGVmaW5lZCwgJ2ZpbGwgd2lsbCBiZSBzZXQgcHJvZ3JhbW1hdGljYWxseSBhbmQgc2hvdWxkIG5vdCBiZSBzcGVjaWZpZWQnICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvcHRpb25zLnN0cm9rZSA9PT0gdW5kZWZpbmVkLCAnc3Ryb2tlIHdpbGwgYmUgc2V0IHByb2dyYW1tYXRpY2FsbHkgYW5kIHNob3VsZCBub3QgYmUgc3BlY2lmaWVkJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy5saW5lV2lkdGggPT09IHVuZGVmaW5lZCwgJ2xpbmUgd2lkdGggd2lsbCBiZSBzZXQgcHJvZ3JhbW1hdGljYWxseSBhbmQgc2hvdWxkIG5vdCBiZSBzcGVjaWZpZWQnICk7XHJcblxyXG4gICAgLy8gR2V0IHRoZSBjb2xvciB0byB1c2UgYXMgdGhlIGJhc2lzIGZvciB0aGUgZ3JhZGllbnRzLCBmaWxscywgc3Ryb2tlcyBhbmQgc3VjaC5cclxuICAgIGNvbnN0IGJhc2VDb2xvciA9IFBBUlRJQ0xFX0NPTE9SU1sgcGFydGljbGVUeXBlIF07XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBiYXNlQ29sb3IsIGBVbnJlY29nbml6ZWQgcGFydGljbGUgdHlwZTogJHtwYXJ0aWNsZVR5cGV9YCApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgZmlsbCB0aGF0IHdpbGwgYmUgdXNlZCB0byBtYWtlIHRoZSBwYXJ0aWNsZXMgbG9vayAzRCB3aGVuIG5vdCBpbiBoaWdoLWNvbnRyYXN0IG1vZGUuXHJcbiAgICBjb25zdCBncmFkaWVudEZpbGwgPSBuZXcgUmFkaWFsR3JhZGllbnQoIC1yYWRpdXMgKiAwLjQsIC1yYWRpdXMgKiAwLjQsIDAsIC1yYWRpdXMgKiAwLjQsIC1yYWRpdXMgKiAwLjQsIHJhZGl1cyAqIDEuNiApXHJcbiAgICAgIC5hZGRDb2xvclN0b3AoIDAsICd3aGl0ZScgKVxyXG4gICAgICAuYWRkQ29sb3JTdG9wKCAxLCBiYXNlQ29sb3IgKTtcclxuXHJcbiAgICAvLyBTZXQgdGhlIG9wdGlvbnMgZm9yIHRoZSBkZWZhdWx0IGxvb2suXHJcbiAgICBjb25zdCBub25IaWdoQ29udHJhc3RTdHJva2UgPSBiYXNlQ29sb3IuY29sb3JVdGlsc0RhcmtlciggMC4zMyApO1xyXG4gICAgb3B0aW9ucy5maWxsID0gZ3JhZGllbnRGaWxsO1xyXG4gICAgb3B0aW9ucy5zdHJva2UgPSBub25IaWdoQ29udHJhc3RTdHJva2U7XHJcbiAgICBvcHRpb25zLmxpbmVXaWR0aCA9IERFRkFVTFRfTElORV9XSURUSDtcclxuXHJcbiAgICBzdXBlciggcmFkaXVzLCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gZnVuY3Rpb24gdG8gY2hhbmdlIHRoZSBjb2xvciBvZiBhIHBhcnRpY2xlXHJcbiAgICBjb25zdCBjaGFuZ2VQYXJ0aWNsZUNvbG9yID0gbmV3Q29sb3IgPT4ge1xyXG5cclxuICAgICAgLy8gQ3JlYXRlIHRoZSBmaWxsIHRoYXQgd2lsbCBiZSB1c2VkIHRvIG1ha2UgdGhlIHBhcnRpY2xlcyBsb29rIDNEIHdoZW4gbm90IGluIGhpZ2gtY29udHJhc3QgbW9kZS5cclxuICAgICAgY29uc3QgZ3JhZGllbnRGaWxsID0gbmV3IFJhZGlhbEdyYWRpZW50KCAtcmFkaXVzICogMC40LCAtcmFkaXVzICogMC40LCAwLCAtcmFkaXVzICogMC40LCAtcmFkaXVzICogMC40LCByYWRpdXMgKiAxLjYgKVxyXG4gICAgICAgIC5hZGRDb2xvclN0b3AoIDAsICd3aGl0ZScgKVxyXG4gICAgICAgIC5hZGRDb2xvclN0b3AoIDEsIG5ld0NvbG9yICk7XHJcblxyXG4gICAgICAvLyBTZXQgdGhlIG9wdGlvbnMgZm9yIHRoZSBkZWZhdWx0IGxvb2suXHJcbiAgICAgIGNvbnN0IG5vbkhpZ2hDb250cmFzdFN0cm9rZSA9IG5ld0NvbG9yLmNvbG9yVXRpbHNEYXJrZXIoIDAuMzMgKTtcclxuICAgICAgY29uc3QgbmV3T3B0aW9ucyA9IHt9O1xyXG4gICAgICBuZXdPcHRpb25zLmZpbGwgPSBncmFkaWVudEZpbGw7XHJcbiAgICAgIG5ld09wdGlvbnMuc3Ryb2tlID0gbm9uSGlnaENvbnRyYXN0U3Ryb2tlO1xyXG5cclxuICAgICAgdGhpcy5tdXRhdGUoIG5ld09wdGlvbnMgKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gY2hhbmdlIHRoZSBjb2xvciBvZiB0aGUgcGFydGljbGVcclxuICAgIG9wdGlvbnMuY29sb3JHcmFkaWVudEluZGV4TnVtYmVyUHJvcGVydHkgJiYgb3B0aW9ucy5jb2xvckdyYWRpZW50SW5kZXhOdW1iZXJQcm9wZXJ0eS5saW5rKCBpbmRleFZhbHVlID0+IHtcclxuICAgICAgaWYgKCBvcHRpb25zLnR5cGVQcm9wZXJ0eS52YWx1ZSA9PT0gJ3Byb3RvbicgfHwgb3B0aW9ucy50eXBlUHJvcGVydHkudmFsdWUgPT09ICduZXV0cm9uJyApIHtcclxuXHJcbiAgICAgICAgbGV0IG51Y2xlb25DaGFuZ2VDb2xvckNoYW5nZTtcclxuICAgICAgICBpZiAoIG9wdGlvbnMudHlwZVByb3BlcnR5LnZhbHVlID09PSAncHJvdG9uJyApIHtcclxuICAgICAgICAgIG51Y2xlb25DaGFuZ2VDb2xvckNoYW5nZSA9IE5VQ0xFT05fQ09MT1JfR1JBRElFTlQuc2xpY2UoKS5yZXZlcnNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCBvcHRpb25zLnR5cGVQcm9wZXJ0eS52YWx1ZSA9PT0gJ25ldXRyb24nICkge1xyXG4gICAgICAgICAgbnVjbGVvbkNoYW5nZUNvbG9yQ2hhbmdlID0gTlVDTEVPTl9DT0xPUl9HUkFESUVOVC5zbGljZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gdGhlIHZhbHVlIGlzIGNsb3NlIHRvIGFuIGludGVnZXJcclxuICAgICAgICBpZiAoIE1hdGguZmxvb3IoIGluZGV4VmFsdWUgKiAxMCApIC8gMTAgJSAxID09PSAwICkge1xyXG4gICAgICAgICAgY2hhbmdlUGFydGljbGVDb2xvciggbnVjbGVvbkNoYW5nZUNvbG9yQ2hhbmdlWyBVdGlscy50b0ZpeGVkKCBpbmRleFZhbHVlLCAwICkgXSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIElmIGEgaGlnaENvbnRyYXN0UHJvcGVydHkgaXMgcHJvdmlkZWQsIHVwZGF0ZSB0aGUgcGFydGljbGUgYXBwZWFyYW5jZSBiYXNlZCBvbiBpdHMgdmFsdWUuXHJcbiAgICAvLyBTZXQgdXAgdGhlIGZpbGwgYW5kIHRoZSBzdHJva2VzIGJhc2VkIG9uIHdoZXRoZXIgdGhlIGhpZ2hDb250cmFzdFByb3BlcnR5IG9wdGlvbiBpcyBwcm92aWRlZC5cclxuICAgIGxldCBoaWdoQ29udHJhc3RMaXN0ZW5lciA9IG51bGw7XHJcbiAgICBpZiAoIG9wdGlvbnMuaGlnaENvbnRyYXN0UHJvcGVydHkgKSB7XHJcbiAgICAgIGhpZ2hDb250cmFzdExpc3RlbmVyID0gaGlnaENvbnRyYXN0ID0+IHtcclxuICAgICAgICB0aGlzLmZpbGwgPSBoaWdoQ29udHJhc3QgPyBiYXNlQ29sb3IgOiBncmFkaWVudEZpbGw7XHJcbiAgICAgICAgdGhpcy5zdHJva2UgPSBoaWdoQ29udHJhc3QgPyBiYXNlQ29sb3IuY29sb3JVdGlsc0RhcmtlciggMC41ICkgOiBub25IaWdoQ29udHJhc3RTdHJva2U7XHJcbiAgICAgICAgdGhpcy5saW5lV2lkdGggPSBoaWdoQ29udHJhc3QgPyBISUdIX0NPTlRSQVNUX0xJTkVfV0lEVEggOiBERUZBVUxUX0xJTkVfV0lEVEg7XHJcbiAgICAgIH07XHJcbiAgICAgIG9wdGlvbnMuaGlnaENvbnRyYXN0UHJvcGVydHkubGluayggaGlnaENvbnRyYXN0TGlzdGVuZXIgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBAcHJpdmF0ZSAtIGludGVybmFsIGRpc3Bvc2UgZnVuY3Rpb25cclxuICAgIHRoaXMuZGlzcG9zZVBhcnRpY2xlTm9kZSA9ICgpID0+IHtcclxuICAgICAgaWYgKCBoaWdoQ29udHJhc3RMaXN0ZW5lciApIHtcclxuICAgICAgICBvcHRpb25zLmhpZ2hDb250cmFzdFByb3BlcnR5LnVubGluayggaGlnaENvbnRyYXN0TGlzdGVuZXIgKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHJlbGVhc2UgbWVtb3J5IHJlZmVyZW5jZXNcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgZGlzcG9zZSgpIHtcclxuICAgIHRoaXMuZGlzcG9zZVBhcnRpY2xlTm9kZSgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuc2hyZWQucmVnaXN0ZXIoICdQYXJ0aWNsZU5vZGUnLCBQYXJ0aWNsZU5vZGUgKTtcclxuZXhwb3J0IGRlZmF1bHQgUGFydGljbGVOb2RlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsS0FBSyxNQUFNLDBCQUEwQjtBQUM1QyxPQUFPQyxLQUFLLE1BQU0sZ0NBQWdDO0FBQ2xELE9BQU9DLGVBQWUsTUFBTSw2Q0FBNkM7QUFDekUsU0FBU0MsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLGNBQWMsUUFBUSxnQ0FBZ0M7QUFDOUUsT0FBT0MsTUFBTSxNQUFNLDhCQUE4QjtBQUNqRCxPQUFPQyxLQUFLLE1BQU0sYUFBYTs7QUFFL0I7QUFDQSxNQUFNQyxrQkFBa0IsR0FBRyxHQUFHO0FBQzlCLE1BQU1DLHdCQUF3QixHQUFHLENBQUM7O0FBRWxDO0FBQ0EsTUFBTUMsZUFBZSxHQUFHO0VBQ3RCQyxNQUFNLEVBQUVULGVBQWUsQ0FBQ1UsY0FBYztFQUN0Q0MsT0FBTyxFQUFFVCxLQUFLLENBQUNVLElBQUk7RUFDbkJDLFFBQVEsRUFBRVgsS0FBSyxDQUFDWSxJQUFJO0VBQ3BCQyxRQUFRLEVBQUViLEtBQUssQ0FBQ2M7QUFDbEIsQ0FBQzs7QUFFRDtBQUNBLE1BQU1DLHNCQUFzQixHQUFHLENBQzdCVCxlQUFlLENBQUNDLE1BQU0sRUFDdEIsSUFBSVAsS0FBSyxDQUFFLFNBQVUsQ0FB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