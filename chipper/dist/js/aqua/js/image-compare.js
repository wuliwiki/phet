// Copyright 2022, University of Colorado Boulder

/**
 * Functions supporting taking two image data URLs and comparing them, and providing a "comparison" image that shows
 * the differences. It also provides other stats in the div returned from the callback, see compareImages();
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

(() => {
  function imageToContext(image, width, height) {
    const canvas = document.createElement('canvas');
    const context = canvas.getContext('2d');
    canvas.width = width;
    canvas.height = height;
    context.drawImage(image, 0, 0);
    return context;
  }
  function contextToData(context, width, height) {
    return context.getImageData(0, 0, width, height);
  }
  function dataToCanvas(data, width, height) {
    const canvas = document.createElement('canvas');
    const context = canvas.getContext('2d');
    canvas.width = width;
    canvas.height = height;
    context.putImageData(data, 0, 0);
    return canvas;
  }
  function compareImageElements(imageA, imageB, msg, width, height) {
    const threshold = 0;
    const a = contextToData(imageToContext(imageA, width, height), width, height);
    const b = contextToData(imageToContext(imageB, width, height), width, height);
    let largestDifference = 0;
    let totalDifference = 0;
    const colorDiffData = document.createElement('canvas').getContext('2d').createImageData(a.width, a.height);
    const alphaDiffData = document.createElement('canvas').getContext('2d').createImageData(a.width, a.height);
    for (let i = 0; i < a.data.length; i++) {
      const diff = Math.abs(a.data[i] - b.data[i]);
      if (i % 4 === 3) {
        colorDiffData.data[i] = 255;
        alphaDiffData.data[i] = 255;
        alphaDiffData.data[i - 3] = diff; // red
        alphaDiffData.data[i - 2] = diff; // green
        alphaDiffData.data[i - 1] = diff; // blue
      } else {
        colorDiffData.data[i] = diff;
      }
      const alphaIndex = i - i % 4 + 3;
      // grab the associated alpha channel and multiply it times the diff
      const alphaMultipliedDiff = i % 4 === 3 ? diff : diff * (a.data[alphaIndex] / 255) * (b.data[alphaIndex] / 255);
      totalDifference += alphaMultipliedDiff;
      // if ( alphaMultipliedDiff > threshold ) {
      // console.log( message + ': ' + Math.abs( a.data[i] - b.data[i] ) );
      largestDifference = Math.max(largestDifference, alphaMultipliedDiff);
      // isEqual = false;
      // break;
      // }
    }

    const averageDifference = totalDifference / (4 * a.width * a.height);
    if (averageDifference > threshold) {
      const container = document.createElement('div');
      container.appendChild(document.createTextNode(`${msg}, largest: ${largestDifference}, average: ${averageDifference}`));
      container.appendChild(document.createElement('br'));
      container.appendChild(dataToCanvas(a, width, height));
      container.appendChild(dataToCanvas(b, width, height));
      container.appendChild(dataToCanvas(colorDiffData, width, height));
      // container.appendChild( dataToCanvas( alphaDiffData ) );
      return container;
    }
    return null;
  }

  // callback returns either null or the div that contains the comparison of images showing the difference.
  function compareImages(imageA_URL, imageB_URL, msg, width, height, callback) {
    const newImage = document.createElement('img');
    newImage.addEventListener('load', () => {
      const oldImage = document.createElement('img');
      oldImage.addEventListener('load', () => {
        const comparisonContent = compareImageElements(oldImage, newImage, msg, width, height);
        callback(comparisonContent);
      });
      oldImage.src = imageA_URL;
    });
    newImage.src = imageB_URL;
  }
  window.compareImages = compareImages;
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpbWFnZVRvQ29udGV4dCIsImltYWdlIiwid2lkdGgiLCJoZWlnaHQiLCJjYW52YXMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsImRyYXdJbWFnZSIsImNvbnRleHRUb0RhdGEiLCJnZXRJbWFnZURhdGEiLCJkYXRhVG9DYW52YXMiLCJkYXRhIiwicHV0SW1hZ2VEYXRhIiwiY29tcGFyZUltYWdlRWxlbWVudHMiLCJpbWFnZUEiLCJpbWFnZUIiLCJtc2ciLCJ0aHJlc2hvbGQiLCJhIiwiYiIsImxhcmdlc3REaWZmZXJlbmNlIiwidG90YWxEaWZmZXJlbmNlIiwiY29sb3JEaWZmRGF0YSIsImNyZWF0ZUltYWdlRGF0YSIsImFscGhhRGlmZkRhdGEiLCJpIiwibGVuZ3RoIiwiZGlmZiIsIk1hdGgiLCJhYnMiLCJhbHBoYUluZGV4IiwiYWxwaGFNdWx0aXBsaWVkRGlmZiIsIm1heCIsImF2ZXJhZ2VEaWZmZXJlbmNlIiwiY29udGFpbmVyIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUZXh0Tm9kZSIsImNvbXBhcmVJbWFnZXMiLCJpbWFnZUFfVVJMIiwiaW1hZ2VCX1VSTCIsImNhbGxiYWNrIiwibmV3SW1hZ2UiLCJhZGRFdmVudExpc3RlbmVyIiwib2xkSW1hZ2UiLCJjb21wYXJpc29uQ29udGVudCIsInNyYyIsIndpbmRvdyJdLCJzb3VyY2VzIjpbImltYWdlLWNvbXBhcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEZ1bmN0aW9ucyBzdXBwb3J0aW5nIHRha2luZyB0d28gaW1hZ2UgZGF0YSBVUkxzIGFuZCBjb21wYXJpbmcgdGhlbSwgYW5kIHByb3ZpZGluZyBhIFwiY29tcGFyaXNvblwiIGltYWdlIHRoYXQgc2hvd3NcclxuICogdGhlIGRpZmZlcmVuY2VzLiBJdCBhbHNvIHByb3ZpZGVzIG90aGVyIHN0YXRzIGluIHRoZSBkaXYgcmV0dXJuZWQgZnJvbSB0aGUgY2FsbGJhY2ssIHNlZSBjb21wYXJlSW1hZ2VzKCk7XHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICogQGF1dGhvciBNaWNoYWVsIEthdXptYW5uIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbiggKCkgPT4ge1xyXG5cclxuICBmdW5jdGlvbiBpbWFnZVRvQ29udGV4dCggaW1hZ2UsIHdpZHRoLCBoZWlnaHQgKSB7XHJcbiAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnY2FudmFzJyApO1xyXG4gICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCAnMmQnICk7XHJcbiAgICBjYW52YXMud2lkdGggPSB3aWR0aDtcclxuICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICBjb250ZXh0LmRyYXdJbWFnZSggaW1hZ2UsIDAsIDAgKTtcclxuICAgIHJldHVybiBjb250ZXh0O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY29udGV4dFRvRGF0YSggY29udGV4dCwgd2lkdGgsIGhlaWdodCApIHtcclxuICAgIHJldHVybiBjb250ZXh0LmdldEltYWdlRGF0YSggMCwgMCwgd2lkdGgsIGhlaWdodCApO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZGF0YVRvQ2FudmFzKCBkYXRhLCB3aWR0aCwgaGVpZ2h0ICkge1xyXG4gICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2NhbnZhcycgKTtcclxuICAgIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCggJzJkJyApO1xyXG4gICAgY2FudmFzLndpZHRoID0gd2lkdGg7XHJcbiAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgY29udGV4dC5wdXRJbWFnZURhdGEoIGRhdGEsIDAsIDAgKTtcclxuICAgIHJldHVybiBjYW52YXM7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjb21wYXJlSW1hZ2VFbGVtZW50cyggaW1hZ2VBLCBpbWFnZUIsIG1zZywgd2lkdGgsIGhlaWdodCApIHtcclxuICAgIGNvbnN0IHRocmVzaG9sZCA9IDA7XHJcbiAgICBjb25zdCBhID0gY29udGV4dFRvRGF0YSggaW1hZ2VUb0NvbnRleHQoIGltYWdlQSwgd2lkdGgsIGhlaWdodCApLCB3aWR0aCwgaGVpZ2h0ICk7XHJcbiAgICBjb25zdCBiID0gY29udGV4dFRvRGF0YSggaW1hZ2VUb0NvbnRleHQoIGltYWdlQiwgd2lkdGgsIGhlaWdodCApLCB3aWR0aCwgaGVpZ2h0ICk7XHJcblxyXG4gICAgbGV0IGxhcmdlc3REaWZmZXJlbmNlID0gMDtcclxuICAgIGxldCB0b3RhbERpZmZlcmVuY2UgPSAwO1xyXG4gICAgY29uc3QgY29sb3JEaWZmRGF0YSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdjYW52YXMnICkuZ2V0Q29udGV4dCggJzJkJyApLmNyZWF0ZUltYWdlRGF0YSggYS53aWR0aCwgYS5oZWlnaHQgKTtcclxuICAgIGNvbnN0IGFscGhhRGlmZkRhdGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnY2FudmFzJyApLmdldENvbnRleHQoICcyZCcgKS5jcmVhdGVJbWFnZURhdGEoIGEud2lkdGgsIGEuaGVpZ2h0ICk7XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBhLmRhdGEubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgIGNvbnN0IGRpZmYgPSBNYXRoLmFicyggYS5kYXRhWyBpIF0gLSBiLmRhdGFbIGkgXSApO1xyXG4gICAgICBpZiAoIGkgJSA0ID09PSAzICkge1xyXG4gICAgICAgIGNvbG9yRGlmZkRhdGEuZGF0YVsgaSBdID0gMjU1O1xyXG4gICAgICAgIGFscGhhRGlmZkRhdGEuZGF0YVsgaSBdID0gMjU1O1xyXG4gICAgICAgIGFscGhhRGlmZkRhdGEuZGF0YVsgaSAtIDMgXSA9IGRpZmY7IC8vIHJlZFxyXG4gICAgICAgIGFscGhhRGlmZkRhdGEuZGF0YVsgaSAtIDIgXSA9IGRpZmY7IC8vIGdyZWVuXHJcbiAgICAgICAgYWxwaGFEaWZmRGF0YS5kYXRhWyBpIC0gMSBdID0gZGlmZjsgLy8gYmx1ZVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbG9yRGlmZkRhdGEuZGF0YVsgaSBdID0gZGlmZjtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBhbHBoYUluZGV4ID0gKCBpIC0gKCBpICUgNCApICsgMyApO1xyXG4gICAgICAvLyBncmFiIHRoZSBhc3NvY2lhdGVkIGFscGhhIGNoYW5uZWwgYW5kIG11bHRpcGx5IGl0IHRpbWVzIHRoZSBkaWZmXHJcbiAgICAgIGNvbnN0IGFscGhhTXVsdGlwbGllZERpZmYgPSAoIGkgJSA0ID09PSAzICkgPyBkaWZmIDogZGlmZiAqICggYS5kYXRhWyBhbHBoYUluZGV4IF0gLyAyNTUgKSAqICggYi5kYXRhWyBhbHBoYUluZGV4IF0gLyAyNTUgKTtcclxuXHJcbiAgICAgIHRvdGFsRGlmZmVyZW5jZSArPSBhbHBoYU11bHRpcGxpZWREaWZmO1xyXG4gICAgICAvLyBpZiAoIGFscGhhTXVsdGlwbGllZERpZmYgPiB0aHJlc2hvbGQgKSB7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKCBtZXNzYWdlICsgJzogJyArIE1hdGguYWJzKCBhLmRhdGFbaV0gLSBiLmRhdGFbaV0gKSApO1xyXG4gICAgICBsYXJnZXN0RGlmZmVyZW5jZSA9IE1hdGgubWF4KCBsYXJnZXN0RGlmZmVyZW5jZSwgYWxwaGFNdWx0aXBsaWVkRGlmZiApO1xyXG4gICAgICAvLyBpc0VxdWFsID0gZmFsc2U7XHJcbiAgICAgIC8vIGJyZWFrO1xyXG4gICAgICAvLyB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXZlcmFnZURpZmZlcmVuY2UgPSB0b3RhbERpZmZlcmVuY2UgLyAoIDQgKiBhLndpZHRoICogYS5oZWlnaHQgKTtcclxuXHJcbiAgICBpZiAoIGF2ZXJhZ2VEaWZmZXJlbmNlID4gdGhyZXNob2xkICkge1xyXG4gICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xyXG5cclxuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSggYCR7bXNnfSwgbGFyZ2VzdDogJHtsYXJnZXN0RGlmZmVyZW5jZX0sIGF2ZXJhZ2U6ICR7YXZlcmFnZURpZmZlcmVuY2V9YCApICk7XHJcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2JyJyApICk7XHJcblxyXG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoIGRhdGFUb0NhbnZhcyggYSwgd2lkdGgsIGhlaWdodCApICk7XHJcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCggZGF0YVRvQ2FudmFzKCBiLCB3aWR0aCwgaGVpZ2h0ICkgKTtcclxuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKCBkYXRhVG9DYW52YXMoIGNvbG9yRGlmZkRhdGEsIHdpZHRoLCBoZWlnaHQgKSApO1xyXG4gICAgICAvLyBjb250YWluZXIuYXBwZW5kQ2hpbGQoIGRhdGFUb0NhbnZhcyggYWxwaGFEaWZmRGF0YSApICk7XHJcbiAgICAgIHJldHVybiBjb250YWluZXI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIC8vIGNhbGxiYWNrIHJldHVybnMgZWl0aGVyIG51bGwgb3IgdGhlIGRpdiB0aGF0IGNvbnRhaW5zIHRoZSBjb21wYXJpc29uIG9mIGltYWdlcyBzaG93aW5nIHRoZSBkaWZmZXJlbmNlLlxyXG4gIGZ1bmN0aW9uIGNvbXBhcmVJbWFnZXMoIGltYWdlQV9VUkwsIGltYWdlQl9VUkwsIG1zZywgd2lkdGgsIGhlaWdodCwgY2FsbGJhY2sgKSB7XHJcbiAgICBjb25zdCBuZXdJbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdpbWcnICk7XHJcbiAgICBuZXdJbWFnZS5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsICgpID0+IHtcclxuICAgICAgY29uc3Qgb2xkSW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnaW1nJyApO1xyXG4gICAgICBvbGRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsICgpID0+IHtcclxuICAgICAgICBjb25zdCBjb21wYXJpc29uQ29udGVudCA9IGNvbXBhcmVJbWFnZUVsZW1lbnRzKCBvbGRJbWFnZSwgbmV3SW1hZ2UsIG1zZywgd2lkdGgsIGhlaWdodCApO1xyXG4gICAgICAgIGNhbGxiYWNrKCBjb21wYXJpc29uQ29udGVudCApO1xyXG4gICAgICB9ICk7XHJcbiAgICAgIG9sZEltYWdlLnNyYyA9IGltYWdlQV9VUkw7XHJcbiAgICB9ICk7XHJcbiAgICBuZXdJbWFnZS5zcmMgPSBpbWFnZUJfVVJMO1xyXG4gIH1cclxuXHJcbiAgd2luZG93LmNvbXBhcmVJbWFnZXMgPSBjb21wYXJlSW1hZ2VzO1xyXG59ICkoKTtcclxuXHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLENBQUUsTUFBTTtFQUVOLFNBQVNBLGNBQWNBLENBQUVDLEtBQUssRUFBRUMsS0FBSyxFQUFFQyxNQUFNLEVBQUc7SUFDOUMsTUFBTUMsTUFBTSxHQUFHQyxRQUFRLENBQUNDLGFBQWEsQ0FBRSxRQUFTLENBQUM7SUFDakQsTUFBTUMsT0FBTyxHQUFHSCxNQUFNLENBQUNJLFVBQVUsQ0FBRSxJQUFLLENBQUM7SUFDekNKLE1BQU0sQ0FBQ0YsS0FBSyxHQUFHQSxLQUFLO0lBQ3BCRSxNQUFNLENBQUNELE1BQU0sR0FBR0EsTUFBTTtJQUN0QkksT0FBTyxDQUFDRSxTQUFTLENBQUVSLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBRSxDQUFDO0lBQ2hDLE9BQU9NLE9BQU87RUFDaEI7RUFFQSxTQUFTRyxhQUFhQSxDQUFFSCxPQUFPLEVBQUVMLEtBQUss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