// Copyright 2017-2023, University of Colorado Boulder

/**
 * Capable of running through sims in multiple passes (in-between code changes) to see if there is any behavioral change
 * in the sim resulting from that change.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

(function () {
  const req = new XMLHttpRequest();
  req.onload = function () {
    const simListText = req.responseText;

    // split string into an array of sim names, ignoring blank lines
    setup(simListText.trim().replace(/\r/g, '').split('\n'));
  };
  // location of active sims
  req.open('GET', '../../perennial/data/active-runnables', true);
  req.send();
})();
function setup(simNames) {
  const snapshots = [];
  window.snapshots = snapshots; // For debugging etc.
  let queue = [];
  let currentSnapshot;
  let currentSim;
  const options = QueryStringMachine.getAll({
    sims: {
      type: 'array',
      elementSchema: {
        type: 'string'
      },
      defaultValue: simNames
    },
    simSeed: {
      type: 'number',
      defaultValue: 4 // Ideal constant taken from https://xkcd.com/221/, DO NOT CHANGE, it's random!
    },

    simWidth: {
      type: 'number',
      defaultValue: 1024 / 4
    },
    simHeight: {
      type: 'number',
      defaultValue: 768 / 4
    },
    // Note: always assumed to be something?
    simQueryParameters: {
      type: 'string',
      defaultValue: 'brand=phet&ea'
    },
    numFrames: {
      type: 'number',
      defaultValue: 10
    },
    showTime: {
      type: 'boolean',
      defaultValue: true
    },
    compareDescription: {
      type: 'boolean',
      defaultValue: true
    }
  });
  const addBR = string => string + '<br/>';
  function comparePDOM(oldHTML, newHTML, message) {
    const container = document.createElement('div');
    comparisonDiv.appendChild(container);
    const diff = document.createElement('details');
    const summary = document.createElement('summary');
    summary.appendChild(document.createTextNode(`${message}: PDOMs different. Compare these two from webstorm diffing.`));
    diff.appendChild(summary);
    const diffGuts = document.createElement('div');
    const oldHTMLP = document.createElement('p');
    oldHTMLP.textContent = oldHTML;
    const newHTMLP = document.createElement('p');
    newHTMLP.textContent = newHTML;
    diffGuts.appendChild(oldHTMLP);
    diffGuts.appendChild(newHTMLP);
    diff.appendChild(diffGuts);
    diffGuts.style.fontSize = '4px';
    container.appendChild(diff);
  }
  function compareDescriptionAlerts(oldUtterances, newUtterances, message) {
    const onlyInOld = []; // Will hold all nodes that will be removed.
    const onlyInNew = []; // Will hold all nodes that will be "new" children (added)

    // Compute what things were added, removed, or stay.
    window.arrayDifference(oldUtterances, newUtterances, onlyInOld, onlyInNew, []);
    const diff = document.createElement('details');
    const summary = document.createElement('summary');
    summary.appendChild(document.createTextNode(`${message}: Utterances different. ${oldUtterances.length} vs ${newUtterances.length} utterances`));
    diff.appendChild(summary);
    const diffGuts = document.createElement('div');
    diff.appendChild(diffGuts);
    const oldHTMLP = document.createElement('p');
    oldHTMLP.innerHTML = `Only in old:<br/> ${onlyInOld.map(addBR)}`;
    const newHTMLP = document.createElement('p');
    newHTMLP.innerHTML = `Only in new:<br/> ${onlyInNew.map(addBR)}`;
    diffGuts.appendChild(oldHTMLP);
    diffGuts.appendChild(newHTMLP);
    comparisonDiv.appendChild(diff);
  }
  const iframe = document.createElement('iframe');
  iframe.setAttribute('frameborder', '0');
  iframe.setAttribute('seamless', '1');
  iframe.setAttribute('width', options.simWidth);
  iframe.setAttribute('height', options.simHeight);
  document.body.appendChild(iframe);
  const buttonsDiv = document.createElement('div');
  document.body.appendChild(buttonsDiv);
  const snapshotButton = document.createElement('button');
  snapshotButton.textContent = 'Start Snapshot';
  buttonsDiv.appendChild(snapshotButton);
  const clearComparisonsButton = document.createElement('button');
  clearComparisonsButton.textContent = 'Clear Comparisons';
  buttonsDiv.appendChild(clearComparisonsButton);
  const comparisonDiv = document.createElement('div');
  document.body.appendChild(comparisonDiv);
  clearComparisonsButton.addEventListener('click', () => {
    comparisonDiv.innerHTML = '';
  });
  const rowMap = {};
  const table = document.createElement('table');
  options.sims.forEach(sim => {
    const row = document.createElement('tr');
    rowMap[sim] = row;
    table.appendChild(row);
    const td = document.createElement('td');
    td.textContent = sim;
    row.appendChild(td);
  });
  document.body.appendChild(table);
  const childQueryParams = `simSeed=${encodeURIComponent(options.simSeed)}&simWidth=${encodeURIComponent(options.simWidth)}&simHeight=${encodeURIComponent(options.simHeight)}&simQueryParameters=${encodeURIComponent(options.simQueryParameters)}&numFrames=${encodeURIComponent(options.numFrames)}&compareDescription=${encodeURIComponent(options.compareDescription)}`;
  function loadSim(sim) {
    currentSim = sim;
    currentSnapshot[currentSim] = {
      frames: []
    };
    iframe.src = `take-snapshot.html?${childQueryParams}&url=${encodeURIComponent(`../../${sim}/${sim}_en.html`)}`;
  }
  function nextSim() {
    if (queue.length) {
      loadSim(queue.shift());
    }
  }
  let globalStartTime;
  function snapshot() {
    globalStartTime = Date.now();
    currentSnapshot = {};
    snapshots.push(currentSnapshot);
    queue = queue.concat(options.sims); // TODO: this should likely clear and reset, but since currentSnapshot is reset, everything left in the queue will be appended to the new snapshot. https://github.com/phetsims/aqua/issues/126
    nextSim();
  }
  snapshotButton.addEventListener('click', snapshot);
  window.addEventListener('message', evt => {
    if (typeof evt.data !== 'string') {
      return;
    }
    const data = JSON.parse(evt.data);
    if (data.type === 'frameEmitted') {
      // number, screenshot: { url, hash }
      currentSnapshot[currentSim].frames.push(data);
    } else if (data.type === 'snapshot') {
      // basically hash
      const sim = currentSim;
      const snapshot = currentSnapshot;
      snapshot[sim].hash = data.hash;
      const td = document.createElement('td');
      td.textContent = data.hash.slice(0, 6) + (options.showTime ? ` ${Date.now() - globalStartTime}` : '');
      if (snapshots.length > 1 && data.hash !== snapshots[snapshots.length - 2][sim].hash) {
        td.style.fontWeight = 'bold';
        td.style.cursor = 'pointer';
        td.addEventListener('click', () => {
          const newFrames = snapshot[sim].frames;
          const oldFrames = snapshots[snapshots.indexOf(snapshot) - 1][sim].frames;
          let nextIndex = 0;
          function compareNextFrame() {
            const index = nextIndex++;
            if (index < newFrames.length && index < oldFrames.length) {
              const oldFrame = oldFrames[index];
              const newFrame = newFrames[index];
              const dataFrameIndex = `Data Frame ${index}`;

              // support comparing the next data frame after this frame's screenshots have loaded (only when different)
              let compareNextFrameCalledFromScreenshot = false;

              // If this screenshot hash is different, then compare and display the difference in screenshots.
              if (oldFrame.screenshot.hash !== newFrame.screenshot.hash) {
                compareNextFrameCalledFromScreenshot = true;
                window.compareImages(oldFrames[index].screenshot.url, newFrames[index].screenshot.url, dataFrameIndex, options.simWidth, options.simHeight, comparisonDataDiv => {
                  comparisonDataDiv && comparisonDiv.appendChild(comparisonDataDiv);
                  compareNextFrame();
                });
              }

              // Compare description via PDOM html
              if (options.compareDescription && oldFrame.pdom.hash !== newFrame.pdom.hash) {
                comparePDOM(oldFrame.pdom.html, newFrame.pdom.html, dataFrameIndex);
              }
              // Compare description utterances
              if (options.compareDescription && oldFrame.descriptionAlert.hash !== newFrame.descriptionAlert.hash) {
                compareDescriptionAlerts(oldFrame.descriptionAlert.utterances, newFrame.descriptionAlert.utterances, `${dataFrameIndex}, Description`);
              }

              // Compare voicing utterances
              if (options.compareDescription && oldFrame.voicing.hash !== newFrame.voicing.hash) {
                compareDescriptionAlerts(oldFrame.voicing.utterances, newFrame.voicing.utterances, `${dataFrameIndex}, Voicing`);
              }

              // Kick off the next iteration if we aren't waiting for images to load
              !compareNextFrameCalledFromScreenshot && compareNextFrame();
            }
          }
          compareNextFrame();
        });
      }
      rowMap[sim].appendChild(td);
      nextSim();
    } else if (data.type === 'error') {
      const errorTd = document.createElement('td');
      errorTd.textContent = 'err';
      rowMap[currentSim].appendChild(errorTd);
      nextSim();
    }
  });
  snapshot();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXEiLCJYTUxIdHRwUmVxdWVzdCIsIm9ubG9hZCIsInNpbUxpc3RUZXh0IiwicmVzcG9uc2VUZXh0Iiwic2V0dXAiLCJ0cmltIiwicmVwbGFjZSIsInNwbGl0Iiwib3BlbiIsInNlbmQiLCJzaW1OYW1lcyIsInNuYXBzaG90cyIsIndpbmRvdyIsInF1ZXVlIiwiY3VycmVudFNuYXBzaG90IiwiY3VycmVudFNpbSIsIm9wdGlvbnMiLCJRdWVyeVN0cmluZ01hY2hpbmUiLCJnZXRBbGwiLCJzaW1zIiwidHlwZSIsImVsZW1lbnRTY2hlbWEiLCJkZWZhdWx0VmFsdWUiLCJzaW1TZWVkIiwic2ltV2lkdGgiLCJzaW1IZWlnaHQiLCJzaW1RdWVyeVBhcmFtZXRlcnMiLCJudW1GcmFtZXMiLCJzaG93VGltZSIsImNvbXBhcmVEZXNjcmlwdGlvbiIsImFkZEJSIiwic3RyaW5nIiwiY29tcGFyZVBET00iLCJvbGRIVE1MIiwibmV3SFRNTCIsIm1lc3NhZ2UiLCJjb250YWluZXIiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjb21wYXJpc29uRGl2IiwiYXBwZW5kQ2hpbGQiLCJkaWZmIiwic3VtbWFyeSIsImNyZWF0ZVRleHROb2RlIiwiZGlmZkd1dHMiLCJvbGRIVE1MUCIsInRleHRDb250ZW50IiwibmV3SFRNTFAiLCJzdHlsZSIsImZvbnRTaXplIiwiY29tcGFyZURlc2NyaXB0aW9uQWxlcnRzIiwib2xkVXR0ZXJhbmNlcyIsIm5ld1V0dGVyYW5jZXMiLCJvbmx5SW5PbGQiLCJvbmx5SW5OZXciLCJhcnJheURpZmZlcmVuY2UiLCJsZW5ndGgiLCJpbm5lckhUTUwiLCJtYXAiLCJpZnJhbWUiLCJzZXRBdHRyaWJ1dGUiLCJib2R5IiwiYnV0dG9uc0RpdiIsInNuYXBzaG90QnV0dG9uIiwiY2xlYXJDb21wYXJpc29uc0J1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyb3dNYXAiLCJ0YWJsZSIsImZvckVhY2giLCJzaW0iLCJyb3ciLCJ0ZCIsImNoaWxkUXVlcnlQYXJhbXMiLCJlbmNvZGVVUklDb21wb25lbnQiLCJsb2FkU2ltIiwiZnJhbWVzIiwic3JjIiwibmV4dFNpbSIsInNoaWZ0IiwiZ2xvYmFsU3RhcnRUaW1lIiwic25hcHNob3QiLCJEYXRlIiwibm93IiwicHVzaCIsImNvbmNhdCIsImV2dCIsImRhdGEiLCJKU09OIiwicGFyc2UiLCJoYXNoIiwic2xpY2UiLCJmb250V2VpZ2h0IiwiY3Vyc29yIiwibmV3RnJhbWVzIiwib2xkRnJhbWVzIiwiaW5kZXhPZiIsIm5leHRJbmRleCIsImNvbXBhcmVOZXh0RnJhbWUiLCJpbmRleCIsIm9sZEZyYW1lIiwibmV3RnJhbWUiLCJkYXRhRnJhbWVJbmRleCIsImNvbXBhcmVOZXh0RnJhbWVDYWxsZWRGcm9tU2NyZWVuc2hvdCIsInNjcmVlbnNob3QiLCJjb21wYXJlSW1hZ2VzIiwidXJsIiwiY29tcGFyaXNvbkRhdGFEaXYiLCJwZG9tIiwiaHRtbCIsImRlc2NyaXB0aW9uQWxlcnQiLCJ1dHRlcmFuY2VzIiwidm9pY2luZyIsImVycm9yVGQiXSwic291cmNlcyI6WyJzbmFwc2hvdC1jb21wYXJpc29uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE3LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIENhcGFibGUgb2YgcnVubmluZyB0aHJvdWdoIHNpbXMgaW4gbXVsdGlwbGUgcGFzc2VzIChpbi1iZXR3ZWVuIGNvZGUgY2hhbmdlcykgdG8gc2VlIGlmIHRoZXJlIGlzIGFueSBiZWhhdmlvcmFsIGNoYW5nZVxyXG4gKiBpbiB0aGUgc2ltIHJlc3VsdGluZyBmcm9tIHRoYXQgY2hhbmdlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcbiAgY29uc3QgcmVxID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgcmVxLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgY29uc3Qgc2ltTGlzdFRleHQgPSByZXEucmVzcG9uc2VUZXh0O1xyXG5cclxuICAgIC8vIHNwbGl0IHN0cmluZyBpbnRvIGFuIGFycmF5IG9mIHNpbSBuYW1lcywgaWdub3JpbmcgYmxhbmsgbGluZXNcclxuICAgIHNldHVwKCBzaW1MaXN0VGV4dC50cmltKCkucmVwbGFjZSggL1xcci9nLCAnJyApLnNwbGl0KCAnXFxuJyApICk7XHJcbiAgfTtcclxuICAvLyBsb2NhdGlvbiBvZiBhY3RpdmUgc2ltc1xyXG4gIHJlcS5vcGVuKCAnR0VUJywgJy4uLy4uL3BlcmVubmlhbC9kYXRhL2FjdGl2ZS1ydW5uYWJsZXMnLCB0cnVlICk7XHJcbiAgcmVxLnNlbmQoKTtcclxufSApKCk7XHJcblxyXG5mdW5jdGlvbiBzZXR1cCggc2ltTmFtZXMgKSB7XHJcbiAgY29uc3Qgc25hcHNob3RzID0gW107XHJcbiAgd2luZG93LnNuYXBzaG90cyA9IHNuYXBzaG90czsgLy8gRm9yIGRlYnVnZ2luZyBldGMuXHJcbiAgbGV0IHF1ZXVlID0gW107XHJcbiAgbGV0IGN1cnJlbnRTbmFwc2hvdDtcclxuICBsZXQgY3VycmVudFNpbTtcclxuXHJcbiAgY29uc3Qgb3B0aW9ucyA9IFF1ZXJ5U3RyaW5nTWFjaGluZS5nZXRBbGwoIHtcclxuICAgIHNpbXM6IHtcclxuICAgICAgdHlwZTogJ2FycmF5JyxcclxuICAgICAgZWxlbWVudFNjaGVtYTogeyB0eXBlOiAnc3RyaW5nJyB9LFxyXG4gICAgICBkZWZhdWx0VmFsdWU6IHNpbU5hbWVzXHJcbiAgICB9LFxyXG4gICAgc2ltU2VlZDoge1xyXG4gICAgICB0eXBlOiAnbnVtYmVyJyxcclxuICAgICAgZGVmYXVsdFZhbHVlOiA0IC8vIElkZWFsIGNvbnN0YW50IHRha2VuIGZyb20gaHR0cHM6Ly94a2NkLmNvbS8yMjEvLCBETyBOT1QgQ0hBTkdFLCBpdCdzIHJhbmRvbSFcclxuICAgIH0sXHJcbiAgICBzaW1XaWR0aDoge1xyXG4gICAgICB0eXBlOiAnbnVtYmVyJyxcclxuICAgICAgZGVmYXVsdFZhbHVlOiAxMDI0IC8gNFxyXG4gICAgfSxcclxuICAgIHNpbUhlaWdodDoge1xyXG4gICAgICB0eXBlOiAnbnVtYmVyJyxcclxuICAgICAgZGVmYXVsdFZhbHVlOiA3NjggLyA0XHJcbiAgICB9LFxyXG4gICAgLy8gTm90ZTogYWx3YXlzIGFzc3VtZWQgdG8gYmUgc29tZXRoaW5nP1xyXG4gICAgc2ltUXVlcnlQYXJhbWV0ZXJzOiB7XHJcbiAgICAgIHR5cGU6ICdzdHJpbmcnLFxyXG4gICAgICBkZWZhdWx0VmFsdWU6ICdicmFuZD1waGV0JmVhJ1xyXG4gICAgfSxcclxuICAgIG51bUZyYW1lczoge1xyXG4gICAgICB0eXBlOiAnbnVtYmVyJyxcclxuICAgICAgZGVmYXVsdFZhbHVlOiAxMFxyXG4gICAgfSxcclxuICAgIHNob3dUaW1lOiB7XHJcbiAgICAgIHR5cGU6ICdib29sZWFuJyxcclxuICAgICAgZGVmYXVsdFZhbHVlOiB0cnVlXHJcbiAgICB9LFxyXG4gICAgY29tcGFyZURlc2NyaXB0aW9uOiB7XHJcbiAgICAgIHR5cGU6ICdib29sZWFuJyxcclxuICAgICAgZGVmYXVsdFZhbHVlOiB0cnVlXHJcbiAgICB9XHJcbiAgfSApO1xyXG5cclxuICBjb25zdCBhZGRCUiA9IHN0cmluZyA9PiBzdHJpbmcgKyAnPGJyLz4nO1xyXG5cclxuICBmdW5jdGlvbiBjb21wYXJlUERPTSggb2xkSFRNTCwgbmV3SFRNTCwgbWVzc2FnZSApIHtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7XHJcbiAgICBjb21wYXJpc29uRGl2LmFwcGVuZENoaWxkKCBjb250YWluZXIgKTtcclxuXHJcbiAgICBjb25zdCBkaWZmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RldGFpbHMnICk7XHJcbiAgICBjb25zdCBzdW1tYXJ5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3N1bW1hcnknICk7XHJcbiAgICBzdW1tYXJ5LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSggYCR7bWVzc2FnZX06IFBET01zIGRpZmZlcmVudC4gQ29tcGFyZSB0aGVzZSB0d28gZnJvbSB3ZWJzdG9ybSBkaWZmaW5nLmAgKSApO1xyXG4gICAgZGlmZi5hcHBlbmRDaGlsZCggc3VtbWFyeSApO1xyXG4gICAgY29uc3QgZGlmZkd1dHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xyXG4gICAgY29uc3Qgb2xkSFRNTFAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAncCcgKTtcclxuICAgIG9sZEhUTUxQLnRleHRDb250ZW50ID0gb2xkSFRNTDtcclxuICAgIGNvbnN0IG5ld0hUTUxQID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3AnICk7XHJcbiAgICBuZXdIVE1MUC50ZXh0Q29udGVudCA9IG5ld0hUTUw7XHJcbiAgICBkaWZmR3V0cy5hcHBlbmRDaGlsZCggb2xkSFRNTFAgKTtcclxuICAgIGRpZmZHdXRzLmFwcGVuZENoaWxkKCBuZXdIVE1MUCApO1xyXG5cclxuICAgIGRpZmYuYXBwZW5kQ2hpbGQoIGRpZmZHdXRzICk7XHJcbiAgICBkaWZmR3V0cy5zdHlsZS5mb250U2l6ZSA9ICc0cHgnO1xyXG5cclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCggZGlmZiApO1xyXG5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXBhcmVEZXNjcmlwdGlvbkFsZXJ0cyggb2xkVXR0ZXJhbmNlcywgbmV3VXR0ZXJhbmNlcywgbWVzc2FnZSApIHtcclxuXHJcbiAgICBjb25zdCBvbmx5SW5PbGQgPSBbXTsgLy8gV2lsbCBob2xkIGFsbCBub2RlcyB0aGF0IHdpbGwgYmUgcmVtb3ZlZC5cclxuICAgIGNvbnN0IG9ubHlJbk5ldyA9IFtdOyAvLyBXaWxsIGhvbGQgYWxsIG5vZGVzIHRoYXQgd2lsbCBiZSBcIm5ld1wiIGNoaWxkcmVuIChhZGRlZClcclxuXHJcbiAgICAvLyBDb21wdXRlIHdoYXQgdGhpbmdzIHdlcmUgYWRkZWQsIHJlbW92ZWQsIG9yIHN0YXkuXHJcbiAgICB3aW5kb3cuYXJyYXlEaWZmZXJlbmNlKCBvbGRVdHRlcmFuY2VzLCBuZXdVdHRlcmFuY2VzLCBvbmx5SW5PbGQsIG9ubHlJbk5ldywgW10gKTtcclxuXHJcbiAgICBjb25zdCBkaWZmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RldGFpbHMnICk7XHJcbiAgICBjb25zdCBzdW1tYXJ5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3N1bW1hcnknICk7XHJcbiAgICBzdW1tYXJ5LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSggYCR7bWVzc2FnZX06IFV0dGVyYW5jZXMgZGlmZmVyZW50LiAke29sZFV0dGVyYW5jZXMubGVuZ3RofSB2cyAke25ld1V0dGVyYW5jZXMubGVuZ3RofSB1dHRlcmFuY2VzYCApICk7XHJcbiAgICBkaWZmLmFwcGVuZENoaWxkKCBzdW1tYXJ5ICk7XHJcbiAgICBjb25zdCBkaWZmR3V0cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7XHJcbiAgICBkaWZmLmFwcGVuZENoaWxkKCBkaWZmR3V0cyApO1xyXG4gICAgY29uc3Qgb2xkSFRNTFAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAncCcgKTtcclxuICAgIG9sZEhUTUxQLmlubmVySFRNTCA9IGBPbmx5IGluIG9sZDo8YnIvPiAke29ubHlJbk9sZC5tYXAoIGFkZEJSICl9YDtcclxuICAgIGNvbnN0IG5ld0hUTUxQID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3AnICk7XHJcbiAgICBuZXdIVE1MUC5pbm5lckhUTUwgPSBgT25seSBpbiBuZXc6PGJyLz4gJHtvbmx5SW5OZXcubWFwKCBhZGRCUiApfWA7XHJcbiAgICBkaWZmR3V0cy5hcHBlbmRDaGlsZCggb2xkSFRNTFAgKTtcclxuICAgIGRpZmZHdXRzLmFwcGVuZENoaWxkKCBuZXdIVE1MUCApO1xyXG5cclxuICAgIGNvbXBhcmlzb25EaXYuYXBwZW5kQ2hpbGQoIGRpZmYgKTtcclxuXHJcbiAgfVxyXG5cclxuICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnaWZyYW1lJyApO1xyXG4gIGlmcmFtZS5zZXRBdHRyaWJ1dGUoICdmcmFtZWJvcmRlcicsICcwJyApO1xyXG4gIGlmcmFtZS5zZXRBdHRyaWJ1dGUoICdzZWFtbGVzcycsICcxJyApO1xyXG4gIGlmcmFtZS5zZXRBdHRyaWJ1dGUoICd3aWR0aCcsIG9wdGlvbnMuc2ltV2lkdGggKTtcclxuICBpZnJhbWUuc2V0QXR0cmlidXRlKCAnaGVpZ2h0Jywgb3B0aW9ucy5zaW1IZWlnaHQgKTtcclxuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCBpZnJhbWUgKTtcclxuXHJcbiAgY29uc3QgYnV0dG9uc0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7XHJcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggYnV0dG9uc0RpdiApO1xyXG5cclxuICBjb25zdCBzbmFwc2hvdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdidXR0b24nICk7XHJcbiAgc25hcHNob3RCdXR0b24udGV4dENvbnRlbnQgPSAnU3RhcnQgU25hcHNob3QnO1xyXG4gIGJ1dHRvbnNEaXYuYXBwZW5kQ2hpbGQoIHNuYXBzaG90QnV0dG9uICk7XHJcblxyXG4gIGNvbnN0IGNsZWFyQ29tcGFyaXNvbnNCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnYnV0dG9uJyApO1xyXG4gIGNsZWFyQ29tcGFyaXNvbnNCdXR0b24udGV4dENvbnRlbnQgPSAnQ2xlYXIgQ29tcGFyaXNvbnMnO1xyXG4gIGJ1dHRvbnNEaXYuYXBwZW5kQ2hpbGQoIGNsZWFyQ29tcGFyaXNvbnNCdXR0b24gKTtcclxuXHJcbiAgY29uc3QgY29tcGFyaXNvbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7XHJcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggY29tcGFyaXNvbkRpdiApO1xyXG4gIGNsZWFyQ29tcGFyaXNvbnNCdXR0b24uYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgKCkgPT4geyBjb21wYXJpc29uRGl2LmlubmVySFRNTCA9ICcnOyB9ICk7XHJcblxyXG4gIGNvbnN0IHJvd01hcCA9IHt9O1xyXG4gIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3RhYmxlJyApO1xyXG4gIG9wdGlvbnMuc2ltcy5mb3JFYWNoKCBzaW0gPT4ge1xyXG4gICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3RyJyApO1xyXG4gICAgcm93TWFwWyBzaW0gXSA9IHJvdztcclxuICAgIHRhYmxlLmFwcGVuZENoaWxkKCByb3cgKTtcclxuICAgIGNvbnN0IHRkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3RkJyApO1xyXG4gICAgdGQudGV4dENvbnRlbnQgPSBzaW07XHJcbiAgICByb3cuYXBwZW5kQ2hpbGQoIHRkICk7XHJcbiAgfSApO1xyXG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIHRhYmxlICk7XHJcblxyXG4gIGNvbnN0IGNoaWxkUXVlcnlQYXJhbXMgPVxyXG4gICAgYHNpbVNlZWQ9JHtlbmNvZGVVUklDb21wb25lbnQoIG9wdGlvbnMuc2ltU2VlZCApXHJcbiAgICB9JnNpbVdpZHRoPSR7ZW5jb2RlVVJJQ29tcG9uZW50KCBvcHRpb25zLnNpbVdpZHRoIClcclxuICAgIH0mc2ltSGVpZ2h0PSR7ZW5jb2RlVVJJQ29tcG9uZW50KCBvcHRpb25zLnNpbUhlaWdodCApXHJcbiAgICB9JnNpbVF1ZXJ5UGFyYW1ldGVycz0ke2VuY29kZVVSSUNvbXBvbmVudCggb3B0aW9ucy5zaW1RdWVyeVBhcmFtZXRlcnMgKVxyXG4gICAgfSZudW1GcmFtZXM9JHtlbmNvZGVVUklDb21wb25lbnQoIG9wdGlvbnMubnVtRnJhbWVzIClcclxuICAgIH0mY29tcGFyZURlc2NyaXB0aW9uPSR7ZW5jb2RlVVJJQ29tcG9uZW50KCBvcHRpb25zLmNvbXBhcmVEZXNjcmlwdGlvbiApfWA7XHJcblxyXG4gIGZ1bmN0aW9uIGxvYWRTaW0oIHNpbSApIHtcclxuICAgIGN1cnJlbnRTaW0gPSBzaW07XHJcbiAgICBjdXJyZW50U25hcHNob3RbIGN1cnJlbnRTaW0gXSA9IHtcclxuICAgICAgZnJhbWVzOiBbXVxyXG4gICAgfTtcclxuICAgIGlmcmFtZS5zcmMgPSBgdGFrZS1zbmFwc2hvdC5odG1sPyR7Y2hpbGRRdWVyeVBhcmFtc30mdXJsPSR7ZW5jb2RlVVJJQ29tcG9uZW50KCBgLi4vLi4vJHtzaW19LyR7c2ltfV9lbi5odG1sYCApfWA7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBuZXh0U2ltKCkge1xyXG4gICAgaWYgKCBxdWV1ZS5sZW5ndGggKSB7XHJcbiAgICAgIGxvYWRTaW0oIHF1ZXVlLnNoaWZ0KCkgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxldCBnbG9iYWxTdGFydFRpbWU7XHJcblxyXG4gIGZ1bmN0aW9uIHNuYXBzaG90KCkge1xyXG4gICAgZ2xvYmFsU3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIGN1cnJlbnRTbmFwc2hvdCA9IHt9O1xyXG4gICAgc25hcHNob3RzLnB1c2goIGN1cnJlbnRTbmFwc2hvdCApO1xyXG4gICAgcXVldWUgPSBxdWV1ZS5jb25jYXQoIG9wdGlvbnMuc2ltcyApOyAvLyBUT0RPOiB0aGlzIHNob3VsZCBsaWtlbHkgY2xlYXIgYW5kIHJlc2V0LCBidXQgc2luY2UgY3VycmVudFNuYXBzaG90IGlzIHJlc2V0LCBldmVyeXRoaW5nIGxlZnQgaW4gdGhlIHF1ZXVlIHdpbGwgYmUgYXBwZW5kZWQgdG8gdGhlIG5ldyBzbmFwc2hvdC4gaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2FxdWEvaXNzdWVzLzEyNlxyXG4gICAgbmV4dFNpbSgpO1xyXG4gIH1cclxuXHJcbiAgc25hcHNob3RCdXR0b24uYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgc25hcHNob3QgKTtcclxuXHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdtZXNzYWdlJywgZXZ0ID0+IHtcclxuICAgIGlmICggdHlwZW9mIGV2dC5kYXRhICE9PSAnc3RyaW5nJyApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKCBldnQuZGF0YSApO1xyXG5cclxuICAgIGlmICggZGF0YS50eXBlID09PSAnZnJhbWVFbWl0dGVkJyApIHtcclxuICAgICAgLy8gbnVtYmVyLCBzY3JlZW5zaG90OiB7IHVybCwgaGFzaCB9XHJcbiAgICAgIGN1cnJlbnRTbmFwc2hvdFsgY3VycmVudFNpbSBdLmZyYW1lcy5wdXNoKCBkYXRhICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggZGF0YS50eXBlID09PSAnc25hcHNob3QnICkge1xyXG4gICAgICAvLyBiYXNpY2FsbHkgaGFzaFxyXG4gICAgICBjb25zdCBzaW0gPSBjdXJyZW50U2ltO1xyXG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGN1cnJlbnRTbmFwc2hvdDtcclxuXHJcbiAgICAgIHNuYXBzaG90WyBzaW0gXS5oYXNoID0gZGF0YS5oYXNoO1xyXG4gICAgICBjb25zdCB0ZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICd0ZCcgKTtcclxuICAgICAgdGQudGV4dENvbnRlbnQgPSBkYXRhLmhhc2guc2xpY2UoIDAsIDYgKSArICggb3B0aW9ucy5zaG93VGltZSA/IGAgJHtEYXRlLm5vdygpIC0gZ2xvYmFsU3RhcnRUaW1lfWAgOiAnJyApO1xyXG4gICAgICBpZiAoIHNuYXBzaG90cy5sZW5ndGggPiAxICYmIGRhdGEuaGFzaCAhPT0gc25hcHNob3RzWyBzbmFwc2hvdHMubGVuZ3RoIC0gMiBdWyBzaW0gXS5oYXNoICkge1xyXG4gICAgICAgIHRkLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XHJcbiAgICAgICAgdGQuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xyXG4gICAgICAgIHRkLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgIGNvbnN0IG5ld0ZyYW1lcyA9IHNuYXBzaG90WyBzaW0gXS5mcmFtZXM7XHJcbiAgICAgICAgICBjb25zdCBvbGRGcmFtZXMgPSBzbmFwc2hvdHNbIHNuYXBzaG90cy5pbmRleE9mKCBzbmFwc2hvdCApIC0gMSBdWyBzaW0gXS5mcmFtZXM7XHJcblxyXG4gICAgICAgICAgbGV0IG5leHRJbmRleCA9IDA7XHJcblxyXG4gICAgICAgICAgZnVuY3Rpb24gY29tcGFyZU5leHRGcmFtZSgpIHtcclxuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBuZXh0SW5kZXgrKztcclxuICAgICAgICAgICAgaWYgKCBpbmRleCA8IG5ld0ZyYW1lcy5sZW5ndGggJiYgaW5kZXggPCBvbGRGcmFtZXMubGVuZ3RoICkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IG9sZEZyYW1lID0gb2xkRnJhbWVzWyBpbmRleCBdO1xyXG4gICAgICAgICAgICAgIGNvbnN0IG5ld0ZyYW1lID0gbmV3RnJhbWVzWyBpbmRleCBdO1xyXG5cclxuICAgICAgICAgICAgICBjb25zdCBkYXRhRnJhbWVJbmRleCA9IGBEYXRhIEZyYW1lICR7aW5kZXh9YDtcclxuXHJcbiAgICAgICAgICAgICAgLy8gc3VwcG9ydCBjb21wYXJpbmcgdGhlIG5leHQgZGF0YSBmcmFtZSBhZnRlciB0aGlzIGZyYW1lJ3Mgc2NyZWVuc2hvdHMgaGF2ZSBsb2FkZWQgKG9ubHkgd2hlbiBkaWZmZXJlbnQpXHJcbiAgICAgICAgICAgICAgbGV0IGNvbXBhcmVOZXh0RnJhbWVDYWxsZWRGcm9tU2NyZWVuc2hvdCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAvLyBJZiB0aGlzIHNjcmVlbnNob3QgaGFzaCBpcyBkaWZmZXJlbnQsIHRoZW4gY29tcGFyZSBhbmQgZGlzcGxheSB0aGUgZGlmZmVyZW5jZSBpbiBzY3JlZW5zaG90cy5cclxuICAgICAgICAgICAgICBpZiAoIG9sZEZyYW1lLnNjcmVlbnNob3QuaGFzaCAhPT0gbmV3RnJhbWUuc2NyZWVuc2hvdC5oYXNoICkge1xyXG4gICAgICAgICAgICAgICAgY29tcGFyZU5leHRGcmFtZUNhbGxlZEZyb21TY3JlZW5zaG90ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5jb21wYXJlSW1hZ2VzKCBvbGRGcmFtZXNbIGluZGV4IF0uc2NyZWVuc2hvdC51cmwsIG5ld0ZyYW1lc1sgaW5kZXggXS5zY3JlZW5zaG90LnVybCxcclxuICAgICAgICAgICAgICAgICAgZGF0YUZyYW1lSW5kZXgsIG9wdGlvbnMuc2ltV2lkdGgsIG9wdGlvbnMuc2ltSGVpZ2h0LCBjb21wYXJpc29uRGF0YURpdiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcGFyaXNvbkRhdGFEaXYgJiYgY29tcGFyaXNvbkRpdi5hcHBlbmRDaGlsZCggY29tcGFyaXNvbkRhdGFEaXYgKTtcclxuICAgICAgICAgICAgICAgICAgICBjb21wYXJlTmV4dEZyYW1lKCk7XHJcbiAgICAgICAgICAgICAgICAgIH0gKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIENvbXBhcmUgZGVzY3JpcHRpb24gdmlhIFBET00gaHRtbFxyXG4gICAgICAgICAgICAgIGlmICggb3B0aW9ucy5jb21wYXJlRGVzY3JpcHRpb24gJiYgb2xkRnJhbWUucGRvbS5oYXNoICE9PSBuZXdGcmFtZS5wZG9tLmhhc2ggKSB7XHJcbiAgICAgICAgICAgICAgICBjb21wYXJlUERPTSggb2xkRnJhbWUucGRvbS5odG1sLCBuZXdGcmFtZS5wZG9tLmh0bWwsIGRhdGFGcmFtZUluZGV4ICk7XHJcblxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAvLyBDb21wYXJlIGRlc2NyaXB0aW9uIHV0dGVyYW5jZXNcclxuICAgICAgICAgICAgICBpZiAoIG9wdGlvbnMuY29tcGFyZURlc2NyaXB0aW9uICYmIG9sZEZyYW1lLmRlc2NyaXB0aW9uQWxlcnQuaGFzaCAhPT0gbmV3RnJhbWUuZGVzY3JpcHRpb25BbGVydC5oYXNoICkge1xyXG4gICAgICAgICAgICAgICAgY29tcGFyZURlc2NyaXB0aW9uQWxlcnRzKCBvbGRGcmFtZS5kZXNjcmlwdGlvbkFsZXJ0LnV0dGVyYW5jZXMsIG5ld0ZyYW1lLmRlc2NyaXB0aW9uQWxlcnQudXR0ZXJhbmNlcywgYCR7ZGF0YUZyYW1lSW5kZXh9LCBEZXNjcmlwdGlvbmAgKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIENvbXBhcmUgdm9pY2luZyB1dHRlcmFuY2VzXHJcbiAgICAgICAgICAgICAgaWYgKCBvcHRpb25zLmNvbXBhcmVEZXNjcmlwdGlvbiAmJiBvbGRGcmFtZS52b2ljaW5nLmhhc2ggIT09IG5ld0ZyYW1lLnZvaWNpbmcuaGFzaCApIHtcclxuICAgICAgICAgICAgICAgIGNvbXBhcmVEZXNjcmlwdGlvbkFsZXJ0cyggb2xkRnJhbWUudm9pY2luZy51dHRlcmFuY2VzLCBuZXdGcmFtZS52b2ljaW5nLnV0dGVyYW5jZXMsIGAke2RhdGFGcmFtZUluZGV4fSwgVm9pY2luZ2AgKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIEtpY2sgb2ZmIHRoZSBuZXh0IGl0ZXJhdGlvbiBpZiB3ZSBhcmVuJ3Qgd2FpdGluZyBmb3IgaW1hZ2VzIHRvIGxvYWRcclxuICAgICAgICAgICAgICAhY29tcGFyZU5leHRGcmFtZUNhbGxlZEZyb21TY3JlZW5zaG90ICYmIGNvbXBhcmVOZXh0RnJhbWUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGNvbXBhcmVOZXh0RnJhbWUoKTtcclxuICAgICAgICB9ICk7XHJcbiAgICAgIH1cclxuICAgICAgcm93TWFwWyBzaW0gXS5hcHBlbmRDaGlsZCggdGQgKTtcclxuICAgICAgbmV4dFNpbSgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIGRhdGEudHlwZSA9PT0gJ2Vycm9yJyApIHtcclxuICAgICAgY29uc3QgZXJyb3JUZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICd0ZCcgKTtcclxuICAgICAgZXJyb3JUZC50ZXh0Q29udGVudCA9ICdlcnInO1xyXG4gICAgICByb3dNYXBbIGN1cnJlbnRTaW0gXS5hcHBlbmRDaGlsZCggZXJyb3JUZCApO1xyXG4gICAgICBuZXh0U2ltKCk7XHJcbiAgICB9XHJcbiAgfSApO1xyXG5cclxuICBzbmFwc2hvdCgpO1xyXG59XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBLENBQUUsWUFBVztFQUNYLE1BQU1BLEdBQUcsR0FBRyxJQUFJQyxjQUFjLENBQUMsQ0FBQztFQUNoQ0QsR0FBRyxDQUFDRSxNQUFNLEdBQUcsWUFBVztJQUN0QixNQUFNQyxXQUFXLEdBQUdILEdBQUcsQ0FBQ0ksWUFBWTs7SUFFcEM7SUFDQUMsS0FBSyxDQUFFRixXQUFXLENBQUNHLElBQUksQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBRSxLQUFLLEVBQUUsRUFBRyxDQUFDLENBQUNDLEtBQUssQ0FBRSxJQUFLLENBQUUsQ0FBQztFQUNoRSxDQUFDO0VBQ0Q7RUFDQVIsR0FBRyxDQUFDUyxJQUFJLENBQUUsS0FBSyxFQUFFLHVDQUF1QyxFQUFFLElBQUssQ0FBQztFQUNoRVQsR0FBRyxDQUFDVSxJQUFJLENBQUMsQ0FBQztBQUNaLENBQUMsRUFBRyxDQUFDO0FBRUwsU0FBU0wsS0FBS0EsQ0FBRU0sUUFBUSxFQUFHO0VBQ3pCLE1BQU1DLFNBQVMsR0FBRyxFQUFFO0VBQ3BCQyxNQUFNLENBQUNELFNBQVMsR0FBR0EsU0FBUyxDQUFDLENBQUM7RUFDOUIsSUFBSUUsS0FBSyxHQUFHLEVBQUU7RUFDZCxJQUFJQyxlQUFlO0VBQ25CLElBQUlDLFVBQVU7RUFFZCxNQUFNQyxPQUFPLEdBQUdDLGtCQUFrQixDQUFDQyxNQUFNLENBQUU7SUFDekNDLElBQUksRUFB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