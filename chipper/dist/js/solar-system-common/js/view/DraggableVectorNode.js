// Copyright 2023, University of Colorado Boulder

/**
 * Used to show the draggable velocity vectors.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author Aaron Davis (PhET Interactive Simulations)
 */

import { Shape } from '../../../kite/js/imports.js';
import PhetFont from '../../../scenery-phet/js/PhetFont.js';
import { Color, DragListener, InteractiveHighlighting, KeyboardDragListener, Path, Text } from '../../../scenery/js/imports.js';
import VectorNode from './VectorNode.js';
import Vector2 from '../../../dot/js/Vector2.js';
import optionize from '../../../phet-core/js/optionize.js';
import solarSystemCommon from '../solarSystemCommon.js';
import Vector2Property from '../../../dot/js/Vector2Property.js';
import NumberProperty from '../../../axon/js/NumberProperty.js';
import SoundClip from '../../../tambo/js/sound-generators/SoundClip.js';
import Grab_Sound_mp3 from '../../sounds/Grab_Sound_mp3.js';
import Release_Sound_mp3 from '../../sounds/Release_Sound_mp3.js';
import SolarSystemCommonConstants from '../SolarSystemCommonConstants.js';
import soundManager from '../../../tambo/js/soundManager.js';
export default class DraggableVectorNode extends VectorNode {
  constructor(body, transformProperty, visibleProperty, vectorProperty, basePositionProperty, scale, labelText, providedOptions) {
    const options = optionize()({
      snapToZero: true,
      minimumMagnitude: 10,
      maxMagnitudeProperty: null,
      soundViewNode: null,
      mapPosition: _.identity
    }, providedOptions);
    super(body, transformProperty, visibleProperty, vectorProperty, new NumberProperty(1.3), options);
    const dragClipOptions = {
      initialOutputLevel: 2 * SolarSystemCommonConstants.DEFAULT_SOUND_OUTPUT_LEVEL
    };
    this.grabClip = new SoundClip(Grab_Sound_mp3, dragClipOptions);
    this.releaseClip = new SoundClip(Release_Sound_mp3, dragClipOptions);
    if (options.soundViewNode) {
      soundManager.addSoundGenerator(this.grabClip, {
        associatedViewNode: options.soundViewNode
      });
      soundManager.addSoundGenerator(this.releaseClip, {
        associatedViewNode: options.soundViewNode
      });
    }
    const circleRadius = 18;
    const circleLineWidth = 3;
    const circleOuterRadius = circleRadius + circleLineWidth / 2;
    const accessibleName = 'Velocity Body ' + (body.index + 1);

    // a circle with text (a character) in the center, to help indicate what it represents
    // ("v" for velocity in this sim)
    const grabArea = new InteractivePath(Shape.circle(0, 0, circleRadius), {
      lineWidth: circleLineWidth,
      stroke: Color.lightGray,
      cursor: 'pointer',
      // pdom
      tagName: 'div',
      focusable: true,
      ariaLabel: accessibleName,
      // the screen reader Accessible Name
      innerContent: accessibleName,
      // needed to make it focusable in the PDOM
      ariaRole: 'application',
      focusHighlight: Shape.circle(0, 0, circleRadius * 1.3)
    });
    const text = new Text(labelText, {
      font: new PhetFont({
        size: 22,
        weight: 'bold'
      }),
      fill: Color.gray,
      maxWidth: 25
    });
    this.tipProperty.link(tip => {
      text.center = tip;
      grabArea.center = tip;
    });
    this.addChild(grabArea);
    this.addChild(text);

    // This represents the model coordinates of where the 'V' circle appears
    const vectorPositionProperty = new Vector2Property(vectorProperty.value.plus(basePositionProperty.value));
    vectorPositionProperty.lazyLink(vectorPosition => {
      const newVelocity = vectorPosition.subtract(basePositionProperty.value);
      if (newVelocity.magnitude < options.minimumMagnitude) {
        if (options.snapToZero) {
          vectorProperty.value = new Vector2(0, 0);
        } else {
          vectorProperty.value = newVelocity.withMagnitude(options.minimumMagnitude);
        }
      } else if (options.maxMagnitudeProperty && newVelocity.magnitude > options.maxMagnitudeProperty.value) {
        vectorProperty.value = newVelocity.withMagnitude(options.maxMagnitudeProperty.value);
      } else {
        vectorProperty.value = newVelocity;
      }
    });

    // Add the drag handler
    const start = () => {
      body.userControlledVelocityProperty.value = true;
      this.grabClip.play();
    };
    const end = () => {
      body.userControlledVelocityProperty.value = false;
      this.releaseClip.play();
    };
    const dragListener = new DragListener({
      transform: transformProperty,
      mapPosition: point => {
        return options.mapPosition(point, circleOuterRadius);
      },
      positionProperty: vectorPositionProperty,
      canStartPress: () => !body.userControlledVelocityProperty.value,
      start: () => {
        keyboardDragListener.interrupt();
        start();
      },
      end: end
    });
    grabArea.addInputListener(dragListener);
    // move behind the geometry created by the superclass
    grabArea.moveToBack();
    text.moveToBack();
    const keyboardDragListener = new KeyboardDragListener({
      positionProperty: vectorProperty,
      transform: transformProperty,
      dragVelocity: 450,
      shiftDragVelocity: 100,
      start: () => {
        dragListener.interrupt();
        start();
      },
      end: end
    });
    this.addInputListener(keyboardDragListener);
    this.disposeEmitter.addListener(() => {
      dragListener.dispose();
      keyboardDragListener.dispose();
      vectorPositionProperty.dispose();
      grabArea.dispose();
    });

    // For PhET-iO, when the node does not support input, don't show the drag circle
    const onInputEnabled = inputEnabled => {
      grabArea.visible = inputEnabled;
      text.visible = inputEnabled;
    };
    this.inputEnabledProperty.link(onInputEnabled);
    this.disposeDraggableVectorNode = () => {
      text.dispose();
      this.inputEnabledProperty.unlink(onInputEnabled);
      if (options.soundViewNode) {
        soundManager.removeSoundGenerator(this.grabClip);
        soundManager.removeSoundGenerator(this.releaseClip);
      }
      this.grabClip.dispose();
      this.releaseClip.dispose();
    };
  }
  dispose() {
    this.disposeDraggableVectorNode();
    super.dispose();
  }
}
class InteractivePath extends InteractiveHighlighting(Path) {
  constructor(shape, options) {
    super(shape, options);
  }
}
solarSystemCommon.register('DraggableVectorNode', DraggableVectorNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaGFwZSIsIlBoZXRGb250IiwiQ29sb3IiLCJEcmFnTGlzdGVuZXIiLCJJbnRlcmFjdGl2ZUhpZ2hsaWdodGluZyIsIktleWJvYXJkRHJhZ0xpc3RlbmVyIiwiUGF0aCIsIlRleHQiLCJWZWN0b3JOb2RlIiwiVmVjdG9yMiIsIm9wdGlvbml6ZSIsInNvbGFyU3lzdGVtQ29tbW9uIiwiVmVjdG9yMlByb3BlcnR5IiwiTnVtYmVyUHJvcGVydHkiLCJTb3VuZENsaXAiLCJHcmFiX1NvdW5kX21wMyIsIlJlbGVhc2VfU291bmRfbXAzIiwiU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMiLCJzb3VuZE1hbmFnZXIiLCJEcmFnZ2FibGVWZWN0b3JOb2RlIiwiY29uc3RydWN0b3IiLCJib2R5IiwidHJhbnNmb3JtUHJvcGVydHkiLCJ2aXNpYmxlUHJvcGVydHkiLCJ2ZWN0b3JQcm9wZXJ0eSIsImJhc2VQb3NpdGlvblByb3BlcnR5Iiwic2NhbGUiLCJsYWJlbFRleHQiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwic25hcFRvWmVybyIsIm1pbmltdW1NYWduaXR1ZGUiLCJtYXhNYWduaXR1ZGVQcm9wZXJ0eSIsInNvdW5kVmlld05vZGUiLCJtYXBQb3NpdGlvbiIsIl8iLCJpZGVudGl0eSIsImRyYWdDbGlwT3B0aW9ucyIsImluaXRpYWxPdXRwdXRMZXZlbCIsIkRFRkFVTFRfU09VTkRfT1VUUFVUX0xFVkVMIiwiZ3JhYkNsaXAiLCJyZWxlYXNlQ2xpcCIsImFkZFNvdW5kR2VuZXJhdG9yIiwiYXNzb2NpYXRlZFZpZXdOb2RlIiwiY2lyY2xlUmFkaXVzIiwiY2lyY2xlTGluZVdpZHRoIiwiY2lyY2xlT3V0ZXJSYWRpdXMiLCJhY2Nlc3NpYmxlTmFtZSIsImluZGV4IiwiZ3JhYkFyZWEiLCJJbnRlcmFjdGl2ZVBhdGgiLCJjaXJjbGUiLCJsaW5lV2lkdGgiLCJzdHJva2UiLCJsaWdodEdyYXkiLCJjdXJzb3IiLCJ0YWdOYW1lIiwiZm9jdXNhYmxlIiwiYXJpYUxhYmVsIiwiaW5uZXJDb250ZW50IiwiYXJpYVJvbGUiLCJmb2N1c0hpZ2hsaWdodCIsInRleHQiLCJmb250Iiwic2l6ZSIsIndlaWdodCIsImZpbGwiLCJncmF5IiwibWF4V2lkdGgiLCJ0aXBQcm9wZXJ0eSIsImxpbmsiLCJ0aXAiLCJjZW50ZXIiLCJhZGRDaGlsZCIsInZlY3RvclBvc2l0aW9uUHJvcGVydHkiLCJ2YWx1ZSIsInBsdXMiLCJsYXp5TGluayIsInZlY3RvclBvc2l0aW9uIiwibmV3VmVsb2NpdHkiLCJzdWJ0cmFjdCIsIm1hZ25pdHVkZSIsIndpdGhNYWduaXR1ZGUiLCJzdGFydCIsInVzZXJDb250cm9sbGVkVmVsb2NpdHlQcm9wZXJ0eSIsInBsYXkiLCJlbmQiLCJkcmFnTGlzdGVuZXIiLCJ0cmFuc2Zvcm0iLCJwb2ludCIsInBvc2l0aW9uUHJvcGVydHkiLCJjYW5TdGFydFByZXNzIiwia2V5Ym9hcmREcmFnTGlzdGVuZXIiLCJpbnRlcnJ1cHQiLCJhZGRJbnB1dExpc3RlbmVyIiwibW92ZVRvQmFjayIsImRyYWdWZWxvY2l0eSIsInNoaWZ0RHJhZ1ZlbG9jaXR5IiwiZGlzcG9zZUVtaXR0ZXIiLCJhZGRMaXN0ZW5lciIsImRpc3Bvc2UiLCJvbklucHV0RW5hYmxlZCIsImlucHV0RW5hYmxlZCIsInZpc2libGUiLCJpbnB1dEVuYWJsZWRQcm9wZXJ0eSIsImRpc3Bvc2VEcmFnZ2FibGVWZWN0b3JOb2RlIiwidW5saW5rIiwicmVtb3ZlU291bmRHZW5lcmF0b3IiLCJzaGFwZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRHJhZ2dhYmxlVmVjdG9yTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogVXNlZCB0byBzaG93IHRoZSBkcmFnZ2FibGUgdmVsb2NpdHkgdmVjdG9ycy5cclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBBYXJvbiBEYXZpcyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBDb2xvciwgRHJhZ0xpc3RlbmVyLCBJbnRlcmFjdGl2ZUhpZ2hsaWdodGluZywgS2V5Ym9hcmREcmFnTGlzdGVuZXIsIE5vZGUsIFBhdGgsIFBhdGhPcHRpb25zLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFZlY3Rvck5vZGUsIHsgVmVjdG9yTm9kZU9wdGlvbnMgfSBmcm9tICcuL1ZlY3Rvck5vZGUuanMnO1xyXG5pbXBvcnQgQm9keSBmcm9tICcuLi9tb2RlbC9Cb2R5LmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IHNvbGFyU3lzdGVtQ29tbW9uIGZyb20gJy4uL3NvbGFyU3lzdGVtQ29tbW9uLmpzJztcclxuaW1wb3J0IFZlY3RvcjJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9kb3QvanMvVmVjdG9yMlByb3BlcnR5LmpzJztcclxuaW1wb3J0IFRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1RQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBOdW1iZXJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL051bWJlclByb3BlcnR5LmpzJztcclxuaW1wb3J0IFNvdW5kQ2xpcCBmcm9tICcuLi8uLi8uLi90YW1iby9qcy9zb3VuZC1nZW5lcmF0b3JzL1NvdW5kQ2xpcC5qcyc7XHJcbmltcG9ydCBHcmFiX1NvdW5kX21wMyBmcm9tICcuLi8uLi9zb3VuZHMvR3JhYl9Tb3VuZF9tcDMuanMnO1xyXG5pbXBvcnQgUmVsZWFzZV9Tb3VuZF9tcDMgZnJvbSAnLi4vLi4vc291bmRzL1JlbGVhc2VfU291bmRfbXAzLmpzJztcclxuaW1wb3J0IFNvbGFyU3lzdGVtQ29tbW9uQ29uc3RhbnRzIGZyb20gJy4uL1NvbGFyU3lzdGVtQ29tbW9uQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IHNvdW5kTWFuYWdlciBmcm9tICcuLi8uLi8uLi90YW1iby9qcy9zb3VuZE1hbmFnZXIuanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuICBzbmFwVG9aZXJvPzogYm9vbGVhbjsgLy8gV2hlbiB0aGUgdXNlciBzZXRzIHRoZSB2ZWN0b3IncyBtYWduaXR1ZGUgdG8gbGVzcyB0aGFuIG1pbmltdW1NYWduaXR1ZGUsIGl0IHNuYXBzIHRvIHplcm9cclxuICBtaW5pbXVtTWFnbml0dWRlPzogbnVtYmVyOyAvLyBUaGUgbWluaW11bSBtYWduaXR1ZGUgb2YgdGhlIHZlY3RvclxyXG4gIG1heE1hZ25pdHVkZVByb3BlcnR5PzogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyPiB8IG51bGw7XHJcblxyXG4gIC8vIElmIGEgc291bmRWaWV3Tm9kZSBpcyBwcm92aWRlZCwgd2UnbGwgaG9vayB1cCBhIHNvdW5kQ2xpcCB0byBpdCBhbmQgcGxheSBzb3VuZHMgd2hlbiBpdCBpcyB2aXNpYmxlXHJcbiAgc291bmRWaWV3Tm9kZT86IE5vZGUgfCBudWxsO1xyXG5cclxuICAvLyBGb3IgZHJhZyBcImJvdW5kc1wiLWxpa2UgaGFuZGxpbmdcclxuICBtYXBQb3NpdGlvbj86ICggcG9zaXRpb246IFZlY3RvcjIsIHJhZGl1czogbnVtYmVyICkgPT4gVmVjdG9yMjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIERyYWdnYWJsZVZlY3Rvck5vZGVPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBWZWN0b3JOb2RlT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERyYWdnYWJsZVZlY3Rvck5vZGUgZXh0ZW5kcyBWZWN0b3JOb2RlIHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlRHJhZ2dhYmxlVmVjdG9yTm9kZTogKCkgPT4gdm9pZDtcclxuICBwdWJsaWMgcmVhZG9ubHkgZ3JhYkNsaXA6IFNvdW5kQ2xpcDtcclxuICBwdWJsaWMgcmVhZG9ubHkgcmVsZWFzZUNsaXA6IFNvdW5kQ2xpcDtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKFxyXG4gICAgYm9keTogQm9keSxcclxuICAgIHRyYW5zZm9ybVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxNb2RlbFZpZXdUcmFuc2Zvcm0yPixcclxuICAgIHZpc2libGVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj4sXHJcbiAgICB2ZWN0b3JQcm9wZXJ0eTogVFByb3BlcnR5PFZlY3RvcjI+LFxyXG4gICAgYmFzZVBvc2l0aW9uUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFZlY3RvcjI+LFxyXG4gICAgc2NhbGU6IG51bWJlcixcclxuICAgIGxhYmVsVGV4dDogVFJlYWRPbmx5UHJvcGVydHk8c3RyaW5nPixcclxuICAgIHByb3ZpZGVkT3B0aW9ucz86IERyYWdnYWJsZVZlY3Rvck5vZGVPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8RHJhZ2dhYmxlVmVjdG9yTm9kZU9wdGlvbnMsIFNlbGZPcHRpb25zLCBWZWN0b3JOb2RlT3B0aW9ucz4oKSgge1xyXG4gICAgICBzbmFwVG9aZXJvOiB0cnVlLFxyXG4gICAgICBtaW5pbXVtTWFnbml0dWRlOiAxMCxcclxuICAgICAgbWF4TWFnbml0dWRlUHJvcGVydHk6IG51bGwsXHJcblxyXG4gICAgICBzb3VuZFZpZXdOb2RlOiBudWxsLFxyXG4gICAgICBtYXBQb3NpdGlvbjogXy5pZGVudGl0eVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoXHJcbiAgICAgIGJvZHksXHJcbiAgICAgIHRyYW5zZm9ybVByb3BlcnR5LFxyXG4gICAgICB2aXNpYmxlUHJvcGVydHksXHJcbiAgICAgIHZlY3RvclByb3BlcnR5LFxyXG4gICAgICBuZXcgTnVtYmVyUHJvcGVydHkoIDEuMyApLFxyXG4gICAgICBvcHRpb25zXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IGRyYWdDbGlwT3B0aW9ucyA9IHtcclxuICAgICAgaW5pdGlhbE91dHB1dExldmVsOiAyICogU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMuREVGQVVMVF9TT1VORF9PVVRQVVRfTEVWRUxcclxuICAgIH07XHJcbiAgICB0aGlzLmdyYWJDbGlwID0gbmV3IFNvdW5kQ2xpcCggR3JhYl9Tb3VuZF9tcDMsIGRyYWdDbGlwT3B0aW9ucyApO1xyXG4gICAgdGhpcy5yZWxlYXNlQ2xpcCA9IG5ldyBTb3VuZENsaXAoIFJlbGVhc2VfU291bmRfbXAzLCBkcmFnQ2xpcE9wdGlvbnMgKTtcclxuXHJcbiAgICBpZiAoIG9wdGlvbnMuc291bmRWaWV3Tm9kZSApIHtcclxuICAgICAgc291bmRNYW5hZ2VyLmFkZFNvdW5kR2VuZXJhdG9yKCB0aGlzLmdyYWJDbGlwLCB7XHJcbiAgICAgICAgYXNzb2NpYXRlZFZpZXdOb2RlOiBvcHRpb25zLnNvdW5kVmlld05vZGVcclxuICAgICAgfSApO1xyXG4gICAgICBzb3VuZE1hbmFnZXIuYWRkU291bmRHZW5lcmF0b3IoIHRoaXMucmVsZWFzZUNsaXAsIHtcclxuICAgICAgICBhc3NvY2lhdGVkVmlld05vZGU6IG9wdGlvbnMuc291bmRWaWV3Tm9kZVxyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2lyY2xlUmFkaXVzID0gMTg7XHJcbiAgICBjb25zdCBjaXJjbGVMaW5lV2lkdGggPSAzO1xyXG4gICAgY29uc3QgY2lyY2xlT3V0ZXJSYWRpdXMgPSBjaXJjbGVSYWRpdXMgKyBjaXJjbGVMaW5lV2lkdGggLyAyO1xyXG5cclxuICAgIGNvbnN0IGFjY2Vzc2libGVOYW1lID0gJ1ZlbG9jaXR5IEJvZHkgJyArICggYm9keS5pbmRleCArIDEgKTtcclxuXHJcbiAgICAvLyBhIGNpcmNsZSB3aXRoIHRleHQgKGEgY2hhcmFjdGVyKSBpbiB0aGUgY2VudGVyLCB0byBoZWxwIGluZGljYXRlIHdoYXQgaXQgcmVwcmVzZW50c1xyXG4gICAgLy8gKFwidlwiIGZvciB2ZWxvY2l0eSBpbiB0aGlzIHNpbSlcclxuICAgIGNvbnN0IGdyYWJBcmVhID0gbmV3IEludGVyYWN0aXZlUGF0aCggU2hhcGUuY2lyY2xlKCAwLCAwLCBjaXJjbGVSYWRpdXMgKSwge1xyXG4gICAgICBsaW5lV2lkdGg6IGNpcmNsZUxpbmVXaWR0aCxcclxuICAgICAgc3Ryb2tlOiBDb2xvci5saWdodEdyYXksXHJcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG5cclxuICAgICAgLy8gcGRvbVxyXG4gICAgICB0YWdOYW1lOiAnZGl2JyxcclxuICAgICAgZm9jdXNhYmxlOiB0cnVlLFxyXG4gICAgICBhcmlhTGFiZWw6IGFjY2Vzc2libGVOYW1lLCAvLyB0aGUgc2NyZWVuIHJlYWRlciBBY2Nlc3NpYmxlIE5hbWVcclxuICAgICAgaW5uZXJDb250ZW50OiBhY2Nlc3NpYmxlTmFtZSwgLy8gbmVlZGVkIHRvIG1ha2UgaXQgZm9jdXNhYmxlIGluIHRoZSBQRE9NXHJcbiAgICAgIGFyaWFSb2xlOiAnYXBwbGljYXRpb24nLFxyXG4gICAgICBmb2N1c0hpZ2hsaWdodDogU2hhcGUuY2lyY2xlKCAwLCAwLCBjaXJjbGVSYWRpdXMgKiAxLjMgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHRleHQgPSBuZXcgVGV4dCggbGFiZWxUZXh0LCB7XHJcbiAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggeyBzaXplOiAyMiwgd2VpZ2h0OiAnYm9sZCcgfSApLFxyXG4gICAgICBmaWxsOiBDb2xvci5ncmF5LFxyXG4gICAgICBtYXhXaWR0aDogMjVcclxuICAgIH0gKTtcclxuICAgIHRoaXMudGlwUHJvcGVydHkubGluayggdGlwID0+IHtcclxuICAgICAgdGV4dC5jZW50ZXIgPSB0aXA7XHJcbiAgICAgIGdyYWJBcmVhLmNlbnRlciA9IHRpcDtcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKCBncmFiQXJlYSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGV4dCApO1xyXG5cclxuICAgIC8vIFRoaXMgcmVwcmVzZW50cyB0aGUgbW9kZWwgY29vcmRpbmF0ZXMgb2Ygd2hlcmUgdGhlICdWJyBjaXJjbGUgYXBwZWFyc1xyXG4gICAgY29uc3QgdmVjdG9yUG9zaXRpb25Qcm9wZXJ0eSA9IG5ldyBWZWN0b3IyUHJvcGVydHkoIHZlY3RvclByb3BlcnR5LnZhbHVlLnBsdXMoIGJhc2VQb3NpdGlvblByb3BlcnR5LnZhbHVlICkgKTtcclxuICAgIHZlY3RvclBvc2l0aW9uUHJvcGVydHkubGF6eUxpbmsoIHZlY3RvclBvc2l0aW9uID0+IHtcclxuICAgICAgY29uc3QgbmV3VmVsb2NpdHkgPSB2ZWN0b3JQb3NpdGlvbi5zdWJ0cmFjdCggYmFzZVBvc2l0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICAgICAgaWYgKCBuZXdWZWxvY2l0eS5tYWduaXR1ZGUgPCBvcHRpb25zLm1pbmltdW1NYWduaXR1ZGUgKSB7XHJcbiAgICAgICAgaWYgKCBvcHRpb25zLnNuYXBUb1plcm8gKSB7XHJcbiAgICAgICAgICB2ZWN0b3JQcm9wZXJ0eS52YWx1ZSA9IG5ldyBWZWN0b3IyKCAwLCAwICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgdmVjdG9yUHJvcGVydHkudmFsdWUgPSBuZXdWZWxvY2l0eS53aXRoTWFnbml0dWRlKCBvcHRpb25zLm1pbmltdW1NYWduaXR1ZGUgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIG9wdGlvbnMubWF4TWFnbml0dWRlUHJvcGVydHkgJiYgbmV3VmVsb2NpdHkubWFnbml0dWRlID4gb3B0aW9ucy5tYXhNYWduaXR1ZGVQcm9wZXJ0eS52YWx1ZSApIHtcclxuICAgICAgICB2ZWN0b3JQcm9wZXJ0eS52YWx1ZSA9IG5ld1ZlbG9jaXR5LndpdGhNYWduaXR1ZGUoIG9wdGlvbnMubWF4TWFnbml0dWRlUHJvcGVydHkudmFsdWUgKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB2ZWN0b3JQcm9wZXJ0eS52YWx1ZSA9IG5ld1ZlbG9jaXR5O1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBkcmFnIGhhbmRsZXJcclxuICAgIGNvbnN0IHN0YXJ0ID0gKCkgPT4ge1xyXG4gICAgICBib2R5LnVzZXJDb250cm9sbGVkVmVsb2NpdHlQcm9wZXJ0eS52YWx1ZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZ3JhYkNsaXAucGxheSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGVuZCA9ICgpID0+IHtcclxuICAgICAgYm9keS51c2VyQ29udHJvbGxlZFZlbG9jaXR5UHJvcGVydHkudmFsdWUgPSBmYWxzZTtcclxuICAgICAgdGhpcy5yZWxlYXNlQ2xpcC5wbGF5KCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGRyYWdMaXN0ZW5lciA9IG5ldyBEcmFnTGlzdGVuZXIoIHtcclxuICAgICAgdHJhbnNmb3JtOiB0cmFuc2Zvcm1Qcm9wZXJ0eSxcclxuICAgICAgbWFwUG9zaXRpb246IHBvaW50ID0+IHtcclxuICAgICAgICByZXR1cm4gb3B0aW9ucy5tYXBQb3NpdGlvbiggcG9pbnQsIGNpcmNsZU91dGVyUmFkaXVzICk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHBvc2l0aW9uUHJvcGVydHk6IHZlY3RvclBvc2l0aW9uUHJvcGVydHksXHJcbiAgICAgIGNhblN0YXJ0UHJlc3M6ICgpID0+ICFib2R5LnVzZXJDb250cm9sbGVkVmVsb2NpdHlQcm9wZXJ0eS52YWx1ZSxcclxuICAgICAgc3RhcnQ6ICgpID0+IHtcclxuICAgICAgICBrZXlib2FyZERyYWdMaXN0ZW5lci5pbnRlcnJ1cHQoKTtcclxuICAgICAgICBzdGFydCgpO1xyXG4gICAgICB9LFxyXG4gICAgICBlbmQ6IGVuZFxyXG4gICAgfSApO1xyXG4gICAgZ3JhYkFyZWEuYWRkSW5wdXRMaXN0ZW5lciggZHJhZ0xpc3RlbmVyICk7XHJcbiAgICAvLyBtb3ZlIGJlaGluZCB0aGUgZ2VvbWV0cnkgY3JlYXRlZCBieSB0aGUgc3VwZXJjbGFzc1xyXG4gICAgZ3JhYkFyZWEubW92ZVRvQmFjaygpO1xyXG4gICAgdGV4dC5tb3ZlVG9CYWNrKCk7XHJcblxyXG4gICAgY29uc3Qga2V5Ym9hcmREcmFnTGlzdGVuZXIgPSBuZXcgS2V5Ym9hcmREcmFnTGlzdGVuZXIoIHtcclxuICAgICAgcG9zaXRpb25Qcm9wZXJ0eTogdmVjdG9yUHJvcGVydHksXHJcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNmb3JtUHJvcGVydHksXHJcbiAgICAgIGRyYWdWZWxvY2l0eTogNDUwLFxyXG4gICAgICBzaGlmdERyYWdWZWxvY2l0eTogMTAwLFxyXG4gICAgICBzdGFydDogKCkgPT4ge1xyXG4gICAgICAgIGRyYWdMaXN0ZW5lci5pbnRlcnJ1cHQoKTtcclxuICAgICAgICBzdGFydCgpO1xyXG4gICAgICB9LFxyXG4gICAgICBlbmQ6IGVuZFxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCBrZXlib2FyZERyYWdMaXN0ZW5lciApO1xyXG5cclxuICAgIHRoaXMuZGlzcG9zZUVtaXR0ZXIuYWRkTGlzdGVuZXIoICgpID0+IHtcclxuICAgICAgZHJhZ0xpc3RlbmVyLmRpc3Bvc2UoKTtcclxuICAgICAga2V5Ym9hcmREcmFnTGlzdGVuZXIuZGlzcG9zZSgpO1xyXG4gICAgICB2ZWN0b3JQb3NpdGlvblByb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgZ3JhYkFyZWEuZGlzcG9zZSgpO1xyXG4gICAgfSApO1xyXG5cclxuXHJcbiAgICAvLyBGb3IgUGhFVC1pTywgd2hlbiB0aGUgbm9kZSBkb2VzIG5vdCBzdXBwb3J0IGlucHV0LCBkb24ndCBzaG93IHRoZSBkcmFnIGNpcmNsZVxyXG4gICAgY29uc3Qgb25JbnB1dEVuYWJsZWQgPSAoIGlucHV0RW5hYmxlZDogYm9vbGVhbiApID0+IHtcclxuICAgICAgZ3JhYkFyZWEudmlzaWJsZSA9IGlucHV0RW5hYmxlZDtcclxuICAgICAgdGV4dC52aXNpYmxlID0gaW5wdXRFbmFibGVkO1xyXG4gICAgfTtcclxuICAgIHRoaXMuaW5wdXRFbmFibGVkUHJvcGVydHkubGluayggb25JbnB1dEVuYWJsZWQgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VEcmFnZ2FibGVWZWN0b3JOb2RlID0gKCkgPT4ge1xyXG4gICAgICB0ZXh0LmRpc3Bvc2UoKTtcclxuXHJcbiAgICAgIHRoaXMuaW5wdXRFbmFibGVkUHJvcGVydHkudW5saW5rKCBvbklucHV0RW5hYmxlZCApO1xyXG5cclxuICAgICAgaWYgKCBvcHRpb25zLnNvdW5kVmlld05vZGUgKSB7XHJcbiAgICAgICAgc291bmRNYW5hZ2VyLnJlbW92ZVNvdW5kR2VuZXJhdG9yKCB0aGlzLmdyYWJDbGlwICk7XHJcbiAgICAgICAgc291bmRNYW5hZ2VyLnJlbW92ZVNvdW5kR2VuZXJhdG9yKCB0aGlzLnJlbGVhc2VDbGlwICk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5ncmFiQ2xpcC5kaXNwb3NlKCk7XHJcbiAgICAgIHRoaXMucmVsZWFzZUNsaXAuZGlzcG9zZSgpO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5kaXNwb3NlRHJhZ2dhYmxlVmVjdG9yTm9kZSgpO1xyXG5cclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbmNsYXNzIEludGVyYWN0aXZlUGF0aCBleHRlbmRzIEludGVyYWN0aXZlSGlnaGxpZ2h0aW5nKCBQYXRoICkge1xyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKCBzaGFwZTogU2hhcGUsIG9wdGlvbnM/OiBQYXRoT3B0aW9ucyApIHtcclxuICAgICAgc3VwZXIoIHNoYXBlLCBvcHRpb25zICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbnNvbGFyU3lzdGVtQ29tbW9uLnJlZ2lzdGVyKCAnRHJhZ2dhYmxlVmVjdG9yTm9kZScsIERyYWdnYWJsZVZlY3Rvck5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTQSxLQUFLLFFBQVEsNkJBQTZCO0FBQ25ELE9BQU9DLFFBQVEsTUFBTSxzQ0FBc0M7QUFDM0QsU0FBU0MsS0FBSyxFQUFFQyxZQUFZLEVBQUVDLHVCQUF1QixFQUFFQyxvQkFBb0IsRUFBUUMsSUFBSSxFQUFlQyxJQUFJLFFBQVEsZ0NBQWdDO0FBQ2xKLE9BQU9DLFVBQVUsTUFBNkIsaUJBQWlCO0FBRy9ELE9BQU9DLE9BQU8sTUFBTSw0QkFBNEI7QUFDaEQsT0FBT0MsU0FBUyxNQUFNLG9DQUFvQztBQUUxRCxPQUFPQyxpQkFBaUIsTUFBTSx5QkFBeUI7QUFDdkQsT0FBT0MsZUFBZSxNQUFNLG9DQUFvQztBQUVoRSxPQUFPQyxjQUFjLE1BQU0sb0NBQW9DO0FBQy9ELE9BQU9DLFNBQVMsTUFBTSxpREFBaUQ7QUFDdkUsT0FBT0MsY0FBYyxNQUFNLGdDQUFnQztBQUMzRCxPQUFPQyxpQkFBaUIsTUFBTSxtQ0FBbUM7QUFDakUsT0FBT0MsMEJBQTBCLE1BQU0sa0NBQWtDO0FBQ3pFLE9BQU9DLFlBQVksTUFBTSxtQ0FBbUM7QUFnQjVELGVBQWUsTUFBTUMs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