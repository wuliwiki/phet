// Copyright 2014-2021, University of Colorado Boulder

/**
 * Multiplication table node for 'Divide' screen in 'Arithmetic' simulation.
 *
 * @author Andrey Zelenkov (MLearner)
 */

import arithmetic from '../../arithmetic.js';
import GameState from '../../common/model/GameState.js';
import MultiplicationTableNode from '../../common/view/table/MultiplicationTableNode.js';
class DivideScreenTableNode extends MultiplicationTableNode {
  /**
   * @param {ArithmeticModel} model
   */
  constructor(model) {
    super(model.levelNumberProperty, model.stateProperty, model.levelModels, true);
    this.problemModel = model.problemModel;
    this.levelNumberProperty = model.levelNumberProperty;
    model.stateProperty.lazyLink(state => {
      // set view for multiplication table after choosing multiplicand and multiplier
      if (state === GameState.AWAITING_USER_INPUT) {
        // clear cell colors prior to showing the problem
        this.setCellsToDefaultColor(this.levelNumberProperty.value);

        // highlight the active multiplicand or multiplier
        if (model.activeInputProperty.get() === 'multiplier') {
          this.cells[this.levelNumberProperty.value][this.problemModel.multiplicandProperty.get()][0].setSelected();
        } else {
          assert && assert(model.activeInputProperty.get() === 'multiplicand');
          this.cells[this.levelNumberProperty.value][0][this.problemModel.multiplierProperty.get()].setSelected();
        }
      } else if (state === GameState.DISPLAYING_CORRECT_ANSWER_FEEDBACK) {
        // Make the cells that correspond to the answer change color.
        this.cells[this.levelNumberProperty.value][this.problemModel.multiplicandProperty.get()][0].setSelected();
        this.cells[this.levelNumberProperty.value][0][this.problemModel.multiplierProperty.get()].setSelected();
        for (let multiplicand = 1; multiplicand <= this.problemModel.multiplicandProperty.get(); multiplicand++) {
          for (let multiplier = 1; multiplier <= this.problemModel.multiplierProperty.get(); multiplier++) {
            this.cells[this.levelNumberProperty.value][multiplicand][multiplier].setSelected();
          }
        }
      } else if (state === GameState.LEVEL_COMPLETED) {
        // set all cells to default conditions when the table has been filled
        this.setCellsToDefaultColor(this.levelNumberProperty.value);
      }
    });
  }

  // @public, @override
  refreshLevel() {
    super.refreshLevel(this.levelNumberProperty.value);

    // highlight the appropriate header cell
    if (this.problemModel.multiplicandProperty.get()) {
      this.cells[this.levelNumberProperty.value][this.problemModel.multiplicandProperty.get()][0].setSelected();
    } else {
      this.cells[this.levelNumberProperty.value][0][this.problemModel.multiplierProperty.get()].setSelected();
    }
  }
}
arithmetic.register('DivideScreenTableNode', DivideScreenTableNode);
export default DivideScreenTableNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJhcml0aG1ldGljIiwiR2FtZVN0YXRlIiwiTXVsdGlwbGljYXRpb25UYWJsZU5vZGUiLCJEaXZpZGVTY3JlZW5UYWJsZU5vZGUiLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwibGV2ZWxOdW1iZXJQcm9wZXJ0eSIsInN0YXRlUHJvcGVydHkiLCJsZXZlbE1vZGVscyIsInByb2JsZW1Nb2RlbCIsImxhenlMaW5rIiwic3RhdGUiLCJBV0FJVElOR19VU0VSX0lOUFVUIiwic2V0Q2VsbHNUb0RlZmF1bHRDb2xvciIsInZhbHVlIiwiYWN0aXZlSW5wdXRQcm9wZXJ0eSIsImdldCIsImNlbGxzIiwibXVsdGlwbGljYW5kUHJvcGVydHkiLCJzZXRTZWxlY3RlZCIsImFzc2VydCIsIm11bHRpcGxpZXJQcm9wZXJ0eSIsIkRJU1BMQVlJTkdfQ09SUkVDVF9BTlNXRVJfRkVFREJBQ0siLCJtdWx0aXBsaWNhbmQiLCJtdWx0aXBsaWVyIiwiTEVWRUxfQ09NUExFVEVEIiwicmVmcmVzaExldmVsIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJEaXZpZGVTY3JlZW5UYWJsZU5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTQtMjAyMSwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogTXVsdGlwbGljYXRpb24gdGFibGUgbm9kZSBmb3IgJ0RpdmlkZScgc2NyZWVuIGluICdBcml0aG1ldGljJyBzaW11bGF0aW9uLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEFuZHJleSBaZWxlbmtvdiAoTUxlYXJuZXIpXHJcbiAqL1xyXG5cclxuaW1wb3J0IGFyaXRobWV0aWMgZnJvbSAnLi4vLi4vYXJpdGhtZXRpYy5qcyc7XHJcbmltcG9ydCBHYW1lU3RhdGUgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0dhbWVTdGF0ZS5qcyc7XHJcbmltcG9ydCBNdWx0aXBsaWNhdGlvblRhYmxlTm9kZSBmcm9tICcuLi8uLi9jb21tb24vdmlldy90YWJsZS9NdWx0aXBsaWNhdGlvblRhYmxlTm9kZS5qcyc7XHJcblxyXG5jbGFzcyBEaXZpZGVTY3JlZW5UYWJsZU5vZGUgZXh0ZW5kcyBNdWx0aXBsaWNhdGlvblRhYmxlTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7QXJpdGhtZXRpY01vZGVsfSBtb2RlbFxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBtb2RlbCApIHtcclxuICAgIHN1cGVyKCBtb2RlbC5sZXZlbE51bWJlclByb3BlcnR5LCBtb2RlbC5zdGF0ZVByb3BlcnR5LCBtb2RlbC5sZXZlbE1vZGVscywgdHJ1ZSApO1xyXG4gICAgdGhpcy5wcm9ibGVtTW9kZWwgPSBtb2RlbC5wcm9ibGVtTW9kZWw7XHJcbiAgICB0aGlzLmxldmVsTnVtYmVyUHJvcGVydHkgPSBtb2RlbC5sZXZlbE51bWJlclByb3BlcnR5O1xyXG5cclxuICAgIG1vZGVsLnN0YXRlUHJvcGVydHkubGF6eUxpbmsoIHN0YXRlID0+IHtcclxuXHJcbiAgICAgIC8vIHNldCB2aWV3IGZvciBtdWx0aXBsaWNhdGlvbiB0YWJsZSBhZnRlciBjaG9vc2luZyBtdWx0aXBsaWNhbmQgYW5kIG11bHRpcGxpZXJcclxuICAgICAgaWYgKCBzdGF0ZSA9PT0gR2FtZVN0YXRlLkFXQUlUSU5HX1VTRVJfSU5QVVQgKSB7XHJcblxyXG4gICAgICAgIC8vIGNsZWFyIGNlbGwgY29sb3JzIHByaW9yIHRvIHNob3dpbmcgdGhlIHByb2JsZW1cclxuICAgICAgICB0aGlzLnNldENlbGxzVG9EZWZhdWx0Q29sb3IoIHRoaXMubGV2ZWxOdW1iZXJQcm9wZXJ0eS52YWx1ZSApO1xyXG5cclxuICAgICAgICAvLyBoaWdobGlnaHQgdGhlIGFjdGl2ZSBtdWx0aXBsaWNhbmQgb3IgbXVsdGlwbGllclxyXG4gICAgICAgIGlmICggbW9kZWwuYWN0aXZlSW5wdXRQcm9wZXJ0eS5nZXQoKSA9PT0gJ211bHRpcGxpZXInICkge1xyXG4gICAgICAgICAgdGhpcy5jZWxsc1sgdGhpcy5sZXZlbE51bWJlclByb3BlcnR5LnZhbHVlIF1bIHRoaXMucHJvYmxlbU1vZGVsLm11bHRpcGxpY2FuZFByb3BlcnR5LmdldCgpIF1bIDAgXS5zZXRTZWxlY3RlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIGFzc2VydCAmJiBhc3NlcnQoIG1vZGVsLmFjdGl2ZUlucHV0UHJvcGVydHkuZ2V0KCkgPT09ICdtdWx0aXBsaWNhbmQnICk7XHJcbiAgICAgICAgICB0aGlzLmNlbGxzWyB0aGlzLmxldmVsTnVtYmVyUHJvcGVydHkudmFsdWUgXVsgMCBdWyB0aGlzLnByb2JsZW1Nb2RlbC5tdWx0aXBsaWVyUHJvcGVydHkuZ2V0KCkgXS5zZXRTZWxlY3RlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggc3RhdGUgPT09IEdhbWVTdGF0ZS5ESVNQTEFZSU5HX0NPUlJFQ1RfQU5TV0VSX0ZFRURCQUNLICkge1xyXG5cclxuICAgICAgICAvLyBNYWtlIHRoZSBjZWxscyB0aGF0IGNvcnJlc3BvbmQgdG8gdGhlIGFuc3dlciBjaGFuZ2UgY29sb3IuXHJcbiAgICAgICAgdGhpcy5jZWxsc1sgdGhpcy5sZXZlbE51bWJlclByb3BlcnR5LnZhbHVlIF1bIHRoaXMucHJvYmxlbU1vZGVsLm11bHRpcGxpY2FuZFByb3BlcnR5LmdldCgpIF1bIDAgXS5zZXRTZWxlY3RlZCgpO1xyXG4gICAgICAgIHRoaXMuY2VsbHNbIHRoaXMubGV2ZWxOdW1iZXJQcm9wZXJ0eS52YWx1ZSBdWyAwIF1bIHRoaXMucHJvYmxlbU1vZGVsLm11bHRpcGxpZXJQcm9wZXJ0eS5nZXQoKSBdLnNldFNlbGVjdGVkKCk7XHJcbiAgICAgICAgZm9yICggbGV0IG11bHRpcGxpY2FuZCA9IDE7IG11bHRpcGxpY2FuZCA8PSB0aGlzLnByb2JsZW1Nb2RlbC5tdWx0aXBsaWNhbmRQcm9wZXJ0eS5nZXQoKTsgbXVsdGlwbGljYW5kKysgKSB7XHJcbiAgICAgICAgICBmb3IgKCBsZXQgbXVsdGlwbGllciA9IDE7IG11bHRpcGxpZXIgPD0gdGhpcy5wcm9ibGVtTW9kZWwubXVsdGlwbGllclByb3BlcnR5LmdldCgpOyBtdWx0aXBsaWVyKysgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2VsbHNbIHRoaXMubGV2ZWxOdW1iZXJQcm9wZXJ0eS52YWx1ZSBdWyBtdWx0aXBsaWNhbmQgXVsgbXVsdGlwbGllciBdLnNldFNlbGVjdGVkKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCBzdGF0ZSA9PT0gR2FtZVN0YXRlLkxFVkVMX0NPTVBMRVRFRCApIHtcclxuXHJcbiAgICAgICAgLy8gc2V0IGFsbCBjZWxscyB0byBkZWZhdWx0IGNvbmRpdGlvbnMgd2hlbiB0aGUgdGFibGUgaGFzIGJlZW4gZmlsbGVkXHJcbiAgICAgICAgdGhpcy5zZXRDZWxsc1RvRGVmYXVsdENvbG9yKCB0aGlzLmxldmVsTnVtYmVyUHJvcGVydHkudmFsdWUgKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLy8gQHB1YmxpYywgQG92ZXJyaWRlXHJcbiAgcmVmcmVzaExldmVsKCkge1xyXG4gICAgc3VwZXIucmVmcmVzaExldmVsKCB0aGlzLmxldmVsTnVtYmVyUHJvcGVydHkudmFsdWUgKTtcclxuXHJcbiAgICAvLyBoaWdobGlnaHQgdGhlIGFwcHJvcHJpYXRlIGhlYWRlciBjZWxsXHJcbiAgICBpZiAoIHRoaXMucHJvYmxlbU1vZGVsLm11bHRpcGxpY2FuZFByb3BlcnR5LmdldCgpICkge1xyXG4gICAgICB0aGlzLmNlbGxzWyB0aGlzLmxldmVsTnVtYmVyUHJvcGVydHkudmFsdWUgXVsgdGhpcy5wcm9ibGVtTW9kZWwubXVsdGlwbGljYW5kUHJvcGVydHkuZ2V0KCkgXVsgMCBdLnNldFNlbGVjdGVkKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgdGhpcy5jZWxsc1sgdGhpcy5sZXZlbE51bWJlclByb3BlcnR5LnZhbHVlIF1bIDAgXVsgdGhpcy5wcm9ibGVtTW9kZWwubXVsdGlwbGllclByb3BlcnR5LmdldCgpIF0uc2V0U2VsZWN0ZWQoKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmFyaXRobWV0aWMucmVnaXN0ZXIoICdEaXZpZGVTY3JlZW5UYWJsZU5vZGUnLCBEaXZpZGVTY3JlZW5UYWJsZU5vZGUgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IERpdmlkZVNjcmVlblRhYmxlTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsVUFBVSxNQUFNLHFCQUFxQjtBQUM1QyxPQUFPQyxTQUFTLE1BQU0saUNBQWlDO0FBQ3ZELE9BQU9DLHVCQUF1QixNQUFNLG9EQUFvRDtBQUV4RixNQUFNQyxxQkFBcUIsU0FBU0QsdUJBQXVCLENBQUM7RUFFMUQ7QUFDRjtBQUNBO0VBQ0VFLFdBQVdBLENBQUVDLEtBQUssRUFBRztJQUNuQixLQUFLLENBQUVBLEtBQUssQ0FBQ0MsbUJBQW1CLEVBQUVELEtBQUssQ0FBQ0UsYUFBYSxFQUFFRixLQUFLLENBQUNHLFdBQVcsRUFBRSxJQUFLLENBQUM7SUFDaEYsSUFBSSxDQUFDQyxZQUFZLEdBQUdKLEtBQUssQ0FBQ0ksWUFBWTtJQUN0QyxJQUFJLENBQUNILG1CQUFtQixHQUFHRCxLQUFLLENBQUNDLG1CQUFtQjtJQUVwREQsS0FBSyxDQUFDRSxhQUFhLENBQUNHLFFBQVEsQ0FBRUMsS0FBSyxJQUFJO01BRXJDO01BQ0EsSUFBS0EsS0FBSyxLQUFLVixTQUFTLENBQUNXLG1CQUFtQixFQUFHO1FBRTdDO1FBQ0EsSUFBSSxDQUFDQyxzQkFBc0IsQ0FBRSxJQUFJLENBQUNQLG1CQUFtQixDQUFDUSxLQUFNLENBQUM7O1FBRTdEO1FBQ0EsSUFBS1QsS0FBSyxDQUFDVSxtQkFBbUIsQ0FBQ0MsR0FBRyxDQUFDLENBQUMsS0FBSyxZQUFZLEVBQUc7VUFDdEQsSUFBSSxDQUFDQyxLQUFLLENBQUUsSUFBSSxDQUFD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