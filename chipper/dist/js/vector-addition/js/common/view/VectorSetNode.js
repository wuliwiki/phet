// Copyright 2019-2023, University of Colorado Boulder

/**
 * VectorSetNode is responsible for creating the view for all vectors associated with a VectorSet.
 *
 * Responsibilities include:
 * - creating the Nodes for the sum vector and sum component vectors
 * - creating and managing Nodes for registered vectors
 * - handling layering of all Nodes related to vectors in the VectorSet
 *
 * @author Chris Malley (PixelZoom, Inc.)
 * @author Brandon Li
 */

import EnumerationProperty from '../../../../axon/js/EnumerationProperty.js';
import Property from '../../../../axon/js/Property.js';
import merge from '../../../../phet-core/js/merge.js';
import { Node, SceneryEvent } from '../../../../scenery/js/imports.js';
import vectorAddition from '../../vectorAddition.js';
import BaseVector from '../model/BaseVector.js';
import Graph from '../model/Graph.js';
import Vector from '../model/Vector.js';
import VectorSet from '../model/VectorSet.js';
import VectorAdditionConstants from '../VectorAdditionConstants.js';
import ComponentVectorNode from './ComponentVectorNode.js';
import SumComponentVectorNode from './SumComponentVectorNode.js';
import SumVectorNode from './SumVectorNode.js';
import VectorNode from './VectorNode.js';
export default class VectorSetNode extends Node {
  /**
   * @param {Graph} graph
   * @param {VectorSet} vectorSet
   * @param {Property.<boolean>} valuesVisibleProperty
   * @param {Property.<boolean>} anglesVisibleProperty
   * @param {EnumerationProperty.<ComponentVectorStyles>} componentStyleProperty
   * @param {Object} [options]
   */
  constructor(graph, vectorSet, valuesVisibleProperty, anglesVisibleProperty, componentStyleProperty, options) {
    assert && assert(graph instanceof Graph, `invalid graph: ${graph}`);
    assert && assert(vectorSet instanceof VectorSet, `invalid vectorSet: ${vectorSet}`);
    assert && assert(valuesVisibleProperty instanceof Property, `invalid valuesVisibleProperty: ${valuesVisibleProperty}`);
    assert && assert(anglesVisibleProperty instanceof Property, `invalid anglesVisibleProperty: ${anglesVisibleProperty}`);
    assert && assert(componentStyleProperty instanceof EnumerationProperty, `invalid componentStyleProperty: ${componentStyleProperty}`);
    options = merge({}, options);

    // Every VectorSet has a sum vector and sum component vectors, so create them
    const sumVectorNode = new SumVectorNode(vectorSet.sumVector, graph, valuesVisibleProperty, anglesVisibleProperty, vectorSet.sumVisibleProperty);
    const xSumComponentVectorNode = new SumComponentVectorNode(vectorSet.sumVector.xComponentVector, graph, componentStyleProperty, valuesVisibleProperty, vectorSet.sumVisibleProperty);
    const ySumComponentVectorNode = new SumComponentVectorNode(vectorSet.sumVector.yComponentVector, graph, componentStyleProperty, valuesVisibleProperty, vectorSet.sumVisibleProperty);
    assert && assert(!options.children, 'VectorSetNode sets children');
    options.children = [xSumComponentVectorNode, ySumComponentVectorNode, sumVectorNode];
    super(options);

    // @public (read-only)
    this.vectorSet = vectorSet;

    // @private
    this.graph = graph;
    this.valuesVisibleProperty = valuesVisibleProperty;
    this.anglesVisibleProperty = anglesVisibleProperty;
    this.componentStyleProperty = componentStyleProperty;

    // When the sum vector becomes selected, move it and its component vectors to the front.
    // unlink is unnecessary, exists for the lifetime of the sim.
    graph.activeVectorProperty.link(activeVector => {
      if (activeVector === sumVectorNode.vector) {
        // move all vectors in the set to the front, see https://github.com/phetsims/vector-addition/issues/94
        this.moveToFront();

        // order is important - sum should be in front of components
        xSumComponentVectorNode.moveToFront();
        ySumComponentVectorNode.moveToFront();
        sumVectorNode.moveToFront();
      }
    });
  }

  /**
   * @public
   * @override
   */
  dispose() {
    assert && assert(false, 'VectorSetNode is not intended to be disposed');
  }

  /**
   * Registers a Vector by creating its associated VectorNode and the ComponentVectorNodes.
   * The Nodes are deleted if Vector is ever removed from its VectorSet.
   * @public
   * @param {Vector} vector - the vector model
   * @param {SceneryEvent} [forwardingEvent] - if provided, it will forward this event to the Vector body drag
   *                                           listener. This is used to forward the click event from the
   *                                           VectorCreatorPanel to the VectorNode. If not provided, no event is
   *                                           forwarded.
   */
  registerVector(vector, forwardingEvent) {
    assert && assert(vector instanceof Vector, `invalid vector: ${vector}`);
    assert && assert(!forwardingEvent || forwardingEvent instanceof SceneryEvent, `invalid forwardingEvent: ${forwardingEvent}`);

    // Create the view for the vector and its component vectors
    const vectorNode = new VectorNode(vector, this.graph, this.valuesVisibleProperty, this.anglesVisibleProperty);
    const xComponentVectorNode = new ComponentVectorNode(vector.xComponentVector, this.graph, this.componentStyleProperty, this.valuesVisibleProperty);
    const yComponentVectorNode = new ComponentVectorNode(vector.yComponentVector, this.graph, this.componentStyleProperty, this.valuesVisibleProperty);
    this.addChild(xComponentVectorNode);
    this.addChild(yComponentVectorNode);
    this.addChild(vectorNode);

    // Optional event forwarding
    if (forwardingEvent) {
      vectorNode.forwardEvent(forwardingEvent);
    }

    // When the vector becomes active (selected), move it and its components to the front.
    // unlink is required when the vector is removed.
    const activeVectorListener = activeVector => {
      if (activeVector === vectorNode.vector) {
        // move all vectors in the set to the front, see https://github.com/phetsims/vector-addition/issues/94
        this.moveToFront();

        // order is important - vector should be in front of components
        xComponentVectorNode.moveToFront();
        yComponentVectorNode.moveToFront();
        vectorNode.moveToFront();
      }
    };
    this.graph.activeVectorProperty.link(activeVectorListener);

    // If the Vector is removed from the VectorSet, clean up.
    if (vector.isRemovable) {
      const removalListener = removedVector => {
        assert && assert(removedVector.isRemovable, 'vector is not removable');
        if (removedVector === vector) {
          // dispose the Nodes that were created
          xComponentVectorNode.dispose();
          yComponentVectorNode.dispose();
          vectorNode.dispose();

          // remove listeners
          this.vectorSet.vectors.removeItemRemovedListener(removalListener);
          this.graph.activeVectorProperty.unlink(activeVectorListener);
        }
      };
      this.vectorSet.vectors.addItemRemovedListener(removalListener);
    }
  }

  /**
   * Adds a base vector to the VectorSetNode.  Base vectors are never removed.
   * Base vectors do not have component vectors, see https://github.com/phetsims/vector-addition/issues/158
   * @param {BaseVector} baseVector
   * @param {Property.<boolean>} baseVectorsVisibleProperty
   * @public
   */
  addBaseVector(baseVector, baseVectorsVisibleProperty) {
    assert && assert(baseVector instanceof BaseVector, 'invalid baseVector');
    assert && assert(baseVectorsVisibleProperty instanceof Property, 'invalid baseVectorsVisibleProperty');

    // Node for the base vector
    const baseVectorNode = new VectorNode(baseVector, this.graph, this.valuesVisibleProperty, this.anglesVisibleProperty, {
      arrowOptions: merge({}, VectorAdditionConstants.BASE_VECTOR_ARROW_OPTIONS, {
        fill: this.graph.vectorSet.vectorColorPalette.baseVectorFill,
        stroke: this.graph.vectorSet.vectorColorPalette.baseVectorStroke
      })
    });
    this.addChild(baseVectorNode);

    // Handle visibility
    baseVectorsVisibleProperty.linkAttribute(baseVectorNode, 'visible');

    // When the base vector becomes active (selected), move it (and the entire vector set) to the front.
    // unlink is unnecessary because base vectors exist for the lifetime of the sim.
    this.graph.activeVectorProperty.link(activeVector => {
      if (activeVector === baseVectorNode.vector) {
        // move all vectors in the set to the front, see https://github.com/phetsims/vector-addition/issues/94
        this.moveToFront();

        // move the base vector to the front
        baseVectorNode.moveToFront();
      }
    });
  }
}
vectorAddition.register('VectorSetNode', VectorSetNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFbnVtZXJhdGlvblByb3BlcnR5IiwiUHJvcGVydHkiLCJtZXJnZSIsIk5vZGUiLCJTY2VuZXJ5RXZlbnQiLCJ2ZWN0b3JBZGRpdGlvbiIsIkJhc2VWZWN0b3IiLCJHcmFwaCIsIlZlY3RvciIsIlZlY3RvclNldCIsIlZlY3RvckFkZGl0aW9uQ29uc3RhbnRzIiwiQ29tcG9uZW50VmVjdG9yTm9kZSIsIlN1bUNvbXBvbmVudFZlY3Rvck5vZGUiLCJTdW1WZWN0b3JOb2RlIiwiVmVjdG9yTm9kZSIsIlZlY3RvclNldE5vZGUiLCJjb25zdHJ1Y3RvciIsImdyYXBoIiwidmVjdG9yU2V0IiwidmFsdWVzVmlzaWJsZVByb3BlcnR5IiwiYW5nbGVzVmlzaWJsZVByb3BlcnR5IiwiY29tcG9uZW50U3R5bGVQcm9wZXJ0eSIsIm9wdGlvbnMiLCJhc3NlcnQiLCJzdW1WZWN0b3JOb2RlIiwic3VtVmVjdG9yIiwic3VtVmlzaWJsZVByb3BlcnR5IiwieFN1bUNvbXBvbmVudFZlY3Rvck5vZGUiLCJ4Q29tcG9uZW50VmVjdG9yIiwieVN1bUNvbXBvbmVudFZlY3Rvck5vZGUiLCJ5Q29tcG9uZW50VmVjdG9yIiwiY2hpbGRyZW4iLCJhY3RpdmVWZWN0b3JQcm9wZXJ0eSIsImxpbmsiLCJhY3RpdmVWZWN0b3IiLCJ2ZWN0b3IiLCJtb3ZlVG9Gcm9udCIsImRpc3Bvc2UiLCJyZWdpc3RlclZlY3RvciIsImZvcndhcmRpbmdFdmVudCIsInZlY3Rvck5vZGUiLCJ4Q29tcG9uZW50VmVjdG9yTm9kZSIsInlDb21wb25lbnRWZWN0b3JOb2RlIiwiYWRkQ2hpbGQiLCJmb3J3YXJkRXZlbnQiLCJhY3RpdmVWZWN0b3JMaXN0ZW5lciIsImlzUmVtb3ZhYmxlIiwicmVtb3ZhbExpc3RlbmVyIiwicmVtb3ZlZFZlY3RvciIsInZlY3RvcnMiLCJyZW1vdmVJdGVtUmVtb3ZlZExpc3RlbmVyIiwidW5saW5rIiwiYWRkSXRlbVJlbW92ZWRMaXN0ZW5lciIsImFkZEJhc2VWZWN0b3IiLCJiYXNlVmVjdG9yIiwiYmFzZVZlY3RvcnNWaXNpYmxlUHJvcGVydHkiLCJiYXNlVmVjdG9yTm9kZSIsImFycm93T3B0aW9ucyIsIkJBU0VfVkVDVE9SX0FSUk9XX09QVElPTlMiLCJmaWxsIiwidmVjdG9yQ29sb3JQYWxldHRlIiwiYmFzZVZlY3RvckZpbGwiLCJzdHJva2UiLCJiYXNlVmVjdG9yU3Ryb2tlIiwibGlua0F0dHJpYnV0ZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiVmVjdG9yU2V0Tm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBWZWN0b3JTZXROb2RlIGlzIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGUgdmlldyBmb3IgYWxsIHZlY3RvcnMgYXNzb2NpYXRlZCB3aXRoIGEgVmVjdG9yU2V0LlxyXG4gKlxyXG4gKiBSZXNwb25zaWJpbGl0aWVzIGluY2x1ZGU6XHJcbiAqIC0gY3JlYXRpbmcgdGhlIE5vZGVzIGZvciB0aGUgc3VtIHZlY3RvciBhbmQgc3VtIGNvbXBvbmVudCB2ZWN0b3JzXHJcbiAqIC0gY3JlYXRpbmcgYW5kIG1hbmFnaW5nIE5vZGVzIGZvciByZWdpc3RlcmVkIHZlY3RvcnNcclxuICogLSBoYW5kbGluZyBsYXllcmluZyBvZiBhbGwgTm9kZXMgcmVsYXRlZCB0byB2ZWN0b3JzIGluIHRoZSBWZWN0b3JTZXRcclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICogQGF1dGhvciBCcmFuZG9uIExpXHJcbiAqL1xyXG5cclxuaW1wb3J0IEVudW1lcmF0aW9uUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9FbnVtZXJhdGlvblByb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IHsgTm9kZSwgU2NlbmVyeUV2ZW50IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IHZlY3RvckFkZGl0aW9uIGZyb20gJy4uLy4uL3ZlY3RvckFkZGl0aW9uLmpzJztcclxuaW1wb3J0IEJhc2VWZWN0b3IgZnJvbSAnLi4vbW9kZWwvQmFzZVZlY3Rvci5qcyc7XHJcbmltcG9ydCBHcmFwaCBmcm9tICcuLi9tb2RlbC9HcmFwaC5qcyc7XHJcbmltcG9ydCBWZWN0b3IgZnJvbSAnLi4vbW9kZWwvVmVjdG9yLmpzJztcclxuaW1wb3J0IFZlY3RvclNldCBmcm9tICcuLi9tb2RlbC9WZWN0b3JTZXQuanMnO1xyXG5pbXBvcnQgVmVjdG9yQWRkaXRpb25Db25zdGFudHMgZnJvbSAnLi4vVmVjdG9yQWRkaXRpb25Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgQ29tcG9uZW50VmVjdG9yTm9kZSBmcm9tICcuL0NvbXBvbmVudFZlY3Rvck5vZGUuanMnO1xyXG5pbXBvcnQgU3VtQ29tcG9uZW50VmVjdG9yTm9kZSBmcm9tICcuL1N1bUNvbXBvbmVudFZlY3Rvck5vZGUuanMnO1xyXG5pbXBvcnQgU3VtVmVjdG9yTm9kZSBmcm9tICcuL1N1bVZlY3Rvck5vZGUuanMnO1xyXG5pbXBvcnQgVmVjdG9yTm9kZSBmcm9tICcuL1ZlY3Rvck5vZGUuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmVjdG9yU2V0Tm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge0dyYXBofSBncmFwaFxyXG4gICAqIEBwYXJhbSB7VmVjdG9yU2V0fSB2ZWN0b3JTZXRcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5Ljxib29sZWFuPn0gdmFsdWVzVmlzaWJsZVByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48Ym9vbGVhbj59IGFuZ2xlc1Zpc2libGVQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSB7RW51bWVyYXRpb25Qcm9wZXJ0eS48Q29tcG9uZW50VmVjdG9yU3R5bGVzPn0gY29tcG9uZW50U3R5bGVQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggZ3JhcGgsIHZlY3RvclNldCwgdmFsdWVzVmlzaWJsZVByb3BlcnR5LCBhbmdsZXNWaXNpYmxlUHJvcGVydHksIGNvbXBvbmVudFN0eWxlUHJvcGVydHksIG9wdGlvbnMgKSB7XHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggZ3JhcGggaW5zdGFuY2VvZiBHcmFwaCwgYGludmFsaWQgZ3JhcGg6ICR7Z3JhcGh9YCApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdmVjdG9yU2V0IGluc3RhbmNlb2YgVmVjdG9yU2V0LCBgaW52YWxpZCB2ZWN0b3JTZXQ6ICR7dmVjdG9yU2V0fWAgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHZhbHVlc1Zpc2libGVQcm9wZXJ0eSBpbnN0YW5jZW9mIFByb3BlcnR5LCBgaW52YWxpZCB2YWx1ZXNWaXNpYmxlUHJvcGVydHk6ICR7dmFsdWVzVmlzaWJsZVByb3BlcnR5fWAgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGFuZ2xlc1Zpc2libGVQcm9wZXJ0eSBpbnN0YW5jZW9mIFByb3BlcnR5LCBgaW52YWxpZCBhbmdsZXNWaXNpYmxlUHJvcGVydHk6ICR7YW5nbGVzVmlzaWJsZVByb3BlcnR5fWAgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGNvbXBvbmVudFN0eWxlUHJvcGVydHkgaW5zdGFuY2VvZiBFbnVtZXJhdGlvblByb3BlcnR5LCBgaW52YWxpZCBjb21wb25lbnRTdHlsZVByb3BlcnR5OiAke2NvbXBvbmVudFN0eWxlUHJvcGVydHl9YCApO1xyXG5cclxuICAgIG9wdGlvbnMgPSBtZXJnZSgge30sIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBFdmVyeSBWZWN0b3JTZXQgaGFzIGEgc3VtIHZlY3RvciBhbmQgc3VtIGNvbXBvbmVudCB2ZWN0b3JzLCBzbyBjcmVhdGUgdGhlbVxyXG4gICAgY29uc3Qgc3VtVmVjdG9yTm9kZSA9IG5ldyBTdW1WZWN0b3JOb2RlKCB2ZWN0b3JTZXQuc3VtVmVjdG9yLCBncmFwaCxcclxuICAgICAgdmFsdWVzVmlzaWJsZVByb3BlcnR5LCBhbmdsZXNWaXNpYmxlUHJvcGVydHksIHZlY3RvclNldC5zdW1WaXNpYmxlUHJvcGVydHlcclxuICAgICk7XHJcbiAgICBjb25zdCB4U3VtQ29tcG9uZW50VmVjdG9yTm9kZSA9IG5ldyBTdW1Db21wb25lbnRWZWN0b3JOb2RlKCB2ZWN0b3JTZXQuc3VtVmVjdG9yLnhDb21wb25lbnRWZWN0b3IsIGdyYXBoLFxyXG4gICAgICBjb21wb25lbnRTdHlsZVByb3BlcnR5LCB2YWx1ZXNWaXNpYmxlUHJvcGVydHksIHZlY3RvclNldC5zdW1WaXNpYmxlUHJvcGVydHkgKTtcclxuICAgIGNvbnN0IHlTdW1Db21wb25lbnRWZWN0b3JOb2RlID0gbmV3IFN1bUNvbXBvbmVudFZlY3Rvck5vZGUoIHZlY3RvclNldC5zdW1WZWN0b3IueUNvbXBvbmVudFZlY3RvciwgZ3JhcGgsXHJcbiAgICAgIGNvbXBvbmVudFN0eWxlUHJvcGVydHksIHZhbHVlc1Zpc2libGVQcm9wZXJ0eSwgdmVjdG9yU2V0LnN1bVZpc2libGVQcm9wZXJ0eSApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggIW9wdGlvbnMuY2hpbGRyZW4sICdWZWN0b3JTZXROb2RlIHNldHMgY2hpbGRyZW4nICk7XHJcbiAgICBvcHRpb25zLmNoaWxkcmVuID0gWyB4U3VtQ29tcG9uZW50VmVjdG9yTm9kZSwgeVN1bUNvbXBvbmVudFZlY3Rvck5vZGUsIHN1bVZlY3Rvck5vZGUgXTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMgKHJlYWQtb25seSlcclxuICAgIHRoaXMudmVjdG9yU2V0ID0gdmVjdG9yU2V0O1xyXG5cclxuICAgIC8vIEBwcml2YXRlXHJcbiAgICB0aGlzLmdyYXBoID0gZ3JhcGg7XHJcbiAgICB0aGlzLnZhbHVlc1Zpc2libGVQcm9wZXJ0eSA9IHZhbHVlc1Zpc2libGVQcm9wZXJ0eTtcclxuICAgIHRoaXMuYW5nbGVzVmlzaWJsZVByb3BlcnR5ID0gYW5nbGVzVmlzaWJsZVByb3BlcnR5O1xyXG4gICAgdGhpcy5jb21wb25lbnRTdHlsZVByb3BlcnR5ID0gY29tcG9uZW50U3R5bGVQcm9wZXJ0eTtcclxuXHJcbiAgICAvLyBXaGVuIHRoZSBzdW0gdmVjdG9yIGJlY29tZXMgc2VsZWN0ZWQsIG1vdmUgaXQgYW5kIGl0cyBjb21wb25lbnQgdmVjdG9ycyB0byB0aGUgZnJvbnQuXHJcbiAgICAvLyB1bmxpbmsgaXMgdW5uZWNlc3NhcnksIGV4aXN0cyBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBzaW0uXHJcbiAgICBncmFwaC5hY3RpdmVWZWN0b3JQcm9wZXJ0eS5saW5rKCBhY3RpdmVWZWN0b3IgPT4ge1xyXG4gICAgICBpZiAoIGFjdGl2ZVZlY3RvciA9PT0gc3VtVmVjdG9yTm9kZS52ZWN0b3IgKSB7XHJcblxyXG4gICAgICAgIC8vIG1vdmUgYWxsIHZlY3RvcnMgaW4gdGhlIHNldCB0byB0aGUgZnJvbnQsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvdmVjdG9yLWFkZGl0aW9uL2lzc3Vlcy85NFxyXG4gICAgICAgIHRoaXMubW92ZVRvRnJvbnQoKTtcclxuXHJcbiAgICAgICAgLy8gb3JkZXIgaXMgaW1wb3J0YW50IC0gc3VtIHNob3VsZCBiZSBpbiBmcm9udCBvZiBjb21wb25lbnRzXHJcbiAgICAgICAgeFN1bUNvbXBvbmVudFZlY3Rvck5vZGUubW92ZVRvRnJvbnQoKTtcclxuICAgICAgICB5U3VtQ29tcG9uZW50VmVjdG9yTm9kZS5tb3ZlVG9Gcm9udCgpO1xyXG4gICAgICAgIHN1bVZlY3Rvck5vZGUubW92ZVRvRnJvbnQoKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHB1YmxpY1xyXG4gICAqIEBvdmVycmlkZVxyXG4gICAqL1xyXG4gIGRpc3Bvc2UoKSB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBmYWxzZSwgJ1ZlY3RvclNldE5vZGUgaXMgbm90IGludGVuZGVkIHRvIGJlIGRpc3Bvc2VkJyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXJzIGEgVmVjdG9yIGJ5IGNyZWF0aW5nIGl0cyBhc3NvY2lhdGVkIFZlY3Rvck5vZGUgYW5kIHRoZSBDb21wb25lbnRWZWN0b3JOb2Rlcy5cclxuICAgKiBUaGUgTm9kZXMgYXJlIGRlbGV0ZWQgaWYgVmVjdG9yIGlzIGV2ZXIgcmVtb3ZlZCBmcm9tIGl0cyBWZWN0b3JTZXQuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqIEBwYXJhbSB7VmVjdG9yfSB2ZWN0b3IgLSB0aGUgdmVjdG9yIG1vZGVsXHJcbiAgICogQHBhcmFtIHtTY2VuZXJ5RXZlbnR9IFtmb3J3YXJkaW5nRXZlbnRdIC0gaWYgcHJvdmlkZWQsIGl0IHdpbGwgZm9yd2FyZCB0aGlzIGV2ZW50IHRvIHRoZSBWZWN0b3IgYm9keSBkcmFnXHJcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXIuIFRoaXMgaXMgdXNlZCB0byBmb3J3YXJkIHRoZSBjbGljayBldmVudCBmcm9tIHRoZVxyXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvckNyZWF0b3JQYW5lbCB0byB0aGUgVmVjdG9yTm9kZS4gSWYgbm90IHByb3ZpZGVkLCBubyBldmVudCBpc1xyXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcndhcmRlZC5cclxuICAgKi9cclxuICByZWdpc3RlclZlY3RvciggdmVjdG9yLCBmb3J3YXJkaW5nRXZlbnQgKSB7XHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdmVjdG9yIGluc3RhbmNlb2YgVmVjdG9yLCBgaW52YWxpZCB2ZWN0b3I6ICR7dmVjdG9yfWAgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoICFmb3J3YXJkaW5nRXZlbnQgfHwgZm9yd2FyZGluZ0V2ZW50IGluc3RhbmNlb2YgU2NlbmVyeUV2ZW50LCBgaW52YWxpZCBmb3J3YXJkaW5nRXZlbnQ6ICR7Zm9yd2FyZGluZ0V2ZW50fWAgKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIHZpZXcgZm9yIHRoZSB2ZWN0b3IgYW5kIGl0cyBjb21wb25lbnQgdmVjdG9yc1xyXG4gICAgY29uc3QgdmVjdG9yTm9kZSA9IG5ldyBWZWN0b3JOb2RlKCB2ZWN0b3IsIHRoaXMuZ3JhcGgsIHRoaXMudmFsdWVzVmlzaWJsZVByb3BlcnR5LCB0aGlzLmFuZ2xlc1Zpc2libGVQcm9wZXJ0eSApO1xyXG5cclxuICAgIGNvbnN0IHhDb21wb25lbnRWZWN0b3JOb2RlID0gbmV3IENvbXBvbmVudFZlY3Rvck5vZGUoIHZlY3Rvci54Q29tcG9uZW50VmVjdG9yLFxyXG4gICAgICB0aGlzLmdyYXBoLFxyXG4gICAgICB0aGlzLmNvbXBvbmVudFN0eWxlUHJvcGVydHksXHJcbiAgICAgIHRoaXMudmFsdWVzVmlzaWJsZVByb3BlcnR5ICk7XHJcblxyXG4gICAgY29uc3QgeUNvbXBvbmVudFZlY3Rvck5vZGUgPSBuZXcgQ29tcG9uZW50VmVjdG9yTm9kZSggdmVjdG9yLnlDb21wb25lbnRWZWN0b3IsXHJcbiAgICAgIHRoaXMuZ3JhcGgsXHJcbiAgICAgIHRoaXMuY29tcG9uZW50U3R5bGVQcm9wZXJ0eSxcclxuICAgICAgdGhpcy52YWx1ZXNWaXNpYmxlUHJvcGVydHkgKTtcclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKCB4Q29tcG9uZW50VmVjdG9yTm9kZSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggeUNvbXBvbmVudFZlY3Rvck5vZGUgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHZlY3Rvck5vZGUgKTtcclxuXHJcbiAgICAvLyBPcHRpb25hbCBldmVudCBmb3J3YXJkaW5nXHJcbiAgICBpZiAoIGZvcndhcmRpbmdFdmVudCApIHtcclxuICAgICAgdmVjdG9yTm9kZS5mb3J3YXJkRXZlbnQoIGZvcndhcmRpbmdFdmVudCApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFdoZW4gdGhlIHZlY3RvciBiZWNvbWVzIGFjdGl2ZSAoc2VsZWN0ZWQpLCBtb3ZlIGl0IGFuZCBpdHMgY29tcG9uZW50cyB0byB0aGUgZnJvbnQuXHJcbiAgICAvLyB1bmxpbmsgaXMgcmVxdWlyZWQgd2hlbiB0aGUgdmVjdG9yIGlzIHJlbW92ZWQuXHJcbiAgICBjb25zdCBhY3RpdmVWZWN0b3JMaXN0ZW5lciA9IGFjdGl2ZVZlY3RvciA9PiB7XHJcbiAgICAgIGlmICggYWN0aXZlVmVjdG9yID09PSB2ZWN0b3JOb2RlLnZlY3RvciApIHtcclxuXHJcbiAgICAgICAgLy8gbW92ZSBhbGwgdmVjdG9ycyBpbiB0aGUgc2V0IHRvIHRoZSBmcm9udCwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy92ZWN0b3ItYWRkaXRpb24vaXNzdWVzLzk0XHJcbiAgICAgICAgdGhpcy5tb3ZlVG9Gcm9udCgpO1xyXG5cclxuICAgICAgICAvLyBvcmRlciBpcyBpbXBvcnRhbnQgLSB2ZWN0b3Igc2hvdWxkIGJlIGluIGZyb250IG9mIGNvbXBvbmVudHNcclxuICAgICAgICB4Q29tcG9uZW50VmVjdG9yTm9kZS5tb3ZlVG9Gcm9udCgpO1xyXG4gICAgICAgIHlDb21wb25lbnRWZWN0b3JOb2RlLm1vdmVUb0Zyb250KCk7XHJcbiAgICAgICAgdmVjdG9yTm9kZS5tb3ZlVG9Gcm9udCgpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5ncmFwaC5hY3RpdmVWZWN0b3JQcm9wZXJ0eS5saW5rKCBhY3RpdmVWZWN0b3JMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIElmIHRoZSBWZWN0b3IgaXMgcmVtb3ZlZCBmcm9tIHRoZSBWZWN0b3JTZXQsIGNsZWFuIHVwLlxyXG4gICAgaWYgKCB2ZWN0b3IuaXNSZW1vdmFibGUgKSB7XHJcblxyXG4gICAgICBjb25zdCByZW1vdmFsTGlzdGVuZXIgPSByZW1vdmVkVmVjdG9yID0+IHtcclxuICAgICAgICBhc3NlcnQgJiYgYXNzZXJ0KCByZW1vdmVkVmVjdG9yLmlzUmVtb3ZhYmxlLCAndmVjdG9yIGlzIG5vdCByZW1vdmFibGUnICk7XHJcblxyXG4gICAgICAgIGlmICggcmVtb3ZlZFZlY3RvciA9PT0gdmVjdG9yICkge1xyXG5cclxuICAgICAgICAgIC8vIGRpc3Bvc2UgdGhlIE5vZGVzIHRoYXQgd2VyZSBjcmVhdGVkXHJcbiAgICAgICAgICB4Q29tcG9uZW50VmVjdG9yTm9kZS5kaXNwb3NlKCk7XHJcbiAgICAgICAgICB5Q29tcG9uZW50VmVjdG9yTm9kZS5kaXNwb3NlKCk7XHJcbiAgICAgICAgICB2ZWN0b3JOb2RlLmRpc3Bvc2UoKTtcclxuXHJcbiAgICAgICAgICAvLyByZW1vdmUgbGlzdGVuZXJzXHJcbiAgICAgICAgICB0aGlzLnZlY3RvclNldC52ZWN0b3JzLnJlbW92ZUl0ZW1SZW1vdmVkTGlzdGVuZXIoIHJlbW92YWxMaXN0ZW5lciApO1xyXG4gICAgICAgICAgdGhpcy5ncmFwaC5hY3RpdmVWZWN0b3JQcm9wZXJ0eS51bmxpbmsoIGFjdGl2ZVZlY3Rvckxpc3RlbmVyICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgdGhpcy52ZWN0b3JTZXQudmVjdG9ycy5hZGRJdGVtUmVtb3ZlZExpc3RlbmVyKCByZW1vdmFsTGlzdGVuZXIgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgYSBiYXNlIHZlY3RvciB0byB0aGUgVmVjdG9yU2V0Tm9kZS4gIEJhc2UgdmVjdG9ycyBhcmUgbmV2ZXIgcmVtb3ZlZC5cclxuICAgKiBCYXNlIHZlY3RvcnMgZG8gbm90IGhhdmUgY29tcG9uZW50IHZlY3RvcnMsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvdmVjdG9yLWFkZGl0aW9uL2lzc3Vlcy8xNThcclxuICAgKiBAcGFyYW0ge0Jhc2VWZWN0b3J9IGJhc2VWZWN0b3JcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5Ljxib29sZWFuPn0gYmFzZVZlY3RvcnNWaXNpYmxlUHJvcGVydHlcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgYWRkQmFzZVZlY3RvciggYmFzZVZlY3RvciwgYmFzZVZlY3RvcnNWaXNpYmxlUHJvcGVydHkgKSB7XHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggYmFzZVZlY3RvciBpbnN0YW5jZW9mIEJhc2VWZWN0b3IsICdpbnZhbGlkIGJhc2VWZWN0b3InICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBiYXNlVmVjdG9yc1Zpc2libGVQcm9wZXJ0eSBpbnN0YW5jZW9mIFByb3BlcnR5LCAnaW52YWxpZCBiYXNlVmVjdG9yc1Zpc2libGVQcm9wZXJ0eScgKTtcclxuXHJcbiAgICAvLyBOb2RlIGZvciB0aGUgYmFzZSB2ZWN0b3JcclxuICAgIGNvbnN0IGJhc2VWZWN0b3JOb2RlID0gbmV3IFZlY3Rvck5vZGUoIGJhc2VWZWN0b3IsIHRoaXMuZ3JhcGgsXHJcbiAgICAgIHRoaXMudmFsdWVzVmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICB0aGlzLmFuZ2xlc1Zpc2libGVQcm9wZXJ0eSwge1xyXG4gICAgICAgIGFycm93T3B0aW9uczogbWVyZ2UoIHt9LCBWZWN0b3JBZGRpdGlvbkNvbnN0YW50cy5CQVNFX1ZFQ1RPUl9BUlJPV19PUFRJT05TLCB7XHJcbiAgICAgICAgICBmaWxsOiB0aGlzLmdyYXBoLnZlY3RvclNldC52ZWN0b3JDb2xvclBhbGV0dGUuYmFzZVZlY3RvckZpbGwsXHJcbiAgICAgICAgICBzdHJva2U6IHRoaXMuZ3JhcGgudmVjdG9yU2V0LnZlY3RvckNvbG9yUGFsZXR0ZS5iYXNlVmVjdG9yU3Ryb2tlXHJcbiAgICAgICAgfSApXHJcbiAgICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGJhc2VWZWN0b3JOb2RlICk7XHJcblxyXG4gICAgLy8gSGFuZGxlIHZpc2liaWxpdHlcclxuICAgIGJhc2VWZWN0b3JzVmlzaWJsZVByb3BlcnR5LmxpbmtBdHRyaWJ1dGUoIGJhc2VWZWN0b3JOb2RlLCAndmlzaWJsZScgKTtcclxuXHJcbiAgICAvLyBXaGVuIHRoZSBiYXNlIHZlY3RvciBiZWNvbWVzIGFjdGl2ZSAoc2VsZWN0ZWQpLCBtb3ZlIGl0IChhbmQgdGhlIGVudGlyZSB2ZWN0b3Igc2V0KSB0byB0aGUgZnJvbnQuXHJcbiAgICAvLyB1bmxpbmsgaXMgdW5uZWNlc3NhcnkgYmVjYXVzZSBiYXNlIHZlY3RvcnMgZXhpc3QgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltLlxyXG4gICAgdGhpcy5ncmFwaC5hY3RpdmVWZWN0b3JQcm9wZXJ0eS5saW5rKCBhY3RpdmVWZWN0b3IgPT4ge1xyXG4gICAgICBpZiAoIGFjdGl2ZVZlY3RvciA9PT0gYmFzZVZlY3Rvck5vZGUudmVjdG9yICkge1xyXG5cclxuICAgICAgICAvLyBtb3ZlIGFsbCB2ZWN0b3JzIGluIHRoZSBzZXQgdG8gdGhlIGZyb250LCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3ZlY3Rvci1hZGRpdGlvbi9pc3N1ZXMvOTRcclxuICAgICAgICB0aGlzLm1vdmVUb0Zyb250KCk7XHJcblxyXG4gICAgICAgIC8vIG1vdmUgdGhlIGJhc2UgdmVjdG9yIHRvIHRoZSBmcm9udFxyXG4gICAgICAgIGJhc2VWZWN0b3JOb2RlLm1vdmVUb0Zyb250KCk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbnZlY3RvckFkZGl0aW9uLnJlZ2lzdGVyKCAnVmVjdG9yU2V0Tm9kZScsIFZlY3RvclNldE5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsbUJB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