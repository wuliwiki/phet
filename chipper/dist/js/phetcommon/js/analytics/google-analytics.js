// Copyright 2012-2023, University of Colorado Boulder

/**
 * Google analytics collection for HTML5 sims.
 * Code provided by Google and Hewlett, possibly doctored by PhET.
 *
 * NOTE: Please be careful about modifications, as it relies on external scripts.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

(function () {
  assert && assert(window.phet && phet.chipper, 'We will require multiple things from the chipper preload namespace');
  assert && assert(!!phet.chipper.brand, 'A brand is required, since some messages depend on the brand');
  assert && assert(!!phet.chipper.queryParameters, 'We will need query parameters to be parsed for multiple purposes');
  assert && assert(!!phet.chipper.buildTimestamp, 'buildTimestamp is required for GA messages');
  assert && assert(!!phet.chipper.project, 'project is required for GA messages');
  assert && assert(!!phet.chipper.version, 'version is required for GA messages');
  assert && assert(!!phet.chipper.locale, 'locale is required for GA messages');
  const ua = navigator.userAgent;
  const hasIESecurityRestrictions = !!(ua.match(/MSIE/) || ua.match(/Trident\//) || ua.match(/Edge\//));

  // If we're in some form of IE running offline, don't attempt to make a cross-origin request.
  // See https://github.com/phetsims/joist/issues/164
  if (window.location.protocol === 'file:' && hasIESecurityRestrictions) {
    return;
  }

  // Don't track sims that we didn't develop
  if (phet.chipper.brand !== 'phet' && phet.chipper.brand !== 'phet-io') {
    return;
  }
  let loadType;
  // This is the iOS app
  if (phet.chipper.queryParameters['phet-app']) {
    loadType = 'phet-app';
  }
  // For the Android app, see https://github.com/phetsims/phet-android-app/issues/16
  else if (phet.chipper.queryParameters['phet-android-app']) {
    loadType = 'phet-android-app';
  } else if (top !== self) {
    // Checks to see if this sim is embedded - phetsims/chipper#50
    loadType = 'embedded';
  }
  // TODO Add additional conditions for tracking hits from the installer, etc. See https://github.com/phetsims/phetcommon/issues/49
  else {
    loadType = 'default';
  }
  function sendMessages() {
    // {boolean} - Whether an error was detected with anything relating to google analytics.
    // See https://github.com/phetsims/yotta/issues/30
    let googleAnalyticsErrored = false;
    window.addEventListener('error', event => {
      if (event && event.target && event.target.src && event.target.src.indexOf && event.target.src.indexOf('google-analytics') >= 0) {
        googleAnalyticsErrored = true;
      }
    }, true);
    const pingParams = `${'pingver=3&' + 'project='}${encodeURIComponent(phet.chipper.project)}&` + `brand=${encodeURIComponent(phet.chipper.brand)}&` + `version=${encodeURIComponent(phet.chipper.version)}&` + `locale=${encodeURIComponent(phet.chipper.locale)}&` + `buildTimestamp=${encodeURIComponent(phet.chipper.buildTimestamp)}&` + `domain=${encodeURIComponent(document.domain)}&` + `href=${encodeURIComponent(window.location.href)}&` + 'type=html&' + `timestamp=${encodeURIComponent(Date.now())}&` + `loadType=${encodeURIComponent(loadType)}&` + `ref=${encodeURIComponent(document.referrer)}`;
    function pingURL(url) {
      const img = document.createElement('img');
      img.src = url;
    }
    pingURL(`https://phet.colorado.edu/yotta/immediate.gif?${pingParams}`);
    window.addEventListener('load', event => {
      pingURL(`https://phet.colorado.edu/yotta/sanity.gif?${pingParams}&` + `gaError=${encodeURIComponent(googleAnalyticsErrored)}&` + `gaLoaded=${encodeURIComponent(false)}`);
    }, false);

    // External UA (Google Analytics) tracker
    if (phet.chipper.queryParameters.ga) {
      // Google Analytics snippet for loading the API
      (function (i, s, o, g, r, a, m) {
        i.GoogleAnalyticsObject = r;
        i[r] = i[r] || function () {
          // eslint-disable-next-line prefer-rest-params
          (i[r].q = i[r].q || []).push(arguments);
        }, i[r].l = 1 * new Date(); // eslint-disable-line no-sequences
        a = s.createElement(o), m = s.getElementsByTagName(o)[0]; // eslint-disable-line no-sequences
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
      })(window, document, 'script', `${document.location.protocol === 'https:' ? 'https:' : 'http:'}//www.google-analytics.com/analytics.js`, 'googleAnalytics');

      // Applies custom dimensions that are common for our main, third-party, and phet-io tracker
      const phetPageviewOptions = {};
      if (phet.chipper.project) {
        phetPageviewOptions.dimension1 = phet.chipper.project; // simName custom dimension
      }

      if (phet.chipper.version) {
        phetPageviewOptions.dimension2 = phet.chipper.version; // simVersion custom dimension
      }

      if (phet.chipper.locale) {
        phetPageviewOptions.dimension3 = phet.chipper.locale; // simLocale custom dimension
      }

      if (phet.chipper.buildTimestamp) {
        phetPageviewOptions.dimension4 = phet.chipper.buildTimestamp; // simBuildTimestamp custom dimension
      }

      phetPageviewOptions.dimension5 = loadType;
      phetPageviewOptions.dimension6 = document.referrer;
      window.googleAnalytics('create', {
        trackingId: phet.chipper.queryParameters.ga,
        storage: 'none',
        cookieDomain: 'none',
        // don't require the tracking from our site
        name: 'external'
      });
      window.googleAnalytics('external.set', 'anonymizeIp', true);
      window.googleAnalytics('external.send', 'pageview', phet.chipper.queryParameters.gaPage || undefined);
    }

    // External GA4 tracker
    if (phet.chipper.queryParameters.ga4) {
      // Use a custom data layer to both (a) get gtag.js and gtm to work at the same time, and (b) don't provide the
      // extra data to third parties by default
      window.ga4DataLayer = window.ga4DataLayer || [];

      // NOTE: Using the GA-provided function here, to be extra cautious.
      function gtag() {
        ga4DataLayer.push(arguments);
      } // eslint-disable-line no-inner-declarations,no-undef,prefer-rest-params

      gtag('js', new Date());
      gtag('consent', 'default', {
        ad_storage: 'denied',
        analytics_storage: 'granted'
      });
      // EEA analytics storage denied for cookies, see https://github.com/phetsims/website/issues/1190
      gtag('consent', 'default', {
        ad_storage: 'denied',
        analytics_storage: 'denied',
        region: ['BE', 'BG', 'CZ', 'DK', 'CY', 'LV', 'LT', 'LU', 'ES', 'FR', 'HR', 'IT', 'PL', 'PT', 'RO', 'SI', 'HU', 'MT', 'NL', 'AT', 'IS', 'LI', 'NO', 'SK', 'FI', 'SE', 'DE', 'EE', 'IE', 'EL']
      });
      gtag('config', phet.chipper.queryParameters.ga4);

      // Dynamically load the script
      const firstScript = document.getElementsByTagName('script')[0];
      const script = document.createElement('script');
      script.async = true;

      // `l` query parameter allows a different data layer name
      script.src = `https://www.googletagmanager.com/gtag/js?id=${phet.chipper.queryParameters.ga4}&l=ga4DataLayer`;
      firstScript.parentNode.insertBefore(script, firstScript);
    }

    // For some reason, having dataLayer declaration here might have fixed the ability to use gtag.js and gtm.js at the
    // same time. Don't move without testing.
    window.dataLayer = window.dataLayer || [];
    function gtmTag() {
      window.dataLayer.push(arguments); // eslint-disable-line prefer-rest-params
    }

    gtmTag('consent', 'default', {
      ad_storage: 'denied',
      analytics_storage: 'granted'
    });
    // EEA analytics storage denied for cookies, see https://github.com/phetsims/website/issues/1190
    gtmTag('consent', 'default', {
      ad_storage: 'denied',
      analytics_storage: 'denied',
      region: ['BE', 'BG', 'CZ', 'DK', 'CY', 'LV', 'LT', 'LU', 'ES', 'FR', 'HR', 'IT', 'PL', 'PT', 'RO', 'SI', 'HU', 'MT', 'NL', 'AT', 'IS', 'LI', 'NO', 'SK', 'FI', 'SE', 'DE', 'EE', 'IE', 'EL']
    });
    window.dataLayer.push({
      simBrand: phet.chipper.brand,
      simName: phet.chipper.project,
      simVersion: phet.chipper.version,
      simLocale: phet.chipper.locale,
      simBuildTimestamp: phet.chipper.buildTimestamp,
      simLoadType: loadType,
      documentReferrer: document.referrer
    });

    // Google Tag Manager (gtm.js) - Identical to recommended snippet with eslint disables to keep it this way.
    (function (w, d, s, l, i) {
      w[l] = w[l] || [];
      w[l].push({
        'gtm.start': new Date().getTime(),
        event: 'gtm.js'
      });
      var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != 'dataLayer' ? '&l=' + l : '';
      j.async = true;
      j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
      f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-WLNGBXD'); // eslint-disable-line space-infix-ops,space-in-parens,comma-spacing,key-spacing,one-var,semi-spacing,eqeqeq,computed-property-spacing,no-var,one-var-declaration-per-line,object-curly-spacing,space-before-blocks
  }

  if (loadType === 'phet-app') {
    window.addEventListener('load', () => {
      setTimeout(sendMessages, 0); // eslint-disable-line bad-sim-text
    }, false);
  } else {
    sendMessages();
  }
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJhc3NlcnQiLCJ3aW5kb3ciLCJwaGV0IiwiY2hpcHBlciIsImJyYW5kIiwicXVlcnlQYXJhbWV0ZXJzIiwiYnVpbGRUaW1lc3RhbXAiLCJwcm9qZWN0IiwidmVyc2lvbiIsImxvY2FsZSIsInVhIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiaGFzSUVTZWN1cml0eVJlc3RyaWN0aW9ucyIsIm1hdGNoIiwibG9jYXRpb24iLCJwcm90b2NvbCIsImxvYWRUeXBlIiwidG9wIiwic2VsZiIsInNlbmRNZXNzYWdlcyIsImdvb2dsZUFuYWx5dGljc0Vycm9yZWQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJ0YXJnZXQiLCJzcmMiLCJpbmRleE9mIiwicGluZ1BhcmFtcyIsImVuY29kZVVSSUNvbXBvbmVudCIsImRvY3VtZW50IiwiZG9tYWluIiwiaHJlZiIsIkRhdGUiLCJub3ciLCJyZWZlcnJlciIsInBpbmdVUkwiLCJ1cmwiLCJpbWciLCJjcmVhdGVFbGVtZW50IiwiZ2EiLCJpIiwicyIsIm8iLCJnIiwiciIsImEiLCJtIiwiR29vZ2xlQW5hbHl0aWNzT2JqZWN0IiwicSIsInB1c2giLCJhcmd1bWVudHMiLCJsIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJhc3luYyIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiLCJwaGV0UGFnZXZpZXdPcHRpb25zIiwiZGltZW5zaW9uMSIsImRpbWVuc2lvbjIiLCJkaW1lbnNpb24zIiwiZGltZW5zaW9uNCIsImRpbWVuc2lvbjUiLCJkaW1lbnNpb242IiwiZ29vZ2xlQW5hbHl0aWNzIiwidHJhY2tpbmdJZCIsInN0b3JhZ2UiLCJjb29raWVEb21haW4iLCJuYW1lIiwiZ2FQYWdlIiwidW5kZWZpbmVkIiwiZ2E0IiwiZ2E0RGF0YUxheWVyIiwiZ3RhZyIsImFkX3N0b3JhZ2UiLCJhbmFseXRpY3Nfc3RvcmFnZSIsInJlZ2lvbiIsImZpcnN0U2NyaXB0Iiwic2NyaXB0IiwiZGF0YUxheWVyIiwiZ3RtVGFnIiwic2ltQnJhbmQiLCJzaW1OYW1lIiwic2ltVmVyc2lvbiIsInNpbUxvY2FsZSIsInNpbUJ1aWxkVGltZXN0YW1wIiwic2ltTG9hZFR5cGUiLCJkb2N1bWVudFJlZmVycmVyIiwidyIsImQiLCJnZXRUaW1lIiwiZiIsImoiLCJkbCIsInNldFRpbWVvdXQiXSwic291cmNlcyI6WyJnb29nbGUtYW5hbHl0aWNzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDEyLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEdvb2dsZSBhbmFseXRpY3MgY29sbGVjdGlvbiBmb3IgSFRNTDUgc2ltcy5cclxuICogQ29kZSBwcm92aWRlZCBieSBHb29nbGUgYW5kIEhld2xldHQsIHBvc3NpYmx5IGRvY3RvcmVkIGJ5IFBoRVQuXHJcbiAqXHJcbiAqIE5PVEU6IFBsZWFzZSBiZSBjYXJlZnVsIGFib3V0IG1vZGlmaWNhdGlvbnMsIGFzIGl0IHJlbGllcyBvbiBleHRlcm5hbCBzY3JpcHRzLlxyXG4gKlxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcbiAgXHJcblxyXG4gIGFzc2VydCAmJiBhc3NlcnQoIHdpbmRvdy5waGV0ICYmIHBoZXQuY2hpcHBlciwgJ1dlIHdpbGwgcmVxdWlyZSBtdWx0aXBsZSB0aGluZ3MgZnJvbSB0aGUgY2hpcHBlciBwcmVsb2FkIG5hbWVzcGFjZScgKTtcclxuICBhc3NlcnQgJiYgYXNzZXJ0KCAhIXBoZXQuY2hpcHBlci5icmFuZCwgJ0EgYnJhbmQgaXMgcmVxdWlyZWQsIHNpbmNlIHNvbWUgbWVzc2FnZXMgZGVwZW5kIG9uIHRoZSBicmFuZCcgKTtcclxuICBhc3NlcnQgJiYgYXNzZXJ0KCAhIXBoZXQuY2hpcHBlci5xdWVyeVBhcmFtZXRlcnMsICdXZSB3aWxsIG5lZWQgcXVlcnkgcGFyYW1ldGVycyB0byBiZSBwYXJzZWQgZm9yIG11bHRpcGxlIHB1cnBvc2VzJyApO1xyXG4gIGFzc2VydCAmJiBhc3NlcnQoICEhcGhldC5jaGlwcGVyLmJ1aWxkVGltZXN0YW1wLCAnYnVpbGRUaW1lc3RhbXAgaXMgcmVxdWlyZWQgZm9yIEdBIG1lc3NhZ2VzJyApO1xyXG4gIGFzc2VydCAmJiBhc3NlcnQoICEhcGhldC5jaGlwcGVyLnByb2plY3QsICdwcm9qZWN0IGlzIHJlcXVpcmVkIGZvciBHQSBtZXNzYWdlcycgKTtcclxuICBhc3NlcnQgJiYgYXNzZXJ0KCAhIXBoZXQuY2hpcHBlci52ZXJzaW9uLCAndmVyc2lvbiBpcyByZXF1aXJlZCBmb3IgR0EgbWVzc2FnZXMnICk7XHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggISFwaGV0LmNoaXBwZXIubG9jYWxlLCAnbG9jYWxlIGlzIHJlcXVpcmVkIGZvciBHQSBtZXNzYWdlcycgKTtcclxuXHJcbiAgY29uc3QgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xyXG4gIGNvbnN0IGhhc0lFU2VjdXJpdHlSZXN0cmljdGlvbnMgPSAhISggdWEubWF0Y2goIC9NU0lFLyApIHx8IHVhLm1hdGNoKCAvVHJpZGVudFxcLy8gKSB8fCB1YS5tYXRjaCggL0VkZ2VcXC8vICkgKTtcclxuXHJcbiAgLy8gSWYgd2UncmUgaW4gc29tZSBmb3JtIG9mIElFIHJ1bm5pbmcgb2ZmbGluZSwgZG9uJ3QgYXR0ZW1wdCB0byBtYWtlIGEgY3Jvc3Mtb3JpZ2luIHJlcXVlc3QuXHJcbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9qb2lzdC9pc3N1ZXMvMTY0XHJcbiAgaWYgKCB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdmaWxlOicgJiYgaGFzSUVTZWN1cml0eVJlc3RyaWN0aW9ucyApIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIC8vIERvbid0IHRyYWNrIHNpbXMgdGhhdCB3ZSBkaWRuJ3QgZGV2ZWxvcFxyXG4gIGlmICggcGhldC5jaGlwcGVyLmJyYW5kICE9PSAncGhldCcgJiYgcGhldC5jaGlwcGVyLmJyYW5kICE9PSAncGhldC1pbycgKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBsZXQgbG9hZFR5cGU7XHJcbiAgLy8gVGhpcyBpcyB0aGUgaU9TIGFwcFxyXG4gIGlmICggcGhldC5jaGlwcGVyLnF1ZXJ5UGFyYW1ldGVyc1sgJ3BoZXQtYXBwJyBdICkge1xyXG4gICAgbG9hZFR5cGUgPSAncGhldC1hcHAnO1xyXG4gIH1cclxuICAvLyBGb3IgdGhlIEFuZHJvaWQgYXBwLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3BoZXQtYW5kcm9pZC1hcHAvaXNzdWVzLzE2XHJcbiAgZWxzZSBpZiAoIHBoZXQuY2hpcHBlci5xdWVyeVBhcmFtZXRlcnNbICdwaGV0LWFuZHJvaWQtYXBwJyBdICkge1xyXG4gICAgbG9hZFR5cGUgPSAncGhldC1hbmRyb2lkLWFwcCc7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKCB0b3AgIT09IHNlbGYgKSB7XHJcbiAgICAvLyBDaGVja3MgdG8gc2VlIGlmIHRoaXMgc2ltIGlzIGVtYmVkZGVkIC0gcGhldHNpbXMvY2hpcHBlciM1MFxyXG4gICAgbG9hZFR5cGUgPSAnZW1iZWRkZWQnO1xyXG4gIH1cclxuICAvLyBUT0RPIEFkZCBhZGRpdGlvbmFsIGNvbmRpdGlvbnMgZm9yIHRyYWNraW5nIGhpdHMgZnJvbSB0aGUgaW5zdGFsbGVyLCBldGMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvcGhldGNvbW1vbi9pc3N1ZXMvNDlcclxuICBlbHNlIHtcclxuICAgIGxvYWRUeXBlID0gJ2RlZmF1bHQnO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2VuZE1lc3NhZ2VzKCkge1xyXG4gICAgLy8ge2Jvb2xlYW59IC0gV2hldGhlciBhbiBlcnJvciB3YXMgZGV0ZWN0ZWQgd2l0aCBhbnl0aGluZyByZWxhdGluZyB0byBnb29nbGUgYW5hbHl0aWNzLlxyXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy95b3R0YS9pc3N1ZXMvMzBcclxuICAgIGxldCBnb29nbGVBbmFseXRpY3NFcnJvcmVkID0gZmFsc2U7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ2Vycm9yJywgZXZlbnQgPT4ge1xyXG4gICAgICBpZiAoIGV2ZW50ICYmXHJcbiAgICAgICAgICAgZXZlbnQudGFyZ2V0ICYmXHJcbiAgICAgICAgICAgZXZlbnQudGFyZ2V0LnNyYyAmJlxyXG4gICAgICAgICAgIGV2ZW50LnRhcmdldC5zcmMuaW5kZXhPZiAmJlxyXG4gICAgICAgICAgIGV2ZW50LnRhcmdldC5zcmMuaW5kZXhPZiggJ2dvb2dsZS1hbmFseXRpY3MnICkgPj0gMCApIHtcclxuICAgICAgICBnb29nbGVBbmFseXRpY3NFcnJvcmVkID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfSwgdHJ1ZSApO1xyXG5cclxuICAgIGNvbnN0IHBpbmdQYXJhbXMgPSBgJHsncGluZ3Zlcj0zJicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICdwcm9qZWN0PSd9JHtlbmNvZGVVUklDb21wb25lbnQoIHBoZXQuY2hpcHBlci5wcm9qZWN0ICl9JmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGBicmFuZD0ke2VuY29kZVVSSUNvbXBvbmVudCggcGhldC5jaGlwcGVyLmJyYW5kICl9JmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGB2ZXJzaW9uPSR7ZW5jb2RlVVJJQ29tcG9uZW50KCBwaGV0LmNoaXBwZXIudmVyc2lvbiApfSZgICtcclxuICAgICAgICAgICAgICAgICAgICAgICBgbG9jYWxlPSR7ZW5jb2RlVVJJQ29tcG9uZW50KCBwaGV0LmNoaXBwZXIubG9jYWxlICl9JmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGBidWlsZFRpbWVzdGFtcD0ke2VuY29kZVVSSUNvbXBvbmVudCggcGhldC5jaGlwcGVyLmJ1aWxkVGltZXN0YW1wICl9JmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGBkb21haW49JHtlbmNvZGVVUklDb21wb25lbnQoIGRvY3VtZW50LmRvbWFpbiApfSZgICtcclxuICAgICAgICAgICAgICAgICAgICAgICBgaHJlZj0ke2VuY29kZVVSSUNvbXBvbmVudCggd2luZG93LmxvY2F0aW9uLmhyZWYgKX0mYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGU9aHRtbCYnICtcclxuICAgICAgICAgICAgICAgICAgICAgICBgdGltZXN0YW1wPSR7ZW5jb2RlVVJJQ29tcG9uZW50KCBEYXRlLm5vdygpICl9JmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGBsb2FkVHlwZT0ke2VuY29kZVVSSUNvbXBvbmVudCggbG9hZFR5cGUgKX0mYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgYHJlZj0ke2VuY29kZVVSSUNvbXBvbmVudCggZG9jdW1lbnQucmVmZXJyZXIgKX1gO1xyXG5cclxuICAgIGZ1bmN0aW9uIHBpbmdVUkwoIHVybCApIHtcclxuICAgICAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2ltZycgKTtcclxuICAgICAgaW1nLnNyYyA9IHVybDtcclxuICAgIH1cclxuXHJcbiAgICBwaW5nVVJMKCBgaHR0cHM6Ly9waGV0LmNvbG9yYWRvLmVkdS95b3R0YS9pbW1lZGlhdGUuZ2lmPyR7cGluZ1BhcmFtc31gICk7XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdsb2FkJywgZXZlbnQgPT4ge1xyXG4gICAgICBwaW5nVVJMKCBgaHR0cHM6Ly9waGV0LmNvbG9yYWRvLmVkdS95b3R0YS9zYW5pdHkuZ2lmPyR7cGluZ1BhcmFtc30mYCArXHJcbiAgICAgICAgICAgICAgIGBnYUVycm9yPSR7ZW5jb2RlVVJJQ29tcG9uZW50KCBnb29nbGVBbmFseXRpY3NFcnJvcmVkICl9JmAgK1xyXG4gICAgICAgICAgICAgICBgZ2FMb2FkZWQ9JHtlbmNvZGVVUklDb21wb25lbnQoIGZhbHNlICl9YCApO1xyXG4gICAgfSwgZmFsc2UgKTtcclxuXHJcbiAgICAvLyBFeHRlcm5hbCBVQSAoR29vZ2xlIEFuYWx5dGljcykgdHJhY2tlclxyXG4gICAgaWYgKCBwaGV0LmNoaXBwZXIucXVlcnlQYXJhbWV0ZXJzLmdhICkge1xyXG4gICAgICAvLyBHb29nbGUgQW5hbHl0aWNzIHNuaXBwZXQgZm9yIGxvYWRpbmcgdGhlIEFQSVxyXG4gICAgICAoIGZ1bmN0aW9uKCBpLCBzLCBvLCBnLCByLCBhLCBtICkge1xyXG4gICAgICAgIGkuR29vZ2xlQW5hbHl0aWNzT2JqZWN0ID0gcjtcclxuICAgICAgICBpWyByIF0gPSBpWyByIF0gfHwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXJlc3QtcGFyYW1zXHJcbiAgICAgICAgICAoIGlbIHIgXS5xID0gaVsgciBdLnEgfHwgW10gKS5wdXNoKCBhcmd1bWVudHMgKTtcclxuICAgICAgICB9LCBpWyByIF0ubCA9IDEgKiBuZXcgRGF0ZSgpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNlcXVlbmNlc1xyXG4gICAgICAgIGEgPSBzLmNyZWF0ZUVsZW1lbnQoIG8gKSwgbSA9IHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIG8gKVsgMCBdOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNlcXVlbmNlc1xyXG4gICAgICAgIGEuYXN5bmMgPSAxO1xyXG4gICAgICAgIGEuc3JjID0gZztcclxuICAgICAgICBtLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCBhLCBtICk7XHJcbiAgICAgIH0gKSggd2luZG93LCBkb2N1bWVudCwgJ3NjcmlwdCcsIGAke2RvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6JyA/ICdodHRwczonIDogJ2h0dHA6J30vL3d3dy5nb29nbGUtYW5hbHl0aWNzLmNvbS9hbmFseXRpY3MuanNgLCAnZ29vZ2xlQW5hbHl0aWNzJyApO1xyXG5cclxuICAgICAgLy8gQXBwbGllcyBjdXN0b20gZGltZW5zaW9ucyB0aGF0IGFyZSBjb21tb24gZm9yIG91ciBtYWluLCB0aGlyZC1wYXJ0eSwgYW5kIHBoZXQtaW8gdHJhY2tlclxyXG4gICAgICBjb25zdCBwaGV0UGFnZXZpZXdPcHRpb25zID0ge307XHJcblxyXG4gICAgICBpZiAoIHBoZXQuY2hpcHBlci5wcm9qZWN0ICkge1xyXG4gICAgICAgIHBoZXRQYWdldmlld09wdGlvbnMuZGltZW5zaW9uMSA9IHBoZXQuY2hpcHBlci5wcm9qZWN0OyAvLyBzaW1OYW1lIGN1c3RvbSBkaW1lbnNpb25cclxuICAgICAgfVxyXG4gICAgICBpZiAoIHBoZXQuY2hpcHBlci52ZXJzaW9uICkge1xyXG4gICAgICAgIHBoZXRQYWdldmlld09wdGlvbnMuZGltZW5zaW9uMiA9IHBoZXQuY2hpcHBlci52ZXJzaW9uOyAvLyBzaW1WZXJzaW9uIGN1c3RvbSBkaW1lbnNpb25cclxuICAgICAgfVxyXG4gICAgICBpZiAoIHBoZXQuY2hpcHBlci5sb2NhbGUgKSB7XHJcbiAgICAgICAgcGhldFBhZ2V2aWV3T3B0aW9ucy5kaW1lbnNpb24zID0gcGhldC5jaGlwcGVyLmxvY2FsZTsgLy8gc2ltTG9jYWxlIGN1c3RvbSBkaW1lbnNpb25cclxuICAgICAgfVxyXG4gICAgICBpZiAoIHBoZXQuY2hpcHBlci5idWlsZFRpbWVzdGFtcCApIHtcclxuICAgICAgICBwaGV0UGFnZXZpZXdPcHRpb25zLmRpbWVuc2lvbjQgPSBwaGV0LmNoaXBwZXIuYnVpbGRUaW1lc3RhbXA7IC8vIHNpbUJ1aWxkVGltZXN0YW1wIGN1c3RvbSBkaW1lbnNpb25cclxuICAgICAgfVxyXG4gICAgICBwaGV0UGFnZXZpZXdPcHRpb25zLmRpbWVuc2lvbjUgPSBsb2FkVHlwZTtcclxuICAgICAgcGhldFBhZ2V2aWV3T3B0aW9ucy5kaW1lbnNpb242ID0gZG9jdW1lbnQucmVmZXJyZXI7XHJcblxyXG4gICAgICB3aW5kb3cuZ29vZ2xlQW5hbHl0aWNzKCAnY3JlYXRlJywge1xyXG4gICAgICAgIHRyYWNraW5nSWQ6IHBoZXQuY2hpcHBlci5xdWVyeVBhcmFtZXRlcnMuZ2EsXHJcbiAgICAgICAgc3RvcmFnZTogJ25vbmUnLFxyXG4gICAgICAgIGNvb2tpZURvbWFpbjogJ25vbmUnLCAvLyBkb24ndCByZXF1aXJlIHRoZSB0cmFja2luZyBmcm9tIG91ciBzaXRlXHJcbiAgICAgICAgbmFtZTogJ2V4dGVybmFsJ1xyXG4gICAgICB9ICk7XHJcbiAgICAgIHdpbmRvdy5nb29nbGVBbmFseXRpY3MoICdleHRlcm5hbC5zZXQnLCAnYW5vbnltaXplSXAnLCB0cnVlICk7XHJcbiAgICAgIHdpbmRvdy5nb29nbGVBbmFseXRpY3MoICdleHRlcm5hbC5zZW5kJywgJ3BhZ2V2aWV3JywgcGhldC5jaGlwcGVyLnF1ZXJ5UGFyYW1ldGVycy5nYVBhZ2UgfHwgdW5kZWZpbmVkICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRXh0ZXJuYWwgR0E0IHRyYWNrZXJcclxuICAgIGlmICggcGhldC5jaGlwcGVyLnF1ZXJ5UGFyYW1ldGVycy5nYTQgKSB7XHJcbiAgICAgIC8vIFVzZSBhIGN1c3RvbSBkYXRhIGxheWVyIHRvIGJvdGggKGEpIGdldCBndGFnLmpzIGFuZCBndG0gdG8gd29yayBhdCB0aGUgc2FtZSB0aW1lLCBhbmQgKGIpIGRvbid0IHByb3ZpZGUgdGhlXHJcbiAgICAgIC8vIGV4dHJhIGRhdGEgdG8gdGhpcmQgcGFydGllcyBieSBkZWZhdWx0XHJcbiAgICAgIHdpbmRvdy5nYTREYXRhTGF5ZXIgPSB3aW5kb3cuZ2E0RGF0YUxheWVyIHx8IFtdO1xyXG5cclxuICAgICAgLy8gTk9URTogVXNpbmcgdGhlIEdBLXByb3ZpZGVkIGZ1bmN0aW9uIGhlcmUsIHRvIGJlIGV4dHJhIGNhdXRpb3VzLlxyXG4gICAgICBmdW5jdGlvbiBndGFnKCkgeyBnYTREYXRhTGF5ZXIucHVzaCggYXJndW1lbnRzICk7IH0gLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1pbm5lci1kZWNsYXJhdGlvbnMsbm8tdW5kZWYscHJlZmVyLXJlc3QtcGFyYW1zXHJcblxyXG4gICAgICBndGFnKCAnanMnLCBuZXcgRGF0ZSgpICk7XHJcbiAgICAgIGd0YWcoICdjb25zZW50JywgJ2RlZmF1bHQnLCB7XHJcbiAgICAgICAgYWRfc3RvcmFnZTogJ2RlbmllZCcsXHJcbiAgICAgICAgYW5hbHl0aWNzX3N0b3JhZ2U6ICdncmFudGVkJ1xyXG4gICAgICB9ICk7XHJcbiAgICAgIC8vIEVFQSBhbmFseXRpY3Mgc3RvcmFnZSBkZW5pZWQgZm9yIGNvb2tpZXMsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvd2Vic2l0ZS9pc3N1ZXMvMTE5MFxyXG4gICAgICBndGFnKCAnY29uc2VudCcsICdkZWZhdWx0Jywge1xyXG4gICAgICAgIGFkX3N0b3JhZ2U6ICdkZW5pZWQnLFxyXG4gICAgICAgIGFuYWx5dGljc19zdG9yYWdlOiAnZGVuaWVkJyxcclxuICAgICAgICByZWdpb246IFsgJ0JFJywgJ0JHJywgJ0NaJywgJ0RLJywgJ0NZJywgJ0xWJywgJ0xUJywgJ0xVJywgJ0VTJywgJ0ZSJywgJ0hSJywgJ0lUJywgJ1BMJywgJ1BUJywgJ1JPJywgJ1NJJywgJ0hVJywgJ01UJywgJ05MJywgJ0FUJywgJ0lTJywgJ0xJJywgJ05PJywgJ1NLJywgJ0ZJJywgJ1NFJywgJ0RFJywgJ0VFJywgJ0lFJywgJ0VMJyBdXHJcbiAgICAgIH0gKTtcclxuICAgICAgZ3RhZyggJ2NvbmZpZycsIHBoZXQuY2hpcHBlci5xdWVyeVBhcmFtZXRlcnMuZ2E0ICk7XHJcblxyXG4gICAgICAvLyBEeW5hbWljYWxseSBsb2FkIHRoZSBzY3JpcHRcclxuICAgICAgY29uc3QgZmlyc3RTY3JpcHQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSggJ3NjcmlwdCcgKVsgMCBdO1xyXG4gICAgICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnc2NyaXB0JyApO1xyXG4gICAgICBzY3JpcHQuYXN5bmMgPSB0cnVlO1xyXG5cclxuICAgICAgLy8gYGxgIHF1ZXJ5IHBhcmFtZXRlciBhbGxvd3MgYSBkaWZmZXJlbnQgZGF0YSBsYXllciBuYW1lXHJcbiAgICAgIHNjcmlwdC5zcmMgPSBgaHR0cHM6Ly93d3cuZ29vZ2xldGFnbWFuYWdlci5jb20vZ3RhZy9qcz9pZD0ke3BoZXQuY2hpcHBlci5xdWVyeVBhcmFtZXRlcnMuZ2E0fSZsPWdhNERhdGFMYXllcmA7XHJcbiAgICAgIGZpcnN0U2NyaXB0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCBzY3JpcHQsIGZpcnN0U2NyaXB0ICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRm9yIHNvbWUgcmVhc29uLCBoYXZpbmcgZGF0YUxheWVyIGRlY2xhcmF0aW9uIGhlcmUgbWlnaHQgaGF2ZSBmaXhlZCB0aGUgYWJpbGl0eSB0byB1c2UgZ3RhZy5qcyBhbmQgZ3RtLmpzIGF0IHRoZVxyXG4gICAgLy8gc2FtZSB0aW1lLiBEb24ndCBtb3ZlIHdpdGhvdXQgdGVzdGluZy5cclxuICAgIHdpbmRvdy5kYXRhTGF5ZXIgPSB3aW5kb3cuZGF0YUxheWVyIHx8IFtdO1xyXG4gICAgZnVuY3Rpb24gZ3RtVGFnKCkge1xyXG4gICAgICAgIHdpbmRvdy5kYXRhTGF5ZXIucHVzaCggYXJndW1lbnRzICk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcHJlZmVyLXJlc3QtcGFyYW1zXHJcbiAgICB9XHJcbiAgICBndG1UYWcoICdjb25zZW50JywgJ2RlZmF1bHQnLCB7XHJcbiAgICAgIGFkX3N0b3JhZ2U6ICdkZW5pZWQnLFxyXG4gICAgICBhbmFseXRpY3Nfc3RvcmFnZTogJ2dyYW50ZWQnXHJcbiAgICB9ICk7XHJcbiAgICAvLyBFRUEgYW5hbHl0aWNzIHN0b3JhZ2UgZGVuaWVkIGZvciBjb29raWVzLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3dlYnNpdGUvaXNzdWVzLzExOTBcclxuICAgIGd0bVRhZyggJ2NvbnNlbnQnLCAnZGVmYXVsdCcsIHtcclxuICAgICAgYWRfc3RvcmFnZTogJ2RlbmllZCcsXHJcbiAgICAgIGFuYWx5dGljc19zdG9yYWdlOiAnZGVuaWVkJyxcclxuICAgICAgcmVnaW9uOiBbICdCRScsICdCRycsICdDWicsICdESycsICdDWScsICdMVicsICdMVCcsICdMVScsICdFUycsICdGUicsICdIUicsICdJVCcsICdQTCcsICdQVCcsICdSTycsICdTSScsICdIVScsICdNVCcsICdOTCcsICdBVCcsICdJUycsICdMSScsICdOTycsICdTSycsICdGSScsICdTRScsICdERScsICdFRScsICdJRScsICdFTCcgXVxyXG4gICAgfSApO1xyXG4gICAgd2luZG93LmRhdGFMYXllci5wdXNoKCB7XHJcbiAgICAgIHNpbUJyYW5kOiBwaGV0LmNoaXBwZXIuYnJhbmQsXHJcbiAgICAgIHNpbU5hbWU6IHBoZXQuY2hpcHBlci5wcm9qZWN0LFxyXG4gICAgICBzaW1WZXJzaW9uOiBwaGV0LmNoaXBwZXIudmVyc2lvbixcclxuICAgICAgc2ltTG9jYWxlOiBwaGV0LmNoaXBwZXIubG9jYWxlLFxyXG4gICAgICBzaW1CdWlsZFRpbWVzdGFtcDogcGhldC5jaGlwcGVyLmJ1aWxkVGltZXN0YW1wLFxyXG4gICAgICBzaW1Mb2FkVHlwZTogbG9hZFR5cGUsXHJcbiAgICAgIGRvY3VtZW50UmVmZXJyZXI6IGRvY3VtZW50LnJlZmVycmVyXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gR29vZ2xlIFRhZyBNYW5hZ2VyIChndG0uanMpIC0gSWRlbnRpY2FsIHRvIHJlY29tbWVuZGVkIHNuaXBwZXQgd2l0aCBlc2xpbnQgZGlzYWJsZXMgdG8ga2VlcCBpdCB0aGlzIHdheS5cclxuICAgIChmdW5jdGlvbih3LGQscyxsLGkpe3dbbF09d1tsXXx8W107d1tsXS5wdXNoKHsnZ3RtLnN0YXJ0JzpuZXcgRGF0ZSgpLmdldFRpbWUoKSxldmVudDonZ3RtLmpzJ30pO3ZhciBmPWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUocylbMF0saj1kLmNyZWF0ZUVsZW1lbnQocyksZGw9bCE9J2RhdGFMYXllcic/JyZsPScrbDonJztqLmFzeW5jPXRydWU7ai5zcmM9J2h0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0bS5qcz9pZD0nK2krZGw7Zi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShqLGYpO30pKHdpbmRvdyxkb2N1bWVudCwnc2NyaXB0JywnZGF0YUxheWVyJywnR1RNLVdMTkdCWEQnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBzcGFjZS1pbmZpeC1vcHMsc3BhY2UtaW4tcGFyZW5zLGNvbW1hLXNwYWNpbmcsa2V5LXNwYWNpbmcsb25lLXZhcixzZW1pLXNwYWNpbmcsZXFlcWVxLGNvbXB1dGVkLXByb3BlcnR5LXNwYWNpbmcsbm8tdmFyLG9uZS12YXItZGVjbGFyYXRpb24tcGVyLWxpbmUsb2JqZWN0LWN1cmx5LXNwYWNpbmcsc3BhY2UtYmVmb3JlLWJsb2Nrc1xyXG4gIH1cclxuXHJcbiAgaWYgKCBsb2FkVHlwZSA9PT0gJ3BoZXQtYXBwJyApIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsICgpID0+IHtcclxuICAgICAgc2V0VGltZW91dCggc2VuZE1lc3NhZ2VzLCAwICk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgYmFkLXNpbS10ZXh0XHJcbiAgICB9LCBmYWxzZSApO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIHNlbmRNZXNzYWdlcygpO1xyXG4gIH1cclxufSApKCk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxDQUFFLFlBQVc7RUFHWEEsTUFBTSxJQUFJQSxNQUFNLENBQUVDLE1BQU0sQ0FBQ0MsSUFBSSxJQUFJQSxJQUFJLENBQUNDLE9BQU8sRUFBRSxvRUFBcUUsQ0FBQztFQUNySEgsTUFBTSxJQUFJQSxNQUFNLENBQUUsQ0FBQyxDQUFDRSxJQUFJLENBQUNDLE9BQU8sQ0FBQ0MsS0FBSyxFQUFFLDhEQUErRCxDQUFDO0VBQ3hHSixNQUFNLElBQUlBLE1BQU0sQ0FBRSxDQUFDLENBQUNFLElBQUks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