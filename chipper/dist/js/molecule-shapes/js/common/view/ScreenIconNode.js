// Copyright 2014-2022, University of Colorado Boulder

/**
 * Dynamically generates the screen icons by rendering 3D scenes into an image and displaying atom labels on top.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Utils from '../../../../dot/js/Utils.js';
import Vector3 from '../../../../dot/js/Vector3.js';
import Screen from '../../../../joist/js/Screen.js';
import Element from '../../../../nitroglycerin/js/Element.js';
import { Image, Node, Text } from '../../../../scenery/js/imports.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import moleculeShapes from '../../moleculeShapes.js';
import MoleculeShapesModel from '../model/MoleculeShapesModel.js';
import PairGroup from '../model/PairGroup.js';
import VSEPRMolecule from '../model/VSEPRMolecule.js';
import MoleculeShapesGlobals from '../MoleculeShapesGlobals.js';
import MoleculeView from './3d/MoleculeView.js';
import MoleculeShapesScreenView from './MoleculeShapesScreenView.js';

/*---------------------------------------------------------------------------*
 * Dynamic generation of the molecules
 *----------------------------------------------------------------------------*/
const scene = new THREE.Scene();
MoleculeShapesScreenView.addLightsToScene(scene);
const renderer = MoleculeShapesGlobals.useWebGLProperty.value ? new THREE.WebGLRenderer({
  antialias: true,
  preserveDrawingBuffer: true,
  // so we can toDataURL() it
  alpha: true // transparency needs to be enabled, even though we don't need it here. see #98
}) : new THREE.CanvasRenderer();
const camera = new THREE.PerspectiveCamera();
function render(view, width, height, isBasicsVersion) {
  scene.add(view);

  // customized colors
  renderer.setClearColor(isBasicsVersion ? 0xc6e2f6 : 0x333333, 1);

  // we want the basics version centered (CO2), but the regular version off-center (so the central atom is higher)
  camera.position.set(0, isBasicsVersion ? 0 : -10, 200);
  camera.fov = 25;
  camera.aspect = width / height;
  camera.near = 1;
  camera.far = 300;
  camera.updateProjectionMatrix();
  renderer.setSize(width, height);
  renderer.render(scene, camera);
  scene.remove(view);
  return renderer.domElement.toDataURL();
}
function getAngle(isModel, isBasicsVersion) {
  if (!isBasicsVersion) {
    // H2O
    return isModel ? Utils.toRadians(120) / 2 : Utils.toRadians(104.5) / 2;
  } else {
    // CO2
    return Math.PI / 2;
  }
}

// since the atoms in the basics version are horizontal, we need to scale it down just a bit
function getRelativeScale(isBasicsVersion) {
  return isBasicsVersion ? 0.95 : 1;
}
function getCentralElement(isBasicsVersion) {
  return isBasicsVersion ? Element.C : Element.O;
}
function getRadialElement(isBasicsVersion) {
  return isBasicsVersion ? Element.O : Element.H;
}
function getBondDataURL(isModel, isBasicsVersion) {
  const angle = getAngle(isModel, isBasicsVersion);
  // basics is CO2, non-basics is H2O
  const centralElement = isModel ? undefined : getCentralElement(isBasicsVersion);
  const radialElement = isModel ? undefined : getRadialElement(isBasicsVersion);
  const bondOrder = isBasicsVersion ? 2 : 1;
  const molecule = new VSEPRMolecule();
  if (!isModel) {
    molecule.isReal = true;
  }
  const centralAtom = new PairGroup(new Vector3(0, 0, 0), false, {
    element: centralElement
  });
  molecule.addCentralAtom(centralAtom);
  molecule.addGroupAndBond(new PairGroup(new Vector3(Math.sin(angle), -Math.cos(angle), 0).times(PairGroup.BONDED_PAIR_DISTANCE), false, {
    element: radialElement
  }), centralAtom, bondOrder);
  molecule.addGroupAndBond(new PairGroup(new Vector3(-Math.sin(angle), -Math.cos(angle), 0).times(PairGroup.BONDED_PAIR_DISTANCE), false, {
    element: radialElement
  }), centralAtom, bondOrder);

  // TODO: This molecule isn't being passed in anymore?
  const model = new MoleculeShapesModel(false, {
    initialMolecule: molecule
  }, Tandem.OPT_OUT);
  const view = new MoleculeView(model, MoleculeShapesScreenView.createAPIStub(renderer), molecule, {
    showLabel: () => {},
    finishedAddingLabels: () => {}
  }, Tandem.OPT_OUT);
  view.updateView();

  // change how atoms/bonds are scaled, so it can appear nicely
  const moleculeScale = 4.5 * getRelativeScale(isBasicsVersion);
  const atomScale = 2;
  const bondScale = 1;
  view.tweakViewScales(moleculeScale, atomScale, bondScale);
  const url = render(view, Screen.MINIMUM_HOME_SCREEN_ICON_SIZE.width, Screen.MINIMUM_HOME_SCREEN_ICON_SIZE.height, isBasicsVersion);
  view.dispose();
  return url;
}
class ScreenIconNode extends Node {
  /**
   * @param {boolean} isModel
   * @param {boolean} isBasicsVersion
   */
  constructor(isModel, isBasicsVersion) {
    super();

    // Firefox doesn't immediately have the correct image bounds, so we set it to be overridden here
    this.localBounds = Screen.MINIMUM_HOME_SCREEN_ICON_SIZE.toBounds();
    const url = getBondDataURL(isModel, isBasicsVersion);
    this.addChild(new Image(url, {
      initialWidth: Screen.MINIMUM_HOME_SCREEN_ICON_SIZE.width,
      initialHeight: Screen.MINIMUM_HOME_SCREEN_ICON_SIZE.height
    }));
    const centralLabel = isModel ? 'A' : getCentralElement(isBasicsVersion).symbol;
    const radialLabel = isModel ? 'X' : getRadialElement(isBasicsVersion).symbol;
    const viewBondDistance = 192 * getRelativeScale(isBasicsVersion);
    const angle = getAngle(isModel, isBasicsVersion);
    const centerX = Screen.MINIMUM_HOME_SCREEN_ICON_SIZE.width * 0.5;
    const centerY = Screen.MINIMUM_HOME_SCREEN_ICON_SIZE.height * (isBasicsVersion ? 0.5 : 0.4);
    this.addChild(new Text(centralLabel, {
      fontSize: 80,
      fill: 'black',
      centerX: centerX,
      centerY: centerY
    }));
    this.addChild(new Text(radialLabel, {
      fontSize: 80,
      fill: 'black',
      centerX: centerX + Math.sin(angle) * viewBondDistance,
      centerY: centerY + Math.cos(angle) * viewBondDistance
    }));
    this.addChild(new Text(radialLabel, {
      fontSize: 80,
      fill: 'black',
      centerX: centerX - Math.sin(angle) * viewBondDistance,
      centerY: centerY + Math.cos(angle) * viewBondDistance
    }));
  }
}
moleculeShapes.register('ScreenIconNode', ScreenIconNode);
export default ScreenIconNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIlZlY3RvcjMiLCJTY3JlZW4iLCJFbGVtZW50IiwiSW1hZ2UiLCJOb2RlIiwiVGV4dCIsIlRhbmRlbSIsIm1vbGVjdWxlU2hhcGVzIiwiTW9sZWN1bGVTaGFwZXNNb2RlbCIsIlBhaXJHcm91cCIsIlZTRVBSTW9sZWN1bGUiLCJNb2xlY3VsZVNoYXBlc0dsb2JhbHMiLCJNb2xlY3VsZVZpZXciLCJNb2xlY3VsZVNoYXBlc1NjcmVlblZpZXciLCJzY2VuZSIsIlRIUkVFIiwiU2NlbmUiLCJhZGRMaWdodHNUb1NjZW5lIiwicmVuZGVyZXIiLCJ1c2VXZWJHTFByb3BlcnR5IiwidmFsdWUiLCJXZWJHTFJlbmRlcmVyIiwiYW50aWFsaWFzIiwicHJlc2VydmVEcmF3aW5nQnVmZmVyIiwiYWxwaGEiLCJDYW52YXNSZW5kZXJlciIsImNhbWVyYSIsIlBlcnNwZWN0aXZlQ2FtZXJhIiwicmVuZGVyIiwidmlldyIsIndpZHRoIiwiaGVpZ2h0IiwiaXNCYXNpY3NWZXJzaW9uIiwiYWRkIiwic2V0Q2xlYXJDb2xvciIsInBvc2l0aW9uIiwic2V0IiwiZm92IiwiYXNwZWN0IiwibmVhciIsImZhciIsInVwZGF0ZVByb2plY3Rpb25NYXRyaXgiLCJzZXRTaXplIiwicmVtb3ZlIiwiZG9tRWxlbWVudCIsInRvRGF0YVVSTCIsImdldEFuZ2xlIiwiaXNNb2RlbCIsInRvUmFkaWFucyIsIk1hdGgiLCJQSSIsImdldFJlbGF0aXZlU2NhbGUiLCJnZXRDZW50cmFsRWxlbWVudCIsIkMiLCJPIiwiZ2V0UmFkaWFsRWxlbWVudCIsIkgiLCJnZXRCb25kRGF0YVVSTCIsImFuZ2xlIiwiY2VudHJhbEVsZW1lbnQiLCJ1bmRlZmluZWQiLCJyYWRpYWxFbGVtZW50IiwiYm9uZE9yZGVyIiwibW9sZWN1bGUiLCJpc1JlYWwiLCJjZW50cmFsQXRvbSIsImVsZW1lbnQiLCJhZGRDZW50cmFsQXRvbSIsImFkZEdyb3VwQW5kQm9uZCIsInNpbiIsImNvcyIsInRpbWVzIiwiQk9OREVEX1BBSVJfRElTVEFOQ0UiLCJtb2RlbCIsImluaXRpYWxNb2xlY3VsZSIsIk9QVF9PVVQiLCJjcmVhdGVBUElTdHViIiwic2hvd0xhYmVsIiwiZmluaXNoZWRBZGRpbmdMYWJlbHMiLCJ1cGRhdGVWaWV3IiwibW9sZWN1bGVTY2FsZSIsImF0b21TY2FsZSIsImJvbmRTY2FsZSIsInR3ZWFrVmlld1NjYWxlcyIsInVybCIsIk1JTklNVU1fSE9NRV9TQ1JFRU5fSUNPTl9TSVpFIiwiZGlzcG9zZSIsIlNjcmVlbkljb25Ob2RlIiwiY29uc3RydWN0b3IiLCJsb2NhbEJvdW5kcyIsInRvQm91bmRzIiwiYWRkQ2hpbGQiLCJpbml0aWFsV2lkdGgiLCJpbml0aWFsSGVpZ2h0IiwiY2VudHJhbExhYmVsIiwic3ltYm9sIiwicmFkaWFsTGFiZWwiLCJ2aWV3Qm9uZERpc3RhbmNlIiwiY2VudGVyWCIsImNlbnRlclkiLCJmb250U2l6ZSIsImZpbGwiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlNjcmVlbkljb25Ob2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIER5bmFtaWNhbGx5IGdlbmVyYXRlcyB0aGUgc2NyZWVuIGljb25zIGJ5IHJlbmRlcmluZyAzRCBzY2VuZXMgaW50byBhbiBpbWFnZSBhbmQgZGlzcGxheWluZyBhdG9tIGxhYmVscyBvbiB0b3AuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1V0aWxzLmpzJztcclxuaW1wb3J0IFZlY3RvcjMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjMuanMnO1xyXG5pbXBvcnQgU2NyZWVuIGZyb20gJy4uLy4uLy4uLy4uL2pvaXN0L2pzL1NjcmVlbi5qcyc7XHJcbmltcG9ydCBFbGVtZW50IGZyb20gJy4uLy4uLy4uLy4uL25pdHJvZ2x5Y2VyaW4vanMvRWxlbWVudC5qcyc7XHJcbmltcG9ydCB7IEltYWdlLCBOb2RlLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IG1vbGVjdWxlU2hhcGVzIGZyb20gJy4uLy4uL21vbGVjdWxlU2hhcGVzLmpzJztcclxuaW1wb3J0IE1vbGVjdWxlU2hhcGVzTW9kZWwgZnJvbSAnLi4vbW9kZWwvTW9sZWN1bGVTaGFwZXNNb2RlbC5qcyc7XHJcbmltcG9ydCBQYWlyR3JvdXAgZnJvbSAnLi4vbW9kZWwvUGFpckdyb3VwLmpzJztcclxuaW1wb3J0IFZTRVBSTW9sZWN1bGUgZnJvbSAnLi4vbW9kZWwvVlNFUFJNb2xlY3VsZS5qcyc7XHJcbmltcG9ydCBNb2xlY3VsZVNoYXBlc0dsb2JhbHMgZnJvbSAnLi4vTW9sZWN1bGVTaGFwZXNHbG9iYWxzLmpzJztcclxuaW1wb3J0IE1vbGVjdWxlVmlldyBmcm9tICcuLzNkL01vbGVjdWxlVmlldy5qcyc7XHJcbmltcG9ydCBNb2xlY3VsZVNoYXBlc1NjcmVlblZpZXcgZnJvbSAnLi9Nb2xlY3VsZVNoYXBlc1NjcmVlblZpZXcuanMnO1xyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qXHJcbiAqIER5bmFtaWMgZ2VuZXJhdGlvbiBvZiB0aGUgbW9sZWN1bGVzXHJcbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbmNvbnN0IHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XHJcbk1vbGVjdWxlU2hhcGVzU2NyZWVuVmlldy5hZGRMaWdodHNUb1NjZW5lKCBzY2VuZSApO1xyXG5cclxuY29uc3QgcmVuZGVyZXIgPSBNb2xlY3VsZVNoYXBlc0dsb2JhbHMudXNlV2ViR0xQcm9wZXJ0eS52YWx1ZSA/IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKCB7XHJcbiAgYW50aWFsaWFzOiB0cnVlLFxyXG4gIHByZXNlcnZlRHJhd2luZ0J1ZmZlcjogdHJ1ZSwgLy8gc28gd2UgY2FuIHRvRGF0YVVSTCgpIGl0XHJcbiAgYWxwaGE6IHRydWUgLy8gdHJhbnNwYXJlbmN5IG5lZWRzIHRvIGJlIGVuYWJsZWQsIGV2ZW4gdGhvdWdoIHdlIGRvbid0IG5lZWQgaXQgaGVyZS4gc2VlICM5OFxyXG59ICkgOiBuZXcgVEhSRUUuQ2FudmFzUmVuZGVyZXIoKTtcclxuXHJcbmNvbnN0IGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSgpO1xyXG5cclxuZnVuY3Rpb24gcmVuZGVyKCB2aWV3LCB3aWR0aCwgaGVpZ2h0LCBpc0Jhc2ljc1ZlcnNpb24gKSB7XHJcbiAgc2NlbmUuYWRkKCB2aWV3ICk7XHJcblxyXG4gIC8vIGN1c3RvbWl6ZWQgY29sb3JzXHJcbiAgcmVuZGVyZXIuc2V0Q2xlYXJDb2xvciggaXNCYXNpY3NWZXJzaW9uID8gMHhjNmUyZjYgOiAweDMzMzMzMywgMSApO1xyXG5cclxuICAvLyB3ZSB3YW50IHRoZSBiYXNpY3MgdmVyc2lvbiBjZW50ZXJlZCAoQ08yKSwgYnV0IHRoZSByZWd1bGFyIHZlcnNpb24gb2ZmLWNlbnRlciAoc28gdGhlIGNlbnRyYWwgYXRvbSBpcyBoaWdoZXIpXHJcbiAgY2FtZXJhLnBvc2l0aW9uLnNldCggMCwgaXNCYXNpY3NWZXJzaW9uID8gMCA6IC0xMCwgMjAwICk7XHJcbiAgY2FtZXJhLmZvdiA9IDI1O1xyXG4gIGNhbWVyYS5hc3BlY3QgPSB3aWR0aCAvIGhlaWdodDtcclxuICBjYW1lcmEubmVhciA9IDE7XHJcbiAgY2FtZXJhLmZhciA9IDMwMDtcclxuICBjYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xyXG5cclxuICByZW5kZXJlci5zZXRTaXplKCB3aWR0aCwgaGVpZ2h0ICk7XHJcbiAgcmVuZGVyZXIucmVuZGVyKCBzY2VuZSwgY2FtZXJhICk7XHJcbiAgc2NlbmUucmVtb3ZlKCB2aWV3ICk7XHJcblxyXG4gIHJldHVybiByZW5kZXJlci5kb21FbGVtZW50LnRvRGF0YVVSTCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRBbmdsZSggaXNNb2RlbCwgaXNCYXNpY3NWZXJzaW9uICkge1xyXG4gIGlmICggIWlzQmFzaWNzVmVyc2lvbiApIHtcclxuICAgIC8vIEgyT1xyXG4gICAgcmV0dXJuIGlzTW9kZWwgPyBVdGlscy50b1JhZGlhbnMoIDEyMCApIC8gMiA6IFV0aWxzLnRvUmFkaWFucyggMTA0LjUgKSAvIDI7XHJcbiAgfVxyXG4gIGVsc2Uge1xyXG4gICAgLy8gQ08yXHJcbiAgICByZXR1cm4gTWF0aC5QSSAvIDI7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBzaW5jZSB0aGUgYXRvbXMgaW4gdGhlIGJhc2ljcyB2ZXJzaW9uIGFyZSBob3Jpem9udGFsLCB3ZSBuZWVkIHRvIHNjYWxlIGl0IGRvd24ganVzdCBhIGJpdFxyXG5mdW5jdGlvbiBnZXRSZWxhdGl2ZVNjYWxlKCBpc0Jhc2ljc1ZlcnNpb24gKSB7XHJcbiAgcmV0dXJuIGlzQmFzaWNzVmVyc2lvbiA/IDAuOTUgOiAxO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRDZW50cmFsRWxlbWVudCggaXNCYXNpY3NWZXJzaW9uICkge1xyXG4gIHJldHVybiBpc0Jhc2ljc1ZlcnNpb24gPyBFbGVtZW50LkMgOiBFbGVtZW50Lk87XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFJhZGlhbEVsZW1lbnQoIGlzQmFzaWNzVmVyc2lvbiApIHtcclxuICByZXR1cm4gaXNCYXNpY3NWZXJzaW9uID8gRWxlbWVudC5PIDogRWxlbWVudC5IO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRCb25kRGF0YVVSTCggaXNNb2RlbCwgaXNCYXNpY3NWZXJzaW9uICkge1xyXG4gIGNvbnN0IGFuZ2xlID0gZ2V0QW5nbGUoIGlzTW9kZWwsIGlzQmFzaWNzVmVyc2lvbiApO1xyXG4gIC8vIGJhc2ljcyBpcyBDTzIsIG5vbi1iYXNpY3MgaXMgSDJPXHJcbiAgY29uc3QgY2VudHJhbEVsZW1lbnQgPSBpc01vZGVsID8gdW5kZWZpbmVkIDogZ2V0Q2VudHJhbEVsZW1lbnQoIGlzQmFzaWNzVmVyc2lvbiApO1xyXG4gIGNvbnN0IHJhZGlhbEVsZW1lbnQgPSBpc01vZGVsID8gdW5kZWZpbmVkIDogZ2V0UmFkaWFsRWxlbWVudCggaXNCYXNpY3NWZXJzaW9uICk7XHJcbiAgY29uc3QgYm9uZE9yZGVyID0gaXNCYXNpY3NWZXJzaW9uID8gMiA6IDE7XHJcblxyXG4gIGNvbnN0IG1vbGVjdWxlID0gbmV3IFZTRVBSTW9sZWN1bGUoKTtcclxuICBpZiAoICFpc01vZGVsICkge1xyXG4gICAgbW9sZWN1bGUuaXNSZWFsID0gdHJ1ZTtcclxuICB9XHJcbiAgY29uc3QgY2VudHJhbEF0b20gPSBuZXcgUGFpckdyb3VwKCBuZXcgVmVjdG9yMyggMCwgMCwgMCApLCBmYWxzZSwge1xyXG4gICAgZWxlbWVudDogY2VudHJhbEVsZW1lbnRcclxuICB9ICk7XHJcbiAgbW9sZWN1bGUuYWRkQ2VudHJhbEF0b20oIGNlbnRyYWxBdG9tICk7XHJcbiAgbW9sZWN1bGUuYWRkR3JvdXBBbmRCb25kKCBuZXcgUGFpckdyb3VwKCBuZXcgVmVjdG9yMyggTWF0aC5zaW4oIGFuZ2xlICksIC1NYXRoLmNvcyggYW5nbGUgKSwgMCApLnRpbWVzKCBQYWlyR3JvdXAuQk9OREVEX1BBSVJfRElTVEFOQ0UgKSwgZmFsc2UsIHsgZWxlbWVudDogcmFkaWFsRWxlbWVudCB9ICksIGNlbnRyYWxBdG9tLCBib25kT3JkZXIgKTtcclxuICBtb2xlY3VsZS5hZGRHcm91cEFuZEJvbmQoIG5ldyBQYWlyR3JvdXAoIG5ldyBWZWN0b3IzKCAtTWF0aC5zaW4oIGFuZ2xlICksIC1NYXRoLmNvcyggYW5nbGUgKSwgMCApLnRpbWVzKCBQYWlyR3JvdXAuQk9OREVEX1BBSVJfRElTVEFOQ0UgKSwgZmFsc2UsIHsgZWxlbWVudDogcmFkaWFsRWxlbWVudCB9ICksIGNlbnRyYWxBdG9tLCBib25kT3JkZXIgKTtcclxuXHJcbiAgLy8gVE9ETzogVGhpcyBtb2xlY3VsZSBpc24ndCBiZWluZyBwYXNzZWQgaW4gYW55bW9yZT9cclxuICBjb25zdCBtb2RlbCA9IG5ldyBNb2xlY3VsZVNoYXBlc01vZGVsKCBmYWxzZSwgeyBpbml0aWFsTW9sZWN1bGU6IG1vbGVjdWxlIH0sIFRhbmRlbS5PUFRfT1VUICk7XHJcblxyXG4gIGNvbnN0IHZpZXcgPSBuZXcgTW9sZWN1bGVWaWV3KCBtb2RlbCwgTW9sZWN1bGVTaGFwZXNTY3JlZW5WaWV3LmNyZWF0ZUFQSVN0dWIoIHJlbmRlcmVyICksIG1vbGVjdWxlLCB7XHJcbiAgICBzaG93TGFiZWw6ICgpID0+IHt9LFxyXG4gICAgZmluaXNoZWRBZGRpbmdMYWJlbHM6ICgpID0+IHt9XHJcbiAgfSwgVGFuZGVtLk9QVF9PVVQgKTtcclxuICB2aWV3LnVwZGF0ZVZpZXcoKTtcclxuXHJcbiAgLy8gY2hhbmdlIGhvdyBhdG9tcy9ib25kcyBhcmUgc2NhbGVkLCBzbyBpdCBjYW4gYXBwZWFyIG5pY2VseVxyXG4gIGNvbnN0IG1vbGVjdWxlU2NhbGUgPSA0LjUgKiBnZXRSZWxhdGl2ZVNjYWxlKCBpc0Jhc2ljc1ZlcnNpb24gKTtcclxuICBjb25zdCBhdG9tU2NhbGUgPSAyO1xyXG4gIGNvbnN0IGJvbmRTY2FsZSA9IDE7XHJcbiAgdmlldy50d2Vha1ZpZXdTY2FsZXMoIG1vbGVjdWxlU2NhbGUsIGF0b21TY2FsZSwgYm9uZFNjYWxlICk7XHJcblxyXG4gIGNvbnN0IHVybCA9IHJlbmRlciggdmlldywgU2NyZWVuLk1JTklNVU1fSE9NRV9TQ1JFRU5fSUNPTl9TSVpFLndpZHRoLCBTY3JlZW4uTUlOSU1VTV9IT01FX1NDUkVFTl9JQ09OX1NJWkUuaGVpZ2h0LCBpc0Jhc2ljc1ZlcnNpb24gKTtcclxuICB2aWV3LmRpc3Bvc2UoKTtcclxuICByZXR1cm4gdXJsO1xyXG59XHJcblxyXG5jbGFzcyBTY3JlZW5JY29uTm9kZSBleHRlbmRzIE5vZGUge1xyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNNb2RlbFxyXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNCYXNpY3NWZXJzaW9uXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIGlzTW9kZWwsIGlzQmFzaWNzVmVyc2lvbiApIHtcclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgLy8gRmlyZWZveCBkb2Vzbid0IGltbWVkaWF0ZWx5IGhhdmUgdGhlIGNvcnJlY3QgaW1hZ2UgYm91bmRzLCBzbyB3ZSBzZXQgaXQgdG8gYmUgb3ZlcnJpZGRlbiBoZXJlXHJcbiAgICB0aGlzLmxvY2FsQm91bmRzID0gU2NyZWVuLk1JTklNVU1fSE9NRV9TQ1JFRU5fSUNPTl9TSVpFLnRvQm91bmRzKCk7XHJcblxyXG4gICAgY29uc3QgdXJsID0gZ2V0Qm9uZERhdGFVUkwoIGlzTW9kZWwsIGlzQmFzaWNzVmVyc2lvbiApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggbmV3IEltYWdlKCB1cmwsIHtcclxuICAgICAgaW5pdGlhbFdpZHRoOiBTY3JlZW4uTUlOSU1VTV9IT01FX1NDUkVFTl9JQ09OX1NJWkUud2lkdGgsXHJcbiAgICAgIGluaXRpYWxIZWlnaHQ6IFNjcmVlbi5NSU5JTVVNX0hPTUVfU0NSRUVOX0lDT05fU0laRS5oZWlnaHRcclxuICAgIH0gKSApO1xyXG5cclxuICAgIGNvbnN0IGNlbnRyYWxMYWJlbCA9IGlzTW9kZWwgPyAnQScgOiBnZXRDZW50cmFsRWxlbWVudCggaXNCYXNpY3NWZXJzaW9uICkuc3ltYm9sO1xyXG4gICAgY29uc3QgcmFkaWFsTGFiZWwgPSBpc01vZGVsID8gJ1gnIDogZ2V0UmFkaWFsRWxlbWVudCggaXNCYXNpY3NWZXJzaW9uICkuc3ltYm9sO1xyXG5cclxuICAgIGNvbnN0IHZpZXdCb25kRGlzdGFuY2UgPSAxOTIgKiBnZXRSZWxhdGl2ZVNjYWxlKCBpc0Jhc2ljc1ZlcnNpb24gKTtcclxuICAgIGNvbnN0IGFuZ2xlID0gZ2V0QW5nbGUoIGlzTW9kZWwsIGlzQmFzaWNzVmVyc2lvbiApO1xyXG4gICAgY29uc3QgY2VudGVyWCA9IFNjcmVlbi5NSU5JTVVNX0hPTUVfU0NSRUVOX0lDT05fU0laRS53aWR0aCAqIDAuNTtcclxuICAgIGNvbnN0IGNlbnRlclkgPSBTY3JlZW4uTUlOSU1VTV9IT01FX1NDUkVFTl9JQ09OX1NJWkUuaGVpZ2h0ICogKCBpc0Jhc2ljc1ZlcnNpb24gPyAwLjUgOiAwLjQgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBUZXh0KCBjZW50cmFsTGFiZWwsIHtcclxuICAgICAgZm9udFNpemU6IDgwLFxyXG4gICAgICBmaWxsOiAnYmxhY2snLFxyXG4gICAgICBjZW50ZXJYOiBjZW50ZXJYLFxyXG4gICAgICBjZW50ZXJZOiBjZW50ZXJZXHJcbiAgICB9ICkgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBUZXh0KCByYWRpYWxMYWJlbCwge1xyXG4gICAgICBmb250U2l6ZTogODAsXHJcbiAgICAgIGZpbGw6ICdibGFjaycsXHJcbiAgICAgIGNlbnRlclg6IGNlbnRlclggKyBNYXRoLnNpbiggYW5nbGUgKSAqIHZpZXdCb25kRGlzdGFuY2UsXHJcbiAgICAgIGNlbnRlclk6IGNlbnRlclkgKyBNYXRoLmNvcyggYW5nbGUgKSAqIHZpZXdCb25kRGlzdGFuY2VcclxuICAgIH0gKSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggbmV3IFRleHQoIHJhZGlhbExhYmVsLCB7XHJcbiAgICAgIGZvbnRTaXplOiA4MCxcclxuICAgICAgZmlsbDogJ2JsYWNrJyxcclxuICAgICAgY2VudGVyWDogY2VudGVyWCAtIE1hdGguc2luKCBhbmdsZSApICogdmlld0JvbmREaXN0YW5jZSxcclxuICAgICAgY2VudGVyWTogY2VudGVyWSArIE1hdGguY29zKCBhbmdsZSApICogdmlld0JvbmREaXN0YW5jZVxyXG4gICAgfSApICk7XHJcbiAgfVxyXG59XHJcblxyXG5tb2xlY3VsZVNoYXBlcy5yZWdpc3RlciggJ1NjcmVlbkljb25Ob2RlJywgU2NyZWVuSWNvbk5vZGUgKTtcclxuZXhwb3J0IGRlZmF1bHQgU2NyZWVuSWNvbk5vZGU7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxNQUFNLE1BQU0sZ0NBQWdDO0FBQ25ELE9BQU9DLE9BQU8sTUFBTSx5Q0FBeUM7QUFDN0QsU0FBU0MsS0FBSyxFQUFFQyxJQUFJLEVBQUVDLElBQUksUUFBUSxtQ0FBbUM7QUFDckUsT0FBT0MsTUFBTSxNQUFNLGlDQUFpQztBQUNwRCxPQUFPQyxjQUFjLE1BQU0seUJBQXlCO0FBQ3BELE9BQU9DLG1CQUFtQixNQUFNLGlDQUFpQztBQUNqRSxPQUFPQyxTQUFTLE1BQU0sdUJBQXVCO0FBQzdDLE9BQU9DLGFBQWEsTUFBTSwyQkFBMkI7QUFDckQsT0FBT0MscUJBQXFCLE1BQU0sNkJBQTZCO0FBQy9ELE9BQU9DLFlBQVksTUFBTSxzQkFBc0I7QUFDL0MsT0FBT0Msd0JBQXdCLE1BQU0sK0JBQStCOztBQUVwRTtBQUNBO0FBQ0E7QUFDQSxNQUFNQyxLQUFLLEdBQUcsSUFBSUMsS0FBSyxDQUFDQyxLQUFLLENBQUMsQ0FBQztBQUMvQkgsd0JBQXdCLENBQUNJLGdCQUFnQixDQUFFSCxLQUFNLENBQUM7QUFFbEQsTUFBTUksUUFBUSxHQUFHUCxxQkFBcUIsQ0FBQ1EsZ0JBQWdCLENBQUNDLEtBQUssR0FBRyxJQUFJTCxLQUFLLENBQUNNLGFBQWEsQ0FBRTtFQUN2RkMsU0FBUyxFQUFFLElBQUk7RUFDZkMscUJBQXFCLEVBQUUsSUFBSTtFQUFFO0VBQzdCQyxLQUFLLEVBQUUsSUFBSSxDQUFDO0FBQ2QsQ0FBRSxDQUFDLEdBQUcsSUFBSVQsS0FBSyxDQUFDVSxj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