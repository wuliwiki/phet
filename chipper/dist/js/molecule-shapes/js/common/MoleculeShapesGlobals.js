// Copyright 2014-2022, University of Colorado Boulder

/**
 * Global settings and quality information
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import BooleanProperty from '../../../axon/js/BooleanProperty.js';
import Property from '../../../axon/js/Property.js';
import ReadOnlyProperty from '../../../axon/js/ReadOnlyProperty.js';
import merge from '../../../phet-core/js/merge.js';
import { Color, Utils } from '../../../scenery/js/imports.js';
import Tandem from '../../../tandem/js/Tandem.js';
import moleculeShapes from '../moleculeShapes.js';
import MoleculeShapesQueryParameters from './MoleculeShapesQueryParameters.js';
import MoleculeShapesColors from './view/MoleculeShapesColors.js';
const MoleculeShapesGlobals = {
  showOuterLonePairsProperty: new BooleanProperty(MoleculeShapesQueryParameters.showOuterLonePairs, {
    tandem: phet.chipper.packageObject.name === 'molecule-shapes-basics' ? Tandem.OPT_OUT : Tandem.PREFERENCES.createTandem('showOuterLonePairsProperty')
  }),
  checkboxOptions: {
    checkboxColor: MoleculeShapesColors.checkboxProperty,
    checkboxColorBackground: MoleculeShapesColors.checkboxBackgroundProperty
  }
};
moleculeShapes.register('MoleculeShapesGlobals', MoleculeShapesGlobals);
let hasBasicWebGLSupport = phet.chipper.queryParameters.webgl && Utils.isWebGLSupported;

// Check for the presence of a webgl/three.js bug present in https://github.com/phetsims/molecule-shapes/issues/161
if (navigator.userAgent.indexOf('Firefox/') >= 0 && navigator.userAgent.match(/OS X 10\.1[0123]/)) {
  hasBasicWebGLSupport = false;
}
const useWebGL = hasBasicWebGLSupport && Utils.checkIE11StencilSupport();
merge(MoleculeShapesGlobals, {
  // @public {Property.<boolean>} - Whether the basics of WebGL are included
  hasBasicWebGLSupportProperty: new Property(hasBasicWebGLSupport),
  // @public {Property.<boolean>} - Whether we will be using WebGL
  useWebGLProperty: new Property(useWebGL),
  /**
   * Applies color changes to the material's color field, and also does so immediately upon being called.
   * @public
   *
   * @param {THREE.Material} material
   * @param {Property.<Color>} colorProperty
   * @returns A callback that will unlink
   */
  linkColor: function (material, colorProperty) {
    const colorListener = function (color) {
      material.color.setHex(color.toNumber());
    };
    colorProperty.link(colorListener);
    return function () {
      colorProperty.unlink(colorListener);
    };
  },
  /**
   * Creates a color Property from anything that can be provided to Scenery as a constant-color fill/stroke.
   * @public
   *
   * @param {string|Color|Property.<Color>} color
   * @returns {Property.<Color>}
   */
  toColorProperty: function (color) {
    // for now, cast it into place
    let colorProperty;
    if (typeof color === 'string') {
      color = new Color(color);
    }
    if (color instanceof Color) {
      colorProperty = new Property(color);
    } else if (color instanceof ReadOnlyProperty) {
      colorProperty = color;
    } else {
      throw new Error('bad color passed to MoleculeShapesGlobals.toColorProperty');
    }
    return colorProperty;
  }
});
export default MoleculeShapesGlobals;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJQcm9wZXJ0eSIsIlJlYWRPbmx5UHJvcGVydHkiLCJtZXJnZSIsIkNvbG9yIiwiVXRpbHMiLCJUYW5kZW0iLCJtb2xlY3VsZVNoYXBlcyIsIk1vbGVjdWxlU2hhcGVzUXVlcnlQYXJhbWV0ZXJzIiwiTW9sZWN1bGVTaGFwZXNDb2xvcnMiLCJNb2xlY3VsZVNoYXBlc0dsb2JhbHMiLCJzaG93T3V0ZXJMb25lUGFpcnNQcm9wZXJ0eSIsInNob3dPdXRlckxvbmVQYWlycyIsInRhbmRlbSIsInBoZXQiLCJjaGlwcGVyIiwicGFja2FnZU9iamVjdCIsIm5hbWUiLCJPUFRfT1VUIiwiUFJFRkVSRU5DRVMiLCJjcmVhdGVUYW5kZW0iLCJjaGVja2JveE9wdGlvbnMiLCJjaGVja2JveENvbG9yIiwiY2hlY2tib3hQcm9wZXJ0eSIsImNoZWNrYm94Q29sb3JCYWNrZ3JvdW5kIiwiY2hlY2tib3hCYWNrZ3JvdW5kUHJvcGVydHkiLCJyZWdpc3RlciIsImhhc0Jhc2ljV2ViR0xTdXBwb3J0IiwicXVlcnlQYXJhbWV0ZXJzIiwid2ViZ2wiLCJpc1dlYkdMU3VwcG9ydGVkIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiaW5kZXhPZiIsIm1hdGNoIiwidXNlV2ViR0wiLCJjaGVja0lFMTFTdGVuY2lsU3VwcG9ydCIsImhhc0Jhc2ljV2ViR0xTdXBwb3J0UHJvcGVydHkiLCJ1c2VXZWJHTFByb3BlcnR5IiwibGlua0NvbG9yIiwibWF0ZXJpYWwiLCJjb2xvclByb3BlcnR5IiwiY29sb3JMaXN0ZW5lciIsImNvbG9yIiwic2V0SGV4IiwidG9OdW1iZXIiLCJsaW5rIiwidW5saW5rIiwidG9Db2xvclByb3BlcnR5IiwiRXJyb3IiXSwic291cmNlcyI6WyJNb2xlY3VsZVNoYXBlc0dsb2JhbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTQtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogR2xvYmFsIHNldHRpbmdzIGFuZCBxdWFsaXR5IGluZm9ybWF0aW9uXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1JlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IHsgQ29sb3IsIFV0aWxzIH0gZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IG1vbGVjdWxlU2hhcGVzIGZyb20gJy4uL21vbGVjdWxlU2hhcGVzLmpzJztcclxuaW1wb3J0IE1vbGVjdWxlU2hhcGVzUXVlcnlQYXJhbWV0ZXJzIGZyb20gJy4vTW9sZWN1bGVTaGFwZXNRdWVyeVBhcmFtZXRlcnMuanMnO1xyXG5pbXBvcnQgTW9sZWN1bGVTaGFwZXNDb2xvcnMgZnJvbSAnLi92aWV3L01vbGVjdWxlU2hhcGVzQ29sb3JzLmpzJztcclxuXHJcbmNvbnN0IE1vbGVjdWxlU2hhcGVzR2xvYmFscyA9IHtcclxuICBzaG93T3V0ZXJMb25lUGFpcnNQcm9wZXJ0eTogbmV3IEJvb2xlYW5Qcm9wZXJ0eSggTW9sZWN1bGVTaGFwZXNRdWVyeVBhcmFtZXRlcnMuc2hvd091dGVyTG9uZVBhaXJzLCB7XHJcbiAgICB0YW5kZW06IHBoZXQuY2hpcHBlci5wYWNrYWdlT2JqZWN0Lm5hbWUgPT09ICdtb2xlY3VsZS1zaGFwZXMtYmFzaWNzJyA/IFRhbmRlbS5PUFRfT1VUIDogVGFuZGVtLlBSRUZFUkVOQ0VTLmNyZWF0ZVRhbmRlbSggJ3Nob3dPdXRlckxvbmVQYWlyc1Byb3BlcnR5JyApXHJcbiAgfSApLFxyXG5cclxuICBjaGVja2JveE9wdGlvbnM6IHtcclxuICAgIGNoZWNrYm94Q29sb3I6IE1vbGVjdWxlU2hhcGVzQ29sb3JzLmNoZWNrYm94UHJvcGVydHksXHJcbiAgICBjaGVja2JveENvbG9yQmFja2dyb3VuZDogTW9sZWN1bGVTaGFwZXNDb2xvcnMuY2hlY2tib3hCYWNrZ3JvdW5kUHJvcGVydHlcclxuICB9XHJcbn07XHJcblxyXG5tb2xlY3VsZVNoYXBlcy5yZWdpc3RlciggJ01vbGVjdWxlU2hhcGVzR2xvYmFscycsIE1vbGVjdWxlU2hhcGVzR2xvYmFscyApO1xyXG5cclxubGV0IGhhc0Jhc2ljV2ViR0xTdXBwb3J0ID0gcGhldC5jaGlwcGVyLnF1ZXJ5UGFyYW1ldGVycy53ZWJnbCAmJiBVdGlscy5pc1dlYkdMU3VwcG9ydGVkO1xyXG5cclxuLy8gQ2hlY2sgZm9yIHRoZSBwcmVzZW5jZSBvZiBhIHdlYmdsL3RocmVlLmpzIGJ1ZyBwcmVzZW50IGluIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9tb2xlY3VsZS1zaGFwZXMvaXNzdWVzLzE2MVxyXG5pZiAoIG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZiggJ0ZpcmVmb3gvJyApID49IDAgJiZcclxuICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKCAvT1MgWCAxMFxcLjFbMDEyM10vICkgKSB7XHJcbiAgaGFzQmFzaWNXZWJHTFN1cHBvcnQgPSBmYWxzZTtcclxufVxyXG5cclxuY29uc3QgdXNlV2ViR0wgPSBoYXNCYXNpY1dlYkdMU3VwcG9ydCAmJiBVdGlscy5jaGVja0lFMTFTdGVuY2lsU3VwcG9ydCgpO1xyXG5cclxubWVyZ2UoIE1vbGVjdWxlU2hhcGVzR2xvYmFscywge1xyXG4gIC8vIEBwdWJsaWMge1Byb3BlcnR5Ljxib29sZWFuPn0gLSBXaGV0aGVyIHRoZSBiYXNpY3Mgb2YgV2ViR0wgYXJlIGluY2x1ZGVkXHJcbiAgaGFzQmFzaWNXZWJHTFN1cHBvcnRQcm9wZXJ0eTogbmV3IFByb3BlcnR5KCBoYXNCYXNpY1dlYkdMU3VwcG9ydCApLFxyXG5cclxuICAvLyBAcHVibGljIHtQcm9wZXJ0eS48Ym9vbGVhbj59IC0gV2hldGhlciB3ZSB3aWxsIGJlIHVzaW5nIFdlYkdMXHJcbiAgdXNlV2ViR0xQcm9wZXJ0eTogbmV3IFByb3BlcnR5KCB1c2VXZWJHTCApLFxyXG5cclxuICAvKipcclxuICAgKiBBcHBsaWVzIGNvbG9yIGNoYW5nZXMgdG8gdGhlIG1hdGVyaWFsJ3MgY29sb3IgZmllbGQsIGFuZCBhbHNvIGRvZXMgc28gaW1tZWRpYXRlbHkgdXBvbiBiZWluZyBjYWxsZWQuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtUSFJFRS5NYXRlcmlhbH0gbWF0ZXJpYWxcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5LjxDb2xvcj59IGNvbG9yUHJvcGVydHlcclxuICAgKiBAcmV0dXJucyBBIGNhbGxiYWNrIHRoYXQgd2lsbCB1bmxpbmtcclxuICAgKi9cclxuICBsaW5rQ29sb3I6IGZ1bmN0aW9uKCBtYXRlcmlhbCwgY29sb3JQcm9wZXJ0eSApIHtcclxuICAgIGNvbnN0IGNvbG9yTGlzdGVuZXIgPSBmdW5jdGlvbiggY29sb3IgKSB7XHJcbiAgICAgIG1hdGVyaWFsLmNvbG9yLnNldEhleCggY29sb3IudG9OdW1iZXIoKSApO1xyXG4gICAgfTtcclxuICAgIGNvbG9yUHJvcGVydHkubGluayggY29sb3JMaXN0ZW5lciApO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICBjb2xvclByb3BlcnR5LnVubGluayggY29sb3JMaXN0ZW5lciApO1xyXG4gICAgfTtcclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIGEgY29sb3IgUHJvcGVydHkgZnJvbSBhbnl0aGluZyB0aGF0IGNhbiBiZSBwcm92aWRlZCB0byBTY2VuZXJ5IGFzIGEgY29uc3RhbnQtY29sb3IgZmlsbC9zdHJva2UuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtzdHJpbmd8Q29sb3J8UHJvcGVydHkuPENvbG9yPn0gY29sb3JcclxuICAgKiBAcmV0dXJucyB7UHJvcGVydHkuPENvbG9yPn1cclxuICAgKi9cclxuICB0b0NvbG9yUHJvcGVydHk6IGZ1bmN0aW9uKCBjb2xvciApIHtcclxuICAgIC8vIGZvciBub3csIGNhc3QgaXQgaW50byBwbGFjZVxyXG4gICAgbGV0IGNvbG9yUHJvcGVydHk7XHJcbiAgICBpZiAoIHR5cGVvZiBjb2xvciA9PT0gJ3N0cmluZycgKSB7XHJcbiAgICAgIGNvbG9yID0gbmV3IENvbG9yKCBjb2xvciApO1xyXG4gICAgfVxyXG4gICAgaWYgKCBjb2xvciBpbnN0YW5jZW9mIENvbG9yICkge1xyXG4gICAgICBjb2xvclByb3BlcnR5ID0gbmV3IFByb3BlcnR5KCBjb2xvciApO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIGNvbG9yIGluc3RhbmNlb2YgUmVhZE9ubHlQcm9wZXJ0eSApIHtcclxuICAgICAgY29sb3JQcm9wZXJ0eSA9IGNvbG9yO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvciggJ2JhZCBjb2xvciBwYXNzZWQgdG8gTW9sZWN1bGVTaGFwZXNHbG9iYWxzLnRvQ29sb3JQcm9wZXJ0eScgKTtcclxuICAgIH1cclxuICAgIHJldHVybiBjb2xvclByb3BlcnR5O1xyXG4gIH1cclxufSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTW9sZWN1bGVTaGFwZXNHbG9iYWxzOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0scUNBQXFDO0FBQ2pFLE9BQU9DLFFBQVEsTUFBTSw4QkFBOEI7QUFDbkQsT0FBT0MsZ0JB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