// Copyright 2014-2022, University of Colorado Boulder

/**
 * Displays a thumbnail of the bond type (single, double, triple) or lone pair, along with a red 'X' for removal.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Bounds2 from '../../../dot/js/Bounds2.js';
import Vector3 from '../../../dot/js/Vector3.js';
import merge from '../../../phet-core/js/merge.js';
import platform from '../../../phet-core/js/platform.js';
import { FireListener, HBox, Image, Imageable, Node, Rectangle } from '../../../scenery/js/imports.js';
import Tandem from '../../../tandem/js/Tandem.js';
import Molecule from '../common/model/Molecule.js';
import MoleculeShapesModel from '../common/model/MoleculeShapesModel.js';
import PairGroup from '../common/model/PairGroup.js';
import VSEPRMolecule from '../common/model/VSEPRMolecule.js';
import MoleculeShapesGlobals from '../common/MoleculeShapesGlobals.js';
import MoleculeView from '../common/view/3d/MoleculeView.js';
import MoleculeShapesColors from '../common/view/MoleculeShapesColors.js';
import MoleculeShapesScreenView from '../common/view/MoleculeShapesScreenView.js';
import moleculeShapes from '../moleculeShapes.js';
import RemovePairGroupButton from './RemovePairGroupButton.js';

/*---------------------------------------------------------------------------*
 * Dynamic generation of the bonding/lone-pair panel images, by rendering a three.js scene to an image
 *----------------------------------------------------------------------------*/
const scene = new THREE.Scene();
MoleculeShapesScreenView.addLightsToScene(scene);
const renderer = MoleculeShapesGlobals.useWebGLProperty.value ? new THREE.WebGLRenderer({
  antialias: true,
  preserveDrawingBuffer: true,
  // so we can toDataURL() it
  alpha: true // so we can render the transparency
}) : new THREE.CanvasRenderer();
MoleculeShapesColors.backgroundProperty.link(color => renderer.setClearColor(color.toNumber(), 1));
const camera = new THREE.OrthographicCamera();
camera.position.set(0, 0, 40);
camera.near = 1; // near clipping plane
camera.far = 100; // far clipping plane

// @param {number} orthoSize - The width of the orthographic camera's viewport in the world coordinate frame
function render(view, width, height, orthoSize) {
  scene.add(view);
  camera.left = 0;
  camera.right = orthoSize;
  camera.top = orthoSize * height / width / 2; // the corresponding height given the orthoSize => width scaling
  camera.bottom = -orthoSize * height / width / 2;
  camera.updateProjectionMatrix(); // three.js requires this to be called after changing the parameters

  renderer.setSize(width, height);
  renderer.render(scene, camera);
  scene.remove(view);
  return renderer.domElement;
}

// tuned parameters to match the desired Canvas sizes for lone pairs and atom bonds
const IMAGE_SCALE = 3;
const LONE_PAIR_WIDTH = 78;
const ATOM_HEIGHT = 42;
const ATOM_WIDTH = 120;
const LONE_PAIR_HEIGHT = 55;

// Returns a {string} URL OR a mipmap {Object}, both of which are compatible with Scenery's Image
function getBondDataURL(bondOrder) {
  const molecule = new VSEPRMolecule();
  const centralAtom = new PairGroup(new Vector3(0, 0, 0), false);
  molecule.addCentralAtom(centralAtom);
  molecule.addGroupAndBond(new PairGroup(Vector3.X_UNIT.times(bondOrder === 0 ? PairGroup.LONE_PAIR_DISTANCE : PairGroup.BONDED_PAIR_DISTANCE), bondOrder === 0), centralAtom, bondOrder);
  const model = new MoleculeShapesModel(false, {
    initialMolecule: molecule
  }, Tandem.OPT_OUT);
  const view = new MoleculeView(model, MoleculeShapesScreenView.createAPIStub(renderer), molecule, {
    showLabel: () => {},
    finishedAddingLabels: () => {}
  }, Tandem.OPT_OUT);
  view.updateView();
  view.hideCentralAtom();
  const orthoSize = bondOrder === 0 ? PairGroup.LONE_PAIR_DISTANCE * 1.07 : PairGroup.BONDED_PAIR_DISTANCE * 1.22;
  const width = (bondOrder === 0 ? LONE_PAIR_WIDTH : ATOM_WIDTH) * IMAGE_SCALE;
  const height = (bondOrder === 0 ? LONE_PAIR_HEIGHT : ATOM_HEIGHT) * IMAGE_SCALE;
  const baseCanvas = render(view, width, height, orthoSize);
  let url = baseCanvas.toDataURL();
  view.dispose();
  if (platform.firefox) {
    // Create a Canvas copy if we are going to keep a reference to the Canvas
    const canvasCopy = document.createElement('canvas');
    const contextCopy = canvasCopy.getContext('2d');
    canvasCopy.width = baseCanvas.width;
    canvasCopy.height = baseCanvas.height;
    contextCopy.drawImage(baseCanvas, 0, 0);

    // Create a mipmap for firefox, see https://github.com/phetsims/molecule-shapes/issues/129
    url = Imageable.createFastMipmapFromCanvas(canvasCopy);
  }
  return url;
}
class BondGroupNode extends HBox {
  /**
   * @param {MoleculeShapesModel} model
   * @param {number} bondOrder
   * @param {Function} addPairCallback - Will be called when the user clicks on the main part (add) of this component.
   * @param {Function} removePairCallback - Will be called when the user clicks on the remove button in this.
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(model, bondOrder, addPairCallback, removePairCallback, tandem, options) {
    super({
      tandem: tandem,
      align: 'center',
      widthSizable: false
    });
    this.model = model; // @private {MoleculeShapesModel}
    this.bondOrder = bondOrder; // @private {number}

    // whether our "button" is enabled
    let enabled = true;

    // how many pointers are over our node, used for changing the highlighting for the "button over"
    let overCount = 0;

    // A semi-transparent overlay with the same color as the background (and variable alpha). Used to adjust the visual
    // "opacity" of the underlying image (by toggling our alpha), and as a hit-area for events.
    const overlay = new Rectangle(0, 0, 120, bondOrder !== 0 ? ATOM_HEIGHT : LONE_PAIR_HEIGHT, 0, 0, options);
    // TODO: track this with the FireListener?
    overlay.addInputListener({
      enter: () => {
        overCount++;
        updateOverlayOpacity();
      },
      exit: () => {
        overCount--;
        updateOverlayOpacity();
      }
    });
    overlay.addInputListener(new FireListener({
      canStartPress: () => enabled,
      tandem: tandem.createTandem('fireListener'),
      fireOnDown: true,
      fire: () => addPairCallback(bondOrder, overlay.localToGlobalBounds(overlay.localBounds))
    }));
    overlay.touchArea = overlay.localBounds.dilatedY(4).withMinX(-10);

    // our image of the lone pair / bond, under the overlay.
    const image = new Image(getBondDataURL(bondOrder), {
      scale: 1 / IMAGE_SCALE // retina devices create large images, so for now we normalize the image scale
    });
    // override local bounds because the correct bounds may not be loaded yet (loading from a data URL, not an HTMLImageElement)
    image.localBounds = bondOrder === 0 ? new Bounds2(0, 0, LONE_PAIR_WIDTH * IMAGE_SCALE, LONE_PAIR_HEIGHT * IMAGE_SCALE) : new Bounds2(0, 0, ATOM_WIDTH * IMAGE_SCALE, ATOM_HEIGHT * IMAGE_SCALE);
    image.center = overlay.center;

    // handle updates to our color scheme by recreating the images needed
    function updateImage() {
      image.image = getBondDataURL(bondOrder);
    }
    if (bondOrder === 0) {
      MoleculeShapesColors.lonePairShellProperty.lazyLink(updateImage);
      MoleculeShapesColors.lonePairElectronProperty.lazyLink(updateImage);
    } else {
      MoleculeShapesColors.atomProperty.lazyLink(updateImage);
      MoleculeShapesColors.bondProperty.lazyLink(updateImage);
    }
    MoleculeShapesColors.backgroundProperty.lazyLink(updateImage);

    // move the lone pair over to the right more, so that it looks more centered
    if (bondOrder === 0) {
      image.right = overlay.right - 10;
    }
    const thumbnail = new Node({
      children: [image, overlay]
    });

    // button to remove a copy of the bond / lone pair
    const removeButton = new RemovePairGroupButton({
      listener: () => {
        removePairCallback(bondOrder);
      },
      visiblePropertyOptions: {
        phetioReadOnly: true
      },
      enabledPropertyOptions: {
        phetioReadOnly: true
      },
      // Adjusted to match the left of the touch area of the overlay
      touchAreaXShift: 5,
      touchAreaXDilation: 15,
      touchAreaYDilation: 14,
      tandem: tandem.createTandem('removeButton')
    });

    // updates the visual state of the thumbnail (image/overlay) and removal button
    function update() {
      enabled = model.moleculeProperty.value.wouldAllowBondOrder(bondOrder);
      if (bondOrder === 0) {
        enabled = enabled && model.showLonePairsProperty.value;
      }
      overlay.cursor = enabled ? 'pointer' : null;
      removeButton.visible = _.filter(model.moleculeProperty.value.getBondsAround(model.moleculeProperty.value.centralAtom), bond => bond.order === bondOrder).length > 0;
      updateOverlayOpacity();
    }
    function updateOverlayOpacity() {
      let alpha;
      if (enabled) {
        // when "button over" the overlay will show through more of the image
        alpha = overCount > 0 ? 0 : 0.1;
      } else {
        alpha = 0.4;
      }
      overlay.fill = MoleculeShapesColors.backgroundProperty.value.withAlpha(alpha);
    }
    model.moleculeProperty.link((newMolecule, oldMolecule) => {
      if (oldMolecule) {
        oldMolecule.bondChangedEmitter.removeListener(update);
      }
      if (newMolecule) {
        newMolecule.bondChangedEmitter.addListener(update);
      }
      update();
    });
    model.showLonePairsProperty.link(update);
    Molecule.maxConnectionsProperty.lazyLink(update);
    MoleculeShapesColors.backgroundProperty.lazyLink(update);
    this.mutate(merge({
      children: [thumbnail, removeButton],
      spacing: 10,
      align: 'center',
      excludeInvisibleChildrenFromBounds: false
    }, options));
  }
}
moleculeShapes.register('BondGroupNode', BondGroupNode);
export default BondGroupNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb3VuZHMyIiwiVmVjdG9yMyIsIm1lcmdlIiwicGxhdGZvcm0iLCJGaXJlTGlzdGVuZXIiLCJIQm94IiwiSW1hZ2UiLCJJbWFnZWFibGUiLCJOb2RlIiwiUmVjdGFuZ2xlIiwiVGFuZGVtIiwiTW9sZWN1bGUiLCJNb2xlY3VsZVNoYXBlc01vZGVsIiwiUGFpckdyb3VwIiwiVlNFUFJNb2xlY3VsZSIsIk1vbGVjdWxlU2hhcGVzR2xvYmFscyIsIk1vbGVjdWxlVmlldyIsIk1vbGVjdWxlU2hhcGVzQ29sb3JzIiwiTW9sZWN1bGVTaGFwZXNTY3JlZW5WaWV3IiwibW9sZWN1bGVTaGFwZXMiLCJSZW1vdmVQYWlyR3JvdXBCdXR0b24iLCJzY2VuZSIsIlRIUkVFIiwiU2NlbmUiLCJhZGRMaWdodHNUb1NjZW5lIiwicmVuZGVyZXIiLCJ1c2VXZWJHTFByb3BlcnR5IiwidmFsdWUiLCJXZWJHTFJlbmRlcmVyIiwiYW50aWFsaWFzIiwicHJlc2VydmVEcmF3aW5nQnVmZmVyIiwiYWxwaGEiLCJDYW52YXNSZW5kZXJlciIsImJhY2tncm91bmRQcm9wZXJ0eSIsImxpbmsiLCJjb2xvciIsInNldENsZWFyQ29sb3IiLCJ0b051bWJlciIsImNhbWVyYSIsIk9ydGhvZ3JhcGhpY0NhbWVyYSIsInBvc2l0aW9uIiwic2V0IiwibmVhciIsImZhciIsInJlbmRlciIsInZpZXciLCJ3aWR0aCIsImhlaWdodCIsIm9ydGhvU2l6ZSIsImFkZCIsImxlZnQiLCJyaWdodCIsInRvcCIsImJvdHRvbSIsInVwZGF0ZVByb2plY3Rpb25NYXRyaXgiLCJzZXRTaXplIiwicmVtb3ZlIiwiZG9tRWxlbWVudCIsIklNQUdFX1NDQUxFIiwiTE9ORV9QQUlSX1dJRFRIIiwiQVRPTV9IRUlHSFQiLCJBVE9NX1dJRFRIIiwiTE9ORV9QQUlSX0hFSUdIVCIsImdldEJvbmREYXRhVVJMIiwiYm9uZE9yZGVyIiwibW9sZWN1bGUiLCJjZW50cmFsQXRvbSIsImFkZENlbnRyYWxBdG9tIiwiYWRkR3JvdXBBbmRCb25kIiwiWF9VTklUIiwidGltZXMiLCJMT05FX1BBSVJfRElTVEFOQ0UiLCJCT05ERURfUEFJUl9ESVNUQU5DRSIsIm1vZGVsIiwiaW5pdGlhbE1vbGVjdWxlIiwiT1BUX09VVCIsImNyZWF0ZUFQSVN0dWIiLCJzaG93TGFiZWwiLCJmaW5pc2hlZEFkZGluZ0xhYmVscyIsInVwZGF0ZVZpZXciLCJoaWRlQ2VudHJhbEF0b20iLCJiYXNlQ2FudmFzIiwidXJsIiwidG9EYXRhVVJMIiwiZGlzcG9zZSIsImZpcmVmb3giLCJjYW52YXNDb3B5IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY29udGV4dENvcHkiLCJnZXRDb250ZXh0IiwiZHJhd0ltYWdlIiwiY3JlYXRlRmFzdE1pcG1hcEZyb21DYW52YXMiLCJCb25kR3JvdXBOb2RlIiwiY29uc3RydWN0b3IiLCJhZGRQYWlyQ2FsbGJhY2siLCJyZW1vdmVQYWlyQ2FsbGJhY2siLCJ0YW5kZW0iLCJvcHRpb25zIiwiYWxpZ24iLCJ3aWR0aFNpemFibGUiLCJlbmFibGVkIiwib3ZlckNvdW50Iiwib3ZlcmxheSIsImFkZElucHV0TGlzdGVuZXIiLCJlbnRlciIsInVwZGF0ZU92ZXJsYXlPcGFjaXR5IiwiZXhpdCIsImNhblN0YXJ0UHJlc3MiLCJjcmVhdGVUYW5kZW0iLCJmaXJlT25Eb3duIiwiZmlyZSIsImxvY2FsVG9HbG9iYWxCb3VuZHMiLCJsb2NhbEJvdW5kcyIsInRvdWNoQXJlYSIsImRpbGF0ZWRZIiwid2l0aE1pblgiLCJpbWFnZSIsInNjYWxlIiwiY2VudGVyIiwidXBkYXRlSW1hZ2UiLCJsb25lUGFpclNoZWxsUHJvcGVydHkiLCJsYXp5TGluayIsImxvbmVQYWlyRWxlY3Ryb25Qcm9wZXJ0eSIsImF0b21Qcm9wZXJ0eSIsImJvbmRQcm9wZXJ0eSIsInRodW1ibmFpbCIsImNoaWxkcmVuIiwicmVtb3ZlQnV0dG9uIiwibGlzdGVuZXIiLCJ2aXNpYmxlUHJvcGVydHlPcHRpb25zIiwicGhldGlvUmVhZE9ubHkiLCJlbmFibGVkUHJvcGVydHlPcHRpb25zIiwidG91Y2hBcmVhWFNoaWZ0IiwidG91Y2hBcmVhWERpbGF0aW9uIiwidG91Y2hBcmVhWURpbGF0aW9uIiwidXBkYXRlIiwibW9sZWN1bGVQcm9wZXJ0eSIsIndvdWxkQWxsb3dCb25kT3JkZXIiLCJzaG93TG9uZVBhaXJzUHJvcGVydHkiLCJjdXJzb3IiLCJ2aXNpYmxlIiwiXyIsImZpbHRlciIsImdldEJvbmRzQXJvdW5kIiwiYm9uZCIsIm9yZGVyIiwibGVuZ3RoIiwiZmlsbCIsIndpdGhBbHBoYSIsIm5ld01vbGVjdWxlIiwib2xkTW9sZWN1bGUiLCJib25kQ2hhbmdlZEVtaXR0ZXIiLCJyZW1vdmVMaXN0ZW5lciIsImFkZExpc3RlbmVyIiwibWF4Q29ubmVjdGlvbnNQcm9wZXJ0eSIsIm11dGF0ZSIsInNwYWNpbmciLCJleGNsdWRlSW52aXNpYmxlQ2hpbGRyZW5Gcm9tQm91bmRzIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJCb25kR3JvdXBOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERpc3BsYXlzIGEgdGh1bWJuYWlsIG9mIHRoZSBib25kIHR5cGUgKHNpbmdsZSwgZG91YmxlLCB0cmlwbGUpIG9yIGxvbmUgcGFpciwgYWxvbmcgd2l0aCBhIHJlZCAnWCcgZm9yIHJlbW92YWwuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgQm91bmRzMiBmcm9tICcuLi8uLi8uLi9kb3QvanMvQm91bmRzMi5qcyc7XHJcbmltcG9ydCBWZWN0b3IzIGZyb20gJy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IzLmpzJztcclxuaW1wb3J0IG1lcmdlIGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy9tZXJnZS5qcyc7XHJcbmltcG9ydCBwbGF0Zm9ybSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvcGxhdGZvcm0uanMnO1xyXG5pbXBvcnQgeyBGaXJlTGlzdGVuZXIsIEhCb3gsIEltYWdlLCBJbWFnZWFibGUsIE5vZGUsIFJlY3RhbmdsZSB9IGZyb20gJy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBNb2xlY3VsZSBmcm9tICcuLi9jb21tb24vbW9kZWwvTW9sZWN1bGUuanMnO1xyXG5pbXBvcnQgTW9sZWN1bGVTaGFwZXNNb2RlbCBmcm9tICcuLi9jb21tb24vbW9kZWwvTW9sZWN1bGVTaGFwZXNNb2RlbC5qcyc7XHJcbmltcG9ydCBQYWlyR3JvdXAgZnJvbSAnLi4vY29tbW9uL21vZGVsL1BhaXJHcm91cC5qcyc7XHJcbmltcG9ydCBWU0VQUk1vbGVjdWxlIGZyb20gJy4uL2NvbW1vbi9tb2RlbC9WU0VQUk1vbGVjdWxlLmpzJztcclxuaW1wb3J0IE1vbGVjdWxlU2hhcGVzR2xvYmFscyBmcm9tICcuLi9jb21tb24vTW9sZWN1bGVTaGFwZXNHbG9iYWxzLmpzJztcclxuaW1wb3J0IE1vbGVjdWxlVmlldyBmcm9tICcuLi9jb21tb24vdmlldy8zZC9Nb2xlY3VsZVZpZXcuanMnO1xyXG5pbXBvcnQgTW9sZWN1bGVTaGFwZXNDb2xvcnMgZnJvbSAnLi4vY29tbW9uL3ZpZXcvTW9sZWN1bGVTaGFwZXNDb2xvcnMuanMnO1xyXG5pbXBvcnQgTW9sZWN1bGVTaGFwZXNTY3JlZW5WaWV3IGZyb20gJy4uL2NvbW1vbi92aWV3L01vbGVjdWxlU2hhcGVzU2NyZWVuVmlldy5qcyc7XHJcbmltcG9ydCBtb2xlY3VsZVNoYXBlcyBmcm9tICcuLi9tb2xlY3VsZVNoYXBlcy5qcyc7XHJcbmltcG9ydCBSZW1vdmVQYWlyR3JvdXBCdXR0b24gZnJvbSAnLi9SZW1vdmVQYWlyR3JvdXBCdXR0b24uanMnO1xyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qXHJcbiAqIER5bmFtaWMgZ2VuZXJhdGlvbiBvZiB0aGUgYm9uZGluZy9sb25lLXBhaXIgcGFuZWwgaW1hZ2VzLCBieSByZW5kZXJpbmcgYSB0aHJlZS5qcyBzY2VuZSB0byBhbiBpbWFnZVxyXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG5jb25zdCBzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xyXG5Nb2xlY3VsZVNoYXBlc1NjcmVlblZpZXcuYWRkTGlnaHRzVG9TY2VuZSggc2NlbmUgKTtcclxuXHJcbmNvbnN0IHJlbmRlcmVyID0gTW9sZWN1bGVTaGFwZXNHbG9iYWxzLnVzZVdlYkdMUHJvcGVydHkudmFsdWUgPyBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcigge1xyXG4gIGFudGlhbGlhczogdHJ1ZSxcclxuICBwcmVzZXJ2ZURyYXdpbmdCdWZmZXI6IHRydWUsIC8vIHNvIHdlIGNhbiB0b0RhdGFVUkwoKSBpdFxyXG4gIGFscGhhOiB0cnVlIC8vIHNvIHdlIGNhbiByZW5kZXIgdGhlIHRyYW5zcGFyZW5jeVxyXG59ICkgOiBuZXcgVEhSRUUuQ2FudmFzUmVuZGVyZXIoKTtcclxuTW9sZWN1bGVTaGFwZXNDb2xvcnMuYmFja2dyb3VuZFByb3BlcnR5LmxpbmsoIGNvbG9yID0+IHJlbmRlcmVyLnNldENsZWFyQ29sb3IoIGNvbG9yLnRvTnVtYmVyKCksIDEgKSApO1xyXG5cclxuY29uc3QgY2FtZXJhID0gbmV3IFRIUkVFLk9ydGhvZ3JhcGhpY0NhbWVyYSgpO1xyXG5jYW1lcmEucG9zaXRpb24uc2V0KCAwLCAwLCA0MCApO1xyXG5jYW1lcmEubmVhciA9IDE7IC8vIG5lYXIgY2xpcHBpbmcgcGxhbmVcclxuY2FtZXJhLmZhciA9IDEwMDsgLy8gZmFyIGNsaXBwaW5nIHBsYW5lXHJcblxyXG4vLyBAcGFyYW0ge251bWJlcn0gb3J0aG9TaXplIC0gVGhlIHdpZHRoIG9mIHRoZSBvcnRob2dyYXBoaWMgY2FtZXJhJ3Mgdmlld3BvcnQgaW4gdGhlIHdvcmxkIGNvb3JkaW5hdGUgZnJhbWVcclxuZnVuY3Rpb24gcmVuZGVyKCB2aWV3LCB3aWR0aCwgaGVpZ2h0LCBvcnRob1NpemUgKSB7XHJcbiAgc2NlbmUuYWRkKCB2aWV3ICk7XHJcbiAgY2FtZXJhLmxlZnQgPSAwO1xyXG4gIGNhbWVyYS5yaWdodCA9IG9ydGhvU2l6ZTtcclxuICBjYW1lcmEudG9wID0gb3J0aG9TaXplICogaGVpZ2h0IC8gd2lkdGggLyAyOyAvLyB0aGUgY29ycmVzcG9uZGluZyBoZWlnaHQgZ2l2ZW4gdGhlIG9ydGhvU2l6ZSA9PiB3aWR0aCBzY2FsaW5nXHJcbiAgY2FtZXJhLmJvdHRvbSA9IC1vcnRob1NpemUgKiBoZWlnaHQgLyB3aWR0aCAvIDI7XHJcbiAgY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsgLy8gdGhyZWUuanMgcmVxdWlyZXMgdGhpcyB0byBiZSBjYWxsZWQgYWZ0ZXIgY2hhbmdpbmcgdGhlIHBhcmFtZXRlcnNcclxuXHJcbiAgcmVuZGVyZXIuc2V0U2l6ZSggd2lkdGgsIGhlaWdodCApO1xyXG4gIHJlbmRlcmVyLnJlbmRlciggc2NlbmUsIGNhbWVyYSApO1xyXG4gIHNjZW5lLnJlbW92ZSggdmlldyApO1xyXG5cclxuICByZXR1cm4gcmVuZGVyZXIuZG9tRWxlbWVudDtcclxufVxyXG5cclxuLy8gdHVuZWQgcGFyYW1ldGVycyB0byBtYXRjaCB0aGUgZGVzaXJlZCBDYW52YXMgc2l6ZXMgZm9yIGxvbmUgcGFpcnMgYW5kIGF0b20gYm9uZHNcclxuY29uc3QgSU1BR0VfU0NBTEUgPSAzO1xyXG5jb25zdCBMT05FX1BBSVJfV0lEVEggPSA3ODtcclxuY29uc3QgQVRPTV9IRUlHSFQgPSA0MjtcclxuY29uc3QgQVRPTV9XSURUSCA9IDEyMDtcclxuY29uc3QgTE9ORV9QQUlSX0hFSUdIVCA9IDU1O1xyXG5cclxuLy8gUmV0dXJucyBhIHtzdHJpbmd9IFVSTCBPUiBhIG1pcG1hcCB7T2JqZWN0fSwgYm90aCBvZiB3aGljaCBhcmUgY29tcGF0aWJsZSB3aXRoIFNjZW5lcnkncyBJbWFnZVxyXG5mdW5jdGlvbiBnZXRCb25kRGF0YVVSTCggYm9uZE9yZGVyICkge1xyXG4gIGNvbnN0IG1vbGVjdWxlID0gbmV3IFZTRVBSTW9sZWN1bGUoKTtcclxuICBjb25zdCBjZW50cmFsQXRvbSA9IG5ldyBQYWlyR3JvdXAoIG5ldyBWZWN0b3IzKCAwLCAwLCAwICksIGZhbHNlICk7XHJcbiAgbW9sZWN1bGUuYWRkQ2VudHJhbEF0b20oIGNlbnRyYWxBdG9tICk7XHJcbiAgbW9sZWN1bGUuYWRkR3JvdXBBbmRCb25kKCBuZXcgUGFpckdyb3VwKCBWZWN0b3IzLlhfVU5JVC50aW1lcyggYm9uZE9yZGVyID09PSAwID8gUGFpckdyb3VwLkxPTkVfUEFJUl9ESVNUQU5DRSA6IFBhaXJHcm91cC5CT05ERURfUEFJUl9ESVNUQU5DRSApLCBib25kT3JkZXIgPT09IDAgKSwgY2VudHJhbEF0b20sIGJvbmRPcmRlciApO1xyXG4gIGNvbnN0IG1vZGVsID0gbmV3IE1vbGVjdWxlU2hhcGVzTW9kZWwoIGZhbHNlLCB7XHJcbiAgICBpbml0aWFsTW9sZWN1bGU6IG1vbGVjdWxlXHJcbiAgfSwgVGFuZGVtLk9QVF9PVVQgKTtcclxuXHJcbiAgY29uc3QgdmlldyA9IG5ldyBNb2xlY3VsZVZpZXcoIG1vZGVsLCBNb2xlY3VsZVNoYXBlc1NjcmVlblZpZXcuY3JlYXRlQVBJU3R1YiggcmVuZGVyZXIgKSwgbW9sZWN1bGUsIHtcclxuICAgIHNob3dMYWJlbDogKCkgPT4ge30sXHJcbiAgICBmaW5pc2hlZEFkZGluZ0xhYmVsczogKCkgPT4ge31cclxuICB9LCBUYW5kZW0uT1BUX09VVCApO1xyXG4gIHZpZXcudXBkYXRlVmlldygpO1xyXG4gIHZpZXcuaGlkZUNlbnRyYWxBdG9tKCk7XHJcblxyXG4gIGNvbnN0IG9ydGhvU2l6ZSA9IGJvbmRPcmRlciA9PT0gMCA/XHJcbiAgICAgICAgICAgICAgICAgICAgKCBQYWlyR3JvdXAuTE9ORV9QQUlSX0RJU1RBTkNFICogMS4wNyApIDpcclxuICAgICAgICAgICAgICAgICAgICAoIFBhaXJHcm91cC5CT05ERURfUEFJUl9ESVNUQU5DRSAqIDEuMjIgKTtcclxuICBjb25zdCB3aWR0aCA9ICggYm9uZE9yZGVyID09PSAwID8gTE9ORV9QQUlSX1dJRFRIIDogQVRPTV9XSURUSCApICogSU1BR0VfU0NBTEU7XHJcbiAgY29uc3QgaGVpZ2h0ID0gKCBib25kT3JkZXIgPT09IDAgPyBMT05FX1BBSVJfSEVJR0hUIDogQVRPTV9IRUlHSFQgKSAqIElNQUdFX1NDQUxFO1xyXG4gIGNvbnN0IGJhc2VDYW52YXMgPSByZW5kZXIoIHZpZXcsIHdpZHRoLCBoZWlnaHQsIG9ydGhvU2l6ZSApO1xyXG4gIGxldCB1cmwgPSBiYXNlQ2FudmFzLnRvRGF0YVVSTCgpO1xyXG4gIHZpZXcuZGlzcG9zZSgpO1xyXG5cclxuICBpZiAoIHBsYXRmb3JtLmZpcmVmb3ggKSB7XHJcbiAgICAvLyBDcmVhdGUgYSBDYW52YXMgY29weSBpZiB3ZSBhcmUgZ29pbmcgdG8ga2VlcCBhIHJlZmVyZW5jZSB0byB0aGUgQ2FudmFzXHJcbiAgICBjb25zdCBjYW52YXNDb3B5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2NhbnZhcycgKTtcclxuICAgIGNvbnN0IGNvbnRleHRDb3B5ID0gY2FudmFzQ29weS5nZXRDb250ZXh0KCAnMmQnICk7XHJcbiAgICBjYW52YXNDb3B5LndpZHRoID0gYmFzZUNhbnZhcy53aWR0aDtcclxuICAgIGNhbnZhc0NvcHkuaGVpZ2h0ID0gYmFzZUNhbnZhcy5oZWlnaHQ7XHJcbiAgICBjb250ZXh0Q29weS5kcmF3SW1hZ2UoIGJhc2VDYW52YXMsIDAsIDAgKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgYSBtaXBtYXAgZm9yIGZpcmVmb3gsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvbW9sZWN1bGUtc2hhcGVzL2lzc3Vlcy8xMjlcclxuICAgIHVybCA9IEltYWdlYWJsZS5jcmVhdGVGYXN0TWlwbWFwRnJvbUNhbnZhcyggY2FudmFzQ29weSApO1xyXG4gIH1cclxuICByZXR1cm4gdXJsO1xyXG59XHJcblxyXG5jbGFzcyBCb25kR3JvdXBOb2RlIGV4dGVuZHMgSEJveCB7XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtNb2xlY3VsZVNoYXBlc01vZGVsfSBtb2RlbFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBib25kT3JkZXJcclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhZGRQYWlyQ2FsbGJhY2sgLSBXaWxsIGJlIGNhbGxlZCB3aGVuIHRoZSB1c2VyIGNsaWNrcyBvbiB0aGUgbWFpbiBwYXJ0IChhZGQpIG9mIHRoaXMgY29tcG9uZW50LlxyXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IHJlbW92ZVBhaXJDYWxsYmFjayAtIFdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIHVzZXIgY2xpY2tzIG9uIHRoZSByZW1vdmUgYnV0dG9uIGluIHRoaXMuXHJcbiAgICogQHBhcmFtIHtUYW5kZW19IHRhbmRlbVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbW9kZWwsIGJvbmRPcmRlciwgYWRkUGFpckNhbGxiYWNrLCByZW1vdmVQYWlyQ2FsbGJhY2ssIHRhbmRlbSwgb3B0aW9ucyApIHtcclxuICAgIHN1cGVyKCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLFxyXG4gICAgICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgIHdpZHRoU2l6YWJsZTogZmFsc2VcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLm1vZGVsID0gbW9kZWw7IC8vIEBwcml2YXRlIHtNb2xlY3VsZVNoYXBlc01vZGVsfVxyXG4gICAgdGhpcy5ib25kT3JkZXIgPSBib25kT3JkZXI7IC8vIEBwcml2YXRlIHtudW1iZXJ9XHJcblxyXG4gICAgLy8gd2hldGhlciBvdXIgXCJidXR0b25cIiBpcyBlbmFibGVkXHJcbiAgICBsZXQgZW5hYmxlZCA9IHRydWU7XHJcblxyXG4gICAgLy8gaG93IG1hbnkgcG9pbnRlcnMgYXJlIG92ZXIgb3VyIG5vZGUsIHVzZWQgZm9yIGNoYW5naW5nIHRoZSBoaWdobGlnaHRpbmcgZm9yIHRoZSBcImJ1dHRvbiBvdmVyXCJcclxuICAgIGxldCBvdmVyQ291bnQgPSAwO1xyXG5cclxuICAgIC8vIEEgc2VtaS10cmFuc3BhcmVudCBvdmVybGF5IHdpdGggdGhlIHNhbWUgY29sb3IgYXMgdGhlIGJhY2tncm91bmQgKGFuZCB2YXJpYWJsZSBhbHBoYSkuIFVzZWQgdG8gYWRqdXN0IHRoZSB2aXN1YWxcclxuICAgIC8vIFwib3BhY2l0eVwiIG9mIHRoZSB1bmRlcmx5aW5nIGltYWdlIChieSB0b2dnbGluZyBvdXIgYWxwaGEpLCBhbmQgYXMgYSBoaXQtYXJlYSBmb3IgZXZlbnRzLlxyXG4gICAgY29uc3Qgb3ZlcmxheSA9IG5ldyBSZWN0YW5nbGUoIDAsIDAsIDEyMCwgYm9uZE9yZGVyICE9PSAwID8gQVRPTV9IRUlHSFQgOiBMT05FX1BBSVJfSEVJR0hULCAwLCAwLCBvcHRpb25zICk7XHJcbiAgICAvLyBUT0RPOiB0cmFjayB0aGlzIHdpdGggdGhlIEZpcmVMaXN0ZW5lcj9cclxuICAgIG92ZXJsYXkuYWRkSW5wdXRMaXN0ZW5lcigge1xyXG4gICAgICBlbnRlcjogKCkgPT4ge1xyXG4gICAgICAgIG92ZXJDb3VudCsrO1xyXG4gICAgICAgIHVwZGF0ZU92ZXJsYXlPcGFjaXR5KCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGV4aXQ6ICgpID0+IHtcclxuICAgICAgICBvdmVyQ291bnQtLTtcclxuICAgICAgICB1cGRhdGVPdmVybGF5T3BhY2l0eSgpO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcbiAgICBvdmVybGF5LmFkZElucHV0TGlzdGVuZXIoIG5ldyBGaXJlTGlzdGVuZXIoIHtcclxuICAgICAgY2FuU3RhcnRQcmVzczogKCkgPT4gZW5hYmxlZCxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnZmlyZUxpc3RlbmVyJyApLFxyXG4gICAgICBmaXJlT25Eb3duOiB0cnVlLFxyXG4gICAgICBmaXJlOiAoKSA9PiBhZGRQYWlyQ2FsbGJhY2soIGJvbmRPcmRlciwgb3ZlcmxheS5sb2NhbFRvR2xvYmFsQm91bmRzKCBvdmVybGF5LmxvY2FsQm91bmRzICkgKVxyXG4gICAgfSApICk7XHJcbiAgICBvdmVybGF5LnRvdWNoQXJlYSA9IG92ZXJsYXkubG9jYWxCb3VuZHMuZGlsYXRlZFkoIDQgKS53aXRoTWluWCggLTEwICk7XHJcblxyXG4gICAgLy8gb3VyIGltYWdlIG9mIHRoZSBsb25lIHBhaXIgLyBib25kLCB1bmRlciB0aGUgb3ZlcmxheS5cclxuICAgIGNvbnN0IGltYWdlID0gbmV3IEltYWdlKCBnZXRCb25kRGF0YVVSTCggYm9uZE9yZGVyICksIHtcclxuICAgICAgc2NhbGU6IDEgLyBJTUFHRV9TQ0FMRSAvLyByZXRpbmEgZGV2aWNlcyBjcmVhdGUgbGFyZ2UgaW1hZ2VzLCBzbyBmb3Igbm93IHdlIG5vcm1hbGl6ZSB0aGUgaW1hZ2Ugc2NhbGVcclxuICAgIH0gKTtcclxuICAgIC8vIG92ZXJyaWRlIGxvY2FsIGJvdW5kcyBiZWNhdXNlIHRoZSBjb3JyZWN0IGJvdW5kcyBtYXkgbm90IGJlIGxvYWRlZCB5ZXQgKGxvYWRpbmcgZnJvbSBhIGRhdGEgVVJMLCBub3QgYW4gSFRNTEltYWdlRWxlbWVudClcclxuICAgIGltYWdlLmxvY2FsQm91bmRzID0gYm9uZE9yZGVyID09PSAwID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEJvdW5kczIoIDAsIDAsIExPTkVfUEFJUl9XSURUSCAqIElNQUdFX1NDQUxFLCBMT05FX1BBSVJfSEVJR0hUICogSU1BR0VfU0NBTEUgKSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBCb3VuZHMyKCAwLCAwLCBBVE9NX1dJRFRIICogSU1BR0VfU0NBTEUsIEFUT01fSEVJR0hUICogSU1BR0VfU0NBTEUgKTtcclxuICAgIGltYWdlLmNlbnRlciA9IG92ZXJsYXkuY2VudGVyO1xyXG5cclxuICAgIC8vIGhhbmRsZSB1cGRhdGVzIHRvIG91ciBjb2xvciBzY2hlbWUgYnkgcmVjcmVhdGluZyB0aGUgaW1hZ2VzIG5lZWRlZFxyXG4gICAgZnVuY3Rpb24gdXBkYXRlSW1hZ2UoKSB7XHJcbiAgICAgIGltYWdlLmltYWdlID0gZ2V0Qm9uZERhdGFVUkwoIGJvbmRPcmRlciApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggYm9uZE9yZGVyID09PSAwICkge1xyXG4gICAgICBNb2xlY3VsZVNoYXBlc0NvbG9ycy5sb25lUGFpclNoZWxsUHJvcGVydHkubGF6eUxpbmsoIHVwZGF0ZUltYWdlICk7XHJcbiAgICAgIE1vbGVjdWxlU2hhcGVzQ29sb3JzLmxvbmVQYWlyRWxlY3Ryb25Qcm9wZXJ0eS5sYXp5TGluayggdXBkYXRlSW1hZ2UgKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBNb2xlY3VsZVNoYXBlc0NvbG9ycy5hdG9tUHJvcGVydHkubGF6eUxpbmsoIHVwZGF0ZUltYWdlICk7XHJcbiAgICAgIE1vbGVjdWxlU2hhcGVzQ29sb3JzLmJvbmRQcm9wZXJ0eS5sYXp5TGluayggdXBkYXRlSW1hZ2UgKTtcclxuICAgIH1cclxuICAgIE1vbGVjdWxlU2hhcGVzQ29sb3JzLmJhY2tncm91bmRQcm9wZXJ0eS5sYXp5TGluayggdXBkYXRlSW1hZ2UgKTtcclxuXHJcbiAgICAvLyBtb3ZlIHRoZSBsb25lIHBhaXIgb3ZlciB0byB0aGUgcmlnaHQgbW9yZSwgc28gdGhhdCBpdCBsb29rcyBtb3JlIGNlbnRlcmVkXHJcbiAgICBpZiAoIGJvbmRPcmRlciA9PT0gMCApIHtcclxuICAgICAgaW1hZ2UucmlnaHQgPSBvdmVybGF5LnJpZ2h0IC0gMTA7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdGh1bWJuYWlsID0gbmV3IE5vZGUoIHsgY2hpbGRyZW46IFsgaW1hZ2UsIG92ZXJsYXkgXSB9ICk7XHJcblxyXG4gICAgLy8gYnV0dG9uIHRvIHJlbW92ZSBhIGNvcHkgb2YgdGhlIGJvbmQgLyBsb25lIHBhaXJcclxuICAgIGNvbnN0IHJlbW92ZUJ1dHRvbiA9IG5ldyBSZW1vdmVQYWlyR3JvdXBCdXR0b24oIHtcclxuICAgICAgbGlzdGVuZXI6ICgpID0+IHtcclxuICAgICAgICByZW1vdmVQYWlyQ2FsbGJhY2soIGJvbmRPcmRlciApO1xyXG4gICAgICB9LFxyXG4gICAgICB2aXNpYmxlUHJvcGVydHlPcHRpb25zOiB7IHBoZXRpb1JlYWRPbmx5OiB0cnVlIH0sXHJcbiAgICAgIGVuYWJsZWRQcm9wZXJ0eU9wdGlvbnM6IHsgcGhldGlvUmVhZE9ubHk6IHRydWUgfSxcclxuXHJcbiAgICAgIC8vIEFkanVzdGVkIHRvIG1hdGNoIHRoZSBsZWZ0IG9mIHRoZSB0b3VjaCBhcmVhIG9mIHRoZSBvdmVybGF5XHJcbiAgICAgIHRvdWNoQXJlYVhTaGlmdDogNSxcclxuICAgICAgdG91Y2hBcmVhWERpbGF0aW9uOiAxNSxcclxuICAgICAgdG91Y2hBcmVhWURpbGF0aW9uOiAxNCxcclxuXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3JlbW92ZUJ1dHRvbicgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHVwZGF0ZXMgdGhlIHZpc3VhbCBzdGF0ZSBvZiB0aGUgdGh1bWJuYWlsIChpbWFnZS9vdmVybGF5KSBhbmQgcmVtb3ZhbCBidXR0b25cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZSgpIHtcclxuICAgICAgZW5hYmxlZCA9IG1vZGVsLm1vbGVjdWxlUHJvcGVydHkudmFsdWUud291bGRBbGxvd0JvbmRPcmRlciggYm9uZE9yZGVyICk7XHJcbiAgICAgIGlmICggYm9uZE9yZGVyID09PSAwICkge1xyXG4gICAgICAgIGVuYWJsZWQgPSBlbmFibGVkICYmIG1vZGVsLnNob3dMb25lUGFpcnNQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgfVxyXG4gICAgICBvdmVybGF5LmN1cnNvciA9IGVuYWJsZWQgPyAncG9pbnRlcicgOiBudWxsO1xyXG5cclxuICAgICAgcmVtb3ZlQnV0dG9uLnZpc2libGUgPSBfLmZpbHRlciggbW9kZWwubW9sZWN1bGVQcm9wZXJ0eS52YWx1ZS5nZXRCb25kc0Fyb3VuZCggbW9kZWwubW9sZWN1bGVQcm9wZXJ0eS52YWx1ZS5jZW50cmFsQXRvbSApLCBib25kID0+IGJvbmQub3JkZXIgPT09IGJvbmRPcmRlciApLmxlbmd0aCA+IDA7XHJcblxyXG4gICAgICB1cGRhdGVPdmVybGF5T3BhY2l0eSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZU92ZXJsYXlPcGFjaXR5KCkge1xyXG4gICAgICBsZXQgYWxwaGE7XHJcbiAgICAgIGlmICggZW5hYmxlZCApIHtcclxuICAgICAgICAvLyB3aGVuIFwiYnV0dG9uIG92ZXJcIiB0aGUgb3ZlcmxheSB3aWxsIHNob3cgdGhyb3VnaCBtb3JlIG9mIHRoZSBpbWFnZVxyXG4gICAgICAgIGFscGhhID0gb3ZlckNvdW50ID4gMCA/IDAgOiAwLjE7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgYWxwaGEgPSAwLjQ7XHJcbiAgICAgIH1cclxuICAgICAgb3ZlcmxheS5maWxsID0gTW9sZWN1bGVTaGFwZXNDb2xvcnMuYmFja2dyb3VuZFByb3BlcnR5LnZhbHVlLndpdGhBbHBoYSggYWxwaGEgKTtcclxuICAgIH1cclxuXHJcbiAgICBtb2RlbC5tb2xlY3VsZVByb3BlcnR5LmxpbmsoICggbmV3TW9sZWN1bGUsIG9sZE1vbGVjdWxlICkgPT4ge1xyXG4gICAgICBpZiAoIG9sZE1vbGVjdWxlICkge1xyXG4gICAgICAgIG9sZE1vbGVjdWxlLmJvbmRDaGFuZ2VkRW1pdHRlci5yZW1vdmVMaXN0ZW5lciggdXBkYXRlICk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCBuZXdNb2xlY3VsZSApIHtcclxuICAgICAgICBuZXdNb2xlY3VsZS5ib25kQ2hhbmdlZEVtaXR0ZXIuYWRkTGlzdGVuZXIoIHVwZGF0ZSApO1xyXG4gICAgICB9XHJcbiAgICAgIHVwZGF0ZSgpO1xyXG4gICAgfSApO1xyXG4gICAgbW9kZWwuc2hvd0xvbmVQYWlyc1Byb3BlcnR5LmxpbmsoIHVwZGF0ZSApO1xyXG4gICAgTW9sZWN1bGUubWF4Q29ubmVjdGlvbnNQcm9wZXJ0eS5sYXp5TGluayggdXBkYXRlICk7XHJcblxyXG4gICAgTW9sZWN1bGVTaGFwZXNDb2xvcnMuYmFja2dyb3VuZFByb3BlcnR5LmxhenlMaW5rKCB1cGRhdGUgKTtcclxuXHJcbiAgICB0aGlzLm11dGF0ZSggbWVyZ2UoIHtcclxuICAgICAgY2hpbGRyZW46IFsgdGh1bWJuYWlsLCByZW1vdmVCdXR0b24gXSxcclxuICAgICAgc3BhY2luZzogMTAsXHJcbiAgICAgIGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgZXhjbHVkZUludmlzaWJsZUNoaWxkcmVuRnJvbUJvdW5kczogZmFsc2VcclxuICAgIH0sIG9wdGlvbnMgKSApO1xyXG4gIH1cclxufVxyXG5cclxubW9sZWN1bGVTaGFwZXMucmVnaXN0ZXIoICdCb25kR3JvdXBOb2RlJywgQm9uZEdyb3VwTm9kZSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQm9uZEdyb3VwTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsT0FBTyxNQUFNLDRCQUE0QjtBQUNoRCxPQUFPQyxPQUFPLE1BQU0sNEJBQTRCO0FBQ2hELE9BQU9DLEtBQUssTUFBTSxnQ0FBZ0M7QUFDbEQsT0FBT0MsUUFBUSxNQUFNLG1DQUFtQztBQUN4RCxTQUFTQyxZQUFZLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFQyxTQUFTLEVBQUVDLElBQUksRUFBRUMsU0FBUyxRQUFRLGdDQUFnQztBQUN0RyxPQUFPQyxNQUFNLE1BQU0sOEJBQThCO0FBQ2pELE9BQU9DLFFBQVEsTUFBTSw2QkFBNkI7QUFD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