// Copyright 2014-2023, University of Colorado Boulder

/**
 * View for the 'Real Molecules' screen.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import ChemUtils from '../../../nitroglycerin/js/ChemUtils.js';
import PhetFont from '../../../scenery-phet/js/PhetFont.js';
import { AlignBox, Node, RichText, Text, VBox } from '../../../scenery/js/imports.js';
import AquaRadioButtonGroup from '../../../sun/js/AquaRadioButtonGroup.js';
import ComboBox from '../../../sun/js/ComboBox.js';
import MoleculeView from '../common/view/3d/MoleculeView.js';
import MoleculeShapesColors from '../common/view/MoleculeShapesColors.js';
import MoleculeShapesPanel from '../common/view/MoleculeShapesPanel.js';
import MoleculeShapesScreenView from '../common/view/MoleculeShapesScreenView.js';
import OptionsNode from '../common/view/OptionsNode.js';
import moleculeShapes from '../moleculeShapes.js';
import MoleculeShapesStrings from '../MoleculeShapesStrings.js';
class RealMoleculesScreenView extends MoleculeShapesScreenView {
  /**
   * @param {ModelMoleculesModel} model the model for the entire screen
   * @param {Tandem} tandem
   */
  constructor(model, tandem) {
    super(model, tandem);
    this.model = model; // @private {MoleculeShapesModel}
    this.moleculeView = new MoleculeView(model, this, model.moleculeProperty.value, tandem.createTandem('moleculeView')); // @public
    this.addMoleculeView(this.moleculeView);
    const moleculePanelTandem = tandem.createTandem('moleculePanel');
    const optionsPanelTandem = tandem.createTandem('optionsPanel');
    const comboBoxListContainer = new Node();
    const comboBoxItems = _.map(model.realMoleculeShapeProperty.validValues, realMoleculeShape => {
      return {
        value: realMoleculeShape,
        createNode: () => new RichText(ChemUtils.toSubscript(realMoleculeShape.displayName)),
        tandemName: `${realMoleculeShape.displayName}${ComboBox.ITEM_TANDEM_NAME_SUFFIX}`
      };
    });
    const moleculeComboBox = new ComboBox(model.realMoleculeShapeProperty, comboBoxItems, comboBoxListContainer, {
      xMargin: 13,
      yMargin: 10,
      cornerRadius: 8,
      tandem: moleculePanelTandem.createTandem('moleculeComboBox'),
      widthSizable: false
    });
    const optionsNode = new OptionsNode(model, optionsPanelTandem.createTandem('optionsCheckboxGroup'));
    const rightBox = new VBox({
      spacing: 15,
      stretch: true,
      children: [new MoleculeShapesPanel(MoleculeShapesStrings.control.moleculeStringProperty, moleculeComboBox, moleculePanelTandem, {
        tandem: moleculePanelTandem,
        align: 'center'
      }), new MoleculeShapesPanel(MoleculeShapesStrings.control.optionsStringProperty, optionsNode, optionsPanelTandem, {
        tandem: optionsPanelTandem
      })]
    });
    this.addChild(new AlignBox(rightBox, {
      alignBounds: this.layoutBounds,
      xAlign: 'right',
      yAlign: 'top',
      margin: 10
    }));
    this.addChild(comboBoxListContainer);
    if (!model.isBasicsVersion) {
      // we offset the camera, so we don't have an exact constant. this is tuned
      const approximateVisualCenterX = this.layoutBounds.width / 2 - 100;

      // NOTE: these font sizes are scaled!
      const horizontalSpacing = 30;
      const radioButtonScale = 0.7;
      const realModelRadioButtonGroup = new AquaRadioButtonGroup(model.showRealViewProperty, [{
        createNode: tandem => new Text(MoleculeShapesStrings.control.realViewStringProperty, {
          font: new PhetFont(28),
          fill: MoleculeShapesColors.controlPanelTextProperty,
          tandem: tandem.createTandem('text')
        }),
        value: true,
        tandemName: 'realRadioButton'
      }, {
        createNode: tandem => new Text(MoleculeShapesStrings.control.modelViewStringProperty, {
          font: new PhetFont(28),
          fill: MoleculeShapesColors.controlPanelTextProperty,
          tandem: tandem.createTandem('text')
        }),
        value: false,
        tandemName: 'modelRadioButton'
      }], {
        radioButtonOptions: {
          radius: 16,
          scale: radioButtonScale,
          maxWidth: 320
        },
        tandem: tandem.createTandem('realModelRadioButtonGroup'),
        touchAreaYDilation: 10,
        spacing: horizontalSpacing,
        orientation: 'horizontal'
      });
      realModelRadioButtonGroup.localBoundsProperty.link(() => {
        realModelRadioButtonGroup.top = this.layoutBounds.top + 20;
        realModelRadioButtonGroup.centerX = approximateVisualCenterX;
      });
      this.addChild(realModelRadioButtonGroup);
    }

    // rebuild our view when we switch molecules
    model.moleculeProperty.lazyLink((newMolecule, oldMolecule) => {
      // tear down the old view
      this.removeMoleculeView(this.moleculeView);
      this.moleculeView.dispose();

      // create the new view
      this.moleculeView = new MoleculeView(model, this, newMolecule, tandem.createTandem('moleculeView'));
      this.addMoleculeView(this.moleculeView);
    });
  }
}
moleculeShapes.register('RealMoleculesScreenView', RealMoleculesScreenView);
export default RealMoleculesScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDaGVtVXRpbHMiLCJQaGV0Rm9udCIsIkFsaWduQm94IiwiTm9kZSIsIlJpY2hUZXh0IiwiVGV4dCIsIlZCb3giLCJBcXVhUmFkaW9CdXR0b25Hcm91cCIsIkNvbWJvQm94IiwiTW9sZWN1bGVWaWV3IiwiTW9sZWN1bGVTaGFwZXNDb2xvcnMiLCJNb2xlY3VsZVNoYXBlc1BhbmVsIiwiTW9sZWN1bGVTaGFwZXNTY3JlZW5WaWV3IiwiT3B0aW9uc05vZGUiLCJtb2xlY3VsZVNoYXBlcyIsIk1vbGVjdWxlU2hhcGVzU3RyaW5ncyIsIlJlYWxNb2xlY3VsZXNTY3JlZW5WaWV3IiwiY29uc3RydWN0b3IiLCJtb2RlbCIsInRhbmRlbSIsIm1vbGVjdWxlVmlldyIsIm1vbGVjdWxlUHJvcGVydHkiLCJ2YWx1ZSIsImNyZWF0ZVRhbmRlbSIsImFkZE1vbGVjdWxlVmlldyIsIm1vbGVjdWxlUGFuZWxUYW5kZW0iLCJvcHRpb25zUGFuZWxUYW5kZW0iLCJjb21ib0JveExpc3RDb250YWluZXIiLCJjb21ib0JveEl0ZW1zIiwiXyIsIm1hcCIsInJlYWxNb2xlY3VsZVNoYXBlUHJvcGVydHkiLCJ2YWxpZFZhbHVlcyIsInJlYWxNb2xlY3VsZVNoYXBlIiwiY3JlYXRlTm9kZSIsInRvU3Vic2NyaXB0IiwiZGlzcGxheU5hbWUiLCJ0YW5kZW1OYW1lIiwiSVRFTV9UQU5ERU1fTkFNRV9TVUZGSVgiLCJtb2xlY3VsZUNvbWJvQm94IiwieE1hcmdpbiIsInlNYXJnaW4iLCJjb3JuZXJSYWRpdXMiLCJ3aWR0aFNpemFibGUiLCJvcHRpb25zTm9kZSIsInJpZ2h0Qm94Iiwic3BhY2luZyIsInN0cmV0Y2giLCJjaGlsZHJlbiIsImNvbnRyb2wiLCJtb2xlY3VsZVN0cmluZ1Byb3BlcnR5IiwiYWxpZ24iLCJvcHRpb25zU3RyaW5nUHJvcGVydHkiLCJhZGRDaGlsZCIsImFsaWduQm91bmRzIiwibGF5b3V0Qm91bmRzIiwieEFsaWduIiwieUFsaWduIiwibWFyZ2luIiwiaXNCYXNpY3NWZXJzaW9uIiwiYXBwcm94aW1hdGVWaXN1YWxDZW50ZXJYIiwid2lkdGgiLCJob3Jpem9udGFsU3BhY2luZyIsInJhZGlvQnV0dG9uU2NhbGUiLCJyZWFsTW9kZWxSYWRpb0J1dHRvbkdyb3VwIiwic2hvd1JlYWxWaWV3UHJvcGVydHkiLCJyZWFsVmlld1N0cmluZ1Byb3BlcnR5IiwiZm9udCIsImZpbGwiLCJjb250cm9sUGFuZWxUZXh0UHJvcGVydHkiLCJtb2RlbFZpZXdTdHJpbmdQcm9wZXJ0eSIsInJhZGlvQnV0dG9uT3B0aW9ucyIsInJhZGl1cyIsInNjYWxlIiwibWF4V2lkdGgiLCJ0b3VjaEFyZWFZRGlsYXRpb24iLCJvcmllbnRhdGlvbiIsImxvY2FsQm91bmRzUHJvcGVydHkiLCJsaW5rIiwidG9wIiwiY2VudGVyWCIsImxhenlMaW5rIiwibmV3TW9sZWN1bGUiLCJvbGRNb2xlY3VsZSIsInJlbW92ZU1vbGVjdWxlVmlldyIsImRpc3Bvc2UiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlJlYWxNb2xlY3VsZXNTY3JlZW5WaWV3LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFZpZXcgZm9yIHRoZSAnUmVhbCBNb2xlY3VsZXMnIHNjcmVlbi5cclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBDaGVtVXRpbHMgZnJvbSAnLi4vLi4vLi4vbml0cm9nbHljZXJpbi9qcy9DaGVtVXRpbHMuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgQWxpZ25Cb3gsIE5vZGUsIFJpY2hUZXh0LCBUZXh0LCBWQm94IH0gZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEFxdWFSYWRpb0J1dHRvbkdyb3VwIGZyb20gJy4uLy4uLy4uL3N1bi9qcy9BcXVhUmFkaW9CdXR0b25Hcm91cC5qcyc7XHJcbmltcG9ydCBDb21ib0JveCBmcm9tICcuLi8uLi8uLi9zdW4vanMvQ29tYm9Cb3guanMnO1xyXG5pbXBvcnQgTW9sZWN1bGVWaWV3IGZyb20gJy4uL2NvbW1vbi92aWV3LzNkL01vbGVjdWxlVmlldy5qcyc7XHJcbmltcG9ydCBNb2xlY3VsZVNoYXBlc0NvbG9ycyBmcm9tICcuLi9jb21tb24vdmlldy9Nb2xlY3VsZVNoYXBlc0NvbG9ycy5qcyc7XHJcbmltcG9ydCBNb2xlY3VsZVNoYXBlc1BhbmVsIGZyb20gJy4uL2NvbW1vbi92aWV3L01vbGVjdWxlU2hhcGVzUGFuZWwuanMnO1xyXG5pbXBvcnQgTW9sZWN1bGVTaGFwZXNTY3JlZW5WaWV3IGZyb20gJy4uL2NvbW1vbi92aWV3L01vbGVjdWxlU2hhcGVzU2NyZWVuVmlldy5qcyc7XHJcbmltcG9ydCBPcHRpb25zTm9kZSBmcm9tICcuLi9jb21tb24vdmlldy9PcHRpb25zTm9kZS5qcyc7XHJcbmltcG9ydCBtb2xlY3VsZVNoYXBlcyBmcm9tICcuLi9tb2xlY3VsZVNoYXBlcy5qcyc7XHJcbmltcG9ydCBNb2xlY3VsZVNoYXBlc1N0cmluZ3MgZnJvbSAnLi4vTW9sZWN1bGVTaGFwZXNTdHJpbmdzLmpzJztcclxuXHJcbmNsYXNzIFJlYWxNb2xlY3VsZXNTY3JlZW5WaWV3IGV4dGVuZHMgTW9sZWN1bGVTaGFwZXNTY3JlZW5WaWV3IHtcclxuICAvKipcclxuICAgKiBAcGFyYW0ge01vZGVsTW9sZWN1bGVzTW9kZWx9IG1vZGVsIHRoZSBtb2RlbCBmb3IgdGhlIGVudGlyZSBzY3JlZW5cclxuICAgKiBAcGFyYW0ge1RhbmRlbX0gdGFuZGVtXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG1vZGVsLCB0YW5kZW0gKSB7XHJcbiAgICBzdXBlciggbW9kZWwsIHRhbmRlbSApO1xyXG5cclxuICAgIHRoaXMubW9kZWwgPSBtb2RlbDsgLy8gQHByaXZhdGUge01vbGVjdWxlU2hhcGVzTW9kZWx9XHJcbiAgICB0aGlzLm1vbGVjdWxlVmlldyA9IG5ldyBNb2xlY3VsZVZpZXcoIG1vZGVsLCB0aGlzLCBtb2RlbC5tb2xlY3VsZVByb3BlcnR5LnZhbHVlLCB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnbW9sZWN1bGVWaWV3JyApICk7IC8vIEBwdWJsaWNcclxuICAgIHRoaXMuYWRkTW9sZWN1bGVWaWV3KCB0aGlzLm1vbGVjdWxlVmlldyApO1xyXG5cclxuICAgIGNvbnN0IG1vbGVjdWxlUGFuZWxUYW5kZW0gPSB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnbW9sZWN1bGVQYW5lbCcgKTtcclxuICAgIGNvbnN0IG9wdGlvbnNQYW5lbFRhbmRlbSA9IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdvcHRpb25zUGFuZWwnICk7XHJcblxyXG4gICAgY29uc3QgY29tYm9Cb3hMaXN0Q29udGFpbmVyID0gbmV3IE5vZGUoKTtcclxuICAgIGNvbnN0IGNvbWJvQm94SXRlbXMgPSBfLm1hcCggbW9kZWwucmVhbE1vbGVjdWxlU2hhcGVQcm9wZXJ0eS52YWxpZFZhbHVlcywgcmVhbE1vbGVjdWxlU2hhcGUgPT4ge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHZhbHVlOiByZWFsTW9sZWN1bGVTaGFwZSxcclxuICAgICAgICBjcmVhdGVOb2RlOiAoKSA9PiBuZXcgUmljaFRleHQoIENoZW1VdGlscy50b1N1YnNjcmlwdCggcmVhbE1vbGVjdWxlU2hhcGUuZGlzcGxheU5hbWUgKSApLFxyXG4gICAgICAgIHRhbmRlbU5hbWU6IGAke3JlYWxNb2xlY3VsZVNoYXBlLmRpc3BsYXlOYW1lfSR7Q29tYm9Cb3guSVRFTV9UQU5ERU1fTkFNRV9TVUZGSVh9YFxyXG4gICAgICB9O1xyXG4gICAgfSApO1xyXG4gICAgY29uc3QgbW9sZWN1bGVDb21ib0JveCA9IG5ldyBDb21ib0JveCggbW9kZWwucmVhbE1vbGVjdWxlU2hhcGVQcm9wZXJ0eSwgY29tYm9Cb3hJdGVtcywgY29tYm9Cb3hMaXN0Q29udGFpbmVyLCB7XHJcbiAgICAgIHhNYXJnaW46IDEzLFxyXG4gICAgICB5TWFyZ2luOiAxMCxcclxuICAgICAgY29ybmVyUmFkaXVzOiA4LFxyXG4gICAgICB0YW5kZW06IG1vbGVjdWxlUGFuZWxUYW5kZW0uY3JlYXRlVGFuZGVtKCAnbW9sZWN1bGVDb21ib0JveCcgKSxcclxuICAgICAgd2lkdGhTaXphYmxlOiBmYWxzZVxyXG4gICAgfSApO1xyXG4gICAgY29uc3Qgb3B0aW9uc05vZGUgPSBuZXcgT3B0aW9uc05vZGUoIG1vZGVsLCBvcHRpb25zUGFuZWxUYW5kZW0uY3JlYXRlVGFuZGVtKCAnb3B0aW9uc0NoZWNrYm94R3JvdXAnICkgKTtcclxuXHJcbiAgICBjb25zdCByaWdodEJveCA9IG5ldyBWQm94KCB7XHJcbiAgICAgIHNwYWNpbmc6IDE1LFxyXG4gICAgICBzdHJldGNoOiB0cnVlLFxyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIG5ldyBNb2xlY3VsZVNoYXBlc1BhbmVsKCBNb2xlY3VsZVNoYXBlc1N0cmluZ3MuY29udHJvbC5tb2xlY3VsZVN0cmluZ1Byb3BlcnR5LCBtb2xlY3VsZUNvbWJvQm94LCBtb2xlY3VsZVBhbmVsVGFuZGVtLCB7XHJcbiAgICAgICAgICB0YW5kZW06IG1vbGVjdWxlUGFuZWxUYW5kZW0sXHJcbiAgICAgICAgICBhbGlnbjogJ2NlbnRlcidcclxuICAgICAgICB9ICksXHJcbiAgICAgICAgbmV3IE1vbGVjdWxlU2hhcGVzUGFuZWwoIE1vbGVjdWxlU2hhcGVzU3RyaW5ncy5jb250cm9sLm9wdGlvbnNTdHJpbmdQcm9wZXJ0eSwgb3B0aW9uc05vZGUsIG9wdGlvbnNQYW5lbFRhbmRlbSwge1xyXG4gICAgICAgICAgdGFuZGVtOiBvcHRpb25zUGFuZWxUYW5kZW1cclxuICAgICAgICB9IClcclxuICAgICAgXVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggbmV3IEFsaWduQm94KCByaWdodEJveCwge1xyXG4gICAgICBhbGlnbkJvdW5kczogdGhpcy5sYXlvdXRCb3VuZHMsXHJcbiAgICAgIHhBbGlnbjogJ3JpZ2h0JyxcclxuICAgICAgeUFsaWduOiAndG9wJyxcclxuICAgICAgbWFyZ2luOiAxMFxyXG4gICAgfSApICk7XHJcblxyXG4gICAgdGhpcy5hZGRDaGlsZCggY29tYm9Cb3hMaXN0Q29udGFpbmVyICk7XHJcblxyXG4gICAgaWYgKCAhbW9kZWwuaXNCYXNpY3NWZXJzaW9uICkge1xyXG4gICAgICAvLyB3ZSBvZmZzZXQgdGhlIGNhbWVyYSwgc28gd2UgZG9uJ3QgaGF2ZSBhbiBleGFjdCBjb25zdGFudC4gdGhpcyBpcyB0dW5lZFxyXG4gICAgICBjb25zdCBhcHByb3hpbWF0ZVZpc3VhbENlbnRlclggPSB0aGlzLmxheW91dEJvdW5kcy53aWR0aCAvIDIgLSAxMDA7XHJcblxyXG4gICAgICAvLyBOT1RFOiB0aGVzZSBmb250IHNpemVzIGFyZSBzY2FsZWQhXHJcbiAgICAgIGNvbnN0IGhvcml6b250YWxTcGFjaW5nID0gMzA7XHJcbiAgICAgIGNvbnN0IHJhZGlvQnV0dG9uU2NhbGUgPSAwLjc7XHJcblxyXG4gICAgICBjb25zdCByZWFsTW9kZWxSYWRpb0J1dHRvbkdyb3VwID0gbmV3IEFxdWFSYWRpb0J1dHRvbkdyb3VwKCBtb2RlbC5zaG93UmVhbFZpZXdQcm9wZXJ0eSwgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGNyZWF0ZU5vZGU6IHRhbmRlbSA9PiBuZXcgVGV4dCggTW9sZWN1bGVTaGFwZXNTdHJpbmdzLmNvbnRyb2wucmVhbFZpZXdTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICAgICAgICBmb250OiBuZXcgUGhldEZvbnQoIDI4ICksXHJcbiAgICAgICAgICAgIGZpbGw6IE1vbGVjdWxlU2hhcGVzQ29sb3JzLmNvbnRyb2xQYW5lbFRleHRQcm9wZXJ0eSxcclxuICAgICAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAndGV4dCcgKVxyXG4gICAgICAgICAgfSApLFxyXG4gICAgICAgICAgdmFsdWU6IHRydWUsXHJcbiAgICAgICAgICB0YW5kZW1OYW1lOiAncmVhbFJhZGlvQnV0dG9uJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgY3JlYXRlTm9kZTogdGFuZGVtID0+IG5ldyBUZXh0KCBNb2xlY3VsZVNoYXBlc1N0cmluZ3MuY29udHJvbC5tb2RlbFZpZXdTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICAgICAgICBmb250OiBuZXcgUGhldEZvbnQoIDI4ICksXHJcbiAgICAgICAgICAgIGZpbGw6IE1vbGVjdWxlU2hhcGVzQ29sb3JzLmNvbnRyb2xQYW5lbFRleHRQcm9wZXJ0eSxcclxuICAgICAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAndGV4dCcgKVxyXG4gICAgICAgICAgfSApLFxyXG4gICAgICAgICAgdmFsdWU6IGZhbHNlLFxyXG4gICAgICAgICAgdGFuZGVtTmFtZTogJ21vZGVsUmFkaW9CdXR0b24nXHJcbiAgICAgICAgfVxyXG4gICAgICBdLCB7XHJcbiAgICAgICAgcmFkaW9CdXR0b25PcHRpb25zOiB7XHJcbiAgICAgICAgICByYWRpdXM6IDE2LFxyXG4gICAgICAgICAgc2NhbGU6IHJhZGlvQnV0dG9uU2NhbGUsXHJcbiAgICAgICAgICBtYXhXaWR0aDogMzIwXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdyZWFsTW9kZWxSYWRpb0J1dHRvbkdyb3VwJyApLFxyXG4gICAgICAgIHRvdWNoQXJlYVlEaWxhdGlvbjogMTAsXHJcbiAgICAgICAgc3BhY2luZzogaG9yaXpvbnRhbFNwYWNpbmcsXHJcbiAgICAgICAgb3JpZW50YXRpb246ICdob3Jpem9udGFsJ1xyXG4gICAgICB9ICk7XHJcbiAgICAgIHJlYWxNb2RlbFJhZGlvQnV0dG9uR3JvdXAubG9jYWxCb3VuZHNQcm9wZXJ0eS5saW5rKCAoKSA9PiB7XHJcbiAgICAgICAgcmVhbE1vZGVsUmFkaW9CdXR0b25Hcm91cC50b3AgPSB0aGlzLmxheW91dEJvdW5kcy50b3AgKyAyMDtcclxuICAgICAgICByZWFsTW9kZWxSYWRpb0J1dHRvbkdyb3VwLmNlbnRlclggPSBhcHByb3hpbWF0ZVZpc3VhbENlbnRlclg7XHJcbiAgICAgIH0gKTtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggcmVhbE1vZGVsUmFkaW9CdXR0b25Hcm91cCApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJlYnVpbGQgb3VyIHZpZXcgd2hlbiB3ZSBzd2l0Y2ggbW9sZWN1bGVzXHJcbiAgICBtb2RlbC5tb2xlY3VsZVByb3BlcnR5LmxhenlMaW5rKCAoIG5ld01vbGVjdWxlLCBvbGRNb2xlY3VsZSApID0+IHtcclxuICAgICAgLy8gdGVhciBkb3duIHRoZSBvbGQgdmlld1xyXG4gICAgICB0aGlzLnJlbW92ZU1vbGVjdWxlVmlldyggdGhpcy5tb2xlY3VsZVZpZXcgKTtcclxuICAgICAgdGhpcy5tb2xlY3VsZVZpZXcuZGlzcG9zZSgpO1xyXG5cclxuICAgICAgLy8gY3JlYXRlIHRoZSBuZXcgdmlld1xyXG4gICAgICB0aGlzLm1vbGVjdWxlVmlldyA9IG5ldyBNb2xlY3VsZVZpZXcoIG1vZGVsLCB0aGlzLCBuZXdNb2xlY3VsZSwgdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ21vbGVjdWxlVmlldycgKSApO1xyXG4gICAgICB0aGlzLmFkZE1vbGVjdWxlVmlldyggdGhpcy5tb2xlY3VsZVZpZXcgKTtcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbm1vbGVjdWxlU2hhcGVzLnJlZ2lzdGVyKCAnUmVhbE1vbGVjdWxlc1NjcmVlblZpZXcnLCBSZWFsTW9sZWN1bGVzU2NyZWVuVmlldyApO1xyXG5leHBvcnQgZGVmYXVsdCBSZWFsTW9sZWN1bGVzU2NyZWVuVmlldzsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsU0FBUyxNQUFNLHdD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