// Copyright 2014-2023, University of Colorado Boulder

/**
 * Period trace timer node in 'Pendulum Lab' simulation.
 *
 * @author Andrey Zelenkov (Mlearner)
 */

import Bounds2 from '../../../../dot/js/Bounds2.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
import Utils from '../../../../dot/js/Utils.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import { Shape } from '../../../../kite/js/imports.js';
import merge from '../../../../phet-core/js/merge.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import UTurnArrowShape from '../../../../scenery-phet/js/UTurnArrowShape.js';
import { AlignBox, Color, DragListener, HBox, Image, LinearGradient, Node, Path, Rectangle, Text, VBox } from '../../../../scenery/js/imports.js';
import Property from '../../../../axon/js/Property.js';
import ABSwitch from '../../../../sun/js/ABSwitch.js';
import BooleanRectangularToggleButton from '../../../../sun/js/buttons/BooleanRectangularToggleButton.js';
import periodTimerBackground_png from '../../../mipmaps/periodTimerBackground_png.js';
import PendulumLabConstants from '../../common/PendulumLabConstants.js';
import pendulumLab from '../../pendulumLab.js';
import PendulumLabStrings from '../../PendulumLabStrings.js';
const periodString = PendulumLabStrings.period;
const secondsPatternString = PendulumLabStrings.secondsPattern;
class PeriodTimerNode extends Node {
  /**
   * @param {PeriodTimer} periodTimer - Period timer
   * @param {Property.<boolean>} secondPendulumIsVisibleProperty - Second pendulum visibility property.
   * @param {Bounds2} layoutBounds - Bounds of screen view.
   * @param {Object} [options]
   */
  constructor(periodTimer, secondPendulumIsVisibleProperty, layoutBounds, options) {
    options = merge({
      iconColor: '#333',
      buttonBaseColor: '#DFE0E1',
      cursor: 'pointer'
    }, options);
    super(options);

    // creates Uturn arrow on the period timer tool
    const uArrowShape = new UTurnArrowShape(10);

    // creates triangle shape on play button by creating three lines at x,y coordinates.
    const playPauseSize = uArrowShape.bounds.height;
    const halfPlayStroke = 0.05 * playPauseSize;
    const playOffset = 0.15 * playPauseSize;
    const playShape = new Shape().moveTo(playPauseSize - halfPlayStroke * 0.5 - playOffset, 0).lineTo(halfPlayStroke * 1.5 + playOffset, playPauseSize / 2 - halfPlayStroke - playOffset).lineTo(halfPlayStroke * 1.5 + playOffset, -playPauseSize / 2 + halfPlayStroke + playOffset).close().getOffsetShape(-playOffset);

    // creates playPauseButton
    const playPauseButton = new BooleanRectangularToggleButton(periodTimer.isRunningProperty, new Path(uArrowShape, {
      fill: options.iconColor,
      center: Vector2.ZERO,
      pickable: false
    }), new Path(playShape, {
      pickable: false,
      stroke: options.iconColor,
      fill: '#eef',
      lineWidth: halfPlayStroke * 2,
      center: Vector2.ZERO
    }), {
      baseColor: options.buttonBaseColor,
      minWidth: 40
    });
    playPauseButton.touchArea = playPauseButton.localBounds.dilated(5);
    function createPendulumIcon(color, label, padLeft) {
      const highlightColor = Color.toColor(color).colorUtilsBrighter(0.4);
      const rectBounds = new Bounds2(0, 0, 17, 20);
      const icon = new Node({
        children: [Rectangle.bounds(rectBounds, {
          stroke: 'black',
          lineWidth: 0.5,
          fill: new LinearGradient(0, 0, rectBounds.width, 0).addColorStop(0, color).addColorStop(0.2, highlightColor).addColorStop(0.4, color).addColorStop(1, color)
        }), new Text(label, {
          fill: 'white',
          font: new PhetFont(14),
          center: rectBounds.center
        })]
      });

      // Don't pad next to the AB switch, but only away from it
      const touchArea = icon.localBounds.dilated(5);
      if (padLeft) {
        touchArea.maxX = icon.localBounds.maxX;
      } else {
        touchArea.minX = icon.localBounds.minX;
      }
      icon.touchArea = touchArea;
      return icon;
    }
    const firstPendulumIcon = createPendulumIcon(PendulumLabConstants.FIRST_PENDULUM_COLOR, '1', true);
    const secondPendulumIcon = createPendulumIcon(PendulumLabConstants.SECOND_PENDULUM_COLOR, '2', false);

    // creates switch icon for choosing the first or second pendulum
    const graphUnitsSwitch = new ABSwitch(periodTimer.activePendulumIndexProperty, 0, firstPendulumIcon, 1, secondPendulumIcon, {
      spacing: 3,
      setEnabled: null,
      // Do not highlight the selected mass more than the other
      toggleSwitchOptions: {
        size: new Dimension2(25, 12.5),
        thumbTouchAreaXDilation: 3.5,
        thumbTouchAreaYDilation: 3.5
      }
    });

    // Switch,Play button, and pendulum icon buttons at the bottom of the period timer tool.
    const periodTimerPendulaSelector = new HBox({
      spacing: 10,
      children: [graphUnitsSwitch, playPauseButton]
    });

    // Creates time text inside period timer tool.
    const readoutText = new Text('', {
      font: PendulumLabConstants.PERIOD_TIMER_READOUT_FONT,
      maxWidth: periodTimerPendulaSelector.width * 0.80
    });
    // present for the lifetime of the sim
    periodTimer.elapsedTimeProperty.link(value => {
      readoutText.string = StringUtils.fillIn(secondsPatternString, {
        seconds: Utils.toFixed(value, 4)
      });
    });

    // Creates white background behind the time readout text in period timer tool.
    const textBackground = Rectangle.roundedBounds(readoutText.bounds.dilatedXY(20, 2), 5, 5, {
      fill: '#fff',
      stroke: 'rgba(0,0,0,0.5)'
    });

    // Creates the title, time readout, and period timer pendulum selector as one box in period timer tool.
    const vBox = new VBox({
      spacing: 5,
      align: 'center',
      children: [new Text(periodString, {
        font: PendulumLabConstants.PERIOD_TIMER_TITLE_FONT,
        pickable: false,
        maxWidth: periodTimerPendulaSelector.width
      }), new Node({
        children: [textBackground, readoutText],
        pickable: false,
        maxWidth: periodTimerPendulaSelector.width
      }), periodTimerPendulaSelector]
    });

    // background image
    const background = new Image(periodTimerBackground_png, {
      scale: 0.6,
      center: vBox.center
    });
    this.addChild(background);

    // adds period timer contents on top of yellow background.
    this.addChild(new AlignBox(vBox, {
      alignBounds: background.bounds
    }));

    // switch to second pendulum when it visible only
    // present for the lifetime of the sim
    secondPendulumIsVisibleProperty.link(isVisible => {
      periodTimerPendulaSelector.children = isVisible ? [graphUnitsSwitch, playPauseButton] : [playPauseButton];
      if (!isVisible) {
        periodTimer.activePendulumIndexProperty.value = 0;
      }
    });
    this.dragListener = new DragListener({
      positionProperty: periodTimer.positionProperty,
      useParentOffset: true,
      dragBoundsProperty: new Property(layoutBounds.erodedXY(this.width / 2, this.height / 2)),
      allowTouchSnag: false
    });
    // add drag and drop events
    this.addInputListener(this.dragListener);

    // prevent dragging the PeriodTimer from the playPause Button and graphUnitSwitch
    const doNotStartDragListener = {
      down: event => {
        event.handle();
      }
    };
    playPauseButton.addInputListener(doNotStartDragListener);
    graphUnitsSwitch.addInputListener(doNotStartDragListener);

    // add update of node position
    periodTimer.positionProperty.lazyLink(position => {
      // Because position is initialized to be null
      if (position) {
        this.center = position;
      }
    });

    // set visibility observer, present for the lifetime of the sim
    periodTimer.isVisibleProperty.linkAttribute(this, 'visible');
  }
}
pendulumLab.register('PeriodTimerNode', PeriodTimerNode);
export default PeriodTimerNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb3VuZHMyIiwiRGltZW5zaW9uMiIsIlV0aWxzIiwiVmVjdG9yMiIsIlNoYXBlIiwibWVyZ2UiLCJTdHJpbmdVdGlscyIsIlBoZXRGb250IiwiVVR1cm5BcnJvd1NoYXBlIiwiQWxpZ25Cb3giLCJDb2xvciIsIkRyYWdMaXN0ZW5lciIsIkhCb3giLCJJbWFnZSIsIkxpbmVhckdyYWRpZW50IiwiTm9kZSIsIlBhdGgiLCJSZWN0YW5nbGUiLCJUZXh0IiwiVkJveCIsIlByb3BlcnR5IiwiQUJTd2l0Y2giLCJCb29sZWFuUmVjdGFuZ3VsYXJUb2dnbGVCdXR0b24iLCJwZXJpb2RUaW1lckJhY2tncm91bmRfcG5nIiwiUGVuZHVsdW1MYWJDb25zdGFudHMiLCJwZW5kdWx1bUxhYiIsIlBlbmR1bHVtTGFiU3RyaW5ncyIsInBlcmlvZFN0cmluZyIsInBlcmlvZCIsInNlY29uZHNQYXR0ZXJuU3RyaW5nIiwic2Vjb25kc1BhdHRlcm4iLCJQZXJpb2RUaW1lck5vZGUiLCJjb25zdHJ1Y3RvciIsInBlcmlvZFRpbWVyIiwic2Vjb25kUGVuZHVsdW1Jc1Zpc2libGVQcm9wZXJ0eSIsImxheW91dEJvdW5kcyIsIm9wdGlvbnMiLCJpY29uQ29sb3IiLCJidXR0b25CYXNlQ29sb3IiLCJjdXJzb3IiLCJ1QXJyb3dTaGFwZSIsInBsYXlQYXVzZVNpemUiLCJib3VuZHMiLCJoZWlnaHQiLCJoYWxmUGxheVN0cm9rZSIsInBsYXlPZmZzZXQiLCJwbGF5U2hhcGUiLCJtb3ZlVG8iLCJsaW5lVG8iLCJjbG9zZSIsImdldE9mZnNldFNoYXBlIiwicGxheVBhdXNlQnV0dG9uIiwiaXNSdW5uaW5nUHJvcGVydHkiLCJmaWxsIiwiY2VudGVyIiwiWkVSTyIsInBpY2thYmxlIiwic3Ryb2tlIiwibGluZVdpZHRoIiwiYmFzZUNvbG9yIiwibWluV2lkdGgiLCJ0b3VjaEFyZWEiLCJsb2NhbEJvdW5kcyIsImRpbGF0ZWQiLCJjcmVhdGVQZW5kdWx1bUljb24iLCJjb2xvciIsImxhYmVsIiwicGFkTGVmdCIsImhpZ2hsaWdodENvbG9yIiwidG9Db2xvciIsImNvbG9yVXRpbHNCcmlnaHRlciIsInJlY3RCb3VuZHMiLCJpY29uIiwiY2hpbGRyZW4iLCJ3aWR0aCIsImFkZENvbG9yU3RvcCIsImZvbnQiLCJtYXhYIiwibWluWCIsImZpcnN0UGVuZHVsdW1JY29uIiwiRklSU1RfUEVORFVMVU1fQ09MT1IiLCJzZWNvbmRQZW5kdWx1bUljb24iLCJTRUNPTkRfUEVORFVMVU1fQ09MT1IiLCJncmFwaFVuaXRzU3dpdGNoIiwiYWN0aXZlUGVuZHVsdW1JbmRleFByb3BlcnR5Iiwic3BhY2luZyIsInNldEVuYWJsZWQiLCJ0b2dnbGVTd2l0Y2hPcHRpb25zIiwic2l6ZSIsInRodW1iVG91Y2hBcmVhWERpbGF0aW9uIiwidGh1bWJUb3VjaEFyZWFZRGlsYXRpb24iLCJwZXJpb2RUaW1lclBlbmR1bGFTZWxlY3RvciIsInJlYWRvdXRUZXh0IiwiUEVSSU9EX1RJTUVSX1JFQURPVVRfRk9OVCIsIm1heFdpZHRoIiwiZWxhcHNlZFRpbWVQcm9wZXJ0eSIsImxpbmsiLCJ2YWx1ZSIsInN0cmluZyIsImZpbGxJbiIsInNlY29uZHMiLCJ0b0ZpeGVkIiwidGV4dEJhY2tncm91bmQiLCJyb3VuZGVkQm91bmRzIiwiZGlsYXRlZFhZIiwidkJveCIsImFsaWduIiwiUEVSSU9EX1RJTUVSX1RJVExFX0ZPTlQiLCJiYWNrZ3JvdW5kIiwic2NhbGUiLCJhZGRDaGlsZCIsImFsaWduQm91bmRzIiwiaXNWaXNpYmxlIiwiZHJhZ0xpc3RlbmVyIiwicG9zaXRpb25Qcm9wZXJ0eSIsInVzZVBhcmVudE9mZnNldCIsImRyYWdCb3VuZHNQcm9wZXJ0eSIsImVyb2RlZFhZIiwiYWxsb3dUb3VjaFNuYWciLCJhZGRJbnB1dExpc3RlbmVyIiwiZG9Ob3RTdGFydERyYWdMaXN0ZW5lciIsImRvd24iLCJldmVudCIsImhhbmRsZSIsImxhenlMaW5rIiwicG9zaXRpb24iLCJpc1Zpc2libGVQcm9wZXJ0eSIsImxpbmtBdHRyaWJ1dGUiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlBlcmlvZFRpbWVyTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNC0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBQZXJpb2QgdHJhY2UgdGltZXIgbm9kZSBpbiAnUGVuZHVsdW0gTGFiJyBzaW11bGF0aW9uLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEFuZHJleSBaZWxlbmtvdiAoTWxlYXJuZXIpXHJcbiAqL1xyXG5cclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgRGltZW5zaW9uMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvRGltZW5zaW9uMi5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IG1lcmdlIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9tZXJnZS5qcyc7XHJcbmltcG9ydCBTdHJpbmdVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3V0aWwvU3RyaW5nVXRpbHMuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IFVUdXJuQXJyb3dTaGFwZSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvVVR1cm5BcnJvd1NoYXBlLmpzJztcclxuaW1wb3J0IHsgQWxpZ25Cb3gsIENvbG9yLCBEcmFnTGlzdGVuZXIsIEhCb3gsIEltYWdlLCBMaW5lYXJHcmFkaWVudCwgTm9kZSwgUGF0aCwgUmVjdGFuZ2xlLCBUZXh0LCBWQm94IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgQUJTd2l0Y2ggZnJvbSAnLi4vLi4vLi4vLi4vc3VuL2pzL0FCU3dpdGNoLmpzJztcclxuaW1wb3J0IEJvb2xlYW5SZWN0YW5ndWxhclRvZ2dsZUJ1dHRvbiBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvYnV0dG9ucy9Cb29sZWFuUmVjdGFuZ3VsYXJUb2dnbGVCdXR0b24uanMnO1xyXG5pbXBvcnQgcGVyaW9kVGltZXJCYWNrZ3JvdW5kX3BuZyBmcm9tICcuLi8uLi8uLi9taXBtYXBzL3BlcmlvZFRpbWVyQmFja2dyb3VuZF9wbmcuanMnO1xyXG5pbXBvcnQgUGVuZHVsdW1MYWJDb25zdGFudHMgZnJvbSAnLi4vLi4vY29tbW9uL1BlbmR1bHVtTGFiQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IHBlbmR1bHVtTGFiIGZyb20gJy4uLy4uL3BlbmR1bHVtTGFiLmpzJztcclxuaW1wb3J0IFBlbmR1bHVtTGFiU3RyaW5ncyBmcm9tICcuLi8uLi9QZW5kdWx1bUxhYlN0cmluZ3MuanMnO1xyXG5cclxuY29uc3QgcGVyaW9kU3RyaW5nID0gUGVuZHVsdW1MYWJTdHJpbmdzLnBlcmlvZDtcclxuY29uc3Qgc2Vjb25kc1BhdHRlcm5TdHJpbmcgPSBQZW5kdWx1bUxhYlN0cmluZ3Muc2Vjb25kc1BhdHRlcm47XHJcblxyXG5jbGFzcyBQZXJpb2RUaW1lck5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuICAvKipcclxuICAgKiBAcGFyYW0ge1BlcmlvZFRpbWVyfSBwZXJpb2RUaW1lciAtIFBlcmlvZCB0aW1lclxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPGJvb2xlYW4+fSBzZWNvbmRQZW5kdWx1bUlzVmlzaWJsZVByb3BlcnR5IC0gU2Vjb25kIHBlbmR1bHVtIHZpc2liaWxpdHkgcHJvcGVydHkuXHJcbiAgICogQHBhcmFtIHtCb3VuZHMyfSBsYXlvdXRCb3VuZHMgLSBCb3VuZHMgb2Ygc2NyZWVuIHZpZXcuXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBwZXJpb2RUaW1lciwgc2Vjb25kUGVuZHVsdW1Jc1Zpc2libGVQcm9wZXJ0eSwgbGF5b3V0Qm91bmRzLCBvcHRpb25zICkge1xyXG5cclxuICAgIG9wdGlvbnMgPSBtZXJnZSgge1xyXG4gICAgICBpY29uQ29sb3I6ICcjMzMzJyxcclxuICAgICAgYnV0dG9uQmFzZUNvbG9yOiAnI0RGRTBFMScsXHJcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBjcmVhdGVzIFV0dXJuIGFycm93IG9uIHRoZSBwZXJpb2QgdGltZXIgdG9vbFxyXG4gICAgY29uc3QgdUFycm93U2hhcGUgPSBuZXcgVVR1cm5BcnJvd1NoYXBlKCAxMCApO1xyXG5cclxuICAgIC8vIGNyZWF0ZXMgdHJpYW5nbGUgc2hhcGUgb24gcGxheSBidXR0b24gYnkgY3JlYXRpbmcgdGhyZWUgbGluZXMgYXQgeCx5IGNvb3JkaW5hdGVzLlxyXG4gICAgY29uc3QgcGxheVBhdXNlU2l6ZSA9IHVBcnJvd1NoYXBlLmJvdW5kcy5oZWlnaHQ7XHJcbiAgICBjb25zdCBoYWxmUGxheVN0cm9rZSA9IDAuMDUgKiBwbGF5UGF1c2VTaXplO1xyXG4gICAgY29uc3QgcGxheU9mZnNldCA9IDAuMTUgKiBwbGF5UGF1c2VTaXplO1xyXG4gICAgY29uc3QgcGxheVNoYXBlID0gbmV3IFNoYXBlKCkubW92ZVRvKCBwbGF5UGF1c2VTaXplIC0gaGFsZlBsYXlTdHJva2UgKiAwLjUgLSBwbGF5T2Zmc2V0LCAwIClcclxuICAgICAgLmxpbmVUbyggaGFsZlBsYXlTdHJva2UgKiAxLjUgKyBwbGF5T2Zmc2V0LCBwbGF5UGF1c2VTaXplIC8gMiAtIGhhbGZQbGF5U3Ryb2tlIC0gcGxheU9mZnNldCApXHJcbiAgICAgIC5saW5lVG8oIGhhbGZQbGF5U3Ryb2tlICogMS41ICsgcGxheU9mZnNldCwgLXBsYXlQYXVzZVNpemUgLyAyICsgaGFsZlBsYXlTdHJva2UgKyBwbGF5T2Zmc2V0IClcclxuICAgICAgLmNsb3NlKClcclxuICAgICAgLmdldE9mZnNldFNoYXBlKCAtcGxheU9mZnNldCApO1xyXG5cclxuICAgIC8vIGNyZWF0ZXMgcGxheVBhdXNlQnV0dG9uXHJcbiAgICBjb25zdCBwbGF5UGF1c2VCdXR0b24gPSBuZXcgQm9vbGVhblJlY3Rhbmd1bGFyVG9nZ2xlQnV0dG9uKCBwZXJpb2RUaW1lci5pc1J1bm5pbmdQcm9wZXJ0eSwgbmV3IFBhdGgoIHVBcnJvd1NoYXBlLCB7XHJcbiAgICAgIGZpbGw6IG9wdGlvbnMuaWNvbkNvbG9yLFxyXG4gICAgICBjZW50ZXI6IFZlY3RvcjIuWkVSTyxcclxuICAgICAgcGlja2FibGU6IGZhbHNlXHJcbiAgICB9ICksIG5ldyBQYXRoKCBwbGF5U2hhcGUsIHtcclxuICAgICAgcGlja2FibGU6IGZhbHNlLFxyXG4gICAgICBzdHJva2U6IG9wdGlvbnMuaWNvbkNvbG9yLFxyXG4gICAgICBmaWxsOiAnI2VlZicsXHJcbiAgICAgIGxpbmVXaWR0aDogaGFsZlBsYXlTdHJva2UgKiAyLFxyXG4gICAgICBjZW50ZXI6IFZlY3RvcjIuWkVST1xyXG4gICAgfSApLCB7XHJcbiAgICAgIGJhc2VDb2xvcjogb3B0aW9ucy5idXR0b25CYXNlQ29sb3IsXHJcbiAgICAgIG1pbldpZHRoOiA0MFxyXG4gICAgfSApO1xyXG4gICAgcGxheVBhdXNlQnV0dG9uLnRvdWNoQXJlYSA9IHBsYXlQYXVzZUJ1dHRvbi5sb2NhbEJvdW5kcy5kaWxhdGVkKCA1ICk7XHJcblxyXG4gICAgZnVuY3Rpb24gY3JlYXRlUGVuZHVsdW1JY29uKCBjb2xvciwgbGFiZWwsIHBhZExlZnQgKSB7XHJcbiAgICAgIGNvbnN0IGhpZ2hsaWdodENvbG9yID0gQ29sb3IudG9Db2xvciggY29sb3IgKS5jb2xvclV0aWxzQnJpZ2h0ZXIoIDAuNCApO1xyXG4gICAgICBjb25zdCByZWN0Qm91bmRzID0gbmV3IEJvdW5kczIoIDAsIDAsIDE3LCAyMCApO1xyXG4gICAgICBjb25zdCBpY29uID0gbmV3IE5vZGUoIHtcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgUmVjdGFuZ2xlLmJvdW5kcyggcmVjdEJvdW5kcywge1xyXG4gICAgICAgICAgICBzdHJva2U6ICdibGFjaycsXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogMC41LFxyXG4gICAgICAgICAgICBmaWxsOiBuZXcgTGluZWFyR3JhZGllbnQoIDAsIDAsIHJlY3RCb3VuZHMud2lkdGgsIDAgKS5hZGRDb2xvclN0b3AoIDAsIGNvbG9yIClcclxuICAgICAgICAgICAgICAuYWRkQ29sb3JTdG9wKCAwLjIsIGhpZ2hsaWdodENvbG9yIClcclxuICAgICAgICAgICAgICAuYWRkQ29sb3JTdG9wKCAwLjQsIGNvbG9yIClcclxuICAgICAgICAgICAgICAuYWRkQ29sb3JTdG9wKCAxLCBjb2xvciApXHJcbiAgICAgICAgICB9ICksXHJcbiAgICAgICAgICBuZXcgVGV4dCggbGFiZWwsIHtcclxuICAgICAgICAgICAgZmlsbDogJ3doaXRlJyxcclxuICAgICAgICAgICAgZm9udDogbmV3IFBoZXRGb250KCAxNCApLFxyXG4gICAgICAgICAgICBjZW50ZXI6IHJlY3RCb3VuZHMuY2VudGVyXHJcbiAgICAgICAgICB9IClcclxuICAgICAgICBdXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAgIC8vIERvbid0IHBhZCBuZXh0IHRvIHRoZSBBQiBzd2l0Y2gsIGJ1dCBvbmx5IGF3YXkgZnJvbSBpdFxyXG4gICAgICBjb25zdCB0b3VjaEFyZWEgPSBpY29uLmxvY2FsQm91bmRzLmRpbGF0ZWQoIDUgKTtcclxuICAgICAgaWYgKCBwYWRMZWZ0ICkge1xyXG4gICAgICAgIHRvdWNoQXJlYS5tYXhYID0gaWNvbi5sb2NhbEJvdW5kcy5tYXhYO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHRvdWNoQXJlYS5taW5YID0gaWNvbi5sb2NhbEJvdW5kcy5taW5YO1xyXG4gICAgICB9XHJcbiAgICAgIGljb24udG91Y2hBcmVhID0gdG91Y2hBcmVhO1xyXG4gICAgICByZXR1cm4gaWNvbjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmaXJzdFBlbmR1bHVtSWNvbiA9IGNyZWF0ZVBlbmR1bHVtSWNvbiggUGVuZHVsdW1MYWJDb25zdGFudHMuRklSU1RfUEVORFVMVU1fQ09MT1IsICcxJywgdHJ1ZSApO1xyXG4gICAgY29uc3Qgc2Vjb25kUGVuZHVsdW1JY29uID0gY3JlYXRlUGVuZHVsdW1JY29uKCBQZW5kdWx1bUxhYkNvbnN0YW50cy5TRUNPTkRfUEVORFVMVU1fQ09MT1IsICcyJywgZmFsc2UgKTtcclxuXHJcbiAgICAvLyBjcmVhdGVzIHN3aXRjaCBpY29uIGZvciBjaG9vc2luZyB0aGUgZmlyc3Qgb3Igc2Vjb25kIHBlbmR1bHVtXHJcbiAgICBjb25zdCBncmFwaFVuaXRzU3dpdGNoID0gbmV3IEFCU3dpdGNoKCBwZXJpb2RUaW1lci5hY3RpdmVQZW5kdWx1bUluZGV4UHJvcGVydHksIDAsIGZpcnN0UGVuZHVsdW1JY29uLCAxLCBzZWNvbmRQZW5kdWx1bUljb24sIHtcclxuICAgICAgc3BhY2luZzogMyxcclxuICAgICAgc2V0RW5hYmxlZDogbnVsbCwgLy8gRG8gbm90IGhpZ2hsaWdodCB0aGUgc2VsZWN0ZWQgbWFzcyBtb3JlIHRoYW4gdGhlIG90aGVyXHJcbiAgICAgIHRvZ2dsZVN3aXRjaE9wdGlvbnM6IHtcclxuICAgICAgICBzaXplOiBuZXcgRGltZW5zaW9uMiggMjUsIDEyLjUgKSxcclxuICAgICAgICB0aHVtYlRvdWNoQXJlYVhEaWxhdGlvbjogMy41LFxyXG4gICAgICAgIHRodW1iVG91Y2hBcmVhWURpbGF0aW9uOiAzLjVcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFN3aXRjaCxQbGF5IGJ1dHRvbiwgYW5kIHBlbmR1bHVtIGljb24gYnV0dG9ucyBhdCB0aGUgYm90dG9tIG9mIHRoZSBwZXJpb2QgdGltZXIgdG9vbC5cclxuICAgIGNvbnN0IHBlcmlvZFRpbWVyUGVuZHVsYVNlbGVjdG9yID0gbmV3IEhCb3goIHtcclxuICAgICAgc3BhY2luZzogMTAsXHJcbiAgICAgIGNoaWxkcmVuOiBbIGdyYXBoVW5pdHNTd2l0Y2gsIHBsYXlQYXVzZUJ1dHRvbiBdXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQ3JlYXRlcyB0aW1lIHRleHQgaW5zaWRlIHBlcmlvZCB0aW1lciB0b29sLlxyXG4gICAgY29uc3QgcmVhZG91dFRleHQgPSBuZXcgVGV4dCggJycsIHtcclxuICAgICAgZm9udDogUGVuZHVsdW1MYWJDb25zdGFudHMuUEVSSU9EX1RJTUVSX1JFQURPVVRfRk9OVCxcclxuICAgICAgbWF4V2lkdGg6IHBlcmlvZFRpbWVyUGVuZHVsYVNlbGVjdG9yLndpZHRoICogMC44MFxyXG4gICAgfSApO1xyXG4gICAgLy8gcHJlc2VudCBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBzaW1cclxuICAgIHBlcmlvZFRpbWVyLmVsYXBzZWRUaW1lUHJvcGVydHkubGluayggdmFsdWUgPT4ge1xyXG4gICAgICByZWFkb3V0VGV4dC5zdHJpbmcgPSBTdHJpbmdVdGlscy5maWxsSW4oIHNlY29uZHNQYXR0ZXJuU3RyaW5nLCB7XHJcbiAgICAgICAgc2Vjb25kczogVXRpbHMudG9GaXhlZCggdmFsdWUsIDQgKVxyXG4gICAgICB9ICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQ3JlYXRlcyB3aGl0ZSBiYWNrZ3JvdW5kIGJlaGluZCB0aGUgdGltZSByZWFkb3V0IHRleHQgaW4gcGVyaW9kIHRpbWVyIHRvb2wuXHJcbiAgICBjb25zdCB0ZXh0QmFja2dyb3VuZCA9IFJlY3RhbmdsZS5yb3VuZGVkQm91bmRzKCByZWFkb3V0VGV4dC5ib3VuZHMuZGlsYXRlZFhZKCAyMCwgMiApLCA1LCA1LCB7XHJcbiAgICAgIGZpbGw6ICcjZmZmJyxcclxuICAgICAgc3Ryb2tlOiAncmdiYSgwLDAsMCwwLjUpJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIENyZWF0ZXMgdGhlIHRpdGxlLCB0aW1lIHJlYWRvdXQsIGFuZCBwZXJpb2QgdGltZXIgcGVuZHVsdW0gc2VsZWN0b3IgYXMgb25lIGJveCBpbiBwZXJpb2QgdGltZXIgdG9vbC5cclxuICAgIGNvbnN0IHZCb3ggPSBuZXcgVkJveCgge1xyXG4gICAgICBzcGFjaW5nOiA1LFxyXG4gICAgICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgbmV3IFRleHQoIHBlcmlvZFN0cmluZywge1xyXG4gICAgICAgICAgZm9udDogUGVuZHVsdW1MYWJDb25zdGFudHMuUEVSSU9EX1RJTUVSX1RJVExFX0ZPTlQsXHJcbiAgICAgICAgICBwaWNrYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICBtYXhXaWR0aDogcGVyaW9kVGltZXJQZW5kdWxhU2VsZWN0b3Iud2lkdGhcclxuICAgICAgICB9ICksXHJcbiAgICAgICAgbmV3IE5vZGUoIHtcclxuICAgICAgICAgIGNoaWxkcmVuOiBbIHRleHRCYWNrZ3JvdW5kLCByZWFkb3V0VGV4dCBdLFxyXG4gICAgICAgICAgcGlja2FibGU6IGZhbHNlLFxyXG4gICAgICAgICAgbWF4V2lkdGg6IHBlcmlvZFRpbWVyUGVuZHVsYVNlbGVjdG9yLndpZHRoXHJcbiAgICAgICAgfSApLFxyXG4gICAgICAgIHBlcmlvZFRpbWVyUGVuZHVsYVNlbGVjdG9yXHJcbiAgICAgIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBiYWNrZ3JvdW5kIGltYWdlXHJcbiAgICBjb25zdCBiYWNrZ3JvdW5kID0gbmV3IEltYWdlKCBwZXJpb2RUaW1lckJhY2tncm91bmRfcG5nLCB7XHJcbiAgICAgIHNjYWxlOiAwLjYsXHJcbiAgICAgIGNlbnRlcjogdkJveC5jZW50ZXJcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGJhY2tncm91bmQgKTtcclxuXHJcbiAgICAvLyBhZGRzIHBlcmlvZCB0aW1lciBjb250ZW50cyBvbiB0b3Agb2YgeWVsbG93IGJhY2tncm91bmQuXHJcbiAgICB0aGlzLmFkZENoaWxkKCBuZXcgQWxpZ25Cb3goIHZCb3gsIHtcclxuICAgICAgYWxpZ25Cb3VuZHM6IGJhY2tncm91bmQuYm91bmRzXHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBzd2l0Y2ggdG8gc2Vjb25kIHBlbmR1bHVtIHdoZW4gaXQgdmlzaWJsZSBvbmx5XHJcbiAgICAvLyBwcmVzZW50IGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIHNpbVxyXG4gICAgc2Vjb25kUGVuZHVsdW1Jc1Zpc2libGVQcm9wZXJ0eS5saW5rKCBpc1Zpc2libGUgPT4ge1xyXG4gICAgICBwZXJpb2RUaW1lclBlbmR1bGFTZWxlY3Rvci5jaGlsZHJlbiA9IGlzVmlzaWJsZSA/IFsgZ3JhcGhVbml0c1N3aXRjaCwgcGxheVBhdXNlQnV0dG9uIF0gOiBbIHBsYXlQYXVzZUJ1dHRvbiBdO1xyXG4gICAgICBpZiAoICFpc1Zpc2libGUgKSB7XHJcbiAgICAgICAgcGVyaW9kVGltZXIuYWN0aXZlUGVuZHVsdW1JbmRleFByb3BlcnR5LnZhbHVlID0gMDtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuZHJhZ0xpc3RlbmVyID0gbmV3IERyYWdMaXN0ZW5lcigge1xyXG4gICAgICBwb3NpdGlvblByb3BlcnR5OiBwZXJpb2RUaW1lci5wb3NpdGlvblByb3BlcnR5LFxyXG4gICAgICB1c2VQYXJlbnRPZmZzZXQ6IHRydWUsXHJcbiAgICAgIGRyYWdCb3VuZHNQcm9wZXJ0eTogbmV3IFByb3BlcnR5KCBsYXlvdXRCb3VuZHMuZXJvZGVkWFkoIHRoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCAvIDIgKSApLFxyXG4gICAgICBhbGxvd1RvdWNoU25hZzogZmFsc2VcclxuICAgIH0gKTtcclxuICAgIC8vIGFkZCBkcmFnIGFuZCBkcm9wIGV2ZW50c1xyXG4gICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCB0aGlzLmRyYWdMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIHByZXZlbnQgZHJhZ2dpbmcgdGhlIFBlcmlvZFRpbWVyIGZyb20gdGhlIHBsYXlQYXVzZSBCdXR0b24gYW5kIGdyYXBoVW5pdFN3aXRjaFxyXG4gICAgY29uc3QgZG9Ob3RTdGFydERyYWdMaXN0ZW5lciA9IHtcclxuICAgICAgZG93bjogZXZlbnQgPT4ge1xyXG4gICAgICAgIGV2ZW50LmhhbmRsZSgpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgcGxheVBhdXNlQnV0dG9uLmFkZElucHV0TGlzdGVuZXIoIGRvTm90U3RhcnREcmFnTGlzdGVuZXIgKTtcclxuICAgIGdyYXBoVW5pdHNTd2l0Y2guYWRkSW5wdXRMaXN0ZW5lciggZG9Ob3RTdGFydERyYWdMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIGFkZCB1cGRhdGUgb2Ygbm9kZSBwb3NpdGlvblxyXG4gICAgcGVyaW9kVGltZXIucG9zaXRpb25Qcm9wZXJ0eS5sYXp5TGluayggcG9zaXRpb24gPT4ge1xyXG4gICAgICAvLyBCZWNhdXNlIHBvc2l0aW9uIGlzIGluaXRpYWxpemVkIHRvIGJlIG51bGxcclxuICAgICAgaWYgKCBwb3NpdGlvbiApIHtcclxuICAgICAgICB0aGlzLmNlbnRlciA9IHBvc2l0aW9uO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gc2V0IHZpc2liaWxpdHkgb2JzZXJ2ZXIsIHByZXNlbnQgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltXHJcbiAgICBwZXJpb2RUaW1lci5pc1Zpc2libGVQcm9wZXJ0eS5saW5rQXR0cmlidXRlKCB0aGlzLCAndmlzaWJsZScgKTtcclxuICB9XHJcbn1cclxuXHJcbnBlbmR1bHVtTGFiLnJlZ2lzdGVyKCAnUGVyaW9kVGltZXJOb2RlJywgUGVy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