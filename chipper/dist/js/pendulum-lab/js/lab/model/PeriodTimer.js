// Copyright 2014-2022, University of Colorado Boulder

/**
 * Period timer model in 'Pendulum Lab' simulation.
 * Calculates the period for the active pendulum, in addition to the normal trace.
 *
 * @author Andrey Zelenkov (MLearner)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Multilink from '../../../../axon/js/Multilink.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Stopwatch from '../../common/model/Stopwatch.js';
import pendulumLab from '../../pendulumLab.js';
class PeriodTimer extends Stopwatch {
  /**
   * @param {Array.<Pendulum>} pendula - Array of pendulum models.
   * @param {Property.<boolean>} isVisibleProperty
   */
  constructor(pendula, isVisibleProperty) {
    // TODO: https://github.com/phetsims/pendulum-lab/issues/216 use SCENERY_PHET/Stopwatch instead of its own Stopwatch which has similar features?
    super(isVisibleProperty.value);

    // Forward our invisibleProperty over to the MovableComponent visibility.
    isVisibleProperty.linkAttribute(this.isVisibleProperty, 'value');

    // @public {Property.<number>}
    this.activePendulumIndexProperty = new NumberProperty(0); // Start with the first pendulum

    // @public {Property.<pendulum>} - The active pendulum that we'll record the period/trace on.
    this.activePendulumProperty = new DerivedProperty([this.activePendulumIndexProperty], index => pendula[index]);

    // @private {Array.<Pendulum>}
    this.pendula = pendula;
    Multilink.multilink([this.isRunningProperty, this.isVisibleProperty], (isRunning, isVisible) => {
      if (isRunning && isVisible) {
        // clear time when timer revert to init state
        this.elapsedTimeProperty.value = 0;

        // reset and show trace path
        this.clear();
        this.activePendulumProperty.value.periodTrace.isVisibleProperty.value = true;
      } else if (isVisible) {
        // clear path if it wasn't finished
        if (this.activePendulumProperty.value.periodTrace.numberOfPointsProperty.value < 4) {
          this.clear();
        }

        // hide path if it wasn't started
        if (this.activePendulumProperty.value.periodTrace.numberOfPointsProperty.value === 0) {
          this.activePendulumProperty.value.periodTrace.isVisibleProperty.value = false;
        }
      } else if (isRunning) {
        this.isRunningProperty.value = false;
      } else {
        this.clear();
        this.activePendulumProperty.value.periodTrace.isVisibleProperty.value = false;
      }
    });

    // create listeners
    const pathListeners = [];
    pendula.forEach((pendulum, pendulumIndex) => {
      pendulum.periodTrace.isVisibleProperty.value = false;
      const clearIfActive = () => {
        if (this.activePendulumProperty.value === pendulum) {
          this.clear();
        }
      };
      pendulum.lengthProperty.lazyLink(clearIfActive);
      pendulum.gravityProperty.lazyLink(clearIfActive);
      pendulum.isUserControlledProperty.lazyLink(clearIfActive);
      pendulum.periodTrace.elapsedTimeProperty.lazyLink(time => {
        if (pendulum === this.activePendulumProperty.value && this.isRunningProperty.value) {
          this.elapsedTimeProperty.value = time;
        }
      });
      pathListeners[pendulumIndex] = () => {
        if (pendulum.periodTrace.numberOfPointsProperty.value === 4 && this.isRunningProperty.value) {
          this.isRunningProperty.value = false;
        }
      };
    });

    // add path listeners
    this.activePendulumProperty.value.periodTrace.numberOfPointsProperty.link(pathListeners[this.activePendulumIndexProperty.value]);
    this.activePendulumIndexProperty.lazyLink((index, oldIndex) => {
      this.clear();
      this.pendula[oldIndex].periodTrace.isVisibleProperty.value = false;
      this.pendula[oldIndex].periodTrace.numberOfPointsProperty.unlink(pathListeners[oldIndex]);
      this.pendula[index].periodTrace.numberOfPointsProperty.link(pathListeners[index]);
      this.pendula[index].periodTrace.isVisibleProperty.value = this.isRunningProperty.value;
    });
  }

  /**
   * Resets the PeriodTimer
   * @public
   */
  reset() {
    super.reset();
    this.activePendulumIndexProperty.reset();
  }

  /**
   * Clears the timer and period traces
   * @private
   */
  clear() {
    // resetting the timer
    this.elapsedTimeProperty.value = 0;

    // clearing the period traces
    if (!this.isRunningProperty.value) {
      this.activePendulumProperty.value.periodTrace.isVisibleProperty.value = false;
    }
    this.pendula.forEach(pendulum => {
      pendulum.periodTrace.resetPathPoints();
    });
  }

  /**
   * Stops the period timer and clear the trace
   * @public
   */
  stop() {
    if (this.isRunningProperty.value === true) {
      this.clear();
    }
  }
}
pendulumLab.register('PeriodTimer', PeriodTimer);
export default PeriodTimer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJNdWx0aWxpbmsiLCJOdW1iZXJQcm9wZXJ0eSIsIlN0b3B3YXRjaCIsInBlbmR1bHVtTGFiIiwiUGVyaW9kVGltZXIiLCJjb25zdHJ1Y3RvciIsInBlbmR1bGEiLCJpc1Zpc2libGVQcm9wZXJ0eSIsInZhbHVlIiwibGlua0F0dHJpYnV0ZSIsImFjdGl2ZVBlbmR1bHVtSW5kZXhQcm9wZXJ0eSIsImFjdGl2ZVBlbmR1bHVtUHJvcGVydHkiLCJpbmRleCIsIm11bHRpbGluayIsImlzUnVubmluZ1Byb3BlcnR5IiwiaXNSdW5uaW5nIiwiaXNWaXNpYmxlIiwiZWxhcHNlZFRpbWVQcm9wZXJ0eSIsImNsZWFyIiwicGVyaW9kVHJhY2UiLCJudW1iZXJPZlBvaW50c1Byb3BlcnR5IiwicGF0aExpc3RlbmVycyIsImZvckVhY2giLCJwZW5kdWx1bSIsInBlbmR1bHVtSW5kZXgiLCJjbGVhcklmQWN0aXZlIiwibGVuZ3RoUHJvcGVydHkiLCJsYXp5TGluayIsImdyYXZpdHlQcm9wZXJ0eSIsImlzVXNlckNvbnRyb2xsZWRQcm9wZXJ0eSIsInRpbWUiLCJsaW5rIiwib2xkSW5kZXgiLCJ1bmxpbmsiLCJyZXNldCIsInJlc2V0UGF0aFBvaW50cyIsInN0b3AiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlBlcmlvZFRpbWVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFBlcmlvZCB0aW1lciBtb2RlbCBpbiAnUGVuZHVsdW0gTGFiJyBzaW11bGF0aW9uLlxyXG4gKiBDYWxjdWxhdGVzIHRoZSBwZXJpb2QgZm9yIHRoZSBhY3RpdmUgcGVuZHVsdW0sIGluIGFkZGl0aW9uIHRvIHRoZSBub3JtYWwgdHJhY2UuXHJcbiAqXHJcbiAqIEBhdXRob3IgQW5kcmV5IFplbGVua292IChNTGVhcm5lcilcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IE11bHRpbGluayBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL011bHRpbGluay5qcyc7XHJcbmltcG9ydCBOdW1iZXJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL051bWJlclByb3BlcnR5LmpzJztcclxuaW1wb3J0IFN0b3B3YXRjaCBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvU3RvcHdhdGNoLmpzJztcclxuaW1wb3J0IHBlbmR1bHVtTGFiIGZyb20gJy4uLy4uL3BlbmR1bHVtTGFiLmpzJztcclxuXHJcbmNsYXNzIFBlcmlvZFRpbWVyIGV4dGVuZHMgU3RvcHdhdGNoIHtcclxuICAvKipcclxuICAgKiBAcGFyYW0ge0FycmF5LjxQZW5kdWx1bT59IHBlbmR1bGEgLSBBcnJheSBvZiBwZW5kdWx1bSBtb2RlbHMuXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48Ym9vbGVhbj59IGlzVmlzaWJsZVByb3BlcnR5XHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHBlbmR1bGEsIGlzVmlzaWJsZVByb3BlcnR5ICkge1xyXG4gICAgLy8gVE9ETzogaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3BlbmR1bHVtLWxhYi9pc3N1ZXMvMjE2IHVzZSBTQ0VORVJZX1BIRVQvU3RvcHdhdGNoIGluc3RlYWQgb2YgaXRzIG93biBTdG9wd2F0Y2ggd2hpY2ggaGFzIHNpbWlsYXIgZmVhdHVyZXM/XHJcbiAgICBzdXBlciggaXNWaXNpYmxlUHJvcGVydHkudmFsdWUgKTtcclxuXHJcbiAgICAvLyBGb3J3YXJkIG91ciBpbnZpc2libGVQcm9wZXJ0eSBvdmVyIHRvIHRoZSBNb3ZhYmxlQ29tcG9uZW50IHZpc2liaWxpdHkuXHJcbiAgICBpc1Zpc2libGVQcm9wZXJ0eS5saW5rQXR0cmlidXRlKCB0aGlzLmlzVmlzaWJsZVByb3BlcnR5LCAndmFsdWUnICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyB7UHJvcGVydHkuPG51bWJlcj59XHJcbiAgICB0aGlzLmFjdGl2ZVBlbmR1bHVtSW5kZXhQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggMCApOyAvLyBTdGFydCB3aXRoIHRoZSBmaXJzdCBwZW5kdWx1bVxyXG5cclxuICAgIC8vIEBwdWJsaWMge1Byb3BlcnR5LjxwZW5kdWx1bT59IC0gVGhlIGFjdGl2ZSBwZW5kdWx1bSB0aGF0IHdlJ2xsIHJlY29yZCB0aGUgcGVyaW9kL3RyYWNlIG9uLlxyXG4gICAgdGhpcy5hY3RpdmVQZW5kdWx1bVByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyB0aGlzLmFjdGl2ZVBlbmR1bHVtSW5kZXhQcm9wZXJ0eSBdLCBpbmRleCA9PiBwZW5kdWxhWyBpbmRleCBdICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge0FycmF5LjxQZW5kdWx1bT59XHJcbiAgICB0aGlzLnBlbmR1bGEgPSBwZW5kdWxhO1xyXG5cclxuICAgIE11bHRpbGluay5tdWx0aWxpbmsoIFsgdGhpcy5pc1J1bm5pbmdQcm9wZXJ0eSwgdGhpcy5pc1Zpc2libGVQcm9wZXJ0eSBdLCAoIGlzUnVubmluZywgaXNWaXNpYmxlICkgPT4ge1xyXG4gICAgICBpZiAoIGlzUnVubmluZyAmJiBpc1Zpc2libGUgKSB7XHJcbiAgICAgICAgLy8gY2xlYXIgdGltZSB3aGVuIHRpbWVyIHJldmVydCB0byBpbml0IHN0YXRlXHJcbiAgICAgICAgdGhpcy5lbGFwc2VkVGltZVByb3BlcnR5LnZhbHVlID0gMDtcclxuXHJcbiAgICAgICAgLy8gcmVzZXQgYW5kIHNob3cgdHJhY2UgcGF0aFxyXG4gICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICB0aGlzLmFjdGl2ZVBlbmR1bHVtUHJvcGVydHkudmFsdWUucGVyaW9kVHJhY2UuaXNWaXNpYmxlUHJvcGVydHkudmFsdWUgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCBpc1Zpc2libGUgKSB7XHJcbiAgICAgICAgLy8gY2xlYXIgcGF0aCBpZiBpdCB3YXNuJ3QgZmluaXNoZWRcclxuICAgICAgICBpZiAoIHRoaXMuYWN0aXZlUGVuZHVsdW1Qcm9wZXJ0eS52YWx1ZS5wZXJpb2RUcmFjZS5udW1iZXJPZlBvaW50c1Byb3BlcnR5LnZhbHVlIDwgNCApIHtcclxuICAgICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGhpZGUgcGF0aCBpZiBpdCB3YXNuJ3Qgc3RhcnRlZFxyXG4gICAgICAgIGlmICggdGhpcy5hY3RpdmVQZW5kdWx1bVByb3BlcnR5LnZhbHVlLnBlcmlvZFRyYWNlLm51bWJlck9mUG9pbnRzUHJvcGVydHkudmFsdWUgPT09IDAgKSB7XHJcbiAgICAgICAgICB0aGlzLmFjdGl2ZVBlbmR1bHVtUHJvcGVydHkudmFsdWUucGVyaW9kVHJhY2UuaXNWaXNpYmxlUHJvcGVydHkudmFsdWUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIGlzUnVubmluZyApIHtcclxuICAgICAgICB0aGlzLmlzUnVubmluZ1Byb3BlcnR5LnZhbHVlID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlUGVuZHVsdW1Qcm9wZXJ0eS52YWx1ZS5wZXJpb2RUcmFjZS5pc1Zpc2libGVQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gY3JlYXRlIGxpc3RlbmVyc1xyXG4gICAgY29uc3QgcGF0aExpc3RlbmVycyA9IFtdO1xyXG4gICAgcGVuZHVsYS5mb3JFYWNoKCAoIHBlbmR1bHVtLCBwZW5kdWx1bUluZGV4ICkgPT4ge1xyXG4gICAgICBwZW5kdWx1bS5wZXJpb2RUcmFjZS5pc1Zpc2libGVQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgY29uc3QgY2xlYXJJZkFjdGl2ZSA9ICgpID0+IHtcclxuICAgICAgICBpZiAoIHRoaXMuYWN0aXZlUGVuZHVsdW1Qcm9wZXJ0eS52YWx1ZSA9PT0gcGVuZHVsdW0gKSB7XHJcbiAgICAgICAgICB0aGlzLmNsZWFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgcGVuZHVsdW0ubGVuZ3RoUHJvcGVydHkubGF6eUxpbmsoIGNsZWFySWZBY3RpdmUgKTtcclxuICAgICAgcGVuZHVsdW0uZ3Jhdml0eVByb3BlcnR5LmxhenlMaW5rKCBjbGVhcklmQWN0aXZlICk7XHJcbiAgICAgIHBlbmR1bHVtLmlzVXNlckNvbnRyb2xsZWRQcm9wZXJ0eS5sYXp5TGluayggY2xlYXJJZkFjdGl2ZSApO1xyXG5cclxuICAgICAgcGVuZHVsdW0ucGVyaW9kVHJhY2UuZWxhcHNlZFRpbWVQcm9wZXJ0eS5sYXp5TGluayggdGltZSA9PiB7XHJcbiAgICAgICAgaWYgKCBwZW5kdWx1bSA9PT0gdGhpcy5hY3RpdmVQZW5kdWx1bVByb3BlcnR5LnZhbHVlICYmIHRoaXMuaXNSdW5uaW5nUHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgICAgICB0aGlzLmVsYXBzZWRUaW1lUHJvcGVydHkudmFsdWUgPSB0aW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG5cclxuICAgICAgcGF0aExpc3RlbmVyc1sgcGVuZHVsdW1JbmRleCBdID0gKCkgPT4ge1xyXG4gICAgICAgIGlmICggcGVuZHVsdW0ucGVyaW9kVHJhY2UubnVtYmVyT2ZQb2ludHNQcm9wZXJ0eS52YWx1ZSA9PT0gNCAmJiB0aGlzLmlzUnVubmluZ1Byb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICAgICAgdGhpcy5pc1J1bm5pbmdQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBhZGQgcGF0aCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuYWN0aXZlUGVuZHVsdW1Qcm9wZXJ0eS52YWx1ZS5wZXJpb2RUcmFjZS5udW1iZXJPZlBvaW50c1Byb3BlcnR5LmxpbmsoIHBhdGhMaXN0ZW5lcnNbIHRoaXMuYWN0aXZlUGVuZHVsdW1JbmRleFByb3BlcnR5LnZhbHVlIF0gKTtcclxuICAgIHRoaXMuYWN0aXZlUGVuZHVsdW1JbmRleFByb3BlcnR5LmxhenlMaW5rKCAoIGluZGV4LCBvbGRJbmRleCApID0+IHtcclxuICAgICAgdGhpcy5jbGVhcigpO1xyXG5cclxuICAgICAgdGhpcy5wZW5kdWxhWyBvbGRJbmRleCBdLnBlcmlvZFRyYWNlLmlzVmlzaWJsZVByb3BlcnR5LnZhbHVlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMucGVuZHVsYVsgb2xkSW5kZXggXS5wZXJpb2RUcmFjZS5udW1iZXJPZlBvaW50c1Byb3BlcnR5LnVubGluayggcGF0aExpc3RlbmVyc1sgb2xkSW5kZXggXSApO1xyXG5cclxuICAgICAgdGhpcy5wZW5kdWxhWyBpbmRleCBdLnBlcmlvZFRyYWNlLm51bWJlck9mUG9pbnRzUHJvcGVydHkubGluayggcGF0aExpc3RlbmVyc1sgaW5kZXggXSApO1xyXG4gICAgICB0aGlzLnBlbmR1bGFbIGluZGV4IF0ucGVyaW9kVHJhY2UuaXNWaXNpYmxlUHJvcGVydHkudmFsdWUgPSB0aGlzLmlzUnVubmluZ1Byb3BlcnR5LnZhbHVlO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzZXRzIHRoZSBQZXJpb2RUaW1lclxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICByZXNldCgpIHtcclxuICAgIHN1cGVyLnJlc2V0KCk7XHJcbiAgICB0aGlzLmFjdGl2ZVBlbmR1bHVtSW5kZXhQcm9wZXJ0eS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYXJzIHRoZSB0aW1lciBhbmQgcGVyaW9kIHRyYWNlc1xyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgY2xlYXIoKSB7XHJcbiAgICAvLyByZXNldHRpbmcgdGhlIHRpbWVyXHJcbiAgICB0aGlzLmVsYXBzZWRUaW1lUHJvcGVydHkudmFsdWUgPSAwO1xyXG5cclxuICAgIC8vIGNsZWFyaW5nIHRoZSBwZXJpb2QgdHJhY2VzXHJcbiAgICBpZiAoICF0aGlzLmlzUnVubmluZ1Byb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICB0aGlzLmFjdGl2ZVBlbmR1bHVtUHJvcGVydHkudmFsdWUucGVyaW9kVHJhY2UuaXNWaXNpYmxlUHJvcGVydHkudmFsdWUgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIHRoaXMucGVuZHVsYS5mb3JFYWNoKCBwZW5kdWx1bSA9PiB7XHJcbiAgICAgIHBlbmR1bHVtLnBlcmlvZFRyYWNlLnJlc2V0UGF0aFBvaW50cygpO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RvcHMgdGhlIHBlcmlvZCB0aW1lciBhbmQgY2xlYXIgdGhlIHRyYWNlXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIHN0b3AoKSB7XHJcbiAgICBpZiAoIHRoaXMuaXNSdW5uaW5nUHJvcGVydHkudmFsdWUgPT09IHRydWUgKSB7XHJcbiAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbnBlbmR1bHVtTGFiLnJlZ2lzdGVyKCAnUGVyaW9kVGltZXInLCBQZXJpb2RUaW1lciApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgUGVyaW9kVGltZXI7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxTQUFTLE1BQU0sa0NBQWtDO0FBQ3hELE9BQU9DLGNBQWMsTUFBTSx1Q0FBdUM7QUFDbEUsT0FBT0MsU0FBUyxNQUFNLGlDQUFpQztBQUN2RCxPQUFPQyxXQUFXLE1BQU0sc0JBQXNCO0FBRTlDLE1BQU1DLFdBQVcsU0FBU0YsU0FBUyxDQUFDO0VBQ2xDO0FBQ0Y7QUFDQTtB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