// Copyright 2022, University of Colorado Boulder

/**
 * Mix-in for modal Density/Buoyancy models, where callbacks will create/position masses for each set.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import EnumerationProperty from '../../../../axon/js/EnumerationProperty.js';
import DensityBuoyancyModel from '../../common/model/DensityBuoyancyModel.js';
import densityBuoyancyCommon from '../../densityBuoyancyCommon.js';
export default class BlockSetModel extends DensityBuoyancyModel {
  constructor(options) {
    super(options);
    this.BlockSet = options.BlockSet;
    const tandem = options.tandem;

    // {Property.<BlockSet>}
    this.blockSetProperty = new EnumerationProperty(options.initialMode, {
      tandem: tandem.createTandem('blockSets').createTandem('blockSetProperty')
    });
    this.createMassesCallback = options.createMassesCallback;
    this.regenerateMassesCallback = options.regenerateMassesCallback;
    this.positionMassesCallback = options.positionMassesCallback;
    this.blockSetToMassesMap = new Map();

    // Create and position masses on startup
    options.BlockSet.values.forEach(blockSet => {
      this.blockSetToMassesMap.set(blockSet, this.createMassesCallback(this, blockSet));

      // Make them invisible by default, they will be made visible when their blockSet is up
      this.blockSetToMassesMap.get(blockSet).forEach(mass => {
        mass.internalVisibleProperty.value = false;
        this.availableMasses.push(mass);
      });
      this.positionMasses(blockSet);
    });

    // This instance lives for the lifetime of the simulation, so we don't need to remove this listener
    this.blockSetProperty.link((blockSet, oldBlockSet) => {
      if (oldBlockSet) {
        this.blockSetToMassesMap.get(oldBlockSet).forEach(mass => {
          mass.internalVisibleProperty.value = false;
        });
      }
      this.blockSetToMassesMap.get(blockSet).forEach(mass => {
        mass.internalVisibleProperty.value = true;
      });
    });
  }

  /**
   * Positions masses.
   */
  positionMasses(blockSet) {
    this.positionMassesCallback(this, blockSet, this.blockSetToMassesMap.get(blockSet));
  }

  /**
   * Regenerates the masses for a specific blockSet.
   */
  regenerate(blockSet) {
    this.regenerateMassesCallback(this, blockSet, this.blockSetToMassesMap.get(blockSet));
    this.positionMasses(blockSet);
  }

  /**
   * Resets values to their original state
   */
  reset() {
    this.blockSetProperty.reset();

    // Reset every available mass.
    this.BlockSet.values.forEach(blockSet => this.blockSetToMassesMap.get(blockSet).forEach(mass => mass.reset()));
    super.reset();

    // Reposition AFTER the reset
    this.BlockSet.values.forEach(blockSet => this.positionMasses(blockSet));

    // Reset the previous positions on masses
    this.BlockSet.values.forEach(blockSet => this.blockSetToMassesMap.get(blockSet).forEach(mass => {
      this.engine.bodySynchronizePrevious(mass.body);
    }));

    // Rehandle visibility, since we reset them
    this.BlockSet.values.forEach(blockSet => this.blockSetToMassesMap.get(blockSet).forEach(mass => {
      mass.internalVisibleProperty.value = blockSet === this.blockSetProperty.value;
    }));
  }
}
densityBuoyancyCommon.register('BlockSetModel', BlockSetModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFbnVtZXJhdGlvblByb3BlcnR5IiwiRGVuc2l0eUJ1b3lhbmN5TW9kZWwiLCJkZW5zaXR5QnVveWFuY3lDb21tb24iLCJCbG9ja1NldE1vZGVsIiwiY29uc3RydWN0b3IiLCJvcHRpb25zIiwiQmxvY2tTZXQiLCJ0YW5kZW0iLCJibG9ja1NldFByb3BlcnR5IiwiaW5pdGlhbE1vZGUiLCJjcmVhdGVUYW5kZW0iLCJjcmVhdGVNYXNzZXNDYWxsYmFjayIsInJlZ2VuZXJhdGVNYXNzZXNDYWxsYmFjayIsInBvc2l0aW9uTWFzc2VzQ2FsbGJhY2siLCJibG9ja1NldFRvTWFzc2VzTWFwIiwiTWFwIiwidmFsdWVzIiwiZm9yRWFjaCIsImJsb2NrU2V0Iiwic2V0IiwiZ2V0IiwibWFzcyIsImludGVybmFsVmlzaWJsZVByb3BlcnR5IiwidmFsdWUiLCJhdmFpbGFibGVNYXNzZXMiLCJwdXNoIiwicG9zaXRpb25NYXNzZXMiLCJsaW5rIiwib2xkQmxvY2tTZXQiLCJyZWdlbmVyYXRlIiwicmVzZXQiLCJlbmdpbmUiLCJib2R5U3luY2hyb25pemVQcmV2aW91cyIsImJvZHkiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkJsb2NrU2V0TW9kZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIE1peC1pbiBmb3IgbW9kYWwgRGVuc2l0eS9CdW95YW5jeSBtb2RlbHMsIHdoZXJlIGNhbGxiYWNrcyB3aWxsIGNyZWF0ZS9wb3NpdGlvbiBtYXNzZXMgZm9yIGVhY2ggc2V0LlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuaW1wb3J0IEVudW1lcmF0aW9uUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9FbnVtZXJhdGlvblByb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRW51bWVyYXRpb24gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL0VudW1lcmF0aW9uLmpzJztcclxuaW1wb3J0IEVudW1lcmF0aW9uVmFsdWUgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL0VudW1lcmF0aW9uVmFsdWUuanMnO1xyXG5pbXBvcnQgRGVuc2l0eUJ1b3lhbmN5TW9kZWwsIHsgRGVuc2l0eUJ1b3lhbmN5TW9kZWxPcHRpb25zIH0gZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0RlbnNpdHlCdW95YW5jeU1vZGVsLmpzJztcclxuaW1wb3J0IGRlbnNpdHlCdW95YW5jeUNvbW1vbiBmcm9tICcuLi8uLi9kZW5zaXR5QnVveWFuY3lDb21tb24uanMnO1xyXG5pbXBvcnQgQ3Vib2lkIGZyb20gJy4vQ3Vib2lkLmpzJztcclxuXHJcbnR5cGUgQ3JlYXRlTWFzc2VzQ2FsbGJhY2s8QmxvY2tTZXRWYWx1ZSBleHRlbmRzIEVudW1lcmF0aW9uVmFsdWU+ID0gKCBtb2RlbDogRGVuc2l0eUJ1b3lhbmN5TW9kZWwsIGJsb2NrU2V0OiBCbG9ja1NldFZhbHVlICkgPT4gQ3Vib2lkW107XHJcbnR5cGUgUmVnZW5lcmF0ZU1hc3Nlc0NhbGxiYWNrPEJsb2NrU2V0VmFsdWUgZXh0ZW5kcyBFbnVtZXJhdGlvblZhbHVlPiA9ICggbW9kZWw6IERlbnNpdHlCdW95YW5jeU1vZGVsLCBibG9ja1NldDogQmxvY2tTZXRWYWx1ZSwgbWFzc2VzOiBDdWJvaWRbXSApID0+IHZvaWQ7XHJcbnR5cGUgUG9zaXRpb25NYXNzZXNDYWxsYmFjazxCbG9ja1NldFZhbHVlIGV4dGVuZHMgRW51bWVyYXRpb25WYWx1ZT4gPSAoIG1vZGVsOiBEZW5zaXR5QnVveWFuY3lNb2RlbCwgYmxvY2tTZXQ6IEJsb2NrU2V0VmFsdWUsIG1hc3NlczogQ3Vib2lkW10gKSA9PiB2b2lkO1xyXG5cclxudHlwZSBTZWxmT3B0aW9uczxCbG9ja1NldFZhbHVlIGV4dGVuZHMgRW51bWVyYXRpb25WYWx1ZT4gPSB7XHJcbiAgLy8gQ3JlYXRlcyBtYXNzZXMgKHdoZW4gZ2l2ZW4gYSBibG9ja1NldClcclxuICBjcmVhdGVNYXNzZXNDYWxsYmFjazogQ3JlYXRlTWFzc2VzQ2FsbGJhY2s8QmxvY2tTZXRWYWx1ZT47XHJcblxyXG4gIC8vIFJlZ2VuZXJhdGUgbWFzc2VzICh3aGVuIGdpdmVuIGEgYmxvY2tTZXQpXHJcbiAgcmVnZW5lcmF0ZU1hc3Nlc0NhbGxiYWNrOiBSZWdlbmVyYXRlTWFzc2VzQ2FsbGJhY2s8QmxvY2tTZXRWYWx1ZT47XHJcblxyXG4gIC8vIFBvc2l0aW9ucyBtYXNzZXMgKGZvciBhIGdpdmVuIGJsb2NrU2V0KVxyXG4gIHBvc2l0aW9uTWFzc2VzQ2FsbGJhY2s6IFBvc2l0aW9uTWFzc2VzQ2FsbGJhY2s8QmxvY2tTZXRWYWx1ZT47XHJcblxyXG4gIGluaXRpYWxNb2RlOiBCbG9ja1NldFZhbHVlO1xyXG4gIEJsb2NrU2V0OiBFbnVtZXJhdGlvbjxCbG9ja1NldFZhbHVlPjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIEJsb2NrU2V0TW9kZWxPcHRpb25zPEJsb2NrU2V0VmFsdWUgZXh0ZW5kcyBFbnVtZXJhdGlvblZhbHVlPiA9IFNlbGZPcHRpb25zPEJsb2NrU2V0VmFsdWU+ICYgRGVuc2l0eUJ1b3lhbmN5TW9kZWxPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmxvY2tTZXRNb2RlbDxCbG9ja1NldFZhbHVlIGV4dGVuZHMgRW51bWVyYXRpb25WYWx1ZT4gZXh0ZW5kcyBEZW5zaXR5QnVveWFuY3lNb2RlbCB7XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBCbG9ja1NldDogRW51bWVyYXRpb248QmxvY2tTZXRWYWx1ZT47XHJcbiAgcHVibGljIHJlYWRvbmx5IGJsb2NrU2V0UHJvcGVydHk6IFByb3BlcnR5PEJsb2NrU2V0VmFsdWU+O1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgY3JlYXRlTWFzc2VzQ2FsbGJhY2s6IENyZWF0ZU1hc3Nlc0NhbGxiYWNrPEJsb2NrU2V0VmFsdWU+O1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcmVnZW5lcmF0ZU1hc3Nlc0NhbGxiYWNrOiBSZWdlbmVyYXRlTWFzc2VzQ2FsbGJhY2s8QmxvY2tTZXRWYWx1ZT47XHJcbiAgcHJpdmF0ZSByZWFkb25seSBwb3NpdGlvbk1hc3Nlc0NhbGxiYWNrOiBQb3NpdGlvbk1hc3Nlc0NhbGxiYWNrPEJsb2NrU2V0VmFsdWU+O1xyXG5cclxuICBwcml2YXRlIGJsb2NrU2V0VG9NYXNzZXNNYXA6IE1hcDxCbG9ja1NldFZhbHVlLCBDdWJvaWRbXT47XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggb3B0aW9uczogQmxvY2tTZXRNb2RlbE9wdGlvbnM8QmxvY2tTZXRWYWx1ZT4gKSB7XHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMuQmxvY2tTZXQgPSBvcHRpb25zLkJsb2NrU2V0O1xyXG5cclxuICAgIGNvbnN0IHRhbmRlbSA9IG9wdGlvbnMudGFuZGVtO1xyXG5cclxuICAgIC8vIHtQcm9wZXJ0eS48QmxvY2tTZXQ+fVxyXG4gICAgdGhpcy5ibG9ja1NldFByb3BlcnR5ID0gbmV3IEVudW1lcmF0aW9uUHJvcGVydHkoIG9wdGlvbnMuaW5pdGlhbE1vZGUsIHtcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnYmxvY2tTZXRzJyApLmNyZWF0ZVRhbmRlbSggJ2Jsb2NrU2V0UHJvcGVydHknIClcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmNyZWF0ZU1hc3Nlc0NhbGxiYWNrID0gb3B0aW9ucy5jcmVhdGVNYXNzZXNDYWxsYmFjaztcclxuICAgIHRoaXMucmVnZW5lcmF0ZU1hc3Nlc0NhbGxiYWNrID0gb3B0aW9ucy5yZWdlbmVyYXRlTWFzc2VzQ2FsbGJhY2s7XHJcbiAgICB0aGlzLnBvc2l0aW9uTWFzc2VzQ2FsbGJhY2sgPSBvcHRpb25zLnBvc2l0aW9uTWFzc2VzQ2FsbGJhY2s7XHJcblxyXG4gICAgdGhpcy5ibG9ja1NldFRvTWFzc2VzTWFwID0gbmV3IE1hcDxCbG9ja1NldFZhbHVlLCBDdWJvaWRbXT4oKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgYW5kIHBvc2l0aW9uIG1hc3NlcyBvbiBzdGFydHVwXHJcbiAgICBvcHRpb25zLkJsb2NrU2V0LnZhbHVlcy5mb3JFYWNoKCBibG9ja1NldCA9PiB7XHJcbiAgICAgIHRoaXMuYmxvY2tTZXRUb01hc3Nlc01hcC5zZXQoIGJsb2NrU2V0LCB0aGlzLmNyZWF0ZU1hc3Nlc0NhbGxiYWNrKCB0aGlzLCBibG9ja1NldCApICk7XHJcblxyXG4gICAgICAvLyBNYWtlIHRoZW0gaW52aXNpYmxlIGJ5IGRlZmF1bHQsIHRoZXkgd2lsbCBiZSBtYWRlIHZpc2libGUgd2hlbiB0aGVpciBibG9ja1NldCBpcyB1cFxyXG4gICAgICB0aGlzLmJsb2NrU2V0VG9NYXNzZXNNYXAuZ2V0KCBibG9ja1NldCApIS5mb3JFYWNoKCBtYXNzID0+IHtcclxuICAgICAgICBtYXNzLmludGVybmFsVmlzaWJsZVByb3BlcnR5LnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hdmFpbGFibGVNYXNzZXMucHVzaCggbWFzcyApO1xyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICB0aGlzLnBvc2l0aW9uTWFzc2VzKCBibG9ja1NldCApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFRoaXMgaW5zdGFuY2UgbGl2ZXMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltdWxhdGlvbiwgc28gd2UgZG9uJ3QgbmVlZCB0byByZW1vdmUgdGhpcyBsaXN0ZW5lclxyXG4gICAgdGhpcy5ibG9ja1NldFByb3BlcnR5LmxpbmsoICggYmxvY2tTZXQsIG9sZEJsb2NrU2V0ICkgPT4ge1xyXG4gICAgICBpZiAoIG9sZEJsb2NrU2V0ICkge1xyXG4gICAgICAgIHRoaXMuYmxvY2tTZXRUb01hc3Nlc01hcC5nZXQoIG9sZEJsb2NrU2V0ICkhLmZvckVhY2goIG1hc3MgPT4ge1xyXG4gICAgICAgICAgbWFzcy5pbnRlcm5hbFZpc2libGVQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmJsb2NrU2V0VG9NYXNzZXNNYXAuZ2V0KCBibG9ja1NldCApIS5mb3JFYWNoKCBtYXNzID0+IHtcclxuICAgICAgICBtYXNzLmludGVybmFsVmlzaWJsZVByb3BlcnR5LnZhbHVlID0gdHJ1ZTtcclxuICAgICAgfSApO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUG9zaXRpb25zIG1hc3Nlcy5cclxuICAgKi9cclxuICBwcml2YXRlIHBvc2l0aW9uTWFzc2VzKCBibG9ja1NldDogQmxvY2tTZXRWYWx1ZSApOiB2b2lkIHtcclxuICAgIHRoaXMucG9zaXRpb25NYXNzZXNDYWxsYmFjayggdGhpcywgYmxvY2tTZXQsIHRoaXMuYmxvY2tTZXRUb01hc3Nlc01hcC5nZXQoIGJsb2NrU2V0ICkhICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWdlbmVyYXRlcyB0aGUgbWFzc2VzIGZvciBhIHNwZWNpZmljIGJsb2NrU2V0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZWdlbmVyYXRlKCBibG9ja1NldDogQmxvY2tTZXRWYWx1ZSApOiB2b2lkIHtcclxuICAgIHRoaXMucmVnZW5lcmF0ZU1hc3Nlc0NhbGxiYWNrKCB0aGlzLCBibG9ja1NldCwgdGhpcy5ibG9ja1NldFRvTWFzc2VzTWFwLmdldCggYmxvY2tTZXQgKSEgKTtcclxuICAgIHRoaXMucG9zaXRpb25NYXNzZXMoIGJsb2NrU2V0ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNldHMgdmFsdWVzIHRvIHRoZWlyIG9yaWdpbmFsIHN0YXRlXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5ibG9ja1NldFByb3BlcnR5LnJlc2V0KCk7XHJcblxyXG4gICAgLy8gUmVzZXQgZXZlcnkgYXZhaWxhYmxlIG1hc3MuXHJcbiAgICB0aGlzLkJsb2NrU2V0LnZhbHVlcy5mb3JFYWNoKCBibG9ja1NldCA9PiB0aGlzLmJsb2NrU2V0VG9NYXNzZXNNYXAuZ2V0KCBibG9ja1NldCApIS5mb3JFYWNoKCBtYXNzID0+IG1hc3MucmVzZXQoKSApICk7XHJcblxyXG4gICAgc3VwZXIucmVzZXQoKTtcclxuXHJcbiAgICAvLyBSZXBvc2l0aW9uIEFGVEVSIHRoZSByZXNldFxyXG4gICAgdGhpcy5CbG9ja1NldC52YWx1ZXMuZm9yRWFjaCggYmxvY2tTZXQgPT4gdGhpcy5wb3NpdGlvbk1hc3NlcyggYmxvY2tTZXQgKSApO1xyXG5cclxuICAgIC8vIFJlc2V0IHRoZSBwcmV2aW91cyBwb3NpdGlvbnMgb24gbWFzc2VzXHJcbiAgICB0aGlzLkJsb2NrU2V0LnZhbHVlcy5mb3JFYWNoKCBibG9ja1NldCA9PiB0aGlzLmJsb2NrU2V0VG9NYXNzZXNNYXAuZ2V0KCBibG9ja1NldCApIS5mb3JFYWNoKCBtYXNzID0+IHtcclxuICAgICAgdGhpcy5lbmdpbmUuYm9keVN5bmNocm9uaXplUHJldmlvdXMoIG1hc3MuYm9keSApO1xyXG4gICAgfSApICk7XHJcblxyXG4gICAgLy8gUmVoYW5kbGUgdmlzaWJpbGl0eSwgc2luY2Ugd2UgcmVzZXQgdGhlbVxyXG4gICAgdGhpcy5CbG9ja1NldC52YWx1ZXMuZm9yRWFjaCggYmxvY2tTZXQgPT4gdGhpcy5ibG9ja1NldFRvTWFzc2VzTWFwLmdldCggYmxvY2tTZXQgKSEuZm9yRWFjaCggbWFzcyA9PiB7XHJcbiAgICAgIG1hc3MuaW50ZXJuYWxWaXNpYmxlUHJvcGVydHkudmFsdWUgPSBibG9ja1NldCA9PT0gdGhpcy5ibG9ja1NldFByb3BlcnR5LnZhbHVlO1xyXG4gICAgfSApICk7XHJcbiAgfVxyXG59XHJcblxyXG5kZW5zaXR5QnVveWFuY3lDb21tb24ucmVnaXN0ZXIoICdCbG9ja1NldE1vZGVsJywgQmxvY2tTZXRN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