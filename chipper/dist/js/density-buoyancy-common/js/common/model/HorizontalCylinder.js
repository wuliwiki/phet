// Copyright 2019-2022, University of Colorado Boulder

/**
 * A cylinder laying on its side (the caps are on the left/right)
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Range from '../../../../dot/js/Range.js';
import Utils from '../../../../dot/js/Utils.js';
import Vector3 from '../../../../dot/js/Vector3.js';
import { Shape } from '../../../../kite/js/imports.js';
import optionize from '../../../../phet-core/js/optionize.js';
import IOType from '../../../../tandem/js/types/IOType.js';
import densityBuoyancyCommon from '../../densityBuoyancyCommon.js';
import Mass, { MASS_MAX_SHAPES_DIMENSION, MASS_MIN_SHAPES_DIMENSION } from './Mass.js';
import { MassShape } from './MassShape.js';
export default class HorizontalCylinder extends Mass {
  // Step information

  constructor(engine, radius, length, providedConfig) {
    const config = optionize()({
      body: engine.createBox(length, radius * 2),
      shape: HorizontalCylinder.getHorizontalCylinderShape(radius, length),
      volume: HorizontalCylinder.getVolume(radius, length),
      massShape: MassShape.HORIZONTAL_CYLINDER,
      phetioType: HorizontalCylinder.HorizontalCylinderIO
    }, providedConfig);
    assert && assert(!config.canRotate);
    super(engine, config);

    // {Property.<number>}
    this.radiusProperty = new NumberProperty(radius, {
      tandem: config.tandem.createTandem('radiusProperty'),
      range: new Range(0, Number.POSITIVE_INFINITY)
    });
    this.lengthProperty = new NumberProperty(length, {
      tandem: config.tandem.createTandem('lengthProperty'),
      range: new Range(0, Number.POSITIVE_INFINITY)
    });
    this.stepRadius = 0;
    this.stepHeight = 0;
    this.stepArea = 0;
    this.stepMaximumVolume = 0;
    this.stepMaximumArea = 0;
    this.updateSize(radius, length);
  }

  /**
   * Updates the size of the cone.
   */
  updateSize(radius, length) {
    this.engine.updateBox(this.body, length, radius * 2);
    this.radiusProperty.value = radius;
    this.lengthProperty.value = length;
    this.shapeProperty.value = HorizontalCylinder.getHorizontalCylinderShape(radius, length);
    this.volumeLock = true;
    this.volumeProperty.value = HorizontalCylinder.getVolume(radius, length);
    this.volumeLock = false;
    this.forceOffsetProperty.value = new Vector3(0, 0, radius);
    this.massOffsetProperty.value = new Vector3(0, -radius * 0.5, radius * 0.7);
  }

  /**
   * Returns the radius from a general size scale
   */
  static getRadiusFromRatio(heightRatio) {
    return (MASS_MIN_SHAPES_DIMENSION + heightRatio * (MASS_MAX_SHAPES_DIMENSION - MASS_MIN_SHAPES_DIMENSION)) / 2;
  }

  /**
   * Returns the length from a general size scale
   */
  static getLengthFromRatio(widthRatio) {
    return MASS_MIN_SHAPES_DIMENSION + widthRatio * (MASS_MAX_SHAPES_DIMENSION - MASS_MIN_SHAPES_DIMENSION);
  }

  /**
   * Sets the general size of the mass based on a general size scale.
   */
  setRatios(widthRatio, heightRatio) {
    this.updateSize(HorizontalCylinder.getRadiusFromRatio(heightRatio), HorizontalCylinder.getLengthFromRatio(widthRatio));
  }

  /**
   * Called after a engine-physics-model step once before doing other operations (like computing buoyant forces,
   * displacement, etc.) so that it can set high-performance flags used for this purpose.
   *
   * Type-specific values are likely to be set, but this should set at least stepX/stepBottom/stepTop
   */
  updateStepInformation() {
    super.updateStepInformation();
    const xOffset = this.stepMatrix.m02();
    const yOffset = this.stepMatrix.m12();
    this.stepX = xOffset;
    this.stepBottom = yOffset - this.radiusProperty.value;
    this.stepTop = yOffset + this.radiusProperty.value;
    this.stepRadius = this.radiusProperty.value;
    this.stepHeight = this.lengthProperty.value;
    this.stepMaximumArea = 2 * this.stepRadius * this.lengthProperty.value;
    this.stepMaximumVolume = Math.PI * this.stepRadius * this.stepRadius * this.lengthProperty.value;
  }

  /**
   * If there is an intersection with the ray and this mass, the t-value (distance the ray would need to travel to
   * reach the intersection, e.g. ray.position + ray.distance * t === intersectionPoint) will be returned. Otherwise
   * if there is no intersection, null will be returned.
   */
  intersect(ray, isTouch) {
    const translation = this.matrix.getTranslation().toVector3();
    const radius = this.radiusProperty.value;
    const length = this.lengthProperty.value;
    const relativePosition = ray.position.minusXYZ(translation.x, translation.y, translation.z);
    const yp = 4 / (radius * radius);
    const zp = 4 / (radius * radius);
    const a = yp * ray.direction.y * ray.direction.y + zp * ray.direction.z * ray.direction.z;
    const b = 2 * (yp * relativePosition.y * ray.direction.y + zp * relativePosition.z * ray.direction.z);
    const c = -1 + yp * relativePosition.y * relativePosition.y + zp * relativePosition.z * relativePosition.z;
    const tValues = Utils.solveQuadraticRootsReal(a, b, c).filter(t => {
      if (t <= 0) {
        return false;
      }
      const x = ray.pointAtDistance(t).x;
      return Math.abs(x - translation.x) <= length / 2;
    });
    if (tValues.length) {
      return tValues[0];
    } else {
      return null;
    }
  }

  /**
   * Returns the cumulative displaced volume of this object up to a given y level.
   *
   * Assumes step information was updated.
   */
  getDisplacedArea(liquidLevel) {
    if (liquidLevel < this.stepBottom || liquidLevel > this.stepTop) {
      return 0;
    } else {
      const ratio = (liquidLevel - this.stepBottom) / (this.stepTop - this.stepBottom);
      return this.stepMaximumArea * 2 * Math.sqrt(ratio - ratio * ratio);
    }
  }

  /**
   * Returns the displaced volume of this object up to a given y level, assuming a y value for the given liquid level.
   *
   * Assumes step information was updated.
   */
  getDisplacedVolume(liquidLevel) {
    if (liquidLevel <= this.stepBottom) {
      return 0;
    } else if (liquidLevel >= this.stepTop) {
      return this.stepMaximumVolume;
    } else {
      const ratio = (liquidLevel - this.stepBottom) / (this.stepTop - this.stepBottom);
      const f = 2 * ratio - 1;

      // Computed with Mathematica
      return this.stepMaximumVolume * (2 * Math.sqrt(ratio - ratio * ratio) * f + Math.acos(-f)) / Math.PI;
    }
  }

  /**
   * Resets things to their original values.
   */
  reset() {
    this.radiusProperty.reset();
    this.lengthProperty.reset();
    this.updateSize(this.radiusProperty.value, this.lengthProperty.value);
    super.reset();
  }

  /**
   * Releases references
   */
  dispose() {
    this.radiusProperty.dispose();
    this.lengthProperty.dispose();
    super.dispose();
  }

  /**
   * Returns a horizontal cylinder shape for a given radius/length.
   */
  static getHorizontalCylinderShape(radius, length) {
    return Shape.rect(-length / 2, -radius, length, 2 * radius);
  }

  /**
   * Returns the volume of a horizontal cylinder with the given radius and length.
   */
  static getVolume(radius, length) {
    return Math.PI * radius * radius * length;
  }
  static HorizontalCylinderIO = new IOType('HorizontalCylinderIO', {
    valueType: HorizontalCylinder,
    supertype: Mass.MassIO,
    documentation: 'Represents a cylinder laying on its side'
  });
}
densityBuoyancyCommon.register('HorizontalCylinder', HorizontalCylinder);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOdW1iZXJQcm9wZXJ0eSIsIlJhbmdlIiwiVXRpbHMiLCJWZWN0b3IzIiwiU2hhcGUiLCJvcHRpb25pemUiLCJJT1R5cGUiLCJkZW5zaXR5QnVveWFuY3lDb21tb24iLCJNYXNzIiwiTUFTU19NQVhfU0hBUEVTX0RJTUVOU0lPTiIsIk1BU1NfTUlOX1NIQVBFU19ESU1FTlNJT04iLCJNYXNzU2hhcGUiLCJIb3Jpem9udGFsQ3lsaW5kZXIiLCJjb25zdHJ1Y3RvciIsImVuZ2luZSIsInJhZGl1cyIsImxlbmd0aCIsInByb3ZpZGVkQ29uZmlnIiwiY29uZmlnIiwiYm9keSIsImNyZWF0ZUJveCIsInNoYXBlIiwiZ2V0SG9yaXpvbnRhbEN5bGluZGVyU2hhcGUiLCJ2b2x1bWUiLCJnZXRWb2x1bWUiLCJtYXNzU2hhcGUiLCJIT1JJWk9OVEFMX0NZTElOREVSIiwicGhldGlvVHlwZSIsIkhvcml6b250YWxDeWxpbmRlcklPIiwiYXNzZXJ0IiwiY2FuUm90YXRlIiwicmFkaXVzUHJvcGVydHkiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJyYW5nZSIsIk51bWJlciIsIlBPU0lUSVZFX0lORklOSVRZIiwibGVuZ3RoUHJvcGVydHkiLCJzdGVwUmFkaXVzIiwic3RlcEhlaWdodCIsInN0ZXBBcmVhIiwic3RlcE1heGltdW1Wb2x1bWUiLCJzdGVwTWF4aW11bUFyZWEiLCJ1cGRhdGVTaXplIiwidXBkYXRlQm94IiwidmFsdWUiLCJzaGFwZVByb3BlcnR5Iiwidm9sdW1lTG9jayIsInZvbHVtZVByb3BlcnR5IiwiZm9yY2VPZmZzZXRQcm9wZXJ0eSIsIm1hc3NPZmZzZXRQcm9wZXJ0eSIsImdldFJhZGl1c0Zyb21SYXRpbyIsImhlaWdodFJhdGlvIiwiZ2V0TGVuZ3RoRnJvbVJhdGlvIiwid2lkdGhSYXRpbyIsInNldFJhdGlvcyIsInVwZGF0ZVN0ZXBJbmZvcm1hdGlvbiIsInhPZmZzZXQiLCJzdGVwTWF0cml4IiwibTAyIiwieU9mZnNldCIsIm0xMiIsInN0ZXBYIiwic3RlcEJvdHRvbSIsInN0ZXBUb3AiLCJNYXRoIiwiUEkiLCJpbnRlcnNlY3QiLCJyYXkiLCJpc1RvdWNoIiwidHJhbnNsYXRpb24iLCJtYXRyaXgiLCJnZXRUcmFuc2xhdGlvbiIsInRvVmVjdG9yMyIsInJlbGF0aXZlUG9zaXRpb24iLCJwb3NpdGlvbiIsIm1pbnVzWFlaIiwieCIsInkiLCJ6IiwieXAiLCJ6cCIsImEiLCJkaXJlY3Rpb24iLCJiIiwiYyIsInRWYWx1ZXMiLCJzb2x2ZVF1YWRyYXRpY1Jvb3RzUmVhbCIsImZpbHRlciIsInQiLCJwb2ludEF0RGlzdGFuY2UiLCJhYnMiLCJnZXREaXNwbGFjZWRBcmVhIiwibGlxdWlkTGV2ZWwiLCJyYXRpbyIsInNxcnQiLCJnZXREaXNwbGFjZWRWb2x1bWUiLCJmIiwiYWNvcyIsInJlc2V0IiwiZGlzcG9zZSIsInJlY3QiLCJ2YWx1ZVR5cGUiLCJzdXBlcnR5cGUiLCJNYXNzSU8iLCJkb2N1bWVudGF0aW9uIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJIb3Jpem9udGFsQ3lsaW5kZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTktMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQSBjeWxpbmRlciBsYXlpbmcgb24gaXRzIHNpZGUgKHRoZSBjYXBzIGFyZSBvbiB0aGUgbGVmdC9yaWdodClcclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBOdW1iZXJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL051bWJlclByb3BlcnR5LmpzJztcclxuaW1wb3J0IFN0cmljdE9taXQgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1N0cmljdE9taXQuanMnO1xyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBSYW5nZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2UuanMnO1xyXG5pbXBvcnQgUmF5MyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmF5My5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgVmVjdG9yMyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMy5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBFbXB0eVNlbGZPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBJT1R5cGUgZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL0lPVHlwZS5qcyc7XHJcbmltcG9ydCBkZW5zaXR5QnVveWFuY3lDb21tb24gZnJvbSAnLi4vLi4vZGVuc2l0eUJ1b3lhbmN5Q29tbW9uLmpzJztcclxuaW1wb3J0IE1hc3MsIHsgSW5zdHJ1bWVudGVkTWFzc09wdGlvbnMsIE1BU1NfTUFYX1NIQVBFU19ESU1FTlNJT04sIE1BU1NfTUlOX1NIQVBFU19ESU1FTlNJT04gfSBmcm9tICcuL01hc3MuanMnO1xyXG5pbXBvcnQgUGh5c2ljc0VuZ2luZSBmcm9tICcuL1BoeXNpY3NFbmdpbmUuanMnO1xyXG5pbXBvcnQgeyBNYXNzU2hhcGUgfSBmcm9tICcuL01hc3NTaGFwZS5qcyc7XHJcblxyXG5leHBvcnQgdHlwZSBIb3Jpem9udGFsQ3lsaW5kZXJPcHRpb25zID0gU3RyaWN0T21pdDxJbnN0cnVtZW50ZWRNYXNzT3B0aW9ucywgJ2JvZHknIHwgJ3NoYXBlJyB8ICd2b2x1bWUnIHwgJ21hc3NTaGFwZSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSG9yaXpvbnRhbEN5bGluZGVyIGV4dGVuZHMgTWFzcyB7XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSByYWRpdXNQcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyPjtcclxuICBwdWJsaWMgcmVhZG9ubHkgbGVuZ3RoUHJvcGVydHk6IFByb3BlcnR5PG51bWJlcj47XHJcblxyXG4gIC8vIFN0ZXAgaW5mb3JtYXRpb25cclxuICBwdWJsaWMgc3RlcFJhZGl1czogbnVtYmVyO1xyXG4gIHB1YmxpYyBzdGVwSGVpZ2h0OiBudW1iZXI7XHJcbiAgcHVibGljIHN0ZXBBcmVhOiBudW1iZXI7XHJcbiAgcHVibGljIHN0ZXBNYXhpbXVtVm9sdW1lOiBudW1iZXI7XHJcbiAgcHVibGljIHN0ZXBNYXhpbXVtQXJlYTogbnVtYmVyO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGVuZ2luZTogUGh5c2ljc0VuZ2luZSwgcmFkaXVzOiBudW1iZXIsIGxlbmd0aDogbnVtYmVyLCBwcm92aWRlZENvbmZpZzogSG9yaXpvbnRhbEN5bGluZGVyT3B0aW9ucyApIHtcclxuICAgIGNvbnN0IGNvbmZpZyA9IG9wdGlvbml6ZTxIb3Jpem9udGFsQ3lsaW5kZXJPcHRpb25zLCBFbXB0eVNlbGZPcHRpb25zLCBJbnN0cnVtZW50ZWRNYXNzT3B0aW9ucz4oKSgge1xyXG4gICAgICBib2R5OiBlbmdpbmUuY3JlYXRlQm94KCBsZW5ndGgsIHJhZGl1cyAqIDIgKSxcclxuICAgICAgc2hhcGU6IEhvcml6b250YWxDeWxpbmRlci5nZXRIb3Jpem9udGFsQ3lsaW5kZXJTaGFwZSggcmFkaXVzLCBsZW5ndGggKSxcclxuICAgICAgdm9sdW1lOiBIb3Jpem9udGFsQ3lsaW5kZXIuZ2V0Vm9sdW1lKCByYWRpdXMsIGxlbmd0aCApLFxyXG4gICAgICBtYXNzU2hhcGU6IE1hc3NTaGFwZS5IT1JJWk9OVEFMX0NZTElOREVSLFxyXG5cclxuICAgICAgcGhldGlvVHlwZTogSG9yaXpvbnRhbEN5bGluZGVyLkhvcml6b250YWxDeWxpbmRlcklPXHJcbiAgICB9LCBwcm92aWRlZENvbmZpZyApO1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoICFjb25maWcuY2FuUm90YXRlICk7XHJcblxyXG4gICAgc3VwZXIoIGVuZ2luZSwgY29uZmlnIGFzIEluc3RydW1lbnRlZE1hc3NPcHRpb25zICk7XHJcblxyXG4gICAgLy8ge1Byb3BlcnR5LjxudW1iZXI+fVxyXG4gICAgdGhpcy5yYWRpdXNQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggcmFkaXVzLCB7XHJcbiAgICAgIHRhbmRlbTogY29uZmlnLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdyYWRpdXNQcm9wZXJ0eScgKSxcclxuICAgICAgcmFuZ2U6IG5ldyBSYW5nZSggMCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIClcclxuICAgIH0gKTtcclxuICAgIHRoaXMubGVuZ3RoUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIGxlbmd0aCwge1xyXG4gICAgICB0YW5kZW06IGNvbmZpZy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnbGVuZ3RoUHJvcGVydHknICksXHJcbiAgICAgIHJhbmdlOiBuZXcgUmFuZ2UoIDAsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5zdGVwUmFkaXVzID0gMDtcclxuICAgIHRoaXMuc3RlcEhlaWdodCA9IDA7XHJcbiAgICB0aGlzLnN0ZXBBcmVhID0gMDtcclxuICAgIHRoaXMuc3RlcE1heGltdW1Wb2x1bWUgPSAwO1xyXG4gICAgdGhpcy5zdGVwTWF4aW11bUFyZWEgPSAwO1xyXG5cclxuICAgIHRoaXMudXBkYXRlU2l6ZSggcmFkaXVzLCBsZW5ndGggKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZXMgdGhlIHNpemUgb2YgdGhlIGNvbmUuXHJcbiAgICovXHJcbiAgcHVibGljIHVwZGF0ZVNpemUoIHJhZGl1czogbnVtYmVyLCBsZW5ndGg6IG51bWJlciApOiB2b2lkIHtcclxuICAgIHRoaXMuZW5naW5lLnVwZGF0ZUJveCggdGhpcy5ib2R5LCBsZW5ndGgsIHJhZGl1cyAqIDIgKTtcclxuXHJcbiAgICB0aGlzLnJhZGl1c1Byb3BlcnR5LnZhbHVlID0gcmFkaXVzO1xyXG4gICAgdGhpcy5sZW5ndGhQcm9wZXJ0eS52YWx1ZSA9IGxlbmd0aDtcclxuXHJcbiAgICB0aGlzLnNoYXBlUHJvcGVydHkudmFsdWUgPSBIb3Jpem9udGFsQ3lsaW5kZXIuZ2V0SG9yaXpvbnRhbEN5bGluZGVyU2hhcGUoIHJhZGl1cywgbGVuZ3RoICk7XHJcblxyXG4gICAgdGhpcy52b2x1bWVMb2NrID0gdHJ1ZTtcclxuICAgIHRoaXMudm9sdW1lUHJvcGVydHkudmFsdWUgPSBIb3Jpem9udGFsQ3lsaW5kZXIuZ2V0Vm9sdW1lKCByYWRpdXMsIGxlbmd0aCApO1xyXG4gICAgdGhpcy52b2x1bWVMb2NrID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5mb3JjZU9mZnNldFByb3BlcnR5LnZhbHVlID0gbmV3IFZlY3RvcjMoIDAsIDAsIHJhZGl1cyApO1xyXG4gICAgdGhpcy5tYXNzT2Zmc2V0UHJvcGVydHkudmFsdWUgPSBuZXcgVmVjdG9yMyggMCwgLXJhZGl1cyAqIDAuNSwgcmFkaXVzICogMC43ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSByYWRpdXMgZnJvbSBhIGdlbmVyYWwgc2l6ZSBzY2FsZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0UmFkaXVzRnJvbVJhdGlvKCBoZWlnaHRSYXRpbzogbnVtYmVyICk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gKCBNQVNTX01JTl9TSEFQRVNfRElNRU5TSU9OICsgaGVpZ2h0UmF0aW8gKiAoIE1BU1NfTUFYX1NIQVBFU19ESU1FTlNJT04gLSBNQVNTX01JTl9TSEFQRVNfRElNRU5TSU9OICkgKSAvIDI7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBsZW5ndGggZnJvbSBhIGdlbmVyYWwgc2l6ZSBzY2FsZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0TGVuZ3RoRnJvbVJhdGlvKCB3aWR0aFJhdGlvOiBudW1iZXIgKTogbnVtYmVyIHtcclxuICAgIHJldHVybiAoIE1BU1NfTUlOX1NIQVBFU19ESU1FTlNJT04gKyB3aWR0aFJhdGlvICogKCBNQVNTX01BWF9TSEFQRVNfRElNRU5TSU9OIC0gTUFTU19NSU5fU0hBUEVTX0RJTUVOU0lPTiApICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXRzIHRoZSBnZW5lcmFsIHNpemUgb2YgdGhlIG1hc3MgYmFzZWQgb24gYSBnZW5lcmFsIHNpemUgc2NhbGUuXHJcbiAgICovXHJcbiAgcHVibGljIHNldFJhdGlvcyggd2lkdGhSYXRpbzogbnVtYmVyLCBoZWlnaHRSYXRpbzogbnVtYmVyICk6IHZvaWQge1xyXG4gICAgdGhpcy51cGRhdGVTaXplKFxyXG4gICAgICBIb3Jpem9udGFsQ3lsaW5kZXIuZ2V0UmFkaXVzRnJvbVJhdGlvKCBoZWlnaHRSYXRpbyApLFxyXG4gICAgICBIb3Jpem9udGFsQ3lsaW5kZXIuZ2V0TGVuZ3RoRnJvbVJhdGlvKCB3aWR0aFJhdGlvIClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxsZWQgYWZ0ZXIgYSBlbmdpbmUtcGh5c2ljcy1tb2RlbCBzdGVwIG9uY2UgYmVmb3JlIGRvaW5nIG90aGVyIG9wZXJhdGlvbnMgKGxpa2UgY29tcHV0aW5nIGJ1b3lhbnQgZm9yY2VzLFxyXG4gICAqIGRpc3BsYWNlbWVudCwgZXRjLikgc28gdGhhdCBpdCBjYW4gc2V0IGhpZ2gtcGVyZm9ybWFuY2UgZmxhZ3MgdXNlZCBmb3IgdGhpcyBwdXJwb3NlLlxyXG4gICAqXHJcbiAgICogVHlwZS1zcGVjaWZpYyB2YWx1ZXMgYXJlIGxpa2VseSB0byBiZSBzZXQsIGJ1dCB0aGlzIHNob3VsZCBzZXQgYXQgbGVhc3Qgc3RlcFgvc3RlcEJvdHRvbS9zdGVwVG9wXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHVwZGF0ZVN0ZXBJbmZvcm1hdGlvbigpOiB2b2lkIHtcclxuICAgIHN1cGVyLnVwZGF0ZVN0ZXBJbmZvcm1hdGlvbigpO1xyXG5cclxuICAgIGNvbnN0IHhPZmZzZXQgPSB0aGlzLnN0ZXBNYXRyaXgubTAyKCk7XHJcbiAgICBjb25zdCB5T2Zmc2V0ID0gdGhpcy5zdGVwTWF0cml4Lm0xMigpO1xyXG5cclxuICAgIHRoaXMuc3RlcFggPSB4T2Zmc2V0O1xyXG4gICAgdGhpcy5zdGVwQm90dG9tID0geU9mZnNldCAtIHRoaXMucmFkaXVzUHJvcGVydHkudmFsdWU7XHJcbiAgICB0aGlzLnN0ZXBUb3AgPSB5T2Zmc2V0ICsgdGhpcy5yYWRpdXNQcm9wZXJ0eS52YWx1ZTtcclxuXHJcbiAgICB0aGlzLnN0ZXBSYWRpdXMgPSB0aGlzLnJhZGl1c1Byb3BlcnR5LnZhbHVlO1xyXG4gICAgdGhpcy5zdGVwSGVpZ2h0ID0gdGhpcy5sZW5ndGhQcm9wZXJ0eS52YWx1ZTtcclxuICAgIHRoaXMuc3RlcE1heGltdW1BcmVhID0gMiAqIHRoaXMuc3RlcFJhZGl1cyAqIHRoaXMubGVuZ3RoUHJvcGVydHkudmFsdWU7XHJcbiAgICB0aGlzLnN0ZXBNYXhpbXVtVm9sdW1lID0gTWF0aC5QSSAqIHRoaXMuc3RlcFJhZGl1cyAqIHRoaXMuc3RlcFJhZGl1cyAqIHRoaXMubGVuZ3RoUHJvcGVydHkudmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJZiB0aGVyZSBpcyBhbiBpbnRlcnNlY3Rpb24gd2l0aCB0aGUgcmF5IGFuZCB0aGlzIG1hc3MsIHRoZSB0LXZhbHVlIChkaXN0YW5jZSB0aGUgcmF5IHdvdWxkIG5lZWQgdG8gdHJhdmVsIHRvXHJcbiAgICogcmVhY2ggdGhlIGludGVyc2VjdGlvbiwgZS5nLiByYXkucG9zaXRpb24gKyByYXkuZGlzdGFuY2UgKiB0ID09PSBpbnRlcnNlY3Rpb25Qb2ludCkgd2lsbCBiZSByZXR1cm5lZC4gT3RoZXJ3aXNlXHJcbiAgICogaWYgdGhlcmUgaXMgbm8gaW50ZXJzZWN0aW9uLCBudWxsIHdpbGwgYmUgcmV0dXJuZWQuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGludGVyc2VjdCggcmF5OiBSYXkzLCBpc1RvdWNoOiBib29sZWFuICk6IG51bWJlciB8IG51bGwge1xyXG4gICAgY29uc3QgdHJhbnNsYXRpb24gPSB0aGlzLm1hdHJpeC5nZXRUcmFuc2xhdGlvbigpLnRvVmVjdG9yMygpO1xyXG4gICAgY29uc3QgcmFkaXVzID0gdGhpcy5yYWRpdXNQcm9wZXJ0eS52YWx1ZTtcclxuICAgIGNvbnN0IGxlbmd0aCA9IHRoaXMubGVuZ3RoUHJvcGVydHkudmFsdWU7XHJcbiAgICBjb25zdCByZWxhdGl2ZVBvc2l0aW9uID0gcmF5LnBvc2l0aW9uLm1pbnVzWFlaKCB0cmFuc2xhdGlvbi54LCB0cmFuc2xhdGlvbi55LCB0cmFuc2xhdGlvbi56ICk7XHJcblxyXG4gICAgY29uc3QgeXAgPSA0IC8gKCByYWRpdXMgKiByYWRpdXMgKTtcclxuICAgIGNvbnN0IHpwID0gNCAvICggcmFkaXVzICogcmFkaXVzICk7XHJcblxyXG4gICAgY29uc3QgYSA9IHlwICogcmF5LmRpcmVjdGlvbi55ICogcmF5LmRpcmVjdGlvbi55ICsgenAgKiByYXkuZGlyZWN0aW9uLnogKiByYXkuZGlyZWN0aW9uLno7XHJcbiAgICBjb25zdCBiID0gMiAqICggeXAgKiByZWxhdGl2ZVBvc2l0aW9uLnkgKiByYXkuZGlyZWN0aW9uLnkgKyB6cCAqIHJlbGF0aXZlUG9zaXRpb24ueiAqIHJheS5kaXJlY3Rpb24ueiApO1xyXG4gICAgY29uc3QgYyA9IC0xICsgeXAgKiByZWxhdGl2ZVBvc2l0aW9uLnkgKiByZWxhdGl2ZVBvc2l0aW9uLnkgKyB6cCAqIHJlbGF0aXZlUG9zaXRpb24ueiAqIHJlbGF0aXZlUG9zaXRpb24uejtcclxuXHJcbiAgICBjb25zdCB0VmFsdWVzID0gVXRpbHMuc29sdmVRdWFkcmF0aWNSb290c1JlYWwoIGEsIGIsIGMgKSEuZmlsdGVyKCB0ID0+IHtcclxuICAgICAgaWYgKCB0IDw9IDAgKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHggPSByYXkucG9pbnRBdERpc3RhbmNlKCB0ICkueDtcclxuXHJcbiAgICAgIHJldHVybiBNYXRoLmFicyggeCAtIHRyYW5zbGF0aW9uLnggKSA8PSBsZW5ndGggLyAyO1xyXG4gICAgfSApO1xyXG5cclxuICAgIGlmICggdFZhbHVlcy5sZW5ndGggKSB7XHJcbiAgICAgIHJldHVybiB0VmFsdWVzWyAwIF07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBjdW11bGF0aXZlIGRpc3BsYWNlZCB2b2x1bWUgb2YgdGhpcyBvYmplY3QgdXAgdG8gYSBnaXZlbiB5IGxldmVsLlxyXG4gICAqXHJcbiAgICogQXNzdW1lcyBzdGVwIGluZm9ybWF0aW9uIHdhcyB1cGRhdGVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXREaXNwbGFjZWRBcmVhKCBsaXF1aWRMZXZlbDogbnVtYmVyICk6IG51bWJlciB7XHJcbiAgICBpZiAoIGxpcXVpZExldmVsIDwgdGhpcy5zdGVwQm90dG9tIHx8IGxpcXVpZExldmVsID4gdGhpcy5zdGVwVG9wICkge1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBjb25zdCByYXRpbyA9ICggbGlxdWlkTGV2ZWwgLSB0aGlzLnN0ZXBCb3R0b20gKSAvICggdGhpcy5zdGVwVG9wIC0gdGhpcy5zdGVwQm90dG9tICk7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy5zdGVwTWF4aW11bUFyZWEgKiAyICogTWF0aC5zcXJ0KCByYXRpbyAtIHJhdGlvICogcmF0aW8gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIGRpc3BsYWNlZCB2b2x1bWUgb2YgdGhpcyBvYmplY3QgdXAgdG8gYSBnaXZlbiB5IGxldmVsLCBhc3N1bWluZyBhIHkgdmFsdWUgZm9yIHRoZSBnaXZlbiBsaXF1aWQgbGV2ZWwuXHJcbiAgICpcclxuICAgKiBBc3N1bWVzIHN0ZXAgaW5mb3JtYXRpb24gd2FzIHVwZGF0ZWQuXHJcbiAgICovXHJcbiAgcHVibGljIGdldERpc3BsYWNlZFZvbHVtZSggbGlxdWlkTGV2ZWw6IG51bWJlciApOiBudW1iZXIge1xyXG4gICAgaWYgKCBsaXF1aWRMZXZlbCA8PSB0aGlzLnN0ZXBCb3R0b20gKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIGxpcXVpZExldmVsID49IHRoaXMuc3RlcFRvcCApIHtcclxuICAgICAgcmV0dXJuIHRoaXMuc3RlcE1heGltdW1Wb2x1bWU7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgY29uc3QgcmF0aW8gPSAoIGxpcXVpZExldmVsIC0gdGhpcy5zdGVwQm90dG9tICkgLyAoIHRoaXMuc3RlcFRvcCAtIHRoaXMuc3RlcEJvdHRvbSApO1xyXG4gICAgICBjb25zdCBmID0gMiAqIHJhdGlvIC0gMTtcclxuXHJcbiAgICAgIC8vIENvbXB1dGVkIHdpdGggTWF0aGVtYXRpY2FcclxuICAgICAgcmV0dXJuIHRoaXMuc3RlcE1heGltdW1Wb2x1bWUgKiAoIDIgKiBNYXRoLnNxcnQoIHJhdGlvIC0gcmF0aW8gKiByYXRpbyApICogZiArIE1hdGguYWNvcyggLWYgKSApIC8gTWF0aC5QSTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc2V0cyB0aGluZ3MgdG8gdGhlaXIgb3JpZ2luYWwgdmFsdWVzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNldCgpOiB2b2lkIHtcclxuICAgIHRoaXMucmFkaXVzUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMubGVuZ3RoUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMudXBkYXRlU2l6ZSggdGhpcy5yYWRpdXNQcm9wZXJ0eS52YWx1ZSwgdGhpcy5sZW5ndGhQcm9wZXJ0eS52YWx1ZSApO1xyXG5cclxuICAgIHN1cGVyLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWxlYXNlcyByZWZlcmVuY2VzXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLnJhZGl1c1Byb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgIHRoaXMubGVuZ3RoUHJvcGVydHkuZGlzcG9zZSgpO1xyXG5cclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgYSBob3Jpem9udGFsIGN5bGluZGVyIHNoYXBlIGZvciBhIGdpdmVuIHJhZGl1cy9sZW5ndGguXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXRIb3Jpem9udGFsQ3lsaW5kZXJTaGFwZSggcmFkaXVzOiBudW1iZXIsIGxlbmd0aDogbnVtYmVyICk6IFNoYXBlIHtcclxuICAgIHJldHVybiBTaGFwZS5yZWN0KCAtbGVuZ3RoIC8gMiwgLXJhZGl1cywgbGVuZ3RoLCAyICogcmFkaXVzICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSB2b2x1bWUgb2YgYSBob3Jpem9udGFsIGN5bGluZGVyIHdpdGggdGhlIGdpdmVuIHJhZGl1cyBhbmQgbGVuZ3RoLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0Vm9sdW1lKCByYWRpdXM6IG51bWJlciwgbGVuZ3RoOiBudW1iZXIgKTogbnVtYmVyIHtcclxuICAgIHJldHVybiBNYXRoLlBJICogcmFkaXVzICogcmFkaXVzICogbGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBIb3Jpem9udGFsQ3lsaW5kZXJJTyA9IG5ldyBJT1R5cGUoICdIb3Jpem9udGFsQ3lsaW5kZXJJTycsIHtcclxuICAgIHZhbHVlVHlwZTogSG9yaXpvbnRhbEN5bGluZGVyLFxyXG4gICAgc3VwZXJ0eXBlOiBNYXNzLk1hc3NJTyxcclxuICAgIGRvY3VtZW50YXRpb246ICdSZXByZXNlbnRzIGEgY3lsaW5kZXIgbGF5aW5nIG9uIGl0cyBzaWRlJ1xyXG4gIH0gKTtcclxufVxyXG5cclxuZGVuc2l0eUJ1b3lhbmN5Q29tbW9uLnJlZ2lzdGVyKCAnSG9yaXpvbnRhbEN5bGluZGVyJywgSG9yaXpvbnRhbEN5bGluZGVyICk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxjQUFjLE1BQU0sdUNBQXVDO0FBR2xFLE9BQU9DLEtBQUssTUFBTSw2QkFBNkI7QUFFL0MsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxPQUFPLE1BQU0sK0JBQStCO0FBQ25ELFNBQVNDLEtBQUssUUFBUSxnQ0FBZ0M7QUFDdEQsT0FBT0MsU0FBUyxNQUE0Qix1Q0FBdUM7QUFDbkYsT0FBT0MsTUFBTSxNQUFNLHVDQUF1QztBQUMxRCxPQUFPQyxxQkFBcUIsTUFBTSxnQ0FBZ0M7QUFDbEUsT0FBT0MsSUFBSSxJQUE2QkMseUJBQXlCLEVBQUVDLHlCQUF5QixRQUFRLFdBQVc7QUFFL0csU0FBU0MsU0FBUyxRQUFRLGdCQUFnQjtBQUkxQyxlQUFlLE1BQU1DLGtCQUFrQixTQUFTSixJQUFJLENBQUM7RUFLbkQ7O0VBT09LLFdBQVdBLENBQUVDLE1BQXFCLEVBQUVDLE1BQWMsRUFBRUMsTUFBYyxFQUFFQyxjQUF5QyxFQUFHO0lBQ3JILE1BQU1DLE1BQU0sR0FBR2IsU0FBUyxDQUF1RSxDQUFDLENBQUU7TUFDaEdjLElBQUksRUFBRUwsTUFBTSxDQUFDTSxTQUFTLENBQUVKLE1BQU0sRUFBRUQsTUFBTSxHQUFHLENBQUUsQ0FBQztNQUM1Q00sS0FBSyxFQUFFVCxrQkFBa0IsQ0FBQ1UsMEJBQTBCLENBQUVQLE1BQU0sRUFBRUMsTUFBTyxDQUFDO01BQ3RFTyxNQUFNLEVBQUVYLGtCQUFrQixDQUFDWSxTQUFTLENBQUVULE1BQU0sRUFBRUMsTUFBTyxD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