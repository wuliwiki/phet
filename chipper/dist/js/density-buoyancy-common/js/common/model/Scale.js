// Copyright 2019-2022, University of Colorado Boulder

/**
 * A scale used for measuring mass/weight (depending on the DisplayType)
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Bounds3 from '../../../../dot/js/Bounds3.js';
import Vector3 from '../../../../dot/js/Vector3.js';
import { Shape } from '../../../../kite/js/imports.js';
import Enumeration from '../../../../phet-core/js/Enumeration.js';
import EnumerationValue from '../../../../phet-core/js/EnumerationValue.js';
import optionize from '../../../../phet-core/js/optionize.js';
import PhetioObject from '../../../../tandem/js/PhetioObject.js';
import IOType from '../../../../tandem/js/types/IOType.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import densityBuoyancyCommon from '../../densityBuoyancyCommon.js';
import Cuboid from './Cuboid.js';
import InterpolatedProperty from './InterpolatedProperty.js';
import Mass from './Mass.js';
import Material from './Material.js';
import VerticalCylinder from './VerticalCylinder.js';
import { MassShape } from './MassShape.js';

// constants
const SCALE_WIDTH = 0.15;
const SCALE_HEIGHT = 0.06;
const SCALE_DEPTH = 0.2;
const SCALE_BASE_HEIGHT = 0.05;
const SCALE_TOP_HEIGHT = SCALE_HEIGHT - SCALE_BASE_HEIGHT;
const SCALE_AREA = SCALE_WIDTH * SCALE_DEPTH;
const SCALE_VOLUME = SCALE_AREA * SCALE_HEIGHT;
const SCALE_BASE_BOUNDS = new Bounds3(-SCALE_WIDTH / 2, -SCALE_HEIGHT / 2, -SCALE_WIDTH / 2, SCALE_WIDTH / 2, SCALE_BASE_HEIGHT - SCALE_HEIGHT / 2, SCALE_DEPTH - SCALE_WIDTH / 2);
const SCALE_FRONT_OFFSET = new Vector3(SCALE_BASE_BOUNDS.centerX, SCALE_BASE_BOUNDS.centerY, SCALE_BASE_BOUNDS.maxZ);
export class DisplayType extends EnumerationValue {
  static NEWTONS = new DisplayType();
  static KILOGRAMS = new DisplayType();
  static enumeration = new Enumeration(DisplayType, {
    phetioDocumentation: 'Units for the scale readout'
  });
}
export default class Scale extends Mass {
  // In Newtons.

  // Just exist for phet-io, see https://github.com/phetsims/density/issues/97

  constructor(engine, gravityProperty, providedOptions) {
    const config = optionize()({
      body: engine.createBox(SCALE_WIDTH, SCALE_HEIGHT, providedOptions.canMove === false),
      shape: Shape.rect(-SCALE_WIDTH / 2, -SCALE_HEIGHT / 2, SCALE_WIDTH, SCALE_HEIGHT),
      volume: SCALE_VOLUME,
      massShape: MassShape.BLOCK,
      // {DisplayType}
      displayType: DisplayType.NEWTONS,
      // material
      material: Material.PLATINUM,
      phetioType: Scale.ScaleIO,
      inputEnabledPropertyOptions: {
        phetioReadOnly: true
      },
      materialPropertyOptions: {
        phetioReadOnly: true
      },
      massPropertyOptions: {
        phetioDocumentation: PhetioObject.DEFAULT_OPTIONS.phetioDocumentation
      },
      volumePropertyOptions: {
        phetioDocumentation: PhetioObject.DEFAULT_OPTIONS.phetioDocumentation
      }
    }, providedOptions);

    // TODO: Ask MK about why the parent options seem to be made optional, this cast shouldn't be needed
    super(engine, config);
    this.scaleForceInterpolatedProperty = new InterpolatedProperty(0, {
      interpolate: InterpolatedProperty.interpolateNumber,
      phetioValueType: NumberIO,
      tandem: config.tandem.createTandem('scaleForceInterpolatedProperty'),
      units: 'N',
      phetioReadOnly: true
    });
    this.scaleMeasuredMassProperty = new DerivedProperty([this.scaleForceInterpolatedProperty, gravityProperty], (force, gravity) => {
      if (gravity.value !== 0) {
        return force / gravity.value;
      } else {
        return 0;
      }
    }, {
      phetioValueType: NumberIO,
      tandem: config.tandem.createTandem('scaleMeasuredMassProperty'),
      units: 'kg',
      phetioReadOnly: true
    });

    // (read-only) {DisplayType}
    this.displayType = config.displayType;
  }

  /**
   * Called after a engine-physics-model step once before doing other operations (like computing buoyant forces,
   * displacement, etc.) so that it can set high-performance flags used for this purpose.
   *
   * Type-specific values are likely to be set, but this should set at least stepX/stepBottom/stepTop
   */
  updateStepInformation() {
    super.updateStepInformation();
    const xOffset = this.stepMatrix.m02();
    const yOffset = this.stepMatrix.m12();
    this.stepX = xOffset;
    this.stepBottom = yOffset - SCALE_HEIGHT / 2;
    this.stepTop = yOffset + SCALE_HEIGHT / 2;
  }

  /**
   * If there is an intersection with the ray and this mass, the t-value (distance the ray would need to travel to
   * reach the intersection, e.g. ray.position + ray.distance * t === intersectionPoint) will be returned. Otherwise
   * if there is no intersection, null will be returned.
   */
  intersect(ray, isTouch) {
    const translation = this.matrix.getTranslation().toVector3();
    const topOffsetTranslation = translation.plusXYZ(0, SCALE_HEIGHT / 2 - SCALE_TOP_HEIGHT / 2, 0);
    const baseIntersection = Cuboid.intersect(SCALE_BASE_BOUNDS, translation, ray);
    const topIntersection = VerticalCylinder.intersect(ray, isTouch, topOffsetTranslation, SCALE_WIDTH / 2, SCALE_TOP_HEIGHT);
    return baseIntersection && topIntersection ? Math.min(baseIntersection, topIntersection) : baseIntersection || topIntersection;
  }

  /**
   * Returns the cumulative displaced volume of this object up to a given y level.
   *
   * Assumes step information was updated.
   */
  getDisplacedArea(liquidLevel) {
    if (liquidLevel < this.stepBottom || liquidLevel > this.stepTop) {
      return 0;
    } else {
      return SCALE_AREA;
    }
  }

  /**
   * Returns the displaced volume of this object up to a given y level, assuming a y value for the given liquid level.
   *
   * Assumes step information was updated.
   */
  getDisplacedVolume(liquidLevel) {
    const bottom = this.stepBottom;
    const top = this.stepTop;
    if (liquidLevel <= bottom) {
      return 0;
    } else if (liquidLevel >= top) {
      return SCALE_VOLUME;
    } else {
      return SCALE_VOLUME * (liquidLevel - bottom) / (top - bottom);
    }
  }
  setRatios(widthRatio, heightRatio) {
    // See subclass for implementation
  }

  /**
   * Steps forward in time.
   */
  step(dt, interpolationRatio) {
    super.step(dt, interpolationRatio);
    this.scaleForceInterpolatedProperty.setRatio(interpolationRatio);
  }
  static ScaleIO = new IOType('ScaleIO', {
    valueType: Scale,
    supertype: Mass.MassIO,
    documentation: 'Represents scale used for measuring mass/weight'
  });
  static SCALE_WIDTH = SCALE_WIDTH;
  static SCALE_HEIGHT = SCALE_HEIGHT;
  static SCALE_DEPTH = SCALE_DEPTH;
  static SCALE_BASE_HEIGHT = SCALE_BASE_HEIGHT;
  static SCALE_TOP_HEIGHT = SCALE_TOP_HEIGHT;
  static SCALE_AREA = SCALE_AREA;
  static SCALE_VOLUME = SCALE_VOLUME;
  static SCALE_BASE_BOUNDS = SCALE_BASE_BOUNDS;
  static SCALE_FRONT_OFFSET = SCALE_FRONT_OFFSET;
}
densityBuoyancyCommon.register('Scale', Scale);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJCb3VuZHMzIiwiVmVjdG9yMyIsIlNoYXBlIiwiRW51bWVyYXRpb24iLCJFbnVtZXJhdGlvblZhbHVlIiwib3B0aW9uaXplIiwiUGhldGlvT2JqZWN0IiwiSU9UeXBlIiwiTnVtYmVySU8iLCJkZW5zaXR5QnVveWFuY3lDb21tb24iLCJDdWJvaWQiLCJJbnRlcnBvbGF0ZWRQcm9wZXJ0eSIsIk1hc3MiLCJNYXRlcmlhbCIsIlZlcnRpY2FsQ3lsaW5kZXIiLCJNYXNzU2hhcGUiLCJTQ0FMRV9XSURUSCIsIlNDQUxFX0hFSUdIVCIsIlNDQUxFX0RFUFRIIiwiU0NBTEVfQkFTRV9IRUlHSFQiLCJTQ0FMRV9UT1BfSEVJR0hUIiwiU0NBTEVfQVJFQSIsIlNDQUxFX1ZPTFVNRSIsIlNDQUxFX0JBU0VfQk9VTkRTIiwiU0NBTEVfRlJPTlRfT0ZGU0VUIiwiY2VudGVyWCIsImNlbnRlclkiLCJtYXhaIiwiRGlzcGxheVR5cGUiLCJORVdUT05TIiwiS0lMT0dSQU1TIiwiZW51bWVyYXRpb24iLCJwaGV0aW9Eb2N1bWVudGF0aW9uIiwiU2NhbGUiLCJjb25zdHJ1Y3RvciIsImVuZ2luZSIsImdyYXZpdHlQcm9wZXJ0eSIsInByb3ZpZGVkT3B0aW9ucyIsImNvbmZpZyIsImJvZHkiLCJjcmVhdGVCb3giLCJjYW5Nb3ZlIiwic2hhcGUiLCJyZWN0Iiwidm9sdW1lIiwibWFzc1NoYXBlIiwiQkxPQ0siLCJkaXNwbGF5VHlwZSIsIm1hdGVyaWFsIiwiUExBVElOVU0iLCJwaGV0aW9UeXBlIiwiU2NhbGVJTyIsImlucHV0RW5hYmxlZFByb3BlcnR5T3B0aW9ucyIsInBoZXRpb1JlYWRPbmx5IiwibWF0ZXJpYWxQcm9wZXJ0eU9wdGlvbnMiLCJtYXNzUHJvcGVydHlPcHRpb25zIiwiREVGQVVMVF9PUFRJT05TIiwidm9sdW1lUHJvcGVydHlPcHRpb25zIiwic2NhbGVGb3JjZUludGVycG9sYXRlZFByb3BlcnR5IiwiaW50ZXJwb2xhdGUiLCJpbnRlcnBvbGF0ZU51bWJlciIsInBoZXRpb1ZhbHVlVHlwZSIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsInVuaXRzIiwic2NhbGVNZWFzdXJlZE1hc3NQcm9wZXJ0eSIsImZvcmNlIiwiZ3Jhdml0eSIsInZhbHVlIiwidXBkYXRlU3RlcEluZm9ybWF0aW9uIiwieE9mZnNldCIsInN0ZXBNYXRyaXgiLCJtMDIiLCJ5T2Zmc2V0IiwibTEyIiwic3RlcFgiLCJzdGVwQm90dG9tIiwic3RlcFRvcCIsImludGVyc2VjdCIsInJheSIsImlzVG91Y2giLCJ0cmFuc2xhdGlvbiIsIm1hdHJpeCIsImdldFRyYW5zbGF0aW9uIiwidG9WZWN0b3IzIiwidG9wT2Zmc2V0VHJhbnNsYXRpb24iLCJwbHVzWFlaIiwiYmFzZUludGVyc2VjdGlvbiIsInRvcEludGVyc2VjdGlvbiIsIk1hdGgiLCJtaW4iLCJnZXREaXNwbGFjZWRBcmVhIiwibGlxdWlkTGV2ZWwiLCJnZXREaXNwbGFjZWRWb2x1bWUiLCJib3R0b20iLCJ0b3AiLCJzZXRSYXRpb3MiLCJ3aWR0aFJhdGlvIiwiaGVpZ2h0UmF0aW8iLCJzdGVwIiwiZHQiLCJpbnRlcnBvbGF0aW9uUmF0aW8iLCJzZXRSYXRpbyIsInZhbHVlVHlwZSIsInN1cGVydHlwZSIsIk1hc3NJTyIsImRvY3VtZW50YXRpb24iLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlNjYWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE5LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEEgc2NhbGUgdXNlZCBmb3IgbWVhc3VyaW5nIG1hc3Mvd2VpZ2h0IChkZXBlbmRpbmcgb24gdGhlIERpc3BsYXlUeXBlKVxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBTdHJpY3RPbWl0IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9TdHJpY3RPbWl0LmpzJztcclxuaW1wb3J0IEJvdW5kczMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczMuanMnO1xyXG5pbXBvcnQgVmVjdG9yMyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMy5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEVudW1lcmF0aW9uIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9FbnVtZXJhdGlvbi5qcyc7XHJcbmltcG9ydCBFbnVtZXJhdGlvblZhbHVlIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9FbnVtZXJhdGlvblZhbHVlLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFBoZXRpb09iamVjdCBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvUGhldGlvT2JqZWN0LmpzJztcclxuaW1wb3J0IElPVHlwZSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvSU9UeXBlLmpzJztcclxuaW1wb3J0IE51bWJlcklPIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy90eXBlcy9OdW1iZXJJTy5qcyc7XHJcbmltcG9ydCBkZW5zaXR5QnVveWFuY3lDb21tb24gZnJvbSAnLi4vLi4vZGVuc2l0eUJ1b3lhbmN5Q29tbW9uLmpzJztcclxuaW1wb3J0IEN1Ym9pZCBmcm9tICcuL0N1Ym9pZC5qcyc7XHJcbmltcG9ydCBJbnRlcnBvbGF0ZWRQcm9wZXJ0eSBmcm9tICcuL0ludGVycG9sYXRlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IE1hc3MsIHsgSW5zdHJ1bWVudGVkTWFzc09wdGlvbnMgfSBmcm9tICcuL01hc3MuanMnO1xyXG5pbXBvcnQgTWF0ZXJpYWwgZnJvbSAnLi9NYXRlcmlhbC5qcyc7XHJcbmltcG9ydCBWZXJ0aWNhbEN5bGluZGVyIGZyb20gJy4vVmVydGljYWxDeWxpbmRlci5qcyc7XHJcbmltcG9ydCBQaHlzaWNzRW5naW5lIGZyb20gJy4vUGh5c2ljc0VuZ2luZS5qcyc7XHJcbmltcG9ydCBHcmF2aXR5IGZyb20gJy4vR3Jhdml0eS5qcyc7XHJcbmltcG9ydCBUUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBSYXkzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9SYXkzLmpzJztcclxuaW1wb3J0IHsgTWFzc1NoYXBlIH0gZnJvbSAnLi9NYXNzU2hhcGUuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IFNDQUxFX1dJRFRIID0gMC4xNTtcclxuY29uc3QgU0NBTEVfSEVJR0hUID0gMC4wNjtcclxuY29uc3QgU0NBTEVfREVQVEggPSAwLjI7XHJcbmNvbnN0IFNDQUxFX0JBU0VfSEVJR0hUID0gMC4wNTtcclxuY29uc3QgU0NBTEVfVE9QX0hFSUdIVCA9IFNDQUxFX0hFSUdIVCAtIFNDQUxFX0JBU0VfSEVJR0hUO1xyXG5jb25zdCBTQ0FMRV9BUkVBID0gU0NBTEVfV0lEVEggKiBTQ0FMRV9ERVBUSDtcclxuY29uc3QgU0NBTEVfVk9MVU1FID0gU0NBTEVfQVJFQSAqIFNDQUxFX0hFSUdIVDtcclxuY29uc3QgU0NBTEVfQkFTRV9CT1VORFMgPSBuZXcgQm91bmRzMyhcclxuICAtU0NBTEVfV0lEVEggLyAyLFxyXG4gIC1TQ0FMRV9IRUlHSFQgLyAyLFxyXG4gIC1TQ0FMRV9XSURUSCAvIDIsXHJcbiAgU0NBTEVfV0lEVEggLyAyLFxyXG4gIFNDQUxFX0JBU0VfSEVJR0hUIC0gU0NBTEVfSEVJR0hUIC8gMixcclxuICBTQ0FMRV9ERVBUSCAtIFNDQUxFX1dJRFRIIC8gMlxyXG4pO1xyXG5jb25zdCBTQ0FMRV9GUk9OVF9PRkZTRVQgPSBuZXcgVmVjdG9yMyhcclxuICBTQ0FMRV9CQVNFX0JPVU5EUy5jZW50ZXJYLFxyXG4gIFNDQUxFX0JBU0VfQk9VTkRTLmNlbnRlclksXHJcbiAgU0NBTEVfQkFTRV9CT1VORFMubWF4WlxyXG4pO1xyXG5cclxuZXhwb3J0IGNsYXNzIERpc3BsYXlUeXBlIGV4dGVuZHMgRW51bWVyYXRpb25WYWx1ZSB7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBORVdUT05TID0gbmV3IERpc3BsYXlUeXBlKCk7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBLSUxPR1JBTVMgPSBuZXcgRGlzcGxheVR5cGUoKTtcclxuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBlbnVtZXJhdGlvbiA9IG5ldyBFbnVtZXJhdGlvbiggRGlzcGxheVR5cGUsIHtcclxuICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdVbml0cyBmb3IgdGhlIHNjYWxlIHJlYWRvdXQnXHJcbiAgfSApO1xyXG59XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIGRpc3BsYXlUeXBlPzogRGlzcGxheVR5cGU7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBTY2FsZU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFN0cmljdE9taXQ8SW5zdHJ1bWVudGVkTWFzc09wdGlvbnMsICdib2R5JyB8ICdzaGFwZScgfCAndm9sdW1lJyB8ICdtYXRlcmlhbCcgfCAnbWFzc1NoYXBlJz47XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTY2FsZSBleHRlbmRzIE1hc3Mge1xyXG5cclxuICAvLyBJbiBOZXd0b25zLlxyXG4gIHB1YmxpYyByZWFkb25seSBzY2FsZUZvcmNlSW50ZXJwb2xhdGVkUHJvcGVydHk6IEludGVycG9sYXRlZFByb3BlcnR5PG51bWJlcj47XHJcblxyXG4gIC8vIEp1c3QgZXhpc3QgZm9yIHBoZXQtaW8sIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvZGVuc2l0eS9pc3N1ZXMvOTdcclxuICBwcml2YXRlIHJlYWRvbmx5IHNjYWxlTWVhc3VyZWRNYXNzUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBkaXNwbGF5VHlwZTogRGlzcGxheVR5cGU7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggZW5naW5lOiBQaHlzaWNzRW5naW5lLCBncmF2aXR5UHJvcGVydHk6IFRQcm9wZXJ0eTxHcmF2aXR5PiwgcHJvdmlkZWRPcHRpb25zOiBTY2FsZU9wdGlvbnMgKSB7XHJcbiAgICBjb25zdCBjb25maWcgPSBvcHRpb25pemU8U2NhbGVPcHRpb25zLCBTZWxmT3B0aW9ucywgSW5zdHJ1bWVudGVkTWFzc09wdGlvbnM+KCkoIHtcclxuICAgICAgYm9keTogZW5naW5lLmNyZWF0ZUJveCggU0NBTEVfV0lEVEgsIFNDQUxFX0hFSUdIVCwgcHJvdmlkZWRPcHRpb25zLmNhbk1vdmUgPT09IGZhbHNlICksXHJcbiAgICAgIHNoYXBlOiBTaGFwZS5yZWN0KCAtU0NBTEVfV0lEVEggLyAyLCAtU0NBTEVfSEVJR0hUIC8gMiwgU0NBTEVfV0lEVEgsIFNDQUxFX0hFSUdIVCApLFxyXG4gICAgICB2b2x1bWU6IFNDQUxFX1ZPTFVNRSxcclxuICAgICAgbWFzc1NoYXBlOiBNYXNzU2hhcGUuQkxPQ0ssXHJcblxyXG4gICAgICAvLyB7RGlzcGxheVR5cGV9XHJcbiAgICAgIGRpc3BsYXlUeXBlOiBEaXNwbGF5VHlwZS5ORVdUT05TLFxyXG5cclxuICAgICAgLy8gbWF0ZXJpYWxcclxuICAgICAgbWF0ZXJpYWw6IE1hdGVyaWFsLlBMQVRJTlVNLFxyXG5cclxuICAgICAgcGhldGlvVHlwZTogU2NhbGUuU2NhbGVJTyxcclxuXHJcbiAgICAgIGlucHV0RW5hYmxlZFByb3BlcnR5T3B0aW9uczoge1xyXG4gICAgICAgIHBoZXRpb1JlYWRPbmx5OiB0cnVlXHJcbiAgICAgIH0sXHJcbiAgICAgIG1hdGVyaWFsUHJvcGVydHlPcHRpb25zOiB7XHJcbiAgICAgICAgcGhldGlvUmVhZE9ubHk6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgbWFzc1Byb3BlcnR5T3B0aW9uczoge1xyXG4gICAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246IFBoZXRpb09iamVjdC5ERUZBVUxUX09QVElPTlMucGhldGlvRG9jdW1lbnRhdGlvblxyXG4gICAgICB9LFxyXG4gICAgICB2b2x1bWVQcm9wZXJ0eU9wdGlvbnM6IHtcclxuICAgICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiBQaGV0aW9PYmplY3QuREVGQVVMVF9PUFRJT05TLnBoZXRpb0RvY3VtZW50YXRpb25cclxuICAgICAgfVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gVE9ETzogQXNrIE1LIGFib3V0IHdoeSB0aGUgcGFyZW50IG9wdGlvbnMgc2VlbSB0byBiZSBtYWRlIG9wdGlvbmFsLCB0aGlzIGNhc3Qgc2hvdWxkbid0IGJlIG5lZWRlZFxyXG4gICAgc3VwZXIoIGVuZ2luZSwgY29uZmlnIGFzIEluc3RydW1lbnRlZE1hc3NPcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5zY2FsZUZvcmNlSW50ZXJwb2xhdGVkUHJvcGVydHkgPSBuZXcgSW50ZXJwb2xhdGVkUHJvcGVydHkoIDAsIHtcclxuICAgICAgaW50ZXJwb2xhdGU6IEludGVycG9sYXRlZFByb3BlcnR5LmludGVycG9sYXRlTnVtYmVyLFxyXG4gICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bWJlcklPLFxyXG4gICAgICB0YW5kZW06IGNvbmZpZy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnc2NhbGVGb3JjZUludGVycG9sYXRlZFByb3BlcnR5JyApLFxyXG4gICAgICB1bml0czogJ04nLFxyXG4gICAgICBwaGV0aW9SZWFkT25seTogdHJ1ZVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuc2NhbGVNZWFzdXJlZE1hc3NQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgdGhpcy5zY2FsZUZvcmNlSW50ZXJwb2xhdGVkUHJvcGVydHksIGdyYXZpdHlQcm9wZXJ0eSBdLCAoIGZvcmNlLCBncmF2aXR5ICkgPT4ge1xyXG4gICAgICBpZiAoIGdyYXZpdHkudmFsdWUgIT09IDAgKSB7XHJcbiAgICAgICAgcmV0dXJuIGZvcmNlIC8gZ3Jhdml0eS52YWx1ZTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgICAgfVxyXG4gICAgfSwge1xyXG4gICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bWJlcklPLFxyXG4gICAgICB0YW5kZW06IGNvbmZpZy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnc2NhbGVNZWFzdXJlZE1hc3NQcm9wZXJ0eScgKSxcclxuICAgICAgdW5pdHM6ICdrZycsXHJcbiAgICAgIHBoZXRpb1JlYWRPbmx5OiB0cnVlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gKHJlYWQtb25seSkge0Rpc3BsYXlUeXBlfVxyXG4gICAgdGhpcy5kaXNwbGF5VHlwZSA9IGNvbmZpZy5kaXNwbGF5VHlwZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGxlZCBhZnRlciBhIGVuZ2luZS1waHlzaWNzLW1vZGVsIHN0ZXAgb25jZSBiZWZvcmUgZG9pbmcgb3RoZXIgb3BlcmF0aW9ucyAobGlrZSBjb21wdXRpbmcgYnVveWFudCBmb3JjZXMsXHJcbiAgICogZGlzcGxhY2VtZW50LCBldGMuKSBzbyB0aGF0IGl0IGNhbiBzZXQgaGlnaC1wZXJmb3JtYW5jZSBmbGFncyB1c2VkIGZvciB0aGlzIHB1cnBvc2UuXHJcbiAgICpcclxuICAgKiBUeXBlLXNwZWNpZmljIHZhbHVlcyBhcmUgbGlrZWx5IHRvIGJlIHNldCwgYnV0IHRoaXMgc2hvdWxkIHNldCBhdCBsZWFzdCBzdGVwWC9zdGVwQm90dG9tL3N0ZXBUb3BcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgdXBkYXRlU3RlcEluZm9ybWF0aW9uKCk6IHZvaWQge1xyXG4gICAgc3VwZXIudXBkYXRlU3RlcEluZm9ybWF0aW9uKCk7XHJcblxyXG4gICAgY29uc3QgeE9mZnNldCA9IHRoaXMuc3RlcE1hdHJpeC5tMDIoKTtcclxuICAgIGNvbnN0IHlPZmZzZXQgPSB0aGlzLnN0ZXBNYXRyaXgubTEyKCk7XHJcblxyXG4gICAgdGhpcy5zdGVwWCA9IHhPZmZzZXQ7XHJcbiAgICB0aGlzLnN0ZXBCb3R0b20gPSB5T2Zmc2V0IC0gU0NBTEVfSEVJR0hUIC8gMjtcclxuICAgIHRoaXMuc3RlcFRvcCA9IHlPZmZzZXQgKyBTQ0FMRV9IRUlHSFQgLyAyO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSWYgdGhlcmUgaXMgYW4gaW50ZXJzZWN0aW9uIHdpdGggdGhlIHJheSBhbmQgdGhpcyBtYXNzLCB0aGUgdC12YWx1ZSAoZGlzdGFuY2UgdGhlIHJheSB3b3VsZCBuZWVkIHRvIHRyYXZlbCB0b1xyXG4gICAqIHJlYWNoIHRoZSBpbnRlcnNlY3Rpb24sIGUuZy4gcmF5LnBvc2l0aW9uICsgcmF5LmRpc3RhbmNlICogdCA9PT0gaW50ZXJzZWN0aW9uUG9pbnQpIHdpbGwgYmUgcmV0dXJuZWQuIE90aGVyd2lzZVxyXG4gICAqIGlmIHRoZXJlIGlzIG5vIGludGVyc2VjdGlvbiwgbnVsbCB3aWxsIGJlIHJldHVybmVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBpbnRlcnNlY3QoIHJheTogUmF5MywgaXNUb3VjaDogYm9vbGVhbiApOiBudW1iZXIgfCBudWxsIHtcclxuICAgIGNvbnN0IHRyYW5zbGF0aW9uID0gdGhpcy5tYXRyaXguZ2V0VHJhbnNsYXRpb24oKS50b1ZlY3RvcjMoKTtcclxuICAgIGNvbnN0IHRvcE9mZnNldFRyYW5zbGF0aW9uID0gdHJhbnNsYXRpb24ucGx1c1hZWiggMCwgU0NBTEVfSEVJR0hUIC8gMiAtIFNDQUxFX1RPUF9IRUlHSFQgLyAyLCAwICk7XHJcblxyXG4gICAgY29uc3QgYmFzZUludGVyc2VjdGlvbiA9IEN1Ym9pZC5pbnRlcnNlY3QoIFNDQUxFX0JBU0VfQk9VTkRTLCB0cmFuc2xhdGlvbiwgcmF5ICk7XHJcbiAgICBjb25zdCB0b3BJbnRlcnNlY3Rpb24gPSBWZXJ0aWNhbEN5bGluZGVyLmludGVyc2VjdCggcmF5LCBpc1RvdWNoLCB0b3BPZmZzZXRUcmFuc2xhdGlvbiwgU0NBTEVfV0lEVEggLyAyLCBTQ0FMRV9UT1BfSEVJR0hUICk7XHJcblxyXG4gICAgcmV0dXJuICggYmFzZUludGVyc2VjdGlvbiAmJiB0b3BJbnRlcnNlY3Rpb24gKSA/IE1hdGgubWluKCBiYXNlSW50ZXJzZWN0aW9uLCB0b3BJbnRlcnNlY3Rpb24gKSA6ICggYmFzZUludGVyc2VjdGlvbiB8fCB0b3BJbnRlcnNlY3Rpb24gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIGN1bXVsYXRpdmUgZGlzcGxhY2VkIHZvbHVtZSBvZiB0aGlzIG9iamVjdCB1cCB0byBhIGdpdmVuIHkgbGV2ZWwuXHJcbiAgICpcclxuICAgKiBBc3N1bWVzIHN0ZXAgaW5mb3JtYXRpb24gd2FzIHVwZGF0ZWQuXHJcbiAgICovXHJcbiAgcHVibGljIGdldERpc3BsYWNlZEFyZWEoIGxpcXVpZExldmVsOiBudW1iZXIgKTogbnVtYmVyIHtcclxuICAgIGlmICggbGlxdWlkTGV2ZWwgPCB0aGlzLnN0ZXBCb3R0b20gfHwgbGlxdWlkTGV2ZWwgPiB0aGlzLnN0ZXBUb3AgKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHJldHVybiBTQ0FMRV9BUkVBO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgZGlzcGxhY2VkIHZvbHVtZSBvZiB0aGlzIG9iamVjdCB1cCB0byBhIGdpdmVuIHkgbGV2ZWwsIGFzc3VtaW5nIGEgeSB2YWx1ZSBmb3IgdGhlIGdpdmVuIGxpcXVpZCBsZXZlbC5cclxuICAgKlxyXG4gICAqIEFzc3VtZXMgc3RlcCBpbmZvcm1hdGlvbiB3YXMgdXBkYXRlZC5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0RGlzcGxhY2VkVm9sdW1lKCBsaXF1aWRMZXZlbDogbnVtYmVyICk6IG51bWJlciB7XHJcbiAgICBjb25zdCBib3R0b20gPSB0aGlzLnN0ZXBCb3R0b207XHJcbiAgICBjb25zdCB0b3AgPSB0aGlzLnN0ZXBUb3A7XHJcblxyXG4gICAgaWYgKCBsaXF1aWRMZXZlbCA8PSBib3R0b20gKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIGxpcXVpZExldmVsID49IHRvcCApIHtcclxuICAgICAgcmV0dXJuIFNDQUxFX1ZPTFVNRTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICByZXR1cm4gU0NBTEVfVk9MVU1FICogKCBsaXF1aWRMZXZlbCAtIGJvdHRvbSApIC8gKCB0b3AgLSBib3R0b20gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXRSYXRpb3MoIHdpZHRoUmF0aW86IG51bWJlciwgaGVpZ2h0UmF0aW86IG51bWJlciApOiB2b2lkIHtcclxuICAgIC8vIFNlZSBzdWJjbGFzcyBmb3IgaW1wbGVtZW50YXRpb25cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0ZXBzIGZvcndhcmQgaW4gdGltZS5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgc3RlcCggZHQ6IG51bWJlciwgaW50ZXJwb2xhdGlvblJhdGlvOiBudW1iZXIgKTogdm9pZCB7XHJcbiAgICBzdXBlci5zdGVwKCBkdCwgaW50ZXJwb2xhdGlvblJhdGlvICk7XHJcblxyXG4gICAgdGhpcy5zY2FsZUZvcmNlSW50ZXJwb2xhdGVkUHJvcGVydHkuc2V0UmF0aW8oIGludGVycG9sYXRpb25SYXRpbyApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBTY2FsZUlPID0gbmV3IElPVHlwZSggJ1NjYWxlSU8nLCB7XHJcbiAgICB2YWx1ZVR5cGU6IFNjYWxlLFxyXG4gICAgc3VwZXJ0eXBlOiBNYXNzLk1hc3NJTyxcclxuICAgIGRvY3VtZW50YXRpb246ICdSZXByZXNlbnRzIHNjYWxlIHVzZWQgZm9yIG1lYXN1cmluZyBtYXNzL3dlaWdodCdcclxuICB9ICk7XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgU0NBTEVfV0lEVEggPSBTQ0FMRV9XSURUSDtcclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFNDQUxFX0hFSUdIVCA9IFNDQUxFX0hFSUdIVDtcclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFNDQUxFX0RFUFRIID0gU0NBTEVfREVQVEg7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBTQ0FMRV9CQVNFX0hFSUdIVCA9IFNDQUxFX0JBU0VfSEVJR0hUO1xyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgU0NBTEVfVE9QX0hFSUdIVCA9IFNDQUxFX1RPUF9IRUlHSFQ7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBTQ0FMRV9BUkVBID0gU0NBTEVfQVJFQTtcclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFNDQUxFX1ZPTFVNRSA9IFNDQUxFX1ZPTFVNRTtcclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFNDQUxFX0JBU0VfQk9VTkRTID0gU0NBTEVfQkFTRV9CT1VORFM7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBTQ0FMRV9GUk9OVF9PRkZTRVQgPSBTQ0FMRV9GUk9OVF9PRkZTRVQ7XHJcbn1cclxuXHJcbmRlbnNpdHlCdW95YW5jeUNvbW1vbi5yZWdpc3RlciggJ1NjYWxlJywgU2NhbGUgKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFFcEUsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxPQUFPLE1BQU0s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