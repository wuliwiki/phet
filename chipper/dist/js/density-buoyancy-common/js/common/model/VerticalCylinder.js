// Copyright 2019-2022, University of Colorado Boulder

/**
 * A cylinder laying on its end (the caps are on the top and bottom)
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Range from '../../../../dot/js/Range.js';
import Utils from '../../../../dot/js/Utils.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import Vector3 from '../../../../dot/js/Vector3.js';
import { Shape } from '../../../../kite/js/imports.js';
import optionize from '../../../../phet-core/js/optionize.js';
import IOType from '../../../../tandem/js/types/IOType.js';
import densityBuoyancyCommon from '../../densityBuoyancyCommon.js';
import Mass, { MASS_MAX_SHAPES_DIMENSION, MASS_MIN_SHAPES_DIMENSION } from './Mass.js';
import { MassShape } from './MassShape.js';
export default class VerticalCylinder extends Mass {
  // Step information

  constructor(engine, radius, height, providedConfig) {
    const config = optionize()({
      body: engine.createBox(2 * radius, height),
      shape: VerticalCylinder.getVerticalCylinderShape(radius, height),
      volume: VerticalCylinder.getVolume(radius, height),
      massShape: MassShape.VERTICAL_CYLINDER,
      phetioType: VerticalCylinder.VerticalCylinderIO
    }, providedConfig);
    assert && assert(!config.canRotate);
    super(engine, config);

    // {Property.<number>}
    this.radiusProperty = new NumberProperty(radius, {
      tandem: config.tandem.createTandem('radiusProperty'),
      range: new Range(0, Number.POSITIVE_INFINITY)
    });
    this.heightProperty = new NumberProperty(height, {
      tandem: config.tandem.createTandem('heightProperty'),
      range: new Range(0, Number.POSITIVE_INFINITY)
    });
    this.stepRadius = 0;
    this.stepHeight = 0;
    this.stepArea = 0;
    this.stepMaximumVolume = 0;
    this.massOffsetOrientationProperty.value = new Vector2(0, -1);
    this.updateSize(radius, height);
  }

  /**
   * Updates the size of the cone.
   */
  updateSize(radius, height) {
    this.engine.updateBox(this.body, 2 * radius, height);
    this.radiusProperty.value = radius;
    this.heightProperty.value = height;
    this.shapeProperty.value = VerticalCylinder.getVerticalCylinderShape(radius, height);
    this.volumeLock = true;
    this.volumeProperty.value = VerticalCylinder.getVolume(radius, height);
    this.volumeLock = false;
    this.forceOffsetProperty.value = new Vector3(0, 0, radius);
    this.massOffsetProperty.value = new Vector3(0, -height / 2, radius);
  }

  /**
   * Returns the radius from a general size scale
   */
  static getRadiusFromRatio(widthRatio) {
    return (MASS_MIN_SHAPES_DIMENSION + widthRatio * (MASS_MAX_SHAPES_DIMENSION - MASS_MIN_SHAPES_DIMENSION)) / 2;
  }

  /**
   * Returns the height from a general size scale
   */
  static getHeightFromRatio(heightRatio) {
    return MASS_MIN_SHAPES_DIMENSION + heightRatio * (MASS_MAX_SHAPES_DIMENSION - MASS_MIN_SHAPES_DIMENSION);
  }

  /**
   * Sets the general size of the mass based on a general size scale.
   */
  setRatios(widthRatio, heightRatio) {
    this.updateSize(VerticalCylinder.getRadiusFromRatio(widthRatio), VerticalCylinder.getHeightFromRatio(heightRatio));
  }

  /**
   * Called after a engine-physics-model step once before doing other operations (like computing buoyant forces,
   * displacement, etc.) so that it can set high-performance flags used for this purpose.
   *
   * Type-specific values are likely to be set, but this should set at least stepX/stepBottom/stepTop
   */
  updateStepInformation() {
    super.updateStepInformation();
    const xOffset = this.stepMatrix.m02();
    const yOffset = this.stepMatrix.m12();
    this.stepX = xOffset;
    this.stepBottom = yOffset - this.heightProperty.value / 2;
    this.stepTop = yOffset + this.heightProperty.value / 2;
    this.stepRadius = this.radiusProperty.value;
    this.stepHeight = this.heightProperty.value;
    this.stepArea = Math.PI * this.stepRadius * this.stepRadius;
    this.stepMaximumVolume = this.stepArea * this.heightProperty.value;
  }

  /**
   * If there is an intersection with the ray and this mass, the t-value (distance the ray would need to travel to
   * reach the intersection, e.g. ray.position + ray.distance * t === intersectionPoint) will be returned. Otherwise
   * if there is no intersection, null will be returned.
   */
  intersect(ray, isTouch) {
    return VerticalCylinder.intersect(ray, isTouch, this.matrix.getTranslation().toVector3(), this.radiusProperty.value, this.heightProperty.value);
  }

  /**
   * Returns the cumulative displaced volume of this object up to a given y level.
   *
   * Assumes step information was updated.
   */
  getDisplacedArea(liquidLevel) {
    if (liquidLevel < this.stepBottom || liquidLevel > this.stepTop) {
      return 0;
    } else {
      return this.stepArea;
    }
  }

  /**
   * Returns the displaced volume of this object up to a given y level, assuming a y value for the given liquid level.
   *
   * Assumes step information was updated.
   */
  getDisplacedVolume(liquidLevel) {
    const bottom = this.stepBottom;
    const top = this.stepTop;
    if (liquidLevel <= bottom) {
      return 0;
    } else if (liquidLevel >= top) {
      return this.stepMaximumVolume;
    } else {
      // This is identical to Cuboid's getDisplacedVolume formula, see there if this needs to change.
      return this.stepMaximumVolume * (liquidLevel - bottom) / (top - bottom);
    }
  }

  /**
   * Resets things to their original values.
   */
  reset() {
    this.radiusProperty.reset();
    this.heightProperty.reset();
    this.updateSize(this.radiusProperty.value, this.heightProperty.value);
    super.reset();
  }

  /**
   * Releases references
   */
  dispose() {
    this.radiusProperty.dispose();
    this.heightProperty.dispose();
    super.dispose();
  }

  /**
   * Returns a vertical cylinder shape for a given radius/height.
   */
  static getVerticalCylinderShape(radius, height) {
    return Shape.rect(-radius, -height / 2, 2 * radius, height);
  }

  /**
   * Returns the volume of a vertical cylinder with the given radius and height.
   */
  static getVolume(radius, height) {
    return Math.PI * radius * radius * height;
  }

  /**
   * If there is an intersection with the ray and the cone, the t-value (distance the ray would need to travel to
   * reach the intersection, e.g. ray.position + ray.distance * t === intersectionPoint) will be returned. Otherwise
   * if there is no intersection, null will be returned.
   */
  static intersect(ray, isTouch, translation, radius, height) {
    const relativePosition = ray.position.minusXYZ(translation.x, translation.y, translation.z);
    const xp = 4 / (radius * radius);
    const zp = 4 / (radius * radius);
    const a = xp * ray.direction.x * ray.direction.x + zp * ray.direction.z * ray.direction.z;
    const b = 2 * (xp * relativePosition.x * ray.direction.x + zp * relativePosition.z * ray.direction.z);
    const c = -1 + xp * relativePosition.x * relativePosition.x + zp * relativePosition.z * relativePosition.z;
    const tValues = Utils.solveQuadraticRootsReal(a, b, c).filter(t => {
      if (t <= 0) {
        return false;
      }
      const y = ray.pointAtDistance(t).y;
      return Math.abs(y - translation.y) <= height / 2;
    });
    if (tValues.length) {
      return tValues[0];
    } else {
      return null;
    }
  }
  static VerticalCylinderIO = new IOType('VerticalCylinderIO', {
    valueType: VerticalCylinder,
    supertype: Mass.MassIO,
    documentation: 'Represents a cylinder laying on its end'
  });
}
densityBuoyancyCommon.register('VerticalCylinder', VerticalCylinder);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOdW1iZXJQcm9wZXJ0eSIsIlJhbmdlIiwiVXRpbHMiLCJWZWN0b3IyIiwiVmVjdG9yMyIsIlNoYXBlIiwib3B0aW9uaXplIiwiSU9UeXBlIiwiZGVuc2l0eUJ1b3lhbmN5Q29tbW9uIiwiTWFzcyIsIk1BU1NfTUFYX1NIQVBFU19ESU1FTlNJT04iLCJNQVNTX01JTl9TSEFQRVNfRElNRU5TSU9OIiwiTWFzc1NoYXBlIiwiVmVydGljYWxDeWxpbmRlciIsImNvbnN0cnVjdG9yIiwiZW5naW5lIiwicmFkaXVzIiwiaGVpZ2h0IiwicHJvdmlkZWRDb25maWciLCJjb25maWciLCJib2R5IiwiY3JlYXRlQm94Iiwic2hhcGUiLCJnZXRWZXJ0aWNhbEN5bGluZGVyU2hhcGUiLCJ2b2x1bWUiLCJnZXRWb2x1bWUiLCJtYXNzU2hhcGUiLCJWRVJUSUNBTF9DWUxJTkRFUiIsInBoZXRpb1R5cGUiLCJWZXJ0aWNhbEN5bGluZGVySU8iLCJhc3NlcnQiLCJjYW5Sb3RhdGUiLCJyYWRpdXNQcm9wZXJ0eSIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsInJhbmdlIiwiTnVtYmVyIiwiUE9TSVRJVkVfSU5GSU5JVFkiLCJoZWlnaHRQcm9wZXJ0eSIsInN0ZXBSYWRpdXMiLCJzdGVwSGVpZ2h0Iiwic3RlcEFyZWEiLCJzdGVwTWF4aW11bVZvbHVtZSIsIm1hc3NPZmZzZXRPcmllbnRhdGlvblByb3BlcnR5IiwidmFsdWUiLCJ1cGRhdGVTaXplIiwidXBkYXRlQm94Iiwic2hhcGVQcm9wZXJ0eSIsInZvbHVtZUxvY2siLCJ2b2x1bWVQcm9wZXJ0eSIsImZvcmNlT2Zmc2V0UHJvcGVydHkiLCJtYXNzT2Zmc2V0UHJvcGVydHkiLCJnZXRSYWRpdXNGcm9tUmF0aW8iLCJ3aWR0aFJhdGlvIiwiZ2V0SGVpZ2h0RnJvbVJhdGlvIiwiaGVpZ2h0UmF0aW8iLCJzZXRSYXRpb3MiLCJ1cGRhdGVTdGVwSW5mb3JtYXRpb24iLCJ4T2Zmc2V0Iiwic3RlcE1hdHJpeCIsIm0wMiIsInlPZmZzZXQiLCJtMTIiLCJzdGVwWCIsInN0ZXBCb3R0b20iLCJzdGVwVG9wIiwiTWF0aCIsIlBJIiwiaW50ZXJzZWN0IiwicmF5IiwiaXNUb3VjaCIsIm1hdHJpeCIsImdldFRyYW5zbGF0aW9uIiwidG9WZWN0b3IzIiwiZ2V0RGlzcGxhY2VkQXJlYSIsImxpcXVpZExldmVsIiwiZ2V0RGlzcGxhY2VkVm9sdW1lIiwiYm90dG9tIiwidG9wIiwicmVzZXQiLCJkaXNwb3NlIiwicmVjdCIsInRyYW5zbGF0aW9uIiwicmVsYXRpdmVQb3NpdGlvbiIsInBvc2l0aW9uIiwibWludXNYWVoiLCJ4IiwieSIsInoiLCJ4cCIsInpwIiwiYSIsImRpcmVjdGlvbiIsImIiLCJjIiwidFZhbHVlcyIsInNvbHZlUXVhZHJhdGljUm9vdHNSZWFsIiwiZmlsdGVyIiwidCIsInBvaW50QXREaXN0YW5jZSIsImFicyIsImxlbmd0aCIsInZhbHVlVHlwZSIsInN1cGVydHlwZSIsIk1hc3NJTyIsImRvY3VtZW50YXRpb24iLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlZlcnRpY2FsQ3lsaW5kZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTktMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQSBjeWxpbmRlciBsYXlpbmcgb24gaXRzIGVuZCAodGhlIGNhcHMgYXJlIG9uIHRoZSB0b3AgYW5kIGJvdHRvbSlcclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBOdW1iZXJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL051bWJlclByb3BlcnR5LmpzJztcclxuaW1wb3J0IFN0cmljdE9taXQgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1N0cmljdE9taXQuanMnO1xyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBSYW5nZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2UuanMnO1xyXG5pbXBvcnQgUmF5MyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmF5My5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCBWZWN0b3IzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IzLmpzJztcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IElPVHlwZSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvSU9UeXBlLmpzJztcclxuaW1wb3J0IGRlbnNpdHlCdW95YW5jeUNvbW1vbiBmcm9tICcuLi8uLi9kZW5zaXR5QnVveWFuY3lDb21tb24uanMnO1xyXG5pbXBvcnQgTWFzcywgeyBJbnN0cnVtZW50ZWRNYXNzT3B0aW9ucywgTUFTU19NQVhfU0hBUEVTX0RJTUVOU0lPTiwgTUFTU19NSU5fU0hBUEVTX0RJTUVOU0lPTiB9IGZyb20gJy4vTWFzcy5qcyc7XHJcbmltcG9ydCBQaHlzaWNzRW5naW5lIGZyb20gJy4vUGh5c2ljc0VuZ2luZS5qcyc7XHJcbmltcG9ydCB7IE1hc3NTaGFwZSB9IGZyb20gJy4vTWFzc1NoYXBlLmpzJztcclxuXHJcbmV4cG9ydCB0eXBlIFZlcnRpY2FsQ3lsaW5kZXJPcHRpb25zID0gU3RyaWN0T21pdDxJbnN0cnVtZW50ZWRNYXNzT3B0aW9ucywgJ2JvZHknIHwgJ3NoYXBlJyB8ICd2b2x1bWUnIHwgJ21hc3NTaGFwZSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmVydGljYWxDeWxpbmRlciBleHRlbmRzIE1hc3Mge1xyXG5cclxuICBwdWJsaWMgcmVhZG9ubHkgcmFkaXVzUHJvcGVydHk6IFByb3BlcnR5PG51bWJlcj47XHJcbiAgcHVibGljIHJlYWRvbmx5IGhlaWdodFByb3BlcnR5OiBQcm9wZXJ0eTxudW1iZXI+O1xyXG5cclxuICAvLyBTdGVwIGluZm9ybWF0aW9uXHJcbiAgcHVibGljIHN0ZXBSYWRpdXM6IG51bWJlcjtcclxuICBwdWJsaWMgc3RlcEhlaWdodDogbnVtYmVyO1xyXG4gIHB1YmxpYyBzdGVwQXJlYTogbnVtYmVyO1xyXG4gIHB1YmxpYyBzdGVwTWF4aW11bVZvbHVtZTogbnVtYmVyO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGVuZ2luZTogUGh5c2ljc0VuZ2luZSwgcmFkaXVzOiBudW1iZXIsIGhlaWdodDogbnVtYmVyLCBwcm92aWRlZENvbmZpZzogVmVydGljYWxDeWxpbmRlck9wdGlvbnMgKSB7XHJcbiAgICBjb25zdCBjb25maWcgPSBvcHRpb25pemU8VmVydGljYWxDeWxpbmRlck9wdGlvbnMsIEVtcHR5U2VsZk9wdGlvbnMsIEluc3RydW1lbnRlZE1hc3NPcHRpb25zPigpKCB7XHJcbiAgICAgIGJvZHk6IGVuZ2luZS5jcmVhdGVCb3goIDIgKiByYWRpdXMsIGhlaWdodCApLFxyXG4gICAgICBzaGFwZTogVmVydGljYWxDeWxpbmRlci5nZXRWZXJ0aWNhbEN5bGluZGVyU2hhcGUoIHJhZGl1cywgaGVpZ2h0ICksXHJcbiAgICAgIHZvbHVtZTogVmVydGljYWxDeWxpbmRlci5nZXRWb2x1bWUoIHJhZGl1cywgaGVpZ2h0ICksXHJcbiAgICAgIG1hc3NTaGFwZTogTWFzc1NoYXBlLlZFUlRJQ0FMX0NZTElOREVSLFxyXG5cclxuICAgICAgcGhldGlvVHlwZTogVmVydGljYWxDeWxpbmRlci5WZXJ0aWNhbEN5bGluZGVySU9cclxuICAgIH0sIHByb3ZpZGVkQ29uZmlnICk7XHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggIWNvbmZpZy5jYW5Sb3RhdGUgKTtcclxuXHJcbiAgICBzdXBlciggZW5naW5lLCBjb25maWcgYXMgSW5zdHJ1bWVudGVkTWFzc09wdGlvbnMgKTtcclxuXHJcbiAgICAvLyB7UHJvcGVydHkuPG51bWJlcj59XHJcbiAgICB0aGlzLnJhZGl1c1Byb3BlcnR5ID0gbmV3IE51bWJlclByb3BlcnR5KCByYWRpdXMsIHtcclxuICAgICAgdGFuZGVtOiBjb25maWcudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3JhZGl1c1Byb3BlcnR5JyApLFxyXG4gICAgICByYW5nZTogbmV3IFJhbmdlKCAwLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgKVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5oZWlnaHRQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggaGVpZ2h0LCB7XHJcbiAgICAgIHRhbmRlbTogY29uZmlnLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdoZWlnaHRQcm9wZXJ0eScgKSxcclxuICAgICAgcmFuZ2U6IG5ldyBSYW5nZSggMCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIClcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLnN0ZXBSYWRpdXMgPSAwO1xyXG4gICAgdGhpcy5zdGVwSGVpZ2h0ID0gMDtcclxuICAgIHRoaXMuc3RlcEFyZWEgPSAwO1xyXG4gICAgdGhpcy5zdGVwTWF4aW11bVZvbHVtZSA9IDA7XHJcblxyXG4gICAgdGhpcy5tYXNzT2Zmc2V0T3JpZW50YXRpb25Qcm9wZXJ0eS52YWx1ZSA9IG5ldyBWZWN0b3IyKCAwLCAtMSApO1xyXG5cclxuICAgIHRoaXMudXBkYXRlU2l6ZSggcmFkaXVzLCBoZWlnaHQgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZXMgdGhlIHNpemUgb2YgdGhlIGNvbmUuXHJcbiAgICovXHJcbiAgcHVibGljIHVwZGF0ZVNpemUoIHJhZGl1czogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciApOiB2b2lkIHtcclxuICAgIHRoaXMuZW5naW5lLnVwZGF0ZUJveCggdGhpcy5ib2R5LCAyICogcmFkaXVzLCBoZWlnaHQgKTtcclxuXHJcbiAgICB0aGlzLnJhZGl1c1Byb3BlcnR5LnZhbHVlID0gcmFkaXVzO1xyXG4gICAgdGhpcy5oZWlnaHRQcm9wZXJ0eS52YWx1ZSA9IGhlaWdodDtcclxuXHJcbiAgICB0aGlzLnNoYXBlUHJvcGVydHkudmFsdWUgPSBWZXJ0aWNhbEN5bGluZGVyLmdldFZlcnRpY2FsQ3lsaW5kZXJTaGFwZSggcmFkaXVzLCBoZWlnaHQgKTtcclxuXHJcbiAgICB0aGlzLnZvbHVtZUxvY2sgPSB0cnVlO1xyXG4gICAgdGhpcy52b2x1bWVQcm9wZXJ0eS52YWx1ZSA9IFZlcnRpY2FsQ3lsaW5kZXIuZ2V0Vm9sdW1lKCByYWRpdXMsIGhlaWdodCApO1xyXG4gICAgdGhpcy52b2x1bWVMb2NrID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5mb3JjZU9mZnNldFByb3BlcnR5LnZhbHVlID0gbmV3IFZlY3RvcjMoIDAsIDAsIHJhZGl1cyApO1xyXG4gICAgdGhpcy5tYXNzT2Zmc2V0UHJvcGVydHkudmFsdWUgPSBuZXcgVmVjdG9yMyggMCwgLWhlaWdodCAvIDIsIHJhZGl1cyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgcmFkaXVzIGZyb20gYSBnZW5lcmFsIHNpemUgc2NhbGVcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldFJhZGl1c0Zyb21SYXRpbyggd2lkdGhSYXRpbzogbnVtYmVyICk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gKCBNQVNTX01JTl9TSEFQRVNfRElNRU5TSU9OICsgd2lkdGhSYXRpbyAqICggTUFTU19NQVhfU0hBUEVTX0RJTUVOU0lPTiAtIE1BU1NfTUlOX1NIQVBFU19ESU1FTlNJT04gKSApIC8gMjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIGhlaWdodCBmcm9tIGEgZ2VuZXJhbCBzaXplIHNjYWxlXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXRIZWlnaHRGcm9tUmF0aW8oIGhlaWdodFJhdGlvOiBudW1iZXIgKTogbnVtYmVyIHtcclxuICAgIHJldHVybiAoIE1BU1NfTUlOX1NIQVBFU19ESU1FTlNJT04gKyBoZWlnaHRSYXRpbyAqICggTUFTU19NQVhfU0hBUEVTX0RJTUVOU0lPTiAtIE1BU1NfTUlOX1NIQVBFU19ESU1FTlNJT04gKSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0cyB0aGUgZ2VuZXJhbCBzaXplIG9mIHRoZSBtYXNzIGJhc2VkIG9uIGEgZ2VuZXJhbCBzaXplIHNjYWxlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRSYXRpb3MoIHdpZHRoUmF0aW86IG51bWJlciwgaGVpZ2h0UmF0aW86IG51bWJlciApOiB2b2lkIHtcclxuICAgIHRoaXMudXBkYXRlU2l6ZShcclxuICAgICAgVmVydGljYWxDeWxpbmRlci5nZXRSYWRpdXNGcm9tUmF0aW8oIHdpZHRoUmF0aW8gKSxcclxuICAgICAgVmVydGljYWxDeWxpbmRlci5nZXRIZWlnaHRGcm9tUmF0aW8oIGhlaWdodFJhdGlvIClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxsZWQgYWZ0ZXIgYSBlbmdpbmUtcGh5c2ljcy1tb2RlbCBzdGVwIG9uY2UgYmVmb3JlIGRvaW5nIG90aGVyIG9wZXJhdGlvbnMgKGxpa2UgY29tcHV0aW5nIGJ1b3lhbnQgZm9yY2VzLFxyXG4gICAqIGRpc3BsYWNlbWVudCwgZXRjLikgc28gdGhhdCBpdCBjYW4gc2V0IGhpZ2gtcGVyZm9ybWFuY2UgZmxhZ3MgdXNlZCBmb3IgdGhpcyBwdXJwb3NlLlxyXG4gICAqXHJcbiAgICogVHlwZS1zcGVjaWZpYyB2YWx1ZXMgYXJlIGxpa2VseSB0byBiZSBzZXQsIGJ1dCB0aGlzIHNob3VsZCBzZXQgYXQgbGVhc3Qgc3RlcFgvc3RlcEJvdHRvbS9zdGVwVG9wXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHVwZGF0ZVN0ZXBJbmZvcm1hdGlvbigpOiB2b2lkIHtcclxuICAgIHN1cGVyLnVwZGF0ZVN0ZXBJbmZvcm1hdGlvbigpO1xyXG5cclxuICAgIGNvbnN0IHhPZmZzZXQgPSB0aGlzLnN0ZXBNYXRyaXgubTAyKCk7XHJcbiAgICBjb25zdCB5T2Zmc2V0ID0gdGhpcy5zdGVwTWF0cml4Lm0xMigpO1xyXG5cclxuICAgIHRoaXMuc3RlcFggPSB4T2Zmc2V0O1xyXG4gICAgdGhpcy5zdGVwQm90dG9tID0geU9mZnNldCAtIHRoaXMuaGVpZ2h0UHJvcGVydHkudmFsdWUgLyAyO1xyXG4gICAgdGhpcy5zdGVwVG9wID0geU9mZnNldCArIHRoaXMuaGVpZ2h0UHJvcGVydHkudmFsdWUgLyAyO1xyXG5cclxuICAgIHRoaXMuc3RlcFJhZGl1cyA9IHRoaXMucmFkaXVzUHJvcGVydHkudmFsdWU7XHJcbiAgICB0aGlzLnN0ZXBIZWlnaHQgPSB0aGlzLmhlaWdodFByb3BlcnR5LnZhbHVlO1xyXG4gICAgdGhpcy5zdGVwQXJlYSA9IE1hdGguUEkgKiB0aGlzLnN0ZXBSYWRpdXMgKiB0aGlzLnN0ZXBSYWRpdXM7XHJcbiAgICB0aGlzLnN0ZXBNYXhpbXVtVm9sdW1lID0gdGhpcy5zdGVwQXJlYSAqIHRoaXMuaGVpZ2h0UHJvcGVydHkudmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJZiB0aGVyZSBpcyBhbiBpbnRlcnNlY3Rpb24gd2l0aCB0aGUgcmF5IGFuZCB0aGlzIG1hc3MsIHRoZSB0LXZhbHVlIChkaXN0YW5jZSB0aGUgcmF5IHdvdWxkIG5lZWQgdG8gdHJhdmVsIHRvXHJcbiAgICogcmVhY2ggdGhlIGludGVyc2VjdGlvbiwgZS5nLiByYXkucG9zaXRpb24gKyByYXkuZGlzdGFuY2UgKiB0ID09PSBpbnRlcnNlY3Rpb25Qb2ludCkgd2lsbCBiZSByZXR1cm5lZC4gT3RoZXJ3aXNlXHJcbiAgICogaWYgdGhlcmUgaXMgbm8gaW50ZXJzZWN0aW9uLCBudWxsIHdpbGwgYmUgcmV0dXJuZWQuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGludGVyc2VjdCggcmF5OiBSYXkzLCBpc1RvdWNoOiBib29sZWFuICk6IG51bWJlciB8IG51bGwge1xyXG4gICAgcmV0dXJuIFZlcnRpY2FsQ3lsaW5kZXIuaW50ZXJzZWN0KCByYXksIGlzVG91Y2gsIHRoaXMubWF0cml4LmdldFRyYW5zbGF0aW9uKCkudG9WZWN0b3IzKCksIHRoaXMucmFkaXVzUHJvcGVydHkudmFsdWUsIHRoaXMuaGVpZ2h0UHJvcGVydHkudmFsdWUgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIGN1bXVsYXRpdmUgZGlzcGxhY2VkIHZvbHVtZSBvZiB0aGlzIG9iamVjdCB1cCB0byBhIGdpdmVuIHkgbGV2ZWwuXHJcbiAgICpcclxuICAgKiBBc3N1bWVzIHN0ZXAgaW5mb3JtYXRpb24gd2FzIHVwZGF0ZWQuXHJcbiAgICovXHJcbiAgcHVibGljIGdldERpc3BsYWNlZEFyZWEoIGxpcXVpZExldmVsOiBudW1iZXIgKTogbnVtYmVyIHtcclxuICAgIGlmICggbGlxdWlkTGV2ZWwgPCB0aGlzLnN0ZXBCb3R0b20gfHwgbGlxdWlkTGV2ZWwgPiB0aGlzLnN0ZXBUb3AgKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnN0ZXBBcmVhO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgZGlzcGxhY2VkIHZvbHVtZSBvZiB0aGlzIG9iamVjdCB1cCB0byBhIGdpdmVuIHkgbGV2ZWwsIGFzc3VtaW5nIGEgeSB2YWx1ZSBmb3IgdGhlIGdpdmVuIGxpcXVpZCBsZXZlbC5cclxuICAgKlxyXG4gICAqIEFzc3VtZXMgc3RlcCBpbmZvcm1hdGlvbiB3YXMgdXBkYXRlZC5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0RGlzcGxhY2VkVm9sdW1lKCBsaXF1aWRMZXZlbDogbnVtYmVyICk6IG51bWJlciB7XHJcbiAgICBjb25zdCBib3R0b20gPSB0aGlzLnN0ZXBCb3R0b207XHJcbiAgICBjb25zdCB0b3AgPSB0aGlzLnN0ZXBUb3A7XHJcblxyXG4gICAgaWYgKCBsaXF1aWRMZXZlbCA8PSBib3R0b20gKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIGxpcXVpZExldmVsID49IHRvcCApIHtcclxuICAgICAgcmV0dXJuIHRoaXMuc3RlcE1heGltdW1Wb2x1bWU7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgLy8gVGhpcyBpcyBpZGVudGljYWwgdG8gQ3Vib2lkJ3MgZ2V0RGlzcGxhY2VkVm9sdW1lIGZvcm11bGEsIHNlZSB0aGVyZSBpZiB0aGlzIG5lZWRzIHRvIGNoYW5nZS5cclxuICAgICAgcmV0dXJuIHRoaXMuc3RlcE1heGltdW1Wb2x1bWUgKiAoIGxpcXVpZExldmVsIC0gYm90dG9tICkgLyAoIHRvcCAtIGJvdHRvbSApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzZXRzIHRoaW5ncyB0byB0aGVpciBvcmlnaW5hbCB2YWx1ZXMuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5yYWRpdXNQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5oZWlnaHRQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy51cGRhdGVTaXplKCB0aGlzLnJhZGl1c1Byb3BlcnR5LnZhbHVlLCB0aGlzLmhlaWdodFByb3BlcnR5LnZhbHVlICk7XHJcblxyXG4gICAgc3VwZXIucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbGVhc2VzIHJlZmVyZW5jZXNcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMucmFkaXVzUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgdGhpcy5oZWlnaHRQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcblxyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhIHZlcnRpY2FsIGN5bGluZGVyIHNoYXBlIGZvciBhIGdpdmVuIHJhZGl1cy9oZWlnaHQuXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXRWZXJ0aWNhbEN5bGluZGVyU2hhcGUoIHJhZGl1czogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciApOiBTaGFwZSB7XHJcbiAgICByZXR1cm4gU2hhcGUucmVjdCggLXJhZGl1cywgLWhlaWdodCAvIDIsIDIgKiByYWRpdXMsIGhlaWdodCApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgdm9sdW1lIG9mIGEgdmVydGljYWwgY3lsaW5kZXIgd2l0aCB0aGUgZ2l2ZW4gcmFkaXVzIGFuZCBoZWlnaHQuXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXRWb2x1bWUoIHJhZGl1czogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciApOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIE1hdGguUEkgKiByYWRpdXMgKiByYWRpdXMgKiBoZWlnaHQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJZiB0aGVyZSBpcyBhbiBpbnRlcnNlY3Rpb24gd2l0aCB0aGUgcmF5IGFuZCB0aGUgY29uZSwgdGhlIHQtdmFsdWUgKGRpc3RhbmNlIHRoZSByYXkgd291bGQgbmVlZCB0byB0cmF2ZWwgdG9cclxuICAgKiByZWFjaCB0aGUgaW50ZXJzZWN0aW9uLCBlLmcuIHJheS5wb3NpdGlvbiArIHJheS5kaXN0YW5jZSAqIHQgPT09IGludGVyc2VjdGlvblBvaW50KSB3aWxsIGJlIHJldHVybmVkLiBPdGhlcndpc2VcclxuICAgKiBpZiB0aGVyZSBpcyBubyBpbnRlcnNlY3Rpb24sIG51bGwgd2lsbCBiZSByZXR1cm5lZC5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGludGVyc2VjdCggcmF5OiBSYXkzLCBpc1RvdWNoOiBib29sZWFuLCB0cmFuc2xhdGlvbjogVmVjdG9yMywgcmFkaXVzOiBudW1iZXIsIGhlaWdodDogbnVtYmVyICk6IG51bWJlciB8IG51bGwge1xyXG4gICAgY29uc3QgcmVsYXRpdmVQb3NpdGlvbiA9IHJheS5wb3NpdGlvbi5taW51c1hZWiggdHJhbnNsYXRpb24ueCwgdHJhbnNsYXRpb24ueSwgdHJhbnNsYXRpb24ueiApO1xyXG5cclxuICAgIGNvbnN0IHhwID0gNCAvICggcmFkaXVzICogcmFkaXVzICk7XHJcbiAgICBjb25zdCB6cCA9IDQgLyAoIHJhZGl1cyAqIHJhZGl1cyApO1xyXG5cclxuICAgIGNvbnN0IGEgPSB4cCAqIHJheS5kaXJlY3Rpb24ueCAqIHJheS5kaXJlY3Rpb24ueCArIHpwICogcmF5LmRpcmVjdGlvbi56ICogcmF5LmRpcmVjdGlvbi56O1xyXG4gICAgY29uc3QgYiA9IDIgKiAoIHhwICogcmVsYXRpdmVQb3NpdGlvbi54ICogcmF5LmRpcmVjdGlvbi54ICsgenAgKiByZWxhdGl2ZVBvc2l0aW9uLnogKiByYXkuZGlyZWN0aW9uLnogKTtcclxuICAgIGNvbnN0IGMgPSAtMSArIHhwICogcmVsYXRpdmVQb3NpdGlvbi54ICogcmVsYXRpdmVQb3NpdGlvbi54ICsgenAgKiByZWxhdGl2ZVBvc2l0aW9uLnogKiByZWxhdGl2ZVBvc2l0aW9uLno7XHJcblxyXG4gICAgY29uc3QgdFZhbHVlcyA9IFV0aWxzLnNvbHZlUXVhZHJhdGljUm9vdHNSZWFsKCBhLCBiLCBjICkhLmZpbHRlciggdCA9PiB7XHJcbiAgICAgIGlmICggdCA8PSAwICkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCB5ID0gcmF5LnBvaW50QXREaXN0YW5jZSggdCApLnk7XHJcblxyXG4gICAgICByZXR1cm4gTWF0aC5hYnMoIHkgLSB0cmFuc2xhdGlvbi55ICkgPD0gaGVpZ2h0IC8gMjtcclxuICAgIH0gKTtcclxuXHJcbiAgICBpZiAoIHRWYWx1ZXMubGVuZ3RoICkge1xyXG4gICAgICByZXR1cm4gdFZhbHVlc1sgMCBdO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBWZXJ0aWNhbEN5bGluZGVySU8gPSBuZXcgSU9UeXBlKCAnVmVydGljYWxDeWxpbmRlcklPJywge1xyXG4gICAgdmFsdWVUeXBlOiBWZXJ0aWNhbEN5bGluZGVyLFxyXG4gICAgc3VwZXJ0eXBlOiBNYXNzLk1hc3NJTyxcclxuICAgIGRvY3VtZW50YXRpb246ICdSZXByZXNlbnRzIGEgY3lsaW5kZXIgbGF5aW5nIG9uIGl0cyBlbmQnXHJcbiAgfSApO1xyXG59XHJcblxyXG5kZW5zaXR5QnVveWFuY3lDb21tb24ucmVnaXN0ZXIoICdWZXJ0aWNhbEN5bGluZGVyJywgVmVydGljYWxDeWxpbmRlciApO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsY0FBYyxNQUFNLHVDQUF1QztBQUdsRSxPQUFPQyxLQUFLLE1BQU0sNkJBQTZCO0FBRS9DLE9BQU9DLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxPQUFPLE1BQU0sK0JBQStCO0FBQ25ELFNBQVNDLEtBQUssUUFBUSxnQ0FBZ0M7QUFDdEQsT0FBT0MsU0FBUyxNQUE0Qix1Q0FBdUM7QUFDbkYsT0FBT0MsTUFBTSxNQUFNLHVDQUF1QztBQUMxRCxPQUFPQyxxQkFBcUIsTUFBTSxnQ0FBZ0M7QUFDbEUsT0FBT0MsSUFBSSxJQUE2QkMseUJBQXlCLEVBQUVDLHlCQUF5QixRQUFRLFdBQVc7QUFFL0csU0FBU0MsU0FBUyxRQUFRLGdCQUFnQjtBQUkxQyxlQUFlLE1BQU1DLGdCQUFnQixTQUFTSixJQUFJLENBQUM7RUFLakQ7O0VBTU9LLFdBQVdBLENBQUVDLE1BQXFCLEVB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