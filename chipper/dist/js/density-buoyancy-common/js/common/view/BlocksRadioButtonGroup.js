// Copyright 2020-2023, University of Colorado Boulder

/**
 * Controls whether the second mass is visible.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Vector3 from '../../../../dot/js/Vector3.js';
import ThreeStage from '../../../../mobius/js/ThreeStage.js';
import ThreeUtils from '../../../../mobius/js/ThreeUtils.js';
import optionize from '../../../../phet-core/js/optionize.js';
import { Image } from '../../../../scenery/js/imports.js';
import RectangularRadioButtonGroup from '../../../../sun/js/buttons/RectangularRadioButtonGroup.js';
import doubleCuboidIcon_png from '../../../mipmaps/doubleCuboidIcon_png.js';
import singleCuboidIcon_png from '../../../mipmaps/singleCuboidIcon_png.js';
import densityBuoyancyCommon from '../../densityBuoyancyCommon.js';
import DensityBuoyancyCommonQueryParameters from '../DensityBuoyancyCommonQueryParameters.js';
import TwoBlockMode from '../model/TwoBlockMode.js';
import DensityBuoyancyCommonColors from './DensityBuoyancyCommonColors.js';

// constants
const aMaterial = new THREE.MeshLambertMaterial();
const bMaterial = new THREE.MeshLambertMaterial();

// These live for the lifetime of the simulation, so we don't need to remove this listener
DensityBuoyancyCommonColors.labelAProperty.link(labelColor => {
  aMaterial.color = ThreeUtils.colorToThree(labelColor);
});
DensityBuoyancyCommonColors.labelBProperty.link(labelColor => {
  bMaterial.color = ThreeUtils.colorToThree(labelColor);
});
export default class BlocksRadioButtonGroup extends RectangularRadioButtonGroup {
  constructor(modeProperty, options) {
    super(modeProperty, [{
      value: TwoBlockMode.ONE_BLOCK,
      createNode: () => BlocksRadioButtonGroup.getSingleCuboidIcon(),
      tandemName: 'oneBlockRadioButton'
    }, {
      value: TwoBlockMode.TWO_BLOCKS,
      createNode: () => BlocksRadioButtonGroup.getDoubleCuboidIcon(),
      tandemName: 'twoBlocksRadioButton'
    }], optionize()({
      orientation: 'horizontal',
      touchAreaXDilation: 5,
      touchAreaYDilation: 5,
      radioButtonOptions: {
        baseColor: 'rgb( 230, 231, 232 )'
      }
    }, options));
  }

  /**
   * Creates a box mesh for use in icons.
   */
  static createBox(material, position) {
    const boxGeometry = new THREE.BoxGeometry(0.1, 0.1, 0.1);
    const box = new THREE.Mesh(boxGeometry, material);
    box.position.copy(ThreeUtils.vectorToThree(position));

    // Create outlines around the box with cylinders (like stroking the edges)
    const connect = (a, b) => {
      const delta = b.minus(a);
      const edgeGeometry = new THREE.CylinderGeometry(0.002, 0.002, delta.magnitude, 8, 1);
      const edge = new THREE.Mesh(edgeGeometry, new THREE.MeshBasicMaterial({
        color: 0x000000
      }));
      edge.position.copy(ThreeUtils.vectorToThree(a.average(b)));
      if (a.z !== b.z) {
        edge.rotation.x += Math.PI / 2;
      }
      if (a.x !== b.x) {
        edge.rotation.z += Math.PI / 2;
      }
      box.add(edge);
    };
    connect(new Vector3(0.05, 0.05, 0.05), new Vector3(0.05, 0.05, -0.05));
    connect(new Vector3(-0.05, 0.05, 0.05), new Vector3(-0.05, 0.05, -0.05));
    connect(new Vector3(-0.05, -0.05, 0.05), new Vector3(-0.05, -0.05, -0.05));
    connect(new Vector3(0.05, -0.05, 0.05), new Vector3(0.05, -0.05, -0.05));
    connect(new Vector3(0.05, 0.05, 0.05), new Vector3(0.05, -0.05, 0.05));
    connect(new Vector3(-0.05, 0.05, 0.05), new Vector3(-0.05, -0.05, 0.05));
    connect(new Vector3(-0.05, 0.05, -0.05), new Vector3(-0.05, -0.05, -0.05));
    connect(new Vector3(0.05, 0.05, -0.05), new Vector3(0.05, -0.05, -0.05));
    connect(new Vector3(0.05, 0.05, 0.05), new Vector3(-0.05, 0.05, 0.05));
    connect(new Vector3(0.05, -0.05, 0.05), new Vector3(-0.05, -0.05, 0.05));
    connect(new Vector3(0.05, -0.05, -0.05), new Vector3(-0.05, -0.05, -0.05));
    connect(new Vector3(0.05, 0.05, -0.05), new Vector3(-0.05, 0.05, -0.05));
    return box;
  }

  /**
   * Returns an icon for selection, given a scene setup callback.
   */
  static getIcon(zoom, setupScene) {
    const stage = new ThreeStage();
    const ambientLight = new THREE.AmbientLight(0x333333);
    stage.threeScene.add(ambientLight);
    const sunLight = new THREE.DirectionalLight(0xffffff, 1);
    sunLight.position.set(-1, 1.5, 0.8);
    stage.threeScene.add(sunLight);
    const moonLight = new THREE.DirectionalLight(0xffffff, 0.2);
    moonLight.position.set(2.0, -1.0, 1.0);
    stage.threeScene.add(moonLight);
    stage.threeCamera.position.copy(ThreeUtils.vectorToThree(new Vector3(0, 0.3, 1)));
    stage.threeCamera.zoom = zoom;
    stage.threeCamera.lookAt(ThreeUtils.vectorToThree(new Vector3(0, -0.003, 0)));
    stage.threeCamera.updateProjectionMatrix();
    setupScene(stage.threeScene);
    stage.threeCamera.fov = 50;
    stage.threeCamera.aspect = 1;
    stage.setDimensions(256, 256);
    stage.threeCamera.near = 0.03;
    stage.threeCamera.updateProjectionMatrix();
    stage.render(undefined);
    const canvas = stage.renderToCanvas(3);
    stage.dispose();
    console.log(canvas.toDataURL());
    const image = new Image(canvas.toDataURL(), {
      mipmap: true,
      initialWidth: canvas.width,
      initialHeight: canvas.height
    });
    image.setScaleMagnitude(0.2, -0.2);
    return image;
  }

  /**
   * Returns an icon that shows a single cuboid.
   */
  static getSingleCuboidIcon() {
    if (DensityBuoyancyCommonQueryParameters.generateIconImages) {
      return BlocksRadioButtonGroup.getIcon(5.5, scene => {
        scene.add(BlocksRadioButtonGroup.createBox(aMaterial, new Vector3(0, 0, 0)));
      });
    } else {
      return new Image(singleCuboidIcon_png, {
        scale: 0.2
      });
    }
  }

  /**
   * Returns an icon that shows a single cuboid.
   */
  static getDoubleCuboidIcon() {
    if (DensityBuoyancyCommonQueryParameters.generateIconImages) {
      return BlocksRadioButtonGroup.getIcon(4, scene => {
        scene.add(BlocksRadioButtonGroup.createBox(aMaterial, new Vector3(-0.039, 0.015, -0.07)));
        scene.add(BlocksRadioButtonGroup.createBox(bMaterial, new Vector3(0.03, -0.005, 0.07)));
      });
    } else {
      return new Image(doubleCuboidIcon_png, {
        scale: 0.2
      });
    }
  }
}
densityBuoyancyCommon.register('BlocksRadioButtonGroup', BlocksRadioButtonGroup);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWZWN0b3IzIiwiVGhyZWVTdGFnZSIsIlRocmVlVXRpbHMiLCJvcHRpb25pemUiLCJJbWFnZSIsIlJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cCIsImRvdWJsZUN1Ym9pZEljb25fcG5nIiwic2luZ2xlQ3Vib2lkSWNvbl9wbmciLCJkZW5zaXR5QnVveWFuY3lDb21tb24iLCJEZW5zaXR5QnVveWFuY3lDb21tb25RdWVyeVBhcmFtZXRlcnMiLCJUd29CbG9ja01vZGUiLCJEZW5zaXR5QnVveWFuY3lDb21tb25Db2xvcnMiLCJhTWF0ZXJpYWwiLCJUSFJFRSIsIk1lc2hMYW1iZXJ0TWF0ZXJpYWwiLCJiTWF0ZXJpYWwiLCJsYWJlbEFQcm9wZXJ0eSIsImxpbmsiLCJsYWJlbENvbG9yIiwiY29sb3IiLCJjb2xvclRvVGhyZWUiLCJsYWJlbEJQcm9wZXJ0eSIsIkJsb2Nrc1JhZGlvQnV0dG9uR3JvdXAiLCJjb25zdHJ1Y3RvciIsIm1vZGVQcm9wZXJ0eSIsIm9wdGlvbnMiLCJ2YWx1ZSIsIk9ORV9CTE9DSyIsImNyZWF0ZU5vZGUiLCJnZXRTaW5nbGVDdWJvaWRJY29uIiwidGFuZGVtTmFtZSIsIlRXT19CTE9DS1MiLCJnZXREb3VibGVDdWJvaWRJY29uIiwib3JpZW50YXRpb24iLCJ0b3VjaEFyZWFYRGlsYXRpb24iLCJ0b3VjaEFyZWFZRGlsYXRpb24iLCJyYWRpb0J1dHRvbk9wdGlvbnMiLCJiYXNlQ29sb3IiLCJjcmVhdGVCb3giLCJtYXRlcmlhbCIsInBvc2l0aW9uIiwiYm94R2VvbWV0cnkiLCJCb3hHZW9tZXRyeSIsImJveCIsIk1lc2giLCJjb3B5IiwidmVjdG9yVG9UaHJlZSIsImNvbm5lY3QiLCJhIiwiYiIsImRlbHRhIiwibWludXMiLCJlZGdlR2VvbWV0cnkiLCJDeWxpbmRlckdlb21ldHJ5IiwibWFnbml0dWRlIiwiZWRnZSIsIk1lc2hCYXNpY01hdGVyaWFsIiwiYXZlcmFnZSIsInoiLCJyb3RhdGlvbiIsIngiLCJNYXRoIiwiUEkiLCJhZGQiLCJnZXRJY29uIiwiem9vbSIsInNldHVwU2NlbmUiLCJzdGFnZSIsImFtYmllbnRMaWdodCIsIkFtYmllbnRMaWdodCIsInRocmVlU2NlbmUiLCJzdW5MaWdodCIsIkRpcmVjdGlvbmFsTGlnaHQiLCJzZXQiLCJtb29uTGlnaHQiLCJ0aHJlZUNhbWVyYSIsImxvb2tBdCIsInVwZGF0ZVByb2plY3Rpb25NYXRyaXgiLCJmb3YiLCJhc3BlY3QiLCJzZXREaW1lbnNpb25zIiwibmVhciIsInJlbmRlciIsInVuZGVmaW5lZCIsImNhbnZhcyIsInJlbmRlclRvQ2FudmFzIiwiZGlzcG9zZSIsImNvbnNvbGUiLCJsb2ciLCJ0b0RhdGFVUkwiLCJpbWFnZSIsIm1pcG1hcCIsImluaXRpYWxXaWR0aCIsIndpZHRoIiwiaW5pdGlhbEhlaWdodCIsImhlaWdodCIsInNldFNjYWxlTWFnbml0dWRlIiwiZ2VuZXJhdGVJY29uSW1hZ2VzIiwic2NlbmUiLCJzY2FsZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQmxvY2tzUmFkaW9CdXR0b25Hcm91cC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMC0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBDb250cm9scyB3aGV0aGVyIHRoZSBzZWNvbmQgbWFzcyBpcyB2aXNpYmxlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVmVjdG9yMyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMy5qcyc7XHJcbmltcG9ydCBUaHJlZVN0YWdlIGZyb20gJy4uLy4uLy4uLy4uL21vYml1cy9qcy9UaHJlZVN0YWdlLmpzJztcclxuaW1wb3J0IFRocmVlVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vbW9iaXVzL2pzL1RocmVlVXRpbHMuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IHsgSW1hZ2UsIE5vZGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwLCB7IFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cE9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvYnV0dG9ucy9SZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXAuanMnO1xyXG5pbXBvcnQgZG91YmxlQ3Vib2lkSWNvbl9wbmcgZnJvbSAnLi4vLi4vLi4vbWlwbWFwcy9kb3VibGVDdWJvaWRJY29uX3BuZy5qcyc7XHJcbmltcG9ydCBzaW5nbGVDdWJvaWRJY29uX3BuZyBmcm9tICcuLi8uLi8uLi9taXBtYXBzL3NpbmdsZUN1Ym9pZEljb25fcG5nLmpzJztcclxuaW1wb3J0IGRlbnNpdHlCdW95YW5jeUNvbW1vbiBmcm9tICcuLi8uLi9kZW5zaXR5QnVveWFuY3lDb21tb24uanMnO1xyXG5pbXBvcnQgRGVuc2l0eUJ1b3lhbmN5Q29tbW9uUXVlcnlQYXJhbWV0ZXJzIGZyb20gJy4uL0RlbnNpdHlCdW95YW5jeUNvbW1vblF1ZXJ5UGFyYW1ldGVycy5qcyc7XHJcbmltcG9ydCBUd29CbG9ja01vZGUgZnJvbSAnLi4vbW9kZWwvVHdvQmxvY2tNb2RlLmpzJztcclxuaW1wb3J0IERlbnNpdHlCdW95YW5jeUNvbW1vbkNvbG9ycyBmcm9tICcuL0RlbnNpdHlCdW95YW5jeUNvbW1vbkNvbG9ycy5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgYU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwoKTtcclxuY29uc3QgYk1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwoKTtcclxuXHJcbi8vIFRoZXNlIGxpdmUgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltdWxhdGlvbiwgc28gd2UgZG9uJ3QgbmVlZCB0byByZW1vdmUgdGhpcyBsaXN0ZW5lclxyXG5EZW5zaXR5QnVveWFuY3lDb21tb25Db2xvcnMubGFiZWxBUHJvcGVydHkubGluayggbGFiZWxDb2xvciA9PiB7XHJcbiAgYU1hdGVyaWFsLmNvbG9yID0gVGhyZWVVdGlscy5jb2xvclRvVGhyZWUoIGxhYmVsQ29sb3IgKTtcclxufSApO1xyXG5EZW5zaXR5QnVveWFuY3lDb21tb25Db2xvcnMubGFiZWxCUHJvcGVydHkubGluayggbGFiZWxDb2xvciA9PiB7XHJcbiAgYk1hdGVyaWFsLmNvbG9yID0gVGhyZWVVdGlscy5jb2xvclRvVGhyZWUoIGxhYmVsQ29sb3IgKTtcclxufSApO1xyXG5cclxuZXhwb3J0IHR5cGUgQmxvY2tzUmFkaW9CdXR0b25Hcm91cE9wdGlvbnMgPSBSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXBPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmxvY2tzUmFkaW9CdXR0b25Hcm91cCBleHRlbmRzIFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cDxUd29CbG9ja01vZGU+IHtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoIG1vZGVQcm9wZXJ0eTogUHJvcGVydHk8VHdvQmxvY2tNb2RlPiwgb3B0aW9ucz86IEJsb2Nrc1JhZGlvQnV0dG9uR3JvdXBPcHRpb25zICkge1xyXG4gICAgc3VwZXIoIG1vZGVQcm9wZXJ0eSwgW1xyXG4gICAgICB7XHJcbiAgICAgICAgdmFsdWU6IFR3b0Jsb2NrTW9kZS5PTkVfQkxPQ0ssXHJcbiAgICAgICAgY3JlYXRlTm9kZTogKCkgPT4gQmxvY2tzUmFkaW9CdXR0b25Hcm91cC5nZXRTaW5nbGVDdWJvaWRJY29uKCksXHJcbiAgICAgICAgdGFuZGVtTmFtZTogJ29uZUJsb2NrUmFkaW9CdXR0b24nXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICB2YWx1ZTogVHdvQmxvY2tNb2RlLlRXT19CTE9DS1MsXHJcbiAgICAgICAgY3JlYXRlTm9kZTogKCkgPT4gQmxvY2tzUmFkaW9CdXR0b25Hcm91cC5nZXREb3VibGVDdWJvaWRJY29uKCksXHJcbiAgICAgICAgdGFuZGVtTmFtZTogJ3R3b0Jsb2Nrc1JhZGlvQnV0dG9uJ1xyXG4gICAgICB9XHJcbiAgICBdLCBvcHRpb25pemU8QmxvY2tzUmFkaW9CdXR0b25Hcm91cE9wdGlvbnMsIEVtcHR5U2VsZk9wdGlvbnMsIFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cE9wdGlvbnM+KCkoIHtcclxuICAgICAgb3JpZW50YXRpb246ICdob3Jpem9udGFsJyxcclxuICAgICAgdG91Y2hBcmVhWERpbGF0aW9uOiA1LFxyXG4gICAgICB0b3VjaEFyZWFZRGlsYXRpb246IDUsXHJcbiAgICAgIHJhZGlvQnV0dG9uT3B0aW9uczoge1xyXG4gICAgICAgIGJhc2VDb2xvcjogJ3JnYiggMjMwLCAyMzEsIDIzMiApJ1xyXG4gICAgICB9XHJcbiAgICB9LCBvcHRpb25zICkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBib3ggbWVzaCBmb3IgdXNlIGluIGljb25zLlxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIGNyZWF0ZUJveCggbWF0ZXJpYWw6IFRIUkVFLk1hdGVyaWFsLCBwb3NpdGlvbjogVmVjdG9yMyApOiBUSFJFRS5NZXNoIHtcclxuICAgIGNvbnN0IGJveEdlb21ldHJ5ID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KCAwLjEsIDAuMSwgMC4xICk7XHJcblxyXG4gICAgY29uc3QgYm94ID0gbmV3IFRIUkVFLk1lc2goIGJveEdlb21ldHJ5LCBtYXRlcmlhbCApO1xyXG4gICAgYm94LnBvc2l0aW9uLmNvcHkoIFRocmVlVXRpbHMudmVjdG9yVG9UaHJlZSggcG9zaXRpb24gKSApO1xyXG5cclxuICAgIC8vIENyZWF0ZSBvdXRsaW5lcyBhcm91bmQgdGhlIGJveCB3aXRoIGN5bGluZGVycyAobGlrZSBzdHJva2luZyB0aGUgZWRnZXMpXHJcbiAgICBjb25zdCBjb25uZWN0ID0gKCBhOiBWZWN0b3IzLCBiOiBWZWN0b3IzICkgPT4ge1xyXG4gICAgICBjb25zdCBkZWx0YSA9IGIubWludXMoIGEgKTtcclxuXHJcbiAgICAgIGNvbnN0IGVkZ2VHZW9tZXRyeSA9IG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KCAwLjAwMiwgMC4wMDIsIGRlbHRhLm1hZ25pdHVkZSwgOCwgMSApO1xyXG4gICAgICBjb25zdCBlZGdlID0gbmV3IFRIUkVFLk1lc2goIGVkZ2VHZW9tZXRyeSwgbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7IGNvbG9yOiAweDAwMDAwMCB9ICkgKTtcclxuXHJcbiAgICAgIGVkZ2UucG9zaXRpb24uY29weSggVGhyZWVVdGlscy52ZWN0b3JUb1RocmVlKCBhLmF2ZXJhZ2UoIGIgKSApICk7XHJcblxyXG4gICAgICBpZiAoIGEueiAhPT0gYi56ICkge1xyXG4gICAgICAgIGVkZ2Uucm90YXRpb24ueCArPSBNYXRoLlBJIC8gMjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIGEueCAhPT0gYi54ICkge1xyXG4gICAgICAgIGVkZ2Uucm90YXRpb24ueiArPSBNYXRoLlBJIC8gMjtcclxuICAgICAgfVxyXG5cclxuICAgICAgYm94LmFkZCggZWRnZSApO1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25uZWN0KCBuZXcgVmVjdG9yMyggMC4wNSwgMC4wNSwgMC4wNSApLCBuZXcgVmVjdG9yMyggMC4wNSwgMC4wNSwgLTAuMDUgKSApO1xyXG4gICAgY29ubmVjdCggbmV3IFZlY3RvcjMoIC0wLjA1LCAwLjA1LCAwLjA1ICksIG5ldyBWZWN0b3IzKCAtMC4wNSwgMC4wNSwgLTAuMDUgKSApO1xyXG4gICAgY29ubmVjdCggbmV3IFZlY3RvcjMoIC0wLjA1LCAtMC4wNSwgMC4wNSApLCBuZXcgVmVjdG9yMyggLTAuMDUsIC0wLjA1LCAtMC4wNSApICk7XHJcbiAgICBjb25uZWN0KCBuZXcgVmVjdG9yMyggMC4wNSwgLTAuMDUsIDAuMDUgKSwgbmV3IFZlY3RvcjMoIDAuMDUsIC0wLjA1LCAtMC4wNSApICk7XHJcblxyXG4gICAgY29ubmVjdCggbmV3IFZlY3RvcjMoIDAuMDUsIDAuMDUsIDAuMDUgKSwgbmV3IFZlY3RvcjMoIDAuMDUsIC0wLjA1LCAwLjA1ICkgKTtcclxuICAgIGNvbm5lY3QoIG5ldyBWZWN0b3IzKCAtMC4wNSwgMC4wNSwgMC4wNSApLCBuZXcgVmVjdG9yMyggLTAuMDUsIC0wLjA1LCAwLjA1ICkgKTtcclxuICAgIGNvbm5lY3QoIG5ldyBWZWN0b3IzKCAtMC4wNSwgMC4wNSwgLTAuMDUgKSwgbmV3IFZlY3RvcjMoIC0wLjA1LCAtMC4wNSwgLTAuMDUgKSApO1xyXG4gICAgY29ubmVjdCggbmV3IFZlY3RvcjMoIDAuMDUsIDAuMDUsIC0wLjA1ICksIG5ldyBWZWN0b3IzKCAwLjA1LCAtMC4wNSwgLTAuMDUgKSApO1xyXG5cclxuICAgIGNvbm5lY3QoIG5ldyBWZWN0b3IzKCAwLjA1LCAwLjA1LCAwLjA1ICksIG5ldyBWZWN0b3IzKCAtMC4wNSwgMC4wNSwgMC4wNSApICk7XHJcbiAgICBjb25uZWN0KCBuZXcgVmVjdG9yMyggMC4wNSwgLTAuMDUsIDAuMDUgKSwgbmV3IFZlY3RvcjMoIC0wLjA1LCAtMC4wNSwgMC4wNSApICk7XHJcbiAgICBjb25uZWN0KCBuZXcgVmVjdG9yMyggMC4wNSwgLTAuMDUsIC0wLjA1ICksIG5ldyBWZWN0b3IzKCAtMC4wNSwgLTAuMDUsIC0wLjA1ICkgKTtcclxuICAgIGNvbm5lY3QoIG5ldyBWZWN0b3IzKCAwLjA1LCAwLjA1LCAtMC4wNSApLCBuZXcgVmVjdG9yMyggLTAuMDUsIDAuMDUsIC0wLjA1ICkgKTtcclxuXHJcbiAgICByZXR1cm4gYm94O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhbiBpY29uIGZvciBzZWxlY3Rpb24sIGdpdmVuIGEgc2NlbmUgc2V0dXAgY2FsbGJhY2suXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0SWNvbiggem9vbTogbnVtYmVyLCBzZXR1cFNjZW5lOiAoIHNjZW5lOiBUSFJFRS5TY2VuZSApID0+IHZvaWQgKTogTm9kZSB7XHJcbiAgICBjb25zdCBzdGFnZSA9IG5ldyBUaHJlZVN0YWdlKCk7XHJcblxyXG4gICAgY29uc3QgYW1iaWVudExpZ2h0ID0gbmV3IFRIUkVFLkFtYmllbnRMaWdodCggMHgzMzMzMzMgKTtcclxuICAgIHN0YWdlLnRocmVlU2NlbmUuYWRkKCBhbWJpZW50TGlnaHQgKTtcclxuXHJcbiAgICBjb25zdCBzdW5MaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KCAweGZmZmZmZiwgMSApO1xyXG4gICAgc3VuTGlnaHQucG9zaXRpb24uc2V0KCAtMSwgMS41LCAwLjggKTtcclxuICAgIHN0YWdlLnRocmVlU2NlbmUuYWRkKCBzdW5MaWdodCApO1xyXG5cclxuICAgIGNvbnN0IG1vb25MaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KCAweGZmZmZmZiwgMC4yICk7XHJcbiAgICBtb29uTGlnaHQucG9zaXRpb24uc2V0KCAyLjAsIC0xLjAsIDEuMCApO1xyXG4gICAgc3RhZ2UudGhyZWVTY2VuZS5hZGQoIG1vb25MaWdodCApO1xyXG5cclxuICAgIHN0YWdlLnRocmVlQ2FtZXJhLnBvc2l0aW9uLmNvcHkoIFRocmVlVXRpbHMudmVjdG9yVG9UaHJlZSggbmV3IFZlY3RvcjMoIDAsIDAuMywgMSApICkgKTtcclxuICAgIHN0YWdlLnRocmVlQ2FtZXJhLnpvb20gPSB6b29tO1xyXG4gICAgc3RhZ2UudGhyZWVDYW1lcmEubG9va0F0KCBUaHJlZVV0aWxzLnZlY3RvclRvVGhyZWUoIG5ldyBWZWN0b3IzKCAwLCAtMC4wMDMsIDAgKSApICk7XHJcbiAgICBzdGFnZS50aHJlZUNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XHJcblxyXG4gICAgc2V0dXBTY2VuZSggc3RhZ2UudGhyZWVTY2VuZSApO1xyXG5cclxuICAgIHN0YWdlLnRocmVlQ2FtZXJhLmZvdiA9IDUwO1xyXG4gICAgc3RhZ2UudGhyZWVDYW1lcmEuYXNwZWN0ID0gMTtcclxuICAgIHN0YWdlLnNldERpbWVuc2lvbnMoIDI1NiwgMjU2ICk7XHJcbiAgICBzdGFnZS50aHJlZUNhbWVyYS5uZWFyID0gMC4wMztcclxuICAgIHN0YWdlLnRocmVlQ2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcclxuICAgIHN0YWdlLnJlbmRlciggdW5kZWZpbmVkICk7XHJcblxyXG4gICAgY29uc3QgY2FudmFzID0gc3RhZ2UucmVuZGVyVG9DYW52YXMoIDMgKTtcclxuXHJcbiAgICBzdGFnZS5kaXNwb3NlKCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coIGNhbnZhcy50b0RhdGFVUkwoKSApO1xyXG5cclxuICAgIGNvbnN0IGltYWdlID0gbmV3IEltYWdlKCBjYW52YXMudG9EYXRhVVJMKCksIHtcclxuICAgICAgbWlwbWFwOiB0cnVlLFxyXG4gICAgICBpbml0aWFsV2lkdGg6IGNhbnZhcy53aWR0aCxcclxuICAgICAgaW5pdGlhbEhlaWdodDogY2FudmFzLmhlaWdodFxyXG4gICAgfSApO1xyXG4gICAgaW1hZ2Uuc2V0U2NhbGVNYWduaXR1ZGUoIDAuMiwgLTAuMiApO1xyXG4gICAgcmV0dXJuIGltYWdlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhbiBpY29uIHRoYXQgc2hvd3MgYSBzaW5nbGUgY3Vib2lkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0U2luZ2xlQ3Vib2lkSWNvbigpOiBOb2RlIHtcclxuICAgIGlmICggRGVuc2l0eUJ1b3lhbmN5Q29tbW9uUXVlcnlQYXJhbWV0ZXJzLmdlbmVyYXRlSWNvbkltYWdlcyApIHtcclxuICAgICAgcmV0dXJuIEJsb2Nrc1JhZGlvQnV0dG9uR3JvdXAuZ2V0SWNvbiggNS41LCBzY2VuZSA9PiB7XHJcbiAgICAgICAgc2NlbmUuYWRkKCBCbG9ja3NSYWRpb0J1dHRvbkdyb3VwLmNyZWF0ZUJveCggYU1hdGVyaWFsLCBuZXcgVmVjdG9yMyggMCwgMCwgMCApICkgKTtcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHJldHVybiBuZXcgSW1hZ2UoIHNpbmdsZUN1Ym9pZEljb25fcG5nLCB7IHNjYWxlOiAwLjIgfSApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhbiBpY29uIHRoYXQgc2hvd3MgYSBzaW5nbGUgY3Vib2lkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0RG91YmxlQ3Vib2lkSWNvbigpOiBOb2RlIHtcclxuICAgIGlmICggRGVuc2l0eUJ1b3lhbmN5Q29tbW9uUXVlcnlQYXJhbWV0ZXJzLmdlbmVyYXRlSWNvbkltYWdlcyApIHtcclxuICAgICAgcmV0dXJuIEJsb2Nrc1JhZGlvQnV0dG9uR3JvdXAuZ2V0SWNvbiggNCwgc2NlbmUgPT4ge1xyXG4gICAgICAgIHNjZW5lLmFkZCggQmxvY2tzUmFkaW9CdXR0b25Hcm91cC5jcmVhdGVCb3goIGFNYXRlcmlhbCwgbmV3IFZlY3RvcjMoIC0wLjAzOSwgMC4wMTUsIC0wLjA3ICkgKSApO1xyXG4gICAgICAgIHNjZW5lLmFkZCggQmxvY2tzUmFkaW9CdXR0b25Hcm91cC5jcmVhdGVCb3goIGJNYXRlcmlhbCwgbmV3IFZlY3RvcjMoIDAuMDMsIC0wLjAwNSwgMC4wNyApICkgKTtcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHJldHVybiBuZXcgSW1hZ2UoIGRvdWJsZUN1Ym9pZEljb25fcG5nLCB7IHNjYWxlOiAwLjIgfSApO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZGVuc2l0eUJ1b3lhbmN5Q29tbW9uLnJlZ2lzdGVyKCAnQmxvY2tzUmFkaW9CdXR0b25Hcm91cCcsIEJsb2Nrc1JhZGlvQnV0dG9uR3JvdXAgKTtcclxuIl0s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QUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSyxDQUFDLEVBQUUsSUFBSUEsT0FBTyxDQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSyxDQUFFLENBQUM7SUFDaEYrQyxPQUFPLENBQUUsSUFBSS9DLE9BQU8sQ0FBRSxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSyxDQUFDLEVBQUUsSUFBSUEsT0FBTyxDQUFFLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUssQ0FBRSxDQUFDO0lBRTlFK0MsT0FBTyxDQUFFLElBQUkvQyxPQUFPLENBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFLLENBQUMsRUFBRSxJQUFJQSxPQUFPLENBQUUsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLElBQUssQ0FBRSxDQUFDO0lBQzVFK0MsT0FBTyxDQUFFLElBQUkvQyxPQUFPLENBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUssQ0FBQyxFQUFFLElBQUlBLE9BQU8sQ0FBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxJQUFLLENBQUUsQ0FBQztJQUM5RStDLE9BQU8sQ0FBRSxJQUFJL0MsT0FBTyxDQUFFLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDLElBQUssQ0FBQyxFQUFFLElBQUlBLE9BQU8sQ0FBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUssQ0FBRSxDQUFDO0lBQ2hGK0MsT0FBTyxDQUFFLElBQUkvQyxPQUFPLENBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDLElBQUssQ0FBQyxFQUFFLElBQUlBLE9BQU8sQ0FBRSxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFLLENBQUUsQ0FBQztJQUU5RStDLE9BQU8sQ0FBRSxJQUFJL0MsT0FBTyxDQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSyxDQUFDLEVBQUUsSUFBSUEsT0FBTyxDQUFFLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFLLENBQUUsQ0FBQztJQUM1RStDLE9BQU8sQ0FBRSxJQUFJL0MsT0FBTyxDQUFFLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxJQUFLLENBQUMsRUFBRSxJQUFJQSxPQUFPLENBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSyxDQUFFLENBQUM7SUFDOUUrQyxPQUFPLENBQUUsSUFBSS9DLE9BQU8sQ0FBRSxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFLLENBQUMsRUFBRSxJQUFJQSxPQUFPLENBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFLLENBQUUsQ0FBQztJQUNoRitDLE9BQU8sQ0FBRSxJQUFJL0MsT0FBTyxDQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxJQUFLLENBQUMsRUFBRSxJQUFJQSxPQUFPLENBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsSUFBSyxDQUFFLENBQUM7SUFFOUUsT0FBTzJDLEdBQUc7RUFDWjs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxPQUFlcUIsT0FBT0EsQ0FBRUMsSUFBWSxFQUFFQyxVQUEwQyxFQUFTO0lBQ3ZGLE1BQU1DLEtBQUssR0FBRyxJQUFJbEUsVUFBVSxDQUFDLENBQUM7SUFFOUIsTUFBTW1FLFlBQVksR0FBRyxJQUFJdkQsS0FBSyxDQUFDd0QsWUFBWSxDQUFFLFFBQVMsQ0FBQztJQUN2REYsS0FBSyxDQUFDRyxVQUFVLENBQUNQLEdBQUcsQ0FBRUssWUFBYSxDQUFDO0lBRXBDLE1BQU1HLFFBQVEsR0FBRyxJQUFJMUQsS0FBSyxDQUFDMkQsZ0JBQWdCLENBQUUsUUFBUSxFQUFFLENBQUUsQ0FBQztJQUMxREQsUUFBUSxDQUFDL0IsUUFBUSxDQUFDaUMsR0FBRyxDQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFJLENBQUM7SUFDckNOLEtBQUssQ0FBQ0csVUFBVSxDQUFDUCxHQUFHLENBQUVRLFFBQVMsQ0FBQztJQUVoQyxNQUFNRyxTQUFTLEdBQUcsSUFBSTdELEtBQUssQ0FBQzJELGdCQUFnQixDQUFFLFFBQVEsRUFBRSxHQUFJLENBQUM7SUFDN0RFLFNBQVMsQ0FBQ2xDLFFBQVEsQ0FBQ2lDLEdBQUcsQ0FBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBSSxDQUFDO0lBQ3hDTixLQUFLLENBQUNHLFVBQVUsQ0FBQ1AsR0FBRyxDQUFFVyxTQUFVLENBQUM7SUFFakNQLEtBQUssQ0FBQ1EsV0FBVyxDQUFDbkMsUUFBUSxDQUFDSyxJQUFJLENBQUUzQyxVQUFVLENBQUM0QyxhQUFhLENBQUUsSUFBSTlDLE9BQU8sQ0FBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUUsQ0FBRSxDQUFFLENBQUM7SUFDdkZtRSxLQUFLLENBQUNRLFdBQVcsQ0FBQ1YsSUFBSSxHQUFHQSxJQUFJO0lBQzdCRSxLQUFLLENBQUNRLFdBQVcsQ0FBQ0MsTUFBTSxDQUFFMUUsVUFBVSxDQUFDNEMsYUFBYSxDQUFFLElBQUk5QyxPQUFPLENBQUUsQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLENBQUUsQ0FBRSxDQUFFLENBQUM7SUFDbkZtRSxLQUFLLENBQUNRLFdBQVcsQ0FBQ0Usc0JBQXNCLENBQUMsQ0FBQztJQUUxQ1gsVUFBVSxDQUFFQyxLQUFLLENBQUNHLFVBQVcsQ0FBQztJQUU5QkgsS0FBSyxDQUFDUSxXQUFXLENBQUNHLEdBQUcsR0FBRyxFQUFFO0lBQzFCWCxLQUFLLENBQUNRLFdBQVcsQ0FBQ0ksTUFBTSxHQUFHLENBQUM7SUFDNUJaLEtBQUssQ0FBQ2EsYUFBYSxDQUFFLEdBQUcsRUFBRSxHQUFJLENBQUM7SUFDL0JiLEtBQUssQ0FBQ1EsV0FBVyxDQUFDTSxJQUFJLEdBQUcsSUFBSTtJQUM3QmQsS0FBSyxDQUFDUSxXQUFXLENBQUNFLHNCQUFzQixDQUFDLENBQUM7SUFDMUNWLEtBQUssQ0FBQ2UsTUFBTSxDQUFFQyxTQUFVLENBQUM7SUFFekIsTUFBTUMsTUFBTSxHQUFHakIsS0FBSyxDQUFDa0IsY0FBYyxDQUFFLENBQUUsQ0FBQztJQUV4Q2xCLEtBQUssQ0FBQ21CLE9BQU8sQ0FBQyxDQUFDO0lBRWZDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFFSixNQUFNLENBQUNLLFNBQVMsQ0FBQyxDQUFFLENBQUM7SUFFakMsTUFBTUMsS0FBSyxHQUFHLElBQUl0RixLQUFLLENBQUVnRixNQUFNLENBQUNLLFNBQVMsQ0FBQyxDQUFDLEVBQUU7TUFDM0NFLE1BQU0sRUFBRSxJQUFJO01BQ1pDLFlBQVksRUFBRVIsTUFBTSxDQUFDUyxLQUFLO01BQzFCQyxhQUFhLEVBQUVWLE1BQU0sQ0FBQ1c7SUFDeEIsQ0FBRSxDQUFDO0lBQ0hMLEtBQUssQ0FBQ00saUJBQWlCLENBQUUsR0FBRyxFQUFFLENBQUMsR0FBSSxDQUFDO0lBQ3BDLE9BQU9OLEtBQUs7RUFDZDs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxPQUFjN0QsbUJBQW1CQSxDQUFBLEVBQVM7SUFDeEMsSUFBS3BCLG9DQUFvQyxDQUFDd0Ysa0JBQWtCLEVBQUc7TUFDN0QsT0FBTzNFLHNCQUFzQixDQUFDMEMsT0FBTyxDQUFFLEdBQUcsRUFBRWtDLEtBQUssSUFBSTtRQUNuREEsS0FBSyxDQUFDbkMsR0FBRyxDQUFFekMsc0JBQXNCLENBQUNnQixTQUFTLENBQUUxQixTQUFTLEVBQUUsSUFBSVosT0FBTyxDQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBRSxDQUFFLENBQUUsQ0FBQztNQUNwRixDQUFFLENBQUM7SUFDTCxDQUFDLE1BQ0k7TUFDSCxPQUFPLElBQUlJLEtBQUssQ0FBRUcsb0JBQW9CLEVBQUU7UUFBRTRGLEtBQUssRUFBRTtNQUFJLENBQUUsQ0FBQztJQUMxRDtFQUNGOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE9BQWNuRSxtQkFBbUJBLENBQUEsRUFBUztJQUN4QyxJQUFLdkIsb0NBQW9DLENBQUN3RixrQkFBa0IsRUFBRztNQUM3RCxPQUFPM0Usc0JBQXNCLENBQUMwQyxPQUFPLENBQUUsQ0FBQyxFQUFFa0MsS0FBSyxJQUFJO1FBQ2pEQSxLQUFLLENBQUNuQyxHQUFHLENBQUV6QyxzQkFBc0IsQ0FBQ2dCLFNBQVMsQ0FBRTFCLFNBQVMsRUFBRSxJQUFJWixPQUFPLENBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUMsSUFBSyxDQUFFLENBQUUsQ0FBQztRQUMvRmtHLEtBQUssQ0FBQ25DLEdBQUcsQ0FBRXpDLHNCQUFzQixDQUFDZ0IsU0FBUyxDQUFFdkIsU0FBUyxFQUFFLElBQUlmLE9BQU8sQ0FBRSxJQUFJLEVBQUUsQ0FBQyxLQUFLLEVBQUUsSUFBSyxDQUFFLENBQUUsQ0FBQztNQUMvRixDQUFFLENBQUM7SUFDTCxDQUFDLE1BQ0k7TUFDSCxPQUFPLElBQUlJLEtBQUssQ0FBRUUsb0JBQW9CLEVBQUU7UUFBRTZGLEtBQUssRUFBRTtNQUFJLENBQUUsQ0FBQztJQUMxRDtFQUNGO0FBQ0Y7QUFFQTNGLHFCQUFxQixDQUFDNEYsUUFBUSxDQUFFLHdCQUF3QixFQUFFOUUsc0JBQXVCLENBQUMifQ==