// Copyright 2019-2022, University of Colorado Boulder

/**
 * The base type for 3D views of any type of mass.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Property from '../../../../axon/js/Property.js';
import Vector3 from '../../../../dot/js/Vector3.js';
import TextureQuad from '../../../../mobius/js/TextureQuad.js';
import densityBuoyancyCommon from '../../densityBuoyancyCommon.js';
import { MassTag } from '../model/Mass.js';
import DensityMaterials from './DensityMaterials.js';
import MassLabelNode from './MassLabelNode.js';
const TAG_SIZE = 0.03;
export const TAG_OFFSET = 0.005;
const TAG_SCALE = 0.0005;
export default class MassView extends THREE.Mesh {
  tagHeight = null;
  tagOffsetProperty = new Property(Vector3.ZERO);
  constructor(mass, initialGeometry) {
    const materialView = DensityMaterials.getMaterialView(mass.materialProperty.value);
    super(initialGeometry, materialView.material);
    this.mass = mass;
    this.materialView = materialView;
    this.material = materialView.material;
    this.materialListener = material => {
      this.materialView.dispose();
      this.materialView = DensityMaterials.getMaterialView(material);
      this.material = this.materialView.material;
    };
    this.mass.materialProperty.lazyLink(this.materialListener);
    this.positionListener = () => {
      const position = mass.matrix.translation;

      // LHS is NOT a Vector2, don't try to simplify this
      this.position.x = position.x;
      this.position.y = position.y;
    };
    this.mass.transformedEmitter.addListener(this.positionListener);
    this.positionListener();
    this.tagNodeTexture = null;
    this.tagMesh = null;
    if (mass.tag === MassTag.PRIMARY) {
      this.tagNodeTexture = MassLabelNode.getPrimaryTexture();
      this.tagMesh = new TextureQuad(this.tagNodeTexture, TAG_SIZE, TAG_SIZE, {
        depthTest: true
      });
      this.tagHeight = TAG_SIZE;
    } else if (mass.tag === MassTag.SECONDARY) {
      this.tagNodeTexture = MassLabelNode.getSecondaryTexture();
      this.tagMesh = new TextureQuad(this.tagNodeTexture, TAG_SIZE, TAG_SIZE, {
        depthTest: true
      });
      this.tagHeight = TAG_SIZE;
    } else if (mass.tag !== MassTag.NONE) {
      const string = mass.nameProperty.value;
      this.tagNodeTexture = MassLabelNode.getBasicLabelTexture(string);
      this.tagMesh = new TextureQuad(this.tagNodeTexture, TAG_SCALE * this.tagNodeTexture._width, TAG_SCALE * this.tagNodeTexture._height, {
        depthTest: true
      });
      this.tagHeight = TAG_SCALE * this.tagNodeTexture._height;
      this.massNameListener = string => {
        this.tagNodeTexture.dispose();
        this.tagNodeTexture = MassLabelNode.getBasicLabelTexture(string);
        this.tagMesh.updateTexture(this.tagNodeTexture, TAG_SCALE * this.tagNodeTexture._width, TAG_SCALE * this.tagNodeTexture._height);
        this.tagMesh.visible = string !== '';
      };
      this.mass.nameProperty.lazyLink(this.massNameListener);
    }
    if (this.tagMesh) {
      this.add(this.tagMesh);
      this.tagMesh.renderOrder = 1;
      this.tagOffsetProperty.link(offset => {
        this.tagMesh.position.set(offset.x, offset.y, offset.z + 0.0001);
      });
    }
  }

  /**
   * Releases references.
   */
  dispose() {
    this.mass.transformedEmitter.removeListener(this.positionListener);
    this.mass.materialProperty.unlink(this.materialListener);
    this.materialView.dispose();
    if (this.massNameListener) {
      this.mass.nameProperty.unlink(this.massNameListener);
    }
    this.tagNodeTexture && this.tagNodeTexture.dispose();
    this.tagMesh && this.tagMesh.dispose();

    // @ts-expect-error
    super.dispose && super.dispose();
  }
}
densityBuoyancyCommon.register('MassView', MassView);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIlZlY3RvcjMiLCJUZXh0dXJlUXVhZCIsImRlbnNpdHlCdW95YW5jeUNvbW1vbiIsIk1hc3NUYWciLCJEZW5zaXR5TWF0ZXJpYWxzIiwiTWFzc0xhYmVsTm9kZSIsIlRBR19TSVpFIiwiVEFHX09GRlNFVCIsIlRBR19TQ0FMRSIsIk1hc3NWaWV3IiwiVEhSRUUiLCJNZXNoIiwidGFnSGVpZ2h0IiwidGFnT2Zmc2V0UHJvcGVydHkiLCJaRVJPIiwiY29uc3RydWN0b3IiLCJtYXNzIiwiaW5pdGlhbEdlb21ldHJ5IiwibWF0ZXJpYWxWaWV3IiwiZ2V0TWF0ZXJpYWxWaWV3IiwibWF0ZXJpYWxQcm9wZXJ0eSIsInZhbHVlIiwibWF0ZXJpYWwiLCJtYXRlcmlhbExpc3RlbmVyIiwiZGlzcG9zZSIsImxhenlMaW5rIiwicG9zaXRpb25MaXN0ZW5lciIsInBvc2l0aW9uIiwibWF0cml4IiwidHJhbnNsYXRpb24iLCJ4IiwieSIsInRyYW5zZm9ybWVkRW1pdHRlciIsImFkZExpc3RlbmVyIiwidGFnTm9kZVRleHR1cmUiLCJ0YWdNZXNoIiwidGFnIiwiUFJJTUFSWSIsImdldFByaW1hcnlUZXh0dXJlIiwiZGVwdGhUZXN0IiwiU0VDT05EQVJZIiwiZ2V0U2Vjb25kYXJ5VGV4dHVyZSIsIk5PTkUiLCJzdHJpbmciLCJuYW1lUHJvcGVydHkiLCJnZXRCYXNpY0xhYmVsVGV4dHVyZSIsIl93aWR0aCIsIl9oZWlnaHQiLCJtYXNzTmFtZUxpc3RlbmVyIiwidXBkYXRlVGV4dHVyZSIsInZpc2libGUiLCJhZGQiLCJyZW5kZXJPcmRlciIsImxpbmsiLCJvZmZzZXQiLCJzZXQiLCJ6IiwicmVtb3ZlTGlzdGVuZXIiLCJ1bmxpbmsiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIk1hc3NWaWV3LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE5LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFRoZSBiYXNlIHR5cGUgZm9yIDNEIHZpZXdzIG9mIGFueSB0eXBlIG9mIG1hc3MuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBWZWN0b3IzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IzLmpzJztcclxuaW1wb3J0IE5vZGVUZXh0dXJlIGZyb20gJy4uLy4uLy4uLy4uL21vYml1cy9qcy9Ob2RlVGV4dHVyZS5qcyc7XHJcbmltcG9ydCBUZXh0dXJlUXVhZCBmcm9tICcuLi8uLi8uLi8uLi9tb2JpdXMvanMvVGV4dHVyZVF1YWQuanMnO1xyXG5pbXBvcnQgZGVuc2l0eUJ1b3lhbmN5Q29tbW9uIGZyb20gJy4uLy4uL2RlbnNpdHlCdW95YW5jeUNvbW1vbi5qcyc7XHJcbmltcG9ydCBNYXNzLCB7IE1hc3NUYWcgfSBmcm9tICcuLi9tb2RlbC9NYXNzLmpzJztcclxuaW1wb3J0IE1hdGVyaWFsIGZyb20gJy4uL21vZGVsL01hdGVyaWFsLmpzJztcclxuaW1wb3J0IERlbnNpdHlNYXRlcmlhbHMgZnJvbSAnLi9EZW5zaXR5TWF0ZXJpYWxzLmpzJztcclxuaW1wb3J0IE1hc3NMYWJlbE5vZGUgZnJvbSAnLi9NYXNzTGFiZWxOb2RlLmpzJztcclxuaW1wb3J0IE1hdGVyaWFsVmlldyBmcm9tICcuL01hdGVyaWFsVmlldy5qcyc7XHJcblxyXG5jb25zdCBUQUdfU0laRSA9IDAuMDM7XHJcbmV4cG9ydCBjb25zdCBUQUdfT0ZGU0VUID0gMC4wMDU7XHJcbmNvbnN0IFRBR19TQ0FMRSA9IDAuMDAwNTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFic3RyYWN0IGNsYXNzIE1hc3NWaWV3IGV4dGVuZHMgVEhSRUUuTWVzaCB7XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBtYXNzOiBNYXNzO1xyXG4gIHB1YmxpYyBtYXRlcmlhbFZpZXc6IE1hdGVyaWFsVmlldztcclxuICBwcml2YXRlIHJlYWRvbmx5IG1hdGVyaWFsTGlzdGVuZXI6ICggbWF0ZXJpYWw6IE1hdGVyaWFsICkgPT4gdm9pZDtcclxuICBwcml2YXRlIHJlYWRvbmx5IHBvc2l0aW9uTGlzdGVuZXI6ICgpID0+IHZvaWQ7XHJcblxyXG4gIHByaXZhdGUgdGFnTm9kZVRleHR1cmU6IE5vZGVUZXh0dXJlIHwgbnVsbDtcclxuICBwcml2YXRlIHJlYWRvbmx5IHRhZ01lc2g6IFRleHR1cmVRdWFkIHwgbnVsbDtcclxuICBwcml2YXRlIHJlYWRvbmx5IG1hc3NOYW1lTGlzdGVuZXI/OiAoIHN0cmluZzogc3RyaW5nICkgPT4gdm9pZDtcclxuXHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHRhZ0hlaWdodDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHRhZ09mZnNldFByb3BlcnR5OiBQcm9wZXJ0eTxWZWN0b3IzPiA9IG5ldyBQcm9wZXJ0eTxWZWN0b3IzPiggVmVjdG9yMy5aRVJPICk7XHJcblxyXG4gIHByb3RlY3RlZCBjb25zdHJ1Y3RvciggbWFzczogTWFzcywgaW5pdGlhbEdlb21ldHJ5OiBUSFJFRS5CdWZmZXJHZW9tZXRyeSApIHtcclxuICAgIGNvbnN0IG1hdGVyaWFsVmlldyA9IERlbnNpdHlNYXRlcmlhbHMuZ2V0TWF0ZXJpYWxWaWV3KCBtYXNzLm1hdGVyaWFsUHJvcGVydHkudmFsdWUgKTtcclxuXHJcbiAgICBzdXBlciggaW5pdGlhbEdlb21ldHJ5LCBtYXRlcmlhbFZpZXcubWF0ZXJpYWwgKTtcclxuXHJcbiAgICB0aGlzLm1hc3MgPSBtYXNzO1xyXG4gICAgdGhpcy5tYXRlcmlhbFZpZXcgPSBtYXRlcmlhbFZpZXc7XHJcblxyXG4gICAgdGhpcy5tYXRlcmlhbCA9IG1hdGVyaWFsVmlldy5tYXRlcmlhbDtcclxuXHJcbiAgICB0aGlzLm1hdGVyaWFsTGlzdGVuZXIgPSBtYXRlcmlhbCA9PiB7XHJcbiAgICAgIHRoaXMubWF0ZXJpYWxWaWV3LmRpc3Bvc2UoKTtcclxuICAgICAgdGhpcy5tYXRlcmlhbFZpZXcgPSBEZW5zaXR5TWF0ZXJpYWxzLmdldE1hdGVyaWFsVmlldyggbWF0ZXJpYWwgKTtcclxuICAgICAgdGhpcy5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWxWaWV3Lm1hdGVyaWFsO1xyXG4gICAgfTtcclxuICAgIHRoaXMubWFzcy5tYXRlcmlhbFByb3BlcnR5LmxhenlMaW5rKCB0aGlzLm1hdGVyaWFsTGlzdGVuZXIgKTtcclxuXHJcbiAgICB0aGlzLnBvc2l0aW9uTGlzdGVuZXIgPSAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHBvc2l0aW9uID0gbWFzcy5tYXRyaXgudHJhbnNsYXRpb247XHJcblxyXG4gICAgICAvLyBMSFMgaXMgTk9UIGEgVmVjdG9yMiwgZG9uJ3QgdHJ5IHRvIHNpbXBsaWZ5IHRoaXNcclxuICAgICAgdGhpcy5wb3NpdGlvbi54ID0gcG9zaXRpb24ueDtcclxuICAgICAgdGhpcy5wb3NpdGlvbi55ID0gcG9zaXRpb24ueTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5tYXNzLnRyYW5zZm9ybWVkRW1pdHRlci5hZGRMaXN0ZW5lciggdGhpcy5wb3NpdGlvbkxpc3RlbmVyICk7XHJcbiAgICB0aGlzLnBvc2l0aW9uTGlzdGVuZXIoKTtcclxuXHJcbiAgICB0aGlzLnRhZ05vZGVUZXh0dXJlID0gbnVsbDtcclxuICAgIHRoaXMudGFnTWVzaCA9IG51bGw7XHJcblxyXG4gICAgaWYgKCBtYXNzLnRhZyA9PT0gTWFzc1RhZy5QUklNQVJZICkge1xyXG4gICAgICB0aGlzLnRhZ05vZGVUZXh0dXJlID0gTWFzc0xhYmVsTm9kZS5nZXRQcmltYXJ5VGV4dHVyZSgpO1xyXG4gICAgICB0aGlzLnRhZ01lc2ggPSBuZXcgVGV4dHVyZVF1YWQoIHRoaXMudGFnTm9kZVRleHR1cmUsIFRBR19TSVpFLCBUQUdfU0laRSwge1xyXG4gICAgICAgIGRlcHRoVGVzdDogdHJ1ZVxyXG4gICAgICB9ICk7XHJcbiAgICAgIHRoaXMudGFnSGVpZ2h0ID0gVEFHX1NJWkU7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggbWFzcy50YWcgPT09IE1hc3NUYWcuU0VDT05EQVJZICkge1xyXG4gICAgICB0aGlzLnRhZ05vZGVUZXh0dXJlID0gTWFzc0xhYmVsTm9kZS5nZXRTZWNvbmRhcnlUZXh0dXJlKCk7XHJcbiAgICAgIHRoaXMudGFnTWVzaCA9IG5ldyBUZXh0dXJlUXVhZCggdGhpcy50YWdOb2RlVGV4dHVyZSwgVEFHX1NJWkUsIFRBR19TSVpFLCB7XHJcbiAgICAgICAgZGVwdGhUZXN0OiB0cnVlXHJcbiAgICAgIH0gKTtcclxuICAgICAgdGhpcy50YWdIZWlnaHQgPSBUQUdfU0laRTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBtYXNzLnRhZyAhPT0gTWFzc1RhZy5OT05FICkge1xyXG5cclxuICAgICAgY29uc3Qgc3RyaW5nID0gbWFzcy5uYW1lUHJvcGVydHkudmFsdWU7XHJcbiAgICAgIHRoaXMudGFnTm9kZVRleHR1cmUgPSBNYXNzTGFiZWxOb2RlLmdldEJhc2ljTGFiZWxUZXh0dXJlKCBzdHJpbmcgKTtcclxuXHJcbiAgICAgIHRoaXMudGFnTWVzaCA9IG5ldyBUZXh0dXJlUXVhZCggdGhpcy50YWdOb2RlVGV4dHVyZSwgVEFHX1NDQUxFICogdGhpcy50YWdOb2RlVGV4dHVyZS5fd2lkdGgsIFRBR19TQ0FMRSAqIHRoaXMudGFnTm9kZVRleHR1cmUuX2hlaWdodCwge1xyXG4gICAgICAgIGRlcHRoVGVzdDogdHJ1ZVxyXG4gICAgICB9ICk7XHJcbiAgICAgIHRoaXMudGFnSGVpZ2h0ID0gVEFHX1NDQUxFICogdGhpcy50YWdOb2RlVGV4dHVyZS5faGVpZ2h0O1xyXG5cclxuICAgICAgdGhpcy5tYXNzTmFtZUxpc3RlbmVyID0gc3RyaW5nID0+IHtcclxuICAgICAgICB0aGlzLnRhZ05vZGVUZXh0dXJlIS5kaXNwb3NlKCk7XHJcbiAgICAgICAgdGhpcy50YWdOb2RlVGV4dHVyZSA9IE1hc3NMYWJlbE5vZGUuZ2V0QmFzaWNMYWJlbFRleHR1cmUoIHN0cmluZyApO1xyXG4gICAgICAgIHRoaXMudGFnTWVzaCEudXBkYXRlVGV4dHVyZSggdGhpcy50YWdOb2RlVGV4dHVyZSwgVEFHX1NDQUxFICogdGhpcy50YWdOb2RlVGV4dHVyZS5fd2lkdGgsIFRBR19TQ0FMRSAqIHRoaXMudGFnTm9kZVRleHR1cmUuX2hlaWdodCApO1xyXG4gICAgICAgIHRoaXMudGFnTWVzaCEudmlzaWJsZSA9IHN0cmluZyAhPT0gJyc7XHJcbiAgICAgIH07XHJcbiAgICAgIHRoaXMubWFzcy5uYW1lUHJvcGVydHkubGF6eUxpbmsoIHRoaXMubWFzc05hbWVMaXN0ZW5lciApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggdGhpcy50YWdNZXNoICkge1xyXG4gICAgICB0aGlzLmFkZCggdGhpcy50YWdNZXNoICk7XHJcbiAgICAgIHRoaXMudGFnTWVzaC5yZW5kZXJPcmRlciA9IDE7XHJcblxyXG4gICAgICB0aGlzLnRhZ09mZnNldFByb3BlcnR5LmxpbmsoIG9mZnNldCA9PiB7XHJcbiAgICAgICAgdGhpcy50YWdNZXNoIS5wb3NpdGlvbi5zZXQoIG9mZnNldC54LCBvZmZzZXQueSwgb2Zmc2V0LnogKyAwLjAwMDEgKTtcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVsZWFzZXMgcmVmZXJlbmNlcy5cclxuICAgKi9cclxuICBwdWJsaWMgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMubWFzcy50cmFuc2Zvcm1lZEVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoIHRoaXMucG9zaXRpb25MaXN0ZW5lciApO1xyXG4gICAgdGhpcy5tYXNzLm1hdGVyaWFsUHJvcGVydHkudW5saW5rKCB0aGlzLm1hdGVyaWFsTGlzdGVuZXIgKTtcclxuXHJcbiAgICB0aGlzLm1hdGVyaWFsVmlldy5kaXNwb3NlKCk7XHJcblxyXG4gICAgaWYgKCB0aGlzLm1hc3NOYW1lTGlzdGVuZXIgKSB7XHJcbiAgICAgIHRoaXMubWFzcy5uYW1lUHJvcGVydHkudW5saW5rKCB0aGlzLm1hc3NOYW1lTGlzdGVuZXIgKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnRhZ05vZGVUZXh0dXJlICYmIHRoaXMudGFnTm9kZVRleHR1cmUuZGlzcG9zZSgpO1xyXG4gICAgdGhpcy50YWdNZXNoICYmIHRoaXMudGFnTWVzaC5kaXNwb3NlKCk7XHJcblxyXG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvclxyXG4gICAgc3VwZXIuZGlzcG9zZSAmJiBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5kZW5zaXR5QnVveWFuY3lDb21tb24ucmVnaXN0ZXIoICdNYXNzVmlldycsIE1hc3NWaWV3ICk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxRQUFRLE1BQU0saUNBQWlDO0FBQ3RELE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFFbkQsT0FBT0MsV0FBVyxNQUFNLHNDQUFzQztBQUM5RCxPQUFPQyxxQkFBcUIsTUFBTSxnQ0FBZ0M7QUFDbEUsU0FBZUMsT0FBTyxRQUFRLGtCQUFrQjtBQUVoRCxPQUFPQyxnQkFBZ0IsTUFBTSx1QkFBdUI7QUFDcEQsT0FBT0MsYUFBYSxNQUFNLG9CQUFvQjtBQUc5QyxNQUFNQyxRQUFRLEdBQUcsSUFBSTtBQUNyQixPQUFPLE1BQU1DLFVBQVUsR0FBRyxLQUFLO0FBQy9CLE1BQU1DLFNBQVMsR0FBRyxNQUFNO0FBRXhCLGVBQWUsTUFBZUMsUUFBUSxTQUFTQyxLQUFLLENBQUNDLElBQUksQ0FBQztFQVdyQ0MsU0FBUyxHQUFrQixJQUFJO0VBQy9CQyxpQkFBaUIsR0FBc0IsSUFBSWQsUUFBUSxDQUFXQyxPQUFPLENBQUNjLElBQUssQ0FBQztFQUVyRkMsV0FBV0EsQ0FBRUMsSUFBVSxFQUFFQyxlQUFxQyxFQUFHO0lBQ3pFLE1BQU1DLFlBQVksR0FBR2QsZ0JBQWdCLENBQUNl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