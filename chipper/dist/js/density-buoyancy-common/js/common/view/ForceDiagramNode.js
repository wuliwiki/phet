// Copyright 2019-2023, University of Colorado Boulder

/**
 * Shows a force diagram for an individual mass.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Utils from '../../../../dot/js/Utils.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import ArrowNode from '../../../../scenery-phet/js/ArrowNode.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Line, Node, Text } from '../../../../scenery/js/imports.js';
import Panel from '../../../../sun/js/Panel.js';
import densityBuoyancyCommon from '../../densityBuoyancyCommon.js';
import DensityBuoyancyCommonStrings from '../../DensityBuoyancyCommonStrings.js';
import DensityBuoyancyCommonColors from './DensityBuoyancyCommonColors.js';
import { combineOptions } from '../../../../phet-core/js/optionize.js';
// constants
const arrowOptions = {
  stroke: null,
  tailWidth: 4,
  headWidth: 15,
  headHeight: 12
};
const arrowSpacing = arrowOptions.headWidth + 3;
const labelFont = new PhetFont({
  size: 12,
  weight: 'bold'
});
export default class ForceDiagramNode extends Node {
  constructor(mass, showGravityForceProperty, showBuoyancyForceProperty, showContactForceProperty, showForceValuesProperty, forceScaleProperty) {
    super();
    this.mass = mass;
    this.showGravityForceProperty = showGravityForceProperty;
    this.showBuoyancyForceProperty = showBuoyancyForceProperty;
    this.showContactForceProperty = showContactForceProperty;
    this.showForceValuesProperty = showForceValuesProperty;
    this.forceScaleProperty = forceScaleProperty;
    this.gravityArrowNode = new ArrowNode(0, 0, 0, 0, combineOptions({
      fill: DensityBuoyancyCommonColors.gravityForceProperty
    }, arrowOptions));
    this.buoyancyArrowNode = new ArrowNode(0, 0, 0, 0, combineOptions({
      fill: DensityBuoyancyCommonColors.buoyancyForceProperty
    }, arrowOptions));
    this.contactArrowNode = new ArrowNode(0, 0, 0, 0, combineOptions({
      fill: DensityBuoyancyCommonColors.contactForceProperty
    }, arrowOptions));
    this.gravityLabelText = new Text('', {
      font: labelFont,
      fill: DensityBuoyancyCommonColors.gravityForceProperty,
      maxWidth: 200
    });
    this.buoyancyLabelText = new Text('', {
      font: labelFont,
      fill: DensityBuoyancyCommonColors.buoyancyForceProperty,
      maxWidth: 200
    });
    this.contactLabelText = new Text('', {
      font: labelFont,
      fill: DensityBuoyancyCommonColors.contactForceProperty,
      maxWidth: 200
    });
    const panelOptions = {
      stroke: null,
      fill: DensityBuoyancyCommonColors.massLabelBackgroundProperty,
      cornerRadius: 0,
      xMargin: 2,
      yMargin: 1
    };
    this.gravityLabelNode = new Panel(this.gravityLabelText, panelOptions);
    this.buoyancyLabelNode = new Panel(this.buoyancyLabelText, panelOptions);
    this.contactLabelNode = new Panel(this.contactLabelText, panelOptions);
    this.arrowMap = new Map();
    this.arrowMap.set(this.gravityArrowNode, this.gravityLabelNode);
    this.arrowMap.set(this.buoyancyArrowNode, this.buoyancyLabelNode);
    this.arrowMap.set(this.contactArrowNode, this.contactLabelNode);
    this.axisNode = new Line({
      stroke: 'black'
    });
    const newtonsPatternProperty = DensityBuoyancyCommonStrings.newtonsPatternStringProperty;
    newtonsPatternProperty.lazyLink(this.update.bind(this));
  }

  /**
   * Updates the displayed view.
   */
  update() {
    const upwardArrows = [];
    const downwardArrows = [];
    const labels = [];
    const updateArrow = (forceProperty, showForceProperty, arrowNode, textNode, labelNode) => {
      const y = forceProperty.value.y;
      if (showForceProperty.value && Math.abs(y) > 1e-5) {
        arrowNode.setTip(0, -y * this.forceScaleProperty.value * 20); // Default zoom is 20 units per Newton
        (y > 0 ? upwardArrows : downwardArrows).push(arrowNode);
        if (this.showForceValuesProperty.value) {
          // We have a listener to the string that will call update
          textNode.string = StringUtils.fillIn(DensityBuoyancyCommonStrings.newtonsPattern, {
            newtons: Utils.toFixed(forceProperty.value.magnitude, 2)
          });
          labels.push(labelNode);
        }
      }
    };

    // Documentation specifies that contact force should always be on the left if there are conflicts
    updateArrow(this.mass.contactForceInterpolatedProperty, this.showContactForceProperty, this.contactArrowNode, this.contactLabelText, this.contactLabelNode);
    updateArrow(this.mass.gravityForceInterpolatedProperty, this.showGravityForceProperty, this.gravityArrowNode, this.gravityLabelText, this.gravityLabelNode);
    updateArrow(this.mass.buoyancyForceInterpolatedProperty, this.showBuoyancyForceProperty, this.buoyancyArrowNode, this.buoyancyLabelText, this.buoyancyLabelNode);
    this.children = [...upwardArrows, ...downwardArrows, ...(upwardArrows.length + downwardArrows.length > 0 ? [this.axisNode] : []), ...labels];
    const positionArrow = (array, index, isUp) => {
      const arrow = array[index];
      arrow.x = (index - (array.length - 1) / 2) * arrowSpacing;
      if (this.showForceValuesProperty.value) {
        const label = this.arrowMap.get(arrow);
        if (isUp) {
          label.bottom = -2;
        } else {
          label.top = 2;
        }
        if (index + 1 < array.length) {
          label.right = arrow.left - 2;
        } else {
          label.left = arrow.right + 2;
        }
      }
    };

    // Layout arrows with spacing
    for (let i = 0; i < upwardArrows.length; i++) {
      positionArrow(upwardArrows, i, true);
    }
    for (let i = 0; i < downwardArrows.length; i++) {
      positionArrow(downwardArrows, i, false);
    }
    const axisHalfWidth = Math.max(upwardArrows.length, downwardArrows.length) * 10 - 5;
    this.axisNode.x1 = -axisHalfWidth;
    this.axisNode.x2 = axisHalfWidth;
  }
}
densityBuoyancyCommon.register('ForceDiagramNode', ForceDiagramNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIlN0cmluZ1V0aWxzIiwiQXJyb3dOb2RlIiwiUGhldEZvbnQiLCJMaW5lIiwiTm9kZSIsIlRleHQiLCJQYW5lbCIsImRlbnNpdHlCdW95YW5jeUNvbW1vbiIsIkRlbnNpdHlCdW95YW5jeUNvbW1vblN0cmluZ3MiLCJEZW5zaXR5QnVveWFuY3lDb21tb25Db2xvcnMiLCJjb21iaW5lT3B0aW9ucyIsImFycm93T3B0aW9ucyIsInN0cm9rZSIsInRhaWxXaWR0aCIsImhlYWRXaWR0aCIsImhlYWRIZWlnaHQiLCJhcnJvd1NwYWNpbmciLCJsYWJlbEZvbnQiLCJzaXplIiwid2VpZ2h0IiwiRm9yY2VEaWFncmFtTm9kZSIsImNvbnN0cnVjdG9yIiwibWFzcyIsInNob3dHcmF2aXR5Rm9yY2VQcm9wZXJ0eSIsInNob3dCdW95YW5jeUZvcmNlUHJvcGVydHkiLCJzaG93Q29udGFjdEZvcmNlUHJvcGVydHkiLCJzaG93Rm9yY2VWYWx1ZXNQcm9wZXJ0eSIsImZvcmNlU2NhbGVQcm9wZXJ0eSIsImdyYXZpdHlBcnJvd05vZGUiLCJmaWxsIiwiZ3Jhdml0eUZvcmNlUHJvcGVydHkiLCJidW95YW5jeUFycm93Tm9kZSIsImJ1b3lhbmN5Rm9yY2VQcm9wZXJ0eSIsImNvbnRhY3RBcnJvd05vZGUiLCJjb250YWN0Rm9yY2VQcm9wZXJ0eSIsImdyYXZpdHlMYWJlbFRleHQiLCJmb250IiwibWF4V2lkdGgiLCJidW95YW5jeUxhYmVsVGV4dCIsImNvbnRhY3RMYWJlbFRleHQiLCJwYW5lbE9wdGlvbnMiLCJtYXNzTGFiZWxCYWNrZ3JvdW5kUHJvcGVydHkiLCJjb3JuZXJSYWRpdXMiLCJ4TWFyZ2luIiwieU1hcmdpbiIsImdyYXZpdHlMYWJlbE5vZGUiLCJidW95YW5jeUxhYmVsTm9kZSIsImNvbnRhY3RMYWJlbE5vZGUiLCJhcnJvd01hcCIsIk1hcCIsInNldCIsImF4aXNOb2RlIiwibmV3dG9uc1BhdHRlcm5Qcm9wZXJ0eSIsIm5ld3RvbnNQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJsYXp5TGluayIsInVwZGF0ZSIsImJpbmQiLCJ1cHdhcmRBcnJvd3MiLCJkb3dud2FyZEFycm93cyIsImxhYmVscyIsInVwZGF0ZUFycm93IiwiZm9yY2VQcm9wZXJ0eSIsInNob3dGb3JjZVByb3BlcnR5IiwiYXJyb3dOb2RlIiwidGV4dE5vZGUiLCJsYWJlbE5vZGUiLCJ5IiwidmFsdWUiLCJNYXRoIiwiYWJzIiwic2V0VGlwIiwicHVzaCIsInN0cmluZyIsImZpbGxJbiIsIm5ld3RvbnNQYXR0ZXJuIiwibmV3dG9ucyIsInRvRml4ZWQiLCJtYWduaXR1ZGUiLCJjb250YWN0Rm9yY2VJbnRlcnBvbGF0ZWRQcm9wZXJ0eSIsImdyYXZpdHlGb3JjZUludGVycG9sYXRlZFByb3BlcnR5IiwiYnVveWFuY3lGb3JjZUludGVycG9sYXRlZFByb3BlcnR5IiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJwb3NpdGlvbkFycm93IiwiYXJyYXkiLCJpbmRleCIsImlzVXAiLCJhcnJvdyIsIngiLCJsYWJlbCIsImdldCIsImJvdHRvbSIsInRvcCIsInJpZ2h0IiwibGVmdCIsImkiLCJheGlzSGFsZldpZHRoIiwibWF4IiwieDEiLCJ4MiIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRm9yY2VEaWFncmFtTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBTaG93cyBhIGZvcmNlIGRpYWdyYW0gZm9yIGFuIGluZGl2aWR1YWwgbWFzcy5cclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCBTdHJpbmdVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3V0aWwvU3RyaW5nVXRpbHMuanMnO1xyXG5pbXBvcnQgQXJyb3dOb2RlLCB7IEFycm93Tm9kZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvQXJyb3dOb2RlLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IExpbmUsIE5vZGUsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgUGFuZWwgZnJvbSAnLi4vLi4vLi4vLi4vc3VuL2pzL1BhbmVsLmpzJztcclxuaW1wb3J0IGRlbnNpdHlCdW95YW5jeUNvbW1vbiBmcm9tICcuLi8uLi9kZW5zaXR5QnVveWFuY3lDb21tb24uanMnO1xyXG5pbXBvcnQgRGVuc2l0eUJ1b3lhbmN5Q29tbW9uU3RyaW5ncyBmcm9tICcuLi8uLi9EZW5zaXR5QnVveWFuY3lDb21tb25TdHJpbmdzLmpzJztcclxuaW1wb3J0IE1hc3MgZnJvbSAnLi4vbW9kZWwvTWFzcy5qcyc7XHJcbmltcG9ydCBEZW5zaXR5QnVveWFuY3lDb21tb25Db2xvcnMgZnJvbSAnLi9EZW5zaXR5QnVveWFuY3lDb21tb25Db2xvcnMuanMnO1xyXG5pbXBvcnQgSW50ZXJwb2xhdGVkUHJvcGVydHkgZnJvbSAnLi4vbW9kZWwvSW50ZXJwb2xhdGVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCB7IGNvbWJpbmVPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBUUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUHJvcGVydHkuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IGFycm93T3B0aW9ucyA9IHtcclxuICBzdHJva2U6IG51bGwsXHJcbiAgdGFpbFdpZHRoOiA0LFxyXG4gIGhlYWRXaWR0aDogMTUsXHJcbiAgaGVhZEhlaWdodDogMTJcclxufTtcclxuY29uc3QgYXJyb3dTcGFjaW5nID0gYXJyb3dPcHRpb25zLmhlYWRXaWR0aCArIDM7XHJcbmNvbnN0IGxhYmVsRm9udCA9IG5ldyBQaGV0Rm9udCggeyBzaXplOiAxMiwgd2VpZ2h0OiAnYm9sZCcgfSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9yY2VEaWFncmFtTm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICBwdWJsaWMgcmVhZG9ubHkgbWFzczogTWFzcztcclxuICBwcml2YXRlIHJlYWRvbmx5IHNob3dHcmF2aXR5Rm9yY2VQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj47XHJcbiAgcHJpdmF0ZSByZWFkb25seSBzaG93QnVveWFuY3lGb3JjZVByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPjtcclxuICBwcml2YXRlIHJlYWRvbmx5IHNob3dDb250YWN0Rm9yY2VQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj47XHJcbiAgcHJpdmF0ZSByZWFkb25seSBzaG93Rm9yY2VWYWx1ZXNQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj47XHJcbiAgcHJpdmF0ZSByZWFkb25seSBmb3JjZVNjYWxlUHJvcGVydHk6IFRQcm9wZXJ0eTxudW1iZXI+O1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGdyYXZpdHlBcnJvd05vZGU6IEFycm93Tm9kZTtcclxuICBwcml2YXRlIHJlYWRvbmx5IGJ1b3lhbmN5QXJyb3dOb2RlOiBBcnJvd05vZGU7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBjb250YWN0QXJyb3dOb2RlOiBBcnJvd05vZGU7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZ3Jhdml0eUxhYmVsVGV4dDogVGV4dDtcclxuICBwcml2YXRlIHJlYWRvbmx5IGJ1b3lhbmN5TGFiZWxUZXh0OiBUZXh0O1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGFjdExhYmVsVGV4dDogVGV4dDtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBncmF2aXR5TGFiZWxOb2RlOiBOb2RlO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgYnVveWFuY3lMYWJlbE5vZGU6IE5vZGU7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBjb250YWN0TGFiZWxOb2RlOiBOb2RlO1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGFycm93TWFwOiBNYXA8QXJyb3dOb2RlLCBOb2RlPjtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBheGlzTm9kZTogTGluZTtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBtYXNzOiBNYXNzLCBzaG93R3Jhdml0eUZvcmNlUHJvcGVydHk6IFByb3BlcnR5PGJvb2xlYW4+LCBzaG93QnVveWFuY3lGb3JjZVByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPiwgc2hvd0NvbnRhY3RGb3JjZVByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPiwgc2hvd0ZvcmNlVmFsdWVzUHJvcGVydHk6IFByb3BlcnR5PGJvb2xlYW4+LCBmb3JjZVNjYWxlUHJvcGVydHk6IFRQcm9wZXJ0eTxudW1iZXI+ICkge1xyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICB0aGlzLm1hc3MgPSBtYXNzO1xyXG5cclxuICAgIHRoaXMuc2hvd0dyYXZpdHlGb3JjZVByb3BlcnR5ID0gc2hvd0dyYXZpdHlGb3JjZVByb3BlcnR5O1xyXG4gICAgdGhpcy5zaG93QnVveWFuY3lGb3JjZVByb3BlcnR5ID0gc2hvd0J1b3lhbmN5Rm9yY2VQcm9wZXJ0eTtcclxuICAgIHRoaXMuc2hvd0NvbnRhY3RGb3JjZVByb3BlcnR5ID0gc2hvd0NvbnRhY3RGb3JjZVByb3BlcnR5O1xyXG4gICAgdGhpcy5zaG93Rm9yY2VWYWx1ZXNQcm9wZXJ0eSA9IHNob3dGb3JjZVZhbHVlc1Byb3BlcnR5O1xyXG4gICAgdGhpcy5mb3JjZVNjYWxlUHJvcGVydHkgPSBmb3JjZVNjYWxlUHJvcGVydHk7XHJcblxyXG4gICAgdGhpcy5ncmF2aXR5QXJyb3dOb2RlID0gbmV3IEFycm93Tm9kZSggMCwgMCwgMCwgMCwgY29tYmluZU9wdGlvbnM8QXJyb3dOb2RlT3B0aW9ucz4oIHtcclxuICAgICAgZmlsbDogRGVuc2l0eUJ1b3lhbmN5Q29tbW9uQ29sb3JzLmdyYXZpdHlGb3JjZVByb3BlcnR5XHJcbiAgICB9LCBhcnJvd09wdGlvbnMgKSApO1xyXG4gICAgdGhpcy5idW95YW5jeUFycm93Tm9kZSA9IG5ldyBBcnJvd05vZGUoIDAsIDAsIDAsIDAsIGNvbWJpbmVPcHRpb25zPEFycm93Tm9kZU9wdGlvbnM+KCB7XHJcbiAgICAgIGZpbGw6IERlbnNpdHlCdW95YW5jeUNvbW1vbkNvbG9ycy5idW95YW5jeUZvcmNlUHJvcGVydHlcclxuICAgIH0sIGFycm93T3B0aW9ucyApICk7XHJcbiAgICB0aGlzLmNvbnRhY3RBcnJvd05vZGUgPSBuZXcgQXJyb3dOb2RlKCAwLCAwLCAwLCAwLCBjb21iaW5lT3B0aW9uczxBcnJvd05vZGVPcHRpb25zPigge1xyXG4gICAgICBmaWxsOiBEZW5zaXR5QnVveWFuY3lDb21tb25Db2xvcnMuY29udGFjdEZvcmNlUHJvcGVydHlcclxuICAgIH0sIGFycm93T3B0aW9ucyApICk7XHJcblxyXG4gICAgdGhpcy5ncmF2aXR5TGFiZWxUZXh0ID0gbmV3IFRleHQoICcnLCB7XHJcbiAgICAgIGZvbnQ6IGxhYmVsRm9udCxcclxuICAgICAgZmlsbDogRGVuc2l0eUJ1b3lhbmN5Q29tbW9uQ29sb3JzLmdyYXZpdHlGb3JjZVByb3BlcnR5LFxyXG4gICAgICBtYXhXaWR0aDogMjAwXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmJ1b3lhbmN5TGFiZWxUZXh0ID0gbmV3IFRleHQoICcnLCB7XHJcbiAgICAgIGZvbnQ6IGxhYmVsRm9udCxcclxuICAgICAgZmlsbDogRGVuc2l0eUJ1b3lhbmN5Q29tbW9uQ29sb3JzLmJ1b3lhbmN5Rm9yY2VQcm9wZXJ0eSxcclxuICAgICAgbWF4V2lkdGg6IDIwMFxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5jb250YWN0TGFiZWxUZXh0ID0gbmV3IFRleHQoICcnLCB7XHJcbiAgICAgIGZvbnQ6IGxhYmVsRm9udCxcclxuICAgICAgZmlsbDogRGVuc2l0eUJ1b3lhbmN5Q29tbW9uQ29sb3JzLmNvbnRhY3RGb3JjZVByb3BlcnR5LFxyXG4gICAgICBtYXhXaWR0aDogMjAwXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgcGFuZWxPcHRpb25zID0ge1xyXG4gICAgICBzdHJva2U6IG51bGwsXHJcbiAgICAgIGZpbGw6IERlbnNpdHlCdW95YW5jeUNvbW1vbkNvbG9ycy5tYXNzTGFiZWxCYWNrZ3JvdW5kUHJvcGVydHksXHJcbiAgICAgIGNvcm5lclJhZGl1czogMCxcclxuICAgICAgeE1hcmdpbjogMixcclxuICAgICAgeU1hcmdpbjogMVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmdyYXZpdHlMYWJlbE5vZGUgPSBuZXcgUGFuZWwoIHRoaXMuZ3Jhdml0eUxhYmVsVGV4dCwgcGFuZWxPcHRpb25zICk7XHJcbiAgICB0aGlzLmJ1b3lhbmN5TGFiZWxOb2RlID0gbmV3IFBhbmVsKCB0aGlzLmJ1b3lhbmN5TGFiZWxUZXh0LCBwYW5lbE9wdGlvbnMgKTtcclxuICAgIHRoaXMuY29udGFjdExhYmVsTm9kZSA9IG5ldyBQYW5lbCggdGhpcy5jb250YWN0TGFiZWxUZXh0LCBwYW5lbE9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLmFycm93TWFwID0gbmV3IE1hcCgpO1xyXG4gICAgdGhpcy5hcnJvd01hcC5zZXQoIHRoaXMuZ3Jhdml0eUFycm93Tm9kZSwgdGhpcy5ncmF2aXR5TGFiZWxOb2RlICk7XHJcbiAgICB0aGlzLmFycm93TWFwLnNldCggdGhpcy5idW95YW5jeUFycm93Tm9kZSwgdGhpcy5idW95YW5jeUxhYmVsTm9kZSApO1xyXG4gICAgdGhpcy5hcnJvd01hcC5zZXQoIHRoaXMuY29udGFjdEFycm93Tm9kZSwgdGhpcy5jb250YWN0TGFiZWxOb2RlICk7XHJcblxyXG4gICAgdGhpcy5heGlzTm9kZSA9IG5ldyBMaW5lKCB7XHJcbiAgICAgIHN0cm9rZTogJ2JsYWNrJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IG5ld3RvbnNQYXR0ZXJuUHJvcGVydHkgPSBEZW5zaXR5QnVveWFuY3lDb21tb25TdHJpbmdzLm5ld3RvbnNQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbiAgICBuZXd0b25zUGF0dGVyblByb3BlcnR5LmxhenlMaW5rKCB0aGlzLnVwZGF0ZS5iaW5kKCB0aGlzICkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZXMgdGhlIGRpc3BsYXllZCB2aWV3LlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1cGRhdGUoKTogdm9pZCB7XHJcbiAgICBjb25zdCB1cHdhcmRBcnJvd3M6IEFycm93Tm9kZVtdID0gW107XHJcbiAgICBjb25zdCBkb3dud2FyZEFycm93czogQXJyb3dOb2RlW10gPSBbXTtcclxuICAgIGNvbnN0IGxhYmVsczogTm9kZVtdID0gW107XHJcblxyXG4gICAgY29uc3QgdXBkYXRlQXJyb3cgPSAoIGZvcmNlUHJvcGVydHk6IEludGVycG9sYXRlZFByb3BlcnR5PFZlY3RvcjI+LCBzaG93Rm9yY2VQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj4sIGFycm93Tm9kZTogQXJyb3dOb2RlLCB0ZXh0Tm9kZTogVGV4dCwgbGFiZWxOb2RlOiBOb2RlICkgPT4ge1xyXG4gICAgICBjb25zdCB5ID0gZm9yY2VQcm9wZXJ0eS52YWx1ZS55O1xyXG4gICAgICBpZiAoIHNob3dGb3JjZVByb3BlcnR5LnZhbHVlICYmIE1hdGguYWJzKCB5ICkgPiAxZS01ICkge1xyXG4gICAgICAgIGFycm93Tm9kZS5zZXRUaXAoIDAsIC15ICogdGhpcy5mb3JjZVNjYWxlUHJvcGVydHkudmFsdWUgKiAyMCApOyAvLyBEZWZhdWx0IHpvb20gaXMgMjAgdW5pdHMgcGVyIE5ld3RvblxyXG4gICAgICAgICggeSA+IDAgPyB1cHdhcmRBcnJvd3MgOiBkb3dud2FyZEFycm93cyApLnB1c2goIGFycm93Tm9kZSApO1xyXG5cclxuICAgICAgICBpZiAoIHRoaXMuc2hvd0ZvcmNlVmFsdWVzUHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgICAgICAvLyBXZSBoYXZlIGEgbGlzdGVuZXIgdG8gdGhlIHN0cmluZyB0aGF0IHdpbGwgY2FsbCB1cGRhdGVcclxuICAgICAgICAgIHRleHROb2RlLnN0cmluZyA9IFN0cmluZ1V0aWxzLmZpbGxJbiggRGVuc2l0eUJ1b3lhbmN5Q29tbW9uU3RyaW5ncy5uZXd0b25zUGF0dGVybiwge1xyXG4gICAgICAgICAgICBuZXd0b25zOiBVdGlscy50b0ZpeGVkKCBmb3JjZVByb3BlcnR5LnZhbHVlLm1hZ25pdHVkZSwgMiApXHJcbiAgICAgICAgICB9ICk7XHJcbiAgICAgICAgICBsYWJlbHMucHVzaCggbGFiZWxOb2RlICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIERvY3VtZW50YXRpb24gc3BlY2lmaWVzIHRoYXQgY29udGFjdCBmb3JjZSBzaG91bGQgYWx3YXlzIGJlIG9uIHRoZSBsZWZ0IGlmIHRoZXJlIGFyZSBjb25mbGljdHNcclxuICAgIHVwZGF0ZUFycm93KCB0aGlzLm1hc3MuY29udGFjdEZvcmNlSW50ZXJwb2xhdGVkUHJvcGVydHksIHRoaXMuc2hvd0NvbnRhY3RGb3JjZVByb3BlcnR5LCB0aGlzLmNvbnRhY3RBcnJvd05vZGUsIHRoaXMuY29udGFjdExhYmVsVGV4dCwgdGhpcy5jb250YWN0TGFiZWxOb2RlICk7XHJcbiAgICB1cGRhdGVBcnJvdyggdGhpcy5tYXNzLmdyYXZpdHlGb3JjZUludGVycG9sYXRlZFByb3BlcnR5LCB0aGlzLnNob3dHcmF2aXR5Rm9yY2VQcm9wZXJ0eSwgdGhpcy5ncmF2aXR5QXJyb3dOb2RlLCB0aGlzLmdyYXZpdHlMYWJlbFRleHQsIHRoaXMuZ3Jhdml0eUxhYmVsTm9kZSApO1xyXG4gICAgdXBkYXRlQXJyb3coIHRoaXMubWFzcy5idW95YW5jeUZvcmNlSW50ZXJwb2xhdGVkUHJvcGVydHksIHRoaXMuc2hvd0J1b3lhbmN5Rm9yY2VQcm9wZXJ0eSwgdGhpcy5idW95YW5jeUFycm93Tm9kZSwgdGhpcy5idW95YW5jeUxhYmVsVGV4dCwgdGhpcy5idW95YW5jeUxhYmVsTm9kZSApO1xyXG5cclxuICAgIHRoaXMuY2hpbGRyZW4gPSBbXHJcbiAgICAgIC4uLnVwd2FyZEFycm93cyxcclxuICAgICAgLi4uZG93bndhcmRBcnJvd3MsXHJcbiAgICAgIC4uLiggdXB3YXJkQXJyb3dzLmxlbmd0aCArIGRvd253YXJkQXJyb3dzLmxlbmd0aCA+IDAgPyBbIHRoaXMuYXhpc05vZGUgXSA6IFtdICksXHJcbiAgICAgIC4uLmxhYmVsc1xyXG4gICAgXTtcclxuXHJcbiAgICBjb25zdCBwb3NpdGlvbkFycm93ID0gKCBhcnJheTogQXJyb3dOb2RlW10sIGluZGV4OiBudW1iZXIsIGlzVXA6IGJvb2xlYW4gKSA9PiB7XHJcbiAgICAgIGNvbnN0IGFycm93ID0gYXJyYXlbIGluZGV4IF07XHJcbiAgICAgIGFycm93LnggPSAoIGluZGV4IC0gKCBhcnJheS5sZW5ndGggLSAxICkgLyAyICkgKiBhcnJvd1NwYWNpbmc7XHJcbiAgICAgIGlmICggdGhpcy5zaG93Rm9yY2VWYWx1ZXNQcm9wZXJ0eS52YWx1ZSApIHtcclxuICAgICAgICBjb25zdCBsYWJlbCA9IHRoaXMuYXJyb3dNYXAuZ2V0KCBhcnJvdyApITtcclxuICAgICAgICBpZiAoIGlzVXAgKSB7XHJcbiAgICAgICAgICBsYWJlbC5ib3R0b20gPSAtMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBsYWJlbC50b3AgPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIGluZGV4ICsgMSA8IGFycmF5Lmxlbmd0aCApIHtcclxuICAgICAgICAgIGxhYmVsLnJpZ2h0ID0gYXJyb3cubGVmdCAtIDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgbGFiZWwubGVmdCA9IGFycm93LnJpZ2h0ICsgMjtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gTGF5b3V0IGFycm93cyB3aXRoIHNwYWNpbmdcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHVwd2FyZEFycm93cy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgcG9zaXRpb25BcnJvdyggdXB3YXJkQXJyb3dzLCBpLCB0cnVlICk7XHJcbiAgICB9XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBkb3dud2FyZEFycm93cy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgcG9zaXRpb25BcnJvdyggZG93bndhcmRBcnJvd3MsIGksIGZhbHNlICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXhpc0hhbGZXaWR0aCA9IE1hdGgubWF4KCB1cHdhcmRBcnJvd3MubGVuZ3RoLCBkb3dud2FyZEFycm93cy5sZW5ndGggKSAqIDEwIC0gNTtcclxuICAgIHRoaXMuYXhpc05vZGUueDEgPSAtYXhpc0hhbGZXaWR0aDtcclxuICAgIHRoaXMuYXhpc05vZGUueDIgPSBheGlzSGFsZldpZHRoO1xyXG4gIH1cclxufVxyXG5cclxuZGVuc2l0eUJ1b3lhbmN5Q29tbW9uLnJlZ2lzdGVyKCAnRm9yY2VEaWFncmFtTm9kZScsIEZvcmNlRGlhZ3JhbU5vZGUgKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBLE9BQU9BLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsV0FBVyxNQUFNLCtDQUErQztBQUN2RSxPQUFPQyxTQUFTLE1BQTRCLDBDQUEwQztBQUN0RixPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELFNBQVNDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQ3BFLE9BQU9D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