// Copyright 2020-2022, University of Colorado Boulder

/**
 * The 3D view for a Boat.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Multilink from '../../../../axon/js/Multilink.js';
import Material from '../../common/model/Material.js';
import MassView from '../../common/view/MassView.js';
import densityBuoyancyCommon from '../../densityBuoyancyCommon.js';
import BoatDesign from '../model/BoatDesign.js';
export default class BoatView extends MassView {
  constructor(boat, liquidYInterpolatedProperty) {
    // @ts-expect-error
    super(boat, new THREE.Geometry());

    // Clip planes at the boat's water level
    const bottomBoatClipPlane = new THREE.Plane(new THREE.Vector3(0, -1, 0), 0);
    const topBoatClipPlane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);

    // Clip planes at the pool's water level
    const bottomPoolClipPlane = new THREE.Plane(new THREE.Vector3(0, -1, 0), 0);
    const topPoolClipPlane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);
    const boatOneLiterInteriorGeometry = BoatDesign.getPrimaryGeometry(1, false, false, true, false);
    const boatOneLiterExteriorGeometry = BoatDesign.getPrimaryGeometry(1, true, true, false, false);
    const boatOneLiterGeometry = BoatDesign.getPrimaryGeometry(1);
    const boatGroup = new THREE.Group();
    this.add(boatGroup);
    boat.displacementVolumeProperty.link(volume => {
      const scale = Math.pow(volume / 0.001, 1 / 3);
      boatGroup.scale.x = scale;
      boatGroup.scale.y = scale;
      boatGroup.scale.z = scale;
    });
    const backExteriorMaterial = new THREE.MeshPhongMaterial({
      color: 0xffffff,
      opacity: 0.4,
      transparent: true,
      side: THREE.BackSide,
      depthWrite: false
    });
    const backExterior = new THREE.Mesh(boatOneLiterExteriorGeometry, backExteriorMaterial);
    boatGroup.add(backExterior);
    const backTopMaterial = new THREE.MeshPhongMaterial({
      color: 0xffffff,
      opacity: 0.4,
      transparent: true,
      side: THREE.BackSide,
      depthWrite: false,
      clippingPlanes: [topBoatClipPlane]
    });
    const backTop = new THREE.Mesh(boatOneLiterInteriorGeometry, backTopMaterial);
    boatGroup.add(backTop);
    const backMiddleMaterial = new THREE.MeshBasicMaterial({
      color: 0x33FF33,
      // will be replaced with liquid color below
      opacity: 0.8,
      transparent: true,
      side: THREE.BackSide,
      // better appearance with this
      depthWrite: false,
      clippingPlanes: [bottomBoatClipPlane, topPoolClipPlane]
    });
    const backMiddle = new THREE.Mesh(boatOneLiterInteriorGeometry, backMiddleMaterial);
    boatGroup.add(backMiddle);
    const backBottomMaterial = new THREE.MeshPhongMaterial({
      color: 0xffffff,
      opacity: 0.4,
      transparent: true,
      side: THREE.BackSide,
      depthWrite: false,
      clippingPlanes: [bottomBoatClipPlane, bottomPoolClipPlane]
    });
    const backBottom = new THREE.Mesh(boatOneLiterInteriorGeometry, backBottomMaterial);
    boatGroup.add(backBottom);
    const frontExteriorMaterial = new THREE.MeshPhongMaterial({
      color: 0xffffff,
      opacity: 0.4,
      transparent: true,
      side: THREE.FrontSide,
      depthWrite: false
    });
    const frontExterior = new THREE.Mesh(boatOneLiterExteriorGeometry, frontExteriorMaterial);
    boatGroup.add(frontExterior);
    const frontTopMaterial = new THREE.MeshPhongMaterial({
      color: 0xffffff,
      opacity: 0.4,
      transparent: true,
      side: THREE.FrontSide,
      depthWrite: false,
      clippingPlanes: [topBoatClipPlane]
    });
    const frontTop = new THREE.Mesh(boatOneLiterInteriorGeometry, frontTopMaterial);
    boatGroup.add(frontTop);
    const frontForDepth = new THREE.Mesh(boatOneLiterGeometry, new THREE.MeshPhongMaterial({
      color: 0xFF0000,
      opacity: 0,
      transparent: true,
      side: THREE.FrontSide
    }));
    boatGroup.add(frontForDepth);
    const topLiquidPositionArray = BoatDesign.createCrossSectionVertexArray();
    const topLiquidNormalArray = new Float32Array(topLiquidPositionArray.length);
    for (let i = 1; i < topLiquidNormalArray.length; i += 3) {
      topLiquidNormalArray[i] = 1; // normals should all be 0,1,0
    }

    const topLiquidGeometry = new THREE.BufferGeometry();
    topLiquidGeometry.addAttribute('position', new THREE.BufferAttribute(topLiquidPositionArray, 3));
    topLiquidGeometry.addAttribute('normal', new THREE.BufferAttribute(topLiquidNormalArray, 3));
    const topLiquidMaterial = new THREE.MeshPhongMaterial({
      color: 0x33FF33,
      // will be replaced with liquid color below
      opacity: 0.8,
      transparent: true,
      depthWrite: false
    });
    const topLiquid = new THREE.Mesh(topLiquidGeometry, topLiquidMaterial);
    this.add(topLiquid);
    this.liquidMultilink = Multilink.multilink([boat.basin.liquidYInterpolatedProperty, boat.displacementVolumeProperty, boat.basin.liquidVolumeProperty], (boatLiquidY, boatDisplacement, boatLiquidVolume) => {
      const poolLiquidY = liquidYInterpolatedProperty.value;
      const liters = boatDisplacement / 0.001;
      const relativeBoatLiquidY = boatLiquidY - boat.matrix.translation.y;
      const maximumVolume = boat.basin.getEmptyVolume(Number.POSITIVE_INFINITY);
      const volume = boat.basin.liquidVolumeProperty.value;
      const isFull = volume >= maximumVolume - 1e-7;
      if (boatLiquidVolume > 0 && (!isFull || BoatDesign.shouldBoatWaterDisplayIfFull(liquidYInterpolatedProperty.value - boat.matrix.translation.y, liters))) {
        BoatDesign.fillCrossSectionVertexArray(relativeBoatLiquidY, liters, topLiquidPositionArray);
      } else {
        topLiquidPositionArray.fill(0);
      }
      topLiquidGeometry.attributes.position.needsUpdate = true;
      topLiquidGeometry.computeBoundingSphere();
      if (boat.basin.liquidVolumeProperty.value > 1e-7) {
        bottomBoatClipPlane.constant = boatLiquidY;
        topBoatClipPlane.constant = -boatLiquidY;
      } else {
        bottomBoatClipPlane.constant = -1000;
        topBoatClipPlane.constant = 1000;
      }
      bottomPoolClipPlane.constant = poolLiquidY;
      topPoolClipPlane.constant = -poolLiquidY;
    });
    Material.linkLiquidColor(boat.liquidMaterialProperty, topLiquidMaterial);
    Material.linkLiquidColor(boat.liquidMaterialProperty, backMiddleMaterial);

    // pool liquid will be at a higher value
    frontForDepth.renderOrder = 4;
    topLiquid.renderOrder = 3;
    frontTop.renderOrder = 2;
    frontExterior.renderOrder = 1;
    // block will be at 0
    backBottom.renderOrder = -1;
    backMiddle.renderOrder = -1;
    backTop.renderOrder = -1;
    backExterior.renderOrder = -2;
    this.boat = boat;
  }

  /**
   * Releases references.
   */
  dispose() {
    // TODO: dispose everything from above

    this.liquidMultilink.dispose();
    super.dispose();
  }
}
densityBuoyancyCommon.register('BoatView', BoatView);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aWxpbmsiLCJNYXRlcmlhbCIsIk1hc3NWaWV3IiwiZGVuc2l0eUJ1b3lhbmN5Q29tbW9uIiwiQm9hdERlc2lnbiIsIkJvYXRWaWV3IiwiY29uc3RydWN0b3IiLCJib2F0IiwibGlxdWlkWUludGVycG9sYXRlZFByb3BlcnR5IiwiVEhSRUUiLCJHZW9tZXRyeSIsImJvdHRvbUJvYXRDbGlwUGxhbmUiLCJQbGFuZSIsIlZlY3RvcjMiLCJ0b3BCb2F0Q2xpcFBsYW5lIiwiYm90dG9tUG9vbENsaXBQbGFuZSIsInRvcFBvb2xDbGlwUGxhbmUiLCJib2F0T25lTGl0ZXJJbnRlcmlvckdlb21ldHJ5IiwiZ2V0UHJpbWFyeUdlb21ldHJ5IiwiYm9hdE9uZUxpdGVyRXh0ZXJpb3JHZW9tZXRyeSIsImJvYXRPbmVMaXRlckdlb21ldHJ5IiwiYm9hdEdyb3VwIiwiR3JvdXAiLCJhZGQiLCJkaXNwbGFjZW1lbnRWb2x1bWVQcm9wZXJ0eSIsImxpbmsiLCJ2b2x1bWUiLCJzY2FsZSIsIk1hdGgiLCJwb3ciLCJ4IiwieSIsInoiLCJiYWNrRXh0ZXJpb3JNYXRlcmlhbCIsIk1lc2hQaG9uZ01hdGVyaWFsIiwiY29sb3IiLCJvcGFjaXR5IiwidHJhbnNwYXJlbnQiLCJzaWRlIiwiQmFja1NpZGUiLCJkZXB0aFdyaXRlIiwiYmFja0V4dGVyaW9yIiwiTWVzaCIsImJhY2tUb3BNYXRlcmlhbCIsImNsaXBwaW5nUGxhbmVzIiwiYmFja1RvcCIsImJhY2tNaWRkbGVNYXRlcmlhbCIsIk1lc2hCYXNpY01hdGVyaWFsIiwiYmFja01pZGRsZSIsImJhY2tCb3R0b21NYXRlcmlhbCIsImJhY2tCb3R0b20iLCJmcm9udEV4dGVyaW9yTWF0ZXJpYWwiLCJGcm9udFNpZGUiLCJmcm9udEV4dGVyaW9yIiwiZnJvbnRUb3BNYXRlcmlhbCIsImZyb250VG9wIiwiZnJvbnRGb3JEZXB0aCIsInRvcExpcXVpZFBvc2l0aW9uQXJyYXkiLCJjcmVhdGVDcm9zc1NlY3Rpb25WZXJ0ZXhBcnJheSIsInRvcExpcXVpZE5vcm1hbEFycmF5IiwiRmxvYXQzMkFycmF5IiwibGVuZ3RoIiwiaSIsInRvcExpcXVpZEdlb21ldHJ5IiwiQnVmZmVyR2VvbWV0cnkiLCJhZGRBdHRyaWJ1dGUiLCJCdWZmZXJBdHRyaWJ1dGUiLCJ0b3BMaXF1aWRNYXRlcmlhbCIsInRvcExpcXVpZCIsImxpcXVpZE11bHRpbGluayIsIm11bHRpbGluayIsImJhc2luIiwibGlxdWlkVm9sdW1lUHJvcGVydHkiLCJib2F0TGlxdWlkWSIsImJvYXREaXNwbGFjZW1lbnQiLCJib2F0TGlxdWlkVm9sdW1lIiwicG9vbExpcXVpZFkiLCJ2YWx1ZSIsImxpdGVycyIsInJlbGF0aXZlQm9hdExpcXVpZFkiLCJtYXRyaXgiLCJ0cmFuc2xhdGlvbiIsIm1heGltdW1Wb2x1bWUiLCJnZXRFbXB0eVZvbHVtZSIsIk51bWJlciIsIlBPU0lUSVZFX0lORklOSVRZIiwiaXNGdWxsIiwic2hvdWxkQm9hdFdhdGVyRGlzcGxheUlmRnVsbCIsImZpbGxDcm9zc1NlY3Rpb25WZXJ0ZXhBcnJheSIsImZpbGwiLCJhdHRyaWJ1dGVzIiwicG9zaXRpb24iLCJuZWVkc1VwZGF0ZSIsImNvbXB1dGVCb3VuZGluZ1NwaGVyZSIsImNvbnN0YW50IiwibGlua0xpcXVpZENvbG9yIiwibGlxdWlkTWF0ZXJpYWxQcm9wZXJ0eSIsInJlbmRlck9yZGVyIiwiZGlzcG9zZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQm9hdFZpZXcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjAtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogVGhlIDNEIHZpZXcgZm9yIGEgQm9hdC5cclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IE11bHRpbGluaywgeyBVbmtub3duTXVsdGlsaW5rIH0gZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9NdWx0aWxpbmsuanMnO1xyXG5pbXBvcnQgTWF0ZXJpYWwgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL01hdGVyaWFsLmpzJztcclxuaW1wb3J0IE1hc3NWaWV3IGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L01hc3NWaWV3LmpzJztcclxuaW1wb3J0IGRlbnNpdHlCdW95YW5jeUNvbW1vbiBmcm9tICcuLi8uLi9kZW5zaXR5QnVveWFuY3lDb21tb24uanMnO1xyXG5pbXBvcnQgQm9hdCBmcm9tICcuLi9tb2RlbC9Cb2F0LmpzJztcclxuaW1wb3J0IEJvYXREZXNpZ24gZnJvbSAnLi4vbW9kZWwvQm9hdERlc2lnbi5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCb2F0VmlldyBleHRlbmRzIE1hc3NWaWV3IHtcclxuICBwcml2YXRlIHJlYWRvbmx5IGxpcXVpZE11bHRpbGluazogVW5rbm93bk11bHRpbGluaztcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IGJvYXQ6IEJvYXQ7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggYm9hdDogQm9hdCwgbGlxdWlkWUludGVycG9sYXRlZFByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+ICkge1xyXG5cclxuICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcclxuICAgIHN1cGVyKCBib2F0LCBuZXcgVEhSRUUuR2VvbWV0cnkoKSApO1xyXG5cclxuICAgIC8vIENsaXAgcGxhbmVzIGF0IHRoZSBib2F0J3Mgd2F0ZXIgbGV2ZWxcclxuICAgIGNvbnN0IGJvdHRvbUJvYXRDbGlwUGxhbmUgPSBuZXcgVEhSRUUuUGxhbmUoIG5ldyBUSFJFRS5WZWN0b3IzKCAwLCAtMSwgMCApLCAwICk7XHJcbiAgICBjb25zdCB0b3BCb2F0Q2xpcFBsYW5lID0gbmV3IFRIUkVFLlBsYW5lKCBuZXcgVEhSRUUuVmVjdG9yMyggMCwgMSwgMCApLCAwICk7XHJcblxyXG4gICAgLy8gQ2xpcCBwbGFuZXMgYXQgdGhlIHBvb2wncyB3YXRlciBsZXZlbFxyXG4gICAgY29uc3QgYm90dG9tUG9vbENsaXBQbGFuZSA9IG5ldyBUSFJFRS5QbGFuZSggbmV3IFRIUkVFLlZlY3RvcjMoIDAsIC0xLCAwICksIDAgKTtcclxuICAgIGNvbnN0IHRvcFBvb2xDbGlwUGxhbmUgPSBuZXcgVEhSRUUuUGxhbmUoIG5ldyBUSFJFRS5WZWN0b3IzKCAwLCAxLCAwICksIDAgKTtcclxuXHJcbiAgICBjb25zdCBib2F0T25lTGl0ZXJJbnRlcmlvckdlb21ldHJ5ID0gQm9hdERlc2lnbi5nZXRQcmltYXJ5R2VvbWV0cnkoIDEsIGZhbHNlLCBmYWxzZSwgdHJ1ZSwgZmFsc2UgKTtcclxuICAgIGNvbnN0IGJvYXRPbmVMaXRlckV4dGVyaW9yR2VvbWV0cnkgPSBCb2F0RGVzaWduLmdldFByaW1hcnlHZW9tZXRyeSggMSwgdHJ1ZSwgdHJ1ZSwgZmFsc2UsIGZhbHNlICk7XHJcblxyXG4gICAgY29uc3QgYm9hdE9uZUxpdGVyR2VvbWV0cnkgPSBCb2F0RGVzaWduLmdldFByaW1hcnlHZW9tZXRyeSggMSApO1xyXG5cclxuICAgIGNvbnN0IGJvYXRHcm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpO1xyXG4gICAgdGhpcy5hZGQoIGJvYXRHcm91cCApO1xyXG5cclxuICAgIGJvYXQuZGlzcGxhY2VtZW50Vm9sdW1lUHJvcGVydHkubGluayggdm9sdW1lID0+IHtcclxuICAgICAgY29uc3Qgc2NhbGUgPSBNYXRoLnBvdyggdm9sdW1lIC8gMC4wMDEsIDEgLyAzICk7XHJcbiAgICAgIGJvYXRHcm91cC5zY2FsZS54ID0gc2NhbGU7XHJcbiAgICAgIGJvYXRHcm91cC5zY2FsZS55ID0gc2NhbGU7XHJcbiAgICAgIGJvYXRHcm91cC5zY2FsZS56ID0gc2NhbGU7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgYmFja0V4dGVyaW9yTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoIHtcclxuICAgICAgY29sb3I6IDB4ZmZmZmZmLFxyXG4gICAgICBvcGFjaXR5OiAwLjQsXHJcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlLFxyXG4gICAgICBzaWRlOiBUSFJFRS5CYWNrU2lkZSxcclxuICAgICAgZGVwdGhXcml0ZTogZmFsc2VcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGJhY2tFeHRlcmlvciA9IG5ldyBUSFJFRS5NZXNoKCBib2F0T25lTGl0ZXJFeHRlcmlvckdlb21ldHJ5LCBiYWNrRXh0ZXJpb3JNYXRlcmlhbCApO1xyXG4gICAgYm9hdEdyb3VwLmFkZCggYmFja0V4dGVyaW9yICk7XHJcblxyXG4gICAgY29uc3QgYmFja1RvcE1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKCB7XHJcbiAgICAgIGNvbG9yOiAweGZmZmZmZixcclxuICAgICAgb3BhY2l0eTogMC40LFxyXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcclxuICAgICAgc2lkZTogVEhSRUUuQmFja1NpZGUsXHJcbiAgICAgIGRlcHRoV3JpdGU6IGZhbHNlLFxyXG4gICAgICBjbGlwcGluZ1BsYW5lczogWyB0b3BCb2F0Q2xpcFBsYW5lIF1cclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGJhY2tUb3AgPSBuZXcgVEhSRUUuTWVzaCggYm9hdE9uZUxpdGVySW50ZXJpb3JHZW9tZXRyeSwgYmFja1RvcE1hdGVyaWFsICk7XHJcbiAgICBib2F0R3JvdXAuYWRkKCBiYWNrVG9wICk7XHJcblxyXG4gICAgY29uc3QgYmFja01pZGRsZU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7XHJcbiAgICAgIGNvbG9yOiAweDMzRkYzMywgLy8gd2lsbCBiZSByZXBsYWNlZCB3aXRoIGxpcXVpZCBjb2xvciBiZWxvd1xyXG4gICAgICBvcGFjaXR5OiAwLjgsXHJcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlLFxyXG4gICAgICBzaWRlOiBUSFJFRS5CYWNrU2lkZSwgLy8gYmV0dGVyIGFwcGVhcmFuY2Ugd2l0aCB0aGlzXHJcbiAgICAgIGRlcHRoV3JpdGU6IGZhbHNlLFxyXG4gICAgICBjbGlwcGluZ1BsYW5lczogWyBib3R0b21Cb2F0Q2xpcFBsYW5lLCB0b3BQb29sQ2xpcFBsYW5lIF1cclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGJhY2tNaWRkbGUgPSBuZXcgVEhSRUUuTWVzaCggYm9hdE9uZUxpdGVySW50ZXJpb3JHZW9tZXRyeSwgYmFja01pZGRsZU1hdGVyaWFsICk7XHJcbiAgICBib2F0R3JvdXAuYWRkKCBiYWNrTWlkZGxlICk7XHJcblxyXG4gICAgY29uc3QgYmFja0JvdHRvbU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKCB7XHJcbiAgICAgIGNvbG9yOiAweGZmZmZmZixcclxuICAgICAgb3BhY2l0eTogMC40LFxyXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcclxuICAgICAgc2lkZTogVEhSRUUuQmFja1NpZGUsXHJcbiAgICAgIGRlcHRoV3JpdGU6IGZhbHNlLFxyXG4gICAgICBjbGlwcGluZ1BsYW5lczogWyBib3R0b21Cb2F0Q2xpcFBsYW5lLCBib3R0b21Qb29sQ2xpcFBsYW5lIF1cclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGJhY2tCb3R0b20gPSBuZXcgVEhSRUUuTWVzaCggYm9hdE9uZUxpdGVySW50ZXJpb3JHZW9tZXRyeSwgYmFja0JvdHRvbU1hdGVyaWFsICk7XHJcbiAgICBib2F0R3JvdXAuYWRkKCBiYWNrQm90dG9tICk7XHJcblxyXG4gICAgY29uc3QgZnJvbnRFeHRlcmlvck1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKCB7XHJcbiAgICAgIGNvbG9yOiAweGZmZmZmZixcclxuICAgICAgb3BhY2l0eTogMC40LFxyXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcclxuICAgICAgc2lkZTogVEhSRUUuRnJvbnRTaWRlLFxyXG4gICAgICBkZXB0aFdyaXRlOiBmYWxzZVxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgZnJvbnRFeHRlcmlvciA9IG5ldyBUSFJFRS5NZXNoKCBib2F0T25lTGl0ZXJFeHRlcmlvckdlb21ldHJ5LCBmcm9udEV4dGVyaW9yTWF0ZXJpYWwgKTtcclxuICAgIGJvYXRHcm91cC5hZGQoIGZyb250RXh0ZXJpb3IgKTtcclxuXHJcbiAgICBjb25zdCBmcm9udFRvcE1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKCB7XHJcbiAgICAgIGNvbG9yOiAweGZmZmZmZixcclxuICAgICAgb3BhY2l0eTogMC40LFxyXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcclxuICAgICAgc2lkZTogVEhSRUUuRnJvbnRTaWRlLFxyXG4gICAgICBkZXB0aFdyaXRlOiBmYWxzZSxcclxuICAgICAgY2xpcHBpbmdQbGFuZXM6IFsgdG9wQm9hdENsaXBQbGFuZSBdXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBmcm9udFRvcCA9IG5ldyBUSFJFRS5NZXNoKCBib2F0T25lTGl0ZXJJbnRlcmlvckdlb21ldHJ5LCBmcm9udFRvcE1hdGVyaWFsICk7XHJcbiAgICBib2F0R3JvdXAuYWRkKCBmcm9udFRvcCApO1xyXG5cclxuICAgIGNvbnN0IGZyb250Rm9yRGVwdGggPSBuZXcgVEhSRUUuTWVzaCggYm9hdE9uZUxpdGVyR2VvbWV0cnksIG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCgge1xyXG4gICAgICBjb2xvcjogMHhGRjAwMDAsXHJcbiAgICAgIG9wYWNpdHk6IDAsXHJcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlLFxyXG4gICAgICBzaWRlOiBUSFJFRS5Gcm9udFNpZGVcclxuICAgIH0gKSApO1xyXG4gICAgYm9hdEdyb3VwLmFkZCggZnJvbnRGb3JEZXB0aCApO1xyXG5cclxuICAgIGNvbnN0IHRvcExpcXVpZFBvc2l0aW9uQXJyYXkgPSBCb2F0RGVzaWduLmNyZWF0ZUNyb3NzU2VjdGlvblZlcnRleEFycmF5KCk7XHJcbiAgICBjb25zdCB0b3BMaXF1aWROb3JtYWxBcnJheSA9IG5ldyBGbG9hdDMyQXJyYXkoIHRvcExpcXVpZFBvc2l0aW9uQXJyYXkubGVuZ3RoICk7XHJcbiAgICBmb3IgKCBsZXQgaSA9IDE7IGkgPCB0b3BMaXF1aWROb3JtYWxBcnJheS5sZW5ndGg7IGkgKz0gMyApIHtcclxuICAgICAgdG9wTGlxdWlkTm9ybWFsQXJyYXlbIGkgXSA9IDE7IC8vIG5vcm1hbHMgc2hvdWxkIGFsbCBiZSAwLDEsMFxyXG4gICAgfVxyXG4gICAgY29uc3QgdG9wTGlxdWlkR2VvbWV0cnkgPSBuZXcgVEhSRUUuQnVmZmVyR2VvbWV0cnkoKTtcclxuICAgIHRvcExpcXVpZEdlb21ldHJ5LmFkZEF0dHJpYnV0ZSggJ3Bvc2l0aW9uJywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggdG9wTGlxdWlkUG9zaXRpb25BcnJheSwgMyApICk7XHJcbiAgICB0b3BMaXF1aWRHZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdub3JtYWwnLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCB0b3BMaXF1aWROb3JtYWxBcnJheSwgMyApICk7XHJcblxyXG4gICAgY29uc3QgdG9wTGlxdWlkTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoIHtcclxuICAgICAgY29sb3I6IDB4MzNGRjMzLCAvLyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggbGlxdWlkIGNvbG9yIGJlbG93XHJcbiAgICAgIG9wYWNpdHk6IDAuOCxcclxuICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXHJcbiAgICAgIGRlcHRoV3JpdGU6IGZhbHNlXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCB0b3BMaXF1aWQgPSBuZXcgVEhSRUUuTWVzaCggdG9wTGlxdWlkR2VvbWV0cnksIHRvcExpcXVpZE1hdGVyaWFsICk7XHJcbiAgICB0aGlzLmFkZCggdG9wTGlxdWlkICk7XHJcblxyXG4gICAgdGhpcy5saXF1aWRNdWx0aWxpbmsgPSBNdWx0aWxpbmsubXVsdGlsaW5rKCBbXHJcbiAgICAgIGJvYXQuYmFzaW4ubGlxdWlkWUludGVycG9sYXRlZFByb3BlcnR5LFxyXG4gICAgICBib2F0LmRpc3BsYWNlbWVudFZvbHVtZVByb3BlcnR5LFxyXG4gICAgICBib2F0LmJhc2luLmxpcXVpZFZvbHVtZVByb3BlcnR5XHJcbiAgICBdLCAoIGJvYXRMaXF1aWRZLCBib2F0RGlzcGxhY2VtZW50LCBib2F0TGlxdWlkVm9sdW1lICkgPT4ge1xyXG4gICAgICBjb25zdCBwb29sTGlxdWlkWSA9IGxpcXVpZFlJbnRlcnBvbGF0ZWRQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgY29uc3QgbGl0ZXJzID0gYm9hdERpc3BsYWNlbWVudCAvIDAuMDAxO1xyXG5cclxuICAgICAgY29uc3QgcmVsYXRpdmVCb2F0TGlxdWlkWSA9IGJvYXRMaXF1aWRZIC0gYm9hdC5tYXRyaXgudHJhbnNsYXRpb24ueTtcclxuXHJcbiAgICAgIGNvbnN0IG1heGltdW1Wb2x1bWUgPSBib2F0LmJhc2luLmdldEVtcHR5Vm9sdW1lKCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgKTtcclxuICAgICAgY29uc3Qgdm9sdW1lID0gYm9hdC5iYXNpbi5saXF1aWRWb2x1bWVQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgY29uc3QgaXNGdWxsID0gdm9sdW1lID49IG1heGltdW1Wb2x1bWUgLSAxZS03O1xyXG4gICAgICBpZiAoIGJvYXRMaXF1aWRWb2x1bWUgPiAwICYmICggIWlzRnVsbCB8fCBCb2F0RGVzaWduLnNob3VsZEJvYXRXYXRlckRpc3BsYXlJZkZ1bGwoIGxpcXVpZFlJbnRlcnBvbGF0ZWRQcm9wZXJ0eS52YWx1ZSAtIGJvYXQubWF0cml4LnRyYW5zbGF0aW9uLnksIGxpdGVycyApICkgKSB7XHJcbiAgICAgICAgQm9hdERlc2lnbi5maWxsQ3Jvc3NTZWN0aW9uVmVydGV4QXJyYXkoIHJlbGF0aXZlQm9hdExpcXVpZFksIGxpdGVycywgdG9wTGlxdWlkUG9zaXRpb25BcnJheSApO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHRvcExpcXVpZFBvc2l0aW9uQXJyYXkuZmlsbCggMCApO1xyXG4gICAgICB9XHJcbiAgICAgIHRvcExpcXVpZEdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xyXG4gICAgICB0b3BMaXF1aWRHZW9tZXRyeS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKTtcclxuXHJcbiAgICAgIGlmICggYm9hdC5iYXNpbi5saXF1aWRWb2x1bWVQcm9wZXJ0eS52YWx1ZSA+IDFlLTcgKSB7XHJcbiAgICAgICAgYm90dG9tQm9hdENsaXBQbGFuZS5jb25zdGFudCA9IGJvYXRMaXF1aWRZO1xyXG4gICAgICAgIHRvcEJvYXRDbGlwUGxhbmUuY29uc3RhbnQgPSAtYm9hdExpcXVpZFk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgYm90dG9tQm9hdENsaXBQbGFuZS5jb25zdGFudCA9IC0xMDAwO1xyXG4gICAgICAgIHRvcEJvYXRDbGlwUGxhbmUuY29uc3RhbnQgPSAxMDAwO1xyXG4gICAgICB9XHJcbiAgICAgIGJvdHRvbVBvb2xDbGlwUGxhbmUuY29uc3RhbnQgPSBwb29sTGlxdWlkWTtcclxuICAgICAgdG9wUG9vbENsaXBQbGFuZS5jb25zdGFudCA9IC1wb29sTGlxdWlkWTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBNYXRlcmlhbC5saW5rTGlxdWlkQ29sb3IoIGJvYXQubGlxdWlkTWF0ZXJpYWxQcm9wZXJ0eSwgdG9wTGlxdWlkTWF0ZXJpYWwgKTtcclxuICAgIE1hdGVyaWFsLmxpbmtMaXF1aWRDb2xvciggYm9hdC5saXF1aWRNYXRlcmlhbFByb3BlcnR5LCBiYWNrTWlkZGxlTWF0ZXJpYWwgKTtcclxuXHJcbiAgICAvLyBwb29sIGxpcXVpZCB3aWxsIGJlIGF0IGEgaGlnaGVyIHZhbHVlXHJcbiAgICBmcm9udEZvckRlcHRoLnJlbmRlck9yZGVyID0gNDtcclxuICAgIHRvcExpcXVpZC5yZW5kZXJPcmRlciA9IDM7XHJcbiAgICBmcm9udFRvcC5yZW5kZXJPcmRlciA9IDI7XHJcbiAgICBmcm9udEV4dGVyaW9yLnJlbmRlck9yZGVyID0gMTtcclxuICAgIC8vIGJsb2NrIHdpbGwgYmUgYXQgMFxyXG4gICAgYmFja0JvdHRvbS5yZW5kZXJPcmRlciA9IC0xO1xyXG4gICAgYmFja01pZGRsZS5yZW5kZXJPcmRlciA9IC0xO1xyXG4gICAgYmFja1RvcC5yZW5kZXJPcmRlciA9IC0xO1xyXG4gICAgYmFja0V4dGVyaW9yLnJlbmRlck9yZGVyID0gLTI7XHJcblxyXG4gICAgdGhpcy5ib2F0ID0gYm9hdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbGVhc2VzIHJlZmVyZW5jZXMuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICAvLyBUT0RPOiBkaXNwb3NlIGV2ZXJ5dGhpbmcgZnJvbSBhYm92ZVxyXG5cclxuICAgIHRoaXMubGlxdWlkTXVsdGlsaW5rLmRpc3Bvc2UoKTtcclxuXHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5kZW5zaXR5QnVveWFuY3lDb21tb24ucmVnaXN0ZXIoICdCb2F0VmlldycsIEJvYXRWaWV3ICk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQSxPQUFPQSxTQUFTLE1BQTRCLGtDQUFrQztBQUM5RSxPQUFPQyxRQUFRLE1BQU0sZ0NBQWdDO0FBQ3JELE9BQU9DLFFBQVEsTUFBTSwrQkFBK0I7QUFDcEQsT0FBT0MscUJBQXFCLE1BQU0sZ0NBQWdDO0FBRWxFLE9BQU9DLFVBQVUsTUFBTSx3QkFBd0I7QUFFL0MsZUFBZSxNQUFNQyxRQUFRLFNBQVNILFFBQVEsQ0FBQztFQUt0Q0ksV0FBV0EsQ0FBRUMsSUFBVSxFQUFFQywyQkFBc0QsRUFBRztJQUV2RjtJQUNBLEtBQUssQ0FBRUQsSUFBSSxFQUFFLElBQUlFLEtBQUssQ0FBQ0MsUUFB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