// Copyright 2014-2023, University of Colorado Boulder

/**
 * GameFeedbackPanel presents feedback about a user's guess. The format of the feedback is specific to whether
 * the equation is balanced and simplified, balanced but not simplified, or unbalanced.
 *
 * NOTE: While the UX here is similar to a Dialog, there are significant differences that make using Dialog impractical
 * here. See https://github.com/phetsims/balancing-chemical-equations/issues/137 for details.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Property from '../../../../axon/js/Property.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import FaceNode from '../../../../scenery-phet/js/FaceNode.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { HBox, Node, Path, Rectangle, Text, VBox, VStrut } from '../../../../scenery/js/imports.js';
import checkSolidShape from '../../../../sherpa/js/fontawesome-5/checkSolidShape.js';
import timesSolidShape from '../../../../sherpa/js/fontawesome-5/timesSolidShape.js';
import TextPushButton from '../../../../sun/js/buttons/TextPushButton.js';
import Panel from '../../../../sun/js/Panel.js';
import balancingChemicalEquations from '../../balancingChemicalEquations.js';
import BalancingChemicalEquationsStrings from '../../BalancingChemicalEquationsStrings.js';
import BalancedRepresentation from '../../common/model/BalancedRepresentation.js';
import BalanceScalesNode from '../../common/view/BalanceScalesNode.js';
import BarChartsNode from '../../common/view/BarChartsNode.js';
import GameState from '../model/GameState.js';
import optionize from '../../../../phet-core/js/optionize.js';
// constants
const TEXT_FONT = new PhetFont(18);
const STATE_BUTTON_FONT = new PhetFont(20);
const STATE_BUTTON_FILL = 'yellow';
const WHY_BUTTON_FONT = new PhetFont(16);
const WHY_BUTTON_FILL = '#d9d9d9';
const ACTION_AREA_Y_SPACING = 8; // vertical space that separates the 'action area' (buttons) from stuff above it

export default class GameFeedbackPanel extends Node {
  constructor(model, aligner, providedOptions) {
    const options = optionize()({
      // SelfOptions
      fill: '#c1d8fe',
      xMargin: 40,
      yMargin: 10,
      cornerRadius: 0,
      hBoxSpacing: 5,
      vBoxSpacing: 7,
      shadowXOffset: 5,
      shadowYOffset: 5
    }, providedOptions);
    const equation = model.currentEquationProperty.value;
    const balancedRepresentation = model.balancedRepresentation;
    const points = model.currentPoints;
    const maxWidth = 0.75 * aligner.getScreenWidth(); // max width of UI elements
    const textOptions = {
      font: TEXT_FONT,
      maxWidth: maxWidth
    };

    // happy/sad face
    const faceNode = new FaceNode(75);
    if (!equation.balancedProperty.value) {
      faceNode.frown();
    }
    const pointsAwardedStringProperty = new DerivedProperty([BalancingChemicalEquationsStrings.pattern_0pointsStringProperty], pattern => StringUtils.format(pattern, points));
    let content;
    if (equation.balancedAndSimplified) {
      // balanced and simplified
      content = new VBox({
        children: [
        // happy face
        faceNode,
        // check mark + 'balanced'
        new HBox({
          children: [createCorrectIcon(), new Text(BalancingChemicalEquationsStrings.balancedStringProperty, textOptions)],
          spacing: options.hBoxSpacing
        }),
        // points awarded
        new Text(pointsAwardedStringProperty, {
          font: new PhetFont({
            size: 24,
            weight: 'bold'
          }),
          maxWidth: maxWidth
        }),
        // space
        new VStrut(ACTION_AREA_Y_SPACING),
        // Next button
        createStateChangeButton(BalancingChemicalEquationsStrings.nextStringProperty, model.next.bind(model), maxWidth)],
        spacing: options.vBoxSpacing
      });
    } else if (equation.balancedProperty.value) {
      // balanced, not simplified: happy face with 'balance' and 'not simplified' below it
      content = new VBox({
        children: [
        // happy face
        faceNode, new VBox({
          align: 'left',
          spacing: 3,
          children: [
          // check mark + 'balanced'
          new HBox({
            children: [createCorrectIcon(), new Text(BalancingChemicalEquationsStrings.balancedStringProperty, textOptions)],
            spacing: options.hBoxSpacing
          }),
          // red X + 'not simplified'
          new HBox({
            children: [createIncorrectIcon(), new Text(BalancingChemicalEquationsStrings.notSimplifiedStringProperty, textOptions)],
            spacing: options.hBoxSpacing
          })]
        }),
        // space
        new VStrut(ACTION_AREA_Y_SPACING),
        // Try Again or Show Answer button
        createButtonForState(model, maxWidth)],
        spacing: options.vBoxSpacing
      });
    } else {
      // not balanced
      let saveCenterX; // saves the panel's centerX when pressing Show/Hide Why.
      let balancedRepresentationNode = null; // create on demand

      // 'Show Why' button, exposes one of the 'balanced' representations to explain why it's not balanced
      const showWhyButton = new TextPushButton(BalancingChemicalEquationsStrings.showWhyStringProperty, {
        listener: () => {
          showWhyButton.visible = false;
          hideWhyButton.visible = true;
          saveCenterX = this.centerX;
          if (!balancedRepresentationNode) {
            balancedRepresentationNode = createBalancedRepresentation(equation, balancedRepresentation, aligner);
          }
          content.addChild(balancedRepresentationNode);
          this.centerX = saveCenterX;
        },
        font: WHY_BUTTON_FONT,
        baseColor: WHY_BUTTON_FILL,
        visible: true,
        maxWidth: maxWidth
      });

      // 'Hide Why' button, hides the 'balanced' representation
      const hideWhyButton = new TextPushButton(BalancingChemicalEquationsStrings.hideWhyStringProperty, {
        listener: () => {
          showWhyButton.visible = true;
          hideWhyButton.visible = false;
          saveCenterX = this.centerX;
          if (balancedRepresentationNode && content.hasChild(balancedRepresentationNode)) {
            content.removeChild(balancedRepresentationNode);
          }
          this.centerX = saveCenterX;
        },
        font: WHY_BUTTON_FONT,
        baseColor: WHY_BUTTON_FILL,
        visible: !showWhyButton.visible,
        center: showWhyButton.center,
        maxWidth: maxWidth
      });
      content = new VBox({
        children: [
        // sad face
        faceNode,
        // red X + 'not balanced'
        new HBox({
          children: [createIncorrectIcon(), new Text(BalancingChemicalEquationsStrings.notBalancedStringProperty, textOptions)],
          spacing: options.hBoxSpacing
        }),
        // space
        new VStrut(ACTION_AREA_Y_SPACING),
        // Try Again or Show Answer button
        createButtonForState(model, maxWidth),
        // Show/Hide Why buttons
        new Node({
          children: [showWhyButton, hideWhyButton]
        })],
        spacing: options.vBoxSpacing
      });
    }

    // panel, which will resize dynamically
    const panel = new Panel(content, options);

    // shadow
    const shadowNode = new Rectangle(0, 0, 1, 1, {
      fill: 'rgba( 80, 80, 80, 0.12 )',
      cornerRadius: options.cornerRadius
    });
    const updateShadow = () => {
      shadowNode.setRect(panel.left + options.shadowXOffset, panel.top + options.shadowYOffset, panel.width, panel.height);
    };
    content.boundsProperty.lazyLink(updateShadow); // resize shadow when panel changes size
    updateShadow();
    options.children = [shadowNode, panel];
    super(options);
  }
}

/**
 * Creates the icon for a correct answer, a green check mark.
 */
function createCorrectIcon() {
  return new Path(checkSolidShape, {
    scale: 0.08,
    fill: 'rgb( 0, 180, 0 )'
  });
}

/**
 * Creates the icon for an incorrect answer, a red 'X'.
 */
function createIncorrectIcon() {
  return new Path(timesSolidShape, {
    scale: 0.08,
    fill: 'rgb( 252, 104, 0 )'
  });
}

/**
 * Creates a text button that performs a model state change when pressed.
 * @param labelStringProperty
 * @param modelFunction - model function that performs the state change
 * @param maxWidth
 */
function createStateChangeButton(labelStringProperty, modelFunction, maxWidth) {
  return new TextPushButton(labelStringProperty, {
    font: STATE_BUTTON_FONT,
    baseColor: STATE_BUTTON_FILL,
    maxWidth: maxWidth,
    listener: () => modelFunction()
  });
}

/**
 * Creates a button that is appropriate for the current state of the model.
 */
function createButtonForState(model, maxWidth) {
  let button = null;
  const gameState = model.stateProperty.value;
  if (gameState === GameState.TRY_AGAIN) {
    button = createStateChangeButton(BalancingChemicalEquationsStrings.tryAgainStringProperty, model.tryAgain.bind(model), maxWidth);
  } else if (gameState === GameState.SHOW_ANSWER) {
    button = createStateChangeButton(BalancingChemicalEquationsStrings.showAnswerStringProperty, model.showAnswer.bind(model), maxWidth);
  } else {
    throw new Error(`unsupported GameState: ${gameState}`);
  }
  return button;
}

/**
 * Creates the representation of 'balanced' that becomes visible when the 'Show Why' button is pressed.
 */
function createBalancedRepresentation(equation, balancedRepresentation, aligner) {
  let balancedRepresentationNode;
  if (balancedRepresentation === BalancedRepresentation.BALANCE_SCALES) {
    balancedRepresentationNode = new BalanceScalesNode(new Property(equation), aligner);
  } else if (balancedRepresentation === BalancedRepresentation.BAR_CHARTS) {
    balancedRepresentationNode = new BarChartsNode(new Property(equation), aligner);
  } else {
    throw new Error(`unsupported balancedRepresentation: ${balancedRepresentation.name}`);
  }
  balancedRepresentationNode.setScaleMagnitude(0.65); // issue #29, shrink size so that it doesn't cover so much of the screen
  return balancedRepresentationNode;
}
balancingChemicalEquations.register('GameFeedbackPanel', GameFeedbackPanel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIkRlcml2ZWRQcm9wZXJ0eSIsIlN0cmluZ1V0aWxzIiwiRmFjZU5vZGUiLCJQaGV0Rm9udCIsIkhCb3giLCJOb2RlIiwiUGF0aCIsIlJlY3RhbmdsZSIsIlRleHQiLCJWQm94IiwiVlN0cnV0IiwiY2hlY2tTb2xpZFNoYXBlIiwidGltZXNTb2xpZFNoYXBlIiwiVGV4dFB1c2hCdXR0b24iLCJQYW5lbCIsImJhbGFuY2luZ0NoZW1pY2FsRXF1YXRpb25zIiwiQmFsYW5jaW5nQ2hlbWljYWxFcXVhdGlvbnNTdHJpbmdzIiwiQmFsYW5jZWRSZXByZXNlbnRhdGlvbiIsIkJhbGFuY2VTY2FsZXNOb2RlIiwiQmFyQ2hhcnRzTm9kZSIsIkdhbWVTdGF0ZSIsIm9wdGlvbml6ZSIsIlRFWFRfRk9OVCIsIlNUQVRFX0JVVFRPTl9GT05UIiwiU1RBVEVfQlVUVE9OX0ZJTEwiLCJXSFlfQlVUVE9OX0ZPTlQiLCJXSFlfQlVUVE9OX0ZJTEwiLCJBQ1RJT05fQVJFQV9ZX1NQQUNJTkciLCJHYW1lRmVlZGJhY2tQYW5lbCIsImNvbnN0cnVjdG9yIiwibW9kZWwiLCJhbGlnbmVyIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsImZpbGwiLCJ4TWFyZ2luIiwieU1hcmdpbiIsImNvcm5lclJhZGl1cyIsImhCb3hTcGFjaW5nIiwidkJveFNwYWNpbmciLCJzaGFkb3dYT2Zmc2V0Iiwic2hhZG93WU9mZnNldCIsImVxdWF0aW9uIiwiY3VycmVudEVxdWF0aW9uUHJvcGVydHkiLCJ2YWx1ZSIsImJhbGFuY2VkUmVwcmVzZW50YXRpb24iLCJwb2ludHMiLCJjdXJyZW50UG9pbnRzIiwibWF4V2lkdGgiLCJnZXRTY3JlZW5XaWR0aCIsInRleHRPcHRpb25zIiwiZm9udCIsImZhY2VOb2RlIiwiYmFsYW5jZWRQcm9wZXJ0eSIsImZyb3duIiwicG9pbnRzQXdhcmRlZFN0cmluZ1Byb3BlcnR5IiwicGF0dGVybl8wcG9pbnRzU3RyaW5nUHJvcGVydHkiLCJwYXR0ZXJuIiwiZm9ybWF0IiwiY29udGVudCIsImJhbGFuY2VkQW5kU2ltcGxpZmllZCIsImNoaWxkcmVuIiwiY3JlYXRlQ29ycmVjdEljb24iLCJiYWxhbmNlZFN0cmluZ1Byb3BlcnR5Iiwic3BhY2luZyIsInNpemUiLCJ3ZWlnaHQiLCJjcmVhdGVTdGF0ZUNoYW5nZUJ1dHRvbiIsIm5leHRTdHJpbmdQcm9wZXJ0eSIsIm5leHQiLCJiaW5kIiwiYWxpZ24iLCJjcmVhdGVJbmNvcnJlY3RJY29uIiwibm90U2ltcGxpZmllZFN0cmluZ1Byb3BlcnR5IiwiY3JlYXRlQnV0dG9uRm9yU3RhdGUiLCJzYXZlQ2VudGVyWCIsImJhbGFuY2VkUmVwcmVzZW50YXRpb25Ob2RlIiwic2hvd1doeUJ1dHRvbiIsInNob3dXaHlTdHJpbmdQcm9wZXJ0eSIsImxpc3RlbmVyIiwidmlzaWJsZSIsImhpZGVXaHlCdXR0b24iLCJjZW50ZXJYIiwiY3JlYXRlQmFsYW5jZWRSZXByZXNlbnRhdGlvbiIsImFkZENoaWxkIiwiYmFzZUNvbG9yIiwiaGlkZVdoeVN0cmluZ1Byb3BlcnR5IiwiaGFzQ2hpbGQiLCJyZW1vdmVDaGlsZCIsImNlbnRlciIsIm5vdEJhbGFuY2VkU3RyaW5nUHJvcGVydHkiLCJwYW5lbCIsInNoYWRvd05vZGUiLCJ1cGRhdGVTaGFkb3ciLCJzZXRSZWN0IiwibGVmdCIsInRvcCIsIndpZHRoIiwiaGVpZ2h0IiwiYm91bmRzUHJvcGVydHkiLCJsYXp5TGluayIsInNjYWxlIiwibGFiZWxTdHJpbmdQcm9wZXJ0eSIsIm1vZGVsRnVuY3Rpb24iLCJidXR0b24iLCJnYW1lU3RhdGUiLCJzdGF0ZVByb3BlcnR5IiwiVFJZX0FHQUlOIiwidHJ5QWdhaW5TdHJpbmdQcm9wZXJ0eSIsInRyeUFnYWluIiwiU0hPV19BTlNXRVIiLCJzaG93QW5zd2VyU3RyaW5nUHJvcGVydHkiLCJzaG93QW5zd2VyIiwiRXJyb3IiLCJCQUxBTkNFX1NDQUxFUyIsIkJBUl9DSEFSVFMiLCJuYW1lIiwic2V0U2NhbGVNYWduaXR1ZGUiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkdhbWVGZWVkYmFja1BhbmVsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEdhbWVGZWVkYmFja1BhbmVsIHByZXNlbnRzIGZlZWRiYWNrIGFib3V0IGEgdXNlcidzIGd1ZXNzLiBUaGUgZm9ybWF0IG9mIHRoZSBmZWVkYmFjayBpcyBzcGVjaWZpYyB0byB3aGV0aGVyXHJcbiAqIHRoZSBlcXVhdGlvbiBpcyBiYWxhbmNlZCBhbmQgc2ltcGxpZmllZCwgYmFsYW5jZWQgYnV0IG5vdCBzaW1wbGlmaWVkLCBvciB1bmJhbGFuY2VkLlxyXG4gKlxyXG4gKiBOT1RFOiBXaGlsZSB0aGUgVVggaGVyZSBpcyBzaW1pbGFyIHRvIGEgRGlhbG9nLCB0aGVyZSBhcmUgc2lnbmlmaWNhbnQgZGlmZmVyZW5jZXMgdGhhdCBtYWtlIHVzaW5nIERpYWxvZyBpbXByYWN0aWNhbFxyXG4gKiBoZXJlLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2JhbGFuY2luZy1jaGVtaWNhbC1lcXVhdGlvbnMvaXNzdWVzLzEzNyBmb3IgZGV0YWlscy5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgU3RyaW5nVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy91dGlsL1N0cmluZ1V0aWxzLmpzJztcclxuaW1wb3J0IEZhY2VOb2RlIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9GYWNlTm9kZS5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBIQm94LCBOb2RlLCBOb2RlT3B0aW9ucywgTm9kZVRyYW5zbGF0aW9uT3B0aW9ucywgUGF0aCwgUmVjdGFuZ2xlLCBUQ29sb3IsIFRleHQsIFZCb3gsIFZTdHJ1dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBjaGVja1NvbGlkU2hhcGUgZnJvbSAnLi4vLi4vLi4vLi4vc2hlcnBhL2pzL2ZvbnRhd2Vzb21lLTUvY2hlY2tTb2xpZFNoYXBlLmpzJztcclxuaW1wb3J0IHRpbWVzU29saWRTaGFwZSBmcm9tICcuLi8uLi8uLi8uLi9zaGVycGEvanMvZm9udGF3ZXNvbWUtNS90aW1lc1NvbGlkU2hhcGUuanMnO1xyXG5pbXBvcnQgVGV4dFB1c2hCdXR0b24gZnJvbSAnLi4vLi4vLi4vLi4vc3VuL2pzL2J1dHRvbnMvVGV4dFB1c2hCdXR0b24uanMnO1xyXG5pbXBvcnQgUGFuZWwgZnJvbSAnLi4vLi4vLi4vLi4vc3VuL2pzL1BhbmVsLmpzJztcclxuaW1wb3J0IGJhbGFuY2luZ0NoZW1pY2FsRXF1YXRpb25zIGZyb20gJy4uLy4uL2JhbGFuY2luZ0NoZW1pY2FsRXF1YXRpb25zLmpzJztcclxuaW1wb3J0IEJhbGFuY2luZ0NoZW1pY2FsRXF1YXRpb25zU3RyaW5ncyBmcm9tICcuLi8uLi9CYWxhbmNpbmdDaGVtaWNhbEVxdWF0aW9uc1N0cmluZ3MuanMnO1xyXG5pbXBvcnQgQmFsYW5jZWRSZXByZXNlbnRhdGlvbiBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvQmFsYW5jZWRSZXByZXNlbnRhdGlvbi5qcyc7XHJcbmltcG9ydCBCYWxhbmNlU2NhbGVzTm9kZSBmcm9tICcuLi8uLi9jb21tb24vdmlldy9CYWxhbmNlU2NhbGVzTm9kZS5qcyc7XHJcbmltcG9ydCBCYXJDaGFydHNOb2RlIGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L0JhckNoYXJ0c05vZGUuanMnO1xyXG5pbXBvcnQgR2FtZVN0YXRlIGZyb20gJy4uL21vZGVsL0dhbWVTdGF0ZS5qcyc7XHJcbmltcG9ydCBIb3Jpem9udGFsQWxpZ25lciBmcm9tICcuLi8uLi9jb21tb24vdmlldy9Ib3Jpem9udGFsQWxpZ25lci5qcyc7XHJcbmltcG9ydCBHYW1lTW9kZWwgZnJvbSAnLi4vbW9kZWwvR2FtZU1vZGVsLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRXF1YXRpb24gZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0VxdWF0aW9uLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBURVhUX0ZPTlQgPSBuZXcgUGhldEZvbnQoIDE4ICk7XHJcbmNvbnN0IFNUQVRFX0JVVFRPTl9GT05UID0gbmV3IFBoZXRGb250KCAyMCApO1xyXG5jb25zdCBTVEFURV9CVVRUT05fRklMTCA9ICd5ZWxsb3cnO1xyXG5jb25zdCBXSFlfQlVUVE9OX0ZPTlQgPSBuZXcgUGhldEZvbnQoIDE2ICk7XHJcbmNvbnN0IFdIWV9CVVRUT05fRklMTCA9ICcjZDlkOWQ5JztcclxuY29uc3QgQUNUSU9OX0FSRUFfWV9TUEFDSU5HID0gODsgLy8gdmVydGljYWwgc3BhY2UgdGhhdCBzZXBhcmF0ZXMgdGhlICdhY3Rpb24gYXJlYScgKGJ1dHRvbnMpIGZyb20gc3R1ZmYgYWJvdmUgaXRcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgZmlsbD86IFRDb2xvcjtcclxuICB4TWFyZ2luPzogbnVtYmVyO1xyXG4gIHlNYXJnaW4/OiBudW1iZXI7XHJcbiAgY29ybmVyUmFkaXVzPzogbnVtYmVyO1xyXG4gIGhCb3hTcGFjaW5nPzogbnVtYmVyO1xyXG4gIHZCb3hTcGFjaW5nPzogbnVtYmVyO1xyXG4gIHNoYWRvd1hPZmZzZXQ/OiBudW1iZXI7XHJcbiAgc2hhZG93WU9mZnNldD86IG51bWJlcjtcclxufTtcclxuXHJcbnR5cGUgR2FtZUZlZWRiYWNrUGFuZWxPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBOb2RlVHJhbnNsYXRpb25PcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUZlZWRiYWNrUGFuZWwgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBtb2RlbDogR2FtZU1vZGVsLCBhbGlnbmVyOiBIb3Jpem9udGFsQWxpZ25lciwgcHJvdmlkZWRPcHRpb25zPzogR2FtZUZlZWRiYWNrUGFuZWxPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8R2FtZUZlZWRiYWNrUGFuZWxPcHRpb25zLCBTZWxmT3B0aW9ucywgTm9kZU9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIFNlbGZPcHRpb25zXHJcbiAgICAgIGZpbGw6ICcjYzFkOGZlJyxcclxuICAgICAgeE1hcmdpbjogNDAsXHJcbiAgICAgIHlNYXJnaW46IDEwLFxyXG4gICAgICBjb3JuZXJSYWRpdXM6IDAsXHJcbiAgICAgIGhCb3hTcGFjaW5nOiA1LFxyXG4gICAgICB2Qm94U3BhY2luZzogNyxcclxuICAgICAgc2hhZG93WE9mZnNldDogNSxcclxuICAgICAgc2hhZG93WU9mZnNldDogNVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgY29uc3QgZXF1YXRpb24gPSBtb2RlbC5jdXJyZW50RXF1YXRpb25Qcm9wZXJ0eS52YWx1ZTtcclxuICAgIGNvbnN0IGJhbGFuY2VkUmVwcmVzZW50YXRpb24gPSBtb2RlbC5iYWxhbmNlZFJlcHJlc2VudGF0aW9uO1xyXG4gICAgY29uc3QgcG9pbnRzID0gbW9kZWwuY3VycmVudFBvaW50cztcclxuICAgIGNvbnN0IG1heFdpZHRoID0gMC43NSAqIGFsaWduZXIuZ2V0U2NyZWVuV2lkdGgoKTsgLy8gbWF4IHdpZHRoIG9mIFVJIGVsZW1lbnRzXHJcbiAgICBjb25zdCB0ZXh0T3B0aW9ucyA9IHsgZm9udDogVEVYVF9GT05ULCBtYXhXaWR0aDogbWF4V2lkdGggfTtcclxuXHJcbiAgICAvLyBoYXBweS9zYWQgZmFjZVxyXG4gICAgY29uc3QgZmFjZU5vZGUgPSBuZXcgRmFjZU5vZGUoIDc1ICk7XHJcbiAgICBpZiAoICFlcXVhdGlvbi5iYWxhbmNlZFByb3BlcnR5LnZhbHVlICkgeyBmYWNlTm9kZS5mcm93bigpOyB9XHJcblxyXG4gICAgY29uc3QgcG9pbnRzQXdhcmRlZFN0cmluZ1Byb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyBCYWxhbmNpbmdDaGVtaWNhbEVxdWF0aW9uc1N0cmluZ3MucGF0dGVybl8wcG9pbnRzU3RyaW5nUHJvcGVydHkgXSxcclxuICAgICAgcGF0dGVybiA9PiBTdHJpbmdVdGlscy5mb3JtYXQoIHBhdHRlcm4sIHBvaW50cyApXHJcbiAgICApO1xyXG5cclxuICAgIGxldCBjb250ZW50OiBOb2RlO1xyXG4gICAgaWYgKCBlcXVhdGlvbi5iYWxhbmNlZEFuZFNpbXBsaWZpZWQgKSB7XHJcblxyXG4gICAgICAvLyBiYWxhbmNlZCBhbmQgc2ltcGxpZmllZFxyXG4gICAgICBjb250ZW50ID0gbmV3IFZCb3goIHtcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG5cclxuICAgICAgICAgIC8vIGhhcHB5IGZhY2VcclxuICAgICAgICAgIGZhY2VOb2RlLFxyXG5cclxuICAgICAgICAgIC8vIGNoZWNrIG1hcmsgKyAnYmFsYW5jZWQnXHJcbiAgICAgICAgICBuZXcgSEJveCgge1xyXG4gICAgICAgICAgICBjaGlsZHJlbjogWyBjcmVhdGVDb3JyZWN0SWNvbigpLCBuZXcgVGV4dCggQmFsYW5jaW5nQ2hlbWljYWxFcXVhdGlvbnNTdHJpbmdzLmJhbGFuY2VkU3RyaW5nUHJvcGVydHksIHRleHRPcHRpb25zICkgXSxcclxuICAgICAgICAgICAgc3BhY2luZzogb3B0aW9ucy5oQm94U3BhY2luZ1xyXG4gICAgICAgICAgfSApLFxyXG5cclxuICAgICAgICAgIC8vIHBvaW50cyBhd2FyZGVkXHJcbiAgICAgICAgICBuZXcgVGV4dCggcG9pbnRzQXdhcmRlZFN0cmluZ1Byb3BlcnR5LCB7XHJcbiAgICAgICAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCgge1xyXG4gICAgICAgICAgICAgIHNpemU6IDI0LFxyXG4gICAgICAgICAgICAgIHdlaWdodDogJ2JvbGQnXHJcbiAgICAgICAgICAgIH0gKSwgbWF4V2lkdGg6IG1heFdpZHRoXHJcbiAgICAgICAgICB9ICksXHJcblxyXG4gICAgICAgICAgLy8gc3BhY2VcclxuICAgICAgICAgIG5ldyBWU3RydXQoIEFDVElPTl9BUkVBX1lfU1BBQ0lORyApLFxyXG5cclxuICAgICAgICAgIC8vIE5leHQgYnV0dG9uXHJcbiAgICAgICAgICBjcmVhdGVTdGF0ZUNoYW5nZUJ1dHRvbiggQmFsYW5jaW5nQ2hlbWljYWxFcXVhdGlvbnNTdHJpbmdzLm5leHRTdHJpbmdQcm9wZXJ0eSwgbW9kZWwubmV4dC5iaW5kKCBtb2RlbCApLCBtYXhXaWR0aCApXHJcbiAgICAgICAgXSxcclxuICAgICAgICBzcGFjaW5nOiBvcHRpb25zLnZCb3hTcGFjaW5nXHJcbiAgICAgIH0gKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBlcXVhdGlvbi5iYWxhbmNlZFByb3BlcnR5LnZhbHVlICkge1xyXG5cclxuICAgICAgLy8gYmFsYW5jZWQsIG5vdCBzaW1wbGlmaWVkOiBoYXBweSBmYWNlIHdpdGggJ2JhbGFuY2UnIGFuZCAnbm90IHNpbXBsaWZpZWQnIGJlbG93IGl0XHJcbiAgICAgIGNvbnRlbnQgPSBuZXcgVkJveCgge1xyXG4gICAgICAgIGNoaWxkcmVuOiBbXHJcblxyXG4gICAgICAgICAgLy8gaGFwcHkgZmFjZVxyXG4gICAgICAgICAgZmFjZU5vZGUsXHJcbiAgICAgICAgICBuZXcgVkJveCgge1xyXG4gICAgICAgICAgICBhbGlnbjogJ2xlZnQnLFxyXG4gICAgICAgICAgICBzcGFjaW5nOiAzLFxyXG4gICAgICAgICAgICBjaGlsZHJlbjogW1xyXG5cclxuICAgICAgICAgICAgICAvLyBjaGVjayBtYXJrICsgJ2JhbGFuY2VkJ1xyXG4gICAgICAgICAgICAgIG5ldyBIQm94KCB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogWyBjcmVhdGVDb3JyZWN0SWNvbigpLCBuZXcgVGV4dCggQmFsYW5jaW5nQ2hlbWljYWxFcXVhdGlvbnNTdHJpbmdzLmJhbGFuY2VkU3RyaW5nUHJvcGVydHksIHRleHRPcHRpb25zICkgXSxcclxuICAgICAgICAgICAgICAgIHNwYWNpbmc6IG9wdGlvbnMuaEJveFNwYWNpbmdcclxuICAgICAgICAgICAgICB9ICksXHJcblxyXG4gICAgICAgICAgICAgIC8vIHJlZCBYICsgJ25vdCBzaW1wbGlmaWVkJ1xyXG4gICAgICAgICAgICAgIG5ldyBIQm94KCB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogWyBjcmVhdGVJbmNvcnJlY3RJY29uKCksIG5ldyBUZXh0KCBCYWxhbmNpbmdDaGVtaWNhbEVxdWF0aW9uc1N0cmluZ3Mubm90U2ltcGxpZmllZFN0cmluZ1Byb3BlcnR5LCB0ZXh0T3B0aW9ucyApIF0sXHJcbiAgICAgICAgICAgICAgICBzcGFjaW5nOiBvcHRpb25zLmhCb3hTcGFjaW5nXHJcbiAgICAgICAgICAgICAgfSApXHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICAgIH0gKSxcclxuXHJcbiAgICAgICAgICAvLyBzcGFjZVxyXG4gICAgICAgICAgbmV3IFZTdHJ1dCggQUNUSU9OX0FSRUFfWV9TUEFDSU5HICksXHJcblxyXG4gICAgICAgICAgLy8gVHJ5IEFnYWluIG9yIFNob3cgQW5zd2VyIGJ1dHRvblxyXG4gICAgICAgICAgY3JlYXRlQnV0dG9uRm9yU3RhdGUoIG1vZGVsLCBtYXhXaWR0aCApXHJcbiAgICAgICAgXSxcclxuICAgICAgICBzcGFjaW5nOiBvcHRpb25zLnZCb3hTcGFjaW5nXHJcbiAgICAgIH0gKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG5cclxuICAgICAgLy8gbm90IGJhbGFuY2VkXHJcbiAgICAgIGxldCBzYXZlQ2VudGVyWDsgLy8gc2F2ZXMgdGhlIHBhbmVsJ3MgY2VudGVyWCB3aGVuIHByZXNzaW5nIFNob3cvSGlkZSBXaHkuXHJcbiAgICAgIGxldCBiYWxhbmNlZFJlcHJlc2VudGF0aW9uTm9kZTogTm9kZSB8IG51bGwgPSBudWxsOyAvLyBjcmVhdGUgb24gZGVtYW5kXHJcblxyXG4gICAgICAvLyAnU2hvdyBXaHknIGJ1dHRvbiwgZXhwb3NlcyBvbmUgb2YgdGhlICdiYWxhbmNlZCcgcmVwcmVzZW50YXRpb25zIHRvIGV4cGxhaW4gd2h5IGl0J3Mgbm90IGJhbGFuY2VkXHJcbiAgICAgIGNvbnN0IHNob3dXaHlCdXR0b24gPSBuZXcgVGV4dFB1c2hCdXR0b24oIEJhbGFuY2luZ0NoZW1pY2FsRXF1YXRpb25zU3RyaW5ncy5zaG93V2h5U3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgICBsaXN0ZW5lcjogKCkgPT4ge1xyXG4gICAgICAgICAgc2hvd1doeUJ1dHRvbi52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICBoaWRlV2h5QnV0dG9uLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgc2F2ZUNlbnRlclggPSB0aGlzLmNlbnRlclg7XHJcbiAgICAgICAgICBpZiAoICFiYWxhbmNlZFJlcHJlc2VudGF0aW9uTm9kZSApIHtcclxuICAgICAgICAgICAgYmFsYW5jZWRSZXByZXNlbnRhdGlvbk5vZGUgPSBjcmVhdGVCYWxhbmNlZFJlcHJlc2VudGF0aW9uKCBlcXVhdGlvbiwgYmFsYW5jZWRSZXByZXNlbnRhdGlvbiwgYWxpZ25lciApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY29udGVudC5hZGRDaGlsZCggYmFsYW5jZWRSZXByZXNlbnRhdGlvbk5vZGUgKTtcclxuICAgICAgICAgIHRoaXMuY2VudGVyWCA9IHNhdmVDZW50ZXJYO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZm9udDogV0hZX0JVVFRPTl9GT05ULFxyXG4gICAgICAgIGJhc2VDb2xvcjogV0hZX0JVVFRPTl9GSUxMLFxyXG4gICAgICAgIHZpc2libGU6IHRydWUsXHJcbiAgICAgICAgbWF4V2lkdGg6IG1heFdpZHRoXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAgIC8vICdIaWRlIFdoeScgYnV0dG9uLCBoaWRlcyB0aGUgJ2JhbGFuY2VkJyByZXByZXNlbnRhdGlvblxyXG4gICAgICBjb25zdCBoaWRlV2h5QnV0dG9uID0gbmV3IFRleHRQdXNoQnV0dG9uKCBCYWxhbmNpbmdDaGVtaWNhbEVxdWF0aW9uc1N0cmluZ3MuaGlkZVdoeVN0cmluZ1Byb3BlcnR5LCB7XHJcbiAgICAgICAgbGlzdGVuZXI6ICgpID0+IHtcclxuICAgICAgICAgIHNob3dXaHlCdXR0b24udmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICBoaWRlV2h5QnV0dG9uLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgIHNhdmVDZW50ZXJYID0gdGhpcy5jZW50ZXJYO1xyXG4gICAgICAgICAgaWYgKCBiYWxhbmNlZFJlcHJlc2VudGF0aW9uTm9kZSAmJiBjb250ZW50Lmhhc0NoaWxkKCBiYWxhbmNlZFJlcHJlc2VudGF0aW9uTm9kZSApICkge1xyXG4gICAgICAgICAgICBjb250ZW50LnJlbW92ZUNoaWxkKCBiYWxhbmNlZFJlcHJlc2VudGF0aW9uTm9kZSApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5jZW50ZXJYID0gc2F2ZUNlbnRlclg7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmb250OiBXSFlfQlVUVE9OX0ZPTlQsXHJcbiAgICAgICAgYmFzZUNvbG9yOiBXSFlfQlVUVE9OX0ZJTEwsXHJcbiAgICAgICAgdmlzaWJsZTogIXNob3dXaHlCdXR0b24udmlzaWJsZSxcclxuICAgICAgICBjZW50ZXI6IHNob3dXaHlCdXR0b24uY2VudGVyLFxyXG4gICAgICAgIG1heFdpZHRoOiBtYXhXaWR0aFxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICBjb250ZW50ID0gbmV3IFZCb3goIHtcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG5cclxuICAgICAgICAgIC8vIHNhZCBmYWNlXHJcbiAgICAgICAgICBmYWNlTm9kZSxcclxuXHJcbiAgICAgICAgICAvLyByZWQgWCArICdub3QgYmFsYW5jZWQnXHJcbiAgICAgICAgICBuZXcgSEJveCgge1xyXG4gICAgICAgICAgICBjaGlsZHJlbjogWyBjcmVhdGVJbmNvcnJlY3RJY29uKCksIG5ldyBUZXh0KCBCYWxhbmNpbmdDaGVtaWNhbEVxdWF0aW9uc1N0cmluZ3Mubm90QmFsYW5jZWRTdHJpbmdQcm9wZXJ0eSwgdGV4dE9wdGlvbnMgKSBdLFxyXG4gICAgICAgICAgICBzcGFjaW5nOiBvcHRpb25zLmhCb3hTcGFjaW5nXHJcbiAgICAgICAgICB9ICksXHJcblxyXG4gICAgICAgICAgLy8gc3BhY2VcclxuICAgICAgICAgIG5ldyBWU3RydXQoIEFDVElPTl9BUkVBX1lfU1BBQ0lORyApLFxyXG5cclxuICAgICAgICAgIC8vIFRyeSBBZ2FpbiBvciBTaG93IEFuc3dlciBidXR0b25cclxuICAgICAgICAgIGNyZWF0ZUJ1dHRvbkZvclN0YXRlKCBtb2RlbCwgbWF4V2lkdGggKSxcclxuXHJcbiAgICAgICAgICAvLyBTaG93L0hpZGUgV2h5IGJ1dHRvbnNcclxuICAgICAgICAgIG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIHNob3dXaHlCdXR0b24sIGhpZGVXaHlCdXR0b24gXSB9IClcclxuICAgICAgICBdLFxyXG4gICAgICAgIHNwYWNpbmc6IG9wdGlvbnMudkJveFNwYWNpbmdcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHBhbmVsLCB3aGljaCB3aWxsIHJlc2l6ZSBkeW5hbWljYWxseVxyXG4gICAgY29uc3QgcGFuZWwgPSBuZXcgUGFuZWwoIGNvbnRlbnQsIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBzaGFkb3dcclxuICAgIGNvbnN0IHNoYWRvd05vZGUgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCAxLCAxLCB7XHJcbiAgICAgIGZpbGw6ICdyZ2JhKCA4MCwgODAsIDgwLCAwLjEyICknLFxyXG4gICAgICBjb3JuZXJSYWRpdXM6IG9wdGlvbnMuY29ybmVyUmFkaXVzXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCB1cGRhdGVTaGFkb3cgPSAoKSA9PiB7XHJcbiAgICAgIHNoYWRvd05vZGUuc2V0UmVjdCggcGFuZWwubGVmdCArIG9wdGlvbnMuc2hhZG93WE9mZnNldCwgcGFuZWwudG9wICsgb3B0aW9ucy5zaGFkb3dZT2Zmc2V0LCBwYW5lbC53aWR0aCwgcGFuZWwuaGVpZ2h0ICk7XHJcbiAgICB9O1xyXG4gICAgY29udGVudC5ib3VuZHNQcm9wZXJ0eS5sYXp5TGluayggdXBkYXRlU2hhZG93ICk7IC8vIHJlc2l6ZSBzaGFkb3cgd2hlbiBwYW5lbCBjaGFuZ2VzIHNpemVcclxuICAgIHVwZGF0ZVNoYWRvdygpO1xyXG5cclxuICAgIG9wdGlvbnMuY2hpbGRyZW4gPSBbIHNoYWRvd05vZGUsIHBhbmVsIF07XHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgdGhlIGljb24gZm9yIGEgY29ycmVjdCBhbnN3ZXIsIGEgZ3JlZW4gY2hlY2sgbWFyay5cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZUNvcnJlY3RJY29uKCk6IE5vZGUge1xyXG4gIHJldHVybiBuZXcgUGF0aCggY2hlY2tTb2xpZFNoYXBlLCB7XHJcbiAgICBzY2FsZTogMC4wOCxcclxuICAgIGZpbGw6ICdyZ2IoIDAsIDE4MCwgMCApJ1xyXG4gIH0gKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgdGhlIGljb24gZm9yIGFuIGluY29ycmVjdCBhbnN3ZXIsIGEgcmVkICdYJy5cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZUluY29ycmVjdEljb24oKTogTm9kZSB7XHJcbiAgcmV0dXJuIG5ldyBQYXRoKCB0aW1lc1NvbGlkU2hhcGUsIHtcclxuICAgIHNjYWxlOiAwLjA4LFxyXG4gICAgZmlsbDogJ3JnYiggMjUyLCAxMDQsIDAgKSdcclxuICB9ICk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgdGV4dCBidXR0b24gdGhhdCBwZXJmb3JtcyBhIG1vZGVsIHN0YXRlIGNoYW5nZSB3aGVuIHByZXNzZWQuXHJcbiAqIEBwYXJhbSBsYWJlbFN0cmluZ1Byb3BlcnR5XHJcbiAqIEBwYXJhbSBtb2RlbEZ1bmN0aW9uIC0gbW9kZWwgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyB0aGUgc3RhdGUgY2hhbmdlXHJcbiAqIEBwYXJhbSBtYXhXaWR0aFxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlU3RhdGVDaGFuZ2VCdXR0b24oIGxhYmVsU3RyaW5nUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbEZ1bmN0aW9uOiAoKSA9PiB2b2lkLCBtYXhXaWR0aDogbnVtYmVyICk6IFRleHRQdXNoQnV0dG9uIHtcclxuICByZXR1cm4gbmV3IFRleHRQdXNoQnV0dG9uKCBsYWJlbFN0cmluZ1Byb3BlcnR5LCB7XHJcbiAgICBmb250OiBTVEFURV9CVVRUT05fRk9OVCxcclxuICAgIGJhc2VDb2xvcjogU1RBVEVfQlVUVE9OX0ZJTEwsXHJcbiAgICBtYXhXaWR0aDogbWF4V2lkdGgsXHJcbiAgICBsaXN0ZW5lcjogKCkgPT4gbW9kZWxGdW5jdGlvbigpXHJcbiAgfSApO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhIGJ1dHRvbiB0aGF0IGlzIGFwcHJvcHJpYXRlIGZvciB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgbW9kZWwuXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVCdXR0b25Gb3JTdGF0ZSggbW9kZWw6IEdhbWVNb2RlbCwgbWF4V2lkdGg6IG51bWJlciApOiBUZXh0UHVzaEJ1dHRvbiB7XHJcbiAgbGV0IGJ1dHRvbiA9IG51bGw7XHJcbiAgY29uc3QgZ2FtZVN0YXRlID0gbW9kZWwuc3RhdGVQcm9wZXJ0eS52YWx1ZTtcclxuICBpZiAoIGdhbWVTdGF0ZSA9PT0gR2FtZVN0YXRlLlRSWV9BR0FJTiApIHtcclxuICAgIGJ1dHRvbiA9IGNyZWF0ZVN0YXRlQ2hhbmdlQnV0dG9uKCBCYWxhbmNpbmdDaGVtaWNhbEVxdWF0aW9uc1N0cmluZ3MudHJ5QWdhaW5TdHJpbmdQcm9wZXJ0eSxcclxuICAgICAgbW9kZWwudHJ5QWdhaW4uYmluZCggbW9kZWwgKSwgbWF4V2lkdGggKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIGdhbWVTdGF0ZSA9PT0gR2FtZVN0YXRlLlNIT1dfQU5TV0VSICkge1xyXG4gICAgYnV0dG9uID0gY3JlYXRlU3RhdGVDaGFuZ2VCdXR0b24oIEJhbGFuY2luZ0NoZW1pY2FsRXF1YXRpb25zU3RyaW5ncy5zaG93QW5zd2VyU3RyaW5nUHJvcGVydHksXHJcbiAgICAgIG1vZGVsLnNob3dBbnN3ZXIuYmluZCggbW9kZWwgKSwgbWF4V2lkdGggKTtcclxuICB9XHJcbiAgZWxzZSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoIGB1bnN1cHBvcnRlZCBHYW1lU3RhdGU6ICR7Z2FtZVN0YXRlfWAgKTtcclxuICB9XHJcbiAgcmV0dXJuIGJ1dHRvbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgdGhlIHJlcHJlc2VudGF0aW9uIG9mICdiYWxhbmNlZCcgdGhhdCBiZWNvbWVzIHZpc2libGUgd2hlbiB0aGUgJ1Nob3cgV2h5JyBidXR0b24gaXMgcHJlc3NlZC5cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZUJhbGFuY2VkUmVwcmVzZW50YXRpb24oIGVxdWF0aW9uOiBFcXVhdGlvbiwgYmFsYW5jZWRSZXByZXNlbnRhdGlvbjogQmFsYW5jZWRSZXByZXNlbnRhdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ25lcjogSG9yaXpvbnRhbEFsaWduZXIgKTogTm9kZSB7XHJcbiAgbGV0IGJhbGFuY2VkUmVwcmVzZW50YXRpb25Ob2RlO1xyXG4gIGlmICggYmFsYW5jZWRSZXByZXNlbnRhdGlvbiA9PT0gQmFsYW5jZWRSZXByZXNlbnRhdGlvbi5CQUxBTkNFX1NDQUxFUyApIHtcclxuICAgIGJhbGFuY2VkUmVwcmVzZW50YXRpb25Ob2RlID0gbmV3IEJhbGFuY2VTY2FsZXNOb2RlKCBuZXcgUHJvcGVydHkoIGVxdWF0aW9uICksIGFsaWduZXIgKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIGJhbGFuY2VkUmVwcmVzZW50YXRpb24gPT09IEJhbGFuY2VkUmVwcmVzZW50YXRpb24uQkFSX0NIQVJUUyApIHtcclxuICAgIGJhbGFuY2VkUmVwcmVzZW50YXRpb25Ob2RlID0gbmV3IEJhckNoYXJ0c05vZGUoIG5ldyBQcm9wZXJ0eSggZXF1YXRpb24gKSwgYWxpZ25lciApO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIHRocm93IG5ldyBFcnJvciggYHVuc3VwcG9ydGVkIGJhbGFuY2VkUmVwcmVzZW50YXRpb246ICR7YmFsYW5jZWRSZXByZXNlbnRhdGlvbi5uYW1lfWAgKTtcclxuICB9XHJcbiAgYmFsYW5jZWRSZXByZXNlbnRhdGlvbk5vZGUuc2V0U2NhbGVNYWduaXR1ZGUoIDAuNjUgKTsgLy8gaXNzdWUgIzI5LCBzaHJpbmsgc2l6ZSBzbyB0aGF0IGl0IGRvZXNuJ3QgY292ZXIgc28gbXVjaCBvZiB0aGUgc2NyZWVuXHJcbiAgcmV0dXJuIGJhbGFuY2VkUmVwcmVzZW50YXRpb25Ob2RlO1xyXG59XHJcblxyXG5iYWxhbmNpbmdDaGVtaWNhbEVxdWF0aW9ucy5yZWdpc3RlciggJ0dhbWVGZWVkYmFja1BhbmVsJywgR2FtZUZlZWRiYWNrUGFuZWwgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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