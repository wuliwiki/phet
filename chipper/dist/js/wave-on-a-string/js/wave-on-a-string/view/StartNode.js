// Copyright 2013-2023, University of Colorado Boulder

/**
 * Left-side "start" view (wrench/oscillator/pulse)
 *
 * @author Anton Ulyanov (Mlearner)
 */

import Bounds2 from '../../../../dot/js/Bounds2.js';
import Matrix3, { m3 } from '../../../../dot/js/Matrix3.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import { Shape } from '../../../../kite/js/imports.js';
import merge from '../../../../phet-core/js/merge.js';
import platform from '../../../../phet-core/js/platform.js';
import ArrowNode from '../../../../scenery-phet/js/ArrowNode.js';
import ShadedRectangle from '../../../../scenery-phet/js/ShadedRectangle.js';
import { Circle, Color, DragListener, Image, Line, LinearGradient, Node, RadialGradient, Rectangle } from '../../../../scenery/js/imports.js';
import wrench_png from '../../../images/wrench_png.js';
import waveOnAString from '../../waveOnAString.js';
import Constants from '../Constants.js';
import WOASModel from '../model/WOASModel.js';
import PulseButton from './PulseButton.js';
class StartNode extends Node {
  /**
   * @param {WOASModel} model
   * @param {Emitter} frameEmitter
   * @param {Object} [options]
   */
  constructor(model, frameEmitter, options) {
    options = merge({
      layerSplit: true
    }, options);
    const postNodeHeight = 158;
    const postScale = 3;
    super();

    /*---------------------------------------------------------------------------*
     * Oscillation wheel
     *----------------------------------------------------------------------------*/
    const wheelRadius = 29.5;
    let wheel = new Circle(wheelRadius, {
      stroke: '#333',
      lineWidth: 1.5,
      fill: new LinearGradient(-wheelRadius, 0, wheelRadius, 0).addColorStop(0, 'rgb(215,210,210)').addColorStop(1, 'rgb(215,210,210)')
    });
    const innerWheelRadius = 4.8;
    wheel.addChild(new Circle(innerWheelRadius, {
      stroke: '#333',
      lineWidth: 1.5,
      fill: '#fff'
    }));
    wheel.addChild(new Line(-innerWheelRadius, 0, innerWheelRadius, 0, {
      stroke: '#333',
      lineWidth: 1.5
    }));
    wheel.addChild(new Circle(innerWheelRadius, {
      x: innerWheelRadius * 1.5 - wheelRadius,
      stroke: '#333',
      lineWidth: 0.5,
      fill: new RadialGradient(0, 0, 0, 0, 0, innerWheelRadius).addColorStop(0.2, '#555').addColorStop(1, '#555')
    }));

    // toImage* style conversion of the wheel if necessary for performance
    const wheelImageScale = 3;
    wheel.scale(wheelImageScale);
    const wheelSize = Math.ceil(wheel.width / 2) + 2;
    wheel = wheel.toDataURLNodeSynchronous(wheelSize, wheelSize, 2 * wheelSize, 2 * wheelSize);
    if (platform.firefox) {
      wheel.renderer = 'canvas';
    }

    /*---------------------------------------------------------------------------*
     * Wrench
     *----------------------------------------------------------------------------*/
    const wrenchImageNode = new Image(wrench_png, {
      x: -40,
      y: -24,
      scale: 0.9 / 4,
      pickable: false
    });
    const wrenchArrowOptions = {
      fill: 'hsl(210,90%,60%)',
      tailWidth: 10,
      headWidth: 22,
      headHeight: 18
    };
    const wrenchArrowXOffset = 8;
    const wrenchArrowYOffset = 10;
    const wrenchTopArrow = new ArrowNode(wrenchImageNode.centerX + wrenchArrowXOffset, wrenchImageNode.top - wrenchArrowYOffset, wrenchImageNode.centerX + wrenchArrowXOffset, wrenchImageNode.top - 30 - wrenchArrowYOffset, wrenchArrowOptions);
    const wrenchBottomArrow = new ArrowNode(wrenchImageNode.centerX + wrenchArrowXOffset, wrenchImageNode.bottom + wrenchArrowYOffset, wrenchImageNode.centerX + wrenchArrowXOffset, wrenchImageNode.bottom + 30 + wrenchArrowYOffset, wrenchArrowOptions);
    const wrench = new Node({
      children: [wrenchImageNode, wrenchTopArrow, wrenchBottomArrow],
      cursor: 'pointer'
    });
    wrenchTopArrow.touchArea = wrenchTopArrow.localBounds.dilated(6);
    wrenchBottomArrow.touchArea = wrenchBottomArrow.localBounds.dilated(6);
    wrench.touchArea = Shape.bounds(wrenchImageNode.bounds.dilated(Constants.dilatedTouchArea));
    wrench.mouseArea = Shape.bounds(wrenchImageNode.bounds);

    /*---------------------------------------------------------------------------*
     * Post
     *----------------------------------------------------------------------------*/
    let post = new Rectangle(Constants.offsetWheel.x - 5, 0, 10, postNodeHeight, {
      stroke: '#000',
      fill: Constants.postGradient
    });

    /*---------------------------------------------------------------------------*
     * Piston Box
     *----------------------------------------------------------------------------*/
    const pistonBox = new ShadedRectangle(Bounds2.point(Constants.offsetWheel.x, Constants.offsetWheel.y).dilatedXY(40, 25), {
      baseColor: new Color(200, 200, 200),
      lightFactor: 0.5,
      lighterFactor: 0.1,
      darkFactor: 0.5,
      darkerFactor: 0.1,
      cornerRadius: 6
    });
    pistonBox.addChild(new PulseButton(model, {
      center: pistonBox.center,
      tandem: options.tandem.createTandem('pulseButton')
    }));

    // cache the post as an image, since otherwise with the current Scenery its gradient is updated every frame in the defs (NOTE: remove this with Scenery 0.2?)
    const postCache = new Node({
      scale: 1 / postScale
    });
    new Node({
      children: [post],
      scale: postScale
    }).toImageNodeAsynchronous(image => {
      postCache.addChild(image);
    });
    post = new Node({
      children: [postCache]
    });
    this.children = [post, pistonBox, wrench, new Node({
      children: [wheel],
      translation: Constants.offsetWheel
    })];
    let clickOffset = new Vector2(0, 0);
    wrench.addInputListener(new DragListener({
      tandem: options.tandem.createTandem('wrenchDragListener'),
      start: event => {
        clickOffset = wrench.globalToParentPoint(event.pointer.point).minus(event.currentTarget.translation);
        if (event.target !== wrenchTopArrow && event.target !== wrenchBottomArrow) {
          model.wrenchArrowsVisibleProperty.value = false;
        }
      },
      drag: event => {
        const point = wrench.globalToParentPoint(event.pointer.point).minus(clickOffset);
        model.nextLeftYProperty.value = Math.max(Math.min(point.y, options.range.max), options.range.min);
        model.isPlayingProperty.value = true;
        model.yNowChangedEmitter.emit();
      },
      end: () => {
        model.wrenchArrowsVisibleProperty.value = false;
      }
    }));
    model.wrenchArrowsVisibleProperty.link(visible => {
      wrenchTopArrow.visible = visible;
      wrenchBottomArrow.visible = visible;
    });
    this.mutate(options);
    const updateKey = () => {
      if (wrench.isVisible()) {
        wrench.y = model.yNow[0];
      }
    };
    const updatePost = () => {
      const y = model.yNow[0];
      if (post.isVisible()) {
        post.matrix = m3(1, 0, 0, 0, (Constants.offsetWheel.y - (y + 7)) / postNodeHeight, y + 7, 0, 0, 1);
      }
    };
    let dirty = true;
    model.yNowChangedEmitter.addListener(() => {
      dirty = true;
    });
    frameEmitter.addListener(() => {
      if (dirty) {
        updateKey();
        updatePost();
        dirty = false;
      }
    });
    const wheelScaleMatrix = Matrix3.scale(1 / wheelImageScale);
    model.angleProperty.link(angle => {
      wheel.matrix = Matrix3.rotation2(angle).timesMatrix(wheelScaleMatrix); // doesn't need to compute current transform, or do matrix multiplication
    });

    model.waveModeProperty.link(mode => {
      const wrenchIsVisible = mode === WOASModel.Mode.MANUAL;
      if (wrench.isVisible() !== wrenchIsVisible) {
        wrench.visible = wrenchIsVisible;
        updateKey();
      }
      const postIsVisible = mode !== WOASModel.Mode.MANUAL;
      if (post.isVisible() !== postIsVisible) {
        post.visible = postIsVisible;
        updatePost();
      }
      wheel.visible = mode === WOASModel.Mode.OSCILLATE;
      pistonBox.visible = mode === WOASModel.Mode.PULSE;
    });
  }
}
waveOnAString.register('StartNode', StartNode);
export default StartNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb3VuZHMyIiwiTWF0cml4MyIsIm0zIiwiVmVjdG9yMiIsIlNoYXBlIiwibWVyZ2UiLCJwbGF0Zm9ybSIsIkFycm93Tm9kZSIsIlNoYWRlZFJlY3RhbmdsZSIsIkNpcmNsZSIsIkNvbG9yIiwiRHJhZ0xpc3RlbmVyIiwiSW1hZ2UiLCJMaW5lIiwiTGluZWFyR3JhZGllbnQiLCJOb2RlIiwiUmFkaWFsR3JhZGllbnQiLCJSZWN0YW5nbGUiLCJ3cmVuY2hfcG5nIiwid2F2ZU9uQVN0cmluZyIsIkNvbnN0YW50cyIsIldPQVNNb2RlbCIsIlB1bHNlQnV0dG9uIiwiU3RhcnROb2RlIiwiY29uc3RydWN0b3IiLCJtb2RlbCIsImZyYW1lRW1pdHRlciIsIm9wdGlvbnMiLCJsYXllclNwbGl0IiwicG9zdE5vZGVIZWlnaHQiLCJwb3N0U2NhbGUiLCJ3aGVlbFJhZGl1cyIsIndoZWVsIiwic3Ryb2tlIiwibGluZVdpZHRoIiwiZmlsbCIsImFkZENvbG9yU3RvcCIsImlubmVyV2hlZWxSYWRpdXMiLCJhZGRDaGlsZCIsIngiLCJ3aGVlbEltYWdlU2NhbGUiLCJzY2FsZSIsIndoZWVsU2l6ZSIsIk1hdGgiLCJjZWlsIiwid2lkdGgiLCJ0b0RhdGFVUkxOb2RlU3luY2hyb25vdXMiLCJmaXJlZm94IiwicmVuZGVyZXIiLCJ3cmVuY2hJbWFnZU5vZGUiLCJ5IiwicGlja2FibGUiLCJ3cmVuY2hBcnJvd09wdGlvbnMiLCJ0YWlsV2lkdGgiLCJoZWFkV2lkdGgiLCJoZWFkSGVpZ2h0Iiwid3JlbmNoQXJyb3dYT2Zmc2V0Iiwid3JlbmNoQXJyb3dZT2Zmc2V0Iiwid3JlbmNoVG9wQXJyb3ciLCJjZW50ZXJYIiwidG9wIiwid3JlbmNoQm90dG9tQXJyb3ciLCJib3R0b20iLCJ3cmVuY2giLCJjaGlsZHJlbiIsImN1cnNvciIsInRvdWNoQXJlYSIsImxvY2FsQm91bmRzIiwiZGlsYXRlZCIsImJvdW5kcyIsImRpbGF0ZWRUb3VjaEFyZWEiLCJtb3VzZUFyZWEiLCJwb3N0Iiwib2Zmc2V0V2hlZWwiLCJwb3N0R3JhZGllbnQiLCJwaXN0b25Cb3giLCJwb2ludCIsImRpbGF0ZWRYWSIsImJhc2VDb2xvciIsImxpZ2h0RmFjdG9yIiwibGlnaHRlckZhY3RvciIsImRhcmtGYWN0b3IiLCJkYXJrZXJGYWN0b3IiLCJjb3JuZXJSYWRpdXMiLCJjZW50ZXIiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJwb3N0Q2FjaGUiLCJ0b0ltYWdlTm9kZUFzeW5jaHJvbm91cyIsImltYWdlIiwidHJhbnNsYXRpb24iLCJjbGlja09mZnNldCIsImFkZElucHV0TGlzdGVuZXIiLCJzdGFydCIsImV2ZW50IiwiZ2xvYmFsVG9QYXJlbnRQb2ludCIsInBvaW50ZXIiLCJtaW51cyIsImN1cnJlbnRUYXJnZXQiLCJ0YXJnZXQiLCJ3cmVuY2hBcnJvd3NWaXNpYmxlUHJvcGVydHkiLCJ2YWx1ZSIsImRyYWciLCJuZXh0TGVmdFlQcm9wZXJ0eSIsIm1heCIsIm1pbiIsInJhbmdlIiwiaXNQbGF5aW5nUHJvcGVydHkiLCJ5Tm93Q2hhbmdlZEVtaXR0ZXIiLCJlbWl0IiwiZW5kIiwibGluayIsInZpc2libGUiLCJtdXRhdGUiLCJ1cGRhdGVLZXkiLCJpc1Zpc2libGUiLCJ5Tm93IiwidXBkYXRlUG9zdCIsIm1hdHJpeCIsImRpcnR5IiwiYWRkTGlzdGVuZXIiLCJ3aGVlbFNjYWxlTWF0cml4IiwiYW5nbGVQcm9wZXJ0eSIsImFuZ2xlIiwicm90YXRpb24yIiwidGltZXNNYXRyaXgiLCJ3YXZlTW9kZVByb3BlcnR5IiwibW9kZSIsIndyZW5jaElzVmlzaWJsZSIsIk1vZGUiLCJNQU5VQUwiLCJwb3N0SXNWaXNpYmxlIiwiT1NDSUxMQVRFIiwiUFVMU0UiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlN0YXJ0Tm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBMZWZ0LXNpZGUgXCJzdGFydFwiIHZpZXcgKHdyZW5jaC9vc2NpbGxhdG9yL3B1bHNlKVxyXG4gKlxyXG4gKiBAYXV0aG9yIEFudG9uIFVseWFub3YgKE1sZWFybmVyKVxyXG4gKi9cclxuXHJcbmltcG9ydCBCb3VuZHMyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9Cb3VuZHMyLmpzJztcclxuaW1wb3J0IE1hdHJpeDMsIHsgbTMgfSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvTWF0cml4My5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IHBsYXRmb3JtIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9wbGF0Zm9ybS5qcyc7XHJcbmltcG9ydCBBcnJvd05vZGUgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL0Fycm93Tm9kZS5qcyc7XHJcbmltcG9ydCBTaGFkZWRSZWN0YW5nbGUgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1NoYWRlZFJlY3RhbmdsZS5qcyc7XHJcbmltcG9ydCB7IENpcmNsZSwgQ29sb3IsIERyYWdMaXN0ZW5lciwgSW1hZ2UsIExpbmUsIExpbmVhckdyYWRpZW50LCBOb2RlLCBSYWRpYWxHcmFkaWVudCwgUmVjdGFuZ2xlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IHdyZW5jaF9wbmcgZnJvbSAnLi4vLi4vLi4vaW1hZ2VzL3dyZW5jaF9wbmcuanMnO1xyXG5pbXBvcnQgd2F2ZU9uQVN0cmluZyBmcm9tICcuLi8uLi93YXZlT25BU3RyaW5nLmpzJztcclxuaW1wb3J0IENvbnN0YW50cyBmcm9tICcuLi9Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgV09BU01vZGVsIGZyb20gJy4uL21vZGVsL1dPQVNNb2RlbC5qcyc7XHJcbmltcG9ydCBQdWxzZUJ1dHRvbiBmcm9tICcuL1B1bHNlQnV0dG9uLmpzJztcclxuXHJcbmNsYXNzIFN0YXJ0Tm9kZSBleHRlbmRzIE5vZGUge1xyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7V09BU01vZGVsfSBtb2RlbFxyXG4gICAqIEBwYXJhbSB7RW1pdHRlcn0gZnJhbWVFbWl0dGVyXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBtb2RlbCwgZnJhbWVFbWl0dGVyLCBvcHRpb25zICkge1xyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcbiAgICAgIGxheWVyU3BsaXQ6IHRydWVcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCBwb3N0Tm9kZUhlaWdodCA9IDE1ODtcclxuICAgIGNvbnN0IHBvc3RTY2FsZSA9IDM7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSpcclxuICAgICAqIE9zY2lsbGF0aW9uIHdoZWVsXHJcbiAgICAgKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG4gICAgY29uc3Qgd2hlZWxSYWRpdXMgPSAyOS41O1xyXG4gICAgbGV0IHdoZWVsID0gbmV3IENpcmNsZSggd2hlZWxSYWRpdXMsIHtcclxuICAgICAgc3Ryb2tlOiAnIzMzMycsXHJcbiAgICAgIGxpbmVXaWR0aDogMS41LFxyXG4gICAgICBmaWxsOiBuZXcgTGluZWFyR3JhZGllbnQoIC13aGVlbFJhZGl1cywgMCwgd2hlZWxSYWRpdXMsIDAgKS5hZGRDb2xvclN0b3AoIDAsICdyZ2IoMjE1LDIxMCwyMTApJyApLmFkZENvbG9yU3RvcCggMSwgJ3JnYigyMTUsMjEwLDIxMCknIClcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBpbm5lcldoZWVsUmFkaXVzID0gNC44O1xyXG4gICAgd2hlZWwuYWRkQ2hpbGQoIG5ldyBDaXJjbGUoIGlubmVyV2hlZWxSYWRpdXMsIHtcclxuICAgICAgc3Ryb2tlOiAnIzMzMycsXHJcbiAgICAgIGxpbmVXaWR0aDogMS41LFxyXG4gICAgICBmaWxsOiAnI2ZmZidcclxuICAgIH0gKSApO1xyXG4gICAgd2hlZWwuYWRkQ2hpbGQoIG5ldyBMaW5lKCAtaW5uZXJXaGVlbFJhZGl1cywgMCwgaW5uZXJXaGVlbFJhZGl1cywgMCwgeyBzdHJva2U6ICcjMzMzJywgbGluZVdpZHRoOiAxLjUgfSApICk7XHJcbiAgICB3aGVlbC5hZGRDaGlsZCggbmV3IENpcmNsZSggaW5uZXJXaGVlbFJhZGl1cywge1xyXG4gICAgICB4OiBpbm5lcldoZWVsUmFkaXVzICogMS41IC0gd2hlZWxSYWRpdXMsXHJcbiAgICAgIHN0cm9rZTogJyMzMzMnLFxyXG4gICAgICBsaW5lV2lkdGg6IDAuNSxcclxuICAgICAgZmlsbDogbmV3IFJhZGlhbEdyYWRpZW50KCAwLCAwLCAwLCAwLCAwLCBpbm5lcldoZWVsUmFkaXVzICkuYWRkQ29sb3JTdG9wKCAwLjIsICcjNTU1JyApLmFkZENvbG9yU3RvcCggMSwgJyM1NTUnIClcclxuICAgIH0gKSApO1xyXG5cclxuICAgIC8vIHRvSW1hZ2UqIHN0eWxlIGNvbnZlcnNpb24gb2YgdGhlIHdoZWVsIGlmIG5lY2Vzc2FyeSBmb3IgcGVyZm9ybWFuY2VcclxuICAgIGNvbnN0IHdoZWVsSW1hZ2VTY2FsZSA9IDM7XHJcbiAgICB3aGVlbC5zY2FsZSggd2hlZWxJbWFnZVNjYWxlICk7XHJcbiAgICBjb25zdCB3aGVlbFNpemUgPSBNYXRoLmNlaWwoIHdoZWVsLndpZHRoIC8gMiApICsgMjtcclxuICAgIHdoZWVsID0gd2hlZWwudG9EYXRhVVJMTm9kZVN5bmNocm9ub3VzKCB3aGVlbFNpemUsIHdoZWVsU2l6ZSwgMiAqIHdoZWVsU2l6ZSwgMiAqIHdoZWVsU2l6ZSApO1xyXG4gICAgaWYgKCBwbGF0Zm9ybS5maXJlZm94ICkge1xyXG4gICAgICB3aGVlbC5yZW5kZXJlciA9ICdjYW52YXMnO1xyXG4gICAgfVxyXG5cclxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKlxyXG4gICAgICogV3JlbmNoXHJcbiAgICAgKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG4gICAgY29uc3Qgd3JlbmNoSW1hZ2VOb2RlID0gbmV3IEltYWdlKCB3cmVuY2hfcG5nLCB7IHg6IC00MCwgeTogLTI0LCBzY2FsZTogMC45IC8gNCwgcGlja2FibGU6IGZhbHNlIH0gKTtcclxuICAgIGNvbnN0IHdyZW5jaEFycm93T3B0aW9ucyA9IHtcclxuICAgICAgZmlsbDogJ2hzbCgyMTAsOTAlLDYwJSknLFxyXG4gICAgICB0YWlsV2lkdGg6IDEwLFxyXG4gICAgICBoZWFkV2lkdGg6IDIyLFxyXG4gICAgICBoZWFkSGVpZ2h0OiAxOFxyXG4gICAgfTtcclxuICAgIGNvbnN0IHdyZW5jaEFycm93WE9mZnNldCA9IDg7XHJcbiAgICBjb25zdCB3cmVuY2hBcnJvd1lPZmZzZXQgPSAxMDtcclxuICAgIGNvbnN0IHdyZW5jaFRvcEFycm93ID0gbmV3IEFycm93Tm9kZSggd3JlbmNoSW1hZ2VOb2RlLmNlbnRlclggKyB3cmVuY2hBcnJvd1hPZmZzZXQsIHdyZW5jaEltYWdlTm9kZS50b3AgLSB3cmVuY2hBcnJvd1lPZmZzZXQsXHJcbiAgICAgIHdyZW5jaEltYWdlTm9kZS5jZW50ZXJYICsgd3JlbmNoQXJyb3dYT2Zmc2V0LCB3cmVuY2hJbWFnZU5vZGUudG9wIC0gMzAgLSB3cmVuY2hBcnJvd1lPZmZzZXQsIHdyZW5jaEFycm93T3B0aW9ucyApO1xyXG4gICAgY29uc3Qgd3JlbmNoQm90dG9tQXJyb3cgPSBuZXcgQXJyb3dOb2RlKCB3cmVuY2hJbWFnZU5vZGUuY2VudGVyWCArIHdyZW5jaEFycm93WE9mZnNldCwgd3JlbmNoSW1hZ2VOb2RlLmJvdHRvbSArIHdyZW5jaEFycm93WU9mZnNldCxcclxuICAgICAgd3JlbmNoSW1hZ2VOb2RlLmNlbnRlclggKyB3cmVuY2hBcnJvd1hPZmZzZXQsIHdyZW5jaEltYWdlTm9kZS5ib3R0b20gKyAzMCArIHdyZW5jaEFycm93WU9mZnNldCwgd3JlbmNoQXJyb3dPcHRpb25zICk7XHJcbiAgICBjb25zdCB3cmVuY2ggPSBuZXcgTm9kZSgge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIHdyZW5jaEltYWdlTm9kZSxcclxuICAgICAgICB3cmVuY2hUb3BBcnJvdyxcclxuICAgICAgICB3cmVuY2hCb3R0b21BcnJvd1xyXG4gICAgICBdLCBjdXJzb3I6ICdwb2ludGVyJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIHdyZW5jaFRvcEFycm93LnRvdWNoQXJlYSA9IHdyZW5jaFRvcEFycm93LmxvY2FsQm91bmRzLmRpbGF0ZWQoIDYgKTtcclxuICAgIHdyZW5jaEJvdHRvbUFycm93LnRvdWNoQXJlYSA9IHdyZW5jaEJvdHRvbUFycm93LmxvY2FsQm91bmRzLmRpbGF0ZWQoIDYgKTtcclxuICAgIHdyZW5jaC50b3VjaEFyZWEgPSBTaGFwZS5ib3VuZHMoIHdyZW5jaEltYWdlTm9kZS5ib3VuZHMuZGlsYXRlZCggQ29uc3RhbnRzLmRpbGF0ZWRUb3VjaEFyZWEgKSApO1xyXG4gICAgd3JlbmNoLm1vdXNlQXJlYSA9IFNoYXBlLmJvdW5kcyggd3JlbmNoSW1hZ2VOb2RlLmJvdW5kcyApO1xyXG5cclxuXHJcbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSpcclxuICAgICAqIFBvc3RcclxuICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbiAgICBsZXQgcG9zdCA9IG5ldyBSZWN0YW5nbGUoIENvbnN0YW50cy5vZmZzZXRXaGVlbC54IC0gNSwgMCwgMTAsIHBvc3ROb2RlSGVpZ2h0LCB7XHJcbiAgICAgIHN0cm9rZTogJyMwMDAnLFxyXG4gICAgICBmaWxsOiBDb25zdGFudHMucG9zdEdyYWRpZW50XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qXHJcbiAgICAgKiBQaXN0b24gQm94XHJcbiAgICAgKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG4gICAgY29uc3QgcGlzdG9uQm94ID0gbmV3IFNoYWRlZFJlY3RhbmdsZSggQm91bmRzMi5wb2ludCggQ29uc3RhbnRzLm9mZnNldFdoZWVsLngsIENvbnN0YW50cy5vZmZzZXRXaGVlbC55ICkuZGlsYXRlZFhZKCA0MCwgMjUgKSwge1xyXG4gICAgICBiYXNlQ29sb3I6IG5ldyBDb2xvciggMjAwLCAyMDAsIDIwMCApLFxyXG4gICAgICBsaWdodEZhY3RvcjogMC41LFxyXG4gICAgICBsaWdodGVyRmFjdG9yOiAwLjEsXHJcbiAgICAgIGRhcmtGYWN0b3I6IDAuNSxcclxuICAgICAgZGFya2VyRmFjdG9yOiAwLjEsXHJcbiAgICAgIGNvcm5lclJhZGl1czogNlxyXG4gICAgfSApO1xyXG5cclxuICAgIHBpc3RvbkJveC5hZGRDaGlsZCggbmV3IFB1bHNlQnV0dG9uKCBtb2RlbCwge1xyXG4gICAgICBjZW50ZXI6IHBpc3RvbkJveC5jZW50ZXIsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncHVsc2VCdXR0b24nIClcclxuICAgIH0gKSApO1xyXG5cclxuICAgIC8vIGNhY2hlIHRoZSBwb3N0IGFzIGFuIGltYWdlLCBzaW5jZSBvdGhlcndpc2Ugd2l0aCB0aGUgY3VycmVudCBTY2VuZXJ5IGl0cyBncmFkaWVudCBpcyB1cGRhdGVkIGV2ZXJ5IGZyYW1lIGluIHRoZSBkZWZzIChOT1RFOiByZW1vdmUgdGhpcyB3aXRoIFNjZW5lcnkgMC4yPylcclxuICAgIGNvbnN0IHBvc3RDYWNoZSA9IG5ldyBOb2RlKCB7IHNjYWxlOiAxIC8gcG9zdFNjYWxlIH0gKTtcclxuICAgIG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIHBvc3QgXSwgc2NhbGU6IHBvc3RTY2FsZSB9ICkudG9JbWFnZU5vZGVBc3luY2hyb25vdXMoIGltYWdlID0+IHtcclxuICAgICAgcG9zdENhY2hlLmFkZENoaWxkKCBpbWFnZSApO1xyXG4gICAgfSApO1xyXG4gICAgcG9zdCA9IG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIHBvc3RDYWNoZSBdIH0gKTtcclxuXHJcbiAgICB0aGlzLmNoaWxkcmVuID0gW1xyXG4gICAgICBwb3N0LFxyXG4gICAgICBwaXN0b25Cb3gsXHJcbiAgICAgIHdyZW5jaCxcclxuICAgICAgbmV3IE5vZGUoIHsgY2hpbGRyZW46IFsgd2hlZWwgXSwgdHJhbnNsYXRpb246IENvbnN0YW50cy5vZmZzZXRXaGVlbCB9IClcclxuICAgIF07XHJcblxyXG4gICAgbGV0IGNsaWNrT2Zmc2V0ID0gbmV3IFZlY3RvcjIoIDAsIDAgKTtcclxuICAgIHdyZW5jaC5hZGRJbnB1dExpc3RlbmVyKCBuZXcgRHJhZ0xpc3RlbmVyKCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnd3JlbmNoRHJhZ0xpc3RlbmVyJyApLFxyXG4gICAgICBzdGFydDogZXZlbnQgPT4ge1xyXG4gICAgICAgIGNsaWNrT2Zmc2V0ID0gd3JlbmNoLmdsb2JhbFRvUGFyZW50UG9pbnQoIGV2ZW50LnBvaW50ZXIucG9pbnQgKS5taW51cyggZXZlbnQuY3VycmVudFRhcmdldC50cmFuc2xhdGlvbiApO1xyXG5cclxuICAgICAgICBpZiAoIGV2ZW50LnRhcmdldCAhPT0gd3JlbmNoVG9wQXJyb3cgJiYgZXZlbnQudGFyZ2V0ICE9PSB3cmVuY2hCb3R0b21BcnJvdyApIHtcclxuICAgICAgICAgIG1vZGVsLndyZW5jaEFycm93c1Zpc2libGVQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgZHJhZzogZXZlbnQgPT4ge1xyXG4gICAgICAgIGNvbnN0IHBvaW50ID0gd3JlbmNoLmdsb2JhbFRvUGFyZW50UG9pbnQoIGV2ZW50LnBvaW50ZXIucG9pbnQgKS5taW51cyggY2xpY2tPZmZzZXQgKTtcclxuXHJcbiAgICAgICAgbW9kZWwubmV4dExlZnRZUHJvcGVydHkudmFsdWUgPSBNYXRoLm1heCggTWF0aC5taW4oIHBvaW50LnksIG9wdGlvbnMucmFuZ2UubWF4ICksIG9wdGlvbnMucmFuZ2UubWluICk7XHJcbiAgICAgICAgbW9kZWwuaXNQbGF5aW5nUHJvcGVydHkudmFsdWUgPSB0cnVlO1xyXG4gICAgICAgIG1vZGVsLnlOb3dDaGFuZ2VkRW1pdHRlci5lbWl0KCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGVuZDogKCkgPT4ge1xyXG4gICAgICAgIG1vZGVsLndyZW5jaEFycm93c1Zpc2libGVQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICBtb2RlbC53cmVuY2hBcnJvd3NWaXNpYmxlUHJvcGVydHkubGluayggdmlzaWJsZSA9PiB7XHJcbiAgICAgIHdyZW5jaFRvcEFycm93LnZpc2libGUgPSB2aXNpYmxlO1xyXG4gICAgICB3cmVuY2hCb3R0b21BcnJvdy52aXNpYmxlID0gdmlzaWJsZTtcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLm11dGF0ZSggb3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IHVwZGF0ZUtleSA9ICgpID0+IHtcclxuICAgICAgaWYgKCB3cmVuY2guaXNWaXNpYmxlKCkgKSB7XHJcbiAgICAgICAgd3JlbmNoLnkgPSBtb2RlbC55Tm93WyAwIF07XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgdXBkYXRlUG9zdCA9ICgpID0+IHtcclxuICAgICAgY29uc3QgeSA9IG1vZGVsLnlOb3dbIDAgXTtcclxuICAgICAgaWYgKCBwb3N0LmlzVmlzaWJsZSgpICkge1xyXG4gICAgICAgIHBvc3QubWF0cml4ID0gbTMoXHJcbiAgICAgICAgICAxLCAwLCAwLFxyXG4gICAgICAgICAgMCwgKCBDb25zdGFudHMub2Zmc2V0V2hlZWwueSAtICggeSArIDcgKSApIC8gcG9zdE5vZGVIZWlnaHQsIHkgKyA3LFxyXG4gICAgICAgICAgMCwgMCwgMVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgbGV0IGRpcnR5ID0gdHJ1ZTtcclxuICAgIG1vZGVsLnlOb3dDaGFuZ2VkRW1pdHRlci5hZGRMaXN0ZW5lciggKCkgPT4ge1xyXG4gICAgICBkaXJ0eSA9IHRydWU7XHJcbiAgICB9ICk7XHJcbiAgICBmcmFtZUVtaXR0ZXIuYWRkTGlzdGVuZXIoICgpID0+IHtcclxuICAgICAgaWYgKCBkaXJ0eSApIHtcclxuICAgICAgICB1cGRhdGVLZXkoKTtcclxuICAgICAgICB1cGRhdGVQb3N0KCk7XHJcbiAgICAgICAgZGlydHkgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHdoZWVsU2NhbGVNYXRyaXggPSBNYXRyaXgzLnNjYWxlKCAxIC8gd2hlZWxJbWFnZVNjYWxlICk7XHJcbiAgICBtb2RlbC5hbmdsZVByb3BlcnR5LmxpbmsoIGFuZ2xlID0+IHtcclxuICAgICAgd2hlZWwubWF0cml4ID0gTWF0cml4My5yb3RhdGlvbjIoIGFuZ2xlICkudGltZXNNYXRyaXgoIHdoZWVsU2NhbGVNYXRyaXggKTsgLy8gZG9lc24ndCBuZWVkIHRvIGNvbXB1dGUgY3VycmVudCB0cmFuc2Zvcm0sIG9yIGRvIG1hdHJpeCBtdWx0aXBsaWNhdGlvblxyXG4gICAgfSApO1xyXG4gICAgbW9kZWwud2F2ZU1vZGVQcm9wZXJ0eS5saW5rKCBtb2RlID0+IHtcclxuICAgICAgY29uc3Qgd3JlbmNoSXNWaXNpYmxlID0gbW9kZSA9PT0gV09BU01vZGVsLk1vZGUuTUFOVUFMO1xyXG4gICAgICBpZiAoIHdyZW5jaC5pc1Zpc2libGUoKSAhPT0gd3JlbmNoSXNWaXNpYmxlICkge1xyXG4gICAgICAgIHdyZW5jaC52aXNpYmxlID0gd3JlbmNoSXNWaXNpYmxlO1xyXG5cclxuICAgICAgICB1cGRhdGVLZXkoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcG9zdElzVmlzaWJsZSA9IG1vZGUgIT09IFdPQVNNb2RlbC5Nb2RlLk1BTlVBTDtcclxuICAgICAgaWYgKCBwb3N0LmlzVmlzaWJsZSgpICE9PSBwb3N0SXNWaXNpYmxlICkge1xyXG4gICAgICAgIHBvc3QudmlzaWJsZSA9IHBvc3RJc1Zpc2libGU7XHJcblxyXG4gICAgICAgIHVwZGF0ZVBvc3QoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgd2hlZWwudmlzaWJsZSA9IG1vZGUgPT09IFdPQVNNb2RlbC5Nb2RlLk9TQ0lMTEFURTtcclxuICAgICAgcGlzdG9uQm94LnZpc2libGUgPSBtb2RlID09PSBXT0FTTW9kZWwuTW9kZS5QVUxTRTtcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbndhdmVPbkFTdHJpbmcucmVnaXN0ZXIoICdTdGFydE5vZGUnLCBTdGFydE5vZGUgKTtcclxuZXhwb3J0IGRlZmF1bHQgU3RhcnROb2RlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxPQUFPLE1BQU0sK0JBQStCO0FBQ25ELE9BQU9DLE9BQU8s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