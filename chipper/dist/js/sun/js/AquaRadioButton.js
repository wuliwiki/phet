// Copyright 2013-2023, University of Colorado Boulder

/**
 * Radio button with a pseudo-Aqua (Mac OS) look. See "options" comment for list of options.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Emitter from '../../axon/js/Emitter.js';
import InstanceRegistry from '../../phet-core/js/documentation/InstanceRegistry.js';
import optionize from '../../phet-core/js/optionize.js';
import { Circle, FireListener, isWidthSizable, LayoutConstraint, Node, Rectangle, SceneryConstants, Voicing, WidthSizable } from '../../scenery/js/imports.js';
import multiSelectionSoundPlayerFactory from '../../tambo/js/multiSelectionSoundPlayerFactory.js';
import Tandem from '../../tandem/js/Tandem.js';
import sun from './sun.js';
export default class AquaRadioButton extends WidthSizable(Voicing(Node)) {
  // the value associated with this radio button

  static DEFAULT_RADIUS = 7;
  static TANDEM_NAME_SUFFIX = 'RadioButton';
  onInputEmitter = new Emitter();

  // Handles layout of the content, rectangles and mouse/touch areas

  // We need to record if the mouse/touch areas are customized, so that we can avoid overwriting them.
  // public for use by AquaRadioButtonConstraint only!
  _isMouseAreaCustomized = false;
  _isTouchAreaCustomized = false;
  _isSettingAreas = false;

  /**
   * @param property
   * @param value - the value that corresponds to this button, same type as property
   * @param labelNode - Node that will be vertically centered to the right of the button
   * @param providedOptions
   */
  constructor(property, value, labelNode, providedOptions) {
    const options = optionize()({
      // SelfOptions
      centerColor: 'black',
      radius: AquaRadioButton.DEFAULT_RADIUS,
      selectedColor: 'rgb( 143, 197, 250 )',
      deselectedColor: 'white',
      xSpacing: 8,
      stroke: 'black',
      soundPlayer: multiSelectionSoundPlayerFactory.getSelectionSoundPlayer(0),
      a11yNameAttribute: null,
      touchAreaXDilation: 0,
      touchAreaYDilation: 0,
      mouseAreaXDilation: 0,
      mouseAreaYDilation: 0,
      // NodeOptions
      cursor: 'pointer',
      // {number} - opt into Node's disabled opacity when enabled:false
      disabledOpacity: SceneryConstants.DISABLED_OPACITY,
      // phet-io
      tandem: Tandem.REQUIRED,
      tandemNameSuffix: 'RadioButton',
      visiblePropertyOptions: {
        phetioFeatured: true
      },
      phetioEnabledPropertyInstrumented: true,
      // opt into default PhET-iO instrumented enabledProperty

      // pdom
      tagName: 'input',
      inputType: 'radio',
      containerTagName: 'li',
      labelTagName: 'label',
      appendLabel: true,
      appendDescription: true
    }, providedOptions);
    assert && assert(!options.tandem.supplied || options.tandem.name.endsWith(AquaRadioButton.TANDEM_NAME_SUFFIX), `AquaRadioButton tandem.name must end with ${AquaRadioButton.TANDEM_NAME_SUFFIX}: ${options.tandem.phetioID}`);
    super();
    this.value = value;

    // selected Node
    const selectedNode = new Node();
    const innerCircle = new Circle(options.radius / 3, {
      fill: options.centerColor
    });
    const outerCircleSelected = new Circle(options.radius, {
      fill: options.selectedColor,
      stroke: options.stroke
    });
    const selectedCircleButton = new Node({
      children: [outerCircleSelected, innerCircle]
    });
    selectedNode.addChild(selectedCircleButton);

    // deselected Node
    const deselectedNode = new Node();
    const deselectedCircleButton = new Circle(options.radius, {
      fill: options.deselectedColor,
      stroke: options.stroke
    });
    deselectedNode.addChild(deselectedCircleButton);
    const radioNode = new Node({
      children: [selectedNode, deselectedNode],
      pickable: false // rectangle used for input
    });

    const labelBoundsListener = () => {
      labelNode.left = deselectedCircleButton.right + options.xSpacing;
      labelNode.centerY = deselectedCircleButton.centerY;
    };
    labelNode.boundsProperty.link(labelBoundsListener);

    // Add an invisible Node to make sure the layout for selected vs deselected is the same
    const rectangle = new Rectangle({});
    selectedNode.pickable = deselectedNode.pickable = false; // the background rectangle suffices

    labelNode.pickable = false; // since there's a pickable rectangle on top of content

    this.children = [radioNode, labelNode, rectangle];
    this.constraint = new AquaRadioButtonConstraint(this, radioNode, labelNode, rectangle, options);
    this.constraint.updateLayout();

    // sync control with model
    const syncWithModel = newValue => {
      selectedNode.visible = newValue === value;
      deselectedNode.visible = !selectedNode.visible;
    };
    property.link(syncWithModel);

    // set Property value on fire
    const fire = () => {
      const oldValue = property.value;
      property.set(value);
      if (oldValue !== property.value) {
        this.onInputEmitter.emit();
      }
    };
    const fireListener = new FireListener({
      fire: fire,
      tandem: options.tandem.createTandem('fireListener')
    });
    this.addInputListener(fireListener);

    // sound support
    this.onInputEmitter.addListener(() => options.soundPlayer.play());

    // pdom - input listener so that updates the state of the radio button with keyboard interaction
    const changeListener = {
      change: fire
    };
    this.addInputListener(changeListener);

    // pdom - Specify the default value for assistive technology. This attribute is needed in addition to
    // the 'checked' Property to mark this element as the default selection since 'checked' may be set before
    // we are finished adding RadioButtons to the containing group, and the browser will remove the boolean
    // 'checked' flag when new buttons are added.
    if (property.value === value) {
      this.setPDOMAttribute('checked', 'checked');
    }

    // pdom - when the Property changes, make sure the correct radio button is marked as 'checked' so that this button
    // receives focus on 'tab'
    const pdomCheckedListener = newValue => {
      this.pdomChecked = newValue === value;
    };
    property.link(pdomCheckedListener);

    // pdom - every button in a group of radio buttons should have the same name, see options for more info
    if (options.a11yNameAttribute !== null) {
      this.setPDOMAttribute('name', options.a11yNameAttribute);
    }
    this.mutate(options);
    this.disposeAquaRadioButton = () => {
      this.constraint.dispose();
      this.onInputEmitter.dispose();
      this.removeInputListener(fireListener);
      this.removeInputListener(changeListener);
      property.unlink(pdomCheckedListener);
      property.unlink(syncWithModel);
      if (labelNode.boundsProperty.hasListener(labelBoundsListener)) {
        labelNode.boundsProperty.unlink(labelBoundsListener);
      }

      // phet-io: Unregister listener
      fireListener.dispose();
    };

    // support for binder documentation, stripped out in builds and only runs when ?binder is specified
    assert && phet.chipper.queryParameters.binder && InstanceRegistry.registerDataURL('sun', 'AquaRadioButton', this);
  }
  dispose() {
    this.disposeAquaRadioButton();
    super.dispose();
  }
}
class AquaRadioButtonConstraint extends LayoutConstraint {
  constructor(radioButton, radioNode, content, rectangle, options) {
    super(radioButton);
    this.radioButton = radioButton;
    this.radioNode = radioNode;
    this.content = content;
    this.rectangle = rectangle;
    this.options = options;
    this.radioButton.localPreferredWidthProperty.lazyLink(this._updateLayoutListener);
    this.addNode(content);
  }
  layout() {
    super.layout();

    // LayoutProxy helps with some layout operations, and will support a non-child content.
    const contentProxy = this.createLayoutProxy(this.content);
    const contentWidth = contentProxy.minimumWidth;
    const minimumWidth = this.radioNode.width + this.options.xSpacing + contentWidth;
    const preferredWidth = this.radioButton.localPreferredWidth === null ? minimumWidth : this.radioButton.localPreferredWidth;

    // Attempt to set a preferredWidth
    if (isWidthSizable(this.content)) {
      contentProxy.preferredWidth = preferredWidth - this.radioNode.width - this.options.xSpacing;
    }

    // For now just position content. Future updates could include widthResizable content?
    contentProxy.left = this.radioNode.right + this.options.xSpacing;
    contentProxy.centerY = this.radioNode.centerY;

    // Our rectangle bounds will cover the radioNode and content, and if necessary expand to include the full
    // preferredWidth
    this.rectangle.rectBounds = this.radioNode.bounds.union(contentProxy.bounds).withMaxX(Math.max(this.radioNode.left + preferredWidth, contentProxy.right));

    // Update pointer areas (if the client hasn't customized them)
    this.radioButton._isSettingAreas = true;
    if (!this.radioButton._isTouchAreaCustomized) {
      this.radioButton.touchArea = this.radioButton.localBounds.dilatedXY(this.options.touchAreaXDilation, this.options.touchAreaYDilation);
    }
    if (!this.radioButton._isMouseAreaCustomized) {
      this.radioButton.mouseArea = this.radioButton.localBounds.dilatedXY(this.options.mouseAreaXDilation, this.options.mouseAreaYDilation);
    }
    this.radioButton._isSettingAreas = false;
    contentProxy.dispose();

    // Set the minimumWidth last, since this may trigger a relayout
    this.radioButton.localMinimumWidth = minimumWidth;
  }
  dispose() {
    this.radioButton.localPreferredWidthProperty.unlink(this._updateLayoutListener);
    super.dispose();
  }
}
sun.register('AquaRadioButton', AquaRadioButton);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFbWl0dGVyIiwiSW5zdGFuY2VSZWdpc3RyeSIsIm9wdGlvbml6ZSIsIkNpcmNsZSIsIkZpcmVMaXN0ZW5lciIsImlzV2lkdGhTaXphYmxlIiwiTGF5b3V0Q29uc3RyYWludCIsIk5vZGUiLCJSZWN0YW5nbGUiLCJTY2VuZXJ5Q29uc3RhbnRzIiwiVm9pY2luZyIsIldpZHRoU2l6YWJsZSIsIm11bHRpU2VsZWN0aW9uU291bmRQbGF5ZXJGYWN0b3J5IiwiVGFuZGVtIiwic3VuIiwiQXF1YVJhZGlvQnV0dG9uIiwiREVGQVVMVF9SQURJVVMiLCJUQU5ERU1fTkFNRV9TVUZGSVgiLCJvbklucHV0RW1pdHRlciIsIl9pc01vdXNlQXJlYUN1c3RvbWl6ZWQiLCJfaXNUb3VjaEFyZWFDdXN0b21pemVkIiwiX2lzU2V0dGluZ0FyZWFzIiwiY29uc3RydWN0b3IiLCJwcm9wZXJ0eSIsInZhbHVlIiwibGFiZWxOb2RlIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsImNlbnRlckNvbG9yIiwicmFkaXVzIiwic2VsZWN0ZWRDb2xvciIsImRlc2VsZWN0ZWRDb2xvciIsInhTcGFjaW5nIiwic3Ryb2tlIiwic291bmRQbGF5ZXIiLCJnZXRTZWxlY3Rpb25Tb3VuZFBsYXllciIsImExMXlOYW1lQXR0cmlidXRlIiwidG91Y2hBcmVhWERpbGF0aW9uIiwidG91Y2hBcmVhWURpbGF0aW9uIiwibW91c2VBcmVhWERpbGF0aW9uIiwibW91c2VBcmVhWURpbGF0aW9uIiwiY3Vyc29yIiwiZGlzYWJsZWRPcGFjaXR5IiwiRElTQUJMRURfT1BBQ0lUWSIsInRhbmRlbSIsIlJFUVVJUkVEIiwidGFuZGVtTmFtZVN1ZmZpeCIsInZpc2libGVQcm9wZXJ0eU9wdGlvbnMiLCJwaGV0aW9GZWF0dXJlZCIsInBoZXRpb0VuYWJsZWRQcm9wZXJ0eUluc3RydW1lbnRlZCIsInRhZ05hbWUiLCJpbnB1dFR5cGUiLCJjb250YWluZXJUYWdOYW1lIiwibGFiZWxUYWdOYW1lIiwiYXBwZW5kTGFiZWwiLCJhcHBlbmREZXNjcmlwdGlvbiIsImFzc2VydCIsInN1cHBsaWVkIiwibmFtZSIsImVuZHNXaXRoIiwicGhldGlvSUQiLCJzZWxlY3RlZE5vZGUiLCJpbm5lckNpcmNsZSIsImZpbGwiLCJvdXRlckNpcmNsZVNlbGVjdGVkIiwic2VsZWN0ZWRDaXJjbGVCdXR0b24iLCJjaGlsZHJlbiIsImFkZENoaWxkIiwiZGVzZWxlY3RlZE5vZGUiLCJkZXNlbGVjdGVkQ2lyY2xlQnV0dG9uIiwicmFkaW9Ob2RlIiwicGlja2FibGUiLCJsYWJlbEJvdW5kc0xpc3RlbmVyIiwibGVmdCIsInJpZ2h0IiwiY2VudGVyWSIsImJvdW5kc1Byb3BlcnR5IiwibGluayIsInJlY3RhbmdsZSIsImNvbnN0cmFpbnQiLCJBcXVhUmFkaW9CdXR0b25Db25zdHJhaW50IiwidXBkYXRlTGF5b3V0Iiwic3luY1dpdGhNb2RlbCIsIm5ld1ZhbHVlIiwidmlzaWJsZSIsImZpcmUiLCJvbGRWYWx1ZSIsInNldCIsImVtaXQiLCJmaXJlTGlzdGVuZXIiLCJjcmVhdGVUYW5kZW0iLCJhZGRJbnB1dExpc3RlbmVyIiwiYWRkTGlzdGVuZXIiLCJwbGF5IiwiY2hhbmdlTGlzdGVuZXIiLCJjaGFuZ2UiLCJzZXRQRE9NQXR0cmlidXRlIiwicGRvbUNoZWNrZWRMaXN0ZW5lciIsInBkb21DaGVja2VkIiwibXV0YXRlIiwiZGlzcG9zZUFxdWFSYWRpb0J1dHRvbiIsImRpc3Bvc2UiLCJyZW1vdmVJbnB1dExpc3RlbmVyIiwidW5saW5rIiwiaGFzTGlzdGVuZXIiLCJwaGV0IiwiY2hpcHBlciIsInF1ZXJ5UGFyYW1ldGVycyIsImJpbmRlciIsInJlZ2lzdGVyRGF0YVVSTCIsInJhZGlvQnV0dG9uIiwiY29udGVudCIsImxvY2FsUHJlZmVycmVkV2lkdGhQcm9wZXJ0eSIsImxhenlMaW5rIiwiX3VwZGF0ZUxheW91dExpc3RlbmVyIiwiYWRkTm9kZSIsImxheW91dCIsImNvbnRlbnRQcm94eSIsImNyZWF0ZUxheW91dFByb3h5IiwiY29udGVudFdpZHRoIiwibWluaW11bVdpZHRoIiwid2lkdGgiLCJwcmVmZXJyZWRXaWR0aCIsImxvY2FsUHJlZmVycmVkV2lkdGgiLCJyZWN0Qm91bmRzIiwiYm91bmRzIiwidW5pb24iLCJ3aXRoTWF4WCIsIk1hdGgiLCJtYXgiLCJ0b3VjaEFyZWEiLCJsb2NhbEJvdW5kcyIsImRpbGF0ZWRYWSIsIm1vdXNlQXJlYSIsImxvY2FsTWluaW11bVdpZHRoIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJBcXVhUmFkaW9CdXR0b24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTMtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogUmFkaW8gYnV0dG9uIHdpdGggYSBwc2V1ZG8tQXF1YSAoTWFjIE9TKSBsb29rLiBTZWUgXCJvcHRpb25zXCIgY29tbWVudCBmb3IgbGlzdCBvZiBvcHRpb25zLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBUUHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9UUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRW1pdHRlciBmcm9tICcuLi8uLi9heG9uL2pzL0VtaXR0ZXIuanMnO1xyXG5pbXBvcnQgSW5zdGFuY2VSZWdpc3RyeSBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvZG9jdW1lbnRhdGlvbi9JbnN0YW5jZVJlZ2lzdHJ5LmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IHsgQ2lyY2xlLCBGaXJlTGlzdGVuZXIsIGlzV2lkdGhTaXphYmxlLCBMYXlvdXRDb25zdHJhaW50LCBOb2RlLCBOb2RlT3B0aW9ucywgUmVjdGFuZ2xlLCBTY2VuZXJ5Q29uc3RhbnRzLCBUUGFpbnQsIFZvaWNpbmcsIFZvaWNpbmdPcHRpb25zLCBXaWR0aFNpemFibGUgfSBmcm9tICcuLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgVFNvdW5kUGxheWVyIGZyb20gJy4uLy4uL3RhbWJvL2pzL1RTb3VuZFBsYXllci5qcyc7XHJcbmltcG9ydCBtdWx0aVNlbGVjdGlvblNvdW5kUGxheWVyRmFjdG9yeSBmcm9tICcuLi8uLi90YW1iby9qcy9tdWx0aVNlbGVjdGlvblNvdW5kUGxheWVyRmFjdG9yeS5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBzdW4gZnJvbSAnLi9zdW4uanMnO1xyXG5pbXBvcnQgU3RyaWN0T21pdCBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvU3RyaWN0T21pdC5qcyc7XHJcbmltcG9ydCBURW1pdHRlciBmcm9tICcuLi8uLi9heG9uL2pzL1RFbWl0dGVyLmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcblxyXG4gIC8vIGNvbG9yIHVzZWQgdG8gZmlsbCB0aGUgY2VudGVyIG9mIHRoZSBidXR0b24gd2hlbiBpdCdzIHNlbGVjdGVkXHJcbiAgY2VudGVyQ29sb3I/OiBUUGFpbnQ7XHJcblxyXG4gIC8vIHJhZGl1cyBvZiB0aGUgYnV0dG9uXHJcbiAgcmFkaXVzPzogbnVtYmVyO1xyXG5cclxuICAvLyBjb2xvciB1c2VkIHRvIGZpbGwgdGhlIGJ1dHRvbiB3aGVuIGl0J3Mgc2VsZWN0ZWRcclxuICBzZWxlY3RlZENvbG9yPzogVFBhaW50O1xyXG5cclxuICAvLyBjb2xvciB1c2VkIHRvIGZpbGwgdGhlIGJ1dHRvbiB3aGVuIGl0J3MgZGVzZWxlY3RlZFxyXG4gIGRlc2VsZWN0ZWRDb2xvcj86IFRQYWludDtcclxuXHJcbiAgLy8gaG9yaXpvbnRhbCBzcGFjZSBiZXR3ZWVuIHRoZSBidXR0b24gYW5kIHRoZSBsYWJlbE5vZGVcclxuICB4U3BhY2luZz86IG51bWJlcjtcclxuXHJcbiAgLy8gY29sb3IgdXNlZCB0byBzdHJva2UgdGhlIG91dGVyIGVkZ2Ugb2YgdGhlIGJ1dHRvblxyXG4gIHN0cm9rZT86IFRQYWludDtcclxuXHJcbiAgLy8gc291bmQgZ2VuZXJhdG9yLCB1c3VhbGx5IG92ZXJyaWRkZW4gd2hlbiBjcmVhdGluZyBhIGdyb3VwIG9mIHRoZXNlXHJcbiAgc291bmRQbGF5ZXI/OiBUU291bmRQbGF5ZXI7XHJcblxyXG4gIC8vIHBvaW50ZXIgYXJlYXNcclxuICB0b3VjaEFyZWFYRGlsYXRpb24/OiBudW1iZXI7XHJcbiAgdG91Y2hBcmVhWURpbGF0aW9uPzogbnVtYmVyO1xyXG4gIG1vdXNlQXJlYVhEaWxhdGlvbj86IG51bWJlcjtcclxuICBtb3VzZUFyZWFZRGlsYXRpb24/OiBudW1iZXI7XHJcblxyXG4gIC8vIEVhY2ggYnV0dG9uIGluIGEgZ3JvdXAgb2YgcmFkaW8gYnV0dG9ucyBtdXN0IGhhdmUgdGhlIHNhbWUgJ25hbWUnIGF0dHJpYnV0ZSB0byBiZSBjb25zaWRlcmVkIGEgJ2dyb3VwJyBieSB0aGVcclxuICAvLyBicm93c2VyLiBPdGhlcndpc2UsIGFycm93IGtleXMgd2lsbCBuYXZpZ2F0ZSB0aHJvdWdoIGFsbCBpbnB1dHMgb2YgdHlwZSByYWRpbyBpbiB0aGUgZG9jdW1lbnQuXHJcbiAgYTExeU5hbWVBdHRyaWJ1dGU/OiBzdHJpbmcgfCBudW1iZXIgfCBudWxsO1xyXG59O1xyXG50eXBlIFBhcmVudE9wdGlvbnMgPSBWb2ljaW5nT3B0aW9ucyAmIFN0cmljdE9taXQ8Tm9kZU9wdGlvbnMsICdjaGlsZHJlbic+O1xyXG5leHBvcnQgdHlwZSBBcXVhUmFkaW9CdXR0b25PcHRpb25zID0gU2VsZk9wdGlvbnMgJiBQYXJlbnRPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXF1YVJhZGlvQnV0dG9uPFQ+IGV4dGVuZHMgV2lkdGhTaXphYmxlKCBWb2ljaW5nKCBOb2RlICkgKSB7XHJcblxyXG4gIC8vIHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggdGhpcyByYWRpbyBidXR0b25cclxuICBwdWJsaWMgcmVhZG9ubHkgdmFsdWU6IFQ7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZUFxdWFSYWRpb0J1dHRvbjogKCkgPT4gdm9pZDtcclxuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBERUZBVUxUX1JBRElVUyA9IDc7XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgVEFOREVNX05BTUVfU1VGRklYID0gJ1JhZGlvQnV0dG9uJztcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IG9uSW5wdXRFbWl0dGVyOiBURW1pdHRlciA9IG5ldyBFbWl0dGVyKCk7XHJcblxyXG4gIC8vIEhhbmRsZXMgbGF5b3V0IG9mIHRoZSBjb250ZW50LCByZWN0YW5nbGVzIGFuZCBtb3VzZS90b3VjaCBhcmVhc1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgY29uc3RyYWludDogQXF1YVJhZGlvQnV0dG9uQ29uc3RyYWludDxUPjtcclxuXHJcbiAgLy8gV2UgbmVlZCB0byByZWNvcmQgaWYgdGhlIG1vdXNlL3RvdWNoIGFyZWFzIGFyZSBjdXN0b21pemVkLCBzbyB0aGF0IHdlIGNhbiBhdm9pZCBvdmVyd3JpdGluZyB0aGVtLlxyXG4gIC8vIHB1YmxpYyBmb3IgdXNlIGJ5IEFxdWFSYWRpb0J1dHRvbkNvbnN0cmFpbnQgb25seSFcclxuICBwdWJsaWMgX2lzTW91c2VBcmVhQ3VzdG9taXplZCA9IGZhbHNlO1xyXG4gIHB1YmxpYyBfaXNUb3VjaEFyZWFDdXN0b21pemVkID0gZmFsc2U7XHJcbiAgcHVibGljIF9pc1NldHRpbmdBcmVhcyA9IGZhbHNlO1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0gcHJvcGVydHlcclxuICAgKiBAcGFyYW0gdmFsdWUgLSB0aGUgdmFsdWUgdGhhdCBjb3JyZXNwb25kcyB0byB0aGlzIGJ1dHRvbiwgc2FtZSB0eXBlIGFzIHByb3BlcnR5XHJcbiAgICogQHBhcmFtIGxhYmVsTm9kZSAtIE5vZGUgdGhhdCB3aWxsIGJlIHZlcnRpY2FsbHkgY2VudGVyZWQgdG8gdGhlIHJpZ2h0IG9mIHRoZSBidXR0b25cclxuICAgKiBAcGFyYW0gcHJvdmlkZWRPcHRpb25zXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBwcm9wZXJ0eTogVFByb3BlcnR5PFQ+LCB2YWx1ZTogVCwgbGFiZWxOb2RlOiBOb2RlLCBwcm92aWRlZE9wdGlvbnM/OiBBcXVhUmFkaW9CdXR0b25PcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8QXF1YVJhZGlvQnV0dG9uT3B0aW9ucywgU2VsZk9wdGlvbnMsIFBhcmVudE9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIFNlbGZPcHRpb25zXHJcbiAgICAgIGNlbnRlckNvbG9yOiAnYmxhY2snLFxyXG4gICAgICByYWRpdXM6IEFxdWFSYWRpb0J1dHRvbi5ERUZBVUxUX1JBRElVUyxcclxuICAgICAgc2VsZWN0ZWRDb2xvcjogJ3JnYiggMTQzLCAxOTcsIDI1MCApJyxcclxuICAgICAgZGVzZWxlY3RlZENvbG9yOiAnd2hpdGUnLFxyXG4gICAgICB4U3BhY2luZzogOCxcclxuICAgICAgc3Ryb2tlOiAnYmxhY2snLFxyXG4gICAgICBzb3VuZFBsYXllcjogbXVsdGlTZWxlY3Rpb25Tb3VuZFBsYXllckZhY3RvcnkuZ2V0U2VsZWN0aW9uU291bmRQbGF5ZXIoIDAgKSxcclxuICAgICAgYTExeU5hbWVBdHRyaWJ1dGU6IG51bGwsXHJcbiAgICAgIHRvdWNoQXJlYVhEaWxhdGlvbjogMCxcclxuICAgICAgdG91Y2hBcmVhWURpbGF0aW9uOiAwLFxyXG4gICAgICBtb3VzZUFyZWFYRGlsYXRpb246IDAsXHJcbiAgICAgIG1vdXNlQXJlYVlEaWxhdGlvbjogMCxcclxuXHJcbiAgICAgIC8vIE5vZGVPcHRpb25zXHJcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG5cclxuICAgICAgLy8ge251bWJlcn0gLSBvcHQgaW50byBOb2RlJ3MgZGlzYWJsZWQgb3BhY2l0eSB3aGVuIGVuYWJsZWQ6ZmFsc2VcclxuICAgICAgZGlzYWJsZWRPcGFjaXR5OiBTY2VuZXJ5Q29uc3RhbnRzLkRJU0FCTEVEX09QQUNJVFksXHJcblxyXG4gICAgICAvLyBwaGV0LWlvXHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVELFxyXG4gICAgICB0YW5kZW1OYW1lU3VmZml4OiAnUmFkaW9CdXR0b24nLFxyXG4gICAgICB2aXNpYmxlUHJvcGVydHlPcHRpb25zOiB7IHBoZXRpb0ZlYXR1cmVkOiB0cnVlIH0sXHJcbiAgICAgIHBoZXRpb0VuYWJsZWRQcm9wZXJ0eUluc3RydW1lbnRlZDogdHJ1ZSwgLy8gb3B0IGludG8gZGVmYXVsdCBQaEVULWlPIGluc3RydW1lbnRlZCBlbmFibGVkUHJvcGVydHlcclxuXHJcbiAgICAgIC8vIHBkb21cclxuICAgICAgdGFnTmFtZTogJ2lucHV0JyxcclxuICAgICAgaW5wdXRUeXBlOiAncmFkaW8nLFxyXG4gICAgICBjb250YWluZXJUYWdOYW1lOiAnbGknLFxyXG4gICAgICBsYWJlbFRhZ05hbWU6ICdsYWJlbCcsXHJcbiAgICAgIGFwcGVuZExhYmVsOiB0cnVlLFxyXG4gICAgICBhcHBlbmREZXNjcmlwdGlvbjogdHJ1ZVxyXG5cclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoICFvcHRpb25zLnRhbmRlbS5zdXBwbGllZCB8fCBvcHRpb25zLnRhbmRlbS5uYW1lLmVuZHNXaXRoKCBBcXVhUmFkaW9CdXR0b24uVEFOREVNX05BTUVfU1VGRklYICksXHJcbiAgICAgIGBBcXVhUmFkaW9CdXR0b24gdGFuZGVtLm5hbWUgbXVzdCBlbmQgd2l0aCAke0FxdWFSYWRpb0J1dHRvbi5UQU5ERU1fTkFNRV9TVUZGSVh9OiAke29wdGlvbnMudGFuZGVtLnBoZXRpb0lEfWAgKTtcclxuXHJcbiAgICBzdXBlcigpO1xyXG5cclxuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuXHJcbiAgICAvLyBzZWxlY3RlZCBOb2RlXHJcbiAgICBjb25zdCBzZWxlY3RlZE5vZGUgPSBuZXcgTm9kZSgpO1xyXG4gICAgY29uc3QgaW5uZXJDaXJjbGUgPSBuZXcgQ2lyY2xlKCBvcHRpb25zLnJhZGl1cyAvIDMsIHsgZmlsbDogb3B0aW9ucy5jZW50ZXJDb2xvciB9ICk7XHJcbiAgICBjb25zdCBvdXRlckNpcmNsZVNlbGVjdGVkID0gbmV3IENpcmNsZSggb3B0aW9ucy5yYWRpdXMsIHsgZmlsbDogb3B0aW9ucy5zZWxlY3RlZENvbG9yLCBzdHJva2U6IG9wdGlvbnMuc3Ryb2tlIH0gKTtcclxuICAgIGNvbnN0IHNlbGVjdGVkQ2lyY2xlQnV0dG9uID0gbmV3IE5vZGUoIHtcclxuICAgICAgY2hpbGRyZW46IFsgb3V0ZXJDaXJjbGVTZWxlY3RlZCwgaW5uZXJDaXJjbGUgXVxyXG4gICAgfSApO1xyXG4gICAgc2VsZWN0ZWROb2RlLmFkZENoaWxkKCBzZWxlY3RlZENpcmNsZUJ1dHRvbiApO1xyXG5cclxuICAgIC8vIGRlc2VsZWN0ZWQgTm9kZVxyXG4gICAgY29uc3QgZGVzZWxlY3RlZE5vZGUgPSBuZXcgTm9kZSgpO1xyXG4gICAgY29uc3QgZGVzZWxlY3RlZENpcmNsZUJ1dHRvbiA9IG5ldyBDaXJjbGUoIG9wdGlvbnMucmFkaXVzLCB7XHJcbiAgICAgIGZpbGw6IG9wdGlvbnMuZGVzZWxlY3RlZENvbG9yLFxyXG4gICAgICBzdHJva2U6IG9wdGlvbnMuc3Ryb2tlXHJcbiAgICB9ICk7XHJcbiAgICBkZXNlbGVjdGVkTm9kZS5hZGRDaGlsZCggZGVzZWxlY3RlZENpcmNsZUJ1dHRvbiApO1xyXG5cclxuICAgIGNvbnN0IHJhZGlvTm9kZSA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIHNlbGVjdGVkTm9kZSwgZGVzZWxlY3RlZE5vZGUgXSxcclxuICAgICAgcGlja2FibGU6IGZhbHNlIC8vIHJlY3RhbmdsZSB1c2VkIGZvciBpbnB1dFxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGxhYmVsQm91bmRzTGlzdGVuZXIgPSAoKSA9PiB7XHJcbiAgICAgIGxhYmVsTm9kZS5sZWZ0ID0gZGVzZWxlY3RlZENpcmNsZUJ1dHRvbi5yaWdodCArIG9wdGlvbnMueFNwYWNpbmc7XHJcbiAgICAgIGxhYmVsTm9kZS5jZW50ZXJZID0gZGVzZWxlY3RlZENpcmNsZUJ1dHRvbi5jZW50ZXJZO1xyXG4gICAgfTtcclxuICAgIGxhYmVsTm9kZS5ib3VuZHNQcm9wZXJ0eS5saW5rKCBsYWJlbEJvdW5kc0xpc3RlbmVyICk7XHJcblxyXG4gICAgLy8gQWRkIGFuIGludmlzaWJsZSBOb2RlIHRvIG1ha2Ugc3VyZSB0aGUgbGF5b3V0IGZvciBzZWxlY3RlZCB2cyBkZXNlbGVjdGVkIGlzIHRoZSBzYW1lXHJcbiAgICBjb25zdCByZWN0YW5nbGUgPSBuZXcgUmVjdGFuZ2xlKCB7fSApO1xyXG4gICAgc2VsZWN0ZWROb2RlLnBpY2thYmxlID0gZGVzZWxlY3RlZE5vZGUucGlja2FibGUgPSBmYWxzZTsgLy8gdGhlIGJhY2tncm91bmQgcmVjdGFuZ2xlIHN1ZmZpY2VzXHJcblxyXG4gICAgbGFiZWxOb2RlLnBpY2thYmxlID0gZmFsc2U7IC8vIHNpbmNlIHRoZXJlJ3MgYSBwaWNrYWJsZSByZWN0YW5nbGUgb24gdG9wIG9mIGNvbnRlbnRcclxuXHJcbiAgICB0aGlzLmNoaWxkcmVuID0gW1xyXG4gICAgICByYWRpb05vZGUsXHJcbiAgICAgIGxhYmVsTm9kZSxcclxuICAgICAgcmVjdGFuZ2xlXHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMuY29uc3RyYWludCA9IG5ldyBBcXVhUmFkaW9CdXR0b25Db25zdHJhaW50KCB0aGlzLCByYWRpb05vZGUsIGxhYmVsTm9kZSwgcmVjdGFuZ2xlLCBvcHRpb25zICk7XHJcbiAgICB0aGlzLmNvbnN0cmFpbnQudXBkYXRlTGF5b3V0KCk7XHJcblxyXG4gICAgLy8gc3luYyBjb250cm9sIHdpdGggbW9kZWxcclxuICAgIGNvbnN0IHN5bmNXaXRoTW9kZWwgPSAoIG5ld1ZhbHVlOiBUICkgPT4ge1xyXG4gICAgICBzZWxlY3RlZE5vZGUudmlzaWJsZSA9ICggbmV3VmFsdWUgPT09IHZhbHVlICk7XHJcbiAgICAgIGRlc2VsZWN0ZWROb2RlLnZpc2libGUgPSAhc2VsZWN0ZWROb2RlLnZpc2libGU7XHJcbiAgICB9O1xyXG4gICAgcHJvcGVydHkubGluayggc3luY1dpdGhNb2RlbCApO1xyXG5cclxuICAgIC8vIHNldCBQcm9wZXJ0eSB2YWx1ZSBvbiBmaXJlXHJcbiAgICBjb25zdCBmaXJlID0gKCkgPT4ge1xyXG4gICAgICBjb25zdCBvbGRWYWx1ZSA9IHByb3BlcnR5LnZhbHVlO1xyXG4gICAgICBwcm9wZXJ0eS5zZXQoIHZhbHVlICk7XHJcbiAgICAgIGlmICggb2xkVmFsdWUgIT09IHByb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICAgIHRoaXMub25JbnB1dEVtaXR0ZXIuZW1pdCgpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgZmlyZUxpc3RlbmVyID0gbmV3IEZpcmVMaXN0ZW5lcigge1xyXG4gICAgICBmaXJlOiBmaXJlLFxyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2ZpcmVMaXN0ZW5lcicgKVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCBmaXJlTGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyBzb3VuZCBzdXBwb3J0XHJcbiAgICB0aGlzLm9uSW5wdXRFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiBvcHRpb25zLnNvdW5kUGxheWVyLnBsYXkoKSApO1xyXG5cclxuICAgIC8vIHBkb20gLSBpbnB1dCBsaXN0ZW5lciBzbyB0aGF0IHVwZGF0ZXMgdGhlIHN0YXRlIG9mIHRoZSByYWRpbyBidXR0b24gd2l0aCBrZXlib2FyZCBpbnRlcmFjdGlvblxyXG4gICAgY29uc3QgY2hhbmdlTGlzdGVuZXIgPSB7XHJcbiAgICAgIGNoYW5nZTogZmlyZVxyXG4gICAgfTtcclxuICAgIHRoaXMuYWRkSW5wdXRMaXN0ZW5lciggY2hhbmdlTGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyBwZG9tIC0gU3BlY2lmeSB0aGUgZGVmYXVsdCB2YWx1ZSBmb3IgYXNzaXN0aXZlIHRlY2hub2xvZ3kuIFRoaXMgYXR0cmlidXRlIGlzIG5lZWRlZCBpbiBhZGRpdGlvbiB0b1xyXG4gICAgLy8gdGhlICdjaGVja2VkJyBQcm9wZXJ0eSB0byBtYXJrIHRoaXMgZWxlbWVudCBhcyB0aGUgZGVmYXVsdCBzZWxlY3Rpb24gc2luY2UgJ2NoZWNrZWQnIG1heSBiZSBzZXQgYmVmb3JlXHJcbiAgICAvLyB3ZSBhcmUgZmluaXNoZWQgYWRkaW5nIFJhZGlvQnV0dG9ucyB0byB0aGUgY29udGFpbmluZyBncm91cCwgYW5kIHRoZSBicm93c2VyIHdpbGwgcmVtb3ZlIHRoZSBib29sZWFuXHJcbiAgICAvLyAnY2hlY2tlZCcgZmxhZyB3aGVuIG5ldyBidXR0b25zIGFyZSBhZGRlZC5cclxuICAgIGlmICggcHJvcGVydHkudmFsdWUgPT09IHZhbHVlICkge1xyXG4gICAgICB0aGlzLnNldFBET01BdHRyaWJ1dGUoICdjaGVja2VkJywgJ2NoZWNrZWQnICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcGRvbSAtIHdoZW4gdGhlIFByb3BlcnR5IGNoYW5nZXMsIG1ha2Ugc3VyZSB0aGUgY29ycmVjdCByYWRpbyBidXR0b24gaXMgbWFya2VkIGFzICdjaGVja2VkJyBzbyB0aGF0IHRoaXMgYnV0dG9uXHJcbiAgICAvLyByZWNlaXZlcyBmb2N1cyBvbiAndGFiJ1xyXG4gICAgY29uc3QgcGRvbUNoZWNrZWRMaXN0ZW5lciA9ICggbmV3VmFsdWU6IFQgKSA9PiB7XHJcbiAgICAgIHRoaXMucGRvbUNoZWNrZWQgPSAoIG5ld1ZhbHVlID09PSB2YWx1ZSApO1xyXG4gICAgfTtcclxuICAgIHByb3BlcnR5LmxpbmsoIHBkb21DaGVja2VkTGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyBwZG9tIC0gZXZlcnkgYnV0dG9uIGluIGEgZ3JvdXAgb2YgcmFkaW8gYnV0dG9ucyBzaG91bGQgaGF2ZSB0aGUgc2FtZSBuYW1lLCBzZWUgb3B0aW9ucyBmb3IgbW9yZSBpbmZvXHJcbiAgICBpZiAoIG9wdGlvbnMuYTExeU5hbWVBdHRyaWJ1dGUgIT09IG51bGwgKSB7XHJcbiAgICAgIHRoaXMuc2V0UERPTUF0dHJpYnV0ZSggJ25hbWUnLCBvcHRpb25zLmExMXlOYW1lQXR0cmlidXRlICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5tdXRhdGUoIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VBcXVhUmFkaW9CdXR0b24gPSAoKSA9PiB7XHJcbiAgICAgIHRoaXMuY29uc3RyYWludC5kaXNwb3NlKCk7XHJcblxyXG4gICAgICB0aGlzLm9uSW5wdXRFbWl0dGVyLmRpc3Bvc2UoKTtcclxuICAgICAgdGhpcy5yZW1vdmVJbnB1dExpc3RlbmVyKCBmaXJlTGlzdGVuZXIgKTtcclxuICAgICAgdGhpcy5yZW1vdmVJbnB1dExpc3RlbmVyKCBjaGFuZ2VMaXN0ZW5lciApO1xyXG4gICAgICBwcm9wZXJ0eS51bmxpbmsoIHBkb21DaGVja2VkTGlzdGVuZXIgKTtcclxuICAgICAgcHJvcGVydHkudW5saW5rKCBzeW5jV2l0aE1vZGVsICk7XHJcblxyXG4gICAgICBpZiAoIGxhYmVsTm9kZS5ib3VuZHNQcm9wZXJ0eS5oYXNMaXN0ZW5lciggbGFiZWxCb3VuZHNMaXN0ZW5lciApICkge1xyXG4gICAgICAgIGxhYmVsTm9kZS5ib3VuZHNQcm9wZXJ0eS51bmxpbmsoIGxhYmVsQm91bmRzTGlzdGVuZXIgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gcGhldC1pbzogVW5yZWdpc3RlciBsaXN0ZW5lclxyXG4gICAgICBmaXJlTGlzdGVuZXIuZGlzcG9zZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBzdXBwb3J0IGZvciBiaW5kZXIgZG9jdW1lbnRhdGlvbiwgc3RyaXBwZWQgb3V0IGluIGJ1aWxkcyBhbmQgb25seSBydW5zIHdoZW4gP2JpbmRlciBpcyBzcGVjaWZpZWRcclxuICAgIGFzc2VydCAmJiBwaGV0LmNoaXBwZXIucXVlcnlQYXJhbWV0ZXJzLmJpbmRlciAmJiBJbnN0YW5jZVJlZ2lzdHJ5LnJlZ2lzdGVyRGF0YVVSTCggJ3N1bicsICdBcXVhUmFkaW9CdXR0b24nLCB0aGlzICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZGlzcG9zZUFxdWFSYWRpb0J1dHRvbigpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuY2xhc3MgQXF1YVJhZGlvQnV0dG9uQ29uc3RyYWludDxUPiBleHRlbmRzIExheW91dENvbnN0cmFpbnQge1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcmFkaW9CdXR0b246IEFxdWFSYWRpb0J1dHRvbjxUPjtcclxuICBwcml2YXRlIHJlYWRvbmx5IHJhZGlvTm9kZTogTm9kZTtcclxuICBwcml2YXRlIHJlYWRvbmx5IGNvbnRlbnQ6IE5vZGU7XHJcbiAgcHJpdmF0ZSByZWFkb25seSByZWN0YW5nbGU6IFJlY3RhbmdsZTtcclxuICBwcml2YXRlIHJlYWRvbmx5IG9wdGlvbnM6IFJlcXVpcmVkPFNlbGZPcHRpb25zPjtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCByYWRpb0J1dHRvbjogQXF1YVJhZGlvQnV0dG9uPFQ+LCByYWRpb05vZGU6IE5vZGUsIGNvbnRlbnQ6IE5vZGUsIHJlY3RhbmdsZTogUmVjdGFuZ2xlLCBvcHRpb25zOiBSZXF1aXJlZDxTZWxmT3B0aW9ucz4gKSB7XHJcbiAgICBzdXBlciggcmFkaW9CdXR0b24gKTtcclxuXHJcbiAgICB0aGlzLnJhZGlvQnV0dG9uID0gcmFkaW9CdXR0b247XHJcbiAgICB0aGlzLnJhZGlvTm9kZSA9IHJhZGlvTm9kZTtcclxuICAgIHRoaXMuY29udGVudCA9IGNvbnRlbnQ7XHJcbiAgICB0aGlzLnJlY3RhbmdsZSA9IHJlY3RhbmdsZTtcclxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XHJcblxyXG4gICAgdGhpcy5yYWRpb0J1dHRvbi5sb2NhbFByZWZlcnJlZFdpZHRoUHJvcGVydHkubGF6eUxpbmsoIHRoaXMuX3VwZGF0ZUxheW91dExpc3RlbmVyICk7XHJcblxyXG4gICAgdGhpcy5hZGROb2RlKCBjb250ZW50ICk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgb3ZlcnJpZGUgbGF5b3V0KCk6IHZvaWQge1xyXG4gICAgc3VwZXIubGF5b3V0KCk7XHJcblxyXG4gICAgLy8gTGF5b3V0UHJveHkgaGVscHMgd2l0aCBzb21lIGxheW91dCBvcGVyYXRpb25zLCBhbmQgd2lsbCBzdXBwb3J0IGEgbm9uLWNoaWxkIGNvbnRlbnQuXHJcbiAgICBjb25zdCBjb250ZW50UHJveHkgPSB0aGlzLmNyZWF0ZUxheW91dFByb3h5KCB0aGlzLmNvbnRlbnQgKSE7XHJcblxyXG4gICAgY29uc3QgY29udGVudFdpZHRoID0gY29udGVudFByb3h5Lm1pbmltdW1XaWR0aDtcclxuXHJcbiAgICBjb25zdCBtaW5pbXVtV2lkdGggPSB0aGlzLnJhZGlvTm9kZS53aWR0aCArIHRoaXMub3B0aW9ucy54U3BhY2luZyArIGNvbnRlbnRXaWR0aDtcclxuXHJcbiAgICBjb25zdCBwcmVmZXJyZWRXaWR0aCA9IHRoaXMucmFkaW9CdXR0b24ubG9jYWxQcmVmZXJyZWRXaWR0aCA9PT0gbnVsbCA/IG1pbmltdW1XaWR0aCA6IHRoaXMucmFkaW9CdXR0b24ubG9jYWxQcmVmZXJyZWRXaWR0aDtcclxuXHJcbiAgICAvLyBBdHRlbXB0IHRvIHNldCBhIHByZWZlcnJlZFdpZHRoXHJcbiAgICBpZiAoIGlzV2lkdGhTaXphYmxlKCB0aGlzLmNvbnRlbnQgKSApIHtcclxuICAgICAgY29udGVudFByb3h5LnByZWZlcnJlZFdpZHRoID0gcHJlZmVycmVkV2lkdGggLSB0aGlzLnJhZGlvTm9kZS53aWR0aCAtIHRoaXMub3B0aW9ucy54U3BhY2luZztcclxuICAgIH1cclxuXHJcbiAgICAvLyBGb3Igbm93IGp1c3QgcG9zaXRpb24gY29udGVudC4gRnV0dXJlIHVwZGF0ZXMgY291bGQgaW5jbHVkZSB3aWR0aFJlc2l6YWJsZSBjb250ZW50P1xyXG4gICAgY29udGVudFByb3h5LmxlZnQgPSB0aGlzLnJhZGlvTm9kZS5yaWdodCArIHRoaXMub3B0aW9ucy54U3BhY2luZztcclxuICAgIGNvbnRlbnRQcm94eS5jZW50ZXJZID0gdGhpcy5yYWRpb05vZGUuY2VudGVyWTtcclxuXHJcbiAgICAvLyBPdXIgcmVjdGFuZ2xlIGJvdW5kcyB3aWxsIGNvdmVyIHRoZSByYWRpb05vZGUgYW5kIGNvbnRlbnQsIGFuZCBpZiBuZWNlc3NhcnkgZXhwYW5kIHRvIGluY2x1ZGUgdGhlIGZ1bGxcclxuICAgIC8vIHByZWZlcnJlZFdpZHRoXHJcbiAgICB0aGlzLnJlY3RhbmdsZS5yZWN0Qm91bmRzID0gdGhpcy5yYWRpb05vZGUuYm91bmRzLnVuaW9uKCBjb250ZW50UHJveHkuYm91bmRzICkud2l0aE1heFgoXHJcbiAgICAgIE1hdGgubWF4KCB0aGlzLnJhZGlvTm9kZS5sZWZ0ICsgcHJlZmVycmVkV2lkdGgsIGNvbnRlbnRQcm94eS5yaWdodCApXHJcbiAgICApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSBwb2ludGVyIGFyZWFzIChpZiB0aGUgY2xpZW50IGhhc24ndCBjdXN0b21pemVkIHRoZW0pXHJcbiAgICB0aGlzLnJhZGlvQnV0dG9uLl9pc1NldHRpbmdBcmVhcyA9IHRydWU7XHJcbiAgICBpZiAoICF0aGlzLnJhZGlvQnV0dG9uLl9pc1RvdWNoQXJlYUN1c3RvbWl6ZWQgKSB7XHJcbiAgICAgIHRoaXMucmFkaW9CdXR0b24udG91Y2hBcmVhID0gdGhpcy5yYWRpb0J1dHRvbi5sb2NhbEJvdW5kcy5kaWxhdGVkWFkoIHRoaXMub3B0aW9ucy50b3VjaEFyZWFYRGlsYXRpb24sIHRoaXMub3B0aW9ucy50b3VjaEFyZWFZRGlsYXRpb24gKTtcclxuICAgIH1cclxuICAgIGlmICggIXRoaXMucmFkaW9CdXR0b24uX2lzTW91c2VBcmVhQ3VzdG9taXplZCApIHtcclxuICAgICAgdGhpcy5yYWRpb0J1dHRvbi5tb3VzZUFyZWEgPSB0aGlzLnJhZGlvQnV0dG9uLmxvY2FsQm91bmRzLmRpbGF0ZWRYWSggdGhpcy5vcHRpb25zLm1vdXNlQXJlYVhEaWxhdGlvbiwgdGhpcy5vcHRpb25zLm1vdXNlQXJlYVlEaWxhdGlvbiApO1xyXG4gICAgfVxyXG4gICAgdGhpcy5yYWRpb0J1dHRvbi5faXNTZXR0aW5nQXJlYXMgPSBmYWxzZTtcclxuXHJcbiAgICBjb250ZW50UHJveHkuZGlzcG9zZSgpO1xyXG5cclxuICAgIC8vIFNldCB0aGUgbWluaW11bVdpZHRoIGxhc3QsIHNpbmNlIHRoaXMgbWF5IHRyaWdnZXIgYSByZWxheW91dFxyXG4gICAgdGhpcy5yYWRpb0J1dHRvbi5sb2NhbE1pbmltdW1XaWR0aCA9IG1pbmltdW1XaWR0aDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5yYWRpb0J1dHRvbi5sb2NhbFByZWZlcnJlZFdpZHRoUHJvcGVydHkudW5saW5rKCB0aGlzLl91cGRhdGVMYXlvdXRMaXN0ZW5lciApO1xyXG5cclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbnN1bi5yZWdpc3RlciggJ0FxdWFSYWRpb0J1dHRvbicsIEFxdWFSYWRpb0J1dHRvbiApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQSxPQUFPQSxPQUFPLE1BQU0sMEJBQTBCO0FBQzlDLE9BQU9DLGdCQUFnQixNQUFNLHNEQUFzRDtBQUNuRixPQUFPQyxTQUFTLE1BQU0saUNBQWlDO0FBQ3ZELFNBQVNDLE1BQU0sRUFBRUMsWUFBWSxFQUFFQyxjQUFjLEVBQUVDLGdCQUFnQixFQUFFQyxJQUFJLEVBQWVDLFNBQVMsRUFBRUMsZ0JBQWdCLEVBQVVDLE9BQU8sRUFBa0JDLFlBQVksUUFBUSw2QkFBNkI7QUFFbk0sT0FBT0MsZ0NBQWdDLE1BQU0sb0RBQW9EO0FB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