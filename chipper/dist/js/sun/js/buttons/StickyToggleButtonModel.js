// Copyright 2014-2022, University of Colorado Boulder

/**
 * Model for a toggle button that sticks when pushed down and pops up when pushed a second time. Unlike other general
 * sun models, 'sticky' implies a specific type of user-interface component, a button that is either popped up or
 * pressed down.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author John Blanco (PhET Interactive Simulations)
 */

import BooleanProperty from '../../../axon/js/BooleanProperty.js';
import Emitter from '../../../axon/js/Emitter.js';
import optionize from '../../../phet-core/js/optionize.js';
import EventType from '../../../tandem/js/EventType.js';
import Tandem from '../../../tandem/js/Tandem.js';
import sun from '../sun.js';
import ButtonModel from './ButtonModel.js';
export default class StickyToggleButtonModel extends ButtonModel {
  /**
   * @param valueUp - value when the toggle is in the 'up' position
   * @param valueDown - value when the toggle is in the 'down' position
   * @param valueProperty - axon Property that can be either valueUp or valueDown.
   *   Would have preferred to call this `property` but it would clash with the Property function name.
   * @param providedOptions
   */
  constructor(valueUp, valueDown, valueProperty, providedOptions) {
    const options = optionize()({
      tandem: Tandem.REQUIRED
    }, providedOptions);
    super(options);
    this.valueUp = valueUp;
    this.valueDown = valueDown;
    this.valueProperty = valueProperty;
    this.toggledEmitter = new Emitter({
      tandem: options.tandem.createTandem('toggledEmitter'),
      phetioDocumentation: 'Emits when the button is toggled',
      phetioEventType: EventType.USER
    });
    this.toggledEmitter.addListener(() => {
      assert && assert(this.valueProperty.value === this.valueUp || this.valueProperty.value === this.valueDown, `unrecognized value: ${this.valueProperty.value}`);
      this.valueProperty.value = this.valueProperty.value === this.valueUp ? this.valueDown : this.valueUp;
    });

    // When the user releases the toggle button, it should only fire an event if it is not during the same action in
    // which they pressed the button.  Track the state to see if they have already pushed the button.
    // Note: Does this need to be reset when the simulation does "reset all"?  I (Sam Reid) can't find any negative
    // consequences in the user interface of not resetting it, but maybe I missed something. Or maybe it would be safe
    // to reset it anyway.
    this.pressedWhileDownProperty = new BooleanProperty(false);

    // If the button is up and the user presses it, show it pressed and toggle the state right away.  When the button is
    // released, pop up the button (unless it was part of the same action that pressed the button down in the first
    // place).
    const downListener = down => {
      const overOrFocused = this.overProperty.get() || this.focusedProperty.get();
      if (this.enabledProperty.get() && overOrFocused && !this.interrupted) {
        if (down && valueProperty.value === valueUp) {
          this.toggle();
          this.pressedWhileDownProperty.set(false);
        }
        if (!down && valueProperty.value === valueDown) {
          if (this.pressedWhileDownProperty.get()) {
            this.toggle();
          } else {
            this.pressedWhileDownProperty.set(true);
          }
        }
      }

      // Handle the case where the pointer moved out then up over a toggle button, so it will respond to the next press
      if (!down && !overOrFocused) {
        this.pressedWhileDownProperty.set(true);
      }
    };
    this.downProperty.link(downListener);

    // if the valueProperty is set externally to user interaction, update the buttonModel
    // downProperty so the model stays in sync
    const valuePropertyListener = value => {
      this.downProperty.set(value === valueDown);
    };
    valueProperty.link(valuePropertyListener);

    // make the button ready to toggle when enabled
    const enabledPropertyOnListener = enabled => {
      if (enabled) {
        this.pressedWhileDownProperty.set(true);
      }
    };
    this.enabledProperty.link(enabledPropertyOnListener);
    this.disposeToggleButtonModel = () => {
      this.downProperty.unlink(downListener);
      this.enabledProperty.unlink(enabledPropertyOnListener);
      valueProperty.unlink(valuePropertyListener);
      this.toggledEmitter.dispose();
    };
  }
  dispose() {
    this.disposeToggleButtonModel();
    super.dispose();
  }
  toggle() {
    this.toggledEmitter.emit();
    this.produceSoundEmitter.emit();
  }
}
sun.register('StickyToggleButtonModel', StickyToggleButtonModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJFbWl0dGVyIiwib3B0aW9uaXplIiwiRXZlbnRUeXBlIiwiVGFuZGVtIiwic3VuIiwiQnV0dG9uTW9kZWwiLCJTdGlja3lUb2dnbGVCdXR0b25Nb2RlbCIsImNvbnN0cnVjdG9yIiwidmFsdWVVcCIsInZhbHVlRG93biIsInZhbHVlUHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwidGFuZGVtIiwiUkVRVUlSRUQiLCJ0b2dnbGVkRW1pdHRlciIsImNyZWF0ZVRhbmRlbSIsInBoZXRpb0RvY3VtZW50YXRpb24iLCJwaGV0aW9FdmVudFR5cGUiLCJVU0VSIiwiYWRkTGlzdGVuZXIiLCJhc3NlcnQiLCJ2YWx1ZSIsInByZXNzZWRXaGlsZURvd25Qcm9wZXJ0eSIsImRvd25MaXN0ZW5lciIsImRvd24iLCJvdmVyT3JGb2N1c2VkIiwib3ZlclByb3BlcnR5IiwiZ2V0IiwiZm9jdXNlZFByb3BlcnR5IiwiZW5hYmxlZFByb3BlcnR5IiwiaW50ZXJydXB0ZWQiLCJ0b2dnbGUiLCJzZXQiLCJkb3duUHJvcGVydHkiLCJsaW5rIiwidmFsdWVQcm9wZXJ0eUxpc3RlbmVyIiwiZW5hYmxlZFByb3BlcnR5T25MaXN0ZW5lciIsImVuYWJsZWQiLCJkaXNwb3NlVG9nZ2xlQnV0dG9uTW9kZWwiLCJ1bmxpbmsiLCJkaXNwb3NlIiwiZW1pdCIsInByb2R1Y2VTb3VuZEVtaXR0ZXIiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlN0aWNreVRvZ2dsZUJ1dHRvbk1vZGVsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIE1vZGVsIGZvciBhIHRvZ2dsZSBidXR0b24gdGhhdCBzdGlja3Mgd2hlbiBwdXNoZWQgZG93biBhbmQgcG9wcyB1cCB3aGVuIHB1c2hlZCBhIHNlY29uZCB0aW1lLiBVbmxpa2Ugb3RoZXIgZ2VuZXJhbFxyXG4gKiBzdW4gbW9kZWxzLCAnc3RpY2t5JyBpbXBsaWVzIGEgc3BlY2lmaWMgdHlwZSBvZiB1c2VyLWludGVyZmFjZSBjb21wb25lbnQsIGEgYnV0dG9uIHRoYXQgaXMgZWl0aGVyIHBvcHBlZCB1cCBvclxyXG4gKiBwcmVzc2VkIGRvd24uXHJcbiAqXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY28gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IEJvb2xlYW5Qcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL0Jvb2xlYW5Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBFbWl0dGVyIGZyb20gJy4uLy4uLy4uL2F4b24vanMvRW1pdHRlci5qcyc7XHJcbmltcG9ydCBURW1pdHRlciBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1RFbWl0dGVyLmpzJztcclxuaW1wb3J0IFRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1RQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgRXZlbnRUeXBlIGZyb20gJy4uLy4uLy4uL3RhbmRlbS9qcy9FdmVudFR5cGUuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgc3VuIGZyb20gJy4uL3N1bi5qcyc7XHJcbmltcG9ydCBCdXR0b25Nb2RlbCwgeyBCdXR0b25Nb2RlbE9wdGlvbnMgfSBmcm9tICcuL0J1dHRvbk1vZGVsLmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBFbXB0eVNlbGZPcHRpb25zO1xyXG5cclxuZXhwb3J0IHR5cGUgU3RpY2t5VG9nZ2xlQnV0dG9uTW9kZWxPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBCdXR0b25Nb2RlbE9wdGlvbnM7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTdGlja3lUb2dnbGVCdXR0b25Nb2RlbDxUPiBleHRlbmRzIEJ1dHRvbk1vZGVsIHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IHZhbHVlUHJvcGVydHk6IFRQcm9wZXJ0eTxUPjtcclxuICBwdWJsaWMgcmVhZG9ubHkgdmFsdWVVcDogVDtcclxuICBwdWJsaWMgcmVhZG9ubHkgdmFsdWVEb3duOiBUO1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IHRvZ2dsZWRFbWl0dGVyOiBURW1pdHRlcjtcclxuICBwcml2YXRlIHJlYWRvbmx5IHByZXNzZWRXaGlsZURvd25Qcm9wZXJ0eTogVFByb3BlcnR5PGJvb2xlYW4+O1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZVRvZ2dsZUJ1dHRvbk1vZGVsOiAoKSA9PiB2b2lkO1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0gdmFsdWVVcCAtIHZhbHVlIHdoZW4gdGhlIHRvZ2dsZSBpcyBpbiB0aGUgJ3VwJyBwb3NpdGlvblxyXG4gICAqIEBwYXJhbSB2YWx1ZURvd24gLSB2YWx1ZSB3aGVuIHRoZSB0b2dnbGUgaXMgaW4gdGhlICdkb3duJyBwb3NpdGlvblxyXG4gICAqIEBwYXJhbSB2YWx1ZVByb3BlcnR5IC0gYXhvbiBQcm9wZXJ0eSB0aGF0IGNhbiBiZSBlaXRoZXIgdmFsdWVVcCBvciB2YWx1ZURvd24uXHJcbiAgICogICBXb3VsZCBoYXZlIHByZWZlcnJlZCB0byBjYWxsIHRoaXMgYHByb3BlcnR5YCBidXQgaXQgd291bGQgY2xhc2ggd2l0aCB0aGUgUHJvcGVydHkgZnVuY3Rpb24gbmFtZS5cclxuICAgKiBAcGFyYW0gcHJvdmlkZWRPcHRpb25zXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCB2YWx1ZVVwOiBULCB2YWx1ZURvd246IFQsIHZhbHVlUHJvcGVydHk6IFRQcm9wZXJ0eTxUPiwgcHJvdmlkZWRPcHRpb25zPzogU3RpY2t5VG9nZ2xlQnV0dG9uTW9kZWxPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8U3RpY2t5VG9nZ2xlQnV0dG9uTW9kZWxPcHRpb25zLCBTZWxmT3B0aW9ucywgQnV0dG9uTW9kZWxPcHRpb25zPigpKCB7XHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVEXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMudmFsdWVVcCA9IHZhbHVlVXA7XHJcbiAgICB0aGlzLnZhbHVlRG93biA9IHZhbHVlRG93bjtcclxuICAgIHRoaXMudmFsdWVQcm9wZXJ0eSA9IHZhbHVlUHJvcGVydHk7XHJcblxyXG4gICAgdGhpcy50b2dnbGVkRW1pdHRlciA9IG5ldyBFbWl0dGVyKCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAndG9nZ2xlZEVtaXR0ZXInICksXHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdFbWl0cyB3aGVuIHRoZSBidXR0b24gaXMgdG9nZ2xlZCcsXHJcbiAgICAgIHBoZXRpb0V2ZW50VHlwZTogRXZlbnRUeXBlLlVTRVJcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLnRvZ2dsZWRFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiB7XHJcbiAgICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMudmFsdWVQcm9wZXJ0eS52YWx1ZSA9PT0gdGhpcy52YWx1ZVVwIHx8IHRoaXMudmFsdWVQcm9wZXJ0eS52YWx1ZSA9PT0gdGhpcy52YWx1ZURvd24sXHJcbiAgICAgICAgYHVucmVjb2duaXplZCB2YWx1ZTogJHt0aGlzLnZhbHVlUHJvcGVydHkudmFsdWV9YCApO1xyXG4gICAgICB0aGlzLnZhbHVlUHJvcGVydHkudmFsdWUgPSB0aGlzLnZhbHVlUHJvcGVydHkudmFsdWUgPT09IHRoaXMudmFsdWVVcCA/IHRoaXMudmFsdWVEb3duIDogdGhpcy52YWx1ZVVwO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFdoZW4gdGhlIHVzZXIgcmVsZWFzZXMgdGhlIHRvZ2dsZSBidXR0b24sIGl0IHNob3VsZCBvbmx5IGZpcmUgYW4gZXZlbnQgaWYgaXQgaXMgbm90IGR1cmluZyB0aGUgc2FtZSBhY3Rpb24gaW5cclxuICAgIC8vIHdoaWNoIHRoZXkgcHJlc3NlZCB0aGUgYnV0dG9uLiAgVHJhY2sgdGhlIHN0YXRlIHRvIHNlZSBpZiB0aGV5IGhhdmUgYWxyZWFkeSBwdXNoZWQgdGhlIGJ1dHRvbi5cclxuICAgIC8vIE5vdGU6IERvZXMgdGhpcyBuZWVkIHRvIGJlIHJlc2V0IHdoZW4gdGhlIHNpbXVsYXRpb24gZG9lcyBcInJlc2V0IGFsbFwiPyAgSSAoU2FtIFJlaWQpIGNhbid0IGZpbmQgYW55IG5lZ2F0aXZlXHJcbiAgICAvLyBjb25zZXF1ZW5jZXMgaW4gdGhlIHVzZXIgaW50ZXJmYWNlIG9mIG5vdCByZXNldHRpbmcgaXQsIGJ1dCBtYXliZSBJIG1pc3NlZCBzb21ldGhpbmcuIE9yIG1heWJlIGl0IHdvdWxkIGJlIHNhZmVcclxuICAgIC8vIHRvIHJlc2V0IGl0IGFueXdheS5cclxuICAgIHRoaXMucHJlc3NlZFdoaWxlRG93blByb3BlcnR5ID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UgKTtcclxuXHJcbiAgICAvLyBJZiB0aGUgYnV0dG9uIGlzIHVwIGFuZCB0aGUgdXNlciBwcmVzc2VzIGl0LCBzaG93IGl0IHByZXNzZWQgYW5kIHRvZ2dsZSB0aGUgc3RhdGUgcmlnaHQgYXdheS4gIFdoZW4gdGhlIGJ1dHRvbiBpc1xyXG4gICAgLy8gcmVsZWFzZWQsIHBvcCB1cCB0aGUgYnV0dG9uICh1bmxlc3MgaXQgd2FzIHBhcnQgb2YgdGhlIHNhbWUgYWN0aW9uIHRoYXQgcHJlc3NlZCB0aGUgYnV0dG9uIGRvd24gaW4gdGhlIGZpcnN0XHJcbiAgICAvLyBwbGFjZSkuXHJcbiAgICBjb25zdCBkb3duTGlzdGVuZXIgPSAoIGRvd246IGJvb2xlYW4gKSA9PiB7XHJcbiAgICAgIGNvbnN0IG92ZXJPckZvY3VzZWQgPSB0aGlzLm92ZXJQcm9wZXJ0eS5nZXQoKSB8fCB0aGlzLmZvY3VzZWRQcm9wZXJ0eS5nZXQoKTtcclxuICAgICAgaWYgKCB0aGlzLmVuYWJsZWRQcm9wZXJ0eS5nZXQoKSAmJiBvdmVyT3JGb2N1c2VkICYmICF0aGlzLmludGVycnVwdGVkICkge1xyXG4gICAgICAgIGlmICggZG93biAmJiB2YWx1ZVByb3BlcnR5LnZhbHVlID09PSB2YWx1ZVVwICkge1xyXG4gICAgICAgICAgdGhpcy50b2dnbGUoKTtcclxuICAgICAgICAgIHRoaXMucHJlc3NlZFdoaWxlRG93blByb3BlcnR5LnNldCggZmFsc2UgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCAhZG93biAmJiB2YWx1ZVByb3BlcnR5LnZhbHVlID09PSB2YWx1ZURvd24gKSB7XHJcbiAgICAgICAgICBpZiAoIHRoaXMucHJlc3NlZFdoaWxlRG93blByb3BlcnR5LmdldCgpICkge1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJlc3NlZFdoaWxlRG93blByb3BlcnR5LnNldCggdHJ1ZSApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gSGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSBwb2ludGVyIG1vdmVkIG91dCB0aGVuIHVwIG92ZXIgYSB0b2dnbGUgYnV0dG9uLCBzbyBpdCB3aWxsIHJlc3BvbmQgdG8gdGhlIG5leHQgcHJlc3NcclxuICAgICAgaWYgKCAhZG93biAmJiAhb3Zlck9yRm9jdXNlZCApIHtcclxuICAgICAgICB0aGlzLnByZXNzZWRXaGlsZURvd25Qcm9wZXJ0eS5zZXQoIHRydWUgKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmRvd25Qcm9wZXJ0eS5saW5rKCBkb3duTGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyBpZiB0aGUgdmFsdWVQcm9wZXJ0eSBpcyBzZXQgZXh0ZXJuYWxseSB0byB1c2VyIGludGVyYWN0aW9uLCB1cGRhdGUgdGhlIGJ1dHRvbk1vZGVsXHJcbiAgICAvLyBkb3duUHJvcGVydHkgc28gdGhlIG1vZGVsIHN0YXlzIGluIHN5bmNcclxuICAgIGNvbnN0IHZhbHVlUHJvcGVydHlMaXN0ZW5lciA9ICggdmFsdWU6IFQgKSA9PiB7XHJcbiAgICAgIHRoaXMuZG93blByb3BlcnR5LnNldCggdmFsdWUgPT09IHZhbHVlRG93biApO1xyXG4gICAgfTtcclxuICAgIHZhbHVlUHJvcGVydHkubGluayggdmFsdWVQcm9wZXJ0eUxpc3RlbmVyICk7XHJcblxyXG4gICAgLy8gbWFrZSB0aGUgYnV0dG9uIHJlYWR5IHRvIHRvZ2dsZSB3aGVuIGVuYWJsZWRcclxuICAgIGNvbnN0IGVuYWJsZWRQcm9wZXJ0eU9uTGlzdGVuZXIgPSAoIGVuYWJsZWQ6IGJvb2xlYW4gKSA9PiB7XHJcbiAgICAgIGlmICggZW5hYmxlZCApIHtcclxuICAgICAgICB0aGlzLnByZXNzZWRXaGlsZURvd25Qcm9wZXJ0eS5zZXQoIHRydWUgKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRoaXMuZW5hYmxlZFByb3BlcnR5LmxpbmsoIGVuYWJsZWRQcm9wZXJ0eU9uTGlzdGVuZXIgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VUb2dnbGVCdXR0b25Nb2RlbCA9ICgpID0+IHtcclxuICAgICAgdGhpcy5kb3duUHJvcGVydHkudW5saW5rKCBkb3duTGlzdGVuZXIgKTtcclxuICAgICAgdGhpcy5lbmFibGVkUHJvcGVydHkudW5saW5rKCBlbmFibGVkUHJvcGVydHlPbkxpc3RlbmVyICk7XHJcbiAgICAgIHZhbHVlUHJvcGVydHkudW5saW5rKCB2YWx1ZVByb3BlcnR5TGlzdGVuZXIgKTtcclxuICAgICAgdGhpcy50b2dnbGVkRW1pdHRlci5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VUb2dnbGVCdXR0b25Nb2RlbCgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB0b2dnbGUoKTogdm9pZCB7XHJcbiAgICB0aGlzLnRvZ2dsZWRFbWl0dGVyLmVtaXQoKTtcclxuICAgIHRoaXMucHJvZHVjZVNvdW5kRW1pdHRlci5lbWl0KCk7XHJcbiAgfVxyXG59XHJcblxyXG5zdW4ucmVnaXN0ZXIoICdTdGlja3lUb2dnbGVCdXR0b25Nb2RlbCcsIFN0aWNreVRvZ2dsZUJ1dHRvbk1vZGVsICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSxxQ0FBcUM7QUFDakUsT0FBT0MsT0FBTyxNQUFNLDZCQUE2QjtBQUdqRCxPQUFPQyxTQUFTLE1BQTRCLG9DQUFvQztBQUNoRixPQUFPQyxTQUFTLE1BQU0saUNBQWlDO0FBQ3ZELE9BQU9DLE1BQU0sTUFBTSw4QkFBOEI7QUFDakQsT0FBT0MsR0FBRyxNQUFNLFdBQVc7QUFDM0IsT0FBT0MsV0FBVyxNQUE4QixrQkFBa0I7QUFNbEUsZUFBZSxNQUFNQyx1QkFBdUIsU0FBWUQsV0FBVyxDQUFDO0VBVWxFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ1NFLFdBQVdBLENBQUVDLE9BQVUsRUFBRUMsU0FBWSxFQUFFQyxhQUEyQixFQUFFQyxlQUFnRCxFQUFHO0lBRTVILE1BQU1DLE9BQU8sR0FBR1gsU0FBUyxDQUFrRSxDQUFDLENBQUU7TUFDNUZZLE1BQU0sRUFBRVYsTUFBTSxDQUFDVztJQUNqQixDQUFDLEVBQUVILGVBQWdCLENBQUM7SUFFcEIsS0FBSyxDQUFFQyxPQUFRLENBQUM7SUFFaEIsSUFBSSxDQUFDSixPQUFPLEdBQUdBLE9B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