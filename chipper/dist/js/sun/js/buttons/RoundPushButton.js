// Copyright 2014-2022, University of Colorado Boulder

/**
 * RoundPushButton is a round push button, used to initiate some action.
 *
 * @author John Blanco (PhET Interactive Simulations)
 * @author Sam Reid (PhET Interactive Simulations)
 */

import InstanceRegistry from '../../../phet-core/js/documentation/InstanceRegistry.js';
import pushButtonSoundPlayer from '../../../tambo/js/shared-sound-players/pushButtonSoundPlayer.js';
import Tandem from '../../../tandem/js/Tandem.js';
import sun from '../sun.js';
import PushButtonInteractionStateProperty from './PushButtonInteractionStateProperty.js';
import PushButtonModel from './PushButtonModel.js';
import RoundButton from './RoundButton.js';
import optionize from '../../../phet-core/js/optionize.js';

//TODO https://github.com/phetsims/sun/issues/749 Let's not create PushButtonModel with these options?

export default class RoundPushButton extends RoundButton {
  // RoundButton has this.buttonModel, but we also need this.pushButtonModel, because it has additional methods

  constructor(providedOptions) {
    const options = optionize()({
      soundPlayer: pushButtonSoundPlayer,
      tandem: Tandem.REQUIRED,
      tandemNameSuffix: 'Button'
    }, providedOptions);

    // Save the listener and add it after creating the button model. This is done so that
    // the same code path is always used for adding listener, thus guaranteeing a consistent code path if addListener is
    // overridden, see https://github.com/phetsims/sun/issues/284.
    const listener = options.listener;
    const superOptions = _.omit(options, ['listener']);

    // Note it shares a tandem with this, so the emitter will be instrumented as a child of the button
    //TODO https://github.com/phetsims/sun/issues/749 its surprising that we can pass superOptions with irrelevant fields to PushButtonModel without TS errors
    const pushButtonModel = new PushButtonModel(superOptions);
    super(pushButtonModel, new PushButtonInteractionStateProperty(pushButtonModel), superOptions);
    this.pushButtonModel = pushButtonModel;

    // add the listener that was potentially saved above
    listener && this.addListener(listener);

    // sound generation
    const playSound = () => {
      options.soundPlayer.play();
    };
    pushButtonModel.produceSoundEmitter.addListener(playSound);
    this.disposeRoundPushButton = () => {
      pushButtonModel.produceSoundEmitter.removeListener(playSound);
      pushButtonModel.dispose();
    };

    // support for binder documentation, stripped out in builds and only runs when ?binder is specified
    assert && phet.chipper.queryParameters.binder && InstanceRegistry.registerDataURL('sun', 'RoundPushButton', this);
  }
  dispose() {
    // The order of operations here is important - the view needs to be disposed first so that it is unhooked from
    // the model before the model is disposed.  If the model is disposed first, the view ends up trying to change some
    // of its Property values when it is disposed.  See https://github.com/phetsims/axon/issues/242.
    super.dispose();
    this.disposeRoundPushButton();
  }

  /**
   * Adds a listener that will be notified when the button fires.
   */
  addListener(listener) {
    this.pushButtonModel.addListener(listener);
  }

  /**
   * Removes a listener.
   */
  removeListener(listener) {
    this.pushButtonModel.removeListener(listener);
  }
}
sun.register('RoundPushButton', RoundPushButton);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJJbnN0YW5jZVJlZ2lzdHJ5IiwicHVzaEJ1dHRvblNvdW5kUGxheWVyIiwiVGFuZGVtIiwic3VuIiwiUHVzaEJ1dHRvbkludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSIsIlB1c2hCdXR0b25Nb2RlbCIsIlJvdW5kQnV0dG9uIiwib3B0aW9uaXplIiwiUm91bmRQdXNoQnV0dG9uIiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwic291bmRQbGF5ZXIiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsInRhbmRlbU5hbWVTdWZmaXgiLCJsaXN0ZW5lciIsInN1cGVyT3B0aW9ucyIsIl8iLCJvbWl0IiwicHVzaEJ1dHRvbk1vZGVsIiwiYWRkTGlzdGVuZXIiLCJwbGF5U291bmQiLCJwbGF5IiwicHJvZHVjZVNvdW5kRW1pdHRlciIsImRpc3Bvc2VSb3VuZFB1c2hCdXR0b24iLCJyZW1vdmVMaXN0ZW5lciIsImRpc3Bvc2UiLCJhc3NlcnQiLCJwaGV0IiwiY2hpcHBlciIsInF1ZXJ5UGFyYW1ldGVycyIsImJpbmRlciIsInJlZ2lzdGVyRGF0YVVSTCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiUm91bmRQdXNoQnV0dG9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFJvdW5kUHVzaEJ1dHRvbiBpcyBhIHJvdW5kIHB1c2ggYnV0dG9uLCB1c2VkIHRvIGluaXRpYXRlIHNvbWUgYWN0aW9uLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBJbnN0YW5jZVJlZ2lzdHJ5IGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy9kb2N1bWVudGF0aW9uL0luc3RhbmNlUmVnaXN0cnkuanMnO1xyXG5pbXBvcnQgcHVzaEJ1dHRvblNvdW5kUGxheWVyIGZyb20gJy4uLy4uLy4uL3RhbWJvL2pzL3NoYXJlZC1zb3VuZC1wbGF5ZXJzL3B1c2hCdXR0b25Tb3VuZFBsYXllci5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBzdW4gZnJvbSAnLi4vc3VuLmpzJztcclxuaW1wb3J0IFB1c2hCdXR0b25JbnRlcmFjdGlvblN0YXRlUHJvcGVydHkgZnJvbSAnLi9QdXNoQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5LmpzJztcclxuaW1wb3J0IFB1c2hCdXR0b25Nb2RlbCwgeyBQdXNoQnV0dG9uTGlzdGVuZXIsIFB1c2hCdXR0b25Nb2RlbE9wdGlvbnMgfSBmcm9tICcuL1B1c2hCdXR0b25Nb2RlbC5qcyc7XHJcbmltcG9ydCBSb3VuZEJ1dHRvbiwgeyBSb3VuZEJ1dHRvbk9wdGlvbnMgfSBmcm9tICcuL1JvdW5kQnV0dG9uLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFRTb3VuZFBsYXllciBmcm9tICcuLi8uLi8uLi90YW1iby9qcy9UU291bmRQbGF5ZXIuanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuICBzb3VuZFBsYXllcj86IFRTb3VuZFBsYXllcjtcclxufTtcclxuXHJcbi8vVE9ETyBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvc3VuL2lzc3Vlcy83NDkgTGV0J3Mgbm90IGNyZWF0ZSBQdXNoQnV0dG9uTW9kZWwgd2l0aCB0aGVzZSBvcHRpb25zP1xyXG50eXBlIFN1cGVyT3B0aW9ucyA9IFJvdW5kQnV0dG9uT3B0aW9ucyAmIFB1c2hCdXR0b25Nb2RlbE9wdGlvbnM7XHJcblxyXG5leHBvcnQgdHlwZSBSb3VuZFB1c2hCdXR0b25PcHRpb25zID0gU2VsZk9wdGlvbnMgJiBTdXBlck9wdGlvbnM7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSb3VuZFB1c2hCdXR0b24gZXh0ZW5kcyBSb3VuZEJ1dHRvbiB7XHJcblxyXG4gIC8vIFJvdW5kQnV0dG9uIGhhcyB0aGlzLmJ1dHRvbk1vZGVsLCBidXQgd2UgYWxzbyBuZWVkIHRoaXMucHVzaEJ1dHRvbk1vZGVsLCBiZWNhdXNlIGl0IGhhcyBhZGRpdGlvbmFsIG1ldGhvZHNcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgcHVzaEJ1dHRvbk1vZGVsOiBQdXNoQnV0dG9uTW9kZWw7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZVJvdW5kUHVzaEJ1dHRvbjogKCkgPT4gdm9pZDtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBwcm92aWRlZE9wdGlvbnM/OiBSb3VuZFB1c2hCdXR0b25PcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8Um91bmRQdXNoQnV0dG9uT3B0aW9ucywgU2VsZk9wdGlvbnMsIFN1cGVyT3B0aW9ucz4oKSgge1xyXG4gICAgICBzb3VuZFBsYXllcjogcHVzaEJ1dHRvblNvdW5kUGxheWVyLFxyXG4gICAgICB0YW5kZW06IFRhbmRlbS5SRVFVSVJFRCxcclxuICAgICAgdGFuZGVtTmFtZVN1ZmZpeDogJ0J1dHRvbidcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIFNhdmUgdGhlIGxpc3RlbmVyIGFuZCBhZGQgaXQgYWZ0ZXIgY3JlYXRpbmcgdGhlIGJ1dHRvbiBtb2RlbC4gVGhpcyBpcyBkb25lIHNvIHRoYXRcclxuICAgIC8vIHRoZSBzYW1lIGNvZGUgcGF0aCBpcyBhbHdheXMgdXNlZCBmb3IgYWRkaW5nIGxpc3RlbmVyLCB0aHVzIGd1YXJhbnRlZWluZyBhIGNvbnNpc3RlbnQgY29kZSBwYXRoIGlmIGFkZExpc3RlbmVyIGlzXHJcbiAgICAvLyBvdmVycmlkZGVuLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3N1bi9pc3N1ZXMvMjg0LlxyXG4gICAgY29uc3QgbGlzdGVuZXIgPSBvcHRpb25zLmxpc3RlbmVyO1xyXG4gICAgY29uc3Qgc3VwZXJPcHRpb25zID0gXy5vbWl0KCBvcHRpb25zLCBbICdsaXN0ZW5lcicgXSApO1xyXG5cclxuICAgIC8vIE5vdGUgaXQgc2hhcmVzIGEgdGFuZGVtIHdpdGggdGhpcywgc28gdGhlIGVtaXR0ZXIgd2lsbCBiZSBpbnN0cnVtZW50ZWQgYXMgYSBjaGlsZCBvZiB0aGUgYnV0dG9uXHJcbiAgICAvL1RPRE8gaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3N1bi9pc3N1ZXMvNzQ5IGl0cyBzdXJwcmlzaW5nIHRoYXQgd2UgY2FuIHBhc3Mgc3VwZXJPcHRpb25zIHdpdGggaXJyZWxldmFudCBmaWVsZHMgdG8gUHVzaEJ1dHRvbk1vZGVsIHdpdGhvdXQgVFMgZXJyb3JzXHJcbiAgICBjb25zdCBwdXNoQnV0dG9uTW9kZWwgPSBuZXcgUHVzaEJ1dHRvbk1vZGVsKCBzdXBlck9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggcHVzaEJ1dHRvbk1vZGVsLCBuZXcgUHVzaEJ1dHRvbkludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSggcHVzaEJ1dHRvbk1vZGVsICksIHN1cGVyT3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMucHVzaEJ1dHRvbk1vZGVsID0gcHVzaEJ1dHRvbk1vZGVsO1xyXG5cclxuICAgIC8vIGFkZCB0aGUgbGlzdGVuZXIgdGhhdCB3YXMgcG90ZW50aWFsbHkgc2F2ZWQgYWJvdmVcclxuICAgIGxpc3RlbmVyICYmIHRoaXMuYWRkTGlzdGVuZXIoIGxpc3RlbmVyICk7XHJcblxyXG4gICAgLy8gc291bmQgZ2VuZXJhdGlvblxyXG4gICAgY29uc3QgcGxheVNvdW5kID0gKCkgPT4geyBvcHRpb25zLnNvdW5kUGxheWVyLnBsYXkoKTsgfTtcclxuICAgIHB1c2hCdXR0b25Nb2RlbC5wcm9kdWNlU291bmRFbWl0dGVyLmFkZExpc3RlbmVyKCBwbGF5U291bmQgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VSb3VuZFB1c2hCdXR0b24gPSAoKSA9PiB7XHJcbiAgICAgIHB1c2hCdXR0b25Nb2RlbC5wcm9kdWNlU291bmRFbWl0dGVyLnJlbW92ZUxpc3RlbmVyKCBwbGF5U291bmQgKTtcclxuICAgICAgcHVzaEJ1dHRvbk1vZGVsLmRpc3Bvc2UoKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gc3VwcG9ydCBmb3IgYmluZGVyIGRvY3VtZW50YXRpb24sIHN0cmlwcGVkIG91dCBpbiBidWlsZHMgYW5kIG9ubHkgcnVucyB3aGVuID9iaW5kZXIgaXMgc3BlY2lmaWVkXHJcbiAgICBhc3NlcnQgJiYgcGhldC5jaGlwcGVyLnF1ZXJ5UGFyYW1ldGVycy5iaW5kZXIgJiYgSW5zdGFuY2VSZWdpc3RyeS5yZWdpc3RlckRhdGFVUkwoICdzdW4nLCAnUm91bmRQdXNoQnV0dG9uJywgdGhpcyApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcblxyXG4gICAgLy8gVGhlIG9yZGVyIG9mIG9wZXJhdGlvbnMgaGVyZSBpcyBpbXBvcnRhbnQgLSB0aGUgdmlldyBuZWVkcyB0byBiZSBkaXNwb3NlZCBmaXJzdCBzbyB0aGF0IGl0IGlzIHVuaG9va2VkIGZyb21cclxuICAgIC8vIHRoZSBtb2RlbCBiZWZvcmUgdGhlIG1vZGVsIGlzIGRpc3Bvc2VkLiAgSWYgdGhlIG1vZGVsIGlzIGRpc3Bvc2VkIGZpcnN0LCB0aGUgdmlldyBlbmRzIHVwIHRyeWluZyB0byBjaGFuZ2Ugc29tZVxyXG4gICAgLy8gb2YgaXRzIFByb3BlcnR5IHZhbHVlcyB3aGVuIGl0IGlzIGRpc3Bvc2VkLiAgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9heG9uL2lzc3Vlcy8yNDIuXHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgICB0aGlzLmRpc3Bvc2VSb3VuZFB1c2hCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgYSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgbm90aWZpZWQgd2hlbiB0aGUgYnV0dG9uIGZpcmVzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhZGRMaXN0ZW5lciggbGlzdGVuZXI6IFB1c2hCdXR0b25MaXN0ZW5lciApOiB2b2lkIHtcclxuICAgIHRoaXMucHVzaEJ1dHRvbk1vZGVsLmFkZExpc3RlbmVyKCBsaXN0ZW5lciApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVtb3ZlcyBhIGxpc3RlbmVyLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZW1vdmVMaXN0ZW5lciggbGlzdGVuZXI6IFB1c2hCdXR0b25MaXN0ZW5lciApOiB2b2lkIHtcclxuICAgIHRoaXMucHVzaEJ1dHRvbk1vZGVsLnJlbW92ZUxpc3RlbmVyKCBsaXN0ZW5lciApO1xyXG4gIH1cclxufVxyXG5cclxuc3VuLnJlZ2lzdGVyKCAnUm91bmRQdXNoQnV0dG9uJywgUm91bmRQdXNoQnV0dG9uICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZ0JBQWdCLE1BQU0seURBQXlEO0FBQ3RGLE9BQU9DLHFCQUFxQixNQUFNLGlFQUFpRTtBQUNuRyxPQUFPQyxNQUFNLE1BQU0sOEJBQThCO0FBQ2pELE9BQU9DLEdBQUcsTUFBTSxXQUFXO0FBQzNCLE9BQU9DLGtDQUFrQyxNQUFNLHlDQUF5QztBQUN4RixPQUFPQyxlQUFlLE1BQXNELHNCQUFzQjtBQUNsRyxPQUFPQyxXQUFXLE1BQThCLGtCQUFrQjtBQUNsRSxPQUFPQyxTQUFTLE1BQU0sb0NBQW9DOztBQU8xRDs7QUFLQSxlQUFlLE1BQU1DLGVBQWUsU0FBU0YsV0FBVyxDQUFDO0VBRXZEOztFQUtPRyxXQUFXQSxDQUFFQyxlQUF3QyxFQUFHO0lBRTdELE1BQU1DLE9BQU8sR0FBR0osU0FBUyxDQUFvRCxDQUFDLENBQUU7TUFDOUVLLFdBQVcsRUFBRVgscUJBQXFCO01BQ2xDWSxNQUFNLEVBQUVYLE1BQU0sQ0FBQ1ksUUFBUTtNQUN2QkMsZ0JBQWdCLEVBQUU7SUFDcEIsQ0FBQyxFQUFFTCxlQUFnQixDQUFDOztJQUVwQjtJQUNBO0lBQ0E7SUFDQSxNQUFNTSxRQUFRLEdBQUdMLE9BQU8sQ0FBQ0ssUUFBUTtJQUNqQyxNQUFNQyxZQUFZLEdBQUdDLENBQUMsQ0FBQ0MsSUFBSSxDQUFFUixPQUFPLEVBQUUsQ0FBRSxVQUFVLENBQUcsQ0FBQzs7SUFFdEQ7SUFDQTtJQUNBLE1BQU1TLGVBQWUsR0FBRyxJQUFJZixlQUFlLENBQUVZLFlBQWEsQ0FBQztJQUUzRCxLQUFLLENBQUVHLGVBQWUsRUFBRSxJQUFJaEIsa0NBQWtDLENBQUVnQixlQUFnQixDQUFDLEVBQUVILFlBQWEsQ0FBQztJQUVqRyxJQUFJLENBQUNHLGVBQWUsR0FBR0EsZUFBZTs7SUFFdEM7SUFDQUosUUFBUSxJQUFJLElBQUksQ0FBQ0ssV0FBVyxDQUFFTCxRQUFTLENBQUM7O0lBRXhDO0lBQ0EsTUFBTU0sU0FBUyxHQUFHQSxDQUFBLEtBQU07TUFBRVgsT0FBTyxDQUFDQyxXQUFXLENBQUNXLElBQUksQ0FBQyxDQUFDO0lBQUUsQ0FBQztJQUN2REgsZUFBZSxDQUFDSSxtQkFBbUIsQ0FBQ0gsV0FBVyxDQUFFQyxTQUFVLENBQUM7SUFFNUQsSUFBSSxDQUFDRyxzQkFBc0IsR0FBRyxNQUFNO01BQ2xDTCxlQUFlLENBQUNJLG1CQUFtQixDQUFDRSxjQUFjLENBQUVKLFNBQVUsQ0FBQztNQUMvREYsZUFBZSxDQUFDTyxPQUFPLENBQUMsQ0FBQztJQUMzQixDQUFDOztJQUVEO0lBQ0FDLE1BQU0sSUFBSUMsSUFBSSxDQUFDQyxPQUFPLENBQUNDLGVBQWUsQ0FBQ0MsTUFBTSxJQUFJaEMsZ0JBQWdCLENBQUNpQyxlQUFlLENBQUUsS0FBSyxFQUFFLGlCQUFpQixFQUFFLElBQUssQ0FBQztFQUNySDtFQUVnQk4sT0FBT0EsQ0FBQSxFQUFTO0lBRTlCO0lBQ0E7SUFDQTtJQUNBLEtBQUssQ0FBQ0EsT0FBTyxDQUFDLENBQUM7SUFDZixJQUFJLENBQUNGLHNCQUFzQixDQUFDLENBQUM7RUFDL0I7O0VBRUE7QUFDRjtBQUNBO0VBQ1NKLFdBQVdBLENBQUVMLFFBQTRCLEVBQVM7SUFDdkQsSUFBSSxDQUFDSSxlQUFlLENBQUNDLFdBQVcsQ0FBRUwsUUFBUyxDQUFDO0VBQzlDOztFQUVBO0FBQ0Y7QUFDQTtFQUNTVSxjQUFjQSxDQUFFVixRQUE0QixFQUFTO0lBQzFELElBQUksQ0FBQ0ksZUFBZSxDQUFDTSxjQUFjLENBQUVWLFFBQVMsQ0FBQztFQUNqRDtBQUNGO0FBRUFiLEdBQUcsQ0FBQytCLFFBQVEsQ0FBRSxpQkFBaUIsRUFBRTFCLGVBQWdCLENBQUMifQ==