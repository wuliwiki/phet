// Copyright 2019-2023, University of Colorado Boulder

/**
 * The button on a combo box box.  Displays the current selection on the button.
 * Typically instantiated by ComboBox, not by client code.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import { Shape } from '../../kite/js/imports.js';
import optionize from '../../phet-core/js/optionize.js';
import { AriaHasPopUpMutator, GridBox, Line, Node, Path, PDOMPeer } from '../../scenery/js/imports.js';
import Tandem from '../../tandem/js/Tandem.js';
import ButtonNode from './buttons/ButtonNode.js';
import RectangularPushButton from './buttons/RectangularPushButton.js';
import sun from './sun.js';
import SunConstants from './SunConstants.js';
import nullSoundPlayer from '../../tambo/js/shared-sound-players/nullSoundPlayer.js';
import TinyProperty from '../../axon/js/TinyProperty.js';
import ComboBox from './ComboBox.js';
import Multilink from '../../axon/js/Multilink.js';
import PatternStringProperty from '../../axon/js/PatternStringProperty.js';
import Property from '../../axon/js/Property.js';

// constants
const ALIGN_VALUES = ['left', 'center', 'right'];
const ARROW_DIRECTION_VALUES = ['up', 'down'];
// The definition for how ComboBoxButton sets its accessibleName in the PDOM. See ComboBox.md for further style guide
// and documentation on the pattern.
const ACCESSIBLE_NAME_BEHAVIOR = (node, options, accessibleName) => {
  options.labelTagName = 'p'; // NOTE: A `span` causes duplicate name-speaking with VO+safari in https://github.com/phetsims/ratio-and-proportion/issues/532
  options.labelContent = accessibleName;
  return options;
};
export default class ComboBoxButton extends RectangularPushButton {
  // set to true to block voicing to occur upon this button's next focus event.

  // needed by methods

  constructor(property, items, nodes, providedOptions) {
    const options = optionize()({
      align: 'left',
      arrowDirection: 'down',
      arrowFill: 'black',
      comboBoxVoicingNameResponsePattern: SunConstants.VALUE_NAMED_PLACEHOLDER,
      // RectangularPushButton options
      cursor: 'pointer',
      baseColor: 'white',
      buttonAppearanceStrategy: ButtonNode.FlatAppearanceStrategy,
      xMargin: 12,
      yMargin: 8,
      stroke: 'black',
      lineWidth: 1,
      soundPlayer: nullSoundPlayer,
      // disable default sound generation

      // PushButtonModel options
      enabledPropertyOptions: {
        phetioFeatured: false
      },
      visiblePropertyOptions: {
        phetioFeatured: false
      },
      localPreferredWidthProperty: new TinyProperty(null),
      localMinimumWidthProperty: new TinyProperty(null),
      // phet-io
      tandem: Tandem.OPTIONAL,
      // pdom
      containerTagName: 'div',
      accessibleNameBehavior: ACCESSIBLE_NAME_BEHAVIOR
    }, providedOptions);
    assert && assert(_.includes(ALIGN_VALUES, options.align), `invalid align: ${options.align}`);
    assert && assert(_.includes(ARROW_DIRECTION_VALUES, options.arrowDirection), `invalid arrowDirection: ${options.arrowDirection}`);

    // To improve readability
    const itemXMargin = options.xMargin;
    const itemYMargin = options.yMargin;

    // Compute max item size
    const maxItemWidthProperty = ComboBox.getMaxItemWidthProperty(nodes);
    const maxItemHeightProperty = ComboBox.getMaxItemHeightProperty(nodes);
    const arrow = new Path(null, {
      fill: options.arrowFill
    });

    // Wrapper for the selected item's Node.
    // Do not transform ComboBoxItem.node because it is shared with ComboBoxListItemNode.

    const matchingItem = _.find(items, item => item.value === property.value);
    const index = items.indexOf(matchingItem);
    const itemNodeWrapper = new Node({
      layoutOptions: {
        yMargin: itemYMargin,
        grow: 1,
        xAlign: options.align
      },
      children: [nodes[index]]
    });

    // Line separator between the item and arrow that is the full height of the button.
    // We cannot use VSeparator here, because it is incompatible with GridConstraints.
    // y2 is set during a multilink according to the item height property.
    const separatorLine = new Line(0, 0, 0, 0, {
      stroke: 'black',
      lineWidth: options.lineWidth
    });
    options.content = new GridBox({
      rows: [[itemNodeWrapper, separatorLine, arrow]]
    });

    // Update the drop-down arrow.  No dispose is needed since the dependencies are locally owned.
    Multilink.multilink([maxItemWidthProperty, maxItemHeightProperty], (maxItemWidth, maxItemHeight) => {
      const fullHeight = maxItemHeight + 2 * itemYMargin;

      // We want the arrow area to be square, see https://github.com/phetsims/sun/issues/453
      const arrowAreaSize = fullHeight;

      // The arrow is sized to fit in the arrow area, empirically determined to be visually pleasing.
      const arrowHeight = 0.35 * arrowAreaSize; // height of equilateral triangle
      const arrowWidth = 2 * arrowHeight * Math.sqrt(3) / 3; // side of equilateral triangle

      const leftMargin = itemXMargin;
      const middleMargin = itemXMargin - options.lineWidth / 2; // Compensation for the separator having width
      const rightMargin = -options.lineWidth / 2; // Compensation for the separator having width

      // arrow that points up or down, to indicate which way the list pops up
      const createArrowShape = (direction, width, height) => {
        if (direction === 'up') {
          return new Shape().moveTo(0, height).lineTo(width / 2, 0).lineTo(width, height).close();
        } else {
          return new Shape().moveTo(0, 0).lineTo(width, 0).lineTo(width / 2, height).close();
        }
      };
      arrow.shape = createArrowShape(options.arrowDirection, arrowWidth, arrowHeight);
      arrow.mutateLayoutOptions({
        minContentWidth: arrowAreaSize,
        minContentHeight: arrowAreaSize
      });
      itemNodeWrapper.mutateLayoutOptions({
        minContentWidth: maxItemWidth,
        minContentHeight: maxItemHeight,
        leftMargin: leftMargin,
        rightMargin: middleMargin
      });
      separatorLine.y2 = fullHeight;
      separatorLine.mutateLayoutOptions({
        rightMargin: rightMargin
      });
    });

    // Margins are different in the item and button areas. And we want the vertical separator to extend
    // beyond the margin.  We've handled those margins above, so the actual margins propagated to the button
    // need to be zero.
    options.xMargin = 0;
    options.yMargin = 0;
    super(options);

    // Provide our minimum width back up to the ComboBox (or creator)
    this.minimumWidthProperty.link(minimumWidth => {
      options.localMinimumWidthProperty.value = minimumWidth;
    });

    // Hook our ComboBox's preferredWidth up to ours
    const preferredWidthListener = preferredWidth => {
      this.preferredWidth = preferredWidth;
    };
    options.localPreferredWidthProperty.link(preferredWidthListener);
    this._blockNextVoicingFocusListener = false;
    this.voicingFocusListener = () => {
      // fire the listener only if we are not blocking the focus listener
      !this._blockNextVoicingFocusListener && this.defaultFocusListener();
      this._blockNextVoicingFocusListener = false;
    };

    // Keep track for disposal
    let voicingPatternstringProperty = null;

    // When Property's value changes, show the corresponding item's Node on the button.
    let item = null;
    const propertyObserver = value => {
      // remove the node for the previous item
      itemNodeWrapper.removeAllChildren();

      // find the ComboBoxItem whose value matches the property's value
      item = _.find(items, item => item.value === value);
      assert && assert(item, `no item found for value: ${value}`);
      const index = items.indexOf(item);
      const node = nodes[index];

      // add the associated node
      itemNodeWrapper.addChild(node);

      // pdom
      this.innerContent = item.a11yName || null;
      const patternProperty = typeof options.comboBoxVoicingNameResponsePattern === 'string' ? new Property(options.comboBoxVoicingNameResponsePattern) : options.comboBoxVoicingNameResponsePattern;
      voicingPatternstringProperty && voicingPatternstringProperty.dispose();
      this.voicingNameResponse = voicingPatternstringProperty = new PatternStringProperty(patternProperty, {
        value: item.a11yName
      });
    };
    property.link(propertyObserver);

    // Add aria-labelledby attribute to the button.
    // The button is aria-labelledby its own label sibling, and then (second) its primary sibling in the PDOM.
    // Order matters!
    this.ariaLabelledbyAssociations = [{
      otherNode: this,
      otherElementName: PDOMPeer.LABEL_SIBLING,
      thisElementName: PDOMPeer.PRIMARY_SIBLING
    }, {
      otherNode: this,
      otherElementName: PDOMPeer.PRIMARY_SIBLING,
      thisElementName: PDOMPeer.PRIMARY_SIBLING
    }];

    // signify to AT that this button opens a menu
    AriaHasPopUpMutator.mutateNode(this, 'listbox');
    this.disposeComboBoxButton = () => {
      maxItemWidthProperty.dispose();
      maxItemHeightProperty.dispose();
      property.unlink(propertyObserver);
      options.localPreferredWidthProperty.unlink(preferredWidthListener);
      voicingPatternstringProperty && voicingPatternstringProperty.dispose();
    };
    this.arrow = arrow;
    this.separatorLine = separatorLine;
  }

  /**
   * Sets the button to look like a value display instead of a combo box button.
   * See https://github.com/phetsims/sun/issues/451
   */
  setDisplayOnly(displayOnly) {
    this.arrow.visible = !displayOnly;
    this.separatorLine.visible = !displayOnly;
  }

  /**
   * Call to block voicing from occurring upon this button's next focus event.
   * For use by ComboBox.
   */
  blockNextVoicingFocusListener() {
    this._blockNextVoicingFocusListener = true;
  }
  dispose() {
    this.disposeComboBoxButton();
    super.dispose();
  }
}
sun.register('ComboBoxButton', ComboBoxButton);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaGFwZSIsIm9wdGlvbml6ZSIsIkFyaWFIYXNQb3BVcE11dGF0b3IiLCJHcmlkQm94IiwiTGluZSIsIk5vZGUiLCJQYXRoIiwiUERPTVBlZXIiLCJUYW5kZW0iLCJCdXR0b25Ob2RlIiwiUmVjdGFuZ3VsYXJQdXNoQnV0dG9uIiwic3VuIiwiU3VuQ29uc3RhbnRzIiwibnVsbFNvdW5kUGxheWVyIiwiVGlueVByb3BlcnR5IiwiQ29tYm9Cb3giLCJNdWx0aWxpbmsiLCJQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJQcm9wZXJ0eSIsIkFMSUdOX1ZBTFVFUyIsIkFSUk9XX0RJUkVDVElPTl9WQUxVRVMiLCJBQ0NFU1NJQkxFX05BTUVfQkVIQVZJT1IiLCJub2RlIiwib3B0aW9ucyIsImFjY2Vzc2libGVOYW1lIiwibGFiZWxUYWdOYW1lIiwibGFiZWxDb250ZW50IiwiQ29tYm9Cb3hCdXR0b24iLCJjb25zdHJ1Y3RvciIsInByb3BlcnR5IiwiaXRlbXMiLCJub2RlcyIsInByb3ZpZGVkT3B0aW9ucyIsImFsaWduIiwiYXJyb3dEaXJlY3Rpb24iLCJhcnJvd0ZpbGwiLCJjb21ib0JveFZvaWNpbmdOYW1lUmVzcG9uc2VQYXR0ZXJuIiwiVkFMVUVfTkFNRURfUExBQ0VIT0xERVIiLCJjdXJzb3IiLCJiYXNlQ29sb3IiLCJidXR0b25BcHBlYXJhbmNlU3RyYXRlZ3kiLCJGbGF0QXBwZWFyYW5jZVN0cmF0ZWd5IiwieE1hcmdpbiIsInlNYXJnaW4iLCJzdHJva2UiLCJsaW5lV2lkdGgiLCJzb3VuZFBsYXllciIsImVuYWJsZWRQcm9wZXJ0eU9wdGlvbnMiLCJwaGV0aW9GZWF0dXJlZCIsInZpc2libGVQcm9wZXJ0eU9wdGlvbnMiLCJsb2NhbFByZWZlcnJlZFdpZHRoUHJvcGVydHkiLCJsb2NhbE1pbmltdW1XaWR0aFByb3BlcnR5IiwidGFuZGVtIiwiT1BUSU9OQUwiLCJjb250YWluZXJUYWdOYW1lIiwiYWNjZXNzaWJsZU5hbWVCZWhhdmlvciIsImFzc2VydCIsIl8iLCJpbmNsdWRlcyIsIml0ZW1YTWFyZ2luIiwiaXRlbVlNYXJnaW4iLCJtYXhJdGVtV2lkdGhQcm9wZXJ0eSIsImdldE1heEl0ZW1XaWR0aFByb3BlcnR5IiwibWF4SXRlbUhlaWdodFByb3BlcnR5IiwiZ2V0TWF4SXRlbUhlaWdodFByb3BlcnR5IiwiYXJyb3ciLCJmaWxsIiwibWF0Y2hpbmdJdGVtIiwiZmluZCIsIml0ZW0iLCJ2YWx1ZSIsImluZGV4IiwiaW5kZXhPZiIsIml0ZW1Ob2RlV3JhcHBlciIsImxheW91dE9wdGlvbnMiLCJncm93IiwieEFsaWduIiwiY2hpbGRyZW4iLCJzZXBhcmF0b3JMaW5lIiwiY29udGVudCIsInJvd3MiLCJtdWx0aWxpbmsiLCJtYXhJdGVtV2lkdGgiLCJtYXhJdGVtSGVpZ2h0IiwiZnVsbEhlaWdodCIsImFycm93QXJlYVNpemUiLCJhcnJvd0hlaWdodCIsImFycm93V2lkdGgiLCJNYXRoIiwic3FydCIsImxlZnRNYXJnaW4iLCJtaWRkbGVNYXJnaW4iLCJyaWdodE1hcmdpbiIsImNyZWF0ZUFycm93U2hhcGUiLCJkaXJlY3Rpb24iLCJ3aWR0aCIsImhlaWdodCIsIm1vdmVUbyIsImxpbmVUbyIsImNsb3NlIiwic2hhcGUiLCJtdXRhdGVMYXlvdXRPcHRpb25zIiwibWluQ29udGVudFdpZHRoIiwibWluQ29udGVudEhlaWdodCIsInkyIiwibWluaW11bVdpZHRoUHJvcGVydHkiLCJsaW5rIiwibWluaW11bVdpZHRoIiwicHJlZmVycmVkV2lkdGhMaXN0ZW5lciIsInByZWZlcnJlZFdpZHRoIiwiX2Jsb2NrTmV4dFZvaWNpbmdGb2N1c0xpc3RlbmVyIiwidm9pY2luZ0ZvY3VzTGlzdGVuZXIiLCJkZWZhdWx0Rm9jdXNMaXN0ZW5lciIsInZvaWNpbmdQYXR0ZXJuc3RyaW5nUHJvcGVydHkiLCJwcm9wZXJ0eU9ic2VydmVyIiwicmVtb3ZlQWxsQ2hpbGRyZW4iLCJhZGRDaGlsZCIsImlubmVyQ29udGVudCIsImExMXlOYW1lIiwicGF0dGVyblByb3BlcnR5IiwiZGlzcG9zZSIsInZvaWNpbmdOYW1lUmVzcG9uc2UiLCJhcmlhTGFiZWxsZWRieUFzc29jaWF0aW9ucyIsIm90aGVyTm9kZSIsIm90aGVyRWxlbWVudE5hbWUiLCJMQUJFTF9TSUJMSU5HIiwidGhpc0VsZW1lbnROYW1lIiwiUFJJTUFSWV9TSUJMSU5HIiwibXV0YXRlTm9kZSIsImRpc3Bvc2VDb21ib0JveEJ1dHRvbiIsInVubGluayIsInNldERpc3BsYXlPbmx5IiwiZGlzcGxheU9ubHkiLCJ2aXNpYmxlIiwiYmxvY2tOZXh0Vm9pY2luZ0ZvY3VzTGlzdGVuZXIiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkNvbWJvQm94QnV0dG9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE5LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFRoZSBidXR0b24gb24gYSBjb21ibyBib3ggYm94LiAgRGlzcGxheXMgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIG9uIHRoZSBidXR0b24uXHJcbiAqIFR5cGljYWxseSBpbnN0YW50aWF0ZWQgYnkgQ29tYm9Cb3gsIG5vdCBieSBjbGllbnQgY29kZS5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCB7IEFyaWFIYXNQb3BVcE11dGF0b3IsIEdyaWRCb3gsIExpbmUsIE5vZGUsIFBhdGgsIFBET01CZWhhdmlvckZ1bmN0aW9uLCBQRE9NUGVlciwgVFBhaW50IH0gZnJvbSAnLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IEJ1dHRvbk5vZGUgZnJvbSAnLi9idXR0b25zL0J1dHRvbk5vZGUuanMnO1xyXG5pbXBvcnQgUmVjdGFuZ3VsYXJQdXNoQnV0dG9uLCB7IFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbk9wdGlvbnMgfSBmcm9tICcuL2J1dHRvbnMvUmVjdGFuZ3VsYXJQdXNoQnV0dG9uLmpzJztcclxuaW1wb3J0IHN1biBmcm9tICcuL3N1bi5qcyc7XHJcbmltcG9ydCBTdW5Db25zdGFudHMgZnJvbSAnLi9TdW5Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgVFByb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvVFByb3BlcnR5LmpzJztcclxuaW1wb3J0IG51bGxTb3VuZFBsYXllciBmcm9tICcuLi8uLi90YW1iby9qcy9zaGFyZWQtc291bmQtcGxheWVycy9udWxsU291bmRQbGF5ZXIuanMnO1xyXG5pbXBvcnQgVGlueVByb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvVGlueVByb3BlcnR5LmpzJztcclxuaW1wb3J0IFN0cmljdE9taXQgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1N0cmljdE9taXQuanMnO1xyXG5pbXBvcnQgQ29tYm9Cb3gsIHsgQ29tYm9Cb3hJdGVtTm9Ob2RlIH0gZnJvbSAnLi9Db21ib0JveC5qcyc7XHJcbmltcG9ydCBNdWx0aWxpbmsgZnJvbSAnLi4vLi4vYXhvbi9qcy9NdWx0aWxpbmsuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBQYXR0ZXJuU3RyaW5nUHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9QYXR0ZXJuU3RyaW5nUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgQUxJR05fVkFMVUVTID0gWyAnbGVmdCcsICdjZW50ZXInLCAncmlnaHQnIF0gYXMgY29uc3Q7XHJcbmNvbnN0IEFSUk9XX0RJUkVDVElPTl9WQUxVRVMgPSBbICd1cCcsICdkb3duJyBdIGFzIGNvbnN0O1xyXG5cclxuZXhwb3J0IHR5cGUgQ29tYm9Cb3hCdXR0b25BbGlnbiA9IHR5cGVvZiBBTElHTl9WQUxVRVNbbnVtYmVyXTtcclxuZXhwb3J0IHR5cGUgQ29tYm9Cb3hCdXR0b25BcnJvd0RpcmVjdGlvbiA9IHR5cGVvZiBBUlJPV19ESVJFQ1RJT05fVkFMVUVTW251bWJlcl07XHJcblxyXG4vLyBUaGUgZGVmaW5pdGlvbiBmb3IgaG93IENvbWJvQm94QnV0dG9uIHNldHMgaXRzIGFjY2Vzc2libGVOYW1lIGluIHRoZSBQRE9NLiBTZWUgQ29tYm9Cb3gubWQgZm9yIGZ1cnRoZXIgc3R5bGUgZ3VpZGVcclxuLy8gYW5kIGRvY3VtZW50YXRpb24gb24gdGhlIHBhdHRlcm4uXHJcbmNvbnN0IEFDQ0VTU0lCTEVfTkFNRV9CRUhBVklPUjogUERPTUJlaGF2aW9yRnVuY3Rpb24gPSAoIG5vZGUsIG9wdGlvbnMsIGFjY2Vzc2libGVOYW1lICkgPT4ge1xyXG4gIG9wdGlvbnMubGFiZWxUYWdOYW1lID0gJ3AnOyAvLyBOT1RFOiBBIGBzcGFuYCBjYXVzZXMgZHVwbGljYXRlIG5hbWUtc3BlYWtpbmcgd2l0aCBWTytzYWZhcmkgaW4gaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3JhdGlvLWFuZC1wcm9wb3J0aW9uL2lzc3Vlcy81MzJcclxuICBvcHRpb25zLmxhYmVsQ29udGVudCA9IGFjY2Vzc2libGVOYW1lO1xyXG4gIHJldHVybiBvcHRpb25zO1xyXG59O1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuICBhbGlnbj86IENvbWJvQm94QnV0dG9uQWxpZ247XHJcbiAgYXJyb3dEaXJlY3Rpb24/OiBDb21ib0JveEJ1dHRvbkFycm93RGlyZWN0aW9uO1xyXG4gIGFycm93RmlsbD86IFRQYWludDtcclxuXHJcbiAgLy8gVGhlIHBhdHRlcm4gZm9yIHRoZSB2b2ljaW5nTmFtZVJlc3BvbnNlLCB3aXRoIFwie3t2YWx1ZX19XCIgcHJvdmlkZWQgdG8gYmUgZmlsbGVkIGluIHdpdGhcclxuICAvLyBDb21ib0JveEl0ZW0uYTExeU5hbWUuXHJcbiAgY29tYm9Cb3hWb2ljaW5nTmFtZVJlc3BvbnNlUGF0dGVybj86IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz4gfCBzdHJpbmc7XHJcblxyXG4gIGxvY2FsUHJlZmVycmVkV2lkdGhQcm9wZXJ0eT86IFRSZWFkT25seVByb3BlcnR5PG51bWJlciB8IG51bGw+O1xyXG4gIGxvY2FsTWluaW11bVdpZHRoUHJvcGVydHk/OiBUUHJvcGVydHk8bnVtYmVyIHwgbnVsbD47IC8vIFdpbGwgb25seSBiZSBzZXRcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIENvbWJvQm94QnV0dG9uT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgU3RyaWN0T21pdDxSZWN0YW5ndWxhclB1c2hCdXR0b25PcHRpb25zLCAnY2hpbGRyZW4nIHwgJ2FyaWFMYWJlbGxlZGJ5QXNzb2NpYXRpb25zJz47XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21ib0JveEJ1dHRvbjxUPiBleHRlbmRzIFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbiB7XHJcblxyXG4gIC8vIHNldCB0byB0cnVlIHRvIGJsb2NrIHZvaWNpbmcgdG8gb2NjdXIgdXBvbiB0aGlzIGJ1dHRvbidzIG5leHQgZm9jdXMgZXZlbnQuXHJcbiAgcHJpdmF0ZSBfYmxvY2tOZXh0Vm9pY2luZ0ZvY3VzTGlzdGVuZXI6IGJvb2xlYW47XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZUNvbWJvQm94QnV0dG9uOiAoKSA9PiB2b2lkO1xyXG5cclxuICAvLyBuZWVkZWQgYnkgbWV0aG9kc1xyXG4gIHByaXZhdGUgYXJyb3c6IFBhdGg7XHJcbiAgcHJpdmF0ZSBzZXBhcmF0b3JMaW5lOiBMaW5lO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3BlcnR5OiBUUHJvcGVydHk8VD4sIGl0ZW1zOiBDb21ib0JveEl0ZW1Ob05vZGU8VD5bXSwgbm9kZXM6IE5vZGVbXSwgcHJvdmlkZWRPcHRpb25zPzogQ29tYm9Cb3hCdXR0b25PcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8Q29tYm9Cb3hCdXR0b25PcHRpb25zLCBTZWxmT3B0aW9ucywgUmVjdGFuZ3VsYXJQdXNoQnV0dG9uT3B0aW9ucz4oKSgge1xyXG5cclxuICAgICAgYWxpZ246ICdsZWZ0JyxcclxuICAgICAgYXJyb3dEaXJlY3Rpb246ICdkb3duJyxcclxuICAgICAgYXJyb3dGaWxsOiAnYmxhY2snLFxyXG5cclxuICAgICAgY29tYm9Cb3hWb2ljaW5nTmFtZVJlc3BvbnNlUGF0dGVybjogU3VuQ29uc3RhbnRzLlZBTFVFX05BTUVEX1BMQUNFSE9MREVSLFxyXG5cclxuICAgICAgLy8gUmVjdGFuZ3VsYXJQdXNoQnV0dG9uIG9wdGlvbnNcclxuICAgICAgY3Vyc29yOiAncG9pbnRlcicsXHJcbiAgICAgIGJhc2VDb2xvcjogJ3doaXRlJyxcclxuICAgICAgYnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5OiBCdXR0b25Ob2RlLkZsYXRBcHBlYXJhbmNlU3RyYXRlZ3ksXHJcbiAgICAgIHhNYXJnaW46IDEyLFxyXG4gICAgICB5TWFyZ2luOiA4LFxyXG4gICAgICBzdHJva2U6ICdibGFjaycsXHJcbiAgICAgIGxpbmVXaWR0aDogMSxcclxuICAgICAgc291bmRQbGF5ZXI6IG51bGxTb3VuZFBsYXllciwgLy8gZGlzYWJsZSBkZWZhdWx0IHNvdW5kIGdlbmVyYXRpb25cclxuXHJcbiAgICAgIC8vIFB1c2hCdXR0b25Nb2RlbCBvcHRpb25zXHJcbiAgICAgIGVuYWJsZWRQcm9wZXJ0eU9wdGlvbnM6IHtcclxuICAgICAgICBwaGV0aW9GZWF0dXJlZDogZmFsc2VcclxuICAgICAgfSxcclxuICAgICAgdmlzaWJsZVByb3BlcnR5T3B0aW9uczogeyBwaGV0aW9GZWF0dXJlZDogZmFsc2UgfSxcclxuXHJcbiAgICAgIGxvY2FsUHJlZmVycmVkV2lkdGhQcm9wZXJ0eTogbmV3IFRpbnlQcm9wZXJ0eSggbnVsbCApLFxyXG4gICAgICBsb2NhbE1pbmltdW1XaWR0aFByb3BlcnR5OiBuZXcgVGlueVByb3BlcnR5KCBudWxsICksXHJcblxyXG4gICAgICAvLyBwaGV0LWlvXHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLk9QVElPTkFMLFxyXG5cclxuICAgICAgLy8gcGRvbVxyXG4gICAgICBjb250YWluZXJUYWdOYW1lOiAnZGl2JyxcclxuICAgICAgYWNjZXNzaWJsZU5hbWVCZWhhdmlvcjogQUNDRVNTSUJMRV9OQU1FX0JFSEFWSU9SXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBfLmluY2x1ZGVzKCBBTElHTl9WQUxVRVMsIG9wdGlvbnMuYWxpZ24gKSxcclxuICAgICAgYGludmFsaWQgYWxpZ246ICR7b3B0aW9ucy5hbGlnbn1gICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBfLmluY2x1ZGVzKCBBUlJPV19ESVJFQ1RJT05fVkFMVUVTLCBvcHRpb25zLmFycm93RGlyZWN0aW9uICksXHJcbiAgICAgIGBpbnZhbGlkIGFycm93RGlyZWN0aW9uOiAke29wdGlvbnMuYXJyb3dEaXJlY3Rpb259YCApO1xyXG5cclxuICAgIC8vIFRvIGltcHJvdmUgcmVhZGFiaWxpdHlcclxuICAgIGNvbnN0IGl0ZW1YTWFyZ2luID0gb3B0aW9ucy54TWFyZ2luO1xyXG4gICAgY29uc3QgaXRlbVlNYXJnaW4gPSBvcHRpb25zLnlNYXJnaW47XHJcblxyXG4gICAgLy8gQ29tcHV0ZSBtYXggaXRlbSBzaXplXHJcbiAgICBjb25zdCBtYXhJdGVtV2lkdGhQcm9wZXJ0eSA9IENvbWJvQm94LmdldE1heEl0ZW1XaWR0aFByb3BlcnR5KCBub2RlcyApO1xyXG4gICAgY29uc3QgbWF4SXRlbUhlaWdodFByb3BlcnR5ID0gQ29tYm9Cb3guZ2V0TWF4SXRlbUhlaWdodFByb3BlcnR5KCBub2RlcyApO1xyXG5cclxuICAgIGNvbnN0IGFycm93ID0gbmV3IFBhdGgoIG51bGwsIHtcclxuICAgICAgZmlsbDogb3B0aW9ucy5hcnJvd0ZpbGxcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBXcmFwcGVyIGZvciB0aGUgc2VsZWN0ZWQgaXRlbSdzIE5vZGUuXHJcbiAgICAvLyBEbyBub3QgdHJhbnNmb3JtIENvbWJvQm94SXRlbS5ub2RlIGJlY2F1c2UgaXQgaXMgc2hhcmVkIHdpdGggQ29tYm9Cb3hMaXN0SXRlbU5vZGUuXHJcblxyXG5cclxuICAgIGNvbnN0IG1hdGNoaW5nSXRlbSA9IF8uZmluZCggaXRlbXMsIGl0ZW0gPT4gaXRlbS52YWx1ZSA9PT0gcHJvcGVydHkudmFsdWUgKSE7XHJcbiAgICBjb25zdCBpbmRleCA9IGl0ZW1zLmluZGV4T2YoIG1hdGNoaW5nSXRlbSApO1xyXG4gICAgY29uc3QgaXRlbU5vZGVXcmFwcGVyID0gbmV3IE5vZGUoIHtcclxuICAgICAgbGF5b3V0T3B0aW9uczoge1xyXG4gICAgICAgIHlNYXJnaW46IGl0ZW1ZTWFyZ2luLFxyXG4gICAgICAgIGdyb3c6IDEsXHJcbiAgICAgICAgeEFsaWduOiBvcHRpb25zLmFsaWduXHJcbiAgICAgIH0sXHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgbm9kZXNbIGluZGV4IF1cclxuICAgICAgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIExpbmUgc2VwYXJhdG9yIGJldHdlZW4gdGhlIGl0ZW0gYW5kIGFycm93IHRoYXQgaXMgdGhlIGZ1bGwgaGVpZ2h0IG9mIHRoZSBidXR0b24uXHJcbiAgICAvLyBXZSBjYW5ub3QgdXNlIFZTZXBhcmF0b3IgaGVyZSwgYmVjYXVzZSBpdCBpcyBpbmNvbXBhdGlibGUgd2l0aCBHcmlkQ29uc3RyYWludHMuXHJcbiAgICAvLyB5MiBpcyBzZXQgZHVyaW5nIGEgbXVsdGlsaW5rIGFjY29yZGluZyB0byB0aGUgaXRlbSBoZWlnaHQgcHJvcGVydHkuXHJcbiAgICBjb25zdCBzZXBhcmF0b3JMaW5lID0gbmV3IExpbmUoIDAsIDAsIDAsIDAsIHtcclxuICAgICAgc3Ryb2tlOiAnYmxhY2snLFxyXG4gICAgICBsaW5lV2lkdGg6IG9wdGlvbnMubGluZVdpZHRoXHJcbiAgICB9ICk7XHJcblxyXG4gICAgb3B0aW9ucy5jb250ZW50ID0gbmV3IEdyaWRCb3goIHtcclxuICAgICAgcm93czogWyBbXHJcbiAgICAgICAgaXRlbU5vZGVXcmFwcGVyLFxyXG4gICAgICAgIHNlcGFyYXRvckxpbmUsXHJcbiAgICAgICAgYXJyb3dcclxuICAgICAgXSBdXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHRoZSBkcm9wLWRvd24gYXJyb3cuICBObyBkaXNwb3NlIGlzIG5lZWRlZCBzaW5jZSB0aGUgZGVwZW5kZW5jaWVzIGFyZSBsb2NhbGx5IG93bmVkLlxyXG4gICAgTXVsdGlsaW5rLm11bHRpbGluayggWyBtYXhJdGVtV2lkdGhQcm9wZXJ0eSwgbWF4SXRlbUhlaWdodFByb3BlcnR5IF0sICggbWF4SXRlbVdpZHRoLCBtYXhJdGVtSGVpZ2h0ICkgPT4ge1xyXG5cclxuICAgICAgY29uc3QgZnVsbEhlaWdodCA9IG1heEl0ZW1IZWlnaHQgKyAyICogaXRlbVlNYXJnaW47XHJcblxyXG4gICAgICAvLyBXZSB3YW50IHRoZSBhcnJvdyBhcmVhIHRvIGJlIHNxdWFyZSwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzQ1M1xyXG4gICAgICBjb25zdCBhcnJvd0FyZWFTaXplID0gZnVsbEhlaWdodDtcclxuXHJcbiAgICAgIC8vIFRoZSBhcnJvdyBpcyBzaXplZCB0byBmaXQgaW4gdGhlIGFycm93IGFyZWEsIGVtcGlyaWNhbGx5IGRldGVybWluZWQgdG8gYmUgdmlzdWFsbHkgcGxlYXNpbmcuXHJcbiAgICAgIGNvbnN0IGFycm93SGVpZ2h0ID0gMC4zNSAqIGFycm93QXJlYVNpemU7IC8vIGhlaWdodCBvZiBlcXVpbGF0ZXJhbCB0cmlhbmdsZVxyXG4gICAgICBjb25zdCBhcnJvd1dpZHRoID0gMiAqIGFycm93SGVpZ2h0ICogTWF0aC5zcXJ0KCAzICkgLyAzOyAvLyBzaWRlIG9mIGVxdWlsYXRlcmFsIHRyaWFuZ2xlXHJcblxyXG4gICAgICBjb25zdCBsZWZ0TWFyZ2luID0gaXRlbVhNYXJnaW47XHJcbiAgICAgIGNvbnN0IG1pZGRsZU1hcmdpbiA9IGl0ZW1YTWFyZ2luIC0gb3B0aW9ucy5saW5lV2lkdGggLyAyOyAvLyBDb21wZW5zYXRpb24gZm9yIHRoZSBzZXBhcmF0b3IgaGF2aW5nIHdpZHRoXHJcbiAgICAgIGNvbnN0IHJpZ2h0TWFyZ2luID0gLW9wdGlvbnMubGluZVdpZHRoIC8gMjsgLy8gQ29tcGVuc2F0aW9uIGZvciB0aGUgc2VwYXJhdG9yIGhhdmluZyB3aWR0aFxyXG5cclxuICAgICAgLy8gYXJyb3cgdGhhdCBwb2ludHMgdXAgb3IgZG93biwgdG8gaW5kaWNhdGUgd2hpY2ggd2F5IHRoZSBsaXN0IHBvcHMgdXBcclxuICAgICAgY29uc3QgY3JlYXRlQXJyb3dTaGFwZSA9ICggZGlyZWN0aW9uOiAndXAnIHwgJ2Rvd24nLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciApID0+IHtcclxuICAgICAgICBpZiAoIGRpcmVjdGlvbiA9PT0gJ3VwJyApIHtcclxuICAgICAgICAgIHJldHVybiBuZXcgU2hhcGUoKVxyXG4gICAgICAgICAgICAubW92ZVRvKCAwLCBoZWlnaHQgKVxyXG4gICAgICAgICAgICAubGluZVRvKCB3aWR0aCAvIDIsIDAgKVxyXG4gICAgICAgICAgICAubGluZVRvKCB3aWR0aCwgaGVpZ2h0IClcclxuICAgICAgICAgICAgLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIG5ldyBTaGFwZSgpXHJcbiAgICAgICAgICAgIC5tb3ZlVG8oIDAsIDAgKVxyXG4gICAgICAgICAgICAubGluZVRvKCB3aWR0aCwgMCApXHJcbiAgICAgICAgICAgIC5saW5lVG8oIHdpZHRoIC8gMiwgaGVpZ2h0IClcclxuICAgICAgICAgICAgLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgYXJyb3cuc2hhcGUgPSBjcmVhdGVBcnJvd1NoYXBlKCBvcHRpb25zLmFycm93RGlyZWN0aW9uLCBhcnJvd1dpZHRoLCBhcnJvd0hlaWdodCApO1xyXG4gICAgICBhcnJvdy5tdXRhdGVMYXlvdXRPcHRpb25zKCB7XHJcbiAgICAgICAgbWluQ29udGVudFdpZHRoOiBhcnJvd0FyZWFTaXplLFxyXG4gICAgICAgIG1pbkNvbnRlbnRIZWlnaHQ6IGFycm93QXJlYVNpemVcclxuICAgICAgfSApO1xyXG5cclxuICAgICAgaXRlbU5vZGVXcmFwcGVyLm11dGF0ZUxheW91dE9wdGlvbnMoIHtcclxuICAgICAgICBtaW5Db250ZW50V2lkdGg6IG1heEl0ZW1XaWR0aCxcclxuICAgICAgICBtaW5Db250ZW50SGVpZ2h0OiBtYXhJdGVtSGVpZ2h0LFxyXG4gICAgICAgIGxlZnRNYXJnaW46IGxlZnRNYXJnaW4sXHJcbiAgICAgICAgcmlnaHRNYXJnaW46IG1pZGRsZU1hcmdpblxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICBzZXBhcmF0b3JMaW5lLnkyID0gZnVsbEhlaWdodDtcclxuICAgICAgc2VwYXJhdG9yTGluZS5tdXRhdGVMYXlvdXRPcHRpb25zKCB7XHJcbiAgICAgICAgcmlnaHRNYXJnaW46IHJpZ2h0TWFyZ2luXHJcbiAgICAgIH0gKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBNYXJnaW5zIGFyZSBkaWZmZXJlbnQgaW4gdGhlIGl0ZW0gYW5kIGJ1dHRvbiBhcmVhcy4gQW5kIHdlIHdhbnQgdGhlIHZlcnRpY2FsIHNlcGFyYXRvciB0byBleHRlbmRcclxuICAgIC8vIGJleW9uZCB0aGUgbWFyZ2luLiAgV2UndmUgaGFuZGxlZCB0aG9zZSBtYXJnaW5zIGFib3ZlLCBzbyB0aGUgYWN0dWFsIG1hcmdpbnMgcHJvcGFnYXRlZCB0byB0aGUgYnV0dG9uXHJcbiAgICAvLyBuZWVkIHRvIGJlIHplcm8uXHJcbiAgICBvcHRpb25zLnhNYXJnaW4gPSAwO1xyXG4gICAgb3B0aW9ucy55TWFyZ2luID0gMDtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIFByb3ZpZGUgb3VyIG1pbmltdW0gd2lkdGggYmFjayB1cCB0byB0aGUgQ29tYm9Cb3ggKG9yIGNyZWF0b3IpXHJcbiAgICB0aGlzLm1pbmltdW1XaWR0aFByb3BlcnR5LmxpbmsoIG1pbmltdW1XaWR0aCA9PiB7XHJcbiAgICAgIG9wdGlvbnMubG9jYWxNaW5pbXVtV2lkdGhQcm9wZXJ0eS52YWx1ZSA9IG1pbmltdW1XaWR0aDtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBIb29rIG91ciBDb21ib0JveCdzIHByZWZlcnJlZFdpZHRoIHVwIHRvIG91cnNcclxuICAgIGNvbnN0IHByZWZlcnJlZFdpZHRoTGlzdGVuZXIgPSAoIHByZWZlcnJlZFdpZHRoOiBudW1iZXIgfCBudWxsICkgPT4ge1xyXG4gICAgICB0aGlzLnByZWZlcnJlZFdpZHRoID0gcHJlZmVycmVkV2lkdGg7XHJcbiAgICB9O1xyXG4gICAgb3B0aW9ucy5sb2NhbFByZWZlcnJlZFdpZHRoUHJvcGVydHkubGluayggcHJlZmVycmVkV2lkdGhMaXN0ZW5lciApO1xyXG5cclxuICAgIHRoaXMuX2Jsb2NrTmV4dFZvaWNpbmdGb2N1c0xpc3RlbmVyID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy52b2ljaW5nRm9jdXNMaXN0ZW5lciA9ICgpID0+IHtcclxuXHJcbiAgICAgIC8vIGZpcmUgdGhlIGxpc3RlbmVyIG9ubHkgaWYgd2UgYXJlIG5vdCBibG9ja2luZyB0aGUgZm9jdXMgbGlzdGVuZXJcclxuICAgICAgIXRoaXMuX2Jsb2NrTmV4dFZvaWNpbmdGb2N1c0xpc3RlbmVyICYmIHRoaXMuZGVmYXVsdEZvY3VzTGlzdGVuZXIoKTtcclxuICAgICAgdGhpcy5fYmxvY2tOZXh0Vm9pY2luZ0ZvY3VzTGlzdGVuZXIgPSBmYWxzZTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gS2VlcCB0cmFjayBmb3IgZGlzcG9zYWxcclxuICAgIGxldCB2b2ljaW5nUGF0dGVybnN0cmluZ1Byb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgLy8gV2hlbiBQcm9wZXJ0eSdzIHZhbHVlIGNoYW5nZXMsIHNob3cgdGhlIGNvcnJlc3BvbmRpbmcgaXRlbSdzIE5vZGUgb24gdGhlIGJ1dHRvbi5cclxuICAgIGxldCBpdGVtOiBDb21ib0JveEl0ZW1Ob05vZGU8VD4gfCBudWxsID0gbnVsbDtcclxuICAgIGNvbnN0IHByb3BlcnR5T2JzZXJ2ZXIgPSAoIHZhbHVlOiBUICkgPT4ge1xyXG4gICAgICAvLyByZW1vdmUgdGhlIG5vZGUgZm9yIHRoZSBwcmV2aW91cyBpdGVtXHJcbiAgICAgIGl0ZW1Ob2RlV3JhcHBlci5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG5cclxuICAgICAgLy8gZmluZCB0aGUgQ29tYm9Cb3hJdGVtIHdob3NlIHZhbHVlIG1hdGNoZXMgdGhlIHByb3BlcnR5J3MgdmFsdWVcclxuICAgICAgaXRlbSA9IF8uZmluZCggaXRlbXMsIGl0ZW0gPT4gaXRlbS52YWx1ZSA9PT0gdmFsdWUgKSE7XHJcbiAgICAgIGFzc2VydCAmJiBhc3NlcnQoIGl0ZW0sIGBubyBpdGVtIGZvdW5kIGZvciB2YWx1ZTogJHt2YWx1ZX1gICk7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gaXRlbXMuaW5kZXhPZiggaXRlbSApO1xyXG4gICAgICBjb25zdCBub2RlID0gbm9kZXNbIGluZGV4IF07XHJcblxyXG4gICAgICAvLyBhZGQgdGhlIGFzc29jaWF0ZWQgbm9kZVxyXG4gICAgICBpdGVtTm9kZVdyYXBwZXIuYWRkQ2hpbGQoIG5vZGUgKTtcclxuXHJcbiAgICAgIC8vIHBkb21cclxuICAgICAgdGhpcy5pbm5lckNvbnRlbnQgPSAoIGl0ZW0uYTExeU5hbWUgfHwgbnVsbCApO1xyXG5cclxuICAgICAgY29uc3QgcGF0dGVyblByb3BlcnR5ID0gdHlwZW9mIG9wdGlvbnMuY29tYm9Cb3hWb2ljaW5nTmFtZVJlc3BvbnNlUGF0dGVybiA9PT0gJ3N0cmluZycgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgUHJvcGVydHkoIG9wdGlvbnMuY29tYm9Cb3hWb2ljaW5nTmFtZVJlc3BvbnNlUGF0dGVybiApIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5jb21ib0JveFZvaWNpbmdOYW1lUmVzcG9uc2VQYXR0ZXJuO1xyXG5cclxuICAgICAgdm9pY2luZ1BhdHRlcm5zdHJpbmdQcm9wZXJ0eSAmJiB2b2ljaW5nUGF0dGVybnN0cmluZ1Byb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgdGhpcy52b2ljaW5nTmFtZVJlc3BvbnNlID0gdm9pY2luZ1BhdHRlcm5zdHJpbmdQcm9wZXJ0eSA9IG5ldyBQYXR0ZXJuU3RyaW5nUHJvcGVydHkoIHBhdHRlcm5Qcm9wZXJ0eSwge1xyXG4gICAgICAgIHZhbHVlOiBpdGVtLmExMXlOYW1lXHJcbiAgICAgIH0gKTtcclxuICAgIH07XHJcbiAgICBwcm9wZXJ0eS5saW5rKCBwcm9wZXJ0eU9ic2VydmVyICk7XHJcblxyXG4gICAgLy8gQWRkIGFyaWEtbGFiZWxsZWRieSBhdHRyaWJ1dGUgdG8gdGhlIGJ1dHRvbi5cclxuICAgIC8vIFRoZSBidXR0b24gaXMgYXJpYS1sYWJlbGxlZGJ5IGl0cyBvd24gbGFiZWwgc2libGluZywgYW5kIHRoZW4gKHNlY29uZCkgaXRzIHByaW1hcnkgc2libGluZyBpbiB0aGUgUERPTS5cclxuICAgIC8vIE9yZGVyIG1hdHRlcnMhXHJcbiAgICB0aGlzLmFyaWFMYWJlbGxlZGJ5QXNzb2NpYXRpb25zID0gW1xyXG4gICAgICB7XHJcbiAgICAgICAgb3RoZXJOb2RlOiB0aGlzLFxyXG4gICAgICAgIG90aGVyRWxlbWVudE5hbWU6IFBET01QZWVyLkxBQkVMX1NJQkxJTkcsXHJcbiAgICAgICAgdGhpc0VsZW1lbnROYW1lOiBQRE9NUGVlci5QUklNQVJZX1NJQkxJTkdcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIG90aGVyTm9kZTogdGhpcyxcclxuICAgICAgICBvdGhlckVsZW1lbnROYW1lOiBQRE9NUGVlci5QUklNQVJZX1NJQkxJTkcsXHJcbiAgICAgICAgdGhpc0VsZW1lbnROYW1lOiBQRE9NUGVlci5QUklNQVJZX1NJQkxJTkdcclxuICAgICAgfVxyXG4gICAgXTtcclxuXHJcbiAgICAvLyBzaWduaWZ5IHRvIEFUIHRoYXQgdGhpcyBidXR0b24gb3BlbnMgYSBtZW51XHJcbiAgICBBcmlhSGFzUG9wVXBNdXRhdG9yLm11dGF0ZU5vZGUoIHRoaXMsICdsaXN0Ym94JyApO1xyXG5cclxuICAgIHRoaXMuZGlzcG9zZUNvbWJvQm94QnV0dG9uID0gKCkgPT4ge1xyXG4gICAgICBtYXhJdGVtV2lkdGhQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICAgIG1heEl0ZW1IZWlnaHRQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcblxyXG4gICAgICBwcm9wZXJ0eS51bmxpbmsoIHByb3BlcnR5T2JzZXJ2ZXIgKTtcclxuICAgICAgb3B0aW9ucy5sb2NhbFByZWZlcnJlZFdpZHRoUHJvcGVydHkudW5saW5rKCBwcmVmZXJyZWRXaWR0aExpc3RlbmVyICk7XHJcblxyXG4gICAgICB2b2ljaW5nUGF0dGVybnN0cmluZ1Byb3BlcnR5ICYmIHZvaWNpbmdQYXR0ZXJuc3RyaW5nUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmFycm93ID0gYXJyb3c7XHJcbiAgICB0aGlzLnNlcGFyYXRvckxpbmUgPSBzZXBhcmF0b3JMaW5lO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0cyB0aGUgYnV0dG9uIHRvIGxvb2sgbGlrZSBhIHZhbHVlIGRpc3BsYXkgaW5zdGVhZCBvZiBhIGNvbWJvIGJveCBidXR0b24uXHJcbiAgICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzQ1MVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXREaXNwbGF5T25seSggZGlzcGxheU9ubHk6IGJvb2xlYW4gKTogdm9pZCB7XHJcbiAgICB0aGlzLmFycm93LnZpc2libGUgPSAhZGlzcGxheU9ubHk7XHJcbiAgICB0aGlzLnNlcGFyYXRvckxpbmUudmlzaWJsZSA9ICFkaXNwbGF5T25seTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGwgdG8gYmxvY2sgdm9pY2luZyBmcm9tIG9jY3VycmluZyB1cG9uIHRoaXMgYnV0dG9uJ3MgbmV4dCBmb2N1cyBldmVudC5cclxuICAgKiBGb3IgdXNlIGJ5IENvbWJvQm94LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBibG9ja05leHRWb2ljaW5nRm9jdXNMaXN0ZW5lcigpOiB2b2lkIHtcclxuICAgIHRoaXMuX2Jsb2NrTmV4dFZvaWNpbmdGb2N1c0xpc3RlbmVyID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5kaXNwb3NlQ29tYm9Cb3hCdXR0b24oKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbnN1bi5yZWdpc3RlciggJ0NvbWJvQm94QnV0dG9uJywgQ29tYm9Cb3hCdXR0b24gKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBU0EsS0FBSyxRQUFRLDBCQUEwQjtBQUNoRCxPQUFPQyxTQUFTLE1BQU0saUNBQWlDO0FBQ3ZELFNBQVNDLG1CQUFtQixFQUFFQyxPQUFPLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxJQUFJLEVBQXdCQyxRQUFRLFFBQWdCLDZCQUE2QjtBQUNwSSxPQUFPQyxNQUFNLE1BQU0sMkJBQTJCO0FBQzlDLE9BQU9DLFVBQVUsTUFBTSx5QkFBeUI7QUFDaEQsT0FBT0MscUJB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