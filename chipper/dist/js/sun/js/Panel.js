// Copyright 2013-2022, University of Colorado Boulder

/**
 * Control panel around a content node.
 * Dynamically adjusts its size to fit its contents.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author Chris Malley (PixelZoom, Inc.)
 * @author John Blanco (PhET Interactive Simulations)
 */

import { optionize3 } from '../../phet-core/js/optionize.js';
import { isHeightSizable, isWidthSizable, LayoutConstraint, Node, Rectangle, Sizable } from '../../scenery/js/imports.js';
import Tandem from '../../tandem/js/Tandem.js';
import sun from './sun.js';

// valid values for options.align
const ALIGN_VALUES = ['left', 'center', 'right'];
const DEFAULT_OPTIONS = {
  fill: 'white',
  stroke: 'black',
  lineWidth: 1,
  lineDash: [],
  xMargin: 5,
  yMargin: 5,
  cornerRadius: 10,
  resize: true,
  backgroundPickable: true,
  excludeInvisibleChildrenFromBounds: true,
  align: 'left',
  minWidth: 0,
  minHeight: 0,
  tandem: Tandem.OPTIONAL
};
assert && Object.freeze(DEFAULT_OPTIONS);
export default class Panel extends Sizable(Node) {
  // These are public for use by PanelConstraint only. They should otherwise be considered private.

  static DEFAULT_PANEL_OPTIONS = DEFAULT_OPTIONS;
  constructor(content, providedOptions) {
    const options = optionize3()({}, DEFAULT_OPTIONS, providedOptions);
    assert && assert(_.includes(ALIGN_VALUES, options.align), `invalid align: ${options.align}`);
    super();
    this._content = content;
    this._backgroundContainer = new Node();

    // correct size will be set by layout
    this._background = new Rectangle(0, 0, 1, 1, {
      lineWidth: options.lineWidth,
      pickable: options.backgroundPickable,
      lineDash: options.lineDash,
      cornerRadius: options.cornerRadius
    });

    // update the fill and stroke (before layout)
    this.setStroke(options.stroke);
    this.setFill(options.fill);
    this.addChild(this._backgroundContainer);
    this.addChild(content);
    this.constraint = new PanelConstraint(this, options);
    this.constraint.updateLayout();

    // Don't update automatically if resize:false
    this.constraint.enabled = options.resize;

    // Apply options after the layout is done, so that options that use the bounds will work properly.
    this.mutate(options);
  }

  /**
   * Get the background rectangle's stroke (can be overridden)
   */
  getStroke() {
    return this._background.stroke;
  }
  get stroke() {
    return this.getStroke();
  }
  set stroke(value) {
    this.setStroke(value);
  }

  /**
   * Change the background rectangle's stroke (can be overridden)
   */
  setStroke(stroke) {
    this._background.stroke = stroke;

    // Since it depends on the stroke (if it's null, our minimum bounds get reduced)
    this.constraint && this.constraint.updateLayoutAutomatically();
  }

  /**
   * Get the background rectangle's fill (can be overridden)
   */
  getFill() {
    return this._background.fill;
  }
  get fill() {
    return this.getFill();
  }
  set fill(value) {
    this.setFill(value);
  }

  /**
   * Change the background rectangle's fill (can be overridden)
   */
  setFill(fill) {
    this._background.fill = fill;
  }
  setExcludeInvisibleChildrenFromBounds(excludeInvisibleChildrenFromBounds) {
    super.setExcludeInvisibleChildrenFromBounds(excludeInvisibleChildrenFromBounds);
    this.constraint.updateLayoutAutomatically();
  }
  dispose() {
    this.constraint.dispose();
    super.dispose();
  }
}
class PanelConstraint extends LayoutConstraint {
  constructor(panel, options) {
    super(panel);
    this.panel = panel;
    assert && assert(typeof options.minWidth === 'number', 'Panel minWidth should be a number');
    assert && assert(typeof options.xMargin === 'number', 'Panel xMargin should be a number');
    assert && assert(typeof options.yMargin === 'number', 'Panel yMargin should be a number');
    assert && assert(typeof options.lineWidth === 'number', 'Panel lineWidth should be a number');
    assert && assert(ALIGN_VALUES.includes(options.align), `Panel align should be one of ${ALIGN_VALUES}`);
    this.minWidth = options.minWidth;
    this.minHeight = options.minHeight;
    this.xMargin = options.xMargin;
    this.yMargin = options.yMargin;
    this.lineWidth = options.lineWidth;
    this.align = options.align;
    this.panel.localPreferredWidthProperty.lazyLink(this._updateLayoutListener);
    this.panel.localPreferredHeightProperty.lazyLink(this._updateLayoutListener);
    this.addNode(panel._content);
  }
  layout() {
    super.layout();
    const panel = this.panel;
    const content = panel._content;
    const background = panel._background;

    // We only have to account for the lineWidth in our layout if we have a stroke
    const lineWidth = panel.stroke === null ? 0 : this.lineWidth;
    const hasValidContent = panel.isChildIncludedInLayout(content);

    // Bail out (and make the background invisible) if our bounds are invalid
    panel._backgroundContainer.children = hasValidContent ? [background] : [];
    if (!hasValidContent) {
      panel.localMinimumWidth = null;
      panel.localMinimumHeight = null;
      return;
    }
    const minimumContentWidth = isWidthSizable(content) && content.minimumWidth !== null ? content.minimumWidth : content.width;
    const minimumContentHeight = isHeightSizable(content) && content.minimumHeight !== null ? content.minimumHeight : content.height;

    // Our minimum dimensions are directly determined by the content, margins and lineWidth
    // NOTE: options.minWidth does NOT include the stroke (e.g. lineWidth), left for backward compatibility.
    const minimumWidth = Math.max(this.minWidth, minimumContentWidth + 2 * this.xMargin) + lineWidth;
    const minimumHeight = Math.max(this.minHeight, minimumContentHeight + 2 * this.yMargin) + lineWidth;

    // Our resulting sizes (allow setting preferred width/height on the panel)
    const preferredWidth = panel.localPreferredWidth === null ? minimumWidth : panel.localPreferredWidth;
    const preferredHeight = panel.localPreferredHeight === null ? minimumHeight : panel.localPreferredHeight;

    // Determine the size available to our content
    // NOTE: We do NOT set preferred sizes of our content if we don't have a preferred size ourself!
    if (isWidthSizable(content) && panel.localPreferredWidth !== null) {
      content.preferredWidth = preferredWidth - lineWidth - 2 * this.xMargin;
    }
    if (isHeightSizable(content) && panel.localPreferredHeight !== null) {
      content.preferredHeight = preferredHeight - lineWidth - 2 * this.yMargin;
    }
    background.setRect(0, 0, preferredWidth - lineWidth, preferredHeight - lineWidth);

    // Align the content within the background. If the content width >= minWidth, then all alignments are equivalent.
    if (this.align === 'center') {
      content.center = background.center;
    } else if (this.align === 'left') {
      // Use background.rectWidth instead of background.width because they differ by the background lineWidth
      content.left = background.centerX - background.rectWidth / 2 + this.xMargin;
      content.centerY = background.centerY;
    } else {
      /* right */

      // Use background.rectWidth instead of background.width because they differ by the background lineWidth
      content.right = background.centerX + background.rectWidth / 2 - this.xMargin;
      content.centerY = background.centerY;
    }

    // Set minimums at the end
    panel.localMinimumWidth = minimumWidth;
    panel.localMinimumHeight = minimumHeight;
  }
  dispose() {
    this.panel.localPreferredWidthProperty.unlink(this._updateLayoutListener);
    this.panel.localPreferredHeightProperty.unlink(this._updateLayoutListener);
    super.dispose();
  }
}
sun.register('Panel', Panel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25pemUzIiwiaXNIZWlnaHRTaXphYmxlIiwiaXNXaWR0aFNpemFibGUiLCJMYXlvdXRDb25zdHJhaW50IiwiTm9kZSIsIlJlY3RhbmdsZSIsIlNpemFibGUiLCJUYW5kZW0iLCJzdW4iLCJBTElHTl9WQUxVRVMiLCJERUZBVUxUX09QVElPTlMiLCJmaWxsIiwic3Ryb2tlIiwibGluZVdpZHRoIiwibGluZURhc2giLCJ4TWFyZ2luIiwieU1hcmdpbiIsImNvcm5lclJhZGl1cyIsInJlc2l6ZSIsImJhY2tncm91bmRQaWNrYWJsZSIsImV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHMiLCJhbGlnbiIsIm1pbldpZHRoIiwibWluSGVpZ2h0IiwidGFuZGVtIiwiT1BUSU9OQUwiLCJhc3NlcnQiLCJPYmplY3QiLCJmcmVlemUiLCJQYW5lbCIsIkRFRkFVTFRfUEFORUxfT1BUSU9OUyIsImNvbnN0cnVjdG9yIiwiY29udGVudCIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJfIiwiaW5jbHVkZXMiLCJfY29udGVudCIsIl9iYWNrZ3JvdW5kQ29udGFpbmVyIiwiX2JhY2tncm91bmQiLCJwaWNrYWJsZSIsInNldFN0cm9rZSIsInNldEZpbGwiLCJhZGRDaGlsZCIsImNvbnN0cmFpbnQiLCJQYW5lbENvbnN0cmFpbnQiLCJ1cGRhdGVMYXlvdXQiLCJlbmFibGVkIiwibXV0YXRlIiwiZ2V0U3Ryb2tlIiwidmFsdWUiLCJ1cGRhdGVMYXlvdXRBdXRvbWF0aWNhbGx5IiwiZ2V0RmlsbCIsInNldEV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHMiLCJkaXNwb3NlIiwicGFuZWwiLCJsb2NhbFByZWZlcnJlZFdpZHRoUHJvcGVydHkiLCJsYXp5TGluayIsIl91cGRhdGVMYXlvdXRMaXN0ZW5lciIsImxvY2FsUHJlZmVycmVkSGVpZ2h0UHJvcGVydHkiLCJhZGROb2RlIiwibGF5b3V0IiwiYmFja2dyb3VuZCIsImhhc1ZhbGlkQ29udGVudCIsImlzQ2hpbGRJbmNsdWRlZEluTGF5b3V0IiwiY2hpbGRyZW4iLCJsb2NhbE1pbmltdW1XaWR0aCIsImxvY2FsTWluaW11bUhlaWdodCIsIm1pbmltdW1Db250ZW50V2lkdGgiLCJtaW5pbXVtV2lkdGgiLCJ3aWR0aCIsIm1pbmltdW1Db250ZW50SGVpZ2h0IiwibWluaW11bUhlaWdodCIsImhlaWdodCIsIk1hdGgiLCJtYXgiLCJwcmVmZXJyZWRXaWR0aCIsImxvY2FsUHJlZmVycmVkV2lkdGgiLCJwcmVmZXJyZWRIZWlnaHQiLCJsb2NhbFByZWZlcnJlZEhlaWdodCIsInNldFJlY3QiLCJjZW50ZXIiLCJsZWZ0IiwiY2VudGVyWCIsInJlY3RXaWR0aCIsImNlbnRlclkiLCJyaWdodCIsInVubGluayIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiUGFuZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTMtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQ29udHJvbCBwYW5lbCBhcm91bmQgYSBjb250ZW50IG5vZGUuXHJcbiAqIER5bmFtaWNhbGx5IGFkanVzdHMgaXRzIHNpemUgdG8gZml0IGl0cyBjb250ZW50cy5cclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICogQGF1dGhvciBKb2huIEJsYW5jbyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgeyBvcHRpb25pemUzLCBPcHRpb25pemVEZWZhdWx0cyB9IGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgeyBUUGFpbnQsIGlzSGVpZ2h0U2l6YWJsZSwgaXNXaWR0aFNpemFibGUsIExheW91dENvbnN0cmFpbnQsIE5vZGUsIE5vZGVPcHRpb25zLCBSZWN0YW5nbGUsIFNpemFibGUsIFNpemFibGVPcHRpb25zIH0gZnJvbSAnLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IHN1biBmcm9tICcuL3N1bi5qcyc7XHJcblxyXG4vLyB2YWxpZCB2YWx1ZXMgZm9yIG9wdGlvbnMuYWxpZ25cclxuY29uc3QgQUxJR05fVkFMVUVTID0gWyAnbGVmdCcsICdjZW50ZXInLCAncmlnaHQnIF0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgdHlwZSBQYW5lbEFsaWduID0gdHlwZW9mIEFMSUdOX1ZBTFVFU1tudW1iZXJdO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuICBmaWxsPzogVFBhaW50O1xyXG4gIHN0cm9rZT86IFRQYWludDtcclxuXHJcbiAgLy8gd2lkdGggb2YgdGhlIGJhY2tncm91bmQgYm9yZGVyXHJcbiAgbGluZVdpZHRoPzogbnVtYmVyO1xyXG4gIGxpbmVEYXNoPzogbnVtYmVyW107XHJcblxyXG4gIHhNYXJnaW4/OiBudW1iZXI7XHJcbiAgeU1hcmdpbj86IG51bWJlcjtcclxuXHJcbiAgLy8gcmFkaXVzIG9mIHRoZSByb3VuZGVkIGNvcm5lcnMgb24gdGhlIGJhY2tncm91bmRcclxuICBjb3JuZXJSYWRpdXM/OiBudW1iZXI7XHJcblxyXG4gIC8vIGR5bmFtaWNhbGx5IHJlc2l6ZSB3aGVuIGNvbnRlbnQgYm91bmRzIGNoYW5nZVxyXG4gIHJlc2l6ZT86IGJvb2xlYW47XHJcblxyXG4gIGJhY2tncm91bmRQaWNrYWJsZT86IGJvb2xlYW47XHJcblxyXG4gIC8vIGhvcml6b250YWwgYWxpZ25tZW50IG9mIGNvbnRlbnQgaW4gdGhlIHBhbmUsIHNlZSBBTElHTl9WQUxVRVNcclxuICAvLyBBbGwgYWxpZ25tZW50cyBhcmUgZXF1YWwgd2hlbiB0aGUgY29udGVudCB3aWR0aCA+PSBtaW5XaWR0aFxyXG4gIC8vIExlZnQgaXMgdGhlIGRlZmF1bHQgYWxpZ25tZW50IHNvIHdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIHBhbmVscywgdGhlaXIgY29udGVudCB3aWxsIGxlZnQgYWxpZ24sIHNlZSAjMjUyXHJcbiAgYWxpZ24/OiBQYW5lbEFsaWduO1xyXG5cclxuICAvLyBtaW5pbXVtIHdpZHRoIG9mIHRoZSBwYW5lbCAobGluZVdpZHRoIHdpbGwgYWRkIHRvIHRoaXMpXHJcbiAgbWluV2lkdGg/OiBudW1iZXI7XHJcbiAgbWluSGVpZ2h0PzogbnVtYmVyO1xyXG59O1xyXG5cclxudHlwZSBTdXBlck9wdGlvbnMgPSBTaXphYmxlT3B0aW9ucyAmIE5vZGVPcHRpb25zO1xyXG5leHBvcnQgdHlwZSBQYW5lbE9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFN1cGVyT3B0aW9ucztcclxuXHJcbmNvbnN0IERFRkFVTFRfT1BUSU9OUzogT3B0aW9uaXplRGVmYXVsdHM8U2VsZk9wdGlvbnMsIFN1cGVyT3B0aW9ucz4gPSB7XHJcbiAgZmlsbDogJ3doaXRlJyxcclxuICBzdHJva2U6ICdibGFjaycsXHJcbiAgbGluZVdpZHRoOiAxLFxyXG4gIGxpbmVEYXNoOiBbXSxcclxuICB4TWFyZ2luOiA1LFxyXG4gIHlNYXJnaW46IDUsXHJcbiAgY29ybmVyUmFkaXVzOiAxMCxcclxuICByZXNpemU6IHRydWUsXHJcbiAgYmFja2dyb3VuZFBpY2thYmxlOiB0cnVlLFxyXG4gIGV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHM6IHRydWUsXHJcbiAgYWxpZ246ICdsZWZ0JyxcclxuICBtaW5XaWR0aDogMCxcclxuICBtaW5IZWlnaHQ6IDAsXHJcbiAgdGFuZGVtOiBUYW5kZW0uT1BUSU9OQUxcclxufTtcclxuYXNzZXJ0ICYmIE9iamVjdC5mcmVlemUoIERFRkFVTFRfT1BUSU9OUyApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFuZWwgZXh0ZW5kcyBTaXphYmxlKCBOb2RlICkge1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGNvbnN0cmFpbnQ6IFBhbmVsQ29uc3RyYWludDtcclxuXHJcbiAgLy8gVGhlc2UgYXJlIHB1YmxpYyBmb3IgdXNlIGJ5IFBhbmVsQ29uc3RyYWludCBvbmx5LiBUaGV5IHNob3VsZCBvdGhlcndpc2UgYmUgY29uc2lkZXJlZCBwcml2YXRlLlxyXG4gIHB1YmxpYyByZWFkb25seSBfY29udGVudDogTm9kZTtcclxuICBwdWJsaWMgcmVhZG9ubHkgX2JhY2tncm91bmRDb250YWluZXI6IE5vZGU7XHJcbiAgcHVibGljIHJlYWRvbmx5IF9iYWNrZ3JvdW5kOiBSZWN0YW5nbGU7XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgREVGQVVMVF9QQU5FTF9PUFRJT05TID0gREVGQVVMVF9PUFRJT05TO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGNvbnRlbnQ6IE5vZGUsIHByb3ZpZGVkT3B0aW9ucz86IFBhbmVsT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplMzxQYW5lbE9wdGlvbnMsIFNlbGZPcHRpb25zLCBTdXBlck9wdGlvbnM+KCkoIHt9LCBERUZBVUxUX09QVElPTlMsIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIF8uaW5jbHVkZXMoIEFMSUdOX1ZBTFVFUywgb3B0aW9ucy5hbGlnbiApLCBgaW52YWxpZCBhbGlnbjogJHtvcHRpb25zLmFsaWdufWAgKTtcclxuXHJcbiAgICBzdXBlcigpO1xyXG5cclxuICAgIHRoaXMuX2NvbnRlbnQgPSBjb250ZW50O1xyXG4gICAgdGhpcy5fYmFja2dyb3VuZENvbnRhaW5lciA9IG5ldyBOb2RlKCk7XHJcblxyXG4gICAgLy8gY29ycmVjdCBzaXplIHdpbGwgYmUgc2V0IGJ5IGxheW91dFxyXG4gICAgdGhpcy5fYmFja2dyb3VuZCA9IG5ldyBSZWN0YW5nbGUoIDAsIDAsIDEsIDEsIHtcclxuICAgICAgbGluZVdpZHRoOiBvcHRpb25zLmxpbmVXaWR0aCxcclxuICAgICAgcGlja2FibGU6IG9wdGlvbnMuYmFja2dyb3VuZFBpY2thYmxlLFxyXG4gICAgICBsaW5lRGFzaDogb3B0aW9ucy5saW5lRGFzaCxcclxuICAgICAgY29ybmVyUmFkaXVzOiBvcHRpb25zLmNvcm5lclJhZGl1c1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHVwZGF0ZSB0aGUgZmlsbCBhbmQgc3Ryb2tlIChiZWZvcmUgbGF5b3V0KVxyXG4gICAgdGhpcy5zZXRTdHJva2UoIG9wdGlvbnMuc3Ryb2tlICk7XHJcbiAgICB0aGlzLnNldEZpbGwoIG9wdGlvbnMuZmlsbCApO1xyXG5cclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMuX2JhY2tncm91bmRDb250YWluZXIgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGNvbnRlbnQgKTtcclxuXHJcbiAgICB0aGlzLmNvbnN0cmFpbnQgPSBuZXcgUGFuZWxDb25zdHJhaW50KCB0aGlzLCBvcHRpb25zICk7XHJcbiAgICB0aGlzLmNvbnN0cmFpbnQudXBkYXRlTGF5b3V0KCk7XHJcblxyXG4gICAgLy8gRG9uJ3QgdXBkYXRlIGF1dG9tYXRpY2FsbHkgaWYgcmVzaXplOmZhbHNlXHJcbiAgICB0aGlzLmNvbnN0cmFpbnQuZW5hYmxlZCA9IG9wdGlvbnMucmVzaXplO1xyXG5cclxuICAgIC8vIEFwcGx5IG9wdGlvbnMgYWZ0ZXIgdGhlIGxheW91dCBpcyBkb25lLCBzbyB0aGF0IG9wdGlvbnMgdGhhdCB1c2UgdGhlIGJvdW5kcyB3aWxsIHdvcmsgcHJvcGVybHkuXHJcbiAgICB0aGlzLm11dGF0ZSggb3B0aW9ucyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBiYWNrZ3JvdW5kIHJlY3RhbmdsZSdzIHN0cm9rZSAoY2FuIGJlIG92ZXJyaWRkZW4pXHJcbiAgICovXHJcbiAgcHVibGljIGdldFN0cm9rZSgpOiBUUGFpbnQge1xyXG4gICAgcmV0dXJuIHRoaXMuX2JhY2tncm91bmQuc3Ryb2tlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBzdHJva2UoKTogVFBhaW50IHsgcmV0dXJuIHRoaXMuZ2V0U3Ryb2tlKCk7IH1cclxuXHJcbiAgcHVibGljIHNldCBzdHJva2UoIHZhbHVlOiBUUGFpbnQgKSB7IHRoaXMuc2V0U3Ryb2tlKCB2YWx1ZSApOyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoYW5nZSB0aGUgYmFja2dyb3VuZCByZWN0YW5nbGUncyBzdHJva2UgKGNhbiBiZSBvdmVycmlkZGVuKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRTdHJva2UoIHN0cm9rZTogVFBhaW50ICk6IHZvaWQge1xyXG4gICAgdGhpcy5fYmFja2dyb3VuZC5zdHJva2UgPSBzdHJva2U7XHJcblxyXG4gICAgLy8gU2luY2UgaXQgZGVwZW5kcyBvbiB0aGUgc3Ryb2tlIChpZiBpdCdzIG51bGwsIG91ciBtaW5pbXVtIGJvdW5kcyBnZXQgcmVkdWNlZClcclxuICAgIHRoaXMuY29uc3RyYWludCAmJiB0aGlzLmNvbnN0cmFpbnQudXBkYXRlTGF5b3V0QXV0b21hdGljYWxseSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBiYWNrZ3JvdW5kIHJlY3RhbmdsZSdzIGZpbGwgKGNhbiBiZSBvdmVycmlkZGVuKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRGaWxsKCk6IFRQYWludCB7XHJcbiAgICByZXR1cm4gdGhpcy5fYmFja2dyb3VuZC5maWxsO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBmaWxsKCk6IFRQYWludCB7IHJldHVybiB0aGlzLmdldEZpbGwoKTsgfVxyXG5cclxuICBwdWJsaWMgc2V0IGZpbGwoIHZhbHVlOiBUUGFpbnQgKSB7IHRoaXMuc2V0RmlsbCggdmFsdWUgKTsgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGFuZ2UgdGhlIGJhY2tncm91bmQgcmVjdGFuZ2xlJ3MgZmlsbCAoY2FuIGJlIG92ZXJyaWRkZW4pXHJcbiAgICovXHJcbiAgcHVibGljIHNldEZpbGwoIGZpbGw6IFRQYWludCApOiB2b2lkIHtcclxuICAgIHRoaXMuX2JhY2tncm91bmQuZmlsbCA9IGZpbGw7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgc2V0RXhjbHVkZUludmlzaWJsZUNoaWxkcmVuRnJvbUJvdW5kcyggZXhjbHVkZUludmlzaWJsZUNoaWxkcmVuRnJvbUJvdW5kczogYm9vbGVhbiApOiB2b2lkIHtcclxuICAgIHN1cGVyLnNldEV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHMoIGV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHMgKTtcclxuICAgIHRoaXMuY29uc3RyYWludC51cGRhdGVMYXlvdXRBdXRvbWF0aWNhbGx5KCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuY29uc3RyYWludC5kaXNwb3NlKCk7XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5jbGFzcyBQYW5lbENvbnN0cmFpbnQgZXh0ZW5kcyBMYXlvdXRDb25zdHJhaW50IHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBwYW5lbDogUGFuZWw7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBtaW5XaWR0aDogbnVtYmVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgeE1hcmdpbjogbnVtYmVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgeU1hcmdpbjogbnVtYmVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgbGluZVdpZHRoOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBhbGlnbjogUGFuZWxBbGlnbjtcclxuICBwcml2YXRlIHJlYWRvbmx5IG1pbkhlaWdodDogbnVtYmVyO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHBhbmVsOiBQYW5lbCwgb3B0aW9uczogUmVxdWlyZWQ8U2VsZk9wdGlvbnM+ICkge1xyXG4gICAgc3VwZXIoIHBhbmVsICk7XHJcblxyXG4gICAgdGhpcy5wYW5lbCA9IHBhbmVsO1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBvcHRpb25zLm1pbldpZHRoID09PSAnbnVtYmVyJywgJ1BhbmVsIG1pbldpZHRoIHNob3VsZCBiZSBhIG51bWJlcicgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBvcHRpb25zLnhNYXJnaW4gPT09ICdudW1iZXInLCAnUGFuZWwgeE1hcmdpbiBzaG91bGQgYmUgYSBudW1iZXInICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2Ygb3B0aW9ucy55TWFyZ2luID09PSAnbnVtYmVyJywgJ1BhbmVsIHlNYXJnaW4gc2hvdWxkIGJlIGEgbnVtYmVyJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdHlwZW9mIG9wdGlvbnMubGluZVdpZHRoID09PSAnbnVtYmVyJywgJ1BhbmVsIGxpbmVXaWR0aCBzaG91bGQgYmUgYSBudW1iZXInICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBBTElHTl9WQUxVRVMuaW5jbHVkZXMoIG9wdGlvbnMuYWxpZ24gKSwgYFBhbmVsIGFsaWduIHNob3VsZCBiZSBvbmUgb2YgJHtBTElHTl9WQUxVRVN9YCApO1xyXG5cclxuICAgIHRoaXMubWluV2lkdGggPSBvcHRpb25zLm1pbldpZHRoO1xyXG4gICAgdGhpcy5taW5IZWlnaHQgPSBvcHRpb25zLm1pbkhlaWdodDtcclxuICAgIHRoaXMueE1hcmdpbiA9IG9wdGlvbnMueE1hcmdpbjtcclxuICAgIHRoaXMueU1hcmdpbiA9IG9wdGlvbnMueU1hcmdpbjtcclxuICAgIHRoaXMubGluZVdpZHRoID0gb3B0aW9ucy5saW5lV2lkdGg7XHJcbiAgICB0aGlzLmFsaWduID0gb3B0aW9ucy5hbGlnbjtcclxuXHJcbiAgICB0aGlzLnBhbmVsLmxvY2FsUHJlZmVycmVkV2lkdGhQcm9wZXJ0eS5sYXp5TGluayggdGhpcy5fdXBkYXRlTGF5b3V0TGlzdGVuZXIgKTtcclxuICAgIHRoaXMucGFuZWwubG9jYWxQcmVmZXJyZWRIZWlnaHRQcm9wZXJ0eS5sYXp5TGluayggdGhpcy5fdXBkYXRlTGF5b3V0TGlzdGVuZXIgKTtcclxuXHJcbiAgICB0aGlzLmFkZE5vZGUoIHBhbmVsLl9jb250ZW50ICk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgb3ZlcnJpZGUgbGF5b3V0KCk6IHZvaWQge1xyXG4gICAgc3VwZXIubGF5b3V0KCk7XHJcblxyXG4gICAgY29uc3QgcGFuZWwgPSB0aGlzLnBhbmVsO1xyXG4gICAgY29uc3QgY29udGVudCA9IHBhbmVsLl9jb250ZW50O1xyXG4gICAgY29uc3QgYmFja2dyb3VuZCA9IHBhbmVsLl9iYWNrZ3JvdW5kO1xyXG5cclxuICAgIC8vIFdlIG9ubHkgaGF2ZSB0byBhY2NvdW50IGZvciB0aGUgbGluZVdpZHRoIGluIG91ciBsYXlvdXQgaWYgd2UgaGF2ZSBhIHN0cm9rZVxyXG4gICAgY29uc3QgbGluZVdpZHRoID0gcGFuZWwuc3Ryb2tlID09PSBudWxsID8gMCA6IHRoaXMubGluZVdpZHRoO1xyXG5cclxuICAgIGNvbnN0IGhhc1ZhbGlkQ29udGVudCA9IHBhbmVsLmlzQ2hpbGRJbmNsdWRlZEluTGF5b3V0KCBjb250ZW50ICk7XHJcblxyXG4gICAgLy8gQmFpbCBvdXQgKGFuZCBtYWtlIHRoZSBiYWNrZ3JvdW5kIGludmlzaWJsZSkgaWYgb3VyIGJvdW5kcyBhcmUgaW52YWxpZFxyXG4gICAgcGFuZWwuX2JhY2tncm91bmRDb250YWluZXIuY2hpbGRyZW4gPSBoYXNWYWxpZENvbnRlbnQgPyBbIGJhY2tncm91bmQgXSA6IFtdO1xyXG4gICAgaWYgKCAhaGFzVmFsaWRDb250ZW50ICkge1xyXG4gICAgICBwYW5lbC5sb2NhbE1pbmltdW1XaWR0aCA9IG51bGw7XHJcbiAgICAgIHBhbmVsLmxvY2FsTWluaW11bUhlaWdodCA9IG51bGw7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBtaW5pbXVtQ29udGVudFdpZHRoID0gKCBpc1dpZHRoU2l6YWJsZSggY29udGVudCApICYmIGNvbnRlbnQubWluaW11bVdpZHRoICE9PSBudWxsICkgPyBjb250ZW50Lm1pbmltdW1XaWR0aCA6IGNvbnRlbnQud2lkdGg7XHJcbiAgICBjb25zdCBtaW5pbXVtQ29udGVudEhlaWdodCA9ICggaXNIZWlnaHRTaXphYmxlKCBjb250ZW50ICkgJiYgY29udGVudC5taW5pbXVtSGVpZ2h0ICE9PSBudWxsICkgPyBjb250ZW50Lm1pbmltdW1IZWlnaHQgOiBjb250ZW50LmhlaWdodDtcclxuXHJcbiAgICAvLyBPdXIgbWluaW11bSBkaW1lbnNpb25zIGFyZSBkaXJlY3RseSBkZXRlcm1pbmVkIGJ5IHRoZSBjb250ZW50LCBtYXJnaW5zIGFuZCBsaW5lV2lkdGhcclxuICAgIC8vIE5PVEU6IG9wdGlvbnMubWluV2lkdGggZG9lcyBOT1QgaW5jbHVkZSB0aGUgc3Ryb2tlIChlLmcuIGxpbmVXaWR0aCksIGxlZnQgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkuXHJcbiAgICBjb25zdCBtaW5pbXVtV2lkdGggPSBNYXRoLm1heCggdGhpcy5taW5XaWR0aCwgbWluaW11bUNvbnRlbnRXaWR0aCArICggMiAqIHRoaXMueE1hcmdpbiApICkgKyBsaW5lV2lkdGg7XHJcbiAgICBjb25zdCBtaW5pbXVtSGVpZ2h0ID0gTWF0aC5tYXgoIHRoaXMubWluSGVpZ2h0LCBtaW5pbXVtQ29udGVudEhlaWdodCArICggMiAqIHRoaXMueU1hcmdpbiApICkgKyBsaW5lV2lkdGg7XHJcblxyXG4gICAgLy8gT3VyIHJlc3VsdGluZyBzaXplcyAoYWxsb3cgc2V0dGluZyBwcmVmZXJyZWQgd2lkdGgvaGVpZ2h0IG9uIHRoZSBwYW5lbClcclxuICAgIGNvbnN0IHByZWZlcnJlZFdpZHRoOiBudW1iZXIgPSBwYW5lbC5sb2NhbFByZWZlcnJlZFdpZHRoID09PSBudWxsID8gbWluaW11bVdpZHRoIDogcGFuZWwubG9jYWxQcmVmZXJyZWRXaWR0aDtcclxuICAgIGNvbnN0IHByZWZlcnJlZEhlaWdodDogbnVtYmVyID0gcGFuZWwubG9jYWxQcmVmZXJyZWRIZWlnaHQgPT09IG51bGwgPyBtaW5pbXVtSGVpZ2h0IDogcGFuZWwubG9jYWxQcmVmZXJyZWRIZWlnaHQ7XHJcblxyXG4gICAgLy8gRGV0ZXJtaW5lIHRoZSBzaXplIGF2YWlsYWJsZSB0byBvdXIgY29udGVudFxyXG4gICAgLy8gTk9URTogV2UgZG8gTk9UIHNldCBwcmVmZXJyZWQgc2l6ZXMgb2Ygb3VyIGNvbnRlbnQgaWYgd2UgZG9uJ3QgaGF2ZSBhIHByZWZlcnJlZCBzaXplIG91cnNlbGYhXHJcbiAgICBpZiAoIGlzV2lkdGhTaXphYmxlKCBjb250ZW50ICkgJiYgcGFuZWwubG9jYWxQcmVmZXJyZWRXaWR0aCAhPT0gbnVsbCApIHtcclxuICAgICAgY29udGVudC5wcmVmZXJyZWRXaWR0aCA9IHByZWZlcnJlZFdpZHRoIC0gbGluZVdpZHRoIC0gMiAqIHRoaXMueE1hcmdpbjtcclxuICAgIH1cclxuICAgIGlmICggaXNIZWlnaHRTaXphYmxlKCBjb250ZW50ICkgJiYgcGFuZWwubG9jYWxQcmVmZXJyZWRIZWlnaHQgIT09IG51bGwgKSB7XHJcbiAgICAgIGNvbnRlbnQucHJlZmVycmVkSGVpZ2h0ID0gcHJlZmVycmVkSGVpZ2h0IC0gbGluZVdpZHRoIC0gMiAqIHRoaXMueU1hcmdpbjtcclxuICAgIH1cclxuXHJcbiAgICBiYWNrZ3JvdW5kLnNldFJlY3QoIDAsIDAsIHByZWZlcnJlZFdpZHRoIC0gbGluZVdpZHRoLCBwcmVmZXJyZWRIZWlnaHQgLSBsaW5lV2lkdGggKTtcclxuXHJcbiAgICAvLyBBbGlnbiB0aGUgY29udGVudCB3aXRoaW4gdGhlIGJhY2tncm91bmQuIElmIHRoZSBjb250ZW50IHdpZHRoID49IG1pbldpZHRoLCB0aGVuIGFsbCBhbGlnbm1lbnRzIGFyZSBlcXVpdmFsZW50LlxyXG4gICAgaWYgKCB0aGlzLmFsaWduID09PSAnY2VudGVyJyApIHtcclxuICAgICAgY29udGVudC5jZW50ZXIgPSBiYWNrZ3JvdW5kLmNlbnRlcjtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCB0aGlzLmFsaWduID09PSAnbGVmdCcgKSB7XHJcblxyXG4gICAgICAvLyBVc2UgYmFja2dyb3VuZC5yZWN0V2lkdGggaW5zdGVhZCBvZiBiYWNrZ3JvdW5kLndpZHRoIGJlY2F1c2UgdGhleSBkaWZmZXIgYnkgdGhlIGJhY2tncm91bmQgbGluZVdpZHRoXHJcbiAgICAgIGNvbnRlbnQubGVmdCA9IGJhY2tncm91bmQuY2VudGVyWCAtIGJhY2tncm91bmQucmVjdFdpZHRoIC8gMiArIHRoaXMueE1hcmdpbjtcclxuICAgICAgY29udGVudC5jZW50ZXJZID0gYmFja2dyb3VuZC5jZW50ZXJZO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7IC8qIHJpZ2h0ICovXHJcblxyXG4gICAgICAvLyBVc2UgYmFja2dyb3VuZC5yZWN0V2lkdGggaW5zdGVhZCBvZiBiYWNrZ3JvdW5kLndpZHRoIGJlY2F1c2UgdGhleSBkaWZmZXIgYnkgdGhlIGJhY2tncm91bmQgbGluZVdpZHRoXHJcbiAgICAgIGNvbnRlbnQucmlnaHQgPSBiYWNrZ3JvdW5kLmNlbnRlclggKyBiYWNrZ3JvdW5kLnJlY3RXaWR0aCAvIDIgLSB0aGlzLnhNYXJnaW47XHJcbiAgICAgIGNvbnRlbnQuY2VudGVyWSA9IGJhY2tncm91bmQuY2VudGVyWTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTZXQgbWluaW11bXMgYXQgdGhlIGVuZFxyXG4gICAgcGFuZWwubG9jYWxNaW5pbXVtV2lkdGggPSBtaW5pbXVtV2lkdGg7XHJcbiAgICBwYW5lbC5sb2NhbE1pbmltdW1IZWlnaHQgPSBtaW5pbXVtSGVpZ2h0O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLnBhbmVsLmxvY2FsUHJlZmVycmVkV2lkdGhQcm9wZXJ0eS51bmxpbmsoIHRoaXMuX3VwZGF0ZUxheW91dExpc3RlbmVyICk7XHJcbiAgICB0aGlzLnBhbmVsLmxvY2FsUHJlZmVycmVkSGVpZ2h0UHJvcGVydHkudW5saW5rKCB0aGlzLl91cGRhdGVMYXlvdXRMaXN0ZW5lciApO1xyXG5cclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbnN1bi5yZWdpc3RlciggJ1BhbmVsJywgUGFuZWwgKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFNBQVNBLFVBQVUsUUFBMkIsaUNBQWlDO0FBQy9FLFNBQWlCQyxlQUFlLEVBQUVDLGNBQWMsRUFBRUMsZ0JBQWdCLEVBQUVDLElBQUksRUFBZUMsU0FBUyxFQUFFQyxPQUFPLFFBQXdCLDZCQUE2QjtBQUM5SixPQUFPQyxNQUFNLE1BQU0sMkJBQTJCO0FBQzlDLE9BQU9DLEdBQUcsTUFBTSxVQUFVOztBQUUxQjtBQUNBLE1BQU1DLFlBQVksR0FBRyxDQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsT0FBTyxDQUFXO0FBb0MzRCxNQUFNQyxlQUE2RCxHQUFHO0VBQ3BFQyxJQUFJLEVBQUUsT0FBTztFQUNiQyxNQUFNLEVBQUUsT0FBTztFQUNmQyxTQUFTLEVBQUUsQ0FBQztFQUNaQyxRQUFRLEVBQUUsRUFBRTtFQUNaQyxPQUFPLEVBQUUsQ0FBQztFQUNWQyxPQUFPLEVBQUUsQ0FBQztFQUNWQyxZQUFZLEVBQUUsRUFBRTtFQUNoQkMsTUFBTSxFQUFFLElBQUk7RUFDWkMsa0JBQWtCLEVBQUUsSUFBSTtFQUN4QkMsa0NBQWtDLEVBQUUsSUFBSTtFQUN4Q0MsS0FBSyxFQUFFLE1BQU07RUFDYkMsUUFBUSxFQUFFLENBQUM7RUFDWEMsU0FBUyxFQUFFLENBQUM7RUFDWkMsTUFBTSxFQUFFakIsTUFBTSxDQUFDa0I7QUFDakIsQ0FBQztBQUNEQyxNQUFNLElBQUlDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFFbEIsZUFBZ0IsQ0FBQztBQUUxQyxlQUFlLE1BQU1tQixLQUFLLFNBQVN2QixPQUFPLENBQUVGLElBQUssQ0FBQyxDQUFDO0VBSWpEOztFQUtBLE9BQXVCMEIscUJBQXFC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