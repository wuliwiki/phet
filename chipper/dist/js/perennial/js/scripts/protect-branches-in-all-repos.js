// Copyright 2021, University of Colorado Boulder

/**
 * Applies or updates branch protection rules for all active repos.
 *
 * USAGE:
 * node perennial/js/scripts/protect-branches-in-all-repos.js
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

const protectGithubBranches = require('../common/protectGithubBranches');
const fs = require('fs');

// cannot use getActiveRepos() from root
const contents = fs.readFileSync('perennial/data/active-repos', 'utf8').trim();
const activeRepos = contents.split('\n').map(sim => sim.trim());

// perennial-alias is an exception, it is just a clone of the perennial repository
if (activeRepos.includes('perennial-alias')) {
  activeRepos.splice(activeRepos.indexOf('perennial-alias'), 1);
}

// so that execution doesn't finish until githubProtectBranches resolves
(async () => {
  await protectGithubBranches.protectBranches(activeRepos);
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwcm90ZWN0R2l0aHViQnJhbmNoZXMiLCJyZXF1aXJlIiwiZnMiLCJjb250ZW50cyIsInJlYWRGaWxlU3luYyIsInRyaW0iLCJhY3RpdmVSZXBvcyIsInNwbGl0IiwibWFwIiwic2ltIiwiaW5jbHVkZXMiLCJzcGxpY2UiLCJpbmRleE9mIiwicHJvdGVjdEJyYW5jaGVzIl0sInNvdXJjZXMiOlsicHJvdGVjdC1icmFuY2hlcy1pbi1hbGwtcmVwb3MuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjEsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEFwcGxpZXMgb3IgdXBkYXRlcyBicmFuY2ggcHJvdGVjdGlvbiBydWxlcyBmb3IgYWxsIGFjdGl2ZSByZXBvcy5cclxuICpcclxuICogVVNBR0U6XHJcbiAqIG5vZGUgcGVyZW5uaWFsL2pzL3NjcmlwdHMvcHJvdGVjdC1icmFuY2hlcy1pbi1hbGwtcmVwb3MuanNcclxuICpcclxuICogQGF1dGhvciBKZXNzZSBHcmVlbmJlcmcgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuY29uc3QgcHJvdGVjdEdpdGh1YkJyYW5jaGVzID0gcmVxdWlyZSggJy4uL2NvbW1vbi9wcm90ZWN0R2l0aHViQnJhbmNoZXMnICk7XHJcbmNvbnN0IGZzID0gcmVxdWlyZSggJ2ZzJyApO1xyXG5cclxuLy8gY2Fubm90IHVzZSBnZXRBY3RpdmVSZXBvcygpIGZyb20gcm9vdFxyXG5jb25zdCBjb250ZW50cyA9IGZzLnJlYWRGaWxlU3luYyggJ3BlcmVubmlhbC9kYXRhL2FjdGl2ZS1yZXBvcycsICd1dGY4JyApLnRyaW0oKTtcclxuY29uc3QgYWN0aXZlUmVwb3MgPSBjb250ZW50cy5zcGxpdCggJ1xcbicgKS5tYXAoIHNpbSA9PiBzaW0udHJpbSgpICk7XHJcblxyXG4vLyBwZXJlbm5pYWwtYWxpYXMgaXMgYW4gZXhjZXB0aW9uLCBpdCBpcyBqdXN0IGEgY2xvbmUgb2YgdGhlIHBlcmVubmlhbCByZXBvc2l0b3J5XHJcbmlmICggYWN0aXZlUmVwb3MuaW5jbHVkZXMoICdwZXJlbm5pYWwtYWxpYXMnICkgKSB7XHJcbiAgYWN0aXZlUmVwb3Muc3BsaWNlKCBhY3RpdmVSZXBvcy5pbmRleE9mKCAncGVyZW5uaWFsLWFsaWFzJyApLCAxICk7XHJcbn1cclxuXHJcbi8vIHNvIHRoYXQgZXhlY3V0aW9uIGRvZXNuJ3QgZmluaXNoIHVudGlsIGdpdGh1YlByb3RlY3RCcmFuY2hlcyByZXNvbHZlc1xyXG4oIGFzeW5jICgpID0+IHtcclxuICBhd2FpdCBwcm90ZWN0R2l0aHViQnJhbmNoZXMucHJvdGVjdEJyYW5jaGVzKCBhY3RpdmVSZXBvcyApO1xyXG59ICkoKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLHFCQUFxQixHQUFHQyxPQUFPLENBQUUsaUNBQWtDLENBQUM7QUFDMUUsTUFBTUMsRUFBRSxHQUFHRCxPQUFPLENBQUUsSUFBSyxDQUFDOztBQUUxQjtBQUNBLE1BQU1FLFFBQVEsR0FBR0QsRUFBRSxDQUFDRSxZQUFZLENBQUUsNkJBQTZCLEVBQUUsTUFBTyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFDO0FBQ2hGLE1BQU1DLFdBQVcsR0FBR0gsUUFBUSxDQUFDSSxLQUFLLENBQUUsSUFBSyxDQUFDLENBQUNDLEdBQUcsQ0FBRUMsR0FBRyxJQUFJQSxHQUFHLENBQUNKLElBQUksQ0FBQyxDQUFFLENBQUM7O0FBRW5FO0FBQ0EsSUFBS0MsV0FBVyxDQUFDSSxRQUFRLENBQUUsaUJBQWtCLENBQUMsRUFBRztFQUMvQ0osV0FBVyxDQUFDSyxNQUFNLENBQUVMLFdBQVcsQ0FBQ00sT0FBTyxDQUFFLGlCQUFrQixDQUFDLEVBQUUsQ0FBRSxDQUFDO0FBQ25FOztBQUVBO0FBQ0EsQ0FBRSxZQUFZO0VBQ1osTUFBTVoscUJBQXFCLENBQUNhLGVBQWUsQ0FBRVAsV0FBWSxDQUFDO0FBQzVELENBQUMsRUFBRyxDQUFDIn0=