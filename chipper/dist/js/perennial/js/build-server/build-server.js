// Copyright 2002-2017, University of Colorado Boulder

/**
 * PhET build and deploy server. The server is designed to run on the same host as the production site (phet-server.int.colorado.edu).
 * This file initializes the app and the main process queue.
 *
 * @author Aaron Davis
 * @author Matt Pennington
 */

const constants = require('./constants');
const childProcess = require('child_process'); // eslint-disable-line require-statement-match
const winston = require('./log.js'); // eslint-disable-line require-statement-match
const logRequest = require('./logRequest');
const sendEmail = require('./sendEmail');
const taskWorker = require('./taskWorker');
const async = require('async');
const bodyParser = require('body-parser'); // eslint-disable-line require-statement-match
const express = require('express');
const _ = require('lodash');
const parseArgs = require('minimist'); // eslint-disable-line require-statement-match
const persistentQueue = require('./persistentQueue');

// set this process up with the appropriate permissions, value is in octal
process.umask(0o0002);

/**
 * Handle command line input
 * First 2 args provide info about executables, ignore
 */
const parsedCommandLineOptions = parseArgs(process.argv.slice(2), {
  boolean: true
});
const defaultOptions = {
  verbose: constants.BUILD_SERVER_CONFIG.verbose,
  // can be overridden by a flag on the command line

  // options for supporting help
  help: false,
  h: false
};
for (const key in parsedCommandLineOptions) {
  if (key !== '_' && parsedCommandLineOptions.hasOwnProperty(key) && !defaultOptions.hasOwnProperty(key)) {
    console.error(`Unrecognized option: ${key}`);
    console.error('try --help for usage information.');
    process.exit(1);
  }
}

// If help flag, print help and usage info
if (parsedCommandLineOptions.hasOwnProperty('help') || parsedCommandLineOptions.hasOwnProperty('h')) {
  console.log('Usage:');
  console.log('  node build-server.js [options]');
  console.log('');
  console.log('Options:');
  console.log('  --help (print usage and exit)\n' + '    type: bool  default: false\n' + '  --verbose (output grunt logs in addition to build-server)\n' + '    type: bool  default: false\n');
  process.exit(1);
}

// Merge the default and supplied options.
const options = _.extend(defaultOptions, parsedCommandLineOptions);
const verbose = options.verbose;
const taskQueue = async.queue(taskWorker, 1); // 1 is the max number of tasks that can run concurrently

/**
 * Handle chipper 1.0 requests
 *
 * @param {express.Request} req
 * @param {express.Response} res
 * @param {String} key - one of 'query' or 'body', used to differentiate query parameters or POST data.
 */
const queueDeployApiVersion1 = (req, res, key) => {
  const repos = JSON.parse(decodeURIComponent(req[key][constants.REPOS_KEY]));
  const simName = decodeURIComponent(req[key][constants.SIM_NAME_KEY]);
  const version = decodeURIComponent(req[key][constants.VERSION_KEY]);
  const locales = decodeURIComponent(req[key][constants.LOCALES_KEY]) || null;
  const option = decodeURIComponent(req[key][constants.OPTION_KEY]) || 'default';
  const email = decodeURIComponent(req[key][constants.EMAIL_KEY]) || null;
  const translatorId = decodeURIComponent(req[key][constants.USER_ID_KEY]) || null;
  const authorizationKey = decodeURIComponent(req[key][constants.AUTHORIZATION_KEY]);
  const branch = decodeURIComponent(req[key][constants.BRANCH_KEY]);

  // TODO https://github.com/phetsims/perennial/issues/167 determine if this comment needs updating for chipper 1.0 deploys
  // For RC deploys, only send to the dev server.  For production deploys, the local build will send to the dev server so the build-server
  // only sends to the production server (phet-server2).
  const servers = option === 'rc' ? [constants.DEV_SERVER] : [constants.PRODUCTION_SERVER];
  const brands = version.indexOf('phetio') < 0 ? [constants.PHET_BRAND] : [constants.PHET_IO_BRAND];
  queueDeploy('1.0', repos, simName, version, locales, brands, servers, email, translatorId, branch, authorizationKey, req, res);
};
const getQueueDeploy = (req, res) => {
  logRequest(req, 'query', winston);
  queueDeployApiVersion1(req, res, 'query');
};
const postQueueDeploy = (req, res) => {
  logRequest(req, 'body', winston);
  const api = decodeURIComponent(req.body[constants.API_KEY]);
  if (api && api.startsWith('2.')) {
    const repos = JSON.parse(req.body[constants.DEPENDENCIES_KEY]);
    const simName = req.body[constants.SIM_NAME_KEY];
    const version = req.body[constants.VERSION_KEY];
    const locales = req.body[constants.LOCALES_KEY] || null;
    const servers = req.body[constants.SERVERS_KEY];
    const brands = req.body[constants.BRANDS_KEY];
    const authorizationKey = req.body[constants.AUTHORIZATION_KEY];
    const translatorId = req.body[constants.TRANSLATOR_ID_KEY] || null;
    const email = req.body[constants.EMAIL_KEY] || null;
    const branch = req.body[constants.BRANCH_KEY] || null;
    queueDeploy(api, repos, simName, version, locales, brands, servers, email, translatorId, branch, authorizationKey, req, res);
  } else {
    queueDeployApiVersion1(req, res, 'body');
  }
};

/**
 * Adds the request to the processing queue and handles email notifications about success or failures
 *
 * @param {String} api
 * @param {Object} repos
 * @param {String} simName
 * @param {String} version
 * @param {Array.<String>} locales
 * @param {Array.<String>} brands
 * @param {Array.<String>} servers
 * @param {String} email
 * @param {String} userId
 * @param {String} branch
 * @param {String} authorizationKey
 * @param {express.Request} req
 * @param {express.Response} res
 */
const queueDeploy = (api, repos, simName, version, locales, brands, servers, email, userId, branch, authorizationKey, req, res) => {
  if (repos && simName && version && authorizationKey) {
    const productionBrands = [constants.PHET_BRAND, constants.PHET_IO_BRAND];
    if (authorizationKey !== constants.BUILD_SERVER_CONFIG.buildServerAuthorizationCode) {
      const err = 'wrong authorization code';
      winston.log('error', err);
      res.status(401);
      res.send(err);
    } else if (servers.indexOf(constants.PRODUCTION_SERVER) >= 0 && brands.some(brand => !productionBrands.includes(brand))) {
      const err = 'Cannot complete production deploys for brands outside of phet and phet-io';
      winston.log('error', err);
      res.status(400);
      res.send(err);
    } else {
      winston.log('info', `queuing build for ${simName} ${version}`);
      const task = {
        api: api,
        repos: repos,
        simName: simName,
        version: version,
        locales: locales,
        servers: servers,
        brands: brands,
        email: email,
        userId: userId,
        branch: branch
      };
      persistentQueue.addTask(task);
      taskQueue.push(task, buildCallback(task));
      res.status(api === '1.0' ? 200 : 202);
      res.send('build process initiated, check logs for details');
    }
  } else {
    const errorString = 'missing one or more required query parameters: dependencies, simName, version, authorizationCode';
    winston.log('error', errorString);
    res.status(400);
    res.send(errorString);
  }
};
const buildCallback = task => {
  return err => {
    const simInfoString = `Sim = ${task.simName} Version = ${task.version} Brands = ${task.brands} Locales = ${task.locales}`;
    if (err) {
      let shas = task.repos;

      // try to format the JSON nicely for the email, but don't worry if it is invalid JSON
      try {
        shas = JSON.stringify(JSON.parse(shas), null, 2);
      } catch (e) {
        // invalid JSON
      }
      const errorMessage = `Build failure: ${err}. ${simInfoString} Shas = ${JSON.stringify(shas)}`;
      winston.log('error', errorMessage);
      sendEmail('BUILD ERROR', errorMessage, task.email);
    } else {
      winston.log('info', `build for ${task.simName} finished successfully`);
      sendEmail('Build Succeeded', simInfoString, task.email, true);
    }
  };
};
const postQueueImageDeploy = (req, res) => {
  logRequest(req, 'body', winston);
  const authorizationKey = req.body[constants.AUTHORIZATION_KEY];
  if (authorizationKey !== constants.BUILD_SERVER_CONFIG.buildServerAuthorizationCode) {
    const err = 'wrong authorization code';
    winston.log('error', err);
    res.status(401);
    res.send(err);
    return;
  }
  const branch = req.body[constants.BRANCH_KEY] || 'master';
  const brands = req.body[constants.BRANDS_KEY] || 'phet';
  const email = req.body[constants.EMAIL_KEY] || null;
  const simulation = req.body[constants.SIM_NAME_KEY] || null;
  const version = req.body[constants.VERSION_KEY] || null;
  const emailBodyText = 'Not implemented';
  taskQueue.push({
    deployImages: true,
    branch: branch,
    brands: brands,
    simulation: simulation,
    version: version
  }, err => {
    if (err) {
      const errorMessage = `Image deploy failure: ${err}`;
      winston.log('error', errorMessage);
      sendEmail('IMAGE DEPLOY ERROR', errorMessage, email);
    } else {
      winston.log('info', 'Image deploy finished successfully');
      sendEmail('Image deploy succeeded', emailBodyText, email, true);
    }
  });
  res.status(202);
  res.send('build process initiated, check logs for details');
};

// Create the ExpressJS app
const app = express();

// to support JSON-encoded bodies
app.use(bodyParser.json());

// add the route to build and deploy
app.get('/deploy-html-simulation', getQueueDeploy);
app.post('/deploy-html-simulation', postQueueDeploy);
app.post('/deploy-images', postQueueImageDeploy);

// start the server
app.listen(constants.LISTEN_PORT, () => {
  winston.log('info', `Listening on port ${constants.LISTEN_PORT}`);
  winston.log('info', `Verbose mode: ${verbose}`);

  // log the SHA of perennial - this may make it easier to duplicate and track down problems
  try {
    const sha = childProcess.execSync('git rev-parse HEAD');
    winston.info(`current SHA: ${sha.toString()}`);
  } catch (err) {
    winston.warn(`unable to get SHA from git, err: ${err}`);
  }

  // Recreate queue
  try {
    const queue = persistentQueue.getQueue();
    for (const task of queue) {
      console.log('Resuming task from persistent queue: ', task);
      taskQueue.push(task, buildCallback(task));
    }
  } catch (e) {
    console.error('could not resume queue');
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb25zdGFudHMiLCJyZXF1aXJlIiwiY2hpbGRQcm9jZXNzIiwid2luc3RvbiIsImxvZ1JlcXVlc3QiLCJzZW5kRW1haWwiLCJ0YXNrV29ya2VyIiwiYXN5bmMiLCJib2R5UGFyc2VyIiwiZXhwcmVzcyIsIl8iLCJwYXJzZUFyZ3MiLCJwZXJzaXN0ZW50UXVldWUiLCJwcm9jZXNzIiwidW1hc2siLCJwYXJzZWRDb21tYW5kTGluZU9wdGlvbnMiLCJhcmd2Iiwic2xpY2UiLCJib29sZWFuIiwiZGVmYXVsdE9wdGlvbnMiLCJ2ZXJib3NlIiwiQlVJTERfU0VSVkVSX0NPTkZJRyIsImhlbHAiLCJoIiwia2V5IiwiaGFzT3duUHJvcGVydHkiLCJjb25zb2xlIiwiZXJyb3IiLCJleGl0IiwibG9nIiwib3B0aW9ucyIsImV4dGVuZCIsInRhc2tRdWV1ZSIsInF1ZXVlIiwicXVldWVEZXBsb3lBcGlWZXJzaW9uMSIsInJlcSIsInJlcyIsInJlcG9zIiwiSlNPTiIsInBhcnNlIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiUkVQT1NfS0VZIiwic2ltTmFtZSIsIlNJTV9OQU1FX0tFWSIsInZlcnNpb24iLCJWRVJTSU9OX0tFWSIsImxvY2FsZXMiLCJMT0NBTEVTX0tFWSIsIm9wdGlvbiIsIk9QVElPTl9LRVkiLCJlbWFpbCIsIkVNQUlMX0tFWSIsInRyYW5zbGF0b3JJZCIsIlVTRVJfSURfS0VZIiwiYXV0aG9yaXphdGlvbktleSIsIkFVVEhPUklaQVRJT05fS0VZIiwiYnJhbmNoIiwiQlJBTkNIX0tFWSIsInNlcnZlcnMiLCJERVZfU0VSVkVSIiwiUFJPRFVDVElPTl9TRVJWRVIiLCJicmFuZHMiLCJpbmRleE9mIiwiUEhFVF9CUkFORCIsIlBIRVRfSU9fQlJBTkQiLCJxdWV1ZURlcGxveSIsImdldFF1ZXVlRGVwbG95IiwicG9zdFF1ZXVlRGVwbG95IiwiYXBpIiwiYm9keSIsIkFQSV9LRVkiLCJzdGFydHNXaXRoIiwiREVQRU5ERU5DSUVTX0tFWSIsIlNFUlZFUlNfS0VZIiwiQlJBTkRTX0tFWSIsIlRSQU5TTEFUT1JfSURfS0VZIiwidXNlcklkIiwicHJvZHVjdGlvbkJyYW5kcyIsImJ1aWxkU2VydmVyQXV0aG9yaXphdGlvbkNvZGUiLCJlcnIiLCJzdGF0dXMiLCJzZW5kIiwic29tZSIsImJyYW5kIiwiaW5jbHVkZXMiLCJ0YXNrIiwiYWRkVGFzayIsInB1c2giLCJidWlsZENhbGxiYWNrIiwiZXJyb3JTdHJpbmciLCJzaW1JbmZvU3RyaW5nIiwic2hhcyIsInN0cmluZ2lmeSIsImUiLCJlcnJvck1lc3NhZ2UiLCJwb3N0UXVldWVJbWFnZURlcGxveSIsInNpbXVsYXRpb24iLCJlbWFpbEJvZHlUZXh0IiwiZGVwbG95SW1hZ2VzIiwiYXBwIiwidXNlIiwianNvbiIsImdldCIsInBvc3QiLCJsaXN0ZW4iLCJMSVNURU5fUE9SVCIsInNoYSIsImV4ZWNTeW5jIiwiaW5mbyIsInRvU3RyaW5nIiwid2FybiIsImdldFF1ZXVlIl0sInNvdXJjZXMiOlsiYnVpbGQtc2VydmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDAyLTIwMTcsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFBoRVQgYnVpbGQgYW5kIGRlcGxveSBzZXJ2ZXIuIFRoZSBzZXJ2ZXIgaXMgZGVzaWduZWQgdG8gcnVuIG9uIHRoZSBzYW1lIGhvc3QgYXMgdGhlIHByb2R1Y3Rpb24gc2l0ZSAocGhldC1zZXJ2ZXIuaW50LmNvbG9yYWRvLmVkdSkuXHJcbiAqIFRoaXMgZmlsZSBpbml0aWFsaXplcyB0aGUgYXBwIGFuZCB0aGUgbWFpbiBwcm9jZXNzIHF1ZXVlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEFhcm9uIERhdmlzXHJcbiAqIEBhdXRob3IgTWF0dCBQZW5uaW5ndG9uXHJcbiAqL1xyXG5cclxuXHJcbmNvbnN0IGNvbnN0YW50cyA9IHJlcXVpcmUoICcuL2NvbnN0YW50cycgKTtcclxuY29uc3QgY2hpbGRQcm9jZXNzID0gcmVxdWlyZSggJ2NoaWxkX3Byb2Nlc3MnICk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcmVxdWlyZS1zdGF0ZW1lbnQtbWF0Y2hcclxuY29uc3Qgd2luc3RvbiA9IHJlcXVpcmUoICcuL2xvZy5qcycgKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSByZXF1aXJlLXN0YXRlbWVudC1tYXRjaFxyXG5jb25zdCBsb2dSZXF1ZXN0ID0gcmVxdWlyZSggJy4vbG9nUmVxdWVzdCcgKTtcclxuY29uc3Qgc2VuZEVtYWlsID0gcmVxdWlyZSggJy4vc2VuZEVtYWlsJyApO1xyXG5jb25zdCB0YXNrV29ya2VyID0gcmVxdWlyZSggJy4vdGFza1dvcmtlcicgKTtcclxuY29uc3QgYXN5bmMgPSByZXF1aXJlKCAnYXN5bmMnICk7XHJcbmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCAnYm9keS1wYXJzZXInICk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcmVxdWlyZS1zdGF0ZW1lbnQtbWF0Y2hcclxuY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoICdleHByZXNzJyApO1xyXG5jb25zdCBfID0gcmVxdWlyZSggJ2xvZGFzaCcgKTtcclxuY29uc3QgcGFyc2VBcmdzID0gcmVxdWlyZSggJ21pbmltaXN0JyApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHJlcXVpcmUtc3RhdGVtZW50LW1hdGNoXHJcbmNvbnN0IHBlcnNpc3RlbnRRdWV1ZSA9IHJlcXVpcmUoICcuL3BlcnNpc3RlbnRRdWV1ZScgKTtcclxuXHJcbi8vIHNldCB0aGlzIHByb2Nlc3MgdXAgd2l0aCB0aGUgYXBwcm9wcmlhdGUgcGVybWlzc2lvbnMsIHZhbHVlIGlzIGluIG9jdGFsXHJcbnByb2Nlc3MudW1hc2soIDBvMDAwMiApO1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZSBjb21tYW5kIGxpbmUgaW5wdXRcclxuICogRmlyc3QgMiBhcmdzIHByb3ZpZGUgaW5mbyBhYm91dCBleGVjdXRhYmxlcywgaWdub3JlXHJcbiAqL1xyXG5jb25zdCBwYXJzZWRDb21tYW5kTGluZU9wdGlvbnMgPSBwYXJzZUFyZ3MoIHByb2Nlc3MuYXJndi5zbGljZSggMiApLCB7XHJcbiAgYm9vbGVhbjogdHJ1ZVxyXG59ICk7XHJcblxyXG5jb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcclxuICB2ZXJib3NlOiBjb25zdGFudHMuQlVJTERfU0VSVkVSX0NPTkZJRy52ZXJib3NlLCAvLyBjYW4gYmUgb3ZlcnJpZGRlbiBieSBhIGZsYWcgb24gdGhlIGNvbW1hbmQgbGluZVxyXG5cclxuICAvLyBvcHRpb25zIGZvciBzdXBwb3J0aW5nIGhlbHBcclxuICBoZWxwOiBmYWxzZSxcclxuICBoOiBmYWxzZVxyXG59O1xyXG5cclxuZm9yICggY29uc3Qga2V5IGluIHBhcnNlZENvbW1hbmRMaW5lT3B0aW9ucyApIHtcclxuICBpZiAoIGtleSAhPT0gJ18nICYmIHBhcnNlZENvbW1hbmRMaW5lT3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgga2V5ICkgJiYgIWRlZmF1bHRPcHRpb25zLmhhc093blByb3BlcnR5KCBrZXkgKSApIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoIGBVbnJlY29nbml6ZWQgb3B0aW9uOiAke2tleX1gICk7XHJcbiAgICBjb25zb2xlLmVycm9yKCAndHJ5IC0taGVscCBmb3IgdXNhZ2UgaW5mb3JtYXRpb24uJyApO1xyXG4gICAgcHJvY2Vzcy5leGl0KCAxICk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBJZiBoZWxwIGZsYWcsIHByaW50IGhlbHAgYW5kIHVzYWdlIGluZm9cclxuaWYgKCBwYXJzZWRDb21tYW5kTGluZU9wdGlvbnMuaGFzT3duUHJvcGVydHkoICdoZWxwJyApIHx8IHBhcnNlZENvbW1hbmRMaW5lT3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSggJ2gnICkgKSB7XHJcbiAgY29uc29sZS5sb2coICdVc2FnZTonICk7XHJcbiAgY29uc29sZS5sb2coICcgIG5vZGUgYnVpbGQtc2VydmVyLmpzIFtvcHRpb25zXScgKTtcclxuICBjb25zb2xlLmxvZyggJycgKTtcclxuICBjb25zb2xlLmxvZyggJ09wdGlvbnM6JyApO1xyXG4gIGNvbnNvbGUubG9nKFxyXG4gICAgJyAgLS1oZWxwIChwcmludCB1c2FnZSBhbmQgZXhpdClcXG4nICtcclxuICAgICcgICAgdHlwZTogYm9vbCAgZGVmYXVsdDogZmFsc2VcXG4nICtcclxuICAgICcgIC0tdmVyYm9zZSAob3V0cHV0IGdydW50IGxvZ3MgaW4gYWRkaXRpb24gdG8gYnVpbGQtc2VydmVyKVxcbicgK1xyXG4gICAgJyAgICB0eXBlOiBib29sICBkZWZhdWx0OiBmYWxzZVxcbidcclxuICApO1xyXG4gIHByb2Nlc3MuZXhpdCggMSApO1xyXG59XHJcblxyXG4vLyBNZXJnZSB0aGUgZGVmYXVsdCBhbmQgc3VwcGxpZWQgb3B0aW9ucy5cclxuY29uc3Qgb3B0aW9ucyA9IF8uZXh0ZW5kKCBkZWZhdWx0T3B0aW9ucywgcGFyc2VkQ29tbWFuZExpbmVPcHRpb25zICk7XHJcbmNvbnN0IHZlcmJvc2UgPSBvcHRpb25zLnZlcmJvc2U7XHJcblxyXG5jb25zdCB0YXNrUXVldWUgPSBhc3luYy5xdWV1ZSggdGFza1dvcmtlciwgMSApOyAvLyAxIGlzIHRoZSBtYXggbnVtYmVyIG9mIHRhc2tzIHRoYXQgY2FuIHJ1biBjb25jdXJyZW50bHlcclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgY2hpcHBlciAxLjAgcmVxdWVzdHNcclxuICpcclxuICogQHBhcmFtIHtleHByZXNzLlJlcXVlc3R9IHJlcVxyXG4gKiBAcGFyYW0ge2V4cHJlc3MuUmVzcG9uc2V9IHJlc1xyXG4gKiBAcGFyYW0ge1N0cmluZ30ga2V5IC0gb25lIG9mICdxdWVyeScgb3IgJ2JvZHknLCB1c2VkIHRvIGRpZmZlcmVudGlhdGUgcXVlcnkgcGFyYW1ldGVycyBvciBQT1NUIGRhdGEuXHJcbiAqL1xyXG5jb25zdCBxdWV1ZURlcGxveUFwaVZlcnNpb24xID0gKCByZXEsIHJlcywga2V5ICkgPT4ge1xyXG4gIGNvbnN0IHJlcG9zID0gSlNPTi5wYXJzZSggZGVjb2RlVVJJQ29tcG9uZW50KCByZXFbIGtleSBdWyBjb25zdGFudHMuUkVQT1NfS0VZIF0gKSApO1xyXG4gIGNvbnN0IHNpbU5hbWUgPSBkZWNvZGVVUklDb21wb25lbnQoIHJlcVsga2V5IF1bIGNvbnN0YW50cy5TSU1fTkFNRV9LRVkgXSApO1xyXG4gIGNvbnN0IHZlcnNpb24gPSBkZWNvZGVVUklDb21wb25lbnQoIHJlcVsga2V5IF1bIGNvbnN0YW50cy5WRVJTSU9OX0tFWSBdICk7XHJcbiAgY29uc3QgbG9jYWxlcyA9IGRlY29kZVVSSUNvbXBvbmVudCggcmVxWyBrZXkgXVsgY29uc3RhbnRzLkxPQ0FMRVNfS0VZIF0gKSB8fCBudWxsO1xyXG4gIGNvbnN0IG9wdGlvbiA9IGRlY29kZVVSSUNvbXBvbmVudCggcmVxWyBrZXkgXVsgY29uc3RhbnRzLk9QVElPTl9LRVkgXSApIHx8ICdkZWZhdWx0JztcclxuICBjb25zdCBlbWFpbCA9IGRlY29kZVVSSUNvbXBvbmVudCggcmVxWyBrZXkgXVsgY29uc3RhbnRzLkVNQUlMX0tFWSBdICkgfHwgbnVsbDtcclxuICBjb25zdCB0cmFuc2xhdG9ySWQgPSBkZWNvZGVVUklDb21wb25lbnQoIHJlcVsga2V5IF1bIGNvbnN0YW50cy5VU0VSX0lEX0tFWSBdICkgfHwgbnVsbDtcclxuICBjb25zdCBhdXRob3JpemF0aW9uS2V5ID0gZGVjb2RlVVJJQ29tcG9uZW50KCByZXFbIGtleSBdWyBjb25zdGFudHMuQVVUSE9SSVpBVElPTl9LRVkgXSApO1xyXG4gIGNvbnN0IGJyYW5jaCA9IGRlY29kZVVSSUNvbXBvbmVudCggcmVxWyBrZXkgXVsgY29uc3RhbnRzLkJSQU5DSF9LRVkgXSApO1xyXG5cclxuICAvLyBUT0RPIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9wZXJlbm5pYWwvaXNzdWVzLzE2NyBkZXRlcm1pbmUgaWYgdGhpcyBjb21tZW50IG5lZWRzIHVwZGF0aW5nIGZvciBjaGlwcGVyIDEuMCBkZXBsb3lzXHJcbiAgLy8gRm9yIFJDIGRlcGxveXMsIG9ubHkgc2VuZCB0byB0aGUgZGV2IHNlcnZlci4gIEZvciBwcm9kdWN0aW9uIGRlcGxveXMsIHRoZSBsb2NhbCBidWlsZCB3aWxsIHNlbmQgdG8gdGhlIGRldiBzZXJ2ZXIgc28gdGhlIGJ1aWxkLXNlcnZlclxyXG4gIC8vIG9ubHkgc2VuZHMgdG8gdGhlIHByb2R1Y3Rpb24gc2VydmVyIChwaGV0LXNlcnZlcjIpLlxyXG4gIGNvbnN0IHNlcnZlcnMgPSAoIG9wdGlvbiA9PT0gJ3JjJyApID8gWyBjb25zdGFudHMuREVWX1NFUlZFUiBdIDogWyBjb25zdGFudHMuUFJPRFVDVElPTl9TRVJWRVIgXTtcclxuICBjb25zdCBicmFuZHMgPSB2ZXJzaW9uLmluZGV4T2YoICdwaGV0aW8nICkgPCAwID8gWyBjb25zdGFudHMuUEhFVF9CUkFORCBdIDogWyBjb25zdGFudHMuUEhFVF9JT19CUkFORCBdO1xyXG5cclxuICBxdWV1ZURlcGxveSggJzEuMCcsIHJlcG9zLCBzaW1OYW1lLCB2ZXJzaW9uLCBsb2NhbGVzLCBicmFuZHMsIHNlcnZlcnMsIGVtYWlsLCB0cmFuc2xhdG9ySWQsIGJyYW5jaCwgYXV0aG9yaXphdGlvbktleSwgcmVxLCByZXMgKTtcclxufTtcclxuXHJcbmNvbnN0IGdldFF1ZXVlRGVwbG95ID0gKCByZXEsIHJlcyApID0+IHtcclxuICBsb2dSZXF1ZXN0KCByZXEsICdxdWVyeScsIHdpbnN0b24gKTtcclxuICBxdWV1ZURlcGxveUFwaVZlcnNpb24xKCByZXEsIHJlcywgJ3F1ZXJ5JyApO1xyXG59O1xyXG5cclxuY29uc3QgcG9zdFF1ZXVlRGVwbG95ID0gKCByZXEsIHJlcyApID0+IHtcclxuICBsb2dSZXF1ZXN0KCByZXEsICdib2R5Jywgd2luc3RvbiApO1xyXG5cclxuICBjb25zdCBhcGkgPSBkZWNvZGVVUklDb21wb25lbnQoIHJlcS5ib2R5WyBjb25zdGFudHMuQVBJX0tFWSBdICk7XHJcblxyXG4gIGlmICggYXBpICYmIGFwaS5zdGFydHNXaXRoKCAnMi4nICkgKSB7XHJcbiAgICBjb25zdCByZXBvcyA9IEpTT04ucGFyc2UoIHJlcS5ib2R5WyBjb25zdGFudHMuREVQRU5ERU5DSUVTX0tFWSBdICk7XHJcbiAgICBjb25zdCBzaW1OYW1lID0gcmVxLmJvZHlbIGNvbnN0YW50cy5TSU1fTkFNRV9LRVkgXTtcclxuICAgIGNvbnN0IHZlcnNpb24gPSByZXEuYm9keVsgY29uc3RhbnRzLlZFUlNJT05fS0VZIF07XHJcbiAgICBjb25zdCBsb2NhbGVzID0gcmVxLmJvZHlbIGNvbnN0YW50cy5MT0NBTEVTX0tFWSBdIHx8IG51bGw7XHJcbiAgICBjb25zdCBzZXJ2ZXJzID0gcmVxLmJvZHlbIGNvbnN0YW50cy5TRVJWRVJTX0tFWSBdO1xyXG4gICAgY29uc3QgYnJhbmRzID0gcmVxLmJvZHlbIGNvbnN0YW50cy5CUkFORFNfS0VZIF07XHJcbiAgICBjb25zdCBhdXRob3JpemF0aW9uS2V5ID0gcmVxLmJvZHlbIGNvbnN0YW50cy5BVVRIT1JJWkFUSU9OX0tFWSBdO1xyXG4gICAgY29uc3QgdHJhbnNsYXRvcklkID0gcmVxLmJvZHlbIGNvbnN0YW50cy5UUkFOU0xBVE9SX0lEX0tFWSBdIHx8IG51bGw7XHJcbiAgICBjb25zdCBlbWFpbCA9IHJlcS5ib2R5WyBjb25zdGFudHMuRU1BSUxfS0VZIF0gfHwgbnVsbDtcclxuICAgIGNvbnN0IGJyYW5jaCA9IHJlcS5ib2R5WyBjb25zdGFudHMuQlJBTkNIX0tFWSBdIHx8IG51bGw7XHJcblxyXG4gICAgcXVldWVEZXBsb3koIGFwaSwgcmVwb3MsIHNpbU5hbWUsIHZlcnNpb24sIGxvY2FsZXMsIGJyYW5kcywgc2VydmVycywgZW1haWwsIHRyYW5zbGF0b3JJZCwgYnJhbmNoLCBhdXRob3JpemF0aW9uS2V5LCByZXEsIHJlcyApO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIHF1ZXVlRGVwbG95QXBpVmVyc2lvbjEoIHJlcSwgcmVzLCAnYm9keScgKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQWRkcyB0aGUgcmVxdWVzdCB0byB0aGUgcHJvY2Vzc2luZyBxdWV1ZSBhbmQgaGFuZGxlcyBlbWFpbCBub3RpZmljYXRpb25zIGFib3V0IHN1Y2Nlc3Mgb3IgZmFpbHVyZXNcclxuICpcclxuICogQHBhcmFtIHtTdHJpbmd9IGFwaVxyXG4gKiBAcGFyYW0ge09iamVjdH0gcmVwb3NcclxuICogQHBhcmFtIHtTdHJpbmd9IHNpbU5hbWVcclxuICogQHBhcmFtIHtTdHJpbmd9IHZlcnNpb25cclxuICogQHBhcmFtIHtBcnJheS48U3RyaW5nPn0gbG9jYWxlc1xyXG4gKiBAcGFyYW0ge0FycmF5LjxTdHJpbmc+fSBicmFuZHNcclxuICogQHBhcmFtIHtBcnJheS48U3RyaW5nPn0gc2VydmVyc1xyXG4gKiBAcGFyYW0ge1N0cmluZ30gZW1haWxcclxuICogQHBhcmFtIHtTdHJpbmd9IHVzZXJJZFxyXG4gKiBAcGFyYW0ge1N0cmluZ30gYnJhbmNoXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSBhdXRob3JpemF0aW9uS2V5XHJcbiAqIEBwYXJhbSB7ZXhwcmVzcy5SZXF1ZXN0fSByZXFcclxuICogQHBhcmFtIHtleHByZXNzLlJlc3BvbnNlfSByZXNcclxuICovXHJcbmNvbnN0IHF1ZXVlRGVwbG95ID0gKCBhcGksIHJlcG9zLCBzaW1OYW1lLCB2ZXJzaW9uLCBsb2NhbGVzLCBicmFuZHMsIHNlcnZlcnMsIGVtYWlsLCB1c2VySWQsIGJyYW5jaCwgYXV0aG9yaXphdGlvbktleSwgcmVxLCByZXMgKSA9PiB7XHJcblxyXG4gIGlmICggcmVwb3MgJiYgc2ltTmFtZSAmJiB2ZXJzaW9uICYmIGF1dGhvcml6YXRpb25LZXkgKSB7XHJcbiAgICBjb25zdCBwcm9kdWN0aW9uQnJhbmRzID0gWyBjb25zdGFudHMuUEhFVF9CUkFORCwgY29uc3RhbnRzLlBIRVRfSU9fQlJBTkQgXTtcclxuXHJcbiAgICBpZiAoIGF1dGhvcml6YXRpb25LZXkgIT09IGNvbnN0YW50cy5CVUlMRF9TRVJWRVJfQ09ORklHLmJ1aWxkU2VydmVyQXV0aG9yaXphdGlvbkNvZGUgKSB7XHJcbiAgICAgIGNvbnN0IGVyciA9ICd3cm9uZyBhdXRob3JpemF0aW9uIGNvZGUnO1xyXG4gICAgICB3aW5zdG9uLmxvZyggJ2Vycm9yJywgZXJyICk7XHJcbiAgICAgIHJlcy5zdGF0dXMoIDQwMSApO1xyXG4gICAgICByZXMuc2VuZCggZXJyICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggc2VydmVycy5pbmRleE9mKCBjb25zdGFudHMuUFJPRFVDVElPTl9TRVJWRVIgKSA+PSAwICYmIGJyYW5kcy5zb21lKCBicmFuZCA9PiAhcHJvZHVjdGlvbkJyYW5kcy5pbmNsdWRlcyggYnJhbmQgKSApICkge1xyXG4gICAgICBjb25zdCBlcnIgPSAnQ2Fubm90IGNvbXBsZXRlIHByb2R1Y3Rpb24gZGVwbG95cyBmb3IgYnJhbmRzIG91dHNpZGUgb2YgcGhldCBhbmQgcGhldC1pbyc7XHJcbiAgICAgIHdpbnN0b24ubG9nKCAnZXJyb3InLCBlcnIgKTtcclxuICAgICAgcmVzLnN0YXR1cyggNDAwICk7XHJcbiAgICAgIHJlcy5zZW5kKCBlcnIgKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICB3aW5zdG9uLmxvZyggJ2luZm8nLCBgcXVldWluZyBidWlsZCBmb3IgJHtzaW1OYW1lfSAke3ZlcnNpb259YCApO1xyXG4gICAgICBjb25zdCB0YXNrID0ge1xyXG4gICAgICAgIGFwaTogYXBpLFxyXG4gICAgICAgIHJlcG9zOiByZXBvcyxcclxuICAgICAgICBzaW1OYW1lOiBzaW1OYW1lLFxyXG4gICAgICAgIHZlcnNpb246IHZlcnNpb24sXHJcbiAgICAgICAgbG9jYWxlczogbG9jYWxlcyxcclxuICAgICAgICBzZXJ2ZXJzOiBzZXJ2ZXJzLFxyXG4gICAgICAgIGJyYW5kczogYnJhbmRzLFxyXG4gICAgICAgIGVtYWlsOiBlbWFpbCxcclxuICAgICAgICB1c2VySWQ6IHVzZXJJZCxcclxuICAgICAgICBicmFuY2g6IGJyYW5jaFxyXG4gICAgICB9O1xyXG4gICAgICBwZXJzaXN0ZW50UXVldWUuYWRkVGFzayggdGFzayApO1xyXG4gICAgICB0YXNrUXVldWUucHVzaCggdGFzaywgYnVpbGRDYWxsYmFjayggdGFzayApICk7XHJcblxyXG4gICAgICByZXMuc3RhdHVzKCBhcGkgPT09ICcxLjAnID8gMjAwIDogMjAyICk7XHJcbiAgICAgIHJlcy5zZW5kKCAnYnVpbGQgcHJvY2VzcyBpbml0aWF0ZWQsIGNoZWNrIGxvZ3MgZm9yIGRldGFpbHMnICk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGVsc2Uge1xyXG4gICAgY29uc3QgZXJyb3JTdHJpbmcgPSAnbWlzc2luZyBvbmUgb3IgbW9yZSByZXF1aXJlZCBxdWVyeSBwYXJhbWV0ZXJzOiBkZXBlbmRlbmNpZXMsIHNpbU5hbWUsIHZlcnNpb24sIGF1dGhvcml6YXRpb25Db2RlJztcclxuICAgIHdpbnN0b24ubG9nKCAnZXJyb3InLCBlcnJvclN0cmluZyApO1xyXG4gICAgcmVzLnN0YXR1cyggNDAwICk7XHJcbiAgICByZXMuc2VuZCggZXJyb3JTdHJpbmcgKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBidWlsZENhbGxiYWNrID0gdGFzayA9PiB7XHJcbiAgcmV0dXJuIGVyciA9PiB7XHJcbiAgICBjb25zdCBzaW1JbmZvU3RyaW5nID0gYFNpbSA9ICR7dGFzay5zaW1OYW1lXHJcbiAgICB9IFZlcnNpb24gPSAke3Rhc2sudmVyc2lvblxyXG4gICAgfSBCcmFuZHMgPSAke3Rhc2suYnJhbmRzXHJcbiAgICB9IExvY2FsZXMgPSAke3Rhc2subG9jYWxlc31gO1xyXG5cclxuICAgIGlmICggZXJyICkge1xyXG4gICAgICBsZXQgc2hhcyA9IHRhc2sucmVwb3M7XHJcblxyXG4gICAgICAvLyB0cnkgdG8gZm9ybWF0IHRoZSBKU09OIG5pY2VseSBmb3IgdGhlIGVtYWlsLCBidXQgZG9uJ3Qgd29ycnkgaWYgaXQgaXMgaW52YWxpZCBKU09OXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgc2hhcyA9IEpTT04uc3RyaW5naWZ5KCBKU09OLnBhcnNlKCBzaGFzICksIG51bGwsIDIgKTtcclxuICAgICAgfVxyXG4gICAgICBjYXRjaCggZSApIHtcclxuICAgICAgICAvLyBpbnZhbGlkIEpTT05cclxuICAgICAgfVxyXG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBgQnVpbGQgZmFpbHVyZTogJHtlcnJ9LiAke3NpbUluZm9TdHJpbmd9IFNoYXMgPSAke0pTT04uc3RyaW5naWZ5KCBzaGFzICl9YDtcclxuICAgICAgd2luc3Rvbi5sb2coICdlcnJvcicsIGVycm9yTWVzc2FnZSApO1xyXG4gICAgICBzZW5kRW1haWwoICdCVUlMRCBFUlJPUicsIGVycm9yTWVzc2FnZSwgdGFzay5lbWFpbCApO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHdpbnN0b24ubG9nKCAnaW5mbycsIGBidWlsZCBmb3IgJHt0YXNrLnNpbU5hbWV9IGZpbmlzaGVkIHN1Y2Nlc3NmdWxseWAgKTtcclxuICAgICAgc2VuZEVtYWlsKCAnQnVpbGQgU3VjY2VlZGVkJywgc2ltSW5mb1N0cmluZywgdGFzay5lbWFpbCwgdHJ1ZSApO1xyXG4gICAgfVxyXG4gIH07XHJcbn07XHJcblxyXG5jb25zdCBwb3N0UXVldWVJbWFnZURlcGxveSA9ICggcmVxLCByZXMgKSA9PiB7XHJcbiAgbG9nUmVxdWVzdCggcmVxLCAnYm9keScsIHdpbnN0b24gKTtcclxuXHJcbiAgY29uc3QgYXV0aG9yaXphdGlvbktleSA9IHJlcS5ib2R5WyBjb25zdGFudHMuQVVUSE9SSVpBVElPTl9LRVkgXTtcclxuICBpZiAoIGF1dGhvcml6YXRpb25LZXkgIT09IGNvbnN0YW50cy5CVUlMRF9TRVJWRVJfQ09ORklHLmJ1aWxkU2VydmVyQXV0aG9yaXphdGlvbkNvZGUgKSB7XHJcbiAgICBjb25zdCBlcnIgPSAnd3JvbmcgYXV0aG9yaXphdGlvbiBjb2RlJztcclxuICAgIHdpbnN0b24ubG9nKCAnZXJyb3InLCBlcnIgKTtcclxuICAgIHJlcy5zdGF0dXMoIDQwMSApO1xyXG4gICAgcmVzLnNlbmQoIGVyciApO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgYnJhbmNoID0gcmVxLmJvZHlbIGNvbnN0YW50cy5CUkFOQ0hfS0VZIF0gfHwgJ21hc3Rlcic7XHJcbiAgY29uc3QgYnJhbmRzID0gcmVxLmJvZHlbIGNvbnN0YW50cy5CUkFORFNfS0VZIF0gfHwgJ3BoZXQnO1xyXG4gIGNvbnN0IGVtYWlsID0gcmVxLmJvZHlbIGNvbnN0YW50cy5FTUFJTF9LRVkgXSB8fCBudWxsO1xyXG4gIGNvbnN0IHNpbXVsYXRpb24gPSByZXEuYm9keVsgY29uc3RhbnRzLlNJTV9OQU1FX0tFWSBdIHx8IG51bGw7XHJcbiAgY29uc3QgdmVyc2lvbiA9IHJlcS5ib2R5WyBjb25zdGFudHMuVkVSU0lPTl9LRVkgXSB8fCBudWxsO1xyXG4gIGNvbnN0IGVtYWlsQm9keVRleHQgPSAnTm90IGltcGxlbWVudGVkJztcclxuXHJcbiAgdGFza1F1ZXVlLnB1c2goXHJcbiAgICB7XHJcbiAgICAgIGRlcGxveUltYWdlczogdHJ1ZSxcclxuICAgICAgYnJhbmNoOiBicmFuY2gsXHJcbiAgICAgIGJyYW5kczogYnJhbmRzLFxyXG4gICAgICBzaW11bGF0aW9uOiBzaW11bGF0aW9uLFxyXG4gICAgICB2ZXJzaW9uOiB2ZXJzaW9uXHJcbiAgICB9LFxyXG4gICAgZXJyID0+IHtcclxuICAgICAgaWYgKCBlcnIgKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gYEltYWdlIGRlcGxveSBmYWlsdXJlOiAke2Vycn1gO1xyXG4gICAgICAgIHdpbnN0b24ubG9nKCAnZXJyb3InLCBlcnJvck1lc3NhZ2UgKTtcclxuICAgICAgICBzZW5kRW1haWwoICdJTUFHRSBERVBMT1kgRVJST1InLCBlcnJvck1lc3NhZ2UsIGVtYWlsICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgd2luc3Rvbi5sb2coICdpbmZvJywgJ0ltYWdlIGRlcGxveSBmaW5pc2hlZCBzdWNjZXNzZnVsbHknICk7XHJcbiAgICAgICAgc2VuZEVtYWlsKCAnSW1hZ2UgZGVwbG95IHN1Y2NlZWRlZCcsIGVtYWlsQm9keVRleHQsIGVtYWlsLCB0cnVlICk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgcmVzLnN0YXR1cyggMjAyICk7XHJcbiAgcmVzLnNlbmQoICdidWlsZCBwcm9jZXNzIGluaXRpYXRlZCwgY2hlY2sgbG9ncyBmb3IgZGV0YWlscycgKTtcclxufTtcclxuXHJcbi8vIENyZWF0ZSB0aGUgRXhwcmVzc0pTIGFwcFxyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcblxyXG4vLyB0byBzdXBwb3J0IEpTT04tZW5jb2RlZCBib2RpZXNcclxuYXBwLnVzZSggYm9keVBhcnNlci5qc29uKCkgKTtcclxuXHJcbi8vIGFkZCB0aGUgcm91dGUgdG8gYnVpbGQgYW5kIGRlcGxveVxyXG5hcHAuZ2V0KCAnL2RlcGxveS1odG1sLXNpbXVsYXRpb24nLCBnZXRRdWV1ZURlcGxveSApO1xyXG5hcHAucG9zdCggJy9kZXBsb3ktaHRtbC1zaW11bGF0aW9uJywgcG9zdFF1ZXVlRGVwbG95ICk7XHJcbmFwcC5wb3N0KCAnL2RlcGxveS1pbWFnZXMnLCBwb3N0UXVldWVJbWFnZURlcGxveSApO1xyXG5cclxuLy8gc3RhcnQgdGhlIHNlcnZlclxyXG5hcHAubGlzdGVuKCBjb25zdGFudHMuTElTVEVOX1BPUlQsICgpID0+IHtcclxuICB3aW5zdG9uLmxvZyggJ2luZm8nLCBgTGlzdGVuaW5nIG9uIHBvcnQgJHtjb25zdGFudHMuTElTVEVOX1BPUlR9YCApO1xyXG4gIHdpbnN0b24ubG9nKCAnaW5mbycsIGBWZXJib3NlIG1vZGU6ICR7dmVyYm9zZX1gICk7XHJcblxyXG4gIC8vIGxvZyB0aGUgU0hBIG9mIHBlcmVubmlhbCAtIHRoaXMgbWF5IG1ha2UgaXQgZWFzaWVyIHRvIGR1cGxpY2F0ZSBhbmQgdHJhY2sgZG93biBwcm9ibGVtc1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzaGEgPSBjaGlsZFByb2Nlc3MuZXhlY1N5bmMoICdnaXQgcmV2LXBhcnNlIEhFQUQnICk7XHJcbiAgICB3aW5zdG9uLmluZm8oIGBjdXJyZW50IFNIQTogJHtzaGEudG9TdHJpbmcoKX1gICk7XHJcbiAgfVxyXG4gIGNhdGNoKCBlcnIgKSB7XHJcbiAgICB3aW5zdG9uLndhcm4oIGB1bmFibGUgdG8gZ2V0IFNIQSBmcm9tIGdpdCwgZXJyOiAke2Vycn1gICk7XHJcbiAgfVxyXG5cclxuICAvLyBSZWNyZWF0ZSBxdWV1ZVxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBxdWV1ZSA9IHBlcnNpc3RlbnRRdWV1ZS5nZXRRdWV1ZSgpO1xyXG4gICAgZm9yICggY29uc3QgdGFzayBvZiBxdWV1ZSApIHtcclxuICAgICAgY29uc29sZS5sb2coICdSZXN1bWluZyB0YXNrIGZyb20gcGVyc2lzdGVudCBxdWV1ZTogJywgdGFzayApO1xyXG4gICAgICB0YXNrUXVldWUucHVzaCggdGFzaywgYnVpbGRDYWxsYmFjayggdGFzayApICk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNhdGNoKCBlICkge1xyXG4gICAgY29uc29sZS5lcnJvciggJ2NvdWxkIG5vdCByZXN1bWUgcXVldWUnICk7XHJcbiAgfVxyXG59ICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQSxNQUFNQSxTQUFTLEdBQUdDLE9BQU8sQ0FBRSxhQUFjLENBQUM7QUFDMUMsTUFBTUMsWUFBWSxHQUFHRCxPQUFPLENBQUUsZUFBZ0IsQ0FBQyxDQUFDLENBQUM7QUFDakQsTUFBTUUsT0FBTyxHQUFHRixPQUFPLENBQUUsVUFBVyxDQUFDLENBQUMsQ0FBQztBQUN2QyxNQUFNRyxVQUFVLEdBQUdILE9BQU8sQ0FBRSxjQUFlLENBQUM7QUFDNUMsTUFBTUksU0FBUyxHQUFHSixPQUFPLENBQUUsYUFBYyxDQUFDO0FBQzFDLE1BQU1LLFVBQVUsR0FBR0wsT0FBTyxDQUFFLGNBQWUsQ0FBQztBQUM1QyxNQUFNTSxLQUFLLEdBQUdOLE9BQU8sQ0FBRSxPQUFRLENB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