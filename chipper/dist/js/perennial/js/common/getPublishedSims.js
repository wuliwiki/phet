// Copyright 2022, University of Colorado Boulder

/**
 * Returns a list of simulation repos that have been published (does NOT include prototypes)
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

const simMetadata = require('./simMetadata');
const simPhetioMetadata = require('./simPhetioMetadata');
const _ = require('lodash');

/**
 * Returns a list of simulation repos that have been published (does NOT include prototypes)
 * @public
 *
 * @returns {Promise<Array.<string>>}
 */
module.exports = async function () {
  const publishedRepos = [];
  const metadata = await simMetadata({
    includePrototypes: false
  });
  metadata.projects.forEach(projectData => {
    if (projectData.name.startsWith('html/')) {
      publishedRepos.push(projectData.name.substring('html/'.length));
    }
  });
  (await simPhetioMetadata({
    active: true,
    latest: true
  })).filter(simData => simData.active && simData.latest).forEach(simData => {
    publishedRepos.push(simData.name);
  });
  return _.uniq(publishedRepos).sort();
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzaW1NZXRhZGF0YSIsInJlcXVpcmUiLCJzaW1QaGV0aW9NZXRhZGF0YSIsIl8iLCJtb2R1bGUiLCJleHBvcnRzIiwicHVibGlzaGVkUmVwb3MiLCJtZXRhZGF0YSIsImluY2x1ZGVQcm90b3R5cGVzIiwicHJvamVjdHMiLCJmb3JFYWNoIiwicHJvamVjdERhdGEiLCJuYW1lIiwic3RhcnRzV2l0aCIsInB1c2giLCJzdWJzdHJpbmciLCJsZW5ndGgiLCJhY3RpdmUiLCJsYXRlc3QiLCJmaWx0ZXIiLCJzaW1EYXRhIiwidW5pcSIsInNvcnQiXSwic291cmNlcyI6WyJnZXRQdWJsaXNoZWRTaW1zLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgbGlzdCBvZiBzaW11bGF0aW9uIHJlcG9zIHRoYXQgaGF2ZSBiZWVuIHB1Ymxpc2hlZCAoZG9lcyBOT1QgaW5jbHVkZSBwcm90b3R5cGVzKVxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuY29uc3Qgc2ltTWV0YWRhdGEgPSByZXF1aXJlKCAnLi9zaW1NZXRhZGF0YScgKTtcclxuY29uc3Qgc2ltUGhldGlvTWV0YWRhdGEgPSByZXF1aXJlKCAnLi9zaW1QaGV0aW9NZXRhZGF0YScgKTtcclxuY29uc3QgXyA9IHJlcXVpcmUoICdsb2Rhc2gnICk7XHJcblxyXG4vKipcclxuICogUmV0dXJucyBhIGxpc3Qgb2Ygc2ltdWxhdGlvbiByZXBvcyB0aGF0IGhhdmUgYmVlbiBwdWJsaXNoZWQgKGRvZXMgTk9UIGluY2x1ZGUgcHJvdG90eXBlcylcclxuICogQHB1YmxpY1xyXG4gKlxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxBcnJheS48c3RyaW5nPj59XHJcbiAqL1xyXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jIGZ1bmN0aW9uKCkge1xyXG4gIGNvbnN0IHB1Ymxpc2hlZFJlcG9zID0gW107XHJcblxyXG4gIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgc2ltTWV0YWRhdGEoIHtcclxuICAgIGluY2x1ZGVQcm90b3R5cGVzOiBmYWxzZVxyXG4gIH0gKTtcclxuICBtZXRhZGF0YS5wcm9qZWN0cy5mb3JFYWNoKCBwcm9qZWN0RGF0YSA9PiB7XHJcbiAgICBpZiAoIHByb2plY3REYXRhLm5hbWUuc3RhcnRzV2l0aCggJ2h0bWwvJyApICkge1xyXG4gICAgICBwdWJsaXNoZWRSZXBvcy5wdXNoKCBwcm9qZWN0RGF0YS5uYW1lLnN1YnN0cmluZyggJ2h0bWwvJy5sZW5ndGggKSApO1xyXG4gICAgfVxyXG4gIH0gKTtcclxuXHJcbiAgKCBhd2FpdCBzaW1QaGV0aW9NZXRhZGF0YSgge1xyXG4gICAgYWN0aXZlOiB0cnVlLFxyXG4gICAgbGF0ZXN0OiB0cnVlXHJcbiAgfSApICkuZmlsdGVyKCBzaW1EYXRhID0+IHNpbURhdGEuYWN0aXZlICYmIHNpbURhdGEubGF0ZXN0ICkuZm9yRWFjaCggc2ltRGF0YSA9PiB7XHJcbiAgICBwdWJsaXNoZWRSZXBvcy5wdXNoKCBzaW1EYXRhLm5hbWUgKTtcclxuICB9ICk7XHJcblxyXG4gIHJldHVybiBfLnVuaXEoIHB1Ymxpc2hlZFJlcG9zICkuc29ydCgpO1xyXG59O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsV0FBVyxHQUFHQyxPQUFPLENBQUUsZUFBZ0IsQ0FBQztBQUM5QyxNQUFNQyxpQkFBaUIsR0FBR0QsT0FBTyxDQUFFLHFCQUFzQixDQUFDO0FBQzFELE1BQU1FLENBQUMsR0FBR0YsT0FBTyxDQUFFLFFBQVMsQ0FBQzs7QUFFN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0FHLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHLGtCQUFpQjtFQUNoQyxNQUFNQyxjQUFjLEdBQUcsRUFBRTtFQUV6QixNQUFNQyxRQUFRLEdBQUcsTUFBTVAsV0FBVyxDQUFFO0lBQ2xDUSxpQkFBaUIsRUFBRTtFQUNyQixDQUFFLENBQUM7RUFDSEQsUUFBUSxDQUFDRSxRQUFRLENBQUNDLE9BQU8sQ0FBRUMsV0FBVyxJQUFJO0lBQ3hDLElBQUtBLFdBQVcsQ0FBQ0MsSUFBSSxDQUFDQyxVQUFVLENBQUUsT0FBUSxDQUFDLEVBQUc7TUFDNUNQLGNBQWMsQ0FBQ1EsSUFBSSxDQUFFSCxXQUFXLENBQUNDLElBQUksQ0FBQ0csU0FBUyxDQUFFLE9BQU8sQ0FBQ0MsTUFBTyxDQUFFLENBQUM7SUFDckU7RUFDRixDQUFFLENBQUM7RUFFSCxDQUFFLE1BQU1kLGlCQUFpQixDQUFFO0lBQ3pCZSxNQUFNLEVBQUUsSUFBSTtJQUNaQyxNQUFNLEVBQUU7RUFDVixDQUFFLENBQUMsRUFBR0MsTUFBTSxDQUFFQyxPQUFPLElBQUlBLE9BQU8sQ0FBQ0gsTUFBTSxJQUFJRyxPQUFPLENBQUNGLE1BQU8sQ0FBQyxDQUFDUixPQUFPLENBQUVVLE9BQU8sSUFBSTtJQUM5RWQsY0FBYyxDQUFDUSxJQUFJLENBQUVNLE9BQU8sQ0FBQ1IsSUFBSyxDQUFDO0VBQ3JDLENBQUUsQ0FBQztFQUVILE9BQU9ULENBQUMsQ0FBQ2tCLElBQUksQ0FBRWYsY0FBZSxDQUFDLENBQUNnQixJQUFJLENBQUMsQ0FBQztBQUN4QyxDQUFDIn0=