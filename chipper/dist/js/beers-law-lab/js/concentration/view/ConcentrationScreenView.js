// Copyright 2013-2023, University of Colorado Boulder

/**
 * View for the 'Concentration' screen.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Multilink from '../../../../axon/js/Multilink.js';
import Bounds2 from '../../../../dot/js/Bounds2.js';
import ScreenView from '../../../../joist/js/ScreenView.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import { Node } from '../../../../scenery/js/imports.js';
import EyeDropperNode from '../../../../scenery-phet/js/EyeDropperNode.js';
import beersLawLab from '../../beersLawLab.js';
import BLLConstants from '../../common/BLLConstants.js';
import BeakerNode from './BeakerNode.js';
import BLLDropperNode from './BLLDropperNode.js';
import BLLFaucetNode from './BLLFaucetNode.js';
import ConcentrationMeterNode from './ConcentrationMeterNode.js';
import EvaporationPanel from './EvaporationPanel.js';
import FaucetFluidNode from './FaucetFluidNode.js';
import PrecipitateParticlesNode from './PrecipitateParticlesNode.js';
import RemoveSoluteButton from './RemoveSoluteButton.js';
import SaturatedIndicator from './SaturatedIndicator.js';
import ShakerNode from './ShakerNode.js';
import ShakerParticlesNode from './ShakerParticlesNode.js';
import SoluteAmountText from './SoluteAmountText.js';
import SolutePanel from './SolutePanel.js';
import SolutionNode from './SolutionNode.js';
import StockSolutionNode from './StockSolutionNode.js';
import SolutionVolumeNode from './SolutionVolumeNode.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import StringIO from '../../../../tandem/js/types/StringIO.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
export default class ConcentrationScreenView extends ScreenView {
  constructor(model, modelViewTransform, tandem) {
    super({
      // Workaround for things shifting around while dragging.
      // See https://github.com/phetsims/scenery/issues/1289 and https://github.com/phetsims/beers-law-lab/issues/299.
      preventFit: true,
      layoutBounds: BLLConstants.LAYOUT_BOUNDS,
      tandem: tandem
    });

    // Beaker and stuff inside it
    const beakerNode = new BeakerNode(model.beaker, modelViewTransform, {
      tandem: tandem.createTandem('beakerNode')
    });
    const solutionNode = new SolutionNode(model.solution, model.beaker, modelViewTransform);
    const solutionVolumeNode = new SolutionVolumeNode(model.solution.volumeProperty, {
      tandem: tandem.createTandem('solutionVolumeNode')
    });
    Multilink.multilink([solutionNode.boundsProperty, solutionVolumeNode.boundsProperty], () => {
      solutionVolumeNode.right = beakerNode.centerX + model.beaker.size.width / 2;
      solutionVolumeNode.y = solutionNode.top + BLLConstants.SOLUTION_LINE_WIDTH / 2;
    });

    // PrecipitateParticles particles are drawn using canvas. Specify bounds of the canvas (smaller for speed).
    const precipitateParticlesNode = new PrecipitateParticlesNode(model.precipitateParticles, modelViewTransform, new Bounds2(modelViewTransform.modelToViewX(model.beaker.left), modelViewTransform.modelToViewY(model.beaker.position.y) - 100, modelViewTransform.modelToViewX(model.beaker.right), modelViewTransform.modelToViewY(model.beaker.position.y)));
    const saturatedIndicator = new SaturatedIndicator(model.solution.isSaturatedProperty, tandem.createTandem('saturatedIndicator'));

    // Label for the shaker and dropper. If formula is null, use the solute name.
    const soluteLabelStringProperty = DerivedProperty.deriveAny([model.shaker.soluteProperty, ...model.solutes.map(solute => solute.formulaProperty), ...model.solutes.map(solute => solute.nameProperty)], () => {
      const solute = model.shaker.soluteProperty.value;
      const formula = solute.formulaProperty.value;
      const name = solute.nameProperty.value;
      return formula ? StringUtils.wrapLTR(formula) : name;
    }, {
      tandem: tandem.createTandem('soluteLabelStringProperty'),
      phetioValueType: StringIO,
      phetioDocumentation: 'The label used on the shaker and dropper'
    });

    // Shaker
    const shakerNode = new ShakerNode(model.shaker, soluteLabelStringProperty, modelViewTransform, {
      tandem: tandem.createTandem('shakerNode')
    });

    // Shaker particles are drawn using canvas. Specify bounds of the canvas (smaller for speed).
    const shakerParticlesNode = new ShakerParticlesNode(model.shakerParticles, modelViewTransform, new Bounds2(modelViewTransform.modelToViewX(model.beaker.left), this.layoutBounds.minY, modelViewTransform.modelToViewX(model.beaker.right), modelViewTransform.modelToViewY(model.beaker.position.y)));

    // Dropper
    const dropperNode = new BLLDropperNode(model.dropper, soluteLabelStringProperty, model.solution.solvent, model.solution.soluteProperty, modelViewTransform, {
      tandem: tandem.createTandem('dropperNode')
    });
    const stockSolutionNode = new StockSolutionNode(model.solution.solvent, model.soluteProperty, model.dropper, model.beaker, EyeDropperNode.TIP_WIDTH - 1, modelViewTransform);

    // faucets
    const solventFaucetNode = new BLLFaucetNode(model.solventFaucet, modelViewTransform, {
      tandem: tandem.createTandem('solventFaucetNode')
    });
    const drainFaucetNode = new BLLFaucetNode(model.drainFaucet, modelViewTransform, {
      tandem: tandem.createTandem('drainFaucetNode')
    });
    const SOLVENT_FLUID_HEIGHT = model.beaker.position.y - model.solventFaucet.position.y;
    const DRAIN_FLUID_HEIGHT = 1000; // tall enough that resizing the play area is unlikely to show bottom of fluid
    const solventFluidNode = new FaucetFluidNode(model.solventFaucet, model.solution.solvent, SOLVENT_FLUID_HEIGHT, modelViewTransform);
    const drainFluidNode = new FaucetFluidNode(model.drainFaucet, model.solution, DRAIN_FLUID_HEIGHT, modelViewTransform);

    // Concentration meter
    const concentrationMeterNode = new ConcentrationMeterNode(model.concentrationMeter, model.solution, model.dropper, solutionNode, stockSolutionNode, solventFluidNode, drainFluidNode, modelViewTransform, {
      tandem: tandem.createTandem('concentrationMeterNode')
    });

    // Solute controls
    const soluteListParent = new Node();
    const solutePanel = new SolutePanel(model.solutes, model.soluteProperty, model.soluteFormProperty, model.shaker, model.dropper, soluteListParent, {
      tandem: tandem.createTandem('solutePanel')
    });

    // Evaporation panel
    const evaporationPanel = new EvaporationPanel(model.evaporator, {
      tandem: tandem.createTandem('evaporationPanel')
    });

    // Solute amount, in grams
    const soluteAmountText = new SoluteAmountText(model.solution.soluteGramsProperty, {
      tandem: tandem.createTandem('soluteAmountText')
    });

    // Remove Solute button
    const removeSoluteButton = new RemoveSoluteButton(model.solution, model.shakerParticles, {
      tandem: tandem.createTandem('removeSoluteButton')
    });

    // Reset All button
    const resetAllButton = new ResetAllButton({
      listener: () => {
        this.interruptSubtreeInput(); // cancel interactions that may be in progress
        model.reset();
      },
      scale: 1.32,
      tandem: tandem.createTandem('resetAllButton')
    });

    // Rendering order
    const screenViewRootNode = new Node({
      children: [solventFluidNode, solventFaucetNode, drainFluidNode, drainFaucetNode, stockSolutionNode, solutionNode, solutionVolumeNode, beakerNode.mutate({
        layerSplit: true
      }),
      // beaker is static, put in its own layer
      precipitateParticlesNode, saturatedIndicator, shakerParticlesNode, shakerNode, dropperNode, evaporationPanel, soluteAmountText, removeSoluteButton, resetAllButton, solutePanel, concentrationMeterNode, soluteListParent // last, so that combo box list is on top
      ]
    });

    this.addChild(screenViewRootNode);

    // Center 'Saturated' at centerBottom of beaker.
    saturatedIndicator.boundsProperty.link(() => {
      saturatedIndicator.centerX = beakerNode.centerX;
      saturatedIndicator.bottom = beakerNode.bottom - 30;
    });

    // upper right
    solutePanel.right = this.layoutBounds.right - 20;
    solutePanel.top = this.layoutBounds.top + 20;

    // left-aligned below beaker
    evaporationPanel.left = modelViewTransform.modelToViewPosition(model.beaker.position).x - modelViewTransform.modelToViewDeltaX(model.beaker.size.width / 2);
    evaporationPanel.top = beakerNode.bottom + 30;
    Multilink.multilink([soluteAmountText.visibleProperty, evaporationPanel.boundsProperty, removeSoluteButton.boundsProperty, soluteAmountText.boundsProperty], () => {
      if (soluteAmountText.visible) {
        // bottom aligned with evaporator
        removeSoluteButton.left = evaporationPanel.right + 30;
        removeSoluteButton.bottom = evaporationPanel.bottom;
        //  above button
        soluteAmountText.left = removeSoluteButton.left;
        soluteAmountText.bottom = removeSoluteButton.top - 20;
      } else {
        // left of evaporation control
        removeSoluteButton.left = evaporationPanel.right + 30;
        removeSoluteButton.centerY = evaporationPanel.centerY;
      }
    });

    // bottom right
    resetAllButton.right = this.layoutBounds.right - 30;
    resetAllButton.bottom = this.layoutBounds.bottom - 30;
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
}
beersLawLab.register('ConcentrationScreenView', ConcentrationScreenView);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aWxpbmsiLCJCb3VuZHMyIiwiU2NyZWVuVmlldyIsIlJlc2V0QWxsQnV0dG9uIiwiTm9kZSIsIkV5ZURyb3BwZXJOb2RlIiwiYmVlcnNMYXdMYWIiLCJCTExDb25zdGFudHMiLCJCZWFrZXJOb2RlIiwiQkxMRHJvcHBlck5vZGUiLCJCTExGYXVjZXROb2RlIiwiQ29uY2VudHJhdGlvbk1ldGVyTm9kZSIsIkV2YXBvcmF0aW9uUGFuZWwiLCJGYXVjZXRGbHVpZE5vZGUiLCJQcmVjaXBpdGF0ZVBhcnRpY2xlc05vZGUiLCJSZW1vdmVTb2x1dGVCdXR0b24iLCJTYXR1cmF0ZWRJbmRpY2F0b3IiLCJTaGFrZXJOb2RlIiwiU2hha2VyUGFydGljbGVzTm9kZSIsIlNvbHV0ZUFtb3VudFRleHQiLCJTb2x1dGVQYW5lbCIsIlNvbHV0aW9uTm9kZSIsIlN0b2NrU29sdXRpb25Ob2RlIiwiU29sdXRpb25Wb2x1bWVOb2RlIiwiRGVyaXZlZFByb3BlcnR5IiwiU3RyaW5nSU8iLCJTdHJpbmdVdGlscyIsIkNvbmNlbnRyYXRpb25TY3JlZW5WaWV3IiwiY29uc3RydWN0b3IiLCJtb2RlbCIsIm1vZGVsVmlld1RyYW5zZm9ybSIsInRhbmRlbSIsInByZXZlbnRGaXQiLCJsYXlvdXRCb3VuZHMiLCJMQVlPVVRfQk9VTkRTIiwiYmVha2VyTm9kZSIsImJlYWtlciIsImNyZWF0ZVRhbmRlbSIsInNvbHV0aW9uTm9kZSIsInNvbHV0aW9uIiwic29sdXRpb25Wb2x1bWVOb2RlIiwidm9sdW1lUHJvcGVydHkiLCJtdWx0aWxpbmsiLCJib3VuZHNQcm9wZXJ0eSIsInJpZ2h0IiwiY2VudGVyWCIsInNpemUiLCJ3aWR0aCIsInkiLCJ0b3AiLCJTT0xVVElPTl9MSU5FX1dJRFRIIiwicHJlY2lwaXRhdGVQYXJ0aWNsZXNOb2RlIiwicHJlY2lwaXRhdGVQYXJ0aWNsZXMiLCJtb2RlbFRvVmlld1giLCJsZWZ0IiwibW9kZWxUb1ZpZXdZIiwicG9zaXRpb24iLCJzYXR1cmF0ZWRJbmRpY2F0b3IiLCJpc1NhdHVyYXRlZFByb3BlcnR5Iiwic29sdXRlTGFiZWxTdHJpbmdQcm9wZXJ0eSIsImRlcml2ZUFueSIsInNoYWtlciIsInNvbHV0ZVByb3BlcnR5Iiwic29sdXRlcyIsIm1hcCIsInNvbHV0ZSIsImZvcm11bGFQcm9wZXJ0eSIsIm5hbWVQcm9wZXJ0eSIsInZhbHVlIiwiZm9ybXVsYSIsIm5hbWUiLCJ3cmFwTFRSIiwicGhldGlvVmFsdWVUeXBlIiwicGhldGlvRG9jdW1lbnRhdGlvbiIsInNoYWtlck5vZGUiLCJzaGFrZXJQYXJ0aWNsZXNOb2RlIiwic2hha2VyUGFydGljbGVzIiwibWluWSIsImRyb3BwZXJOb2RlIiwiZHJvcHBlciIsInNvbHZlbnQiLCJzdG9ja1NvbHV0aW9uTm9kZSIsIlRJUF9XSURUSCIsInNvbHZlbnRGYXVjZXROb2RlIiwic29sdmVudEZhdWNldCIsImRyYWluRmF1Y2V0Tm9kZSIsImRyYWluRmF1Y2V0IiwiU09MVkVOVF9GTFVJRF9IRUlHSFQiLCJEUkFJTl9GTFVJRF9IRUlHSFQiLCJzb2x2ZW50Rmx1aWROb2RlIiwiZHJhaW5GbHVpZE5vZGUiLCJjb25jZW50cmF0aW9uTWV0ZXJOb2RlIiwiY29uY2VudHJhdGlvbk1ldGVyIiwic29sdXRlTGlzdFBhcmVudCIsInNvbHV0ZVBhbmVsIiwic29sdXRlRm9ybVByb3BlcnR5IiwiZXZhcG9yYXRpb25QYW5lbCIsImV2YXBvcmF0b3IiLCJzb2x1dGVBbW91bnRUZXh0Iiwic29sdXRlR3JhbXNQcm9wZXJ0eSIsInJlbW92ZVNvbHV0ZUJ1dHRvbiIsInJlc2V0QWxsQnV0dG9uIiwibGlzdGVuZXIiLCJpbnRlcnJ1cHRTdWJ0cmVlSW5wdXQiLCJyZXNldCIsInNjYWxlIiwic2NyZWVuVmlld1Jvb3ROb2RlIiwiY2hpbGRyZW4iLCJtdXRhdGUiLCJsYXllclNwbGl0IiwiYWRkQ2hpbGQiLCJsaW5rIiwiYm90dG9tIiwibW9kZWxUb1ZpZXdQb3NpdGlvbiIsIngiLCJtb2RlbFRvVmlld0RlbHRhWCIsInZpc2libGVQcm9wZXJ0eSIsInZpc2libGUiLCJjZW50ZXJZIiwiZGlzcG9zZSIsImFzc2VydCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQ29uY2VudHJhdGlvblNjcmVlblZpZXcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTMtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogVmlldyBmb3IgdGhlICdDb25jZW50cmF0aW9uJyBzY3JlZW4uXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IE11bHRpbGluayBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL011bHRpbGluay5qcyc7XHJcbmltcG9ydCBCb3VuZHMyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9Cb3VuZHMyLmpzJztcclxuaW1wb3J0IFNjcmVlblZpZXcgZnJvbSAnLi4vLi4vLi4vLi4vam9pc3QvanMvU2NyZWVuVmlldy5qcyc7XHJcbmltcG9ydCBNb2RlbFZpZXdUcmFuc2Zvcm0yIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdmlldy9Nb2RlbFZpZXdUcmFuc2Zvcm0yLmpzJztcclxuaW1wb3J0IFJlc2V0QWxsQnV0dG9uIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9idXR0b25zL1Jlc2V0QWxsQnV0dG9uLmpzJztcclxuaW1wb3J0IHsgTm9kZSB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBFeWVEcm9wcGVyTm9kZSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvRXllRHJvcHBlck5vZGUuanMnO1xyXG5pbXBvcnQgYmVlcnNMYXdMYWIgZnJvbSAnLi4vLi4vYmVlcnNMYXdMYWIuanMnO1xyXG5pbXBvcnQgQkxMQ29uc3RhbnRzIGZyb20gJy4uLy4uL2NvbW1vbi9CTExDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgQ29uY2VudHJhdGlvbk1vZGVsIGZyb20gJy4uL21vZGVsL0NvbmNlbnRyYXRpb25Nb2RlbC5qcyc7XHJcbmltcG9ydCBCZWFrZXJOb2RlIGZyb20gJy4vQmVha2VyTm9kZS5qcyc7XHJcbmltcG9ydCBCTExEcm9wcGVyTm9kZSBmcm9tICcuL0JMTERyb3BwZXJOb2RlLmpzJztcclxuaW1wb3J0IEJMTEZhdWNldE5vZGUgZnJvbSAnLi9CTExGYXVjZXROb2RlLmpzJztcclxuaW1wb3J0IENvbmNlbnRyYXRpb25NZXRlck5vZGUgZnJvbSAnLi9Db25jZW50cmF0aW9uTWV0ZXJOb2RlLmpzJztcclxuaW1wb3J0IEV2YXBvcmF0aW9uUGFuZWwgZnJvbSAnLi9FdmFwb3JhdGlvblBhbmVsLmpzJztcclxuaW1wb3J0IEZhdWNldEZsdWlkTm9kZSBmcm9tICcuL0ZhdWNldEZsdWlkTm9kZS5qcyc7XHJcbmltcG9ydCBQcmVjaXBpdGF0ZVBhcnRpY2xlc05vZGUgZnJvbSAnLi9QcmVjaXBpdGF0ZVBhcnRpY2xlc05vZGUuanMnO1xyXG5pbXBvcnQgUmVtb3ZlU29sdXRlQnV0dG9uIGZyb20gJy4vUmVtb3ZlU29sdXRlQnV0dG9uLmpzJztcclxuaW1wb3J0IFNhdHVyYXRlZEluZGljYXRvciBmcm9tICcuL1NhdHVyYXRlZEluZGljYXRvci5qcyc7XHJcbmltcG9ydCBTaGFrZXJOb2RlIGZyb20gJy4vU2hha2VyTm9kZS5qcyc7XHJcbmltcG9ydCBTaGFrZXJQYXJ0aWNsZXNOb2RlIGZyb20gJy4vU2hha2VyUGFydGljbGVzTm9kZS5qcyc7XHJcbmltcG9ydCBTb2x1dGVBbW91bnRUZXh0IGZyb20gJy4vU29sdXRlQW1vdW50VGV4dC5qcyc7XHJcbmltcG9ydCBTb2x1dGVQYW5lbCBmcm9tICcuL1NvbHV0ZVBhbmVsLmpzJztcclxuaW1wb3J0IFNvbHV0aW9uTm9kZSBmcm9tICcuL1NvbHV0aW9uTm9kZS5qcyc7XHJcbmltcG9ydCBTdG9ja1NvbHV0aW9uTm9kZSBmcm9tICcuL1N0b2NrU29sdXRpb25Ob2RlLmpzJztcclxuaW1wb3J0IFNvbHV0aW9uVm9sdW1lTm9kZSBmcm9tICcuL1NvbHV0aW9uVm9sdW1lTm9kZS5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgU3RyaW5nSU8gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL1N0cmluZ0lPLmpzJztcclxuaW1wb3J0IFN0cmluZ1V0aWxzIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdXRpbC9TdHJpbmdVdGlscy5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb25jZW50cmF0aW9uU2NyZWVuVmlldyBleHRlbmRzIFNjcmVlblZpZXcge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIG1vZGVsOiBDb25jZW50cmF0aW9uTW9kZWwsIG1vZGVsVmlld1RyYW5zZm9ybTogTW9kZWxWaWV3VHJhbnNmb3JtMiwgdGFuZGVtOiBUYW5kZW0gKSB7XHJcblxyXG4gICAgc3VwZXIoIHtcclxuXHJcbiAgICAgIC8vIFdvcmthcm91bmQgZm9yIHRoaW5ncyBzaGlmdGluZyBhcm91bmQgd2hpbGUgZHJhZ2dpbmcuXHJcbiAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvc2NlbmVyeS9pc3N1ZXMvMTI4OSBhbmQgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2JlZXJzLWxhdy1sYWIvaXNzdWVzLzI5OS5cclxuICAgICAgcHJldmVudEZpdDogdHJ1ZSxcclxuICAgICAgbGF5b3V0Qm91bmRzOiBCTExDb25zdGFudHMuTEFZT1VUX0JPVU5EUyxcclxuICAgICAgdGFuZGVtOiB0YW5kZW1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBCZWFrZXIgYW5kIHN0dWZmIGluc2lkZSBpdFxyXG4gICAgY29uc3QgYmVha2VyTm9kZSA9IG5ldyBCZWFrZXJOb2RlKCBtb2RlbC5iZWFrZXIsIG1vZGVsVmlld1RyYW5zZm9ybSwge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdiZWFrZXJOb2RlJyApXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBzb2x1dGlvbk5vZGUgPSBuZXcgU29sdXRpb25Ob2RlKCBtb2RlbC5zb2x1dGlvbiwgbW9kZWwuYmVha2VyLCBtb2RlbFZpZXdUcmFuc2Zvcm0gKTtcclxuICAgIGNvbnN0IHNvbHV0aW9uVm9sdW1lTm9kZSA9IG5ldyBTb2x1dGlvblZvbHVtZU5vZGUoIG1vZGVsLnNvbHV0aW9uLnZvbHVtZVByb3BlcnR5LCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NvbHV0aW9uVm9sdW1lTm9kZScgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIE11bHRpbGluay5tdWx0aWxpbmsoIFsgc29sdXRpb25Ob2RlLmJvdW5kc1Byb3BlcnR5LCBzb2x1dGlvblZvbHVtZU5vZGUuYm91bmRzUHJvcGVydHkgXSxcclxuICAgICAgKCkgPT4ge1xyXG4gICAgICAgIHNvbHV0aW9uVm9sdW1lTm9kZS5yaWdodCA9IGJlYWtlck5vZGUuY2VudGVyWCArIG1vZGVsLmJlYWtlci5zaXplLndpZHRoIC8gMjtcclxuICAgICAgICBzb2x1dGlvblZvbHVtZU5vZGUueSA9IHNvbHV0aW9uTm9kZS50b3AgKyBCTExDb25zdGFudHMuU09MVVRJT05fTElORV9XSURUSCAvIDI7XHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAvLyBQcmVjaXBpdGF0ZVBhcnRpY2xlcyBwYXJ0aWNsZXMgYXJlIGRyYXduIHVzaW5nIGNhbnZhcy4gU3BlY2lmeSBib3VuZHMgb2YgdGhlIGNhbnZhcyAoc21hbGxlciBmb3Igc3BlZWQpLlxyXG4gICAgY29uc3QgcHJlY2lwaXRhdGVQYXJ0aWNsZXNOb2RlID0gbmV3IFByZWNpcGl0YXRlUGFydGljbGVzTm9kZSggbW9kZWwucHJlY2lwaXRhdGVQYXJ0aWNsZXMsIG1vZGVsVmlld1RyYW5zZm9ybSwgbmV3IEJvdW5kczIoXHJcbiAgICAgIG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1goIG1vZGVsLmJlYWtlci5sZWZ0ICksIG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIG1vZGVsLmJlYWtlci5wb3NpdGlvbi55ICkgLSAxMDAsXHJcbiAgICAgIG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1goIG1vZGVsLmJlYWtlci5yaWdodCApLCBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdZKCBtb2RlbC5iZWFrZXIucG9zaXRpb24ueSApICkgKTtcclxuICAgIGNvbnN0IHNhdHVyYXRlZEluZGljYXRvciA9IG5ldyBTYXR1cmF0ZWRJbmRpY2F0b3IoIG1vZGVsLnNvbHV0aW9uLmlzU2F0dXJhdGVkUHJvcGVydHksIHRhbmRlbS5jcmVhdGVUYW5kZW0oICdzYXR1cmF0ZWRJbmRpY2F0b3InICkgKTtcclxuXHJcbiAgICAvLyBMYWJlbCBmb3IgdGhlIHNoYWtlciBhbmQgZHJvcHBlci4gSWYgZm9ybXVsYSBpcyBudWxsLCB1c2UgdGhlIHNvbHV0ZSBuYW1lLlxyXG4gICAgY29uc3Qgc29sdXRlTGFiZWxTdHJpbmdQcm9wZXJ0eSA9IERlcml2ZWRQcm9wZXJ0eS5kZXJpdmVBbnkoIFtcclxuICAgICAgbW9kZWwuc2hha2VyLnNvbHV0ZVByb3BlcnR5LFxyXG4gICAgICAuLi5tb2RlbC5zb2x1dGVzLm1hcCggc29sdXRlID0+IHNvbHV0ZS5mb3JtdWxhUHJvcGVydHkgKSxcclxuICAgICAgLi4ubW9kZWwuc29sdXRlcy5tYXAoIHNvbHV0ZSA9PiBzb2x1dGUubmFtZVByb3BlcnR5IClcclxuICAgIF0sICgpID0+IHtcclxuICAgICAgY29uc3Qgc29sdXRlID0gbW9kZWwuc2hha2VyLnNvbHV0ZVByb3BlcnR5LnZhbHVlO1xyXG4gICAgICBjb25zdCBmb3JtdWxhID0gc29sdXRlLmZvcm11bGFQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgY29uc3QgbmFtZSA9IHNvbHV0ZS5uYW1lUHJvcGVydHkudmFsdWU7XHJcbiAgICAgIHJldHVybiBmb3JtdWxhID8gU3RyaW5nVXRpbHMud3JhcExUUiggZm9ybXVsYSApIDogbmFtZTtcclxuICAgIH0sIHtcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnc29sdXRlTGFiZWxTdHJpbmdQcm9wZXJ0eScgKSxcclxuICAgICAgcGhldGlvVmFsdWVUeXBlOiBTdHJpbmdJTyxcclxuICAgICAgcGhldGlvRG9jdW1lbnRhdGlvbjogJ1RoZSBsYWJlbCB1c2VkIG9uIHRoZSBzaGFrZXIgYW5kIGRyb3BwZXInXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gU2hha2VyXHJcbiAgICBjb25zdCBzaGFrZXJOb2RlID0gbmV3IFNoYWtlck5vZGUoIG1vZGVsLnNoYWtlciwgc29sdXRlTGFiZWxTdHJpbmdQcm9wZXJ0eSwgbW9kZWxWaWV3VHJhbnNmb3JtLCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NoYWtlck5vZGUnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBTaGFrZXIgcGFydGljbGVzIGFyZSBkcmF3biB1c2luZyBjYW52YXMuIFNwZWNpZnkgYm91bmRzIG9mIHRoZSBjYW52YXMgKHNtYWxsZXIgZm9yIHNwZWVkKS5cclxuICAgIGNvbnN0IHNoYWtlclBhcnRpY2xlc05vZGUgPSBuZXcgU2hha2VyUGFydGljbGVzTm9kZSggbW9kZWwuc2hha2VyUGFydGljbGVzLCBtb2RlbFZpZXdUcmFuc2Zvcm0sIG5ldyBCb3VuZHMyKFxyXG4gICAgICBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdYKCBtb2RlbC5iZWFrZXIubGVmdCApLCB0aGlzLmxheW91dEJvdW5kcy5taW5ZLFxyXG4gICAgICBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdYKCBtb2RlbC5iZWFrZXIucmlnaHQgKSwgbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WSggbW9kZWwuYmVha2VyLnBvc2l0aW9uLnkgKSApICk7XHJcblxyXG4gICAgLy8gRHJvcHBlclxyXG4gICAgY29uc3QgZHJvcHBlck5vZGUgPSBuZXcgQkxMRHJvcHBlck5vZGUoIG1vZGVsLmRyb3BwZXIsIHNvbHV0ZUxhYmVsU3RyaW5nUHJvcGVydHksIG1vZGVsLnNvbHV0aW9uLnNvbHZlbnQsXHJcbiAgICAgIG1vZGVsLnNvbHV0aW9uLnNvbHV0ZVByb3BlcnR5LCBtb2RlbFZpZXdUcmFuc2Zvcm0sIHtcclxuICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdkcm9wcGVyTm9kZScgKVxyXG4gICAgICB9ICk7XHJcbiAgICBjb25zdCBzdG9ja1NvbHV0aW9uTm9kZSA9IG5ldyBTdG9ja1NvbHV0aW9uTm9kZSggbW9kZWwuc29sdXRpb24uc29sdmVudCwgbW9kZWwuc29sdXRlUHJvcGVydHksIG1vZGVsLmRyb3BwZXIsXHJcbiAgICAgIG1vZGVsLmJlYWtlciwgRXllRHJvcHBlck5vZGUuVElQX1dJRFRIIC0gMSwgbW9kZWxWaWV3VHJhbnNmb3JtICk7XHJcblxyXG4gICAgLy8gZmF1Y2V0c1xyXG4gICAgY29uc3Qgc29sdmVudEZhdWNldE5vZGUgPSBuZXcgQkxMRmF1Y2V0Tm9kZSggbW9kZWwuc29sdmVudEZhdWNldCwgbW9kZWxWaWV3VHJhbnNmb3JtLCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NvbHZlbnRGYXVjZXROb2RlJyApXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBkcmFpbkZhdWNldE5vZGUgPSBuZXcgQkxMRmF1Y2V0Tm9kZSggbW9kZWwuZHJhaW5GYXVjZXQsIG1vZGVsVmlld1RyYW5zZm9ybSwge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdkcmFpbkZhdWNldE5vZGUnIClcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IFNPTFZFTlRfRkxVSURfSEVJR0hUID0gbW9kZWwuYmVha2VyLnBvc2l0aW9uLnkgLSBtb2RlbC5zb2x2ZW50RmF1Y2V0LnBvc2l0aW9uLnk7XHJcbiAgICBjb25zdCBEUkFJTl9GTFVJRF9IRUlHSFQgPSAxMDAwOyAvLyB0YWxsIGVub3VnaCB0aGF0IHJlc2l6aW5nIHRoZSBwbGF5IGFyZWEgaXMgdW5saWtlbHkgdG8gc2hvdyBib3R0b20gb2YgZmx1aWRcclxuICAgIGNvbnN0IHNvbHZlbnRGbHVpZE5vZGUgPSBuZXcgRmF1Y2V0Rmx1aWROb2RlKCBtb2RlbC5zb2x2ZW50RmF1Y2V0LCBtb2RlbC5zb2x1dGlvbi5zb2x2ZW50LCBTT0xWRU5UX0ZMVUlEX0hFSUdIVCwgbW9kZWxWaWV3VHJhbnNmb3JtICk7XHJcbiAgICBjb25zdCBkcmFpbkZsdWlkTm9kZSA9IG5ldyBGYXVjZXRGbHVpZE5vZGUoIG1vZGVsLmRyYWluRmF1Y2V0LCBtb2RlbC5zb2x1dGlvbiwgRFJBSU5fRkxVSURfSEVJR0hULCBtb2RlbFZpZXdUcmFuc2Zvcm0gKTtcclxuXHJcbiAgICAvLyBDb25jZW50cmF0aW9uIG1ldGVyXHJcbiAgICBjb25zdCBjb25jZW50cmF0aW9uTWV0ZXJOb2RlID0gbmV3IENvbmNlbnRyYXRpb25NZXRlck5vZGUoIG1vZGVsLmNvbmNlbnRyYXRpb25NZXRlciwgbW9kZWwuc29sdXRpb24sIG1vZGVsLmRyb3BwZXIsXHJcbiAgICAgIHNvbHV0aW9uTm9kZSwgc3RvY2tTb2x1dGlvbk5vZGUsIHNvbHZlbnRGbHVpZE5vZGUsIGRyYWluRmx1aWROb2RlLCBtb2RlbFZpZXdUcmFuc2Zvcm0sIHtcclxuICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdjb25jZW50cmF0aW9uTWV0ZXJOb2RlJyApXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAvLyBTb2x1dGUgY29udHJvbHNcclxuICAgIGNvbnN0IHNvbHV0ZUxpc3RQYXJlbnQgPSBuZXcgTm9kZSgpO1xyXG4gICAgY29uc3Qgc29sdXRlUGFuZWwgPSBuZXcgU29sdXRlUGFuZWwoIG1vZGVsLnNvbHV0ZXMsIG1vZGVsLnNvbHV0ZVByb3BlcnR5LCBtb2RlbC5zb2x1dGVGb3JtUHJvcGVydHksIG1vZGVsLnNoYWtlcixcclxuICAgICAgbW9kZWwuZHJvcHBlciwgc29sdXRlTGlzdFBhcmVudCwge1xyXG4gICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NvbHV0ZVBhbmVsJyApXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAvLyBFdmFwb3JhdGlvbiBwYW5lbFxyXG4gICAgY29uc3QgZXZhcG9yYXRpb25QYW5lbCA9IG5ldyBFdmFwb3JhdGlvblBhbmVsKCBtb2RlbC5ldmFwb3JhdG9yLCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2V2YXBvcmF0aW9uUGFuZWwnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBTb2x1dGUgYW1vdW50LCBpbiBncmFtc1xyXG4gICAgY29uc3Qgc29sdXRlQW1vdW50VGV4dCA9IG5ldyBTb2x1dGVBbW91bnRUZXh0KCBtb2RlbC5zb2x1dGlvbi5zb2x1dGVHcmFtc1Byb3BlcnR5LCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NvbHV0ZUFtb3VudFRleHQnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBSZW1vdmUgU29sdXRlIGJ1dHRvblxyXG4gICAgY29uc3QgcmVtb3ZlU29sdXRlQnV0dG9uID0gbmV3IFJlbW92ZVNvbHV0ZUJ1dHRvbiggbW9kZWwuc29sdXRpb24sIG1vZGVsLnNoYWtlclBhcnRpY2xlcywge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdyZW1vdmVTb2x1dGVCdXR0b24nIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBSZXNldCBBbGwgYnV0dG9uXHJcbiAgICBjb25zdCByZXNldEFsbEJ1dHRvbiA9IG5ldyBSZXNldEFsbEJ1dHRvbigge1xyXG4gICAgICBsaXN0ZW5lcjogKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuaW50ZXJydXB0U3VidHJlZUlucHV0KCk7IC8vIGNhbmNlbCBpbnRlcmFjdGlvbnMgdGhhdCBtYXkgYmUgaW4gcHJvZ3Jlc3NcclxuICAgICAgICBtb2RlbC5yZXNldCgpO1xyXG4gICAgICB9LFxyXG4gICAgICBzY2FsZTogMS4zMixcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAncmVzZXRBbGxCdXR0b24nIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBSZW5kZXJpbmcgb3JkZXJcclxuICAgIGNvbnN0IHNjcmVlblZpZXdSb290Tm9kZSA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgc29sdmVudEZsdWlkTm9kZSxcclxuICAgICAgICBzb2x2ZW50RmF1Y2V0Tm9kZSxcclxuICAgICAgICBkcmFpbkZsdWlkTm9kZSxcclxuICAgICAgICBkcmFpbkZhdWNldE5vZGUsXHJcbiAgICAgICAgc3RvY2tTb2x1dGlvbk5vZGUsXHJcbiAgICAgICAgc29sdXRpb25Ob2RlLFxyXG4gICAgICAgIHNvbHV0aW9uVm9sdW1lTm9kZSxcclxuICAgICAgICBiZWFrZXJOb2RlLm11dGF0ZSggeyBsYXllclNwbGl0OiB0cnVlIH0gKSwgLy8gYmVha2VyIGlzIHN0YXRpYywgcHV0IGluIGl0cyBvd24gbGF5ZXJcclxuICAgICAgICBwcmVjaXBpdGF0ZVBhcnRpY2xlc05vZGUsXHJcbiAgICAgICAgc2F0dXJhdGVkSW5kaWNhdG9yLFxyXG4gICAgICAgIHNoYWtlclBhcnRpY2xlc05vZGUsXHJcbiAgICAgICAgc2hha2VyTm9kZSxcclxuICAgICAgICBkcm9wcGVyTm9kZSxcclxuICAgICAgICBldmFwb3JhdGlvblBhbmVsLFxyXG4gICAgICAgIHNvbHV0ZUFtb3VudFRleHQsXHJcbiAgICAgICAgcmVtb3ZlU29sdXRlQnV0dG9uLFxyXG4gICAgICAgIHJlc2V0QWxsQnV0dG9uLFxyXG4gICAgICAgIHNvbHV0ZVBhbmVsLFxyXG4gICAgICAgIGNvbmNlbnRyYXRpb25NZXRlck5vZGUsXHJcbiAgICAgICAgc29sdXRlTGlzdFBhcmVudCAvLyBsYXN0LCBzbyB0aGF0IGNvbWJvIGJveCBsaXN0IGlzIG9uIHRvcFxyXG4gICAgICBdXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBzY3JlZW5WaWV3Um9vdE5vZGUgKTtcclxuXHJcbiAgICAvLyBDZW50ZXIgJ1NhdHVyYXRlZCcgYXQgY2VudGVyQm90dG9tIG9mIGJlYWtlci5cclxuICAgIHNhdHVyYXRlZEluZGljYXRvci5ib3VuZHNQcm9wZXJ0eS5saW5rKCAoKSA9PiB7XHJcbiAgICAgIHNhdHVyYXRlZEluZGljYXRvci5jZW50ZXJYID0gYmVha2VyTm9kZS5jZW50ZXJYO1xyXG4gICAgICBzYXR1cmF0ZWRJbmRpY2F0b3IuYm90dG9tID0gYmVha2VyTm9kZS5ib3R0b20gLSAzMDtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB1cHBlciByaWdodFxyXG4gICAgc29sdXRlUGFuZWwucmlnaHQgPSB0aGlzLmxheW91dEJvdW5kcy5yaWdodCAtIDIwO1xyXG4gICAgc29sdXRlUGFuZWwudG9wID0gdGhpcy5sYXlvdXRCb3VuZHMudG9wICsgMjA7XHJcblxyXG4gICAgLy8gbGVmdC1hbGlnbmVkIGJlbG93IGJlYWtlclxyXG4gICAgZXZhcG9yYXRpb25QYW5lbC5sZWZ0ID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3UG9zaXRpb24oIG1vZGVsLmJlYWtlci5wb3NpdGlvbiApLnggLVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3RGVsdGFYKCBtb2RlbC5iZWFrZXIuc2l6ZS53aWR0aCAvIDIgKTtcclxuICAgIGV2YXBvcmF0aW9uUGFuZWwudG9wID0gYmVha2VyTm9kZS5ib3R0b20gKyAzMDtcclxuXHJcbiAgICBNdWx0aWxpbmsubXVsdGlsaW5rKCBbXHJcbiAgICAgIHNvbHV0ZUFtb3VudFRleHQudmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICBldmFwb3JhdGlvblBhbmVsLmJvdW5kc1Byb3BlcnR5LFxyXG4gICAgICByZW1vdmVTb2x1dGVCdXR0b24uYm91bmRzUHJvcGVydHksXHJcbiAgICAgIHNvbHV0ZUFtb3VudFRleHQuYm91bmRzUHJvcGVydHlcclxuICAgIF0sICgpID0+IHtcclxuICAgICAgaWYgKCBzb2x1dGVBbW91bnRUZXh0LnZpc2libGUgKSB7XHJcbiAgICAgICAgLy8gYm90dG9tIGFsaWduZWQgd2l0aCBldmFwb3JhdG9yXHJcbiAgICAgICAgcmVtb3ZlU29sdXRlQnV0dG9uLmxlZnQgPSBldmFwb3JhdGlvblBhbmVsLnJpZ2h0ICsgMzA7XHJcbiAgICAgICAgcmVtb3ZlU29sdXRlQnV0dG9uLmJvdHRvbSA9IGV2YXBvcmF0aW9uUGFuZWwuYm90dG9tO1xyXG4gICAgICAgIC8vICBhYm92ZSBidXR0b25cclxuICAgICAgICBzb2x1dGVBbW91bnRUZXh0LmxlZnQgPSByZW1vdmVTb2x1dGVCdXR0b24ubGVmdDtcclxuICAgICAgICBzb2x1dGVBbW91bnRUZXh0LmJvdHRvbSA9IHJlbW92ZVNvbHV0ZUJ1dHRvbi50b3AgLSAyMDtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAvLyBsZWZ0IG9mIGV2YXBvcmF0aW9uIGNvbnRyb2xcclxuICAgICAgICByZW1vdmVTb2x1dGVCdXR0b24ubGVmdCA9IGV2YXBvcmF0aW9uUGFuZWwucmlnaHQgKyAzMDtcclxuICAgICAgICByZW1vdmVTb2x1dGVCdXR0b24uY2VudGVyWSA9IGV2YXBvcmF0aW9uUGFuZWwuY2VudGVyWTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGJvdHRvbSByaWdodFxyXG4gICAgcmVzZXRBbGxCdXR0b24ucmlnaHQgPSB0aGlzLmxheW91dEJvdW5kcy5yaWdodCAtIDMwO1xyXG4gICAgcmVzZXRBbGxCdXR0b24uYm90dG9tID0gdGhpcy5sYXlvdXRCb3VuZHMuYm90dG9tIC0gMzA7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuYmVlcnNMYXdMYWIucmVnaXN0ZXIoICdDb25jZW50cmF0aW9uU2NyZWVuVmlldycsIENvbmNlbnRyYXRpb25TY3JlZW5WaWV3ICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFNBQVMsTUFBTSxrQ0FBa0M7QUFDeEQsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxVQUFVLE1BQU0sb0NBQW9DO0FBRTNELE9BQU9DLGNBQWMsTUFBTSx1REFBdUQ7QUFDbEYsU0FBU0MsSUFBSSxRQUFRLG1DQUFtQztBQUN4RCxPQUFPQyxjQUFjLE1BQU0sK0NBQStDO0FBQzFFLE9BQU9DLFdBQVcsTUFBTSxzQkFBc0I7QUFDOUMsT0FBT0MsWUFBWSxNQUFNLDhCQUE4QjtBQUV2RCxPQUFPQyxVQUFVLE1BQU0saUJBQWlCO0FBQ3hDLE9BQU9DLGNBQWMsTUFBTSxxQkFBcUI7QUFDaEQsT0FBT0MsYUFBYSxNQUFNLG9CQUFvQjtBQUM5QyxPQUFPQyxzQkFBc0IsTUFBTSw2QkFBNkI7QUFDaEUsT0FBT0MsZ0JBQWdCLE1BQU0sdUJBQXVCO0FBQ3BELE9BQU9DLGVBQWUsTUFBTSxzQkFBc0I7QUFDbEQsT0FBT0Msd0JBQXdCLE1BQU0sK0JBQStCO0FBQ3BFLE9BQU9DLGtCQUFrQixNQUFNLHlCQUF5QjtBQUN4RCxPQUFPQyxrQkFBa0IsTUFBTSx5QkFBeUI7QUFDeEQsT0FBT0MsVUFBVSxNQUFNLGlCQUFpQjtBQUN4QyxPQUFPQyxtQkFBbUIsTUFBTSwwQkFBMEI7QUFDMUQsT0FBT0MsZ0JBQWdCLE1BQU0sdUJBQXVCO0FBQ3BELE9BQU9DLFdBQVcsTUFBTSxrQkFBa0I7QUFDMUMsT0FBT0MsWUFBWSxNQUFNLG1CQUFtQjtBQUM1QyxPQUFPQyxpQkFBaUIsTUFBTSx3QkFBd0I7QUFDdEQsT0FBT0Msa0JBQWtCLE1BQU0seUJBQXlCO0FBRXhELE9BQU9DLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxPQUFPQyxXQUFXLE1BQU0sK0NBQStDO0FBRXZFLGVBQWUsTUFBTUMsdUJBQXVCLFNBQVN6QixVQUFVLENBQUM7RUFFdkQwQixXQUFXQSxDQUFFQyxLQUF5QixFQUFFQyxrQkFBdUMsRUFBRUMsTUFBYyxFQUFHO0lBRXZHLEtBQUssQ0FBRTtNQUVMO01BQ0E7TUFDQUMsVUFBVSxFQUFFLElBQUk7TUFDaEJDLFlBQVksRUFBRTFCLFlBQVksQ0FBQzJCLGFBQWE7TUFDeENILE1BQU0sRUFBRUE7SUFDVixDQUFFLENBQUM7O0lBRUg7SUFDQSxNQUFNSSxVQUFVLEdBQUcsSUFBSTNCLFVBQVUsQ0FBRXFCLEtBQUssQ0FBQ08sTUFBTSxFQUFFTixrQkFBa0IsRUFBRTtNQUNuRUMsTUFBTSxFQUFFQSxNQUFNLENBQUNNLFlBQVksQ0FBRSxZQUFhO0lBQzVDLENBQUUsQ0FBQztJQUNILE1BQU1DLFlBQVksR0FBRyxJQUFJakIsWUFBWSxDQUFFUSxLQUFLLENBQUNVLFFBQVEsRUFBRVYsS0FBSyxDQUFDTyxNQUFNLEVBQUVOLGtCQUFtQixDQUFDO0lBQ3pGLE1BQU1VLGtCQUFrQixHQUFHLElBQUlqQixrQkFBa0IsQ0FBRU0sS0FBSyxDQUFDVSxRQUFRLENBQUNFLGNBQWMsRUFBRTtNQUNoRlYsTUFBTSxFQUFFQSxNQUFNLENBQUNNLFlBQVksQ0FBRSxvQkFBcUI7SUFDcEQsQ0FBRSxDQUFDO0lBRUhyQyxTQUFTLENBQUMwQyxTQUFTLENBQUUsQ0FBRUosWUFBWSxDQUFDSyxjQUFjLEVBQUVILGtCQUFrQixDQUFDRyxjQUFjLENBQUUsRUFDckYsTUFBTTtNQUNKSCxrQkFBa0IsQ0FBQ0ksS0FBSyxHQUFHVCxVQUFVLENBQUNVLE9BQU8sR0FBR2hCLEtBQUssQ0FBQ08sTUFBTSxDQUFDVSxJQUFJLENBQUNDLEtBQUssR0FBRyxDQUFDO01BQzNFUCxrQkFBa0IsQ0FBQ1EsQ0FBQyxHQUFHVixZQUFZLENBQUNXLEdBQUcsR0FBRzFDLFlBQVksQ0FBQzJDLG1CQUFtQixHQUFHLENBQUM7SUFDaEYsQ0FBRSxDQUFDOztJQUVMO0lBQ0EsTUFBTUMsd0JBQXdCLEdBQUcsSUFBSXJDLHdCQUF3QixDQUFFZSxLQUFLLENBQUN1QixvQkFBb0IsRUFBRXRCLGtCQUFrQixFQUFFLElBQUk3QixPQUFPLENBQ3hINkIsa0JBQWtCLENBQUN1QixZQUFZLENBQUV4QixLQUFLLENBQUNPLE1BQU0sQ0FBQ2tCLElBQUssQ0FBQyxFQUFFeEIsa0JBQWtCLENBQUN5QixZQUFZLENBQUUxQixLQUFLLENBQUNPLE1BQU0sQ0FBQ29CLFFBQVEsQ0FBQ1IsQ0FBRSxDQUFDLEdBQUcsR0FBRyxFQUN0SGxCLGtCQUFrQixDQUFDdUIsWUFBWSxDQUFFeEIsS0FBSyxDQUFDTyxNQUFNLENBQUNRLEtBQU0sQ0FBQyxFQUFFZCxrQkFBa0IsQ0FBQ3lCLFlBQVksQ0FBRTFCLEtBQUssQ0FBQ08sTUFBTSxDQUFDb0IsUUFBUSxDQUFDUixDQUFFLENBQUUsQ0FBRSxDQUFDO0lBQ3ZILE1BQU1TLGtCQUFrQixHQUFHLElBQUl6QyxrQkFBa0IsQ0FBRWEsS0FBSyxDQUFDVSxRQUFRLENBQUNtQixtQkFBbUIsRUFBRTNCLE1BQU0sQ0FBQ00sWUFBWSxDQUFFLG9CQUFxQixDQUFFLENBQUM7O0lBRXBJO0lBQ0EsTUFBTXNCLHlCQUF5QixHQUFHbkMsZUFBZSxDQUFDb0MsU0FBUyxDQUFFLENBQzNEL0IsS0FBSyxDQUFDZ0MsTUFBTSxDQUFDQyxjQUFjLEVBQzNCLEdBQUdqQyxLQUFLLENBQUNrQyxPQUFPLENBQUNDLEdBQUcsQ0FBRUMsTUFBTSxJQUFJQSxNQUFNLENBQUNDLGVBQWdCLENBQUMsRUFDeEQsR0FBR3JDLEtBQUssQ0FBQ2tDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFFQyxNQUFNLElBQUlBLE1BQU0sQ0FBQ0UsWUFBYSxDQUFDLENBQ3RELEVBQUUsTUFBTTtNQUNQLE1BQU1GLE1BQU0sR0FBR3BDLEtBQUssQ0FBQ2dDLE1BQU0sQ0FBQ0MsY0FBYyxDQUFDTSxLQUFLO01BQ2hELE1BQU1DLE9BQU8sR0FBR0osTUFBTSxDQUFDQyxlQUFlLENBQUNFLEtBQUs7TUFDNUMsTUFBTUUsSUFBSSxHQUFHTCxNQUFNLENBQUNFLFlBQVksQ0FBQ0MsS0FBSztNQUN0QyxPQUFPQyxPQUFPLEdBQUczQyxXQUFXLENBQUM2QyxPQUFPLENBQUVGLE9BQVEsQ0FBQyxHQUFHQyxJQUFJO0lBQ3hELENBQUMsRUFBRTtNQUNEdkMsTUFBTSxFQUFFQSxNQUFNLENBQUNNLFlBQVksQ0FBRSwyQkFBNEIsQ0FBQztNQUMxRG1DLGVBQWUsRUFBRS9DLFFBQVE7TUFDekJnRCxtQkFBbUIsRUFBRTtJQUN2QixDQUFFLENBQUM7O0lBRUg7SUFDQSxNQUFNQyxVQUFVLEdBQUcsSUFBSXpELFVBQVUsQ0FBRVksS0FBSyxDQUFDZ0MsTUFBTSxFQUFFRix5QkFBeUIsRUFBRTdCLGtCQUFrQixFQUFFO01BQzlGQyxNQUFNLEVBQUVBLE1BQU0sQ0FBQ00sWUFBWSxDQUFFLFlBQWE7SUFDNUMsQ0FBRSxDQUFDOztJQUVIO0lBQ0EsTUFBTXNDLG1CQUFtQixHQUFHLElBQUl6RCxtQkFBbUIsQ0FBRVcsS0FBSyxDQUFDK0MsZUFBZSxFQUFFOUMsa0JBQWtCLEVBQUUsSUFBSTdCLE9BQU8sQ0FDekc2QixrQkFBa0IsQ0FBQ3VCLFlBQVksQ0FBRXhCLEtBQUssQ0FBQ08sTUFBTSxDQUFDa0IsSUFBSyxDQUFDLEVBQUUsSUFBSSxDQUFDckIsWUFBWSxDQUFDNEMsSUFBSSxFQUM1RS9DLGtCQUFrQixDQUFDdUIsWUFBWSxDQUFFeEIsS0FBSyxDQUFDTyxNQUFNLENBQUNRLEtBQU0sQ0FBQyxFQUFFZCxrQkFBa0IsQ0FBQ3lCLFlBQVksQ0FBRTFCLEtBQUssQ0FBQ08sTUFBTSxDQUFDb0IsUUFBUSxDQUFDUixDQUFFLENBQUUsQ0FBRSxDQUFDOztJQUV2SDtJQUNBLE1BQU04QixXQUFXLEdBQUcsSUFBSXJFLGNBQWMsQ0FBRW9CLEtBQUssQ0FBQ2tELE9BQU8sRUFBRXBCLHlCQUF5QixFQUFFOUIsS0FBSyxDQUFDVSxRQUFRLENBQUN5QyxPQUFPLEVBQ3RHbkQsS0FBSyxDQUFDVSxRQUFRLENBQUN1QixjQUFjLEVBQUVoQyxrQkFBa0IsRUFBRTtNQUNqREMsTUFBTSxFQUFFQSxNQUFNLENBQUNNLFlBQVksQ0FBRSxhQUFjO0lBQzdDLENBQUUsQ0FBQztJQUNMLE1BQU00QyxpQkFBaUIsR0FBRyxJQUFJM0QsaUJBQWlCLENBQUVPLEtBQUssQ0FBQ1UsUUFBUSxDQUFDeUMsT0FBTyxFQUFFbkQsS0FBSyxDQUFDaUMsY0FBYyxFQUFFakMsS0FBSyxDQUFDa0QsT0FBTyxFQUMxR2xELEtBQUssQ0FBQ08sTUFBTSxFQUFFL0IsY0FBYyxDQUFDNkUsU0FBUyxHQUFHLENBQUMsRUFBRXBELGtCQUFtQixDQUFDOztJQUVsRTtJQUNBLE1BQU1xRCxpQkFBaUIsR0FBRyxJQUFJekUsYUFBYSxDQUFFbUIsS0FBSyxDQUFDdUQsYUFBYSxFQUFFdEQsa0JBQWtCLEVBQUU7TUFDcEZDLE1BQU0sRUFBRUEsTUFBTSxDQUFDTSxZQUFZLENBQUUsbUJBQW9CO0lBQ25ELENBQUUsQ0FBQztJQUNILE1BQU1nRCxlQUFlLEdBQUcsSUFBSTNFLGFBQWEsQ0FBRW1CLEtBQUssQ0FBQ3lELFdBQVcsRUFBRXhELGtCQUFrQixFQUFFO01BQ2hGQyxNQUFNLEVBQUVBLE1BQU0sQ0FBQ00sWUFBWSxDQUFFLGlCQUFrQjtJQUNqRCxDQUFFLENBQUM7SUFDSCxNQUFNa0Qsb0JBQW9CLEdBQUcxRCxLQUFLLENBQUNPLE1BQU0sQ0FBQ29CLFFBQVEsQ0FBQ1IsQ0FBQyxHQUFHbkIsS0FBSyxDQUFDdUQsYUFBYSxDQUFDNUIsUUFBUSxDQUFDUixDQUFDO0lBQ3JGLE1BQU13QyxrQkFBa0IsR0FBRyxJQUFJLENBQUMsQ0FBQztJQUNqQyxNQUFNQyxnQkFBZ0IsR0FBRyxJQUFJNUUsZUFBZSxDQUFFZ0IsS0FBSyxDQUFDdUQsYUFBYSxFQUFFdkQsS0FBSyxDQUFDVSxRQUFRLENBQUN5QyxPQUFPLEVBQUVPLG9CQUFvQixFQUFFekQsa0JBQW1CLENBQUM7SUFDckksTUFBTTRELGNBQWMsR0FBRyxJQUFJN0UsZUFBZSxDQUFFZ0IsS0FBSyxDQUFDeUQsV0FBVyxFQUFFekQsS0FBSyxDQUFDVSxRQUFRLEVBQUVpRCxrQkFBa0IsRUFBRTFELGtCQUFtQixDQUFDOztJQUV2SDtJQUNBLE1BQU02RCxzQkFBc0IsR0FBRyxJQUFJaEYsc0JBQXNCLENBQUVrQixLQUFLLENBQUMrRCxrQkFBa0IsRUFBRS9ELEtBQUssQ0FBQ1UsUUFBUSxFQUFFVixLQUFLLENBQUNrRCxPQUFPLEVBQ2hIekMsWUFBWSxFQUFFMkMsaUJBQWlCLEVBQUVRLGdCQUFnQixFQUFFQyxjQUFjLEVBQUU1RCxrQkFBa0IsRUFBRTtNQUNyRkMsTUFBTSxFQUFFQSxNQUFNLENBQUNNLFlBQVksQ0FBRSx3QkFBeUI7SUFDeEQsQ0FBRSxDQUFDOztJQUVMO0lBQ0EsTUFBTXdELGdCQUFnQixHQUFHLElBQUl6RixJQUFJLENBQUMsQ0FBQztJQUNuQyxNQUFNMEYsV0FBVyxHQUFHLElBQUkxRSxXQUFXLENBQUVTLEtBQUssQ0FBQ2tDLE9BQU8sRUFBRWxDLEtBQUssQ0FBQ2lDLGNBQWMsRUFBRWpDLEtBQUssQ0FBQ2tFLGtCQUFrQixFQUFFbEUsS0FBSyxDQUFDZ0MsTUFBTSxFQUM5R2hDLEtBQUssQ0FBQ2tELE9BQU8sRUFBRWMsZ0JBQWdCLEVBQUU7TUFDL0I5RCxNQUFNLEVBQUVBLE1BQU0sQ0FBQ00sWUFBWSxDQUFFLGFBQWM7SUFDN0MsQ0FBRSxDQUFDOztJQUVMO0lBQ0EsTUFBTTJELGdCQUFnQixHQUFHLElBQUlwRixnQkFBZ0IsQ0FBRWlCLEtBQUssQ0FBQ29FLFVBQVUsRUFBRTtNQUMvRGxFLE1BQU0sRUFBRUEsTUFBTSxDQUFDTSxZQUFZLENBQUUsa0JBQW1CO0lBQ2xELENBQUUsQ0FBQzs7SUFFSDtJQUNBLE1BQU02RCxnQkFBZ0IsR0FBRyxJQUFJL0UsZ0JBQWdCLENBQUVVLEtBQUssQ0FBQ1UsUUFBUSxDQUFDNEQsbUJBQW1CLEVBQUU7TUFDakZwRSxNQUFNLEVBQUVBLE1BQU0sQ0FBQ00sWUFBWSxDQUFFLGtCQUFtQjtJQUNsRCxDQUFFLENBQUM7O0lBRUg7SUFDQSxNQUFNK0Qsa0JBQWtCLEdBQUcsSUFBSXJGLGtCQUFrQixDQUFFYyxLQUFLLENBQUNVLFFBQVEsRUFBRVYsS0FBSyxDQUFDK0MsZUFBZSxFQUFFO01BQ3hGN0MsTUFBTSxFQUFFQSxNQUFNLENBQUNNLFlBQVksQ0FBRSxvQkFBcUI7SUFDcEQsQ0FBRSxDQUFDOztJQUVIO0lBQ0EsTUFBTWdFLGNBQWMsR0FBRyxJQUFJbEcsY0FBYyxDQUFFO01BQ3pDbUcsUUFBUSxFQUFFQSxDQUFBLEtBQU07UUFDZCxJQUFJLENBQUNDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlCMUUsS0FBSyxDQUFDMkUsS0FBSyxDQUFDLENBQUM7TUFDZixDQUFDO01BQ0RDLEtBQUssRUFBRSxJQUFJO01BQ1gxRSxNQUFNLEVBQUVBLE1BQU0sQ0FBQ00sWUFBWSxDQUFFLGdCQUFpQjtJQUNoRCxDQUFFLENBQUM7O0lBRUg7SUFDQSxNQUFNcUUsa0JBQWtCLEdBQUcsSUFBSXRHLElBQUksQ0FBRTtNQUNuQ3VHLFFBQVEsRUFBRSxDQUNSbEIsZ0JBQWdCLEVBQ2hCTixpQkFBaUIsRUFDakJPLGNBQWMsRUFDZEwsZUFBZSxFQUNmSixpQkFBaUIsRUFDakIzQyxZQUFZLEVBQ1pFLGtCQUFrQixFQUNsQkwsVUFBVSxDQUFDeUUsTUFBTSxDQUFFO1FBQUVDLFVBQVUsRUFBRTtNQUFLLENBQUUsQ0FBQztNQUFFO01BQzNDMUQsd0JBQXdCLEVBQ3hCTSxrQkFBa0IsRUFDbEJrQixtQkFBbUIsRUFDbkJELFVBQVUsRUFDVkksV0FBVyxFQUNYa0IsZ0JBQWdCLEVBQ2hCRSxnQkFBZ0IsRUFDaEJFLGtCQUFrQixFQUNsQkMsY0FBYyxFQUNkUCxXQUFXLEVBQ1hILHNCQUFzQixFQUN0QkUsZ0JBQWdCLENBQUM7TUFBQTtJQUVyQixDQUFFLENBQUM7O0lBQ0gsSUFBSSxDQUFDaUIsUUFBUSxDQUFFSixrQkFBbUIsQ0FBQzs7SUFFbkM7SUFDQWpELGtCQUFrQixDQUFDZCxjQUFjLENBQUNvRSxJQUFJLENBQUUsTUFBTTtNQUM1Q3RELGtCQUFrQixDQUFDWixPQUFPLEdBQUdWLFVBQVUsQ0FBQ1UsT0FBTztNQUMvQ1ksa0JBQWtCLENBQUN1RCxNQUFNLEdBQUc3RSxVQUFVLENBQUM2RSxNQUFNLEdBQUcsRUFBRTtJQUNwRCxDQUFFLENBQUM7O0lBRUg7SUFDQWxCLFdBQVcsQ0FBQ2xELEtBQUssR0FBRyxJQUFJLENBQUNYLFlBQVksQ0FBQ1csS0FBSyxHQUFHLEVBQUU7SUFDaERrRCxXQUFXLENBQUM3QyxHQUFHLEdBQUcsSUFBSSxDQUFDaEIsWUFBWSxDQUFDZ0IsR0FBRyxHQUFHLEVBQUU7O0lBRTVDO0lBQ0ErQyxnQkFBZ0IsQ0FBQzFDLElBQUksR0FBR3hCLGtCQUFrQixDQUFDbUYsbUJBQW1CLENBQUVwRixLQUFLLENBQUNPLE1BQU0sQ0FBQ29CLFFBQVMsQ0FBQyxDQUFDMEQsQ0FBQyxHQUNqRXBGLGtCQUFrQixDQUFDcUYsaUJBQWlCLENBQUV0RixLQUFLLENBQUNPLE1BQU0sQ0FBQ1UsSUFBSSxDQUFDQyxLQUFLLEdBQUcsQ0FBRSxDQUFDO0lBQzNGaUQsZ0JBQWdCLENBQUMvQyxHQUFHLEdBQUdkLFVBQVUsQ0FBQzZFLE1BQU0sR0FBRyxFQUFFO0lBRTdDaEgsU0FBUyxDQUFDMEMsU0FBUyxDQUFFLENBQ25Cd0QsZ0JBQWdCLENBQUNrQixlQUFlLEVBQ2hDcEIsZ0JBQWdCLENBQUNyRCxjQUFjLEVBQy9CeUQsa0JBQWtCLENBQUN6RCxjQUFjLEVBQ2pDdUQsZ0JBQWdCLENBQUN2RCxjQUFjLENBQ2hDLEVBQUUsTUFBTTtNQUNQLElBQUt1RCxnQkFBZ0IsQ0FBQ21CLE9BQU8sRUFBRztRQUM5QjtRQUNBakIsa0JBQWtCLENBQUM5QyxJQUFJLEdBQUcwQyxnQkFBZ0IsQ0FBQ3BELEtBQUssR0FBRyxFQUFFO1FBQ3JEd0Qsa0JBQWtCLENBQUNZLE1BQU0sR0FBR2hCLGdCQUFnQixDQUFDZ0IsTUFBTTtRQUNuRDtRQUNBZCxnQkFBZ0IsQ0FBQzVDLElBQUksR0FBRzhDLGtCQUFrQixDQUFDOUMsSUFBSTtRQUMvQzRDLGdCQUFnQixDQUFDYyxNQUFNLEdBQUdaLGtCQUFrQixDQUFDbkQsR0FBRyxHQUFHLEVBQUU7TUFDdkQsQ0FBQyxNQUNJO1FBQ0g7UUFDQW1ELGtCQUFrQixDQUFDOUMsSUFBSSxHQUFHMEMsZ0JBQWdCLENBQUNwRCxLQUFLLEdBQUcsRUFBRTtRQUNyRHdELGtCQUFrQixDQUFDa0IsT0FBTyxHQUFHdEIsZ0JBQWdCLENBQUNzQixPQUFPO01BQ3ZEO0lBQ0YsQ0FBRSxDQUFDOztJQUVIO0lBQ0FqQixjQUFjLENBQUN6RCxLQUFLLEdBQUcsSUFBSSxDQUFDWCxZQUFZLENBQUNXLEtBQUssR0FBRyxFQUFFO0lBQ25EeUQsY0FBYyxDQUFDVyxNQUFNLEdBQUcsSUFBSSxDQUFDL0UsWUFBWSxDQUFDK0UsTUFBTSxHQUFHLEVBQUU7RUFDdkQ7RUFFZ0JPLE9BQU9BLENBQUEsRUFBUztJQUM5QkMsTUFBTSxJQUFJQSxNQUFNLENBQUUsS0FBSyxFQUFFLDhEQUErRCxDQUFDO0lBQ3pGLEtBQUssQ0FBQ0QsT0FBTyxDQUFDLENBQUM7RUFDakI7QUFDRjtBQUVBakgsV0FBVyxDQUFDbUgsUUFBUSxDQUFFLHlCQUF5QixFQUFFOUYsdUJBQXdCLENBQUMifQ==