// Copyright 2013-2023, University of Colorado Boulder

/**
 * Solution model for the 'Concentration' screen.
 * This screen has a single solution that is mutated by changing the solute, solute amount, and volume.
 * Concentration is derived via M=mol/L.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Utils from '../../../../dot/js/Utils.js';
import optionize from '../../../../phet-core/js/optionize.js';
import BooleanIO from '../../../../tandem/js/types/BooleanIO.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import beersLawLab from '../../beersLawLab.js';
import Fluid from '../../common/model/Fluid.js';
import Solvent from '../../common/model/Solvent.js';
export default class ConcentrationSolution extends Fluid {
  // total solute, dissolved and precipitate, in mol
  // L

  // for deferring update of precipitateAmount until we've changed both volume and soluteAmount
  // see https://github.com/phetsims/concentration/issues/1
  // mol
  // M
  // solute dissolved in solution, in grams
  // [0,100]
  constructor(soluteProperty, soluteAmountRange, volumeRange, providedOptions) {
    const options = optionize()({
      phetioDocumentation: 'The solution in the beaker'
    }, providedOptions);
    const solvent = Solvent.WATER;
    super(ConcentrationSolution.createColor(solvent, soluteProperty.value, 0));
    this.solvent = solvent;
    this.soluteProperty = soluteProperty;
    this.soluteMolesProperty = new NumberProperty(soluteAmountRange.defaultValue, {
      units: 'mol',
      range: soluteAmountRange,
      tandem: options.tandem.createTandem('soluteMolesProperty')
    });
    this.volumeProperty = new NumberProperty(volumeRange.defaultValue, {
      units: 'L',
      range: volumeRange,
      tandem: options.tandem.createTandem('volumeProperty')
    });
    this.updatePrecipitateAmount = true;
    this.precipitateMolesProperty = new DerivedProperty([this.soluteProperty, this.soluteMolesProperty, this.volumeProperty], (solute, soluteMoles, volume) => {
      if (this.updatePrecipitateAmount) {
        return Math.max(0, soluteMoles - volume * this.getSaturatedConcentration());
      } else {
        return this.precipitateMolesProperty.value;
      }
    }, {
      tandem: options.tandem.createTandem('precipitateMolesProperty'),
      units: 'mol',
      phetioValueType: NumberIO
    });
    this.concentrationProperty = new DerivedProperty([this.soluteProperty, this.soluteMolesProperty, this.volumeProperty], (solute, soluteMoles, volume) => {
      return volume > 0 ? Math.min(this.getSaturatedConcentration(), soluteMoles / volume) : 0;
    }, {
      tandem: options.tandem.createTandem('concentrationProperty'),
      units: 'mol/L',
      phetioValueType: NumberIO
    });
    this.isSaturatedProperty = new DerivedProperty([this.soluteProperty, this.soluteMolesProperty, this.volumeProperty], (solute, soluteMoles, volume) => {
      return volume > 0 && soluteMoles / volume > solute.getSaturatedConcentration();
    }, {
      tandem: options.tandem.createTandem('isSaturatedProperty'),
      phetioValueType: BooleanIO
    });
    this.soluteGramsProperty = new DerivedProperty([this.soluteProperty, this.soluteMolesProperty, this.precipitateMolesProperty], (solute, soluteMoles, precipitateMoles) => {
      // Use Math.max to prevent a negative value during intermediate states.
      // See https://github.com/phetsims/beers-law-lab/issues/253
      const soluteGrams = solute.molarMass * Math.max(0, soluteMoles - precipitateMoles);
      assert && assert(soluteGrams >= 0, `invalid soluteGrams: ${soluteGrams}`);
      return soluteGrams;
    }, {
      tandem: options.tandem.createTandem('soluteGramsProperty'),
      units: 'g',
      phetioValueType: NumberIO
    });
    this.percentConcentrationProperty = new DerivedProperty([this.volumeProperty, this.soluteGramsProperty], (volume, soluteGrams) => {
      let percentConcentration = 0;
      if (volume > 0) {
        const solventGrams = volume * this.solvent.density;
        percentConcentration = 100 * (soluteGrams / (soluteGrams + solventGrams));
      }
      assert && assert(percentConcentration >= 0 && percentConcentration <= 100, `percentConcentration out of range: ${percentConcentration}`);
      return percentConcentration;
    }, {
      tandem: options.tandem.createTandem('percentConcentrationProperty'),
      phetioValueType: NumberIO,
      units: '%',
      phetioDocumentation: 'Calculated as a mass percent.'
    });

    // derive the solution color
    const updateColor = () => {
      this.colorProperty.value = ConcentrationSolution.createColor(this.solvent, this.soluteProperty.value, this.concentrationProperty.value);
    };
    this.soluteProperty.lazyLink(updateColor);
    this.concentrationProperty.link(updateColor); // link to force update of color
  }

  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
  reset() {
    super.reset();
    this.soluteMolesProperty.reset();
    this.volumeProperty.reset();
  }
  getSaturatedConcentration() {
    return this.soluteProperty.value.getSaturatedConcentration();
  }
  getNumberOfPrecipitateParticles() {
    let numberOfParticles = Utils.roundSymmetric(this.soluteProperty.value.particlesPerMole * this.precipitateMolesProperty.value);
    if (numberOfParticles === 0 && this.precipitateMolesProperty.value > 0) {
      numberOfParticles = 1;
    }
    return numberOfParticles;
  }

  /**
   * Creates a color that corresponds to the solution's concentration.
   */
  static createColor(solvent, solute, concentration) {
    let color = solvent.colorProperty.value;
    if (concentration > 0) {
      color = solute.colorScheme.concentrationToColor(concentration);
    }
    return color;
  }
}
beersLawLab.register('ConcentrationSolution', ConcentrationSolution);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJOdW1iZXJQcm9wZXJ0eSIsIlV0aWxzIiwib3B0aW9uaXplIiwiQm9vbGVhbklPIiwiTnVtYmVySU8iLCJiZWVyc0xhd0xhYiIsIkZsdWlkIiwiU29sdmVudCIsIkNvbmNlbnRyYXRpb25Tb2x1dGlvbiIsImNvbnN0cnVjdG9yIiwic29sdXRlUHJvcGVydHkiLCJzb2x1dGVBbW91bnRSYW5nZSIsInZvbHVtZVJhbmdlIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInBoZXRpb0RvY3VtZW50YXRpb24iLCJzb2x2ZW50IiwiV0FURVIiLCJjcmVhdGVDb2xvciIsInZhbHVlIiwic29sdXRlTW9sZXNQcm9wZXJ0eSIsImRlZmF1bHRWYWx1ZSIsInVuaXRzIiwicmFuZ2UiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJ2b2x1bWVQcm9wZXJ0eSIsInVwZGF0ZVByZWNpcGl0YXRlQW1vdW50IiwicHJlY2lwaXRhdGVNb2xlc1Byb3BlcnR5Iiwic29sdXRlIiwic29sdXRlTW9sZXMiLCJ2b2x1bWUiLCJNYXRoIiwibWF4IiwiZ2V0U2F0dXJhdGVkQ29uY2VudHJhdGlvbiIsInBoZXRpb1ZhbHVlVHlwZSIsImNvbmNlbnRyYXRpb25Qcm9wZXJ0eSIsIm1pbiIsImlzU2F0dXJhdGVkUHJvcGVydHkiLCJzb2x1dGVHcmFtc1Byb3BlcnR5IiwicHJlY2lwaXRhdGVNb2xlcyIsInNvbHV0ZUdyYW1zIiwibW9sYXJNYXNzIiwiYXNzZXJ0IiwicGVyY2VudENvbmNlbnRyYXRpb25Qcm9wZXJ0eSIsInBlcmNlbnRDb25jZW50cmF0aW9uIiwic29sdmVudEdyYW1zIiwiZGVuc2l0eSIsInVwZGF0ZUNvbG9yIiwiY29sb3JQcm9wZXJ0eSIsImxhenlMaW5rIiwibGluayIsImRpc3Bvc2UiLCJyZXNldCIsImdldE51bWJlck9mUHJlY2lwaXRhdGVQYXJ0aWNsZXMiLCJudW1iZXJPZlBhcnRpY2xlcyIsInJvdW5kU3ltbWV0cmljIiwicGFydGljbGVzUGVyTW9sZSIsImNvbmNlbnRyYXRpb24iLCJjb2xvciIsImNvbG9yU2NoZW1lIiwiY29uY2VudHJhdGlvblRvQ29sb3IiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkNvbmNlbnRyYXRpb25Tb2x1dGlvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBTb2x1dGlvbiBtb2RlbCBmb3IgdGhlICdDb25jZW50cmF0aW9uJyBzY3JlZW4uXHJcbiAqIFRoaXMgc2NyZWVuIGhhcyBhIHNpbmdsZSBzb2x1dGlvbiB0aGF0IGlzIG11dGF0ZWQgYnkgY2hhbmdpbmcgdGhlIHNvbHV0ZSwgc29sdXRlIGFtb3VudCwgYW5kIHZvbHVtZS5cclxuICogQ29uY2VudHJhdGlvbiBpcyBkZXJpdmVkIHZpYSBNPW1vbC9MLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgTnVtYmVyUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9OdW1iZXJQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUmFuZ2VXaXRoVmFsdWUgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlV2l0aFZhbHVlLmpzJztcclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgUGlja09wdGlvbmFsIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrT3B0aW9uYWwuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgeyBDb2xvciB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCB7IFBoZXRpb09iamVjdE9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvUGhldGlvT2JqZWN0LmpzJztcclxuaW1wb3J0IEJvb2xlYW5JTyBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvQm9vbGVhbklPLmpzJztcclxuaW1wb3J0IE51bWJlcklPIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy90eXBlcy9OdW1iZXJJTy5qcyc7XHJcbmltcG9ydCBiZWVyc0xhd0xhYiBmcm9tICcuLi8uLi9iZWVyc0xhd0xhYi5qcyc7XHJcbmltcG9ydCBGbHVpZCBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvRmx1aWQuanMnO1xyXG5pbXBvcnQgU29sdXRlIGZyb20gJy4uLy4uL2NvbW1vbi9tb2RlbC9Tb2x1dGUuanMnO1xyXG5pbXBvcnQgU29sdmVudCBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvU29sdmVudC5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0gRW1wdHlTZWxmT3B0aW9ucyAmXHJcbiAgUGlja09wdGlvbmFsPFBoZXRpb09iamVjdE9wdGlvbnMsICdwaGV0aW9Eb2N1bWVudGF0aW9uJz4gJlxyXG4gIFBpY2tSZXF1aXJlZDxQaGV0aW9PYmplY3RPcHRpb25zLCAndGFuZGVtJz47XHJcblxyXG50eXBlIENvbmNlbnRyYXRpb25Tb2x1dGlvbk9wdGlvbnMgPSBTZWxmT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbmNlbnRyYXRpb25Tb2x1dGlvbiBleHRlbmRzIEZsdWlkIHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IHNvbHZlbnQ6IFNvbHZlbnQ7XHJcbiAgcHVibGljIHJlYWRvbmx5IHNvbHV0ZVByb3BlcnR5OiBQcm9wZXJ0eTxTb2x1dGU+O1xyXG4gIHB1YmxpYyByZWFkb25seSBzb2x1dGVNb2xlc1Byb3BlcnR5OiBQcm9wZXJ0eTxudW1iZXI+OyAvLyB0b3RhbCBzb2x1dGUsIGRpc3NvbHZlZCBhbmQgcHJlY2lwaXRhdGUsIGluIG1vbFxyXG4gIHB1YmxpYyByZWFkb25seSB2b2x1bWVQcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyPjsgLy8gTFxyXG5cclxuICAvLyBmb3IgZGVmZXJyaW5nIHVwZGF0ZSBvZiBwcmVjaXBpdGF0ZUFtb3VudCB1bnRpbCB3ZSd2ZSBjaGFuZ2VkIGJvdGggdm9sdW1lIGFuZCBzb2x1dGVBbW91bnRcclxuICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2NvbmNlbnRyYXRpb24vaXNzdWVzLzFcclxuICBwdWJsaWMgdXBkYXRlUHJlY2lwaXRhdGVBbW91bnQ6IGJvb2xlYW47XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBwcmVjaXBpdGF0ZU1vbGVzUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47IC8vIG1vbFxyXG4gIHB1YmxpYyByZWFkb25seSBjb25jZW50cmF0aW9uUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47IC8vIE1cclxuICBwdWJsaWMgcmVhZG9ubHkgaXNTYXR1cmF0ZWRQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj47XHJcbiAgcHVibGljIHJlYWRvbmx5IHNvbHV0ZUdyYW1zUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47IC8vIHNvbHV0ZSBkaXNzb2x2ZWQgaW4gc29sdXRpb24sIGluIGdyYW1zXHJcbiAgcHVibGljIHJlYWRvbmx5IHBlcmNlbnRDb25jZW50cmF0aW9uUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47IC8vIFswLDEwMF1cclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBzb2x1dGVQcm9wZXJ0eTogUHJvcGVydHk8U29sdXRlPixcclxuICAgICAgICAgICAgICAgICAgICAgIHNvbHV0ZUFtb3VudFJhbmdlOiBSYW5nZVdpdGhWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgIHZvbHVtZVJhbmdlOiBSYW5nZVdpdGhWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVkT3B0aW9uczogQ29uY2VudHJhdGlvblNvbHV0aW9uT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPENvbmNlbnRyYXRpb25Tb2x1dGlvbk9wdGlvbnMsIFNlbGZPcHRpb25zPigpKCB7XHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdUaGUgc29sdXRpb24gaW4gdGhlIGJlYWtlcidcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IHNvbHZlbnQgPSBTb2x2ZW50LldBVEVSO1xyXG5cclxuICAgIHN1cGVyKCBDb25jZW50cmF0aW9uU29sdXRpb24uY3JlYXRlQ29sb3IoIHNvbHZlbnQsIHNvbHV0ZVByb3BlcnR5LnZhbHVlLCAwICkgKTtcclxuXHJcbiAgICB0aGlzLnNvbHZlbnQgPSBzb2x2ZW50O1xyXG5cclxuICAgIHRoaXMuc29sdXRlUHJvcGVydHkgPSBzb2x1dGVQcm9wZXJ0eTtcclxuXHJcbiAgICB0aGlzLnNvbHV0ZU1vbGVzUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIHNvbHV0ZUFtb3VudFJhbmdlLmRlZmF1bHRWYWx1ZSwge1xyXG4gICAgICB1bml0czogJ21vbCcsXHJcbiAgICAgIHJhbmdlOiBzb2x1dGVBbW91bnRSYW5nZSxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdzb2x1dGVNb2xlc1Byb3BlcnR5JyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy52b2x1bWVQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggdm9sdW1lUmFuZ2UuZGVmYXVsdFZhbHVlLCB7XHJcbiAgICAgIHVuaXRzOiAnTCcsXHJcbiAgICAgIHJhbmdlOiB2b2x1bWVSYW5nZSxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICd2b2x1bWVQcm9wZXJ0eScgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMudXBkYXRlUHJlY2lwaXRhdGVBbW91bnQgPSB0cnVlO1xyXG5cclxuICAgIHRoaXMucHJlY2lwaXRhdGVNb2xlc1Byb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyB0aGlzLnNvbHV0ZVByb3BlcnR5LCB0aGlzLnNvbHV0ZU1vbGVzUHJvcGVydHksIHRoaXMudm9sdW1lUHJvcGVydHkgXSxcclxuICAgICAgKCBzb2x1dGUsIHNvbHV0ZU1vbGVzLCB2b2x1bWUgKSA9PiB7XHJcbiAgICAgICAgaWYgKCB0aGlzLnVwZGF0ZVByZWNpcGl0YXRlQW1vdW50ICkge1xyXG4gICAgICAgICAgcmV0dXJuIE1hdGgubWF4KCAwLCBzb2x1dGVNb2xlcyAtICggdm9sdW1lICogdGhpcy5nZXRTYXR1cmF0ZWRDb25jZW50cmF0aW9uKCkgKSApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLnByZWNpcGl0YXRlTW9sZXNQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIHtcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3ByZWNpcGl0YXRlTW9sZXNQcm9wZXJ0eScgKSxcclxuICAgICAgICB1bml0czogJ21vbCcsXHJcbiAgICAgICAgcGhldGlvVmFsdWVUeXBlOiBOdW1iZXJJT1xyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuY29uY2VudHJhdGlvblByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyB0aGlzLnNvbHV0ZVByb3BlcnR5LCB0aGlzLnNvbHV0ZU1vbGVzUHJvcGVydHksIHRoaXMudm9sdW1lUHJvcGVydHkgXSxcclxuICAgICAgKCBzb2x1dGUsIHNvbHV0ZU1vbGVzLCB2b2x1bWUgKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuICggdm9sdW1lID4gMCApID8gTWF0aC5taW4oIHRoaXMuZ2V0U2F0dXJhdGVkQ29uY2VudHJhdGlvbigpLCBzb2x1dGVNb2xlcyAvIHZvbHVtZSApIDogMDtcclxuICAgICAgfSwge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnY29uY2VudHJhdGlvblByb3BlcnR5JyApLFxyXG4gICAgICAgIHVuaXRzOiAnbW9sL0wnLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVtYmVySU9cclxuICAgICAgfVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLmlzU2F0dXJhdGVkUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICBbIHRoaXMuc29sdXRlUHJvcGVydHksIHRoaXMuc29sdXRlTW9sZXNQcm9wZXJ0eSwgdGhpcy52b2x1bWVQcm9wZXJ0eSBdLFxyXG4gICAgICAoIHNvbHV0ZSwgc29sdXRlTW9sZXMsIHZvbHVtZSApID0+IHtcclxuICAgICAgICByZXR1cm4gKCB2b2x1bWUgPiAwICkgJiYgKCBzb2x1dGVNb2xlcyAvIHZvbHVtZSApID4gc29sdXRlLmdldFNhdHVyYXRlZENvbmNlbnRyYXRpb24oKTtcclxuICAgICAgfSwge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnaXNTYXR1cmF0ZWRQcm9wZXJ0eScgKSxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IEJvb2xlYW5JT1xyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuc29sdXRlR3JhbXNQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5zb2x1dGVQcm9wZXJ0eSwgdGhpcy5zb2x1dGVNb2xlc1Byb3BlcnR5LCB0aGlzLnByZWNpcGl0YXRlTW9sZXNQcm9wZXJ0eSBdLFxyXG4gICAgICAoIHNvbHV0ZSwgc29sdXRlTW9sZXMsIHByZWNpcGl0YXRlTW9sZXMgKSA9PiB7XHJcblxyXG4gICAgICAgIC8vIFVzZSBNYXRoLm1heCB0byBwcmV2ZW50IGEgbmVnYXRpdmUgdmFsdWUgZHVyaW5nIGludGVybWVkaWF0ZSBzdGF0ZXMuXHJcbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9iZWVycy1sYXctbGFiL2lzc3Vlcy8yNTNcclxuICAgICAgICBjb25zdCBzb2x1dGVHcmFtcyA9IHNvbHV0ZS5tb2xhck1hc3MgKiBNYXRoLm1heCggMCwgc29sdXRlTW9sZXMgLSBwcmVjaXBpdGF0ZU1vbGVzICk7XHJcbiAgICAgICAgYXNzZXJ0ICYmIGFzc2VydCggc29sdXRlR3JhbXMgPj0gMCwgYGludmFsaWQgc29sdXRlR3JhbXM6ICR7c29sdXRlR3JhbXN9YCApO1xyXG4gICAgICAgIHJldHVybiBzb2x1dGVHcmFtcztcclxuICAgICAgfSwge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnc29sdXRlR3JhbXNQcm9wZXJ0eScgKSxcclxuICAgICAgICB1bml0czogJ2cnLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVtYmVySU9cclxuICAgICAgfVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLnBlcmNlbnRDb25jZW50cmF0aW9uUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICBbIHRoaXMudm9sdW1lUHJvcGVydHksIHRoaXMuc29sdXRlR3JhbXNQcm9wZXJ0eSBdLFxyXG4gICAgICAoIHZvbHVtZSwgc29sdXRlR3JhbXMgKSA9PiB7XHJcbiAgICAgICAgbGV0IHBlcmNlbnRDb25jZW50cmF0aW9uID0gMDtcclxuICAgICAgICBpZiAoIHZvbHVtZSA+IDAgKSB7XHJcbiAgICAgICAgICBjb25zdCBzb2x2ZW50R3JhbXMgPSB2b2x1bWUgKiB0aGlzLnNvbHZlbnQuZGVuc2l0eTtcclxuICAgICAgICAgIHBlcmNlbnRDb25jZW50cmF0aW9uID0gMTAwICogKCBzb2x1dGVHcmFtcyAvICggc29sdXRlR3JhbXMgKyBzb2x2ZW50R3JhbXMgKSApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhc3NlcnQgJiYgYXNzZXJ0KCBwZXJjZW50Q29uY2VudHJhdGlvbiA+PSAwICYmIHBlcmNlbnRDb25jZW50cmF0aW9uIDw9IDEwMCxcclxuICAgICAgICAgIGBwZXJjZW50Q29uY2VudHJhdGlvbiBvdXQgb2YgcmFuZ2U6ICR7cGVyY2VudENvbmNlbnRyYXRpb259YCApO1xyXG4gICAgICAgIHJldHVybiBwZXJjZW50Q29uY2VudHJhdGlvbjtcclxuICAgICAgfSwge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncGVyY2VudENvbmNlbnRyYXRpb25Qcm9wZXJ0eScgKSxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bWJlcklPLFxyXG4gICAgICAgIHVuaXRzOiAnJScsXHJcbiAgICAgICAgcGhldGlvRG9jdW1lbnRhdGlvbjogJ0NhbGN1bGF0ZWQgYXMgYSBtYXNzIHBlcmNlbnQuJ1xyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIGRlcml2ZSB0aGUgc29sdXRpb24gY29sb3JcclxuICAgIGNvbnN0IHVwZGF0ZUNvbG9yID0gKCkgPT4ge1xyXG4gICAgICB0aGlzLmNvbG9yUHJvcGVydHkudmFsdWUgPVxyXG4gICAgICAgIENvbmNlbnRyYXRpb25Tb2x1dGlvbi5jcmVhdGVDb2xvciggdGhpcy5zb2x2ZW50LCB0aGlzLnNvbHV0ZVByb3BlcnR5LnZhbHVlLCB0aGlzLmNvbmNlbnRyYXRpb25Qcm9wZXJ0eS52YWx1ZSApO1xyXG4gICAgfTtcclxuICAgIHRoaXMuc29sdXRlUHJvcGVydHkubGF6eUxpbmsoIHVwZGF0ZUNvbG9yICk7XHJcbiAgICB0aGlzLmNvbmNlbnRyYXRpb25Qcm9wZXJ0eS5saW5rKCB1cGRhdGVDb2xvciApOyAvLyBsaW5rIHRvIGZvcmNlIHVwZGF0ZSBvZiBjb2xvclxyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBmYWxzZSwgJ2Rpc3Bvc2UgaXMgbm90IHN1cHBvcnRlZCwgZXhpc3RzIGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIHNpbScgKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNldCgpOiB2b2lkIHtcclxuICAgIHN1cGVyLnJlc2V0KCk7XHJcbiAgICB0aGlzLnNvbHV0ZU1vbGVzUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMudm9sdW1lUHJvcGVydHkucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRTYXR1cmF0ZWRDb25jZW50cmF0aW9uKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5zb2x1dGVQcm9wZXJ0eS52YWx1ZS5nZXRTYXR1cmF0ZWRDb25jZW50cmF0aW9uKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0TnVtYmVyT2ZQcmVjaXBpdGF0ZVBhcnRpY2xlcygpOiBudW1iZXIge1xyXG4gICAgbGV0IG51bWJlck9mUGFydGljbGVzID0gVXRpbHMucm91bmRTeW1tZXRyaWMoIHRoaXMuc29sdXRlUHJvcGVydHkudmFsdWUucGFydGljbGVzUGVyTW9sZSAqIHRoaXMucHJlY2lwaXRhdGVNb2xlc1Byb3BlcnR5LnZhbHVlICk7XHJcbiAgICBpZiAoIG51bWJlck9mUGFydGljbGVzID09PSAwICYmIHRoaXMucHJlY2lwaXRhdGVNb2xlc1Byb3BlcnR5LnZhbHVlID4gMCApIHtcclxuICAgICAgbnVtYmVyT2ZQYXJ0aWNsZXMgPSAxO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bWJlck9mUGFydGljbGVzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyBhIGNvbG9yIHRoYXQgY29ycmVzcG9uZHMgdG8gdGhlIHNvbHV0aW9uJ3MgY29uY2VudHJhdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGNyZWF0ZUNvbG9yKCBzb2x2ZW50OiBTb2x2ZW50LCBzb2x1dGU6IFNvbHV0ZSwgY29uY2VudHJhdGlvbjogbnVtYmVyICk6IENvbG9yIHtcclxuICAgIGxldCBjb2xvciA9IHNvbHZlbnQuY29sb3JQcm9wZXJ0eS52YWx1ZTtcclxuICAgIGlmICggY29uY2VudHJhdGlvbiA+IDAgKSB7XHJcbiAgICAgIGNvbG9yID0gc29sdXRlLmNvbG9yU2NoZW1lLmNvbmNlbnRyYXRpb25Ub0NvbG9yKCBjb25jZW50cmF0aW9uICk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29sb3I7XHJcbiAgfVxyXG59XHJcblxyXG5iZWVyc0xhd0xhYi5yZWdpc3RlciggJ0NvbmNlbnRyYXRpb25Tb2x1dGlvbicsIENvbmNlbnRyYXRpb25Tb2x1dGlvbiApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxjQUFjLE1BQU0sdUNBQXVDO0FBSWxFLE9BQU9DLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsU0FBUyxNQUE0Qix1Q0FBdUM7QUFLbkYsT0FBT0MsU0FBUyxNQUFNLDBDQUEwQztBQUNoRSxPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELE9BQU9DLFdBQVcsTUFBTSxzQkFBc0I7QUFDOUMsT0FBT0MsS0FBSyxN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