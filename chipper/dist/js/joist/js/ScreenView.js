// Copyright 2013-2023, University of Colorado Boulder

/**
 * The view portion of a Screen, specifies the layout strategy for the visual view.
 *
 * For the PDOM view, this type creates  the three organizing elements associated with each screen:
 * - The `ScreenSummaryNode` is introductory description that outlines the screen and sets the scene for the user.
 * - The `PlayAreaNode` holds content that is considered the main interaction and pedagogy to be learned from the screen.
 * - The `ControlAreaNode` houses controls and other content that is secondary to the main interaction. Ideally the user
 *       would encounter this after exploring the PlayAreaNode.
 * The screenSummaryNode instance is not available on the ScreenView, instead content can be added to it via a constructor
 * option or `ScreenView.setScreenSummaryContent`. This is because some accessible descriptions in the screen summary
 * are the same throughout all simulations. The playAreaNode and controlAreaNode instances are public, read-only Nodes
 * that are meant to have their pdomOrder and children set to achieve the proper PDOM structure. Do not set
 * `pdomOrder` directly on the ScreenView, as ScreenView set's its own pdomOrder
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import Property from '../../axon/js/Property.js';
import Bounds2 from '../../dot/js/Bounds2.js';
import Matrix3 from '../../dot/js/Matrix3.js';
import optionize from '../../phet-core/js/optionize.js';
import ControlAreaNode from '../../scenery-phet/js/accessibility/nodes/ControlAreaNode.js';
import PlayAreaNode from '../../scenery-phet/js/accessibility/nodes/PlayAreaNode.js';
import ScreenSummaryNode from '../../scenery-phet/js/accessibility/nodes/ScreenSummaryNode.js';
import { Node } from '../../scenery/js/imports.js';
import Tandem from '../../tandem/js/Tandem.js';
import joist from './joist.js';
/*
 * Default width and height for iPad2, iPad3, iPad4 running Safari with default tabs and decorations
 * These bounds were added in Sep 2014 and are based on a screenshot from a non-Retina iPad, in Safari, iOS7.
 * It therefore accounts for the nav bar on the bottom and the space consumed by the browser on the top.
 * As of this writing, this is the resolution being used by PhET's sim designers for their mockups.
 * For more information see https://github.com/phetsims/joist/issues/126
 */
const DEFAULT_LAYOUT_BOUNDS = new Bounds2(0, 0, 1024, 618);

// Documented where the defaults are defined

class ScreenView extends Node {
  // Clients should not set this value

  static DEFAULT_LAYOUT_BOUNDS = DEFAULT_LAYOUT_BOUNDS;
  constructor(providedOptions) {
    const options = optionize()({
      // {Bounds2} the bounds that are safe to draw in on all supported platforms
      layoutBounds: DEFAULT_LAYOUT_BOUNDS.copy(),
      // Node options
      layerSplit: true,
      // so we're not in the same layer as the navbar, etc.
      excludeInvisible: true,
      // so we don't keep invisible screens in the SVG tree

      // phet-io
      // @ts-expect-error include a default for un-instrumented, JavaScript sims
      tandem: Tandem.REQUIRED,
      visiblePropertyOptions: {
        phetioState: false,
        phetioReadOnly: true
      },
      // pdom options
      containerTagName: 'article',
      tagName: 'div',
      // {Node|null} the Node with screen summary content to be added to the ScreenSummaryNode, and into PDOM above
      // the Play Area. This Node is added as a child to the ScreenSummaryNode.
      screenSummaryContent: null,
      // {boolean} whether or not to add the screen summary, play area, and control area Nodes to the PDOM
      includePDOMNodes: true
    }, providedOptions);
    super(options);
    if (assert && this.isPhetioInstrumented()) {
      assert && assert(options.tandem.name === 'view', 'tandem name should be view');
    }

    // the bounds the confine the layout of the view.
    this.layoutBounds = options.layoutBounds;

    // The visible bounds of the ScreenView in ScreenView coordinates.  This includes top/bottom or left/right margins
    // depending on the aspect ratio of the screen.
    // Initialize to defaults, then update as soon as layout() is called, which is before the ScreenView is displayed
    this.visibleBoundsProperty = new Property(options.layoutBounds);

    // this cannot be a label to this ScreenView, because it needs to be focusable.
    this.pdomTitleNode = new Node({
      tagName: 'h1',
      focusHighlight: 'invisible'
    });

    // add children and set accessible order to these to organize and structure the PDOM.
    this.pdomPlayAreaNode = new PlayAreaNode();
    this.pdomControlAreaNode = new ControlAreaNode();

    // This container has the intro "{{SIM}} is an interactive sim, it changes as you . . ."
    this.pdomScreenSummaryNode = new ScreenSummaryNode();

    // keep track of the content added to the summary Node, so that if it is set more than once, the previous one can be
    // removed.
    this.screenSummaryContent = null;

    // at the Node from options in the same way that can be done at any time
    options.screenSummaryContent && this.setScreenSummaryContent(options.screenSummaryContent);

    // To make sure that the title "h1" is the first, focused item on a screen when that screen is selected, toggle the
    // focusability of the title, and then focus it. See https://github.com/phetsims/ratio-and-proportion/issues/321
    this.visibleProperty.lazyLink(visible => {
      if (visible) {
        assert && assert(!this.pdomTitleNode.focusable, 'about to set to be focusable');
        this.pdomTitleNode.focusable = true;
        this.pdomTitleNode.focus();
      } else {
        this.pdomTitleNode.focusable = false;
      }
    });

    // after initial focus, the titleNode should be removed from the focus order
    this.pdomTitleNode.addInputListener({
      blur: () => {
        this.pdomTitleNode.focusable = false;
      }
    });
    this.pdomParentNode = new Node({
      // order of Nodes for the PDOM that makes most sense for graphical rendering, "Play Area" components
      // on top of "Control Area" components.
      children: options.includePDOMNodes ? [this.pdomTitleNode, this.pdomScreenSummaryNode, this.pdomControlAreaNode, this.pdomPlayAreaNode] : [this.pdomTitleNode]
    });
    this.addChild(this.pdomParentNode);

    // pdom - "Play Area" comes before "Control Area" in PDOM
    this.pdomParentNode.pdomOrder = options.includePDOMNodes ? [this.pdomTitleNode, this.pdomScreenSummaryNode, this.pdomPlayAreaNode, this.pdomControlAreaNode] : [this.pdomTitleNode];
  }

  /**
   * This method should not be called because ScreenView defines child Nodes that organize the PDOM structure of a
   * screen. See this.pdomScreenSummaryNode, this.pdomPlayAreaNode, and this.pdomControlAreaNode and set their accessible
   * order accordingly when adding accessible content to the PDOM for this screen.
   */
  setPDOMOrder(pdomOrder) {
    throw new Error('should not need to set accessible order on a ScreenView');
  }

  /**
   * Override to make sure that setting children doesn't blow away Nodes set by ScreenView.
   */
  setChildren(children) {
    Node.prototype.setChildren.call(this, children);

    // mutate may call setChildren before pdomParentNode is constructed
    if (this.pdomParentNode && !this.hasChild(this.pdomParentNode)) {
      this.addChild(this.pdomParentNode);
      this.pdomParentNode.moveToBack();
    }
    return this;
  }

  /**
   * Get the scale to use for laying out the sim components and the navigation bar, so its size will track
   * with the sim size
   * (joist-internal)
   */
  getLayoutScale(viewBounds) {
    return ScreenView.getLayoutScale(this.layoutBounds, viewBounds);
  }

  /**
   * Default layout function uses the layoutWidth and layoutHeight to scale the content (based on whichever is more limiting: width or height)
   * and centers the content in the screen vertically and horizontally
   * This function can be replaced by subclasses that wish to perform their own custom layout.
   * @param viewBounds - desired bounds for the view
   * (joist-internal)
   */
  layout(viewBounds, layoutMatrixOptions) {
    this.matrix = ScreenView.getLayoutMatrix(this.layoutBounds, viewBounds, layoutMatrixOptions);
    this.visibleBoundsProperty.value = this.parentToLocalBounds(viewBounds);
  }

  /**
   * Set the screen summary Node for the PDOM of this Screen View. Prefer passing in a screen summary Node via
   * constructor options, but this method can be used directly when necessary.
   */
  setScreenSummaryContent(node) {
    assert && assert(node !== this.screenSummaryContent, 'this is already the screen summary Node content');
    this.screenSummaryContent && this.pdomScreenSummaryNode.removeChild(this.screenSummaryContent);
    this.screenSummaryContent = node;
    this.pdomScreenSummaryNode.addChild(node);
  }

  /**
   * Set the screen summary Node intro string
   * (joist-internal)
   */
  setScreenSummaryIntroAndTitle(simName, screenDisplayName, simTitle, isMultiScreen) {
    // TODO: Should use PatternStringProperty, see https://github.com/phetsims/joist/issues/885
    this.pdomScreenSummaryNode.setIntroString(simName, screenDisplayName, isMultiScreen);
    this.pdomTitleNode.innerContent = simTitle;
  }

  /**
   * Create the alert content for this ScreenView when the Voicing feature is enabled and the "Overview" button
   * is pressed.
   * Must be implemented if supporting voicing in your ScreenView.
   */
  getVoicingOverviewContent() {
    throw new Error('The ScreenView should implement getVoicingOverviewContent if Voicing is enabled');
  }

  /**
   * Create the alert content for this ScreenView when the Voicing feature is enabled and the "Details" button is
   * pressed.
   * Must be implemented if supporting voicing in your ScreenView.
   */
  getVoicingDetailsContent() {
    throw new Error('The ScreenView should implement getVoicingDetailsContent when the Voicing feature is enabled.');
  }

  /**
   * Create the alert content for this ScreenView when the Voicing feature is enabled and the "Hint" button is pressed.
   * Must be implemented if supporting voicing in your ScreenView.
   */
  getVoicingHintContent() {
    throw new Error('The ScreenView should implement getVoicingHintContent when Voicing is enabled.');
  }

  /**
   * Get the scale to use for laying out the sim components and the navigation bar, so its size will track
   * with the sim size
   */
  static getLayoutScale(layoutBounds, viewBounds) {
    return Math.min(viewBounds.width / layoutBounds.width, viewBounds.height / layoutBounds.height);
  }
  static getLayoutMatrix(layoutBounds, viewBounds, providedOptions) {
    const options = optionize()({
      verticalAlign: 'center' // 'center' or 'bottom'
    }, providedOptions);
    const width = viewBounds.width;
    const height = viewBounds.height;
    const scale = ScreenView.getLayoutScale(layoutBounds, viewBounds);
    let dx = 0;
    let dy = 0;
    if (scale === width / layoutBounds.width) {
      // vertically float to bottom
      dy = height / scale - layoutBounds.height;

      // center vertically
      if (options.verticalAlign === 'center') {
        dy /= 2;
      }
    } else if (scale === height / layoutBounds.height) {
      // center horizontally
      dx = (width / scale - layoutBounds.width) / 2;
    }
    return Matrix3.rowMajor(scale, 0, dx * scale + viewBounds.left, 0, scale, dy * scale + viewBounds.top, 0, 0, 1);
  }

  // Noops for consistent API
  step(dt) {
    // See subclass for implementation
  }
}
joist.register('ScreenView', ScreenView);
export default ScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIkJvdW5kczIiLCJNYXRyaXgzIiwib3B0aW9uaXplIiwiQ29udHJvbEFyZWFOb2RlIiwiUGxheUFyZWFOb2RlIiwiU2NyZWVuU3VtbWFyeU5vZGUiLCJOb2RlIiwiVGFuZGVtIiwiam9pc3QiLCJERUZBVUxUX0xBWU9VVF9CT1VORFMiLCJTY3JlZW5WaWV3IiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwibGF5b3V0Qm91bmRzIiwiY29weSIsImxheWVyU3BsaXQiLCJleGNsdWRlSW52aXNpYmxlIiwidGFuZGVtIiwiUkVRVUlSRUQiLCJ2aXNpYmxlUHJvcGVydHlPcHRpb25zIiwicGhldGlvU3RhdGUiLCJwaGV0aW9SZWFkT25seSIsImNvbnRhaW5lclRhZ05hbWUiLCJ0YWdOYW1lIiwic2NyZWVuU3VtbWFyeUNvbnRlbnQiLCJpbmNsdWRlUERPTU5vZGVzIiwiYXNzZXJ0IiwiaXNQaGV0aW9JbnN0cnVtZW50ZWQiLCJuYW1lIiwidmlzaWJsZUJvdW5kc1Byb3BlcnR5IiwicGRvbVRpdGxlTm9kZSIsImZvY3VzSGlnaGxpZ2h0IiwicGRvbVBsYXlBcmVhTm9kZSIsInBkb21Db250cm9sQXJlYU5vZGUiLCJwZG9tU2NyZWVuU3VtbWFyeU5vZGUiLCJzZXRTY3JlZW5TdW1tYXJ5Q29udGVudCIsInZpc2libGVQcm9wZXJ0eSIsImxhenlMaW5rIiwidmlzaWJsZSIsImZvY3VzYWJsZSIsImZvY3VzIiwiYWRkSW5wdXRMaXN0ZW5lciIsImJsdXIiLCJwZG9tUGFyZW50Tm9kZSIsImNoaWxkcmVuIiwiYWRkQ2hpbGQiLCJwZG9tT3JkZXIiLCJzZXRQRE9NT3JkZXIiLCJFcnJvciIsInNldENoaWxkcmVuIiwicHJvdG90eXBlIiwiY2FsbCIsImhhc0NoaWxkIiwibW92ZVRvQmFjayIsImdldExheW91dFNjYWxlIiwidmlld0JvdW5kcyIsImxheW91dCIsImxheW91dE1hdHJpeE9wdGlvbnMiLCJtYXRyaXgiLCJnZXRMYXlvdXRNYXRyaXgiLCJ2YWx1ZSIsInBhcmVudFRvTG9jYWxCb3VuZHMiLCJub2RlIiwicmVtb3ZlQ2hpbGQiLCJzZXRTY3JlZW5TdW1tYXJ5SW50cm9BbmRUaXRsZSIsInNpbU5hbWUiLCJzY3JlZW5EaXNwbGF5TmFtZSIsInNpbVRpdGxlIiwiaXNNdWx0aVNjcmVlbiIsInNldEludHJvU3RyaW5nIiwiaW5uZXJDb250ZW50IiwiZ2V0Vm9pY2luZ092ZXJ2aWV3Q29udGVudCIsImdldFZvaWNpbmdEZXRhaWxzQ29udGVudCIsImdldFZvaWNpbmdIaW50Q29udGVudCIsIk1hdGgiLCJtaW4iLCJ3aWR0aCIsImhlaWdodCIsInZlcnRpY2FsQWxpZ24iLCJzY2FsZSIsImR4IiwiZHkiLCJyb3dNYWpvciIsImxlZnQiLCJ0b3AiLCJzdGVwIiwiZHQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlNjcmVlblZpZXcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTMtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogVGhlIHZpZXcgcG9ydGlvbiBvZiBhIFNjcmVlbiwgc3BlY2lmaWVzIHRoZSBsYXlvdXQgc3RyYXRlZ3kgZm9yIHRoZSB2aXN1YWwgdmlldy5cclxuICpcclxuICogRm9yIHRoZSBQRE9NIHZpZXcsIHRoaXMgdHlwZSBjcmVhdGVzICB0aGUgdGhyZWUgb3JnYW5pemluZyBlbGVtZW50cyBhc3NvY2lhdGVkIHdpdGggZWFjaCBzY3JlZW46XHJcbiAqIC0gVGhlIGBTY3JlZW5TdW1tYXJ5Tm9kZWAgaXMgaW50cm9kdWN0b3J5IGRlc2NyaXB0aW9uIHRoYXQgb3V0bGluZXMgdGhlIHNjcmVlbiBhbmQgc2V0cyB0aGUgc2NlbmUgZm9yIHRoZSB1c2VyLlxyXG4gKiAtIFRoZSBgUGxheUFyZWFOb2RlYCBob2xkcyBjb250ZW50IHRoYXQgaXMgY29uc2lkZXJlZCB0aGUgbWFpbiBpbnRlcmFjdGlvbiBhbmQgcGVkYWdvZ3kgdG8gYmUgbGVhcm5lZCBmcm9tIHRoZSBzY3JlZW4uXHJcbiAqIC0gVGhlIGBDb250cm9sQXJlYU5vZGVgIGhvdXNlcyBjb250cm9scyBhbmQgb3RoZXIgY29udGVudCB0aGF0IGlzIHNlY29uZGFyeSB0byB0aGUgbWFpbiBpbnRlcmFjdGlvbi4gSWRlYWxseSB0aGUgdXNlclxyXG4gKiAgICAgICB3b3VsZCBlbmNvdW50ZXIgdGhpcyBhZnRlciBleHBsb3JpbmcgdGhlIFBsYXlBcmVhTm9kZS5cclxuICogVGhlIHNjcmVlblN1bW1hcnlOb2RlIGluc3RhbmNlIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIFNjcmVlblZpZXcsIGluc3RlYWQgY29udGVudCBjYW4gYmUgYWRkZWQgdG8gaXQgdmlhIGEgY29uc3RydWN0b3JcclxuICogb3B0aW9uIG9yIGBTY3JlZW5WaWV3LnNldFNjcmVlblN1bW1hcnlDb250ZW50YC4gVGhpcyBpcyBiZWNhdXNlIHNvbWUgYWNjZXNzaWJsZSBkZXNjcmlwdGlvbnMgaW4gdGhlIHNjcmVlbiBzdW1tYXJ5XHJcbiAqIGFyZSB0aGUgc2FtZSB0aHJvdWdob3V0IGFsbCBzaW11bGF0aW9ucy4gVGhlIHBsYXlBcmVhTm9kZSBhbmQgY29udHJvbEFyZWFOb2RlIGluc3RhbmNlcyBhcmUgcHVibGljLCByZWFkLW9ubHkgTm9kZXNcclxuICogdGhhdCBhcmUgbWVhbnQgdG8gaGF2ZSB0aGVpciBwZG9tT3JkZXIgYW5kIGNoaWxkcmVuIHNldCB0byBhY2hpZXZlIHRoZSBwcm9wZXIgUERPTSBzdHJ1Y3R1cmUuIERvIG5vdCBzZXRcclxuICogYHBkb21PcmRlcmAgZGlyZWN0bHkgb24gdGhlIFNjcmVlblZpZXcsIGFzIFNjcmVlblZpZXcgc2V0J3MgaXRzIG93biBwZG9tT3JkZXJcclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBCb3VuZHMyIGZyb20gJy4uLy4uL2RvdC9qcy9Cb3VuZHMyLmpzJztcclxuaW1wb3J0IE1hdHJpeDMgZnJvbSAnLi4vLi4vZG90L2pzL01hdHJpeDMuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgQ29udHJvbEFyZWFOb2RlIGZyb20gJy4uLy4uL3NjZW5lcnktcGhldC9qcy9hY2Nlc3NpYmlsaXR5L25vZGVzL0NvbnRyb2xBcmVhTm9kZS5qcyc7XHJcbmltcG9ydCBQbGF5QXJlYU5vZGUgZnJvbSAnLi4vLi4vc2NlbmVyeS1waGV0L2pzL2FjY2Vzc2liaWxpdHkvbm9kZXMvUGxheUFyZWFOb2RlLmpzJztcclxuaW1wb3J0IFNjcmVlblN1bW1hcnlOb2RlIGZyb20gJy4uLy4uL3NjZW5lcnktcGhldC9qcy9hY2Nlc3NpYmlsaXR5L25vZGVzL1NjcmVlblN1bW1hcnlOb2RlLmpzJztcclxuaW1wb3J0IHsgTm9kZSwgTm9kZU9wdGlvbnMgfSBmcm9tICcuLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgam9pc3QgZnJvbSAnLi9qb2lzdC5qcyc7XHJcbmltcG9ydCBXaXRoUmVxdWlyZWQgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1dpdGhSZXF1aXJlZC5qcyc7XHJcbmltcG9ydCB7IFNwZWFrYWJsZVJlc29sdmVkUmVzcG9uc2UgfSBmcm9tICcuLi8uLi91dHRlcmFuY2UtcXVldWUvanMvUmVzcG9uc2VQYWNrZXQuanMnO1xyXG5cclxuLypcclxuICogRGVmYXVsdCB3aWR0aCBhbmQgaGVpZ2h0IGZvciBpUGFkMiwgaVBhZDMsIGlQYWQ0IHJ1bm5pbmcgU2FmYXJpIHdpdGggZGVmYXVsdCB0YWJzIGFuZCBkZWNvcmF0aW9uc1xyXG4gKiBUaGVzZSBib3VuZHMgd2VyZSBhZGRlZCBpbiBTZXAgMjAxNCBhbmQgYXJlIGJhc2VkIG9uIGEgc2NyZWVuc2hvdCBmcm9tIGEgbm9uLVJldGluYSBpUGFkLCBpbiBTYWZhcmksIGlPUzcuXHJcbiAqIEl0IHRoZXJlZm9yZSBhY2NvdW50cyBmb3IgdGhlIG5hdiBiYXIgb24gdGhlIGJvdHRvbSBhbmQgdGhlIHNwYWNlIGNvbnN1bWVkIGJ5IHRoZSBicm93c2VyIG9uIHRoZSB0b3AuXHJcbiAqIEFzIG9mIHRoaXMgd3JpdGluZywgdGhpcyBpcyB0aGUgcmVzb2x1dGlvbiBiZWluZyB1c2VkIGJ5IFBoRVQncyBzaW0gZGVzaWduZXJzIGZvciB0aGVpciBtb2NrdXBzLlxyXG4gKiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2pvaXN0L2lzc3Vlcy8xMjZcclxuICovXHJcbmNvbnN0IERFRkFVTFRfTEFZT1VUX0JPVU5EUyA9IG5ldyBCb3VuZHMyKCAwLCAwLCAxMDI0LCA2MTggKTtcclxuXHJcbnR5cGUgR2V0TGF5b3V0TWF0cml4T3B0aW9ucyA9IHtcclxuICB2ZXJ0aWNhbEFsaWduPzogJ2NlbnRlcicgfCAnYm90dG9tJztcclxufTtcclxuXHJcbi8vIERvY3VtZW50ZWQgd2hlcmUgdGhlIGRlZmF1bHRzIGFyZSBkZWZpbmVkXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgbGF5b3V0Qm91bmRzPzogQm91bmRzMjtcclxuICBzY3JlZW5TdW1tYXJ5Q29udGVudD86IE5vZGUgfCBudWxsO1xyXG4gIGluY2x1ZGVQRE9NTm9kZXM/OiBib29sZWFuO1xyXG59O1xyXG5leHBvcnQgdHlwZSBTY3JlZW5WaWV3T3B0aW9ucyA9IFNlbGZPcHRpb25zICYgV2l0aFJlcXVpcmVkPE5vZGVPcHRpb25zLCAndGFuZGVtJz47XHJcblxyXG5jbGFzcyBTY3JlZW5WaWV3IGV4dGVuZHMgTm9kZSB7XHJcbiAgcHVibGljIHJlYWRvbmx5IGxheW91dEJvdW5kczogQm91bmRzMjtcclxuICBwdWJsaWMgcmVhZG9ubHkgdmlzaWJsZUJvdW5kc1Byb3BlcnR5OiBQcm9wZXJ0eTxCb3VuZHMyPjsgLy8gQ2xpZW50cyBzaG91bGQgbm90IHNldCB0aGlzIHZhbHVlXHJcbiAgcHJpdmF0ZSByZWFkb25seSBwZG9tVGl0bGVOb2RlOiBOb2RlO1xyXG4gIHByb3RlY3RlZCByZWFkb25seSBwZG9tUGxheUFyZWFOb2RlOiBQbGF5QXJlYU5vZGU7XHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHBkb21Db250cm9sQXJlYU5vZGU6IENvbnRyb2xBcmVhTm9kZTtcclxuICBwcml2YXRlIHJlYWRvbmx5IHBkb21TY3JlZW5TdW1tYXJ5Tm9kZTogU2NyZWVuU3VtbWFyeU5vZGU7XHJcbiAgcHJpdmF0ZSBzY3JlZW5TdW1tYXJ5Q29udGVudDogTm9kZSB8IG51bGw7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBwZG9tUGFyZW50Tm9kZTogTm9kZTtcclxuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBERUZBVUxUX0xBWU9VVF9CT1VORFMgPSBERUZBVUxUX0xBWU9VVF9CT1VORFM7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcHJvdmlkZWRPcHRpb25zOiBTY3JlZW5WaWV3T3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFNjcmVlblZpZXdPcHRpb25zLCBTZWxmT3B0aW9ucywgTm9kZU9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIHtCb3VuZHMyfSB0aGUgYm91bmRzIHRoYXQgYXJlIHNhZmUgdG8gZHJhdyBpbiBvbiBhbGwgc3VwcG9ydGVkIHBsYXRmb3Jtc1xyXG4gICAgICBsYXlvdXRCb3VuZHM6IERFRkFVTFRfTEFZT1VUX0JPVU5EUy5jb3B5KCksXHJcblxyXG4gICAgICAvLyBOb2RlIG9wdGlvbnNcclxuICAgICAgbGF5ZXJTcGxpdDogdHJ1ZSwgLy8gc28gd2UncmUgbm90IGluIHRoZSBzYW1lIGxheWVyIGFzIHRoZSBuYXZiYXIsIGV0Yy5cclxuICAgICAgZXhjbHVkZUludmlzaWJsZTogdHJ1ZSwgLy8gc28gd2UgZG9uJ3Qga2VlcCBpbnZpc2libGUgc2NyZWVucyBpbiB0aGUgU1ZHIHRyZWVcclxuXHJcbiAgICAgIC8vIHBoZXQtaW9cclxuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBpbmNsdWRlIGEgZGVmYXVsdCBmb3IgdW4taW5zdHJ1bWVudGVkLCBKYXZhU2NyaXB0IHNpbXNcclxuICAgICAgdGFuZGVtOiBUYW5kZW0uUkVRVUlSRUQsXHJcbiAgICAgIHZpc2libGVQcm9wZXJ0eU9wdGlvbnM6IHtcclxuICAgICAgICBwaGV0aW9TdGF0ZTogZmFsc2UsXHJcbiAgICAgICAgcGhldGlvUmVhZE9ubHk6IHRydWVcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIHBkb20gb3B0aW9uc1xyXG4gICAgICBjb250YWluZXJUYWdOYW1lOiAnYXJ0aWNsZScsXHJcbiAgICAgIHRhZ05hbWU6ICdkaXYnLFxyXG5cclxuICAgICAgLy8ge05vZGV8bnVsbH0gdGhlIE5vZGUgd2l0aCBzY3JlZW4gc3VtbWFyeSBjb250ZW50IHRvIGJlIGFkZGVkIHRvIHRoZSBTY3JlZW5TdW1tYXJ5Tm9kZSwgYW5kIGludG8gUERPTSBhYm92ZVxyXG4gICAgICAvLyB0aGUgUGxheSBBcmVhLiBUaGlzIE5vZGUgaXMgYWRkZWQgYXMgYSBjaGlsZCB0byB0aGUgU2NyZWVuU3VtbWFyeU5vZGUuXHJcbiAgICAgIHNjcmVlblN1bW1hcnlDb250ZW50OiBudWxsLFxyXG5cclxuICAgICAgLy8ge2Jvb2xlYW59IHdoZXRoZXIgb3Igbm90IHRvIGFkZCB0aGUgc2NyZWVuIHN1bW1hcnksIHBsYXkgYXJlYSwgYW5kIGNvbnRyb2wgYXJlYSBOb2RlcyB0byB0aGUgUERPTVxyXG4gICAgICBpbmNsdWRlUERPTU5vZGVzOiB0cnVlXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIGlmICggYXNzZXJ0ICYmIHRoaXMuaXNQaGV0aW9JbnN0cnVtZW50ZWQoKSApIHtcclxuICAgICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy50YW5kZW0ubmFtZSA9PT0gJ3ZpZXcnLCAndGFuZGVtIG5hbWUgc2hvdWxkIGJlIHZpZXcnICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdGhlIGJvdW5kcyB0aGUgY29uZmluZSB0aGUgbGF5b3V0IG9mIHRoZSB2aWV3LlxyXG4gICAgdGhpcy5sYXlvdXRCb3VuZHMgPSBvcHRpb25zLmxheW91dEJvdW5kcztcclxuXHJcbiAgICAvLyBUaGUgdmlzaWJsZSBib3VuZHMgb2YgdGhlIFNjcmVlblZpZXcgaW4gU2NyZWVuVmlldyBjb29yZGluYXRlcy4gIFRoaXMgaW5jbHVkZXMgdG9wL2JvdHRvbSBvciBsZWZ0L3JpZ2h0IG1hcmdpbnNcclxuICAgIC8vIGRlcGVuZGluZyBvbiB0aGUgYXNwZWN0IHJhdGlvIG9mIHRoZSBzY3JlZW4uXHJcbiAgICAvLyBJbml0aWFsaXplIHRvIGRlZmF1bHRzLCB0aGVuIHVwZGF0ZSBhcyBzb29uIGFzIGxheW91dCgpIGlzIGNhbGxlZCwgd2hpY2ggaXMgYmVmb3JlIHRoZSBTY3JlZW5WaWV3IGlzIGRpc3BsYXllZFxyXG4gICAgdGhpcy52aXNpYmxlQm91bmRzUHJvcGVydHkgPSBuZXcgUHJvcGVydHkoIG9wdGlvbnMubGF5b3V0Qm91bmRzICk7XHJcblxyXG4gICAgLy8gdGhpcyBjYW5ub3QgYmUgYSBsYWJlbCB0byB0aGlzIFNjcmVlblZpZXcsIGJlY2F1c2UgaXQgbmVlZHMgdG8gYmUgZm9jdXNhYmxlLlxyXG4gICAgdGhpcy5wZG9tVGl0bGVOb2RlID0gbmV3IE5vZGUoIHsgdGFnTmFtZTogJ2gxJywgZm9jdXNIaWdobGlnaHQ6ICdpbnZpc2libGUnIH0gKTtcclxuXHJcbiAgICAvLyBhZGQgY2hpbGRyZW4gYW5kIHNldCBhY2Nlc3NpYmxlIG9yZGVyIHRvIHRoZXNlIHRvIG9yZ2FuaXplIGFuZCBzdHJ1Y3R1cmUgdGhlIFBET00uXHJcbiAgICB0aGlzLnBkb21QbGF5QXJlYU5vZGUgPSBuZXcgUGxheUFyZWFOb2RlKCk7XHJcbiAgICB0aGlzLnBkb21Db250cm9sQXJlYU5vZGUgPSBuZXcgQ29udHJvbEFyZWFOb2RlKCk7XHJcblxyXG4gICAgLy8gVGhpcyBjb250YWluZXIgaGFzIHRoZSBpbnRybyBcInt7U0lNfX0gaXMgYW4gaW50ZXJhY3RpdmUgc2ltLCBpdCBjaGFuZ2VzIGFzIHlvdSAuIC4gLlwiXHJcbiAgICB0aGlzLnBkb21TY3JlZW5TdW1tYXJ5Tm9kZSA9IG5ldyBTY3JlZW5TdW1tYXJ5Tm9kZSgpO1xyXG5cclxuICAgIC8vIGtlZXAgdHJhY2sgb2YgdGhlIGNvbnRlbnQgYWRkZWQgdG8gdGhlIHN1bW1hcnkgTm9kZSwgc28gdGhhdCBpZiBpdCBpcyBzZXQgbW9yZSB0aGFuIG9uY2UsIHRoZSBwcmV2aW91cyBvbmUgY2FuIGJlXHJcbiAgICAvLyByZW1vdmVkLlxyXG4gICAgdGhpcy5zY3JlZW5TdW1tYXJ5Q29udGVudCA9IG51bGw7XHJcblxyXG4gICAgLy8gYXQgdGhlIE5vZGUgZnJvbSBvcHRpb25zIGluIHRoZSBzYW1lIHdheSB0aGF0IGNhbiBiZSBkb25lIGF0IGFueSB0aW1lXHJcbiAgICBvcHRpb25zLnNjcmVlblN1bW1hcnlDb250ZW50ICYmIHRoaXMuc2V0U2NyZWVuU3VtbWFyeUNvbnRlbnQoIG9wdGlvbnMuc2NyZWVuU3VtbWFyeUNvbnRlbnQgKTtcclxuXHJcbiAgICAvLyBUbyBtYWtlIHN1cmUgdGhhdCB0aGUgdGl0bGUgXCJoMVwiIGlzIHRoZSBmaXJzdCwgZm9jdXNlZCBpdGVtIG9uIGEgc2NyZWVuIHdoZW4gdGhhdCBzY3JlZW4gaXMgc2VsZWN0ZWQsIHRvZ2dsZSB0aGVcclxuICAgIC8vIGZvY3VzYWJpbGl0eSBvZiB0aGUgdGl0bGUsIGFuZCB0aGVuIGZvY3VzIGl0LiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3JhdGlvLWFuZC1wcm9wb3J0aW9uL2lzc3Vlcy8zMjFcclxuICAgIHRoaXMudmlzaWJsZVByb3BlcnR5LmxhenlMaW5rKCB2aXNpYmxlID0+IHtcclxuICAgICAgaWYgKCB2aXNpYmxlICkge1xyXG4gICAgICAgIGFzc2VydCAmJiBhc3NlcnQoICF0aGlzLnBkb21UaXRsZU5vZGUuZm9jdXNhYmxlLCAnYWJvdXQgdG8gc2V0IHRvIGJlIGZvY3VzYWJsZScgKTtcclxuICAgICAgICB0aGlzLnBkb21UaXRsZU5vZGUuZm9jdXNhYmxlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnBkb21UaXRsZU5vZGUuZm9jdXMoKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB0aGlzLnBkb21UaXRsZU5vZGUuZm9jdXNhYmxlID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBhZnRlciBpbml0aWFsIGZvY3VzLCB0aGUgdGl0bGVOb2RlIHNob3VsZCBiZSByZW1vdmVkIGZyb20gdGhlIGZvY3VzIG9yZGVyXHJcbiAgICB0aGlzLnBkb21UaXRsZU5vZGUuYWRkSW5wdXRMaXN0ZW5lcigge1xyXG4gICAgICBibHVyOiAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5wZG9tVGl0bGVOb2RlLmZvY3VzYWJsZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5wZG9tUGFyZW50Tm9kZSA9IG5ldyBOb2RlKCB7XHJcblxyXG4gICAgICAvLyBvcmRlciBvZiBOb2RlcyBmb3IgdGhlIFBET00gdGhhdCBtYWtlcyBtb3N0IHNlbnNlIGZvciBncmFwaGljYWwgcmVuZGVyaW5nLCBcIlBsYXkgQXJlYVwiIGNvbXBvbmVudHNcclxuICAgICAgLy8gb24gdG9wIG9mIFwiQ29udHJvbCBBcmVhXCIgY29tcG9uZW50cy5cclxuICAgICAgY2hpbGRyZW46IG9wdGlvbnMuaW5jbHVkZVBET01Ob2RlcyA/IFtcclxuICAgICAgICB0aGlzLnBkb21UaXRsZU5vZGUsXHJcbiAgICAgICAgdGhpcy5wZG9tU2NyZWVuU3VtbWFyeU5vZGUsXHJcbiAgICAgICAgdGhpcy5wZG9tQ29udHJvbEFyZWFOb2RlLFxyXG4gICAgICAgIHRoaXMucGRvbVBsYXlBcmVhTm9kZVxyXG4gICAgICBdIDogWyB0aGlzLnBkb21UaXRsZU5vZGUgXVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5wZG9tUGFyZW50Tm9kZSApO1xyXG5cclxuICAgIC8vIHBkb20gLSBcIlBsYXkgQXJlYVwiIGNvbWVzIGJlZm9yZSBcIkNvbnRyb2wgQXJlYVwiIGluIFBET01cclxuICAgIHRoaXMucGRvbVBhcmVudE5vZGUucGRvbU9yZGVyID0gb3B0aW9ucy5pbmNsdWRlUERPTU5vZGVzID8gW1xyXG4gICAgICB0aGlzLnBkb21UaXRsZU5vZGUsXHJcbiAgICAgIHRoaXMucGRvbVNjcmVlblN1bW1hcnlOb2RlLFxyXG4gICAgICB0aGlzLnBkb21QbGF5QXJlYU5vZGUsXHJcbiAgICAgIHRoaXMucGRvbUNvbnRyb2xBcmVhTm9kZVxyXG4gICAgXSA6IFsgdGhpcy5wZG9tVGl0bGVOb2RlIF07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIG1ldGhvZCBzaG91bGQgbm90IGJlIGNhbGxlZCBiZWNhdXNlIFNjcmVlblZpZXcgZGVmaW5lcyBjaGlsZCBOb2RlcyB0aGF0IG9yZ2FuaXplIHRoZSBQRE9NIHN0cnVjdHVyZSBvZiBhXHJcbiAgICogc2NyZWVuLiBTZWUgdGhpcy5wZG9tU2NyZWVuU3VtbWFyeU5vZGUsIHRoaXMucGRvbVBsYXlBcmVhTm9kZSwgYW5kIHRoaXMucGRvbUNvbnRyb2xBcmVhTm9kZSBhbmQgc2V0IHRoZWlyIGFjY2Vzc2libGVcclxuICAgKiBvcmRlciBhY2NvcmRpbmdseSB3aGVuIGFkZGluZyBhY2Nlc3NpYmxlIGNvbnRlbnQgdG8gdGhlIFBET00gZm9yIHRoaXMgc2NyZWVuLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBzZXRQRE9NT3JkZXIoIHBkb21PcmRlcjogQXJyYXk8Tm9kZSB8IG51bGw+IHwgbnVsbCApOiB2b2lkIHtcclxuICAgIHRocm93IG5ldyBFcnJvciggJ3Nob3VsZCBub3QgbmVlZCB0byBzZXQgYWNjZXNzaWJsZSBvcmRlciBvbiBhIFNjcmVlblZpZXcnICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBPdmVycmlkZSB0byBtYWtlIHN1cmUgdGhhdCBzZXR0aW5nIGNoaWxkcmVuIGRvZXNuJ3QgYmxvdyBhd2F5IE5vZGVzIHNldCBieSBTY3JlZW5WaWV3LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBzZXRDaGlsZHJlbiggY2hpbGRyZW46IE5vZGVbXSApOiB0aGlzIHtcclxuICAgIE5vZGUucHJvdG90eXBlLnNldENoaWxkcmVuLmNhbGwoIHRoaXMsIGNoaWxkcmVuICk7XHJcblxyXG4gICAgLy8gbXV0YXRlIG1heSBjYWxsIHNldENoaWxkcmVuIGJlZm9yZSBwZG9tUGFyZW50Tm9kZSBpcyBjb25zdHJ1Y3RlZFxyXG4gICAgaWYgKCB0aGlzLnBkb21QYXJlbnROb2RlICYmICF0aGlzLmhhc0NoaWxkKCB0aGlzLnBkb21QYXJlbnROb2RlICkgKSB7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMucGRvbVBhcmVudE5vZGUgKTtcclxuICAgICAgdGhpcy5wZG9tUGFyZW50Tm9kZS5tb3ZlVG9CYWNrKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgc2NhbGUgdG8gdXNlIGZvciBsYXlpbmcgb3V0IHRoZSBzaW0gY29tcG9uZW50cyBhbmQgdGhlIG5hdmlnYXRpb24gYmFyLCBzbyBpdHMgc2l6ZSB3aWxsIHRyYWNrXHJcbiAgICogd2l0aCB0aGUgc2ltIHNpemVcclxuICAgKiAoam9pc3QtaW50ZXJuYWwpXHJcbiAgICovXHJcbiAgcHVibGljIGdldExheW91dFNjYWxlKCB2aWV3Qm91bmRzOiBCb3VuZHMyICk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gU2NyZWVuVmlldy5nZXRMYXlvdXRTY2FsZSggdGhpcy5sYXlvdXRCb3VuZHMsIHZpZXdCb3VuZHMgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERlZmF1bHQgbGF5b3V0IGZ1bmN0aW9uIHVzZXMgdGhlIGxheW91dFdpZHRoIGFuZCBsYXlvdXRIZWlnaHQgdG8gc2NhbGUgdGhlIGNvbnRlbnQgKGJhc2VkIG9uIHdoaWNoZXZlciBpcyBtb3JlIGxpbWl0aW5nOiB3aWR0aCBvciBoZWlnaHQpXHJcbiAgICogYW5kIGNlbnRlcnMgdGhlIGNvbnRlbnQgaW4gdGhlIHNjcmVlbiB2ZXJ0aWNhbGx5IGFuZCBob3Jpem9udGFsbHlcclxuICAgKiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSByZXBsYWNlZCBieSBzdWJjbGFzc2VzIHRoYXQgd2lzaCB0byBwZXJmb3JtIHRoZWlyIG93biBjdXN0b20gbGF5b3V0LlxyXG4gICAqIEBwYXJhbSB2aWV3Qm91bmRzIC0gZGVzaXJlZCBib3VuZHMgZm9yIHRoZSB2aWV3XHJcbiAgICogKGpvaXN0LWludGVybmFsKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBsYXlvdXQoIHZpZXdCb3VuZHM6IEJvdW5kczIsIGxheW91dE1hdHJpeE9wdGlvbnM/OiBHZXRMYXlvdXRNYXRyaXhPcHRpb25zICk6IHZvaWQge1xyXG4gICAgdGhpcy5tYXRyaXggPSBTY3JlZW5WaWV3LmdldExheW91dE1hdHJpeCggdGhpcy5sYXlvdXRCb3VuZHMsIHZpZXdCb3VuZHMsIGxheW91dE1hdHJpeE9wdGlvbnMgKTtcclxuICAgIHRoaXMudmlzaWJsZUJvdW5kc1Byb3BlcnR5LnZhbHVlID0gdGhpcy5wYXJlbnRUb0xvY2FsQm91bmRzKCB2aWV3Qm91bmRzICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgdGhlIHNjcmVlbiBzdW1tYXJ5IE5vZGUgZm9yIHRoZSBQRE9NIG9mIHRoaXMgU2NyZWVuIFZpZXcuIFByZWZlciBwYXNzaW5nIGluIGEgc2NyZWVuIHN1bW1hcnkgTm9kZSB2aWFcclxuICAgKiBjb25zdHJ1Y3RvciBvcHRpb25zLCBidXQgdGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZGlyZWN0bHkgd2hlbiBuZWNlc3NhcnkuXHJcbiAgICovXHJcbiAgcHVibGljIHNldFNjcmVlblN1bW1hcnlDb250ZW50KCBub2RlOiBOb2RlICk6IHZvaWQge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggbm9kZSAhPT0gdGhpcy5zY3JlZW5TdW1tYXJ5Q29udGVudCwgJ3RoaXMgaXMgYWxyZWFkeSB0aGUgc2NyZWVuIHN1bW1hcnkgTm9kZSBjb250ZW50JyApO1xyXG5cclxuICAgIHRoaXMuc2NyZWVuU3VtbWFyeUNvbnRlbnQgJiYgdGhpcy5wZG9tU2NyZWVuU3VtbWFyeU5vZGUucmVtb3ZlQ2hpbGQoIHRoaXMuc2NyZWVuU3VtbWFyeUNvbnRlbnQgKTtcclxuXHJcbiAgICB0aGlzLnNjcmVlblN1bW1hcnlDb250ZW50ID0gbm9kZTtcclxuICAgIHRoaXMucGRvbVNjcmVlblN1bW1hcnlOb2RlLmFkZENoaWxkKCBub2RlICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgdGhlIHNjcmVlbiBzdW1tYXJ5IE5vZGUgaW50cm8gc3RyaW5nXHJcbiAgICogKGpvaXN0LWludGVybmFsKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRTY3JlZW5TdW1tYXJ5SW50cm9BbmRUaXRsZSggc2ltTmFtZTogc3RyaW5nLCBzY3JlZW5EaXNwbGF5TmFtZTogc3RyaW5nIHwgbnVsbCwgc2ltVGl0bGU6IHN0cmluZywgaXNNdWx0aVNjcmVlbjogYm9vbGVhbiApOiB2b2lkIHtcclxuICAgIC8vIFRPRE86IFNob3VsZCB1c2UgUGF0dGVyblN0cmluZ1Byb3BlcnR5LCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2pvaXN0L2lzc3Vlcy84ODVcclxuICAgIHRoaXMucGRvbVNjcmVlblN1bW1hcnlOb2RlLnNldEludHJvU3RyaW5nKCBzaW1OYW1lLCBzY3JlZW5EaXNwbGF5TmFtZSwgaXNNdWx0aVNjcmVlbiApO1xyXG4gICAgdGhpcy5wZG9tVGl0bGVOb2RlLmlubmVyQ29udGVudCA9IHNpbVRpdGxlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIHRoZSBhbGVydCBjb250ZW50IGZvciB0aGlzIFNjcmVlblZpZXcgd2hlbiB0aGUgVm9pY2luZyBmZWF0dXJlIGlzIGVuYWJsZWQgYW5kIHRoZSBcIk92ZXJ2aWV3XCIgYnV0dG9uXHJcbiAgICogaXMgcHJlc3NlZC5cclxuICAgKiBNdXN0IGJlIGltcGxlbWVudGVkIGlmIHN1cHBvcnRpbmcgdm9pY2luZyBpbiB5b3VyIFNjcmVlblZpZXcuXHJcbiAgICovXHJcbiAgcHVibGljIGdldFZvaWNpbmdPdmVydmlld0NvbnRlbnQoKTogU3BlYWthYmxlUmVzb2x2ZWRSZXNwb25zZSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoICdUaGUgU2NyZWVuVmlldyBzaG91bGQgaW1wbGVtZW50IGdldFZvaWNpbmdPdmVydmlld0NvbnRlbnQgaWYgVm9pY2luZyBpcyBlbmFibGVkJyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIHRoZSBhbGVydCBjb250ZW50IGZvciB0aGlzIFNjcmVlblZpZXcgd2hlbiB0aGUgVm9pY2luZyBmZWF0dXJlIGlzIGVuYWJsZWQgYW5kIHRoZSBcIkRldGFpbHNcIiBidXR0b24gaXNcclxuICAgKiBwcmVzc2VkLlxyXG4gICAqIE11c3QgYmUgaW1wbGVtZW50ZWQgaWYgc3VwcG9ydGluZyB2b2ljaW5nIGluIHlvdXIgU2NyZWVuVmlldy5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0Vm9pY2luZ0RldGFpbHNDb250ZW50KCk6IFNwZWFrYWJsZVJlc29sdmVkUmVzcG9uc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCAnVGhlIFNjcmVlblZpZXcgc2hvdWxkIGltcGxlbWVudCBnZXRWb2ljaW5nRGV0YWlsc0NvbnRlbnQgd2hlbiB0aGUgVm9pY2luZyBmZWF0dXJlIGlzIGVuYWJsZWQuJyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIHRoZSBhbGVydCBjb250ZW50IGZvciB0aGlzIFNjcmVlblZpZXcgd2hlbiB0aGUgVm9pY2luZyBmZWF0dXJlIGlzIGVuYWJsZWQgYW5kIHRoZSBcIkhpbnRcIiBidXR0b24gaXMgcHJlc3NlZC5cclxuICAgKiBNdXN0IGJlIGltcGxlbWVudGVkIGlmIHN1cHBvcnRpbmcgdm9pY2luZyBpbiB5b3VyIFNjcmVlblZpZXcuXHJcbiAgICovXHJcbiAgcHVibGljIGdldFZvaWNpbmdIaW50Q29udGVudCgpOiBTcGVha2FibGVSZXNvbHZlZFJlc3BvbnNlIHtcclxuICAgIHRocm93IG5ldyBFcnJvciggJ1RoZSBTY3JlZW5WaWV3IHNob3VsZCBpbXBsZW1lbnQgZ2V0Vm9pY2luZ0hpbnRDb250ZW50IHdoZW4gVm9pY2luZyBpcyBlbmFibGVkLicgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgc2NhbGUgdG8gdXNlIGZvciBsYXlpbmcgb3V0IHRoZSBzaW0gY29tcG9uZW50cyBhbmQgdGhlIG5hdmlnYXRpb24gYmFyLCBzbyBpdHMgc2l6ZSB3aWxsIHRyYWNrXHJcbiAgICogd2l0aCB0aGUgc2ltIHNpemVcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGdldExheW91dFNjYWxlKCBsYXlvdXRCb3VuZHM6IEJvdW5kczIsIHZpZXdCb3VuZHM6IEJvdW5kczIgKTogbnVtYmVyIHtcclxuICAgIHJldHVybiBNYXRoLm1pbiggdmlld0JvdW5kcy53aWR0aCAvIGxheW91dEJvdW5kcy53aWR0aCwgdmlld0JvdW5kcy5oZWlnaHQgLyBsYXlvdXRCb3VuZHMuaGVpZ2h0ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGdldExheW91dE1hdHJpeCggbGF5b3V0Qm91bmRzOiBCb3VuZHMyLCB2aWV3Qm91bmRzOiBCb3VuZHMyLCBwcm92aWRlZE9wdGlvbnM/OiBHZXRMYXlvdXRNYXRyaXhPcHRpb25zICk6IE1hdHJpeDMge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8R2V0TGF5b3V0TWF0cml4T3B0aW9ucz4oKSgge1xyXG4gICAgICB2ZXJ0aWNhbEFsaWduOiAnY2VudGVyJyAvLyAnY2VudGVyJyBvciAnYm90dG9tJ1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgY29uc3Qgd2lkdGggPSB2aWV3Qm91bmRzLndpZHRoO1xyXG4gICAgY29uc3QgaGVpZ2h0ID0gdmlld0JvdW5kcy5oZWlnaHQ7XHJcbiAgICBjb25zdCBzY2FsZSA9IFNjcmVlblZpZXcuZ2V0TGF5b3V0U2NhbGUoIGxheW91dEJvdW5kcywgdmlld0JvdW5kcyApO1xyXG5cclxuICAgIGxldCBkeCA9IDA7XHJcbiAgICBsZXQgZHkgPSAwO1xyXG5cclxuICAgIGlmICggc2NhbGUgPT09IHdpZHRoIC8gbGF5b3V0Qm91bmRzLndpZHRoICkge1xyXG5cclxuICAgICAgLy8gdmVydGljYWxseSBmbG9hdCB0byBib3R0b21cclxuICAgICAgZHkgPSAoIGhlaWdodCAvIHNjYWxlIC0gbGF5b3V0Qm91bmRzLmhlaWdodCApO1xyXG5cclxuICAgICAgLy8gY2VudGVyIHZlcnRpY2FsbHlcclxuICAgICAgaWYgKCBvcHRpb25zLnZlcnRpY2FsQWxpZ24gPT09ICdjZW50ZXInICkge1xyXG4gICAgICAgIGR5IC89IDI7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBzY2FsZSA9PT0gaGVpZ2h0IC8gbGF5b3V0Qm91bmRzLmhlaWdodCApIHtcclxuXHJcbiAgICAgIC8vIGNlbnRlciBob3Jpem9udGFsbHlcclxuICAgICAgZHggPSAoIHdpZHRoIC8gc2NhbGUgLSBsYXlvdXRCb3VuZHMud2lkdGggKSAvIDI7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE1hdHJpeDMucm93TWFqb3IoXHJcbiAgICAgIHNjYWxlLCAwLCBkeCAqIHNjYWxlICsgdmlld0JvdW5kcy5sZWZ0LFxyXG4gICAgICAwLCBzY2FsZSwgZHkgKiBzY2FsZSArIHZpZXdCb3VuZHMudG9wLFxyXG4gICAgICAwLCAwLCAxXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy8gTm9vcHMgZm9yIGNvbnNpc3RlbnQgQVBJXHJcbiAgcHVibGljIHN0ZXAoIGR0OiBudW1iZXIgKTogdm9pZCB7XHJcbiAgICAvLyBTZWUgc3ViY2xhc3MgZm9yIGltcGxlbWVudGF0aW9uXHJcbiAgfVxyXG59XHJcblxyXG5qb2lzdC5yZWdpc3RlciggJ1NjcmVlblZpZXcnLCBTY3JlZW5WaWV3ICk7XHJcbmV4cG9ydCBkZWZhdWx0IFNjcmVlblZpZXc7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxRQUFRLE1BQU0sMkJBQTJCO0FBQ2hELE9BQU9DLE9BQU8sTUFBTSx5QkFBeUI7QUFDN0MsT0FBT0MsT0FBTyxNQUFNLHlCQUF5QjtBQUM3QyxPQUFPQyxTQUFTLE1BQU0saUNBQWlDO0FBQ3ZELE9BQU9DLGVBQWUsTUFBTSw4REFBOEQ7QUFDMUYsT0FBT0MsWUFBWSxNQUFNLDJEQUEyRDtBQUNwRixPQUFPQyxpQkFBaUIsTUFBTSxnRUFBZ0U7QUFDOUYsU0FBU0MsSUFBSSxRQUFxQiw2QkFBNkI7QUFDL0QsT0FBT0MsTUFBTSxNQUFNLDJCQUEyQjtBQUM5QyxPQUFPQyxLQUFLLE1BQU0sWUFBWTtBQUk5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU1DLHFCQUFxQixHQUFHLElBQUlULE9BQU8sQ0FBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxHQUFJLENBQUM7O0FBTTVEOztBQVFBLE1BQU1VLFVBQVUsU0FBU0osSUFBSSxDQUFDO0VBRThCOztFQVExRCxPQUF1QkcscUJBQXFCLEdBQUdBLHFCQUFxQjtFQUU3REUsV0FBV0EsQ0FBRUMsZUFBa0MsRUFBRztJQUV2RCxNQUFNQyxPQUFP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