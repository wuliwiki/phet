// Copyright 2017-2022, University of Colorado Boulder

/**
 * Support for Legends of Learning platform. Sends init message after sim is constructed and supports pause/resume.
 *
 * To test this class, follow the 'Legends of Learning Test' instructions at
 * https://github.com/phetsims/QA/blob/master/documentation/qa-book.md#legends-of-learning-test
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import joist from '../joist.js';
class LegendsOfLearningSupport {
  constructor(sim) {
    this.sim = sim;

    // Respond to pause/resume commands from the Legends of Learning platform
    window.addEventListener('message', message => {
      if (message.data.messageName === 'pause') {
        sim.stepOneFrame();
        sim.activeProperty.value = false;
      } else if (message.data.messageName === 'resume') {
        sim.activeProperty.value = true;
      }
    });
  }
  start() {
    // Send init message when sim has started up so that Legends of Learning can remove their splash screen
    this.sim.isConstructionCompleteProperty.link(isConstructionComplete => {
      isConstructionComplete && window.parent !== window && window.parent.postMessage({
        message: 'init'
      }, '*');
    });
  }
}
joist.register('LegendsOfLearningSupport', LegendsOfLearningSupport);
export default LegendsOfLearningSupport;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqb2lzdCIsIkxlZ2VuZHNPZkxlYXJuaW5nU3VwcG9ydCIsImNvbnN0cnVjdG9yIiwic2ltIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm1lc3NhZ2UiLCJkYXRhIiwibWVzc2FnZU5hbWUiLCJzdGVwT25lRnJhbWUiLCJhY3RpdmVQcm9wZXJ0eSIsInZhbHVlIiwic3RhcnQiLCJpc0NvbnN0cnVjdGlvbkNvbXBsZXRlUHJvcGVydHkiLCJsaW5rIiwiaXNDb25zdHJ1Y3Rpb25Db21wbGV0ZSIsInBhcmVudCIsInBvc3RNZXNzYWdlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJMZWdlbmRzT2ZMZWFybmluZ1N1cHBvcnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTctMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogU3VwcG9ydCBmb3IgTGVnZW5kcyBvZiBMZWFybmluZyBwbGF0Zm9ybS4gU2VuZHMgaW5pdCBtZXNzYWdlIGFmdGVyIHNpbSBpcyBjb25zdHJ1Y3RlZCBhbmQgc3VwcG9ydHMgcGF1c2UvcmVzdW1lLlxyXG4gKlxyXG4gKiBUbyB0ZXN0IHRoaXMgY2xhc3MsIGZvbGxvdyB0aGUgJ0xlZ2VuZHMgb2YgTGVhcm5pbmcgVGVzdCcgaW5zdHJ1Y3Rpb25zIGF0XHJcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9RQS9ibG9iL21hc3Rlci9kb2N1bWVudGF0aW9uL3FhLWJvb2subWQjbGVnZW5kcy1vZi1sZWFybmluZy10ZXN0XHJcbiAqXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IGpvaXN0IGZyb20gJy4uL2pvaXN0LmpzJztcclxuaW1wb3J0IFNpbSBmcm9tICcuLi9TaW0uanMnO1xyXG5cclxuY2xhc3MgTGVnZW5kc09mTGVhcm5pbmdTdXBwb3J0IHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBzaW06IFNpbTtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBzaW06IFNpbSApIHtcclxuICAgIHRoaXMuc2ltID0gc2ltO1xyXG5cclxuICAgIC8vIFJlc3BvbmQgdG8gcGF1c2UvcmVzdW1lIGNvbW1hbmRzIGZyb20gdGhlIExlZ2VuZHMgb2YgTGVhcm5pbmcgcGxhdGZvcm1cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAnbWVzc2FnZScsIG1lc3NhZ2UgPT4ge1xyXG4gICAgICBpZiAoIG1lc3NhZ2UuZGF0YS5tZXNzYWdlTmFtZSA9PT0gJ3BhdXNlJyApIHtcclxuICAgICAgICBzaW0uc3RlcE9uZUZyYW1lKCk7XHJcbiAgICAgICAgc2ltLmFjdGl2ZVByb3BlcnR5LnZhbHVlID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIG1lc3NhZ2UuZGF0YS5tZXNzYWdlTmFtZSA9PT0gJ3Jlc3VtZScgKSB7XHJcbiAgICAgICAgc2ltLmFjdGl2ZVByb3BlcnR5LnZhbHVlID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXJ0KCk6IHZvaWQge1xyXG5cclxuICAgIC8vIFNlbmQgaW5pdCBtZXNzYWdlIHdoZW4gc2ltIGhhcyBzdGFydGVkIHVwIHNvIHRoYXQgTGVnZW5kcyBvZiBMZWFybmluZyBjYW4gcmVtb3ZlIHRoZWlyIHNwbGFzaCBzY3JlZW5cclxuICAgIHRoaXMuc2ltLmlzQ29uc3RydWN0aW9uQ29tcGxldGVQcm9wZXJ0eS5saW5rKCBpc0NvbnN0cnVjdGlvbkNvbXBsZXRlID0+IHtcclxuICAgICAgaXNDb25zdHJ1Y3Rpb25Db21wbGV0ZSAmJiAoIHdpbmRvdy5wYXJlbnQgIT09IHdpbmRvdyApICYmIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoIHsgbWVzc2FnZTogJ2luaXQnIH0sICcqJyApO1xyXG4gICAgfSApO1xyXG4gIH1cclxufVxyXG5cclxuam9pc3QucmVnaXN0ZXIoICdMZWdlbmRzT2ZMZWFybmluZ1N1cHBvcnQnLCBMZWdlbmRzT2ZMZWFybmluZ1N1cHBvcnQgKTtcclxuZXhwb3J0IGRlZmF1bHQgTGVnZW5kc09mTGVhcm5pbmdTdXBwb3J0OyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxLQUFLLE1BQU0sYUFBYTtBQUcvQixNQUFNQyx3QkFBd0IsQ0FBQztFQUl0QkMsV0FBV0EsQ0FBRUMsR0FBUSxFQUFHO0lBQzdCLElBQUksQ0FBQ0EsR0FBRyxHQUFHQSxHQUFHOztJQUVkO0lBQ0FDLE1BQU0sQ0FBQ0MsZ0JBQWdCLENBQUUsU0FBUyxFQUFFQyxPQUFPLElBQUk7TUFDN0MsSUFBS0EsT0FBTyxDQUFDQyxJQUFJLENBQUNDLFdBQVcsS0FBSyxPQUFPLEVBQUc7UUFDMUNMLEdBQUcsQ0FBQ00sWUFBWSxDQUFDLENBQUM7UUFDbEJOLEdBQUcsQ0FBQ08sY0FBYyxDQUFDQyxLQUFLLEdBQUcsS0FBSztNQUNsQyxDQUFDLE1BQ0ksSUFBS0wsT0FBTyxDQUFDQyxJQUFJLENBQUNDLFdBQVcsS0FBSyxRQUFRLEVBQUc7UUFDaERMLEdBQUcsQ0FBQ08sY0FBYyxDQUFDQyxLQUFLLEdBQUcsSUFBSTtNQUNqQztJQUNGLENBQUUsQ0FBQztFQUNMO0VBRU9DLEtBQUtBLENBQUEsRUFBUztJQUVuQjtJQUNBLElBQUksQ0FBQ1QsR0FBRyxDQUFDVSw4QkFBOEIsQ0FBQ0MsSUFBSSxDQUFFQyxzQkFBc0IsSUFBSTtNQUN0RUEsc0JBQXNCLElBQU1YLE1BQU0sQ0FBQ1ksTUFBTSxLQUFLWixNQUFRLElBQUlBLE1BQU0sQ0FBQ1ksTUFBTSxDQUFDQyxXQUFXLENBQUU7UUFBRVgsT0FBTyxFQUFFO01BQU8sQ0FBQyxFQUFFLEdBQUksQ0FBQztJQUNqSCxDQUFFLENBQUM7RUFDTDtBQUNGO0FBRUFOLEtBQUssQ0FBQ2tCLFFBQVEsQ0FBRSwwQkFBMEIsRUFBRWpCLHdCQUF5QixDQUFDO0FBQ3RFLGVBQWVBLHdCQUF3QiJ9