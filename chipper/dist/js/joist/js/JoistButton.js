// Copyright 2014-2022, University of Colorado Boulder

/**
 * Base class for Joist buttons such as the "home" button and "PhET" button that show custom highlighting on mouseover.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import Multilink from '../../axon/js/Multilink.js';
import { Shape } from '../../kite/js/imports.js';
import optionize from '../../phet-core/js/optionize.js';
import { Color, FocusHighlightPath, Node, SceneryConstants, Voicing } from '../../scenery/js/imports.js';
import ButtonInteractionState from '../../sun/js/buttons/ButtonInteractionState.js';
import PushButtonInteractionStateProperty from '../../sun/js/buttons/PushButtonInteractionStateProperty.js';
import PushButtonModel from '../../sun/js/buttons/PushButtonModel.js';
import HighlightNode from './HighlightNode.js';
import joist from './joist.js';
export default class JoistButton extends Voicing(Node) {
  // (phet-io|a11y) - Button model
  // Note it shares a tandem with "this", so the emitter will be instrumented as a child of the button

  /**
   * @param content - the scenery node to render as the content of the button
   * @param navigationBarFillProperty - the color of the navbar, as a string.
   * @param [providedOptions]
   */
  constructor(content, navigationBarFillProperty, providedOptions) {
    const options = optionize()({
      cursor: 'pointer',
      // {string}
      listener: null,
      // {function}

      // Customization for the highlight region, see overrides in HomeButton and PhetButton
      highlightExtensionWidth: 0,
      highlightExtensionHeight: 0,
      highlightCenterOffsetX: 0,
      highlightCenterOffsetY: 0,
      pointerAreaDilationX: 0,
      pointerAreaDilationY: 0,
      // JoistButtons by default do not have a featured enabledProperty
      enabledPropertyOptions: {
        phetioFeatured: false
      },
      disabledOpacity: SceneryConstants.DISABLED_OPACITY,
      // pdom
      tagName: 'button'
    }, providedOptions);

    // Creates the highlights for the button.
    const createHighlight = function (fill) {
      return new HighlightNode(content.width + options.highlightExtensionWidth, content.height + options.highlightExtensionHeight, {
        centerX: content.centerX + options.highlightCenterOffsetX,
        centerY: content.centerY + options.highlightCenterOffsetY,
        fill: fill,
        pickable: false
      });
    };

    // Highlight against the black background
    const brightenHighlight = createHighlight('white');

    // Highlight against the white background
    const darkenHighlight = createHighlight('black');
    options.children = [content, brightenHighlight, darkenHighlight];
    super(options);
    this.buttonModel = new PushButtonModel(options);

    // Button interactions
    const interactionStateProperty = new PushButtonInteractionStateProperty(this.buttonModel);
    this.interactionStateProperty = interactionStateProperty;

    // Update the highlights based on whether the button is highlighted and whether it is against a light or dark background.
    Multilink.multilink([interactionStateProperty, navigationBarFillProperty, this.buttonModel.enabledProperty], (interactionState, navigationBarFill, enabled) => {
      const useDarkenHighlight = !navigationBarFill.equals(Color.BLACK);
      brightenHighlight.visible = !useDarkenHighlight && enabled && (interactionState === ButtonInteractionState.OVER || interactionState === ButtonInteractionState.PRESSED);
      darkenHighlight.visible = useDarkenHighlight && enabled && (interactionState === ButtonInteractionState.OVER || interactionState === ButtonInteractionState.PRESSED);
    });

    // Keep the cursor in sync with if the button is enabled.
    // JoistButtons exist for the lifetime of the sim, and don't need to be disposed
    this.buttonModel.enabledProperty.link(enabled => {
      this.cursor = enabled ? options.cursor : null;
    });

    // Hook up the input listener
    this._pressListener = this.buttonModel.createPressListener({
      tandem: options.tandem.createTandem('pressListener')
    });
    this.addInputListener(this._pressListener);

    // eliminate interactivity gap between label and button
    this.mouseArea = this.touchArea = Shape.bounds(this.bounds.dilatedXY(options.pointerAreaDilationX, options.pointerAreaDilationY));

    // shift the focus highlight for the joist button so that the bottom is always on screen
    const highlightLineWidth = FocusHighlightPath.getOuterLineWidthFromNode(this);
    this.focusHighlight = Shape.bounds(this.bounds.shiftedY(-highlightLineWidth));
  }

  /**
   * Is the button currently firing because of accessibility input coming from the PDOM?
   * (pdom)
   */
  isPDOMClicking() {
    return this._pressListener.pdomClickingProperty.get();
  }
}
joist.register('JoistButton', JoistButton);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aWxpbmsiLCJTaGFwZSIsIm9wdGlvbml6ZSIsIkNvbG9yIiwiRm9jdXNIaWdobGlnaHRQYXRoIiwiTm9kZSIsIlNjZW5lcnlDb25zdGFudHMiLCJWb2ljaW5nIiwiQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZSIsIlB1c2hCdXR0b25JbnRlcmFjdGlvblN0YXRlUHJvcGVydHkiLCJQdXNoQnV0dG9uTW9kZWwiLCJIaWdobGlnaHROb2RlIiwiam9pc3QiLCJKb2lzdEJ1dHRvbiIsImNvbnN0cnVjdG9yIiwiY29udGVudCIsIm5hdmlnYXRpb25CYXJGaWxsUHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwiY3Vyc29yIiwibGlzdGVuZXIiLCJoaWdobGlnaHRFeHRlbnNpb25XaWR0aCIsImhpZ2hsaWdodEV4dGVuc2lvbkhlaWdodCIsImhpZ2hsaWdodENlbnRlck9mZnNldFgiLCJoaWdobGlnaHRDZW50ZXJPZmZzZXRZIiwicG9pbnRlckFyZWFEaWxhdGlvblgiLCJwb2ludGVyQXJlYURpbGF0aW9uWSIsImVuYWJsZWRQcm9wZXJ0eU9wdGlvbnMiLCJwaGV0aW9GZWF0dXJlZCIsImRpc2FibGVkT3BhY2l0eSIsIkRJU0FCTEVEX09QQUNJVFkiLCJ0YWdOYW1lIiwiY3JlYXRlSGlnaGxpZ2h0IiwiZmlsbCIsIndpZHRoIiwiaGVpZ2h0IiwiY2VudGVyWCIsImNlbnRlclkiLCJwaWNrYWJsZSIsImJyaWdodGVuSGlnaGxpZ2h0IiwiZGFya2VuSGlnaGxpZ2h0IiwiY2hpbGRyZW4iLCJidXR0b25Nb2RlbCIsImludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSIsIm11bHRpbGluayIsImVuYWJsZWRQcm9wZXJ0eSIsImludGVyYWN0aW9uU3RhdGUiLCJuYXZpZ2F0aW9uQmFyRmlsbCIsImVuYWJsZWQiLCJ1c2VEYXJrZW5IaWdobGlnaHQiLCJlcXVhbHMiLCJCTEFDSyIsInZpc2libGUiLCJPVkVSIiwiUFJFU1NFRCIsImxpbmsiLCJfcHJlc3NMaXN0ZW5lciIsImNyZWF0ZVByZXNzTGlzdGVuZXIiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJhZGRJbnB1dExpc3RlbmVyIiwibW91c2VBcmVhIiwidG91Y2hBcmVhIiwiYm91bmRzIiwiZGlsYXRlZFhZIiwiaGlnaGxpZ2h0TGluZVdpZHRoIiwiZ2V0T3V0ZXJMaW5lV2lkdGhGcm9tTm9kZSIsImZvY3VzSGlnaGxpZ2h0Iiwic2hpZnRlZFkiLCJpc1BET01DbGlja2luZyIsInBkb21DbGlja2luZ1Byb3BlcnR5IiwiZ2V0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJKb2lzdEJ1dHRvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBCYXNlIGNsYXNzIGZvciBKb2lzdCBidXR0b25zIHN1Y2ggYXMgdGhlIFwiaG9tZVwiIGJ1dHRvbiBhbmQgXCJQaEVUXCIgYnV0dG9uIHRoYXQgc2hvdyBjdXN0b20gaGlnaGxpZ2h0aW5nIG9uIG1vdXNlb3Zlci5cclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBNdWx0aWxpbmsgZnJvbSAnLi4vLi4vYXhvbi9qcy9NdWx0aWxpbmsuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBQaWNrUmVxdWlyZWQgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1BpY2tSZXF1aXJlZC5qcyc7XHJcbmltcG9ydCBTdHJpY3RPbWl0IGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9TdHJpY3RPbWl0LmpzJztcclxuaW1wb3J0IHsgQ29sb3IsIEZvY3VzSGlnaGxpZ2h0UGF0aCwgTm9kZSwgTm9kZU9wdGlvbnMsIFByZXNzTGlzdGVuZXIsIFNjZW5lcnlDb25zdGFudHMsIFZvaWNpbmcsIFZvaWNpbmdPcHRpb25zIH0gZnJvbSAnLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEJ1dHRvbkludGVyYWN0aW9uU3RhdGUgZnJvbSAnLi4vLi4vc3VuL2pzL2J1dHRvbnMvQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZS5qcyc7XHJcbmltcG9ydCBQdXNoQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5IGZyb20gJy4uLy4uL3N1bi9qcy9idXR0b25zL1B1c2hCdXR0b25JbnRlcmFjdGlvblN0YXRlUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUHVzaEJ1dHRvbk1vZGVsIGZyb20gJy4uLy4uL3N1bi9qcy9idXR0b25zL1B1c2hCdXR0b25Nb2RlbC5qcyc7XHJcbmltcG9ydCBIaWdobGlnaHROb2RlIGZyb20gJy4vSGlnaGxpZ2h0Tm9kZS5qcyc7XHJcbmltcG9ydCBqb2lzdCBmcm9tICcuL2pvaXN0LmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgaGlnaGxpZ2h0RXh0ZW5zaW9uV2lkdGg/OiBudW1iZXI7XHJcbiAgaGlnaGxpZ2h0RXh0ZW5zaW9uSGVpZ2h0PzogbnVtYmVyO1xyXG4gIGhpZ2hsaWdodENlbnRlck9mZnNldFg/OiBudW1iZXI7XHJcbiAgaGlnaGxpZ2h0Q2VudGVyT2Zmc2V0WT86IG51bWJlcjtcclxuICBwb2ludGVyQXJlYURpbGF0aW9uWD86IG51bWJlcjtcclxuICBwb2ludGVyQXJlYURpbGF0aW9uWT86IG51bWJlcjtcclxuICBsaXN0ZW5lcj86ICggKCkgPT4gdm9pZCApIHwgbnVsbDtcclxufTtcclxudHlwZSBQYXJlbnRPcHRpb25zID0gVm9pY2luZ09wdGlvbnMgJiBOb2RlT3B0aW9ucztcclxuZXhwb3J0IHR5cGUgSm9pc3RCdXR0b25PcHRpb25zID0gU2VsZk9wdGlvbnMgJiBTdHJpY3RPbWl0PFBhcmVudE9wdGlvbnMsICdjaGlsZHJlbic+ICYgUGlja1JlcXVpcmVkPFBhcmVudE9wdGlvbnMsICd0YW5kZW0nPjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEpvaXN0QnV0dG9uIGV4dGVuZHMgVm9pY2luZyggTm9kZSApIHtcclxuXHJcbiAgLy8gKHBoZXQtaW98YTExeSkgLSBCdXR0b24gbW9kZWxcclxuICAvLyBOb3RlIGl0IHNoYXJlcyBhIHRhbmRlbSB3aXRoIFwidGhpc1wiLCBzbyB0aGUgZW1pdHRlciB3aWxsIGJlIGluc3RydW1lbnRlZCBhcyBhIGNoaWxkIG9mIHRoZSBidXR0b25cclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgYnV0dG9uTW9kZWw6IFB1c2hCdXR0b25Nb2RlbDtcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgaW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5OiBQdXNoQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5O1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgX3ByZXNzTGlzdGVuZXI6IFByZXNzTGlzdGVuZXI7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBjb250ZW50IC0gdGhlIHNjZW5lcnkgbm9kZSB0byByZW5kZXIgYXMgdGhlIGNvbnRlbnQgb2YgdGhlIGJ1dHRvblxyXG4gICAqIEBwYXJhbSBuYXZpZ2F0aW9uQmFyRmlsbFByb3BlcnR5IC0gdGhlIGNvbG9yIG9mIHRoZSBuYXZiYXIsIGFzIGEgc3RyaW5nLlxyXG4gICAqIEBwYXJhbSBbcHJvdmlkZWRPcHRpb25zXVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggY29udGVudDogTm9kZSwgbmF2aWdhdGlvbkJhckZpbGxQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Q29sb3I+LCBwcm92aWRlZE9wdGlvbnM6IEpvaXN0QnV0dG9uT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEpvaXN0QnV0dG9uT3B0aW9ucywgU2VsZk9wdGlvbnMsIFBhcmVudE9wdGlvbnM+KCkoIHtcclxuICAgICAgY3Vyc29yOiAncG9pbnRlcicsIC8vIHtzdHJpbmd9XHJcbiAgICAgIGxpc3RlbmVyOiBudWxsLCAvLyB7ZnVuY3Rpb259XHJcblxyXG4gICAgICAvLyBDdXN0b21pemF0aW9uIGZvciB0aGUgaGlnaGxpZ2h0IHJlZ2lvbiwgc2VlIG92ZXJyaWRlcyBpbiBIb21lQnV0dG9uIGFuZCBQaGV0QnV0dG9uXHJcbiAgICAgIGhpZ2hsaWdodEV4dGVuc2lvbldpZHRoOiAwLFxyXG4gICAgICBoaWdobGlnaHRFeHRlbnNpb25IZWlnaHQ6IDAsXHJcbiAgICAgIGhpZ2hsaWdodENlbnRlck9mZnNldFg6IDAsXHJcbiAgICAgIGhpZ2hsaWdodENlbnRlck9mZnNldFk6IDAsXHJcblxyXG4gICAgICBwb2ludGVyQXJlYURpbGF0aW9uWDogMCxcclxuICAgICAgcG9pbnRlckFyZWFEaWxhdGlvblk6IDAsXHJcblxyXG4gICAgICAvLyBKb2lzdEJ1dHRvbnMgYnkgZGVmYXVsdCBkbyBub3QgaGF2ZSBhIGZlYXR1cmVkIGVuYWJsZWRQcm9wZXJ0eVxyXG4gICAgICBlbmFibGVkUHJvcGVydHlPcHRpb25zOiB7IHBoZXRpb0ZlYXR1cmVkOiBmYWxzZSB9LFxyXG4gICAgICBkaXNhYmxlZE9wYWNpdHk6IFNjZW5lcnlDb25zdGFudHMuRElTQUJMRURfT1BBQ0lUWSxcclxuXHJcbiAgICAgIC8vIHBkb21cclxuICAgICAgdGFnTmFtZTogJ2J1dHRvbidcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIENyZWF0ZXMgdGhlIGhpZ2hsaWdodHMgZm9yIHRoZSBidXR0b24uXHJcbiAgICBjb25zdCBjcmVhdGVIaWdobGlnaHQgPSBmdW5jdGlvbiggZmlsbDogQ29sb3IgfCBzdHJpbmcgKSB7XHJcbiAgICAgIHJldHVybiBuZXcgSGlnaGxpZ2h0Tm9kZSggY29udGVudC53aWR0aCArIG9wdGlvbnMuaGlnaGxpZ2h0RXh0ZW5zaW9uV2lkdGgsIGNvbnRlbnQuaGVpZ2h0ICsgb3B0aW9ucy5oaWdobGlnaHRFeHRlbnNpb25IZWlnaHQsIHtcclxuICAgICAgICBjZW50ZXJYOiBjb250ZW50LmNlbnRlclggKyBvcHRpb25zLmhpZ2hsaWdodENlbnRlck9mZnNldFgsXHJcbiAgICAgICAgY2VudGVyWTogY29udGVudC5jZW50ZXJZICsgb3B0aW9ucy5oaWdobGlnaHRDZW50ZXJPZmZzZXRZLFxyXG4gICAgICAgIGZpbGw6IGZpbGwsXHJcbiAgICAgICAgcGlja2FibGU6IGZhbHNlXHJcbiAgICAgIH0gKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gSGlnaGxpZ2h0IGFnYWluc3QgdGhlIGJsYWNrIGJhY2tncm91bmRcclxuICAgIGNvbnN0IGJyaWdodGVuSGlnaGxpZ2h0ID0gY3JlYXRlSGlnaGxpZ2h0KCAnd2hpdGUnICk7XHJcblxyXG4gICAgLy8gSGlnaGxpZ2h0IGFnYWluc3QgdGhlIHdoaXRlIGJhY2tncm91bmRcclxuICAgIGNvbnN0IGRhcmtlbkhpZ2hsaWdodCA9IGNyZWF0ZUhpZ2hsaWdodCggJ2JsYWNrJyApO1xyXG5cclxuICAgIG9wdGlvbnMuY2hpbGRyZW4gPSBbIGNvbnRlbnQsIGJyaWdodGVuSGlnaGxpZ2h0LCBkYXJrZW5IaWdobGlnaHQgXTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMuYnV0dG9uTW9kZWwgPSBuZXcgUHVzaEJ1dHRvbk1vZGVsKCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gQnV0dG9uIGludGVyYWN0aW9uc1xyXG4gICAgY29uc3QgaW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5ID0gbmV3IFB1c2hCdXR0b25JbnRlcmFjdGlvblN0YXRlUHJvcGVydHkoIHRoaXMuYnV0dG9uTW9kZWwgKTtcclxuXHJcbiAgICB0aGlzLmludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSA9IGludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIGhpZ2hsaWdodHMgYmFzZWQgb24gd2hldGhlciB0aGUgYnV0dG9uIGlzIGhpZ2hsaWdodGVkIGFuZCB3aGV0aGVyIGl0IGlzIGFnYWluc3QgYSBsaWdodCBvciBkYXJrIGJhY2tncm91bmQuXHJcbiAgICBNdWx0aWxpbmsubXVsdGlsaW5rKCBbIGludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSwgbmF2aWdhdGlvbkJhckZpbGxQcm9wZXJ0eSwgdGhpcy5idXR0b25Nb2RlbC5lbmFibGVkUHJvcGVydHkgXSxcclxuICAgICAgKCBpbnRlcmFjdGlvblN0YXRlLCBuYXZpZ2F0aW9uQmFyRmlsbCwgZW5hYmxlZCApID0+IHtcclxuICAgICAgICBjb25zdCB1c2VEYXJrZW5IaWdobGlnaHQgPSAhbmF2aWdhdGlvbkJhckZpbGwuZXF1YWxzKCBDb2xvci5CTEFDSyApO1xyXG5cclxuICAgICAgICBicmlnaHRlbkhpZ2hsaWdodC52aXNpYmxlID0gIXVzZURhcmtlbkhpZ2hsaWdodCAmJiBlbmFibGVkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICggaW50ZXJhY3Rpb25TdGF0ZSA9PT0gQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZS5PVkVSIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25TdGF0ZSA9PT0gQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZS5QUkVTU0VEICk7XHJcbiAgICAgICAgZGFya2VuSGlnaGxpZ2h0LnZpc2libGUgPSB1c2VEYXJrZW5IaWdobGlnaHQgJiYgZW5hYmxlZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCBpbnRlcmFjdGlvblN0YXRlID09PSBCdXR0b25JbnRlcmFjdGlvblN0YXRlLk9WRVIgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25TdGF0ZSA9PT0gQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZS5QUkVTU0VEICk7XHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAvLyBLZWVwIHRoZSBjdXJzb3IgaW4gc3luYyB3aXRoIGlmIHRoZSBidXR0b24gaXMgZW5hYmxlZC5cclxuICAgIC8vIEpvaXN0QnV0dG9ucyBleGlzdCBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBzaW0sIGFuZCBkb24ndCBuZWVkIHRvIGJlIGRpc3Bvc2VkXHJcbiAgICB0aGlzLmJ1dHRvbk1vZGVsLmVuYWJsZWRQcm9wZXJ0eS5saW5rKCBlbmFibGVkID0+IHtcclxuICAgICAgdGhpcy5jdXJzb3IgPSBlbmFibGVkID8gb3B0aW9ucy5jdXJzb3IgOiBudWxsO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEhvb2sgdXAgdGhlIGlucHV0IGxpc3RlbmVyXHJcbiAgICB0aGlzLl9wcmVzc0xpc3RlbmVyID0gdGhpcy5idXR0b25Nb2RlbC5jcmVhdGVQcmVzc0xpc3RlbmVyKCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncHJlc3NMaXN0ZW5lcicgKVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCB0aGlzLl9wcmVzc0xpc3RlbmVyICk7XHJcblxyXG4gICAgLy8gZWxpbWluYXRlIGludGVyYWN0aXZpdHkgZ2FwIGJldHdlZW4gbGFiZWwgYW5kIGJ1dHRvblxyXG4gICAgdGhpcy5tb3VzZUFyZWEgPSB0aGlzLnRvdWNoQXJlYSA9IFNoYXBlLmJvdW5kcyggdGhpcy5ib3VuZHMuZGlsYXRlZFhZKCBvcHRpb25zLnBvaW50ZXJBcmVhRGlsYXRpb25YLCBvcHRpb25zLnBvaW50ZXJBcmVhRGlsYXRpb25ZICkgKTtcclxuXHJcbiAgICAvLyBzaGlmdCB0aGUgZm9jdXMgaGlnaGxpZ2h0IGZvciB0aGUgam9pc3QgYnV0dG9uIHNvIHRoYXQgdGhlIGJvdHRvbSBpcyBhbHdheXMgb24gc2NyZWVuXHJcbiAgICBjb25zdCBoaWdobGlnaHRMaW5lV2lkdGggPSBGb2N1c0hpZ2hsaWdodFBhdGguZ2V0T3V0ZXJMaW5lV2lkdGhGcm9tTm9kZSggdGhpcyApO1xyXG4gICAgdGhpcy5mb2N1c0hpZ2hsaWdodCA9IFNoYXBlLmJvdW5kcyggdGhpcy5ib3VuZHMuc2hpZnRlZFkoIC1oaWdobGlnaHRMaW5lV2lkdGggKSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSXMgdGhlIGJ1dHRvbiBjdXJyZW50bHkgZmlyaW5nIGJlY2F1c2Ugb2YgYWNjZXNzaWJpbGl0eSBpbnB1dCBjb21pbmcgZnJvbSB0aGUgUERPTT9cclxuICAgKiAocGRvbSlcclxuICAgKi9cclxuICBwdWJsaWMgaXNQRE9NQ2xpY2tpbmcoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5fcHJlc3NMaXN0ZW5lci5wZG9tQ2xpY2tpbmdQcm9wZXJ0eS5nZXQoKTtcclxuICB9XHJcbn1cclxuXHJcbmpvaXN0LnJlZ2lzdGVyKCAnSm9pc3RCdXR0b24nLCBKb2lzdEJ1dHRvbiApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQSxPQUFPQSxTQUFTLE1BQU0sNEJBQTRCO0FBQ2xELFNBQVNDLEtBQUssUUFBUSwwQkFBMEI7QUFDaEQsT0FBT0MsU0FBUyxNQUFNLGlDQUFpQztBQUd2RCxTQUFTQyxLQUFLLEVBQUVDLGtCQUFrQixFQUFFQyxJQUFJLEVBQThCQyxnQkFBZ0IsRUFBRUMsT0FBTyxRQUF3Qiw2QkFBNkI7QUFDcEosT0FBT0Msc0JBQXNCLE1BQU0sZ0RBQWdEO0FBQ25GLE9BQU9DLGtDQUFrQyxNQUFNLDREQUE0RDtBQUMzRyxPQUFPQyxlQUFlLE1BQU0seUNBQXlDO0FBQ3JFLE9BQU9DLGFBQWEsTUFBTSxvQkFBb0I7QUFDOUMsT0FBT0MsS0FBSyxNQUFNLFlBQVk7QUFjOUIsZUFBZSxNQUFNQyxXQUFXLFNBQVNOLE9BQU8sQ0FBRUYsSUFBSyxDQUFDLENBQUM7RUFFdkQ7RUFDQTs7RUFL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