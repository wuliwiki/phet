// Copyright 2021-2023, University of Colorado Boulder

/**
 * Dialog with preferences to enable or disable various features for the simulation. Groups of preferences are
 * organized and displayed in a tab panel.
 *
 * Once the dialog is created it is never destroyed so listeners and components do not need to be disposed.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import EnumerationProperty from '../../../axon/js/EnumerationProperty.js';
import optionize from '../../../phet-core/js/optionize.js';
import PhetFont from '../../../scenery-phet/js/PhetFont.js';
import { HSeparator, KeyboardUtils, Text, VBox } from '../../../scenery/js/imports.js';
import Dialog from '../../../sun/js/Dialog.js';
import soundManager from '../../../tambo/js/soundManager.js';
import joist from '../joist.js';
import JoistStrings from '../JoistStrings.js';
import PreferencesPanels from './PreferencesPanels.js';
import PreferencesTabs from './PreferencesTabs.js';
import PreferencesTabSwitchSoundGenerator from './PreferencesTabSwitchSoundGenerator.js';
import PreferencesType from './PreferencesType.js';

// constants
const TITLE_FONT = new PhetFont({
  size: 24,
  weight: 'bold'
});
const TAB_FONT = new PhetFont(20);
const TAB_MAX_WIDTH = 120;
const TAB_OPTIONS = {
  font: TAB_FONT,
  maxWidth: TAB_MAX_WIDTH
};
const CONTENT_FONT = new PhetFont(16);
const CONTENT_MAX_WIDTH = 500;
const PANEL_SECTION_CONTENT_OPTIONS = {
  font: CONTENT_FONT,
  maxWidth: CONTENT_MAX_WIDTH
};
const PANEL_SECTION_LABEL_FONT = new PhetFont({
  weight: 'bold',
  size: 16
});
const PANEL_SECTION_LABEL_MAX_WIDTH = 360;
const PANEL_SECTION_LABEL_OPTIONS = {
  font: PANEL_SECTION_LABEL_FONT,
  maxWidth: PANEL_SECTION_LABEL_MAX_WIDTH
};
class PreferencesDialog extends Dialog {
  constructor(preferencesModel, providedOptions) {
    const titleText = new Text(JoistStrings.preferences.titleStringProperty, {
      font: TITLE_FONT,
      maxWidth: CONTENT_MAX_WIDTH,
      // The width of the title should be the same max as for a panel section

      // pdom
      tagName: 'h1',
      innerContent: JoistStrings.preferences.titleStringProperty
    });
    const options = optionize()({
      titleAlign: 'center',
      title: titleText,
      // phet-io
      phetioDynamicElement: true,
      closeButtonVoicingDialogTitle: JoistStrings.preferences.titleStringProperty,
      // pdom
      positionInPDOM: true
    }, providedOptions);

    // determine which tabs will be supported in this Dialog, true if any entry in a configuration has content
    const supportedTabs = [PreferencesType.OVERVIEW]; // There is always an "Overview" tab
    preferencesModel.supportsSimulationPreferences() && supportedTabs.push(PreferencesType.SIMULATION);
    preferencesModel.supportsVisualPreferences() && supportedTabs.push(PreferencesType.VISUAL);
    preferencesModel.supportsAudioPreferences() && supportedTabs.push(PreferencesType.AUDIO);
    preferencesModel.supportsInputPreferences() && supportedTabs.push(PreferencesType.INPUT);
    preferencesModel.supportsLocalizationPreferences() && supportedTabs.push(PreferencesType.LOCALIZATION);
    assert && assert(supportedTabs.length > 0, 'Trying to create a PreferencesDialog with no tabs, check PreferencesModel');

    // the selected PreferencesType, indicating which tab is visible in the Dialog
    const selectedTabProperty = new EnumerationProperty(PreferencesType.OVERVIEW, {
      validValues: supportedTabs,
      tandem: options.tandem.createTandem('selectedTabProperty')
    });

    // the set of tabs you can click to activate a tab panel
    const preferencesTabs = new PreferencesTabs(supportedTabs, selectedTabProperty, {
      tandem: options.tandem.createTandem('preferencesTabs')
    });

    // the panels of content with UI components to select preferences, only one is displayed at a time
    const preferencesPanels = new PreferencesPanels(preferencesModel, supportedTabs, selectedTabProperty, preferencesTabs, {
      tandem: options.tandem.createTandem('preferencesPanels')
    });

    // visual separator between tabs and panels - as long as the widest separated content, which may change with i18n

    const content = new VBox({
      children: [preferencesTabs, new HSeparator({
        layoutOptions: {
          bottomMargin: 20,
          stretch: true
        }
      }), preferencesPanels]
    });

    // sound generation for tab switching
    const tabSwitchSoundGenerator = new PreferencesTabSwitchSoundGenerator(selectedTabProperty, {
      initialOutputLevel: 0.2
    });
    soundManager.addSoundGenerator(tabSwitchSoundGenerator, {
      categoryName: 'user-interface'
    });
    super(content, options);
    this.preferencesTabs = preferencesTabs;
    this.preferencesPanels = preferencesPanels;

    // pdom - When the "down" arrow is pressed on the group of tabs, move focus to the selected panel
    preferencesTabs.addInputListener({
      keydown: event => {
        if (KeyboardUtils.isKeyEvent(event.domEvent, KeyboardUtils.KEY_DOWN_ARROW)) {
          this.focusSelectedPanel();
        }
      }
    });
    content.addInputListener({
      keydown: event => {
        // components within the content may need to respond to input themselves, only focus tabs if container has focus
        if (KeyboardUtils.isKeyEvent(event.domEvent, KeyboardUtils.KEY_UP_ARROW) && this.preferencesPanels.isFocusableSelectedContent(event.target)) {
          this.focusSelectedTab();
        }
      }
    });
    this.disposePreferencesDialog = () => {
      content.dispose();
      soundManager.removeSoundGenerator(tabSwitchSoundGenerator);
      tabSwitchSoundGenerator.dispose();
      preferencesTabs.dispose();
      selectedTabProperty.dispose();
      preferencesPanels.dispose();
      titleText.dispose();
    };
  }

  /**
   * Move focus to the selected tab. Generally to be used when opening the dialog.
   */
  focusSelectedTab() {
    this.preferencesTabs.focusSelectedTab();
  }

  /**
   * Move focus to the selected panel.
   */
  focusSelectedPanel() {
    this.preferencesPanels.focusSelectedPanel();
  }
  dispose() {
    this.disposePreferencesDialog();
    super.dispose();
  }

  // Font and options for the text that labels a tab in the dialog.
  static TAB_FONT = TAB_FONT;
  static TAB_OPTIONS = TAB_OPTIONS;

  // The font for a title of a panel in the dialog.
  static TITLE_FONT = TITLE_FONT;

  // The font, max width, and options for most text content in the dialog.
  static CONTENT_FONT = CONTENT_FONT;
  static CONTENT_MAX_WIDTH = CONTENT_MAX_WIDTH;
  static PANEL_SECTION_CONTENT_OPTIONS = PANEL_SECTION_CONTENT_OPTIONS;

  // The font, max width, and options for a label for a section of content in the dialog.
  static PANEL_SECTION_LABEL_FONT = PANEL_SECTION_LABEL_FONT;
  static PANEL_SECTION_LABEL_MAX_WIDTH = PANEL_SECTION_LABEL_MAX_WIDTH;
  static PANEL_SECTION_LABEL_OPTIONS = PANEL_SECTION_LABEL_OPTIONS;

  // Default spacing between unique items in a preferences dialog
  static CONTENT_SPACING = 20;

  // Default vertical spacing between grouped items (radio buttons, vertical checkboxes, ...)
  static VERTICAL_CONTENT_SPACING = 5;

  // Content or UI component intendentation under a PreferencesPanelSection title.
  static CONTENT_INDENTATION_SPACING = 15;

  // Default vertical spacing between a label and its collection of contents for a control in the dialog.
  static LABEL_CONTENT_SPACING = 10;
}
joist.register('PreferencesDialog', PreferencesDialog);
export default PreferencesDialog;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFbnVtZXJhdGlvblByb3BlcnR5Iiwib3B0aW9uaXplIiwiUGhldEZvbnQiLCJIU2VwYXJhdG9yIiwiS2V5Ym9hcmRVdGlscyIsIlRleHQiLCJWQm94IiwiRGlhbG9nIiwic291bmRNYW5hZ2VyIiwiam9pc3QiLCJKb2lzdFN0cmluZ3MiLCJQcmVmZXJlbmNlc1BhbmVscyIsIlByZWZlcmVuY2VzVGFicyIsIlByZWZlcmVuY2VzVGFiU3dpdGNoU291bmRHZW5lcmF0b3IiLCJQcmVmZXJlbmNlc1R5cGUiLCJUSVRMRV9GT05UIiwic2l6ZSIsIndlaWdodCIsIlRBQl9GT05UIiwiVEFCX01BWF9XSURUSCIsIlRBQl9PUFRJT05TIiwiZm9udCIsIm1heFdpZHRoIiwiQ09OVEVOVF9GT05UIiwiQ09OVEVOVF9NQVhfV0lEVEgiLCJQQU5FTF9TRUNUSU9OX0NPTlRFTlRfT1BUSU9OUyIsIlBBTkVMX1NFQ1RJT05fTEFCRUxfRk9OVCIsIlBBTkVMX1NFQ1RJT05fTEFCRUxfTUFYX1dJRFRIIiwiUEFORUxfU0VDVElPTl9MQUJFTF9PUFRJT05TIiwiUHJlZmVyZW5jZXNEaWFsb2ciLCJjb25zdHJ1Y3RvciIsInByZWZlcmVuY2VzTW9kZWwiLCJwcm92aWRlZE9wdGlvbnMiLCJ0aXRsZVRleHQiLCJwcmVmZXJlbmNlcyIsInRpdGxlU3RyaW5nUHJvcGVydHkiLCJ0YWdOYW1lIiwiaW5uZXJDb250ZW50Iiwib3B0aW9ucyIsInRpdGxlQWxpZ24iLCJ0aXRsZSIsInBoZXRpb0R5bmFtaWNFbGVtZW50IiwiY2xvc2VCdXR0b25Wb2ljaW5nRGlhbG9nVGl0bGUiLCJwb3NpdGlvbkluUERPTSIsInN1cHBvcnRlZFRhYnMiLCJPVkVSVklFVyIsInN1cHBvcnRzU2ltdWxhdGlvblByZWZlcmVuY2VzIiwicHVzaCIsIlNJTVVMQVRJT04iLCJzdXBwb3J0c1Zpc3VhbFByZWZlcmVuY2VzIiwiVklTVUFMIiwic3VwcG9ydHNBdWRpb1ByZWZlcmVuY2VzIiwiQVVESU8iLCJzdXBwb3J0c0lucHV0UHJlZmVyZW5jZXMiLCJJTlBVVCIsInN1cHBvcnRzTG9jYWxpemF0aW9uUHJlZmVyZW5jZXMiLCJMT0NBTElaQVRJT04iLCJhc3NlcnQiLCJsZW5ndGgiLCJzZWxlY3RlZFRhYlByb3BlcnR5IiwidmFsaWRWYWx1ZXMiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJwcmVmZXJlbmNlc1RhYnMiLCJwcmVmZXJlbmNlc1BhbmVscyIsImNvbnRlbnQiLCJjaGlsZHJlbiIsImxheW91dE9wdGlvbnMiLCJib3R0b21NYXJnaW4iLCJzdHJldGNoIiwidGFiU3dpdGNoU291bmRHZW5lcmF0b3IiLCJpbml0aWFsT3V0cHV0TGV2ZWwiLCJhZGRTb3VuZEdlbmVyYXRvciIsImNhdGVnb3J5TmFtZSIsImFkZElucHV0TGlzdGVuZXIiLCJrZXlkb3duIiwiZXZlbnQiLCJpc0tleUV2ZW50IiwiZG9tRXZlbnQiLCJLRVlfRE9XTl9BUlJPVyIsImZvY3VzU2VsZWN0ZWRQYW5lbCIsIktFWV9VUF9BUlJPVyIsImlzRm9jdXNhYmxlU2VsZWN0ZWRDb250ZW50IiwidGFyZ2V0IiwiZm9jdXNTZWxlY3RlZFRhYiIsImRpc3Bvc2VQcmVmZXJlbmNlc0RpYWxvZyIsImRpc3Bvc2UiLCJyZW1vdmVTb3VuZEdlbmVyYXRvciIsIkNPTlRFTlRfU1BBQ0lORyIsIlZFUlRJQ0FMX0NPTlRFTlRfU1BBQ0lORyIsIkNPTlRFTlRfSU5ERU5UQVRJT05fU1BBQ0lORyIsIkxBQkVMX0NPTlRFTlRfU1BBQ0lORyIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiUHJlZmVyZW5jZXNEaWFsb2cudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjEtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogRGlhbG9nIHdpdGggcHJlZmVyZW5jZXMgdG8gZW5hYmxlIG9yIGRpc2FibGUgdmFyaW91cyBmZWF0dXJlcyBmb3IgdGhlIHNpbXVsYXRpb24uIEdyb3VwcyBvZiBwcmVmZXJlbmNlcyBhcmVcclxuICogb3JnYW5pemVkIGFuZCBkaXNwbGF5ZWQgaW4gYSB0YWIgcGFuZWwuXHJcbiAqXHJcbiAqIE9uY2UgdGhlIGRpYWxvZyBpcyBjcmVhdGVkIGl0IGlzIG5ldmVyIGRlc3Ryb3llZCBzbyBsaXN0ZW5lcnMgYW5kIGNvbXBvbmVudHMgZG8gbm90IG5lZWQgdG8gYmUgZGlzcG9zZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBFbnVtZXJhdGlvblByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvRW51bWVyYXRpb25Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgSFNlcGFyYXRvciwgS2V5Ym9hcmRVdGlscywgVGV4dCwgVkJveCB9IGZyb20gJy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBEaWFsb2csIHsgRGlhbG9nT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL3N1bi9qcy9EaWFsb2cuanMnO1xyXG5pbXBvcnQgc291bmRNYW5hZ2VyIGZyb20gJy4uLy4uLy4uL3RhbWJvL2pzL3NvdW5kTWFuYWdlci5qcyc7XHJcbmltcG9ydCBqb2lzdCBmcm9tICcuLi9qb2lzdC5qcyc7XHJcbmltcG9ydCBKb2lzdFN0cmluZ3MgZnJvbSAnLi4vSm9pc3RTdHJpbmdzLmpzJztcclxuaW1wb3J0IFByZWZlcmVuY2VzTW9kZWwgZnJvbSAnLi9QcmVmZXJlbmNlc01vZGVsLmpzJztcclxuaW1wb3J0IFByZWZlcmVuY2VzUGFuZWxzIGZyb20gJy4vUHJlZmVyZW5jZXNQYW5lbHMuanMnO1xyXG5pbXBvcnQgUHJlZmVyZW5jZXNUYWJzIGZyb20gJy4vUHJlZmVyZW5jZXNUYWJzLmpzJztcclxuaW1wb3J0IFByZWZlcmVuY2VzVGFiU3dpdGNoU291bmRHZW5lcmF0b3IgZnJvbSAnLi9QcmVmZXJlbmNlc1RhYlN3aXRjaFNvdW5kR2VuZXJhdG9yLmpzJztcclxuaW1wb3J0IFByZWZlcmVuY2VzVHlwZSBmcm9tICcuL1ByZWZlcmVuY2VzVHlwZS5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgVElUTEVfRk9OVCA9IG5ldyBQaGV0Rm9udCggeyBzaXplOiAyNCwgd2VpZ2h0OiAnYm9sZCcgfSApO1xyXG5cclxuY29uc3QgVEFCX0ZPTlQgPSBuZXcgUGhldEZvbnQoIDIwICk7XHJcbmNvbnN0IFRBQl9NQVhfV0lEVEggPSAxMjA7XHJcbmNvbnN0IFRBQl9PUFRJT05TID0ge1xyXG4gIGZvbnQ6IFRBQl9GT05ULFxyXG4gIG1heFdpZHRoOiBUQUJfTUFYX1dJRFRIXHJcbn07XHJcblxyXG5jb25zdCBDT05URU5UX0ZPTlQgPSBuZXcgUGhldEZvbnQoIDE2ICk7XHJcbmNvbnN0IENPTlRFTlRfTUFYX1dJRFRIID0gNTAwO1xyXG5jb25zdCBQQU5FTF9TRUNUSU9OX0NPTlRFTlRfT1BUSU9OUyA9IHtcclxuICBmb250OiBDT05URU5UX0ZPTlQsXHJcbiAgbWF4V2lkdGg6IENPTlRFTlRfTUFYX1dJRFRIXHJcbn07XHJcblxyXG5jb25zdCBQQU5FTF9TRUNUSU9OX0xBQkVMX0ZPTlQgPSBuZXcgUGhldEZvbnQoIHsgd2VpZ2h0OiAnYm9sZCcsIHNpemU6IDE2IH0gKTtcclxuY29uc3QgUEFORUxfU0VDVElPTl9MQUJFTF9NQVhfV0lEVEggPSAzNjA7XHJcbmNvbnN0IFBBTkVMX1NFQ1RJT05fTEFCRUxfT1BUSU9OUyA9IHtcclxuICBmb250OiBQQU5FTF9TRUNUSU9OX0xBQkVMX0ZPTlQsXHJcbiAgbWF4V2lkdGg6IFBBTkVMX1NFQ1RJT05fTEFCRUxfTUFYX1dJRFRIXHJcbn07XHJcblxyXG50eXBlIFByZWZlcmVuY2VzRGlhbG9nT3B0aW9ucyA9IERpYWxvZ09wdGlvbnMgJiBQaWNrUmVxdWlyZWQ8RGlhbG9nT3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuY2xhc3MgUHJlZmVyZW5jZXNEaWFsb2cgZXh0ZW5kcyBEaWFsb2cge1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcHJlZmVyZW5jZXNUYWJzOiBQcmVmZXJlbmNlc1RhYnM7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBwcmVmZXJlbmNlc1BhbmVsczogUHJlZmVyZW5jZXNQYW5lbHM7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlUHJlZmVyZW5jZXNEaWFsb2c6ICgpID0+IHZvaWQ7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcHJlZmVyZW5jZXNNb2RlbDogUHJlZmVyZW5jZXNNb2RlbCwgcHJvdmlkZWRPcHRpb25zPzogUHJlZmVyZW5jZXNEaWFsb2dPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IHRpdGxlVGV4dCA9IG5ldyBUZXh0KCBKb2lzdFN0cmluZ3MucHJlZmVyZW5jZXMudGl0bGVTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICBmb250OiBUSVRMRV9GT05ULFxyXG4gICAgICBtYXhXaWR0aDogQ09OVEVOVF9NQVhfV0lEVEgsIC8vIFRoZSB3aWR0aCBvZiB0aGUgdGl0bGUgc2hvdWxkIGJlIHRoZSBzYW1lIG1heCBhcyBmb3IgYSBwYW5lbCBzZWN0aW9uXHJcblxyXG4gICAgICAvLyBwZG9tXHJcbiAgICAgIHRhZ05hbWU6ICdoMScsXHJcbiAgICAgIGlubmVyQ29udGVudDogSm9pc3RTdHJpbmdzLnByZWZlcmVuY2VzLnRpdGxlU3RyaW5nUHJvcGVydHlcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFByZWZlcmVuY2VzRGlhbG9nT3B0aW9ucywgRW1wdHlTZWxmT3B0aW9ucywgRGlhbG9nT3B0aW9ucz4oKSgge1xyXG4gICAgICB0aXRsZUFsaWduOiAnY2VudGVyJyxcclxuICAgICAgdGl0bGU6IHRpdGxlVGV4dCxcclxuXHJcbiAgICAgIC8vIHBoZXQtaW9cclxuICAgICAgcGhldGlvRHluYW1pY0VsZW1lbnQ6IHRydWUsXHJcblxyXG4gICAgICBjbG9zZUJ1dHRvblZvaWNpbmdEaWFsb2dUaXRsZTogSm9pc3RTdHJpbmdzLnByZWZlcmVuY2VzLnRpdGxlU3RyaW5nUHJvcGVydHksXHJcblxyXG4gICAgICAvLyBwZG9tXHJcbiAgICAgIHBvc2l0aW9uSW5QRE9NOiB0cnVlXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBkZXRlcm1pbmUgd2hpY2ggdGFicyB3aWxsIGJlIHN1cHBvcnRlZCBpbiB0aGlzIERpYWxvZywgdHJ1ZSBpZiBhbnkgZW50cnkgaW4gYSBjb25maWd1cmF0aW9uIGhhcyBjb250ZW50XHJcbiAgICBjb25zdCBzdXBwb3J0ZWRUYWJzID0gWyBQcmVmZXJlbmNlc1R5cGUuT1ZFUlZJRVcgXTsgLy8gVGhlcmUgaXMgYWx3YXlzIGFuIFwiT3ZlcnZpZXdcIiB0YWJcclxuICAgIHByZWZlcmVuY2VzTW9kZWwuc3VwcG9ydHNTaW11bGF0aW9uUHJlZmVyZW5jZXMoKSAmJiBzdXBwb3J0ZWRUYWJzLnB1c2goIFByZWZlcmVuY2VzVHlwZS5TSU1VTEFUSU9OICk7XHJcbiAgICBwcmVmZXJlbmNlc01vZGVsLnN1cHBvcnRzVmlzdWFsUHJlZmVyZW5jZXMoKSAmJiBzdXBwb3J0ZWRUYWJzLnB1c2goIFByZWZlcmVuY2VzVHlwZS5WSVNVQUwgKTtcclxuICAgIHByZWZlcmVuY2VzTW9kZWwuc3VwcG9ydHNBdWRpb1ByZWZlcmVuY2VzKCkgJiYgc3VwcG9ydGVkVGFicy5wdXNoKCBQcmVmZXJlbmNlc1R5cGUuQVVESU8gKTtcclxuICAgIHByZWZlcmVuY2VzTW9kZWwuc3VwcG9ydHNJbnB1dFByZWZlcmVuY2VzKCkgJiYgc3VwcG9ydGVkVGFicy5wdXNoKCBQcmVmZXJlbmNlc1R5cGUuSU5QVVQgKTtcclxuICAgIHByZWZlcmVuY2VzTW9kZWwuc3VwcG9ydHNMb2NhbGl6YXRpb25QcmVmZXJlbmNlcygpICYmIHN1cHBvcnRlZFRhYnMucHVzaCggUHJlZmVyZW5jZXNUeXBlLkxPQ0FMSVpBVElPTiApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggc3VwcG9ydGVkVGFicy5sZW5ndGggPiAwLCAnVHJ5aW5nIHRvIGNyZWF0ZSBhIFByZWZlcmVuY2VzRGlhbG9nIHdpdGggbm8gdGFicywgY2hlY2sgUHJlZmVyZW5jZXNNb2RlbCcgKTtcclxuXHJcbiAgICAvLyB0aGUgc2VsZWN0ZWQgUHJlZmVyZW5jZXNUeXBlLCBpbmRpY2F0aW5nIHdoaWNoIHRhYiBpcyB2aXNpYmxlIGluIHRoZSBEaWFsb2dcclxuICAgIGNvbnN0IHNlbGVjdGVkVGFiUHJvcGVydHkgPSBuZXcgRW51bWVyYXRpb25Qcm9wZXJ0eSggUHJlZmVyZW5jZXNUeXBlLk9WRVJWSUVXLCB7XHJcbiAgICAgIHZhbGlkVmFsdWVzOiBzdXBwb3J0ZWRUYWJzLFxyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NlbGVjdGVkVGFiUHJvcGVydHknIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB0aGUgc2V0IG9mIHRhYnMgeW91IGNhbiBjbGljayB0byBhY3RpdmF0ZSBhIHRhYiBwYW5lbFxyXG4gICAgY29uc3QgcHJlZmVyZW5jZXNUYWJzID0gbmV3IFByZWZlcmVuY2VzVGFicyggc3VwcG9ydGVkVGFicywgc2VsZWN0ZWRUYWJQcm9wZXJ0eSwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3ByZWZlcmVuY2VzVGFicycgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHRoZSBwYW5lbHMgb2YgY29udGVudCB3aXRoIFVJIGNvbXBvbmVudHMgdG8gc2VsZWN0IHByZWZlcmVuY2VzLCBvbmx5IG9uZSBpcyBkaXNwbGF5ZWQgYXQgYSB0aW1lXHJcbiAgICBjb25zdCBwcmVmZXJlbmNlc1BhbmVscyA9IG5ldyBQcmVmZXJlbmNlc1BhbmVscyggcHJlZmVyZW5jZXNNb2RlbCwgc3VwcG9ydGVkVGFicywgc2VsZWN0ZWRUYWJQcm9wZXJ0eSwgcHJlZmVyZW5jZXNUYWJzLCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncHJlZmVyZW5jZXNQYW5lbHMnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB2aXN1YWwgc2VwYXJhdG9yIGJldHdlZW4gdGFicyBhbmQgcGFuZWxzIC0gYXMgbG9uZyBhcyB0aGUgd2lkZXN0IHNlcGFyYXRlZCBjb250ZW50LCB3aGljaCBtYXkgY2hhbmdlIHdpdGggaTE4blxyXG5cclxuICAgIGNvbnN0IGNvbnRlbnQgPSBuZXcgVkJveCgge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIHByZWZlcmVuY2VzVGFicyxcclxuICAgICAgICBuZXcgSFNlcGFyYXRvcigge1xyXG4gICAgICAgICAgbGF5b3V0T3B0aW9uczoge1xyXG4gICAgICAgICAgICBib3R0b21NYXJnaW46IDIwLFxyXG4gICAgICAgICAgICBzdHJldGNoOiB0cnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSApLFxyXG4gICAgICAgIHByZWZlcmVuY2VzUGFuZWxzXHJcbiAgICAgIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBzb3VuZCBnZW5lcmF0aW9uIGZvciB0YWIgc3dpdGNoaW5nXHJcbiAgICBjb25zdCB0YWJTd2l0Y2hTb3VuZEdlbmVyYXRvciA9IG5ldyBQcmVmZXJlbmNlc1RhYlN3aXRjaFNvdW5kR2VuZXJhdG9yKCBzZWxlY3RlZFRhYlByb3BlcnR5LCB7XHJcbiAgICAgIGluaXRpYWxPdXRwdXRMZXZlbDogMC4yXHJcbiAgICB9ICk7XHJcbiAgICBzb3VuZE1hbmFnZXIuYWRkU291bmRHZW5lcmF0b3IoIHRhYlN3aXRjaFNvdW5kR2VuZXJhdG9yLCB7XHJcbiAgICAgIGNhdGVnb3J5TmFtZTogJ3VzZXItaW50ZXJmYWNlJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIHN1cGVyKCBjb250ZW50LCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5wcmVmZXJlbmNlc1RhYnMgPSBwcmVmZXJlbmNlc1RhYnM7XHJcbiAgICB0aGlzLnByZWZlcmVuY2VzUGFuZWxzID0gcHJlZmVyZW5jZXNQYW5lbHM7XHJcblxyXG4gICAgLy8gcGRvbSAtIFdoZW4gdGhlIFwiZG93blwiIGFycm93IGlzIHByZXNzZWQgb24gdGhlIGdyb3VwIG9mIHRhYnMsIG1vdmUgZm9jdXMgdG8gdGhlIHNlbGVjdGVkIHBhbmVsXHJcbiAgICBwcmVmZXJlbmNlc1RhYnMuYWRkSW5wdXRMaXN0ZW5lcigge1xyXG4gICAgICBrZXlkb3duOiBldmVudCA9PiB7XHJcbiAgICAgICAgaWYgKCBLZXlib2FyZFV0aWxzLmlzS2V5RXZlbnQoIGV2ZW50LmRvbUV2ZW50LCBLZXlib2FyZFV0aWxzLktFWV9ET1dOX0FSUk9XICkgKSB7XHJcbiAgICAgICAgICB0aGlzLmZvY3VzU2VsZWN0ZWRQYW5lbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gICAgY29udGVudC5hZGRJbnB1dExpc3RlbmVyKCB7XHJcbiAgICAgIGtleWRvd246IGV2ZW50ID0+IHtcclxuXHJcbiAgICAgICAgLy8gY29tcG9uZW50cyB3aXRoaW4gdGhlIGNvbnRlbnQgbWF5IG5lZWQgdG8gcmVzcG9uZCB0byBpbnB1dCB0aGVtc2VsdmVzLCBvbmx5IGZvY3VzIHRhYnMgaWYgY29udGFpbmVyIGhhcyBmb2N1c1xyXG4gICAgICAgIGlmICggS2V5Ym9hcmRVdGlscy5pc0tleUV2ZW50KCBldmVudC5kb21FdmVudCwgS2V5Ym9hcmRVdGlscy5LRVlfVVBfQVJST1cgKSAmJlxyXG4gICAgICAgICAgICAgdGhpcy5wcmVmZXJlbmNlc1BhbmVscy5pc0ZvY3VzYWJsZVNlbGVjdGVkQ29udGVudCggZXZlbnQudGFyZ2V0ICkgKSB7XHJcbiAgICAgICAgICB0aGlzLmZvY3VzU2VsZWN0ZWRUYWIoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VQcmVmZXJlbmNlc0RpYWxvZyA9ICgpID0+IHtcclxuICAgICAgY29udGVudC5kaXNwb3NlKCk7XHJcblxyXG4gICAgICBzb3VuZE1hbmFnZXIucmVtb3ZlU291bmRHZW5lcmF0b3IoIHRhYlN3aXRjaFNvdW5kR2VuZXJhdG9yICk7XHJcbiAgICAgIHRhYlN3aXRjaFNvdW5kR2VuZXJhdG9yLmRpc3Bvc2UoKTtcclxuICAgICAgcHJlZmVyZW5jZXNUYWJzLmRpc3Bvc2UoKTtcclxuICAgICAgc2VsZWN0ZWRUYWJQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICAgIHByZWZlcmVuY2VzUGFuZWxzLmRpc3Bvc2UoKTtcclxuICAgICAgdGl0bGVUZXh0LmRpc3Bvc2UoKTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNb3ZlIGZvY3VzIHRvIHRoZSBzZWxlY3RlZCB0YWIuIEdlbmVyYWxseSB0byBiZSB1c2VkIHdoZW4gb3BlbmluZyB0aGUgZGlhbG9nLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBmb2N1c1NlbGVjdGVkVGFiKCk6IHZvaWQge1xyXG4gICAgdGhpcy5wcmVmZXJlbmNlc1RhYnMuZm9jdXNTZWxlY3RlZFRhYigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTW92ZSBmb2N1cyB0byB0aGUgc2VsZWN0ZWQgcGFuZWwuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBmb2N1c1NlbGVjdGVkUGFuZWwoKTogdm9pZCB7XHJcbiAgICB0aGlzLnByZWZlcmVuY2VzUGFuZWxzLmZvY3VzU2VsZWN0ZWRQYW5lbCgpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VQcmVmZXJlbmNlc0RpYWxvZygpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgLy8gRm9udCBhbmQgb3B0aW9ucyBmb3IgdGhlIHRleHQgdGhhdCBsYWJlbHMgYSB0YWIgaW4gdGhlIGRpYWxvZy5cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFRBQl9GT05UID0gVEFCX0ZPTlQ7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBUQUJfT1BUSU9OUyA9IFRBQl9PUFRJT05TO1xyXG5cclxuICAvLyBUaGUgZm9udCBmb3IgYSB0aXRsZSBvZiBhIHBhbmVsIGluIHRoZSBkaWFsb2cuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBUSVRMRV9GT05UID0gVElUTEVfRk9OVDtcclxuXHJcbiAgLy8gVGhlIGZvbnQsIG1heCB3aWR0aCwgYW5kIG9wdGlvbnMgZm9yIG1vc3QgdGV4dCBjb250ZW50IGluIHRoZSBkaWFsb2cuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBDT05URU5UX0ZPTlQgPSBDT05URU5UX0ZPTlQ7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBDT05URU5UX01BWF9XSURUSCA9IENPTlRFTlRfTUFYX1dJRFRIO1xyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgUEFORUxfU0VDVElPTl9DT05URU5UX09QVElPTlMgPSBQQU5FTF9TRUNUSU9OX0NPTlRFTlRfT1BUSU9OUztcclxuXHJcbiAgLy8gVGhlIGZvbnQsIG1heCB3aWR0aCwgYW5kIG9wdGlvbnMgZm9yIGEgbGFiZWwgZm9yIGEgc2VjdGlvbiBvZiBjb250ZW50IGluIHRoZSBkaWFsb2cuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBQQU5FTF9TRUNUSU9OX0xBQkVMX0ZPTlQgPSBQQU5FTF9TRUNUSU9OX0xBQkVMX0ZPTlQ7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBQQU5FTF9TRUNUSU9OX0xBQkVMX01BWF9XSURUSCA9IFBBTkVMX1NFQ1RJT05fTEFCRUxfTUFYX1dJRFRIO1xyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgUEFORUxfU0VDVElPTl9MQUJFTF9PUFRJT05TID0gUEFORUxfU0VDVElPTl9MQUJFTF9PUFRJT05TO1xyXG5cclxuICAvLyBEZWZhdWx0IHNwYWNpbmcgYmV0d2VlbiB1bmlxdWUgaXRlbXMgaW4gYSBwcmVmZXJlbmNlcyBkaWFsb2dcclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IENPTlRFTlRfU1BBQ0lORyA9IDIwO1xyXG5cclxuICAvLyBEZWZhdWx0IHZlcnRpY2FsIHNwYWNpbmcgYmV0d2VlbiBncm91cGVkIGl0ZW1zIChyYWRpbyBidXR0b25zLCB2ZXJ0aWNhbCBjaGVja2JveGVzLCAuLi4pXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBWRVJUSUNBTF9DT05URU5UX1NQQUNJTkcgPSA1O1xyXG5cclxuICAvLyBDb250ZW50IG9yIFVJIGNvbXBvbmVudCBpbnRlbmRlbnRhdGlvbiB1bmRlciBhIFByZWZlcmVuY2VzUGFuZWxTZWN0aW9uIHRpdGxlLlxyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgQ09OVEVOVF9JTkRFTlRBVElPTl9TUEFDSU5HID0gMTU7XHJcblxyXG4gIC8vIERlZmF1bHQgdmVydGljYWwgc3BhY2luZyBiZXR3ZWVuIGEgbGFiZWwgYW5kIGl0cyBjb2xsZWN0aW9uIG9mIGNvbnRlbnRzIGZvciBhIGNvbnRyb2wgaW4gdGhlIGRpYWxvZy5cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IExBQkVMX0NPTlRFTlRfU1BBQ0lORyA9IDEwO1xyXG59XHJcblxyXG5qb2lzdC5yZWdpc3RlciggJ1ByZWZlcmVuY2VzRGlhbG9nJywgUHJlZmVyZW5jZXNEaWFsb2cgKTtcclxuZXhwb3J0IGRlZmF1bHQgUHJlZmVyZW5jZXNEaWFsb2c7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLG1C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