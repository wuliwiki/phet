// Copyright 2021-2023, University of Colorado Boulder

/**
 * The panels that contain preferences controls. There is one panel for every tab, and it is shown when the
 * corresponding tab is selected.
 *
 * Once the dialog is created it is never destroyed so listeners do not need to be disposed.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import optionize from '../../../phet-core/js/optionize.js';
import { AlignGroup, Node } from '../../../scenery/js/imports.js';
import joist from '../joist.js';
import AudioPreferencesPanel from './AudioPreferencesPanel.js';
import SimulationPreferencesPanel from './SimulationPreferencesPanel.js';
import InputPreferencesPanel from './InputPreferencesPanel.js';
import VisualPreferencesPanel from './VisualPreferencesPanel.js';
import LocalizationPreferencesPanel from './LocalizationPreferencesPanel.js';
import PreferencesType from './PreferencesType.js';
import OverviewPreferencesPanel from './OverviewPreferencesPanel.js';
import Tandem from '../../../tandem/js/Tandem.js';
class PreferencesPanels extends Node {
  // Each Preferences Panel as a Node collected into this array for layout and other management.
  content = [];

  // Property controlling the selected tab, so we can control which panel should be visible.

  /**
   * @param preferencesModel
   * @param supportedTabs - list of Tabs supported by this Dialog
   * @param selectedTabProperty
   * @param preferencesTabs
   * @param [providedOptions]
   */
  constructor(preferencesModel, supportedTabs, selectedTabProperty, preferencesTabs, providedOptions) {
    const options = optionize()({
      phetioVisiblePropertyInstrumented: false
    }, providedOptions);
    const tandem = options.tandem;

    // Don't instrument the actual PreferencesPanels Node. Then if it doesn't have any children, it won't be in the Studio Tree)
    options.tandem = Tandem.OPT_OUT;
    super(options);
    this.selectedTabProperty = selectedTabProperty;
    const panelAlignGroup = new AlignGroup({
      matchVertical: false
    });
    let overviewPreferencesPanel = null;
    if (supportedTabs.includes(PreferencesType.OVERVIEW)) {
      overviewPreferencesPanel = new OverviewPreferencesPanel(selectedTabProperty, preferencesTabs.getTabVisibleProperty(PreferencesType.OVERVIEW));
      const overviewBox = panelAlignGroup.createBox(overviewPreferencesPanel);
      this.addChild(overviewBox);
      this.content.push(new PreferencesPanelContainer(overviewPreferencesPanel, PreferencesType.OVERVIEW));
    }
    let simulationPreferencesPanel = null;
    if (supportedTabs.includes(PreferencesType.SIMULATION)) {
      simulationPreferencesPanel = new SimulationPreferencesPanel(preferencesModel.simulationModel, selectedTabProperty, preferencesTabs.getTabVisibleProperty(PreferencesType.SIMULATION), {
        tandem: tandem.createTandem('simulationPreferencesPanel')
      });
      const simulationBox = panelAlignGroup.createBox(simulationPreferencesPanel);
      this.addChild(simulationBox);
      this.content.push(new PreferencesPanelContainer(simulationPreferencesPanel, PreferencesType.SIMULATION));
    }
    let visualPreferencesPanel = null;
    if (supportedTabs.includes(PreferencesType.VISUAL)) {
      visualPreferencesPanel = new VisualPreferencesPanel(preferencesModel.visualModel, selectedTabProperty, preferencesTabs.getTabVisibleProperty(PreferencesType.VISUAL), {
        tandem: tandem.createTandem('visualPreferencesPanel')
      });
      const visualBox = panelAlignGroup.createBox(visualPreferencesPanel);
      this.addChild(visualBox);
      this.content.push(new PreferencesPanelContainer(visualPreferencesPanel, PreferencesType.VISUAL));
    }
    let audioPreferencesPanel = null;
    if (supportedTabs.includes(PreferencesType.AUDIO)) {
      audioPreferencesPanel = new AudioPreferencesPanel(preferencesModel.audioModel, selectedTabProperty, preferencesTabs.getTabVisibleProperty(PreferencesType.AUDIO), {
        tandem: tandem.createTandem('audioPreferencesPanel')
      });
      const audioBox = panelAlignGroup.createBox(audioPreferencesPanel);
      this.addChild(audioBox);
      this.content.push(new PreferencesPanelContainer(audioPreferencesPanel, PreferencesType.AUDIO));
    }
    let inputPreferencesPanel = null;
    if (supportedTabs.includes(PreferencesType.INPUT)) {
      inputPreferencesPanel = new InputPreferencesPanel(preferencesModel.inputModel, selectedTabProperty, preferencesTabs.getTabVisibleProperty(PreferencesType.INPUT), {
        tandem: tandem.createTandem('inputPreferencesPanel')
      });
      const inputBox = panelAlignGroup.createBox(inputPreferencesPanel);
      this.addChild(inputBox);
      this.content.push(new PreferencesPanelContainer(inputPreferencesPanel, PreferencesType.INPUT));
    }
    let localizationPreferencesPanel = null;
    if (supportedTabs.includes(PreferencesType.LOCALIZATION)) {
      localizationPreferencesPanel = new LocalizationPreferencesPanel(preferencesModel.localizationModel, selectedTabProperty, preferencesTabs.getTabVisibleProperty(PreferencesType.LOCALIZATION), {
        tandem: tandem.createTandem('localizationPreferencesPanel')
      });
      const localizationBox = panelAlignGroup.createBox(localizationPreferencesPanel);
      this.addChild(localizationBox);
      this.content.push(new PreferencesPanelContainer(localizationPreferencesPanel, PreferencesType.LOCALIZATION));
    }
    this.disposePreferencesPanel = () => {
      panelAlignGroup.dispose();
      this.content.forEach(panelContent => panelContent.dispose());
      overviewPreferencesPanel && overviewPreferencesPanel.dispose();
      simulationPreferencesPanel && simulationPreferencesPanel.dispose();
      visualPreferencesPanel && visualPreferencesPanel.dispose();
      audioPreferencesPanel && audioPreferencesPanel.dispose();
      inputPreferencesPanel && inputPreferencesPanel.dispose();
      localizationPreferencesPanel && localizationPreferencesPanel.dispose();
    };
  }
  dispose() {
    this.disposePreferencesPanel();
    super.dispose();
  }

  /**
   * Returns the visible content panel Node for the selected PreferencesType.
   * NOTE: Loop shouldn't be necessary, create a map that goes from PreferencesType -> content.
   */
  getSelectedContent() {
    for (let i = 0; i < this.content.length; i++) {
      const currentContent = this.content[i];
      if (currentContent.selectedTabValue === this.selectedTabProperty.value) {
        return currentContent;
      }
    }
    assert && assert(false, 'should never not have a selected panel content.');
    return null;
  }

  /**
   * Focus the selected panel. The panel should not be focusable until this is requested, so it is set to be
   * focusable before the focus() call. When focus is removed from the panel, it should become non-focusable
   * again. That is handled in PreferencesPanelContainer class.
   */
  focusSelectedPanel() {
    const selectedContent = this.getSelectedContent();
    selectedContent.panelContent.focusable = true;
    selectedContent.panelContent.focus();
  }

  /**
   * @param node - the potential content for the selected panel that is focusable
   * @returns true if the provided node is the currently selected panel
   */
  isFocusableSelectedContent(node) {
    const selectedContent = this.getSelectedContent();
    return node === selectedContent.panelContent; // the panelContent is what is focused in focusSelectedPanel()
  }
}

/**
 * An inner class that manages the panelContent and its value. A listener as added to the panel so that
 * whenever focus is lost from the panel, it is removed from the traversal order.
 */
class PreferencesPanelContainer extends Node {
  constructor(panelContent, selectedTabValue) {
    super();
    this.panelContent = panelContent;
    this.selectedTabValue = selectedTabValue;
    panelContent.addInputListener({
      focusout: event => {
        panelContent.focusable = false;
      }
    });
  }
}
joist.register('PreferencesPanels', PreferencesPanels);
export default PreferencesPanels;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25pemUiLCJBbGlnbkdyb3VwIiwiTm9kZSIsImpvaXN0IiwiQXVkaW9QcmVmZXJlbmNlc1BhbmVsIiwiU2ltdWxhdGlvblByZWZlcmVuY2VzUGFuZWwiLCJJbnB1dFByZWZlcmVuY2VzUGFuZWwiLCJWaXN1YWxQcmVmZXJlbmNlc1BhbmVsIiwiTG9jYWxpemF0aW9uUHJlZmVyZW5jZXNQYW5lbCIsIlByZWZlcmVuY2VzVHlwZSIsIk92ZXJ2aWV3UHJlZmVyZW5jZXNQYW5lbCIsIlRhbmRlbSIsIlByZWZlcmVuY2VzUGFuZWxzIiwiY29udGVudCIsImNvbnN0cnVjdG9yIiwicHJlZmVyZW5jZXNNb2RlbCIsInN1cHBvcnRlZFRhYnMiLCJzZWxlY3RlZFRhYlByb3BlcnR5IiwicHJlZmVyZW5jZXNUYWJzIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInBoZXRpb1Zpc2libGVQcm9wZXJ0eUluc3RydW1lbnRlZCIsInRhbmRlbSIsIk9QVF9PVVQiLCJwYW5lbEFsaWduR3JvdXAiLCJtYXRjaFZlcnRpY2FsIiwib3ZlcnZpZXdQcmVmZXJlbmNlc1BhbmVsIiwiaW5jbHVkZXMiLCJPVkVSVklFVyIsImdldFRhYlZpc2libGVQcm9wZXJ0eSIsIm92ZXJ2aWV3Qm94IiwiY3JlYXRlQm94IiwiYWRkQ2hpbGQiLCJwdXNoIiwiUHJlZmVyZW5jZXNQYW5lbENvbnRhaW5lciIsInNpbXVsYXRpb25QcmVmZXJlbmNlc1BhbmVsIiwiU0lNVUxBVElPTiIsInNpbXVsYXRpb25Nb2RlbCIsImNyZWF0ZVRhbmRlbSIsInNpbXVsYXRpb25Cb3giLCJ2aXN1YWxQcmVmZXJlbmNlc1BhbmVsIiwiVklTVUFMIiwidmlzdWFsTW9kZWwiLCJ2aXN1YWxCb3giLCJhdWRpb1ByZWZlcmVuY2VzUGFuZWwiLCJBVURJTyIsImF1ZGlvTW9kZWwiLCJhdWRpb0JveCIsImlucHV0UHJlZmVyZW5jZXNQYW5lbCIsIklOUFVUIiwiaW5wdXRNb2RlbCIsImlucHV0Qm94IiwibG9jYWxpemF0aW9uUHJlZmVyZW5jZXNQYW5lbCIsIkxPQ0FMSVpBVElPTiIsImxvY2FsaXphdGlvbk1vZGVsIiwibG9jYWxpemF0aW9uQm94IiwiZGlzcG9zZVByZWZlcmVuY2VzUGFuZWwiLCJkaXNwb3NlIiwiZm9yRWFjaCIsInBhbmVsQ29udGVudCIsImdldFNlbGVjdGVkQ29udGVudCIsImkiLCJsZW5ndGgiLCJjdXJyZW50Q29udGVudCIsInNlbGVjdGVkVGFiVmFsdWUiLCJ2YWx1ZSIsImFzc2VydCIsImZvY3VzU2VsZWN0ZWRQYW5lbCIsInNlbGVjdGVkQ29udGVudCIsImZvY3VzYWJsZSIsImZvY3VzIiwiaXNGb2N1c2FibGVTZWxlY3RlZENvbnRlbnQiLCJub2RlIiwiYWRkSW5wdXRMaXN0ZW5lciIsImZvY3Vzb3V0IiwiZXZlbnQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlByZWZlcmVuY2VzUGFuZWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIxLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFRoZSBwYW5lbHMgdGhhdCBjb250YWluIHByZWZlcmVuY2VzIGNvbnRyb2xzLiBUaGVyZSBpcyBvbmUgcGFuZWwgZm9yIGV2ZXJ5IHRhYiwgYW5kIGl0IGlzIHNob3duIHdoZW4gdGhlXHJcbiAqIGNvcnJlc3BvbmRpbmcgdGFiIGlzIHNlbGVjdGVkLlxyXG4gKlxyXG4gKiBPbmNlIHRoZSBkaWFsb2cgaXMgY3JlYXRlZCBpdCBpcyBuZXZlciBkZXN0cm95ZWQgc28gbGlzdGVuZXJzIGRvIG5vdCBuZWVkIHRvIGJlIGRpc3Bvc2VkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IHsgQWxpZ25Hcm91cCwgTm9kZSwgTm9kZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgam9pc3QgZnJvbSAnLi4vam9pc3QuanMnO1xyXG5pbXBvcnQgQXVkaW9QcmVmZXJlbmNlc1BhbmVsIGZyb20gJy4vQXVkaW9QcmVmZXJlbmNlc1BhbmVsLmpzJztcclxuaW1wb3J0IFNpbXVsYXRpb25QcmVmZXJlbmNlc1BhbmVsIGZyb20gJy4vU2ltdWxhdGlvblByZWZlcmVuY2VzUGFuZWwuanMnO1xyXG5pbXBvcnQgSW5wdXRQcmVmZXJlbmNlc1BhbmVsIGZyb20gJy4vSW5wdXRQcmVmZXJlbmNlc1BhbmVsLmpzJztcclxuaW1wb3J0IFZpc3VhbFByZWZlcmVuY2VzUGFuZWwgZnJvbSAnLi9WaXN1YWxQcmVmZXJlbmNlc1BhbmVsLmpzJztcclxuaW1wb3J0IFByZWZlcmVuY2VzTW9kZWwgZnJvbSAnLi9QcmVmZXJlbmNlc01vZGVsLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgTG9jYWxpemF0aW9uUHJlZmVyZW5jZXNQYW5lbCBmcm9tICcuL0xvY2FsaXphdGlvblByZWZlcmVuY2VzUGFuZWwuanMnO1xyXG5pbXBvcnQgUHJlZmVyZW5jZXNUeXBlIGZyb20gJy4vUHJlZmVyZW5jZXNUeXBlLmpzJztcclxuaW1wb3J0IE92ZXJ2aWV3UHJlZmVyZW5jZXNQYW5lbCBmcm9tICcuL092ZXJ2aWV3UHJlZmVyZW5jZXNQYW5lbC5qcyc7XHJcbmltcG9ydCBQcmVmZXJlbmNlc1RhYnMgZnJvbSAnLi9QcmVmZXJlbmNlc1RhYnMuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcbnR5cGUgUHJlZmVyZW5jZXNQYW5lbHNPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBOb2RlT3B0aW9ucyAmIFBpY2tSZXF1aXJlZDxOb2RlT3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuY2xhc3MgUHJlZmVyZW5jZXNQYW5lbHMgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgLy8gRWFjaCBQcmVmZXJlbmNlcyBQYW5lbCBhcyBhIE5vZGUgY29sbGVjdGVkIGludG8gdGhpcyBhcnJheSBmb3IgbGF5b3V0IGFuZCBvdGhlciBtYW5hZ2VtZW50LlxyXG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGVudDogUHJlZmVyZW5jZXNQYW5lbENvbnRhaW5lcltdID0gW107XHJcblxyXG4gIC8vIFByb3BlcnR5IGNvbnRyb2xsaW5nIHRoZSBzZWxlY3RlZCB0YWIsIHNvIHdlIGNhbiBjb250cm9sIHdoaWNoIHBhbmVsIHNob3VsZCBiZSB2aXNpYmxlLlxyXG4gIHByaXZhdGUgcmVhZG9ubHkgc2VsZWN0ZWRUYWJQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8UHJlZmVyZW5jZXNUeXBlPjtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlUHJlZmVyZW5jZXNQYW5lbDogKCkgPT4gdm9pZDtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHByZWZlcmVuY2VzTW9kZWxcclxuICAgKiBAcGFyYW0gc3VwcG9ydGVkVGFicyAtIGxpc3Qgb2YgVGFicyBzdXBwb3J0ZWQgYnkgdGhpcyBEaWFsb2dcclxuICAgKiBAcGFyYW0gc2VsZWN0ZWRUYWJQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSBwcmVmZXJlbmNlc1RhYnNcclxuICAgKiBAcGFyYW0gW3Byb3ZpZGVkT3B0aW9uc11cclxuICAgKi9cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByZWZlcmVuY2VzTW9kZWw6IFByZWZlcmVuY2VzTW9kZWwsIHN1cHBvcnRlZFRhYnM6IFByZWZlcmVuY2VzVHlwZVtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUYWJQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8UHJlZmVyZW5jZXNUeXBlPiwgcHJlZmVyZW5jZXNUYWJzOiBQcmVmZXJlbmNlc1RhYnMsXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM/OiBQcmVmZXJlbmNlc1BhbmVsc09wdGlvbnMgKSB7XHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFByZWZlcmVuY2VzUGFuZWxzT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcbiAgICAgIHBoZXRpb1Zpc2libGVQcm9wZXJ0eUluc3RydW1lbnRlZDogZmFsc2VcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IHRhbmRlbSA9IG9wdGlvbnMudGFuZGVtO1xyXG5cclxuICAgIC8vIERvbid0IGluc3RydW1lbnQgdGhlIGFjdHVhbCBQcmVmZXJlbmNlc1BhbmVscyBOb2RlLiBUaGVuIGlmIGl0IGRvZXNuJ3QgaGF2ZSBhbnkgY2hpbGRyZW4sIGl0IHdvbid0IGJlIGluIHRoZSBTdHVkaW8gVHJlZSlcclxuICAgIG9wdGlvbnMudGFuZGVtID0gVGFuZGVtLk9QVF9PVVQ7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLnNlbGVjdGVkVGFiUHJvcGVydHkgPSBzZWxlY3RlZFRhYlByb3BlcnR5O1xyXG5cclxuICAgIGNvbnN0IHBhbmVsQWxpZ25Hcm91cCA9IG5ldyBBbGlnbkdyb3VwKCB7XHJcbiAgICAgIG1hdGNoVmVydGljYWw6IGZhbHNlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgbGV0IG92ZXJ2aWV3UHJlZmVyZW5jZXNQYW5lbDogTm9kZSB8IG51bGwgPSBudWxsO1xyXG4gICAgaWYgKCBzdXBwb3J0ZWRUYWJzLmluY2x1ZGVzKCBQcmVmZXJlbmNlc1R5cGUuT1ZFUlZJRVcgKSApIHtcclxuICAgICAgb3ZlcnZpZXdQcmVmZXJlbmNlc1BhbmVsID0gbmV3IE92ZXJ2aWV3UHJlZmVyZW5jZXNQYW5lbCggc2VsZWN0ZWRUYWJQcm9wZXJ0eSwgcHJlZmVyZW5jZXNUYWJzLmdldFRhYlZpc2libGVQcm9wZXJ0eSggUHJlZmVyZW5jZXNUeXBlLk9WRVJWSUVXICkgKTtcclxuICAgICAgY29uc3Qgb3ZlcnZpZXdCb3ggPSBwYW5lbEFsaWduR3JvdXAuY3JlYXRlQm94KCBvdmVydmlld1ByZWZlcmVuY2VzUGFuZWwgKTtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggb3ZlcnZpZXdCb3ggKTtcclxuICAgICAgdGhpcy5jb250ZW50LnB1c2goIG5ldyBQcmVmZXJlbmNlc1BhbmVsQ29udGFpbmVyKCBvdmVydmlld1ByZWZlcmVuY2VzUGFuZWwsIFByZWZlcmVuY2VzVHlwZS5PVkVSVklFVyApICk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHNpbXVsYXRpb25QcmVmZXJlbmNlc1BhbmVsOiBOb2RlIHwgbnVsbCA9IG51bGw7XHJcbiAgICBpZiAoIHN1cHBvcnRlZFRhYnMuaW5jbHVkZXMoIFByZWZlcmVuY2VzVHlwZS5TSU1VTEFUSU9OICkgKSB7XHJcbiAgICAgIHNpbXVsYXRpb25QcmVmZXJlbmNlc1BhbmVsID0gbmV3IFNpbXVsYXRpb25QcmVmZXJlbmNlc1BhbmVsKFxyXG4gICAgICAgIHByZWZlcmVuY2VzTW9kZWwuc2ltdWxhdGlvbk1vZGVsLCBzZWxlY3RlZFRhYlByb3BlcnR5LCBwcmVmZXJlbmNlc1RhYnMuZ2V0VGFiVmlzaWJsZVByb3BlcnR5KCBQcmVmZXJlbmNlc1R5cGUuU0lNVUxBVElPTiApLCB7XHJcbiAgICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdzaW11bGF0aW9uUHJlZmVyZW5jZXNQYW5lbCcgKVxyXG4gICAgICAgIH0gKTtcclxuICAgICAgY29uc3Qgc2ltdWxhdGlvbkJveCA9IHBhbmVsQWxpZ25Hcm91cC5jcmVhdGVCb3goIHNpbXVsYXRpb25QcmVmZXJlbmNlc1BhbmVsICk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIHNpbXVsYXRpb25Cb3ggKTtcclxuICAgICAgdGhpcy5jb250ZW50LnB1c2goIG5ldyBQcmVmZXJlbmNlc1BhbmVsQ29udGFpbmVyKCBzaW11bGF0aW9uUHJlZmVyZW5jZXNQYW5lbCwgUHJlZmVyZW5jZXNUeXBlLlNJTVVMQVRJT04gKSApO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCB2aXN1YWxQcmVmZXJlbmNlc1BhbmVsOiBOb2RlIHwgbnVsbCA9IG51bGw7XHJcbiAgICBpZiAoIHN1cHBvcnRlZFRhYnMuaW5jbHVkZXMoIFByZWZlcmVuY2VzVHlwZS5WSVNVQUwgKSApIHtcclxuICAgICAgdmlzdWFsUHJlZmVyZW5jZXNQYW5lbCA9IG5ldyBWaXN1YWxQcmVmZXJlbmNlc1BhbmVsKFxyXG4gICAgICAgIHByZWZlcmVuY2VzTW9kZWwudmlzdWFsTW9kZWwsXHJcbiAgICAgICAgc2VsZWN0ZWRUYWJQcm9wZXJ0eSxcclxuICAgICAgICBwcmVmZXJlbmNlc1RhYnMuZ2V0VGFiVmlzaWJsZVByb3BlcnR5KCBQcmVmZXJlbmNlc1R5cGUuVklTVUFMICksIHtcclxuICAgICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3Zpc3VhbFByZWZlcmVuY2VzUGFuZWwnIClcclxuICAgICAgICB9ICk7XHJcbiAgICAgIGNvbnN0IHZpc3VhbEJveCA9IHBhbmVsQWxpZ25Hcm91cC5jcmVhdGVCb3goIHZpc3VhbFByZWZlcmVuY2VzUGFuZWwgKTtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggdmlzdWFsQm94ICk7XHJcbiAgICAgIHRoaXMuY29udGVudC5wdXNoKCBuZXcgUHJlZmVyZW5jZXNQYW5lbENvbnRhaW5lciggdmlzdWFsUHJlZmVyZW5jZXNQYW5lbCwgUHJlZmVyZW5jZXNUeXBlLlZJU1VBTCApICk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGF1ZGlvUHJlZmVyZW5jZXNQYW5lbDogTm9kZSB8IG51bGwgPSBudWxsO1xyXG4gICAgaWYgKCBzdXBwb3J0ZWRUYWJzLmluY2x1ZGVzKCBQcmVmZXJlbmNlc1R5cGUuQVVESU8gKSApIHtcclxuICAgICAgYXVkaW9QcmVmZXJlbmNlc1BhbmVsID0gbmV3IEF1ZGlvUHJlZmVyZW5jZXNQYW5lbChcclxuICAgICAgICBwcmVmZXJlbmNlc01vZGVsLmF1ZGlvTW9kZWwsXHJcbiAgICAgICAgc2VsZWN0ZWRUYWJQcm9wZXJ0eSxcclxuICAgICAgICBwcmVmZXJlbmNlc1RhYnMuZ2V0VGFiVmlzaWJsZVByb3BlcnR5KCBQcmVmZXJlbmNlc1R5cGUuQVVESU8gKSwge1xyXG4gICAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnYXVkaW9QcmVmZXJlbmNlc1BhbmVsJyApXHJcbiAgICAgICAgfSApO1xyXG4gICAgICBjb25zdCBhdWRpb0JveCA9IHBhbmVsQWxpZ25Hcm91cC5jcmVhdGVCb3goIGF1ZGlvUHJlZmVyZW5jZXNQYW5lbCApO1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCBhdWRpb0JveCApO1xyXG4gICAgICB0aGlzLmNvbnRlbnQucHVzaCggbmV3IFByZWZlcmVuY2VzUGFuZWxDb250YWluZXIoIGF1ZGlvUHJlZmVyZW5jZXNQYW5lbCwgUHJlZmVyZW5jZXNUeXBlLkFVRElPICkgKTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgaW5wdXRQcmVmZXJlbmNlc1BhbmVsOiBOb2RlIHwgbnVsbCA9IG51bGw7XHJcbiAgICBpZiAoIHN1cHBvcnRlZFRhYnMuaW5jbHVkZXMoIFByZWZlcmVuY2VzVHlwZS5JTlBVVCApICkge1xyXG4gICAgICBpbnB1dFByZWZlcmVuY2VzUGFuZWwgPSBuZXcgSW5wdXRQcmVmZXJlbmNlc1BhbmVsKFxyXG4gICAgICAgIHByZWZlcmVuY2VzTW9kZWwuaW5wdXRNb2RlbCxcclxuICAgICAgICBzZWxlY3RlZFRhYlByb3BlcnR5LFxyXG4gICAgICAgIHByZWZlcmVuY2VzVGFicy5nZXRUYWJWaXNpYmxlUHJvcGVydHkoIFByZWZlcmVuY2VzVHlwZS5JTlBVVCApLCB7XHJcbiAgICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdpbnB1dFByZWZlcmVuY2VzUGFuZWwnIClcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICAgIGNvbnN0IGlucHV0Qm94ID0gcGFuZWxBbGlnbkdyb3VwLmNyZWF0ZUJveCggaW5wdXRQcmVmZXJlbmNlc1BhbmVsICk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIGlucHV0Qm94ICk7XHJcbiAgICAgIHRoaXMuY29udGVudC5wdXNoKCBuZXcgUHJlZmVyZW5jZXNQYW5lbENvbnRhaW5lciggaW5wdXRQcmVmZXJlbmNlc1BhbmVsLCBQcmVmZXJlbmNlc1R5cGUuSU5QVVQgKSApO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBsb2NhbGl6YXRpb25QcmVmZXJlbmNlc1BhbmVsOiBOb2RlIHwgbnVsbCA9IG51bGw7XHJcbiAgICBpZiAoIHN1cHBvcnRlZFRhYnMuaW5jbHVkZXMoIFByZWZlcmVuY2VzVHlwZS5MT0NBTElaQVRJT04gKSApIHtcclxuICAgICAgbG9jYWxpemF0aW9uUHJlZmVyZW5jZXNQYW5lbCA9IG5ldyBMb2NhbGl6YXRpb25QcmVmZXJlbmNlc1BhbmVsKFxyXG4gICAgICAgIHByZWZlcmVuY2VzTW9kZWwubG9jYWxpemF0aW9uTW9kZWwsXHJcbiAgICAgICAgc2VsZWN0ZWRUYWJQcm9wZXJ0eSxcclxuICAgICAgICBwcmVmZXJlbmNlc1RhYnMuZ2V0VGFiVmlzaWJsZVByb3BlcnR5KCBQcmVmZXJlbmNlc1R5cGUuTE9DQUxJWkFUSU9OICksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnbG9jYWxpemF0aW9uUHJlZmVyZW5jZXNQYW5lbCcgKVxyXG4gICAgICAgIH0gKTtcclxuICAgICAgY29uc3QgbG9jYWxpemF0aW9uQm94ID0gcGFuZWxBbGlnbkdyb3VwLmNyZWF0ZUJveCggbG9jYWxpemF0aW9uUHJlZmVyZW5jZXNQYW5lbCApO1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCBsb2NhbGl6YXRpb25Cb3ggKTtcclxuICAgICAgdGhpcy5jb250ZW50LnB1c2goIG5ldyBQcmVmZXJlbmNlc1BhbmVsQ29udGFpbmVyKCBsb2NhbGl6YXRpb25QcmVmZXJlbmNlc1BhbmVsLCBQcmVmZXJlbmNlc1R5cGUuTE9DQUxJWkFUSU9OICkgKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VQcmVmZXJlbmNlc1BhbmVsID0gKCkgPT4ge1xyXG4gICAgICBwYW5lbEFsaWduR3JvdXAuZGlzcG9zZSgpO1xyXG4gICAgICB0aGlzLmNvbnRlbnQuZm9yRWFjaCggcGFuZWxDb250ZW50ID0+IHBhbmVsQ29udGVudC5kaXNwb3NlKCkgKTtcclxuXHJcbiAgICAgIG92ZXJ2aWV3UHJlZmVyZW5jZXNQYW5lbCAmJiBvdmVydmlld1ByZWZlcmVuY2VzUGFuZWwuZGlzcG9zZSgpO1xyXG4gICAgICBzaW11bGF0aW9uUHJlZmVyZW5jZXNQYW5lbCAmJiBzaW11bGF0aW9uUHJlZmVyZW5jZXNQYW5lbC5kaXNwb3NlKCk7XHJcbiAgICAgIHZpc3VhbFByZWZlcmVuY2VzUGFuZWwgJiYgdmlzdWFsUHJlZmVyZW5jZXNQYW5lbC5kaXNwb3NlKCk7XHJcbiAgICAgIGF1ZGlvUHJlZmVyZW5jZXNQYW5lbCAmJiBhdWRpb1ByZWZlcmVuY2VzUGFuZWwuZGlzcG9zZSgpO1xyXG4gICAgICBpbnB1dFByZWZlcmVuY2VzUGFuZWwgJiYgaW5wdXRQcmVmZXJlbmNlc1BhbmVsLmRpc3Bvc2UoKTtcclxuICAgICAgbG9jYWxpemF0aW9uUHJlZmVyZW5jZXNQYW5lbCAmJiBsb2NhbGl6YXRpb25QcmVmZXJlbmNlc1BhbmVsLmRpc3Bvc2UoKTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZGlzcG9zZVByZWZlcmVuY2VzUGFuZWwoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIHZpc2libGUgY29udGVudCBwYW5lbCBOb2RlIGZvciB0aGUgc2VsZWN0ZWQgUHJlZmVyZW5jZXNUeXBlLlxyXG4gICAqIE5PVEU6IExvb3Agc2hvdWxkbid0IGJlIG5lY2Vzc2FyeSwgY3JlYXRlIGEgbWFwIHRoYXQgZ29lcyBmcm9tIFByZWZlcmVuY2VzVHlwZSAtPiBjb250ZW50LlxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0U2VsZWN0ZWRDb250ZW50KCk6IFByZWZlcmVuY2VzUGFuZWxDb250YWluZXIgfCBudWxsIHtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHRoaXMuY29udGVudC5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgY29uc3QgY3VycmVudENvbnRlbnQgPSB0aGlzLmNvbnRlbnRbIGkgXTtcclxuICAgICAgaWYgKCBjdXJyZW50Q29udGVudC5zZWxlY3RlZFRhYlZhbHVlID09PSB0aGlzLnNlbGVjdGVkVGFiUHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRDb250ZW50O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBmYWxzZSwgJ3Nob3VsZCBuZXZlciBub3QgaGF2ZSBhIHNlbGVjdGVkIHBhbmVsIGNvbnRlbnQuJyApO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGb2N1cyB0aGUgc2VsZWN0ZWQgcGFuZWwuIFRoZSBwYW5lbCBzaG91bGQgbm90IGJlIGZvY3VzYWJsZSB1bnRpbCB0aGlzIGlzIHJlcXVlc3RlZCwgc28gaXQgaXMgc2V0IHRvIGJlXHJcbiAgICogZm9jdXNhYmxlIGJlZm9yZSB0aGUgZm9jdXMoKSBjYWxsLiBXaGVuIGZvY3VzIGlzIHJlbW92ZWQgZnJvbSB0aGUgcGFuZWwsIGl0IHNob3VsZCBiZWNvbWUgbm9uLWZvY3VzYWJsZVxyXG4gICAqIGFnYWluLiBUaGF0IGlzIGhhbmRsZWQgaW4gUHJlZmVyZW5jZXNQYW5lbENvbnRhaW5lciBjbGFzcy5cclxuICAgKi9cclxuICBwdWJsaWMgZm9jdXNTZWxlY3RlZFBhbmVsKCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc2VsZWN0ZWRDb250ZW50ID0gdGhpcy5nZXRTZWxlY3RlZENvbnRlbnQoKTtcclxuICAgIHNlbGVjdGVkQ29udGVudCEucGFuZWxDb250ZW50LmZvY3VzYWJsZSA9IHRydWU7XHJcbiAgICBzZWxlY3RlZENvbnRlbnQhLnBhbmVsQ29udGVudC5mb2N1cygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIG5vZGUgLSB0aGUgcG90ZW50aWFsIGNvbnRlbnQgZm9yIHRoZSBzZWxlY3RlZCBwYW5lbCB0aGF0IGlzIGZvY3VzYWJsZVxyXG4gICAqIEByZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIG5vZGUgaXMgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBwYW5lbFxyXG4gICAqL1xyXG4gIHB1YmxpYyBpc0ZvY3VzYWJsZVNlbGVjdGVkQ29udGVudCggbm9kZTogTm9kZSApOiBib29sZWFuIHtcclxuICAgIGNvbnN0IHNlbGVjdGVkQ29udGVudCA9IHRoaXMuZ2V0U2VsZWN0ZWRDb250ZW50KCk7XHJcbiAgICByZXR1cm4gbm9kZSA9PT0gc2VsZWN0ZWRDb250ZW50IS5wYW5lbENvbnRlbnQ7IC8vIHRoZSBwYW5lbENvbnRlbnQgaXMgd2hhdCBpcyBmb2N1c2VkIGluIGZvY3VzU2VsZWN0ZWRQYW5lbCgpXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQW4gaW5uZXIgY2xhc3MgdGhhdCBtYW5hZ2VzIHRoZSBwYW5lbENvbnRlbnQgYW5kIGl0cyB2YWx1ZS4gQSBsaXN0ZW5lciBhcyBhZGRlZCB0byB0aGUgcGFuZWwgc28gdGhhdFxyXG4gKiB3aGVuZXZlciBmb2N1cyBpcyBsb3N0IGZyb20gdGhlIHBhbmVsLCBpdCBpcyByZW1vdmVkIGZyb20gdGhlIHRyYXZlcnNhbCBvcmRlci5cclxuICovXHJcbmNsYXNzIFByZWZlcmVuY2VzUGFuZWxDb250YWluZXIgZXh0ZW5kcyBOb2RlIHtcclxuICBwdWJsaWMgcmVhZG9ubHkgcGFuZWxDb250ZW50OiBOb2RlO1xyXG4gIHB1YmxpYyByZWFkb25seSBzZWxlY3RlZFRhYlZhbHVlOiBQcmVmZXJlbmNlc1R5cGU7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcGFuZWxDb250ZW50OiBOb2RlLCBzZWxlY3RlZFRhYlZhbHVlOiBQcmVmZXJlbmNlc1R5cGUgKSB7XHJcbiAgICBzdXBlcigpO1xyXG5cclxuICAgIHRoaXMucGFuZWxDb250ZW50ID0gcGFuZWxDb250ZW50O1xyXG4gICAgdGhpcy5zZWxlY3RlZFRhYlZhbHVlID0gc2VsZWN0ZWRUYWJWYWx1ZTtcclxuXHJcbiAgICBwYW5lbENvbnRlbnQuYWRkSW5wdXRMaXN0ZW5lcigge1xyXG4gICAgICBmb2N1c291dDogZXZlbnQgPT4ge1xyXG4gICAgICAgIHBhbmVsQ29udGVudC5mb2N1c2FibGUgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxufVxyXG5cclxuam9pc3QucmVnaXN0ZXIoICdQcmVmZXJlbmNlc1BhbmVscycsIFByZWZlcmVuY2VzUGFuZWxzICk7XHJcbmV4cG9ydCBkZWZhdWx0IFByZWZlcmVuY2VzUGFuZWxzOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxTQUFTLE1BQTRCLG9DQUFvQztBQUNoRixTQUFTQyxVQUFVLEVBQUVDLElBQUksUUFBcUIsZ0NBQWdDO0FBQzlFLE9BQU9DLEtBQUssTUFBTSxhQUFhO0FBQy9CLE9BQU9DLHFCQUFxQixNQUFNLDRCQUE0QjtBQUM5RCxPQUFPQywwQkFBMEIsTUFBTSxpQ0FBaUM7QUFDeEUsT0FBT0MscUJBQXFCLE1BQU0sNEJBQTRCO0FBQzlELE9B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