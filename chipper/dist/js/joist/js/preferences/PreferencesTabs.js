// Copyright 2021-2023, University of Colorado Boulder

/**
 * The tabs for the PreferencesDialog. Activating a tab will select a PreferencesTabPanel to be displayed to the user.
 * The actual tabs are implemented as radio buttons, styled to look like flat like a set of tabs.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import optionize from '../../../phet-core/js/optionize.js';
import globeSolidShape from '../../../sherpa/js/fontawesome-5/globeSolidShape.js';
import { HBox, KeyboardUtils, Path } from '../../../scenery/js/imports.js';
import joist from '../joist.js';
import JoistStrings from '../JoistStrings.js';
import PreferencesType from './PreferencesType.js';
import PreferencesTab from './PreferencesTab.js';
import Multilink from '../../../axon/js/Multilink.js';
class PreferencesTabs extends HBox {
  //  A reference to the selected and focusable tab content so that we can determine which
  // tab is next in order when cycling through with alternative input.
  selectedButton = null;
  content = [];
  constructor(supportedTabs, selectedPanelProperty, providedOptions) {
    const options = optionize()({
      // pdom
      tagName: 'ul',
      ariaRole: 'tablist',
      groupFocusHighlight: true,
      spacing: 10,
      align: 'bottom'
    }, providedOptions);
    super(options);
    this.selectedPanelProperty = selectedPanelProperty;
    const isTabSupported = preferencesType => _.includes(supportedTabs, preferencesType);
    if (isTabSupported(PreferencesType.OVERVIEW)) {
      this.content.push(new PreferencesTab(JoistStrings.preferences.tabs.overview.titleStringProperty, selectedPanelProperty, PreferencesType.OVERVIEW, {
        tandem: options.tandem.createTandem('overviewTab')
      }));
    }
    if (isTabSupported(PreferencesType.SIMULATION)) {
      this.content.push(new PreferencesTab(JoistStrings.preferences.tabs.simulation.titleStringProperty, selectedPanelProperty, PreferencesType.SIMULATION, {
        tandem: options.tandem.createTandem('simulationTab')
      }));
    }
    if (isTabSupported(PreferencesType.VISUAL)) {
      this.content.push(new PreferencesTab(JoistStrings.preferences.tabs.visual.titleStringProperty, selectedPanelProperty, PreferencesType.VISUAL, {
        tandem: options.tandem.createTandem('visualTab')
      }));
    }
    if (isTabSupported(PreferencesType.AUDIO)) {
      this.content.push(new PreferencesTab(JoistStrings.preferences.tabs.audio.titleStringProperty, selectedPanelProperty, PreferencesType.AUDIO, {
        tandem: options.tandem.createTandem('audioTab')
      }));
    }
    if (isTabSupported(PreferencesType.INPUT)) {
      this.content.push(new PreferencesTab(JoistStrings.preferences.tabs.input.titleStringProperty, selectedPanelProperty, PreferencesType.INPUT, {
        tandem: options.tandem.createTandem('inputTab')
      }));
    }
    if (isTabSupported(PreferencesType.LOCALIZATION)) {
      this.content.push(new PreferencesTab(JoistStrings.preferences.tabs.localization.titleStringProperty, selectedPanelProperty, PreferencesType.LOCALIZATION, {
        // Display a globe icon next to the localization label
        iconNode: new Path(globeSolidShape, {
          scale: 1 / 25,
          // by inspection
          fill: 'black'
        }),
        tandem: options.tandem.createTandem('localizationTab')
      }));
    }
    this.children = this.content;

    // If the currently selected tab is hidden via phet-io, then select the first visible tab (if there is one)
    const visibilityMultilink = Multilink.multilinkAny([selectedPanelProperty, ...this.content.map(tab => tab.visibleProperty)], () => {
      // Find the tab corresponding to the current selection
      const tab = this.content.find(tab => tab.value === selectedPanelProperty.value);

      // If the selected tab is not showing...
      if (!tab.visibleProperty.value) {
        // Find the leftmost tab that is showing (if there are any showing tabs)
        const firstShowingTab = this.content.find(tab => tab.visibleProperty.value);
        if (firstShowingTab) {
          selectedPanelProperty.value = firstShowingTab.value;
        }
      }
    });

    // pdom - keyboard support to move through tabs with arrow keys
    const keyboardListener = {
      keydown: event => {
        // reserve keyboard events for dragging to prevent default panning behavior with zoom features
        event.pointer.reserveForKeyboardDrag();
      },
      keyup: event => {
        if (KeyboardUtils.isAnyKeyEvent(event.domEvent, [KeyboardUtils.KEY_RIGHT_ARROW, KeyboardUtils.KEY_LEFT_ARROW])) {
          // prevent "native" behavior so that Safari doesn't make an error sound with arrow keys in full screen mode
          event.domEvent.preventDefault();
          const direction = KeyboardUtils.isKeyEvent(event.domEvent, KeyboardUtils.KEY_RIGHT_ARROW) ? 1 : -1;
          for (let i = 0; i < this.content.length; i++) {
            if (this.selectedButton === this.content[i]) {
              const nextButtonContent = this.content[i + direction];
              if (nextButtonContent) {
                // select the next tab and move focus to it - a listener on selectedPanelProperty sets the next
                // selectedButton and makes it focusable
                selectedPanelProperty.value = nextButtonContent.value;
                this.selectedButton.focus();
                break;
              }
            }
          }
        }
      }
    };
    this.addInputListener(keyboardListener);
    const selectedPanelListener = () => {
      this.content.forEach(content => {
        if (content.value === this.selectedPanelProperty.value) {
          this.selectedButton = content;
        }
      });
    };
    selectedPanelProperty.link(selectedPanelListener);

    // if there is only one tab, it is not interactive
    if (supportedTabs.length === 1) {
      this.focusable = false;
      this.inputEnabledProperty.value = false;
    }
    this.disposePreferencesTabs = () => {
      this.removeInputListener(keyboardListener);
      selectedPanelProperty.unlink(selectedPanelListener);
      Multilink.unmultilink(visibilityMultilink);
      this.content.forEach(tab => tab.dispose());
    };
  }

  /**
   * Returns the visibleProperty for the Tab associated with the PreferencesType. PreferencesTabs need to be hidden
   * if the Tab becomes invisible (mostly needed for PhET-iO).
   */
  getTabVisibleProperty(preferencesType) {
    const tab = _.find(this.content, content => content.value === preferencesType);
    assert && assert(tab, `tab not found for PreferencesType, ${preferencesType.name}`);
    return tab.visibleProperty;
  }

  /**
   * Move focus to the selected tab. Useful when the Preferences dialog is opened.
   */
  focusSelectedTab() {
    this.content.forEach(content => {
      if (content.value === this.selectedPanelProperty.value) {
        content.focus();
      }
    });
  }
  dispose() {
    this.disposePreferencesTabs();
    super.dispose();
  }
}
joist.register('PreferencesTabs', PreferencesTabs);
export default PreferencesTabs;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25pemUiLCJnbG9iZVNvbGlkU2hhcGUiLCJIQm94IiwiS2V5Ym9hcmRVdGlscyIsIlBhdGgiLCJqb2lzdCIsIkpvaXN0U3RyaW5ncyIsIlByZWZlcmVuY2VzVHlwZSIsIlByZWZlcmVuY2VzVGFiIiwiTXVsdGlsaW5rIiwiUHJlZmVyZW5jZXNUYWJzIiwic2VsZWN0ZWRCdXR0b24iLCJjb250ZW50IiwiY29uc3RydWN0b3IiLCJzdXBwb3J0ZWRUYWJzIiwic2VsZWN0ZWRQYW5lbFByb3BlcnR5IiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInRhZ05hbWUiLCJhcmlhUm9sZSIsImdyb3VwRm9jdXNIaWdobGlnaHQiLCJzcGFjaW5nIiwiYWxpZ24iLCJpc1RhYlN1cHBvcnRlZCIsInByZWZlcmVuY2VzVHlwZSIsIl8iLCJpbmNsdWRlcyIsIk9WRVJWSUVXIiwicHVzaCIsInByZWZlcmVuY2VzIiwidGFicyIsIm92ZXJ2aWV3IiwidGl0bGVTdHJpbmdQcm9wZXJ0eSIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsIlNJTVVMQVRJT04iLCJzaW11bGF0aW9uIiwiVklTVUFMIiwidmlzdWFsIiwiQVVESU8iLCJhdWRpbyIsIklOUFVUIiwiaW5wdXQiLCJMT0NBTElaQVRJT04iLCJsb2NhbGl6YXRpb24iLCJpY29uTm9kZSIsInNjYWxlIiwiZmlsbCIsImNoaWxkcmVuIiwidmlzaWJpbGl0eU11bHRpbGluayIsIm11bHRpbGlua0FueSIsIm1hcCIsInRhYiIsInZpc2libGVQcm9wZXJ0eSIsImZpbmQiLCJ2YWx1ZSIsImZpcnN0U2hvd2luZ1RhYiIsImtleWJvYXJkTGlzdGVuZXIiLCJrZXlkb3duIiwiZXZlbnQiLCJwb2ludGVyIiwicmVzZXJ2ZUZvcktleWJvYXJkRHJhZyIsImtleXVwIiwiaXNBbnlLZXlFdmVudCIsImRvbUV2ZW50IiwiS0VZX1JJR0hUX0FSUk9XIiwiS0VZX0xFRlRfQVJST1ciLCJwcmV2ZW50RGVmYXVsdCIsImRpcmVjdGlvbiIsImlzS2V5RXZlbnQiLCJpIiwibGVuZ3RoIiwibmV4dEJ1dHRvbkNvbnRlbnQiLCJmb2N1cyIsImFkZElucHV0TGlzdGVuZXIiLCJzZWxlY3RlZFBhbmVsTGlzdGVuZXIiLCJmb3JFYWNoIiwibGluayIsImZvY3VzYWJsZSIsImlucHV0RW5hYmxlZFByb3BlcnR5IiwiZGlzcG9zZVByZWZlcmVuY2VzVGFicyIsInJlbW92ZUlucHV0TGlzdGVuZXIiLCJ1bmxpbmsiLCJ1bm11bHRpbGluayIsImRpc3Bvc2UiLCJnZXRUYWJWaXNpYmxlUHJvcGVydHkiLCJhc3NlcnQiLCJuYW1lIiwiZm9jdXNTZWxlY3RlZFRhYiIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiUHJlZmVyZW5jZXNUYWJzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIxLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFRoZSB0YWJzIGZvciB0aGUgUHJlZmVyZW5jZXNEaWFsb2cuIEFjdGl2YXRpbmcgYSB0YWIgd2lsbCBzZWxlY3QgYSBQcmVmZXJlbmNlc1RhYlBhbmVsIHRvIGJlIGRpc3BsYXllZCB0byB0aGUgdXNlci5cclxuICogVGhlIGFjdHVhbCB0YWJzIGFyZSBpbXBsZW1lbnRlZCBhcyByYWRpbyBidXR0b25zLCBzdHlsZWQgdG8gbG9vayBsaWtlIGZsYXQgbGlrZSBhIHNldCBvZiB0YWJzLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgVFByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvVFByb3BlcnR5LmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IGdsb2JlU29saWRTaGFwZSBmcm9tICcuLi8uLi8uLi9zaGVycGEvanMvZm9udGF3ZXNvbWUtNS9nbG9iZVNvbGlkU2hhcGUuanMnO1xyXG5pbXBvcnQgeyBIQm94LCBIQm94T3B0aW9ucywgS2V5Ym9hcmRVdGlscywgTm9kZSwgUGF0aCwgVElucHV0TGlzdGVuZXIgfSBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgam9pc3QgZnJvbSAnLi4vam9pc3QuanMnO1xyXG5pbXBvcnQgSm9pc3RTdHJpbmdzIGZyb20gJy4uL0pvaXN0U3RyaW5ncy5qcyc7XHJcbmltcG9ydCBQcmVmZXJlbmNlc1R5cGUgZnJvbSAnLi9QcmVmZXJlbmNlc1R5cGUuanMnO1xyXG5pbXBvcnQgUHJlZmVyZW5jZXNUYWIgZnJvbSAnLi9QcmVmZXJlbmNlc1RhYi5qcyc7XHJcbmltcG9ydCBQaWNrUmVxdWlyZWQgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1BpY2tSZXF1aXJlZC5qcyc7XHJcbmltcG9ydCBNdWx0aWxpbmsgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9NdWx0aWxpbmsuanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcblxyXG5leHBvcnQgdHlwZSBQcmVmZXJlbmNlc1RhYnNPcHRpb25zID0gSEJveE9wdGlvbnMgJiBQaWNrUmVxdWlyZWQ8SEJveE9wdGlvbnMsICd0YW5kZW0nPjtcclxuXHJcbmNsYXNzIFByZWZlcmVuY2VzVGFicyBleHRlbmRzIEhCb3gge1xyXG5cclxuICAvLyAgQSByZWZlcmVuY2UgdG8gdGhlIHNlbGVjdGVkIGFuZCBmb2N1c2FibGUgdGFiIGNvbnRlbnQgc28gdGhhdCB3ZSBjYW4gZGV0ZXJtaW5lIHdoaWNoXHJcbiAgLy8gdGFiIGlzIG5leHQgaW4gb3JkZXIgd2hlbiBjeWNsaW5nIHRocm91Z2ggd2l0aCBhbHRlcm5hdGl2ZSBpbnB1dC5cclxuICBwcml2YXRlIHNlbGVjdGVkQnV0dG9uOiBOb2RlIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBzZWxlY3RlZFBhbmVsUHJvcGVydHk6IFRQcm9wZXJ0eTxQcmVmZXJlbmNlc1R5cGU+O1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGVudDogUHJlZmVyZW5jZXNUYWJbXSA9IFtdO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZVByZWZlcmVuY2VzVGFiczogKCkgPT4gdm9pZDtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBzdXBwb3J0ZWRUYWJzOiBQcmVmZXJlbmNlc1R5cGVbXSwgc2VsZWN0ZWRQYW5lbFByb3BlcnR5OiBUUHJvcGVydHk8UHJlZmVyZW5jZXNUeXBlPiwgcHJvdmlkZWRPcHRpb25zOiBQcmVmZXJlbmNlc1RhYnNPcHRpb25zICkge1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxQcmVmZXJlbmNlc1RhYnNPcHRpb25zLCBTZWxmT3B0aW9ucywgSEJveE9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIHBkb21cclxuICAgICAgdGFnTmFtZTogJ3VsJyxcclxuICAgICAgYXJpYVJvbGU6ICd0YWJsaXN0JyxcclxuICAgICAgZ3JvdXBGb2N1c0hpZ2hsaWdodDogdHJ1ZSxcclxuICAgICAgc3BhY2luZzogMTAsXHJcbiAgICAgIGFsaWduOiAnYm90dG9tJ1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLnNlbGVjdGVkUGFuZWxQcm9wZXJ0eSA9IHNlbGVjdGVkUGFuZWxQcm9wZXJ0eTtcclxuXHJcbiAgICBjb25zdCBpc1RhYlN1cHBvcnRlZCA9ICggcHJlZmVyZW5jZXNUeXBlOiBQcmVmZXJlbmNlc1R5cGUgKSA9PiBfLmluY2x1ZGVzKCBzdXBwb3J0ZWRUYWJzLCBwcmVmZXJlbmNlc1R5cGUgKTtcclxuXHJcbiAgICBpZiAoIGlzVGFiU3VwcG9ydGVkKCBQcmVmZXJlbmNlc1R5cGUuT1ZFUlZJRVcgKSApIHtcclxuICAgICAgdGhpcy5jb250ZW50LnB1c2goIG5ldyBQcmVmZXJlbmNlc1RhYiggSm9pc3RTdHJpbmdzLnByZWZlcmVuY2VzLnRhYnMub3ZlcnZpZXcudGl0bGVTdHJpbmdQcm9wZXJ0eSwgc2VsZWN0ZWRQYW5lbFByb3BlcnR5LCBQcmVmZXJlbmNlc1R5cGUuT1ZFUlZJRVcsIHtcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ292ZXJ2aWV3VGFiJyApXHJcbiAgICAgIH0gKSApO1xyXG4gICAgfVxyXG4gICAgaWYgKCBpc1RhYlN1cHBvcnRlZCggUHJlZmVyZW5jZXNUeXBlLlNJTVVMQVRJT04gKSApIHtcclxuICAgICAgdGhpcy5jb250ZW50LnB1c2goIG5ldyBQcmVmZXJlbmNlc1RhYiggSm9pc3RTdHJpbmdzLnByZWZlcmVuY2VzLnRhYnMuc2ltdWxhdGlvbi50aXRsZVN0cmluZ1Byb3BlcnR5LCBzZWxlY3RlZFBhbmVsUHJvcGVydHksIFByZWZlcmVuY2VzVHlwZS5TSU1VTEFUSU9OLCB7XHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdzaW11bGF0aW9uVGFiJyApXHJcbiAgICAgIH0gKSApO1xyXG4gICAgfVxyXG4gICAgaWYgKCBpc1RhYlN1cHBvcnRlZCggUHJlZmVyZW5jZXNUeXBlLlZJU1VBTCApICkge1xyXG4gICAgICB0aGlzLmNvbnRlbnQucHVzaCggbmV3IFByZWZlcmVuY2VzVGFiKCBKb2lzdFN0cmluZ3MucHJlZmVyZW5jZXMudGFicy52aXN1YWwudGl0bGVTdHJpbmdQcm9wZXJ0eSwgc2VsZWN0ZWRQYW5lbFByb3BlcnR5LCBQcmVmZXJlbmNlc1R5cGUuVklTVUFMLCB7XHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICd2aXN1YWxUYWInIClcclxuICAgICAgfSApICk7XHJcbiAgICB9XHJcbiAgICBpZiAoIGlzVGFiU3VwcG9ydGVkKCBQcmVmZXJlbmNlc1R5cGUuQVVESU8gKSApIHtcclxuICAgICAgdGhpcy5jb250ZW50LnB1c2goIG5ldyBQcmVmZXJlbmNlc1RhYiggSm9pc3RTdHJpbmdzLnByZWZlcmVuY2VzLnRhYnMuYXVkaW8udGl0bGVTdHJpbmdQcm9wZXJ0eSwgc2VsZWN0ZWRQYW5lbFByb3BlcnR5LCBQcmVmZXJlbmNlc1R5cGUuQVVESU8sIHtcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2F1ZGlvVGFiJyApXHJcbiAgICAgIH0gKSApO1xyXG4gICAgfVxyXG4gICAgaWYgKCBpc1RhYlN1cHBvcnRlZCggUHJlZmVyZW5jZXNUeXBlLklOUFVUICkgKSB7XHJcbiAgICAgIHRoaXMuY29udGVudC5wdXNoKCBuZXcgUHJlZmVyZW5jZXNUYWIoIEpvaXN0U3RyaW5ncy5wcmVmZXJlbmNlcy50YWJzLmlucHV0LnRpdGxlU3RyaW5nUHJvcGVydHksIHNlbGVjdGVkUGFuZWxQcm9wZXJ0eSwgUHJlZmVyZW5jZXNUeXBlLklOUFVULCB7XHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdpbnB1dFRhYicgKVxyXG4gICAgICB9ICkgKTtcclxuICAgIH1cclxuICAgIGlmICggaXNUYWJTdXBwb3J0ZWQoIFByZWZlcmVuY2VzVHlwZS5MT0NBTElaQVRJT04gKSApIHtcclxuICAgICAgdGhpcy5jb250ZW50LnB1c2goIG5ldyBQcmVmZXJlbmNlc1RhYiggSm9pc3RTdHJpbmdzLnByZWZlcmVuY2VzLnRhYnMubG9jYWxpemF0aW9uLnRpdGxlU3RyaW5nUHJvcGVydHksIHNlbGVjdGVkUGFuZWxQcm9wZXJ0eSwgUHJlZmVyZW5jZXNUeXBlLkxPQ0FMSVpBVElPTiwge1xyXG5cclxuICAgICAgICAvLyBEaXNwbGF5IGEgZ2xvYmUgaWNvbiBuZXh0IHRvIHRoZSBsb2NhbGl6YXRpb24gbGFiZWxcclxuICAgICAgICBpY29uTm9kZTogbmV3IFBhdGgoIGdsb2JlU29saWRTaGFwZSwge1xyXG4gICAgICAgICAgc2NhbGU6IDEgLyAyNSwgLy8gYnkgaW5zcGVjdGlvblxyXG4gICAgICAgICAgZmlsbDogJ2JsYWNrJ1xyXG4gICAgICAgIH0gKSxcclxuXHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdsb2NhbGl6YXRpb25UYWInIClcclxuICAgICAgfSApICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jaGlsZHJlbiA9IHRoaXMuY29udGVudDtcclxuXHJcbiAgICAvLyBJZiB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHRhYiBpcyBoaWRkZW4gdmlhIHBoZXQtaW8sIHRoZW4gc2VsZWN0IHRoZSBmaXJzdCB2aXNpYmxlIHRhYiAoaWYgdGhlcmUgaXMgb25lKVxyXG4gICAgY29uc3QgdmlzaWJpbGl0eU11bHRpbGluayA9IE11bHRpbGluay5tdWx0aWxpbmtBbnkoIFsgc2VsZWN0ZWRQYW5lbFByb3BlcnR5LCAuLi50aGlzLmNvbnRlbnQubWFwKCB0YWIgPT4gdGFiLnZpc2libGVQcm9wZXJ0eSApIF0sICgpID0+IHtcclxuXHJcbiAgICAgIC8vIEZpbmQgdGhlIHRhYiBjb3JyZXNwb25kaW5nIHRvIHRoZSBjdXJyZW50IHNlbGVjdGlvblxyXG4gICAgICBjb25zdCB0YWIgPSB0aGlzLmNvbnRlbnQuZmluZCggdGFiID0+IHRhYi52YWx1ZSA9PT0gc2VsZWN0ZWRQYW5lbFByb3BlcnR5LnZhbHVlICkhO1xyXG5cclxuICAgICAgLy8gSWYgdGhlIHNlbGVjdGVkIHRhYiBpcyBub3Qgc2hvd2luZy4uLlxyXG4gICAgICBpZiAoICF0YWIudmlzaWJsZVByb3BlcnR5LnZhbHVlICkge1xyXG5cclxuICAgICAgICAvLyBGaW5kIHRoZSBsZWZ0bW9zdCB0YWIgdGhhdCBpcyBzaG93aW5nIChpZiB0aGVyZSBhcmUgYW55IHNob3dpbmcgdGFicylcclxuICAgICAgICBjb25zdCBmaXJzdFNob3dpbmdUYWIgPSB0aGlzLmNvbnRlbnQuZmluZCggdGFiID0+IHRhYi52aXNpYmxlUHJvcGVydHkudmFsdWUgKTtcclxuICAgICAgICBpZiAoIGZpcnN0U2hvd2luZ1RhYiApIHtcclxuICAgICAgICAgIHNlbGVjdGVkUGFuZWxQcm9wZXJ0eS52YWx1ZSA9IGZpcnN0U2hvd2luZ1RhYi52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBwZG9tIC0ga2V5Ym9hcmQgc3VwcG9ydCB0byBtb3ZlIHRocm91Z2ggdGFicyB3aXRoIGFycm93IGtleXNcclxuICAgIGNvbnN0IGtleWJvYXJkTGlzdGVuZXI6IFRJbnB1dExpc3RlbmVyID0ge1xyXG4gICAgICBrZXlkb3duOiBldmVudCA9PiB7XHJcblxyXG4gICAgICAgIC8vIHJlc2VydmUga2V5Ym9hcmQgZXZlbnRzIGZvciBkcmFnZ2luZyB0byBwcmV2ZW50IGRlZmF1bHQgcGFubmluZyBiZWhhdmlvciB3aXRoIHpvb20gZmVhdHVyZXNcclxuICAgICAgICBldmVudC5wb2ludGVyLnJlc2VydmVGb3JLZXlib2FyZERyYWcoKTtcclxuICAgICAgfSxcclxuICAgICAga2V5dXA6IGV2ZW50ID0+IHtcclxuICAgICAgICBpZiAoICggS2V5Ym9hcmRVdGlscy5pc0FueUtleUV2ZW50KCBldmVudC5kb21FdmVudCwgWyBLZXlib2FyZFV0aWxzLktFWV9SSUdIVF9BUlJPVywgS2V5Ym9hcmRVdGlscy5LRVlfTEVGVF9BUlJPVyBdICkgKSApIHtcclxuXHJcbiAgICAgICAgICAvLyBwcmV2ZW50IFwibmF0aXZlXCIgYmVoYXZpb3Igc28gdGhhdCBTYWZhcmkgZG9lc24ndCBtYWtlIGFuIGVycm9yIHNvdW5kIHdpdGggYXJyb3cga2V5cyBpbiBmdWxsIHNjcmVlbiBtb2RlXHJcbiAgICAgICAgICBldmVudC5kb21FdmVudCEucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBLZXlib2FyZFV0aWxzLmlzS2V5RXZlbnQoIGV2ZW50LmRvbUV2ZW50LCBLZXlib2FyZFV0aWxzLktFWV9SSUdIVF9BUlJPVyApID8gMSA6IC0xO1xyXG4gICAgICAgICAgZm9yICggbGV0IGkgPSAwOyBpIDwgdGhpcy5jb250ZW50Lmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICBpZiAoIHRoaXMuc2VsZWN0ZWRCdXR0b24gPT09IHRoaXMuY29udGVudFsgaSBdICkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IG5leHRCdXR0b25Db250ZW50ID0gdGhpcy5jb250ZW50WyBpICsgZGlyZWN0aW9uIF07XHJcbiAgICAgICAgICAgICAgaWYgKCBuZXh0QnV0dG9uQ29udGVudCApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBzZWxlY3QgdGhlIG5leHQgdGFiIGFuZCBtb3ZlIGZvY3VzIHRvIGl0IC0gYSBsaXN0ZW5lciBvbiBzZWxlY3RlZFBhbmVsUHJvcGVydHkgc2V0cyB0aGUgbmV4dFxyXG4gICAgICAgICAgICAgICAgLy8gc2VsZWN0ZWRCdXR0b24gYW5kIG1ha2VzIGl0IGZvY3VzYWJsZVxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRQYW5lbFByb3BlcnR5LnZhbHVlID0gbmV4dEJ1dHRvbkNvbnRlbnQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkQnV0dG9uLmZvY3VzKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCBrZXlib2FyZExpc3RlbmVyICk7XHJcblxyXG4gICAgY29uc3Qgc2VsZWN0ZWRQYW5lbExpc3RlbmVyID0gKCkgPT4ge1xyXG4gICAgICB0aGlzLmNvbnRlbnQuZm9yRWFjaCggY29udGVudCA9PiB7XHJcbiAgICAgICAgaWYgKCBjb250ZW50LnZhbHVlID09PSB0aGlzLnNlbGVjdGVkUGFuZWxQcm9wZXJ0eS52YWx1ZSApIHtcclxuICAgICAgICAgIHRoaXMuc2VsZWN0ZWRCdXR0b24gPSBjb250ZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG4gICAgfTtcclxuICAgIHNlbGVjdGVkUGFuZWxQcm9wZXJ0eS5saW5rKCBzZWxlY3RlZFBhbmVsTGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSB0YWIsIGl0IGlzIG5vdCBpbnRlcmFjdGl2ZVxyXG4gICAgaWYgKCBzdXBwb3J0ZWRUYWJzLmxlbmd0aCA9PT0gMSApIHtcclxuICAgICAgdGhpcy5mb2N1c2FibGUgPSBmYWxzZTtcclxuICAgICAgdGhpcy5pbnB1dEVuYWJsZWRQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZGlzcG9zZVByZWZlcmVuY2VzVGFicyA9ICgpID0+IHtcclxuICAgICAgdGhpcy5yZW1vdmVJbnB1dExpc3RlbmVyKCBrZXlib2FyZExpc3RlbmVyICk7XHJcbiAgICAgIHNlbGVjdGVkUGFuZWxQcm9wZXJ0eS51bmxpbmsoIHNlbGVjdGVkUGFuZWxMaXN0ZW5lciApO1xyXG4gICAgICBNdWx0aWxpbmsudW5tdWx0aWxpbmsoIHZpc2liaWxpdHlNdWx0aWxpbmsgKTtcclxuICAgICAgdGhpcy5jb250ZW50LmZvckVhY2goIHRhYiA9PiB0YWIuZGlzcG9zZSgpICk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgdmlzaWJsZVByb3BlcnR5IGZvciB0aGUgVGFiIGFzc29jaWF0ZWQgd2l0aCB0aGUgUHJlZmVyZW5jZXNUeXBlLiBQcmVmZXJlbmNlc1RhYnMgbmVlZCB0byBiZSBoaWRkZW5cclxuICAgKiBpZiB0aGUgVGFiIGJlY29tZXMgaW52aXNpYmxlIChtb3N0bHkgbmVlZGVkIGZvciBQaEVULWlPKS5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0VGFiVmlzaWJsZVByb3BlcnR5KCBwcmVmZXJlbmNlc1R5cGU6IFByZWZlcmVuY2VzVHlwZSApOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPiB7XHJcbiAgICBjb25zdCB0YWIgPSBfLmZpbmQoIHRoaXMuY29udGVudCwgY29udGVudCA9PiBjb250ZW50LnZhbHVlID09PSBwcmVmZXJlbmNlc1R5cGUgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRhYiwgYHRhYiBub3QgZm91bmQgZm9yIFByZWZlcmVuY2VzVHlwZSwgJHtwcmVmZXJlbmNlc1R5cGUubmFtZX1gICk7XHJcbiAgICByZXR1cm4gdGFiIS52aXNpYmxlUHJvcGVydHk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNb3ZlIGZvY3VzIHRvIHRoZSBzZWxlY3RlZCB0YWIuIFVzZWZ1bCB3aGVuIHRoZSBQcmVmZXJlbmNlcyBkaWFsb2cgaXMgb3BlbmVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBmb2N1c1NlbGVjdGVkVGFiKCk6IHZvaWQge1xyXG4gICAgdGhpcy5jb250ZW50LmZvckVhY2goIGNvbnRlbnQgPT4ge1xyXG4gICAgICBpZiAoIGNvbnRlbnQudmFsdWUgPT09IHRoaXMuc2VsZWN0ZWRQYW5lbFByb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICAgIGNvbnRlbnQuZm9jdXMoKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VQcmVmZXJlbmNlc1RhYnMoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbmpvaXN0LnJlZ2lzdGVyKCAnUHJlZmVyZW5jZXNUYWJzJywgUHJlZmVyZW5jZXNUYWJzICk7XHJcbmV4cG9ydCBkZWZhdWx0IFByZWZlcmVuY2VzVGFiczsiXSwibWFwcGluZ3MiOiJBQUFB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