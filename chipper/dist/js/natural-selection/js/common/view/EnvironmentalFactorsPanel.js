// Copyright 2019-2023, University of Colorado Boulder

/**
 * EnvironmentalFactorsPanel is the panel that contains controls for environmental factors that affect
 * the mortality of bunnies.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import optionize, { combineOptions, optionize4 } from '../../../../phet-core/js/optionize.js';
import { AlignGroup, Text, VBox } from '../../../../scenery/js/imports.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import StringIO from '../../../../tandem/js/types/StringIO.js';
import naturalSelection from '../../naturalSelection.js';
import NaturalSelectionStrings from '../../NaturalSelectionStrings.js';
import NaturalSelectionConstants from '../NaturalSelectionConstants.js';
import LimitedFoodCheckbox from './LimitedFoodCheckbox.js';
import NaturalSelectionPanel from './NaturalSelectionPanel.js';
import ToughFoodCheckbox from './ToughFoodCheckbox.js';
import WolvesCheckbox from './WolvesCheckbox.js';
export default class EnvironmentalFactorsPanel extends NaturalSelectionPanel {
  constructor(wolvesEnabledProperty, foodIsToughProperty, foodIsLimitedProperty, providedOptions) {
    const options = optionize4()({}, NaturalSelectionConstants.PANEL_OPTIONS, {
      // SelfOptions
      toughFoodCheckboxVisible: true
    }, providedOptions);

    // To make all checkbox labels have the same effective size
    const checkboxLabelAlignGroup = new AlignGroup();

    // A checkbox for each environmental factor
    const wolvesCheckbox = new WolvesCheckbox(wolvesEnabledProperty, checkboxLabelAlignGroup, {
      tandem: options.tandem.createTandem('wolvesCheckbox')
    });
    const toughFoodCheckbox = new ToughFoodCheckbox(foodIsToughProperty, checkboxLabelAlignGroup, {
      visible: options.toughFoodCheckboxVisible,
      tandem: options.tandem.createTandem('toughFoodCheckbox')
    });
    const limitedFoodCheckbox = new LimitedFoodCheckbox(foodIsLimitedProperty, checkboxLabelAlignGroup, {
      tandem: options.tandem.createTandem('limitedFoodCheckbox')
    });
    const checkboxes = [wolvesCheckbox, toughFoodCheckbox, limitedFoodCheckbox];

    // Checkbox currently has a limitation with adjusting its content size after instantiation, which is the case with
    // these checkboxes that use AlignGroup. So this forces the pointer areas to be recomputed, and also dilates the
    // pointer areas to fill vertical space between the checkboxes.
    // See https://github.com/phetsims/natural-selection/issues/145 and https://github.com/phetsims/natural-selection/issues/173
    const xDilation = 8;
    const ySpacing = NaturalSelectionConstants.VBOX_OPTIONS.spacing;
    assert && assert(ySpacing !== undefined);
    const yDilation = ySpacing / 2;
    checkboxes.forEach(checkbox => {
      checkbox.touchArea = checkbox.localBounds.dilatedXY(xDilation, yDilation);
      checkbox.mouseArea = checkbox.localBounds.dilatedXY(xDilation, yDilation);
    });
    const numberOfCheckboxesVisibleProperty = DerivedProperty.deriveAny(checkboxes.map(checkbox => checkbox.visibleProperty), () => _.filter(checkboxes, checkbox => checkbox.visible).length, {
      tandem: options.tandem.createTandem('numberOfCheckboxesVisibleProperty'),
      phetioValueType: NumberIO,
      phetioDocumentation: 'the number of checkboxes that are visible affects whether the panel title is singular or plural'
    });

    // title
    const titleText = new TitleText(numberOfCheckboxesVisibleProperty, {
      tandem: options.tandem.createTandem('titleText')
    });
    const content = new VBox(combineOptions({}, NaturalSelectionConstants.VBOX_OPTIONS, {
      children: [titleText, ...checkboxes]
    }));
    super(content, options);
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
}
/**
 * TitleText supports dynamic locale, and changes between singular/plural based on how many checkboxes are visible.
 */
class TitleText extends Text {
  constructor(numberOfCheckboxesVisibleProperty, providedOptions) {
    const options = optionize()({
      // TextOptions
      font: NaturalSelectionConstants.TITLE_FONT,
      maxWidth: 175,
      // determined empirically,
      phetioVisiblePropertyInstrumented: true
    }, providedOptions);
    const stringProperty = new DerivedProperty([numberOfCheckboxesVisibleProperty, NaturalSelectionStrings.environmentalFactorStringProperty, NaturalSelectionStrings.environmentalFactorsStringProperty], (numberOfCheckboxesVisible, environmentalFactor, environmentalFactors) => numberOfCheckboxesVisible === 1 ? environmentalFactor : environmentalFactors, {
      tandem: options.tandem.createTandem(Text.STRING_PROPERTY_TANDEM_NAME),
      phetioValueType: StringIO
    });
    super(stringProperty, options);
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
}
naturalSelection.register('EnvironmentalFactorsPanel', EnvironmentalFactorsPanel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJvcHRpb25pemUiLCJjb21iaW5lT3B0aW9ucyIsIm9wdGlvbml6ZTQiLCJBbGlnbkdyb3VwIiwiVGV4dCIsIlZCb3giLCJOdW1iZXJJTyIsIlN0cmluZ0lPIiwibmF0dXJhbFNlbGVjdGlvbiIsIk5hdHVyYWxTZWxlY3Rpb25TdHJpbmdzIiwiTmF0dXJhbFNlbGVjdGlvbkNvbnN0YW50cyIsIkxpbWl0ZWRGb29kQ2hlY2tib3giLCJOYXR1cmFsU2VsZWN0aW9uUGFuZWwiLCJUb3VnaEZvb2RDaGVja2JveCIsIldvbHZlc0NoZWNrYm94IiwiRW52aXJvbm1lbnRhbEZhY3RvcnNQYW5lbCIsImNvbnN0cnVjdG9yIiwid29sdmVzRW5hYmxlZFByb3BlcnR5IiwiZm9vZElzVG91Z2hQcm9wZXJ0eSIsImZvb2RJc0xpbWl0ZWRQcm9wZXJ0eSIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJQQU5FTF9PUFRJT05TIiwidG91Z2hGb29kQ2hlY2tib3hWaXNpYmxlIiwiY2hlY2tib3hMYWJlbEFsaWduR3JvdXAiLCJ3b2x2ZXNDaGVja2JveCIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsInRvdWdoRm9vZENoZWNrYm94IiwidmlzaWJsZSIsImxpbWl0ZWRGb29kQ2hlY2tib3giLCJjaGVja2JveGVzIiwieERpbGF0aW9uIiwieVNwYWNpbmciLCJWQk9YX09QVElPTlMiLCJzcGFjaW5nIiwiYXNzZXJ0IiwidW5kZWZpbmVkIiwieURpbGF0aW9uIiwiZm9yRWFjaCIsImNoZWNrYm94IiwidG91Y2hBcmVhIiwibG9jYWxCb3VuZHMiLCJkaWxhdGVkWFkiLCJtb3VzZUFyZWEiLCJudW1iZXJPZkNoZWNrYm94ZXNWaXNpYmxlUHJvcGVydHkiLCJkZXJpdmVBbnkiLCJtYXAiLCJ2aXNpYmxlUHJvcGVydHkiLCJfIiwiZmlsdGVyIiwibGVuZ3RoIiwicGhldGlvVmFsdWVUeXBlIiwicGhldGlvRG9jdW1lbnRhdGlvbiIsInRpdGxlVGV4dCIsIlRpdGxlVGV4dCIsImNvbnRlbnQiLCJjaGlsZHJlbiIsImRpc3Bvc2UiLCJmb250IiwiVElUTEVfRk9OVCIsIm1heFdpZHRoIiwicGhldGlvVmlzaWJsZVByb3BlcnR5SW5zdHJ1bWVudGVkIiwic3RyaW5nUHJvcGVydHkiLCJlbnZpcm9ubWVudGFsRmFjdG9yU3RyaW5nUHJvcGVydHkiLCJlbnZpcm9ubWVudGFsRmFjdG9yc1N0cmluZ1Byb3BlcnR5IiwibnVtYmVyT2ZDaGVja2JveGVzVmlzaWJsZSIsImVudmlyb25tZW50YWxGYWN0b3IiLCJlbnZpcm9ubWVudGFsRmFjdG9ycyIsIlNUUklOR19QUk9QRVJUWV9UQU5ERU1fTkFNRSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRW52aXJvbm1lbnRhbEZhY3RvcnNQYW5lbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBFbnZpcm9ubWVudGFsRmFjdG9yc1BhbmVsIGlzIHRoZSBwYW5lbCB0aGF0IGNvbnRhaW5zIGNvbnRyb2xzIGZvciBlbnZpcm9ubWVudGFsIGZhY3RvcnMgdGhhdCBhZmZlY3RcclxuICogdGhlIG1vcnRhbGl0eSBvZiBidW5uaWVzLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBjb21iaW5lT3B0aW9ucywgRW1wdHlTZWxmT3B0aW9ucywgb3B0aW9uaXplNCB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgU3RyaWN0T21pdCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvU3RyaWN0T21pdC5qcyc7XHJcbmltcG9ydCBQaWNrUmVxdWlyZWQgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1BpY2tSZXF1aXJlZC5qcyc7XHJcbmltcG9ydCB7IEFsaWduR3JvdXAsIFRleHQsIFRleHRPcHRpb25zLCBWQm94LCBWQm94T3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBOdW1iZXJJTyBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvTnVtYmVySU8uanMnO1xyXG5pbXBvcnQgU3RyaW5nSU8gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL1N0cmluZ0lPLmpzJztcclxuaW1wb3J0IG5hdHVyYWxTZWxlY3Rpb24gZnJvbSAnLi4vLi4vbmF0dXJhbFNlbGVjdGlvbi5qcyc7XHJcbmltcG9ydCBOYXR1cmFsU2VsZWN0aW9uU3RyaW5ncyBmcm9tICcuLi8uLi9OYXR1cmFsU2VsZWN0aW9uU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBOYXR1cmFsU2VsZWN0aW9uQ29uc3RhbnRzIGZyb20gJy4uL05hdHVyYWxTZWxlY3Rpb25Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgTGltaXRlZEZvb2RDaGVja2JveCBmcm9tICcuL0xpbWl0ZWRGb29kQ2hlY2tib3guanMnO1xyXG5pbXBvcnQgTmF0dXJhbFNlbGVjdGlvblBhbmVsLCB7IE5hdHVyYWxTZWxlY3Rpb25QYW5lbE9wdGlvbnMgfSBmcm9tICcuL05hdHVyYWxTZWxlY3Rpb25QYW5lbC5qcyc7XHJcbmltcG9ydCBUb3VnaEZvb2RDaGVja2JveCBmcm9tICcuL1RvdWdoRm9vZENoZWNrYm94LmpzJztcclxuaW1wb3J0IFdvbHZlc0NoZWNrYm94IGZyb20gJy4vV29sdmVzQ2hlY2tib3guanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuICB0b3VnaEZvb2RDaGVja2JveFZpc2libGU/OiBib29sZWFuO1xyXG59O1xyXG5cclxudHlwZSBFbnZpcm9ubWVudGFsRmFjdG9yc1BhbmVsT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgTmF0dXJhbFNlbGVjdGlvblBhbmVsT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudmlyb25tZW50YWxGYWN0b3JzUGFuZWwgZXh0ZW5kcyBOYXR1cmFsU2VsZWN0aW9uUGFuZWwge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHdvbHZlc0VuYWJsZWRQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj4sIGZvb2RJc1RvdWdoUHJvcGVydHk6IFByb3BlcnR5PGJvb2xlYW4+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgZm9vZElzTGltaXRlZFByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPiwgcHJvdmlkZWRPcHRpb25zOiBFbnZpcm9ubWVudGFsRmFjdG9yc1BhbmVsT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplNDxFbnZpcm9ubWVudGFsRmFjdG9yc1BhbmVsT3B0aW9ucywgU2VsZk9wdGlvbnMsIFN0cmljdE9taXQ8TmF0dXJhbFNlbGVjdGlvblBhbmVsT3B0aW9ucywgJ3RhbmRlbSc+PigpKFxyXG4gICAgICB7fSwgTmF0dXJhbFNlbGVjdGlvbkNvbnN0YW50cy5QQU5FTF9PUFRJT05TLCB7XHJcblxyXG4gICAgICAgIC8vIFNlbGZPcHRpb25zXHJcbiAgICAgICAgdG91Z2hGb29kQ2hlY2tib3hWaXNpYmxlOiB0cnVlXHJcbiAgICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIFRvIG1ha2UgYWxsIGNoZWNrYm94IGxhYmVscyBoYXZlIHRoZSBzYW1lIGVmZmVjdGl2ZSBzaXplXHJcbiAgICBjb25zdCBjaGVja2JveExhYmVsQWxpZ25Hcm91cCA9IG5ldyBBbGlnbkdyb3VwKCk7XHJcblxyXG4gICAgLy8gQSBjaGVja2JveCBmb3IgZWFjaCBlbnZpcm9ubWVudGFsIGZhY3RvclxyXG4gICAgY29uc3Qgd29sdmVzQ2hlY2tib3ggPSBuZXcgV29sdmVzQ2hlY2tib3goIHdvbHZlc0VuYWJsZWRQcm9wZXJ0eSwgY2hlY2tib3hMYWJlbEFsaWduR3JvdXAsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICd3b2x2ZXNDaGVja2JveCcgKVxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgdG91Z2hGb29kQ2hlY2tib3ggPSBuZXcgVG91Z2hGb29kQ2hlY2tib3goIGZvb2RJc1RvdWdoUHJvcGVydHksIGNoZWNrYm94TGFiZWxBbGlnbkdyb3VwLCB7XHJcbiAgICAgIHZpc2libGU6IG9wdGlvbnMudG91Z2hGb29kQ2hlY2tib3hWaXNpYmxlLFxyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3RvdWdoRm9vZENoZWNrYm94JyApXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBsaW1pdGVkRm9vZENoZWNrYm94ID0gbmV3IExpbWl0ZWRGb29kQ2hlY2tib3goIGZvb2RJc0xpbWl0ZWRQcm9wZXJ0eSwgY2hlY2tib3hMYWJlbEFsaWduR3JvdXAsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdsaW1pdGVkRm9vZENoZWNrYm94JyApXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBjaGVja2JveGVzID0gWyB3b2x2ZXNDaGVja2JveCwgdG91Z2hGb29kQ2hlY2tib3gsIGxpbWl0ZWRGb29kQ2hlY2tib3ggXTtcclxuXHJcbiAgICAvLyBDaGVja2JveCBjdXJyZW50bHkgaGFzIGEgbGltaXRhdGlvbiB3aXRoIGFkanVzdGluZyBpdHMgY29udGVudCBzaXplIGFmdGVyIGluc3RhbnRpYXRpb24sIHdoaWNoIGlzIHRoZSBjYXNlIHdpdGhcclxuICAgIC8vIHRoZXNlIGNoZWNrYm94ZXMgdGhhdCB1c2UgQWxpZ25Hcm91cC4gU28gdGhpcyBmb3JjZXMgdGhlIHBvaW50ZXIgYXJlYXMgdG8gYmUgcmVjb21wdXRlZCwgYW5kIGFsc28gZGlsYXRlcyB0aGVcclxuICAgIC8vIHBvaW50ZXIgYXJlYXMgdG8gZmlsbCB2ZXJ0aWNhbCBzcGFjZSBiZXR3ZWVuIHRoZSBjaGVja2JveGVzLlxyXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9uYXR1cmFsLXNlbGVjdGlvbi9pc3N1ZXMvMTQ1IGFuZCBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvbmF0dXJhbC1zZWxlY3Rpb24vaXNzdWVzLzE3M1xyXG4gICAgY29uc3QgeERpbGF0aW9uID0gODtcclxuICAgIGNvbnN0IHlTcGFjaW5nID0gTmF0dXJhbFNlbGVjdGlvbkNvbnN0YW50cy5WQk9YX09QVElPTlMuc3BhY2luZyE7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB5U3BhY2luZyAhPT0gdW5kZWZpbmVkICk7XHJcbiAgICBjb25zdCB5RGlsYXRpb24gPSB5U3BhY2luZyAvIDI7XHJcbiAgICBjaGVja2JveGVzLmZvckVhY2goIGNoZWNrYm94ID0+IHtcclxuICAgICAgY2hlY2tib3gudG91Y2hBcmVhID0gY2hlY2tib3gubG9jYWxCb3VuZHMuZGlsYXRlZFhZKCB4RGlsYXRpb24sIHlEaWxhdGlvbiApO1xyXG4gICAgICBjaGVja2JveC5tb3VzZUFyZWEgPSBjaGVja2JveC5sb2NhbEJvdW5kcy5kaWxhdGVkWFkoIHhEaWxhdGlvbiwgeURpbGF0aW9uICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgbnVtYmVyT2ZDaGVja2JveGVzVmlzaWJsZVByb3BlcnR5ID0gRGVyaXZlZFByb3BlcnR5LmRlcml2ZUFueShcclxuICAgICAgY2hlY2tib3hlcy5tYXAoIGNoZWNrYm94ID0+IGNoZWNrYm94LnZpc2libGVQcm9wZXJ0eSApLFxyXG4gICAgICAoKSA9PiBfLmZpbHRlciggY2hlY2tib3hlcywgY2hlY2tib3ggPT4gY2hlY2tib3gudmlzaWJsZSApLmxlbmd0aCwge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnbnVtYmVyT2ZDaGVja2JveGVzVmlzaWJsZVByb3BlcnR5JyApLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVtYmVySU8sXHJcbiAgICAgICAgcGhldGlvRG9jdW1lbnRhdGlvbjogJ3RoZSBudW1iZXIgb2YgY2hlY2tib3hlcyB0aGF0IGFyZSB2aXNpYmxlIGFmZmVjdHMgd2hldGhlciB0aGUgcGFuZWwgdGl0bGUgaXMgc2luZ3VsYXIgb3IgcGx1cmFsJ1xyXG4gICAgICB9ICk7XHJcblxyXG4gICAgLy8gdGl0bGVcclxuICAgIGNvbnN0IHRpdGxlVGV4dCA9IG5ldyBUaXRsZVRleHQoIG51bWJlck9mQ2hlY2tib3hlc1Zpc2libGVQcm9wZXJ0eSwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3RpdGxlVGV4dCcgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGNvbnRlbnQgPSBuZXcgVkJveCggY29tYmluZU9wdGlvbnM8VkJveE9wdGlvbnM+KCB7fSwgTmF0dXJhbFNlbGVjdGlvbkNvbnN0YW50cy5WQk9YX09QVElPTlMsIHtcclxuICAgICAgY2hpbGRyZW46IFsgdGl0bGVUZXh0LCAuLi5jaGVja2JveGVzIF1cclxuICAgIH0gKSApO1xyXG5cclxuICAgIHN1cGVyKCBjb250ZW50LCBvcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxudHlwZSBUaXRsZVRleHRTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcbnR5cGUgVGl0bGVUZXh0T3B0aW9ucyA9IFRpdGxlVGV4dFNlbGZPcHRpb25zICYgUGlja1JlcXVpcmVkPFRleHQsICd0YW5kZW0nPjtcclxuXHJcbi8qKlxyXG4gKiBUaXRsZVRleHQgc3VwcG9ydHMgZHluYW1pYyBsb2NhbGUsIGFuZCBjaGFuZ2VzIGJldHdlZW4gc2luZ3VsYXIvcGx1cmFsIGJhc2VkIG9uIGhvdyBtYW55IGNoZWNrYm94ZXMgYXJlIHZpc2libGUuXHJcbiAqL1xyXG5jbGFzcyBUaXRsZVRleHQgZXh0ZW5kcyBUZXh0IHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBudW1iZXJPZkNoZWNrYm94ZXNWaXNpYmxlUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj4sIHByb3ZpZGVkT3B0aW9uczogVGl0bGVUZXh0T3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFRpdGxlVGV4dE9wdGlvbnMsIFRpdGxlVGV4dFNlbGZPcHRpb25zLCBUZXh0T3B0aW9ucz4oKSgge1xyXG5cclxuICAgICAgLy8gVGV4dE9wdGlvbnNcclxuICAgICAgZm9udDogTmF0dXJhbFNlbGVjdGlvbkNvbnN0YW50cy5USVRMRV9GT05ULFxyXG4gICAgICBtYXhXaWR0aDogMTc1LCAvLyBkZXRlcm1pbmVkIGVtcGlyaWNhbGx5LFxyXG4gICAgICBwaGV0aW9WaXNpYmxlUHJvcGVydHlJbnN0cnVtZW50ZWQ6IHRydWVcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IHN0cmluZ1Byb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggW1xyXG4gICAgICBudW1iZXJPZkNoZWNrYm94ZXNWaXNpYmxlUHJvcGVydHksXHJcbiAgICAgIE5hdHVyYWxTZWxlY3Rpb25TdHJpbmdzLmVudmlyb25tZW50YWxGYWN0b3JTdHJpbmdQcm9wZXJ0eSxcclxuICAgICAgTmF0dXJhbFNlbGVjdGlvblN0cmluZ3MuZW52aXJvbm1lbnRhbEZhY3RvcnNTdHJpbmdQcm9wZXJ0eVxyXG4gICAgXSwgKCBudW1iZXJPZkNoZWNrYm94ZXNWaXNpYmxlLCBlbnZpcm9ubWVudGFsRmFjdG9yLCBlbnZpcm9ubWVudGFsRmFjdG9ycyApID0+XHJcbiAgICAgICggbnVtYmVyT2ZDaGVja2JveGVzVmlzaWJsZSA9PT0gMSApID8gZW52aXJvbm1lbnRhbEZhY3RvciA6IGVudmlyb25tZW50YWxGYWN0b3JzLCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCBUZXh0LlNUUklOR19QUk9QRVJUWV9UQU5ERU1fTkFNRSApLFxyXG4gICAgICBwaGV0aW9WYWx1ZVR5cGU6IFN0cmluZ0lPXHJcbiAgICB9ICk7XHJcblxyXG4gICAgc3VwZXIoIHN0cmluZ1Byb3BlcnR5LCBvcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxubmF0dXJhbFNlbGVjdGlvbi5yZWdpc3RlciggJ0Vudmlyb25tZW50YWxGYWN0b3JzUGFuZWwnLCBFbnZpcm9ubWVudGFsRmFjdG9yc1BhbmVsICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUdwRSxPQUFPQyxTQUFTLElBQUlDLGNBQWMsRUFBb0JDLFVBQVUsUUFBUSx1Q0FBdUM7QUFHL0csU0FBU0MsVUFBVSxFQUFFQyxJQUFJLEVBQWVDLElBQUks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