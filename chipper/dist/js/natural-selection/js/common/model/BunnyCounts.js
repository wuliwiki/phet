// Copyright 2020-2022, University of Colorado Boulder

/**
 * BunnyCounts is a data structure that contains the counts that describe the phenotypes of a collection of bunnies.
 * There is a count for each allele, and a total count. The data structure is immutable, atomic, and describes the
 * population at a point in time. These are the Start Counts and End Counts that are shown in the Proportions graph.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import IOType from '../../../../tandem/js/types/IOType.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import naturalSelection from '../../naturalSelection.js';

// State object happens to be identical to SelfOptions

export default class BunnyCounts {
  constructor(providedOptions) {
    this.totalCount = providedOptions.totalCount;
    this.whiteFurCount = providedOptions.whiteFurCount;
    this.brownFurCount = providedOptions.brownFurCount;
    this.straightEarsCount = providedOptions.straightEarsCount;
    this.floppyEarsCount = providedOptions.floppyEarsCount;
    this.shortTeethCount = providedOptions.shortTeethCount;
    this.longTeethCount = providedOptions.longTeethCount;
    assert && assert(this.whiteFurCount + this.brownFurCount === this.totalCount, 'fur counts are out of sync');
    assert && assert(this.straightEarsCount + this.floppyEarsCount === this.totalCount, 'ears counts are out of sync');
    assert && assert(this.shortTeethCount + this.longTeethCount === this.totalCount, 'teeth counts are out of sync');
  }

  /**
   * Adds a bunny's contribution to the counts.
   */
  plus(bunny) {
    return this.updateCounts(bunny, 1);
  }

  /**
   * Subtracts a bunny's contribution from the counts.
   */
  minus(bunny) {
    return this.updateCounts(bunny, -1);
  }

  /**
   * Adjusts the counts based on a bunny's phenotype.
   */
  updateCounts(bunny, delta) {
    assert && assert(delta === 1 || delta === -1, 'invalid delta');
    return new BunnyCounts({
      totalCount: this.totalCount + delta,
      whiteFurCount: this.whiteFurCount + (bunny.phenotype.hasWhiteFur() ? delta : 0),
      brownFurCount: this.brownFurCount + (bunny.phenotype.hasBrownFur() ? delta : 0),
      straightEarsCount: this.straightEarsCount + (bunny.phenotype.hasStraightEars() ? delta : 0),
      floppyEarsCount: this.floppyEarsCount + (bunny.phenotype.hasFloppyEars() ? delta : 0),
      shortTeethCount: this.shortTeethCount + (bunny.phenotype.hasShortTeeth() ? delta : 0),
      longTeethCount: this.longTeethCount + (bunny.phenotype.hasLongTeeth() ? delta : 0)
    });
  }

  /**
   * Gets a string representation of this BunnyCounts. For debugging only. Do not rely on format!
   */
  toString() {
    return JSON.stringify(this, null, 2);
  }

  /**
   * Gets a BunnyCounts instance with all counts initialized to zero.
   */
  static withZero() {
    return new BunnyCounts({
      totalCount: 0,
      whiteFurCount: 0,
      brownFurCount: 0,
      straightEarsCount: 0,
      floppyEarsCount: 0,
      shortTeethCount: 0,
      longTeethCount: 0
    });
  }

  //--------------------------------------------------------------------------------------------------------------------
  // Below here are methods used by BunnyCountsIO to serialize PhET-iO state.
  //--------------------------------------------------------------------------------------------------------------------

  /**
   * Serializes this BunnyCounts instance.
   */
  toStateObject() {
    return {
      totalCount: this.totalCount,
      whiteFurCount: this.whiteFurCount,
      brownFurCount: this.brownFurCount,
      straightEarsCount: this.straightEarsCount,
      floppyEarsCount: this.floppyEarsCount,
      shortTeethCount: this.shortTeethCount,
      longTeethCount: this.longTeethCount
    };
  }

  /**
   * Deserializes a BunnyCounts instance.
   */
  static fromStateObject(stateObject) {
    return new BunnyCounts({
      totalCount: stateObject.totalCount,
      whiteFurCount: stateObject.whiteFurCount,
      brownFurCount: stateObject.brownFurCount,
      straightEarsCount: stateObject.straightEarsCount,
      floppyEarsCount: stateObject.floppyEarsCount,
      shortTeethCount: stateObject.shortTeethCount,
      longTeethCount: stateObject.longTeethCount
    });
  }

  /**
   * BunnyCountsIO handles PhET-iO serialization of BunnyCounts.
   * It implements 'Data type serialization', as described in the Serialization section of
   * https://github.com/phetsims/phet-io/blob/master/doc/phet-io-instrumentation-technical-guide.md#serialization
   */
  static BunnyCountsIO = new IOType('BunnyCountsIO', {
    valueType: BunnyCounts,
    stateSchema: {
      totalCount: NumberIO,
      whiteFurCount: NumberIO,
      brownFurCount: NumberIO,
      straightEarsCount: NumberIO,
      floppyEarsCount: NumberIO,
      shortTeethCount: NumberIO,
      longTeethCount: NumberIO
    },
    toStateObject: bunnyCounts => bunnyCounts.toStateObject(),
    fromStateObject: stateObject => BunnyCounts.fromStateObject(stateObject)
  });
}
naturalSelection.register('BunnyCounts', BunnyCounts);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJJT1R5cGUiLCJOdW1iZXJJTyIsIm5hdHVyYWxTZWxlY3Rpb24iLCJCdW5ueUNvdW50cyIsImNvbnN0cnVjdG9yIiwicHJvdmlkZWRPcHRpb25zIiwidG90YWxDb3VudCIsIndoaXRlRnVyQ291bnQiLCJicm93bkZ1ckNvdW50Iiwic3RyYWlnaHRFYXJzQ291bnQiLCJmbG9wcHlFYXJzQ291bnQiLCJzaG9ydFRlZXRoQ291bnQiLCJsb25nVGVldGhDb3VudCIsImFzc2VydCIsInBsdXMiLCJidW5ueSIsInVwZGF0ZUNvdW50cyIsIm1pbnVzIiwiZGVsdGEiLCJwaGVub3R5cGUiLCJoYXNXaGl0ZUZ1ciIsImhhc0Jyb3duRnVyIiwiaGFzU3RyYWlnaHRFYXJzIiwiaGFzRmxvcHB5RWFycyIsImhhc1Nob3J0VGVldGgiLCJoYXNMb25nVGVldGgiLCJ0b1N0cmluZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJ3aXRoWmVybyIsInRvU3RhdGVPYmplY3QiLCJmcm9tU3RhdGVPYmplY3QiLCJzdGF0ZU9iamVjdCIsIkJ1bm55Q291bnRzSU8iLCJ2YWx1ZVR5cGUiLCJzdGF0ZVNjaGVtYSIsImJ1bm55Q291bnRzIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJCdW5ueUNvdW50cy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBCdW5ueUNvdW50cyBpcyBhIGRhdGEgc3RydWN0dXJlIHRoYXQgY29udGFpbnMgdGhlIGNvdW50cyB0aGF0IGRlc2NyaWJlIHRoZSBwaGVub3R5cGVzIG9mIGEgY29sbGVjdGlvbiBvZiBidW5uaWVzLlxyXG4gKiBUaGVyZSBpcyBhIGNvdW50IGZvciBlYWNoIGFsbGVsZSwgYW5kIGEgdG90YWwgY291bnQuIFRoZSBkYXRhIHN0cnVjdHVyZSBpcyBpbW11dGFibGUsIGF0b21pYywgYW5kIGRlc2NyaWJlcyB0aGVcclxuICogcG9wdWxhdGlvbiBhdCBhIHBvaW50IGluIHRpbWUuIFRoZXNlIGFyZSB0aGUgU3RhcnQgQ291bnRzIGFuZCBFbmQgQ291bnRzIHRoYXQgYXJlIHNob3duIGluIHRoZSBQcm9wb3J0aW9ucyBncmFwaC5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgSU9UeXBlIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy90eXBlcy9JT1R5cGUuanMnO1xyXG5pbXBvcnQgTnVtYmVySU8gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL051bWJlcklPLmpzJztcclxuaW1wb3J0IG5hdHVyYWxTZWxlY3Rpb24gZnJvbSAnLi4vLi4vbmF0dXJhbFNlbGVjdGlvbi5qcyc7XHJcbmltcG9ydCBCdW5ueSBmcm9tICcuL0J1bm55LmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgdG90YWxDb3VudDogbnVtYmVyO1xyXG4gIHdoaXRlRnVyQ291bnQ6IG51bWJlcjtcclxuICBicm93bkZ1ckNvdW50OiBudW1iZXI7XHJcbiAgc3RyYWlnaHRFYXJzQ291bnQ6IG51bWJlcjtcclxuICBmbG9wcHlFYXJzQ291bnQ6IG51bWJlcjtcclxuICBzaG9ydFRlZXRoQ291bnQ6IG51bWJlcjtcclxuICBsb25nVGVldGhDb3VudDogbnVtYmVyO1xyXG59O1xyXG5cclxudHlwZSBCdW5ueUNvdW50T3B0aW9ucyA9IFNlbGZPcHRpb25zO1xyXG5cclxuLy8gU3RhdGUgb2JqZWN0IGhhcHBlbnMgdG8gYmUgaWRlbnRpY2FsIHRvIFNlbGZPcHRpb25zXHJcbmV4cG9ydCB0eXBlIEJ1bm55Q291bnRzU3RhdGVPYmplY3QgPSBTZWxmT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJ1bm55Q291bnRzIHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IHRvdGFsQ291bnQ6IG51bWJlcjtcclxuICBwdWJsaWMgcmVhZG9ubHkgd2hpdGVGdXJDb3VudDogbnVtYmVyO1xyXG4gIHB1YmxpYyByZWFkb25seSBicm93bkZ1ckNvdW50OiBudW1iZXI7XHJcbiAgcHVibGljIHJlYWRvbmx5IHN0cmFpZ2h0RWFyc0NvdW50OiBudW1iZXI7XHJcbiAgcHVibGljIHJlYWRvbmx5IGZsb3BweUVhcnNDb3VudDogbnVtYmVyO1xyXG4gIHB1YmxpYyByZWFkb25seSBzaG9ydFRlZXRoQ291bnQ6IG51bWJlcjtcclxuICBwdWJsaWMgcmVhZG9ubHkgbG9uZ1RlZXRoQ291bnQ6IG51bWJlcjtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBwcm92aWRlZE9wdGlvbnM6IEJ1bm55Q291bnRPcHRpb25zICkge1xyXG5cclxuICAgIHRoaXMudG90YWxDb3VudCA9IHByb3ZpZGVkT3B0aW9ucy50b3RhbENvdW50O1xyXG4gICAgdGhpcy53aGl0ZUZ1ckNvdW50ID0gcHJvdmlkZWRPcHRpb25zLndoaXRlRnVyQ291bnQ7XHJcbiAgICB0aGlzLmJyb3duRnVyQ291bnQgPSBwcm92aWRlZE9wdGlvbnMuYnJvd25GdXJDb3VudDtcclxuICAgIHRoaXMuc3RyYWlnaHRFYXJzQ291bnQgPSBwcm92aWRlZE9wdGlvbnMuc3RyYWlnaHRFYXJzQ291bnQ7XHJcbiAgICB0aGlzLmZsb3BweUVhcnNDb3VudCA9IHByb3ZpZGVkT3B0aW9ucy5mbG9wcHlFYXJzQ291bnQ7XHJcbiAgICB0aGlzLnNob3J0VGVldGhDb3VudCA9IHByb3ZpZGVkT3B0aW9ucy5zaG9ydFRlZXRoQ291bnQ7XHJcbiAgICB0aGlzLmxvbmdUZWV0aENvdW50ID0gcHJvdmlkZWRPcHRpb25zLmxvbmdUZWV0aENvdW50O1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMud2hpdGVGdXJDb3VudCArIHRoaXMuYnJvd25GdXJDb3VudCA9PT0gdGhpcy50b3RhbENvdW50LFxyXG4gICAgICAnZnVyIGNvdW50cyBhcmUgb3V0IG9mIHN5bmMnICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLnN0cmFpZ2h0RWFyc0NvdW50ICsgdGhpcy5mbG9wcHlFYXJzQ291bnQgPT09IHRoaXMudG90YWxDb3VudCxcclxuICAgICAgJ2VhcnMgY291bnRzIGFyZSBvdXQgb2Ygc3luYycgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMuc2hvcnRUZWV0aENvdW50ICsgdGhpcy5sb25nVGVldGhDb3VudCA9PT0gdGhpcy50b3RhbENvdW50LFxyXG4gICAgICAndGVldGggY291bnRzIGFyZSBvdXQgb2Ygc3luYycgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgYSBidW5ueSdzIGNvbnRyaWJ1dGlvbiB0byB0aGUgY291bnRzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBwbHVzKCBidW5ueTogQnVubnkgKTogQnVubnlDb3VudHMge1xyXG4gICAgcmV0dXJuIHRoaXMudXBkYXRlQ291bnRzKCBidW5ueSwgMSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3VidHJhY3RzIGEgYnVubnkncyBjb250cmlidXRpb24gZnJvbSB0aGUgY291bnRzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBtaW51cyggYnVubnk6IEJ1bm55ICk6IEJ1bm55Q291bnRzIHtcclxuICAgIHJldHVybiB0aGlzLnVwZGF0ZUNvdW50cyggYnVubnksIC0xICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBZGp1c3RzIHRoZSBjb3VudHMgYmFzZWQgb24gYSBidW5ueSdzIHBoZW5vdHlwZS5cclxuICAgKi9cclxuICBwcml2YXRlIHVwZGF0ZUNvdW50cyggYnVubnk6IEJ1bm55LCBkZWx0YTogbnVtYmVyICk6IEJ1bm55Q291bnRzIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGRlbHRhID09PSAxIHx8IGRlbHRhID09PSAtMSwgJ2ludmFsaWQgZGVsdGEnICk7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBCdW5ueUNvdW50cygge1xyXG4gICAgICB0b3RhbENvdW50OiB0aGlzLnRvdGFsQ291bnQgKyBkZWx0YSxcclxuICAgICAgd2hpdGVGdXJDb3VudDogdGhpcy53aGl0ZUZ1ckNvdW50ICsgKCBidW5ueS5waGVub3R5cGUuaGFzV2hpdGVGdXIoKSA/IGRlbHRhIDogMCApLFxyXG4gICAgICBicm93bkZ1ckNvdW50OiB0aGlzLmJyb3duRnVyQ291bnQgKyAoIGJ1bm55LnBoZW5vdHlwZS5oYXNCcm93bkZ1cigpID8gZGVsdGEgOiAwICksXHJcbiAgICAgIHN0cmFpZ2h0RWFyc0NvdW50OiB0aGlzLnN0cmFpZ2h0RWFyc0NvdW50ICsgKCBidW5ueS5waGVub3R5cGUuaGFzU3RyYWlnaHRFYXJzKCkgPyBkZWx0YSA6IDAgKSxcclxuICAgICAgZmxvcHB5RWFyc0NvdW50OiB0aGlzLmZsb3BweUVhcnNDb3VudCArICggYnVubnkucGhlbm90eXBlLmhhc0Zsb3BweUVhcnMoKSA/IGRlbHRhIDogMCApLFxyXG4gICAgICBzaG9ydFRlZXRoQ291bnQ6IHRoaXMuc2hvcnRUZWV0aENvdW50ICsgKCBidW5ueS5waGVub3R5cGUuaGFzU2hvcnRUZWV0aCgpID8gZGVsdGEgOiAwICksXHJcbiAgICAgIGxvbmdUZWV0aENvdW50OiB0aGlzLmxvbmdUZWV0aENvdW50ICsgKCBidW5ueS5waGVub3R5cGUuaGFzTG9uZ1RlZXRoKCkgPyBkZWx0YSA6IDAgKVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGlzIEJ1bm55Q291bnRzLiBGb3IgZGVidWdnaW5nIG9ubHkuIERvIG5vdCByZWx5IG9uIGZvcm1hdCFcclxuICAgKi9cclxuICBwdWJsaWMgdG9TdHJpbmcoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSggdGhpcywgbnVsbCwgMiApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyBhIEJ1bm55Q291bnRzIGluc3RhbmNlIHdpdGggYWxsIGNvdW50cyBpbml0aWFsaXplZCB0byB6ZXJvLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgd2l0aFplcm8oKTogQnVubnlDb3VudHMge1xyXG4gICAgcmV0dXJuIG5ldyBCdW5ueUNvdW50cygge1xyXG4gICAgICB0b3RhbENvdW50OiAwLFxyXG4gICAgICB3aGl0ZUZ1ckNvdW50OiAwLFxyXG4gICAgICBicm93bkZ1ckNvdW50OiAwLFxyXG4gICAgICBzdHJhaWdodEVhcnNDb3VudDogMCxcclxuICAgICAgZmxvcHB5RWFyc0NvdW50OiAwLFxyXG4gICAgICBzaG9ydFRlZXRoQ291bnQ6IDAsXHJcbiAgICAgIGxvbmdUZWV0aENvdW50OiAwXHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gQmVsb3cgaGVyZSBhcmUgbWV0aG9kcyB1c2VkIGJ5IEJ1bm55Q291bnRzSU8gdG8gc2VyaWFsaXplIFBoRVQtaU8gc3RhdGUuXHJcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvKipcclxuICAgKiBTZXJpYWxpemVzIHRoaXMgQnVubnlDb3VudHMgaW5zdGFuY2UuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB0b1N0YXRlT2JqZWN0KCk6IEJ1bm55Q291bnRzU3RhdGVPYmplY3Qge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdG90YWxDb3VudDogdGhpcy50b3RhbENvdW50LFxyXG4gICAgICB3aGl0ZUZ1ckNvdW50OiB0aGlzLndoaXRlRnVyQ291bnQsXHJcbiAgICAgIGJyb3duRnVyQ291bnQ6IHRoaXMuYnJvd25GdXJDb3VudCxcclxuICAgICAgc3RyYWlnaHRFYXJzQ291bnQ6IHRoaXMuc3RyYWlnaHRFYXJzQ291bnQsXHJcbiAgICAgIGZsb3BweUVhcnNDb3VudDogdGhpcy5mbG9wcHlFYXJzQ291bnQsXHJcbiAgICAgIHNob3J0VGVldGhDb3VudDogdGhpcy5zaG9ydFRlZXRoQ291bnQsXHJcbiAgICAgIGxvbmdUZWV0aENvdW50OiB0aGlzLmxvbmdUZWV0aENvdW50XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGVzZXJpYWxpemVzIGEgQnVubnlDb3VudHMgaW5zdGFuY2UuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgZnJvbVN0YXRlT2JqZWN0KCBzdGF0ZU9iamVjdDogU2VsZk9wdGlvbnMgKTogQnVubnlDb3VudHMge1xyXG4gICAgcmV0dXJuIG5ldyBCdW5ueUNvdW50cygge1xyXG4gICAgICB0b3RhbENvdW50OiBzdGF0ZU9iamVjdC50b3RhbENvdW50LFxyXG4gICAgICB3aGl0ZUZ1ckNvdW50OiBzdGF0ZU9iamVjdC53aGl0ZUZ1ckNvdW50LFxyXG4gICAgICBicm93bkZ1ckNvdW50OiBzdGF0ZU9iamVjdC5icm93bkZ1ckNvdW50LFxyXG4gICAgICBzdHJhaWdodEVhcnNDb3VudDogc3RhdGVPYmplY3Quc3RyYWlnaHRFYXJzQ291bnQsXHJcbiAgICAgIGZsb3BweUVhcnNDb3VudDogc3RhdGVPYmplY3QuZmxvcHB5RWFyc0NvdW50LFxyXG4gICAgICBzaG9ydFRlZXRoQ291bnQ6IHN0YXRlT2JqZWN0LnNob3J0VGVldGhDb3VudCxcclxuICAgICAgbG9uZ1RlZXRoQ291bnQ6IHN0YXRlT2JqZWN0LmxvbmdUZWV0aENvdW50XHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBCdW5ueUNvdW50c0lPIGhhbmRsZXMgUGhFVC1pTyBzZXJpYWxpemF0aW9uIG9mIEJ1bm55Q291bnRzLlxyXG4gICAqIEl0IGltcGxlbWVudHMgJ0RhdGEgdHlwZSBzZXJpYWxpemF0aW9uJywgYXMgZGVzY3JpYmVkIGluIHRoZSBTZXJpYWxpemF0aW9uIHNlY3Rpb24gb2ZcclxuICAgKiBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvcGhldC1pby9ibG9iL21hc3Rlci9kb2MvcGhldC1pby1pbnN0cnVtZW50YXRpb24tdGVjaG5pY2FsLWd1aWRlLm1kI3NlcmlhbGl6YXRpb25cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEJ1bm55Q291bnRzSU8gPSBuZXcgSU9UeXBlPEJ1bm55Q291bnRzLCBCdW5ueUNvdW50c1N0YXRlT2JqZWN0PiggJ0J1bm55Q291bnRzSU8nLCB7XHJcbiAgICB2YWx1ZVR5cGU6IEJ1bm55Q291bnRzLFxyXG4gICAgc3RhdGVTY2hlbWE6IHtcclxuICAgICAgdG90YWxDb3VudDogTnVtYmVySU8sXHJcbiAgICAgIHdoaXRlRnVyQ291bnQ6IE51bWJlcklPLFxyXG4gICAgICBicm93bkZ1ckNvdW50OiBOdW1iZXJJTyxcclxuICAgICAgc3RyYWlnaHRFYXJzQ291bnQ6IE51bWJlcklPLFxyXG4gICAgICBmbG9wcHlFYXJzQ291bnQ6IE51bWJlcklPLFxyXG4gICAgICBzaG9ydFRlZXRoQ291bnQ6IE51bWJlcklPLFxyXG4gICAgICBsb25nVGVldGhDb3VudDogTnVtYmVySU9cclxuICAgIH0sXHJcbiAgICB0b1N0YXRlT2JqZWN0OiBidW5ueUNvdW50cyA9PiBidW5ueUNvdW50cy50b1N0YXRlT2JqZWN0KCksXHJcbiAgICBmcm9tU3RhdGVPYmplY3Q6IHN0YXRlT2JqZWN0ID0+IEJ1bm55Q291bnRzLmZyb21TdGF0ZU9iamVjdCggc3RhdGVPYmplY3QgKVxyXG4gIH0gKTtcclxufVxyXG5cclxubmF0dXJhbFNlbGVjdGlvbi5yZWdpc3RlciggJ0J1bm55Q291bnRzJywgQnVubnlDb3VudHMgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9B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