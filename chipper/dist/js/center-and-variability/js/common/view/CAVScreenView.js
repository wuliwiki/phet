// Copyright 2022-2023, University of Colorado Boulder

/**
 * Base class for all ScreenViews in the sim.
 *
 * @author Chris Klusendorf (PhET Interactive Simulations)
 * @author Sam Reid (PhET Interactive Simulations)
 */

import ScreenView from '../../../../joist/js/ScreenView.js';
import optionize from '../../../../phet-core/js/optionize.js';
import centerAndVariability from '../../centerAndVariability.js';
import CAVConstants from '../CAVConstants.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import ModelViewTransform2 from '../../../../phetcommon/js/view/ModelViewTransform2.js';
import { AlignBox, ManualConstraint, Node } from '../../../../scenery/js/imports.js';
import EraserButton from '../../../../scenery-phet/js/buttons/EraserButton.js';
import QuestionBar from '../../../../scenery-phet/js/QuestionBar.js';
import NumberLineNode from './NumberLineNode.js';
import Bounds2 from '../../../../dot/js/Bounds2.js';
import BackgroundNode from './BackgroundNode.js';
import merge from '../../../../phet-core/js/merge.js';
import VerticalCheckboxGroup from '../../../../sun/js/VerticalCheckboxGroup.js';
import PredictionSlider from './PredictionSlider.js';
import CAVColors from '../CAVColors.js';
import Property from '../../../../axon/js/Property.js';
import SceneView from './SceneView.js';
import KickButtonGroup from './KickButtonGroup.js';
import DynamicProperty from '../../../../axon/js/DynamicProperty.js';
// constants
const GROUND_POSITION_Y = 500;
export default class CAVScreenView extends ScreenView {
  frontObjectLayer = new Node();

  // TODO: We haven't enforced the "exactly half a ball should be occluded if anything is occluded" design, see https://github.com/phetsims/center-and-variability/issues/175
  // May need https://github.com/phetsims/center-and-variability/issues/166 to be addressed first
  backObjectLayer = new Node();
  // Subclasses use this to add to for correct z-ordering and correct tab navigation order
  contentLayer = new Node();
  accordionBox = null;
  constructor(model, providedOptions) {
    const options = optionize()({}, providedOptions);

    // The ground is at y=0
    const modelViewTransform = ModelViewTransform2.createRectangleInvertedYMapping(new Bounds2(CAVConstants.PHYSICAL_RANGE.min, 0, CAVConstants.PHYSICAL_RANGE.max, CAVConstants.PHYSICAL_RANGE.getLength()), new Bounds2(CAVConstants.NUMBER_LINE_MARGIN_X, GROUND_POSITION_Y - CAVConstants.CHART_VIEW_WIDTH, CAVConstants.NUMBER_LINE_MARGIN_X + CAVConstants.CHART_VIEW_WIDTH, GROUND_POSITION_Y));
    super(options);
    this.modelViewTransform = modelViewTransform;
    this.model = model;

    // Soccer balls go behind the accordion box after they land
    // this.contentLayer.addChild( this.backObjectLayer );

    this.addChild(this.contentLayer);
    this.addChild(this.frontObjectLayer);
    model.sceneModels.map(sceneModel => new SceneView(model, sceneModel, this.backObjectLayer, this.frontObjectLayer, modelViewTransform, () => this.accordionBox, {
      tandem: options.tandem.createTandem('sceneView')
    }));
    this.resetAllButton = new ResetAllButton({
      listener: () => {
        this.interruptSubtreeInput(); // cancel interactions that may be in progress

        model.reset();

        // hide the dragIndicatorArrowNode and reset the flag for if it has been dragged already
        // dragIndicatorArrowNode.visible = false;
      },

      right: this.layoutBounds.maxX - CAVConstants.SCREEN_VIEW_X_MARGIN,
      bottom: this.layoutBounds.maxY - CAVConstants.SCREEN_VIEW_Y_MARGIN,
      tandem: options.tandem.createTandem('resetAllButton')
    });
    this.eraseButton = new EraserButton({
      tandem: options.tandem.createTandem('eraseButton'),
      listener: () => {
        // Interrupt dragging of existing objects
        this.interruptSubtreeInput();
        model.selectedSceneModelProperty.value.clearData();

        // hide the dragIndicatorArrowNode but don't reset objectHasBeenDragged
        // dragIndicatorArrowNode.visible = false;
      },

      iconWidth: 26,
      right: this.resetAllButton.left - CAVConstants.SCREEN_VIEW_X_MARGIN,
      centerY: this.resetAllButton.centerY
    });
    this.addChild(this.eraseButton);
    this.addChild(this.resetAllButton);
    this.contentLayer.addChild(new BackgroundNode(GROUND_POSITION_Y, this.visibleBoundsProperty));
    this.playAreaNumberLineNode = new NumberLineNode(new DynamicProperty(model.selectedSceneModelProperty, {
      derive: 'meanValueProperty'
    }), model.isShowingPlayAreaMeanProperty, new DynamicProperty(model.selectedSceneModelProperty, {
      derive: 'dataRangeProperty'
    }), {
      includeXAxis: false,
      includeMeanStroke: true,
      tandem: options.tandem.createTandem('playAreaNumberLineNode'),
      x: CAVConstants.NUMBER_LINE_MARGIN_X,
      y: GROUND_POSITION_Y
    });
    this.contentLayer.addChild(this.playAreaNumberLineNode);
    this.questionBar = new QuestionBar(this.layoutBounds, this.visibleBoundsProperty, merge({
      tandem: options.tandem.createTandem('questionBar')
    }, options.questionBarOptions));
    this.contentLayer.addChild(this.questionBar);
    this.contentLayer.addChild(new KickButtonGroup(model, {
      left: 25,
      // Center between the ground and the bottom of the layout bounds.  Adjust because of the asymmetries:
      // the soccer player foot falls beneath the ground, and the shading of the buttons.
      centerY: (GROUND_POSITION_Y + this.layoutBounds.maxY) / 2 + 2,
      tandem: options.tandem.createTandem('kickButtonGroup')
    }));

    // Soccer balls go behind the accordion box after they land
    // TODO: Why is the back layer in the front?
    this.contentLayer.addChild(this.backObjectLayer);
  }
  updateAccordionBoxPosition() {
    this.accordionBox.top = this.questionBar.bottom + CAVConstants.SCREEN_VIEW_Y_MARGIN;
  }

  /**
   * Floating layout that keeps the ground near the ground, and accordion box near the question bar
   */
  layout(viewBounds) {
    super.layout(viewBounds, {
      verticalAlign: 'bottom'
    });
    this.accordionBox && this.updateAccordionBoxPosition();
  }

  /**
   * Called by subtype constructors to finish initialization.
   */
  setAccordionBox(accordionBox) {
    this.accordionBox = accordionBox;
    this.contentLayer.addChild(this.accordionBox);
    this.updateAccordionBoxPosition();
  }

  /**
   * Sets the accordion box and aligns its content with the play area number line node.
   * Should be used with accordion boxes that also have a number line.
   * The alignment  assumes that the NumberLineNode in the play area and in the dot plot have the same characteristics:
   * - Same font
   * -Same offset and scale
   * Given those assumptions, this code moves the dot plot so that its number line matches the play area one.
   */
  setAccordionBoxWithAlignedContent(accordionBox) {
    this.setAccordionBox(accordionBox);
    ManualConstraint.create(this, [this.playAreaNumberLineNode, accordionBox.plotNode], (lowerNumberLineWrapper, contentsWrapper) => {
      contentsWrapper.x = lowerNumberLineWrapper.x;
    });
  }
  setBottomCheckboxGroup(items) {
    const bottomCheckboxGroup = new VerticalCheckboxGroup(items, {
      tandem: this.tandem.createTandem('bottomCheckboxGroup')
    });

    // In order to use the AlignBox we need to know the distance from the top of the screen, to the top of the grass.
    const BOTTOM_CHECKBOX_PANEL_MARGIN = 12.5;
    const BOTTOM_CHECKBOX_PANEL_Y_MARGIN = this.layoutBounds.maxY - this.modelViewTransform.modelToViewY(0) + BOTTOM_CHECKBOX_PANEL_MARGIN;
    this.addChild(new AlignBox(bottomCheckboxGroup, {
      alignBounds: this.layoutBounds,
      xAlign: 'right',
      yAlign: 'bottom',
      xMargin: BOTTOM_CHECKBOX_PANEL_MARGIN,
      yMargin: BOTTOM_CHECKBOX_PANEL_Y_MARGIN
    }));
  }

  /**
   * The MedianPredictionNode is shared in the Median screen and MeanAndMedianScreen, so factored out here.
   */
  static createMedianPredictionNode(model, modelViewTransform, tandem) {
    return new PredictionSlider(model.medianPredictionProperty, modelViewTransform, CAVConstants.PHYSICAL_RANGE, {
      predictionThumbNodeOptions: {
        color: CAVColors.medianColorProperty
      },
      valueProperty: model.medianPredictionProperty,
      enabledRangeProperty: new Property(CAVConstants.PHYSICAL_RANGE),
      roundToInterval: 0.5,
      visibleProperty: model.isShowingMedianPredictionProperty,
      tandem: tandem
    });
  }
}
centerAndVariability.register('CAVScreenView', CAVScreenView);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTY3JlZW5WaWV3Iiwib3B0aW9uaXplIiwiY2VudGVyQW5kVmFyaWFiaWxpdHkiLCJDQVZDb25zdGFudHMiLCJSZXNldEFsbEJ1dHRvbiIsIk1vZGVsVmlld1RyYW5zZm9ybTIiLCJBbGlnbkJveCIsIk1hbnVhbENvbnN0cmFpbnQiLCJOb2RlIiwiRXJhc2VyQnV0dG9uIiwiUXVlc3Rpb25CYXIiLCJOdW1iZXJMaW5lTm9kZSIsIkJvdW5kczIiLCJCYWNrZ3JvdW5kTm9kZSIsIm1lcmdlIiwiVmVydGljYWxDaGVja2JveEdyb3VwIiwiUHJlZGljdGlvblNsaWRlciIsIkNBVkNvbG9ycyIsIlByb3BlcnR5IiwiU2NlbmVWaWV3IiwiS2lja0J1dHRvbkdyb3VwIiwiRHluYW1pY1Byb3BlcnR5IiwiR1JPVU5EX1BPU0lUSU9OX1kiLCJDQVZTY3JlZW5WaWV3IiwiZnJvbnRPYmplY3RMYXllciIsImJhY2tPYmplY3RMYXllciIsImNvbnRlbnRMYXllciIsImFjY29yZGlvbkJveCIsImNvbnN0cnVjdG9yIiwibW9kZWwiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwibW9kZWxWaWV3VHJhbnNmb3JtIiwiY3JlYXRlUmVjdGFuZ2xlSW52ZXJ0ZWRZTWFwcGluZyIsIlBIWVNJQ0FMX1JBTkdFIiwibWluIiwibWF4IiwiZ2V0TGVuZ3RoIiwiTlVNQkVSX0xJTkVfTUFSR0lOX1giLCJDSEFSVF9WSUVXX1dJRFRIIiwiYWRkQ2hpbGQiLCJzY2VuZU1vZGVscyIsIm1hcCIsInNjZW5lTW9kZWwiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJyZXNldEFsbEJ1dHRvbiIsImxpc3RlbmVyIiwiaW50ZXJydXB0U3VidHJlZUlucHV0IiwicmVzZXQiLCJyaWdodCIsImxheW91dEJvdW5kcyIsIm1heFgiLCJTQ1JFRU5fVklFV19YX01BUkdJTiIsImJvdHRvbSIsIm1heFkiLCJTQ1JFRU5fVklFV19ZX01BUkdJTiIsImVyYXNlQnV0dG9uIiwic2VsZWN0ZWRTY2VuZU1vZGVsUHJvcGVydHkiLCJ2YWx1ZSIsImNsZWFyRGF0YSIsImljb25XaWR0aCIsImxlZnQiLCJjZW50ZXJZIiwidmlzaWJsZUJvdW5kc1Byb3BlcnR5IiwicGxheUFyZWFOdW1iZXJMaW5lTm9kZSIsImRlcml2ZSIsImlzU2hvd2luZ1BsYXlBcmVhTWVhblByb3BlcnR5IiwiaW5jbHVkZVhBeGlzIiwiaW5jbHVkZU1lYW5TdHJva2UiLCJ4IiwieSIsInF1ZXN0aW9uQmFyIiwicXVlc3Rpb25CYXJPcHRpb25zIiwidXBkYXRlQWNjb3JkaW9uQm94UG9zaXRpb24iLCJ0b3AiLCJsYXlvdXQiLCJ2aWV3Qm91bmRzIiwidmVydGljYWxBbGlnbiIsInNldEFjY29yZGlvbkJveCIsInNldEFjY29yZGlvbkJveFdpdGhBbGlnbmVkQ29udGVudCIsImNyZWF0ZSIsInBsb3ROb2RlIiwibG93ZXJOdW1iZXJMaW5lV3JhcHBlciIsImNvbnRlbnRzV3JhcHBlciIsInNldEJvdHRvbUNoZWNrYm94R3JvdXAiLCJpdGVtcyIsImJvdHRvbUNoZWNrYm94R3JvdXAiLCJCT1RUT01fQ0hFQ0tCT1hfUEFORUxfTUFSR0lOIiwiQk9UVE9NX0NIRUNLQk9YX1BBTkVMX1lfTUFSR0lOIiwibW9kZWxUb1ZpZXdZIiwiYWxpZ25Cb3VuZHMiLCJ4QWxpZ24iLCJ5QWxpZ24iLCJ4TWFyZ2luIiwieU1hcmdpbiIsImNyZWF0ZU1lZGlhblByZWRpY3Rpb25Ob2RlIiwibWVkaWFuUHJlZGljdGlvblByb3BlcnR5IiwicHJlZGljdGlvblRodW1iTm9kZU9wdGlvbnMiLCJjb2xvciIsIm1lZGlhbkNvbG9yUHJvcGVydHkiLCJ2YWx1ZVByb3BlcnR5IiwiZW5hYmxlZFJhbmdlUHJvcGVydHkiLCJyb3VuZFRvSW50ZXJ2YWwiLCJ2aXNpYmxlUHJvcGVydHkiLCJpc1Nob3dpbmdNZWRpYW5QcmVkaWN0aW9uUHJvcGVydHkiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkNBVlNjcmVlblZpZXcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjItMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQmFzZSBjbGFzcyBmb3IgYWxsIFNjcmVlblZpZXdzIGluIHRoZSBzaW0uXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgS2x1c2VuZG9yZiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgU2NyZWVuVmlldywgeyBTY3JlZW5WaWV3T3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL2pvaXN0L2pzL1NjcmVlblZpZXcuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgY2VudGVyQW5kVmFyaWFiaWxpdHkgZnJvbSAnLi4vLi4vY2VudGVyQW5kVmFyaWFiaWxpdHkuanMnO1xyXG5pbXBvcnQgQ0FWQ29uc3RhbnRzIGZyb20gJy4uL0NBVkNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBSZXNldEFsbEJ1dHRvbiBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvYnV0dG9ucy9SZXNldEFsbEJ1dHRvbi5qcyc7XHJcbmltcG9ydCBNb2RlbFZpZXdUcmFuc2Zvcm0yIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdmlldy9Nb2RlbFZpZXdUcmFuc2Zvcm0yLmpzJztcclxuaW1wb3J0IHsgQWxpZ25Cb3gsIE1hbnVhbENvbnN0cmFpbnQsIE5vZGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgRXJhc2VyQnV0dG9uIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9idXR0b25zL0VyYXNlckJ1dHRvbi5qcyc7XHJcbmltcG9ydCBRdWVzdGlvbkJhciwgeyBRdWVzdGlvbkJhck9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUXVlc3Rpb25CYXIuanMnO1xyXG5pbXBvcnQgTnVtYmVyTGluZU5vZGUgZnJvbSAnLi9OdW1iZXJMaW5lTm9kZS5qcyc7XHJcbmltcG9ydCBCb3VuZHMyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9Cb3VuZHMyLmpzJztcclxuaW1wb3J0IEJhY2tncm91bmROb2RlIGZyb20gJy4vQmFja2dyb3VuZE5vZGUuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IENBVkFjY29yZGlvbkJveCBmcm9tICcuL0NBVkFjY29yZGlvbkJveC5qcyc7XHJcbmltcG9ydCBWZXJ0aWNhbENoZWNrYm94R3JvdXAsIHsgVmVydGljYWxDaGVja2JveEdyb3VwSXRlbSB9IGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9WZXJ0aWNhbENoZWNrYm94R3JvdXAuanMnO1xyXG5pbXBvcnQgUHJlZGljdGlvblNsaWRlciBmcm9tICcuL1ByZWRpY3Rpb25TbGlkZXIuanMnO1xyXG5pbXBvcnQgQ0FWQ29sb3JzIGZyb20gJy4uL0NBVkNvbG9ycy5qcyc7XHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFJhbmdlIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9SYW5nZS5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBDQVZNb2RlbCBmcm9tICcuLi9tb2RlbC9DQVZNb2RlbC5qcyc7XHJcbmltcG9ydCBTY2VuZVZpZXcgZnJvbSAnLi9TY2VuZVZpZXcuanMnO1xyXG5pbXBvcnQgS2lja0J1dHRvbkdyb3VwIGZyb20gJy4vS2lja0J1dHRvbkdyb3VwLmpzJztcclxuaW1wb3J0IER5bmFtaWNQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0R5bmFtaWNQcm9wZXJ0eS5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIHF1ZXN0aW9uQmFyT3B0aW9uczogUXVlc3Rpb25CYXJPcHRpb25zO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgQ0FWU2NyZWVuVmlld09wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFNjcmVlblZpZXdPcHRpb25zO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IEdST1VORF9QT1NJVElPTl9ZID0gNTAwO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ0FWU2NyZWVuVmlldyBleHRlbmRzIFNjcmVlblZpZXcge1xyXG5cclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgcmVzZXRBbGxCdXR0b246IFJlc2V0QWxsQnV0dG9uO1xyXG4gIHByb3RlY3RlZCByZWFkb25seSBtb2RlbFZpZXdUcmFuc2Zvcm06IE1vZGVsVmlld1RyYW5zZm9ybTI7XHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IG1vZGVsOiBDQVZNb2RlbDtcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgZnJvbnRPYmplY3RMYXllciA9IG5ldyBOb2RlKCk7XHJcblxyXG4gIC8vIFRPRE86IFdlIGhhdmVuJ3QgZW5mb3JjZWQgdGhlIFwiZXhhY3RseSBoYWxmIGEgYmFsbCBzaG91bGQgYmUgb2NjbHVkZWQgaWYgYW55dGhpbmcgaXMgb2NjbHVkZWRcIiBkZXNpZ24sIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvY2VudGVyLWFuZC12YXJpYWJpbGl0eS9pc3N1ZXMvMTc1XHJcbiAgLy8gTWF5IG5lZWQgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2NlbnRlci1hbmQtdmFyaWFiaWxpdHkvaXNzdWVzLzE2NiB0byBiZSBhZGRyZXNzZWQgZmlyc3RcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgYmFja09iamVjdExheWVyID0gbmV3IE5vZGUoKTtcclxuXHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IGVyYXNlQnV0dG9uOiBFcmFzZXJCdXR0b247XHJcblxyXG4gIC8vIFN1YmNsYXNzZXMgdXNlIHRoaXMgdG8gYWRkIHRvIGZvciBjb3JyZWN0IHotb3JkZXJpbmcgYW5kIGNvcnJlY3QgdGFiIG5hdmlnYXRpb24gb3JkZXJcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgY29udGVudExheWVyID0gbmV3IE5vZGUoKTtcclxuXHJcbiAgcHJvdGVjdGVkIGFjY29yZGlvbkJveDogQ0FWQWNjb3JkaW9uQm94IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIHByb3RlY3RlZCByZWFkb25seSBxdWVzdGlvbkJhcjogUXVlc3Rpb25CYXI7XHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHBsYXlBcmVhTnVtYmVyTGluZU5vZGU6IE51bWJlckxpbmVOb2RlO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIG1vZGVsOiBDQVZNb2RlbCwgcHJvdmlkZWRPcHRpb25zOiBDQVZTY3JlZW5WaWV3T3B0aW9ucyApIHtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8Q0FWU2NyZWVuVmlld09wdGlvbnMsIFNlbGZPcHRpb25zLCBTY3JlZW5WaWV3T3B0aW9ucz4oKSgge30sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIFRoZSBncm91bmQgaXMgYXQgeT0wXHJcbiAgICBjb25zdCBtb2RlbFZpZXdUcmFuc2Zvcm0gPSBNb2RlbFZpZXdUcmFuc2Zvcm0yLmNyZWF0ZVJlY3RhbmdsZUludmVydGVkWU1hcHBpbmcoXHJcbiAgICAgIG5ldyBCb3VuZHMyKCBDQVZDb25zdGFudHMuUEhZU0lDQUxfUkFOR0UubWluLCAwLCBDQVZDb25zdGFudHMuUEhZU0lDQUxfUkFOR0UubWF4LCBDQVZDb25zdGFudHMuUEhZU0lDQUxfUkFOR0UuZ2V0TGVuZ3RoKCkgKSxcclxuICAgICAgbmV3IEJvdW5kczIoIENBVkNvbnN0YW50cy5OVU1CRVJfTElORV9NQVJHSU5fWCwgR1JPVU5EX1BPU0lUSU9OX1kgLSBDQVZDb25zdGFudHMuQ0hBUlRfVklFV19XSURUSCwgQ0FWQ29uc3RhbnRzLk5VTUJFUl9MSU5FX01BUkdJTl9YICsgQ0FWQ29uc3RhbnRzLkNIQVJUX1ZJRVdfV0lEVEgsIEdST1VORF9QT1NJVElPTl9ZIClcclxuICAgICk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybSA9IG1vZGVsVmlld1RyYW5zZm9ybTtcclxuICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcclxuXHJcbiAgICAvLyBTb2NjZXIgYmFsbHMgZ28gYmVoaW5kIHRoZSBhY2NvcmRpb24gYm94IGFmdGVyIHRoZXkgbGFuZFxyXG4gICAgLy8gdGhpcy5jb250ZW50TGF5ZXIuYWRkQ2hpbGQoIHRoaXMuYmFja09iamVjdExheWVyICk7XHJcblxyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5jb250ZW50TGF5ZXIgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMuZnJvbnRPYmplY3RMYXllciApO1xyXG5cclxuXHJcbiAgICBtb2RlbC5zY2VuZU1vZGVscy5tYXAoIHNjZW5lTW9kZWwgPT4gbmV3IFNjZW5lVmlldyggbW9kZWwsIHNjZW5lTW9kZWwsIHRoaXMuYmFja09iamVjdExheWVyLCB0aGlzLmZyb250T2JqZWN0TGF5ZXIsXHJcbiAgICAgIG1vZGVsVmlld1RyYW5zZm9ybSwgKCkgPT4gdGhpcy5hY2NvcmRpb25Cb3gsIHtcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NjZW5lVmlldycgKVxyXG4gICAgICB9ICkgKTtcclxuICAgIHRoaXMucmVzZXRBbGxCdXR0b24gPSBuZXcgUmVzZXRBbGxCdXR0b24oIHtcclxuICAgICAgbGlzdGVuZXI6ICgpID0+IHtcclxuICAgICAgICB0aGlzLmludGVycnVwdFN1YnRyZWVJbnB1dCgpOyAvLyBjYW5jZWwgaW50ZXJhY3Rpb25zIHRoYXQgbWF5IGJlIGluIHByb2dyZXNzXHJcblxyXG4gICAgICAgIG1vZGVsLnJlc2V0KCk7XHJcblxyXG4gICAgICAgIC8vIGhpZGUgdGhlIGRyYWdJbmRpY2F0b3JBcnJvd05vZGUgYW5kIHJlc2V0IHRoZSBmbGFnIGZvciBpZiBpdCBoYXMgYmVlbiBkcmFnZ2VkIGFscmVhZHlcclxuICAgICAgICAvLyBkcmFnSW5kaWNhdG9yQXJyb3dOb2RlLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgfSxcclxuICAgICAgcmlnaHQ6IHRoaXMubGF5b3V0Qm91bmRzLm1heFggLSBDQVZDb25zdGFudHMuU0NSRUVOX1ZJRVdfWF9NQVJHSU4sXHJcbiAgICAgIGJvdHRvbTogdGhpcy5sYXlvdXRCb3VuZHMubWF4WSAtIENBVkNvbnN0YW50cy5TQ1JFRU5fVklFV19ZX01BUkdJTixcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdyZXNldEFsbEJ1dHRvbicgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuZXJhc2VCdXR0b24gPSBuZXcgRXJhc2VyQnV0dG9uKCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZXJhc2VCdXR0b24nICksXHJcbiAgICAgIGxpc3RlbmVyOiAoKSA9PiB7XHJcblxyXG4gICAgICAgIC8vIEludGVycnVwdCBkcmFnZ2luZyBvZiBleGlzdGluZyBvYmplY3RzXHJcbiAgICAgICAgdGhpcy5pbnRlcnJ1cHRTdWJ0cmVlSW5wdXQoKTtcclxuXHJcbiAgICAgICAgbW9kZWwuc2VsZWN0ZWRTY2VuZU1vZGVsUHJvcGVydHkudmFsdWUuY2xlYXJEYXRhKCk7XHJcblxyXG4gICAgICAgIC8vIGhpZGUgdGhlIGRyYWdJbmRpY2F0b3JBcnJvd05vZGUgYnV0IGRvbid0IHJlc2V0IG9iamVjdEhhc0JlZW5EcmFnZ2VkXHJcbiAgICAgICAgLy8gZHJhZ0luZGljYXRvckFycm93Tm9kZS52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgIH0sXHJcbiAgICAgIGljb25XaWR0aDogMjYsXHJcbiAgICAgIHJpZ2h0OiB0aGlzLnJlc2V0QWxsQnV0dG9uLmxlZnQgLSBDQVZDb25zdGFudHMuU0NSRUVOX1ZJRVdfWF9NQVJHSU4sXHJcbiAgICAgIGNlbnRlclk6IHRoaXMucmVzZXRBbGxCdXR0b24uY2VudGVyWVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5lcmFzZUJ1dHRvbiApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5yZXNldEFsbEJ1dHRvbiApO1xyXG5cclxuICAgIHRoaXMuY29udGVudExheWVyLmFkZENoaWxkKCBuZXcgQmFja2dyb3VuZE5vZGUoIEdST1VORF9QT1NJVElPTl9ZLCB0aGlzLnZpc2libGVCb3VuZHNQcm9wZXJ0eSApICk7XHJcblxyXG4gICAgdGhpcy5wbGF5QXJlYU51bWJlckxpbmVOb2RlID0gbmV3IE51bWJlckxpbmVOb2RlKFxyXG4gICAgICBuZXcgRHluYW1pY1Byb3BlcnR5KCBtb2RlbC5zZWxlY3RlZFNjZW5lTW9kZWxQcm9wZXJ0eSwge1xyXG4gICAgICAgIGRlcml2ZTogJ21lYW5WYWx1ZVByb3BlcnR5J1xyXG4gICAgICB9ICksXHJcbiAgICAgIG1vZGVsLmlzU2hvd2luZ1BsYXlBcmVhTWVhblByb3BlcnR5LFxyXG4gICAgICBuZXcgRHluYW1pY1Byb3BlcnR5KCBtb2RlbC5zZWxlY3RlZFNjZW5lTW9kZWxQcm9wZXJ0eSwge1xyXG4gICAgICAgIGRlcml2ZTogJ2RhdGFSYW5nZVByb3BlcnR5J1xyXG4gICAgICB9ICksIHtcclxuICAgICAgICBpbmNsdWRlWEF4aXM6IGZhbHNlLFxyXG4gICAgICAgIGluY2x1ZGVNZWFuU3Ryb2tlOiB0cnVlLFxyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncGxheUFyZWFOdW1iZXJMaW5lTm9kZScgKSxcclxuICAgICAgICB4OiBDQVZDb25zdGFudHMuTlVNQkVSX0xJTkVfTUFSR0lOX1gsXHJcbiAgICAgICAgeTogR1JPVU5EX1BPU0lUSU9OX1lcclxuICAgICAgfSApO1xyXG4gICAgdGhpcy5jb250ZW50TGF5ZXIuYWRkQ2hpbGQoIHRoaXMucGxheUFyZWFOdW1iZXJMaW5lTm9kZSApO1xyXG5cclxuICAgIHRoaXMucXVlc3Rpb25CYXIgPSBuZXcgUXVlc3Rpb25CYXIoIHRoaXMubGF5b3V0Qm91bmRzLCB0aGlzLnZpc2libGVCb3VuZHNQcm9wZXJ0eSwgbWVyZ2UoIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdxdWVzdGlvbkJhcicgKVxyXG4gICAgfSwgb3B0aW9ucy5xdWVzdGlvbkJhck9wdGlvbnMgKSApO1xyXG4gICAgdGhpcy5jb250ZW50TGF5ZXIuYWRkQ2hpbGQoIHRoaXMucXVlc3Rpb25CYXIgKTtcclxuXHJcbiAgICB0aGlzLmNvbnRlbnRMYXllci5hZGRDaGlsZCggbmV3IEtpY2tCdXR0b25Hcm91cCggbW9kZWwsIHtcclxuICAgICAgbGVmdDogMjUsXHJcblxyXG4gICAgICAvLyBDZW50ZXIgYmV0d2VlbiB0aGUgZ3JvdW5kIGFuZCB0aGUgYm90dG9tIG9mIHRoZSBsYXlvdXQgYm91bmRzLiAgQWRqdXN0IGJlY2F1c2Ugb2YgdGhlIGFzeW1tZXRyaWVzOlxyXG4gICAgICAvLyB0aGUgc29jY2VyIHBsYXllciBmb290IGZhbGxzIGJlbmVhdGggdGhlIGdyb3VuZCwgYW5kIHRoZSBzaGFkaW5nIG9mIHRoZSBidXR0b25zLlxyXG4gICAgICBjZW50ZXJZOiAoIEdST1VORF9QT1NJVElPTl9ZICsgdGhpcy5sYXlvdXRCb3VuZHMubWF4WSApIC8gMiArIDIsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAna2lja0J1dHRvbkdyb3VwJyApXHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBTb2NjZXIgYmFsbHMgZ28gYmVoaW5kIHRoZSBhY2NvcmRpb24gYm94IGFmdGVyIHRoZXkgbGFuZFxyXG4gICAgLy8gVE9ETzogV2h5IGlzIHRoZSBiYWNrIGxheWVyIGluIHRoZSBmcm9udD9cclxuICAgIHRoaXMuY29udGVudExheWVyLmFkZENoaWxkKCB0aGlzLmJhY2tPYmplY3RMYXllciApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVBY2NvcmRpb25Cb3hQb3NpdGlvbigpOiB2b2lkIHtcclxuICAgIHRoaXMuYWNjb3JkaW9uQm94IS50b3AgPSB0aGlzLnF1ZXN0aW9uQmFyLmJvdHRvbSArIENBVkNvbnN0YW50cy5TQ1JFRU5fVklFV19ZX01BUkdJTjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZsb2F0aW5nIGxheW91dCB0aGF0IGtlZXBzIHRoZSBncm91bmQgbmVhciB0aGUgZ3JvdW5kLCBhbmQgYWNjb3JkaW9uIGJveCBuZWFyIHRoZSBxdWVzdGlvbiBiYXJcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgbGF5b3V0KCB2aWV3Qm91bmRzOiBCb3VuZHMyICk6IHZvaWQge1xyXG4gICAgc3VwZXIubGF5b3V0KCB2aWV3Qm91bmRzLCB7XHJcbiAgICAgIHZlcnRpY2FsQWxpZ246ICdib3R0b20nXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5hY2NvcmRpb25Cb3ggJiYgdGhpcy51cGRhdGVBY2NvcmRpb25Cb3hQb3NpdGlvbigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbGVkIGJ5IHN1YnR5cGUgY29uc3RydWN0b3JzIHRvIGZpbmlzaCBpbml0aWFsaXphdGlvbi5cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgc2V0QWNjb3JkaW9uQm94KCBhY2NvcmRpb25Cb3g6IENBVkFjY29yZGlvbkJveCApOiB2b2lkIHtcclxuICAgIHRoaXMuYWNjb3JkaW9uQm94ID0gYWNjb3JkaW9uQm94O1xyXG4gICAgdGhpcy5jb250ZW50TGF5ZXIuYWRkQ2hpbGQoIHRoaXMuYWNjb3JkaW9uQm94ICk7XHJcbiAgICB0aGlzLnVwZGF0ZUFjY29yZGlvbkJveFBvc2l0aW9uKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXRzIHRoZSBhY2NvcmRpb24gYm94IGFuZCBhbGlnbnMgaXRzIGNvbnRlbnQgd2l0aCB0aGUgcGxheSBhcmVhIG51bWJlciBsaW5lIG5vZGUuXHJcbiAgICogU2hvdWxkIGJlIHVzZWQgd2l0aCBhY2NvcmRpb24gYm94ZXMgdGhhdCBhbHNvIGhhdmUgYSBudW1iZXIgbGluZS5cclxuICAgKiBUaGUgYWxpZ25tZW50ICBhc3N1bWVzIHRoYXQgdGhlIE51bWJlckxpbmVOb2RlIGluIHRoZSBwbGF5IGFyZWEgYW5kIGluIHRoZSBkb3QgcGxvdCBoYXZlIHRoZSBzYW1lIGNoYXJhY3RlcmlzdGljczpcclxuICAgKiAtIFNhbWUgZm9udFxyXG4gICAqIC1TYW1lIG9mZnNldCBhbmQgc2NhbGVcclxuICAgKiBHaXZlbiB0aG9zZSBhc3N1bXB0aW9ucywgdGhpcyBjb2RlIG1vdmVzIHRoZSBkb3QgcGxvdCBzbyB0aGF0IGl0cyBudW1iZXIgbGluZSBtYXRjaGVzIHRoZSBwbGF5IGFyZWEgb25lLlxyXG4gICAqL1xyXG4gIHByb3RlY3RlZCBzZXRBY2NvcmRpb25Cb3hXaXRoQWxpZ25lZENvbnRlbnQoIGFjY29yZGlvbkJveDogQ0FWQWNjb3JkaW9uQm94ICk6IHZvaWQge1xyXG4gICAgdGhpcy5zZXRBY2NvcmRpb25Cb3goIGFjY29yZGlvbkJveCApO1xyXG4gICAgTWFudWFsQ29uc3RyYWludC5jcmVhdGUoIHRoaXMsIFsgdGhpcy5wbGF5QXJlYU51bWJlckxpbmVOb2RlLCBhY2NvcmRpb25Cb3gucGxvdE5vZGUgXSxcclxuICAgICAgKCBsb3dlck51bWJlckxpbmVXcmFwcGVyLCBjb250ZW50c1dyYXBwZXIgKSA9PiB7XHJcbiAgICAgICAgY29udGVudHNXcmFwcGVyLnggPSBsb3dlck51bWJlckxpbmVXcmFwcGVyLng7XHJcbiAgICAgIH0gKTtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBzZXRCb3R0b21DaGVja2JveEdyb3VwKCBpdGVtczogVmVydGljYWxDaGVja2JveEdyb3VwSXRlbVtdICk6IHZvaWQge1xyXG5cclxuICAgIGNvbnN0IGJvdHRvbUNoZWNrYm94R3JvdXAgPSBuZXcgVmVydGljYWxDaGVja2JveEdyb3VwKCBpdGVtcywge1xyXG4gICAgICB0YW5kZW06IHRoaXMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2JvdHRvbUNoZWNrYm94R3JvdXAnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBJbiBvcmRlciB0byB1c2UgdGhlIEFsaWduQm94IHdlIG5lZWQgdG8ga25vdyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgdG9wIG9mIHRoZSBzY3JlZW4sIHRvIHRoZSB0b3Agb2YgdGhlIGdyYXNzLlxyXG4gICAgY29uc3QgQk9UVE9NX0NIRUNLQk9YX1BBTkVMX01BUkdJTiA9IDEyLjU7XHJcbiAgICBjb25zdCBCT1RUT01fQ0hFQ0tCT1hfUEFORUxfWV9NQVJHSU4gPSB0aGlzLmxheW91dEJvdW5kcy5tYXhZIC0gdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdZKCAwICkgKyBCT1RUT01fQ0hFQ0tCT1hfUEFORUxfTUFSR0lOO1xyXG5cclxuICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBBbGlnbkJveCggYm90dG9tQ2hlY2tib3hHcm91cCwge1xyXG4gICAgICBhbGlnbkJvdW5kczogdGhpcy5sYXlvdXRCb3VuZHMsXHJcbiAgICAgIHhBbGlnbjogJ3JpZ2h0JyxcclxuICAgICAgeUFsaWduOiAnYm90dG9tJyxcclxuICAgICAgeE1hcmdpbjogQk9UVE9NX0NIRUNLQk9YX1BBTkVMX01BUkdJTixcclxuICAgICAgeU1hcmdpbjogQk9UVE9NX0NIRUNLQk9YX1BBTkVMX1lfTUFSR0lOXHJcbiAgICB9ICkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoZSBNZWRpYW5QcmVkaWN0aW9uTm9kZSBpcyBzaGFyZWQgaW4gdGhlIE1lZGlhbiBzY3JlZW4gYW5kIE1lYW5BbmRNZWRpYW5TY3JlZW4sIHNvIGZhY3RvcmVkIG91dCBoZXJlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgY3JlYXRlTWVkaWFuUHJlZGljdGlvbk5vZGUoIG1vZGVsOiBDQVZNb2RlbCwgbW9kZWxWaWV3VHJhbnNmb3JtOiBNb2RlbFZpZXdUcmFuc2Zvcm0yLCB0YW5kZW06IFRhbmRlbSApOiBQcmVkaWN0aW9uU2xpZGVyIHtcclxuICAgIHJldHVybiBuZXcgUHJlZGljdGlvblNsaWRlciggbW9kZWwubWVkaWFuUHJlZGljdGlvblByb3BlcnR5LCBtb2RlbFZpZXdUcmFuc2Zvcm0sIENBVkNvbnN0YW50cy5QSFlTSUNBTF9SQU5HRSwge1xyXG4gICAgICBwcmVkaWN0aW9uVGh1bWJOb2RlT3B0aW9uczoge1xyXG4gICAgICAgIGNvbG9yOiBDQVZDb2xvcnMubWVkaWFuQ29sb3JQcm9wZXJ0eVxyXG4gICAgICB9LFxyXG4gICAgICB2YWx1ZVByb3BlcnR5OiBtb2RlbC5tZWRpYW5QcmVkaWN0aW9uUHJvcGVydHksXHJcbiAgICAgIGVuYWJsZWRSYW5nZVByb3BlcnR5OiBuZXcgUHJvcGVydHk8UmFuZ2U+KCBDQVZDb25zdGFudHMuUEhZU0lDQUxfUkFOR0UgKSxcclxuICAgICAgcm91bmRUb0ludGVydmFsOiAwLjUsXHJcbiAgICAgIHZpc2libGVQcm9wZXJ0eTogbW9kZWwuaXNTaG93aW5nTWVkaWFuUHJlZGljdGlvblByb3BlcnR5LFxyXG4gICAgICB0YW5kZW06IHRhbmRlbVxyXG4gICAgfSApO1xyXG4gIH1cclxufVxyXG5cclxuY2VudGVyQW5kVmFyaWFiaWxpdHkucmVnaXN0ZXIoICdDQVZTY3JlZW5WaWV3JywgQ0FWU2NyZWVuVmlldyApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFVBQVUsTUFBNkIsb0NBQW9DO0FBQ2xGLE9BQU9DLFNBQVMsTUFBTSx1Q0FBdUM7QUFDN0QsT0FBT0Msb0JBQW9CLE1BQU0sK0JBQStCO0FBQ2hFLE9BQU9DLFlBQVksTUFBTSxvQkFBb0I7QUFDN0MsT0FBT0MsY0FBYyxNQUFNLHVE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