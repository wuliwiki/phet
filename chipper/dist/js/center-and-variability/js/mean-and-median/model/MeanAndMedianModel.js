// Copyright 2022-2023, University of Colorado Boulder

/**
 * Model for the "Mean & Median" screen.
 *
 * @author Chris Klusendorf (PhET Interactive Simulations)
 * @author Sam Reid (PhET Interactive Simulations)
 */

import centerAndVariability from '../../centerAndVariability.js';
import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import CAVSceneModel from '../../common/model/CAVSceneModel.js';
import CAVModel from '../../common/model/CAVModel.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import CAVConstants from '../../common/CAVConstants.js';

// constants
const HIGHLIGHT_ANIMATION_TIME_STEP = 0.25; // in seconds

export default class MeanAndMedianModel extends CAVModel {
  // Indicates how far the show median animation has progressed, or null if not animating. Not PhET-iO instrumented since
  // it represents a transient value.
  highlightAnimationIndex = null;
  lastHighlightAnimationStepTime = 0;
  isMedianAnimationCompleteProperty = new BooleanProperty(false);
  constructor(options) {
    const scene = new CAVSceneModel(CAVSceneModel.chooseDistribution(), {
      tandem: options.tandem.createTandem('sceneModel')
    });
    super([scene], {
      ...options,
      instrumentMeanPredictionProperty: true
    });
    this.isShowingTopMeanProperty = new BooleanProperty(false, {
      tandem: options.tandem.createTandem('isShowingTopMeanProperty')
    });
    this.isShowingTopMedianProperty = new BooleanProperty(false, {
      tandem: options.tandem.createTandem('isShowingTopMedianProperty')
    });

    // Don't show animation on startup or when setting PhET-iO state
    this.isShowingTopMedianProperty.lazyLink(isShowingTopMedian => {
      if (isShowingTopMedian) {
        if (!phet.joist.sim.isSettingPhetioStateProperty.value) {
          this.highlightAnimationIndex = 0;
          this.lastHighlightAnimationStepTime = scene.timeProperty.value;
        } else {
          // When setting PhET-iO state, show the arrow right away.
          this.isMedianAnimationCompleteProperty.value = true;
        }
      } else {
        this.clearAnimation();
        this.isMedianAnimationCompleteProperty.value = false;
      }
    });
    this.meanPredictionProperty = new NumberProperty(1.5, {
      range: CAVConstants.PHYSICAL_RANGE,
      tandem: options.tandem.createTandem('meanPredictionProperty')
    });
    this.isShowingMeanPredictionProperty = new BooleanProperty(false, {
      tandem: options.tandem.createTandem('isShowingMeanPredictionProperty')
    });
    scene.objectValueBecameNonNullEmitter.addListener(() => this.updateAnimation());
  }
  reset() {
    super.reset();
    this.highlightAnimationIndex = null;
    this.isMedianAnimationCompleteProperty.reset();
    this.isShowingTopMeanProperty.reset();
    this.isShowingTopMedianProperty.reset();
    this.meanPredictionProperty.reset();
    this.isShowingMeanPredictionProperty.reset();
  }
  step(dt) {
    super.step(dt);
    this.updateAnimation();
  }
  clearAnimation() {
    this.highlightAnimationIndex = null;
    this.selectedSceneModelProperty.value.soccerBalls.forEach(soccerBall => soccerBall.isShowingAnimationHighlightProperty.set(false));
  }
  updateAnimation() {
    const sortedObjects = this.selectedSceneModelProperty.value.getSortedLandedObjects();
    for (let i = 0; i < sortedObjects.length / 2; i++) {
      const isHighlighted = i === this.highlightAnimationIndex;
      sortedObjects[i].isShowingAnimationHighlightProperty.value = isHighlighted;
      const upperIndex = sortedObjects.length - 1 - i;
      sortedObjects[upperIndex].isShowingAnimationHighlightProperty.value = isHighlighted;
    }
    const isAnimationFinished = this.highlightAnimationIndex !== null && this.highlightAnimationIndex >= sortedObjects.length / 2;
    if (isAnimationFinished) {
      this.clearAnimation();
      this.isMedianAnimationCompleteProperty.value = true;
    } else if (this.highlightAnimationIndex !== null && this.selectedSceneModelProperty.value.timeProperty.value > this.lastHighlightAnimationStepTime + HIGHLIGHT_ANIMATION_TIME_STEP) {
      // if the animation has already started, step it to the next animation index
      this.highlightAnimationIndex++;
      this.lastHighlightAnimationStepTime = this.selectedSceneModelProperty.value.timeProperty.value;
    }
  }
}
centerAndVariability.register('MeanAndMedianModel', MeanAndMedianModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjZW50ZXJBbmRWYXJpYWJpbGl0eSIsIkJvb2xlYW5Qcm9wZXJ0eSIsIkNBVlNjZW5lTW9kZWwiLCJDQVZNb2RlbCIsIk51bWJlclByb3BlcnR5IiwiQ0FWQ29uc3RhbnRzIiwiSElHSExJR0hUX0FOSU1BVElPTl9USU1FX1NURVAiLCJNZWFuQW5kTWVkaWFuTW9kZWwiLCJoaWdobGlnaHRBbmltYXRpb25JbmRleCIsImxhc3RIaWdobGlnaHRBbmltYXRpb25TdGVwVGltZSIsImlzTWVkaWFuQW5pbWF0aW9uQ29tcGxldGVQcm9wZXJ0eSIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInNjZW5lIiwiY2hvb3NlRGlzdHJpYnV0aW9uIiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwiaW5zdHJ1bWVudE1lYW5QcmVkaWN0aW9uUHJvcGVydHkiLCJpc1Nob3dpbmdUb3BNZWFuUHJvcGVydHkiLCJpc1Nob3dpbmdUb3BNZWRpYW5Qcm9wZXJ0eSIsImxhenlMaW5rIiwiaXNTaG93aW5nVG9wTWVkaWFuIiwicGhldCIsImpvaXN0Iiwic2ltIiwiaXNTZXR0aW5nUGhldGlvU3RhdGVQcm9wZXJ0eSIsInZhbHVlIiwidGltZVByb3BlcnR5IiwiY2xlYXJBbmltYXRpb24iLCJtZWFuUHJlZGljdGlvblByb3BlcnR5IiwicmFuZ2UiLCJQSFlTSUNBTF9SQU5HRSIsImlzU2hvd2luZ01lYW5QcmVkaWN0aW9uUHJvcGVydHkiLCJvYmplY3RWYWx1ZUJlY2FtZU5vbk51bGxFbWl0dGVyIiwiYWRkTGlzdGVuZXIiLCJ1cGRhdGVBbmltYXRpb24iLCJyZXNldCIsInN0ZXAiLCJkdCIsInNlbGVjdGVkU2NlbmVNb2RlbFByb3BlcnR5Iiwic29jY2VyQmFsbHMiLCJmb3JFYWNoIiwic29jY2VyQmFsbCIsImlzU2hvd2luZ0FuaW1hdGlvbkhpZ2hsaWdodFByb3BlcnR5Iiwic2V0Iiwic29ydGVkT2JqZWN0cyIsImdldFNvcnRlZExhbmRlZE9iamVjdHMiLCJpIiwibGVuZ3RoIiwiaXNIaWdobGlnaHRlZCIsInVwcGVySW5kZXgiLCJpc0FuaW1hdGlvbkZpbmlzaGVkIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJNZWFuQW5kTWVkaWFuTW9kZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjItMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogTW9kZWwgZm9yIHRoZSBcIk1lYW4gJiBNZWRpYW5cIiBzY3JlZW4uXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgS2x1c2VuZG9yZiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgY2VudGVyQW5kVmFyaWFiaWxpdHkgZnJvbSAnLi4vLi4vY2VudGVyQW5kVmFyaWFiaWxpdHkuanMnO1xyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IENBVlNjZW5lTW9kZWwgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0NBVlNjZW5lTW9kZWwuanMnO1xyXG5pbXBvcnQgQ0FWTW9kZWwgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0NBVk1vZGVsLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgQ0FWQ29uc3RhbnRzIGZyb20gJy4uLy4uL2NvbW1vbi9DQVZDb25zdGFudHMuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IEhJR0hMSUdIVF9BTklNQVRJT05fVElNRV9TVEVQID0gMC4yNTsgLy8gaW4gc2Vjb25kc1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWVhbkFuZE1lZGlhbk1vZGVsIGV4dGVuZHMgQ0FWTW9kZWwge1xyXG5cclxuICAvLyBJbmRpY2F0ZXMgaG93IGZhciB0aGUgc2hvdyBtZWRpYW4gYW5pbWF0aW9uIGhhcyBwcm9ncmVzc2VkLCBvciBudWxsIGlmIG5vdCBhbmltYXRpbmcuIE5vdCBQaEVULWlPIGluc3RydW1lbnRlZCBzaW5jZVxyXG4gIC8vIGl0IHJlcHJlc2VudHMgYSB0cmFuc2llbnQgdmFsdWUuXHJcbiAgcHJpdmF0ZSBoaWdobGlnaHRBbmltYXRpb25JbmRleDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIHByaXZhdGUgbGFzdEhpZ2hsaWdodEFuaW1hdGlvblN0ZXBUaW1lID0gMDtcclxuICBwdWJsaWMgcmVhZG9ubHkgaXNNZWRpYW5BbmltYXRpb25Db21wbGV0ZVByb3BlcnR5ID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UgKTtcclxuICBwdWJsaWMgcmVhZG9ubHkgaXNTaG93aW5nVG9wTWVkaWFuUHJvcGVydHk6IEJvb2xlYW5Qcm9wZXJ0eTtcclxuICBwdWJsaWMgcmVhZG9ubHkgaXNTaG93aW5nVG9wTWVhblByb3BlcnR5OiBCb29sZWFuUHJvcGVydHk7XHJcbiAgcHVibGljIHJlYWRvbmx5IGlzU2hvd2luZ01lYW5QcmVkaWN0aW9uUHJvcGVydHk6IEJvb2xlYW5Qcm9wZXJ0eTtcclxuICBwdWJsaWMgcmVhZG9ubHkgbWVhblByZWRpY3Rpb25Qcm9wZXJ0eTogTnVtYmVyUHJvcGVydHk7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggb3B0aW9uczogeyB0YW5kZW06IFRhbmRlbSB9ICkge1xyXG5cclxuICAgIGNvbnN0IHNjZW5lID0gbmV3IENBVlNjZW5lTW9kZWwoIENBVlNjZW5lTW9kZWwuY2hvb3NlRGlzdHJpYnV0aW9uKCksIHsgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdzY2VuZU1vZGVsJyApIH0gKTtcclxuICAgIHN1cGVyKCBbIHNjZW5lIF0sIHtcclxuICAgICAgLi4ub3B0aW9ucyxcclxuICAgICAgaW5zdHJ1bWVudE1lYW5QcmVkaWN0aW9uUHJvcGVydHk6IHRydWVcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmlzU2hvd2luZ1RvcE1lYW5Qcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIGZhbHNlLCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnaXNTaG93aW5nVG9wTWVhblByb3BlcnR5JyApXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmlzU2hvd2luZ1RvcE1lZGlhblByb3BlcnR5ID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdpc1Nob3dpbmdUb3BNZWRpYW5Qcm9wZXJ0eScgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIERvbid0IHNob3cgYW5pbWF0aW9uIG9uIHN0YXJ0dXAgb3Igd2hlbiBzZXR0aW5nIFBoRVQtaU8gc3RhdGVcclxuICAgIHRoaXMuaXNTaG93aW5nVG9wTWVkaWFuUHJvcGVydHkubGF6eUxpbmsoIGlzU2hvd2luZ1RvcE1lZGlhbiA9PiB7XHJcbiAgICAgIGlmICggaXNTaG93aW5nVG9wTWVkaWFuICkge1xyXG5cclxuICAgICAgICBpZiAoICFwaGV0LmpvaXN0LnNpbS5pc1NldHRpbmdQaGV0aW9TdGF0ZVByb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICAgICAgdGhpcy5oaWdobGlnaHRBbmltYXRpb25JbmRleCA9IDA7XHJcbiAgICAgICAgICB0aGlzLmxhc3RIaWdobGlnaHRBbmltYXRpb25TdGVwVGltZSA9IHNjZW5lLnRpbWVQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgICAgLy8gV2hlbiBzZXR0aW5nIFBoRVQtaU8gc3RhdGUsIHNob3cgdGhlIGFycm93IHJpZ2h0IGF3YXkuXHJcbiAgICAgICAgICB0aGlzLmlzTWVkaWFuQW5pbWF0aW9uQ29tcGxldGVQcm9wZXJ0eS52YWx1ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHRoaXMuY2xlYXJBbmltYXRpb24oKTtcclxuICAgICAgICB0aGlzLmlzTWVkaWFuQW5pbWF0aW9uQ29tcGxldGVQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5tZWFuUHJlZGljdGlvblByb3BlcnR5ID0gbmV3IE51bWJlclByb3BlcnR5KCAxLjUsIHtcclxuICAgICAgcmFuZ2U6IENBVkNvbnN0YW50cy5QSFlTSUNBTF9SQU5HRSxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdtZWFuUHJlZGljdGlvblByb3BlcnR5JyApXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmlzU2hvd2luZ01lYW5QcmVkaWN0aW9uUHJvcGVydHkgPSBuZXcgQm9vbGVhblByb3BlcnR5KCBmYWxzZSwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2lzU2hvd2luZ01lYW5QcmVkaWN0aW9uUHJvcGVydHknIClcclxuICAgIH0gKTtcclxuXHJcbiAgICBzY2VuZS5vYmplY3RWYWx1ZUJlY2FtZU5vbk51bGxFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiB0aGlzLnVwZGF0ZUFuaW1hdGlvbigpICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgcmVzZXQoKTogdm9pZCB7XHJcbiAgICBzdXBlci5yZXNldCgpO1xyXG4gICAgdGhpcy5oaWdobGlnaHRBbmltYXRpb25JbmRleCA9IG51bGw7XHJcbiAgICB0aGlzLmlzTWVkaWFuQW5pbWF0aW9uQ29tcGxldGVQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5pc1Nob3dpbmdUb3BNZWFuUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMuaXNTaG93aW5nVG9wTWVkaWFuUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMubWVhblByZWRpY3Rpb25Qcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5pc1Nob3dpbmdNZWFuUHJlZGljdGlvblByb3BlcnR5LnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgc3RlcCggZHQ6IG51bWJlciApOiB2b2lkIHtcclxuICAgIHN1cGVyLnN0ZXAoIGR0ICk7XHJcbiAgICB0aGlzLnVwZGF0ZUFuaW1hdGlvbigpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjbGVhckFuaW1hdGlvbigpOiB2b2lkIHtcclxuICAgIHRoaXMuaGlnaGxpZ2h0QW5pbWF0aW9uSW5kZXggPSBudWxsO1xyXG4gICAgdGhpcy5zZWxlY3RlZFNjZW5lTW9kZWxQcm9wZXJ0eS52YWx1ZS5zb2NjZXJCYWxscy5mb3JFYWNoKCBzb2NjZXJCYWxsID0+IHNvY2NlckJhbGwuaXNTaG93aW5nQW5pbWF0aW9uSGlnaGxpZ2h0UHJvcGVydHkuc2V0KCBmYWxzZSApICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZUFuaW1hdGlvbigpOiB2b2lkIHtcclxuXHJcbiAgICBjb25zdCBzb3J0ZWRPYmplY3RzID0gdGhpcy5zZWxlY3RlZFNjZW5lTW9kZWxQcm9wZXJ0eS52YWx1ZS5nZXRTb3J0ZWRMYW5kZWRPYmplY3RzKCk7XHJcblxyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgc29ydGVkT2JqZWN0cy5sZW5ndGggLyAyOyBpKysgKSB7XHJcbiAgICAgIGNvbnN0IGlzSGlnaGxpZ2h0ZWQgPSBpID09PSB0aGlzLmhpZ2hsaWdodEFuaW1hdGlvbkluZGV4O1xyXG4gICAgICBzb3J0ZWRPYmplY3RzWyBpIF0uaXNTaG93aW5nQW5pbWF0aW9uSGlnaGxpZ2h0UHJvcGVydHkudmFsdWUgPSBpc0hpZ2hsaWdodGVkO1xyXG5cclxuICAgICAgY29uc3QgdXBwZXJJbmRleCA9IHNvcnRlZE9iamVjdHMubGVuZ3RoIC0gMSAtIGk7XHJcbiAgICAgIHNvcnRlZE9iamVjdHNbIHVwcGVySW5kZXggXS5pc1Nob3dpbmdBbmltYXRpb25IaWdobGlnaHRQcm9wZXJ0eS52YWx1ZSA9IGlzSGlnaGxpZ2h0ZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaXNBbmltYXRpb25GaW5pc2hlZCA9IHRoaXMuaGlnaGxpZ2h0QW5pbWF0aW9uSW5kZXggIT09IG51bGwgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodEFuaW1hdGlvbkluZGV4ID49IHNvcnRlZE9iamVjdHMubGVuZ3RoIC8gMjtcclxuXHJcbiAgICBpZiAoIGlzQW5pbWF0aW9uRmluaXNoZWQgKSB7XHJcbiAgICAgIHRoaXMuY2xlYXJBbmltYXRpb24oKTtcclxuICAgICAgdGhpcy5pc01lZGlhbkFuaW1hdGlvbkNvbXBsZXRlUHJvcGVydHkudmFsdWUgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIHRoaXMuaGlnaGxpZ2h0QW5pbWF0aW9uSW5kZXggIT09IG51bGwgJiZcclxuICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkU2NlbmVNb2RlbFByb3BlcnR5LnZhbHVlLnRpbWVQcm9wZXJ0eS52YWx1ZSA+IHRoaXMubGFzdEhpZ2hsaWdodEFuaW1hdGlvblN0ZXBUaW1lICsgSElHSExJR0hUX0FOSU1BVElPTl9USU1FX1NURVAgKSB7XHJcblxyXG4gICAgICAvLyBpZiB0aGUgYW5pbWF0aW9uIGhhcyBhbHJlYWR5IHN0YXJ0ZWQsIHN0ZXAgaXQgdG8gdGhlIG5leHQgYW5pbWF0aW9uIGluZGV4XHJcbiAgICAgIHRoaXMuaGlnaGxpZ2h0QW5pbWF0aW9uSW5kZXgrKztcclxuICAgICAgdGhpcy5sYXN0SGlnaGxpZ2h0QW5pbWF0aW9uU3RlcFRpbWUgPSB0aGlzLnNlbGVjdGVkU2NlbmVNb2RlbFByb3BlcnR5LnZhbHVlLnRpbWVQcm9wZXJ0eS52YWx1ZTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmNlbnRlckFuZFZhcmlhYmlsaXR5LnJlZ2lzdGVyKCAnTWVhbkFuZE1lZGlhbk1vZGVsJywgTWVhbkFuZE1lZGlhbk1vZGVsICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0Esb0JBQW9CLE1BQU0sK0JBQStCO0FBQ2hFLE9BQU9DLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsYUFBYSxNQUFNLHFDQUFxQztBQUMvRCxPQUFPQyxRQUFRLE1BQU0sZ0NBQWdDO0FBRXJELE9BQU9DLGNBQWMsTUFBTSx1Q0FBdUM7QUFDbEUsT0FBT0MsWUFBWSxNQUFNLDhCQUE4Qjs7QUFFdkQ7QUFDQSxNQUFNQyw2QkFBNkIsR0FBRyxJQUFJLENBQUMsQ0FBQzs7QUFFNUMsZUFBZSxNQUFNQyxrQkFBa0IsU0FBU0osUUFBUSxDQUFDO0VBRXZEO0VBQ0E7RUFDUUssdUJBQXVCLEdBQWtCLElBQUk7RUFFN0NDLDhCQUE4QixHQUFHLENBQUM7RUFDMUJDLGlDQUFpQyxHQUFHLElBQUlULGVBQWUsQ0FBRSxLQUFNLENBQUM7RUFNekVVLFdBQVdBLENBQUVDLE9BQTJCLEVBQUc7SUFFaEQsTUFBTUMsS0FBSyxHQUFHLElBQUlYLGFBQWEsQ0FBRUEsYUFBYSxDQUFDWSxrQkFBa0IsQ0FBQyxDQUFDLEVBQUU7TUFBRUMsTUFBTSxFQUFFSCxPQUFPLENBQUNHLE1BQU0sQ0FBQ0MsWUFBWSxDQUFFLFlBQWE7SUFBRSxDQUFFLENBQUM7SUFDOUgsS0FBSyxDQUFFLENBQUVILEtBQUssQ0FBRSxFQUFFO01BQ2hCLEdBQUdELE9BQU87TUFDVkssZ0NBQWdDLEVBQUU7SUFDcEMsQ0FBRSxDQUFDO0lBRUgsSUFBSSxDQUFDQyx3QkFBd0IsR0FBRyxJQUFJakIsZUFBZSxDQUFFLEtBQUssRUFBRTtNQUMxRGMsTUFBTSxFQUFFSCxPQUFPLENBQUNHLE1BQU0sQ0FBQ0MsWUFBWSxDQUFFLDBCQUEyQjtJQUNs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