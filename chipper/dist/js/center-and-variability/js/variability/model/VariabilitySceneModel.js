// Copyright 2022-2023, University of Colorado Boulder

import CAVSceneModel from '../../common/model/CAVSceneModel.js';
import centerAndVariability from '../../centerAndVariability.js';
import Property from '../../../../axon/js/Property.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import NullableIO from '../../../../tandem/js/types/NullableIO.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import VariabilityModel from './VariabilityModel.js';
export default class VariabilitySceneModel extends CAVSceneModel {
  initialized = false;
  constructor(distribution, options) {
    super(distribution, options);
    this.maxValueProperty = new DerivedProperty([this.dataRangeProperty], dataRange => {
      return dataRange === null ? null : dataRange.max;
    }, {
      tandem: options.tandem.createTandem('maxValueProperty'),
      phetioValueType: NullableIO(NumberIO)
    });
    this.minValueProperty = new DerivedProperty([this.dataRangeProperty], dataRange => {
      return dataRange === null ? null : dataRange.min;
    }, {
      tandem: options.tandem.createTandem('minValueProperty'),
      phetioValueType: NullableIO(NumberIO)
    });
    this.rangeValueProperty = new DerivedProperty([this.maxValueProperty, this.minValueProperty], (max, min) => {
      return max === null || min === null ? null : max - min;
    }, {
      tandem: options.tandem.createTandem('rangeValueProperty'),
      phetioValueType: NullableIO(NumberIO)
    });
    this.q1ValueProperty = new Property(null, {
      tandem: options.tandem.createTandem('q1ValueProperty'),
      phetioValueType: NullableIO(NumberIO),
      phetioReadOnly: true
    });
    this.q3ValueProperty = new Property(null, {
      tandem: options.tandem.createTandem('q3ValueProperty'),
      phetioValueType: NullableIO(NumberIO),
      phetioReadOnly: true
    });
    this.iqrValueProperty = new DerivedProperty([this.q1ValueProperty, this.q3ValueProperty], (q1, q3) => {
      return q3 - q1;
    });
    this.madValueProperty = new Property(null, {
      tandem: options.tandem.createTandem('madValueProperty'),
      phetioValueType: NullableIO(NumberIO)
    });
    this.updateDataMeasures();
    this.initialized = true;
  }
  reset() {
    super.reset();

    // TODO: https://github.com/phetsims/center-and-variability/issues/164 Should this be called in the parent class? Or at least make sure not to forget it
    // in any of the subclasses?
    this.updateDataMeasures();
  }
  updateDataMeasures() {
    super.updateDataMeasures();
    if (this.initialized) {
      const sortedObjects = this.getSortedLandedObjects();

      // if there is enough data to calculate quartiles
      if (sortedObjects.length >= 5) {
        // Split the array into lower and upper halves, ignoring the median value if there are an odd number of objects
        const splitIndex = Math.floor(sortedObjects.length / 2);
        const lowerHalf = sortedObjects.slice(0, splitIndex);
        const upperHalf = sortedObjects.slice(sortedObjects.length % 2 !== 0 ? splitIndex + 1 : splitIndex);
        const q1Objects = CAVSceneModel.getMedianObjectsFromSortedArray(lowerHalf);
        const q3Objects = CAVSceneModel.getMedianObjectsFromSortedArray(upperHalf);

        // take the average to account for cases where there is more than one object contributing to the median
        this.q1ValueProperty.value = _.mean(q1Objects.map(obj => obj.valueProperty.value));
        this.q3ValueProperty.value = _.mean(q3Objects.map(obj => obj.valueProperty.value));
        this.soccerBalls.forEach(object => {
          object.isQ1ObjectProperty.value = q1Objects.includes(object);
          object.isQ3ObjectProperty.value = q3Objects.includes(object);
        });
        assert && assert(!isNaN(this.q1ValueProperty.value));
        assert && assert(!isNaN(this.q3ValueProperty.value));
      } else {
        this.q1ValueProperty.value = null;
        this.q3ValueProperty.value = null;
      }

      // Support call from superclass constructor
      if (this.madValueProperty) {
        this.madValueProperty.value = sortedObjects.length === 0 ? null : VariabilityModel.meanAbsoluteDeviation(sortedObjects.map(object => object.valueProperty.value));
      }
    }
  }
}
centerAndVariability.register('VariabilitySceneModel', VariabilitySceneModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDQVZTY2VuZU1vZGVsIiwiY2VudGVyQW5kVmFyaWFiaWxpdHkiLCJQcm9wZXJ0eSIsIkRlcml2ZWRQcm9wZXJ0eSIsIk51bGxhYmxlSU8iLCJOdW1iZXJJTyIsIlZhcmlhYmlsaXR5TW9kZWwiLCJWYXJpYWJpbGl0eVNjZW5lTW9kZWwiLCJpbml0aWFsaXplZCIsImNvbnN0cnVjdG9yIiwiZGlzdHJpYnV0aW9uIiwib3B0aW9ucyIsIm1heFZhbHVlUHJvcGVydHkiLCJkYXRhUmFuZ2VQcm9wZXJ0eSIsImRhdGFSYW5nZSIsIm1heCIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsInBoZXRpb1ZhbHVlVHlwZSIsIm1pblZhbHVlUHJvcGVydHkiLCJtaW4iLCJyYW5nZVZhbHVlUHJvcGVydHkiLCJxMVZhbHVlUHJvcGVydHkiLCJwaGV0aW9SZWFkT25seSIsInEzVmFsdWVQcm9wZXJ0eSIsImlxclZhbHVlUHJvcGVydHkiLCJxMSIsInEzIiwibWFkVmFsdWVQcm9wZXJ0eSIsInVwZGF0ZURhdGFNZWFzdXJlcyIsInJlc2V0Iiwic29ydGVkT2JqZWN0cyIsImdldFNvcnRlZExhbmRlZE9iamVjdHMiLCJsZW5ndGgiLCJzcGxpdEluZGV4IiwiTWF0aCIsImZsb29yIiwibG93ZXJIYWxmIiwic2xpY2UiLCJ1cHBlckhhbGYiLCJxMU9iamVjdHMiLCJnZXRNZWRpYW5PYmplY3RzRnJvbVNvcnRlZEFycmF5IiwicTNPYmplY3RzIiwidmFsdWUiLCJfIiwibWVhbiIsIm1hcCIsIm9iaiIsInZhbHVlUHJvcGVydHkiLCJzb2NjZXJCYWxscyIsImZvckVhY2giLCJvYmplY3QiLCJpc1ExT2JqZWN0UHJvcGVydHkiLCJpbmNsdWRlcyIsImlzUTNPYmplY3RQcm9wZXJ0eSIsImFzc2VydCIsImlzTmFOIiwibWVhbkFic29sdXRlRGV2aWF0aW9uIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJWYXJpYWJpbGl0eVNjZW5lTW9kZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjItMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG5pbXBvcnQgQ0FWU2NlbmVNb2RlbCBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvQ0FWU2NlbmVNb2RlbC5qcyc7XHJcbmltcG9ydCBjZW50ZXJBbmRWYXJpYWJpbGl0eSBmcm9tICcuLi8uLi9jZW50ZXJBbmRWYXJpYWJpbGl0eS5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IE51bGxhYmxlSU8gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL051bGxhYmxlSU8uanMnO1xyXG5pbXBvcnQgTnVtYmVySU8gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL051bWJlcklPLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IFZhcmlhYmlsaXR5TW9kZWwgZnJvbSAnLi9WYXJpYWJpbGl0eU1vZGVsLmpzJztcclxuaW1wb3J0IFNvY2NlckJhbGwgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL1NvY2NlckJhbGwuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmFyaWFiaWxpdHlTY2VuZU1vZGVsIGV4dGVuZHMgQ0FWU2NlbmVNb2RlbCB7XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBtYXhWYWx1ZVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXIgfCBudWxsPjtcclxuICBwdWJsaWMgcmVhZG9ubHkgbWluVmFsdWVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyIHwgbnVsbD47XHJcbiAgcHVibGljIHJlYWRvbmx5IHJhbmdlVmFsdWVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyIHwgbnVsbD47XHJcbiAgcHVibGljIHJlYWRvbmx5IHExVmFsdWVQcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyIHwgbnVsbD47XHJcbiAgcHVibGljIHJlYWRvbmx5IHEzVmFsdWVQcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyIHwgbnVsbD47XHJcbiAgcHVibGljIHJlYWRvbmx5IGlxclZhbHVlUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlciB8IG51bGw+O1xyXG4gIHB1YmxpYyByZWFkb25seSBtYWRWYWx1ZVByb3BlcnR5OiBQcm9wZXJ0eTxudW1iZXIgfCBudWxsPjtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBpbml0aWFsaXplZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGRpc3RyaWJ1dGlvbjogUmVhZG9ubHlBcnJheTxudW1iZXI+LCBvcHRpb25zOiB7IHRhbmRlbTogVGFuZGVtIH0gKSB7XHJcbiAgICBzdXBlciggZGlzdHJpYnV0aW9uLCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5tYXhWYWx1ZVByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyB0aGlzLmRhdGFSYW5nZVByb3BlcnR5IF0sIGRhdGFSYW5nZSA9PiB7XHJcbiAgICAgIHJldHVybiBkYXRhUmFuZ2UgPT09IG51bGwgPyBudWxsIDogZGF0YVJhbmdlLm1heDtcclxuICAgIH0sIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdtYXhWYWx1ZVByb3BlcnR5JyApLFxyXG4gICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bGxhYmxlSU8oIE51bWJlcklPIClcclxuICAgIH0gKTtcclxuICAgIHRoaXMubWluVmFsdWVQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgdGhpcy5kYXRhUmFuZ2VQcm9wZXJ0eSBdLCBkYXRhUmFuZ2UgPT4ge1xyXG4gICAgICByZXR1cm4gZGF0YVJhbmdlID09PSBudWxsID8gbnVsbCA6IGRhdGFSYW5nZS5taW47XHJcbiAgICB9LCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnbWluVmFsdWVQcm9wZXJ0eScgKSxcclxuICAgICAgcGhldGlvVmFsdWVUeXBlOiBOdWxsYWJsZUlPKCBOdW1iZXJJTyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5yYW5nZVZhbHVlUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHRoaXMubWF4VmFsdWVQcm9wZXJ0eSwgdGhpcy5taW5WYWx1ZVByb3BlcnR5IF0sICggbWF4LCBtaW4gKSA9PiB7XHJcbiAgICAgIHJldHVybiAoIG1heCA9PT0gbnVsbCB8fCBtaW4gPT09IG51bGwgKSA/IG51bGwgOiBtYXggLSBtaW47XHJcbiAgICB9LCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncmFuZ2VWYWx1ZVByb3BlcnR5JyApLFxyXG4gICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bGxhYmxlSU8oIE51bWJlcklPIClcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLnExVmFsdWVQcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eTxudW1iZXIgfCBudWxsPiggbnVsbCwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3ExVmFsdWVQcm9wZXJ0eScgKSxcclxuICAgICAgcGhldGlvVmFsdWVUeXBlOiBOdWxsYWJsZUlPKCBOdW1iZXJJTyApLFxyXG4gICAgICBwaGV0aW9SZWFkT25seTogdHJ1ZVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5xM1ZhbHVlUHJvcGVydHkgPSBuZXcgUHJvcGVydHk8bnVtYmVyIHwgbnVsbD4oIG51bGwsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdxM1ZhbHVlUHJvcGVydHknICksXHJcbiAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVsbGFibGVJTyggTnVtYmVySU8gKSxcclxuICAgICAgcGhldGlvUmVhZE9ubHk6IHRydWVcclxuICAgIH0gKTtcclxuICAgIHRoaXMuaXFyVmFsdWVQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgdGhpcy5xMVZhbHVlUHJvcGVydHksIHRoaXMucTNWYWx1ZVByb3BlcnR5IF0sICggcTEsIHEzICkgPT4ge1xyXG4gICAgICByZXR1cm4gcTMhIC0gcTEhO1xyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMubWFkVmFsdWVQcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eTxudW1iZXIgfCBudWxsPiggbnVsbCwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ21hZFZhbHVlUHJvcGVydHknICksXHJcbiAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVsbGFibGVJTyggTnVtYmVySU8gKVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMudXBkYXRlRGF0YU1lYXN1cmVzKCk7XHJcbiAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNldCgpOiB2b2lkIHtcclxuICAgIHN1cGVyLnJlc2V0KCk7XHJcblxyXG4gICAgLy8gVE9ETzogaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2NlbnRlci1hbmQtdmFyaWFiaWxpdHkvaXNzdWVzLzE2NCBTaG91bGQgdGhpcyBiZSBjYWxsZWQgaW4gdGhlIHBhcmVudCBjbGFzcz8gT3IgYXQgbGVhc3QgbWFrZSBzdXJlIG5vdCB0byBmb3JnZXQgaXRcclxuICAgIC8vIGluIGFueSBvZiB0aGUgc3ViY2xhc3Nlcz9cclxuICAgIHRoaXMudXBkYXRlRGF0YU1lYXN1cmVzKCk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgb3ZlcnJpZGUgdXBkYXRlRGF0YU1lYXN1cmVzKCk6IHZvaWQge1xyXG4gICAgc3VwZXIudXBkYXRlRGF0YU1lYXN1cmVzKCk7XHJcblxyXG4gICAgaWYgKCB0aGlzLmluaXRpYWxpemVkICkge1xyXG4gICAgICBjb25zdCBzb3J0ZWRPYmplY3RzID0gdGhpcy5nZXRTb3J0ZWRMYW5kZWRPYmplY3RzKCk7XHJcblxyXG4gICAgICAvLyBpZiB0aGVyZSBpcyBlbm91Z2ggZGF0YSB0byBjYWxjdWxhdGUgcXVhcnRpbGVzXHJcbiAgICAgIGlmICggc29ydGVkT2JqZWN0cy5sZW5ndGggPj0gNSApIHtcclxuXHJcbiAgICAgICAgLy8gU3BsaXQgdGhlIGFycmF5IGludG8gbG93ZXIgYW5kIHVwcGVyIGhhbHZlcywgaWdub3JpbmcgdGhlIG1lZGlhbiB2YWx1ZSBpZiB0aGVyZSBhcmUgYW4gb2RkIG51bWJlciBvZiBvYmplY3RzXHJcbiAgICAgICAgY29uc3Qgc3BsaXRJbmRleCA9IE1hdGguZmxvb3IoIHNvcnRlZE9iamVjdHMubGVuZ3RoIC8gMiApO1xyXG4gICAgICAgIGNvbnN0IGxvd2VySGFsZiA9IHNvcnRlZE9iamVjdHMuc2xpY2UoIDAsIHNwbGl0SW5kZXggKTtcclxuICAgICAgICBjb25zdCB1cHBlckhhbGYgPSBzb3J0ZWRPYmplY3RzLnNsaWNlKCBzb3J0ZWRPYmplY3RzLmxlbmd0aCAlIDIgIT09IDAgPyBzcGxpdEluZGV4ICsgMSA6IHNwbGl0SW5kZXggKTtcclxuXHJcbiAgICAgICAgY29uc3QgcTFPYmplY3RzOiBTb2NjZXJCYWxsW10gPSBDQVZTY2VuZU1vZGVsLmdldE1lZGlhbk9iamVjdHNGcm9tU29ydGVkQXJyYXkoIGxvd2VySGFsZiApO1xyXG4gICAgICAgIGNvbnN0IHEzT2JqZWN0czogU29jY2VyQmFsbFtdID0gQ0FWU2NlbmVNb2RlbC5nZXRNZWRpYW5PYmplY3RzRnJvbVNvcnRlZEFycmF5KCB1cHBlckhhbGYgKTtcclxuXHJcbiAgICAgICAgLy8gdGFrZSB0aGUgYXZlcmFnZSB0byBhY2NvdW50IGZvciBjYXNlcyB3aGVyZSB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIG9iamVjdCBjb250cmlidXRpbmcgdG8gdGhlIG1lZGlhblxyXG4gICAgICAgIHRoaXMucTFWYWx1ZVByb3BlcnR5LnZhbHVlID0gXy5tZWFuKCBxMU9iamVjdHMubWFwKCBvYmogPT4gb2JqLnZhbHVlUHJvcGVydHkudmFsdWUhICkgKTtcclxuICAgICAgICB0aGlzLnEzVmFsdWVQcm9wZXJ0eS52YWx1ZSA9IF8ubWVhbiggcTNPYmplY3RzLm1hcCggb2JqID0+IG9iai52YWx1ZVByb3BlcnR5LnZhbHVlISApICk7XHJcblxyXG4gICAgICAgIHRoaXMuc29jY2VyQmFsbHMuZm9yRWFjaCggb2JqZWN0ID0+IHtcclxuICAgICAgICAgIG9iamVjdC5pc1ExT2JqZWN0UHJvcGVydHkudmFsdWUgPSBxMU9iamVjdHMuaW5jbHVkZXMoIG9iamVjdCApO1xyXG4gICAgICAgICAgb2JqZWN0LmlzUTNPYmplY3RQcm9wZXJ0eS52YWx1ZSA9IHEzT2JqZWN0cy5pbmNsdWRlcyggb2JqZWN0ICk7XHJcbiAgICAgICAgfSApO1xyXG5cclxuICAgICAgICBhc3NlcnQgJiYgYXNzZXJ0KCAhaXNOYU4oIHRoaXMucTFWYWx1ZVByb3BlcnR5LnZhbHVlICkgKTtcclxuICAgICAgICBhc3NlcnQgJiYgYXNzZXJ0KCAhaXNOYU4oIHRoaXMucTNWYWx1ZVByb3BlcnR5LnZhbHVlICkgKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB0aGlzLnExVmFsdWVQcm9wZXJ0eS52YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5xM1ZhbHVlUHJvcGVydHkudmFsdWUgPSBudWxsO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBTdXBwb3J0IGNhbGwgZnJvbSBzdXBlcmNsYXNzIGNvbnN0cnVjdG9yXHJcbiAgICAgIGlmICggdGhpcy5tYWRWYWx1ZVByb3BlcnR5ICkge1xyXG4gICAgICAgIHRoaXMubWFkVmFsdWVQcm9wZXJ0eS52YWx1ZSA9IHNvcnRlZE9iamVjdHMubGVuZ3RoID09PSAwID8gbnVsbCA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFyaWFiaWxpdHlNb2RlbC5tZWFuQWJzb2x1dGVEZXZpYXRpb24oIHNvcnRlZE9iamVjdHMubWFwKCBvYmplY3QgPT4gb2JqZWN0LnZhbHVlUHJvcGVydHkudmFsdWUhICkgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuXHJcbmNlbnRlckFuZFZhcmlhYmlsaXR5LnJlZ2lzdGVyKCAnVmFyaWFiaWxpdHlTY2VuZU1vZGVsJywgVmFyaWFiaWxpdHlTY2VuZU1vZGVsICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxPQUFPQSxhQUFhLE1BQU0scUNBQXFDO0FBQy9ELE9BQU9DLG9CQUFvQixNQUFNLCtCQUErQjtBQUVoRSxPQUFPQyxRQUFRLE1BQU0saUNBQWlDO0FBQ3RELE9BQU9DLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsVUFBVSxNQUFNLDJDQUEyQztBQUNsRSxPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBRTlELE9BQU9DLGdCQUFnQixNQUFNLHVCQUF1QjtBQUdwRCxlQUFlLE1BQU1DLHFCQUFxQixTQUFTUCxhQUFhLENBQUM7RUFVOUNRLFdBQVcsR0FBWSxLQUFLO0VBRXRDQyxXQUFXQSxDQUFFQyxZQUFtQyxFQUFFQyxPQUEyQixFQUFHO0lBQ3JGLEtBQUssQ0FBRUQsWUFBWSxFQUFFQyxPQUFRLENBQUM7SUFFOUIsSUFBSSxDQUFDQyxnQkFBZ0IsR0FBRyxJQUFJVCxlQUFlLENBQUUsQ0FBRSxJQUFJLENBQUNVLGlCQUFpQixDQUFFLEVBQUVDLFNBQVMsSUFBSTtNQUNwRixPQUFPQSxTQUFTLEtBQUssSUFBSSxHQUFHLElBQUksR0FBR0EsU0FBUyxDQUFDQyxHQUFHO0lBQ2xELENBQUMsRUFBRTtNQUNEQyxNQUFNLEVBQUVMLE9BQU8sQ0FBQ0ssTUFBTSxDQUFDQyxZQUFZLENBQUUsa0JBQW1CLENBQUM7TUFDekRDLGVBQWUsRUFBRWQsVUFBVSxDQUFFQyxRQUFTO0lBQ3hDLENBQUUsQ0FBQztJQUNILElBQUksQ0FBQ2MsZ0JBQWdCLEdBQUcsSUFBSWhCLGVBQWUsQ0FBRSxDQUFFLElBQUksQ0FBQ1UsaUJBQWlCLENBQUUsRUFBRUMsU0FBUyxJQUFJO01BQ3BGLE9BQU9BLFNBQVMsS0FBSyxJQUFJLEdBQUcsSUFBSSxHQUFHQSxTQUFTLENBQUNNLEdBQUc7SUFDbEQsQ0FBQyxFQUFFO01BQ0RKLE1BQU0sRUFBRUwsT0FBTyxDQUFDSyxNQUFNLENBQUNDLFlBQVksQ0FBRSxrQkFBbUIsQ0FBQztNQUN6REMsZUFBZSxFQUFFZCxVQUFVLENBQUVDLFFBQVM7SUFDeEMsQ0FBRSxDQUFDO0lBRUgsSUFBSSxDQUFDZ0Isa0JBQWtCLEdBQUcsSUFBSWxCLGVBQWUsQ0FBRSxDQUFFLElBQUksQ0FBQ1MsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDTyxnQkFBZ0IsQ0FBRSxFQUFFLENBQUVKLEdBQUcsRUFBRUssR0FBRyxLQUFNO01BQy9HLE9BQVNMLEdBQUcsS0FBSyxJQUFJLElBQUlLLEdBQUcsS0FBSyxJQUFJLEdBQUssSUFBSSxHQUFHTCxHQUFHLEdBQUdLLEdBQUc7SUFDNUQsQ0FBQyxFQUFFO01BQ0RKLE1BQU0sRUFBRUwsT0FBTyxDQUFDSyxNQUFNLENBQUNDLFlBQVksQ0FBRSxvQkFBcUIsQ0FBQztNQUMzREMsZUFBZSxFQUFFZCxVQUFVLENBQUVDLFFBQVM7SUFDeEMsQ0FBRSxDQUFDO0lBRUgsSUFBSSxDQUFDaUIsZUFBZSxHQUFHLElBQUlwQixRQUFRLENBQWlCLElBQUksRUFBRTtNQUN4RGMsTUFBTSxFQUFFTCxPQUFPLENBQUNLLE1BQU0sQ0FBQ0MsWUFBWSxDQUFFLGlCQUFrQixDQUFDO01BQ3hEQyxlQUFlLEVBQUVkLFVBQVUsQ0FBRUMsUUFBUyxDQUFDO01BQ3ZDa0IsY0FBYyxFQUFFO0lBQ2xCLENBQUUsQ0FBQztJQUNILElBQUksQ0FBQ0MsZUFBZSxHQUFHLElBQUl0QixRQUFRLENBQWlCLElBQUksRUFBRTtNQUN4RGMsTUFBTSxFQUFFTCxPQUFPLENBQUNLLE1BQU0sQ0FBQ0MsWUFBWSxDQUFFLGlCQUFrQixDQUFDO01BQ3hEQyxlQUFlLEVBQUVkLFVBQVUsQ0FBRUMsUUFBUyxDQUFDO01BQ3ZDa0IsY0FBYyxFQUFFO0lBQ2xCLENBQUUsQ0FBQztJQUNILElBQUksQ0FBQ0UsZ0JBQWdCLEdBQUcsSUFBSXRCLGVBQWUsQ0FBRSxDQUFFLElBQUksQ0FBQ21CLGVBQWUsRUFBRSxJQUFJLENBQUNFLGVBQWUsQ0FBRSxFQUFFLENBQUVFLEVBQUUsRUFBRUMsRUFBRSxLQUFNO01BQ3pHLE9BQU9BLEVBQUUsR0FBSUQsRUFBRztJQUNsQixDQUFFLENBQUM7SUFFSCxJQUFJLENBQUNFLGdCQUFnQixHQUFHLElBQUkxQixRQUFRLENBQWlCLElBQUksRUFBRTtNQUN6RGMsTUFBTSxFQUFFTCxPQUFPLENBQUNLLE1BQU0sQ0FBQ0MsWUFBWSxDQUFFLGtCQUFtQixDQUFDO01BQ3pEQyxlQUFlLEVBQUVkLFVBQVUsQ0FBRUMsUUFBUztJQUN4QyxDQUFFLENBQUM7SUFFSCxJQUFJLENBQUN3QixrQkFBa0IsQ0FBQyxDQUFDO0lBQ3pCLElBQUksQ0FBQ3JCLFdBQVcsR0FBRyxJQUFJO0VBQ3pCO0VBRWdCc0IsS0FBS0EsQ0FBQSxFQUFTO0lBQzVCLEtBQUssQ0FBQ0EsS0FBSyxDQUFDLENBQUM7O0lBRWI7SUFDQTtJQUNBLElBQUksQ0FBQ0Qsa0JBQWtCLENBQUMsQ0FBQztFQUMzQjtFQUVtQkEsa0JBQWtCQSxDQUFBLEVBQVM7SUFDNUMsS0FBSyxDQUFDQSxrQkFBa0IsQ0FBQyxDQUFDO0lBRTFCLElBQUssSUFBSSxDQUFDckIsV0FBVyxFQUFHO01BQ3RCLE1BQU11QixhQUFhLEdBQUcsSUFBSSxDQUFDQyxzQkFBc0IsQ0FBQyxDQUFDOztNQUVuRDtNQUNBLElBQUtELGFBQWEsQ0FBQ0UsTUFBTSxJQUFJLENBQUMsRUFBRztRQUUvQjtRQUNBLE1BQU1DLFVBQVUsR0FBR0MsSUFBSSxDQUFDQyxLQUFLLENBQUVMLGFBQWEsQ0FBQ0UsTUFBTSxHQUFHLENBQUUsQ0FBQztRQUN6RCxNQUFNSSxTQUFTLEdBQUdOLGFBQWEsQ0FBQ08sS0FBSyxDQUFFLENBQUMsRUFBRUosVUFBVyxDQUFDO1FBQ3RELE1BQU1LLFNBQVMsR0FBR1IsYUFBYSxDQUFDTyxLQUFLLENBQUVQLGFBQWEsQ0FBQ0UsTUFBTSxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUdDLFVBQVUsR0FBRyxDQUFDLEdBQUdBLFVBQVcsQ0FBQztRQUVyRyxNQUFNTSxTQUF1QixHQUFHeEMsYUFBYSxDQUFDeUMsK0JBQStCLENBQUVKLFNBQVUsQ0FBQztRQUMxRixNQUFNSyxTQUF1QixHQUFHMUMsYUFBYSxDQUFDeUMsK0JBQStCLENBQUVGLFNBQVUsQ0FBQzs7UUFFMUY7UUFDQSxJQUFJLENBQUNqQixlQUFlLENBQUNxQixLQUFLLEdBQUdDLENBQUMsQ0FBQ0MsSUFBSSxDQUFFTCxTQUFTLENBQUNNLEdBQUcsQ0FBRUMsR0FBRyxJQUFJQSxHQUFHLENBQUNDLGFBQWEsQ0FBQ0wsS0FBTyxDQUFFLENBQUM7UUFDdkYsSUFBSSxDQUFDbkIsZUFBZSxDQUFDbUIsS0FBSyxHQUFHQyxDQUFDLENBQUNDLElBQUksQ0FBRUgsU0FBUyxDQUFDSSxHQUFHLENBQUVDLEdBQUcsSUFBSUEsR0FBRyxDQUFDQyxhQUFhLENBQUNMLEtBQU8sQ0FBRSxDQUFDO1FBRXZGLElBQUksQ0FBQ00sV0FBVyxDQUFDQyxPQUFPLENBQUVDLE1BQU0sSUFBSTtVQUNsQ0EsTUFBTSxDQUFDQyxrQkFBa0IsQ0FBQ1QsS0FBSyxHQUFHSCxTQUFTLENBQUNhLFFBQVEsQ0FBRUYsTUFBTyxDQUFDO1VBQzlEQSxNQUFNLENBQUNHLGtCQUFrQixDQUFDWCxLQUFLLEdBQUdELFNBQVMsQ0FBQ1csUUFBUSxDQUFFRixNQUFPLENBQUM7UUFDaEUsQ0FBRSxDQUFDO1FBRUhJLE1BQU0sSUFBSUEsTUFBTSxDQUFFLENBQUNDLEtBQUssQ0FBRSxJQUFJLENBQUNsQyxlQUFlLENBQUNxQixLQUFNLENBQUUsQ0FBQztRQUN4RFksTUFBTSxJQUFJQSxNQUFNLENBQUUsQ0FBQ0MsS0FBSyxDQUFFLElBQUksQ0FBQ2hDLGVBQWUsQ0FBQ21CLEtBQU0sQ0FBRSxDQUFDO01BQzFELENBQUMsTUFDSTtRQUNILElBQUksQ0FBQ3JCLGVBQWUsQ0FBQ3FCLEtBQUssR0FBRyxJQUFJO1FBQ2pDLElBQUksQ0FBQ25CLGVBQWUsQ0FBQ21CLEtBQUssR0FBRyxJQUFJO01BQ25DOztNQUVBO01BQ0EsSUFBSyxJQUFJLENBQUNmLGdCQUFnQixFQUFHO1FBQzNCLElBQUksQ0FBQ0EsZ0JBQWdCLENBQUNlLEtBQUssR0FBR1osYUFBYSxDQUFDRSxNQUFNLEtBQUssQ0FBQyxHQUFHLElBQUksR0FDakMzQixnQkFBZ0IsQ0FBQ21ELHFCQUFxQixDQUFFMUIsYUFBYSxDQUFDZSxHQUFHLENBQUVLLE1BQU0sSUFBSUEsTUFBTSxDQUFDSCxhQUFhLENBQUNMLEtBQU8sQ0FBRSxDQUFDO01BQ3BJO0lBQ0Y7RUFDRjtBQUVGO0FBRUExQyxvQkFBb0IsQ0FBQ3lELFFBQVEsQ0FBRSx1QkFBdUIsRUFBRW5ELHFCQUFzQixDQUFDIn0=