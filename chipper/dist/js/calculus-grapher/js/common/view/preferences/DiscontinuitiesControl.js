// Copyright 2022-2023, University of Colorado Boulder

/**
 * DiscontinuitiesControl is the control in the Preferences dialog for selecting how discontinuities in curves
 * will be displayed. It is a labeled group of radio buttons.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import { combineOptions } from '../../../../../phet-core/js/optionize.js';
import { Circle, Line, Node, Text } from '../../../../../scenery/js/imports.js';
import RectangularRadioButton from '../../../../../sun/js/buttons/RectangularRadioButton.js';
import RectangularRadioButtonGroup from '../../../../../sun/js/buttons/RectangularRadioButtonGroup.js';
import calculusGrapher from '../../../calculusGrapher.js';
import CalculusGrapherColors from '../../CalculusGrapherColors.js';
import CalculusGrapherStrings from '../../../CalculusGrapherStrings.js';
import { ConnectDiscontinuitiesValues } from '../../CalculusGrapherQueryParameters.js';
import CalculusGrapherConstants from '../../CalculusGrapherConstants.js';
import PreferencesControl from '../../../../../joist/js/preferences/PreferencesControl.js';
export default class DiscontinuitiesControl extends PreferencesControl {
  constructor(connectDiscontinuitiesProperty, tandem) {
    const labelText = new Text(CalculusGrapherStrings.discontinuitiesStringProperty, {
      font: CalculusGrapherConstants.PREFERENCES_LABEL_FONT,
      maxWidth: CalculusGrapherConstants.PREFERENCES_LABEL_MAX_WIDTH,
      tandem: tandem.createTandem('labelText')
    });
    const radioButtonGroup = new DiscontinuitiesRadioButtonGroup(connectDiscontinuitiesProperty, tandem.createTandem('radioButtonGroup'));
    super({
      labelNode: labelText,
      controlNode: radioButtonGroup,
      labelSpacing: 20,
      tandem: tandem,
      visiblePropertyOptions: {
        phetioFeatured: true
      }
    });
    this.disposeDiscontinuitiesControl = () => {
      labelText.dispose();
      radioButtonGroup.dispose();
    };
  }
  dispose() {
    this.disposeDiscontinuitiesControl();
    super.dispose();
  }
}

/**
 * The radio button group for this control.
 */
class DiscontinuitiesRadioButtonGroup extends RectangularRadioButtonGroup {
  constructor(connectDiscontinuitiesProperty, tandem) {
    const items = ConnectDiscontinuitiesValues.map(value => {
      return {
        value: value,
        createNode: () => new DiscontinuitiesRadioButtonLabel(value),
        tandemName: `${value}${RectangularRadioButton.TANDEM_NAME_SUFFIX}`
      };
    });
    super(connectDiscontinuitiesProperty, items, {
      orientation: 'horizontal',
      radioButtonOptions: {
        baseColor: 'white',
        xMargin: 0,
        yMargin: 7,
        buttonAppearanceStrategyOptions: {
          selectedLineWidth: 2
        },
        phetioVisiblePropertyInstrumented: false
      },
      phetioVisiblePropertyInstrumented: false,
      tandem: tandem
    });
  }
}

/**
 * Labels for the radio buttons.
 */
class DiscontinuitiesRadioButtonLabel extends Node {
  constructor(value) {
    const lineWidth = 2;
    const verticalGap = 25;

    // 2 horizontal lines
    const lineLength = 20;
    const lineOptions = {
      lineWidth: lineWidth,
      stroke: CalculusGrapherColors.derivativeCurveStrokeProperty // Nodes that use circleOptions must be disposed!
    };

    const leftLine = new Line(0, 0, lineLength, 0, lineOptions);
    const rightLine = new Line(0, 0, lineLength, 0, lineOptions);

    // 2 open circles
    const circleOptions = {
      radius: 3,
      lineWidth: 2,
      stroke: CalculusGrapherColors.derivativeCurveStrokeProperty // Nodes that use circleOptions must be disposed!
    };

    const leftCircle = new Circle(circleOptions);
    const rightCircle = new Circle(circleOptions);

    // layout, left to right
    leftCircle.left = leftLine.right;
    leftCircle.centerY = leftLine.centerY;
    rightCircle.x = leftCircle.x;
    rightCircle.centerY = leftCircle.centerY - verticalGap;
    rightLine.left = rightCircle.right;
    rightLine.centerY = rightCircle.centerY;
    const children = [leftLine, rightLine, leftCircle, rightCircle];

    // optional vertical dashed line, connecting the 2 circles
    let dashedLine;
    if (value === 'dashedLine') {
      dashedLine = new Line(leftCircle.centerX, leftCircle.top, rightCircle.centerX, rightCircle.bottom, combineOptions({
        lineDash: [2, 2]
      }, lineOptions));
      children.push(dashedLine);
    }
    super({
      children: children
    });
    this.disposeDiscontinuitiesRadioButtonLabel = () => children.forEach(child => child.dispose());
  }
  dispose() {
    this.disposeDiscontinuitiesRadioButtonLabel();
    super.dispose();
  }
}
calculusGrapher.register('DiscontinuitiesControl', DiscontinuitiesControl);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb21iaW5lT3B0aW9ucyIsIkNpcmNsZSIsIkxpbmUiLCJOb2RlIiwiVGV4dCIsIlJlY3Rhbmd1bGFyUmFkaW9CdXR0b24iLCJSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXAiLCJjYWxjdWx1c0dyYXBoZXIiLCJDYWxjdWx1c0dyYXBoZXJDb2xvcnMiLCJDYWxjdWx1c0dyYXBoZXJTdHJpbmdzIiwiQ29ubmVjdERpc2NvbnRpbnVpdGllc1ZhbHVlcyIsIkNhbGN1bHVzR3JhcGhlckNvbnN0YW50cyIsIlByZWZlcmVuY2VzQ29udHJvbCIsIkRpc2NvbnRpbnVpdGllc0NvbnRyb2wiLCJjb25zdHJ1Y3RvciIsImNvbm5lY3REaXNjb250aW51aXRpZXNQcm9wZXJ0eSIsInRhbmRlbSIsImxhYmVsVGV4dCIsImRpc2NvbnRpbnVpdGllc1N0cmluZ1Byb3BlcnR5IiwiZm9udCIsIlBSRUZFUkVOQ0VTX0xBQkVMX0ZPTlQiLCJtYXhXaWR0aCIsIlBSRUZFUkVOQ0VTX0xBQkVMX01BWF9XSURUSCIsImNyZWF0ZVRhbmRlbSIsInJhZGlvQnV0dG9uR3JvdXAiLCJEaXNjb250aW51aXRpZXNSYWRpb0J1dHRvbkdyb3VwIiwibGFiZWxOb2RlIiwiY29udHJvbE5vZGUiLCJsYWJlbFNwYWNpbmciLCJ2aXNpYmxlUHJvcGVydHlPcHRpb25zIiwicGhldGlvRmVhdHVyZWQiLCJkaXNwb3NlRGlzY29udGludWl0aWVzQ29udHJvbCIsImRpc3Bvc2UiLCJpdGVtcyIsIm1hcCIsInZhbHVlIiwiY3JlYXRlTm9kZSIsIkRpc2NvbnRpbnVpdGllc1JhZGlvQnV0dG9uTGFiZWwiLCJ0YW5kZW1OYW1lIiwiVEFOREVNX05BTUVfU1VGRklYIiwib3JpZW50YXRpb24iLCJyYWRpb0J1dHRvbk9wdGlvbnMiLCJiYXNlQ29sb3IiLCJ4TWFyZ2luIiwieU1hcmdpbiIsImJ1dHRvbkFwcGVhcmFuY2VTdHJhdGVneU9wdGlvbnMiLCJzZWxlY3RlZExpbmVXaWR0aCIsInBoZXRpb1Zpc2libGVQcm9wZXJ0eUluc3RydW1lbnRlZCIsImxpbmVXaWR0aCIsInZlcnRpY2FsR2FwIiwibGluZUxlbmd0aCIsImxpbmVPcHRpb25zIiwic3Ryb2tlIiwiZGVyaXZhdGl2ZUN1cnZlU3Ryb2tlUHJvcGVydHkiLCJsZWZ0TGluZSIsInJpZ2h0TGluZSIsImNpcmNsZU9wdGlvbnMiLCJyYWRpdXMiLCJsZWZ0Q2lyY2xlIiwicmlnaHRDaXJjbGUiLCJsZWZ0IiwicmlnaHQiLCJjZW50ZXJZIiwieCIsImNoaWxkcmVuIiwiZGFzaGVkTGluZSIsImNlbnRlclgiLCJ0b3AiLCJib3R0b20iLCJsaW5lRGFzaCIsInB1c2giLCJkaXNwb3NlRGlzY29udGludWl0aWVzUmFkaW9CdXR0b25MYWJlbCIsImZvckVhY2giLCJjaGlsZCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRGlzY29udGludWl0aWVzQ29udHJvbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMi0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBEaXNjb250aW51aXRpZXNDb250cm9sIGlzIHRoZSBjb250cm9sIGluIHRoZSBQcmVmZXJlbmNlcyBkaWFsb2cgZm9yIHNlbGVjdGluZyBob3cgZGlzY29udGludWl0aWVzIGluIGN1cnZlc1xyXG4gKiB3aWxsIGJlIGRpc3BsYXllZC4gSXQgaXMgYSBsYWJlbGVkIGdyb3VwIG9mIHJhZGlvIGJ1dHRvbnMuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgeyBjb21iaW5lT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgeyBDaXJjbGUsIExpbmUsIExpbmVPcHRpb25zLCBOb2RlLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFJlY3Rhbmd1bGFyUmFkaW9CdXR0b24gZnJvbSAnLi4vLi4vLi4vLi4vLi4vc3VuL2pzL2J1dHRvbnMvUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbi5qcyc7XHJcbmltcG9ydCBSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXAsIHsgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwSXRlbSB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3N1bi9qcy9idXR0b25zL1JlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cC5qcyc7XHJcbmltcG9ydCBjYWxjdWx1c0dyYXBoZXIgZnJvbSAnLi4vLi4vLi4vY2FsY3VsdXNHcmFwaGVyLmpzJztcclxuaW1wb3J0IENhbGN1bHVzR3JhcGhlckNvbG9ycyBmcm9tICcuLi8uLi9DYWxjdWx1c0dyYXBoZXJDb2xvcnMuanMnO1xyXG5pbXBvcnQgQ2FsY3VsdXNHcmFwaGVyU3RyaW5ncyBmcm9tICcuLi8uLi8uLi9DYWxjdWx1c0dyYXBoZXJTdHJpbmdzLmpzJztcclxuaW1wb3J0IHsgQ29ubmVjdERpc2NvbnRpbnVpdGllcywgQ29ubmVjdERpc2NvbnRpbnVpdGllc1ZhbHVlcyB9IGZyb20gJy4uLy4uL0NhbGN1bHVzR3JhcGhlclF1ZXJ5UGFyYW1ldGVycy5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBDYWxjdWx1c0dyYXBoZXJDb25zdGFudHMgZnJvbSAnLi4vLi4vQ2FsY3VsdXNHcmFwaGVyQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IFByZWZlcmVuY2VzQ29udHJvbCBmcm9tICcuLi8uLi8uLi8uLi8uLi9qb2lzdC9qcy9wcmVmZXJlbmNlcy9QcmVmZXJlbmNlc0NvbnRyb2wuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGlzY29udGludWl0aWVzQ29udHJvbCBleHRlbmRzIFByZWZlcmVuY2VzQ29udHJvbCB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZURpc2NvbnRpbnVpdGllc0NvbnRyb2w6ICgpID0+IHZvaWQ7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggY29ubmVjdERpc2NvbnRpbnVpdGllc1Byb3BlcnR5OiBQcm9wZXJ0eTxDb25uZWN0RGlzY29udGludWl0aWVzPiwgdGFuZGVtOiBUYW5kZW0gKSB7XHJcblxyXG4gICAgY29uc3QgbGFiZWxUZXh0ID0gbmV3IFRleHQoIENhbGN1bHVzR3JhcGhlclN0cmluZ3MuZGlzY29udGludWl0aWVzU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgZm9udDogQ2FsY3VsdXNHcmFwaGVyQ29uc3RhbnRzLlBSRUZFUkVOQ0VTX0xBQkVMX0ZPTlQsXHJcbiAgICAgIG1heFdpZHRoOiBDYWxjdWx1c0dyYXBoZXJDb25zdGFudHMuUFJFRkVSRU5DRVNfTEFCRUxfTUFYX1dJRFRILFxyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdsYWJlbFRleHQnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCByYWRpb0J1dHRvbkdyb3VwID0gbmV3IERpc2NvbnRpbnVpdGllc1JhZGlvQnV0dG9uR3JvdXAoIGNvbm5lY3REaXNjb250aW51aXRpZXNQcm9wZXJ0eSxcclxuICAgICAgdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3JhZGlvQnV0dG9uR3JvdXAnICkgKTtcclxuXHJcbiAgICBzdXBlcigge1xyXG4gICAgICBsYWJlbE5vZGU6IGxhYmVsVGV4dCxcclxuICAgICAgY29udHJvbE5vZGU6IHJhZGlvQnV0dG9uR3JvdXAsXHJcbiAgICAgIGxhYmVsU3BhY2luZzogMjAsXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLFxyXG4gICAgICB2aXNpYmxlUHJvcGVydHlPcHRpb25zOiB7XHJcbiAgICAgICAgcGhldGlvRmVhdHVyZWQ6IHRydWVcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuZGlzcG9zZURpc2NvbnRpbnVpdGllc0NvbnRyb2wgPSAoKSA9PiB7XHJcbiAgICAgIGxhYmVsVGV4dC5kaXNwb3NlKCk7XHJcbiAgICAgIHJhZGlvQnV0dG9uR3JvdXAuZGlzcG9zZSgpO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5kaXNwb3NlRGlzY29udGludWl0aWVzQ29udHJvbCgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRoZSByYWRpbyBidXR0b24gZ3JvdXAgZm9yIHRoaXMgY29udHJvbC5cclxuICovXHJcbmNsYXNzIERpc2NvbnRpbnVpdGllc1JhZGlvQnV0dG9uR3JvdXAgZXh0ZW5kcyBSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXA8Q29ubmVjdERpc2NvbnRpbnVpdGllcz4ge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGNvbm5lY3REaXNjb250aW51aXRpZXNQcm9wZXJ0eTogUHJvcGVydHk8Q29ubmVjdERpc2NvbnRpbnVpdGllcz4sIHRhbmRlbTogVGFuZGVtICkge1xyXG5cclxuICAgIGNvbnN0IGl0ZW1zOiBSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXBJdGVtPENvbm5lY3REaXNjb250aW51aXRpZXM+W10gPSBDb25uZWN0RGlzY29udGludWl0aWVzVmFsdWVzLm1hcCggdmFsdWUgPT4ge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICBjcmVhdGVOb2RlOiAoKSA9PiBuZXcgRGlzY29udGludWl0aWVzUmFkaW9CdXR0b25MYWJlbCggdmFsdWUgKSxcclxuICAgICAgICB0YW5kZW1OYW1lOiBgJHt2YWx1ZX0ke1JlY3Rhbmd1bGFyUmFkaW9CdXR0b24uVEFOREVNX05BTUVfU1VGRklYfWBcclxuICAgICAgfTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBzdXBlciggY29ubmVjdERpc2NvbnRpbnVpdGllc1Byb3BlcnR5LCBpdGVtcywge1xyXG4gICAgICBvcmllbnRhdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICByYWRpb0J1dHRvbk9wdGlvbnM6IHtcclxuICAgICAgICBiYXNlQ29sb3I6ICd3aGl0ZScsXHJcbiAgICAgICAgeE1hcmdpbjogMCxcclxuICAgICAgICB5TWFyZ2luOiA3LFxyXG4gICAgICAgIGJ1dHRvbkFwcGVhcmFuY2VTdHJhdGVneU9wdGlvbnM6IHtcclxuICAgICAgICAgIHNlbGVjdGVkTGluZVdpZHRoOiAyXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwaGV0aW9WaXNpYmxlUHJvcGVydHlJbnN0cnVtZW50ZWQ6IGZhbHNlXHJcbiAgICAgIH0sXHJcbiAgICAgIHBoZXRpb1Zpc2libGVQcm9wZXJ0eUluc3RydW1lbnRlZDogZmFsc2UsXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtXHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogTGFiZWxzIGZvciB0aGUgcmFkaW8gYnV0dG9ucy5cclxuICovXHJcbmNsYXNzIERpc2NvbnRpbnVpdGllc1JhZGlvQnV0dG9uTGFiZWwgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlRGlzY29udGludWl0aWVzUmFkaW9CdXR0b25MYWJlbDogKCkgPT4gdm9pZDtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCB2YWx1ZTogQ29ubmVjdERpc2NvbnRpbnVpdGllcyApIHtcclxuXHJcbiAgICBjb25zdCBsaW5lV2lkdGggPSAyO1xyXG4gICAgY29uc3QgdmVydGljYWxHYXAgPSAyNTtcclxuXHJcbiAgICAvLyAyIGhvcml6b250YWwgbGluZXNcclxuICAgIGNvbnN0IGxpbmVMZW5ndGggPSAyMDtcclxuICAgIGNvbnN0IGxpbmVPcHRpb25zID0ge1xyXG4gICAgICBsaW5lV2lkdGg6IGxpbmVXaWR0aCxcclxuICAgICAgc3Ryb2tlOiBDYWxjdWx1c0dyYXBoZXJDb2xvcnMuZGVyaXZhdGl2ZUN1cnZlU3Ryb2tlUHJvcGVydHkgLy8gTm9kZXMgdGhhdCB1c2UgY2lyY2xlT3B0aW9ucyBtdXN0IGJlIGRpc3Bvc2VkIVxyXG4gICAgfTtcclxuICAgIGNvbnN0IGxlZnRMaW5lID0gbmV3IExpbmUoIDAsIDAsIGxpbmVMZW5ndGgsIDAsIGxpbmVPcHRpb25zICk7XHJcbiAgICBjb25zdCByaWdodExpbmUgPSBuZXcgTGluZSggMCwgMCwgbGluZUxlbmd0aCwgMCwgbGluZU9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyAyIG9wZW4gY2lyY2xlc1xyXG4gICAgY29uc3QgY2lyY2xlT3B0aW9ucyA9IHtcclxuICAgICAgcmFkaXVzOiAzLFxyXG4gICAgICBsaW5lV2lkdGg6IDIsXHJcbiAgICAgIHN0cm9rZTogQ2FsY3VsdXNHcmFwaGVyQ29sb3JzLmRlcml2YXRpdmVDdXJ2ZVN0cm9rZVByb3BlcnR5IC8vIE5vZGVzIHRoYXQgdXNlIGNpcmNsZU9wdGlvbnMgbXVzdCBiZSBkaXNwb3NlZCFcclxuICAgIH07XHJcbiAgICBjb25zdCBsZWZ0Q2lyY2xlID0gbmV3IENpcmNsZSggY2lyY2xlT3B0aW9ucyApO1xyXG4gICAgY29uc3QgcmlnaHRDaXJjbGUgPSBuZXcgQ2lyY2xlKCBjaXJjbGVPcHRpb25zICk7XHJcblxyXG4gICAgLy8gbGF5b3V0LCBsZWZ0IHRvIHJpZ2h0XHJcbiAgICBsZWZ0Q2lyY2xlLmxlZnQgPSBsZWZ0TGluZS5yaWdodDtcclxuICAgIGxlZnRDaXJjbGUuY2VudGVyWSA9IGxlZnRMaW5lLmNlbnRlclk7XHJcbiAgICByaWdodENpcmNsZS54ID0gbGVmdENpcmNsZS54O1xyXG4gICAgcmlnaHRDaXJjbGUuY2VudGVyWSA9IGxlZnRDaXJjbGUuY2VudGVyWSAtIHZlcnRpY2FsR2FwO1xyXG4gICAgcmlnaHRMaW5lLmxlZnQgPSByaWdodENpcmNsZS5yaWdodDtcclxuICAgIHJpZ2h0TGluZS5jZW50ZXJZID0gcmlnaHRDaXJjbGUuY2VudGVyWTtcclxuXHJcbiAgICBjb25zdCBjaGlsZHJlbiA9IFsgbGVmdExpbmUsIHJpZ2h0TGluZSwgbGVmdENpcmNsZSwgcmlnaHRDaXJjbGUgXTtcclxuXHJcbiAgICAvLyBvcHRpb25hbCB2ZXJ0aWNhbCBkYXNoZWQgbGluZSwgY29ubmVjdGluZyB0aGUgMiBjaXJjbGVzXHJcbiAgICBsZXQgZGFzaGVkTGluZTogTGluZTtcclxuICAgIGlmICggdmFsdWUgPT09ICdkYXNoZWRMaW5lJyApIHtcclxuICAgICAgZGFzaGVkTGluZSA9IG5ldyBMaW5lKCBsZWZ0Q2lyY2xlLmNlbnRlclgsIGxlZnRDaXJjbGUudG9wLCByaWdodENpcmNsZS5jZW50ZXJYLCByaWdodENpcmNsZS5ib3R0b20sXHJcbiAgICAgICAgY29tYmluZU9wdGlvbnM8TGluZU9wdGlvbnM+KCB7XHJcbiAgICAgICAgICBsaW5lRGFzaDogWyAyLCAyIF1cclxuICAgICAgICB9LCBsaW5lT3B0aW9ucyApICk7XHJcbiAgICAgIGNoaWxkcmVuLnB1c2goIGRhc2hlZExpbmUgKTtcclxuICAgIH1cclxuXHJcbiAgICBzdXBlcigge1xyXG4gICAgICBjaGlsZHJlbjogY2hpbGRyZW5cclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VEaXNjb250aW51aXRpZXNSYWRpb0J1dHRvbkxhYmVsID0gKCkgPT4gY2hpbGRyZW4uZm9yRWFjaCggY2hpbGQgPT4gY2hpbGQuZGlzcG9zZSgpICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZGlzcG9zZURpc2NvbnRpbnVpdGllc1JhZGlvQnV0dG9uTGFiZWwoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbmNhbGN1bHVzR3JhcGhlci5yZWdpc3RlciggJ0Rpc2NvbnRpbnVpdGllc0NvbnRyb2wnLCBEaXNjb250aW51aXRpZXNDb250cm9sICk7XHJc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