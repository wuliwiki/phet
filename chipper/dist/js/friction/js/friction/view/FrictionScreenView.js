// Copyright 2013-2022, University of Colorado Boulder

/**
 * Friction's ScreenView
 *
 * @author Andrey Zelenkov (Mlearner)
 * @author John Blanco (PhET Interactive Simulations)
 * @author Sam Reid (PhET Interactive Simulations)
 */

import Bounds2 from '../../../../dot/js/Bounds2.js';
import ScreenView from '../../../../joist/js/ScreenView.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import ThermometerNode from '../../../../scenery-phet/js/ThermometerNode.js';
import { Node, Voicing } from '../../../../scenery/js/imports.js';
import SoundClip from '../../../../tambo/js/sound-generators/SoundClip.js';
import SoundLevelEnum from '../../../../tambo/js/SoundLevelEnum.js';
import soundManager from '../../../../tambo/js/soundManager.js';
import ResponsePacket from '../../../../utterance-queue/js/ResponsePacket.js';
import Utterance from '../../../../utterance-queue/js/Utterance.js';
import breakOffAutosinfonieSpatialized_mp3 from '../../../sounds/breakOffAutosinfonieSpatialized_mp3.js';
import contactLower_mp3 from '../../../sounds/contactLower_mp3.js';
import friction from '../../friction.js';
import FrictionStrings from '../../FrictionStrings.js';
import FrictionConstants from '../FrictionConstants.js';
import FrictionModel from '../model/FrictionModel.js';
import BookMovementAlerter from './book/BookMovementAlerter.js';
import BookNode from './book/BookNode.js';
import BookRubSoundGenerator from './book/BookRubSoundGenerator.js';
import BreakAwayAlerter from './BreakAwayAlerter.js';
import CoolingSoundGenerator from './CoolingSoundGenerator.js';
import FrictionScreenSummaryNode from './FrictionScreenSummaryNode.js';
import GrabbedDescriber from './GrabbedDescriber.js';
import MagnifierNode from './magnifier/MagnifierNode.js';
import MoleculeMotionSoundGenerator from './MoleculeMotionSoundGenerator.js';
import TemperatureDecreasingAlerter from './TemperatureDecreasingAlerter.js';
import TemperatureIncreasingAlerter from './TemperatureIncreasingAlerter.js';

// constants
const chemistryStringProperty = FrictionStrings.chemistryStringProperty;
const physicsStringProperty = FrictionStrings.physicsStringProperty;
const THERMOMETER_FLUID_MAIN_COLOR = 'rgb(237,28,36)';
const THERMOMETER_FLUID_HIGHLIGHT_COLOR = 'rgb(240,150,150)';
const THERMOMETER_FLUID_RIGHT_SIDE_COLOR = 'rgb(237,28,36)';
const THERMOMETER_BACKGROUND_FILL_COLOR = 'white';
const THERMOMETER_MIN_TEMP = FrictionModel.THERMOMETER_MIN_TEMP;
const THERMOMETER_MAX_TEMP = FrictionModel.THERMOMETER_MAX_TEMP;
class FrictionScreenView extends ScreenView {
  /**
   * @param {FrictionModel} model
   * @param {Tandem} tandem
   */
  constructor(model, tandem) {
    // To pass to super
    const screenSummaryNodeContainer = new Node();
    super({
      layoutBounds: new Bounds2(0, 0, model.width, model.height),
      screenSummaryContent: screenSummaryNodeContainer,
      tandem: tandem
    });
    const descriptionAlertNodeOptions = {
      descriptionAlertNode: this
    };

    // pdom - initialize the describers for auditory descriptions and alerts.
    const temperatureIncreasingAlerter = new TemperatureIncreasingAlerter(model, descriptionAlertNodeOptions);
    const temperatureDecreasingAlerter = new TemperatureDecreasingAlerter(model, descriptionAlertNodeOptions);
    const breakAwayAlerter = new BreakAwayAlerter(model.vibrationAmplitudeProperty, model.numberOfAtomsShearedOffProperty, descriptionAlertNodeOptions);
    const bookMovementAlerter = new BookMovementAlerter(model, descriptionAlertNodeOptions);
    const grabbedDescriber = new GrabbedDescriber(model.contactProperty, model.successfullyInteractedWithProperty);
    const atomsJiggleTinyBitUtterance = new Utterance({
      alert: new ResponsePacket({
        contextResponse: FrictionStrings.a11y.atomsJiggleTinyBitTempCool
      }),
      announcerOptions: {
        cancelOther: false
      }
    });
    const alertSettledAndCool = () => {
      // only add "reset sim" hint when all atoms have sheared off.
      atomsJiggleTinyBitUtterance.alert.hintResponse = model.numberOfAtomsShearedOffProperty.value === FrictionModel.NUMBER_OF_SHEARABLE_ATOMS ? FrictionStrings.a11y.resetSimMoreObservationSentence : null;
      this.alertDescriptionUtterance(atomsJiggleTinyBitUtterance);
      Voicing.alertUtterance(atomsJiggleTinyBitUtterance);
    };
    let amplitudeIncreasedEnoughForSettledAndCoolAlert = false;

    // handle the "settled and cool" alert once temp is completely decreased.
    // lazyLink so that we do not hear the alert on startup
    // exists for the lifetime of the sim, no need to dispose
    model.vibrationAmplitudeProperty.lazyLink(amplitude => {
      if (amplitudeIncreasedEnoughForSettledAndCoolAlert && amplitude === model.vibrationAmplitudeProperty.initialValue) {
        alertSettledAndCool();
        amplitudeIncreasedEnoughForSettledAndCoolAlert = false;
      }

      // The amplitude must increase 1% of its range before the next settled and cool alert can be triggered.
      if (amplitude >= model.vibrationAmplitudeProperty.range.expandNormalizedValue(0.01)) {
        amplitudeIncreasedEnoughForSettledAndCoolAlert = true;
      }
    });

    // pdom
    const frictionScreenSummaryNode = new FrictionScreenSummaryNode(model.contactProperty, model.numberOfAtomsShearedOffProperty, model.vibrationAmplitudeProperty, THERMOMETER_MIN_TEMP, THERMOMETER_MAX_TEMP, temperatureDecreasingAlerter);
    screenSummaryNodeContainer.addChild(frictionScreenSummaryNode);

    // @private
    this.frictionScreenSummaryNode = frictionScreenSummaryNode;

    // add physics book
    this.addChild(new BookNode(model, physicsStringProperty, temperatureIncreasingAlerter, temperatureDecreasingAlerter, bookMovementAlerter, grabbedDescriber, alertSettledAndCool, {
      x: 50,
      y: 225,
      interactiveHighlight: 'invisible',
      tandem: tandem.createTandem('bottomBookNode')
    }));

    // add chemistry book
    const chemistryBookNode = new BookNode(model, chemistryStringProperty, temperatureIncreasingAlerter, temperatureDecreasingAlerter, bookMovementAlerter, grabbedDescriber, alertSettledAndCool, {
      x: 65,
      y: 209,
      color: FrictionConstants.TOP_BOOK_COLOR_MACRO,
      drag: true,
      // phet-io
      tandem: tandem.createTandem('topBookNode'),
      phetioInputEnabledPropertyInstrumented: true
    });
    this.addChild(chemistryBookNode);

    // create and hook up the sound that will be produced when the books come into contact with one another
    const contactLower_mp3SoundClip = new SoundClip(contactLower_mp3, {
      initialOutputLevel: 0.06
    });
    soundManager.addSoundGenerator(contactLower_mp3SoundClip);
    model.contactProperty.link(contact => {
      if (contact) {
        contactLower_mp3SoundClip.play();
      }
    });

    // @private {BookRubSoundGenerator} - sound generator for when the books rub together
    this.bookRubSoundGenerator = new BookRubSoundGenerator(model.topBookPositionProperty, model.contactProperty, {
      maxOutputLevel: 0.3
    });
    soundManager.addSoundGenerator(this.bookRubSoundGenerator);

    // @private - add magnifier
    this.magnifierNode = new MagnifierNode(model, 195, 425, chemistryStringProperty, temperatureIncreasingAlerter, temperatureDecreasingAlerter, bookMovementAlerter, grabbedDescriber, alertSettledAndCool, {
      x: 40,
      y: 25,
      layerSplit: true,
      tandem: tandem.createTandem('atomicView')
    });
    this.addChild(this.magnifierNode);

    // add thermometer
    this.addChild(new ThermometerNode(model.vibrationAmplitudeProperty, THERMOMETER_MIN_TEMP, THERMOMETER_MAX_TEMP, {
      x: 690,
      y: 250,
      tubeHeight: 160,
      tickSpacing: 9,
      lineWidth: 1,
      tubeWidth: 12,
      bulbDiameter: 24,
      glassThickness: 3,
      majorTickLength: 4,
      minorTickLength: 4,
      fluidMainColor: THERMOMETER_FLUID_MAIN_COLOR,
      fluidHighlightColor: THERMOMETER_FLUID_HIGHLIGHT_COLOR,
      fluidRightSideColor: THERMOMETER_FLUID_RIGHT_SIDE_COLOR,
      backgroundFill: THERMOMETER_BACKGROUND_FILL_COLOR,
      // phet-io
      tandem: tandem.createTandem('thermometerNode')
    }));

    // pdom
    this.pdomPlayAreaNode.pdomOrder = [chemistryBookNode, this.magnifierNode];

    // add reset button
    const resetAllButton = new ResetAllButton({
      listener: () => {
        model.reset();
        this.reset();
      },
      radius: 22,
      x: model.width * 0.94,
      y: model.height * 0.9,
      tandem: tandem.createTandem('resetAllButton')
    });
    this.addChild(resetAllButton);

    // create and register the sound that will be played to indicate changes to the rate of molecule motion
    soundManager.addSoundGenerator(new MoleculeMotionSoundGenerator(model.vibrationAmplitudeProperty, {
      initialOutputLevel: 0,
      maxOutputLevel: 0.175
    }));

    // create and hook up the sound that is played when molecules break off from the top book
    const breakOffAutosinfonieSpatialized_mp3SoundClip = new SoundClip(breakOffAutosinfonieSpatialized_mp3, {
      initialOutputLevel: 0.05,
      rateChangesAffectPlayingSounds: false
    });
    soundManager.addSoundGenerator(breakOffAutosinfonieSpatialized_mp3SoundClip);
    model.shearedOffEmitter.addListener(() => {
      // don't play for every sheared off atom or it's too noisy
      if (model.numberOfAtomsShearedOffProperty.value % 4 === 0) {
        // set a random playback rate
        breakOffAutosinfonieSpatialized_mp3SoundClip.setPlaybackRate(FrictionConstants.GET_RANDOM_PENTATONIC_PLAYBACK_RATE(), 0);

        // play the sound
        breakOffAutosinfonieSpatialized_mp3SoundClip.play();
      }
    });

    // @private {CoolingSoundGenerator} - sound generator that produces the "cooling off" sound
    this.coolingSoundGenerator = new CoolingSoundGenerator(model.vibrationAmplitudeProperty, {
      maxOutputLevel: 0.75
    });
    soundManager.addSoundGenerator(this.coolingSoundGenerator, {
      sonificationLevel: SoundLevelEnum.EXTRA
    });

    // add a node that creates a "play area" accessible section in the PDOM
    this.pdomControlAreaNode.pdomOrder = [resetAllButton];

    // voicing - Make is so that the Utterances of each Alerter cannot be announced unless the chemistryBookNode
    // is globally visible and voicingVisible in the display
    Voicing.registerUtteranceToNode(temperatureIncreasingAlerter.maxTempUtterance, this);
    Voicing.registerUtteranceToNode(temperatureIncreasingAlerter.temperatureJiggleUtterance, this);
    Voicing.registerUtteranceToNode(temperatureDecreasingAlerter.utterance, this);
    Voicing.registerUtteranceToNode(breakAwayAlerter.utterance, this);
    Voicing.registerUtteranceToNode(bookMovementAlerter.bottomDescriptionUtterance, this);
    Voicing.registerUtteranceToNode(bookMovementAlerter.bottomVoicingUtterance, this);
    Voicing.registerUtteranceToNode(bookMovementAlerter.moveDownToRubHarderUtterance, this);
    Voicing.registerUtteranceToNode(atomsJiggleTinyBitUtterance, this);

    // @private
    this.resetFrictionScreenView = () => {
      // pdom - among other things, this will reset the grab button cuing.
      this.magnifierNode.reset();
      chemistryBookNode.reset();

      // pdom, reset PDOM and reset alerting types
      temperatureDecreasingAlerter.reset();
      temperatureIncreasingAlerter.reset();
      breakAwayAlerter.reset();
      bookMovementAlerter.reset();
      frictionScreenSummaryNode.updateSummaryString();
    };
  }

  /**
   * move forward in time
   * @param {number} dt - delta time, in seconds
   * @public
   */
  step(dt) {
    this.magnifierNode.step(dt);
    this.bookRubSoundGenerator.step(dt);
    this.coolingSoundGenerator.step(dt);
  }

  /**
   * Reset the view
   * @private
   */
  reset() {
    this.resetFrictionScreenView();
  }

  /**
   * To support voicing.
   * @override
   * @public
   */
  getVoicingOverviewContent() {
    return FrictionStrings.a11y.readMeOverview;
  }

  /**
   * To support voicing.
   * @override
   * @public
   */
  getVoicingDetailsContent() {
    return this.frictionScreenSummaryNode.getCurrentDetailsString();
  }

  /**
   * To support voicing.
   * @override
   * @public
   */
  getVoicingHintContent() {
    return this.frictionScreenSummaryNode.getHintString();
  }
}
friction.register('FrictionScreenView', FrictionScreenView);
export default FrictionScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb3VuZHMyIiwiU2NyZWVuVmlldyIsIlJlc2V0QWxsQnV0dG9uIiwiVGhlcm1vbWV0ZXJOb2RlIiwiTm9kZSIsIlZvaWNpbmciLCJTb3VuZENsaXAiLCJTb3VuZExldmVsRW51bSIsInNvdW5kTWFuYWdlciIsIlJlc3BvbnNlUGFja2V0IiwiVXR0ZXJhbmNlIiwiYnJlYWtPZmZBdXRvc2luZm9uaWVTcGF0aWFsaXplZF9tcDMiLCJjb250YWN0TG93ZXJfbXAzIiwiZnJpY3Rpb24iLCJGcmljdGlvblN0cmluZ3MiLCJGcmljdGlvbkNvbnN0YW50cyIsIkZyaWN0aW9uTW9kZWwiLCJCb29rTW92ZW1lbnRBbGVydGVyIiwiQm9va05vZGUiLCJCb29rUnViU291bmRHZW5lcmF0b3IiLCJCcmVha0F3YXlBbGVydGVyIiwiQ29vbGluZ1NvdW5kR2VuZXJhdG9yIiwiRnJpY3Rpb25TY3JlZW5TdW1tYXJ5Tm9kZSIsIkdyYWJiZWREZXNjcmliZXIiLCJNYWduaWZpZXJOb2RlIiwiTW9sZWN1bGVNb3Rpb25Tb3VuZEdlbmVyYXRvciIsIlRlbXBlcmF0dXJlRGVjcmVhc2luZ0FsZXJ0ZXIiLCJUZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyIiwiY2hlbWlzdHJ5U3RyaW5nUHJvcGVydHkiLCJwaHlzaWNzU3RyaW5nUHJvcGVydHkiLCJUSEVSTU9NRVRFUl9GTFVJRF9NQUlOX0NPTE9SIiwiVEhFUk1PTUVURVJfRkxVSURfSElHSExJR0hUX0NPTE9SIiwiVEhFUk1PTUVURVJfRkxVSURfUklHSFRfU0lERV9DT0xPUiIsIlRIRVJNT01FVEVSX0JBQ0tHUk9VTkRfRklMTF9DT0xPUiIsIlRIRVJNT01FVEVSX01JTl9URU1QIiwiVEhFUk1PTUVURVJfTUFYX1RFTVAiLCJGcmljdGlvblNjcmVlblZpZXciLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwidGFuZGVtIiwic2NyZWVuU3VtbWFyeU5vZGVDb250YWluZXIiLCJsYXlvdXRCb3VuZHMiLCJ3aWR0aCIsImhlaWdodCIsInNjcmVlblN1bW1hcnlDb250ZW50IiwiZGVzY3JpcHRpb25BbGVydE5vZGVPcHRpb25zIiwiZGVzY3JpcHRpb25BbGVydE5vZGUiLCJ0ZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyIiwidGVtcGVyYXR1cmVEZWNyZWFzaW5nQWxlcnRlciIsImJyZWFrQXdheUFsZXJ0ZXIiLCJ2aWJyYXRpb25BbXBsaXR1ZGVQcm9wZXJ0eSIsIm51bWJlck9mQXRvbXNTaGVhcmVkT2ZmUHJvcGVydHkiLCJib29rTW92ZW1lbnRBbGVydGVyIiwiZ3JhYmJlZERlc2NyaWJlciIsImNvbnRhY3RQcm9wZXJ0eSIsInN1Y2Nlc3NmdWxseUludGVyYWN0ZWRXaXRoUHJvcGVydHkiLCJhdG9tc0ppZ2dsZVRpbnlCaXRVdHRlcmFuY2UiLCJhbGVydCIsImNvbnRleHRSZXNwb25zZSIsImExMXkiLCJhdG9tc0ppZ2dsZVRpbnlCaXRUZW1wQ29vbCIsImFubm91bmNlck9wdGlvbnMiLCJjYW5jZWxPdGhlciIsImFsZXJ0U2V0dGxlZEFuZENvb2wiLCJoaW50UmVzcG9uc2UiLCJ2YWx1ZSIsIk5VTUJFUl9PRl9TSEVBUkFCTEVfQVRPTVMiLCJyZXNldFNpbU1vcmVPYnNlcnZhdGlvblNlbnRlbmNlIiwiYWxlcnREZXNjcmlwdGlvblV0dGVyYW5jZSIsImFsZXJ0VXR0ZXJhbmNlIiwiYW1wbGl0dWRlSW5jcmVhc2VkRW5vdWdoRm9yU2V0dGxlZEFuZENvb2xBbGVydCIsImxhenlMaW5rIiwiYW1wbGl0dWRlIiwiaW5pdGlhbFZhbHVlIiwicmFuZ2UiLCJleHBhbmROb3JtYWxpemVkVmFsdWUiLCJmcmljdGlvblNjcmVlblN1bW1hcnlOb2RlIiwiYWRkQ2hpbGQiLCJ4IiwieSIsImludGVyYWN0aXZlSGlnaGxpZ2h0IiwiY3JlYXRlVGFuZGVtIiwiY2hlbWlzdHJ5Qm9va05vZGUiLCJjb2xvciIsIlRPUF9CT09LX0NPTE9SX01BQ1JPIiwiZHJhZyIsInBoZXRpb0lucHV0RW5hYmxlZFByb3BlcnR5SW5zdHJ1bWVudGVkIiwiY29udGFjdExvd2VyX21wM1NvdW5kQ2xpcCIsImluaXRpYWxPdXRwdXRMZXZlbCIsImFkZFNvdW5kR2VuZXJhdG9yIiwibGluayIsImNvbnRhY3QiLCJwbGF5IiwiYm9va1J1YlNvdW5kR2VuZXJhdG9yIiwidG9wQm9va1Bvc2l0aW9uUHJvcGVydHkiLCJtYXhPdXRwdXRMZXZlbCIsIm1hZ25pZmllck5vZGUiLCJsYXllclNwbGl0IiwidHViZUhlaWdodCIsInRpY2tTcGFjaW5nIiwibGluZVdpZHRoIiwidHViZVdpZHRoIiwiYnVsYkRpYW1ldGVyIiwiZ2xhc3NUaGlja25lc3MiLCJtYWpvclRpY2tMZW5ndGgiLCJtaW5vclRpY2tMZW5ndGgiLCJmbHVpZE1haW5Db2xvciIsImZsdWlkSGlnaGxpZ2h0Q29sb3IiLCJmbHVpZFJpZ2h0U2lkZUNvbG9yIiwiYmFja2dyb3VuZEZpbGwiLCJwZG9tUGxheUFyZWFOb2RlIiwicGRvbU9yZGVyIiwicmVzZXRBbGxCdXR0b24iLCJsaXN0ZW5lciIsInJlc2V0IiwicmFkaXVzIiwiYnJlYWtPZmZBdXRvc2luZm9uaWVTcGF0aWFsaXplZF9tcDNTb3VuZENsaXAiLCJyYXRlQ2hhbmdlc0FmZmVjdFBsYXlpbmdTb3VuZHMiLCJzaGVhcmVkT2ZmRW1pdHRlciIsImFkZExpc3RlbmVyIiwic2V0UGxheWJhY2tSYXRlIiwiR0VUX1JBTkRPTV9QRU5UQVRPTklDX1BMQVlCQUNLX1JBVEUiLCJjb29saW5nU291bmRHZW5lcmF0b3IiLCJzb25pZmljYXRpb25MZXZlbCIsIkVYVFJBIiwicGRvbUNvbnRyb2xBcmVhTm9kZSIsInJlZ2lzdGVyVXR0ZXJhbmNlVG9Ob2RlIiwibWF4VGVtcFV0dGVyYW5jZSIsInRlbXBlcmF0dXJlSmlnZ2xlVXR0ZXJhbmNlIiwidXR0ZXJhbmNlIiwiYm90dG9tRGVzY3JpcHRpb25VdHRlcmFuY2UiLCJib3R0b21Wb2ljaW5nVXR0ZXJhbmNlIiwibW92ZURvd25Ub1J1YkhhcmRlclV0dGVyYW5jZSIsInJlc2V0RnJpY3Rpb25TY3JlZW5WaWV3IiwidXBkYXRlU3VtbWFyeVN0cmluZyIsInN0ZXAiLCJkdCIsImdldFZvaWNpbmdPdmVydmlld0NvbnRlbnQiLCJyZWFkTWVPdmVydmlldyIsImdldFZvaWNpbmdEZXRhaWxzQ29udGVudCIsImdldEN1cnJlbnREZXRhaWxzU3RyaW5nIiwiZ2V0Vm9pY2luZ0hpbnRDb250ZW50IiwiZ2V0SGludFN0cmluZyIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRnJpY3Rpb25TY3JlZW5WaWV3LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDEzLTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEZyaWN0aW9uJ3MgU2NyZWVuVmlld1xyXG4gKlxyXG4gKiBAYXV0aG9yIEFuZHJleSBaZWxlbmtvdiAoTWxlYXJuZXIpXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY28gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgU2NyZWVuVmlldyBmcm9tICcuLi8uLi8uLi8uLi9qb2lzdC9qcy9TY3JlZW5WaWV3LmpzJztcclxuaW1wb3J0IFJlc2V0QWxsQnV0dG9uIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9idXR0b25zL1Jlc2V0QWxsQnV0dG9uLmpzJztcclxuaW1wb3J0IFRoZXJtb21ldGVyTm9kZSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvVGhlcm1vbWV0ZXJOb2RlLmpzJztcclxuaW1wb3J0IHsgTm9kZSwgVm9pY2luZyB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBTb3VuZENsaXAgZnJvbSAnLi4vLi4vLi4vLi4vdGFtYm8vanMvc291bmQtZ2VuZXJhdG9ycy9Tb3VuZENsaXAuanMnO1xyXG5pbXBvcnQgU291bmRMZXZlbEVudW0gZnJvbSAnLi4vLi4vLi4vLi4vdGFtYm8vanMvU291bmRMZXZlbEVudW0uanMnO1xyXG5pbXBvcnQgc291bmRNYW5hZ2VyIGZyb20gJy4uLy4uLy4uLy4uL3RhbWJvL2pzL3NvdW5kTWFuYWdlci5qcyc7XHJcbmltcG9ydCBSZXNwb25zZVBhY2tldCBmcm9tICcuLi8uLi8uLi8uLi91dHRlcmFuY2UtcXVldWUvanMvUmVzcG9uc2VQYWNrZXQuanMnO1xyXG5pbXBvcnQgVXR0ZXJhbmNlIGZyb20gJy4uLy4uLy4uLy4uL3V0dGVyYW5jZS1xdWV1ZS9qcy9VdHRlcmFuY2UuanMnO1xyXG5pbXBvcnQgYnJlYWtPZmZBdXRvc2luZm9uaWVTcGF0aWFsaXplZF9tcDMgZnJvbSAnLi4vLi4vLi4vc291bmRzL2JyZWFrT2ZmQXV0b3NpbmZvbmllU3BhdGlhbGl6ZWRfbXAzLmpzJztcclxuaW1wb3J0IGNvbnRhY3RMb3dlcl9tcDMgZnJvbSAnLi4vLi4vLi4vc291bmRzL2NvbnRhY3RMb3dlcl9tcDMuanMnO1xyXG5pbXBvcnQgZnJpY3Rpb24gZnJvbSAnLi4vLi4vZnJpY3Rpb24uanMnO1xyXG5pbXBvcnQgRnJpY3Rpb25TdHJpbmdzIGZyb20gJy4uLy4uL0ZyaWN0aW9uU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBGcmljdGlvbkNvbnN0YW50cyBmcm9tICcuLi9GcmljdGlvbkNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBGcmljdGlvbk1vZGVsIGZyb20gJy4uL21vZGVsL0ZyaWN0aW9uTW9kZWwuanMnO1xyXG5pbXBvcnQgQm9va01vdmVtZW50QWxlcnRlciBmcm9tICcuL2Jvb2svQm9va01vdmVtZW50QWxlcnRlci5qcyc7XHJcbmltcG9ydCBCb29rTm9kZSBmcm9tICcuL2Jvb2svQm9va05vZGUuanMnO1xyXG5pbXBvcnQgQm9va1J1YlNvdW5kR2VuZXJhdG9yIGZyb20gJy4vYm9vay9Cb29rUnViU291bmRHZW5lcmF0b3IuanMnO1xyXG5pbXBvcnQgQnJlYWtBd2F5QWxlcnRlciBmcm9tICcuL0JyZWFrQXdheUFsZXJ0ZXIuanMnO1xyXG5pbXBvcnQgQ29vbGluZ1NvdW5kR2VuZXJhdG9yIGZyb20gJy4vQ29vbGluZ1NvdW5kR2VuZXJhdG9yLmpzJztcclxuaW1wb3J0IEZyaWN0aW9uU2NyZWVuU3VtbWFyeU5vZGUgZnJvbSAnLi9GcmljdGlvblNjcmVlblN1bW1hcnlOb2RlLmpzJztcclxuaW1wb3J0IEdyYWJiZWREZXNjcmliZXIgZnJvbSAnLi9HcmFiYmVkRGVzY3JpYmVyLmpzJztcclxuaW1wb3J0IE1hZ25pZmllck5vZGUgZnJvbSAnLi9tYWduaWZpZXIvTWFnbmlmaWVyTm9kZS5qcyc7XHJcbmltcG9ydCBNb2xlY3VsZU1vdGlvblNvdW5kR2VuZXJhdG9yIGZyb20gJy4vTW9sZWN1bGVNb3Rpb25Tb3VuZEdlbmVyYXRvci5qcyc7XHJcbmltcG9ydCBUZW1wZXJhdHVyZURlY3JlYXNpbmdBbGVydGVyIGZyb20gJy4vVGVtcGVyYXR1cmVEZWNyZWFzaW5nQWxlcnRlci5qcyc7XHJcbmltcG9ydCBUZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyIGZyb20gJy4vVGVtcGVyYXR1cmVJbmNyZWFzaW5nQWxlcnRlci5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgY2hlbWlzdHJ5U3RyaW5nUHJvcGVydHkgPSBGcmljdGlvblN0cmluZ3MuY2hlbWlzdHJ5U3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IHBoeXNpY3NTdHJpbmdQcm9wZXJ0eSA9IEZyaWN0aW9uU3RyaW5ncy5waHlzaWNzU3RyaW5nUHJvcGVydHk7XHJcblxyXG5jb25zdCBUSEVSTU9NRVRFUl9GTFVJRF9NQUlOX0NPTE9SID0gJ3JnYigyMzcsMjgsMzYpJztcclxuY29uc3QgVEhFUk1PTUVURVJfRkxVSURfSElHSExJR0hUX0NPTE9SID0gJ3JnYigyNDAsMTUwLDE1MCknO1xyXG5jb25zdCBUSEVSTU9NRVRFUl9GTFVJRF9SSUdIVF9TSURFX0NPTE9SID0gJ3JnYigyMzcsMjgsMzYpJztcclxuY29uc3QgVEhFUk1PTUVURVJfQkFDS0dST1VORF9GSUxMX0NPTE9SID0gJ3doaXRlJztcclxuY29uc3QgVEhFUk1PTUVURVJfTUlOX1RFTVAgPSBGcmljdGlvbk1vZGVsLlRIRVJNT01FVEVSX01JTl9URU1QO1xyXG5jb25zdCBUSEVSTU9NRVRFUl9NQVhfVEVNUCA9IEZyaWN0aW9uTW9kZWwuVEhFUk1PTUVURVJfTUFYX1RFTVA7XHJcblxyXG5cclxuY2xhc3MgRnJpY3Rpb25TY3JlZW5WaWV3IGV4dGVuZHMgU2NyZWVuVmlldyB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7RnJpY3Rpb25Nb2RlbH0gbW9kZWxcclxuICAgKiBAcGFyYW0ge1RhbmRlbX0gdGFuZGVtXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG1vZGVsLCB0YW5kZW0gKSB7XHJcblxyXG4gICAgLy8gVG8gcGFzcyB0byBzdXBlclxyXG4gICAgY29uc3Qgc2NyZWVuU3VtbWFyeU5vZGVDb250YWluZXIgPSBuZXcgTm9kZSgpO1xyXG5cclxuICAgIHN1cGVyKCB7XHJcbiAgICAgIGxheW91dEJvdW5kczogbmV3IEJvdW5kczIoIDAsIDAsIG1vZGVsLndpZHRoLCBtb2RlbC5oZWlnaHQgKSxcclxuICAgICAgc2NyZWVuU3VtbWFyeUNvbnRlbnQ6IHNjcmVlblN1bW1hcnlOb2RlQ29udGFpbmVyLFxyXG4gICAgICB0YW5kZW06IHRhbmRlbVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGRlc2NyaXB0aW9uQWxlcnROb2RlT3B0aW9ucyA9IHtcclxuICAgICAgZGVzY3JpcHRpb25BbGVydE5vZGU6IHRoaXNcclxuICAgIH07XHJcblxyXG4gICAgLy8gcGRvbSAtIGluaXRpYWxpemUgdGhlIGRlc2NyaWJlcnMgZm9yIGF1ZGl0b3J5IGRlc2NyaXB0aW9ucyBhbmQgYWxlcnRzLlxyXG4gICAgY29uc3QgdGVtcGVyYXR1cmVJbmNyZWFzaW5nQWxlcnRlciA9IG5ldyBUZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyKCBtb2RlbCwgZGVzY3JpcHRpb25BbGVydE5vZGVPcHRpb25zICk7XHJcbiAgICBjb25zdCB0ZW1wZXJhdHVyZURlY3JlYXNpbmdBbGVydGVyID0gbmV3IFRlbXBlcmF0dXJlRGVjcmVhc2luZ0FsZXJ0ZXIoIG1vZGVsLCBkZXNjcmlwdGlvbkFsZXJ0Tm9kZU9wdGlvbnMgKTtcclxuICAgIGNvbnN0IGJyZWFrQXdheUFsZXJ0ZXIgPSBuZXcgQnJlYWtBd2F5QWxlcnRlcihcclxuICAgICAgbW9kZWwudmlicmF0aW9uQW1wbGl0dWRlUHJvcGVydHksXHJcbiAgICAgIG1vZGVsLm51bWJlck9mQXRvbXNTaGVhcmVkT2ZmUHJvcGVydHksXHJcbiAgICAgIGRlc2NyaXB0aW9uQWxlcnROb2RlT3B0aW9uc1xyXG4gICAgKTtcclxuICAgIGNvbnN0IGJvb2tNb3ZlbWVudEFsZXJ0ZXIgPSBuZXcgQm9va01vdmVtZW50QWxlcnRlciggbW9kZWwsIGRlc2NyaXB0aW9uQWxlcnROb2RlT3B0aW9ucyApO1xyXG4gICAgY29uc3QgZ3JhYmJlZERlc2NyaWJlciA9IG5ldyBHcmFiYmVkRGVzY3JpYmVyKCBtb2RlbC5jb250YWN0UHJvcGVydHksIG1vZGVsLnN1Y2Nlc3NmdWxseUludGVyYWN0ZWRXaXRoUHJvcGVydHkgKTtcclxuXHJcbiAgICBjb25zdCBhdG9tc0ppZ2dsZVRpbnlCaXRVdHRlcmFuY2UgPSBuZXcgVXR0ZXJhbmNlKCB7XHJcbiAgICAgIGFsZXJ0OiBuZXcgUmVzcG9uc2VQYWNrZXQoIHtcclxuICAgICAgICBjb250ZXh0UmVzcG9uc2U6IEZyaWN0aW9uU3RyaW5ncy5hMTF5LmF0b21zSmlnZ2xlVGlueUJpdFRlbXBDb29sXHJcbiAgICAgIH0gKSxcclxuICAgICAgYW5ub3VuY2VyT3B0aW9uczoge1xyXG4gICAgICAgIGNhbmNlbE90aGVyOiBmYWxzZVxyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgYWxlcnRTZXR0bGVkQW5kQ29vbCA9ICgpID0+IHtcclxuXHJcbiAgICAgIC8vIG9ubHkgYWRkIFwicmVzZXQgc2ltXCIgaGludCB3aGVuIGFsbCBhdG9tcyBoYXZlIHNoZWFyZWQgb2ZmLlxyXG4gICAgICBhdG9tc0ppZ2dsZVRpbnlCaXRVdHRlcmFuY2UuYWxlcnQuaGludFJlc3BvbnNlID0gbW9kZWwubnVtYmVyT2ZBdG9tc1NoZWFyZWRPZmZQcm9wZXJ0eS52YWx1ZSA9PT0gRnJpY3Rpb25Nb2RlbC5OVU1CRVJfT0ZfU0hFQVJBQkxFX0FUT01TID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZyaWN0aW9uU3RyaW5ncy5hMTF5LnJlc2V0U2ltTW9yZU9ic2VydmF0aW9uU2VudGVuY2UgOiBudWxsO1xyXG5cclxuICAgICAgdGhpcy5hbGVydERlc2NyaXB0aW9uVXR0ZXJhbmNlKCBhdG9tc0ppZ2dsZVRpbnlCaXRVdHRlcmFuY2UgKTtcclxuXHJcbiAgICAgIFZvaWNpbmcuYWxlcnRVdHRlcmFuY2UoIGF0b21zSmlnZ2xlVGlueUJpdFV0dGVyYW5jZSApO1xyXG4gICAgfTtcclxuXHJcbiAgICBsZXQgYW1wbGl0dWRlSW5jcmVhc2VkRW5vdWdoRm9yU2V0dGxlZEFuZENvb2xBbGVydCA9IGZhbHNlO1xyXG5cclxuICAgIC8vIGhhbmRsZSB0aGUgXCJzZXR0bGVkIGFuZCBjb29sXCIgYWxlcnQgb25jZSB0ZW1wIGlzIGNvbXBsZXRlbHkgZGVjcmVhc2VkLlxyXG4gICAgLy8gbGF6eUxpbmsgc28gdGhhdCB3ZSBkbyBub3QgaGVhciB0aGUgYWxlcnQgb24gc3RhcnR1cFxyXG4gICAgLy8gZXhpc3RzIGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIHNpbSwgbm8gbmVlZCB0byBkaXNwb3NlXHJcbiAgICBtb2RlbC52aWJyYXRpb25BbXBsaXR1ZGVQcm9wZXJ0eS5sYXp5TGluayggYW1wbGl0dWRlID0+IHtcclxuXHJcbiAgICAgIGlmICggYW1wbGl0dWRlSW5jcmVhc2VkRW5vdWdoRm9yU2V0dGxlZEFuZENvb2xBbGVydCAmJiBhbXBsaXR1ZGUgPT09IG1vZGVsLnZpYnJhdGlvbkFtcGxpdHVkZVByb3BlcnR5LmluaXRpYWxWYWx1ZSApIHtcclxuICAgICAgICBhbGVydFNldHRsZWRBbmRDb29sKCk7XHJcbiAgICAgICAgYW1wbGl0dWRlSW5jcmVhc2VkRW5vdWdoRm9yU2V0dGxlZEFuZENvb2xBbGVydCA9IGZhbHNlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBUaGUgYW1wbGl0dWRlIG11c3QgaW5jcmVhc2UgMSUgb2YgaXRzIHJhbmdlIGJlZm9yZSB0aGUgbmV4dCBzZXR0bGVkIGFuZCBjb29sIGFsZXJ0IGNhbiBiZSB0cmlnZ2VyZWQuXHJcbiAgICAgIGlmICggYW1wbGl0dWRlID49IG1vZGVsLnZpYnJhdGlvbkFtcGxpdHVkZVByb3BlcnR5LnJhbmdlLmV4cGFuZE5vcm1hbGl6ZWRWYWx1ZSggMC4wMSApICkge1xyXG4gICAgICAgIGFtcGxpdHVkZUluY3JlYXNlZEVub3VnaEZvclNldHRsZWRBbmRDb29sQWxlcnQgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gcGRvbVxyXG4gICAgY29uc3QgZnJpY3Rpb25TY3JlZW5TdW1tYXJ5Tm9kZSA9IG5ldyBGcmljdGlvblNjcmVlblN1bW1hcnlOb2RlKFxyXG4gICAgICBtb2RlbC5jb250YWN0UHJvcGVydHksXHJcbiAgICAgIG1vZGVsLm51bWJlck9mQXRvbXNTaGVhcmVkT2ZmUHJvcGVydHksXHJcbiAgICAgIG1vZGVsLnZpYnJhdGlvbkFtcGxpdHVkZVByb3BlcnR5LFxyXG4gICAgICBUSEVSTU9NRVRFUl9NSU5fVEVNUCxcclxuICAgICAgVEhFUk1PTUVURVJfTUFYX1RFTVAsXHJcbiAgICAgIHRlbXBlcmF0dXJlRGVjcmVhc2luZ0FsZXJ0ZXJcclxuICAgICk7XHJcbiAgICBzY3JlZW5TdW1tYXJ5Tm9kZUNvbnRhaW5lci5hZGRDaGlsZCggZnJpY3Rpb25TY3JlZW5TdW1tYXJ5Tm9kZSApO1xyXG5cclxuICAgIC8vIEBwcml2YXRlXHJcbiAgICB0aGlzLmZyaWN0aW9uU2NyZWVuU3VtbWFyeU5vZGUgPSBmcmljdGlvblNjcmVlblN1bW1hcnlOb2RlO1xyXG5cclxuICAgIC8vIGFkZCBwaHlzaWNzIGJvb2tcclxuICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBCb29rTm9kZSggbW9kZWwsIHBoeXNpY3NTdHJpbmdQcm9wZXJ0eSwgdGVtcGVyYXR1cmVJbmNyZWFzaW5nQWxlcnRlciwgdGVtcGVyYXR1cmVEZWNyZWFzaW5nQWxlcnRlcixcclxuICAgICAgYm9va01vdmVtZW50QWxlcnRlciwgZ3JhYmJlZERlc2NyaWJlciwgYWxlcnRTZXR0bGVkQW5kQ29vbCwge1xyXG4gICAgICAgIHg6IDUwLFxyXG4gICAgICAgIHk6IDIyNSxcclxuICAgICAgICBpbnRlcmFjdGl2ZUhpZ2hsaWdodDogJ2ludmlzaWJsZScsXHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnYm90dG9tQm9va05vZGUnIClcclxuICAgICAgfSApICk7XHJcblxyXG4gICAgLy8gYWRkIGNoZW1pc3RyeSBib29rXHJcbiAgICBjb25zdCBjaGVtaXN0cnlCb29rTm9kZSA9IG5ldyBCb29rTm9kZSggbW9kZWwsIGNoZW1pc3RyeVN0cmluZ1Byb3BlcnR5LCB0ZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyLFxyXG4gICAgICB0ZW1wZXJhdHVyZURlY3JlYXNpbmdBbGVydGVyLFxyXG4gICAgICBib29rTW92ZW1lbnRBbGVydGVyLCBncmFiYmVkRGVzY3JpYmVyLCBhbGVydFNldHRsZWRBbmRDb29sLCB7XHJcbiAgICAgICAgeDogNjUsXHJcbiAgICAgICAgeTogMjA5LFxyXG4gICAgICAgIGNvbG9yOiBGcmljdGlvbkNvbnN0YW50cy5UT1BfQk9PS19DT0xPUl9NQUNSTyxcclxuICAgICAgICBkcmFnOiB0cnVlLFxyXG5cclxuICAgICAgICAvLyBwaGV0LWlvXHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAndG9wQm9va05vZGUnICksXHJcbiAgICAgICAgcGhldGlvSW5wdXRFbmFibGVkUHJvcGVydHlJbnN0cnVtZW50ZWQ6IHRydWVcclxuICAgICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggY2hlbWlzdHJ5Qm9va05vZGUgKTtcclxuXHJcbiAgICAvLyBjcmVhdGUgYW5kIGhvb2sgdXAgdGhlIHNvdW5kIHRoYXQgd2lsbCBiZSBwcm9kdWNlZCB3aGVuIHRoZSBib29rcyBjb21lIGludG8gY29udGFjdCB3aXRoIG9uZSBhbm90aGVyXHJcbiAgICBjb25zdCBjb250YWN0TG93ZXJfbXAzU291bmRDbGlwID0gbmV3IFNvdW5kQ2xpcCggY29udGFjdExvd2VyX21wMywgeyBpbml0aWFsT3V0cHV0TGV2ZWw6IDAuMDYgfSApO1xyXG4gICAgc291bmRNYW5hZ2VyLmFkZFNvdW5kR2VuZXJhdG9yKCBjb250YWN0TG93ZXJfbXAzU291bmRDbGlwICk7XHJcbiAgICBtb2RlbC5jb250YWN0UHJvcGVydHkubGluayggY29udGFjdCA9PiB7XHJcbiAgICAgIGlmICggY29udGFjdCApIHtcclxuICAgICAgICBjb250YWN0TG93ZXJfbXAzU291bmRDbGlwLnBsYXkoKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEBwcml2YXRlIHtCb29rUnViU291bmRHZW5lcmF0b3J9IC0gc291bmQgZ2VuZXJhdG9yIGZvciB3aGVuIHRoZSBib29rcyBydWIgdG9nZXRoZXJcclxuICAgIHRoaXMuYm9va1J1YlNvdW5kR2VuZXJhdG9yID0gbmV3IEJvb2tSdWJTb3VuZEdlbmVyYXRvciggbW9kZWwudG9wQm9va1Bvc2l0aW9uUHJvcGVydHksIG1vZGVsLmNvbnRhY3RQcm9wZXJ0eSwge1xyXG4gICAgICBtYXhPdXRwdXRMZXZlbDogMC4zXHJcbiAgICB9ICk7XHJcbiAgICBzb3VuZE1hbmFnZXIuYWRkU291bmRHZW5lcmF0b3IoIHRoaXMuYm9va1J1YlNvdW5kR2VuZXJhdG9yICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUgLSBhZGQgbWFnbmlmaWVyXHJcbiAgICB0aGlzLm1hZ25pZmllck5vZGUgPSBuZXcgTWFnbmlmaWVyTm9kZSggbW9kZWwsIDE5NSwgNDI1LCBjaGVtaXN0cnlTdHJpbmdQcm9wZXJ0eSwgdGVtcGVyYXR1cmVJbmNyZWFzaW5nQWxlcnRlcixcclxuICAgICAgdGVtcGVyYXR1cmVEZWNyZWFzaW5nQWxlcnRlcixcclxuICAgICAgYm9va01vdmVtZW50QWxlcnRlciwgZ3JhYmJlZERlc2NyaWJlciwgYWxlcnRTZXR0bGVkQW5kQ29vbCwge1xyXG4gICAgICAgIHg6IDQwLFxyXG4gICAgICAgIHk6IDI1LFxyXG4gICAgICAgIGxheWVyU3BsaXQ6IHRydWUsXHJcblxyXG4gICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2F0b21pY1ZpZXcnIClcclxuICAgICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5tYWduaWZpZXJOb2RlICk7XHJcblxyXG4gICAgLy8gYWRkIHRoZXJtb21ldGVyXHJcbiAgICB0aGlzLmFkZENoaWxkKCBuZXcgVGhlcm1vbWV0ZXJOb2RlKCBtb2RlbC52aWJyYXRpb25BbXBsaXR1ZGVQcm9wZXJ0eSwgVEhFUk1PTUVURVJfTUlOX1RFTVAsIFRIRVJNT01FVEVSX01BWF9URU1QLCB7XHJcbiAgICAgIHg6IDY5MCxcclxuICAgICAgeTogMjUwLFxyXG4gICAgICB0dWJlSGVpZ2h0OiAxNjAsXHJcbiAgICAgIHRpY2tTcGFjaW5nOiA5LFxyXG4gICAgICBsaW5lV2lkdGg6IDEsXHJcbiAgICAgIHR1YmVXaWR0aDogMTIsXHJcbiAgICAgIGJ1bGJEaWFtZXRlcjogMjQsXHJcbiAgICAgIGdsYXNzVGhpY2tuZXNzOiAzLFxyXG4gICAgICBtYWpvclRpY2tMZW5ndGg6IDQsXHJcbiAgICAgIG1pbm9yVGlja0xlbmd0aDogNCxcclxuICAgICAgZmx1aWRNYWluQ29sb3I6IFRIRVJNT01FVEVSX0ZMVUlEX01BSU5fQ09MT1IsXHJcbiAgICAgIGZsdWlkSGlnaGxpZ2h0Q29sb3I6IFRIRVJNT01FVEVSX0ZMVUlEX0hJR0hMSUdIVF9DT0xPUixcclxuICAgICAgZmx1aWRSaWdodFNpZGVDb2xvcjogVEhFUk1PTUVURVJfRkxVSURfUklHSFRfU0lERV9DT0xPUixcclxuICAgICAgYmFja2dyb3VuZEZpbGw6IFRIRVJNT01FVEVSX0JBQ0tHUk9VTkRfRklMTF9DT0xPUixcclxuXHJcbiAgICAgIC8vIHBoZXQtaW9cclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAndGhlcm1vbWV0ZXJOb2RlJyApXHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBwZG9tXHJcbiAgICB0aGlzLnBkb21QbGF5QXJlYU5vZGUucGRvbU9yZGVyID0gWyBjaGVtaXN0cnlCb29rTm9kZSwgdGhpcy5tYWduaWZpZXJOb2RlIF07XHJcblxyXG4gICAgLy8gYWRkIHJlc2V0IGJ1dHRvblxyXG4gICAgY29uc3QgcmVzZXRBbGxCdXR0b24gPSBuZXcgUmVzZXRBbGxCdXR0b24oIHtcclxuICAgICAgbGlzdGVuZXI6ICgpID0+IHtcclxuICAgICAgICBtb2RlbC5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgICAgfSxcclxuICAgICAgcmFkaXVzOiAyMixcclxuICAgICAgeDogbW9kZWwud2lkdGggKiAwLjk0LFxyXG4gICAgICB5OiBtb2RlbC5oZWlnaHQgKiAwLjksXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3Jlc2V0QWxsQnV0dG9uJyApXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCByZXNldEFsbEJ1dHRvbiApO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBhbmQgcmVnaXN0ZXIgdGhlIHNvdW5kIHRoYXQgd2lsbCBiZSBwbGF5ZWQgdG8gaW5kaWNhdGUgY2hhbmdlcyB0byB0aGUgcmF0ZSBvZiBtb2xlY3VsZSBtb3Rpb25cclxuICAgIHNvdW5kTWFuYWdlci5hZGRTb3VuZEdlbmVyYXRvciggbmV3IE1vbGVjdWxlTW90aW9uU291bmRHZW5lcmF0b3IoIG1vZGVsLnZpYnJhdGlvbkFtcGxpdHVkZVByb3BlcnR5LCB7XHJcbiAgICAgIGluaXRpYWxPdXRwdXRMZXZlbDogMCxcclxuICAgICAgbWF4T3V0cHV0TGV2ZWw6IDAuMTc1XHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBjcmVhdGUgYW5kIGhvb2sgdXAgdGhlIHNvdW5kIHRoYXQgaXMgcGxheWVkIHdoZW4gbW9sZWN1bGVzIGJyZWFrIG9mZiBmcm9tIHRoZSB0b3AgYm9va1xyXG4gICAgY29uc3QgYnJlYWtPZmZBdXRvc2luZm9uaWVTcGF0aWFsaXplZF9tcDNTb3VuZENsaXAgPSBuZXcgU291bmRDbGlwKCBicmVha09mZkF1dG9zaW5mb25pZVNwYXRpYWxpemVkX21wMywge1xyXG4gICAgICBpbml0aWFsT3V0cHV0TGV2ZWw6IDAuMDUsXHJcbiAgICAgIHJhdGVDaGFuZ2VzQWZmZWN0UGxheWluZ1NvdW5kczogZmFsc2VcclxuICAgIH0gKTtcclxuICAgIHNvdW5kTWFuYWdlci5hZGRTb3VuZEdlbmVyYXRvciggYnJlYWtPZmZBdXRvc2luZm9uaWVTcGF0aWFsaXplZF9tcDNTb3VuZENsaXAgKTtcclxuICAgIG1vZGVsLnNoZWFyZWRPZmZFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiB7XHJcblxyXG4gICAgICAvLyBkb24ndCBwbGF5IGZvciBldmVyeSBzaGVhcmVkIG9mZiBhdG9tIG9yIGl0J3MgdG9vIG5vaXN5XHJcbiAgICAgIGlmICggbW9kZWwubnVtYmVyT2ZBdG9tc1NoZWFyZWRPZmZQcm9wZXJ0eS52YWx1ZSAlIDQgPT09IDAgKSB7XHJcblxyXG4gICAgICAgIC8vIHNldCBhIHJhbmRvbSBwbGF5YmFjayByYXRlXHJcbiAgICAgICAgYnJlYWtPZmZBdXRvc2luZm9uaWVTcGF0aWFsaXplZF9tcDNTb3VuZENsaXAuc2V0UGxheWJhY2tSYXRlKCBGcmljdGlvbkNvbnN0YW50cy5HRVRfUkFORE9NX1BFTlRBVE9OSUNfUExBWUJBQ0tfUkFURSgpLCAwICk7XHJcblxyXG4gICAgICAgIC8vIHBsYXkgdGhlIHNvdW5kXHJcbiAgICAgICAgYnJlYWtPZmZBdXRvc2luZm9uaWVTcGF0aWFsaXplZF9tcDNTb3VuZENsaXAucGxheSgpO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge0Nvb2xpbmdTb3VuZEdlbmVyYXRvcn0gLSBzb3VuZCBnZW5lcmF0b3IgdGhhdCBwcm9kdWNlcyB0aGUgXCJjb29saW5nIG9mZlwiIHNvdW5kXHJcbiAgICB0aGlzLmNvb2xpbmdTb3VuZEdlbmVyYXRvciA9IG5ldyBDb29saW5nU291bmRHZW5lcmF0b3IoIG1vZGVsLnZpYnJhdGlvbkFtcGxpdHVkZVByb3BlcnR5LCB7XHJcbiAgICAgIG1heE91dHB1dExldmVsOiAwLjc1XHJcbiAgICB9ICk7XHJcbiAgICBzb3VuZE1hbmFnZXIuYWRkU291bmRHZW5lcmF0b3IoIHRoaXMuY29vbGluZ1NvdW5kR2VuZXJhdG9yLCB7XHJcbiAgICAgIHNvbmlmaWNhdGlvbkxldmVsOiBTb3VuZExldmVsRW51bS5FWFRSQVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGFkZCBhIG5vZGUgdGhhdCBjcmVhdGVzIGEgXCJwbGF5IGFyZWFcIiBhY2Nlc3NpYmxlIHNlY3Rpb24gaW4gdGhlIFBET01cclxuICAgIHRoaXMucGRvbUNvbnRyb2xBcmVhTm9kZS5wZG9tT3JkZXIgPSBbIHJlc2V0QWxsQnV0dG9uIF07XHJcblxyXG4gICAgLy8gdm9pY2luZyAtIE1ha2UgaXMgc28gdGhhdCB0aGUgVXR0ZXJhbmNlcyBvZiBlYWNoIEFsZXJ0ZXIgY2Fubm90IGJlIGFubm91bmNlZCB1bmxlc3MgdGhlIGNoZW1pc3RyeUJvb2tOb2RlXHJcbiAgICAvLyBpcyBnbG9iYWxseSB2aXNpYmxlIGFuZCB2b2ljaW5nVmlzaWJsZSBpbiB0aGUgZGlzcGxheVxyXG4gICAgVm9pY2luZy5yZWdpc3RlclV0dGVyYW5jZVRvTm9kZSggdGVtcGVyYXR1cmVJbmNyZWFzaW5nQWxlcnRlci5tYXhUZW1wVXR0ZXJhbmNlLCB0aGlzICk7XHJcbiAgICBWb2ljaW5nLnJlZ2lzdGVyVXR0ZXJhbmNlVG9Ob2RlKCB0ZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyLnRlbXBlcmF0dXJlSmlnZ2xlVXR0ZXJhbmNlLCB0aGlzICk7XHJcbiAgICBWb2ljaW5nLnJlZ2lzdGVyVXR0ZXJhbmNlVG9Ob2RlKCB0ZW1wZXJhdHVyZURlY3JlYXNpbmdBbGVydGVyLnV0dGVyYW5jZSwgdGhpcyApO1xyXG4gICAgVm9pY2luZy5yZWdpc3RlclV0dGVyYW5jZVRvTm9kZSggYnJlYWtBd2F5QWxlcnRlci51dHRlcmFuY2UsIHRoaXMgKTtcclxuICAgIFZvaWNpbmcucmVnaXN0ZXJVdHRlcmFuY2VUb05vZGUoIGJvb2tNb3ZlbWVudEFsZXJ0ZXIuYm90dG9tRGVzY3JpcHRpb25VdHRlcmFuY2UsIHRoaXMgKTtcclxuICAgIFZvaWNpbmcucmVnaXN0ZXJVdHRlcmFuY2VUb05vZGUoIGJvb2tNb3ZlbWVudEFsZXJ0ZXIuYm90dG9tVm9pY2luZ1V0dGVyYW5jZSwgdGhpcyApO1xyXG4gICAgVm9pY2luZy5yZWdpc3RlclV0dGVyYW5jZVRvTm9kZSggYm9va01vdmVtZW50QWxlcnRlci5tb3ZlRG93blRvUnViSGFyZGVyVXR0ZXJhbmNlLCB0aGlzICk7XHJcbiAgICBWb2ljaW5nLnJlZ2lzdGVyVXR0ZXJhbmNlVG9Ob2RlKCBhdG9tc0ppZ2dsZVRpbnlCaXRVdHRlcmFuY2UsIHRoaXMgKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZVxyXG4gICAgdGhpcy5yZXNldEZyaWN0aW9uU2NyZWVuVmlldyA9ICgpID0+IHtcclxuXHJcbiAgICAgIC8vIHBkb20gLSBhbW9uZyBvdGhlciB0aGluZ3MsIHRoaXMgd2lsbCByZXNldCB0aGUgZ3JhYiBidXR0b24gY3VpbmcuXHJcbiAgICAgIHRoaXMubWFnbmlmaWVyTm9kZS5yZXNldCgpO1xyXG4gICAgICBjaGVtaXN0cnlCb29rTm9kZS5yZXNldCgpO1xyXG5cclxuICAgICAgLy8gcGRvbSwgcmVzZXQgUERPTSBhbmQgcmVzZXQgYWxlcnRpbmcgdHlwZXNcclxuICAgICAgdGVtcGVyYXR1cmVEZWNyZWFzaW5nQWxlcnRlci5yZXNldCgpO1xyXG4gICAgICB0ZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyLnJlc2V0KCk7XHJcbiAgICAgIGJyZWFrQXdheUFsZXJ0ZXIucmVzZXQoKTtcclxuICAgICAgYm9va01vdmVtZW50QWxlcnRlci5yZXNldCgpO1xyXG4gICAgICBmcmljdGlvblNjcmVlblN1bW1hcnlOb2RlLnVwZGF0ZVN1bW1hcnlTdHJpbmcoKTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBtb3ZlIGZvcndhcmQgaW4gdGltZVxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkdCAtIGRlbHRhIHRpbWUsIGluIHNlY29uZHNcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgc3RlcCggZHQgKSB7XHJcbiAgICB0aGlzLm1hZ25pZmllck5vZGUuc3RlcCggZHQgKTtcclxuICAgIHRoaXMuYm9va1J1YlNvdW5kR2VuZXJhdG9yLnN0ZXAoIGR0ICk7XHJcbiAgICB0aGlzLmNvb2xpbmdTb3VuZEdlbmVyYXRvci5zdGVwKCBkdCApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzZXQgdGhlIHZpZXdcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIHJlc2V0KCkge1xyXG4gICAgdGhpcy5yZXNldEZyaWN0aW9uU2NyZWVuVmlldygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVG8gc3VwcG9ydCB2b2ljaW5nLlxyXG4gICAqIEBvdmVycmlkZVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBnZXRWb2ljaW5nT3ZlcnZpZXdDb250ZW50KCkge1xyXG4gICAgcmV0dXJuIEZyaWN0aW9uU3RyaW5ncy5hMTF5LnJlYWRNZU92ZXJ2aWV3O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVG8gc3VwcG9ydCB2b2ljaW5nLlxyXG4gICAqIEBvdmVycmlkZVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBnZXRWb2ljaW5nRGV0YWlsc0NvbnRlbnQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5mcmljdGlvblNjcmVlblN1bW1hcnlOb2RlLmdldEN1cnJlbnREZXRhaWxzU3RyaW5nKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUbyBzdXBwb3J0IHZvaWNpbmcuXHJcbiAgICogQG92ZXJyaWRlXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIGdldFZvaWNpbmdIaW50Q29udGVudCgpIHtcclxuICAgIHJldHVybiB0aGlzLmZyaWN0aW9uU2NyZWVuU3VtbWFyeU5vZGUuZ2V0SGludFN0cmluZygpO1xyXG4gIH1cclxufVxyXG5cclxuZnJpY3Rpb24ucmVnaXN0ZXIoICdGcmljdGlvblNjcmVlblZpZXcnLCBGcmljdGlvblNjcmVlblZpZXcgKTtcclxuZXhwb3J0IGRlZmF1bHQgRnJpY3Rpb25TY3JlZW5WaWV3OyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxVQUFVLE1BQU0sb0NBQW9DO0FBQzNELE9BQU9DLGNBQWMsTUFBTSx1REFBdUQ7QUFDbEYsT0FBT0MsZUFBZSxNQUFNLGdEQUFnRDtBQUM1RSxTQUFTQyxJQUFJLEVBQUVDLE9BQU8sUUFBUSxtQ0FBbUM7QUFDakUsT0FBT0MsU0FBUyxNQUFNLG9EQUFvRDtBQUMxRSxPQUFPQyxjQUFjLE1BQU0sd0NBQXdDO0FBQ25FLE9BQU9DLFlBQVksTUFBTSxzQ0FBc0M7QUFDL0QsT0FBT0MsY0FBYyxNQUFNLGtEQUFrRDtBQUM3RSxPQUFPQyxTQUFTLE1BQU0sNkNBQTZDO0FBQ25FLE9BQU9DLG1DQUFtQyxNQUFNLHdEQUF3RDtBQUN4RyxPQUFPQyxn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