// Copyright 2013-2022, University of Colorado Boulder

/**
 * Displays a single macroscopic book.
 *
 * @author Andrey Zelenkov (Mlearner)
 * @author John Blanco (PhET Interactive Simulations)
 * @author Sam Reid (PhET Interactive Simulations)
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */
import Vector2 from '../../../../../dot/js/Vector2.js';
import { Shape } from '../../../../../kite/js/imports.js';
import merge from '../../../../../phet-core/js/merge.js';
import ModelViewTransform2 from '../../../../../phetcommon/js/view/ModelViewTransform2.js';
import { FocusHighlightPath, Node, Voicing } from '../../../../../scenery/js/imports.js';
import SoundClip from '../../../../../tambo/js/sound-generators/SoundClip.js';
import soundManager from '../../../../../tambo/js/soundManager.js';
import Tandem from '../../../../../tandem/js/Tandem.js';
import simpleDrop_mp3 from '../../../../sounds/simpleDrop_mp3.js';
import simplePickup_mp3 from '../../../../sounds/simplePickup_mp3.js';
import friction from '../../../friction.js';
import FrictionStrings from '../../../FrictionStrings.js';
import FrictionConstants from '../../FrictionConstants.js';
import CueArrow from '../CueArrow.js';
import FrictionDragListener from '../FrictionDragListener.js';
import FrictionGrabDragInteraction from '../FrictionGrabDragInteraction.js';
import FrictionKeyboardDragListener from '../FrictionKeyboardDragListener.js';
import CoverNode from './CoverNode.js';

// constants
const chemistryBookString = FrictionStrings.a11y.chemistryBook;
const grabButtonHelpTextString = FrictionStrings.a11y.grabButtonHelpText;
const SOUND_LEVEL = 0.1;
class BookNode extends Voicing(Node) {
  /**
   * @param {FrictionModel} model
   * @param {string} title - title that appears on the book spine
   * @param {TemperatureIncreasingAlerter} temperatureIncreasingAlerter
   * @param {TemperatureDecreasingAlerter} temperatureDecreasingAlerter
   * @param {BookMovementAlerter} bookMovementAlerter
   * @param {GrabbedDescriber} grabbedDescriber
   * @param {function():} alertSettledAndCool
   * @param {Object} [options]
   */
  constructor(model, title, temperatureIncreasingAlerter, temperatureDecreasingAlerter, bookMovementAlerter, grabbedDescriber, alertSettledAndCool, options) {
    options = merge({
      // whether or not we can drag the book
      drag: false,
      color: FrictionConstants.BOTTOM_BOOK_COLOR_MACRO,
      // voicing
      voicingNameResponse: chemistryBookString,
      // phet-io
      tandem: Tandem.REQUIRED,
      phetioVisiblePropertyInstrumented: false
    }, options);
    assert && assert(typeof options.x === 'number', 'options.x must be specified');
    assert && assert(typeof options.y === 'number', 'options.y must be specified');
    super(options);

    // add cover, pass the whole tandem to hide the "cover" implementation detail
    this.addChild(new CoverNode(title, options.tandem, _.omit(options, ['tandem'])));

    // init drag and a11y options for the draggable book
    if (options.drag) {
      // a11y - We want the highlights to be completely within the bounds of the book.
      const focusHighlightRect = new FocusHighlightPath(null);
      const highlightLineWidth = focusHighlightRect.getOuterLineWidth(this);
      const highlightShape = Shape.bounds(this.localBounds.eroded(highlightLineWidth / 2));
      focusHighlightRect.setShape(highlightShape);
      const interactiveHighlightRect = new FocusHighlightPath(null);
      interactiveHighlightRect.setShape(highlightShape);

      // cuing arrows for the book
      const bookCueArrow1 = new CueArrow({
        rotation: Math.PI,
        right: -10,
        scale: 0.7
      });
      const bookCueArrow2 = new CueArrow({
        left: this.width + 12,
        scale: 0.7
      });
      const bookCueArrow3 = new CueArrow({
        rotation: Math.PI / 2,
        centerX: this.width / 2,
        y: this.height / 2 + 10,
        // a little further down on the screen, empirical
        scale: 0.7
      });
      const arrows = new Node({
        children: [bookCueArrow1, bookCueArrow2, bookCueArrow3]
      });

      // sounds used when the book is picked up or dropped
      const bookPickupSoundClip = new SoundClip(simplePickup_mp3, {
        initialOutputLevel: SOUND_LEVEL
      });
      soundManager.addSoundGenerator(bookPickupSoundClip);
      const bookDropSoundClip = new SoundClip(simpleDrop_mp3, {
        initialOutputLevel: SOUND_LEVEL
      });
      soundManager.addSoundGenerator(bookDropSoundClip);

      // pdom - add a keyboard drag handler
      this.keyboardDragListener = new FrictionKeyboardDragListener(model, temperatureIncreasingAlerter, temperatureDecreasingAlerter, bookMovementAlerter, {
        tandem: options.tandem.createTandem('keyboardDragListener')
      });

      // highlights must be added prior to adding the grab/drag interaction, this is a constraint of GrabDragInteraction
      this.addChild(focusHighlightRect);
      this.focusHighlight = focusHighlightRect;
      this.addChild(interactiveHighlightRect);
      this.interactiveHighlight = interactiveHighlightRect;
      this.focusHighlightLayerable = true;
      this.interactiveHighlightLayerable = true;

      // @private - a11y
      this.grabDragInteraction = new FrictionGrabDragInteraction(model, this.keyboardDragListener, this, grabbedDescriber, alertSettledAndCool, {
        objectToGrabString: chemistryBookString,
        // Empirically determined values to place the cue above the book.
        grabCueOptions: {
          x: 45,
          y: -60
        },
        grabbableOptions: {
          focusHighlight: focusHighlightRect
        },
        keyboardHelpText: grabButtonHelpTextString,
        onGrab: () => {
          bookPickupSoundClip.play();
        },
        onRelease: () => {
          bookDropSoundClip.play();
        },
        dragCueNode: arrows,
        tandem: options.tandem.createTandem('grabDragInteraction')
      });
      this.addInputListener(new FrictionDragListener(model, temperatureIncreasingAlerter, temperatureDecreasingAlerter, bookMovementAlerter, {
        tandem: options.tandem.createTandem('dragListener'),
        startSound: bookPickupSoundClip,
        endSound: bookDropSoundClip,
        targetNode: this,
        startDrag: () => this.voicingSpeakFullResponse({
          objectResponse: grabbedDescriber.getVoicingGrabbedObjectResponse()
        })
      }));

      // This transform uses the assumption that model coords and the magnified view are in the same coordinate frame,
      // and that it's origin is zero, and that the BookNode is positioned with x/y options.
      const transform = ModelViewTransform2.createSinglePointScaleMapping(Vector2.ZERO, new Vector2(options.x, options.y), model.bookDraggingScaleFactor);

      // add observer
      model.topBookPositionProperty.link(position => {
        this.setTranslation(transform.transformPosition2(position));
      });
      this.inputEnabledProperty.link(inputEnabled => {
        this.grabDragInteraction.enabled = inputEnabled;
      });
      this.cursor = 'pointer';
    }
  }

  /**
   * @public
   */
  reset() {
    this.grabDragInteraction.reset();
  }
}
friction.register('BookNode', BookNode);
export default BookNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWZWN0b3IyIiwiU2hhcGUiLCJtZXJnZSIsIk1vZGVsVmlld1RyYW5zZm9ybTIiLCJGb2N1c0hpZ2hsaWdodFBhdGgiLCJOb2RlIiwiVm9pY2luZyIsIlNvdW5kQ2xpcCIsInNvdW5kTWFuYWdlciIsIlRhbmRlbSIsInNpbXBsZURyb3BfbXAzIiwic2ltcGxlUGlja3VwX21wMyIsImZyaWN0aW9uIiwiRnJpY3Rpb25TdHJpbmdzIiwiRnJpY3Rpb25Db25zdGFudHMiLCJDdWVBcnJvdyIsIkZyaWN0aW9uRHJhZ0xpc3RlbmVyIiwiRnJpY3Rpb25HcmFiRHJhZ0ludGVyYWN0aW9uIiwiRnJpY3Rpb25LZXlib2FyZERyYWdMaXN0ZW5lciIsIkNvdmVyTm9kZSIsImNoZW1pc3RyeUJvb2tTdHJpbmciLCJhMTF5IiwiY2hlbWlzdHJ5Qm9vayIsImdyYWJCdXR0b25IZWxwVGV4dFN0cmluZyIsImdyYWJCdXR0b25IZWxwVGV4dCIsIlNPVU5EX0xFVkVMIiwiQm9va05vZGUiLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwidGl0bGUiLCJ0ZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyIiwidGVtcGVyYXR1cmVEZWNyZWFzaW5nQWxlcnRlciIsImJvb2tNb3ZlbWVudEFsZXJ0ZXIiLCJncmFiYmVkRGVzY3JpYmVyIiwiYWxlcnRTZXR0bGVkQW5kQ29vbCIsIm9wdGlvbnMiLCJkcmFnIiwiY29sb3IiLCJCT1RUT01fQk9PS19DT0xPUl9NQUNSTyIsInZvaWNpbmdOYW1lUmVzcG9uc2UiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsInBoZXRpb1Zpc2libGVQcm9wZXJ0eUluc3RydW1lbnRlZCIsImFzc2VydCIsIngiLCJ5IiwiYWRkQ2hpbGQiLCJfIiwib21pdCIsImZvY3VzSGlnaGxpZ2h0UmVjdCIsImhpZ2hsaWdodExpbmVXaWR0aCIsImdldE91dGVyTGluZVdpZHRoIiwiaGlnaGxpZ2h0U2hhcGUiLCJib3VuZHMiLCJsb2NhbEJvdW5kcyIsImVyb2RlZCIsInNldFNoYXBlIiwiaW50ZXJhY3RpdmVIaWdobGlnaHRSZWN0IiwiYm9va0N1ZUFycm93MSIsInJvdGF0aW9uIiwiTWF0aCIsIlBJIiwicmlnaHQiLCJzY2FsZSIsImJvb2tDdWVBcnJvdzIiLCJsZWZ0Iiwid2lkdGgiLCJib29rQ3VlQXJyb3czIiwiY2VudGVyWCIsImhlaWdodCIsImFycm93cyIsImNoaWxkcmVuIiwiYm9va1BpY2t1cFNvdW5kQ2xpcCIsImluaXRpYWxPdXRwdXRMZXZlbCIsImFkZFNvdW5kR2VuZXJhdG9yIiwiYm9va0Ryb3BTb3VuZENsaXAiLCJrZXlib2FyZERyYWdMaXN0ZW5lciIsImNyZWF0ZVRhbmRlbSIsImZvY3VzSGlnaGxpZ2h0IiwiaW50ZXJhY3RpdmVIaWdobGlnaHQiLCJmb2N1c0hpZ2hsaWdodExheWVyYWJsZSIsImludGVyYWN0aXZlSGlnaGxpZ2h0TGF5ZXJhYmxlIiwiZ3JhYkRyYWdJbnRlcmFjdGlvbiIsIm9iamVjdFRvR3JhYlN0cmluZyIsImdyYWJDdWVPcHRpb25zIiwiZ3JhYmJhYmxlT3B0aW9ucyIsImtleWJvYXJkSGVscFRleHQiLCJvbkdyYWIiLCJwbGF5Iiwib25SZWxlYXNlIiwiZHJhZ0N1ZU5vZGUiLCJhZGRJbnB1dExpc3RlbmVyIiwic3RhcnRTb3VuZCIsImVuZFNvdW5kIiwidGFyZ2V0Tm9kZSIsInN0YXJ0RHJhZyIsInZvaWNpbmdTcGVha0Z1bGxSZXNwb25zZSIsIm9iamVjdFJlc3BvbnNlIiwiZ2V0Vm9pY2luZ0dyYWJiZWRPYmplY3RSZXNwb25zZSIsInRyYW5zZm9ybSIsImNyZWF0ZVNpbmdsZVBvaW50U2NhbGVNYXBwaW5nIiwiWkVSTyIsImJvb2tEcmFnZ2luZ1NjYWxlRmFjdG9yIiwidG9wQm9va1Bvc2l0aW9uUHJvcGVydHkiLCJsaW5rIiwicG9zaXRpb24iLCJzZXRUcmFuc2xhdGlvbiIsInRyYW5zZm9ybVBvc2l0aW9uMiIsImlucHV0RW5hYmxlZFByb3BlcnR5IiwiaW5wdXRFbmFibGVkIiwiZW5hYmxlZCIsImN1cnNvciIsInJlc2V0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJCb29rTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBEaXNwbGF5cyBhIHNpbmdsZSBtYWNyb3Njb3BpYyBib29rLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEFuZHJleSBaZWxlbmtvdiAoTWxlYXJuZXIpXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY28gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgTWljaGFlbCBLYXV6bWFubiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgeyBGb2N1c0hpZ2hsaWdodFBhdGgsIE5vZGUsIFZvaWNpbmcgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgU291bmRDbGlwIGZyb20gJy4uLy4uLy4uLy4uLy4uL3RhbWJvL2pzL3NvdW5kLWdlbmVyYXRvcnMvU291bmRDbGlwLmpzJztcclxuaW1wb3J0IHNvdW5kTWFuYWdlciBmcm9tICcuLi8uLi8uLi8uLi8uLi90YW1iby9qcy9zb3VuZE1hbmFnZXIuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgc2ltcGxlRHJvcF9tcDMgZnJvbSAnLi4vLi4vLi4vLi4vc291bmRzL3NpbXBsZURyb3BfbXAzLmpzJztcclxuaW1wb3J0IHNpbXBsZVBpY2t1cF9tcDMgZnJvbSAnLi4vLi4vLi4vLi4vc291bmRzL3NpbXBsZVBpY2t1cF9tcDMuanMnO1xyXG5pbXBvcnQgZnJpY3Rpb24gZnJvbSAnLi4vLi4vLi4vZnJpY3Rpb24uanMnO1xyXG5pbXBvcnQgRnJpY3Rpb25TdHJpbmdzIGZyb20gJy4uLy4uLy4uL0ZyaWN0aW9uU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBGcmljdGlvbkNvbnN0YW50cyBmcm9tICcuLi8uLi9GcmljdGlvbkNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBDdWVBcnJvdyBmcm9tICcuLi9DdWVBcnJvdy5qcyc7XHJcbmltcG9ydCBGcmljdGlvbkRyYWdMaXN0ZW5lciBmcm9tICcuLi9GcmljdGlvbkRyYWdMaXN0ZW5lci5qcyc7XHJcbmltcG9ydCBGcmljdGlvbkdyYWJEcmFnSW50ZXJhY3Rpb24gZnJvbSAnLi4vRnJpY3Rpb25HcmFiRHJhZ0ludGVyYWN0aW9uLmpzJztcclxuaW1wb3J0IEZyaWN0aW9uS2V5Ym9hcmREcmFnTGlzdGVuZXIgZnJvbSAnLi4vRnJpY3Rpb25LZXlib2FyZERyYWdMaXN0ZW5lci5qcyc7XHJcbmltcG9ydCBDb3Zlck5vZGUgZnJvbSAnLi9Db3Zlck5vZGUuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IGNoZW1pc3RyeUJvb2tTdHJpbmcgPSBGcmljdGlvblN0cmluZ3MuYTExeS5jaGVtaXN0cnlCb29rO1xyXG5jb25zdCBncmFiQnV0dG9uSGVscFRleHRTdHJpbmcgPSBGcmljdGlvblN0cmluZ3MuYTExeS5ncmFiQnV0dG9uSGVscFRleHQ7XHJcblxyXG5jb25zdCBTT1VORF9MRVZFTCA9IDAuMTtcclxuXHJcbmNsYXNzIEJvb2tOb2RlIGV4dGVuZHMgVm9pY2luZyggTm9kZSApIHtcclxuICAvKipcclxuICAgKiBAcGFyYW0ge0ZyaWN0aW9uTW9kZWx9IG1vZGVsXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlIC0gdGl0bGUgdGhhdCBhcHBlYXJzIG9uIHRoZSBib29rIHNwaW5lXHJcbiAgICogQHBhcmFtIHtUZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyfSB0ZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyXHJcbiAgICogQHBhcmFtIHtUZW1wZXJhdHVyZURlY3JlYXNpbmdBbGVydGVyfSB0ZW1wZXJhdHVyZURlY3JlYXNpbmdBbGVydGVyXHJcbiAgICogQHBhcmFtIHtCb29rTW92ZW1lbnRBbGVydGVyfSBib29rTW92ZW1lbnRBbGVydGVyXHJcbiAgICogQHBhcmFtIHtHcmFiYmVkRGVzY3JpYmVyfSBncmFiYmVkRGVzY3JpYmVyXHJcbiAgICogQHBhcmFtIHtmdW5jdGlvbigpOn0gYWxlcnRTZXR0bGVkQW5kQ29vbFxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbW9kZWwsIHRpdGxlLCB0ZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyLCB0ZW1wZXJhdHVyZURlY3JlYXNpbmdBbGVydGVyLCBib29rTW92ZW1lbnRBbGVydGVyLCBncmFiYmVkRGVzY3JpYmVyLCBhbGVydFNldHRsZWRBbmRDb29sLCBvcHRpb25zICkge1xyXG5cclxuICAgIG9wdGlvbnMgPSBtZXJnZSgge1xyXG5cclxuICAgICAgLy8gd2hldGhlciBvciBub3Qgd2UgY2FuIGRyYWcgdGhlIGJvb2tcclxuICAgICAgZHJhZzogZmFsc2UsXHJcbiAgICAgIGNvbG9yOiBGcmljdGlvbkNvbnN0YW50cy5CT1RUT01fQk9PS19DT0xPUl9NQUNSTyxcclxuXHJcbiAgICAgIC8vIHZvaWNpbmdcclxuICAgICAgdm9pY2luZ05hbWVSZXNwb25zZTogY2hlbWlzdHJ5Qm9va1N0cmluZyxcclxuXHJcbiAgICAgIC8vIHBoZXQtaW9cclxuICAgICAgdGFuZGVtOiBUYW5kZW0uUkVRVUlSRUQsXHJcbiAgICAgIHBoZXRpb1Zpc2libGVQcm9wZXJ0eUluc3RydW1lbnRlZDogZmFsc2VcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2Ygb3B0aW9ucy54ID09PSAnbnVtYmVyJywgJ29wdGlvbnMueCBtdXN0IGJlIHNwZWNpZmllZCcgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBvcHRpb25zLnkgPT09ICdudW1iZXInLCAnb3B0aW9ucy55IG11c3QgYmUgc3BlY2lmaWVkJyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gYWRkIGNvdmVyLCBwYXNzIHRoZSB3aG9sZSB0YW5kZW0gdG8gaGlkZSB0aGUgXCJjb3ZlclwiIGltcGxlbWVudGF0aW9uIGRldGFpbFxyXG4gICAgdGhpcy5hZGRDaGlsZCggbmV3IENvdmVyTm9kZSggdGl0bGUsIG9wdGlvbnMudGFuZGVtLCBfLm9taXQoIG9wdGlvbnMsIFsgJ3RhbmRlbScgXSApICkgKTtcclxuXHJcbiAgICAvLyBpbml0IGRyYWcgYW5kIGExMXkgb3B0aW9ucyBmb3IgdGhlIGRyYWdnYWJsZSBib29rXHJcbiAgICBpZiAoIG9wdGlvbnMuZHJhZyApIHtcclxuXHJcbiAgICAgIC8vIGExMXkgLSBXZSB3YW50IHRoZSBoaWdobGlnaHRzIHRvIGJlIGNvbXBsZXRlbHkgd2l0aGluIHRoZSBib3VuZHMgb2YgdGhlIGJvb2suXHJcbiAgICAgIGNvbnN0IGZvY3VzSGlnaGxpZ2h0UmVjdCA9IG5ldyBGb2N1c0hpZ2hsaWdodFBhdGgoIG51bGwgKTtcclxuICAgICAgY29uc3QgaGlnaGxpZ2h0TGluZVdpZHRoID0gZm9jdXNIaWdobGlnaHRSZWN0LmdldE91dGVyTGluZVdpZHRoKCB0aGlzICk7XHJcbiAgICAgIGNvbnN0IGhpZ2hsaWdodFNoYXBlID0gU2hhcGUuYm91bmRzKCB0aGlzLmxvY2FsQm91bmRzLmVyb2RlZCggaGlnaGxpZ2h0TGluZVdpZHRoIC8gMiApICk7XHJcbiAgICAgIGZvY3VzSGlnaGxpZ2h0UmVjdC5zZXRTaGFwZSggaGlnaGxpZ2h0U2hhcGUgKTtcclxuXHJcbiAgICAgIGNvbnN0IGludGVyYWN0aXZlSGlnaGxpZ2h0UmVjdCA9IG5ldyBGb2N1c0hpZ2hsaWdodFBhdGgoIG51bGwgKTtcclxuICAgICAgaW50ZXJhY3RpdmVIaWdobGlnaHRSZWN0LnNldFNoYXBlKCBoaWdobGlnaHRTaGFwZSApO1xyXG5cclxuICAgICAgLy8gY3VpbmcgYXJyb3dzIGZvciB0aGUgYm9va1xyXG4gICAgICBjb25zdCBib29rQ3VlQXJyb3cxID0gbmV3IEN1ZUFycm93KCB7XHJcbiAgICAgICAgcm90YXRpb246IE1hdGguUEksXHJcbiAgICAgICAgcmlnaHQ6IC0xMCxcclxuICAgICAgICBzY2FsZTogMC43XHJcbiAgICAgIH0gKTtcclxuICAgICAgY29uc3QgYm9va0N1ZUFycm93MiA9IG5ldyBDdWVBcnJvdygge1xyXG4gICAgICAgIGxlZnQ6IHRoaXMud2lkdGggKyAxMixcclxuICAgICAgICBzY2FsZTogMC43XHJcbiAgICAgIH0gKTtcclxuICAgICAgY29uc3QgYm9va0N1ZUFycm93MyA9IG5ldyBDdWVBcnJvdygge1xyXG4gICAgICAgIHJvdGF0aW9uOiBNYXRoLlBJIC8gMixcclxuICAgICAgICBjZW50ZXJYOiB0aGlzLndpZHRoIC8gMixcclxuICAgICAgICB5OiB0aGlzLmhlaWdodCAvIDIgKyAxMCwgLy8gYSBsaXR0bGUgZnVydGhlciBkb3duIG9uIHRoZSBzY3JlZW4sIGVtcGlyaWNhbFxyXG4gICAgICAgIHNjYWxlOiAwLjdcclxuICAgICAgfSApO1xyXG4gICAgICBjb25zdCBhcnJvd3MgPSBuZXcgTm9kZSgge1xyXG4gICAgICAgIGNoaWxkcmVuOiBbIGJvb2tDdWVBcnJvdzEsIGJvb2tDdWVBcnJvdzIsIGJvb2tDdWVBcnJvdzMgXVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICAvLyBzb3VuZHMgdXNlZCB3aGVuIHRoZSBib29rIGlzIHBpY2tlZCB1cCBvciBkcm9wcGVkXHJcbiAgICAgIGNvbnN0IGJvb2tQaWNrdXBTb3VuZENsaXAgPSBuZXcgU291bmRDbGlwKCBzaW1wbGVQaWNrdXBfbXAzLCB7IGluaXRpYWxPdXRwdXRMZXZlbDogU09VTkRfTEVWRUwgfSApO1xyXG4gICAgICBzb3VuZE1hbmFnZXIuYWRkU291bmRHZW5lcmF0b3IoIGJvb2tQaWNrdXBTb3VuZENsaXAgKTtcclxuICAgICAgY29uc3QgYm9va0Ryb3BTb3VuZENsaXAgPSBuZXcgU291bmRDbGlwKCBzaW1wbGVEcm9wX21wMywgeyBpbml0aWFsT3V0cHV0TGV2ZWw6IFNPVU5EX0xFVkVMIH0gKTtcclxuICAgICAgc291bmRNYW5hZ2VyLmFkZFNvdW5kR2VuZXJhdG9yKCBib29rRHJvcFNvdW5kQ2xpcCApO1xyXG5cclxuICAgICAgLy8gcGRvbSAtIGFkZCBhIGtleWJvYXJkIGRyYWcgaGFuZGxlclxyXG4gICAgICB0aGlzLmtleWJvYXJkRHJhZ0xpc3RlbmVyID0gbmV3IEZyaWN0aW9uS2V5Ym9hcmREcmFnTGlzdGVuZXIoIG1vZGVsLCB0ZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlRGVjcmVhc2luZ0FsZXJ0ZXIsIGJvb2tNb3ZlbWVudEFsZXJ0ZXIsIHtcclxuICAgICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAna2V5Ym9hcmREcmFnTGlzdGVuZXInIClcclxuICAgICAgICB9ICk7XHJcblxyXG4gICAgICAvLyBoaWdobGlnaHRzIG11c3QgYmUgYWRkZWQgcHJpb3IgdG8gYWRkaW5nIHRoZSBncmFiL2RyYWcgaW50ZXJhY3Rpb24sIHRoaXMgaXMgYSBjb25zdHJhaW50IG9mIEdyYWJEcmFnSW50ZXJhY3Rpb25cclxuICAgICAgdGhpcy5hZGRDaGlsZCggZm9jdXNIaWdobGlnaHRSZWN0ICk7XHJcbiAgICAgIHRoaXMuZm9jdXNIaWdobGlnaHQgPSBmb2N1c0hpZ2hsaWdodFJlY3Q7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIGludGVyYWN0aXZlSGlnaGxpZ2h0UmVjdCApO1xyXG4gICAgICB0aGlzLmludGVyYWN0aXZlSGlnaGxpZ2h0ID0gaW50ZXJhY3RpdmVIaWdobGlnaHRSZWN0O1xyXG5cclxuICAgICAgdGhpcy5mb2N1c0hpZ2hsaWdodExheWVyYWJsZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuaW50ZXJhY3RpdmVIaWdobGlnaHRMYXllcmFibGUgPSB0cnVlO1xyXG5cclxuICAgICAgLy8gQHByaXZhdGUgLSBhMTF5XHJcbiAgICAgIHRoaXMuZ3JhYkRyYWdJbnRlcmFjdGlvbiA9IG5ldyBGcmljdGlvbkdyYWJEcmFnSW50ZXJhY3Rpb24oIG1vZGVsLCB0aGlzLmtleWJvYXJkRHJhZ0xpc3RlbmVyLCB0aGlzLCBncmFiYmVkRGVzY3JpYmVyLCBhbGVydFNldHRsZWRBbmRDb29sLCB7XHJcbiAgICAgICAgb2JqZWN0VG9HcmFiU3RyaW5nOiBjaGVtaXN0cnlCb29rU3RyaW5nLFxyXG5cclxuICAgICAgICAvLyBFbXBpcmljYWxseSBkZXRlcm1pbmVkIHZhbHVlcyB0byBwbGFjZSB0aGUgY3VlIGFib3ZlIHRoZSBib29rLlxyXG4gICAgICAgIGdyYWJDdWVPcHRpb25zOiB7XHJcbiAgICAgICAgICB4OiA0NSxcclxuICAgICAgICAgIHk6IC02MFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ3JhYmJhYmxlT3B0aW9uczoge1xyXG4gICAgICAgICAgZm9jdXNIaWdobGlnaHQ6IGZvY3VzSGlnaGxpZ2h0UmVjdFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGtleWJvYXJkSGVscFRleHQ6IGdyYWJCdXR0b25IZWxwVGV4dFN0cmluZyxcclxuXHJcbiAgICAgICAgb25HcmFiOiAoKSA9PiB7IGJvb2tQaWNrdXBTb3VuZENsaXAucGxheSgpOyB9LFxyXG5cclxuICAgICAgICBvblJlbGVhc2U6ICgpID0+IHsgYm9va0Ryb3BTb3VuZENsaXAucGxheSgpOyB9LFxyXG5cclxuICAgICAgICBkcmFnQ3VlTm9kZTogYXJyb3dzLFxyXG5cclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2dyYWJEcmFnSW50ZXJhY3Rpb24nIClcclxuICAgICAgfSApO1xyXG5cclxuICAgICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCBuZXcgRnJpY3Rpb25EcmFnTGlzdGVuZXIoIG1vZGVsLCB0ZW1wZXJhdHVyZUluY3JlYXNpbmdBbGVydGVyLCB0ZW1wZXJhdHVyZURlY3JlYXNpbmdBbGVydGVyLFxyXG4gICAgICAgIGJvb2tNb3ZlbWVudEFsZXJ0ZXIsIHtcclxuICAgICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZHJhZ0xpc3RlbmVyJyApLFxyXG4gICAgICAgICAgc3RhcnRTb3VuZDogYm9va1BpY2t1cFNvdW5kQ2xpcCxcclxuICAgICAgICAgIGVuZFNvdW5kOiBib29rRHJvcFNvdW5kQ2xpcCxcclxuICAgICAgICAgIHRhcmdldE5vZGU6IHRoaXMsXHJcbiAgICAgICAgICBzdGFydERyYWc6ICgpID0+IHRoaXMudm9pY2luZ1NwZWFrRnVsbFJlc3BvbnNlKCB7XHJcbiAgICAgICAgICAgIG9iamVjdFJlc3BvbnNlOiBncmFiYmVkRGVzY3JpYmVyLmdldFZvaWNpbmdHcmFiYmVkT2JqZWN0UmVzcG9uc2UoKVxyXG4gICAgICAgICAgfSApXHJcbiAgICAgICAgfSApICk7XHJcblxyXG4gICAgICAvLyBUaGlzIHRyYW5zZm9ybSB1c2VzIHRoZSBhc3N1bXB0aW9uIHRoYXQgbW9kZWwgY29vcmRzIGFuZCB0aGUgbWFnbmlmaWVkIHZpZXcgYXJlIGluIHRoZSBzYW1lIGNvb3JkaW5hdGUgZnJhbWUsXHJcbiAgICAgIC8vIGFuZCB0aGF0IGl0J3Mgb3JpZ2luIGlzIHplcm8sIGFuZCB0aGF0IHRoZSBCb29rTm9kZSBpcyBwb3NpdGlvbmVkIHdpdGggeC95IG9wdGlvbnMuXHJcbiAgICAgIGNvbnN0IHRyYW5zZm9ybSA9IE1vZGVsVmlld1RyYW5zZm9ybTIuY3JlYXRlU2luZ2xlUG9pbnRTY2FsZU1hcHBpbmcoIFZlY3RvcjIuWkVSTywgbmV3IFZlY3RvcjIoIG9wdGlvbnMueCwgb3B0aW9ucy55ICksXHJcbiAgICAgICAgbW9kZWwuYm9va0RyYWdnaW5nU2NhbGVGYWN0b3IgKTtcclxuXHJcbiAgICAgIC8vIGFkZCBvYnNlcnZlclxyXG4gICAgICBtb2RlbC50b3BCb29rUG9zaXRpb25Qcm9wZXJ0eS5saW5rKCBwb3NpdGlvbiA9PiB7XHJcbiAgICAgICAgdGhpcy5zZXRUcmFuc2xhdGlvbiggdHJhbnNmb3JtLnRyYW5zZm9ybVBvc2l0aW9uMiggcG9zaXRpb24gKSApO1xyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICB0aGlzLmlucHV0RW5hYmxlZFByb3BlcnR5LmxpbmsoIGlucHV0RW5hYmxlZCA9PiB7XHJcbiAgICAgICAgdGhpcy5ncmFiRHJhZ0ludGVyYWN0aW9uLmVuYWJsZWQgPSBpbnB1dEVuYWJsZWQ7XHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAgIHRoaXMuY3Vyc29yID0gJ3BvaW50ZXInO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICByZXNldCgpIHtcclxuICAgIHRoaXMuZ3JhYkRyYWdJbnRlcmFjdGlvbi5yZXNldCgpO1xyXG4gIH1cclxufVxyXG5cclxuZnJpY3Rpb24ucmVnaXN0ZXIoICdCb29rTm9kZScsIEJvb2tOb2RlICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBCb29rTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPQSxPQUFPLE1BQU0sa0NBQWtDO0FBQ3RELFNBQVNDLEtBQUssUUFBUSxtQ0FBbUM7QUFDekQsT0FB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