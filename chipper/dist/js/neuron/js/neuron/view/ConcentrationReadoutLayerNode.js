// Copyright 2014-2023, University of Colorado Boulder
/**
 * This node acts as a layer to which all concentration readouts are added
 *
 * @author John Blanco
 * @author Sharfudeen Ashraf (for Ghent University)
 */

import Multilink from '../../../../axon/js/Multilink.js';
import Utils from '../../../../dot/js/Utils.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import neuron from '../../neuron.js';
import NeuronStrings from '../../NeuronStrings.js';
import PotassiumIon from '../model/PotassiumIon.js';
import SodiumIon from '../model/SodiumIon.js';
const concentrationReadoutPattern0Label1Value2UnitsString = NeuronStrings.concentrationReadoutPattern['0label']['1value']['2units'];
const potassiumChemicalSymbolString = NeuronStrings.potassiumChemicalSymbol;
const sodiumChemicalSymbolString = NeuronStrings.sodiumChemicalSymbol;
const unitsMMString = NeuronStrings.units.mM;

// constants that control aspects of the concentration readout.
const CONCENTRATION_READOUT_NUM_PLACES = 5;
const READ_OUT_FONT_SIZE = 14;
const READOUT_BOUNDS_DILATION = 2;
const INVISIBLE_RECT_FILL = 'rgba( 0, 0, 0, 0 )';
class ConcentrationReadoutLayerNode extends Node {
  /**
   * @param {NeuronModel} neuronModel
   * @param {Property.<number>} zoomProperty
   * @param {Node} zoomableRootNode
   * @param {Bounds2} viewPortBounds
   * @param {AxonCrossSectionNode} axonCrossSectionNode
   */
  constructor(neuronModel, zoomProperty, zoomableRootNode, viewPortBounds, axonCrossSectionNode) {
    super();
    this.zoomableRootNode = zoomableRootNode;

    // Concentration readouts.
    const sodiumExteriorConcentrationReadout = new Text('', {
      font: new PhetFont({
        size: READ_OUT_FONT_SIZE
      }),
      fill: new SodiumIon().getRepresentationColor()
    });
    const sodiumInteriorConcentrationReadout = new Text('', {
      font: new PhetFont({
        size: READ_OUT_FONT_SIZE
      }),
      fill: new SodiumIon().getRepresentationColor()
    });
    const potassiumExteriorConcentrationReadout = new Text('', {
      font: new PhetFont({
        size: READ_OUT_FONT_SIZE
      }),
      fill: new PotassiumIon().getRepresentationColor().darkerColor(0.5)
    });
    const potassiumInteriorConcentrationReadout = new Text('', {
      font: new PhetFont({
        size: READ_OUT_FONT_SIZE
      }),
      fill: new PotassiumIon().getRepresentationColor().darkerColor(0.5)
    });

    // convenience function for formatting the readouts
    function createConcentrationReadoutString(label, value) {
      const valueText = Utils.toFixed(value, CONCENTRATION_READOUT_NUM_PLACES);
      return StringUtils.format(concentrationReadoutPattern0Label1Value2UnitsString, label, valueText, unitsMMString);
    }

    // function to update the text for all four readouts
    function updateConcentrationReadoutValues() {
      sodiumExteriorConcentrationReadout.string = createConcentrationReadoutString(sodiumChemicalSymbolString, neuronModel.getSodiumExteriorConcentration());
      sodiumInteriorConcentrationReadout.string = createConcentrationReadoutString(sodiumChemicalSymbolString, neuronModel.getSodiumInteriorConcentration());
      potassiumExteriorConcentrationReadout.string = createConcentrationReadoutString(potassiumChemicalSymbolString, neuronModel.getPotassiumExteriorConcentration());
      potassiumInteriorConcentrationReadout.string = createConcentrationReadoutString(potassiumChemicalSymbolString, neuronModel.getPotassiumInteriorConcentration());
    }

    // fill in the initial concentration values so that the bounds are available for the code that follows
    updateConcentrationReadoutValues();

    // Put each of the readouts on an invisible rectangle to prevent artifacts, see
    // https://github.com/phetsims/neuron/issues/122, and also override the bounds computation for better performance.
    const sodiumExteriorConcentrationReadoutRect = Rectangle.bounds(sodiumExteriorConcentrationReadout.bounds.dilated(READOUT_BOUNDS_DILATION), {
      fill: INVISIBLE_RECT_FILL,
      children: [sodiumExteriorConcentrationReadout]
    });
    sodiumExteriorConcentrationReadout.computeShapeBounds = () => sodiumExteriorConcentrationReadoutRect.bounds;
    const sodiumInteriorConcentrationReadoutRect = Rectangle.bounds(sodiumInteriorConcentrationReadout.bounds.dilated(READOUT_BOUNDS_DILATION), {
      fill: INVISIBLE_RECT_FILL,
      children: [sodiumInteriorConcentrationReadout]
    });
    sodiumInteriorConcentrationReadout.computeShapeBounds = () => sodiumInteriorConcentrationReadoutRect.bounds;
    const potassiumExteriorConcentrationReadoutRect = Rectangle.bounds(potassiumExteriorConcentrationReadout.bounds.dilated(READOUT_BOUNDS_DILATION), {
      fill: INVISIBLE_RECT_FILL,
      children: [potassiumExteriorConcentrationReadout]
    });
    potassiumExteriorConcentrationReadout.computeShapeBounds = () => potassiumExteriorConcentrationReadoutRect.bounds;
    const potassiumInteriorConcentrationReadoutRect = Rectangle.bounds(potassiumInteriorConcentrationReadout.bounds.dilated(READOUT_BOUNDS_DILATION), {
      fill: INVISIBLE_RECT_FILL,
      children: [potassiumInteriorConcentrationReadout]
    });
    potassiumInteriorConcentrationReadout.computeShapeBounds = () => potassiumInteriorConcentrationReadoutRect.bounds;

    // add the concentration readouts
    this.addChild(sodiumExteriorConcentrationReadoutRect);
    this.addChild(sodiumInteriorConcentrationReadoutRect);
    this.addChild(potassiumExteriorConcentrationReadoutRect);
    this.addChild(potassiumInteriorConcentrationReadoutRect);

    // Update the readout positions when the zoom factor or visibility changes.  Visibility is used as an optimization -
    // it prevents making updates when the readouts aren't visible.
    Multilink.multilink([zoomProperty, neuronModel.concentrationReadoutVisibleProperty], (zoom, visible) => {
      if (visible) {
        const maxExteriorReadoutWidth = Math.max(potassiumExteriorConcentrationReadoutRect.bounds.width, sodiumExteriorConcentrationReadoutRect.bounds.width);

        // Place the exterior readouts to the upper left, just outside of the membrane.  The algorithm for placement was
        // empirically determined and will need adjustment if anything about the neuron position changes.
        const exteriorIndicatorYOffset = Math.max(this.zoomableRootNode.transform.transformY(45), 5);
        potassiumExteriorConcentrationReadoutRect.left = viewPortBounds.minX + maxExteriorReadoutWidth - potassiumExteriorConcentrationReadoutRect.bounds.width + 4;
        potassiumExteriorConcentrationReadoutRect.top = viewPortBounds.minY + exteriorIndicatorYOffset;
        sodiumExteriorConcentrationReadoutRect.top = potassiumExteriorConcentrationReadoutRect.bottom;
        sodiumExteriorConcentrationReadoutRect.right = potassiumExteriorConcentrationReadoutRect.right;

        // Place the interior readout in a place where it can be seen whether or not the chart is showing and doesn't
        // overlap with the membrane of the neuron.  The Y position calculation is empirically determined.
        const interiorIndicatorYOffset = 80 + this.zoomableRootNode.transform.transformY(80) * 0.5;
        potassiumInteriorConcentrationReadoutRect.centerX = axonCrossSectionNode.centerX;
        potassiumInteriorConcentrationReadoutRect.top = viewPortBounds.y + interiorIndicatorYOffset;
        sodiumInteriorConcentrationReadoutRect.top = potassiumInteriorConcentrationReadoutRect.bottom;
        sodiumInteriorConcentrationReadoutRect.right = potassiumInteriorConcentrationReadoutRect.right;
      }
    });

    // update the readouts when the concentration changes, but only if the readout are visible
    neuronModel.concentrationChangedProperty.link(concentrationChanged => {
      // this is optimized to skip updates if not visible to avoid recalculating bounds
      if (concentrationChanged && this.isVisible()) {
        updateConcentrationReadoutValues();
      }
    });

    // update the readouts when this node transitions from invisible to visible
    this.visibleProperty.lazyLink(a => {
      if (this.visible) {
        updateConcentrationReadoutValues();
      }
    });
  }
}
neuron.register('ConcentrationReadoutLayerNode', ConcentrationReadoutLayerNode);
export default ConcentrationReadoutLayerNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aWxpbmsiLCJVdGlscyIsIlN0cmluZ1V0aWxzIiwiUGhldEZvbnQiLCJOb2RlIiwiUmVjdGFuZ2xlIiwiVGV4dCIsIm5ldXJvbiIsIk5ldXJvblN0cmluZ3MiLCJQb3Rhc3NpdW1Jb24iLCJTb2RpdW1Jb24iLCJjb25jZW50cmF0aW9uUmVhZG91dFBhdHRlcm4wTGFiZWwxVmFsdWUyVW5pdHNTdHJpbmciLCJjb25jZW50cmF0aW9uUmVhZG91dFBhdHRlcm4iLCJwb3Rhc3NpdW1DaGVtaWNhbFN5bWJvbFN0cmluZyIsInBvdGFzc2l1bUNoZW1pY2FsU3ltYm9sIiwic29kaXVtQ2hlbWljYWxTeW1ib2xTdHJpbmciLCJzb2RpdW1DaGVtaWNhbFN5bWJvbCIsInVuaXRzTU1TdHJpbmciLCJ1bml0cyIsIm1NIiwiQ09OQ0VOVFJBVElPTl9SRUFET1VUX05VTV9QTEFDRVMiLCJSRUFEX09VVF9GT05UX1NJWkUiLCJSRUFET1VUX0JPVU5EU19ESUxBVElPTiIsIklOVklTSUJMRV9SRUNUX0ZJTEwiLCJDb25jZW50cmF0aW9uUmVhZG91dExheWVyTm9kZSIsImNvbnN0cnVjdG9yIiwibmV1cm9uTW9kZWwiLCJ6b29tUHJvcGVydHkiLCJ6b29tYWJsZVJvb3ROb2RlIiwidmlld1BvcnRCb3VuZHMiLCJheG9uQ3Jvc3NTZWN0aW9uTm9kZSIsInNvZGl1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQiLCJmb250Iiwic2l6ZSIsImZpbGwiLCJnZXRSZXByZXNlbnRhdGlvbkNvbG9yIiwic29kaXVtSW50ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dCIsInBvdGFzc2l1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQiLCJkYXJrZXJDb2xvciIsInBvdGFzc2l1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQiLCJjcmVhdGVDb25jZW50cmF0aW9uUmVhZG91dFN0cmluZyIsImxhYmVsIiwidmFsdWUiLCJ2YWx1ZVRleHQiLCJ0b0ZpeGVkIiwiZm9ybWF0IiwidXBkYXRlQ29uY2VudHJhdGlvblJlYWRvdXRWYWx1ZXMiLCJzdHJpbmciLCJnZXRTb2RpdW1FeHRlcmlvckNvbmNlbnRyYXRpb24iLCJnZXRTb2RpdW1JbnRlcmlvckNvbmNlbnRyYXRpb24iLCJnZXRQb3Rhc3NpdW1FeHRlcmlvckNvbmNlbnRyYXRpb24iLCJnZXRQb3Rhc3NpdW1JbnRlcmlvckNvbmNlbnRyYXRpb24iLCJzb2RpdW1FeHRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdCIsImJvdW5kcyIsImRpbGF0ZWQiLCJjaGlsZHJlbiIsImNvbXB1dGVTaGFwZUJvdW5kcyIsInNvZGl1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0IiwicG90YXNzaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QiLCJwb3Rhc3NpdW1JbnRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdCIsImFkZENoaWxkIiwibXVsdGlsaW5rIiwiY29uY2VudHJhdGlvblJlYWRvdXRWaXNpYmxlUHJvcGVydHkiLCJ6b29tIiwidmlzaWJsZSIsIm1heEV4dGVyaW9yUmVhZG91dFdpZHRoIiwiTWF0aCIsIm1heCIsIndpZHRoIiwiZXh0ZXJpb3JJbmRpY2F0b3JZT2Zmc2V0IiwidHJhbnNmb3JtIiwidHJhbnNmb3JtWSIsImxlZnQiLCJtaW5YIiwidG9wIiwibWluWSIsImJvdHRvbSIsInJpZ2h0IiwiaW50ZXJpb3JJbmRpY2F0b3JZT2Zmc2V0IiwiY2VudGVyWCIsInkiLCJjb25jZW50cmF0aW9uQ2hhbmdlZFByb3BlcnR5IiwibGluayIsImNvbmNlbnRyYXRpb25DaGFuZ2VkIiwiaXNWaXNpYmxlIiwidmlzaWJsZVByb3BlcnR5IiwibGF6eUxpbmsiLCJhIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJDb25jZW50cmF0aW9uUmVhZG91dExheWVyTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNC0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuLyoqXHJcbiAqIFRoaXMgbm9kZSBhY3RzIGFzIGEgbGF5ZXIgdG8gd2hpY2ggYWxsIGNvbmNlbnRyYXRpb24gcmVhZG91dHMgYXJlIGFkZGVkXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY29cclxuICogQGF1dGhvciBTaGFyZnVkZWVuIEFzaHJhZiAoZm9yIEdoZW50IFVuaXZlcnNpdHkpXHJcbiAqL1xyXG5cclxuaW1wb3J0IE11bHRpbGluayBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL011bHRpbGluay5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgU3RyaW5nVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy91dGlsL1N0cmluZ1V0aWxzLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IE5vZGUsIFJlY3RhbmdsZSwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBuZXVyb24gZnJvbSAnLi4vLi4vbmV1cm9uLmpzJztcclxuaW1wb3J0IE5ldXJvblN0cmluZ3MgZnJvbSAnLi4vLi4vTmV1cm9uU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBQb3Rhc3NpdW1Jb24gZnJvbSAnLi4vbW9kZWwvUG90YXNzaXVtSW9uLmpzJztcclxuaW1wb3J0IFNvZGl1bUlvbiBmcm9tICcuLi9tb2RlbC9Tb2RpdW1Jb24uanMnO1xyXG5cclxuY29uc3QgY29uY2VudHJhdGlvblJlYWRvdXRQYXR0ZXJuMExhYmVsMVZhbHVlMlVuaXRzU3RyaW5nID0gTmV1cm9uU3RyaW5ncy5jb25jZW50cmF0aW9uUmVhZG91dFBhdHRlcm5bICcwbGFiZWwnIF1bICcxdmFsdWUnIF1bICcydW5pdHMnIF07XHJcbmNvbnN0IHBvdGFzc2l1bUNoZW1pY2FsU3ltYm9sU3RyaW5nID0gTmV1cm9uU3RyaW5ncy5wb3Rhc3NpdW1DaGVtaWNhbFN5bWJvbDtcclxuY29uc3Qgc29kaXVtQ2hlbWljYWxTeW1ib2xTdHJpbmcgPSBOZXVyb25TdHJpbmdzLnNvZGl1bUNoZW1pY2FsU3ltYm9sO1xyXG5jb25zdCB1bml0c01NU3RyaW5nID0gTmV1cm9uU3RyaW5ncy51bml0cy5tTTtcclxuXHJcbi8vIGNvbnN0YW50cyB0aGF0IGNvbnRyb2wgYXNwZWN0cyBvZiB0aGUgY29uY2VudHJhdGlvbiByZWFkb3V0LlxyXG5jb25zdCBDT05DRU5UUkFUSU9OX1JFQURPVVRfTlVNX1BMQUNFUyA9IDU7XHJcbmNvbnN0IFJFQURfT1VUX0ZPTlRfU0laRSA9IDE0O1xyXG5jb25zdCBSRUFET1VUX0JPVU5EU19ESUxBVElPTiA9IDI7XHJcbmNvbnN0IElOVklTSUJMRV9SRUNUX0ZJTEwgPSAncmdiYSggMCwgMCwgMCwgMCApJztcclxuXHJcbmNsYXNzIENvbmNlbnRyYXRpb25SZWFkb3V0TGF5ZXJOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7TmV1cm9uTW9kZWx9IG5ldXJvbk1vZGVsXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48bnVtYmVyPn0gem9vbVByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtOb2RlfSB6b29tYWJsZVJvb3ROb2RlXHJcbiAgICogQHBhcmFtIHtCb3VuZHMyfSB2aWV3UG9ydEJvdW5kc1xyXG4gICAqIEBwYXJhbSB7QXhvbkNyb3NzU2VjdGlvbk5vZGV9IGF4b25Dcm9zc1NlY3Rpb25Ob2RlXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG5ldXJvbk1vZGVsLCB6b29tUHJvcGVydHksIHpvb21hYmxlUm9vdE5vZGUsIHZpZXdQb3J0Qm91bmRzLCBheG9uQ3Jvc3NTZWN0aW9uTm9kZSApIHtcclxuXHJcbiAgICBzdXBlcigpO1xyXG4gICAgdGhpcy56b29tYWJsZVJvb3ROb2RlID0gem9vbWFibGVSb290Tm9kZTtcclxuXHJcbiAgICAvLyBDb25jZW50cmF0aW9uIHJlYWRvdXRzLlxyXG4gICAgY29uc3Qgc29kaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dCA9IG5ldyBUZXh0KCAnJywge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIHsgc2l6ZTogUkVBRF9PVVRfRk9OVF9TSVpFIH0gKSxcclxuICAgICAgZmlsbDogbmV3IFNvZGl1bUlvbigpLmdldFJlcHJlc2VudGF0aW9uQ29sb3IoKVxyXG4gICAgfSApO1xyXG4gICAgY29uc3Qgc29kaXVtSW50ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dCA9IG5ldyBUZXh0KCAnJywge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIHsgc2l6ZTogUkVBRF9PVVRfRk9OVF9TSVpFIH0gKSxcclxuICAgICAgZmlsbDogbmV3IFNvZGl1bUlvbigpLmdldFJlcHJlc2VudGF0aW9uQ29sb3IoKVxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgcG90YXNzaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dCA9IG5ldyBUZXh0KCAnJywge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIHsgc2l6ZTogUkVBRF9PVVRfRk9OVF9TSVpFIH0gKSxcclxuICAgICAgZmlsbDogbmV3IFBvdGFzc2l1bUlvbigpLmdldFJlcHJlc2VudGF0aW9uQ29sb3IoKS5kYXJrZXJDb2xvciggMC41IClcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IHBvdGFzc2l1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQgPSBuZXcgVGV4dCggJycsIHtcclxuICAgICAgZm9udDogbmV3IFBoZXRGb250KCB7IHNpemU6IFJFQURfT1VUX0ZPTlRfU0laRSB9ICksXHJcbiAgICAgIGZpbGw6IG5ldyBQb3Rhc3NpdW1Jb24oKS5nZXRSZXByZXNlbnRhdGlvbkNvbG9yKCkuZGFya2VyQ29sb3IoIDAuNSApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gY29udmVuaWVuY2UgZnVuY3Rpb24gZm9yIGZvcm1hdHRpbmcgdGhlIHJlYWRvdXRzXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVDb25jZW50cmF0aW9uUmVhZG91dFN0cmluZyggbGFiZWwsIHZhbHVlICkge1xyXG4gICAgICBjb25zdCB2YWx1ZVRleHQgPSBVdGlscy50b0ZpeGVkKCB2YWx1ZSwgQ09OQ0VOVFJBVElPTl9SRUFET1VUX05VTV9QTEFDRVMgKTtcclxuICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZvcm1hdCggY29uY2VudHJhdGlvblJlYWRvdXRQYXR0ZXJuMExhYmVsMVZhbHVlMlVuaXRzU3RyaW5nLCBsYWJlbCwgdmFsdWVUZXh0LCB1bml0c01NU3RyaW5nICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZnVuY3Rpb24gdG8gdXBkYXRlIHRoZSB0ZXh0IGZvciBhbGwgZm91ciByZWFkb3V0c1xyXG4gICAgZnVuY3Rpb24gdXBkYXRlQ29uY2VudHJhdGlvblJlYWRvdXRWYWx1ZXMoKSB7XHJcbiAgICAgIHNvZGl1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQuc3RyaW5nID1cclxuICAgICAgICBjcmVhdGVDb25jZW50cmF0aW9uUmVhZG91dFN0cmluZyggc29kaXVtQ2hlbWljYWxTeW1ib2xTdHJpbmcsIG5ldXJvbk1vZGVsLmdldFNvZGl1bUV4dGVyaW9yQ29uY2VudHJhdGlvbigpICk7XHJcbiAgICAgIHNvZGl1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQuc3RyaW5nID1cclxuICAgICAgICBjcmVhdGVDb25jZW50cmF0aW9uUmVhZG91dFN0cmluZyggc29kaXVtQ2hlbWljYWxTeW1ib2xTdHJpbmcsIG5ldXJvbk1vZGVsLmdldFNvZGl1bUludGVyaW9yQ29uY2VudHJhdGlvbigpICk7XHJcbiAgICAgIHBvdGFzc2l1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQuc3RyaW5nID1cclxuICAgICAgICBjcmVhdGVDb25jZW50cmF0aW9uUmVhZG91dFN0cmluZyggcG90YXNzaXVtQ2hlbWljYWxTeW1ib2xTdHJpbmcsIG5ldXJvbk1vZGVsLmdldFBvdGFzc2l1bUV4dGVyaW9yQ29uY2VudHJhdGlvbigpICk7XHJcbiAgICAgIHBvdGFzc2l1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQuc3RyaW5nID1cclxuICAgICAgICBjcmVhdGVDb25jZW50cmF0aW9uUmVhZG91dFN0cmluZyggcG90YXNzaXVtQ2hlbWljYWxTeW1ib2xTdHJpbmcsIG5ldXJvbk1vZGVsLmdldFBvdGFzc2l1bUludGVyaW9yQ29uY2VudHJhdGlvbigpICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZmlsbCBpbiB0aGUgaW5pdGlhbCBjb25jZW50cmF0aW9uIHZhbHVlcyBzbyB0aGF0IHRoZSBib3VuZHMgYXJlIGF2YWlsYWJsZSBmb3IgdGhlIGNvZGUgdGhhdCBmb2xsb3dzXHJcbiAgICB1cGRhdGVDb25jZW50cmF0aW9uUmVhZG91dFZhbHVlcygpO1xyXG5cclxuICAgIC8vIFB1dCBlYWNoIG9mIHRoZSByZWFkb3V0cyBvbiBhbiBpbnZpc2libGUgcmVjdGFuZ2xlIHRvIHByZXZlbnQgYXJ0aWZhY3RzLCBzZWVcclxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9uZXVyb24vaXNzdWVzLzEyMiwgYW5kIGFsc28gb3ZlcnJpZGUgdGhlIGJvdW5kcyBjb21wdXRhdGlvbiBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlLlxyXG4gICAgY29uc3Qgc29kaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QgPSBSZWN0YW5nbGUuYm91bmRzKFxyXG4gICAgICBzb2RpdW1FeHRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0LmJvdW5kcy5kaWxhdGVkKCBSRUFET1VUX0JPVU5EU19ESUxBVElPTiApLFxyXG4gICAgICB7IGZpbGw6IElOVklTSUJMRV9SRUNUX0ZJTEwsIGNoaWxkcmVuOiBbIHNvZGl1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQgXSB9XHJcbiAgICApO1xyXG4gICAgc29kaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dC5jb21wdXRlU2hhcGVCb3VuZHMgPSAoKSA9PiBzb2RpdW1FeHRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdC5ib3VuZHM7XHJcbiAgICBjb25zdCBzb2RpdW1JbnRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdCA9IFJlY3RhbmdsZS5ib3VuZHMoXHJcbiAgICAgIHNvZGl1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQuYm91bmRzLmRpbGF0ZWQoIFJFQURPVVRfQk9VTkRTX0RJTEFUSU9OICksXHJcbiAgICAgIHsgZmlsbDogSU5WSVNJQkxFX1JFQ1RfRklMTCwgY2hpbGRyZW46IFsgc29kaXVtSW50ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dCBdIH1cclxuICAgICk7XHJcbiAgICBzb2RpdW1JbnRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0LmNvbXB1dGVTaGFwZUJvdW5kcyA9ICgpID0+IHNvZGl1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0LmJvdW5kcztcclxuICAgIGNvbnN0IHBvdGFzc2l1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0ID0gUmVjdGFuZ2xlLmJvdW5kcyhcclxuICAgICAgcG90YXNzaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dC5ib3VuZHMuZGlsYXRlZCggUkVBRE9VVF9CT1VORFNfRElMQVRJT04gKSxcclxuICAgICAgeyBmaWxsOiBJTlZJU0lCTEVfUkVDVF9GSUxMLCBjaGlsZHJlbjogWyBwb3Rhc3NpdW1FeHRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0IF0gfVxyXG4gICAgKTtcclxuICAgIHBvdGFzc2l1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQuY29tcHV0ZVNoYXBlQm91bmRzID0gKCkgPT4gcG90YXNzaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QuYm91bmRzO1xyXG4gICAgY29uc3QgcG90YXNzaXVtSW50ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QgPSBSZWN0YW5nbGUuYm91bmRzKFxyXG4gICAgICBwb3Rhc3NpdW1JbnRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0LmJvdW5kcy5kaWxhdGVkKCBSRUFET1VUX0JPVU5EU19ESUxBVElPTiApLFxyXG4gICAgICB7IGZpbGw6IElOVklTSUJMRV9SRUNUX0ZJTEwsIGNoaWxkcmVuOiBbIHBvdGFzc2l1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXQgXSB9XHJcbiAgICApO1xyXG4gICAgcG90YXNzaXVtSW50ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dC5jb21wdXRlU2hhcGVCb3VuZHMgPSAoKSA9PiBwb3Rhc3NpdW1JbnRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdC5ib3VuZHM7XHJcblxyXG4gICAgLy8gYWRkIHRoZSBjb25jZW50cmF0aW9uIHJlYWRvdXRzXHJcbiAgICB0aGlzLmFkZENoaWxkKCBzb2RpdW1FeHRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdCApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggc29kaXVtSW50ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHBvdGFzc2l1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBwb3Rhc3NpdW1JbnRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdCApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgcmVhZG91dCBwb3NpdGlvbnMgd2hlbiB0aGUgem9vbSBmYWN0b3Igb3IgdmlzaWJpbGl0eSBjaGFuZ2VzLiAgVmlzaWJpbGl0eSBpcyB1c2VkIGFzIGFuIG9wdGltaXphdGlvbiAtXHJcbiAgICAvLyBpdCBwcmV2ZW50cyBtYWtpbmcgdXBkYXRlcyB3aGVuIHRoZSByZWFkb3V0cyBhcmVuJ3QgdmlzaWJsZS5cclxuICAgIE11bHRpbGluay5tdWx0aWxpbmsoIFsgem9vbVByb3BlcnR5LCBuZXVyb25Nb2RlbC5jb25jZW50cmF0aW9uUmVhZG91dFZpc2libGVQcm9wZXJ0eSBdLCAoIHpvb20sIHZpc2libGUgKSA9PiB7XHJcbiAgICAgICAgaWYgKCB2aXNpYmxlICkge1xyXG4gICAgICAgICAgY29uc3QgbWF4RXh0ZXJpb3JSZWFkb3V0V2lkdGggPSBNYXRoLm1heCggcG90YXNzaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QuYm91bmRzLndpZHRoLFxyXG4gICAgICAgICAgICBzb2RpdW1FeHRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdC5ib3VuZHMud2lkdGggKTtcclxuXHJcbiAgICAgICAgICAvLyBQbGFjZSB0aGUgZXh0ZXJpb3IgcmVhZG91dHMgdG8gdGhlIHVwcGVyIGxlZnQsIGp1c3Qgb3V0c2lkZSBvZiB0aGUgbWVtYnJhbmUuICBUaGUgYWxnb3JpdGhtIGZvciBwbGFjZW1lbnQgd2FzXHJcbiAgICAgICAgICAvLyBlbXBpcmljYWxseSBkZXRlcm1pbmVkIGFuZCB3aWxsIG5lZWQgYWRqdXN0bWVudCBpZiBhbnl0aGluZyBhYm91dCB0aGUgbmV1cm9uIHBvc2l0aW9uIGNoYW5nZXMuXHJcbiAgICAgICAgICBjb25zdCBleHRlcmlvckluZGljYXRvcllPZmZzZXQgPSBNYXRoLm1heCggdGhpcy56b29tYWJsZVJvb3ROb2RlLnRyYW5zZm9ybS50cmFuc2Zvcm1ZKCA0NSApLCA1ICk7XHJcbiAgICAgICAgICBwb3Rhc3NpdW1FeHRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdC5sZWZ0ID0gdmlld1BvcnRCb3VuZHMubWluWCArIG1heEV4dGVyaW9yUmVhZG91dFdpZHRoIC1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3Rhc3NpdW1FeHRlcmlvckNvbmNlbnRyYXRpb25SZWFkb3V0UmVjdC5ib3VuZHMud2lkdGggKyA0O1xyXG4gICAgICAgICAgcG90YXNzaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QudG9wID0gdmlld1BvcnRCb3VuZHMubWluWSArIGV4dGVyaW9ySW5kaWNhdG9yWU9mZnNldDtcclxuICAgICAgICAgIHNvZGl1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0LnRvcCA9IHBvdGFzc2l1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0LmJvdHRvbTtcclxuICAgICAgICAgIHNvZGl1bUV4dGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0LnJpZ2h0ID0gcG90YXNzaXVtRXh0ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QucmlnaHQ7XHJcblxyXG4gICAgICAgICAgLy8gUGxhY2UgdGhlIGludGVyaW9yIHJlYWRvdXQgaW4gYSBwbGFjZSB3aGVyZSBpdCBjYW4gYmUgc2VlbiB3aGV0aGVyIG9yIG5vdCB0aGUgY2hhcnQgaXMgc2hvd2luZyBhbmQgZG9lc24ndFxyXG4gICAgICAgICAgLy8gb3ZlcmxhcCB3aXRoIHRoZSBtZW1icmFuZSBvZiB0aGUgbmV1cm9uLiAgVGhlIFkgcG9zaXRpb24gY2FsY3VsYXRpb24gaXMgZW1waXJpY2FsbHkgZGV0ZXJtaW5lZC5cclxuICAgICAgICAgIGNvbnN0IGludGVyaW9ySW5kaWNhdG9yWU9mZnNldCA9IDgwICsgdGhpcy56b29tYWJsZVJvb3ROb2RlLnRyYW5zZm9ybS50cmFuc2Zvcm1ZKCA4MCApICogMC41O1xyXG5cclxuICAgICAgICAgIHBvdGFzc2l1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0LmNlbnRlclggPSBheG9uQ3Jvc3NTZWN0aW9uTm9kZS5jZW50ZXJYO1xyXG4gICAgICAgICAgcG90YXNzaXVtSW50ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QudG9wID0gdmlld1BvcnRCb3VuZHMueSArIGludGVyaW9ySW5kaWNhdG9yWU9mZnNldDtcclxuICAgICAgICAgIHNvZGl1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0LnRvcCA9IHBvdGFzc2l1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0LmJvdHRvbTtcclxuICAgICAgICAgIHNvZGl1bUludGVyaW9yQ29uY2VudHJhdGlvblJlYWRvdXRSZWN0LnJpZ2h0ID0gcG90YXNzaXVtSW50ZXJpb3JDb25jZW50cmF0aW9uUmVhZG91dFJlY3QucmlnaHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIHVwZGF0ZSB0aGUgcmVhZG91dHMgd2hlbiB0aGUgY29uY2VudHJhdGlvbiBjaGFuZ2VzLCBidXQgb25seSBpZiB0aGUgcmVhZG91dCBhcmUgdmlzaWJsZVxyXG4gICAgbmV1cm9uTW9kZWwuY29uY2VudHJhdGlvbkNoYW5nZWRQcm9wZXJ0eS5saW5rKCBjb25jZW50cmF0aW9uQ2hhbmdlZCA9PiB7XHJcbiAgICAgIC8vIHRoaXMgaXMgb3B0aW1pemVkIHRvIHNraXAgdXBkYXRlcyBpZiBub3QgdmlzaWJsZSB0byBhdm9pZCByZWNhbGN1bGF0aW5nIGJvdW5kc1xyXG4gICAgICBpZiAoIGNvbmNlbnRyYXRpb25DaGFuZ2VkICYmIHRoaXMuaXNWaXNpYmxlKCkgKSB7XHJcbiAgICAgICAgdXBkYXRlQ29uY2VudHJhdGlvblJlYWRvdXRWYWx1ZXMoKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHVwZGF0ZSB0aGUgcmVhZG91dHMgd2hlbiB0aGlzIG5vZGUgdHJhbnNpdGlvbnMgZnJvbSBpbnZpc2libGUgdG8gdmlzaWJsZVxyXG4gICAgdGhpcy52aXNpYmxlUHJvcGVydHkubGF6eUxpbmsoIGEgPT4ge1xyXG4gICAgICBpZiAoIHRoaXMudmlzaWJsZSApIHtcclxuICAgICAgICB1cGRhdGVDb25jZW50cmF0aW9uUmVhZG91dFZhbHVlcygpO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG5uZXVyb24ucmVnaXN0ZXIoICdDb25jZW50cmF0aW9uUmVhZG91dExheWVyTm9kZScsIENvbmNlbnRyYXRpb25SZWFkb3V0TGF5ZXJOb2RlICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb25jZW50cmF0aW9uUmVhZG91dExheWVyTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFNBQVMsTUFBTSxrQ0FBa0M7QUFDeEQsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxXQUFXLE1BQU0sK0NBQStDO0FBQ3ZFLE9BQU9DLFFBQVEsTUFBTSx5Q0FBeUM7QUFDOUQsU0FBU0MsSUFBSSxFQUFFQyxTQUFTLEVBQUVDLElBQUksUUFBUSxtQ0FBbUM7QUFDekUsT0FBT0MsTUFBTSxNQUFNLGlCQUFpQjtBQUNwQyxPQUFPQyxhQUFhLE1BQU0sd0JBQXdCO0FBQ2xELE9BQU9DLFlBQVksTUFBTSwwQkFBMEI7QUFDbkQsT0FBT0MsU0FBUyxNQUFNLHVCQUF1QjtBQUU3QyxNQUFNQyxtREFBbUQsR0FBR0gsYUFBYSxDQUFDSSwyQkFBMkIsQ0FBRSxRQUFRLENBQUUsQ0FBRSxRQUFRLENBQUUsQ0FBRSxRQUFRLENBQUU7QUFDekksTUFBTUMsNkJBQTZCLEdBQUdMLGFBQWEsQ0FBQ00sdUJBQXVCO0FBQzNFLE1BQU1DLDBCQUEwQixHQUFHUCxhQUFhLENBQUNRLG9CQUFvQjtBQUNyRSxNQUFNQyxhQUFhLEdBQUdULGFBQWEsQ0FBQ1UsS0FBSyxDQUFDQyxFQUFFOztBQUU1QztBQUNBLE1BQU1DLGdDQUFnQyxHQUFHLENBQUM7QUFDMUMsTUFBTUMsa0JBQWtCLEdBQUcsRUFBRTtBQUM3QixNQUFNQyx1QkFBdUIsR0FBRyxDQUFDO0FBQ2pDLE1BQU1DLG1CQUFtQixHQUFHLG9CQUFvQjtBQUVoRCxNQUFNQyw2QkFBNkIsU0FBU3BCLElBQUksQ0FBQztFQUUvQztBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFcUIsV0FBV0EsQ0FBRUMsV0FBVyxFQUFFQyxZQUFZLEVBQUVDLGdCQUFnQixFQUFFQyxjQUFjLEVBQUVD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