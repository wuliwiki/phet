// Copyright 2014-2021, University of Colorado Boulder
/**
 * Container class for ChargeSymbols
 *
 * @author John Blanco
 * @author Sharfudeen Ashraf (for Ghent University)
 */

import Vector2 from '../../../../dot/js/Vector2.js';
import { Node } from '../../../../scenery/js/imports.js';
import neuron from '../../neuron.js';
import ChargeSymbolNode from './ChargeSymbolNode.js';

// Max size of the charge symbols, tweak as needed.
const MAX_CHARGE_SYMBOL_SIZE = 10;
class ChargeSymbolsLayerNode extends Node {
  /**
   * @param {NeuronModel} neuronModel
   * @param {ModelViewTransform2} mvt
   */
  constructor(neuronModel, mvt) {
    super();
    neuronModel.chargesShownProperty.link(chargesShown => {
      this.visible = chargesShown;
    });

    /**
     * Add the change symbols to the canvas.  These are added by going through the list of channels and placing two
     * symbols - one intended to be out of the membrane one one inside of it - between each pair of gates.
     */
    const addChargeSymbols = () => {
      // Create a sorted list of the membrane channels in the model.
      const sortedMembraneChannels = neuronModel.membraneChannels.slice();
      sortMembraneChannelList(sortedMembraneChannels);

      // Go through the list and put charge symbols between each pair of channels.
      for (let i = 0; i < sortedMembraneChannels.length; i++) {
        addChargeSymbolPair(sortedMembraneChannels[i], sortedMembraneChannels[(i + 1) % sortedMembraneChannels.length]);
      }
    };
    const outerChargeSymbol = new ChargeSymbolNode(neuronModel, MAX_CHARGE_SYMBOL_SIZE, 0.1, true);
    const innerChargeSymbol = new ChargeSymbolNode(neuronModel, MAX_CHARGE_SYMBOL_SIZE, 0.1, false);

    // function to add a pair of complementary charge symbols, one inside the membrane and one outside
    const addChargeSymbolPair = (channel1, channel2) => {
      const innerSymbolPosition = new Vector2(0, 0);
      const outerSymbolPosition = new Vector2(0, 0);
      const outerSymbolParentNode = new Node();
      outerSymbolParentNode.addChild(outerChargeSymbol);
      const innerSymbolParentNode = new Node();
      innerSymbolParentNode.addChild(innerChargeSymbol);
      calcChargeSymbolPositions(channel1.getCenterPosition(), channel2.getCenterPosition(), Vector2.ZERO, outerSymbolPosition, innerSymbolPosition);
      outerSymbolParentNode.setTranslation(mvt.modelToViewPosition(outerSymbolPosition));
      this.addChild(outerSymbolParentNode);
      innerSymbolParentNode.setTranslation(mvt.modelToViewPosition(innerSymbolPosition));
      this.addChild(innerSymbolParentNode);
    };

    /**
     * Calculate the positions of the charge symbols and set the two provided points accordingly.
     * @param {Vector2} p1
     * @param {Vector2} p2
     * @param {Vector2} neuronCenter
     * @param {Vector2} outerPoint // out parameter
     * @param {Vector2} innerPoint // out parameter
     */
    function calcChargeSymbolPositions(p1, p2, neuronCenter, outerPoint, innerPoint) {
      // Find the center point between the given points.
      const center = new Vector2((p1.x + p2.x) / 2, (p1.y + p2.y) / 2);

      // Convert to polar coordinates.
      const radius = Math.sqrt(Math.pow(center.x - neuronCenter.x, 2) + Math.pow(center.y - neuronCenter.y, 2));
      const angle = Math.atan2(center.y - neuronCenter.y, center.x - neuronCenter.x);

      // Add some distance to the radius to make the charge outside the cell.
      const outsideRadius = radius + 5; // Tweak as needed to position outer charge symbol. (was 4)

      // Subtract some distance from the radius to make the charge inside the cell.
      const insideRadius = radius - 4; // Tweak as needed to position outer charge symbol.(was 3 in java)

      // Convert to cartesian coordinates
      outerPoint.setXY(outsideRadius * Math.cos(angle), outsideRadius * Math.sin(angle));
      innerPoint.setXY(insideRadius * Math.cos(angle), insideRadius * Math.sin(angle));
    }

    /**
     * Sort the provided list of membrane channels such that they proceed in clockwise order around the membrane.
     * @param {Array.<MembraneChannel>} membraneChannels
     */
    function sortMembraneChannelList(membraneChannels) {
      let orderChanged = true;
      while (orderChanged) {
        orderChanged = false;
        for (let i = 0; i < membraneChannels.length - 1; i++) {
          const p1 = membraneChannels[i].getCenterPosition();
          const p2 = membraneChannels[i + 1].getCenterPosition();
          const a1 = Math.atan2(p1.y, p1.x);
          const a2 = Math.atan2(p2.y, p2.x);
          if (a1 > a2) {
            // These two need to be swapped.
            const tempChannel = membraneChannels[i];
            membraneChannels[i] = membraneChannels[i + 1];
            membraneChannels[i + 1] = tempChannel;
            orderChanged = true;
          }
        }
      }
    }
    addChargeSymbols();
  }
}
neuron.register('ChargeSymbolsLayerNode', ChargeSymbolsLayerNode);
export default ChargeSymbolsLayerNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWZWN0b3IyIiwiTm9kZSIsIm5ldXJvbiIsIkNoYXJnZVN5bWJvbE5vZGUiLCJNQVhfQ0hBUkdFX1NZTUJPTF9TSVpFIiwiQ2hhcmdlU3ltYm9sc0xheWVyTm9kZSIsImNvbnN0cnVjdG9yIiwibmV1cm9uTW9kZWwiLCJtdnQiLCJjaGFyZ2VzU2hvd25Qcm9wZXJ0eSIsImxpbmsiLCJjaGFyZ2VzU2hvd24iLCJ2aXNpYmxlIiwiYWRkQ2hhcmdlU3ltYm9scyIsInNvcnRlZE1lbWJyYW5lQ2hhbm5lbHMiLCJtZW1icmFuZUNoYW5uZWxzIiwic2xpY2UiLCJzb3J0TWVtYnJhbmVDaGFubmVsTGlzdCIsImkiLCJsZW5ndGgiLCJhZGRDaGFyZ2VTeW1ib2xQYWlyIiwib3V0ZXJDaGFyZ2VTeW1ib2wiLCJpbm5lckNoYXJnZVN5bWJvbCIsImNoYW5uZWwxIiwiY2hhbm5lbDIiLCJpbm5lclN5bWJvbFBvc2l0aW9uIiwib3V0ZXJTeW1ib2xQb3NpdGlvbiIsIm91dGVyU3ltYm9sUGFyZW50Tm9kZSIsImFkZENoaWxkIiwiaW5uZXJTeW1ib2xQYXJlbnROb2RlIiwiY2FsY0NoYXJnZVN5bWJvbFBvc2l0aW9ucyIsImdldENlbnRlclBvc2l0aW9uIiwiWkVSTyIsInNldFRyYW5zbGF0aW9uIiwibW9kZWxUb1ZpZXdQb3NpdGlvbiIsInAxIiwicDIiLCJuZXVyb25DZW50ZXIiLCJvdXRlclBvaW50IiwiaW5uZXJQb2ludCIsImNlbnRlciIsIngiLCJ5IiwicmFkaXVzIiwiTWF0aCIsInNxcnQiLCJwb3ciLCJhbmdsZSIsImF0YW4yIiwib3V0c2lkZVJhZGl1cyIsImluc2lkZVJhZGl1cyIsInNldFhZIiwiY29zIiwic2luIiwib3JkZXJDaGFuZ2VkIiwiYTEiLCJhMiIsInRlbXBDaGFubmVsIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJDaGFyZ2VTeW1ib2xzTGF5ZXJOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjEsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG4vKipcclxuICogQ29udGFpbmVyIGNsYXNzIGZvciBDaGFyZ2VTeW1ib2xzXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY29cclxuICogQGF1dGhvciBTaGFyZnVkZWVuIEFzaHJhZiAoZm9yIEdoZW50IFVuaXZlcnNpdHkpXHJcbiAqL1xyXG5cclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgeyBOb2RlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IG5ldXJvbiBmcm9tICcuLi8uLi9uZXVyb24uanMnO1xyXG5pbXBvcnQgQ2hhcmdlU3ltYm9sTm9kZSBmcm9tICcuL0NoYXJnZVN5bWJvbE5vZGUuanMnO1xyXG5cclxuLy8gTWF4IHNpemUgb2YgdGhlIGNoYXJnZSBzeW1ib2xzLCB0d2VhayBhcyBuZWVkZWQuXHJcbmNvbnN0IE1BWF9DSEFSR0VfU1lNQk9MX1NJWkUgPSAxMDtcclxuXHJcbmNsYXNzIENoYXJnZVN5bWJvbHNMYXllck5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtOZXVyb25Nb2RlbH0gbmV1cm9uTW9kZWxcclxuICAgKiBAcGFyYW0ge01vZGVsVmlld1RyYW5zZm9ybTJ9IG12dFxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBuZXVyb25Nb2RlbCwgbXZ0ICkge1xyXG5cclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgbmV1cm9uTW9kZWwuY2hhcmdlc1Nob3duUHJvcGVydHkubGluayggY2hhcmdlc1Nob3duID0+IHtcclxuICAgICAgdGhpcy52aXNpYmxlID0gY2hhcmdlc1Nob3duO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkIHRoZSBjaGFuZ2Ugc3ltYm9scyB0byB0aGUgY2FudmFzLiAgVGhlc2UgYXJlIGFkZGVkIGJ5IGdvaW5nIHRocm91Z2ggdGhlIGxpc3Qgb2YgY2hhbm5lbHMgYW5kIHBsYWNpbmcgdHdvXHJcbiAgICAgKiBzeW1ib2xzIC0gb25lIGludGVuZGVkIHRvIGJlIG91dCBvZiB0aGUgbWVtYnJhbmUgb25lIG9uZSBpbnNpZGUgb2YgaXQgLSBiZXR3ZWVuIGVhY2ggcGFpciBvZiBnYXRlcy5cclxuICAgICAqL1xyXG4gICAgY29uc3QgYWRkQ2hhcmdlU3ltYm9scyA9ICgpID0+IHtcclxuICAgICAgLy8gQ3JlYXRlIGEgc29ydGVkIGxpc3Qgb2YgdGhlIG1lbWJyYW5lIGNoYW5uZWxzIGluIHRoZSBtb2RlbC5cclxuICAgICAgY29uc3Qgc29ydGVkTWVtYnJhbmVDaGFubmVscyA9IG5ldXJvbk1vZGVsLm1lbWJyYW5lQ2hhbm5lbHMuc2xpY2UoKTtcclxuICAgICAgc29ydE1lbWJyYW5lQ2hhbm5lbExpc3QoIHNvcnRlZE1lbWJyYW5lQ2hhbm5lbHMgKTtcclxuXHJcbiAgICAgIC8vIEdvIHRocm91Z2ggdGhlIGxpc3QgYW5kIHB1dCBjaGFyZ2Ugc3ltYm9scyBiZXR3ZWVuIGVhY2ggcGFpciBvZiBjaGFubmVscy5cclxuICAgICAgZm9yICggbGV0IGkgPSAwOyBpIDwgc29ydGVkTWVtYnJhbmVDaGFubmVscy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICBhZGRDaGFyZ2VTeW1ib2xQYWlyKCBzb3J0ZWRNZW1icmFuZUNoYW5uZWxzWyBpIF0sIHNvcnRlZE1lbWJyYW5lQ2hhbm5lbHNbICggaSArIDEgKSAlIHNvcnRlZE1lbWJyYW5lQ2hhbm5lbHMubGVuZ3RoIF0gKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBvdXRlckNoYXJnZVN5bWJvbCA9IG5ldyBDaGFyZ2VTeW1ib2xOb2RlKCBuZXVyb25Nb2RlbCwgTUFYX0NIQVJHRV9TWU1CT0xfU0laRSwgMC4xLCB0cnVlICk7XHJcbiAgICBjb25zdCBpbm5lckNoYXJnZVN5bWJvbCA9IG5ldyBDaGFyZ2VTeW1ib2xOb2RlKCBuZXVyb25Nb2RlbCwgTUFYX0NIQVJHRV9TWU1CT0xfU0laRSwgMC4xLCBmYWxzZSApO1xyXG5cclxuICAgIC8vIGZ1bmN0aW9uIHRvIGFkZCBhIHBhaXIgb2YgY29tcGxlbWVudGFyeSBjaGFyZ2Ugc3ltYm9scywgb25lIGluc2lkZSB0aGUgbWVtYnJhbmUgYW5kIG9uZSBvdXRzaWRlXHJcbiAgICBjb25zdCBhZGRDaGFyZ2VTeW1ib2xQYWlyID0gKCBjaGFubmVsMSwgY2hhbm5lbDIgKSA9PiB7XHJcblxyXG4gICAgICBjb25zdCBpbm5lclN5bWJvbFBvc2l0aW9uID0gbmV3IFZlY3RvcjIoIDAsIDAgKTtcclxuICAgICAgY29uc3Qgb3V0ZXJTeW1ib2xQb3NpdGlvbiA9IG5ldyBWZWN0b3IyKCAwLCAwICk7XHJcbiAgICAgIGNvbnN0IG91dGVyU3ltYm9sUGFyZW50Tm9kZSA9IG5ldyBOb2RlKCk7XHJcbiAgICAgIG91dGVyU3ltYm9sUGFyZW50Tm9kZS5hZGRDaGlsZCggb3V0ZXJDaGFyZ2VTeW1ib2wgKTtcclxuICAgICAgY29uc3QgaW5uZXJTeW1ib2xQYXJlbnROb2RlID0gbmV3IE5vZGUoKTtcclxuICAgICAgaW5uZXJTeW1ib2xQYXJlbnROb2RlLmFkZENoaWxkKCBpbm5lckNoYXJnZVN5bWJvbCApO1xyXG5cclxuICAgICAgY2FsY0NoYXJnZVN5bWJvbFBvc2l0aW9ucyggY2hhbm5lbDEuZ2V0Q2VudGVyUG9zaXRpb24oKSwgY2hhbm5lbDIuZ2V0Q2VudGVyUG9zaXRpb24oKSwgVmVjdG9yMi5aRVJPLCBvdXRlclN5bWJvbFBvc2l0aW9uLCBpbm5lclN5bWJvbFBvc2l0aW9uICk7XHJcbiAgICAgIG91dGVyU3ltYm9sUGFyZW50Tm9kZS5zZXRUcmFuc2xhdGlvbiggbXZ0Lm1vZGVsVG9WaWV3UG9zaXRpb24oIG91dGVyU3ltYm9sUG9zaXRpb24gKSApO1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCBvdXRlclN5bWJvbFBhcmVudE5vZGUgKTtcclxuICAgICAgaW5uZXJTeW1ib2xQYXJlbnROb2RlLnNldFRyYW5zbGF0aW9uKCBtdnQubW9kZWxUb1ZpZXdQb3NpdGlvbiggaW5uZXJTeW1ib2xQb3NpdGlvbiApICk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIGlubmVyU3ltYm9sUGFyZW50Tm9kZSApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGN1bGF0ZSB0aGUgcG9zaXRpb25zIG9mIHRoZSBjaGFyZ2Ugc3ltYm9scyBhbmQgc2V0IHRoZSB0d28gcHJvdmlkZWQgcG9pbnRzIGFjY29yZGluZ2x5LlxyXG4gICAgICogQHBhcmFtIHtWZWN0b3IyfSBwMVxyXG4gICAgICogQHBhcmFtIHtWZWN0b3IyfSBwMlxyXG4gICAgICogQHBhcmFtIHtWZWN0b3IyfSBuZXVyb25DZW50ZXJcclxuICAgICAqIEBwYXJhbSB7VmVjdG9yMn0gb3V0ZXJQb2ludCAvLyBvdXQgcGFyYW1ldGVyXHJcbiAgICAgKiBAcGFyYW0ge1ZlY3RvcjJ9IGlubmVyUG9pbnQgLy8gb3V0IHBhcmFtZXRlclxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjYWxjQ2hhcmdlU3ltYm9sUG9zaXRpb25zKCBwMSwgcDIsIG5ldXJvbkNlbnRlciwgb3V0ZXJQb2ludCwgaW5uZXJQb2ludCApIHtcclxuXHJcbiAgICAgIC8vIEZpbmQgdGhlIGNlbnRlciBwb2ludCBiZXR3ZWVuIHRoZSBnaXZlbiBwb2ludHMuXHJcbiAgICAgIGNvbnN0IGNlbnRlciA9IG5ldyBWZWN0b3IyKCAoIHAxLnggKyBwMi54ICkgLyAyLCAoIHAxLnkgKyBwMi55ICkgLyAyICk7XHJcblxyXG4gICAgICAvLyBDb252ZXJ0IHRvIHBvbGFyIGNvb3JkaW5hdGVzLlxyXG4gICAgICBjb25zdCByYWRpdXMgPSBNYXRoLnNxcnQoIE1hdGgucG93KCBjZW50ZXIueCAtIG5ldXJvbkNlbnRlci54LCAyICkgKyBNYXRoLnBvdyggY2VudGVyLnkgLSBuZXVyb25DZW50ZXIueSwgMiApICk7XHJcbiAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5hdGFuMiggY2VudGVyLnkgLSBuZXVyb25DZW50ZXIueSwgY2VudGVyLnggLSBuZXVyb25DZW50ZXIueCApO1xyXG5cclxuICAgICAgLy8gQWRkIHNvbWUgZGlzdGFuY2UgdG8gdGhlIHJhZGl1cyB0byBtYWtlIHRoZSBjaGFyZ2Ugb3V0c2lkZSB0aGUgY2VsbC5cclxuICAgICAgY29uc3Qgb3V0c2lkZVJhZGl1cyA9IHJhZGl1cyArIDU7IC8vIFR3ZWFrIGFzIG5lZWRlZCB0byBwb3NpdGlvbiBvdXRlciBjaGFyZ2Ugc3ltYm9sLiAod2FzIDQpXHJcblxyXG4gICAgICAvLyBTdWJ0cmFjdCBzb21lIGRpc3RhbmNlIGZyb20gdGhlIHJhZGl1cyB0byBtYWtlIHRoZSBjaGFyZ2UgaW5zaWRlIHRoZSBjZWxsLlxyXG4gICAgICBjb25zdCBpbnNpZGVSYWRpdXMgPSByYWRpdXMgLSA0OyAvLyBUd2VhayBhcyBuZWVkZWQgdG8gcG9zaXRpb24gb3V0ZXIgY2hhcmdlIHN5bWJvbC4od2FzIDMgaW4gamF2YSlcclxuXHJcbiAgICAgIC8vIENvbnZlcnQgdG8gY2FydGVzaWFuIGNvb3JkaW5hdGVzXHJcbiAgICAgIG91dGVyUG9pbnQuc2V0WFkoIG91dHNpZGVSYWRpdXMgKiBNYXRoLmNvcyggYW5nbGUgKSwgb3V0c2lkZVJhZGl1cyAqIE1hdGguc2luKCBhbmdsZSApICk7XHJcbiAgICAgIGlubmVyUG9pbnQuc2V0WFkoIGluc2lkZVJhZGl1cyAqIE1hdGguY29zKCBhbmdsZSApLCBpbnNpZGVSYWRpdXMgKiBNYXRoLnNpbiggYW5nbGUgKSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU29ydCB0aGUgcHJvdmlkZWQgbGlzdCBvZiBtZW1icmFuZSBjaGFubmVscyBzdWNoIHRoYXQgdGhleSBwcm9jZWVkIGluIGNsb2Nrd2lzZSBvcmRlciBhcm91bmQgdGhlIG1lbWJyYW5lLlxyXG4gICAgICogQHBhcmFtIHtBcnJheS48TWVtYnJhbmVDaGFubmVsPn0gbWVtYnJhbmVDaGFubmVsc1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBzb3J0TWVtYnJhbmVDaGFubmVsTGlzdCggbWVtYnJhbmVDaGFubmVscyApIHtcclxuICAgICAgbGV0IG9yZGVyQ2hhbmdlZCA9IHRydWU7XHJcbiAgICAgIHdoaWxlICggb3JkZXJDaGFuZ2VkICkge1xyXG4gICAgICAgIG9yZGVyQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAoIGxldCBpID0gMDsgaSA8IG1lbWJyYW5lQ2hhbm5lbHMubGVuZ3RoIC0gMTsgaSsrICkge1xyXG4gICAgICAgICAgY29uc3QgcDEgPSBtZW1icmFuZUNoYW5uZWxzWyBpIF0uZ2V0Q2VudGVyUG9zaXRpb24oKTtcclxuICAgICAgICAgIGNvbnN0IHAyID0gbWVtYnJhbmVDaGFubmVsc1sgaSArIDEgXS5nZXRDZW50ZXJQb3NpdGlvbigpO1xyXG4gICAgICAgICAgY29uc3QgYTEgPSBNYXRoLmF0YW4yKCBwMS55LCBwMS54ICk7XHJcbiAgICAgICAgICBjb25zdCBhMiA9IE1hdGguYXRhbjIoIHAyLnksIHAyLnggKTtcclxuICAgICAgICAgIGlmICggYTEgPiBhMiApIHtcclxuICAgICAgICAgICAgLy8gVGhlc2UgdHdvIG5lZWQgdG8gYmUgc3dhcHBlZC5cclxuICAgICAgICAgICAgY29uc3QgdGVtcENoYW5uZWwgPSBtZW1icmFuZUNoYW5uZWxzWyBpIF07XHJcbiAgICAgICAgICAgIG1lbWJyYW5lQ2hhbm5lbHNbIGkgXSA9IG1lbWJyYW5lQ2hhbm5lbHNbIGkgKyAxIF07XHJcbiAgICAgICAgICAgIG1lbWJyYW5lQ2hhbm5lbHNbIGkgKyAxIF0gPSB0ZW1wQ2hhbm5lbDtcclxuICAgICAgICAgICAgb3JkZXJDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhZGRDaGFyZ2VTeW1ib2xzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5uZXVyb24ucmVnaXN0ZXIoICdDaGFyZ2VTeW1ib2xzTGF5ZXJOb2RlJywgQ2hhcmdlU3ltYm9sc0xheWVyTm9kZSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2hhcmdlU3ltYm9sc0xheWVyTm9kZTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxPQUFPLE1BQU0sK0JBQStCO0FBQ25ELFNBQVNDLElBQUksUUFBUSxtQ0FBbUM7QUFDeEQsT0FBT0MsTUFBTSxNQUFNLGlCQUFpQjtBQUNwQyxPQUFPQyxnQkFBZ0IsTUFBTSx1QkFBdUI7O0FBRXBEO0FBQ0EsTUFBTUMsc0JBQXNCLEdBQUcsRUFBRTtBQUVqQyxNQUFNQyxzQkFBc0IsU0FBU0osSUFBSSxDQUFDO0VBRXhDO0FBQ0Y7QUFDQTtBQUNBO0VBQ0VLLFdBQVdBLENBQUVDLFdBQVcsRUFBRUMsR0FBRyxFQUFHO0lBRTlCLEtBQUssQ0FBQyxDQUFDO0lBRVBELFdBQVcsQ0FBQ0Usb0JBQW9CLENBQUNDLElBQUksQ0FBRUMsWUFBWSxJQUFJO01BQ3JELElBQUksQ0FBQ0MsT0FBTyxHQUFHRCxZQUFZO0lBQzdCLENBQUUsQ0FBQzs7SUFFSDtBQUNKO0FBQ0E7QUFDQTtJQUNJLE1BQU1FLGdCQUFnQixHQUFHQSxDQUFBLEtBQU07TUFDN0I7TUFDQSxNQUFNQyxzQkFBc0IsR0FBR1AsV0FBVyxDQUFDUSxnQkFBZ0IsQ0FBQ0MsS0FBSyxDQUFDLENBQUM7TUFDbkVDLHVCQUF1QixDQUFFSCxzQkFBdUIsQ0FBQzs7TUFFakQ7TUFDQSxLQUFNLElBQUlJLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR0osc0JBQXNCLENBQUNLLE1BQU0sRUFBRUQsQ0FBQyxFQUFFLEVBQUc7UUFDeERFLG1CQUFtQixDQUFFTixzQkFBc0IsQ0FBRUksQ0FBQyxDQUFFLEVBQUVKLHNCQUFzQixDQUFFLENBQUVJLENBQUMsR0FBRyxDQUFDLElBQUtKLHNCQUFzQixDQUFDSyxNQUFNLENBQUcsQ0FBQztNQUN6SDtJQUNGLENBQUM7SUFFRCxNQUFNRSxpQkFB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