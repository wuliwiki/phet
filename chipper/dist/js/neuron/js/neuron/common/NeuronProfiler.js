// Copyright 2015-2021, University of Colorado Boulder

/**
 * Sim-specific code for profiling, created for testing optimizations.  This profiler can be triggered via a method call
 * and will then gather profiling data for the specified amount of time, and then log the collected information to the
 * console.  On iOS devices, it displays the information in an "alert" window.
 */

import Utils from '../../../../dot/js/Utils.js';
import platform from '../../../../phet-core/js/platform.js';
import neuron from '../../neuron.js';
class NeuronProfiler {
  /**
   * @param {Sim} sim - reference to the simulation being profiled
   * @param {number} setting - profiling to be done, values are:
   *    1=profile from when the traveling action potential reaches cross section until all or most of the dynamically
   *      created particles are gone
   *    2=profile from neuron stimulated until traveling action potential reaches the cross section
   *    3=profile from neuron stimulated until all or most of the dynamically created particles have disappeared
   */
  constructor(sim, setting) {
    assert && assert(setting >= 1 && setting <= 3, `invalid profiler setting, value = ${setting}`);
    this.setting = setting; // @public, read only

    this.frameCount = 0;
    this.dataCollectionInProgress = false; // @private
    this.dataCollectionStartTime = Number.NEGATIVE_INFINITY; // @private, in milliseconds
    this.dataCollectionDuration = Number.POSITIVE_INFINITY; // @private, in milliseconds
    this.frameStartedTimes = []; // @private, in milliseconds
    this.frameEndedTimes = []; // @private, in milliseconds
    this.frameProcessingTimes = []; // @private, time between frame started and frame completed events in milliseconds

    sim.frameStartedEmitter.addListener(() => {
      if (this.dataCollectionInProgress) {
        this.frameStartedTimes[this.frameCount] = new Date().getTime();
      }
    });
    sim.frameEndedEmitter.addListener(() => {
      if (this.dataCollectionInProgress && this.frameStartedTimes.length !== 0) {
        const currentTime = new Date().getTime();
        this.frameEndedTimes[this.frameCount] = currentTime;
        this.frameProcessingTimes[this.frameCount] = currentTime - this.frameStartedTimes[this.frameCount];
        this.frameCount++;

        // check if the data collection is complete
        if (new Date().getTime() > this.dataCollectionStartTime + this.dataCollectionDuration) {
          this.dataCollectionInProgress = false; // clear the collection flag

          // process the collected data
          const testDurationInSeconds = this.dataCollectionDuration / 1000;
          let maxFrameProcessingTime = 0;
          let totalFrameProcessingTime = 0;
          for (let i = 0; i < this.frameCount; i++) {
            totalFrameProcessingTime += this.frameProcessingTimes[i];
            if (this.frameProcessingTimes[i] > maxFrameProcessingTime) {
              maxFrameProcessingTime = this.frameProcessingTimes[i];
            }
          }
          const averageFrameProcessingTime = totalFrameProcessingTime / this.frameCount;

          // compose the message that will present the data
          const message = `average FPS over previous ${testDurationInSeconds} seconds = ${Utils.toFixed(this.frameCount / (this.dataCollectionDuration / 1000), 2)}\n` + `average frame processing time = ${Utils.toFixed(averageFrameProcessingTime, 2)} ms\n` + `max frame processing time = ${Utils.toFixed(maxFrameProcessingTime, 2)} ms\n`;

          // display the message
          if (platform.mobileSafari) {
            // pop up the message in an alert dialog, since the console is not available
            alert(message);
          } else {
            console.log('------------ Profiling Result ------------------');
            console.log(message);
          }
        }
      }
    });
  }

  /**
   * Initiate the collection of data for the specified duration.  Once the specified time has passed, the results
   * will be displayed in a popup dialog.
   * @param {number} duration - in milliseconds
   * @public
   */
  startDataAnalysis(duration) {
    if (this.dataCollectionInProgress) {
      throw new Error('Attempt to start data collection when already in progress.');
    }
    this.frameCount = 0;
    this.dataCollectionInProgress = true; // @private
    this.dataCollectionStartTime = new Date().getTime(); // @private, in milliseconds
    this.dataCollectionDuration = duration; // @private, in milliseconds
    this.frameStartedTimes.length = 0;
    this.frameEndedTimes.length = 0;
    this.frameProcessingTimes.length = 0;
  }
}
neuron.register('NeuronProfiler', NeuronProfiler);
export default NeuronProfiler;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsInBsYXRmb3JtIiwibmV1cm9uIiwiTmV1cm9uUHJvZmlsZXIiLCJjb25zdHJ1Y3RvciIsInNpbSIsInNldHRpbmciLCJhc3NlcnQiLCJmcmFtZUNvdW50IiwiZGF0YUNvbGxlY3Rpb25JblByb2dyZXNzIiwiZGF0YUNvbGxlY3Rpb25TdGFydFRpbWUiLCJOdW1iZXIiLCJORUdBVElWRV9JTkZJTklUWSIsImRhdGFDb2xsZWN0aW9uRHVyYXRpb24iLCJQT1NJVElWRV9JTkZJTklUWSIsImZyYW1lU3RhcnRlZFRpbWVzIiwiZnJhbWVFbmRlZFRpbWVzIiwiZnJhbWVQcm9jZXNzaW5nVGltZXMiLCJmcmFtZVN0YXJ0ZWRFbWl0dGVyIiwiYWRkTGlzdGVuZXIiLCJEYXRlIiwiZ2V0VGltZSIsImZyYW1lRW5kZWRFbWl0dGVyIiwibGVuZ3RoIiwiY3VycmVudFRpbWUiLCJ0ZXN0RHVyYXRpb25JblNlY29uZHMiLCJtYXhGcmFtZVByb2Nlc3NpbmdUaW1lIiwidG90YWxGcmFtZVByb2Nlc3NpbmdUaW1lIiwiaSIsImF2ZXJhZ2VGcmFtZVByb2Nlc3NpbmdUaW1lIiwibWVzc2FnZSIsInRvRml4ZWQiLCJtb2JpbGVTYWZhcmkiLCJhbGVydCIsImNvbnNvbGUiLCJsb2ciLCJzdGFydERhdGFBbmFseXNpcyIsImR1cmF0aW9uIiwiRXJyb3IiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIk5ldXJvblByb2ZpbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE1LTIwMjEsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFNpbS1zcGVjaWZpYyBjb2RlIGZvciBwcm9maWxpbmcsIGNyZWF0ZWQgZm9yIHRlc3Rpbmcgb3B0aW1pemF0aW9ucy4gIFRoaXMgcHJvZmlsZXIgY2FuIGJlIHRyaWdnZXJlZCB2aWEgYSBtZXRob2QgY2FsbFxyXG4gKiBhbmQgd2lsbCB0aGVuIGdhdGhlciBwcm9maWxpbmcgZGF0YSBmb3IgdGhlIHNwZWNpZmllZCBhbW91bnQgb2YgdGltZSwgYW5kIHRoZW4gbG9nIHRoZSBjb2xsZWN0ZWQgaW5mb3JtYXRpb24gdG8gdGhlXHJcbiAqIGNvbnNvbGUuICBPbiBpT1MgZGV2aWNlcywgaXQgZGlzcGxheXMgdGhlIGluZm9ybWF0aW9uIGluIGFuIFwiYWxlcnRcIiB3aW5kb3cuXHJcbiAqL1xyXG5cclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCBwbGF0Zm9ybSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvcGxhdGZvcm0uanMnO1xyXG5pbXBvcnQgbmV1cm9uIGZyb20gJy4uLy4uL25ldXJvbi5qcyc7XHJcblxyXG5jbGFzcyBOZXVyb25Qcm9maWxlciB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7U2ltfSBzaW0gLSByZWZlcmVuY2UgdG8gdGhlIHNpbXVsYXRpb24gYmVpbmcgcHJvZmlsZWRcclxuICAgKiBAcGFyYW0ge251bWJlcn0gc2V0dGluZyAtIHByb2ZpbGluZyB0byBiZSBkb25lLCB2YWx1ZXMgYXJlOlxyXG4gICAqICAgIDE9cHJvZmlsZSBmcm9tIHdoZW4gdGhlIHRyYXZlbGluZyBhY3Rpb24gcG90ZW50aWFsIHJlYWNoZXMgY3Jvc3Mgc2VjdGlvbiB1bnRpbCBhbGwgb3IgbW9zdCBvZiB0aGUgZHluYW1pY2FsbHlcclxuICAgKiAgICAgIGNyZWF0ZWQgcGFydGljbGVzIGFyZSBnb25lXHJcbiAgICogICAgMj1wcm9maWxlIGZyb20gbmV1cm9uIHN0aW11bGF0ZWQgdW50aWwgdHJhdmVsaW5nIGFjdGlvbiBwb3RlbnRpYWwgcmVhY2hlcyB0aGUgY3Jvc3Mgc2VjdGlvblxyXG4gICAqICAgIDM9cHJvZmlsZSBmcm9tIG5ldXJvbiBzdGltdWxhdGVkIHVudGlsIGFsbCBvciBtb3N0IG9mIHRoZSBkeW5hbWljYWxseSBjcmVhdGVkIHBhcnRpY2xlcyBoYXZlIGRpc2FwcGVhcmVkXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHNpbSwgc2V0dGluZyApIHtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBzZXR0aW5nID49IDEgJiYgc2V0dGluZyA8PSAzLCBgaW52YWxpZCBwcm9maWxlciBzZXR0aW5nLCB2YWx1ZSA9ICR7c2V0dGluZ31gICk7XHJcblxyXG4gICAgdGhpcy5zZXR0aW5nID0gc2V0dGluZzsgLy8gQHB1YmxpYywgcmVhZCBvbmx5XHJcblxyXG4gICAgdGhpcy5mcmFtZUNvdW50ID0gMDtcclxuICAgIHRoaXMuZGF0YUNvbGxlY3Rpb25JblByb2dyZXNzID0gZmFsc2U7IC8vIEBwcml2YXRlXHJcbiAgICB0aGlzLmRhdGFDb2xsZWN0aW9uU3RhcnRUaW1lID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZOyAvLyBAcHJpdmF0ZSwgaW4gbWlsbGlzZWNvbmRzXHJcbiAgICB0aGlzLmRhdGFDb2xsZWN0aW9uRHVyYXRpb24gPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7IC8vIEBwcml2YXRlLCBpbiBtaWxsaXNlY29uZHNcclxuICAgIHRoaXMuZnJhbWVTdGFydGVkVGltZXMgPSBbXTsgLy8gQHByaXZhdGUsIGluIG1pbGxpc2Vjb25kc1xyXG4gICAgdGhpcy5mcmFtZUVuZGVkVGltZXMgPSBbXTsgLy8gQHByaXZhdGUsIGluIG1pbGxpc2Vjb25kc1xyXG4gICAgdGhpcy5mcmFtZVByb2Nlc3NpbmdUaW1lcyA9IFtdOyAvLyBAcHJpdmF0ZSwgdGltZSBiZXR3ZWVuIGZyYW1lIHN0YXJ0ZWQgYW5kIGZyYW1lIGNvbXBsZXRlZCBldmVudHMgaW4gbWlsbGlzZWNvbmRzXHJcblxyXG4gICAgc2ltLmZyYW1lU3RhcnRlZEVtaXR0ZXIuYWRkTGlzdGVuZXIoICgpID0+IHtcclxuICAgICAgaWYgKCB0aGlzLmRhdGFDb2xsZWN0aW9uSW5Qcm9ncmVzcyApIHtcclxuICAgICAgICB0aGlzLmZyYW1lU3RhcnRlZFRpbWVzWyB0aGlzLmZyYW1lQ291bnQgXSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgc2ltLmZyYW1lRW5kZWRFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiB7XHJcbiAgICAgIGlmICggdGhpcy5kYXRhQ29sbGVjdGlvbkluUHJvZ3Jlc3MgJiYgdGhpcy5mcmFtZVN0YXJ0ZWRUaW1lcy5sZW5ndGggIT09IDAgKSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgICB0aGlzLmZyYW1lRW5kZWRUaW1lc1sgdGhpcy5mcmFtZUNvdW50IF0gPSBjdXJyZW50VGltZTtcclxuICAgICAgICB0aGlzLmZyYW1lUHJvY2Vzc2luZ1RpbWVzWyB0aGlzLmZyYW1lQ291bnQgXSA9IGN1cnJlbnRUaW1lIC0gdGhpcy5mcmFtZVN0YXJ0ZWRUaW1lc1sgdGhpcy5mcmFtZUNvdW50IF07XHJcbiAgICAgICAgdGhpcy5mcmFtZUNvdW50Kys7XHJcblxyXG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSBkYXRhIGNvbGxlY3Rpb24gaXMgY29tcGxldGVcclxuICAgICAgICBpZiAoIG5ldyBEYXRlKCkuZ2V0VGltZSgpID4gdGhpcy5kYXRhQ29sbGVjdGlvblN0YXJ0VGltZSArIHRoaXMuZGF0YUNvbGxlY3Rpb25EdXJhdGlvbiApIHtcclxuXHJcbiAgICAgICAgICB0aGlzLmRhdGFDb2xsZWN0aW9uSW5Qcm9ncmVzcyA9IGZhbHNlOyAvLyBjbGVhciB0aGUgY29sbGVjdGlvbiBmbGFnXHJcblxyXG4gICAgICAgICAgLy8gcHJvY2VzcyB0aGUgY29sbGVjdGVkIGRhdGFcclxuICAgICAgICAgIGNvbnN0IHRlc3REdXJhdGlvbkluU2Vjb25kcyA9IHRoaXMuZGF0YUNvbGxlY3Rpb25EdXJhdGlvbiAvIDEwMDA7XHJcbiAgICAgICAgICBsZXQgbWF4RnJhbWVQcm9jZXNzaW5nVGltZSA9IDA7XHJcbiAgICAgICAgICBsZXQgdG90YWxGcmFtZVByb2Nlc3NpbmdUaW1lID0gMDtcclxuICAgICAgICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHRoaXMuZnJhbWVDb3VudDsgaSsrICkge1xyXG4gICAgICAgICAgICB0b3RhbEZyYW1lUHJvY2Vzc2luZ1RpbWUgKz0gdGhpcy5mcmFtZVByb2Nlc3NpbmdUaW1lc1sgaSBdO1xyXG4gICAgICAgICAgICBpZiAoIHRoaXMuZnJhbWVQcm9jZXNzaW5nVGltZXNbIGkgXSA+IG1heEZyYW1lUHJvY2Vzc2luZ1RpbWUgKSB7XHJcbiAgICAgICAgICAgICAgbWF4RnJhbWVQcm9jZXNzaW5nVGltZSA9IHRoaXMuZnJhbWVQcm9jZXNzaW5nVGltZXNbIGkgXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY29uc3QgYXZlcmFnZUZyYW1lUHJvY2Vzc2luZ1RpbWUgPSB0b3RhbEZyYW1lUHJvY2Vzc2luZ1RpbWUgLyB0aGlzLmZyYW1lQ291bnQ7XHJcblxyXG4gICAgICAgICAgLy8gY29tcG9zZSB0aGUgbWVzc2FnZSB0aGF0IHdpbGwgcHJlc2VudCB0aGUgZGF0YVxyXG4gICAgICAgICAgY29uc3QgbWVzc2FnZSA9XHJcbiAgICAgICAgICAgIGBhdmVyYWdlIEZQUyBvdmVyIHByZXZpb3VzICR7dGVzdER1cmF0aW9uSW5TZWNvbmRzfSBzZWNvbmRzID0gJHtcclxuICAgICAgICAgICAgICBVdGlscy50b0ZpeGVkKCB0aGlzLmZyYW1lQ291bnQgLyAoIHRoaXMuZGF0YUNvbGxlY3Rpb25EdXJhdGlvbiAvIDEwMDAgKSwgMiApfVxcbmAgK1xyXG4gICAgICAgICAgICBgYXZlcmFnZSBmcmFtZSBwcm9jZXNzaW5nIHRpbWUgPSAke1V0aWxzLnRvRml4ZWQoIGF2ZXJhZ2VGcmFtZVByb2Nlc3NpbmdUaW1lLCAyICl9IG1zXFxuYCArXHJcbiAgICAgICAgICAgIGBtYXggZnJhbWUgcHJvY2Vzc2luZyB0aW1lID0gJHtVdGlscy50b0ZpeGVkKCBtYXhGcmFtZVByb2Nlc3NpbmdUaW1lLCAyICl9IG1zXFxuYDtcclxuXHJcbiAgICAgICAgICAvLyBkaXNwbGF5IHRoZSBtZXNzYWdlXHJcbiAgICAgICAgICBpZiAoIHBsYXRmb3JtLm1vYmlsZVNhZmFyaSApIHtcclxuICAgICAgICAgICAgLy8gcG9wIHVwIHRoZSBtZXNzYWdlIGluIGFuIGFsZXJ0IGRpYWxvZywgc2luY2UgdGhlIGNvbnNvbGUgaXMgbm90IGF2YWlsYWJsZVxyXG4gICAgICAgICAgICBhbGVydCggbWVzc2FnZSApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnLS0tLS0tLS0tLS0tIFByb2ZpbGluZyBSZXN1bHQgLS0tLS0tLS0tLS0tLS0tLS0tJyApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyggbWVzc2FnZSApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW5pdGlhdGUgdGhlIGNvbGxlY3Rpb24gb2YgZGF0YSBmb3IgdGhlIHNwZWNpZmllZCBkdXJhdGlvbi4gIE9uY2UgdGhlIHNwZWNpZmllZCB0aW1lIGhhcyBwYXNzZWQsIHRoZSByZXN1bHRzXHJcbiAgICogd2lsbCBiZSBkaXNwbGF5ZWQgaW4gYSBwb3B1cCBkaWFsb2cuXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIC0gaW4gbWlsbGlzZWNvbmRzXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIHN0YXJ0RGF0YUFuYWx5c2lzKCBkdXJhdGlvbiApIHtcclxuICAgIGlmICggdGhpcy5kYXRhQ29sbGVjdGlvbkluUHJvZ3Jlc3MgKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvciggJ0F0dGVtcHQgdG8gc3RhcnQgZGF0YSBjb2xsZWN0aW9uIHdoZW4gYWxyZWFkeSBpbiBwcm9ncmVzcy4nICk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmZyYW1lQ291bnQgPSAwO1xyXG4gICAgdGhpcy5kYXRhQ29sbGVjdGlvbkluUHJvZ3Jlc3MgPSB0cnVlOyAvLyBAcHJpdmF0ZVxyXG4gICAgdGhpcy5kYXRhQ29sbGVjdGlvblN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOyAvLyBAcHJpdmF0ZSwgaW4gbWlsbGlzZWNvbmRzXHJcbiAgICB0aGlzLmRhdGFDb2xsZWN0aW9uRHVyYXRpb24gPSBkdXJhdGlvbjsgLy8gQHByaXZhdGUsIGluIG1pbGxpc2Vjb25kc1xyXG4gICAgdGhpcy5mcmFtZVN0YXJ0ZWRUaW1lcy5sZW5ndGggPSAwO1xyXG4gICAgdGhpcy5mcmFtZUVuZGVkVGltZXMubGVuZ3RoID0gMDtcclxuICAgIHRoaXMuZnJhbWVQcm9jZXNzaW5nVGltZXMubGVuZ3RoID0gMDtcclxuICB9XHJcbn1cclxuXHJcbm5ldXJvbi5yZWdpc3RlciggJ05ldXJvblByb2ZpbGVyJywgTmV1cm9uUHJvZmlsZXIgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IE5ldXJvblByb2ZpbGVyOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxLQUFLLE1BQU0sNkJBQTZCO0FBQy9DLE9BQU9DLFFBQVEsTUFBTSxzQ0FBc0M7QUFDM0QsT0FBT0MsTUFBTSxNQUFNLGlCQUFpQjtBQUVwQyxNQUFNQyxjQUFjLENBQUM7RUFFbkI7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFQyxXQUFXQSxDQUFFQyxHQUFHLEVBQUVDLE9BQU8sRUFBRztJQUUxQkMsTUFBTSxJQUFJQSxNQUFNLENBQUVELE9BQU8sSUFBSSxDQUFDLElBQUlBLE9BQU8sSUFBSSxDQUFDLEVBQUcscUNBQW9DQSxPQUFRLEVBQUUsQ0FBQztJQUVoRyxJQUFJLENBQUNBLE9BQU8sR0FBR0EsT0FBTyxDQUFDLENBQUM7O0lBRXhCLElBQUksQ0FBQ0UsVUFBVSxHQUFHLENBQUM7SUFDbkIsSUFBSSxDQUFDQyx3QkFBd0IsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2QyxJQUFJ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