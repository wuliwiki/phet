// Copyright 2016-2022, University of Colorado Boulder

/**
 * a Scenery node that looks like a small version of the coin terms, used in the collection display
 *
 * @author John Blanco
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Multilink from '../../../../axon/js/Multilink.js';
import MathSymbolFont from '../../../../scenery-phet/js/MathSymbolFont.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, RichText, Text } from '../../../../scenery/js/imports.js';
import expressionExchange from '../../expressionExchange.js';
import ViewMode from '../enum/ViewMode.js';
import CoinNodeFactory from './CoinNodeFactory.js';

// constants
const COIN_VALUE_FONT = new PhetFont({
  size: 12,
  weight: 'bold'
});
const VARIABLE_FONT = new MathSymbolFont(18);
const CONSTANT_FONT = new PhetFont(18);
const COIN_SCALING_FACTOR = 0.4; // empirically determined to yield coin icons of the desired size
const MAX_TERM_WIDTH_PROPORTION = 1.75; // limits how wide text can be relative to coin, empirically determined

class CoinTermIconNode extends Node {
  /**
   * @param {CoinTerm} coinTerm - model of a coin
   * @param {Property.<ViewMode>} viewModeProperty - controls whether to show the coin or the term
   * @param {Property.<boolean>} showCoinValuesProperty - controls whether or not coin value is shown
   * @param {Property.<boolean>} showVariableValuesProperty - controls whether or not variable values are shown
   * @param {Object} [options]
   */
  constructor(coinTerm, viewModeProperty, showCoinValuesProperty, showVariableValuesProperty, options) {
    super();

    // add the node that represents the icon
    const coinIconNode = CoinNodeFactory.createIconNode(coinTerm.typeID, coinTerm.coinRadius * COIN_SCALING_FACTOR);
    this.addChild(coinIconNode);

    // control coin icon visibility
    viewModeProperty.link(representationMode => {
      coinIconNode.visible = representationMode === ViewMode.COINS;
    });

    // convenience variable for positioning the textual labels created below
    const coinCenter = coinIconNode.center;

    // add the coin value text
    const coinValueText = new Text(coinTerm.valueProperty.value, {
      font: COIN_VALUE_FONT,
      center: coinCenter
    });
    this.addChild(coinValueText);

    // control the coin value text visibility
    Multilink.multilink([viewModeProperty, showCoinValuesProperty], (viewMode, showCoinValues) => {
      coinValueText.visible = viewMode === ViewMode.COINS && showCoinValues;
    });

    // determine the max width of the textual components
    const maxTextWidth = coinIconNode.width * MAX_TERM_WIDTH_PROPORTION;

    // add the 'term' text, e.g. xy
    const termText = new RichText(coinTerm.termText, {
      font: coinTerm.isConstant ? CONSTANT_FONT : VARIABLE_FONT,
      maxWidth: maxTextWidth
    });
    if (coinTerm.totalCountProperty.get() < 0) {
      termText.string = MathSymbols.UNARY_MINUS + termText.string;
    }
    termText.center = coinCenter;
    this.addChild(termText);

    // control the term text visibility
    const termTextVisibleProperty = new DerivedProperty([viewModeProperty, showVariableValuesProperty], (viewMode, showVariableValues) => viewMode === ViewMode.VARIABLES && !showVariableValues);
    termTextVisibleProperty.linkAttribute(termText, 'visible');

    // Add the text that includes the variable values.  This can change, so it starts off blank.
    const termWithVariableValuesText = new RichText(' ', {
      font: coinTerm.isConstant ? CONSTANT_FONT : VARIABLE_FONT,
      maxWidth: maxTextWidth
    });
    this.addChild(termWithVariableValuesText);

    // update the variable text when it changes, which is triggered by changes to the underlying variable values
    coinTerm.termValueStringProperty.link(() => {
      const termValueText = coinTerm.termValueStringProperty.value;
      const sign = coinTerm.totalCountProperty.get() > 0 ? '' : MathSymbols.UNARY_MINUS;
      termWithVariableValuesText.string = sign + termValueText;
      termWithVariableValuesText.center = coinCenter;
    });

    // control the visibility of the value text
    Multilink.multilink([viewModeProperty, showVariableValuesProperty], (viewMode, showVariableValues) => {
      termWithVariableValuesText.visible = viewMode === ViewMode.VARIABLES && showVariableValues;
    });
    this.mutate(options);
  }
}
expressionExchange.register('CoinTermIconNode', CoinTermIconNode);
export default CoinTermIconNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJNdWx0aWxpbmsiLCJNYXRoU3ltYm9sRm9udCIsIk1hdGhTeW1ib2xzIiwiUGhldEZvbnQiLCJOb2RlIiwiUmljaFRleHQiLCJUZXh0IiwiZXhwcmVzc2lvbkV4Y2hhbmdlIiwiVmlld01vZGUiLCJDb2luTm9kZUZhY3RvcnkiLCJDT0lOX1ZBTFVFX0ZPTlQiLCJzaXplIiwid2VpZ2h0IiwiVkFSSUFCTEVfRk9OVCIsIkNPTlNUQU5UX0ZPTlQiLCJDT0lOX1NDQUxJTkdfRkFDVE9SIiwiTUFYX1RFUk1fV0lEVEhfUFJPUE9SVElPTiIsIkNvaW5UZXJtSWNvbk5vZGUiLCJjb25zdHJ1Y3RvciIsImNvaW5UZXJtIiwidmlld01vZGVQcm9wZXJ0eSIsInNob3dDb2luVmFsdWVzUHJvcGVydHkiLCJzaG93VmFyaWFibGVWYWx1ZXNQcm9wZXJ0eSIsIm9wdGlvbnMiLCJjb2luSWNvbk5vZGUiLCJjcmVhdGVJY29uTm9kZSIsInR5cGVJRCIsImNvaW5SYWRpdXMiLCJhZGRDaGlsZCIsImxpbmsiLCJyZXByZXNlbnRhdGlvbk1vZGUiLCJ2aXNpYmxlIiwiQ09JTlMiLCJjb2luQ2VudGVyIiwiY2VudGVyIiwiY29pblZhbHVlVGV4dCIsInZhbHVlUHJvcGVydHkiLCJ2YWx1ZSIsImZvbnQiLCJtdWx0aWxpbmsiLCJ2aWV3TW9kZSIsInNob3dDb2luVmFsdWVzIiwibWF4VGV4dFdpZHRoIiwid2lkdGgiLCJ0ZXJtVGV4dCIsImlzQ29uc3RhbnQiLCJtYXhXaWR0aCIsInRvdGFsQ291bnRQcm9wZXJ0eSIsImdldCIsInN0cmluZyIsIlVOQVJZX01JTlVTIiwidGVybVRleHRWaXNpYmxlUHJvcGVydHkiLCJzaG93VmFyaWFibGVWYWx1ZXMiLCJWQVJJQUJMRVMiLCJsaW5rQXR0cmlidXRlIiwidGVybVdpdGhWYXJpYWJsZVZhbHVlc1RleHQiLCJ0ZXJtVmFsdWVTdHJpbmdQcm9wZXJ0eSIsInRlcm1WYWx1ZVRleHQiLCJzaWduIiwibXV0YXRlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJDb2luVGVybUljb25Ob2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE2LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIGEgU2NlbmVyeSBub2RlIHRoYXQgbG9va3MgbGlrZSBhIHNtYWxsIHZlcnNpb24gb2YgdGhlIGNvaW4gdGVybXMsIHVzZWQgaW4gdGhlIGNvbGxlY3Rpb24gZGlzcGxheVxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvXHJcbiAqL1xyXG5cclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBNdWx0aWxpbmsgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9NdWx0aWxpbmsuanMnO1xyXG5pbXBvcnQgTWF0aFN5bWJvbEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL01hdGhTeW1ib2xGb250LmpzJztcclxuaW1wb3J0IE1hdGhTeW1ib2xzIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9NYXRoU3ltYm9scy5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBOb2RlLCBSaWNoVGV4dCwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBleHByZXNzaW9uRXhjaGFuZ2UgZnJvbSAnLi4vLi4vZXhwcmVzc2lvbkV4Y2hhbmdlLmpzJztcclxuaW1wb3J0IFZpZXdNb2RlIGZyb20gJy4uL2VudW0vVmlld01vZGUuanMnO1xyXG5pbXBvcnQgQ29pbk5vZGVGYWN0b3J5IGZyb20gJy4vQ29pbk5vZGVGYWN0b3J5LmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBDT0lOX1ZBTFVFX0ZPTlQgPSBuZXcgUGhldEZvbnQoIHsgc2l6ZTogMTIsIHdlaWdodDogJ2JvbGQnIH0gKTtcclxuY29uc3QgVkFSSUFCTEVfRk9OVCA9IG5ldyBNYXRoU3ltYm9sRm9udCggMTggKTtcclxuY29uc3QgQ09OU1RBTlRfRk9OVCA9IG5ldyBQaGV0Rm9udCggMTggKTtcclxuY29uc3QgQ09JTl9TQ0FMSU5HX0ZBQ1RPUiA9IDAuNDsgLy8gZW1waXJpY2FsbHkgZGV0ZXJtaW5lZCB0byB5aWVsZCBjb2luIGljb25zIG9mIHRoZSBkZXNpcmVkIHNpemVcclxuY29uc3QgTUFYX1RFUk1fV0lEVEhfUFJPUE9SVElPTiA9IDEuNzU7IC8vIGxpbWl0cyBob3cgd2lkZSB0ZXh0IGNhbiBiZSByZWxhdGl2ZSB0byBjb2luLCBlbXBpcmljYWxseSBkZXRlcm1pbmVkXHJcblxyXG5jbGFzcyBDb2luVGVybUljb25Ob2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7Q29pblRlcm19IGNvaW5UZXJtIC0gbW9kZWwgb2YgYSBjb2luXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48Vmlld01vZGU+fSB2aWV3TW9kZVByb3BlcnR5IC0gY29udHJvbHMgd2hldGhlciB0byBzaG93IHRoZSBjb2luIG9yIHRoZSB0ZXJtXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48Ym9vbGVhbj59IHNob3dDb2luVmFsdWVzUHJvcGVydHkgLSBjb250cm9scyB3aGV0aGVyIG9yIG5vdCBjb2luIHZhbHVlIGlzIHNob3duXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48Ym9vbGVhbj59IHNob3dWYXJpYWJsZVZhbHVlc1Byb3BlcnR5IC0gY29udHJvbHMgd2hldGhlciBvciBub3QgdmFyaWFibGUgdmFsdWVzIGFyZSBzaG93blxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggY29pblRlcm0sIHZpZXdNb2RlUHJvcGVydHksIHNob3dDb2luVmFsdWVzUHJvcGVydHksIHNob3dWYXJpYWJsZVZhbHVlc1Byb3BlcnR5LCBvcHRpb25zICkge1xyXG5cclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgLy8gYWRkIHRoZSBub2RlIHRoYXQgcmVwcmVzZW50cyB0aGUgaWNvblxyXG4gICAgY29uc3QgY29pbkljb25Ob2RlID0gQ29pbk5vZGVGYWN0b3J5LmNyZWF0ZUljb25Ob2RlKCBjb2luVGVybS50eXBlSUQsIGNvaW5UZXJtLmNvaW5SYWRpdXMgKiBDT0lOX1NDQUxJTkdfRkFDVE9SICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBjb2luSWNvbk5vZGUgKTtcclxuXHJcbiAgICAvLyBjb250cm9sIGNvaW4gaWNvbiB2aXNpYmlsaXR5XHJcbiAgICB2aWV3TW9kZVByb3BlcnR5LmxpbmsoIHJlcHJlc2VudGF0aW9uTW9kZSA9PiB7XHJcbiAgICAgIGNvaW5JY29uTm9kZS52aXNpYmxlID0gcmVwcmVzZW50YXRpb25Nb2RlID09PSBWaWV3TW9kZS5DT0lOUztcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBjb252ZW5pZW5jZSB2YXJpYWJsZSBmb3IgcG9zaXRpb25pbmcgdGhlIHRleHR1YWwgbGFiZWxzIGNyZWF0ZWQgYmVsb3dcclxuICAgIGNvbnN0IGNvaW5DZW50ZXIgPSBjb2luSWNvbk5vZGUuY2VudGVyO1xyXG5cclxuICAgIC8vIGFkZCB0aGUgY29pbiB2YWx1ZSB0ZXh0XHJcbiAgICBjb25zdCBjb2luVmFsdWVUZXh0ID0gbmV3IFRleHQoIGNvaW5UZXJtLnZhbHVlUHJvcGVydHkudmFsdWUsIHsgZm9udDogQ09JTl9WQUxVRV9GT05ULCBjZW50ZXI6IGNvaW5DZW50ZXIgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggY29pblZhbHVlVGV4dCApO1xyXG5cclxuICAgIC8vIGNvbnRyb2wgdGhlIGNvaW4gdmFsdWUgdGV4dCB2aXNpYmlsaXR5XHJcbiAgICBNdWx0aWxpbmsubXVsdGlsaW5rKCBbIHZpZXdNb2RlUHJvcGVydHksIHNob3dDb2luVmFsdWVzUHJvcGVydHkgXSwgKCB2aWV3TW9kZSwgc2hvd0NvaW5WYWx1ZXMgKSA9PiB7XHJcbiAgICAgIGNvaW5WYWx1ZVRleHQudmlzaWJsZSA9IHZpZXdNb2RlID09PSBWaWV3TW9kZS5DT0lOUyAmJiBzaG93Q29pblZhbHVlcztcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBkZXRlcm1pbmUgdGhlIG1heCB3aWR0aCBvZiB0aGUgdGV4dHVhbCBjb21wb25lbnRzXHJcbiAgICBjb25zdCBtYXhUZXh0V2lkdGggPSBjb2luSWNvbk5vZGUud2lkdGggKiBNQVhfVEVSTV9XSURUSF9QUk9QT1JUSU9OO1xyXG5cclxuICAgIC8vIGFkZCB0aGUgJ3Rlcm0nIHRleHQsIGUuZy4geHlcclxuICAgIGNvbnN0IHRlcm1UZXh0ID0gbmV3IFJpY2hUZXh0KCBjb2luVGVybS50ZXJtVGV4dCwge1xyXG4gICAgICBmb250OiBjb2luVGVybS5pc0NvbnN0YW50ID8gQ09OU1RBTlRfRk9OVCA6IFZBUklBQkxFX0ZPTlQsXHJcbiAgICAgIG1heFdpZHRoOiBtYXhUZXh0V2lkdGhcclxuICAgIH0gKTtcclxuICAgIGlmICggY29pblRlcm0udG90YWxDb3VudFByb3BlcnR5LmdldCgpIDwgMCApIHtcclxuICAgICAgdGVybVRleHQuc3RyaW5nID0gTWF0aFN5bWJvbHMuVU5BUllfTUlOVVMgKyB0ZXJtVGV4dC5zdHJpbmc7XHJcbiAgICB9XHJcbiAgICB0ZXJtVGV4dC5jZW50ZXIgPSBjb2luQ2VudGVyO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGVybVRleHQgKTtcclxuXHJcbiAgICAvLyBjb250cm9sIHRoZSB0ZXJtIHRleHQgdmlzaWJpbGl0eVxyXG4gICAgY29uc3QgdGVybVRleHRWaXNpYmxlUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICBbIHZpZXdNb2RlUHJvcGVydHksIHNob3dWYXJpYWJsZVZhbHVlc1Byb3BlcnR5IF0sXHJcbiAgICAgICggdmlld01vZGUsIHNob3dWYXJpYWJsZVZhbHVlcyApID0+IHZpZXdNb2RlID09PSBWaWV3TW9kZS5WQVJJQUJMRVMgJiYgIXNob3dWYXJpYWJsZVZhbHVlc1xyXG4gICAgKTtcclxuICAgIHRlcm1UZXh0VmlzaWJsZVByb3BlcnR5LmxpbmtBdHRyaWJ1dGUoIHRlcm1UZXh0LCAndmlzaWJsZScgKTtcclxuXHJcbiAgICAvLyBBZGQgdGhlIHRleHQgdGhhdCBpbmNsdWRlcyB0aGUgdmFyaWFibGUgdmFsdWVzLiAgVGhpcyBjYW4gY2hhbmdlLCBzbyBpdCBzdGFydHMgb2ZmIGJsYW5rLlxyXG4gICAgY29uc3QgdGVybVdpdGhWYXJpYWJsZVZhbHVlc1RleHQgPSBuZXcgUmljaFRleHQoICcgJywge1xyXG4gICAgICBmb250OiBjb2luVGVybS5pc0NvbnN0YW50ID8gQ09OU1RBTlRfRk9OVCA6IFZBUklBQkxFX0ZPTlQsXHJcbiAgICAgIG1heFdpZHRoOiBtYXhUZXh0V2lkdGhcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRlcm1XaXRoVmFyaWFibGVWYWx1ZXNUZXh0ICk7XHJcblxyXG4gICAgLy8gdXBkYXRlIHRoZSB2YXJpYWJsZSB0ZXh0IHdoZW4gaXQgY2hhbmdlcywgd2hpY2ggaXMgdHJpZ2dlcmVkIGJ5IGNoYW5nZXMgdG8gdGhlIHVuZGVybHlpbmcgdmFyaWFibGUgdmFsdWVzXHJcbiAgICBjb2luVGVybS50ZXJtVmFsdWVTdHJpbmdQcm9wZXJ0eS5saW5rKCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHRlcm1WYWx1ZVRleHQgPSBjb2luVGVybS50ZXJtVmFsdWVTdHJpbmdQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgY29uc3Qgc2lnbiA9IGNvaW5UZXJtLnRvdGFsQ291bnRQcm9wZXJ0eS5nZXQoKSA+IDAgPyAnJyA6IE1hdGhTeW1ib2xzLlVOQVJZX01JTlVTO1xyXG4gICAgICB0ZXJtV2l0aFZhcmlhYmxlVmFsdWVzVGV4dC5zdHJpbmcgPSBzaWduICsgdGVybVZhbHVlVGV4dDtcclxuICAgICAgdGVybVdpdGhWYXJpYWJsZVZhbHVlc1RleHQuY2VudGVyID0gY29pbkNlbnRlcjtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBjb250cm9sIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSB2YWx1ZSB0ZXh0XHJcbiAgICBNdWx0aWxpbmsubXVsdGlsaW5rKCBbIHZpZXdNb2RlUHJvcGVydHksIHNob3dWYXJpYWJsZVZhbHVlc1Byb3BlcnR5IF0sICggdmlld01vZGUsIHNob3dWYXJpYWJsZVZhbHVlcyApID0+IHtcclxuICAgICAgdGVybVdpdGhWYXJpYWJsZVZhbHVlc1RleHQudmlzaWJsZSA9IHZpZXdNb2RlID09PSBWaWV3TW9kZS5WQVJJQUJMRVMgJiYgc2hvd1ZhcmlhYmxlVmFsdWVzO1xyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMubXV0YXRlKCBvcHRpb25zICk7XHJcbiAgfVxyXG59XHJcblxyXG5leHByZXNzaW9uRXhjaGFuZ2UucmVnaXN0ZXIoICdDb2luVGVybUljb25Ob2RlJywgQ29pblRlcm1JY29uTm9kZSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ29pblRlcm1JY29uTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxTQUFTLE1BQU0sa0NBQWtDO0FBQ3hELE9BQU9DLGNBQWMsTUFBTSwrQ0FBK0M7QUFDMUUsT0FBT0MsV0FBVyxNQUFNLDRDQUE0QztBQUNwRSxPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELFNBQVNDLElBQUksRUFBRUMsUUFBUSxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQ3hFLE9BQU9DLGtCQUFrQixNQUFNLDZCQUE2QjtBQUM1RCxPQUFPQyxRQUFRLE1BQU0scUJBQXFCO0FBQzFDLE9BQU9DLGVBQWUsTUFBTSxzQkFBc0I7O0FBRWxEO0FBQ0EsTUFBTUMsZUFBZSxHQUFHLElBQUlQLFFBQVEsQ0FBRTtFQUFFUSxJQUFJLEVB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