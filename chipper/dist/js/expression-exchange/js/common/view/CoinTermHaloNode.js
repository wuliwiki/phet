// Copyright 2016-2022, University of Colorado Boulder

/**
 * a Scenery node that represents the 'halo' that is used to indicate when coins can be combined
 *
 * @author John Blanco
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Multilink from '../../../../axon/js/Multilink.js';
import { Circle, Node, RadialGradient } from '../../../../scenery/js/imports.js';
import expressionExchange from '../../expressionExchange.js';
import EESharedConstants from '../EESharedConstants.js';
import ViewMode from '../enum/ViewMode.js';

// constants
const COIN_HALO_COLOR = 'rgba( 255, 255, 0, 0.8 )';
const COIN_HALO_EDGE_COLOR = 'rgba( 255, 255, 0, 0 )';
const TERM_HALO_COLOR_CENTER = 'yellow';
const TERM_HALO_EDGE_COLOR = 'rgba( 255, 255, 0, 0 )';
class CoinTermHaloNode extends Node {
  /**
   * @param {CoinTerm} coinTerm - model of a coin term
   * @param {Property.<ViewMode>} viewModeProperty - controls whether to show the coin or the term
   */
  constructor(coinTerm, viewModeProperty) {
    super({
      pickable: true,
      cursor: 'pointer'
    });

    // add the coin halo
    const coinHalo = new Circle(coinTerm.coinRadius, {
      stroke: new RadialGradient(0, 0, coinTerm.coinRadius, 0, 0, coinTerm.coinRadius * 1.5).addColorStop(0, COIN_HALO_COLOR).addColorStop(1, COIN_HALO_EDGE_COLOR),
      lineWidth: 16 // empirically determined
    });

    this.addChild(coinHalo);

    // control coin halo visibility
    const coinHaloVisibleProperty = new DerivedProperty([viewModeProperty, coinTerm.combineHaloActiveProperty], (viewMode, combineHaloActive) => viewMode === ViewMode.COINS && combineHaloActive);
    const coinHaloVisibilityObserver = visible => {
      coinHalo.visible = visible;
    };
    coinHaloVisibleProperty.link(coinHaloVisibilityObserver);

    // add the term halo
    const termHalo = new Circle(EESharedConstants.TERM_COMBINE_DISTANCE, {
      fill: new RadialGradient(0, 0, 0, 0, 0, EESharedConstants.TERM_COMBINE_DISTANCE).addColorStop(0, TERM_HALO_COLOR_CENTER).addColorStop(0.5, TERM_HALO_COLOR_CENTER).addColorStop(1, TERM_HALO_EDGE_COLOR)
    });
    this.addChild(termHalo);

    // control term halo visibility
    const termHaloVisibleMultilink = Multilink.multilink([viewModeProperty, coinTerm.combineHaloActiveProperty], (viewMode, combineHaloActive) => {
      termHalo.visible = viewMode === ViewMode.VARIABLES && combineHaloActive;
    });

    // move this node as the model representation moves
    const handlePositionChanged = position => {
      this.center = position;
    };
    coinTerm.positionProperty.link(handlePositionChanged);
    this.disposeCoinTermHaloNode = () => {
      coinHaloVisibleProperty.unlink(coinHaloVisibilityObserver);
      coinHaloVisibleProperty.dispose();
      termHaloVisibleMultilink.dispose();
      coinTerm.positionProperty.unlink(handlePositionChanged);
    };
  }

  // @public
  dispose() {
    this.disposeCoinTermHaloNode();
    super.dispose();
  }
}
expressionExchange.register('CoinTermHaloNode', CoinTermHaloNode);
export default CoinTermHaloNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJNdWx0aWxpbmsiLCJDaXJjbGUiLCJOb2RlIiwiUmFkaWFsR3JhZGllbnQiLCJleHByZXNzaW9uRXhjaGFuZ2UiLCJFRVNoYXJlZENvbnN0YW50cyIsIlZpZXdNb2RlIiwiQ09JTl9IQUxPX0NPTE9SIiwiQ09JTl9IQUxPX0VER0VfQ09MT1IiLCJURVJNX0hBTE9fQ09MT1JfQ0VOVEVSIiwiVEVSTV9IQUxPX0VER0VfQ09MT1IiLCJDb2luVGVybUhhbG9Ob2RlIiwiY29uc3RydWN0b3IiLCJjb2luVGVybSIsInZpZXdNb2RlUHJvcGVydHkiLCJwaWNrYWJsZSIsImN1cnNvciIsImNvaW5IYWxvIiwiY29pblJhZGl1cyIsInN0cm9rZSIsImFkZENvbG9yU3RvcCIsImxpbmVXaWR0aCIsImFkZENoaWxkIiwiY29pbkhhbG9WaXNpYmxlUHJvcGVydHkiLCJjb21iaW5lSGFsb0FjdGl2ZVByb3BlcnR5Iiwidmlld01vZGUiLCJjb21iaW5lSGFsb0FjdGl2ZSIsIkNPSU5TIiwiY29pbkhhbG9WaXNpYmlsaXR5T2JzZXJ2ZXIiLCJ2aXNpYmxlIiwibGluayIsInRlcm1IYWxvIiwiVEVSTV9DT01CSU5FX0RJU1RBTkNFIiwiZmlsbCIsInRlcm1IYWxvVmlzaWJsZU11bHRpbGluayIsIm11bHRpbGluayIsIlZBUklBQkxFUyIsImhhbmRsZVBvc2l0aW9uQ2hhbmdlZCIsInBvc2l0aW9uIiwiY2VudGVyIiwicG9zaXRpb25Qcm9wZXJ0eSIsImRpc3Bvc2VDb2luVGVybUhhbG9Ob2RlIiwidW5saW5rIiwiZGlzcG9zZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQ29pblRlcm1IYWxvTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNi0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBhIFNjZW5lcnkgbm9kZSB0aGF0IHJlcHJlc2VudHMgdGhlICdoYWxvJyB0aGF0IGlzIHVzZWQgdG8gaW5kaWNhdGUgd2hlbiBjb2lucyBjYW4gYmUgY29tYmluZWRcclxuICpcclxuICogQGF1dGhvciBKb2huIEJsYW5jb1xyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgTXVsdGlsaW5rIGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTXVsdGlsaW5rLmpzJztcclxuaW1wb3J0IHsgQ2lyY2xlLCBOb2RlLCBSYWRpYWxHcmFkaWVudCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBleHByZXNzaW9uRXhjaGFuZ2UgZnJvbSAnLi4vLi4vZXhwcmVzc2lvbkV4Y2hhbmdlLmpzJztcclxuaW1wb3J0IEVFU2hhcmVkQ29uc3RhbnRzIGZyb20gJy4uL0VFU2hhcmVkQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IFZpZXdNb2RlIGZyb20gJy4uL2VudW0vVmlld01vZGUuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IENPSU5fSEFMT19DT0xPUiA9ICdyZ2JhKCAyNTUsIDI1NSwgMCwgMC44ICknO1xyXG5jb25zdCBDT0lOX0hBTE9fRURHRV9DT0xPUiA9ICdyZ2JhKCAyNTUsIDI1NSwgMCwgMCApJztcclxuY29uc3QgVEVSTV9IQUxPX0NPTE9SX0NFTlRFUiA9ICd5ZWxsb3cnO1xyXG5jb25zdCBURVJNX0hBTE9fRURHRV9DT0xPUiA9ICdyZ2JhKCAyNTUsIDI1NSwgMCwgMCApJztcclxuXHJcbmNsYXNzIENvaW5UZXJtSGFsb05vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtDb2luVGVybX0gY29pblRlcm0gLSBtb2RlbCBvZiBhIGNvaW4gdGVybVxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPFZpZXdNb2RlPn0gdmlld01vZGVQcm9wZXJ0eSAtIGNvbnRyb2xzIHdoZXRoZXIgdG8gc2hvdyB0aGUgY29pbiBvciB0aGUgdGVybVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBjb2luVGVybSwgdmlld01vZGVQcm9wZXJ0eSApIHtcclxuICAgIHN1cGVyKCB7IHBpY2thYmxlOiB0cnVlLCBjdXJzb3I6ICdwb2ludGVyJyB9ICk7XHJcblxyXG4gICAgLy8gYWRkIHRoZSBjb2luIGhhbG9cclxuICAgIGNvbnN0IGNvaW5IYWxvID0gbmV3IENpcmNsZSggY29pblRlcm0uY29pblJhZGl1cywge1xyXG4gICAgICBzdHJva2U6IG5ldyBSYWRpYWxHcmFkaWVudCggMCwgMCwgY29pblRlcm0uY29pblJhZGl1cywgMCwgMCwgY29pblRlcm0uY29pblJhZGl1cyAqIDEuNSApLmFkZENvbG9yU3RvcCggMCwgQ09JTl9IQUxPX0NPTE9SICkuYWRkQ29sb3JTdG9wKCAxLCBDT0lOX0hBTE9fRURHRV9DT0xPUiApLFxyXG4gICAgICBsaW5lV2lkdGg6IDE2IC8vIGVtcGlyaWNhbGx5IGRldGVybWluZWRcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGNvaW5IYWxvICk7XHJcblxyXG4gICAgLy8gY29udHJvbCBjb2luIGhhbG8gdmlzaWJpbGl0eVxyXG4gICAgY29uc3QgY29pbkhhbG9WaXNpYmxlUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHZpZXdNb2RlUHJvcGVydHksIGNvaW5UZXJtLmNvbWJpbmVIYWxvQWN0aXZlUHJvcGVydHkgXSxcclxuICAgICAgKCB2aWV3TW9kZSwgY29tYmluZUhhbG9BY3RpdmUgKSA9PiAoIHZpZXdNb2RlID09PSBWaWV3TW9kZS5DT0lOUyApICYmIGNvbWJpbmVIYWxvQWN0aXZlICk7XHJcbiAgICBjb25zdCBjb2luSGFsb1Zpc2liaWxpdHlPYnNlcnZlciA9IHZpc2libGUgPT4ge2NvaW5IYWxvLnZpc2libGUgPSB2aXNpYmxlO307XHJcbiAgICBjb2luSGFsb1Zpc2libGVQcm9wZXJ0eS5saW5rKCBjb2luSGFsb1Zpc2liaWxpdHlPYnNlcnZlciApO1xyXG5cclxuICAgIC8vIGFkZCB0aGUgdGVybSBoYWxvXHJcbiAgICBjb25zdCB0ZXJtSGFsbyA9IG5ldyBDaXJjbGUoIEVFU2hhcmVkQ29uc3RhbnRzLlRFUk1fQ09NQklORV9ESVNUQU5DRSwge1xyXG4gICAgICBmaWxsOiBuZXcgUmFkaWFsR3JhZGllbnQoIDAsIDAsIDAsIDAsIDAsIEVFU2hhcmVkQ29uc3RhbnRzLlRFUk1fQ09NQklORV9ESVNUQU5DRSApLmFkZENvbG9yU3RvcCggMCwgVEVSTV9IQUxPX0NPTE9SX0NFTlRFUiApLmFkZENvbG9yU3RvcCggMC41LCBURVJNX0hBTE9fQ09MT1JfQ0VOVEVSICkuYWRkQ29sb3JTdG9wKCAxLCBURVJNX0hBTE9fRURHRV9DT0xPUiApXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0ZXJtSGFsbyApO1xyXG5cclxuICAgIC8vIGNvbnRyb2wgdGVybSBoYWxvIHZpc2liaWxpdHlcclxuICAgIGNvbnN0IHRlcm1IYWxvVmlzaWJsZU11bHRpbGluayA9IE11bHRpbGluay5tdWx0aWxpbmsoXHJcbiAgICAgIFsgdmlld01vZGVQcm9wZXJ0eSwgY29pblRlcm0uY29tYmluZUhhbG9BY3RpdmVQcm9wZXJ0eSBdLFxyXG4gICAgICAoIHZpZXdNb2RlLCBjb21iaW5lSGFsb0FjdGl2ZSApID0+IHtcclxuICAgICAgICB0ZXJtSGFsby52aXNpYmxlID0gdmlld01vZGUgPT09IFZpZXdNb2RlLlZBUklBQkxFUyAmJiBjb21iaW5lSGFsb0FjdGl2ZTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBtb3ZlIHRoaXMgbm9kZSBhcyB0aGUgbW9kZWwgcmVwcmVzZW50YXRpb24gbW92ZXNcclxuICAgIGNvbnN0IGhhbmRsZVBvc2l0aW9uQ2hhbmdlZCA9IHBvc2l0aW9uID0+IHtcclxuICAgICAgdGhpcy5jZW50ZXIgPSBwb3NpdGlvbjtcclxuICAgIH07XHJcblxyXG4gICAgY29pblRlcm0ucG9zaXRpb25Qcm9wZXJ0eS5saW5rKCBoYW5kbGVQb3NpdGlvbkNoYW5nZWQgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VDb2luVGVybUhhbG9Ob2RlID0gKCkgPT4ge1xyXG4gICAgICBjb2luSGFsb1Zpc2libGVQcm9wZXJ0eS51bmxpbmsoIGNvaW5IYWxvVmlzaWJpbGl0eU9ic2VydmVyICk7XHJcbiAgICAgIGNvaW5IYWxvVmlzaWJsZVByb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgdGVybUhhbG9WaXNpYmxlTXVsdGlsaW5rLmRpc3Bvc2UoKTtcclxuICAgICAgY29pblRlcm0ucG9zaXRpb25Qcm9wZXJ0eS51bmxpbmsoIGhhbmRsZVBvc2l0aW9uQ2hhbmdlZCApO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIEBwdWJsaWNcclxuICBkaXNwb3NlKCkge1xyXG4gICAgdGhpcy5kaXNwb3NlQ29pblRlcm1IYWxvTm9kZSgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwcmVzc2lvbkV4Y2hhbmdlLnJlZ2lzdGVyKCAnQ29pblRlcm1IYWxvTm9kZScsIENvaW5UZXJtSGFsb05vZGUgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IENvaW5UZXJtSGFsb05vZGU7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsU0FBUyxNQUFNLGtDQUFrQztBQUN4RCxTQUFTQyxNQUFNLEVBQUVDLElBQUksRUFBRUMsY0FBYyxRQUFRLG1DQUFtQztBQUNoRixPQUFPQyxrQkFBa0IsTUFBTSw2QkFBNkI7QUFDNUQsT0FBT0MsaUJBQWlCLE1BQU0seUJBQXlCO0FBQ3ZELE9BQU9DLFFBQVEsTUFBTSxxQkFBcUI7O0FBRTFDO0FBQ0EsTUFBTUMsZUFBZSxHQUFHLDBCQUEwQjtBQUNsRCxNQUFNQyxvQkFBb0IsR0FBRyx3QkFBd0I7QUFDckQsTUFBTUMsc0JBQXNCLEdB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