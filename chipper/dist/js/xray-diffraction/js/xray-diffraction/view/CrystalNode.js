// Copyright 2020-2022, University of Colorado Boulder

/**
 * View for the Crystal lattice, displays a 2D array of atomic nuclei to represent the crystal.
 *
 * @author Todd Holden (https://tholden79.wixsite.com/mysite2)
 */

// modules
import ArrowNode from '../../../../scenery-phet/js/ArrowNode.js';
import { Circle, Node, RadialGradient, Rectangle, RichText } from '../../../../scenery/js/imports.js';
import XrayDiffractionConstants from '../../common/XrayDiffractionConstants.js';
import xrayDiffraction from '../../xrayDiffraction.js';
import XrayDiffractionStrings from '../../XrayDiffractionStrings.js';

// strings
const aLatticeConstantString = XrayDiffractionStrings.aLatticeConstant;
const bLatticeConstantString = XrayDiffractionStrings.bLatticeConstant;
const interplaneDistanceString = XrayDiffractionStrings.interplaneDistance;

// constants
const RADIUS = 5; // Atomic Nucleus Radius. Arbitrarily set to look good
const DIMENSION_ARROW_OPTIONS = {
  fill: 'black',
  stroke: null,
  tailWidth: 2,
  headWidth: 7,
  headHeight: 20,
  doubleHead: true
};
const SCALE_FACTOR = XrayDiffractionConstants.SCALE_FACTOR;
const DIMENSION_LABEL_MAXWIDTH = 100; // arbitrary max width for labels

class CrystalNode extends Node {
  /**
   * @param {Array.<Vector2>} sites - an Array of Vector2 points for the crystal lattice
   * @param {Vector3} latticeConstants
   * @param {Object} [options]
   */
  constructor(sites, latticeConstants, options) {
    //----------------------------------------------------------------------------------------
    assert && assert(Array.isArray(sites), `sites should be an Array: ${sites}`);
    super();
    const atomsNode = new Node();
    let xMin = 0;
    let yMin = 0;
    let xMax = 0;
    let yMax = 0;
    sites.forEach(site => {
      const atom = new Circle(RADIUS, {
        x: SCALE_FACTOR * site.x,
        y: SCALE_FACTOR * site.y,
        fill: new RadialGradient(2, -3, 2, 2, -3, 7) // fill pattern to make the atoms look pretty
        .addColorStop(0, '#f97d7d').addColorStop(0.5, '#ed4545').addColorStop(1, '#f00')
      });
      if (site.x < xMin) {
        xMin = site.x;
      }
      if (site.y < yMin) {
        yMin = site.y;
      }
      if (site.x > xMax) {
        xMax = site.x;
      }
      if (site.y > yMax) {
        yMax = site.y;
      }
      atomsNode.addChild(atom);
    });

    // add a rectangular shape to define the crystal
    this.addChild(new Rectangle(SCALE_FACTOR * xMin - RADIUS, SCALE_FACTOR * yMin - RADIUS, SCALE_FACTOR * (xMax - xMin) + 2 * RADIUS, SCALE_FACTOR * (yMax - yMin) + 2 * RADIUS, RADIUS, RADIUS, {
      fill: 'hsl(210,100%,95%)'
    })); // light color picked by hand
    this.addChild(atomsNode);

    // Label lattice constants
    const aDimensionArrow = new ArrowNode(SCALE_FACTOR * xMin, SCALE_FACTOR * latticeConstants.z, SCALE_FACTOR * (xMin + latticeConstants.x), SCALE_FACTOR * latticeConstants.z, DIMENSION_ARROW_OPTIONS);
    const bDimensionArrow = new ArrowNode(SCALE_FACTOR * xMin, 0, SCALE_FACTOR * xMin, SCALE_FACTOR * latticeConstants.z, DIMENSION_ARROW_OPTIONS);
    const dDimensionArrow = new ArrowNode(SCALE_FACTOR * xMin, SCALE_FACTOR * yMin, SCALE_FACTOR * xMin, SCALE_FACTOR * (yMin + latticeConstants.z), DIMENSION_ARROW_OPTIONS);
    this.addChild(aDimensionArrow);
    this.addChild(bDimensionArrow);
    this.addChild(dDimensionArrow);
    const aDimensionLabel = new RichText(aLatticeConstantString, {
      maxWidth: DIMENSION_LABEL_MAXWIDTH,
      centerX: aDimensionArrow.centerX,
      top: aDimensionArrow.centerY
    });
    const bDimensionLabel = new RichText(bLatticeConstantString, {
      maxWidth: DIMENSION_LABEL_MAXWIDTH,
      centerY: bDimensionArrow.centerY,
      right: bDimensionArrow.centerX - 5
    });
    const dDimensionLabel = new RichText(interplaneDistanceString, {
      maxWidth: DIMENSION_LABEL_MAXWIDTH,
      centerY: dDimensionArrow.centerY,
      right: dDimensionArrow.centerX - 5
    });

    // fake labels to expand symmetrically and keep the crystal centered
    const fakeLabel1 = new RichText(interplaneDistanceString, {
      fill: 'transparent',
      maxWidth: DIMENSION_LABEL_MAXWIDTH,
      centerY: dDimensionArrow.centerY,
      left: -dDimensionArrow.centerX + 5
    });
    const fakeLabel2 = new RichText(aLatticeConstantString, {
      fill: 'transparent',
      maxWidth: DIMENSION_LABEL_MAXWIDTH,
      centerX: aDimensionArrow.centerX,
      bottom: -aDimensionArrow.centerY
    });
    this.addChild(aDimensionLabel);
    this.addChild(bDimensionLabel);
    this.addChild(dDimensionLabel);
    this.addChild(fakeLabel1);
    this.addChild(fakeLabel2);

    // convenience specify through options the center of the node after everything has be added
    this.centerX = options.centerX;
    this.centerY = options.centerY;
  }
}
xrayDiffraction.register('CrystalNode', CrystalNode);
export default CrystalNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcnJvd05vZGUiLCJDaXJjbGUiLCJOb2RlIiwiUmFkaWFsR3JhZGllbnQiLCJSZWN0YW5nbGUiLCJSaWNoVGV4dCIsIlhyYXlEaWZmcmFjdGlvbkNvbnN0YW50cyIsInhyYXlEaWZmcmFjdGlvbiIsIlhyYXlEaWZmcmFjdGlvblN0cmluZ3MiLCJhTGF0dGljZUNvbnN0YW50U3RyaW5nIiwiYUxhdHRpY2VDb25zdGFudCIsImJMYXR0aWNlQ29uc3RhbnRTdHJpbmciLCJiTGF0dGljZUNvbnN0YW50IiwiaW50ZXJwbGFuZURpc3RhbmNlU3RyaW5nIiwiaW50ZXJwbGFuZURpc3RhbmNlIiwiUkFESVVTIiwiRElNRU5TSU9OX0FSUk9XX09QVElPTlMiLCJmaWxsIiwic3Ryb2tlIiwidGFpbFdpZHRoIiwiaGVhZFdpZHRoIiwiaGVhZEhlaWdodCIsImRvdWJsZUhlYWQiLCJTQ0FMRV9GQUNUT1IiLCJESU1FTlNJT05fTEFCRUxfTUFYV0lEVEgiLCJDcnlzdGFsTm9kZSIsImNvbnN0cnVjdG9yIiwic2l0ZXMiLCJsYXR0aWNlQ29uc3RhbnRzIiwib3B0aW9ucyIsImFzc2VydCIsIkFycmF5IiwiaXNBcnJheSIsImF0b21zTm9kZSIsInhNaW4iLCJ5TWluIiwieE1heCIsInlNYXgiLCJmb3JFYWNoIiwic2l0ZSIsImF0b20iLCJ4IiwieSIsImFkZENvbG9yU3RvcCIsImFkZENoaWxkIiwiYURpbWVuc2lvbkFycm93IiwieiIsImJEaW1lbnNpb25BcnJvdyIsImREaW1lbnNpb25BcnJvdyIsImFEaW1lbnNpb25MYWJlbCIsIm1heFdpZHRoIiwiY2VudGVyWCIsInRvcCIsImNlbnRlclkiLCJiRGltZW5zaW9uTGFiZWwiLCJyaWdodCIsImREaW1lbnNpb25MYWJlbCIsImZha2VMYWJlbDEiLCJsZWZ0IiwiZmFrZUxhYmVsMiIsImJvdHRvbSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQ3J5c3RhbE5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjAtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogVmlldyBmb3IgdGhlIENyeXN0YWwgbGF0dGljZSwgZGlzcGxheXMgYSAyRCBhcnJheSBvZiBhdG9taWMgbnVjbGVpIHRvIHJlcHJlc2VudCB0aGUgY3J5c3RhbC5cclxuICpcclxuICogQGF1dGhvciBUb2RkIEhvbGRlbiAoaHR0cHM6Ly90aG9sZGVuNzkud2l4c2l0ZS5jb20vbXlzaXRlMilcclxuICovXHJcblxyXG4vLyBtb2R1bGVzXHJcbmltcG9ydCBBcnJvd05vZGUgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL0Fycm93Tm9kZS5qcyc7XHJcbmltcG9ydCB7IENpcmNsZSwgTm9kZSwgUmFkaWFsR3JhZGllbnQsIFJlY3RhbmdsZSwgUmljaFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgWHJheURpZmZyYWN0aW9uQ29uc3RhbnRzIGZyb20gJy4uLy4uL2NvbW1vbi9YcmF5RGlmZnJhY3Rpb25Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgeHJheURpZmZyYWN0aW9uIGZyb20gJy4uLy4uL3hyYXlEaWZmcmFjdGlvbi5qcyc7XHJcbmltcG9ydCBYcmF5RGlmZnJhY3Rpb25TdHJpbmdzIGZyb20gJy4uLy4uL1hyYXlEaWZmcmFjdGlvblN0cmluZ3MuanMnO1xyXG5cclxuLy8gc3RyaW5nc1xyXG5jb25zdCBhTGF0dGljZUNvbnN0YW50U3RyaW5nID0gWHJheURpZmZyYWN0aW9uU3RyaW5ncy5hTGF0dGljZUNvbnN0YW50O1xyXG5jb25zdCBiTGF0dGljZUNvbnN0YW50U3RyaW5nID0gWHJheURpZmZyYWN0aW9uU3RyaW5ncy5iTGF0dGljZUNvbnN0YW50O1xyXG5jb25zdCBpbnRlcnBsYW5lRGlzdGFuY2VTdHJpbmcgPSBYcmF5RGlmZnJhY3Rpb25TdHJpbmdzLmludGVycGxhbmVEaXN0YW5jZTtcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBSQURJVVMgPSA1OyAgIC8vIEF0b21pYyBOdWNsZXVzIFJhZGl1cy4gQXJiaXRyYXJpbHkgc2V0IHRvIGxvb2sgZ29vZFxyXG5jb25zdCBESU1FTlNJT05fQVJST1dfT1BUSU9OUyA9IHsgZmlsbDogJ2JsYWNrJywgc3Ryb2tlOiBudWxsLCB0YWlsV2lkdGg6IDIsIGhlYWRXaWR0aDogNywgaGVhZEhlaWdodDogMjAsIGRvdWJsZUhlYWQ6IHRydWUgfTtcclxuY29uc3QgU0NBTEVfRkFDVE9SID0gWHJheURpZmZyYWN0aW9uQ29uc3RhbnRzLlNDQUxFX0ZBQ1RPUjtcclxuY29uc3QgRElNRU5TSU9OX0xBQkVMX01BWFdJRFRIID0gMTAwOyAvLyBhcmJpdHJhcnkgbWF4IHdpZHRoIGZvciBsYWJlbHNcclxuXHJcbmNsYXNzIENyeXN0YWxOb2RlIGV4dGVuZHMgTm9kZSB7XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtBcnJheS48VmVjdG9yMj59IHNpdGVzIC0gYW4gQXJyYXkgb2YgVmVjdG9yMiBwb2ludHMgZm9yIHRoZSBjcnlzdGFsIGxhdHRpY2VcclxuICAgKiBAcGFyYW0ge1ZlY3RvcjN9IGxhdHRpY2VDb25zdGFudHNcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHNpdGVzLCBsYXR0aWNlQ29uc3RhbnRzLCBvcHRpb25zICkge1xyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggQXJyYXkuaXNBcnJheSggc2l0ZXMgKSwgYHNpdGVzIHNob3VsZCBiZSBhbiBBcnJheTogJHtzaXRlc31gICk7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICBjb25zdCBhdG9tc05vZGUgPSBuZXcgTm9kZSgpO1xyXG4gICAgbGV0IHhNaW4gPSAwO1xyXG4gICAgbGV0IHlNaW4gPSAwO1xyXG4gICAgbGV0IHhNYXggPSAwO1xyXG4gICAgbGV0IHlNYXggPSAwO1xyXG5cclxuICAgIHNpdGVzLmZvckVhY2goIHNpdGUgPT4ge1xyXG4gICAgICBjb25zdCBhdG9tID0gbmV3IENpcmNsZSggUkFESVVTLCB7XHJcbiAgICAgICAgeDogU0NBTEVfRkFDVE9SICogc2l0ZS54LCB5OiBTQ0FMRV9GQUNUT1IgKiBzaXRlLnksXHJcbiAgICAgICAgZmlsbDogbmV3IFJhZGlhbEdyYWRpZW50KCAyLCAtMywgMiwgMiwgLTMsIDcgKSAvLyBmaWxsIHBhdHRlcm4gdG8gbWFrZSB0aGUgYXRvbXMgbG9vayBwcmV0dHlcclxuICAgICAgICAgIC5hZGRDb2xvclN0b3AoIDAsICcjZjk3ZDdkJyApXHJcbiAgICAgICAgICAuYWRkQ29sb3JTdG9wKCAwLjUsICcjZWQ0NTQ1JyApXHJcbiAgICAgICAgICAuYWRkQ29sb3JTdG9wKCAxLCAnI2YwMCcgKVxyXG4gICAgICB9ICk7XHJcbiAgICAgIGlmICggc2l0ZS54IDwgeE1pbiApIHsgeE1pbiA9IHNpdGUueDsgfVxyXG4gICAgICBpZiAoIHNpdGUueSA8IHlNaW4gKSB7IHlNaW4gPSBzaXRlLnk7IH1cclxuICAgICAgaWYgKCBzaXRlLnggPiB4TWF4ICkgeyB4TWF4ID0gc2l0ZS54OyB9XHJcbiAgICAgIGlmICggc2l0ZS55ID4geU1heCApIHsgeU1heCA9IHNpdGUueTsgfVxyXG4gICAgICBhdG9tc05vZGUuYWRkQ2hpbGQoIGF0b20gKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBhZGQgYSByZWN0YW5ndWxhciBzaGFwZSB0byBkZWZpbmUgdGhlIGNyeXN0YWxcclxuICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBSZWN0YW5nbGUoIFNDQUxFX0ZBQ1RPUiAqIHhNaW4gLSBSQURJVVMsIFNDQUxFX0ZBQ1RPUiAqIHlNaW4gLSBSQURJVVMsIFNDQUxFX0ZBQ1RPUiAqICggeE1heCAtIHhNaW4gKSArIDIgKiBSQURJVVMsXHJcbiAgICAgIFNDQUxFX0ZBQ1RPUiAqICggeU1heCAtIHlNaW4gKSArIDIgKiBSQURJVVMsIFJBRElVUywgUkFESVVTLCB7IGZpbGw6ICdoc2woMjEwLDEwMCUsOTUlKScgfSApICk7IC8vIGxpZ2h0IGNvbG9yIHBpY2tlZCBieSBoYW5kXHJcbiAgICB0aGlzLmFkZENoaWxkKCBhdG9tc05vZGUgKTtcclxuXHJcbiAgICAvLyBMYWJlbCBsYXR0aWNlIGNvbnN0YW50c1xyXG4gICAgY29uc3QgYURpbWVuc2lvbkFycm93ID0gbmV3IEFycm93Tm9kZSggU0NBTEVfRkFDVE9SICogeE1pbiwgU0NBTEVfRkFDVE9SICogbGF0dGljZUNvbnN0YW50cy56LFxyXG4gICAgICBTQ0FMRV9GQUNUT1IgKiAoIHhNaW4gKyBsYXR0aWNlQ29uc3RhbnRzLnggKSwgU0NBTEVfRkFDVE9SICogbGF0dGljZUNvbnN0YW50cy56LCBESU1FTlNJT05fQVJST1dfT1BUSU9OUyApO1xyXG4gICAgY29uc3QgYkRpbWVuc2lvbkFycm93ID0gbmV3IEFycm93Tm9kZSggU0NBTEVfRkFDVE9SICogeE1pbiwgMCwgU0NBTEVfRkFDVE9SICogeE1pbixcclxuICAgICAgU0NBTEVfRkFDVE9SICogbGF0dGljZUNvbnN0YW50cy56LCBESU1FTlNJT05fQVJST1dfT1BUSU9OUyApO1xyXG4gICAgY29uc3QgZERpbWVuc2lvbkFycm93ID0gbmV3IEFycm93Tm9kZSggU0NBTEVfRkFDVE9SICogeE1pbiwgU0NBTEVfRkFDVE9SICogeU1pbiwgU0NBTEVfRkFDVE9SICogeE1pbixcclxuICAgICAgU0NBTEVfRkFDVE9SICogKCB5TWluICsgbGF0dGljZUNvbnN0YW50cy56ICksIERJTUVOU0lPTl9BUlJPV19PUFRJT05TICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBhRGltZW5zaW9uQXJyb3cgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGJEaW1lbnNpb25BcnJvdyApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggZERpbWVuc2lvbkFycm93ICk7XHJcbiAgICBjb25zdCBhRGltZW5zaW9uTGFiZWwgPSBuZXcgUmljaFRleHQoIGFMYXR0aWNlQ29uc3RhbnRTdHJpbmcsIHsgbWF4V2lkdGg6IERJTUVOU0lPTl9MQUJFTF9NQVhXSURUSCwgY2VudGVyWDogYURpbWVuc2lvbkFycm93LmNlbnRlclgsIHRvcDogYURpbWVuc2lvbkFycm93LmNlbnRlclkgfSApO1xyXG4gICAgY29uc3QgYkRpbWVuc2lvbkxhYmVsID0gbmV3IFJpY2hUZXh0KCBiTGF0dGljZUNvbnN0YW50U3RyaW5nLCB7IG1heFdpZHRoOiBESU1FTlNJT05fTEFCRUxfTUFYV0lEVEgsIGNlbnRlclk6IGJEaW1lbnNpb25BcnJvdy5jZW50ZXJZLCByaWdodDogYkRpbWVuc2lvbkFycm93LmNlbnRlclggLSA1IH0gKTtcclxuICAgIGNvbnN0IGREaW1lbnNpb25MYWJlbCA9IG5ldyBSaWNoVGV4dCggaW50ZXJwbGFuZURpc3RhbmNlU3RyaW5nLCB7IG1heFdpZHRoOiBESU1FTlNJT05fTEFCRUxfTUFYV0lEVEgsIGNlbnRlclk6IGREaW1lbnNpb25BcnJvdy5jZW50ZXJZLCByaWdodDogZERpbWVuc2lvbkFycm93LmNlbnRlclggLSA1IH0gKTtcclxuXHJcbiAgICAvLyBmYWtlIGxhYmVscyB0byBleHBhbmQgc3ltbWV0cmljYWxseSBhbmQga2VlcCB0aGUgY3J5c3RhbCBjZW50ZXJlZFxyXG4gICAgY29uc3QgZmFrZUxhYmVsMSA9IG5ldyBSaWNoVGV4dCggaW50ZXJwbGFuZURpc3RhbmNlU3RyaW5nLFxyXG4gICAgICB7IGZpbGw6ICd0cmFuc3BhcmVudCcsIG1heFdpZHRoOiBESU1FTlNJT05fTEFCRUxfTUFYV0lEVEgsIGNlbnRlclk6IGREaW1lbnNpb25BcnJvdy5jZW50ZXJZLCBsZWZ0OiAtZERpbWVuc2lvbkFycm93LmNlbnRlclggKyA1IH0gKTtcclxuICAgIGNvbnN0IGZha2VMYWJlbDIgPSBuZXcgUmljaFRleHQoIGFMYXR0aWNlQ29uc3RhbnRTdHJpbmcsXHJcbiAgICAgIHsgZmlsbDogJ3RyYW5zcGFyZW50JywgbWF4V2lkdGg6IERJTUVOU0lPTl9MQUJFTF9NQVhXSURUSCwgY2VudGVyWDogYURpbWVuc2lvbkFycm93LmNlbnRlclgsIGJvdHRvbTogLWFEaW1lbnNpb25BcnJvdy5jZW50ZXJZIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGFEaW1lbnNpb25MYWJlbCApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggYkRpbWVuc2lvbkxhYmVsICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBkRGltZW5zaW9uTGFiZWwgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGZha2VMYWJlbDEgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGZha2VMYWJlbDIgKTtcclxuXHJcbiAgICAvLyBjb252ZW5pZW5jZSBzcGVjaWZ5IHRocm91Z2ggb3B0aW9ucyB0aGUgY2VudGVyIG9mIHRoZSBub2RlIGFmdGVyIGV2ZXJ5dGhpbmcgaGFzIGJlIGFkZGVkXHJcbiAgICB0aGlzLmNlbnRlclggPSBvcHRpb25zLmNlbnRlclg7XHJcbiAgICB0aGlzLmNlbnRlclkgPSBvcHRpb25zLmNlbnRlclk7XHJcbiAgfVxyXG59XHJcblxyXG54cmF5RGlmZnJhY3Rpb24ucmVnaXN0ZXIoICdDcnlzdGFsTm9kZScsIENyeXN0YWxOb2RlICk7XHJcbmV4cG9ydCBkZWZhdWx0IENyeXN0YWxOb2RlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLE9BQU9BLFNBQVMsTUFBTSwwQ0FBMEM7QUFDaEUsU0FBU0MsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLGNBQWMsRUFBRUMsU0FBUyxFQUFFQyxRQUFRLFFBQVEsbUNBQW1DO0FBQ3JHLE9BQU9DLHdCQUF3QixNQUFNLDBDQUEwQztBQUMvRSxPQUFPQyxlQUFlLE1BQU0sMEJBQTBCO0FBQ3RELE9BQU9DLHNCQUFzQixNQUFNLGlDQUFpQzs7QUFFcEU7QUFDQSxNQUFNQyxzQkFBc0IsR0FBR0Qsc0JB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