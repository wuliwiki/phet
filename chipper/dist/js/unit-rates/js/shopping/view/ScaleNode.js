// Copyright 2017-2023, University of Colorado Boulder

/**
 * View of the scale, with display for cost and (optionally) quantity.
 * Origin is at the center of the top surface.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import { Shape } from '../../../../kite/js/imports.js';
import merge from '../../../../phet-core/js/merge.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import { Circle, HBox, Line, LinearGradient, Node, Path, Rectangle } from '../../../../scenery/js/imports.js';
import URColors from '../../common/URColors.js';
import URUtils from '../../common/URUtils.js';
import ValueNode from '../../common/view/ValueNode.js';
import ValuePanel from '../../common/view/ValuePanel.js';
import unitRates from '../../unitRates.js';
import UnitRatesStrings from '../../UnitRatesStrings.js';
import CostNode from './CostNode.js';

// constants
const PANEL_WIDTH = 132;
const PANEL_MIN_HEIGHT = 32;
const DISPLAY_X_MARGIN = 25;
const DISPLAY_Y_MARGIN = 7;
export default class ScaleNode extends Node {
  /**
   * @param {Scale} scale
   * @param {Object} [options]
   */
  constructor(scale, options) {
    options = merge({
      costExpandedProperty: null,
      // {Property.<boolean>|null} null indicates that cost display is not collapsible
      extraCostDecimalVisible: false,
      // {boolean} does the scale show a 3rd decimal place for cost?
      quantityIsDisplayed: false // {boolean} does the scale show quantity?
    }, options);

    // round platter on top, origin at center ---------------------------------------------------

    const topThickness = 8;
    const topRadiusX = 0.5 * scale.width;
    const topRadiusY = 0.5 * scale.depth;
    const topFaceShape = new Shape().ellipse(0, 0, topRadiusX, topRadiusY, 0);
    const topSideShape = new Shape().moveTo(-topRadiusX, 0).lineTo(-topRadiusX, topThickness).ellipticalArc(0, topThickness, topRadiusX, topRadiusY, 0, Math.PI, 0, true).lineTo(topRadiusX, 0).close();
    const topFaceNode = new Path(topFaceShape, {
      fill: new LinearGradient(-topRadiusX / 2, -topRadiusX / 2, topRadiusX / 2, topRadiusX / 2).addColorStop(0, URColors.scaleTopLight).addColorStop(0.5, URColors.scaleTopDark).addColorStop(1, URColors.scaleTopLight),
      stroke: 'black'
    });
    const topSideNode = new Path(topSideShape, {
      fill: 'rgb( 140, 140, 140 )',
      stroke: 'black'
    });
    const topNode = new Node({
      children: [topSideNode, topFaceNode]
    });

    // shadow under the top platter
    const shadowNode = new Path(topFaceShape, {
      fill: 'rgb( 100, 100, 100 )',
      opacity: 0.2,
      y: topFaceNode.y + 2 * topThickness
    });

    // body of the scale ---------------------------------------------------------------------

    // scale.width is the width at the midpoint of the scale's top face, compute the foreground and background widths
    const foregroundWidth = scale.width + scale.perspectiveXOffset;
    const backgroundWidth = scale.width - scale.perspectiveXOffset;

    // draw top face clockwise, starting at front-left corner, in pseudo-3D using parallel perspective
    const bodyShape = new Shape().moveTo(0, 0).lineTo(scale.perspectiveXOffset, -scale.depth).lineTo(scale.perspectiveXOffset + backgroundWidth, -scale.depth).lineTo(foregroundWidth, 0);

    // add front face
    bodyShape.rect(0, 0, scale.width + scale.perspectiveXOffset, scale.height);

    // origin at center of top face
    const bodyNode = new Path(bodyShape, {
      fill: URColors.scaleBody,
      stroke: 'black',
      lineJoin: 'round',
      centerX: topNode.centerX,
      centerY: topNode.centerY + scale.depth
    });

    // display on front of the scale ---------------------------------------------------------------------

    // display background
    const displayBackgroundNode = new Rectangle(0, 0, foregroundWidth - 2 * DISPLAY_X_MARGIN, scale.height - 2 * DISPLAY_Y_MARGIN, {
      fill: 'black',
      cornerRadius: 4,
      left: bodyNode.left + DISPLAY_X_MARGIN,
      bottom: bodyNode.bottom - DISPLAY_Y_MARGIN
    });

    // Nodes that make up the numeric display on the scale
    const displayChildren = [];

    // dispose required
    const costNode = new CostNode(scale.costProperty, {
      extraDecimalVisible: options.extraCostDecimalVisible,
      maxWidth: 90 // i18n, determined empirically
    });

    // dispose required
    const costPanel = new ValuePanel(costNode, {
      panelWidth: PANEL_WIDTH,
      panelMinHeight: PANEL_MIN_HEIGHT,
      expandedProperty: options.costExpandedProperty,
      titleString: UnitRatesStrings.cost
    });
    displayChildren.push(costPanel);

    // optional quantity display
    let quantityNode = null;
    let quantityPanel = null;
    if (options.quantityIsDisplayed) {
      // dispose required
      quantityNode = new ValueNode(scale.quantityProperty, {
        valueToString: value => quantityToString(value, scale.quantityUnits)
      });

      // dispose required
      quantityPanel = new ValuePanel(quantityNode, {
        panelWidth: PANEL_WIDTH,
        panelMinHeight: PANEL_MIN_HEIGHT
      });
      displayChildren.push(quantityPanel);
    }

    // Assemble the display
    const displayNode = new Node({
      children: [displayBackgroundNode, new HBox({
        children: displayChildren,
        align: 'center',
        spacing: 8,
        center: displayBackgroundNode.center
      })]
    });

    // put all of the above pieces together ---------------------------------------------------------------------

    // This type does not propagate options to the supertype because the model determines position.
    super({
      children: [bodyNode, shadowNode, topNode, displayNode]
    });

    // red dot at origin, red line at drag threshold
    if (phet.chipper.queryParameters.dev) {
      this.addChild(new Circle(2, {
        fill: 'red'
      }));
      const lineY = scale.yAboveScale - scale.position.y;
      this.addChild(new Line(-foregroundWidth / 2, lineY, foregroundWidth / 2, lineY, {
        stroke: 'red'
      }));
    }

    // move to model position
    this.translation = scale.position;

    // @private
    this.disposeScaleNode = () => {
      costNode.dispose();
      costPanel.dispose();
      quantityNode && quantityNode.dispose();
      quantityPanel && quantityPanel.dispose();
    };
  }

  /**
   * @public
   * @override
   */
  dispose() {
    this.disposeScaleNode();
    super.dispose();
  }
}

/**
 * Converts a quantity to a string with units, e.g. 10.5 -> '10.5 lb'
 * @param {number} quantity
 * @param {string} units
 * @returns {string}
 */
function quantityToString(quantity, units) {
  return StringUtils.format(UnitRatesStrings.pattern_0value_1units, URUtils.numberToString(quantity, 1 /* maxDecimals */, false /* trimZeros */), units);
}
unitRates.register('ScaleNode', ScaleNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaGFwZSIsIm1lcmdlIiwiU3RyaW5nVXRpbHMiLCJDaXJjbGUiLCJIQm94IiwiTGluZSIsIkxpbmVhckdyYWRpZW50IiwiTm9kZSIsIlBhdGgiLCJSZWN0YW5nbGUiLCJVUkNvbG9ycyIsIlVSVXRpbHMiLCJWYWx1ZU5vZGUiLCJWYWx1ZVBhbmVsIiwidW5pdFJhdGVzIiwiVW5pdFJhdGVzU3RyaW5ncyIsIkNvc3ROb2RlIiwiUEFORUxfV0lEVEgiLCJQQU5FTF9NSU5fSEVJR0hUIiwiRElTUExBWV9YX01BUkdJTiIsIkRJU1BMQVlfWV9NQVJHSU4iLCJTY2FsZU5vZGUiLCJjb25zdHJ1Y3RvciIsInNjYWxlIiwib3B0aW9ucyIsImNvc3RFeHBhbmRlZFByb3BlcnR5IiwiZXh0cmFDb3N0RGVjaW1hbFZpc2libGUiLCJxdWFudGl0eUlzRGlzcGxheWVkIiwidG9wVGhpY2tuZXNzIiwidG9wUmFkaXVzWCIsIndpZHRoIiwidG9wUmFkaXVzWSIsImRlcHRoIiwidG9wRmFjZVNoYXBlIiwiZWxsaXBzZSIsInRvcFNpZGVTaGFwZSIsIm1vdmVUbyIsImxpbmVUbyIsImVsbGlwdGljYWxBcmMiLCJNYXRoIiwiUEkiLCJjbG9zZSIsInRvcEZhY2VOb2RlIiwiZmlsbCIsImFkZENvbG9yU3RvcCIsInNjYWxlVG9wTGlnaHQiLCJzY2FsZVRvcERhcmsiLCJzdHJva2UiLCJ0b3BTaWRlTm9kZSIsInRvcE5vZGUiLCJjaGlsZHJlbiIsInNoYWRvd05vZGUiLCJvcGFjaXR5IiwieSIsImZvcmVncm91bmRXaWR0aCIsInBlcnNwZWN0aXZlWE9mZnNldCIsImJhY2tncm91bmRXaWR0aCIsImJvZHlTaGFwZSIsInJlY3QiLCJoZWlnaHQiLCJib2R5Tm9kZSIsInNjYWxlQm9keSIsImxpbmVKb2luIiwiY2VudGVyWCIsImNlbnRlclkiLCJkaXNwbGF5QmFja2dyb3VuZE5vZGUiLCJjb3JuZXJSYWRpdXMiLCJsZWZ0IiwiYm90dG9tIiwiZGlzcGxheUNoaWxkcmVuIiwiY29zdE5vZGUiLCJjb3N0UHJvcGVydHkiLCJleHRyYURlY2ltYWxWaXNpYmxlIiwibWF4V2lkdGgiLCJjb3N0UGFuZWwiLCJwYW5lbFdpZHRoIiwicGFuZWxNaW5IZWlnaHQiLCJleHBhbmRlZFByb3BlcnR5IiwidGl0bGVTdHJpbmciLCJjb3N0IiwicHVzaCIsInF1YW50aXR5Tm9kZSIsInF1YW50aXR5UGFuZWwiLCJxdWFudGl0eVByb3BlcnR5IiwidmFsdWVUb1N0cmluZyIsInZhbHVlIiwicXVhbnRpdHlUb1N0cmluZyIsInF1YW50aXR5VW5pdHMiLCJkaXNwbGF5Tm9kZSIsImFsaWduIiwic3BhY2luZyIsImNlbnRlciIsInBoZXQiLCJjaGlwcGVyIiwicXVlcnlQYXJhbWV0ZXJzIiwiZGV2IiwiYWRkQ2hpbGQiLCJsaW5lWSIsInlBYm92ZVNjYWxlIiwicG9zaXRpb24iLCJ0cmFuc2xhdGlvbiIsImRpc3Bvc2VTY2FsZU5vZGUiLCJkaXNwb3NlIiwicXVhbnRpdHkiLCJ1bml0cyIsImZvcm1hdCIsInBhdHRlcm5fMHZhbHVlXzF1bml0cyIsIm51bWJlclRvU3RyaW5nIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJTY2FsZU5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTctMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogVmlldyBvZiB0aGUgc2NhbGUsIHdpdGggZGlzcGxheSBmb3IgY29zdCBhbmQgKG9wdGlvbmFsbHkpIHF1YW50aXR5LlxyXG4gKiBPcmlnaW4gaXMgYXQgdGhlIGNlbnRlciBvZiB0aGUgdG9wIHN1cmZhY2UuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IFN0cmluZ1V0aWxzIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdXRpbC9TdHJpbmdVdGlscy5qcyc7XHJcbmltcG9ydCB7IENpcmNsZSwgSEJveCwgTGluZSwgTGluZWFyR3JhZGllbnQsIE5vZGUsIFBhdGgsIFJlY3RhbmdsZSB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBVUkNvbG9ycyBmcm9tICcuLi8uLi9jb21tb24vVVJDb2xvcnMuanMnO1xyXG5pbXBvcnQgVVJVdGlscyBmcm9tICcuLi8uLi9jb21tb24vVVJVdGlscy5qcyc7XHJcbmltcG9ydCBWYWx1ZU5vZGUgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvVmFsdWVOb2RlLmpzJztcclxuaW1wb3J0IFZhbHVlUGFuZWwgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvVmFsdWVQYW5lbC5qcyc7XHJcbmltcG9ydCB1bml0UmF0ZXMgZnJvbSAnLi4vLi4vdW5pdFJhdGVzLmpzJztcclxuaW1wb3J0IFVuaXRSYXRlc1N0cmluZ3MgZnJvbSAnLi4vLi4vVW5pdFJhdGVzU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBDb3N0Tm9kZSBmcm9tICcuL0Nvc3ROb2RlLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBQQU5FTF9XSURUSCA9IDEzMjtcclxuY29uc3QgUEFORUxfTUlOX0hFSUdIVCA9IDMyO1xyXG5jb25zdCBESVNQTEFZX1hfTUFSR0lOID0gMjU7XHJcbmNvbnN0IERJU1BMQVlfWV9NQVJHSU4gPSA3O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2NhbGVOb2RlIGV4dGVuZHMgTm9kZSB7XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtTY2FsZX0gc2NhbGVcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHNjYWxlLCBvcHRpb25zICkge1xyXG5cclxuICAgIG9wdGlvbnMgPSBtZXJnZSgge1xyXG4gICAgICBjb3N0RXhwYW5kZWRQcm9wZXJ0eTogbnVsbCwgLy8ge1Byb3BlcnR5Ljxib29sZWFuPnxudWxsfSBudWxsIGluZGljYXRlcyB0aGF0IGNvc3QgZGlzcGxheSBpcyBub3QgY29sbGFwc2libGVcclxuICAgICAgZXh0cmFDb3N0RGVjaW1hbFZpc2libGU6IGZhbHNlLCAvLyB7Ym9vbGVhbn0gZG9lcyB0aGUgc2NhbGUgc2hvdyBhIDNyZCBkZWNpbWFsIHBsYWNlIGZvciBjb3N0P1xyXG4gICAgICBxdWFudGl0eUlzRGlzcGxheWVkOiBmYWxzZSAvLyB7Ym9vbGVhbn0gZG9lcyB0aGUgc2NhbGUgc2hvdyBxdWFudGl0eT9cclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyByb3VuZCBwbGF0dGVyIG9uIHRvcCwgb3JpZ2luIGF0IGNlbnRlciAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBjb25zdCB0b3BUaGlja25lc3MgPSA4O1xyXG4gICAgY29uc3QgdG9wUmFkaXVzWCA9IDAuNSAqIHNjYWxlLndpZHRoO1xyXG4gICAgY29uc3QgdG9wUmFkaXVzWSA9IDAuNSAqIHNjYWxlLmRlcHRoO1xyXG4gICAgY29uc3QgdG9wRmFjZVNoYXBlID0gbmV3IFNoYXBlKClcclxuICAgICAgLmVsbGlwc2UoIDAsIDAsIHRvcFJhZGl1c1gsIHRvcFJhZGl1c1ksIDAgKTtcclxuICAgIGNvbnN0IHRvcFNpZGVTaGFwZSA9IG5ldyBTaGFwZSgpXHJcbiAgICAgIC5tb3ZlVG8oIC10b3BSYWRpdXNYLCAwIClcclxuICAgICAgLmxpbmVUbyggLXRvcFJhZGl1c1gsIHRvcFRoaWNrbmVzcyApXHJcbiAgICAgIC5lbGxpcHRpY2FsQXJjKCAwLCB0b3BUaGlja25lc3MsIHRvcFJhZGl1c1gsIHRvcFJhZGl1c1ksIDAsIE1hdGguUEksIDAsIHRydWUgKVxyXG4gICAgICAubGluZVRvKCB0b3BSYWRpdXNYLCAwIClcclxuICAgICAgLmNsb3NlKCk7XHJcblxyXG4gICAgY29uc3QgdG9wRmFjZU5vZGUgPSBuZXcgUGF0aCggdG9wRmFjZVNoYXBlLCB7XHJcbiAgICAgIGZpbGw6IG5ldyBMaW5lYXJHcmFkaWVudCggLXRvcFJhZGl1c1ggLyAyLCAtdG9wUmFkaXVzWCAvIDIsIHRvcFJhZGl1c1ggLyAyLCB0b3BSYWRpdXNYIC8gMiApXHJcbiAgICAgICAgLmFkZENvbG9yU3RvcCggMCwgVVJDb2xvcnMuc2NhbGVUb3BMaWdodCApXHJcbiAgICAgICAgLmFkZENvbG9yU3RvcCggMC41LCBVUkNvbG9ycy5zY2FsZVRvcERhcmsgKVxyXG4gICAgICAgIC5hZGRDb2xvclN0b3AoIDEsIFVSQ29sb3JzLnNjYWxlVG9wTGlnaHQgKSxcclxuICAgICAgc3Ryb2tlOiAnYmxhY2snXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCB0b3BTaWRlTm9kZSA9IG5ldyBQYXRoKCB0b3BTaWRlU2hhcGUsIHtcclxuICAgICAgZmlsbDogJ3JnYiggMTQwLCAxNDAsIDE0MCApJyxcclxuICAgICAgc3Ryb2tlOiAnYmxhY2snXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCB0b3BOb2RlID0gbmV3IE5vZGUoIHtcclxuICAgICAgY2hpbGRyZW46IFsgdG9wU2lkZU5vZGUsIHRvcEZhY2VOb2RlIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBzaGFkb3cgdW5kZXIgdGhlIHRvcCBwbGF0dGVyXHJcbiAgICBjb25zdCBzaGFkb3dOb2RlID0gbmV3IFBhdGgoIHRvcEZhY2VTaGFwZSwge1xyXG4gICAgICBmaWxsOiAncmdiKCAxMDAsIDEwMCwgMTAwICknLFxyXG4gICAgICBvcGFjaXR5OiAwLjIsXHJcbiAgICAgIHk6IHRvcEZhY2VOb2RlLnkgKyAoIDIgKiB0b3BUaGlja25lc3MgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGJvZHkgb2YgdGhlIHNjYWxlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIC8vIHNjYWxlLndpZHRoIGlzIHRoZSB3aWR0aCBhdCB0aGUgbWlkcG9pbnQgb2YgdGhlIHNjYWxlJ3MgdG9wIGZhY2UsIGNvbXB1dGUgdGhlIGZvcmVncm91bmQgYW5kIGJhY2tncm91bmQgd2lkdGhzXHJcbiAgICBjb25zdCBmb3JlZ3JvdW5kV2lkdGggPSBzY2FsZS53aWR0aCArIHNjYWxlLnBlcnNwZWN0aXZlWE9mZnNldDtcclxuICAgIGNvbnN0IGJhY2tncm91bmRXaWR0aCA9IHNjYWxlLndpZHRoIC0gc2NhbGUucGVyc3BlY3RpdmVYT2Zmc2V0O1xyXG5cclxuICAgIC8vIGRyYXcgdG9wIGZhY2UgY2xvY2t3aXNlLCBzdGFydGluZyBhdCBmcm9udC1sZWZ0IGNvcm5lciwgaW4gcHNldWRvLTNEIHVzaW5nIHBhcmFsbGVsIHBlcnNwZWN0aXZlXHJcbiAgICBjb25zdCBib2R5U2hhcGUgPSBuZXcgU2hhcGUoKVxyXG4gICAgICAubW92ZVRvKCAwLCAwIClcclxuICAgICAgLmxpbmVUbyggc2NhbGUucGVyc3BlY3RpdmVYT2Zmc2V0LCAtc2NhbGUuZGVwdGggKVxyXG4gICAgICAubGluZVRvKCBzY2FsZS5wZXJzcGVjdGl2ZVhPZmZzZXQgKyBiYWNrZ3JvdW5kV2lkdGgsIC1zY2FsZS5kZXB0aCApXHJcbiAgICAgIC5saW5lVG8oIGZvcmVncm91bmRXaWR0aCwgMCApO1xyXG5cclxuICAgIC8vIGFkZCBmcm9udCBmYWNlXHJcbiAgICBib2R5U2hhcGUucmVjdCggMCwgMCwgc2NhbGUud2lkdGggKyBzY2FsZS5wZXJzcGVjdGl2ZVhPZmZzZXQsIHNjYWxlLmhlaWdodCApO1xyXG5cclxuICAgIC8vIG9yaWdpbiBhdCBjZW50ZXIgb2YgdG9wIGZhY2VcclxuICAgIGNvbnN0IGJvZHlOb2RlID0gbmV3IFBhdGgoIGJvZHlTaGFwZSwge1xyXG4gICAgICBmaWxsOiBVUkNvbG9ycy5zY2FsZUJvZHksXHJcbiAgICAgIHN0cm9rZTogJ2JsYWNrJyxcclxuICAgICAgbGluZUpvaW46ICdyb3VuZCcsXHJcbiAgICAgIGNlbnRlclg6IHRvcE5vZGUuY2VudGVyWCxcclxuICAgICAgY2VudGVyWTogdG9wTm9kZS5jZW50ZXJZICsgc2NhbGUuZGVwdGhcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBkaXNwbGF5IG9uIGZyb250IG9mIHRoZSBzY2FsZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAvLyBkaXNwbGF5IGJhY2tncm91bmRcclxuICAgIGNvbnN0IGRpc3BsYXlCYWNrZ3JvdW5kTm9kZSA9IG5ldyBSZWN0YW5nbGUoIDAsIDAsIGZvcmVncm91bmRXaWR0aCAtICggMiAqIERJU1BMQVlfWF9NQVJHSU4gKSwgc2NhbGUuaGVpZ2h0IC0gKCAyICogRElTUExBWV9ZX01BUkdJTiApLCB7XHJcbiAgICAgIGZpbGw6ICdibGFjaycsXHJcbiAgICAgIGNvcm5lclJhZGl1czogNCxcclxuICAgICAgbGVmdDogYm9keU5vZGUubGVmdCArIERJU1BMQVlfWF9NQVJHSU4sXHJcbiAgICAgIGJvdHRvbTogYm9keU5vZGUuYm90dG9tIC0gRElTUExBWV9ZX01BUkdJTlxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIE5vZGVzIHRoYXQgbWFrZSB1cCB0aGUgbnVtZXJpYyBkaXNwbGF5IG9uIHRoZSBzY2FsZVxyXG4gICAgY29uc3QgZGlzcGxheUNoaWxkcmVuID0gW107XHJcblxyXG4gICAgLy8gZGlzcG9zZSByZXF1aXJlZFxyXG4gICAgY29uc3QgY29zdE5vZGUgPSBuZXcgQ29zdE5vZGUoIHNjYWxlLmNvc3RQcm9wZXJ0eSwge1xyXG4gICAgICBleHRyYURlY2ltYWxWaXNpYmxlOiBvcHRpb25zLmV4dHJhQ29zdERlY2ltYWxWaXNpYmxlLFxyXG4gICAgICBtYXhXaWR0aDogOTAgLy8gaTE4biwgZGV0ZXJtaW5lZCBlbXBpcmljYWxseVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGRpc3Bvc2UgcmVxdWlyZWRcclxuICAgIGNvbnN0IGNvc3RQYW5lbCA9IG5ldyBWYWx1ZVBhbmVsKCBjb3N0Tm9kZSwge1xyXG4gICAgICBwYW5lbFdpZHRoOiBQQU5FTF9XSURUSCxcclxuICAgICAgcGFuZWxNaW5IZWlnaHQ6IFBBTkVMX01JTl9IRUlHSFQsXHJcbiAgICAgIGV4cGFuZGVkUHJvcGVydHk6IG9wdGlvbnMuY29zdEV4cGFuZGVkUHJvcGVydHksXHJcbiAgICAgIHRpdGxlU3RyaW5nOiBVbml0UmF0ZXNTdHJpbmdzLmNvc3RcclxuICAgIH0gKTtcclxuICAgIGRpc3BsYXlDaGlsZHJlbi5wdXNoKCBjb3N0UGFuZWwgKTtcclxuXHJcbiAgICAvLyBvcHRpb25hbCBxdWFudGl0eSBkaXNwbGF5XHJcbiAgICBsZXQgcXVhbnRpdHlOb2RlID0gbnVsbDtcclxuICAgIGxldCBxdWFudGl0eVBhbmVsID0gbnVsbDtcclxuICAgIGlmICggb3B0aW9ucy5xdWFudGl0eUlzRGlzcGxheWVkICkge1xyXG5cclxuICAgICAgLy8gZGlzcG9zZSByZXF1aXJlZFxyXG4gICAgICBxdWFudGl0eU5vZGUgPSBuZXcgVmFsdWVOb2RlKCBzY2FsZS5xdWFudGl0eVByb3BlcnR5LCB7XHJcbiAgICAgICAgdmFsdWVUb1N0cmluZzogdmFsdWUgPT4gcXVhbnRpdHlUb1N0cmluZyggdmFsdWUsIHNjYWxlLnF1YW50aXR5VW5pdHMgKVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICAvLyBkaXNwb3NlIHJlcXVpcmVkXHJcbiAgICAgIHF1YW50aXR5UGFuZWwgPSBuZXcgVmFsdWVQYW5lbCggcXVhbnRpdHlOb2RlLCB7XHJcbiAgICAgICAgcGFuZWxXaWR0aDogUEFORUxfV0lEVEgsXHJcbiAgICAgICAgcGFuZWxNaW5IZWlnaHQ6IFBBTkVMX01JTl9IRUlHSFRcclxuICAgICAgfSApO1xyXG4gICAgICBkaXNwbGF5Q2hpbGRyZW4ucHVzaCggcXVhbnRpdHlQYW5lbCApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFzc2VtYmxlIHRoZSBkaXNwbGF5XHJcbiAgICBjb25zdCBkaXNwbGF5Tm9kZSA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgZGlzcGxheUJhY2tncm91bmROb2RlLFxyXG4gICAgICAgIG5ldyBIQm94KCB7XHJcbiAgICAgICAgICBjaGlsZHJlbjogZGlzcGxheUNoaWxkcmVuLFxyXG4gICAgICAgICAgYWxpZ246ICdjZW50ZXInLFxyXG4gICAgICAgICAgc3BhY2luZzogOCxcclxuICAgICAgICAgIGNlbnRlcjogZGlzcGxheUJhY2tncm91bmROb2RlLmNlbnRlclxyXG4gICAgICAgIH0gKSBdXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gcHV0IGFsbCBvZiB0aGUgYWJvdmUgcGllY2VzIHRvZ2V0aGVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIC8vIFRoaXMgdHlwZSBkb2VzIG5vdCBwcm9wYWdhdGUgb3B0aW9ucyB0byB0aGUgc3VwZXJ0eXBlIGJlY2F1c2UgdGhlIG1vZGVsIGRldGVybWluZXMgcG9zaXRpb24uXHJcbiAgICBzdXBlcigge1xyXG4gICAgICBjaGlsZHJlbjogWyBib2R5Tm9kZSwgc2hhZG93Tm9kZSwgdG9wTm9kZSwgZGlzcGxheU5vZGUgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHJlZCBkb3QgYXQgb3JpZ2luLCByZWQgbGluZSBhdCBkcmFnIHRocmVzaG9sZFxyXG4gICAgaWYgKCBwaGV0LmNoaXBwZXIucXVlcnlQYXJhbWV0ZXJzLmRldiApIHtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggbmV3IENpcmNsZSggMiwgeyBmaWxsOiAncmVkJyB9ICkgKTtcclxuICAgICAgY29uc3QgbGluZVkgPSBzY2FsZS55QWJvdmVTY2FsZSAtIHNjYWxlLnBvc2l0aW9uLnk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBMaW5lKCAtZm9yZWdyb3VuZFdpZHRoIC8gMiwgbGluZVksIGZvcmVncm91bmRXaWR0aCAvIDIsIGxpbmVZLCB7IHN0cm9rZTogJ3JlZCcgfSApICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gbW92ZSB0byBtb2RlbCBwb3NpdGlvblxyXG4gICAgdGhpcy50cmFuc2xhdGlvbiA9IHNjYWxlLnBvc2l0aW9uO1xyXG5cclxuICAgIC8vIEBwcml2YXRlXHJcbiAgICB0aGlzLmRpc3Bvc2VTY2FsZU5vZGUgPSAoKSA9PiB7XHJcbiAgICAgIGNvc3ROb2RlLmRpc3Bvc2UoKTtcclxuICAgICAgY29zdFBhbmVsLmRpc3Bvc2UoKTtcclxuICAgICAgcXVhbnRpdHlOb2RlICYmIHF1YW50aXR5Tm9kZS5kaXNwb3NlKCk7XHJcbiAgICAgIHF1YW50aXR5UGFuZWwgJiYgcXVhbnRpdHlQYW5lbC5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHB1YmxpY1xyXG4gICAqIEBvdmVycmlkZVxyXG4gICAqL1xyXG4gIGRpc3Bvc2UoKSB7XHJcbiAgICB0aGlzLmRpc3Bvc2VTY2FsZU5vZGUoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb252ZXJ0cyBhIHF1YW50aXR5IHRvIGEgc3RyaW5nIHdpdGggdW5pdHMsIGUuZy4gMTAuNSAtPiAnMTAuNSBsYidcclxuICogQHBhcmFtIHtudW1iZXJ9IHF1YW50aXR5XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB1bml0c1xyXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gKi9cclxuZnVuY3Rpb24gcXVhbnRpdHlUb1N0cmluZyggcXVhbnRpdHksIHVuaXRzICkge1xyXG4gIHJldHVybiBTdHJpbmdVdGlscy5mb3JtYXQoIFVuaXRSYXRlc1N0cmluZ3MucGF0dGVybl8wdmFsdWVfMXVuaXRzLFxyXG4gICAgVVJVdGlscy5udW1iZXJUb1N0cmluZyggcXVhbnRpdHksIDEgLyogbWF4RGVjaW1hbHMgKi8sIGZhbHNlIC8qIHRyaW1aZXJvcyAqLyApLCB1bml0cyApO1xyXG59XHJcblxyXG51bml0UmF0ZXMucmVnaXN0ZXIoICdTY2FsZU5vZGUnLCBTY2FsZU5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTQSxLQUFLLFFBQVEsZ0NBQWdDO0FBQ3RELE9BQU9DLEtBQUssTUFBTSxtQ0FBbUM7QUFDckQsT0FBT0MsV0FBVyxNQUFNLCtDQUErQztBQUN2RSxTQUFTQyxNQUFNLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxjQUFjLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxTQUFTLFFBQVEsbUNBQW1DO0FBQzdHLE9BQU9DLFFBQVEsTUFBTSwwQkFBMEI7QUFDL0MsT0FBT0MsT0FBTyxNQUFNLHlCQUF5QjtBQUM3QyxPQUFPQyxTQUFTLE1BQU0sZ0NBQWdDO0FBQ3RELE9BQU9DLFVBQVUsTUFBTSxpQ0FBaUM7QUFDeEQsT0FBT0MsU0FBUyxNQUFNLG9CQUFvQjtBQUMxQyxPQUFPQyxnQkFBZ0IsTUFBTSwyQkFBMkI7QUFDeEQsT0FBT0MsUUFBUSxNQUFNLGVBQWU7O0FBRXBDO0FBQ0EsTUFBTUMsV0FBVyxHQUFHLEdBQUc7QUFDdkIsTUFBTUMsZ0JBQWdCLEdBQUcsRUFBRTtBQUMzQixNQUFNQyxnQkFBZ0IsR0FBRyxFQUFFO0FBQzNCLE1BQU1DLGdCQUFnQixHQUFHLENBQUM7QUFFMUIsZUFBZSxNQUFNQyxTQUFTLFNBQVNkLElBQUksQ0FBQztFQUMxQztBQUNGO0FBQ0E7QUFDQTtFQUNFZSxXQUFXQSxDQUFFQyxLQUFLLEVBQUVDLE9BQU8sRUFBRztJQUU1QkEsT0FBTyxHQUFHdkIsS0FBSyxDQUFFO01BQ2Z3QixvQkFBb0IsRUFBRSxJQUFJO01BQUU7TUFDNUJDLHVCQUF1QixFQUFFLEtBQUs7TUFBRTtNQUNoQ0MsbUJBQW1CLEVBQUUsS0FBSyxDQUFDO0lBQzdCLENBQUMs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