// Copyright 2016-2023, University of Colorado Boulder

/**
 * Model for the 'Shopping' screen. Also used as the base type for the 'Shopping Lab' screen.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Property from '../../../../axon/js/Property.js';
import merge from '../../../../phet-core/js/merge.js';
import apple_png from '../../../images/apple_png.js';
import carrot_png from '../../../images/carrot_png.js';
import purpleCandy_png from '../../../images/purpleCandy_png.js';
import unitRates from '../../unitRates.js';
import CandyScene from './CandyScene.js';
import FruitScene from './FruitScene.js';
import ShoppingCategory from './ShoppingCategory.js';
import ShoppingItemData from './ShoppingItemData.js';
import VegetableScene from './VegetableScene.js';
export default class ShoppingModel {
  /**
   * @param {Object} [options]
   */
  constructor(options) {
    options = merge({
      categoryIndex: 0,
      // {number} index of the category that is initially selected
      categories: null // {ShoppingCategory[]} categories, populated below if not provided
    }, options);

    // @public (read-only) items are grouped into categories
    this.categories = options.categories || [
    // fruits
    new ShoppingCategory(apple_png, [new FruitScene(ShoppingItemData.Fruit.APPLES), new FruitScene(ShoppingItemData.Fruit.LEMONS), new FruitScene(ShoppingItemData.Fruit.ORANGES), new FruitScene(ShoppingItemData.Fruit.PEARS)]),
    // vegetables
    new ShoppingCategory(carrot_png, [new VegetableScene(ShoppingItemData.Vegetable.CARROTS), new VegetableScene(ShoppingItemData.Vegetable.CUCUMBERS), new VegetableScene(ShoppingItemData.Vegetable.POTATOES), new VegetableScene(ShoppingItemData.Vegetable.TOMATOES)]),
    // candies
    new ShoppingCategory(purpleCandy_png, [new CandyScene(ShoppingItemData.Candy.PURPLE_CANDY), new CandyScene(ShoppingItemData.Candy.RED_CANDY), new CandyScene(ShoppingItemData.Candy.GREEN_CANDY), new CandyScene(ShoppingItemData.Candy.BLUE_CANDY)])];

    // validate options
    assert && assert(options.categoryIndex >= 0 && options.categoryIndex < this.categories.length, `invalid categoryIndex: ${options.categoryIndex}`);

    // @public the selected category
    this.categoryProperty = new Property(this.categories[options.categoryIndex], {
      validValues: this.categories
    });
  }

  // @public
  reset() {
    this.categoryProperty.reset();
    this.categories.forEach(category => category.reset());
  }

  /**
   * Updates time-dependent parts of the model.
   * @param {number} dt - time since the previous step, in seconds
   * @public
   */
  step(dt) {
    // Cap dt, see https://github.com/phetsims/unit-rates/issues/193
    dt = Math.min(dt, 0.1);

    // step the selected category
    for (let i = 0; i < this.categories.length; i++) {
      if (this.categories[i] === this.categoryProperty.value) {
        this.categories[i].step(dt);
        break;
      }
    }
  }
}
unitRates.register('ShoppingModel', ShoppingModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIm1lcmdlIiwiYXBwbGVfcG5nIiwiY2Fycm90X3BuZyIsInB1cnBsZUNhbmR5X3BuZyIsInVuaXRSYXRlcyIsIkNhbmR5U2NlbmUiLCJGcnVpdFNjZW5lIiwiU2hvcHBpbmdDYXRlZ29yeSIsIlNob3BwaW5nSXRlbURhdGEiLCJWZWdldGFibGVTY2VuZSIsIlNob3BwaW5nTW9kZWwiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJjYXRlZ29yeUluZGV4IiwiY2F0ZWdvcmllcyIsIkZydWl0IiwiQVBQTEVTIiwiTEVNT05TIiwiT1JBTkdFUyIsIlBFQVJTIiwiVmVnZXRhYmxlIiwiQ0FSUk9UUyIsIkNVQ1VNQkVSUyIsIlBPVEFUT0VTIiwiVE9NQVRPRVMiLCJDYW5keSIsIlBVUlBMRV9DQU5EWSIsIlJFRF9DQU5EWSIsIkdSRUVOX0NBTkRZIiwiQkxVRV9DQU5EWSIsImFzc2VydCIsImxlbmd0aCIsImNhdGVnb3J5UHJvcGVydHkiLCJ2YWxpZFZhbHVlcyIsInJlc2V0IiwiZm9yRWFjaCIsImNhdGVnb3J5Iiwic3RlcCIsImR0IiwiTWF0aCIsIm1pbiIsImkiLCJ2YWx1ZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiU2hvcHBpbmdNb2RlbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNi0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBNb2RlbCBmb3IgdGhlICdTaG9wcGluZycgc2NyZWVuLiBBbHNvIHVzZWQgYXMgdGhlIGJhc2UgdHlwZSBmb3IgdGhlICdTaG9wcGluZyBMYWInIHNjcmVlbi5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgYXBwbGVfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9hcHBsZV9wbmcuanMnO1xyXG5pbXBvcnQgY2Fycm90X3BuZyBmcm9tICcuLi8uLi8uLi9pbWFnZXMvY2Fycm90X3BuZy5qcyc7XHJcbmltcG9ydCBwdXJwbGVDYW5keV9wbmcgZnJvbSAnLi4vLi4vLi4vaW1hZ2VzL3B1cnBsZUNhbmR5X3BuZy5qcyc7XHJcbmltcG9ydCB1bml0UmF0ZXMgZnJvbSAnLi4vLi4vdW5pdFJhdGVzLmpzJztcclxuaW1wb3J0IENhbmR5U2NlbmUgZnJvbSAnLi9DYW5keVNjZW5lLmpzJztcclxuaW1wb3J0IEZydWl0U2NlbmUgZnJvbSAnLi9GcnVpdFNjZW5lLmpzJztcclxuaW1wb3J0IFNob3BwaW5nQ2F0ZWdvcnkgZnJvbSAnLi9TaG9wcGluZ0NhdGVnb3J5LmpzJztcclxuaW1wb3J0IFNob3BwaW5nSXRlbURhdGEgZnJvbSAnLi9TaG9wcGluZ0l0ZW1EYXRhLmpzJztcclxuaW1wb3J0IFZlZ2V0YWJsZVNjZW5lIGZyb20gJy4vVmVnZXRhYmxlU2NlbmUuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2hvcHBpbmdNb2RlbCB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvciggb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgY2F0ZWdvcnlJbmRleDogMCwgLy8ge251bWJlcn0gaW5kZXggb2YgdGhlIGNhdGVnb3J5IHRoYXQgaXMgaW5pdGlhbGx5IHNlbGVjdGVkXHJcbiAgICAgIGNhdGVnb3JpZXM6IG51bGwgLy8ge1Nob3BwaW5nQ2F0ZWdvcnlbXX0gY2F0ZWdvcmllcywgcG9wdWxhdGVkIGJlbG93IGlmIG5vdCBwcm92aWRlZFxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMgKHJlYWQtb25seSkgaXRlbXMgYXJlIGdyb3VwZWQgaW50byBjYXRlZ29yaWVzXHJcbiAgICB0aGlzLmNhdGVnb3JpZXMgPSBvcHRpb25zLmNhdGVnb3JpZXMgfHwgW1xyXG5cclxuICAgICAgLy8gZnJ1aXRzXHJcbiAgICAgIG5ldyBTaG9wcGluZ0NhdGVnb3J5KCBhcHBsZV9wbmcsIFtcclxuICAgICAgICBuZXcgRnJ1aXRTY2VuZSggU2hvcHBpbmdJdGVtRGF0YS5GcnVpdC5BUFBMRVMgKSxcclxuICAgICAgICBuZXcgRnJ1aXRTY2VuZSggU2hvcHBpbmdJdGVtRGF0YS5GcnVpdC5MRU1PTlMgKSxcclxuICAgICAgICBuZXcgRnJ1aXRTY2VuZSggU2hvcHBpbmdJdGVtRGF0YS5GcnVpdC5PUkFOR0VTICksXHJcbiAgICAgICAgbmV3IEZydWl0U2NlbmUoIFNob3BwaW5nSXRlbURhdGEuRnJ1aXQuUEVBUlMgKVxyXG4gICAgICBdICksXHJcblxyXG4gICAgICAvLyB2ZWdldGFibGVzXHJcbiAgICAgIG5ldyBTaG9wcGluZ0NhdGVnb3J5KCBjYXJyb3RfcG5nLCBbXHJcbiAgICAgICAgbmV3IFZlZ2V0YWJsZVNjZW5lKCBTaG9wcGluZ0l0ZW1EYXRhLlZlZ2V0YWJsZS5DQVJST1RTICksXHJcbiAgICAgICAgbmV3IFZlZ2V0YWJsZVNjZW5lKCBTaG9wcGluZ0l0ZW1EYXRhLlZlZ2V0YWJsZS5DVUNVTUJFUlMgKSxcclxuICAgICAgICBuZXcgVmVnZXRhYmxlU2NlbmUoIFNob3BwaW5nSXRlbURhdGEuVmVnZXRhYmxlLlBPVEFUT0VTICksXHJcbiAgICAgICAgbmV3IFZlZ2V0YWJsZVNjZW5lKCBTaG9wcGluZ0l0ZW1EYXRhLlZlZ2V0YWJsZS5UT01BVE9FUyApXHJcbiAgICAgIF0gKSxcclxuXHJcbiAgICAgIC8vIGNhbmRpZXNcclxuICAgICAgbmV3IFNob3BwaW5nQ2F0ZWdvcnkoIHB1cnBsZUNhbmR5X3BuZywgW1xyXG4gICAgICAgIG5ldyBDYW5keVNjZW5lKCBTaG9wcGluZ0l0ZW1EYXRhLkNhbmR5LlBVUlBMRV9DQU5EWSApLFxyXG4gICAgICAgIG5ldyBDYW5keVNjZW5lKCBTaG9wcGluZ0l0ZW1EYXRhLkNhbmR5LlJFRF9DQU5EWSApLFxyXG4gICAgICAgIG5ldyBDYW5keVNjZW5lKCBTaG9wcGluZ0l0ZW1EYXRhLkNhbmR5LkdSRUVOX0NBTkRZICksXHJcbiAgICAgICAgbmV3IENhbmR5U2NlbmUoIFNob3BwaW5nSXRlbURhdGEuQ2FuZHkuQkxVRV9DQU5EWSApXHJcbiAgICAgIF0gKVxyXG4gICAgXTtcclxuXHJcbiAgICAvLyB2YWxpZGF0ZSBvcHRpb25zXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvcHRpb25zLmNhdGVnb3J5SW5kZXggPj0gMCAmJiBvcHRpb25zLmNhdGVnb3J5SW5kZXggPCB0aGlzLmNhdGVnb3JpZXMubGVuZ3RoLFxyXG4gICAgICBgaW52YWxpZCBjYXRlZ29yeUluZGV4OiAke29wdGlvbnMuY2F0ZWdvcnlJbmRleH1gICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyB0aGUgc2VsZWN0ZWQgY2F0ZWdvcnlcclxuICAgIHRoaXMuY2F0ZWdvcnlQcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eSggdGhpcy5jYXRlZ29yaWVzWyBvcHRpb25zLmNhdGVnb3J5SW5kZXggXSwge1xyXG4gICAgICB2YWxpZFZhbHVlczogdGhpcy5jYXRlZ29yaWVzXHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICAvLyBAcHVibGljXHJcbiAgcmVzZXQoKSB7XHJcbiAgICB0aGlzLmNhdGVnb3J5UHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMuY2F0ZWdvcmllcy5mb3JFYWNoKCBjYXRlZ29yeSA9PiBjYXRlZ29yeS5yZXNldCgpICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGVzIHRpbWUtZGVwZW5kZW50IHBhcnRzIG9mIHRoZSBtb2RlbC5cclxuICAgKiBAcGFyYW0ge251bWJlcn0gZHQgLSB0aW1lIHNpbmNlIHRoZSBwcmV2aW91cyBzdGVwLCBpbiBzZWNvbmRzXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIHN0ZXAoIGR0ICkge1xyXG5cclxuICAgIC8vIENhcCBkdCwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy91bml0LXJhdGVzL2lzc3Vlcy8xOTNcclxuICAgIGR0ID0gTWF0aC5taW4oIGR0LCAwLjEgKTtcclxuXHJcbiAgICAvLyBzdGVwIHRoZSBzZWxlY3RlZCBjYXRlZ29yeVxyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgdGhpcy5jYXRlZ29yaWVzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBpZiAoIHRoaXMuY2F0ZWdvcmllc1sgaSBdID09PSB0aGlzLmNhdGVnb3J5UHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgICAgdGhpcy5jYXRlZ29yaWVzWyBpIF0uc3RlcCggZHQgKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxudW5pdFJhdGVzLnJlZ2lzdGVyKCAnU2hvcHBpbmdNb2RlbCcsIFNob3BwaW5nTW9kZWwgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsUUFBUSxNQUFNLGlDQUFpQztBQUN0RCxPQUFPQyxLQUFLLE1BQU0sbUNBQW1DO0FBQ3JELE9BQU9DLFNBQVMsTUFBTSw4QkFBOEI7QUFDcEQsT0FBT0MsVUFBVSxNQUFNLCtCQUErQjtBQUN0RCxPQUFPQyxlQUFlLE1BQU0sb0NBQW9DO0FBQ2hFLE9BQU9DLFNBQVMsTUFBTSxvQkFBb0I7QUFDMUMsT0FBT0MsVUFBVSxNQUFNLGlCQUFpQjtBQUN4QyxPQUFPQyxVQUFVLE1BQU0saUJBQWlCO0FBQ3hDLE9BQU9DLGdCQUFnQixNQUFNLHVCQUF1QjtBQUNwRCxPQUFPQyxnQkFBZ0IsTUFBTSx1QkFBdUI7QUFDcEQsT0FBT0MsY0FBYyxNQUFNLHFCQUFxQjtBQUVoRCxlQUFlLE1BQU1DLGFBQWEsQ0FBQztFQUVqQztBQUNGO0FBQ0E7RUFDRUMsV0FB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