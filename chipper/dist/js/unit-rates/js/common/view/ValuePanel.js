// Copyright 2017-2023, University of Colorado Boulder

/**
 * Displays a value in a panel, with an optional expand/collapse button.
 * When expanded, it displays the right-justified Node.
 * When collapsed, it displays a left-justified title.
 *
 * NOTE: While this seems like a good application for AccordionBox,
 * I ran into problems related to justifying and i18n.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import merge from '../../../../phet-core/js/merge.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import ExpandCollapseButton from '../../../../sun/js/ExpandCollapseButton.js';
import Panel from '../../../../sun/js/Panel.js';
import unitRates from '../../unitRates.js';

// constants
const BACKGROUND_RECTANGLE_STROKE = phet.chipper.queryParameters.dev ? 'red' : null;
export default class ValuePanel extends Panel {
  /**
   * @param {Node} valueNode
   * @param {Object} [options]
   */
  constructor(valueNode, options) {
    options = merge({
      panelWidth: 100,
      // {number} contents are scaled to fit, height depends on contents
      panelMinHeight: 0,
      // {number} minimum panel height

      // expand/collapse button
      expandedProperty: null,
      // {Property.<boolean>|null} null indicates no expand/collapse button

      // title
      titleString: '',
      // {string} string displayed when the panel is collapsed
      titleFont: new PhetFont(20),
      xSpacing: 8,
      // space between expand/collapse button and title

      // Panel options
      cornerRadius: 4,
      xMargin: 8,
      yMargin: 4
    }, options);
    const contentNode = new Node();
    contentNode.addChild(valueNode);

    // width of panel content
    const contentWidth = options.panelWidth - 2 * options.xMargin;
    const minContentHeight = Math.max(0, options.panelMinHeight - 2 * options.yMargin);

    // invisible rectangle whose size is equivalent to the size of the panel's content, used for right justifying valueNode
    let backgroundNode = null; // assigned below

    let contentHeight = 0; // computed below
    let expandCollapseButton = null;
    let expandedObserver = null;
    if (!options.expandedProperty) {
      // limit valueNode width
      valueNode.maxWidth = contentWidth;
      contentHeight = Math.max(minContentHeight, valueNode.height);
      backgroundNode = new Rectangle(0, 0, contentWidth, contentHeight, {
        stroke: BACKGROUND_RECTANGLE_STROKE
      });
      contentNode.addChild(backgroundNode);
    } else {
      // expand/collapse button, dispose required
      expandCollapseButton = new ExpandCollapseButton(options.expandedProperty, {
        sideLength: 15,
        touchAreaXDilation: 8,
        touchAreaYDilation: 10,
        touchAreaYShift: -4,
        mouseAreaXDilation: 5,
        mouseAreaYDilation: 5
      });
      contentNode.addChild(expandCollapseButton);

      // space to right of button
      const maxExpandedWidth = contentWidth - expandCollapseButton.width - options.xSpacing;

      // title, displayed when collapsed
      const titleNode = new Text(options.titleString, {
        font: options.titleFont,
        maxWidth: maxExpandedWidth
      });
      contentNode.addChild(titleNode);

      // limit valueNode width
      valueNode.maxWidth = maxExpandedWidth;
      contentHeight = Math.max(minContentHeight, _.maxBy([titleNode, valueNode, expandCollapseButton], node => node.height).height);
      backgroundNode = new Rectangle(0, 0, contentWidth, contentHeight, {
        stroke: BACKGROUND_RECTANGLE_STROKE
      });
      contentNode.addChild(backgroundNode);

      // layout
      expandCollapseButton.left = backgroundNode.left;
      expandCollapseButton.centerY = backgroundNode.centerY;
      titleNode.left = expandCollapseButton.right + options.xSpacing;
      titleNode.centerY = backgroundNode.centerY;

      // expand/collapse
      expandedObserver = expanded => {
        valueNode.visible = expanded;
        titleNode.visible = !expanded;
      };
      options.expandedProperty.link(expandedObserver); // unlink in dispose
    }

    backgroundNode.moveToBack();
    valueNode.right = backgroundNode.right;
    valueNode.centerY = backgroundNode.centerY;
    super(contentNode, options);

    // right justify valueNode when its bounds change
    const boundsListener = () => {
      valueNode.right = backgroundNode.right;
      valueNode.centerY = backgroundNode.centerY;
    };
    valueNode.boundsProperty.lazyLink(boundsListener); // off in dispose

    // @private
    this.disposeValuePanel = () => {
      expandCollapseButton && expandCollapseButton.dispose();
      options.expandedProperty && options.expandedProperty.unlink(expandedObserver);
      valueNode.boundsProperty.unlink(boundsListener);
    };
  }

  /**
   * @public
   * @override
   */
  dispose() {
    this.disposeValuePanel();
    super.dispose();
  }
}
unitRates.register('ValuePanel', ValuePanel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtZXJnZSIsIlBoZXRGb250IiwiTm9kZSIsIlJlY3RhbmdsZSIsIlRleHQiLCJFeHBhbmRDb2xsYXBzZUJ1dHRvbiIsIlBhbmVsIiwidW5pdFJhdGVzIiwiQkFDS0dST1VORF9SRUNUQU5HTEVfU1RST0tFIiwicGhldCIsImNoaXBwZXIiLCJxdWVyeVBhcmFtZXRlcnMiLCJkZXYiLCJWYWx1ZVBhbmVsIiwiY29uc3RydWN0b3IiLCJ2YWx1ZU5vZGUiLCJvcHRpb25zIiwicGFuZWxXaWR0aCIsInBhbmVsTWluSGVpZ2h0IiwiZXhwYW5kZWRQcm9wZXJ0eSIsInRpdGxlU3RyaW5nIiwidGl0bGVGb250IiwieFNwYWNpbmciLCJjb3JuZXJSYWRpdXMiLCJ4TWFyZ2luIiwieU1hcmdpbiIsImNvbnRlbnROb2RlIiwiYWRkQ2hpbGQiLCJjb250ZW50V2lkdGgiLCJtaW5Db250ZW50SGVpZ2h0IiwiTWF0aCIsIm1heCIsImJhY2tncm91bmROb2RlIiwiY29udGVudEhlaWdodCIsImV4cGFuZENvbGxhcHNlQnV0dG9uIiwiZXhwYW5kZWRPYnNlcnZlciIsIm1heFdpZHRoIiwiaGVpZ2h0Iiwic3Ryb2tlIiwic2lkZUxlbmd0aCIsInRvdWNoQXJlYVhEaWxhdGlvbiIsInRvdWNoQXJlYVlEaWxhdGlvbiIsInRvdWNoQXJlYVlTaGlmdCIsIm1vdXNlQXJlYVhEaWxhdGlvbiIsIm1vdXNlQXJlYVlEaWxhdGlvbiIsIm1heEV4cGFuZGVkV2lkdGgiLCJ3aWR0aCIsInRpdGxlTm9kZSIsImZvbnQiLCJfIiwibWF4QnkiLCJub2RlIiwibGVmdCIsImNlbnRlclkiLCJyaWdodCIsImV4cGFuZGVkIiwidmlzaWJsZSIsImxpbmsiLCJtb3ZlVG9CYWNrIiwiYm91bmRzTGlzdGVuZXIiLCJib3VuZHNQcm9wZXJ0eSIsImxhenlMaW5rIiwiZGlzcG9zZVZhbHVlUGFuZWwiLCJkaXNwb3NlIiwidW5saW5rIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJWYWx1ZVBhbmVsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE3LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERpc3BsYXlzIGEgdmFsdWUgaW4gYSBwYW5lbCwgd2l0aCBhbiBvcHRpb25hbCBleHBhbmQvY29sbGFwc2UgYnV0dG9uLlxyXG4gKiBXaGVuIGV4cGFuZGVkLCBpdCBkaXNwbGF5cyB0aGUgcmlnaHQtanVzdGlmaWVkIE5vZGUuXHJcbiAqIFdoZW4gY29sbGFwc2VkLCBpdCBkaXNwbGF5cyBhIGxlZnQtanVzdGlmaWVkIHRpdGxlLlxyXG4gKlxyXG4gKiBOT1RFOiBXaGlsZSB0aGlzIHNlZW1zIGxpa2UgYSBnb29kIGFwcGxpY2F0aW9uIGZvciBBY2NvcmRpb25Cb3gsXHJcbiAqIEkgcmFuIGludG8gcHJvYmxlbXMgcmVsYXRlZCB0byBqdXN0aWZ5aW5nIGFuZCBpMThuLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgTm9kZSwgUmVjdGFuZ2xlLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEV4cGFuZENvbGxhcHNlQnV0dG9uIGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9FeHBhbmRDb2xsYXBzZUJ1dHRvbi5qcyc7XHJcbmltcG9ydCBQYW5lbCBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvUGFuZWwuanMnO1xyXG5pbXBvcnQgdW5pdFJhdGVzIGZyb20gJy4uLy4uL3VuaXRSYXRlcy5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgQkFDS0dST1VORF9SRUNUQU5HTEVfU1RST0tFID0gKCBwaGV0LmNoaXBwZXIucXVlcnlQYXJhbWV0ZXJzLmRldiA/ICdyZWQnIDogbnVsbCApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmFsdWVQYW5lbCBleHRlbmRzIFBhbmVsIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtOb2RlfSB2YWx1ZU5vZGVcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHZhbHVlTm9kZSwgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuXHJcbiAgICAgIHBhbmVsV2lkdGg6IDEwMCwgLy8ge251bWJlcn0gY29udGVudHMgYXJlIHNjYWxlZCB0byBmaXQsIGhlaWdodCBkZXBlbmRzIG9uIGNvbnRlbnRzXHJcbiAgICAgIHBhbmVsTWluSGVpZ2h0OiAwLCAvLyB7bnVtYmVyfSBtaW5pbXVtIHBhbmVsIGhlaWdodFxyXG5cclxuICAgICAgLy8gZXhwYW5kL2NvbGxhcHNlIGJ1dHRvblxyXG4gICAgICBleHBhbmRlZFByb3BlcnR5OiBudWxsLCAvLyB7UHJvcGVydHkuPGJvb2xlYW4+fG51bGx9IG51bGwgaW5kaWNhdGVzIG5vIGV4cGFuZC9jb2xsYXBzZSBidXR0b25cclxuXHJcbiAgICAgIC8vIHRpdGxlXHJcbiAgICAgIHRpdGxlU3RyaW5nOiAnJywgLy8ge3N0cmluZ30gc3RyaW5nIGRpc3BsYXllZCB3aGVuIHRoZSBwYW5lbCBpcyBjb2xsYXBzZWRcclxuICAgICAgdGl0bGVGb250OiBuZXcgUGhldEZvbnQoIDIwICksXHJcbiAgICAgIHhTcGFjaW5nOiA4LCAgLy8gc3BhY2UgYmV0d2VlbiBleHBhbmQvY29sbGFwc2UgYnV0dG9uIGFuZCB0aXRsZVxyXG5cclxuICAgICAgLy8gUGFuZWwgb3B0aW9uc1xyXG4gICAgICBjb3JuZXJSYWRpdXM6IDQsXHJcbiAgICAgIHhNYXJnaW46IDgsXHJcbiAgICAgIHlNYXJnaW46IDRcclxuXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgY29uc3QgY29udGVudE5vZGUgPSBuZXcgTm9kZSgpO1xyXG4gICAgY29udGVudE5vZGUuYWRkQ2hpbGQoIHZhbHVlTm9kZSApO1xyXG5cclxuICAgIC8vIHdpZHRoIG9mIHBhbmVsIGNvbnRlbnRcclxuICAgIGNvbnN0IGNvbnRlbnRXaWR0aCA9IG9wdGlvbnMucGFuZWxXaWR0aCAtICggMiAqIG9wdGlvbnMueE1hcmdpbiApO1xyXG4gICAgY29uc3QgbWluQ29udGVudEhlaWdodCA9IE1hdGgubWF4KCAwLCBvcHRpb25zLnBhbmVsTWluSGVpZ2h0IC0gKCAyICogb3B0aW9ucy55TWFyZ2luICkgKTtcclxuXHJcbiAgICAvLyBpbnZpc2libGUgcmVjdGFuZ2xlIHdob3NlIHNpemUgaXMgZXF1aXZhbGVudCB0byB0aGUgc2l6ZSBvZiB0aGUgcGFuZWwncyBjb250ZW50LCB1c2VkIGZvciByaWdodCBqdXN0aWZ5aW5nIHZhbHVlTm9kZVxyXG4gICAgbGV0IGJhY2tncm91bmROb2RlID0gbnVsbDsgLy8gYXNzaWduZWQgYmVsb3dcclxuXHJcbiAgICBsZXQgY29udGVudEhlaWdodCA9IDA7IC8vIGNvbXB1dGVkIGJlbG93XHJcbiAgICBsZXQgZXhwYW5kQ29sbGFwc2VCdXR0b24gPSBudWxsO1xyXG4gICAgbGV0IGV4cGFuZGVkT2JzZXJ2ZXIgPSBudWxsO1xyXG4gICAgaWYgKCAhb3B0aW9ucy5leHBhbmRlZFByb3BlcnR5ICkge1xyXG5cclxuICAgICAgLy8gbGltaXQgdmFsdWVOb2RlIHdpZHRoXHJcbiAgICAgIHZhbHVlTm9kZS5tYXhXaWR0aCA9IGNvbnRlbnRXaWR0aDtcclxuXHJcbiAgICAgIGNvbnRlbnRIZWlnaHQgPSBNYXRoLm1heCggbWluQ29udGVudEhlaWdodCwgdmFsdWVOb2RlLmhlaWdodCApO1xyXG5cclxuICAgICAgYmFja2dyb3VuZE5vZGUgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCBjb250ZW50V2lkdGgsIGNvbnRlbnRIZWlnaHQsIHsgc3Ryb2tlOiBCQUNLR1JPVU5EX1JFQ1RBTkdMRV9TVFJPS0UgfSApO1xyXG4gICAgICBjb250ZW50Tm9kZS5hZGRDaGlsZCggYmFja2dyb3VuZE5vZGUgKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG5cclxuICAgICAgLy8gZXhwYW5kL2NvbGxhcHNlIGJ1dHRvbiwgZGlzcG9zZSByZXF1aXJlZFxyXG4gICAgICBleHBhbmRDb2xsYXBzZUJ1dHRvbiA9IG5ldyBFeHBhbmRDb2xsYXBzZUJ1dHRvbiggb3B0aW9ucy5leHBhbmRlZFByb3BlcnR5LCB7XHJcbiAgICAgICAgc2lkZUxlbmd0aDogMTUsXHJcbiAgICAgICAgdG91Y2hBcmVhWERpbGF0aW9uOiA4LFxyXG4gICAgICAgIHRvdWNoQXJlYVlEaWxhdGlvbjogMTAsXHJcbiAgICAgICAgdG91Y2hBcmVhWVNoaWZ0OiAtNCxcclxuICAgICAgICBtb3VzZUFyZWFYRGlsYXRpb246IDUsXHJcbiAgICAgICAgbW91c2VBcmVhWURpbGF0aW9uOiA1XHJcbiAgICAgIH0gKTtcclxuICAgICAgY29udGVudE5vZGUuYWRkQ2hpbGQoIGV4cGFuZENvbGxhcHNlQnV0dG9uICk7XHJcblxyXG4gICAgICAvLyBzcGFjZSB0byByaWdodCBvZiBidXR0b25cclxuICAgICAgY29uc3QgbWF4RXhwYW5kZWRXaWR0aCA9IGNvbnRlbnRXaWR0aCAtIGV4cGFuZENvbGxhcHNlQnV0dG9uLndpZHRoIC0gb3B0aW9ucy54U3BhY2luZztcclxuXHJcbiAgICAgIC8vIHRpdGxlLCBkaXNwbGF5ZWQgd2hlbiBjb2xsYXBzZWRcclxuICAgICAgY29uc3QgdGl0bGVOb2RlID0gbmV3IFRleHQoIG9wdGlvbnMudGl0bGVTdHJpbmcsIHtcclxuICAgICAgICBmb250OiBvcHRpb25zLnRpdGxlRm9udCxcclxuICAgICAgICBtYXhXaWR0aDogbWF4RXhwYW5kZWRXaWR0aFxyXG4gICAgICB9ICk7XHJcbiAgICAgIGNvbnRlbnROb2RlLmFkZENoaWxkKCB0aXRsZU5vZGUgKTtcclxuXHJcbiAgICAgIC8vIGxpbWl0IHZhbHVlTm9kZSB3aWR0aFxyXG4gICAgICB2YWx1ZU5vZGUubWF4V2lkdGggPSBtYXhFeHBhbmRlZFdpZHRoO1xyXG5cclxuICAgICAgY29udGVudEhlaWdodCA9IE1hdGgubWF4KCBtaW5Db250ZW50SGVpZ2h0LFxyXG4gICAgICAgIF8ubWF4QnkoIFsgdGl0bGVOb2RlLCB2YWx1ZU5vZGUsIGV4cGFuZENvbGxhcHNlQnV0dG9uIF0sIG5vZGUgPT4gbm9kZS5oZWlnaHQgKS5oZWlnaHQgKTtcclxuICAgICAgYmFja2dyb3VuZE5vZGUgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCBjb250ZW50V2lkdGgsIGNvbnRlbnRIZWlnaHQsIHsgc3Ryb2tlOiBCQUNLR1JPVU5EX1JFQ1RBTkdMRV9TVFJPS0UgfSApO1xyXG4gICAgICBjb250ZW50Tm9kZS5hZGRDaGlsZCggYmFja2dyb3VuZE5vZGUgKTtcclxuXHJcbiAgICAgIC8vIGxheW91dFxyXG4gICAgICBleHBhbmRDb2xsYXBzZUJ1dHRvbi5sZWZ0ID0gYmFja2dyb3VuZE5vZGUubGVmdDtcclxuICAgICAgZXhwYW5kQ29sbGFwc2VCdXR0b24uY2VudGVyWSA9IGJhY2tncm91bmROb2RlLmNlbnRlclk7XHJcbiAgICAgIHRpdGxlTm9kZS5sZWZ0ID0gZXhwYW5kQ29sbGFwc2VCdXR0b24ucmlnaHQgKyBvcHRpb25zLnhTcGFjaW5nO1xyXG4gICAgICB0aXRsZU5vZGUuY2VudGVyWSA9IGJhY2tncm91bmROb2RlLmNlbnRlclk7XHJcblxyXG4gICAgICAvLyBleHBhbmQvY29sbGFwc2VcclxuICAgICAgZXhwYW5kZWRPYnNlcnZlciA9IGV4cGFuZGVkID0+IHtcclxuICAgICAgICB2YWx1ZU5vZGUudmlzaWJsZSA9IGV4cGFuZGVkO1xyXG4gICAgICAgIHRpdGxlTm9kZS52aXNpYmxlID0gIWV4cGFuZGVkO1xyXG4gICAgICB9O1xyXG4gICAgICBvcHRpb25zLmV4cGFuZGVkUHJvcGVydHkubGluayggZXhwYW5kZWRPYnNlcnZlciApOyAvLyB1bmxpbmsgaW4gZGlzcG9zZVxyXG4gICAgfVxyXG5cclxuICAgIGJhY2tncm91bmROb2RlLm1vdmVUb0JhY2soKTtcclxuICAgIHZhbHVlTm9kZS5yaWdodCA9IGJhY2tncm91bmROb2RlLnJpZ2h0O1xyXG4gICAgdmFsdWVOb2RlLmNlbnRlclkgPSBiYWNrZ3JvdW5kTm9kZS5jZW50ZXJZO1xyXG5cclxuICAgIHN1cGVyKCBjb250ZW50Tm9kZSwgb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIHJpZ2h0IGp1c3RpZnkgdmFsdWVOb2RlIHdoZW4gaXRzIGJvdW5kcyBjaGFuZ2VcclxuICAgIGNvbnN0IGJvdW5kc0xpc3RlbmVyID0gKCkgPT4ge1xyXG4gICAgICB2YWx1ZU5vZGUucmlnaHQgPSBiYWNrZ3JvdW5kTm9kZS5yaWdodDtcclxuICAgICAgdmFsdWVOb2RlLmNlbnRlclkgPSBiYWNrZ3JvdW5kTm9kZS5jZW50ZXJZO1xyXG4gICAgfTtcclxuICAgIHZhbHVlTm9kZS5ib3VuZHNQcm9wZXJ0eS5sYXp5TGluayggYm91bmRzTGlzdGVuZXIgKTsgLy8gb2ZmIGluIGRpc3Bvc2VcclxuXHJcbiAgICAvLyBAcHJpdmF0ZVxyXG4gICAgdGhpcy5kaXNwb3NlVmFsdWVQYW5lbCA9ICgpID0+IHtcclxuICAgICAgZXhwYW5kQ29sbGFwc2VCdXR0b24gJiYgZXhwYW5kQ29sbGFwc2VCdXR0b24uZGlzcG9zZSgpO1xyXG4gICAgICBvcHRpb25zLmV4cGFuZGVkUHJvcGVydHkgJiYgb3B0aW9ucy5leHBhbmRlZFByb3BlcnR5LnVubGluayggZXhwYW5kZWRPYnNlcnZlciApO1xyXG4gICAgICB2YWx1ZU5vZGUuYm91bmRzUHJvcGVydHkudW5saW5rKCBib3VuZHNMaXN0ZW5lciApO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwdWJsaWNcclxuICAgKiBAb3ZlcnJpZGVcclxuICAgKi9cclxuICBkaXNwb3NlKCkge1xyXG4gICAgdGhpcy5kaXNwb3NlVmFsdWVQYW5lbCgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxudW5pdFJhdGVzLnJlZ2lzdGVyKCAnVmFsdWVQYW5lbCcsIFZhbHVlUGFuZWwgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLEtBQUssTUFBTSxtQ0FBbUM7QUFDckQsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxJQUFJLEVBQUVDLFNBQVMsRUFBRUMsSUFBSSxRQUFRLG1DQUFtQztBQUN6RSxPQUFPQyxvQkFBb0IsTUFBTSw0Q0FBNEM7QUFDN0UsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxTQUFTLE1BQU0sb0JBQW9COztBQUUxQztBQUNBLE1BQU1DLDJCQUEyQixHQUFLQyxJQUFJLENBQUNDLE9BQU8sQ0FBQ0MsZUFBZSxDQUFDQyxHQUFHLEdBQUcsS0FBSyxHQUFHLElBQU07QUFFdkYsZUFBZSxNQUFNQyxVQUFVLFNBQVNQLEtBQUssQ0FBQztFQUU1QztBQUNGO0FBQ0E7QUFDQTtFQUNFUSxXQUFXQSxDQUFFQyxTQUFTLEVBQUVDLE9BQU8sRUFBRztJQUVoQ0EsT0FBTyxHQUFHaEIsS0FBSyxDQUFFO01BRWZpQixVQUFVLEVBQUUsR0FBRztNQUFFO01BQ2pCQyxjQUFjLEVBQUUsQ0FBQztNQUFFOztNQUVuQjtNQUNBQyxnQkFBZ0IsRUFBRSxJQUFJO01BQUU7O01BRXhCO01BQ0FDLFdBQVcsRUFBRSxFQUFFO01BQUU7TUFDakJDLFNBQVMsRUFBRSxJQUFJcEIsUUFBUSxDQUFFLEVBQUcsQ0FBQztNQUM3QnFCLFFBQVEsRUFBRSxDQUFDO01BQUc7O01BRWQ7TUFDQUMsWUFBWSxFQUFFLENBQUM7TUFDZkMsT0FBTyxFQUFFLENBQUM7TUFDVkMsT0FBTyxFQUFFO0lBRVgsQ0FBQyxFQUFFVCxPQUFRLENBQUM7SUFFWixNQUFNVSxXQUFXLEdBQUcsSUFB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