// Copyright 2017-2023, University of Colorado Boulder

/**
 * Accordion box used to modify a rate.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Property from '../../../../axon/js/Property.js';
import Range from '../../../../dot/js/Range.js';
import merge from '../../../../phet-core/js/merge.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Line, Node, Text } from '../../../../scenery/js/imports.js';
import AccordionBox from '../../../../sun/js/AccordionBox.js';
import NumberPicker from '../../../../sun/js/NumberPicker.js';
import unitRates from '../../unitRates.js';
import UnitRatesStrings from '../../UnitRatesStrings.js';
import URConstants from '../URConstants.js';

// If the Rate accordion box appears to change size when switching categories, increase this value. Determined empirically.
const MIN_FRACTION_LINE_LENGTH = 115;
export default class RateAccordionBox extends AccordionBox {
  /**
   * @param {Rate} rate
   * @param {Object} [options]
   */
  constructor(rate, options) {
    options = merge({}, URConstants.ACCORDION_BOX_OPTIONS, {
      // AccordionBox options
      contentXMargin: 20,
      contentYMargin: 24,
      contentYSpacing: 20,
      // RateAccordionBox options
      titleString: UnitRatesStrings.rateStringProperty,
      unitsFont: new PhetFont(16),
      unitsMaxWidth: 60,
      // i18n, determined empirically
      numeratorRange: new Range(0, 10),
      denominatorRange: new Range(0, 10),
      numeratorUnits: '',
      denominatorUnits: '',
      pickerFont: new PhetFont(24),
      numeratorPickerColor: 'black',
      denominatorPickerColor: 'black',
      numeratorPickerIncrementFunction: value => value + 1,
      numeratorPickerDecrementFunction: value => value - 1,
      denominatorPickerIncrementFunction: value => value + 1,
      denominatorPickerDecrementFunction: value => value - 1,
      numeratorDecimals: 0,
      denominatorDecimals: 0,
      xSpacing: 10,
      ySpacing: 8
    }, options);
    assert && assert(options.numeratorRange.contains(rate.numeratorProperty.value), `numerator out of range: ${rate.numeratorProperty.value}`);
    assert && assert(options.denominatorRange.contains(rate.denominatorProperty.value), `denominator out of range: ${rate.denominatorProperty.value}`);
    assert && assert(!options.titleNode, 'creates its own title node');
    options.titleNode = new Text(options.titleString, {
      font: URConstants.ACCORDION_BOX_TITLE_FONT,
      maxWidth: 100 // i18n, determined empirically
    });

    // numerator picker, must be disposed
    const numeratorPicker = new NumberPicker(rate.numeratorProperty, new Property(options.numeratorRange), merge({}, URConstants.NUMBER_PICKER_OPTIONS, {
      incrementFunction: options.numeratorPickerIncrementFunction,
      decrementFunction: options.numeratorPickerDecrementFunction,
      decimalPlaces: options.numeratorDecimals,
      font: options.pickerFont,
      color: options.numeratorPickerColor
    }));

    // numerator units
    const numeratorUnitsNode = new Text(options.numeratorUnits, {
      font: options.unitsFont,
      maxWidth: options.unitsMaxWidth
    });

    // denominator picker, must be disposed
    const denominatorPicker = new NumberPicker(rate.denominatorProperty, new Property(options.denominatorRange), merge({}, URConstants.NUMBER_PICKER_OPTIONS, {
      incrementFunction: options.denominatorPickerIncrementFunction,
      decrementFunction: options.denominatorPickerDecrementFunction,
      decimalPlaces: options.denominatorDecimals,
      font: options.pickerFont,
      color: options.denominatorPickerColor
    }));

    // denominator units
    const denominatorUnitsNode = new Text(options.denominatorUnits, {
      font: options.unitsFont,
      maxWidth: options.unitsMaxWidth
    });
    const contentNode = new Node({
      children: [numeratorPicker, numeratorUnitsNode, denominatorPicker, denominatorUnitsNode]
    });

    // horizontal layout: center justify pickers, left justify labels
    denominatorPicker.centerX = numeratorPicker.centerX;
    numeratorUnitsNode.left = Math.max(numeratorPicker.right, denominatorPicker.right) + options.xSpacing;
    denominatorUnitsNode.left = numeratorUnitsNode.left;

    // fraction line
    const fractionLineLength = Math.max(MIN_FRACTION_LINE_LENGTH, Math.max(numeratorUnitsNode.right - numeratorPicker.left, denominatorUnitsNode.right - denominatorPicker.left));
    const fractionLineNode = new Line(0, 0, fractionLineLength, 0, {
      stroke: 'black',
      lineWidth: 2,
      left: Math.min(numeratorPicker.left, denominatorPicker.left)
    });
    contentNode.addChild(fractionLineNode);

    // vertical layout
    numeratorUnitsNode.centerY = numeratorPicker.centerY;
    fractionLineNode.top = numeratorPicker.bottom + options.ySpacing;
    denominatorPicker.top = fractionLineNode.bottom + options.ySpacing;
    denominatorUnitsNode.centerY = denominatorPicker.centerY;
    super(contentNode, options);

    // @private
    this.disposeRateAccordionBox = () => {
      numeratorPicker.dispose();
      denominatorPicker.dispose();
    };
  }

  /**
   * @public
   * @override
   */
  dispose() {
    this.disposeRateAccordionBox();
    super.dispose();
  }
}
unitRates.register('RateAccordionBox', RateAccordionBox);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIlJhbmdlIiwibWVyZ2UiLCJQaGV0Rm9udCIsIkxpbmUiLCJOb2RlIiwiVGV4dCIsIkFjY29yZGlvbkJveCIsIk51bWJlclBpY2tlciIsInVuaXRSYXRlcyIsIlVuaXRSYXRlc1N0cmluZ3MiLCJVUkNvbnN0YW50cyIsIk1JTl9GUkFDVElPTl9MSU5FX0xFTkdUSCIsIlJhdGVBY2NvcmRpb25Cb3giLCJjb25zdHJ1Y3RvciIsInJhdGUiLCJvcHRpb25zIiwiQUNDT1JESU9OX0JPWF9PUFRJT05TIiwiY29udGVudFhNYXJnaW4iLCJjb250ZW50WU1hcmdpbiIsImNvbnRlbnRZU3BhY2luZyIsInRpdGxlU3RyaW5nIiwicmF0ZVN0cmluZ1Byb3BlcnR5IiwidW5pdHNGb250IiwidW5pdHNNYXhXaWR0aCIsIm51bWVyYXRvclJhbmdlIiwiZGVub21pbmF0b3JSYW5nZSIsIm51bWVyYXRvclVuaXRzIiwiZGVub21pbmF0b3JVbml0cyIsInBpY2tlckZvbnQiLCJudW1lcmF0b3JQaWNrZXJDb2xvciIsImRlbm9taW5hdG9yUGlja2VyQ29sb3IiLCJudW1lcmF0b3JQaWNrZXJJbmNyZW1lbnRGdW5jdGlvbiIsInZhbHVlIiwibnVtZXJhdG9yUGlja2VyRGVjcmVtZW50RnVuY3Rpb24iLCJkZW5vbWluYXRvclBpY2tlckluY3JlbWVudEZ1bmN0aW9uIiwiZGVub21pbmF0b3JQaWNrZXJEZWNyZW1lbnRGdW5jdGlvbiIsIm51bWVyYXRvckRlY2ltYWxzIiwiZGVub21pbmF0b3JEZWNpbWFscyIsInhTcGFjaW5nIiwieVNwYWNpbmciLCJhc3NlcnQiLCJjb250YWlucyIsIm51bWVyYXRvclByb3BlcnR5IiwiZGVub21pbmF0b3JQcm9wZXJ0eSIsInRpdGxlTm9kZSIsImZvbnQiLCJBQ0NPUkRJT05fQk9YX1RJVExFX0ZPTlQiLCJtYXhXaWR0aCIsIm51bWVyYXRvclBpY2tlciIsIk5VTUJFUl9QSUNLRVJfT1BUSU9OUyIsImluY3JlbWVudEZ1bmN0aW9uIiwiZGVjcmVtZW50RnVuY3Rpb24iLCJkZWNpbWFsUGxhY2VzIiwiY29sb3IiLCJudW1lcmF0b3JVbml0c05vZGUiLCJkZW5vbWluYXRvclBpY2tlciIsImRlbm9taW5hdG9yVW5pdHNOb2RlIiwiY29udGVudE5vZGUiLCJjaGlsZHJlbiIsImNlbnRlclgiLCJsZWZ0IiwiTWF0aCIsIm1heCIsInJpZ2h0IiwiZnJhY3Rpb25MaW5lTGVuZ3RoIiwiZnJhY3Rpb25MaW5lTm9kZSIsInN0cm9rZSIsImxpbmVXaWR0aCIsIm1pbiIsImFkZENoaWxkIiwiY2VudGVyWSIsInRvcCIsImJvdHRvbSIsImRpc3Bvc2VSYXRlQWNjb3JkaW9uQm94IiwiZGlzcG9zZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiUmF0ZUFjY29yZGlvbkJveC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBY2NvcmRpb24gYm94IHVzZWQgdG8gbW9kaWZ5IGEgcmF0ZS5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBSYW5nZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2UuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IExpbmUsIE5vZGUsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgQWNjb3JkaW9uQm94IGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9BY2NvcmRpb25Cb3guanMnO1xyXG5pbXBvcnQgTnVtYmVyUGlja2VyIGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9OdW1iZXJQaWNrZXIuanMnO1xyXG5pbXBvcnQgdW5pdFJhdGVzIGZyb20gJy4uLy4uL3VuaXRSYXRlcy5qcyc7XHJcbmltcG9ydCBVbml0UmF0ZXNTdHJpbmdzIGZyb20gJy4uLy4uL1VuaXRSYXRlc1N0cmluZ3MuanMnO1xyXG5pbXBvcnQgVVJDb25zdGFudHMgZnJvbSAnLi4vVVJDb25zdGFudHMuanMnO1xyXG5cclxuLy8gSWYgdGhlIFJhdGUgYWNjb3JkaW9uIGJveCBhcHBlYXJzIHRvIGNoYW5nZSBzaXplIHdoZW4gc3dpdGNoaW5nIGNhdGVnb3JpZXMsIGluY3JlYXNlIHRoaXMgdmFsdWUuIERldGVybWluZWQgZW1waXJpY2FsbHkuXHJcbmNvbnN0IE1JTl9GUkFDVElPTl9MSU5FX0xFTkdUSCA9IDExNTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJhdGVBY2NvcmRpb25Cb3ggZXh0ZW5kcyBBY2NvcmRpb25Cb3gge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge1JhdGV9IHJhdGVcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHJhdGUsIG9wdGlvbnMgKSB7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7fSwgVVJDb25zdGFudHMuQUNDT1JESU9OX0JPWF9PUFRJT05TLCB7XHJcblxyXG4gICAgICAvLyBBY2NvcmRpb25Cb3ggb3B0aW9uc1xyXG4gICAgICBjb250ZW50WE1hcmdpbjogMjAsXHJcbiAgICAgIGNvbnRlbnRZTWFyZ2luOiAyNCxcclxuICAgICAgY29udGVudFlTcGFjaW5nOiAyMCxcclxuXHJcbiAgICAgIC8vIFJhdGVBY2NvcmRpb25Cb3ggb3B0aW9uc1xyXG4gICAgICB0aXRsZVN0cmluZzogVW5pdFJhdGVzU3RyaW5ncy5yYXRlU3RyaW5nUHJvcGVydHksXHJcbiAgICAgIHVuaXRzRm9udDogbmV3IFBoZXRGb250KCAxNiApLFxyXG4gICAgICB1bml0c01heFdpZHRoOiA2MCwgLy8gaTE4biwgZGV0ZXJtaW5lZCBlbXBpcmljYWxseVxyXG4gICAgICBudW1lcmF0b3JSYW5nZTogbmV3IFJhbmdlKCAwLCAxMCApLFxyXG4gICAgICBkZW5vbWluYXRvclJhbmdlOiBuZXcgUmFuZ2UoIDAsIDEwICksXHJcbiAgICAgIG51bWVyYXRvclVuaXRzOiAnJyxcclxuICAgICAgZGVub21pbmF0b3JVbml0czogJycsXHJcbiAgICAgIHBpY2tlckZvbnQ6IG5ldyBQaGV0Rm9udCggMjQgKSxcclxuICAgICAgbnVtZXJhdG9yUGlja2VyQ29sb3I6ICdibGFjaycsXHJcbiAgICAgIGRlbm9taW5hdG9yUGlja2VyQ29sb3I6ICdibGFjaycsXHJcbiAgICAgIG51bWVyYXRvclBpY2tlckluY3JlbWVudEZ1bmN0aW9uOiB2YWx1ZSA9PiB2YWx1ZSArIDEsXHJcbiAgICAgIG51bWVyYXRvclBpY2tlckRlY3JlbWVudEZ1bmN0aW9uOiB2YWx1ZSA9PiB2YWx1ZSAtIDEsXHJcbiAgICAgIGRlbm9taW5hdG9yUGlja2VySW5jcmVtZW50RnVuY3Rpb246IHZhbHVlID0+IHZhbHVlICsgMSxcclxuICAgICAgZGVub21pbmF0b3JQaWNrZXJEZWNyZW1lbnRGdW5jdGlvbjogdmFsdWUgPT4gdmFsdWUgLSAxLFxyXG4gICAgICBudW1lcmF0b3JEZWNpbWFsczogMCxcclxuICAgICAgZGVub21pbmF0b3JEZWNpbWFsczogMCxcclxuICAgICAgeFNwYWNpbmc6IDEwLFxyXG4gICAgICB5U3BhY2luZzogOFxyXG5cclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvcHRpb25zLm51bWVyYXRvclJhbmdlLmNvbnRhaW5zKCByYXRlLm51bWVyYXRvclByb3BlcnR5LnZhbHVlICksXHJcbiAgICAgIGBudW1lcmF0b3Igb3V0IG9mIHJhbmdlOiAke3JhdGUubnVtZXJhdG9yUHJvcGVydHkudmFsdWV9YCApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy5kZW5vbWluYXRvclJhbmdlLmNvbnRhaW5zKCByYXRlLmRlbm9taW5hdG9yUHJvcGVydHkudmFsdWUgKSxcclxuICAgICAgYGRlbm9taW5hdG9yIG91dCBvZiByYW5nZTogJHtyYXRlLmRlbm9taW5hdG9yUHJvcGVydHkudmFsdWV9YCApO1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoICFvcHRpb25zLnRpdGxlTm9kZSwgJ2NyZWF0ZXMgaXRzIG93biB0aXRsZSBub2RlJyApO1xyXG4gICAgb3B0aW9ucy50aXRsZU5vZGUgPSBuZXcgVGV4dCggb3B0aW9ucy50aXRsZVN0cmluZywge1xyXG4gICAgICBmb250OiBVUkNvbnN0YW50cy5BQ0NPUkRJT05fQk9YX1RJVExFX0ZPTlQsXHJcbiAgICAgIG1heFdpZHRoOiAxMDAgIC8vIGkxOG4sIGRldGVybWluZWQgZW1waXJpY2FsbHlcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBudW1lcmF0b3IgcGlja2VyLCBtdXN0IGJlIGRpc3Bvc2VkXHJcbiAgICBjb25zdCBudW1lcmF0b3JQaWNrZXIgPSBuZXcgTnVtYmVyUGlja2VyKCByYXRlLm51bWVyYXRvclByb3BlcnR5LCBuZXcgUHJvcGVydHkoIG9wdGlvbnMubnVtZXJhdG9yUmFuZ2UgKSxcclxuICAgICAgbWVyZ2UoIHt9LCBVUkNvbnN0YW50cy5OVU1CRVJfUElDS0VSX09QVElPTlMsIHtcclxuICAgICAgICBpbmNyZW1lbnRGdW5jdGlvbjogb3B0aW9ucy5udW1lcmF0b3JQaWNrZXJJbmNyZW1lbnRGdW5jdGlvbixcclxuICAgICAgICBkZWNyZW1lbnRGdW5jdGlvbjogb3B0aW9ucy5udW1lcmF0b3JQaWNrZXJEZWNyZW1lbnRGdW5jdGlvbixcclxuICAgICAgICBkZWNpbWFsUGxhY2VzOiBvcHRpb25zLm51bWVyYXRvckRlY2ltYWxzLFxyXG4gICAgICAgIGZvbnQ6IG9wdGlvbnMucGlja2VyRm9udCxcclxuICAgICAgICBjb2xvcjogb3B0aW9ucy5udW1lcmF0b3JQaWNrZXJDb2xvclxyXG4gICAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBudW1lcmF0b3IgdW5pdHNcclxuICAgIGNvbnN0IG51bWVyYXRvclVuaXRzTm9kZSA9IG5ldyBUZXh0KCBvcHRpb25zLm51bWVyYXRvclVuaXRzLCB7XHJcbiAgICAgIGZvbnQ6IG9wdGlvbnMudW5pdHNGb250LFxyXG4gICAgICBtYXhXaWR0aDogb3B0aW9ucy51bml0c01heFdpZHRoXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gZGVub21pbmF0b3IgcGlja2VyLCBtdXN0IGJlIGRpc3Bvc2VkXHJcbiAgICBjb25zdCBkZW5vbWluYXRvclBpY2tlciA9IG5ldyBOdW1iZXJQaWNrZXIoIHJhdGUuZGVub21pbmF0b3JQcm9wZXJ0eSwgbmV3IFByb3BlcnR5KCBvcHRpb25zLmRlbm9taW5hdG9yUmFuZ2UgKSxcclxuICAgICAgbWVyZ2UoIHt9LCBVUkNvbnN0YW50cy5OVU1CRVJfUElDS0VSX09QVElPTlMsIHtcclxuICAgICAgICBpbmNyZW1lbnRGdW5jdGlvbjogb3B0aW9ucy5kZW5vbWluYXRvclBpY2tlckluY3JlbWVudEZ1bmN0aW9uLFxyXG4gICAgICAgIGRlY3JlbWVudEZ1bmN0aW9uOiBvcHRpb25zLmRlbm9taW5hdG9yUGlja2VyRGVjcmVtZW50RnVuY3Rpb24sXHJcbiAgICAgICAgZGVjaW1hbFBsYWNlczogb3B0aW9ucy5kZW5vbWluYXRvckRlY2ltYWxzLFxyXG4gICAgICAgIGZvbnQ6IG9wdGlvbnMucGlja2VyRm9udCxcclxuICAgICAgICBjb2xvcjogb3B0aW9ucy5kZW5vbWluYXRvclBpY2tlckNvbG9yXHJcbiAgICAgIH0gKSApO1xyXG5cclxuICAgIC8vIGRlbm9taW5hdG9yIHVuaXRzXHJcbiAgICBjb25zdCBkZW5vbWluYXRvclVuaXRzTm9kZSA9IG5ldyBUZXh0KCBvcHRpb25zLmRlbm9taW5hdG9yVW5pdHMsIHtcclxuICAgICAgZm9udDogb3B0aW9ucy51bml0c0ZvbnQsXHJcbiAgICAgIG1heFdpZHRoOiBvcHRpb25zLnVuaXRzTWF4V2lkdGhcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBjb250ZW50Tm9kZSA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIG51bWVyYXRvclBpY2tlciwgbnVtZXJhdG9yVW5pdHNOb2RlLCBkZW5vbWluYXRvclBpY2tlciwgZGVub21pbmF0b3JVbml0c05vZGUgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGhvcml6b250YWwgbGF5b3V0OiBjZW50ZXIganVzdGlmeSBwaWNrZXJzLCBsZWZ0IGp1c3RpZnkgbGFiZWxzXHJcbiAgICBkZW5vbWluYXRvclBpY2tlci5jZW50ZXJYID0gbnVtZXJhdG9yUGlja2VyLmNlbnRlclg7XHJcbiAgICBudW1lcmF0b3JVbml0c05vZGUubGVmdCA9IE1hdGgubWF4KCBudW1lcmF0b3JQaWNrZXIucmlnaHQsIGRlbm9taW5hdG9yUGlja2VyLnJpZ2h0ICkgKyBvcHRpb25zLnhTcGFjaW5nO1xyXG4gICAgZGVub21pbmF0b3JVbml0c05vZGUubGVmdCA9IG51bWVyYXRvclVuaXRzTm9kZS5sZWZ0O1xyXG5cclxuICAgIC8vIGZyYWN0aW9uIGxpbmVcclxuICAgIGNvbnN0IGZyYWN0aW9uTGluZUxlbmd0aCA9IE1hdGgubWF4KCBNSU5fRlJBQ1RJT05fTElORV9MRU5HVEgsXHJcbiAgICAgIE1hdGgubWF4KCBudW1lcmF0b3JVbml0c05vZGUucmlnaHQgLSBudW1lcmF0b3JQaWNrZXIubGVmdCwgZGVub21pbmF0b3JVbml0c05vZGUucmlnaHQgLSBkZW5vbWluYXRvclBpY2tlci5sZWZ0ICkgKTtcclxuICAgIGNvbnN0IGZyYWN0aW9uTGluZU5vZGUgPSBuZXcgTGluZSggMCwgMCwgZnJhY3Rpb25MaW5lTGVuZ3RoLCAwLCB7XHJcbiAgICAgIHN0cm9rZTogJ2JsYWNrJyxcclxuICAgICAgbGluZVdpZHRoOiAyLFxyXG4gICAgICBsZWZ0OiBNYXRoLm1pbiggbnVtZXJhdG9yUGlja2VyLmxlZnQsIGRlbm9taW5hdG9yUGlja2VyLmxlZnQgKVxyXG4gICAgfSApO1xyXG4gICAgY29udGVudE5vZGUuYWRkQ2hpbGQoIGZyYWN0aW9uTGluZU5vZGUgKTtcclxuXHJcbiAgICAvLyB2ZXJ0aWNhbCBsYXlvdXRcclxuICAgIG51bWVyYXRvclVuaXRzTm9kZS5jZW50ZXJZID0gbnVtZXJhdG9yUGlja2VyLmNlbnRlclk7XHJcbiAgICBmcmFjdGlvbkxpbmVOb2RlLnRvcCA9IG51bWVyYXRvclBpY2tlci5ib3R0b20gKyBvcHRpb25zLnlTcGFjaW5nO1xyXG4gICAgZGVub21pbmF0b3JQaWNrZXIudG9wID0gZnJhY3Rpb25MaW5lTm9kZS5ib3R0b20gKyBvcHRpb25zLnlTcGFjaW5nO1xyXG4gICAgZGVub21pbmF0b3JVbml0c05vZGUuY2VudGVyWSA9IGRlbm9taW5hdG9yUGlja2VyLmNlbnRlclk7XHJcblxyXG4gICAgc3VwZXIoIGNvbnRlbnROb2RlLCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGVcclxuICAgIHRoaXMuZGlzcG9zZVJhdGVBY2NvcmRpb25Cb3ggPSAoKSA9PiB7XHJcbiAgICAgIG51bWVyYXRvclBpY2tlci5kaXNwb3NlKCk7XHJcbiAgICAgIGRlbm9taW5hdG9yUGlja2VyLmRpc3Bvc2UoKTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHVibGljXHJcbiAgICogQG92ZXJyaWRlXHJcbiAgICovXHJcbiAgZGlzcG9zZSgpIHtcclxuICAgIHRoaXMuZGlzcG9zZVJhdGVBY2NvcmRpb25Cb3goKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbnVuaXRSYXRlcy5yZWdpc3RlciggJ1JhdGVBY2NvcmRpb25Cb3gnLCBSYXRlQWNjb3JkaW9uQm94ICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9B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