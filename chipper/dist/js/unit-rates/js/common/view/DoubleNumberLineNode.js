// Copyright 2016-2023, University of Colorado Boulder

/**
 * Displays a double number line.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Dimension2 from '../../../../dot/js/Dimension2.js';
import merge from '../../../../phet-core/js/merge.js';
import ArrowNode from '../../../../scenery-phet/js/ArrowNode.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { HStrut, Line, Node, Text } from '../../../../scenery/js/imports.js';
import unitRates from '../../unitRates.js';
import URConstants from '../URConstants.js';
import MarkerNode from './MarkerNode.js';
export default class DoubleNumberLineNode extends Node {
  /**
   * @param {DoubleNumberLine} doubleNumberLine
   * @param {Object} [options]
   */
  constructor(doubleNumberLine, options) {
    options = merge({
      // common to all axes (horizontal and vertical)
      axisColor: 'black',
      axisLineWidth: 1.5,
      // horizontal axes
      axisViewLength: 1000,
      // {number} view length of doubleNumberLine's range
      arrowSize: new Dimension2(8, 8),
      // size of arrows on axes
      axisYSpacing: 20,
      // {number} vertical spacing between top and bottom axes
      labelFont: new PhetFont(14),
      // {Font} for axis labels
      labelColor: 'black',
      // {Color|string} color of axis labels
      labelMaxWidth: 70,
      // i18n, determined empirically
      labelXSpacing: 12,
      // horizontal spacing between axis and its label

      // markers
      majorMarkerLength: URConstants.MAJOR_MARKER_LENGTH,
      minorMarkerLength: URConstants.MINOR_MARKER_LENGTH,
      // Optional position indicator (vertical line).
      // Used in the Racing Lab screen to indicate the current position of the race car.
      indicatorXProperty: null,
      // {Property.<number>|null} position of vertical indicator line, in model coordinates
      indicatorColor: 'green'
    }, options);
    super();

    // @public (read-only)
    this.axisViewLength = options.axisViewLength;

    // All other nodes are positioned relative to this one
    const verticalAxis = new Line(0, -options.minorMarkerLength / 2, 0, options.minorMarkerLength / 2, {
      stroke: options.axisColor,
      lineWidth: options.axisLineWidth
    });
    this.addChild(verticalAxis);

    // Double number line's maximum should be just to the left of the axis' arrow head
    const horizontalAxisLength = this.axisViewLength + options.arrowSize.height + 10;

    // numerator axis
    const numeratorAxisNode = new ArrowNode(0, 0, horizontalAxisLength, 0, {
      fill: options.axisColor,
      stroke: null,
      headWidth: options.arrowSize.width,
      headHeight: options.arrowSize.height,
      tailWidth: options.axisLineWidth,
      x: verticalAxis.x,
      y: verticalAxis.centerY - options.axisYSpacing / 2
    });
    this.addChild(numeratorAxisNode);

    // numerator axis label
    this.addChild(new Text(doubleNumberLine.numeratorOptions.axisLabel, {
      font: options.labelFont,
      fill: options.labelColor,
      maxWidth: options.labelMaxWidth,
      left: numeratorAxisNode.right + options.labelXSpacing,
      centerY: numeratorAxisNode.centerY,
      children: [new HStrut(options.labelMaxWidth)] // makes labels for all items the same width
    }));

    // denominator axis
    const denominatorAxisNode = new ArrowNode(0, 0, horizontalAxisLength, 0, {
      fill: options.axisColor,
      stroke: null,
      headWidth: options.arrowSize.width,
      headHeight: options.arrowSize.height,
      tailWidth: options.axisLineWidth,
      y: verticalAxis.centerY + options.axisYSpacing / 2
    });
    this.addChild(denominatorAxisNode);

    // denominator axis label
    this.addChild(new Text(doubleNumberLine.denominatorOptions.axisLabel, {
      font: options.labelFont,
      fill: options.labelColor,
      maxWidth: options.labelMaxWidth,
      left: denominatorAxisNode.right + options.labelXSpacing,
      centerY: denominatorAxisNode.centerY,
      children: [new HStrut(options.labelMaxWidth)] // makes labels for all items the same width
    }));

    // position indicator (vertical line)
    let indicatorXObserver = null;
    if (options.indicatorXProperty) {
      const indicatorNode = new Line(0, 0, 0, options.axisYSpacing, {
        stroke: options.indicatorColor,
        lineWidth: 4,
        // horizontal position set by indicatorXObserver
        centerY: verticalAxis.centerY
      });
      this.addChild(indicatorNode);
      indicatorXObserver = x => {
        indicatorNode.centerX = doubleNumberLine.modelToViewNumerator(x, this.axisViewLength);
      };
      options.indicatorXProperty.link(indicatorXObserver); // unlink in dispose
    }

    // @private parent for markers, to maintain rendering order
    this.markersParent = new Node();
    this.addChild(this.markersParent);
    this.mutate(options);

    // @public (read-only) position for things that are "out of range", halfway between arrows and labels
    this.outOfRangeXOffset = horizontalAxisLength + options.labelXSpacing / 2;

    // when a Marker is added, add a MarkerNode
    const markerAddedListener = marker => {
      // The model may contain markers that don't fit on the view scale
      if (doubleNumberLine.markerIsInRange(marker)) {
        this.addMarkerNode(marker, {
          lineLength: marker.isMajor ? options.majorMarkerLength : options.minorMarkerLength,
          numeratorOptions: doubleNumberLine.numeratorOptions,
          denominatorOptions: doubleNumberLine.denominatorOptions,
          centerX: doubleNumberLine.modelToViewDenominator(marker.denominatorProperty.value, this.axisViewLength),
          centerY: verticalAxis.centerY
        });
      }
    };
    doubleNumberLine.markers.addItemAddedListener(markerAddedListener);

    // when a Marker is removed, remove the corresponding MarkerNode
    const markerRemovedListener = marker => {
      this.removeMarkerNode(marker);
    };
    doubleNumberLine.markers.addItemRemovedListener(markerRemovedListener);

    // Add a MarkNode for each initial Marker
    doubleNumberLine.markers.forEach(markerAddedListener.bind(this));

    // @private
    this.disposeDoubleNumberLineNode = () => {
      doubleNumberLine.markers.removeItemAddedListener(markerAddedListener);
      doubleNumberLine.markers.removeItemRemovedListener(markerRemovedListener);
      options.indicatorXProperty && options.indicatorXProperty.unlink(indicatorXObserver);
    };
  }

  /**
   * @public
   * @override
   */
  dispose() {
    this.disposeDoubleNumberLineNode();
    super.dispose();
  }

  /**
   * Adds a MarkerNode to the double number line.
   * @param {Marker} marker
   * @param {Object} [options] - MarkerNode constructor options
   * @private
   */
  addMarkerNode(marker, options) {
    unitRates.log && unitRates.log(`addMarker ${marker}`);
    assert && assert(!this.getMarkerNode(marker), `already have a MarkerNode for ${marker}`);
    const markerNode = new MarkerNode(marker, options);
    this.markersParent.addChild(markerNode);
  }

  /**
   * Removes a MarkerNode from the double number line.
   * @param {Marker} marker
   * @private
   */
  removeMarkerNode(marker) {
    unitRates.log && unitRates.log(`removeMarker ${marker}`);

    // find the node that is associated with the marker
    const markerNode = this.getMarkerNode(marker);

    // the model may contain markers that aren't displayed, because they are outside the range of the view axes
    if (markerNode) {
      this.markersParent.removeChild(markerNode);
      markerNode.dispose();
    }
  }

  /**
   * Gets the MarkerNode that is associated with marker.
   * @param {Marker} marker
   * @returns {MarkerNode|null} - null if there is no MarkerNode associated with marker
   * @private
   */
  getMarkerNode(marker) {
    let markerNode = null;
    const markerNodes = this.markersParent.getChildren();
    for (let i = 0; i < markerNodes.length && !markerNode; i++) {
      if (markerNodes[i].marker === marker) {
        markerNode = markerNodes[i];
      }
    }
    return markerNode;
  }
}
unitRates.register('DoubleNumberLineNode', DoubleNumberLineNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEaW1lbnNpb24yIiwibWVyZ2UiLCJBcnJvd05vZGUiLCJQaGV0Rm9udCIsIkhTdHJ1dCIsIkxpbmUiLCJOb2RlIiwiVGV4dCIsInVuaXRSYXRlcyIsIlVSQ29uc3RhbnRzIiwiTWFya2VyTm9kZSIsIkRvdWJsZU51bWJlckxpbmVOb2RlIiwiY29uc3RydWN0b3IiLCJkb3VibGVOdW1iZXJMaW5lIiwib3B0aW9ucyIsImF4aXNDb2xvciIsImF4aXNMaW5lV2lkdGgiLCJheGlzVmlld0xlbmd0aCIsImFycm93U2l6ZSIsImF4aXNZU3BhY2luZyIsImxhYmVsRm9udCIsImxhYmVsQ29sb3IiLCJsYWJlbE1heFdpZHRoIiwibGFiZWxYU3BhY2luZyIsIm1ham9yTWFya2VyTGVuZ3RoIiwiTUFKT1JfTUFSS0VSX0xFTkdUSCIsIm1pbm9yTWFya2VyTGVuZ3RoIiwiTUlOT1JfTUFSS0VSX0xFTkdUSCIsImluZGljYXRvclhQcm9wZXJ0eSIsImluZGljYXRvckNvbG9yIiwidmVydGljYWxBeGlzIiwic3Ryb2tlIiwibGluZVdpZHRoIiwiYWRkQ2hpbGQiLCJob3Jpem9udGFsQXhpc0xlbmd0aCIsImhlaWdodCIsIm51bWVyYXRvckF4aXNOb2RlIiwiZmlsbCIsImhlYWRXaWR0aCIsIndpZHRoIiwiaGVhZEhlaWdodCIsInRhaWxXaWR0aCIsIngiLCJ5IiwiY2VudGVyWSIsIm51bWVyYXRvck9wdGlvbnMiLCJheGlzTGFiZWwiLCJmb250IiwibWF4V2lkdGgiLCJsZWZ0IiwicmlnaHQiLCJjaGlsZHJlbiIsImRlbm9taW5hdG9yQXhpc05vZGUiLCJkZW5vbWluYXRvck9wdGlvbnMiLCJpbmRpY2F0b3JYT2JzZXJ2ZXIiLCJpbmRpY2F0b3JOb2RlIiwiY2VudGVyWCIsIm1vZGVsVG9WaWV3TnVtZXJhdG9yIiwibGluayIsIm1hcmtlcnNQYXJlbnQiLCJtdXRhdGUiLCJvdXRPZlJhbmdlWE9mZnNldCIsIm1hcmtlckFkZGVkTGlzdGVuZXIiLCJtYXJrZXIiLCJtYXJrZXJJc0luUmFuZ2UiLCJhZGRNYXJrZXJOb2RlIiwibGluZUxlbmd0aCIsImlzTWFqb3IiLCJtb2RlbFRvVmlld0Rlbm9taW5hdG9yIiwiZGVub21pbmF0b3JQcm9wZXJ0eSIsInZhbHVlIiwibWFya2VycyIsImFkZEl0ZW1BZGRlZExpc3RlbmVyIiwibWFya2VyUmVtb3ZlZExpc3RlbmVyIiwicmVtb3ZlTWFya2VyTm9kZSIsImFkZEl0ZW1SZW1vdmVkTGlzdGVuZXIiLCJmb3JFYWNoIiwiYmluZCIsImRpc3Bvc2VEb3VibGVOdW1iZXJMaW5lTm9kZSIsInJlbW92ZUl0ZW1BZGRlZExpc3RlbmVyIiwicmVtb3ZlSXRlbVJlbW92ZWRMaXN0ZW5lciIsInVubGluayIsImRpc3Bvc2UiLCJsb2ciLCJhc3NlcnQiLCJnZXRNYXJrZXJOb2RlIiwibWFya2VyTm9kZSIsInJlbW92ZUNoaWxkIiwibWFya2VyTm9kZXMiLCJnZXRDaGlsZHJlbiIsImkiLCJsZW5ndGgiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkRvdWJsZU51bWJlckxpbmVOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE2LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERpc3BsYXlzIGEgZG91YmxlIG51bWJlciBsaW5lLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEaW1lbnNpb24yIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9EaW1lbnNpb24yLmpzJztcclxuaW1wb3J0IG1lcmdlIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9tZXJnZS5qcyc7XHJcbmltcG9ydCBBcnJvd05vZGUgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL0Fycm93Tm9kZS5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBIU3RydXQsIExpbmUsIE5vZGUsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgdW5pdFJhdGVzIGZyb20gJy4uLy4uL3VuaXRSYXRlcy5qcyc7XHJcbmltcG9ydCBVUkNvbnN0YW50cyBmcm9tICcuLi9VUkNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBNYXJrZXJOb2RlIGZyb20gJy4vTWFya2VyTm9kZS5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEb3VibGVOdW1iZXJMaW5lTm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge0RvdWJsZU51bWJlckxpbmV9IGRvdWJsZU51bWJlckxpbmVcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIGRvdWJsZU51bWJlckxpbmUsIG9wdGlvbnMgKSB7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcblxyXG4gICAgICAvLyBjb21tb24gdG8gYWxsIGF4ZXMgKGhvcml6b250YWwgYW5kIHZlcnRpY2FsKVxyXG4gICAgICBheGlzQ29sb3I6ICdibGFjaycsXHJcbiAgICAgIGF4aXNMaW5lV2lkdGg6IDEuNSxcclxuXHJcbiAgICAgIC8vIGhvcml6b250YWwgYXhlc1xyXG4gICAgICBheGlzVmlld0xlbmd0aDogMTAwMCwgLy8ge251bWJlcn0gdmlldyBsZW5ndGggb2YgZG91YmxlTnVtYmVyTGluZSdzIHJhbmdlXHJcbiAgICAgIGFycm93U2l6ZTogbmV3IERpbWVuc2lvbjIoIDgsIDggKSwgLy8gc2l6ZSBvZiBhcnJvd3Mgb24gYXhlc1xyXG4gICAgICBheGlzWVNwYWNpbmc6IDIwLCAvLyB7bnVtYmVyfSB2ZXJ0aWNhbCBzcGFjaW5nIGJldHdlZW4gdG9wIGFuZCBib3R0b20gYXhlc1xyXG4gICAgICBsYWJlbEZvbnQ6IG5ldyBQaGV0Rm9udCggMTQgKSwgLy8ge0ZvbnR9IGZvciBheGlzIGxhYmVsc1xyXG4gICAgICBsYWJlbENvbG9yOiAnYmxhY2snLCAvLyB7Q29sb3J8c3RyaW5nfSBjb2xvciBvZiBheGlzIGxhYmVsc1xyXG4gICAgICBsYWJlbE1heFdpZHRoOiA3MCwgLy8gaTE4biwgZGV0ZXJtaW5lZCBlbXBpcmljYWxseVxyXG4gICAgICBsYWJlbFhTcGFjaW5nOiAxMiwgLy8gaG9yaXpvbnRhbCBzcGFjaW5nIGJldHdlZW4gYXhpcyBhbmQgaXRzIGxhYmVsXHJcblxyXG4gICAgICAvLyBtYXJrZXJzXHJcbiAgICAgIG1ham9yTWFya2VyTGVuZ3RoOiBVUkNvbnN0YW50cy5NQUpPUl9NQVJLRVJfTEVOR1RILFxyXG4gICAgICBtaW5vck1hcmtlckxlbmd0aDogVVJDb25zdGFudHMuTUlOT1JfTUFSS0VSX0xFTkdUSCxcclxuXHJcbiAgICAgIC8vIE9wdGlvbmFsIHBvc2l0aW9uIGluZGljYXRvciAodmVydGljYWwgbGluZSkuXHJcbiAgICAgIC8vIFVzZWQgaW4gdGhlIFJhY2luZyBMYWIgc2NyZWVuIHRvIGluZGljYXRlIHRoZSBjdXJyZW50IHBvc2l0aW9uIG9mIHRoZSByYWNlIGNhci5cclxuICAgICAgaW5kaWNhdG9yWFByb3BlcnR5OiBudWxsLCAvLyB7UHJvcGVydHkuPG51bWJlcj58bnVsbH0gcG9zaXRpb24gb2YgdmVydGljYWwgaW5kaWNhdG9yIGxpbmUsIGluIG1vZGVsIGNvb3JkaW5hdGVzXHJcbiAgICAgIGluZGljYXRvckNvbG9yOiAnZ3JlZW4nXHJcblxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyAocmVhZC1vbmx5KVxyXG4gICAgdGhpcy5heGlzVmlld0xlbmd0aCA9IG9wdGlvbnMuYXhpc1ZpZXdMZW5ndGg7XHJcblxyXG4gICAgLy8gQWxsIG90aGVyIG5vZGVzIGFyZSBwb3NpdGlvbmVkIHJlbGF0aXZlIHRvIHRoaXMgb25lXHJcbiAgICBjb25zdCB2ZXJ0aWNhbEF4aXMgPSBuZXcgTGluZSggMCwgLW9wdGlvbnMubWlub3JNYXJrZXJMZW5ndGggLyAyLCAwLCBvcHRpb25zLm1pbm9yTWFya2VyTGVuZ3RoIC8gMiwge1xyXG4gICAgICBzdHJva2U6IG9wdGlvbnMuYXhpc0NvbG9yLFxyXG4gICAgICBsaW5lV2lkdGg6IG9wdGlvbnMuYXhpc0xpbmVXaWR0aFxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdmVydGljYWxBeGlzICk7XHJcblxyXG4gICAgLy8gRG91YmxlIG51bWJlciBsaW5lJ3MgbWF4aW11bSBzaG91bGQgYmUganVzdCB0byB0aGUgbGVmdCBvZiB0aGUgYXhpcycgYXJyb3cgaGVhZFxyXG4gICAgY29uc3QgaG9yaXpvbnRhbEF4aXNMZW5ndGggPSB0aGlzLmF4aXNWaWV3TGVuZ3RoICsgb3B0aW9ucy5hcnJvd1NpemUuaGVpZ2h0ICsgMTA7XHJcblxyXG4gICAgLy8gbnVtZXJhdG9yIGF4aXNcclxuICAgIGNvbnN0IG51bWVyYXRvckF4aXNOb2RlID0gbmV3IEFycm93Tm9kZSggMCwgMCwgaG9yaXpvbnRhbEF4aXNMZW5ndGgsIDAsIHtcclxuICAgICAgZmlsbDogb3B0aW9ucy5heGlzQ29sb3IsXHJcbiAgICAgIHN0cm9rZTogbnVsbCxcclxuICAgICAgaGVhZFdpZHRoOiBvcHRpb25zLmFycm93U2l6ZS53aWR0aCxcclxuICAgICAgaGVhZEhlaWdodDogb3B0aW9ucy5hcnJvd1NpemUuaGVpZ2h0LFxyXG4gICAgICB0YWlsV2lkdGg6IG9wdGlvbnMuYXhpc0xpbmVXaWR0aCxcclxuICAgICAgeDogdmVydGljYWxBeGlzLngsXHJcbiAgICAgIHk6IHZlcnRpY2FsQXhpcy5jZW50ZXJZIC0gKCBvcHRpb25zLmF4aXNZU3BhY2luZyAvIDIgKVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggbnVtZXJhdG9yQXhpc05vZGUgKTtcclxuXHJcbiAgICAvLyBudW1lcmF0b3IgYXhpcyBsYWJlbFxyXG4gICAgdGhpcy5hZGRDaGlsZCggbmV3IFRleHQoIGRvdWJsZU51bWJlckxpbmUubnVtZXJhdG9yT3B0aW9ucy5heGlzTGFiZWwsIHtcclxuICAgICAgZm9udDogb3B0aW9ucy5sYWJlbEZvbnQsXHJcbiAgICAgIGZpbGw6IG9wdGlvbnMubGFiZWxDb2xvcixcclxuICAgICAgbWF4V2lkdGg6IG9wdGlvbnMubGFiZWxNYXhXaWR0aCxcclxuICAgICAgbGVmdDogbnVtZXJhdG9yQXhpc05vZGUucmlnaHQgKyBvcHRpb25zLmxhYmVsWFNwYWNpbmcsXHJcbiAgICAgIGNlbnRlclk6IG51bWVyYXRvckF4aXNOb2RlLmNlbnRlclksXHJcbiAgICAgIGNoaWxkcmVuOiBbIG5ldyBIU3RydXQoIG9wdGlvbnMubGFiZWxNYXhXaWR0aCApIF0gLy8gbWFrZXMgbGFiZWxzIGZvciBhbGwgaXRlbXMgdGhlIHNhbWUgd2lkdGhcclxuICAgIH0gKSApO1xyXG5cclxuICAgIC8vIGRlbm9taW5hdG9yIGF4aXNcclxuICAgIGNvbnN0IGRlbm9taW5hdG9yQXhpc05vZGUgPSBuZXcgQXJyb3dOb2RlKCAwLCAwLCBob3Jpem9udGFsQXhpc0xlbmd0aCwgMCwge1xyXG4gICAgICBmaWxsOiBvcHRpb25zLmF4aXNDb2xvcixcclxuICAgICAgc3Ryb2tlOiBudWxsLFxyXG4gICAgICBoZWFkV2lkdGg6IG9wdGlvbnMuYXJyb3dTaXplLndpZHRoLFxyXG4gICAgICBoZWFkSGVpZ2h0OiBvcHRpb25zLmFycm93U2l6ZS5oZWlnaHQsXHJcbiAgICAgIHRhaWxXaWR0aDogb3B0aW9ucy5heGlzTGluZVdpZHRoLFxyXG4gICAgICB5OiB2ZXJ0aWNhbEF4aXMuY2VudGVyWSArICggb3B0aW9ucy5heGlzWVNwYWNpbmcgLyAyIClcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGRlbm9taW5hdG9yQXhpc05vZGUgKTtcclxuXHJcbiAgICAvLyBkZW5vbWluYXRvciBheGlzIGxhYmVsXHJcbiAgICB0aGlzLmFkZENoaWxkKCBuZXcgVGV4dCggZG91YmxlTnVtYmVyTGluZS5kZW5vbWluYXRvck9wdGlvbnMuYXhpc0xhYmVsLCB7XHJcbiAgICAgIGZvbnQ6IG9wdGlvbnMubGFiZWxGb250LFxyXG4gICAgICBmaWxsOiBvcHRpb25zLmxhYmVsQ29sb3IsXHJcbiAgICAgIG1heFdpZHRoOiBvcHRpb25zLmxhYmVsTWF4V2lkdGgsXHJcbiAgICAgIGxlZnQ6IGRlbm9taW5hdG9yQXhpc05vZGUucmlnaHQgKyBvcHRpb25zLmxhYmVsWFNwYWNpbmcsXHJcbiAgICAgIGNlbnRlclk6IGRlbm9taW5hdG9yQXhpc05vZGUuY2VudGVyWSxcclxuICAgICAgY2hpbGRyZW46IFsgbmV3IEhTdHJ1dCggb3B0aW9ucy5sYWJlbE1heFdpZHRoICkgXSAvLyBtYWtlcyBsYWJlbHMgZm9yIGFsbCBpdGVtcyB0aGUgc2FtZSB3aWR0aFxyXG4gICAgfSApICk7XHJcblxyXG4gICAgLy8gcG9zaXRpb24gaW5kaWNhdG9yICh2ZXJ0aWNhbCBsaW5lKVxyXG4gICAgbGV0IGluZGljYXRvclhPYnNlcnZlciA9IG51bGw7XHJcbiAgICBpZiAoIG9wdGlvbnMuaW5kaWNhdG9yWFByb3BlcnR5ICkge1xyXG4gICAgICBjb25zdCBpbmRpY2F0b3JOb2RlID0gbmV3IExpbmUoIDAsIDAsIDAsIG9wdGlvbnMuYXhpc1lTcGFjaW5nLCB7XHJcbiAgICAgICAgc3Ryb2tlOiBvcHRpb25zLmluZGljYXRvckNvbG9yLFxyXG4gICAgICAgIGxpbmVXaWR0aDogNCxcclxuICAgICAgICAvLyBob3Jpem9udGFsIHBvc2l0aW9uIHNldCBieSBpbmRpY2F0b3JYT2JzZXJ2ZXJcclxuICAgICAgICBjZW50ZXJZOiB2ZXJ0aWNhbEF4aXMuY2VudGVyWVxyXG4gICAgICB9ICk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIGluZGljYXRvck5vZGUgKTtcclxuXHJcbiAgICAgIGluZGljYXRvclhPYnNlcnZlciA9IHggPT4ge1xyXG4gICAgICAgIGluZGljYXRvck5vZGUuY2VudGVyWCA9IGRvdWJsZU51bWJlckxpbmUubW9kZWxUb1ZpZXdOdW1lcmF0b3IoIHgsIHRoaXMuYXhpc1ZpZXdMZW5ndGggKTtcclxuICAgICAgfTtcclxuICAgICAgb3B0aW9ucy5pbmRpY2F0b3JYUHJvcGVydHkubGluayggaW5kaWNhdG9yWE9ic2VydmVyICk7IC8vIHVubGluayBpbiBkaXNwb3NlXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQHByaXZhdGUgcGFyZW50IGZvciBtYXJrZXJzLCB0byBtYWludGFpbiByZW5kZXJpbmcgb3JkZXJcclxuICAgIHRoaXMubWFya2Vyc1BhcmVudCA9IG5ldyBOb2RlKCk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLm1hcmtlcnNQYXJlbnQgKTtcclxuXHJcbiAgICB0aGlzLm11dGF0ZSggb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMgKHJlYWQtb25seSkgcG9zaXRpb24gZm9yIHRoaW5ncyB0aGF0IGFyZSBcIm91dCBvZiByYW5nZVwiLCBoYWxmd2F5IGJldHdlZW4gYXJyb3dzIGFuZCBsYWJlbHNcclxuICAgIHRoaXMub3V0T2ZSYW5nZVhPZmZzZXQgPSBob3Jpem9udGFsQXhpc0xlbmd0aCArICggb3B0aW9ucy5sYWJlbFhTcGFjaW5nIC8gMiApO1xyXG5cclxuICAgIC8vIHdoZW4gYSBNYXJrZXIgaXMgYWRkZWQsIGFkZCBhIE1hcmtlck5vZGVcclxuICAgIGNvbnN0IG1hcmtlckFkZGVkTGlzdGVuZXIgPSBtYXJrZXIgPT4ge1xyXG5cclxuICAgICAgLy8gVGhlIG1vZGVsIG1heSBjb250YWluIG1hcmtlcnMgdGhhdCBkb24ndCBmaXQgb24gdGhlIHZpZXcgc2NhbGVcclxuICAgICAgaWYgKCBkb3VibGVOdW1iZXJMaW5lLm1hcmtlcklzSW5SYW5nZSggbWFya2VyICkgKSB7XHJcbiAgICAgICAgdGhpcy5hZGRNYXJrZXJOb2RlKCBtYXJrZXIsIHtcclxuICAgICAgICAgIGxpbmVMZW5ndGg6IG1hcmtlci5pc01ham9yID8gb3B0aW9ucy5tYWpvck1hcmtlckxlbmd0aCA6IG9wdGlvbnMubWlub3JNYXJrZXJMZW5ndGgsXHJcbiAgICAgICAgICBudW1lcmF0b3JPcHRpb25zOiBkb3VibGVOdW1iZXJMaW5lLm51bWVyYXRvck9wdGlvbnMsXHJcbiAgICAgICAgICBkZW5vbWluYXRvck9wdGlvbnM6IGRvdWJsZU51bWJlckxpbmUuZGVub21pbmF0b3JPcHRpb25zLFxyXG4gICAgICAgICAgY2VudGVyWDogZG91YmxlTnVtYmVyTGluZS5tb2RlbFRvVmlld0Rlbm9taW5hdG9yKCBtYXJrZXIuZGVub21pbmF0b3JQcm9wZXJ0eS52YWx1ZSwgdGhpcy5heGlzVmlld0xlbmd0aCApLFxyXG4gICAgICAgICAgY2VudGVyWTogdmVydGljYWxBeGlzLmNlbnRlcllcclxuICAgICAgICB9ICk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICBkb3VibGVOdW1iZXJMaW5lLm1hcmtlcnMuYWRkSXRlbUFkZGVkTGlzdGVuZXIoIG1hcmtlckFkZGVkTGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyB3aGVuIGEgTWFya2VyIGlzIHJlbW92ZWQsIHJlbW92ZSB0aGUgY29ycmVzcG9uZGluZyBNYXJrZXJOb2RlXHJcbiAgICBjb25zdCBtYXJrZXJSZW1vdmVkTGlzdGVuZXIgPSBtYXJrZXIgPT4ge1xyXG4gICAgICB0aGlzLnJlbW92ZU1hcmtlck5vZGUoIG1hcmtlciApO1xyXG4gICAgfTtcclxuICAgIGRvdWJsZU51bWJlckxpbmUubWFya2Vycy5hZGRJdGVtUmVtb3ZlZExpc3RlbmVyKCBtYXJrZXJSZW1vdmVkTGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyBBZGQgYSBNYXJrTm9kZSBmb3IgZWFjaCBpbml0aWFsIE1hcmtlclxyXG4gICAgZG91YmxlTnVtYmVyTGluZS5tYXJrZXJzLmZvckVhY2goIG1hcmtlckFkZGVkTGlzdGVuZXIuYmluZCggdGhpcyApICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGVcclxuICAgIHRoaXMuZGlzcG9zZURvdWJsZU51bWJlckxpbmVOb2RlID0gKCkgPT4ge1xyXG4gICAgICBkb3VibGVOdW1iZXJMaW5lLm1hcmtlcnMucmVtb3ZlSXRlbUFkZGVkTGlzdGVuZXIoIG1hcmtlckFkZGVkTGlzdGVuZXIgKTtcclxuICAgICAgZG91YmxlTnVtYmVyTGluZS5tYXJrZXJzLnJlbW92ZUl0ZW1SZW1vdmVkTGlzdGVuZXIoIG1hcmtlclJlbW92ZWRMaXN0ZW5lciApO1xyXG4gICAgICBvcHRpb25zLmluZGljYXRvclhQcm9wZXJ0eSAmJiBvcHRpb25zLmluZGljYXRvclhQcm9wZXJ0eS51bmxpbmsoIGluZGljYXRvclhPYnNlcnZlciApO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwdWJsaWNcclxuICAgKiBAb3ZlcnJpZGVcclxuICAgKi9cclxuICBkaXNwb3NlKCkge1xyXG4gICAgdGhpcy5kaXNwb3NlRG91YmxlTnVtYmVyTGluZU5vZGUoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgYSBNYXJrZXJOb2RlIHRvIHRoZSBkb3VibGUgbnVtYmVyIGxpbmUuXHJcbiAgICogQHBhcmFtIHtNYXJrZXJ9IG1hcmtlclxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gLSBNYXJrZXJOb2RlIGNvbnN0cnVjdG9yIG9wdGlvbnNcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIGFkZE1hcmtlck5vZGUoIG1hcmtlciwgb3B0aW9ucyApIHtcclxuICAgIHVuaXRSYXRlcy5sb2cgJiYgdW5pdFJhdGVzLmxvZyggYGFkZE1hcmtlciAke21hcmtlcn1gICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCAhdGhpcy5nZXRNYXJrZXJOb2RlKCBtYXJrZXIgKSwgYGFscmVhZHkgaGF2ZSBhIE1hcmtlck5vZGUgZm9yICR7bWFya2VyfWAgKTtcclxuICAgIGNvbnN0IG1hcmtlck5vZGUgPSBuZXcgTWFya2VyTm9kZSggbWFya2VyLCBvcHRpb25zICk7XHJcbiAgICB0aGlzLm1hcmtlcnNQYXJlbnQuYWRkQ2hpbGQoIG1hcmtlck5vZGUgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbW92ZXMgYSBNYXJrZXJOb2RlIGZyb20gdGhlIGRvdWJsZSBudW1iZXIgbGluZS5cclxuICAgKiBAcGFyYW0ge01hcmtlcn0gbWFya2VyXHJcbiAgICogQHByaXZhdGVcclxuICAgKi9cclxuICByZW1vdmVNYXJrZXJOb2RlKCBtYXJrZXIgKSB7XHJcbiAgICB1bml0UmF0ZXMubG9nICYmIHVuaXRSYXRlcy5sb2coIGByZW1vdmVNYXJrZXIgJHttYXJrZXJ9YCApO1xyXG5cclxuICAgIC8vIGZpbmQgdGhlIG5vZGUgdGhhdCBpcyBhc3NvY2lhdGVkIHdpdGggdGhlIG1hcmtlclxyXG4gICAgY29uc3QgbWFya2VyTm9kZSA9IHRoaXMuZ2V0TWFya2VyTm9kZSggbWFya2VyICk7XHJcblxyXG4gICAgLy8gdGhlIG1vZGVsIG1heSBjb250YWluIG1hcmtlcnMgdGhhdCBhcmVuJ3QgZGlzcGxheWVkLCBiZWNhdXNlIHRoZXkgYXJlIG91dHNpZGUgdGhlIHJhbmdlIG9mIHRoZSB2aWV3IGF4ZXNcclxuICAgIGlmICggbWFya2VyTm9kZSApIHtcclxuICAgICAgdGhpcy5tYXJrZXJzUGFyZW50LnJlbW92ZUNoaWxkKCBtYXJrZXJOb2RlICk7XHJcbiAgICAgIG1hcmtlck5vZGUuZGlzcG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyB0aGUgTWFya2VyTm9kZSB0aGF0IGlzIGFzc29jaWF0ZWQgd2l0aCBtYXJrZXIuXHJcbiAgICogQHBhcmFtIHtNYXJrZXJ9IG1hcmtlclxyXG4gICAqIEByZXR1cm5zIHtNYXJrZXJOb2RlfG51bGx9IC0gbnVsbCBpZiB0aGVyZSBpcyBubyBNYXJrZXJOb2RlIGFzc29jaWF0ZWQgd2l0aCBtYXJrZXJcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIGdldE1hcmtlck5vZGUoIG1hcmtlciApIHtcclxuICAgIGxldCBtYXJrZXJOb2RlID0gbnVsbDtcclxuICAgIGNvbnN0IG1hcmtlck5vZGVzID0gdGhpcy5tYXJrZXJzUGFyZW50LmdldENoaWxkcmVuKCk7XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBtYXJrZXJOb2Rlcy5sZW5ndGggJiYgIW1hcmtlck5vZGU7IGkrKyApIHtcclxuICAgICAgaWYgKCBtYXJrZXJOb2Rlc1sgaSBdLm1hcmtlciA9PT0gbWFya2VyICkge1xyXG4gICAgICAgIG1hcmtlck5vZGUgPSBtYXJrZXJOb2Rlc1sgaSBdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWFya2VyTm9kZTtcclxuICB9XHJcbn1cclxuXHJcbnVuaXRSYXRlcy5yZWdpc3RlciggJ0RvdWJsZU51bWJlckxpbmVOb2RlJywgRG91YmxlTnVtYmVyTGluZU5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsVUFBVSxNQUFNLGtDQUFrQztBQUN6RCxPQUFPQyxLQUFLLE1BQU0sbUNBQW1DO0FBQ3JELE9BQU9DLFNBQVMsTUFBTSwwQ0FBMEM7QUFDaEUsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxNQUFNLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQzVFLE9BQU9DLFNBQVMsTUFBTSxvQkFBb0I7QUFDMUMsT0FBT0MsV0FBVyxNQUFNLG1CQUFtQjtBQUMzQyxPQUFPQyxVQUFVLE1BQU0saUJBQWlCO0FBRXhDLGVBQWUsTUFBTUMsb0JBQW9CLFNBQVNMLElBQUksQ0FBQztFQUVyRDtBQUNGO0FBQ0E7QUFDQTtFQUNFTSxXQUFXQSxDQUFFQyxnQkFBZ0IsRUFBRUMsT0FBTyxFQUFHO0lBRXZDQSxPQUFPLEdBQUdiLEtBQUssQ0FBRTtNQUVmO01BQ0FjLFNBQVMsRUFBRSxPQUFPO01BQ2xCQyxhQUFhLEVBQUUsR0FBRztNQUVsQjtNQUNB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