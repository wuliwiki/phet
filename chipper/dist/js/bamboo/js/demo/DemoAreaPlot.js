// Copyright 2023, University of Colorado Boulder

/**
 * Demonstrates AreaPlot.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import AreaPlot from '../AreaPlot.js';
import NumberProperty from '../../../axon/js/NumberProperty.js';
import Range from '../../../dot/js/Range.js';
import Utils from '../../../dot/js/Utils.js';
import Vector2 from '../../../dot/js/Vector2.js';
import Orientation from '../../../phet-core/js/Orientation.js';
import PlusMinusZoomButtonGroup from '../../../scenery-phet/js/PlusMinusZoomButtonGroup.js';
import { Node, Text } from '../../../scenery/js/imports.js';
import AxisArrowNode from '../AxisArrowNode.js';
import bamboo from '../bamboo.js';
import ChartRectangle from '../ChartRectangle.js';
import ChartTransform from '../ChartTransform.js';
import GridLineSet from '../GridLineSet.js';
import TickLabelSet from '../TickLabelSet.js';
import TickMarkSet from '../TickMarkSet.js';
import optionize from '../../../phet-core/js/optionize.js';
import VSlider from '../../../sun/js/VSlider.js';
import Dimension2 from '../../../dot/js/Dimension2.js';
import PhetFont from '../../../scenery-phet/js/PhetFont.js';
const MAX_X_RANGE = new Range(-5, 5);
const MAX_Y_RANGE = new Range(-5, 5);
const GRID_X_SPACING = 1;
const GRID_Y_SPACING = 1;
export default class DemoAreaPlot extends Node {
  constructor(providedOptions) {
    const options = optionize()({
      // We're setting options.children below
    }, providedOptions);
    const chartTransform = new ChartTransform({
      viewWidth: 700,
      viewHeight: 300,
      modelXRange: MAX_X_RANGE,
      modelYRange: MAX_Y_RANGE
    });
    const chartRectangle = new ChartRectangle(chartTransform, {
      fill: 'white',
      stroke: 'black'
    });
    const xZoomLevelProperty = new NumberProperty(1, {
      numberType: 'Integer',
      range: new Range(1, chartTransform.modelXRange.max)
    });

    // The value of xZoomLevelProperty is used as the x-axis range.
    xZoomLevelProperty.link(zoomLevel => chartTransform.setModelXRange(new Range(-zoomLevel, zoomLevel)));
    const xZoomButtonGroup = new PlusMinusZoomButtonGroup(xZoomLevelProperty, {
      orientation: 'horizontal',
      right: chartRectangle.right,
      top: chartRectangle.bottom + 25
    });
    const gridLineSetOptions = {
      stroke: 'lightGray'
    };
    const tickMarkSetOptions = {
      edge: 'min'
    };
    const tickLabelSetOptions = {
      edge: 'min',
      createLabel: value => new Text(Utils.toFixed(value, 0), {
        fontSize: 12
      })
    };
    const areaPlot = new AreaPlot(chartTransform, createSineDataSet(MAX_X_RANGE, 1, MAX_Y_RANGE.max), {
      fill: 'rgba( 255, 0, 0, 0.7 )'
    });
    const chartNode = new Node({
      children: [
      // Background
      chartRectangle,
      // Clipped contents - anything you want clipped goes in here.
      new Node({
        clipArea: chartRectangle.getShape(),
        children: [
        // Minor grid lines
        new GridLineSet(chartTransform, Orientation.HORIZONTAL, GRID_Y_SPACING, gridLineSetOptions), new GridLineSet(chartTransform, Orientation.VERTICAL, GRID_X_SPACING, gridLineSetOptions),
        // Axes nodes are clipped in the chart
        new AxisArrowNode(chartTransform, Orientation.HORIZONTAL), new AxisArrowNode(chartTransform, Orientation.VERTICAL),
        // AreaPlot
        areaPlot]
      }),
      // x-axis label
      new Text('x', {
        leftCenter: chartRectangle.rightCenter.plusXY(4, 0),
        fontSize: 18
      }),
      // x-axis ticks and labels
      new TickMarkSet(chartTransform, Orientation.HORIZONTAL, 1, tickMarkSetOptions), new TickLabelSet(chartTransform, Orientation.HORIZONTAL, 1, tickLabelSetOptions),
      // y-axis ticks and labels
      new TickMarkSet(chartTransform, Orientation.VERTICAL, 1, tickMarkSetOptions), new TickLabelSet(chartTransform, Orientation.VERTICAL, 1, tickLabelSetOptions), xZoomButtonGroup]
    });
    const baselineRange = new Range(MAX_Y_RANGE.min, MAX_Y_RANGE.max);
    const baselineProperty = new NumberProperty(0, {
      range: baselineRange
    });
    const baselineSlider = new VSlider(baselineProperty, baselineProperty.range, {
      // Snap to integer when thumb is released.
      endDrag: () => {
        baselineProperty.value = Utils.toFixedNumber(baselineProperty.value, 0);
      },
      trackSize: new Dimension2(5, chartRectangle.height),
      majorTickStroke: 'gray',
      left: chartNode.right + 20,
      top: chartNode.top
    });
    for (let i = baselineRange.min; i <= baselineRange.max; i++) {
      baselineSlider.addMajorTick(i);
    }
    const baselineText = new Text('', {
      font: new PhetFont(14),
      left: baselineSlider.left,
      bottom: baselineSlider.top - 6
    });
    baselineProperty.link(baseline => {
      areaPlot.setBaseline(baseline);
      baselineText.string = `baseline = ${Utils.toFixedNumber(baseline, 2)}`;
    });
    options.children = [chartNode, baselineSlider, baselineText];
    super(options);
  }
}

/**
 * Creates the data set for a sine wave.
 */
const createSineDataSet = (xRange, period, amplitude, delta = 0.01) => {
  const dataSet = [];
  const frequency = 2 * Math.PI / period;
  for (let x = xRange.min; x <= xRange.max; x += delta) {
    dataSet.push(new Vector2(x, amplitude * Math.sin(x * frequency)));
  }
  return dataSet;
};
bamboo.register('DemoAreaPlot', DemoAreaPlot);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcmVhUGxvdCIsIk51bWJlclByb3BlcnR5IiwiUmFuZ2UiLCJVdGlscyIsIlZlY3RvcjIiLCJPcmllbnRhdGlvbiIsIlBsdXNNaW51c1pvb21CdXR0b25Hcm91cCIsIk5vZGUiLCJUZXh0IiwiQXhpc0Fycm93Tm9kZSIsImJhbWJvbyIsIkNoYXJ0UmVjdGFuZ2xlIiwiQ2hhcnRUcmFuc2Zvcm0iLCJHcmlkTGluZVNldCIsIlRpY2tMYWJlbFNldCIsIlRpY2tNYXJrU2V0Iiwib3B0aW9uaXplIiwiVlNsaWRlciIsIkRpbWVuc2lvbjIiLCJQaGV0Rm9udCIsIk1BWF9YX1JBTkdFIiwiTUFYX1lfUkFOR0UiLCJHUklEX1hfU1BBQ0lORyIsIkdSSURfWV9TUEFDSU5HIiwiRGVtb0FyZWFQbG90IiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwiY2hhcnRUcmFuc2Zvcm0iLCJ2aWV3V2lkdGgiLCJ2aWV3SGVpZ2h0IiwibW9kZWxYUmFuZ2UiLCJtb2RlbFlSYW5nZSIsImNoYXJ0UmVjdGFuZ2xlIiwiZmlsbCIsInN0cm9rZSIsInhab29tTGV2ZWxQcm9wZXJ0eSIsIm51bWJlclR5cGUiLCJyYW5nZSIsIm1heCIsImxpbmsiLCJ6b29tTGV2ZWwiLCJzZXRNb2RlbFhSYW5nZSIsInhab29tQnV0dG9uR3JvdXAiLCJvcmllbnRhdGlvbiIsInJpZ2h0IiwidG9wIiwiYm90dG9tIiwiZ3JpZExpbmVTZXRPcHRpb25zIiwidGlja01hcmtTZXRPcHRpb25zIiwiZWRnZSIsInRpY2tMYWJlbFNldE9wdGlvbnMiLCJjcmVhdGVMYWJlbCIsInZhbHVlIiwidG9GaXhlZCIsImZvbnRTaXplIiwiYXJlYVBsb3QiLCJjcmVhdGVTaW5lRGF0YVNldCIsImNoYXJ0Tm9kZSIsImNoaWxkcmVuIiwiY2xpcEFyZWEiLCJnZXRTaGFwZSIsIkhPUklaT05UQUwiLCJWRVJUSUNBTCIsImxlZnRDZW50ZXIiLCJyaWdodENlbnRlciIsInBsdXNYWSIsImJhc2VsaW5lUmFuZ2UiLCJtaW4iLCJiYXNlbGluZVByb3BlcnR5IiwiYmFzZWxpbmVTbGlkZXIiLCJlbmREcmFnIiwidG9GaXhlZE51bWJlciIsInRyYWNrU2l6ZSIsImhlaWdodCIsIm1ham9yVGlja1N0cm9rZSIsImxlZnQiLCJpIiwiYWRkTWFqb3JUaWNrIiwiYmFzZWxpbmVUZXh0IiwiZm9udCIsImJhc2VsaW5lIiwic2V0QmFzZWxpbmUiLCJzdHJpbmciLCJ4UmFuZ2UiLCJwZXJpb2QiLCJhbXBsaXR1ZGUiLCJkZWx0YSIsImRhdGFTZXQiLCJmcmVxdWVuY3kiLCJNYXRoIiwiUEkiLCJ4IiwicHVzaCIsInNpbiIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRGVtb0FyZWFQbG90LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBEZW1vbnN0cmF0ZXMgQXJlYVBsb3QuXHJcbiAqXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IEFyZWFQbG90IGZyb20gJy4uL0FyZWFQbG90LmpzJztcclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IE9yaWVudGF0aW9uIGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy9PcmllbnRhdGlvbi5qcyc7XHJcbmltcG9ydCBQbHVzTWludXNab29tQnV0dG9uR3JvdXAgZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BsdXNNaW51c1pvb21CdXR0b25Hcm91cC5qcyc7XHJcbmltcG9ydCB7IEhCb3hPcHRpb25zLCBOb2RlLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEF4aXNBcnJvd05vZGUgZnJvbSAnLi4vQXhpc0Fycm93Tm9kZS5qcyc7XHJcbmltcG9ydCBiYW1ib28gZnJvbSAnLi4vYmFtYm9vLmpzJztcclxuaW1wb3J0IENoYXJ0UmVjdGFuZ2xlIGZyb20gJy4uL0NoYXJ0UmVjdGFuZ2xlLmpzJztcclxuaW1wb3J0IENoYXJ0VHJhbnNmb3JtIGZyb20gJy4uL0NoYXJ0VHJhbnNmb3JtLmpzJztcclxuaW1wb3J0IEdyaWRMaW5lU2V0LCB7IEdyaWRMaW5lU2V0T3B0aW9ucyB9IGZyb20gJy4uL0dyaWRMaW5lU2V0LmpzJztcclxuaW1wb3J0IFRpY2tMYWJlbFNldCwgeyBUaWNrTGFiZWxTZXRPcHRpb25zIH0gZnJvbSAnLi4vVGlja0xhYmVsU2V0LmpzJztcclxuaW1wb3J0IFRpY2tNYXJrU2V0LCB7IFRpY2tNYXJrU2V0T3B0aW9ucyB9IGZyb20gJy4uL1RpY2tNYXJrU2V0LmpzJztcclxuaW1wb3J0IFN0cmljdE9taXQgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1N0cmljdE9taXQuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFZTbGlkZXIgZnJvbSAnLi4vLi4vLi4vc3VuL2pzL1ZTbGlkZXIuanMnO1xyXG5pbXBvcnQgRGltZW5zaW9uMiBmcm9tICcuLi8uLi8uLi9kb3QvanMvRGltZW5zaW9uMi5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5cclxuY29uc3QgTUFYX1hfUkFOR0UgPSBuZXcgUmFuZ2UoIC01LCA1ICk7XHJcbmNvbnN0IE1BWF9ZX1JBTkdFID0gbmV3IFJhbmdlKCAtNSwgNSApO1xyXG5jb25zdCBHUklEX1hfU1BBQ0lORyA9IDE7XHJcbmNvbnN0IEdSSURfWV9TUEFDSU5HID0gMTtcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBFbXB0eVNlbGZPcHRpb25zO1xyXG5cclxudHlwZSBEZW1vQXJlYVBsb3RPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBTdHJpY3RPbWl0PEhCb3hPcHRpb25zLCAnY2hpbGRyZW4nPjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERlbW9BcmVhUGxvdCBleHRlbmRzIE5vZGUge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3ZpZGVkT3B0aW9ucz86IERlbW9BcmVhUGxvdE9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxEZW1vQXJlYVBsb3RPcHRpb25zLCBTZWxmT3B0aW9ucywgSEJveE9wdGlvbnM+KCkoIHtcclxuICAgICAgLy8gV2UncmUgc2V0dGluZyBvcHRpb25zLmNoaWxkcmVuIGJlbG93XHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCBjaGFydFRyYW5zZm9ybSA9IG5ldyBDaGFydFRyYW5zZm9ybSgge1xyXG4gICAgICB2aWV3V2lkdGg6IDcwMCxcclxuICAgICAgdmlld0hlaWdodDogMzAwLFxyXG4gICAgICBtb2RlbFhSYW5nZTogTUFYX1hfUkFOR0UsXHJcbiAgICAgIG1vZGVsWVJhbmdlOiBNQVhfWV9SQU5HRVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGNoYXJ0UmVjdGFuZ2xlID0gbmV3IENoYXJ0UmVjdGFuZ2xlKCBjaGFydFRyYW5zZm9ybSwge1xyXG4gICAgICBmaWxsOiAnd2hpdGUnLFxyXG4gICAgICBzdHJva2U6ICdibGFjaydcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCB4Wm9vbUxldmVsUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIDEsIHtcclxuICAgICAgbnVtYmVyVHlwZTogJ0ludGVnZXInLFxyXG4gICAgICByYW5nZTogbmV3IFJhbmdlKCAxLCBjaGFydFRyYW5zZm9ybS5tb2RlbFhSYW5nZS5tYXggKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFRoZSB2YWx1ZSBvZiB4Wm9vbUxldmVsUHJvcGVydHkgaXMgdXNlZCBhcyB0aGUgeC1heGlzIHJhbmdlLlxyXG4gICAgeFpvb21MZXZlbFByb3BlcnR5LmxpbmsoIHpvb21MZXZlbCA9PiBjaGFydFRyYW5zZm9ybS5zZXRNb2RlbFhSYW5nZSggbmV3IFJhbmdlKCAtem9vbUxldmVsLCB6b29tTGV2ZWwgKSApICk7XHJcblxyXG4gICAgY29uc3QgeFpvb21CdXR0b25Hcm91cCA9IG5ldyBQbHVzTWludXNab29tQnV0dG9uR3JvdXAoIHhab29tTGV2ZWxQcm9wZXJ0eSwge1xyXG4gICAgICBvcmllbnRhdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICByaWdodDogY2hhcnRSZWN0YW5nbGUucmlnaHQsXHJcbiAgICAgIHRvcDogY2hhcnRSZWN0YW5nbGUuYm90dG9tICsgMjVcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBncmlkTGluZVNldE9wdGlvbnM6IEdyaWRMaW5lU2V0T3B0aW9ucyA9IHtcclxuICAgICAgc3Ryb2tlOiAnbGlnaHRHcmF5J1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCB0aWNrTWFya1NldE9wdGlvbnM6IFRpY2tNYXJrU2V0T3B0aW9ucyA9IHtcclxuICAgICAgZWRnZTogJ21pbidcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgdGlja0xhYmVsU2V0T3B0aW9uczogVGlja0xhYmVsU2V0T3B0aW9ucyA9IHtcclxuICAgICAgZWRnZTogJ21pbicsXHJcbiAgICAgIGNyZWF0ZUxhYmVsOiAoIHZhbHVlOiBudW1iZXIgKSA9PiBuZXcgVGV4dCggVXRpbHMudG9GaXhlZCggdmFsdWUsIDAgKSwge1xyXG4gICAgICAgIGZvbnRTaXplOiAxMlxyXG4gICAgICB9IClcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgYXJlYVBsb3QgPSBuZXcgQXJlYVBsb3QoIGNoYXJ0VHJhbnNmb3JtLCBjcmVhdGVTaW5lRGF0YVNldCggTUFYX1hfUkFOR0UsIDEsIE1BWF9ZX1JBTkdFLm1heCApLCB7XHJcbiAgICAgIGZpbGw6ICdyZ2JhKCAyNTUsIDAsIDAsIDAuNyApJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGNoYXJ0Tm9kZSA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcblxyXG4gICAgICAgIC8vIEJhY2tncm91bmRcclxuICAgICAgICBjaGFydFJlY3RhbmdsZSxcclxuXHJcbiAgICAgICAgLy8gQ2xpcHBlZCBjb250ZW50cyAtIGFueXRoaW5nIHlvdSB3YW50IGNsaXBwZWQgZ29lcyBpbiBoZXJlLlxyXG4gICAgICAgIG5ldyBOb2RlKCB7XHJcbiAgICAgICAgICBjbGlwQXJlYTogY2hhcnRSZWN0YW5nbGUuZ2V0U2hhcGUoKSxcclxuICAgICAgICAgIGNoaWxkcmVuOiBbXHJcblxyXG4gICAgICAgICAgICAvLyBNaW5vciBncmlkIGxpbmVzXHJcbiAgICAgICAgICAgIG5ldyBHcmlkTGluZVNldCggY2hhcnRUcmFuc2Zvcm0sIE9yaWVudGF0aW9uLkhPUklaT05UQUwsIEdSSURfWV9TUEFDSU5HLCBncmlkTGluZVNldE9wdGlvbnMgKSxcclxuICAgICAgICAgICAgbmV3IEdyaWRMaW5lU2V0KCBjaGFydFRyYW5zZm9ybSwgT3JpZW50YXRpb24uVkVSVElDQUwsIEdSSURfWF9TUEFDSU5HLCBncmlkTGluZVNldE9wdGlvbnMgKSxcclxuXHJcbiAgICAgICAgICAgIC8vIEF4ZXMgbm9kZXMgYXJlIGNsaXBwZWQgaW4gdGhlIGNoYXJ0XHJcbiAgICAgICAgICAgIG5ldyBBeGlzQXJyb3dOb2RlKCBjaGFydFRyYW5zZm9ybSwgT3JpZW50YXRpb24uSE9SSVpPTlRBTCApLFxyXG4gICAgICAgICAgICBuZXcgQXhpc0Fycm93Tm9kZSggY2hhcnRUcmFuc2Zvcm0sIE9yaWVudGF0aW9uLlZFUlRJQ0FMICksXHJcblxyXG4gICAgICAgICAgICAvLyBBcmVhUGxvdFxyXG4gICAgICAgICAgICBhcmVhUGxvdFxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH0gKSxcclxuXHJcbiAgICAgICAgLy8geC1heGlzIGxhYmVsXHJcbiAgICAgICAgbmV3IFRleHQoICd4Jywge1xyXG4gICAgICAgICAgbGVmdENlbnRlcjogY2hhcnRSZWN0YW5nbGUucmlnaHRDZW50ZXIucGx1c1hZKCA0LCAwICksXHJcbiAgICAgICAgICBmb250U2l6ZTogMThcclxuICAgICAgICB9ICksXHJcblxyXG4gICAgICAgIC8vIHgtYXhpcyB0aWNrcyBhbmQgbGFiZWxzXHJcbiAgICAgICAgbmV3IFRpY2tNYXJrU2V0KCBjaGFydFRyYW5zZm9ybSwgT3JpZW50YXRpb24uSE9SSVpPTlRBTCwgMSwgdGlja01hcmtTZXRPcHRpb25zICksXHJcbiAgICAgICAgbmV3IFRpY2tMYWJlbFNldCggY2hhcnRUcmFuc2Zvcm0sIE9yaWVudGF0aW9uLkhPUklaT05UQUwsIDEsIHRpY2tMYWJlbFNldE9wdGlvbnMgKSxcclxuXHJcbiAgICAgICAgLy8geS1heGlzIHRpY2tzIGFuZCBsYWJlbHNcclxuICAgICAgICBuZXcgVGlja01hcmtTZXQoIGNoYXJ0VHJhbnNmb3JtLCBPcmllbnRhdGlvbi5WRVJUSUNBTCwgMSwgdGlja01hcmtTZXRPcHRpb25zICksXHJcbiAgICAgICAgbmV3IFRpY2tMYWJlbFNldCggY2hhcnRUcmFuc2Zvcm0sIE9yaWVudGF0aW9uLlZFUlRJQ0FMLCAxLCB0aWNrTGFiZWxTZXRPcHRpb25zICksXHJcblxyXG4gICAgICAgIHhab29tQnV0dG9uR3JvdXBcclxuICAgICAgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGJhc2VsaW5lUmFuZ2UgPSBuZXcgUmFuZ2UoIE1BWF9ZX1JBTkdFLm1pbiwgTUFYX1lfUkFOR0UubWF4ICk7XHJcbiAgICBjb25zdCBiYXNlbGluZVByb3BlcnR5ID0gbmV3IE51bWJlclByb3BlcnR5KCAwLCB7XHJcbiAgICAgIHJhbmdlOiBiYXNlbGluZVJhbmdlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgYmFzZWxpbmVTbGlkZXIgPSBuZXcgVlNsaWRlciggYmFzZWxpbmVQcm9wZXJ0eSwgYmFzZWxpbmVQcm9wZXJ0eS5yYW5nZSwge1xyXG5cclxuICAgICAgLy8gU25hcCB0byBpbnRlZ2VyIHdoZW4gdGh1bWIgaXMgcmVsZWFzZWQuXHJcbiAgICAgIGVuZERyYWc6ICgpID0+IHtcclxuICAgICAgICBiYXNlbGluZVByb3BlcnR5LnZhbHVlID0gVXRpbHMudG9GaXhlZE51bWJlciggYmFzZWxpbmVQcm9wZXJ0eS52YWx1ZSwgMCApO1xyXG4gICAgICB9LFxyXG4gICAgICB0cmFja1NpemU6IG5ldyBEaW1lbnNpb24yKCA1LCBjaGFydFJlY3RhbmdsZS5oZWlnaHQgKSxcclxuICAgICAgbWFqb3JUaWNrU3Ryb2tlOiAnZ3JheScsXHJcbiAgICAgIGxlZnQ6IGNoYXJ0Tm9kZS5yaWdodCArIDIwLFxyXG4gICAgICB0b3A6IGNoYXJ0Tm9kZS50b3BcclxuICAgIH0gKTtcclxuICAgIGZvciAoIGxldCBpID0gYmFzZWxpbmVSYW5nZS5taW47IGkgPD0gYmFzZWxpbmVSYW5nZS5tYXg7IGkrKyApIHtcclxuICAgICAgYmFzZWxpbmVTbGlkZXIuYWRkTWFqb3JUaWNrKCBpICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYmFzZWxpbmVUZXh0ID0gbmV3IFRleHQoICcnLCB7XHJcbiAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggMTQgKSxcclxuICAgICAgbGVmdDogYmFzZWxpbmVTbGlkZXIubGVmdCxcclxuICAgICAgYm90dG9tOiBiYXNlbGluZVNsaWRlci50b3AgLSA2XHJcbiAgICB9ICk7XHJcblxyXG4gICAgYmFzZWxpbmVQcm9wZXJ0eS5saW5rKCBiYXNlbGluZSA9PiB7XHJcbiAgICAgIGFyZWFQbG90LnNldEJhc2VsaW5lKCBiYXNlbGluZSApO1xyXG4gICAgICBiYXNlbGluZVRleHQuc3RyaW5nID0gYGJhc2VsaW5lID0gJHtVdGlscy50b0ZpeGVkTnVtYmVyKCBiYXNlbGluZSwgMiApfWA7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgb3B0aW9ucy5jaGlsZHJlbiA9IFsgY2hhcnROb2RlLCBiYXNlbGluZVNsaWRlciwgYmFzZWxpbmVUZXh0IF07XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIHRoZSBkYXRhIHNldCBmb3IgYSBzaW5lIHdhdmUuXHJcbiAqL1xyXG5jb25zdCBjcmVhdGVTaW5lRGF0YVNldCA9ICggeFJhbmdlOiBSYW5nZSwgcGVyaW9kOiBudW1iZXIsIGFtcGxpdHVkZTogbnVtYmVyLCBkZWx0YSA9IDAuMDEgKSA9PiB7XHJcbiAgY29uc3QgZGF0YVNldCA9IFtdO1xyXG4gIGNvbnN0IGZyZXF1ZW5jeSA9IDIgKiBNYXRoLlBJIC8gcGVyaW9kO1xyXG4gIGZvciAoIGxldCB4ID0geFJhbmdlLm1pbjsgeCA8PSB4UmFuZ2UubWF4OyB4ICs9IGRlbHRhICkge1xyXG4gICAgZGF0YVNldC5wdXNoKCBuZXcgVmVjdG9yMiggeCwgYW1wbGl0dWRlICogTWF0aC5zaW4oIHggKiBmcmVxdWVuY3kgKSApICk7XHJcbiAgfVxyXG4gIHJldHVybiBkYXRhU2V0O1xyXG59O1xyXG5cclxuYmFtYm9vLnJlZ2lzdGVyKCAnRGVtb0FyZWFQbG90JywgRGVtb0FyZWFQbG90ICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFFBQVEsTUFBTSxnQkFBZ0I7QUFDckMsT0FBT0MsY0FBYyxNQUFNLG9DQUFvQztBQUMvRCxPQUFPQyxLQUFLLE1BQU0sMEJBQTBCO0FBQzVDLE9BQU9DLEtBQUssTUFBTSwwQkFBMEI7QUFDNUMsT0FBT0MsT0FBTyxNQUFNLDRCQUE0QjtBQUNo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