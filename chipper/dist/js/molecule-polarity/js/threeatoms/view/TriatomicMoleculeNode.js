// Copyright 2014-2022, University of Colorado Boulder

/**
 * Visual representation of a triatomic molecule.
 * Children position themselves in global coordinates, so this node's position should be (0,0).
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Multilink from '../../../../axon/js/Multilink.js';
import optionize from '../../../../phet-core/js/optionize.js';
import ArrowNode from '../../../../scenery-phet/js/ArrowNode.js';
import { Node } from '../../../../scenery/js/imports.js';
import MPQueryParameters from '../../common/MPQueryParameters.js';
import AtomNode from '../../common/view/AtomNode.js';
import BondDipoleNode from '../../common/view/BondDipoleNode.js';
import BondNode from '../../common/view/BondNode.js';
import MolecularDipoleNode from '../../common/view/MolecularDipoleNode.js';
import MoleculeAngleDragListener from '../../common/view/MoleculeAngleDragListener.js';
import PartialChargeNode from '../../common/view/PartialChargeNode.js';
import TranslateArrowsNode from '../../common/view/TranslateArrowsNode.js';
import moleculePolarity from '../../moleculePolarity.js';
import BondAngleDragListener from './BondAngleDragListener.js';
import RotateArrowsNode from './RotateArrowsNode.js';
export default class TriatomicMoleculeNode extends Node {
  constructor(molecule, bondDipolesVisibleProperty, molecularDipoleVisibleProperty, partialChargesVisibleProperty, providedOptions) {
    const options = optionize()({
      // NodeOptions
      phetioInputEnabledPropertyInstrumented: true
    }, providedOptions);

    // atoms
    const atomANode = new AtomNode(molecule.atomA, {
      tandem: options.tandem.createTandem('atomANode'),
      phetioInputEnabledPropertyInstrumented: true
    });
    const atomBNode = new AtomNode(molecule.atomB, {
      tandem: options.tandem.createTandem('atomBNode'),
      phetioInputEnabledPropertyInstrumented: true
    });
    const atomCNode = new AtomNode(molecule.atomC, {
      tandem: options.tandem.createTandem('atomCNode'),
      phetioInputEnabledPropertyInstrumented: true
    });

    // bonds
    const bondABNode = new BondNode(molecule.bondAB, {
      tandem: options.tandem.createTandem('bondABNode'),
      phetioInputEnabledPropertyInstrumented: true
    });
    const bondBCNode = new BondNode(molecule.bondBC, {
      tandem: options.tandem.createTandem('bondBCNode'),
      phetioInputEnabledPropertyInstrumented: true
    });

    // arrows to provide interaction hints
    const hintArrowsTandem = options.tandem.createTandem('hintArrowsNode');
    const hintArrowANode = new TranslateArrowsNode(molecule, molecule.atomA, {
      tandem: hintArrowsTandem.createTandem('hintArrowANode')
    });
    const hintArrowCNode = new TranslateArrowsNode(molecule, molecule.atomC, {
      tandem: hintArrowsTandem.createTandem('hintArrowCNode')
    });
    const hintArrowBNode = new RotateArrowsNode(molecule.atomB, {
      tandem: hintArrowsTandem.createTandem('hintArrowBNode')
    });
    const hintArrowsNode = new Node({
      children: [hintArrowANode, hintArrowCNode, hintArrowBNode],
      tandem: hintArrowsTandem,
      visiblePropertyOptions: {
        phetioDocumentation: 'Set to false to permanently hide hint arrows.'
      }
    });

    // We'll be moving the dragged atom to the front, because A & C can overlap
    const atomsParent = new Node({
      children: [atomANode, atomBNode, atomCNode]
    });

    // partial charge
    const partialChargeANode = PartialChargeNode.createOppositePartialChargeNode(molecule.atomA, molecule.bondAB, {
      visibleProperty: partialChargesVisibleProperty
    });
    const partialChargeBNode = PartialChargeNode.createCompositePartialChargeNode(molecule.atomB, molecule, {
      visibleProperty: partialChargesVisibleProperty
    });
    const partialChargeCNode = PartialChargeNode.createOppositePartialChargeNode(molecule.atomC, molecule.bondBC, {
      visibleProperty: partialChargesVisibleProperty
    });

    // dipoles
    const bondDipoleABNode = new BondDipoleNode(molecule.bondAB, {
      visibleProperty: bondDipolesVisibleProperty
    });
    const bondDipoleBCNode = new BondDipoleNode(molecule.bondBC, {
      visibleProperty: bondDipolesVisibleProperty
    });
    const molecularDipoleNode = new MolecularDipoleNode(molecule, {
      visibleProperty: molecularDipoleVisibleProperty
    });
    options.children = [bondABNode, bondBCNode, atomsParent, hintArrowsNode, partialChargeANode, partialChargeBNode, partialChargeCNode, bondDipoleABNode, bondDipoleBCNode, molecularDipoleNode];
    super(options);

    // cursors
    atomANode.cursor = atomBNode.cursor = atomCNode.cursor = 'pointer'; // atoms
    bondABNode.cursor = bondBCNode.cursor = 'pointer'; // bonds

    // Put all DragListeners under one parent in the Studio tree.
    const dragListenersTandem = options.tandem.createTandem('dragListeners');

    // rotate molecule by dragging atom B or bonds
    const atomBDragListener = new MoleculeAngleDragListener(molecule, this, {
      phetioDocumentation: 'dragging atom B rotates the molecule',
      tandem: dragListenersTandem.createTandem('atomBDragListener')
    });
    const bondABDragListener = new MoleculeAngleDragListener(molecule, this, {
      phetioDocumentation: 'dragging the bond between atoms A and C rotates the molecule',
      tandem: dragListenersTandem.createTandem('bondABDragListener')
    });
    const bondBCDragListener = new MoleculeAngleDragListener(molecule, this, {
      phetioDocumentation: 'dragging the bond between atoms B and C rotates the molecule',
      tandem: dragListenersTandem.createTandem('bondBCDragListener')
    });
    atomBNode.addInputListener(atomBDragListener);
    bondABNode.addInputListener(bondABDragListener);
    bondBCNode.addInputListener(bondBCDragListener);

    // change bond angles by dragging atom A or C
    const atomADragListener = new BondAngleDragListener(molecule, molecule.bondAngleABProperty, atomANode, {
      phetioDocumentation: 'dragging atom A changes the angle of the bond between atoms A and B',
      tandem: dragListenersTandem.createTandem('atomADragListener')
    });
    const atomCDragListener = new BondAngleDragListener(molecule, molecule.bondAngleBCProperty, atomCNode, {
      phetioDocumentation: 'dragging atom C changes the angle of the bond between atoms B and C',
      tandem: dragListenersTandem.createTandem('atomCDragListener')
    });
    atomANode.addInputListener(atomADragListener);
    atomCNode.addInputListener(atomCDragListener);

    // {boolean} Set to true when the molecule has been changed by the user.
    let moleculeHasChanged = false;

    /**
     * Updates the visibility of one hint arrow.
     * @param hintArrowNode - the hint arrow
     * @param atomNode - the atom that the hint arrow is associated with
     */
    const updateOneHintArrow = (hintArrowNode, atomNode) => {
      hintArrowNode.visible = !moleculeHasChanged && this.inputEnabled && atomNode.inputEnabled;
    };

    // Updates the visibility of all hint arrows.
    // Set the hint arrows individually, because hintArrowsNode.visibleProperty is for use by PhET-iO.
    const updateAllHintArrows = () => {
      updateOneHintArrow(hintArrowANode, atomANode);
      updateOneHintArrow(hintArrowBNode, atomBNode);
      updateOneHintArrow(hintArrowCNode, atomCNode);
    };

    // When the user drags any atom or bond, hide the hint arrows.
    const hideArrows = () => {
      if (molecule.isDraggingProperty.value) {
        moleculeHasChanged = true;
        updateAllHintArrows();
      }
    };
    molecule.angleProperty.lazyLink(hideArrows);
    molecule.bondAngleABProperty.lazyLink(hideArrows);
    molecule.bondAngleBCProperty.lazyLink(hideArrows);

    // Update a hint arrow when the molecule inputEnabled or atom inputEnabled changes.
    const createMultilink = (hintArrowNode, atomNode) => {
      Multilink.multilink([this.inputEnabledProperty, atomNode.inputEnabledProperty], () => updateOneHintArrow(hintArrowNode, atomNode));
    };
    createMultilink(hintArrowANode, atomANode);
    createMultilink(hintArrowBNode, atomBNode);
    createMultilink(hintArrowCNode, atomCNode);

    // Show molecule angle as an arrow that points from the center to the atom in the direction of angle.
    if (MPQueryParameters.showMoleculeAngle) {
      const arrowNode = new ArrowNode(0, 0, 100, 0, {
        fill: 'red',
        translation: molecule.position
      });
      this.addChild(arrowNode);
      molecule.angleProperty.link(angle => arrowNode.setRotation(angle));
    }
    this.resetTriatomicMoleculeNode = () => {
      moleculeHasChanged = false;
      updateAllHintArrows();
    };
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
  reset() {
    this.resetTriatomicMoleculeNode();
  }
}
moleculePolarity.register('TriatomicMoleculeNode', TriatomicMoleculeNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aWxpbmsiLCJvcHRpb25pemUiLCJBcnJvd05vZGUiLCJOb2RlIiwiTVBRdWVyeVBhcmFtZXRlcnMiLCJBdG9tTm9kZSIsIkJvbmREaXBvbGVOb2RlIiwiQm9uZE5vZGUiLCJNb2xlY3VsYXJEaXBvbGVOb2RlIiwiTW9sZWN1bGVBbmdsZURyYWdMaXN0ZW5lciIsIlBhcnRpYWxDaGFyZ2VOb2RlIiwiVHJhbnNsYXRlQXJyb3dzTm9kZSIsIm1vbGVjdWxlUG9sYXJpdHkiLCJCb25kQW5nbGVEcmFnTGlzdGVuZXIiLCJSb3RhdGVBcnJvd3NOb2RlIiwiVHJpYXRvbWljTW9sZWN1bGVOb2RlIiwiY29uc3RydWN0b3IiLCJtb2xlY3VsZSIsImJvbmREaXBvbGVzVmlzaWJsZVByb3BlcnR5IiwibW9sZWN1bGFyRGlwb2xlVmlzaWJsZVByb3BlcnR5IiwicGFydGlhbENoYXJnZXNWaXNpYmxlUHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwicGhldGlvSW5wdXRFbmFibGVkUHJvcGVydHlJbnN0cnVtZW50ZWQiLCJhdG9tQU5vZGUiLCJhdG9tQSIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsImF0b21CTm9kZSIsImF0b21CIiwiYXRvbUNOb2RlIiwiYXRvbUMiLCJib25kQUJOb2RlIiwiYm9uZEFCIiwiYm9uZEJDTm9kZSIsImJvbmRCQyIsImhpbnRBcnJvd3NUYW5kZW0iLCJoaW50QXJyb3dBTm9kZSIsImhpbnRBcnJvd0NOb2RlIiwiaGludEFycm93Qk5vZGUiLCJoaW50QXJyb3dzTm9kZSIsImNoaWxkcmVuIiwidmlzaWJsZVByb3BlcnR5T3B0aW9ucyIsInBoZXRpb0RvY3VtZW50YXRpb24iLCJhdG9tc1BhcmVudCIsInBhcnRpYWxDaGFyZ2VBTm9kZSIsImNyZWF0ZU9wcG9zaXRlUGFydGlhbENoYXJnZU5vZGUiLCJ2aXNpYmxlUHJvcGVydHkiLCJwYXJ0aWFsQ2hhcmdlQk5vZGUiLCJjcmVhdGVDb21wb3NpdGVQYXJ0aWFsQ2hhcmdlTm9kZSIsInBhcnRpYWxDaGFyZ2VDTm9kZSIsImJvbmREaXBvbGVBQk5vZGUiLCJib25kRGlwb2xlQkNOb2RlIiwibW9sZWN1bGFyRGlwb2xlTm9kZSIsImN1cnNvciIsImRyYWdMaXN0ZW5lcnNUYW5kZW0iLCJhdG9tQkRyYWdMaXN0ZW5lciIsImJvbmRBQkRyYWdMaXN0ZW5lciIsImJvbmRCQ0RyYWdMaXN0ZW5lciIsImFkZElucHV0TGlzdGVuZXIiLCJhdG9tQURyYWdMaXN0ZW5lciIsImJvbmRBbmdsZUFCUHJvcGVydHkiLCJhdG9tQ0RyYWdMaXN0ZW5lciIsImJvbmRBbmdsZUJDUHJvcGVydHkiLCJtb2xlY3VsZUhhc0NoYW5nZWQiLCJ1cGRhdGVPbmVIaW50QXJyb3ciLCJoaW50QXJyb3dOb2RlIiwiYXRvbU5vZGUiLCJ2aXNpYmxlIiwiaW5wdXRFbmFibGVkIiwidXBkYXRlQWxsSGludEFycm93cyIsImhpZGVBcnJvd3MiLCJpc0RyYWdnaW5nUHJvcGVydHkiLCJ2YWx1ZSIsImFuZ2xlUHJvcGVydHkiLCJsYXp5TGluayIsImNyZWF0ZU11bHRpbGluayIsIm11bHRpbGluayIsImlucHV0RW5hYmxlZFByb3BlcnR5Iiwic2hvd01vbGVjdWxlQW5nbGUiLCJhcnJvd05vZGUiLCJmaWxsIiwidHJhbnNsYXRpb24iLCJwb3NpdGlvbiIsImFkZENoaWxkIiwibGluayIsImFuZ2xlIiwic2V0Um90YXRpb24iLCJyZXNldFRyaWF0b21pY01vbGVjdWxlTm9kZSIsImRpc3Bvc2UiLCJhc3NlcnQiLCJyZXNldCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiVHJpYXRvbWljTW9sZWN1bGVOb2RlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFZpc3VhbCByZXByZXNlbnRhdGlvbiBvZiBhIHRyaWF0b21pYyBtb2xlY3VsZS5cclxuICogQ2hpbGRyZW4gcG9zaXRpb24gdGhlbXNlbHZlcyBpbiBnbG9iYWwgY29vcmRpbmF0ZXMsIHNvIHRoaXMgbm9kZSdzIHBvc2l0aW9uIHNob3VsZCBiZSAoMCwwKS5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgTXVsdGlsaW5rIGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTXVsdGlsaW5rLmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFBpY2tSZXF1aXJlZCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja1JlcXVpcmVkLmpzJztcclxuaW1wb3J0IEFycm93Tm9kZSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvQXJyb3dOb2RlLmpzJztcclxuaW1wb3J0IHsgTm9kZSwgTm9kZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgTVBRdWVyeVBhcmFtZXRlcnMgZnJvbSAnLi4vLi4vY29tbW9uL01QUXVlcnlQYXJhbWV0ZXJzLmpzJztcclxuaW1wb3J0IEF0b21Ob2RlIGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L0F0b21Ob2RlLmpzJztcclxuaW1wb3J0IEJvbmREaXBvbGVOb2RlIGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L0JvbmREaXBvbGVOb2RlLmpzJztcclxuaW1wb3J0IEJvbmROb2RlIGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L0JvbmROb2RlLmpzJztcclxuaW1wb3J0IE1vbGVjdWxhckRpcG9sZU5vZGUgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvTW9sZWN1bGFyRGlwb2xlTm9kZS5qcyc7XHJcbmltcG9ydCBNb2xlY3VsZUFuZ2xlRHJhZ0xpc3RlbmVyIGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L01vbGVjdWxlQW5nbGVEcmFnTGlzdGVuZXIuanMnO1xyXG5pbXBvcnQgUGFydGlhbENoYXJnZU5vZGUgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvUGFydGlhbENoYXJnZU5vZGUuanMnO1xyXG5pbXBvcnQgVHJhbnNsYXRlQXJyb3dzTm9kZSBmcm9tICcuLi8uLi9jb21tb24vdmlldy9UcmFuc2xhdGVBcnJvd3NOb2RlLmpzJztcclxuaW1wb3J0IG1vbGVjdWxlUG9sYXJpdHkgZnJvbSAnLi4vLi4vbW9sZWN1bGVQb2xhcml0eS5qcyc7XHJcbmltcG9ydCBUcmlhdG9taWNNb2xlY3VsZSBmcm9tICcuLi9tb2RlbC9UcmlhdG9taWNNb2xlY3VsZS5qcyc7XHJcbmltcG9ydCBCb25kQW5nbGVEcmFnTGlzdGVuZXIgZnJvbSAnLi9Cb25kQW5nbGVEcmFnTGlzdGVuZXIuanMnO1xyXG5pbXBvcnQgUm90YXRlQXJyb3dzTm9kZSBmcm9tICcuL1JvdGF0ZUFycm93c05vZGUuanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcblxyXG50eXBlIFRyaWF0b21pY01vbGVjdWxlTm9kZU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBpY2tSZXF1aXJlZDxOb2RlT3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHJpYXRvbWljTW9sZWN1bGVOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgcmVzZXRUcmlhdG9taWNNb2xlY3VsZU5vZGU6ICgpID0+IHZvaWQ7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggbW9sZWN1bGU6IFRyaWF0b21pY01vbGVjdWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgYm9uZERpcG9sZXNWaXNpYmxlUHJvcGVydHk6IFByb3BlcnR5PGJvb2xlYW4+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgbW9sZWN1bGFyRGlwb2xlVmlzaWJsZVByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPixcclxuICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWxDaGFyZ2VzVmlzaWJsZVByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPixcclxuICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVkT3B0aW9uczogVHJpYXRvbWljTW9sZWN1bGVOb2RlT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFRyaWF0b21pY01vbGVjdWxlTm9kZU9wdGlvbnMsIFNlbGZPcHRpb25zLCBOb2RlT3B0aW9ucz4oKSgge1xyXG5cclxuICAgICAgLy8gTm9kZU9wdGlvbnNcclxuICAgICAgcGhldGlvSW5wdXRFbmFibGVkUHJvcGVydHlJbnN0cnVtZW50ZWQ6IHRydWVcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIGF0b21zXHJcbiAgICBjb25zdCBhdG9tQU5vZGUgPSBuZXcgQXRvbU5vZGUoIG1vbGVjdWxlLmF0b21BLCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnYXRvbUFOb2RlJyApLFxyXG4gICAgICBwaGV0aW9JbnB1dEVuYWJsZWRQcm9wZXJ0eUluc3RydW1lbnRlZDogdHJ1ZVxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgYXRvbUJOb2RlID0gbmV3IEF0b21Ob2RlKCBtb2xlY3VsZS5hdG9tQiwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2F0b21CTm9kZScgKSxcclxuICAgICAgcGhldGlvSW5wdXRFbmFibGVkUHJvcGVydHlJbnN0cnVtZW50ZWQ6IHRydWVcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGF0b21DTm9kZSA9IG5ldyBBdG9tTm9kZSggbW9sZWN1bGUuYXRvbUMsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdhdG9tQ05vZGUnICksXHJcbiAgICAgIHBoZXRpb0lucHV0RW5hYmxlZFByb3BlcnR5SW5zdHJ1bWVudGVkOiB0cnVlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gYm9uZHNcclxuICAgIGNvbnN0IGJvbmRBQk5vZGUgPSBuZXcgQm9uZE5vZGUoIG1vbGVjdWxlLmJvbmRBQiwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2JvbmRBQk5vZGUnICksXHJcbiAgICAgIHBoZXRpb0lucHV0RW5hYmxlZFByb3BlcnR5SW5zdHJ1bWVudGVkOiB0cnVlXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBib25kQkNOb2RlID0gbmV3IEJvbmROb2RlKCBtb2xlY3VsZS5ib25kQkMsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdib25kQkNOb2RlJyApLFxyXG4gICAgICBwaGV0aW9JbnB1dEVuYWJsZWRQcm9wZXJ0eUluc3RydW1lbnRlZDogdHJ1ZVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGFycm93cyB0byBwcm92aWRlIGludGVyYWN0aW9uIGhpbnRzXHJcbiAgICBjb25zdCBoaW50QXJyb3dzVGFuZGVtID0gb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnaGludEFycm93c05vZGUnICk7XHJcbiAgICBjb25zdCBoaW50QXJyb3dBTm9kZSA9IG5ldyBUcmFuc2xhdGVBcnJvd3NOb2RlKCBtb2xlY3VsZSwgbW9sZWN1bGUuYXRvbUEsIHtcclxuICAgICAgdGFuZGVtOiBoaW50QXJyb3dzVGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2hpbnRBcnJvd0FOb2RlJyApXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBoaW50QXJyb3dDTm9kZSA9IG5ldyBUcmFuc2xhdGVBcnJvd3NOb2RlKCBtb2xlY3VsZSwgbW9sZWN1bGUuYXRvbUMsIHtcclxuICAgICAgdGFuZGVtOiBoaW50QXJyb3dzVGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2hpbnRBcnJvd0NOb2RlJyApXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBoaW50QXJyb3dCTm9kZSA9IG5ldyBSb3RhdGVBcnJvd3NOb2RlKCBtb2xlY3VsZS5hdG9tQiwge1xyXG4gICAgICB0YW5kZW06IGhpbnRBcnJvd3NUYW5kZW0uY3JlYXRlVGFuZGVtKCAnaGludEFycm93Qk5vZGUnIClcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGhpbnRBcnJvd3NOb2RlID0gbmV3IE5vZGUoIHtcclxuICAgICAgY2hpbGRyZW46IFsgaGludEFycm93QU5vZGUsIGhpbnRBcnJvd0NOb2RlLCBoaW50QXJyb3dCTm9kZSBdLFxyXG4gICAgICB0YW5kZW06IGhpbnRBcnJvd3NUYW5kZW0sXHJcbiAgICAgIHZpc2libGVQcm9wZXJ0eU9wdGlvbnM6IHtcclxuICAgICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnU2V0IHRvIGZhbHNlIHRvIHBlcm1hbmVudGx5IGhpZGUgaGludCBhcnJvd3MuJ1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gV2UnbGwgYmUgbW92aW5nIHRoZSBkcmFnZ2VkIGF0b20gdG8gdGhlIGZyb250LCBiZWNhdXNlIEEgJiBDIGNhbiBvdmVybGFwXHJcbiAgICBjb25zdCBhdG9tc1BhcmVudCA9IG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIGF0b21BTm9kZSwgYXRvbUJOb2RlLCBhdG9tQ05vZGUgXSB9ICk7XHJcblxyXG4gICAgLy8gcGFydGlhbCBjaGFyZ2VcclxuICAgIGNvbnN0IHBhcnRpYWxDaGFyZ2VBTm9kZSA9IFBhcnRpYWxDaGFyZ2VOb2RlLmNyZWF0ZU9wcG9zaXRlUGFydGlhbENoYXJnZU5vZGUoIG1vbGVjdWxlLmF0b21BLCBtb2xlY3VsZS5ib25kQUIsIHtcclxuICAgICAgdmlzaWJsZVByb3BlcnR5OiBwYXJ0aWFsQ2hhcmdlc1Zpc2libGVQcm9wZXJ0eVxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgcGFydGlhbENoYXJnZUJOb2RlID0gUGFydGlhbENoYXJnZU5vZGUuY3JlYXRlQ29tcG9zaXRlUGFydGlhbENoYXJnZU5vZGUoIG1vbGVjdWxlLmF0b21CLCBtb2xlY3VsZSwge1xyXG4gICAgICB2aXNpYmxlUHJvcGVydHk6IHBhcnRpYWxDaGFyZ2VzVmlzaWJsZVByb3BlcnR5XHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBwYXJ0aWFsQ2hhcmdlQ05vZGUgPSBQYXJ0aWFsQ2hhcmdlTm9kZS5jcmVhdGVPcHBvc2l0ZVBhcnRpYWxDaGFyZ2VOb2RlKCBtb2xlY3VsZS5hdG9tQywgbW9sZWN1bGUuYm9uZEJDLCB7XHJcbiAgICAgIHZpc2libGVQcm9wZXJ0eTogcGFydGlhbENoYXJnZXNWaXNpYmxlUHJvcGVydHlcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBkaXBvbGVzXHJcbiAgICBjb25zdCBib25kRGlwb2xlQUJOb2RlID0gbmV3IEJvbmREaXBvbGVOb2RlKCBtb2xlY3VsZS5ib25kQUIsIHtcclxuICAgICAgdmlzaWJsZVByb3BlcnR5OiBib25kRGlwb2xlc1Zpc2libGVQcm9wZXJ0eVxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgYm9uZERpcG9sZUJDTm9kZSA9IG5ldyBCb25kRGlwb2xlTm9kZSggbW9sZWN1bGUuYm9uZEJDLCB7XHJcbiAgICAgIHZpc2libGVQcm9wZXJ0eTogYm9uZERpcG9sZXNWaXNpYmxlUHJvcGVydHlcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IG1vbGVjdWxhckRpcG9sZU5vZGUgPSBuZXcgTW9sZWN1bGFyRGlwb2xlTm9kZSggbW9sZWN1bGUsIHtcclxuICAgICAgdmlzaWJsZVByb3BlcnR5OiBtb2xlY3VsYXJEaXBvbGVWaXNpYmxlUHJvcGVydHlcclxuICAgIH0gKTtcclxuXHJcbiAgICBvcHRpb25zLmNoaWxkcmVuID0gW1xyXG4gICAgICBib25kQUJOb2RlLCBib25kQkNOb2RlLFxyXG4gICAgICBhdG9tc1BhcmVudCxcclxuICAgICAgaGludEFycm93c05vZGUsXHJcbiAgICAgIHBhcnRpYWxDaGFyZ2VBTm9kZSwgcGFydGlhbENoYXJnZUJOb2RlLCBwYXJ0aWFsQ2hhcmdlQ05vZGUsXHJcbiAgICAgIGJvbmREaXBvbGVBQk5vZGUsIGJvbmREaXBvbGVCQ05vZGUsIG1vbGVjdWxhckRpcG9sZU5vZGVcclxuICAgIF07XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBjdXJzb3JzXHJcbiAgICBhdG9tQU5vZGUuY3Vyc29yID0gYXRvbUJOb2RlLmN1cnNvciA9IGF0b21DTm9kZS5jdXJzb3IgPSAncG9pbnRlcic7IC8vIGF0b21zXHJcbiAgICBib25kQUJOb2RlLmN1cnNvciA9IGJvbmRCQ05vZGUuY3Vyc29yID0gJ3BvaW50ZXInOyAvLyBib25kc1xyXG5cclxuICAgIC8vIFB1dCBhbGwgRHJhZ0xpc3RlbmVycyB1bmRlciBvbmUgcGFyZW50IGluIHRoZSBTdHVkaW8gdHJlZS5cclxuICAgIGNvbnN0IGRyYWdMaXN0ZW5lcnNUYW5kZW0gPSBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdkcmFnTGlzdGVuZXJzJyApO1xyXG5cclxuICAgIC8vIHJvdGF0ZSBtb2xlY3VsZSBieSBkcmFnZ2luZyBhdG9tIEIgb3IgYm9uZHNcclxuICAgIGNvbnN0IGF0b21CRHJhZ0xpc3RlbmVyID0gbmV3IE1vbGVjdWxlQW5nbGVEcmFnTGlzdGVuZXIoIG1vbGVjdWxlLCB0aGlzLCB7XHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdkcmFnZ2luZyBhdG9tIEIgcm90YXRlcyB0aGUgbW9sZWN1bGUnLFxyXG4gICAgICB0YW5kZW06IGRyYWdMaXN0ZW5lcnNUYW5kZW0uY3JlYXRlVGFuZGVtKCAnYXRvbUJEcmFnTGlzdGVuZXInIClcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGJvbmRBQkRyYWdMaXN0ZW5lciA9IG5ldyBNb2xlY3VsZUFuZ2xlRHJhZ0xpc3RlbmVyKCBtb2xlY3VsZSwgdGhpcywge1xyXG4gICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnZHJhZ2dpbmcgdGhlIGJvbmQgYmV0d2VlbiBhdG9tcyBBIGFuZCBDIHJvdGF0ZXMgdGhlIG1vbGVjdWxlJyxcclxuICAgICAgdGFuZGVtOiBkcmFnTGlzdGVuZXJzVGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2JvbmRBQkRyYWdMaXN0ZW5lcicgKVxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgYm9uZEJDRHJhZ0xpc3RlbmVyID0gbmV3IE1vbGVjdWxlQW5nbGVEcmFnTGlzdGVuZXIoIG1vbGVjdWxlLCB0aGlzLCB7XHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdkcmFnZ2luZyB0aGUgYm9uZCBiZXR3ZWVuIGF0b21zIEIgYW5kIEMgcm90YXRlcyB0aGUgbW9sZWN1bGUnLFxyXG4gICAgICB0YW5kZW06IGRyYWdMaXN0ZW5lcnNUYW5kZW0uY3JlYXRlVGFuZGVtKCAnYm9uZEJDRHJhZ0xpc3RlbmVyJyApXHJcbiAgICB9ICk7XHJcbiAgICBhdG9tQk5vZGUuYWRkSW5wdXRMaXN0ZW5lciggYXRvbUJEcmFnTGlzdGVuZXIgKTtcclxuICAgIGJvbmRBQk5vZGUuYWRkSW5wdXRMaXN0ZW5lciggYm9uZEFCRHJhZ0xpc3RlbmVyICk7XHJcbiAgICBib25kQkNOb2RlLmFkZElucHV0TGlzdGVuZXIoIGJvbmRCQ0RyYWdMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIGNoYW5nZSBib25kIGFuZ2xlcyBieSBkcmFnZ2luZyBhdG9tIEEgb3IgQ1xyXG4gICAgY29uc3QgYXRvbUFEcmFnTGlzdGVuZXIgPSBuZXcgQm9uZEFuZ2xlRHJhZ0xpc3RlbmVyKCBtb2xlY3VsZSwgbW9sZWN1bGUuYm9uZEFuZ2xlQUJQcm9wZXJ0eSwgYXRvbUFOb2RlLCB7XHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdkcmFnZ2luZyBhdG9tIEEgY2hhbmdlcyB0aGUgYW5nbGUgb2YgdGhlIGJvbmQgYmV0d2VlbiBhdG9tcyBBIGFuZCBCJyxcclxuICAgICAgdGFuZGVtOiBkcmFnTGlzdGVuZXJzVGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2F0b21BRHJhZ0xpc3RlbmVyJyApXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBhdG9tQ0RyYWdMaXN0ZW5lciA9IG5ldyBCb25kQW5nbGVEcmFnTGlzdGVuZXIoIG1vbGVjdWxlLCBtb2xlY3VsZS5ib25kQW5nbGVCQ1Byb3BlcnR5LCBhdG9tQ05vZGUsIHtcclxuICAgICAgcGhldGlvRG9jdW1lbnRhdGlvbjogJ2RyYWdnaW5nIGF0b20gQyBjaGFuZ2VzIHRoZSBhbmdsZSBvZiB0aGUgYm9uZCBiZXR3ZWVuIGF0b21zIEIgYW5kIEMnLFxyXG4gICAgICB0YW5kZW06IGRyYWdMaXN0ZW5lcnNUYW5kZW0uY3JlYXRlVGFuZGVtKCAnYXRvbUNEcmFnTGlzdGVuZXInIClcclxuICAgIH0gKTtcclxuICAgIGF0b21BTm9kZS5hZGRJbnB1dExpc3RlbmVyKCBhdG9tQURyYWdMaXN0ZW5lciApO1xyXG4gICAgYXRvbUNOb2RlLmFkZElucHV0TGlzdGVuZXIoIGF0b21DRHJhZ0xpc3RlbmVyICk7XHJcblxyXG4gICAgLy8ge2Jvb2xlYW59IFNldCB0byB0cnVlIHdoZW4gdGhlIG1vbGVjdWxlIGhhcyBiZWVuIGNoYW5nZWQgYnkgdGhlIHVzZXIuXHJcbiAgICBsZXQgbW9sZWN1bGVIYXNDaGFuZ2VkID0gZmFsc2U7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSB2aXNpYmlsaXR5IG9mIG9uZSBoaW50IGFycm93LlxyXG4gICAgICogQHBhcmFtIGhpbnRBcnJvd05vZGUgLSB0aGUgaGludCBhcnJvd1xyXG4gICAgICogQHBhcmFtIGF0b21Ob2RlIC0gdGhlIGF0b20gdGhhdCB0aGUgaGludCBhcnJvdyBpcyBhc3NvY2lhdGVkIHdpdGhcclxuICAgICAqL1xyXG4gICAgY29uc3QgdXBkYXRlT25lSGludEFycm93ID0gKCBoaW50QXJyb3dOb2RlOiBOb2RlLCBhdG9tTm9kZTogTm9kZSApID0+IHtcclxuICAgICAgaGludEFycm93Tm9kZS52aXNpYmxlID0gKCAhbW9sZWN1bGVIYXNDaGFuZ2VkICYmIHRoaXMuaW5wdXRFbmFibGVkICYmIGF0b21Ob2RlLmlucHV0RW5hYmxlZCApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBVcGRhdGVzIHRoZSB2aXNpYmlsaXR5IG9mIGFsbCBoaW50IGFycm93cy5cclxuICAgIC8vIFNldCB0aGUgaGludCBhcnJvd3MgaW5kaXZpZHVhbGx5LCBiZWNhdXNlIGhpbnRBcnJvd3NOb2RlLnZpc2libGVQcm9wZXJ0eSBpcyBmb3IgdXNlIGJ5IFBoRVQtaU8uXHJcbiAgICBjb25zdCB1cGRhdGVBbGxIaW50QXJyb3dzID0gKCkgPT4ge1xyXG4gICAgICB1cGRhdGVPbmVIaW50QXJyb3coIGhpbnRBcnJvd0FOb2RlLCBhdG9tQU5vZGUgKTtcclxuICAgICAgdXBkYXRlT25lSGludEFycm93KCBoaW50QXJyb3dCTm9kZSwgYXRvbUJOb2RlICk7XHJcbiAgICAgIHVwZGF0ZU9uZUhpbnRBcnJvdyggaGludEFycm93Q05vZGUsIGF0b21DTm9kZSApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBXaGVuIHRoZSB1c2VyIGRyYWdzIGFueSBhdG9tIG9yIGJvbmQsIGhpZGUgdGhlIGhpbnQgYXJyb3dzLlxyXG4gICAgY29uc3QgaGlkZUFycm93cyA9ICgpID0+IHtcclxuICAgICAgaWYgKCBtb2xlY3VsZS5pc0RyYWdnaW5nUHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgICAgbW9sZWN1bGVIYXNDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICB1cGRhdGVBbGxIaW50QXJyb3dzKCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICBtb2xlY3VsZS5hbmdsZVByb3BlcnR5LmxhenlMaW5rKCBoaWRlQXJyb3dzICk7XHJcbiAgICBtb2xlY3VsZS5ib25kQW5nbGVBQlByb3BlcnR5LmxhenlMaW5rKCBoaWRlQXJyb3dzICk7XHJcbiAgICBtb2xlY3VsZS5ib25kQW5nbGVCQ1Byb3BlcnR5LmxhenlMaW5rKCBoaWRlQXJyb3dzICk7XHJcblxyXG4gICAgLy8gVXBkYXRlIGEgaGludCBhcnJvdyB3aGVuIHRoZSBtb2xlY3VsZSBpbnB1dEVuYWJsZWQgb3IgYXRvbSBpbnB1dEVuYWJsZWQgY2hhbmdlcy5cclxuICAgIGNvbnN0IGNyZWF0ZU11bHRpbGluayA9ICggaGludEFycm93Tm9kZTogTm9kZSwgYXRvbU5vZGU6IE5vZGUgKSA9PiB7XHJcbiAgICAgIE11bHRpbGluay5tdWx0aWxpbmsoIFsgdGhpcy5pbnB1dEVuYWJsZWRQcm9wZXJ0eSwgYXRvbU5vZGUuaW5wdXRFbmFibGVkUHJvcGVydHkgXSxcclxuICAgICAgICAoKSA9PiB1cGRhdGVPbmVIaW50QXJyb3coIGhpbnRBcnJvd05vZGUsIGF0b21Ob2RlIClcclxuICAgICAgKTtcclxuICAgIH07XHJcbiAgICBjcmVhdGVNdWx0aWxpbmsoIGhpbnRBcnJvd0FOb2RlLCBhdG9tQU5vZGUgKTtcclxuICAgIGNyZWF0ZU11bHRpbGluayggaGludEFycm93Qk5vZGUsIGF0b21CTm9kZSApO1xyXG4gICAgY3JlYXRlTXVsdGlsaW5rKCBoaW50QXJyb3dDTm9kZSwgYXRvbUNOb2RlICk7XHJcblxyXG4gICAgLy8gU2hvdyBtb2xlY3VsZSBhbmdsZSBhcyBhbiBhcnJvdyB0aGF0IHBvaW50cyBmcm9tIHRoZSBjZW50ZXIgdG8gdGhlIGF0b20gaW4gdGhlIGRpcmVjdGlvbiBvZiBhbmdsZS5cclxuICAgIGlmICggTVBRdWVyeVBhcmFtZXRlcnMuc2hvd01vbGVjdWxlQW5nbGUgKSB7XHJcbiAgICAgIGNvbnN0IGFycm93Tm9kZSA9IG5ldyBBcnJvd05vZGUoIDAsIDAsIDEwMCwgMCwge1xyXG4gICAgICAgIGZpbGw6ICdyZWQnLFxyXG4gICAgICAgIHRyYW5zbGF0aW9uOiBtb2xlY3VsZS5wb3NpdGlvblxyXG4gICAgICB9ICk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIGFycm93Tm9kZSApO1xyXG4gICAgICBtb2xlY3VsZS5hbmdsZVByb3BlcnR5LmxpbmsoIGFuZ2xlID0+IGFycm93Tm9kZS5zZXRSb3RhdGlvbiggYW5nbGUgKSApO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMucmVzZXRUcmlhdG9taWNNb2xlY3VsZU5vZGUgPSAoKSA9PiB7XHJcbiAgICAgIG1vbGVjdWxlSGFzQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgICB1cGRhdGVBbGxIaW50QXJyb3dzKCk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBmYWxzZSwgJ2Rpc3Bvc2UgaXMgbm90IHN1cHBvcnRlZCwgZXhpc3RzIGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIHNpbScgKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyByZXNldCgpOiB2b2lkIHtcclxuICAgIHRoaXMucmVzZXRUcmlhdG9taWNNb2xlY3VsZU5vZGUoKTtcclxuICB9XHJcbn1cclxuXHJcbm1vbGVjdWxlUG9sYXJpdHkucmVnaXN0ZXIoICdUcmlhdG9taWNNb2xlY3VsZU5vZGUnLCBUcmlhdG9taWNNb2xlY3VsZU5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxTQUFTLE1BQU0sa0NBQWtDO0FBRXhELE9BQU9DLFNBQVMsTUFBNEIsdUNBQXVDO0FBRW5GLE9BQU9DLFNBQVMsTUFBTSwwQ0FBMEM7QUFDaEUsU0FBU0MsSUFBSSxRQUFxQixtQ0FBbUM7QUFDckUsT0FBT0MsaUJBQWlCLE1BQU0sbUNBQW1DO0FBQ2pFLE9BQU9DLFFBQVEsTUFBTSwrQkFBK0I7QUFDcEQsT0FBT0MsY0FBYyxNQUFNLHFDQUFxQztBQUNoRSxPQUFPQyxRQUFRLE1BQU0sK0JBQStCO0FBQ3BELE9BQU9DLG1CQUFtQixNQUFNLDBDQUEwQztBQUMxRSxPQUFPQyx5QkFBeUIsTUFBTSxnREFBZ0Q7QUFDdEYsT0FBT0MsaUJBQWlCLE1BQU0sd0NBQXdDO0FBQ3RFLE9BQU9DLG1CQUFt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