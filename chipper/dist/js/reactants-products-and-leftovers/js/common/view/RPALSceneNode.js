// Copyright 2014-2023, University of Colorado Boulder

/**
 * This is the primary UI component for the 'Sandwiches' and 'Molecules' screens.
 * It displays a reaction as 2 boxes, representing the 'Before' and 'After' states of the reaction.
 * The 'Before' box is on the left, and shows the initial reactants.
 * The 'After' box is on the right, and shows the products and leftovers when the reaction has completed.
 * Below the 'Before' box is a set of spinners for changing the reactant quantities.
 * Below the 'After' box is a set of noneditable quantities for products and leftovers.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Dimension2 from '../../../../dot/js/Dimension2.js';
import optionize, { combineOptions } from '../../../../phet-core/js/optionize.js';
import { HBox, Node } from '../../../../scenery/js/imports.js';
import reactantsProductsAndLeftovers from '../../reactantsProductsAndLeftovers.js';
import ReactantsProductsAndLeftoversStrings from '../../ReactantsProductsAndLeftoversStrings.js';
import RPALColors from '../RPALColors.js';
import RPALConstants from '../RPALConstants.js';
import QuantitiesNode from './QuantitiesNode.js';
import RightArrowNode from './RightArrowNode.js';
import StacksAccordionBox from './StacksAccordionBox.js';
const DEFAULT_CONTENT_SIZE = new Dimension2(100, 100);
const DEFAULT_MIN_ICON_SIZE = new Dimension2(0, 0);
export default class RPALSceneNode extends Node {
  /**
   * @param reaction - the reaction to be displayed
   * @param beforeExpandedProperty - whether the 'Before' box is expanded
   * @param afterExpandedProperty - whether the 'After' box is expanded
   * @param [providedOptions]
   */
  constructor(reaction, beforeExpandedProperty, afterExpandedProperty, providedOptions) {
    const options = optionize()({
      // SelfOptions
      quantityRange: RPALConstants.QUANTITY_RANGE,
      showSymbols: true,
      beforeTitleProperty: ReactantsProductsAndLeftoversStrings.beforeReactionStringProperty,
      afterTitleProperty: ReactantsProductsAndLeftoversStrings.afterReactionStringProperty,
      contentSize: DEFAULT_CONTENT_SIZE,
      minIconSize: DEFAULT_MIN_ICON_SIZE,
      boxYMargin: 6
    }, providedOptions);

    // vars to improve readability
    const reactants = reaction.reactants;
    const products = reaction.products;
    const leftovers = reaction.leftovers;

    // x-offsets of the substances relative to their boxes
    const beforeXOffsets = QuantitiesNode.createXOffsets(reactants.length, options.contentSize.width);
    const afterXOffsets = QuantitiesNode.createXOffsets(products.length + leftovers.length, options.contentSize.width);
    const stacksAccordionBoxOptions = {
      contentSize: options.contentSize,
      minIconSize: options.minIconSize,
      maxQuantity: options.quantityRange.max,
      boxYMargin: options.boxYMargin
    };

    // 'Before Reaction' accordion box, with stacks of reactants
    const beforeAccordionBox = new StacksAccordionBox(reactants, beforeXOffsets, options.beforeTitleProperty, beforeExpandedProperty, combineOptions({
      tandem: options.tandem.createTandem('beforeAccordionBox')
    }, stacksAccordionBoxOptions));

    // 'After Reaction' accordion box, with stacks of products and leftovers
    const afterAccordionBox = new StacksAccordionBox([...products, ...leftovers], afterXOffsets, options.afterTitleProperty, afterExpandedProperty, combineOptions({
      tandem: options.tandem.createTandem('afterAccordionBox')
    }, stacksAccordionBoxOptions));

    // Arrow between boxes
    const rightArrowNode = new RightArrowNode({
      fill: RPALColors.STATUS_BAR_FILL,
      stroke: null,
      scale: 0.75,
      tandem: options.tandem.createTandem('rightArrowNode')
    });

    // layout of boxes and arrow
    const hBox = new HBox({
      children: [beforeAccordionBox, rightArrowNode, afterAccordionBox],
      spacing: 10,
      excludeInvisibleChildrenFromBounds: false
    });

    // Everything below the boxes
    const quantitiesNode = new QuantitiesNode(reactants, products, leftovers, beforeXOffsets, afterXOffsets, {
      showSymbols: options.showSymbols,
      boxWidth: options.contentSize.width,
      afterBoxXOffset: afterAccordionBox.left - beforeAccordionBox.left,
      minIconSize: options.minIconSize,
      quantityRange: options.quantityRange,
      x: beforeAccordionBox.x,
      top: beforeAccordionBox.bottom + 6,
      tandem: options.tandem.createTandem('quantitiesNode')
    });
    options.children = [hBox, quantitiesNode];
    super(options);
    this.addLinkedElement(reaction, {
      tandem: options.tandem.createTandem(reaction.tandem.name)
    });
    this.disposeBeforeAfterNode = () => {
      beforeAccordionBox.dispose();
      afterAccordionBox.dispose();
      rightArrowNode.dispose();
      quantitiesNode.dispose();
    };
  }
  dispose() {
    this.disposeBeforeAfterNode();
    super.dispose();
  }
}
reactantsProductsAndLeftovers.register('RPALSceneNode', RPALSceneNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEaW1lbnNpb24yIiwib3B0aW9uaXplIiwiY29tYmluZU9wdGlvbnMiLCJIQm94IiwiTm9kZSIsInJlYWN0YW50c1Byb2R1Y3RzQW5kTGVmdG92ZXJzIiwiUmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnNTdHJpbmdzIiwiUlBBTENvbG9ycyIsIlJQQUxDb25zdGFudHMiLCJRdWFudGl0aWVzTm9kZSIsIlJpZ2h0QXJyb3dOb2RlIiwiU3RhY2tzQWNjb3JkaW9uQm94IiwiREVGQVVMVF9DT05URU5UX1NJWkUiLCJERUZBVUxUX01JTl9JQ09OX1NJWkUiLCJSUEFMU2NlbmVOb2RlIiwiY29uc3RydWN0b3IiLCJyZWFjdGlvbiIsImJlZm9yZUV4cGFuZGVkUHJvcGVydHkiLCJhZnRlckV4cGFuZGVkUHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwicXVhbnRpdHlSYW5nZSIsIlFVQU5USVRZX1JBTkdFIiwic2hvd1N5bWJvbHMiLCJiZWZvcmVUaXRsZVByb3BlcnR5IiwiYmVmb3JlUmVhY3Rpb25TdHJpbmdQcm9wZXJ0eSIsImFmdGVyVGl0bGVQcm9wZXJ0eSIsImFmdGVyUmVhY3Rpb25TdHJpbmdQcm9wZXJ0eSIsImNvbnRlbnRTaXplIiwibWluSWNvblNpemUiLCJib3hZTWFyZ2luIiwicmVhY3RhbnRzIiwicHJvZHVjdHMiLCJsZWZ0b3ZlcnMiLCJiZWZvcmVYT2Zmc2V0cyIsImNyZWF0ZVhPZmZzZXRzIiwibGVuZ3RoIiwid2lkdGgiLCJhZnRlclhPZmZzZXRzIiwic3RhY2tzQWNjb3JkaW9uQm94T3B0aW9ucyIsIm1heFF1YW50aXR5IiwibWF4IiwiYmVmb3JlQWNjb3JkaW9uQm94IiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwiYWZ0ZXJBY2NvcmRpb25Cb3giLCJyaWdodEFycm93Tm9kZSIsImZpbGwiLCJTVEFUVVNfQkFSX0ZJTEwiLCJzdHJva2UiLCJzY2FsZSIsImhCb3giLCJjaGlsZHJlbiIsInNwYWNpbmciLCJleGNsdWRlSW52aXNpYmxlQ2hpbGRyZW5Gcm9tQm91bmRzIiwicXVhbnRpdGllc05vZGUiLCJib3hXaWR0aCIsImFmdGVyQm94WE9mZnNldCIsImxlZnQiLCJ4IiwidG9wIiwiYm90dG9tIiwiYWRkTGlua2VkRWxlbWVudCIsIm5hbWUiLCJkaXNwb3NlQmVmb3JlQWZ0ZXJOb2RlIiwiZGlzcG9zZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiUlBBTFNjZW5lTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNC0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBUaGlzIGlzIHRoZSBwcmltYXJ5IFVJIGNvbXBvbmVudCBmb3IgdGhlICdTYW5kd2ljaGVzJyBhbmQgJ01vbGVjdWxlcycgc2NyZWVucy5cclxuICogSXQgZGlzcGxheXMgYSByZWFjdGlvbiBhcyAyIGJveGVzLCByZXByZXNlbnRpbmcgdGhlICdCZWZvcmUnIGFuZCAnQWZ0ZXInIHN0YXRlcyBvZiB0aGUgcmVhY3Rpb24uXHJcbiAqIFRoZSAnQmVmb3JlJyBib3ggaXMgb24gdGhlIGxlZnQsIGFuZCBzaG93cyB0aGUgaW5pdGlhbCByZWFjdGFudHMuXHJcbiAqIFRoZSAnQWZ0ZXInIGJveCBpcyBvbiB0aGUgcmlnaHQsIGFuZCBzaG93cyB0aGUgcHJvZHVjdHMgYW5kIGxlZnRvdmVycyB3aGVuIHRoZSByZWFjdGlvbiBoYXMgY29tcGxldGVkLlxyXG4gKiBCZWxvdyB0aGUgJ0JlZm9yZScgYm94IGlzIGEgc2V0IG9mIHNwaW5uZXJzIGZvciBjaGFuZ2luZyB0aGUgcmVhY3RhbnQgcXVhbnRpdGllcy5cclxuICogQmVsb3cgdGhlICdBZnRlcicgYm94IGlzIGEgc2V0IG9mIG5vbmVkaXRhYmxlIHF1YW50aXRpZXMgZm9yIHByb2R1Y3RzIGFuZCBsZWZ0b3ZlcnMuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEaW1lbnNpb24yIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9EaW1lbnNpb24yLmpzJztcclxuaW1wb3J0IFJhbmdlIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9SYW5nZS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgY29tYmluZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IHsgSEJveCwgTm9kZSwgTm9kZU9wdGlvbnMsIE5vZGVUcmFuc2xhdGlvbk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgcmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnMgZnJvbSAnLi4vLi4vcmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnMuanMnO1xyXG5pbXBvcnQgUmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnNTdHJpbmdzIGZyb20gJy4uLy4uL1JlYWN0YW50c1Byb2R1Y3RzQW5kTGVmdG92ZXJzU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBSZWFjdGlvbiBmcm9tICcuLi9tb2RlbC9SZWFjdGlvbi5qcyc7XHJcbmltcG9ydCBSUEFMQ29sb3JzIGZyb20gJy4uL1JQQUxDb2xvcnMuanMnO1xyXG5pbXBvcnQgUlBBTENvbnN0YW50cyBmcm9tICcuLi9SUEFMQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IFF1YW50aXRpZXNOb2RlIGZyb20gJy4vUXVhbnRpdGllc05vZGUuanMnO1xyXG5pbXBvcnQgUmlnaHRBcnJvd05vZGUgZnJvbSAnLi9SaWdodEFycm93Tm9kZS5qcyc7XHJcbmltcG9ydCBTdGFja3NBY2NvcmRpb25Cb3gsIHsgU3RhY2tzQWNjb3JkaW9uQm94T3B0aW9ucyB9IGZyb20gJy4vU3RhY2tzQWNjb3JkaW9uQm94LmpzJztcclxuaW1wb3J0IFBpY2tSZXF1aXJlZCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja1JlcXVpcmVkLmpzJztcclxuXHJcbmNvbnN0IERFRkFVTFRfQ09OVEVOVF9TSVpFID0gbmV3IERpbWVuc2lvbjIoIDEwMCwgMTAwICk7XHJcbmNvbnN0IERFRkFVTFRfTUlOX0lDT05fU0laRSA9IG5ldyBEaW1lbnNpb24yKCAwLCAwICk7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIHF1YW50aXR5UmFuZ2U/OiBSYW5nZTsgLy8gcmFuZ2Ugb2YgdGhlIHF1YW50aXR5IHZhbHVlc1xyXG4gIHNob3dTeW1ib2xzPzogYm9vbGVhbjsgLy8gd2hldGhlciB0byBzaG93IHN5bWJvbHMgKGVnLCBIMk8pIGZvciB0aGUgc3Vic3RhbmNlcyBpbiB0aGUgcmVhY3Rpb25zXHJcbiAgYmVmb3JlVGl0bGVQcm9wZXJ0eT86IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz47ICAvLyB0aXRsZSBvbiB0aGUgJ0JlZm9yZScgYm94XHJcbiAgYWZ0ZXJUaXRsZVByb3BlcnR5PzogVFJlYWRPbmx5UHJvcGVydHk8c3RyaW5nPjsgLy8gdGl0bGUgb24gdGhlICdBZnRlcicgYm94XHJcbiAgY29udGVudFNpemU/OiBEaW1lbnNpb24yOyAvLyBzaXplIG9mIHRoZSAnQmVmb3JlJyBhbmQgJ0FmdGVyJyBib3hlc1xyXG4gIG1pbkljb25TaXplPzogRGltZW5zaW9uMjsgLy8gbWluaW11bSBhbW91bnQgb2YgbGF5b3V0IHNwYWNlIHJlc2VydmVkIGZvciBTdWJzdGFuY2UgaWNvbnNcclxuICBib3hZTWFyZ2luPzogbnVtYmVyOyAvLyB2ZXJ0aWNhbCBtYXJnaW4gYmV0d2VlbiB0aGUgaW5uZXIgZWRnZSBvZiBib3ggYW5kIHRoZSB0YWxsZXN0IG5vZGVcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIEJlZm9yZUFmdGVyTm9kZU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIE5vZGVUcmFuc2xhdGlvbk9wdGlvbnMgJlxyXG4gIFBpY2tSZXF1aXJlZDxOb2RlT3B0aW9ucywgJ3RhbmRlbScgfCAndmlzaWJsZVByb3BlcnR5Jz47XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSUEFMU2NlbmVOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZUJlZm9yZUFmdGVyTm9kZTogKCkgPT4gdm9pZDtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHJlYWN0aW9uIC0gdGhlIHJlYWN0aW9uIHRvIGJlIGRpc3BsYXllZFxyXG4gICAqIEBwYXJhbSBiZWZvcmVFeHBhbmRlZFByb3BlcnR5IC0gd2hldGhlciB0aGUgJ0JlZm9yZScgYm94IGlzIGV4cGFuZGVkXHJcbiAgICogQHBhcmFtIGFmdGVyRXhwYW5kZWRQcm9wZXJ0eSAtIHdoZXRoZXIgdGhlICdBZnRlcicgYm94IGlzIGV4cGFuZGVkXHJcbiAgICogQHBhcmFtIFtwcm92aWRlZE9wdGlvbnNdXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCByZWFjdGlvbjogUmVhY3Rpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgICBiZWZvcmVFeHBhbmRlZFByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPixcclxuICAgICAgICAgICAgICAgICAgICAgIGFmdGVyRXhwYW5kZWRQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM/OiBCZWZvcmVBZnRlck5vZGVPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8QmVmb3JlQWZ0ZXJOb2RlT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBTZWxmT3B0aW9uc1xyXG4gICAgICBxdWFudGl0eVJhbmdlOiBSUEFMQ29uc3RhbnRzLlFVQU5USVRZX1JBTkdFLFxyXG4gICAgICBzaG93U3ltYm9sczogdHJ1ZSxcclxuICAgICAgYmVmb3JlVGl0bGVQcm9wZXJ0eTogUmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnNTdHJpbmdzLmJlZm9yZVJlYWN0aW9uU3RyaW5nUHJvcGVydHksXHJcbiAgICAgIGFmdGVyVGl0bGVQcm9wZXJ0eTogUmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnNTdHJpbmdzLmFmdGVyUmVhY3Rpb25TdHJpbmdQcm9wZXJ0eSxcclxuICAgICAgY29udGVudFNpemU6IERFRkFVTFRfQ09OVEVOVF9TSVpFLFxyXG4gICAgICBtaW5JY29uU2l6ZTogREVGQVVMVF9NSU5fSUNPTl9TSVpFLFxyXG4gICAgICBib3hZTWFyZ2luOiA2XHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyB2YXJzIHRvIGltcHJvdmUgcmVhZGFiaWxpdHlcclxuICAgIGNvbnN0IHJlYWN0YW50cyA9IHJlYWN0aW9uLnJlYWN0YW50cztcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gcmVhY3Rpb24ucHJvZHVjdHM7XHJcbiAgICBjb25zdCBsZWZ0b3ZlcnMgPSByZWFjdGlvbi5sZWZ0b3ZlcnM7XHJcblxyXG4gICAgLy8geC1vZmZzZXRzIG9mIHRoZSBzdWJzdGFuY2VzIHJlbGF0aXZlIHRvIHRoZWlyIGJveGVzXHJcbiAgICBjb25zdCBiZWZvcmVYT2Zmc2V0cyA9IFF1YW50aXRpZXNOb2RlLmNyZWF0ZVhPZmZzZXRzKCByZWFjdGFudHMubGVuZ3RoLCBvcHRpb25zLmNvbnRlbnRTaXplLndpZHRoICk7XHJcbiAgICBjb25zdCBhZnRlclhPZmZzZXRzID0gUXVhbnRpdGllc05vZGUuY3JlYXRlWE9mZnNldHMoIHByb2R1Y3RzLmxlbmd0aCArIGxlZnRvdmVycy5sZW5ndGgsIG9wdGlvbnMuY29udGVudFNpemUud2lkdGggKTtcclxuXHJcbiAgICBjb25zdCBzdGFja3NBY2NvcmRpb25Cb3hPcHRpb25zID0ge1xyXG4gICAgICBjb250ZW50U2l6ZTogb3B0aW9ucy5jb250ZW50U2l6ZSxcclxuICAgICAgbWluSWNvblNpemU6IG9wdGlvbnMubWluSWNvblNpemUsXHJcbiAgICAgIG1heFF1YW50aXR5OiBvcHRpb25zLnF1YW50aXR5UmFuZ2UubWF4LFxyXG4gICAgICBib3hZTWFyZ2luOiBvcHRpb25zLmJveFlNYXJnaW5cclxuICAgIH07XHJcblxyXG4gICAgLy8gJ0JlZm9yZSBSZWFjdGlvbicgYWNjb3JkaW9uIGJveCwgd2l0aCBzdGFja3Mgb2YgcmVhY3RhbnRzXHJcbiAgICBjb25zdCBiZWZvcmVBY2NvcmRpb25Cb3ggPSBuZXcgU3RhY2tzQWNjb3JkaW9uQm94KCByZWFjdGFudHMsIGJlZm9yZVhPZmZzZXRzLCBvcHRpb25zLmJlZm9yZVRpdGxlUHJvcGVydHksXHJcbiAgICAgIGJlZm9yZUV4cGFuZGVkUHJvcGVydHksIGNvbWJpbmVPcHRpb25zPFN0YWNrc0FjY29yZGlvbkJveE9wdGlvbnM+KCB7XHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdiZWZvcmVBY2NvcmRpb25Cb3gnIClcclxuICAgICAgfSwgc3RhY2tzQWNjb3JkaW9uQm94T3B0aW9ucyApICk7XHJcblxyXG4gICAgLy8gJ0FmdGVyIFJlYWN0aW9uJyBhY2NvcmRpb24gYm94LCB3aXRoIHN0YWNrcyBvZiBwcm9kdWN0cyBhbmQgbGVmdG92ZXJzXHJcbiAgICBjb25zdCBhZnRlckFjY29yZGlvbkJveCA9IG5ldyBTdGFja3NBY2NvcmRpb25Cb3goIFsgLi4ucHJvZHVjdHMsIC4uLmxlZnRvdmVycyBdLCBhZnRlclhPZmZzZXRzLCBvcHRpb25zLmFmdGVyVGl0bGVQcm9wZXJ0eSxcclxuICAgICAgYWZ0ZXJFeHBhbmRlZFByb3BlcnR5LCBjb21iaW5lT3B0aW9uczxTdGFja3NBY2NvcmRpb25Cb3hPcHRpb25zPigge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnYWZ0ZXJBY2NvcmRpb25Cb3gnIClcclxuICAgICAgfSwgc3RhY2tzQWNjb3JkaW9uQm94T3B0aW9ucyApICk7XHJcblxyXG4gICAgLy8gQXJyb3cgYmV0d2VlbiBib3hlc1xyXG4gICAgY29uc3QgcmlnaHRBcnJvd05vZGUgPSBuZXcgUmlnaHRBcnJvd05vZGUoIHtcclxuICAgICAgZmlsbDogUlBBTENvbG9ycy5TVEFUVVNfQkFSX0ZJTEwsXHJcbiAgICAgIHN0cm9rZTogbnVsbCxcclxuICAgICAgc2NhbGU6IDAuNzUsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncmlnaHRBcnJvd05vZGUnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBsYXlvdXQgb2YgYm94ZXMgYW5kIGFycm93XHJcbiAgICBjb25zdCBoQm94ID0gbmV3IEhCb3goIHtcclxuICAgICAgY2hpbGRyZW46IFsgYmVmb3JlQWNjb3JkaW9uQm94LCByaWdodEFycm93Tm9kZSwgYWZ0ZXJBY2NvcmRpb25Cb3ggXSxcclxuICAgICAgc3BhY2luZzogMTAsXHJcbiAgICAgIGV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHM6IGZhbHNlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gRXZlcnl0aGluZyBiZWxvdyB0aGUgYm94ZXNcclxuICAgIGNvbnN0IHF1YW50aXRpZXNOb2RlID0gbmV3IFF1YW50aXRpZXNOb2RlKCByZWFjdGFudHMsIHByb2R1Y3RzLCBsZWZ0b3ZlcnMsIGJlZm9yZVhPZmZzZXRzLCBhZnRlclhPZmZzZXRzLCB7XHJcbiAgICAgIHNob3dTeW1ib2xzOiBvcHRpb25zLnNob3dTeW1ib2xzLFxyXG4gICAgICBib3hXaWR0aDogb3B0aW9ucy5jb250ZW50U2l6ZS53aWR0aCxcclxuICAgICAgYWZ0ZXJCb3hYT2Zmc2V0OiBhZnRlckFjY29yZGlvbkJveC5sZWZ0IC0gYmVmb3JlQWNjb3JkaW9uQm94LmxlZnQsXHJcbiAgICAgIG1pbkljb25TaXplOiBvcHRpb25zLm1pbkljb25TaXplLFxyXG4gICAgICBxdWFudGl0eVJhbmdlOiBvcHRpb25zLnF1YW50aXR5UmFuZ2UsXHJcbiAgICAgIHg6IGJlZm9yZUFjY29yZGlvbkJveC54LFxyXG4gICAgICB0b3A6IGJlZm9yZUFjY29yZGlvbkJveC5ib3R0b20gKyA2LFxyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3F1YW50aXRpZXNOb2RlJyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgb3B0aW9ucy5jaGlsZHJlbiA9IFsgaEJveCwgcXVhbnRpdGllc05vZGUgXTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMuYWRkTGlua2VkRWxlbWVudCggcmVhY3Rpb24sIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oIHJlYWN0aW9uLnRhbmRlbS5uYW1lIClcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VCZWZvcmVBZnRlck5vZGUgPSAoKSA9PiB7XHJcbiAgICAgIGJlZm9yZUFjY29yZGlvbkJveC5kaXNwb3NlKCk7XHJcbiAgICAgIGFmdGVyQWNjb3JkaW9uQm94LmRpc3Bvc2UoKTtcclxuICAgICAgcmlnaHRBcnJvd05vZGUuZGlzcG9zZSgpO1xyXG4gICAgICBxdWFudGl0aWVzTm9kZS5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VCZWZvcmVBZnRlck5vZGUoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbnJlYWN0YW50c1Byb2R1Y3RzQW5kTGVmdG92ZXJzLnJlZ2lzdGVyKCAnUlBBTFNjZW5lTm9kZScsIFJQQUxTY2VuZU5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7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