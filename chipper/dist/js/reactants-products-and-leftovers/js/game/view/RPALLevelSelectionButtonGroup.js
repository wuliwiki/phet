// Copyright 2014-2023, University of Colorado Boulder

/**
 * RPALLevelSelectionButtonGroup is the group of level-selection buttons for the 'Game' screen.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import PatternStringProperty from '../../../../axon/js/PatternStringProperty.js';
import H2ONode from '../../../../nitroglycerin/js/nodes/H2ONode.js';
import HClNode from '../../../../nitroglycerin/js/nodes/HClNode.js';
import NH3Node from '../../../../nitroglycerin/js/nodes/NH3Node.js';
import ArrowNode from '../../../../scenery-phet/js/ArrowNode.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { AlignBox, AlignGroup, HBox, Text, VBox } from '../../../../scenery/js/imports.js';
import LevelSelectionButtonGroup from '../../../../vegas/js/LevelSelectionButtonGroup.js';
import ScoreDisplayStars from '../../../../vegas/js/ScoreDisplayStars.js';
import RPALConstants from '../../common/RPALConstants.js';
import reactantsProductsAndLeftovers from '../../reactantsProductsAndLeftovers.js';
import ReactantsProductsAndLeftoversStrings from '../../ReactantsProductsAndLeftoversStrings.js';
const MOLECULE_SCALE = 3; // scale of the molecule icons used on the level-selection buttons
const QUESTION_MARK_OPTIONS = {
  font: new PhetFont({
    size: 70,
    weight: 'bold'
  }),
  maxWidth: 100
};
export default class RPALLevelSelectionButtonGroup extends LevelSelectionButtonGroup {
  constructor(model, tandem) {
    // To make all button icons have the same effective size
    const iconAlignGroup = new AlignGroup();

    // Functions to create icons for the level-selection buttons, indexed by level.
    const buttonIconFunctions = [createLevel1ButtonIcon, createLevel2ButtonIcon, createLevel3ButtonIcon];
    assert && assert(buttonIconFunctions.length === model.numberOfLevels);

    // Description of LevelSelectionButtons
    const levelSelectionButtonGroupItems = [];
    for (let level = 0; level < model.numberOfLevels; level++) {
      const buttonTandemName = `level${level}Button`;
      levelSelectionButtonGroupItems.push({
        icon: buttonIconFunctions[level](iconAlignGroup),
        scoreProperty: model.bestScoreProperties[level],
        options: {
          bestTimeProperty: model.bestTimeProperties[level],
          createScoreDisplay: scoreProperty => new ScoreDisplayStars(scoreProperty, {
            numberOfStars: model.getNumberOfChallenges(level),
            perfectScore: model.getPerfectScore(level)
          }),
          listener: () => model.play(level),
          soundPlayerIndex: level
        },
        tandemName: buttonTandemName
      });
    }
    super(levelSelectionButtonGroupItems, {
      levelSelectionButtonOptions: {
        baseColor: 'rgb( 240, 255, 204 )',
        xMargin: 15,
        yMargin: 15,
        buttonWidth: 150,
        buttonHeight: 150,
        bestTimeVisibleProperty: model.timerEnabledProperty
      },
      flowBoxOptions: {
        spacing: 40
      },
      tandem: tandem
    });
  }
}

/*
 *  Level N
 *  leftNode -> rightNode
 */
function createButtonIcon(level, leftNode, rightNode, iconAlignGroup) {
  // Icon
  const arrowNode = new ArrowNode(0, 0, 50, 0, {
    headHeight: 20,
    headWidth: 20,
    tailWidth: 6
  });
  const icon = new AlignBox(new HBox({
    children: [leftNode, arrowNode, rightNode],
    spacing: 20
  }), {
    group: iconAlignGroup
  });

  // Text
  const stringProperty = new PatternStringProperty(ReactantsProductsAndLeftoversStrings.pattern_Level_0StringProperty, {
    level: level
  }, {
    formatNames: ['level'] // to map '{0}' to '{{level}}'
  });

  const text = new Text(stringProperty, {
    font: new PhetFont(45),
    maxWidth: icon.width
  });
  return new VBox({
    children: [text, icon],
    spacing: 30
  });
}

/**
 *  Level 1
 *  ? -> HCl
 */
function createLevel1ButtonIcon(iconAlignGroup) {
  const leftNode = new Text(ReactantsProductsAndLeftoversStrings.questionMarkStringProperty, QUESTION_MARK_OPTIONS);
  const rightNode = new HClNode(RPALConstants.MOLECULE_NODE_OPTIONS);
  rightNode.setScaleMagnitude(MOLECULE_SCALE);
  return createButtonIcon(1, leftNode, rightNode, iconAlignGroup);
}

/**
 *  Level 2
 *  H2O -> ?
 */
function createLevel2ButtonIcon(iconAlignGroup) {
  const leftNode = new H2ONode(RPALConstants.MOLECULE_NODE_OPTIONS);
  leftNode.setScaleMagnitude(MOLECULE_SCALE);
  const rightNode = new Text(ReactantsProductsAndLeftoversStrings.questionMarkStringProperty, QUESTION_MARK_OPTIONS);
  return createButtonIcon(2, leftNode, rightNode, iconAlignGroup);
}

/**
 *  Level 3
 *  NH3 -> ??
 */
function createLevel3ButtonIcon(iconAlignGroup) {
  const leftNode = new NH3Node(RPALConstants.MOLECULE_NODE_OPTIONS);
  leftNode.setScaleMagnitude(MOLECULE_SCALE);
  const rightNode = new Text(ReactantsProductsAndLeftoversStrings.doubleQuestionMarkStringProperty, QUESTION_MARK_OPTIONS);
  return createButtonIcon(3, leftNode, rightNode, iconAlignGroup);
}
reactantsProductsAndLeftovers.register('RPALLevelSelectionButtonGroup', RPALLevelSelectionButtonGroup);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJIMk9Ob2RlIiwiSENsTm9kZSIsIk5IM05vZGUiLCJBcnJvd05vZGUiLCJQaGV0Rm9udCIsIkFsaWduQm94IiwiQWxpZ25Hcm91cCIsIkhCb3giLCJUZXh0IiwiVkJveCIsIkxldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAiLCJTY29yZURpc3BsYXlTdGFycyIsIlJQQUxDb25zdGFudHMiLCJyZWFjdGFudHNQcm9kdWN0c0FuZExlZnRvdmVycyIsIlJlYWN0YW50c1Byb2R1Y3RzQW5kTGVmdG92ZXJzU3RyaW5ncyIsIk1PTEVDVUxFX1NDQUxFIiwiUVVFU1RJT05fTUFSS19PUFRJT05TIiwiZm9udCIsInNpemUiLCJ3ZWlnaHQiLCJtYXhXaWR0aCIsIlJQQUxMZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwIiwiY29uc3RydWN0b3IiLCJtb2RlbCIsInRhbmRlbSIsImljb25BbGlnbkdyb3VwIiwiYnV0dG9uSWNvbkZ1bmN0aW9ucyIsImNyZWF0ZUxldmVsMUJ1dHRvbkljb24iLCJjcmVhdGVMZXZlbDJCdXR0b25JY29uIiwiY3JlYXRlTGV2ZWwzQnV0dG9uSWNvbiIsImFzc2VydCIsImxlbmd0aCIsIm51bWJlck9mTGV2ZWxzIiwibGV2ZWxTZWxlY3Rpb25CdXR0b25Hcm91cEl0ZW1zIiwibGV2ZWwiLCJidXR0b25UYW5kZW1OYW1lIiwicHVzaCIsImljb24iLCJzY29yZVByb3BlcnR5IiwiYmVzdFNjb3JlUHJvcGVydGllcyIsIm9wdGlvbnMiLCJiZXN0VGltZVByb3BlcnR5IiwiYmVzdFRpbWVQcm9wZXJ0aWVzIiwiY3JlYXRlU2NvcmVEaXNwbGF5IiwibnVtYmVyT2ZTdGFycyIsImdldE51bWJlck9mQ2hhbGxlbmdlcyIsInBlcmZlY3RTY29yZSIsImdldFBlcmZlY3RTY29yZSIsImxpc3RlbmVyIiwicGxheSIsInNvdW5kUGxheWVySW5kZXgiLCJ0YW5kZW1OYW1lIiwibGV2ZWxTZWxlY3Rpb25CdXR0b25PcHRpb25zIiwiYmFzZUNvbG9yIiwieE1hcmdpbiIsInlNYXJnaW4iLCJidXR0b25XaWR0aCIsImJ1dHRvbkhlaWdodCIsImJlc3RUaW1lVmlzaWJsZVByb3BlcnR5IiwidGltZXJFbmFibGVkUHJvcGVydHkiLCJmbG93Qm94T3B0aW9ucyIsInNwYWNpbmciLCJjcmVhdGVCdXR0b25JY29uIiwibGVmdE5vZGUiLCJyaWdodE5vZGUiLCJhcnJvd05vZGUiLCJoZWFkSGVpZ2h0IiwiaGVhZFdpZHRoIiwidGFpbFdpZHRoIiwiY2hpbGRyZW4iLCJncm91cCIsInN0cmluZ1Byb3BlcnR5IiwicGF0dGVybl9MZXZlbF8wU3RyaW5nUHJvcGVydHkiLCJmb3JtYXROYW1lcyIsInRleHQiLCJ3aWR0aCIsInF1ZXN0aW9uTWFya1N0cmluZ1Byb3BlcnR5IiwiTU9MRUNVTEVfTk9ERV9PUFRJT05TIiwic2V0U2NhbGVNYWduaXR1ZGUiLCJkb3VibGVRdWVzdGlvbk1hcmtTdHJpbmdQcm9wZXJ0eSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiUlBBTExldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTQtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogUlBBTExldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAgaXMgdGhlIGdyb3VwIG9mIGxldmVsLXNlbGVjdGlvbiBidXR0b25zIGZvciB0aGUgJ0dhbWUnIHNjcmVlbi5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgUGF0dGVyblN0cmluZ1Byb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUGF0dGVyblN0cmluZ1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgSDJPTm9kZSBmcm9tICcuLi8uLi8uLi8uLi9uaXRyb2dseWNlcmluL2pzL25vZGVzL0gyT05vZGUuanMnO1xyXG5pbXBvcnQgSENsTm9kZSBmcm9tICcuLi8uLi8uLi8uLi9uaXRyb2dseWNlcmluL2pzL25vZGVzL0hDbE5vZGUuanMnO1xyXG5pbXBvcnQgTkgzTm9kZSBmcm9tICcuLi8uLi8uLi8uLi9uaXRyb2dseWNlcmluL2pzL25vZGVzL05IM05vZGUuanMnO1xyXG5pbXBvcnQgQXJyb3dOb2RlIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9BcnJvd05vZGUuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgQWxpZ25Cb3gsIEFsaWduR3JvdXAsIEhCb3gsIE5vZGUsIFRleHQsIFRleHRPcHRpb25zLCBWQm94IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IExldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAsIHsgTGV2ZWxTZWxlY3Rpb25CdXR0b25Hcm91cEl0ZW0gfSBmcm9tICcuLi8uLi8uLi8uLi92ZWdhcy9qcy9MZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwLmpzJztcclxuaW1wb3J0IFNjb3JlRGlzcGxheVN0YXJzIGZyb20gJy4uLy4uLy4uLy4uL3ZlZ2FzL2pzL1Njb3JlRGlzcGxheVN0YXJzLmpzJztcclxuaW1wb3J0IFJQQUxDb25zdGFudHMgZnJvbSAnLi4vLi4vY29tbW9uL1JQQUxDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgcmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnMgZnJvbSAnLi4vLi4vcmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnMuanMnO1xyXG5pbXBvcnQgUmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnNTdHJpbmdzIGZyb20gJy4uLy4uL1JlYWN0YW50c1Byb2R1Y3RzQW5kTGVmdG92ZXJzU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBHYW1lTW9kZWwgZnJvbSAnLi4vbW9kZWwvR2FtZU1vZGVsLmpzJztcclxuXHJcbmNvbnN0IE1PTEVDVUxFX1NDQUxFID0gMzsgLy8gc2NhbGUgb2YgdGhlIG1vbGVjdWxlIGljb25zIHVzZWQgb24gdGhlIGxldmVsLXNlbGVjdGlvbiBidXR0b25zXHJcbmNvbnN0IFFVRVNUSU9OX01BUktfT1BUSU9OUzogVGV4dE9wdGlvbnMgPSB7XHJcbiAgZm9udDogbmV3IFBoZXRGb250KCB7IHNpemU6IDcwLCB3ZWlnaHQ6ICdib2xkJyB9ICksXHJcbiAgbWF4V2lkdGg6IDEwMFxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUlBBTExldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAgZXh0ZW5kcyBMZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwIHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBtb2RlbDogR2FtZU1vZGVsLCB0YW5kZW06IFRhbmRlbSApIHtcclxuXHJcbiAgICAvLyBUbyBtYWtlIGFsbCBidXR0b24gaWNvbnMgaGF2ZSB0aGUgc2FtZSBlZmZlY3RpdmUgc2l6ZVxyXG4gICAgY29uc3QgaWNvbkFsaWduR3JvdXAgPSBuZXcgQWxpZ25Hcm91cCgpO1xyXG5cclxuICAgIC8vIEZ1bmN0aW9ucyB0byBjcmVhdGUgaWNvbnMgZm9yIHRoZSBsZXZlbC1zZWxlY3Rpb24gYnV0dG9ucywgaW5kZXhlZCBieSBsZXZlbC5cclxuICAgIGNvbnN0IGJ1dHRvbkljb25GdW5jdGlvbnMgPSBbIGNyZWF0ZUxldmVsMUJ1dHRvbkljb24sIGNyZWF0ZUxldmVsMkJ1dHRvbkljb24sIGNyZWF0ZUxldmVsM0J1dHRvbkljb24gXTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGJ1dHRvbkljb25GdW5jdGlvbnMubGVuZ3RoID09PSBtb2RlbC5udW1iZXJPZkxldmVscyApO1xyXG5cclxuICAgIC8vIERlc2NyaXB0aW9uIG9mIExldmVsU2VsZWN0aW9uQnV0dG9uc1xyXG4gICAgY29uc3QgbGV2ZWxTZWxlY3Rpb25CdXR0b25Hcm91cEl0ZW1zOiBMZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwSXRlbVtdID0gW107XHJcbiAgICBmb3IgKCBsZXQgbGV2ZWwgPSAwOyBsZXZlbCA8IG1vZGVsLm51bWJlck9mTGV2ZWxzOyBsZXZlbCsrICkge1xyXG4gICAgICBjb25zdCBidXR0b25UYW5kZW1OYW1lID0gYGxldmVsJHtsZXZlbH1CdXR0b25gO1xyXG4gICAgICBsZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwSXRlbXMucHVzaCgge1xyXG4gICAgICAgIGljb246IGJ1dHRvbkljb25GdW5jdGlvbnNbIGxldmVsIF0oIGljb25BbGlnbkdyb3VwICksXHJcbiAgICAgICAgc2NvcmVQcm9wZXJ0eTogbW9kZWwuYmVzdFNjb3JlUHJvcGVydGllc1sgbGV2ZWwgXSxcclxuICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICBiZXN0VGltZVByb3BlcnR5OiBtb2RlbC5iZXN0VGltZVByb3BlcnRpZXNbIGxldmVsIF0sXHJcbiAgICAgICAgICBjcmVhdGVTY29yZURpc3BsYXk6ICggc2NvcmVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyPiApID0+IG5ldyBTY29yZURpc3BsYXlTdGFycyggc2NvcmVQcm9wZXJ0eSwge1xyXG4gICAgICAgICAgICBudW1iZXJPZlN0YXJzOiBtb2RlbC5nZXROdW1iZXJPZkNoYWxsZW5nZXMoIGxldmVsICksXHJcbiAgICAgICAgICAgIHBlcmZlY3RTY29yZTogbW9kZWwuZ2V0UGVyZmVjdFNjb3JlKCBsZXZlbCApXHJcbiAgICAgICAgICB9ICksXHJcbiAgICAgICAgICBsaXN0ZW5lcjogKCkgPT4gbW9kZWwucGxheSggbGV2ZWwgKSxcclxuICAgICAgICAgIHNvdW5kUGxheWVySW5kZXg6IGxldmVsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0YW5kZW1OYW1lOiBidXR0b25UYW5kZW1OYW1lXHJcbiAgICAgIH0gKTtcclxuICAgIH1cclxuXHJcbiAgICBzdXBlciggbGV2ZWxTZWxlY3Rpb25CdXR0b25Hcm91cEl0ZW1zLCB7XHJcbiAgICAgIGxldmVsU2VsZWN0aW9uQnV0dG9uT3B0aW9uczoge1xyXG4gICAgICAgIGJhc2VDb2xvcjogJ3JnYiggMjQwLCAyNTUsIDIwNCApJyxcclxuICAgICAgICB4TWFyZ2luOiAxNSxcclxuICAgICAgICB5TWFyZ2luOiAxNSxcclxuICAgICAgICBidXR0b25XaWR0aDogMTUwLFxyXG4gICAgICAgIGJ1dHRvbkhlaWdodDogMTUwLFxyXG4gICAgICAgIGJlc3RUaW1lVmlzaWJsZVByb3BlcnR5OiBtb2RlbC50aW1lckVuYWJsZWRQcm9wZXJ0eVxyXG4gICAgICB9LFxyXG4gICAgICBmbG93Qm94T3B0aW9uczoge1xyXG4gICAgICAgIHNwYWNpbmc6IDQwXHJcbiAgICAgIH0sXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtXHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG4vKlxyXG4gKiAgTGV2ZWwgTlxyXG4gKiAgbGVmdE5vZGUgLT4gcmlnaHROb2RlXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVCdXR0b25JY29uKCBsZXZlbDogbnVtYmVyLCBsZWZ0Tm9kZTogTm9kZSwgcmlnaHROb2RlOiBOb2RlLCBpY29uQWxpZ25Hcm91cDogQWxpZ25Hcm91cCApOiBOb2RlIHtcclxuXHJcbiAgLy8gSWNvblxyXG4gIGNvbnN0IGFycm93Tm9kZSA9IG5ldyBBcnJvd05vZGUoIDAsIDAsIDUwLCAwLCB7XHJcbiAgICBoZWFkSGVpZ2h0OiAyMCxcclxuICAgIGhlYWRXaWR0aDogMjAsXHJcbiAgICB0YWlsV2lkdGg6IDZcclxuICB9ICk7XHJcbiAgY29uc3QgaWNvbiA9IG5ldyBBbGlnbkJveCggbmV3IEhCb3goIHtcclxuICAgIGNoaWxkcmVuOiBbIGxlZnROb2RlLCBhcnJvd05vZGUsIHJpZ2h0Tm9kZSBdLFxyXG4gICAgc3BhY2luZzogMjBcclxuICB9ICksIHtcclxuICAgIGdyb3VwOiBpY29uQWxpZ25Hcm91cFxyXG4gIH0gKTtcclxuXHJcbiAgLy8gVGV4dFxyXG4gIGNvbnN0IHN0cmluZ1Byb3BlcnR5ID0gbmV3IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSggUmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnNTdHJpbmdzLnBhdHRlcm5fTGV2ZWxfMFN0cmluZ1Byb3BlcnR5LCB7XHJcbiAgICBsZXZlbDogbGV2ZWxcclxuICB9LCB7XHJcbiAgICBmb3JtYXROYW1lczogWyAnbGV2ZWwnIF0gLy8gdG8gbWFwICd7MH0nIHRvICd7e2xldmVsfX0nXHJcbiAgfSApO1xyXG4gIGNvbnN0IHRleHQgPSBuZXcgVGV4dCggc3RyaW5nUHJvcGVydHksIHtcclxuICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggNDUgKSxcclxuICAgIG1heFdpZHRoOiBpY29uLndpZHRoXHJcbiAgfSApO1xyXG5cclxuICByZXR1cm4gbmV3IFZCb3goIHtcclxuICAgIGNoaWxkcmVuOiBbIHRleHQsIGljb24gXSxcclxuICAgIHNwYWNpbmc6IDMwXHJcbiAgfSApO1xyXG59XHJcblxyXG4vKipcclxuICogIExldmVsIDFcclxuICogID8gLT4gSENsXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVMZXZlbDFCdXR0b25JY29uKCBpY29uQWxpZ25Hcm91cDogQWxpZ25Hcm91cCApOiBOb2RlIHtcclxuICBjb25zdCBsZWZ0Tm9kZSA9IG5ldyBUZXh0KCBSZWFjdGFudHNQcm9kdWN0c0FuZExlZnRvdmVyc1N0cmluZ3MucXVlc3Rpb25NYXJrU3RyaW5nUHJvcGVydHksIFFVRVNUSU9OX01BUktfT1BUSU9OUyApO1xyXG4gIGNvbnN0IHJpZ2h0Tm9kZSA9IG5ldyBIQ2xOb2RlKCBSUEFMQ29uc3RhbnRzLk1PTEVDVUxFX05PREVfT1BUSU9OUyApO1xyXG4gIHJpZ2h0Tm9kZS5zZXRTY2FsZU1hZ25pdHVkZSggTU9MRUNVTEVfU0NBTEUgKTtcclxuICByZXR1cm4gY3JlYXRlQnV0dG9uSWNvbiggMSwgbGVmdE5vZGUsIHJpZ2h0Tm9kZSwgaWNvbkFsaWduR3JvdXAgKTtcclxufVxyXG5cclxuLyoqXHJcbiAqICBMZXZlbCAyXHJcbiAqICBIMk8gLT4gP1xyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlTGV2ZWwyQnV0dG9uSWNvbiggaWNvbkFsaWduR3JvdXA6IEFsaWduR3JvdXAgKTogTm9kZSB7XHJcbiAgY29uc3QgbGVmdE5vZGUgPSBuZXcgSDJPTm9kZSggUlBBTENvbnN0YW50cy5NT0xFQ1VMRV9OT0RFX09QVElPTlMgKTtcclxuICBsZWZ0Tm9kZS5zZXRTY2FsZU1hZ25pdHVkZSggTU9MRUNVTEVfU0NBTEUgKTtcclxuICBjb25zdCByaWdodE5vZGUgPSBuZXcgVGV4dCggUmVhY3RhbnRzUHJvZHVjdHNBbmRMZWZ0b3ZlcnNTdHJpbmdzLnF1ZXN0aW9uTWFya1N0cmluZ1Byb3BlcnR5LCBRVUVTVElPTl9NQVJLX09QVElPTlMgKTtcclxuICByZXR1cm4gY3JlYXRlQnV0dG9uSWNvbiggMiwgbGVmdE5vZGUsIHJpZ2h0Tm9kZSwgaWNvbkFsaWduR3JvdXAgKTtcclxufVxyXG5cclxuLyoqXHJcbiAqICBMZXZlbCAzXHJcbiAqICBOSDMgLT4gPz9cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZUxldmVsM0J1dHRvbkljb24oIGljb25BbGlnbkdyb3VwOiBBbGlnbkdyb3VwICk6IE5vZGUge1xyXG4gIGNvbnN0IGxlZnROb2RlID0gbmV3IE5IM05vZGUoIFJQQUxDb25zdGFudHMuTU9MRUNVTEVfTk9ERV9PUFRJT05TICk7XHJcbiAgbGVmdE5vZGUuc2V0U2NhbGVNYWduaXR1ZGUoIE1PTEVDVUxFX1NDQUxFICk7XHJcbiAgY29uc3QgcmlnaHROb2RlID0gbmV3IFRleHQoIFJlYWN0YW50c1Byb2R1Y3RzQW5kTGVmdG92ZXJzU3RyaW5ncy5kb3VibGVRdWVzdGlvbk1hcmtTdHJpbmdQcm9wZXJ0eSwgUVVFU1RJT05fTUFSS19PUFRJT05TICk7XHJcbiAgcmV0dXJuIGNyZWF0ZUJ1dHRvbkljb24oIDMsIGxlZnROb2RlLCByaWdodE5vZGUsIGljb25BbGlnbkdyb3VwICk7XHJcbn1cclxuXHJcbnJlYWN0YW50c1Byb2R1Y3RzQW5kTGVmdG92ZXJzLnJlZ2lzdGVyKCAnUlBBTExldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAnLCBSUEFMTGV2ZWxTZWxlY3Rpb25CdXR0b25Hcm91cCApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxxQkFBcUIsTUFBTSw4Q0FBOEM7QUFFaEYsT0FBT0MsT0FBTyxNQUFNLCtDQUErQztBQUNuRSxPQUFPQyxPQUFPLE1BQU0sK0NBQStDO0FBQ25FLE9BQU9DLE9BQU8sTUFBTSwrQ0FBK0M7QUFDbkUsT0FBT0MsU0FBUyxNQUFNLDBDQUEwQztBQUNoRSxPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELFNBQVNDLFFBQVEsRUFBRUMsVUFBVSxFQUFFQyxJQUFJLEVBQVFDLElBQUksRUFBZUMsSUFBSSxRQUFRLG1DQUFtQztBQUU3RyxPQUFPQyx5QkFBeUIsTUFBeUMsbURBQW1EO0FBQzVILE9BQU9DLGlCQUFpQixNQUFNLDJDQUEyQztBQUN6RSxPQUFPQyxhQUFhLE1BQU0sK0JBQStCO0FBQ3pELE9BQU9DLDZCQUE2QixNQUFNLHdDQUF3QztBQUNsRixPQUFPQyxvQ0FBb0MsTUFBTSwrQ0FBK0M7QUFHaEcsTUFBTUMsY0FBYyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQzFCLE1BQU1DLHFCQUFrQyxHQUFHO0VBQ3pDQyxJQUFJLEVBQUUsSUFBSWIsUUFBUSxDQUFFO0lBQUVjLElBQUksRUFBRSxFQUFFO0lBQUVDLE1BQU0sRUFBRTtFQUFPLENBQUUsQ0FBQztFQUNsREMsUUFBUSxFQUFFO0FBQ1osQ0FBQztBQUVELGVBQWUsTUFBTUMsNkJBQTZCLFNBQVNYLHlCQUF5QixDQUFDO0VBRTVFWSxXQUFXQSxDQUFFQyxLQUFnQixF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