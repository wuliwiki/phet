// Copyright 2015-2023, University of Colorado Boulder

/**
 * MOTHAModel is the base class for the model in all screens.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import EnumerationProperty from '../../../../axon/js/EnumerationProperty.js';
import StringUnionProperty from '../../../../axon/js/StringUnionProperty.js';
import Property from '../../../../axon/js/Property.js';
import optionize from '../../../../phet-core/js/optionize.js';
import TimeSpeed from '../../../../scenery-phet/js/TimeSpeed.js';
import modelsOfTheHydrogenAtom from '../../modelsOfTheHydrogenAtom.js';
import Light from './Light.js';
import createObservableArray from '../../../../axon/js/createObservableArray.js';
import ExperimentModel from './ExperimentModel.js';
import { ModelModeValues } from './ModelMode.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import MOTHAQueryParameters from '../MOTHAQueryParameters.js';
const STEP_ONCE_NORMAL_DT = 0.1;
const NORMAL_SPEED_SCALE = MOTHAQueryParameters.timeScale[0];
const FAST_SPEED_SCALE = MOTHAQueryParameters.timeScale[1];
export default class MOTHAModel {
  // whether we're dealing with the experiment or a predictive hydrogen-atom model

  // the experiment hydrogen-atom model

  // the supported set of predictive hydrogen-atom models

  // the predictive hydrogen-atom model that is currently selected

  // the hydrogen-atom model that is currently selected: either the Experiment model, or the selected predictive model.

  // the zoomed-in part of the box of hydrogen

  // the light that is shining into the box of hydrogen

  // photons inside zoomedInBox

  // is the simulation playing?

  // speed that the simulation is running at

  // scale factor applied to dt, based on timeSpeedProperty

  /**
   * @param zoomedInBox - the zoomed-in part of the box of hydrogen, where animation takes place
   * @param predictiveModels
   * @param initialPredictiveModel
   * @param providedOptions
   */
  constructor(zoomedInBox, predictiveModels, initialPredictiveModel, providedOptions) {
    assert && assert(predictiveModels.includes(initialPredictiveModel));
    const options = optionize()({
      //TODO
    }, providedOptions);
    this.zoomedInBox = zoomedInBox;

    //TODO default should be 'experiment'
    this.modelModeProperty = new StringUnionProperty('prediction', {
      validValues: ModelModeValues,
      tandem: options.tandem.createTandem('modelModeProperty')
    });
    this.experimentModel = new ExperimentModel(zoomedInBox, {
      tandem: options.tandem.createTandem('experimentModel')
    });
    this.predictiveModels = predictiveModels;
    this.predictiveModelProperty = new Property(initialPredictiveModel, {
      validValues: predictiveModels
      //TODO tandem
      //TODO phetioType
    });

    this.hydrogenAtomProperty = new DerivedProperty([this.modelModeProperty, this.predictiveModelProperty], (modelMode, predictiveModel) => modelMode === 'experiment' ? this.experimentModel : predictiveModel, {
      //TODO tandem
      //TODO phetioType
    });
    this.light = new Light(zoomedInBox, {
      tandem: options.tandem.createTandem('light')
    });
    this.photons = createObservableArray({
      //TODO tandem
      //TODO phetioType
    });
    this.isPlayingProperty = new BooleanProperty(true, {
      tandem: options.tandem.createTandem('isPlayingProperty')
    });
    this.timeSpeedProperty = new EnumerationProperty(TimeSpeed.NORMAL, {
      tandem: options.tandem.createTandem('timeSpeedProperty')
    });
    this.dtScaleProperty = new DerivedProperty([this.timeSpeedProperty], timeSpeed => timeSpeed === TimeSpeed.NORMAL ? NORMAL_SPEED_SCALE : FAST_SPEED_SCALE);
    this.hydrogenAtomProperty.link((hydrogenAtom, oldHydrogenAtom) => {
      if (oldHydrogenAtom !== null) {
        oldHydrogenAtom.reset();
      }
      this.photons.clear();
      hydrogenAtom.photonEmittedEmitter.addListener(this.photonEmittedListener.bind(this));
      hydrogenAtom.photonAbsorbedEmitter.addListener(this.photonAbsorbedListener.bind(this));
    });
    this.light.photonCreatedEmitter.addListener(photon => {
      this.photons.add(photon);
    });
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
  }
  reset() {
    this.modelModeProperty.reset();
    this.experimentModel.reset();
    this.predictiveModels.forEach(predictiveModel => predictiveModel.reset());
    this.predictiveModelProperty.reset();
    this.light.reset();
    while (this.photons.length > 0) {
      this.photons.pop().dispose();
    }
    this.isPlayingProperty.reset();
    this.timeSpeedProperty.reset();
  }

  /**
   * Steps the model if it's playing.
   * @param dt - the time step, in seconds
   */
  step(dt) {
    if (this.isPlayingProperty.value) {
      this._step(dt);
    }
  }

  /**
   * Steps the model by one time step. Used by the Step button in the time controls.
   */
  stepOnce() {
    assert && assert(!this.isPlayingProperty.value);
    this._step(STEP_ONCE_NORMAL_DT);
  }

  /**
   * Steps the model, scaled by the setting of the time controls.
   * @param dt - the time step, in seconds
   */
  _step(dt) {
    const dtScaled = dt * this.dtScaleProperty.value;
    this.light.step(dtScaled);
    this.hydrogenAtomProperty.value.step(dtScaled);
    this.moveAndCullPhotons(dtScaled);
  }

  /**
   * Moves photons. Photons that move outside the zoomed-in box are culled.
   * @param dt - the time step, in seconds
   */
  moveAndCullPhotons(dt) {
    const hydrogenAtom = this.hydrogenAtomProperty.value;

    // Move and cull photons. May change this.photons, so operate on a copy of the array.
    this.photons.getArrayCopy().forEach(photon => {
      hydrogenAtom.movePhoton(photon, dt);

      // If the photon leaves the zoomed-in box, cull it.
      if (!this.zoomedInBox.containsPhoton(photon)) {
        photon.dispose();
        this.photons.remove(photon);
      }
    });
  }
  photonEmittedListener(photon) {
    this.photons.add(photon);
  }
  photonAbsorbedListener(photon) {
    this.photons.remove(photon);
  }
}
modelsOfTheHydrogenAtom.register('MOTHAModel', MOTHAModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJFbnVtZXJhdGlvblByb3BlcnR5IiwiU3RyaW5nVW5pb25Qcm9wZXJ0eSIsIlByb3BlcnR5Iiwib3B0aW9uaXplIiwiVGltZVNwZWVkIiwibW9kZWxzT2ZUaGVIeWRyb2dlbkF0b20iLCJMaWdodCIsImNyZWF0ZU9ic2VydmFibGVBcnJheSIsIkV4cGVyaW1lbnRNb2RlbCIsIk1vZGVsTW9kZVZhbHVlcyIsIkRlcml2ZWRQcm9wZXJ0eSIsIk1PVEhBUXVlcnlQYXJhbWV0ZXJzIiwiU1RFUF9PTkNFX05PUk1BTF9EVCIsIk5PUk1BTF9TUEVFRF9TQ0FMRSIsInRpbWVTY2FsZSIsIkZBU1RfU1BFRURfU0NBTEUiLCJNT1RIQU1vZGVsIiwiY29uc3RydWN0b3IiLCJ6b29tZWRJbkJveCIsInByZWRpY3RpdmVNb2RlbHMiLCJpbml0aWFsUHJlZGljdGl2ZU1vZGVsIiwicHJvdmlkZWRPcHRpb25zIiwiYXNzZXJ0IiwiaW5jbHVkZXMiLCJvcHRpb25zIiwibW9kZWxNb2RlUHJvcGVydHkiLCJ2YWxpZFZhbHVlcyIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsImV4cGVyaW1lbnRNb2RlbCIsInByZWRpY3RpdmVNb2RlbFByb3BlcnR5IiwiaHlkcm9nZW5BdG9tUHJvcGVydHkiLCJtb2RlbE1vZGUiLCJwcmVkaWN0aXZlTW9kZWwiLCJsaWdodCIsInBob3RvbnMiLCJpc1BsYXlpbmdQcm9wZXJ0eSIsInRpbWVTcGVlZFByb3BlcnR5IiwiTk9STUFMIiwiZHRTY2FsZVByb3BlcnR5IiwidGltZVNwZWVkIiwibGluayIsImh5ZHJvZ2VuQXRvbSIsIm9sZEh5ZHJvZ2VuQXRvbSIsInJlc2V0IiwiY2xlYXIiLCJwaG90b25FbWl0dGVkRW1pdHRlciIsImFkZExpc3RlbmVyIiwicGhvdG9uRW1pdHRlZExpc3RlbmVyIiwiYmluZCIsInBob3RvbkFic29yYmVkRW1pdHRlciIsInBob3RvbkFic29yYmVkTGlzdGVuZXIiLCJwaG90b25DcmVhdGVkRW1pdHRlciIsInBob3RvbiIsImFkZCIsImRpc3Bvc2UiLCJmb3JFYWNoIiwibGVuZ3RoIiwicG9wIiwic3RlcCIsImR0IiwidmFsdWUiLCJfc3RlcCIsInN0ZXBPbmNlIiwiZHRTY2FsZWQiLCJtb3ZlQW5kQ3VsbFBob3RvbnMiLCJnZXRBcnJheUNvcHkiLCJtb3ZlUGhvdG9uIiwiY29udGFpbnNQaG90b24iLCJyZW1vdmUiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIk1PVEhBTW9kZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTUtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogTU9USEFNb2RlbCBpcyB0aGUgYmFzZSBjbGFzcyBmb3IgdGhlIG1vZGVsIGluIGFsbCBzY3JlZW5zLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBCb29sZWFuUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Cb29sZWFuUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRW51bWVyYXRpb25Qcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0VudW1lcmF0aW9uUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgU3RyaW5nVW5pb25Qcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1N0cmluZ1VuaW9uUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgVGltZVNwZWVkIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9UaW1lU3BlZWQuanMnO1xyXG5pbXBvcnQgeyBQaGV0aW9PYmplY3RPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1BoZXRpb09iamVjdC5qcyc7XHJcbmltcG9ydCBtb2RlbHNPZlRoZUh5ZHJvZ2VuQXRvbSBmcm9tICcuLi8uLi9tb2RlbHNPZlRoZUh5ZHJvZ2VuQXRvbS5qcyc7XHJcbmltcG9ydCBMaWdodCBmcm9tICcuL0xpZ2h0LmpzJztcclxuaW1wb3J0IEh5ZHJvZ2VuQXRvbSBmcm9tICcuL0h5ZHJvZ2VuQXRvbS5qcyc7XHJcbmltcG9ydCBab29tZWRJbkJveCBmcm9tICcuL1pvb21lZEluQm94LmpzJztcclxuaW1wb3J0IFBob3RvbiBmcm9tICcuL1Bob3Rvbi5qcyc7XHJcbmltcG9ydCBjcmVhdGVPYnNlcnZhYmxlQXJyYXksIHsgT2JzZXJ2YWJsZUFycmF5IH0gZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9jcmVhdGVPYnNlcnZhYmxlQXJyYXkuanMnO1xyXG5pbXBvcnQgRXhwZXJpbWVudE1vZGVsIGZyb20gJy4vRXhwZXJpbWVudE1vZGVsLmpzJztcclxuaW1wb3J0IHsgTW9kZWxNb2RlLCBNb2RlbE1vZGVWYWx1ZXMgfSBmcm9tICcuL01vZGVsTW9kZS5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBNT1RIQVF1ZXJ5UGFyYW1ldGVycyBmcm9tICcuLi9NT1RIQVF1ZXJ5UGFyYW1ldGVycy5qcyc7XHJcbmltcG9ydCBUTW9kZWwgZnJvbSAnLi4vLi4vLi4vLi4vam9pc3QvanMvVE1vZGVsLmpzJztcclxuXHJcbmNvbnN0IFNURVBfT05DRV9OT1JNQUxfRFQgPSAwLjE7XHJcbmNvbnN0IE5PUk1BTF9TUEVFRF9TQ0FMRSA9IE1PVEhBUXVlcnlQYXJhbWV0ZXJzLnRpbWVTY2FsZVsgMCBdO1xyXG5jb25zdCBGQVNUX1NQRUVEX1NDQUxFID0gTU9USEFRdWVyeVBhcmFtZXRlcnMudGltZVNjYWxlWyAxIF07XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0gRW1wdHlTZWxmT3B0aW9ucztcclxuXHJcbmV4cG9ydCB0eXBlIE1PVEhBTW9kZWxPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBQaWNrUmVxdWlyZWQ8UGhldGlvT2JqZWN0T3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTU9USEFNb2RlbCBpbXBsZW1lbnRzIFRNb2RlbCB7XHJcblxyXG4gIC8vIHdoZXRoZXIgd2UncmUgZGVhbGluZyB3aXRoIHRoZSBleHBlcmltZW50IG9yIGEgcHJlZGljdGl2ZSBoeWRyb2dlbi1hdG9tIG1vZGVsXHJcbiAgcHVibGljIHJlYWRvbmx5IG1vZGVsTW9kZVByb3BlcnR5OiBQcm9wZXJ0eTxNb2RlbE1vZGU+O1xyXG5cclxuICAvLyB0aGUgZXhwZXJpbWVudCBoeWRyb2dlbi1hdG9tIG1vZGVsXHJcbiAgcHVibGljIHJlYWRvbmx5IGV4cGVyaW1lbnRNb2RlbDogRXhwZXJpbWVudE1vZGVsO1xyXG5cclxuICAvLyB0aGUgc3VwcG9ydGVkIHNldCBvZiBwcmVkaWN0aXZlIGh5ZHJvZ2VuLWF0b20gbW9kZWxzXHJcbiAgcHVibGljIHJlYWRvbmx5IHByZWRpY3RpdmVNb2RlbHM6IEh5ZHJvZ2VuQXRvbVtdO1xyXG5cclxuICAvLyB0aGUgcHJlZGljdGl2ZSBoeWRyb2dlbi1hdG9tIG1vZGVsIHRoYXQgaXMgY3VycmVudGx5IHNlbGVjdGVkXHJcbiAgcHVibGljIHJlYWRvbmx5IHByZWRpY3RpdmVNb2RlbFByb3BlcnR5OiBQcm9wZXJ0eTxIeWRyb2dlbkF0b20+O1xyXG5cclxuICAvLyB0aGUgaHlkcm9nZW4tYXRvbSBtb2RlbCB0aGF0IGlzIGN1cnJlbnRseSBzZWxlY3RlZDogZWl0aGVyIHRoZSBFeHBlcmltZW50IG1vZGVsLCBvciB0aGUgc2VsZWN0ZWQgcHJlZGljdGl2ZSBtb2RlbC5cclxuICBwdWJsaWMgcmVhZG9ubHkgaHlkcm9nZW5BdG9tUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PEh5ZHJvZ2VuQXRvbT47XHJcblxyXG4gIC8vIHRoZSB6b29tZWQtaW4gcGFydCBvZiB0aGUgYm94IG9mIGh5ZHJvZ2VuXHJcbiAgcHVibGljIHJlYWRvbmx5IHpvb21lZEluQm94OiBab29tZWRJbkJveDtcclxuXHJcbiAgLy8gdGhlIGxpZ2h0IHRoYXQgaXMgc2hpbmluZyBpbnRvIHRoZSBib3ggb2YgaHlkcm9nZW5cclxuICBwdWJsaWMgcmVhZG9ubHkgbGlnaHQ6IExpZ2h0O1xyXG5cclxuICAvLyBwaG90b25zIGluc2lkZSB6b29tZWRJbkJveFxyXG4gIHB1YmxpYyByZWFkb25seSBwaG90b25zOiBPYnNlcnZhYmxlQXJyYXk8UGhvdG9uPjtcclxuXHJcbiAgLy8gaXMgdGhlIHNpbXVsYXRpb24gcGxheWluZz9cclxuICBwdWJsaWMgcmVhZG9ubHkgaXNQbGF5aW5nUHJvcGVydHk6IFByb3BlcnR5PGJvb2xlYW4+O1xyXG5cclxuICAvLyBzcGVlZCB0aGF0IHRoZSBzaW11bGF0aW9uIGlzIHJ1bm5pbmcgYXRcclxuICBwdWJsaWMgcmVhZG9ubHkgdGltZVNwZWVkUHJvcGVydHk6IEVudW1lcmF0aW9uUHJvcGVydHk8VGltZVNwZWVkPjtcclxuXHJcbiAgLy8gc2NhbGUgZmFjdG9yIGFwcGxpZWQgdG8gZHQsIGJhc2VkIG9uIHRpbWVTcGVlZFByb3BlcnR5XHJcbiAgcHJpdmF0ZSByZWFkb25seSBkdFNjYWxlUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB6b29tZWRJbkJveCAtIHRoZSB6b29tZWQtaW4gcGFydCBvZiB0aGUgYm94IG9mIGh5ZHJvZ2VuLCB3aGVyZSBhbmltYXRpb24gdGFrZXMgcGxhY2VcclxuICAgKiBAcGFyYW0gcHJlZGljdGl2ZU1vZGVsc1xyXG4gICAqIEBwYXJhbSBpbml0aWFsUHJlZGljdGl2ZU1vZGVsXHJcbiAgICogQHBhcmFtIHByb3ZpZGVkT3B0aW9uc1xyXG4gICAqL1xyXG4gIHByb3RlY3RlZCBjb25zdHJ1Y3Rvciggem9vbWVkSW5Cb3g6IFpvb21lZEluQm94LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgcHJlZGljdGl2ZU1vZGVsczogSHlkcm9nZW5BdG9tW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsUHJlZGljdGl2ZU1vZGVsOiBIeWRyb2dlbkF0b20sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM6IE1PVEhBTW9kZWxPcHRpb25zICkge1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHByZWRpY3RpdmVNb2RlbHMuaW5jbHVkZXMoIGluaXRpYWxQcmVkaWN0aXZlTW9kZWwgKSApO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8TU9USEFNb2RlbE9wdGlvbnMsIFNlbGZPcHRpb25zPigpKCB7XHJcbiAgICAgIC8vVE9ET1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy56b29tZWRJbkJveCA9IHpvb21lZEluQm94O1xyXG5cclxuICAgIC8vVE9ETyBkZWZhdWx0IHNob3VsZCBiZSAnZXhwZXJpbWVudCdcclxuICAgIHRoaXMubW9kZWxNb2RlUHJvcGVydHkgPSBuZXcgU3RyaW5nVW5pb25Qcm9wZXJ0eSggJ3ByZWRpY3Rpb24nLCB7XHJcbiAgICAgIHZhbGlkVmFsdWVzOiBNb2RlbE1vZGVWYWx1ZXMsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnbW9kZWxNb2RlUHJvcGVydHknIClcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmV4cGVyaW1lbnRNb2RlbCA9IG5ldyBFeHBlcmltZW50TW9kZWwoIHpvb21lZEluQm94LCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZXhwZXJpbWVudE1vZGVsJyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5wcmVkaWN0aXZlTW9kZWxzID0gcHJlZGljdGl2ZU1vZGVscztcclxuXHJcbiAgICB0aGlzLnByZWRpY3RpdmVNb2RlbFByb3BlcnR5ID0gbmV3IFByb3BlcnR5PEh5ZHJvZ2VuQXRvbT4oIGluaXRpYWxQcmVkaWN0aXZlTW9kZWwsIHtcclxuICAgICAgdmFsaWRWYWx1ZXM6IHByZWRpY3RpdmVNb2RlbHNcclxuICAgICAgLy9UT0RPIHRhbmRlbVxyXG4gICAgICAvL1RPRE8gcGhldGlvVHlwZVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuaHlkcm9nZW5BdG9tUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICBbIHRoaXMubW9kZWxNb2RlUHJvcGVydHksIHRoaXMucHJlZGljdGl2ZU1vZGVsUHJvcGVydHkgXSxcclxuICAgICAgKCBtb2RlbE1vZGUsIHByZWRpY3RpdmVNb2RlbCApID0+ICggbW9kZWxNb2RlID09PSAnZXhwZXJpbWVudCcgKSA/IHRoaXMuZXhwZXJpbWVudE1vZGVsIDogcHJlZGljdGl2ZU1vZGVsLCB7XHJcbiAgICAgICAgLy9UT0RPIHRhbmRlbVxyXG4gICAgICAgIC8vVE9ETyBwaGV0aW9UeXBlXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmxpZ2h0ID0gbmV3IExpZ2h0KCB6b29tZWRJbkJveCwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2xpZ2h0JyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5waG90b25zID0gY3JlYXRlT2JzZXJ2YWJsZUFycmF5PFBob3Rvbj4oIHtcclxuICAgICAgLy9UT0RPIHRhbmRlbVxyXG4gICAgICAvL1RPRE8gcGhldGlvVHlwZVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuaXNQbGF5aW5nUHJvcGVydHkgPSBuZXcgQm9vbGVhblByb3BlcnR5KCB0cnVlLCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnaXNQbGF5aW5nUHJvcGVydHknIClcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLnRpbWVTcGVlZFByb3BlcnR5ID0gbmV3IEVudW1lcmF0aW9uUHJvcGVydHkoIFRpbWVTcGVlZC5OT1JNQUwsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICd0aW1lU3BlZWRQcm9wZXJ0eScgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuZHRTY2FsZVByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyB0aGlzLnRpbWVTcGVlZFByb3BlcnR5IF0sXHJcbiAgICAgIHRpbWVTcGVlZCA9PiAoIHRpbWVTcGVlZCA9PT0gVGltZVNwZWVkLk5PUk1BTCApID8gTk9STUFMX1NQRUVEX1NDQUxFIDogRkFTVF9TUEVFRF9TQ0FMRVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLmh5ZHJvZ2VuQXRvbVByb3BlcnR5LmxpbmsoICggaHlkcm9nZW5BdG9tLCBvbGRIeWRyb2dlbkF0b20gKSA9PiB7XHJcbiAgICAgIGlmICggb2xkSHlkcm9nZW5BdG9tICE9PSBudWxsICkge1xyXG4gICAgICAgIG9sZEh5ZHJvZ2VuQXRvbS5yZXNldCgpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMucGhvdG9ucy5jbGVhcigpO1xyXG4gICAgICBoeWRyb2dlbkF0b20ucGhvdG9uRW1pdHRlZEVtaXR0ZXIuYWRkTGlzdGVuZXIoIHRoaXMucGhvdG9uRW1pdHRlZExpc3RlbmVyLmJpbmQoIHRoaXMgKSApO1xyXG4gICAgICBoeWRyb2dlbkF0b20ucGhvdG9uQWJzb3JiZWRFbWl0dGVyLmFkZExpc3RlbmVyKCB0aGlzLnBob3RvbkFic29yYmVkTGlzdGVuZXIuYmluZCggdGhpcyApICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5saWdodC5waG90b25DcmVhdGVkRW1pdHRlci5hZGRMaXN0ZW5lciggcGhvdG9uID0+IHtcclxuICAgICAgdGhpcy5waG90b25zLmFkZCggcGhvdG9uICk7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5tb2RlbE1vZGVQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5leHBlcmltZW50TW9kZWwucmVzZXQoKTtcclxuICAgIHRoaXMucHJlZGljdGl2ZU1vZGVscy5mb3JFYWNoKCBwcmVkaWN0aXZlTW9kZWwgPT4gcHJlZGljdGl2ZU1vZGVsLnJlc2V0KCkgKTtcclxuICAgIHRoaXMucHJlZGljdGl2ZU1vZGVsUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMubGlnaHQucmVzZXQoKTtcclxuICAgIHdoaWxlICggdGhpcy5waG90b25zLmxlbmd0aCA+IDAgKSB7XHJcbiAgICAgIHRoaXMucGhvdG9ucy5wb3AoKSEuZGlzcG9zZSgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5pc1BsYXlpbmdQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy50aW1lU3BlZWRQcm9wZXJ0eS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RlcHMgdGhlIG1vZGVsIGlmIGl0J3MgcGxheWluZy5cclxuICAgKiBAcGFyYW0gZHQgLSB0aGUgdGltZSBzdGVwLCBpbiBzZWNvbmRzXHJcbiAgICovXHJcbiAgcHVibGljIHN0ZXAoIGR0OiBudW1iZXIgKTogdm9pZCB7XHJcbiAgICBpZiAoIHRoaXMuaXNQbGF5aW5nUHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgIHRoaXMuX3N0ZXAoIGR0ICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdGVwcyB0aGUgbW9kZWwgYnkgb25lIHRpbWUgc3RlcC4gVXNlZCBieSB0aGUgU3RlcCBidXR0b24gaW4gdGhlIHRpbWUgY29udHJvbHMuXHJcbiAgICovXHJcbiAgcHVibGljIHN0ZXBPbmNlKCk6IHZvaWQge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggIXRoaXMuaXNQbGF5aW5nUHJvcGVydHkudmFsdWUgKTtcclxuICAgIHRoaXMuX3N0ZXAoIFNURVBfT05DRV9OT1JNQUxfRFQgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0ZXBzIHRoZSBtb2RlbCwgc2NhbGVkIGJ5IHRoZSBzZXR0aW5nIG9mIHRoZSB0aW1lIGNvbnRyb2xzLlxyXG4gICAqIEBwYXJhbSBkdCAtIHRoZSB0aW1lIHN0ZXAsIGluIHNlY29uZHNcclxuICAgKi9cclxuICBwcml2YXRlIF9zdGVwKCBkdDogbnVtYmVyICk6IHZvaWQge1xyXG4gICAgY29uc3QgZHRTY2FsZWQgPSBkdCAqIHRoaXMuZHRTY2FsZVByb3BlcnR5LnZhbHVlO1xyXG4gICAgdGhpcy5saWdodC5zdGVwKCBkdFNjYWxlZCApO1xyXG4gICAgdGhpcy5oeWRyb2dlbkF0b21Qcm9wZXJ0eS52YWx1ZS5zdGVwKCBkdFNjYWxlZCApO1xyXG4gICAgdGhpcy5tb3ZlQW5kQ3VsbFBob3RvbnMoIGR0U2NhbGVkICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNb3ZlcyBwaG90b25zLiBQaG90b25zIHRoYXQgbW92ZSBvdXRzaWRlIHRoZSB6b29tZWQtaW4gYm94IGFyZSBjdWxsZWQuXHJcbiAgICogQHBhcmFtIGR0IC0gdGhlIHRpbWUgc3RlcCwgaW4gc2Vjb25kc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgbW92ZUFuZEN1bGxQaG90b25zKCBkdDogbnVtYmVyICk6IHZvaWQge1xyXG5cclxuICAgIGNvbnN0IGh5ZHJvZ2VuQXRvbSA9IHRoaXMuaHlkcm9nZW5BdG9tUHJvcGVydHkudmFsdWU7XHJcblxyXG4gICAgLy8gTW92ZSBhbmQgY3VsbCBwaG90b25zLiBNYXkgY2hhbmdlIHRoaXMucGhvdG9ucywgc28gb3BlcmF0ZSBvbiBhIGNvcHkgb2YgdGhlIGFycmF5LlxyXG4gICAgdGhpcy5waG90b25zLmdldEFycmF5Q29weSgpLmZvckVhY2goIHBob3RvbiA9PiB7XHJcbiAgICAgIGh5ZHJvZ2VuQXRvbS5tb3ZlUGhvdG9uKCBwaG90b24sIGR0ICk7XHJcblxyXG4gICAgICAvLyBJZiB0aGUgcGhvdG9uIGxlYXZlcyB0aGUgem9vbWVkLWluIGJveCwgY3VsbCBpdC5cclxuICAgICAgaWYgKCAhdGhpcy56b29tZWRJbkJveC5jb250YWluc1Bob3RvbiggcGhvdG9uICkgKSB7XHJcbiAgICAgICAgcGhvdG9uLmRpc3Bvc2UoKTtcclxuICAgICAgICB0aGlzLnBob3RvbnMucmVtb3ZlKCBwaG90b24gKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBwaG90b25FbWl0dGVkTGlzdGVuZXIoIHBob3RvbjogUGhvdG9uICk6IHZvaWQge1xyXG4gICAgdGhpcy5waG90b25zLmFkZCggcGhvdG9uICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBob3RvbkFic29yYmVkTGlzdGVuZXIoIHBob3RvbjogUGhvdG9uICk6IHZvaWQge1xyXG4gICAgdGhpcy5waG90b25zLnJlbW92ZSggcGhvdG9uICk7XHJcbiAgfVxyXG59XHJcblxyXG5tb2RlbHNPZlRoZUh5ZHJvZ2VuQXRvbS5yZWdpc3RlciggJ01PVEhBTW9kZWwnLCBNT1RIQU1vZGVsICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsbUJBQW1CLE1BQU0sNENB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