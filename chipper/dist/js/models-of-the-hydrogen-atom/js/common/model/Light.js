// Copyright 2015-2022, University of Colorado Boulder

/**
 * Light is the model of a light that shines into the box of hydrogen.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Emitter from '../../../../axon/js/Emitter.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Property from '../../../../axon/js/Property.js';
import dotRandom from '../../../../dot/js/dotRandom.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import optionize from '../../../../phet-core/js/optionize.js';
import VisibleColor from '../../../../scenery-phet/js/VisibleColor.js';
import { Color } from '../../../../scenery/js/imports.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import StringIO from '../../../../tandem/js/types/StringIO.js';
import modelsOfTheHydrogenAtom from '../../modelsOfTheHydrogenAtom.js';
import BohrModel from './BohrModel.js';
import { LightModeValues } from './LightMode.js';
import Photon from './Photon.js';
import MOTHAConstants from '../MOTHAConstants.js';
import Tandem from '../../../../tandem/js/Tandem.js';
// probability that a "white light" photon's wavelength will be one that causes a state transition. 1.0 = 100%
const TRANSITION_WAVELENGTHS_WEIGHT = 0.40;
assert && assert(TRANSITION_WAVELENGTHS_WEIGHT >= 0 && TRANSITION_WAVELENGTHS_WEIGHT <= 1);

// Maximum number of photons in the zoomed-in box
const MAX_PHOTONS = 20;
export default class Light {
  // is the light on?

  // whether the light is full spectrum (white) or monochromatic

  // wavelength for monochromatic mode, in nm

  // wavelength of the light, where 0 is white light

  // color displayed by the view

  // emits when a photon is created

  // time between creation of photons

  // elapsed time since a photon was created

  // wavelengths that cause a state transition

  constructor(zoomedInBox, providedOptions) {
    const options = optionize()({
      //TODO
    }, providedOptions);
    this.zoomedInBox = zoomedInBox;
    this.onProperty = new BooleanProperty(false, {
      tandem: options.tandem.createTandem('onProperty')
    });
    this.lightModeProperty = new Property('white', {
      validValues: LightModeValues,
      tandem: options.tandem.createTandem('lightModeProperty'),
      phetioValueType: StringIO
    });

    // Range goes from UV to max visible wavelength
    this.monochromaticWavelengthRange = MOTHAConstants.MONOCHROMATIC_WAVELENGTH_RANGE;
    assert && assert(this.monochromaticWavelengthRange.min < VisibleColor.MIN_WAVELENGTH);
    this.monochromaticWavelengthProperty = new NumberProperty(VisibleColor.MIN_WAVELENGTH, {
      range: this.monochromaticWavelengthRange,
      tandem: options.tandem.createTandem('monochromaticWavelengthProperty')
    });
    this.wavelengthProperty = new DerivedProperty([this.lightModeProperty, this.monochromaticWavelengthProperty], (lightMode, monochromaticWavelength) => lightMode === 'white' ? VisibleColor.WHITE_WAVELENGTH : monochromaticWavelength, {
      tandem: options.tandem.createTandem('wavelengthProperty'),
      phetioValueType: NumberIO
    });
    this.colorProperty = new DerivedProperty([this.lightModeProperty, this.wavelengthProperty], (lightMode, wavelength) => VisibleColor.wavelengthToColor(wavelength), {
      tandem: options.tandem.createTandem('colorProperty'),
      phetioValueType: Color.ColorIO
    });
    this.photonCreatedEmitter = new Emitter({
      parameters: [{
        valueType: Photon
      }]
    });
    this.dtPerPhotonCreated = zoomedInBox.height / MOTHAConstants.PHOTON_INITIAL_SPEED / MAX_PHOTONS;
    this.dtSincePhotonCreatedProperty = new NumberProperty(0, {
      tandem: options.tandem.createTandem('dtSincePhotonCreatedProperty'),
      phetioReadOnly: true
    });

    // Get transition wavelengths for state 1, which are all UV.
    this.transitionWavelengths = BohrModel.getTransitionWavelengths(this.monochromaticWavelengthRange.min, VisibleColor.MIN_WAVELENGTH);
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
  }
  reset() {
    this.onProperty.reset();
    this.lightModeProperty.reset();
    this.monochromaticWavelengthProperty.reset();
    this.dtSincePhotonCreatedProperty.reset();
  }

  /**
   * Steps the light, and creates a photon when it's time to do so.
   * @param dt - the time step, in seconds
   */
  step(dt) {
    if (this.onProperty.value) {
      this.dtSincePhotonCreatedProperty.value += dt;
      if (this.dtSincePhotonCreatedProperty.value >= this.dtPerPhotonCreated) {
        // Save the remainder.
        this.dtSincePhotonCreatedProperty.value = this.dtSincePhotonCreatedProperty.value % this.dtPerPhotonCreated;

        // Create a photon.
        this.createPhoton();
      }
    }
  }

  /**
   * Creates a photon when it's time to do so, at a random location along the bottom edge of the zoomed-in box.
   */
  createPhoton() {
    this.photonCreatedEmitter.emit(new Photon({
      wavelength: this.getNextPhotonWavelength(),
      position: this.getNextPhotonPosition(),
      direction: Math.PI / 2,
      // in the direction of +y
      tandem: Tandem.OPT_OUT //TODO create via PhetioGroup
    }));
  }

  /**
   * Creates a photon at the bottom-center of the zoomed-in box. This is used when we want to ensure that a
   * photon hits the atom, which is centered in the zoomed-in box.
   */
  createPhotonAtCenter(wavelength) {
    this.photonCreatedEmitter.emit(new Photon({
      wavelength: wavelength,
      position: new Vector2(this.zoomedInBox.centerX, this.zoomedInBox.minY),
      direction: Math.PI / 2,
      // in the direction of +y
      tandem: Tandem.OPT_OUT //TODO create via PhetioGroup
    }));
  }

  /**
   * Gets the next random position for a photon, along the bottom edge of the zoomed-in box.
   */
  getNextPhotonPosition() {
    const x = dotRandom.nextDoubleBetween(this.zoomedInBox.minX, this.zoomedInBox.maxX);
    const y = this.zoomedInBox.minY;
    return new Vector2(x, y);
  }

  /**
   * Gets a wavelength that would be appropriate for a new photon.
   *
   * For monochromatic light, we simply use the value of the gun's monochromatic wavelength.
   *
   * For white light, the wavelength is randomly chosen. Instead of simply picking a wavelength from the light's
   * entire range, we give a higher weight to those wavelengths that would cause a transition from state 1 to some
   * other state. We consider only the wavelengths relevant to state=1 because all other transitions are very
   * improbable in practice. This increases the probability that our photon will interact with the atom.
   */
  getNextPhotonWavelength() {
    let wavelength = this.monochromaticWavelengthProperty.value;
    if (this.lightModeProperty.value === 'white') {
      if (dotRandom.nextDouble() < TRANSITION_WAVELENGTHS_WEIGHT) {
        // choose a random transition wavelength
        const i = dotRandom.nextIntBetween(0, this.transitionWavelengths.length - 1);
        wavelength = this.transitionWavelengths[i];
      } else {
        // choose a random visible wavelength
        wavelength = dotRandom.nextDoubleBetween(this.monochromaticWavelengthRange.min, this.monochromaticWavelengthRange.max);
      }
    }
    return wavelength;
  }
}
modelsOfTheHydrogenAtom.register('Light', Light);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJEZXJpdmVkUHJvcGVydHkiLCJFbWl0dGVyIiwiTnVtYmVyUHJvcGVydHkiLCJQcm9wZXJ0eSIsImRvdFJhbmRvbSIsIlZlY3RvcjIiLCJvcHRpb25pemUiLCJWaXNpYmxlQ29sb3IiLCJDb2xvciIsIk51bWJlcklPIiwiU3RyaW5nSU8iLCJtb2RlbHNPZlRoZUh5ZHJvZ2VuQXRvbSIsIkJvaHJNb2RlbCIsIkxpZ2h0TW9kZVZhbHVlcyIsIlBob3RvbiIsIk1PVEhBQ29uc3RhbnRzIiwiVGFuZGVtIiwiVFJBTlNJVElPTl9XQVZFTEVOR1RIU19XRUlHSFQiLCJhc3NlcnQiLCJNQVhfUEhPVE9OUyIsIkxpZ2h0IiwiY29uc3RydWN0b3IiLCJ6b29tZWRJbkJveCIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJvblByb3BlcnR5IiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwibGlnaHRNb2RlUHJvcGVydHkiLCJ2YWxpZFZhbHVlcyIsInBoZXRpb1ZhbHVlVHlwZSIsIm1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoUmFuZ2UiLCJNT05PQ0hST01BVElDX1dBVkVMRU5HVEhfUkFOR0UiLCJtaW4iLCJNSU5fV0FWRUxFTkdUSCIsIm1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoUHJvcGVydHkiLCJyYW5nZSIsIndhdmVsZW5ndGhQcm9wZXJ0eSIsImxpZ2h0TW9kZSIsIm1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoIiwiV0hJVEVfV0FWRUxFTkdUSCIsImNvbG9yUHJvcGVydHkiLCJ3YXZlbGVuZ3RoIiwid2F2ZWxlbmd0aFRvQ29sb3IiLCJDb2xvcklPIiwicGhvdG9uQ3JlYXRlZEVtaXR0ZXIiLCJwYXJhbWV0ZXJzIiwidmFsdWVUeXBlIiwiZHRQZXJQaG90b25DcmVhdGVkIiwiaGVpZ2h0IiwiUEhPVE9OX0lOSVRJQUxfU1BFRUQiLCJkdFNpbmNlUGhvdG9uQ3JlYXRlZFByb3BlcnR5IiwicGhldGlvUmVhZE9ubHkiLCJ0cmFuc2l0aW9uV2F2ZWxlbmd0aHMiLCJnZXRUcmFuc2l0aW9uV2F2ZWxlbmd0aHMiLCJkaXNwb3NlIiwicmVzZXQiLCJzdGVwIiwiZHQiLCJ2YWx1ZSIsImNyZWF0ZVBob3RvbiIsImVtaXQiLCJnZXROZXh0UGhvdG9uV2F2ZWxlbmd0aCIsInBvc2l0aW9uIiwiZ2V0TmV4dFBob3RvblBvc2l0aW9uIiwiZGlyZWN0aW9uIiwiTWF0aCIsIlBJIiwiT1BUX09VVCIsImNyZWF0ZVBob3RvbkF0Q2VudGVyIiwiY2VudGVyWCIsIm1pblkiLCJ4IiwibmV4dERvdWJsZUJldHdlZW4iLCJtaW5YIiwibWF4WCIsInkiLCJuZXh0RG91YmxlIiwiaSIsIm5leHRJbnRCZXR3ZWVuIiwibGVuZ3RoIiwibWF4IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJMaWdodC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNS0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBMaWdodCBpcyB0aGUgbW9kZWwgb2YgYSBsaWdodCB0aGF0IHNoaW5lcyBpbnRvIHRoZSBib3ggb2YgaHlkcm9nZW4uXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IEJvb2xlYW5Qcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Jvb2xlYW5Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRW1pdHRlciBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0VtaXR0ZXIuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBOdW1iZXJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL051bWJlclByb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgZG90UmFuZG9tIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9kb3RSYW5kb20uanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFBpY2tSZXF1aXJlZCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja1JlcXVpcmVkLmpzJztcclxuaW1wb3J0IFZpc2libGVDb2xvciBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvVmlzaWJsZUNvbG9yLmpzJztcclxuaW1wb3J0IHsgQ29sb3IgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgeyBQaGV0aW9PYmplY3RPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1BoZXRpb09iamVjdC5qcyc7XHJcbmltcG9ydCBOdW1iZXJJTyBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvTnVtYmVySU8uanMnO1xyXG5pbXBvcnQgU3RyaW5nSU8gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL1N0cmluZ0lPLmpzJztcclxuaW1wb3J0IG1vZGVsc09mVGhlSHlkcm9nZW5BdG9tIGZyb20gJy4uLy4uL21vZGVsc09mVGhlSHlkcm9nZW5BdG9tLmpzJztcclxuaW1wb3J0IEJvaHJNb2RlbCBmcm9tICcuL0JvaHJNb2RlbC5qcyc7XHJcbmltcG9ydCB7IExpZ2h0TW9kZSwgTGlnaHRNb2RlVmFsdWVzIH0gZnJvbSAnLi9MaWdodE1vZGUuanMnO1xyXG5pbXBvcnQgUGhvdG9uIGZyb20gJy4vUGhvdG9uLmpzJztcclxuaW1wb3J0IFpvb21lZEluQm94IGZyb20gJy4vWm9vbWVkSW5Cb3guanMnO1xyXG5pbXBvcnQgTU9USEFDb25zdGFudHMgZnJvbSAnLi4vTU9USEFDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgVEVtaXR0ZXIgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9URW1pdHRlci5qcyc7XHJcblxyXG4vLyBwcm9iYWJpbGl0eSB0aGF0IGEgXCJ3aGl0ZSBsaWdodFwiIHBob3RvbidzIHdhdmVsZW5ndGggd2lsbCBiZSBvbmUgdGhhdCBjYXVzZXMgYSBzdGF0ZSB0cmFuc2l0aW9uLiAxLjAgPSAxMDAlXHJcbmNvbnN0IFRSQU5TSVRJT05fV0FWRUxFTkdUSFNfV0VJR0hUID0gMC40MDtcclxuYXNzZXJ0ICYmIGFzc2VydCggVFJBTlNJVElPTl9XQVZFTEVOR1RIU19XRUlHSFQgPj0gMCAmJiBUUkFOU0lUSU9OX1dBVkVMRU5HVEhTX1dFSUdIVCA8PSAxICk7XHJcblxyXG4vLyBNYXhpbXVtIG51bWJlciBvZiBwaG90b25zIGluIHRoZSB6b29tZWQtaW4gYm94XHJcbmNvbnN0IE1BWF9QSE9UT05TID0gMjA7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0gRW1wdHlTZWxmT3B0aW9ucztcclxuXHJcbnR5cGUgTGlnaHRPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBQaWNrUmVxdWlyZWQ8UGhldGlvT2JqZWN0T3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGlnaHQge1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IHpvb21lZEluQm94OiBab29tZWRJbkJveDtcclxuXHJcbiAgLy8gaXMgdGhlIGxpZ2h0IG9uP1xyXG4gIHB1YmxpYyByZWFkb25seSBvblByb3BlcnR5OiBCb29sZWFuUHJvcGVydHk7XHJcblxyXG4gIC8vIHdoZXRoZXIgdGhlIGxpZ2h0IGlzIGZ1bGwgc3BlY3RydW0gKHdoaXRlKSBvciBtb25vY2hyb21hdGljXHJcbiAgcHVibGljIHJlYWRvbmx5IGxpZ2h0TW9kZVByb3BlcnR5OiBQcm9wZXJ0eTxMaWdodE1vZGU+O1xyXG5cclxuICAvLyB3YXZlbGVuZ3RoIGZvciBtb25vY2hyb21hdGljIG1vZGUsIGluIG5tXHJcbiAgcHVibGljIHJlYWRvbmx5IG1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoUmFuZ2U6IFJhbmdlO1xyXG4gIHB1YmxpYyByZWFkb25seSBtb25vY2hyb21hdGljV2F2ZWxlbmd0aFByb3BlcnR5OiBOdW1iZXJQcm9wZXJ0eTtcclxuXHJcbiAgLy8gd2F2ZWxlbmd0aCBvZiB0aGUgbGlnaHQsIHdoZXJlIDAgaXMgd2hpdGUgbGlnaHRcclxuICBwdWJsaWMgcmVhZG9ubHkgd2F2ZWxlbmd0aFByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+O1xyXG5cclxuICAvLyBjb2xvciBkaXNwbGF5ZWQgYnkgdGhlIHZpZXdcclxuICBwdWJsaWMgcmVhZG9ubHkgY29sb3JQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Q29sb3IgfCBzdHJpbmc+O1xyXG5cclxuICAvLyBlbWl0cyB3aGVuIGEgcGhvdG9uIGlzIGNyZWF0ZWRcclxuICBwdWJsaWMgcmVhZG9ubHkgcGhvdG9uQ3JlYXRlZEVtaXR0ZXI6IFRFbWl0dGVyPFsgUGhvdG9uIF0+O1xyXG5cclxuICAvLyB0aW1lIGJldHdlZW4gY3JlYXRpb24gb2YgcGhvdG9uc1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZHRQZXJQaG90b25DcmVhdGVkOiBudW1iZXI7XHJcblxyXG4gIC8vIGVsYXBzZWQgdGltZSBzaW5jZSBhIHBob3RvbiB3YXMgY3JlYXRlZFxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZHRTaW5jZVBob3RvbkNyZWF0ZWRQcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyPjtcclxuXHJcbiAgLy8gd2F2ZWxlbmd0aHMgdGhhdCBjYXVzZSBhIHN0YXRlIHRyYW5zaXRpb25cclxuICBwcml2YXRlIHJlYWRvbmx5IHRyYW5zaXRpb25XYXZlbGVuZ3RoczogbnVtYmVyW107XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggem9vbWVkSW5Cb3g6IFpvb21lZEluQm94LCBwcm92aWRlZE9wdGlvbnM6IExpZ2h0T3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPExpZ2h0T3B0aW9ucywgU2VsZk9wdGlvbnM+KCkoIHtcclxuICAgICAgLy9UT0RPXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLnpvb21lZEluQm94ID0gem9vbWVkSW5Cb3g7XHJcblxyXG4gICAgdGhpcy5vblByb3BlcnR5ID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdvblByb3BlcnR5JyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5saWdodE1vZGVQcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eTxMaWdodE1vZGU+KCAnd2hpdGUnLCB7XHJcbiAgICAgIHZhbGlkVmFsdWVzOiBMaWdodE1vZGVWYWx1ZXMsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnbGlnaHRNb2RlUHJvcGVydHknICksXHJcbiAgICAgIHBoZXRpb1ZhbHVlVHlwZTogU3RyaW5nSU9cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBSYW5nZSBnb2VzIGZyb20gVVYgdG8gbWF4IHZpc2libGUgd2F2ZWxlbmd0aFxyXG4gICAgdGhpcy5tb25vY2hyb21hdGljV2F2ZWxlbmd0aFJhbmdlID0gTU9USEFDb25zdGFudHMuTU9OT0NIUk9NQVRJQ19XQVZFTEVOR1RIX1JBTkdFO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5tb25vY2hyb21hdGljV2F2ZWxlbmd0aFJhbmdlLm1pbiA8IFZpc2libGVDb2xvci5NSU5fV0FWRUxFTkdUSCApO1xyXG5cclxuICAgIHRoaXMubW9ub2Nocm9tYXRpY1dhdmVsZW5ndGhQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggVmlzaWJsZUNvbG9yLk1JTl9XQVZFTEVOR1RILCB7XHJcbiAgICAgIHJhbmdlOiB0aGlzLm1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoUmFuZ2UsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnbW9ub2Nocm9tYXRpY1dhdmVsZW5ndGhQcm9wZXJ0eScgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMud2F2ZWxlbmd0aFByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyB0aGlzLmxpZ2h0TW9kZVByb3BlcnR5LCB0aGlzLm1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoUHJvcGVydHkgXSxcclxuICAgICAgKCBsaWdodE1vZGUsIG1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoICkgPT5cclxuICAgICAgICAoIGxpZ2h0TW9kZSA9PT0gJ3doaXRlJyApID8gVmlzaWJsZUNvbG9yLldISVRFX1dBVkVMRU5HVEggOiBtb25vY2hyb21hdGljV2F2ZWxlbmd0aCwge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnd2F2ZWxlbmd0aFByb3BlcnR5JyApLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVtYmVySU9cclxuICAgICAgfSApO1xyXG5cclxuICAgIHRoaXMuY29sb3JQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5saWdodE1vZGVQcm9wZXJ0eSwgdGhpcy53YXZlbGVuZ3RoUHJvcGVydHkgXSxcclxuICAgICAgKCBsaWdodE1vZGUsIHdhdmVsZW5ndGggKSA9PiBWaXNpYmxlQ29sb3Iud2F2ZWxlbmd0aFRvQ29sb3IoIHdhdmVsZW5ndGggKSwge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnY29sb3JQcm9wZXJ0eScgKSxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IENvbG9yLkNvbG9ySU9cclxuICAgICAgfSApO1xyXG5cclxuICAgIHRoaXMucGhvdG9uQ3JlYXRlZEVtaXR0ZXIgPSBuZXcgRW1pdHRlcjxbIFBob3RvbiBdPigge1xyXG4gICAgICBwYXJhbWV0ZXJzOiBbIHsgdmFsdWVUeXBlOiBQaG90b24gfSBdXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5kdFBlclBob3RvbkNyZWF0ZWQgPSAoIHpvb21lZEluQm94LmhlaWdodCAvIE1PVEhBQ29uc3RhbnRzLlBIT1RPTl9JTklUSUFMX1NQRUVEICkgLyBNQVhfUEhPVE9OUztcclxuXHJcbiAgICB0aGlzLmR0U2luY2VQaG90b25DcmVhdGVkUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIDAsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdkdFNpbmNlUGhvdG9uQ3JlYXRlZFByb3BlcnR5JyApLFxyXG4gICAgICBwaGV0aW9SZWFkT25seTogdHJ1ZVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEdldCB0cmFuc2l0aW9uIHdhdmVsZW5ndGhzIGZvciBzdGF0ZSAxLCB3aGljaCBhcmUgYWxsIFVWLlxyXG4gICAgdGhpcy50cmFuc2l0aW9uV2F2ZWxlbmd0aHMgPVxyXG4gICAgICBCb2hyTW9kZWwuZ2V0VHJhbnNpdGlvbldhdmVsZW5ndGhzKCB0aGlzLm1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoUmFuZ2UubWluLCBWaXNpYmxlQ29sb3IuTUlOX1dBVkVMRU5HVEggKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggZmFsc2UsICdkaXNwb3NlIGlzIG5vdCBzdXBwb3J0ZWQsIGV4aXN0cyBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBzaW0nICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcmVzZXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLm9uUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMubGlnaHRNb2RlUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMubW9ub2Nocm9tYXRpY1dhdmVsZW5ndGhQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5kdFNpbmNlUGhvdG9uQ3JlYXRlZFByb3BlcnR5LnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdGVwcyB0aGUgbGlnaHQsIGFuZCBjcmVhdGVzIGEgcGhvdG9uIHdoZW4gaXQncyB0aW1lIHRvIGRvIHNvLlxyXG4gICAqIEBwYXJhbSBkdCAtIHRoZSB0aW1lIHN0ZXAsIGluIHNlY29uZHNcclxuICAgKi9cclxuICBwdWJsaWMgc3RlcCggZHQ6IG51bWJlciApOiB2b2lkIHtcclxuICAgIGlmICggdGhpcy5vblByb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICB0aGlzLmR0U2luY2VQaG90b25DcmVhdGVkUHJvcGVydHkudmFsdWUgKz0gZHQ7XHJcbiAgICAgIGlmICggdGhpcy5kdFNpbmNlUGhvdG9uQ3JlYXRlZFByb3BlcnR5LnZhbHVlID49IHRoaXMuZHRQZXJQaG90b25DcmVhdGVkICkge1xyXG5cclxuICAgICAgICAvLyBTYXZlIHRoZSByZW1haW5kZXIuXHJcbiAgICAgICAgdGhpcy5kdFNpbmNlUGhvdG9uQ3JlYXRlZFByb3BlcnR5LnZhbHVlID0gdGhpcy5kdFNpbmNlUGhvdG9uQ3JlYXRlZFByb3BlcnR5LnZhbHVlICUgdGhpcy5kdFBlclBob3RvbkNyZWF0ZWQ7XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBhIHBob3Rvbi5cclxuICAgICAgICB0aGlzLmNyZWF0ZVBob3RvbigpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIGEgcGhvdG9uIHdoZW4gaXQncyB0aW1lIHRvIGRvIHNvLCBhdCBhIHJhbmRvbSBsb2NhdGlvbiBhbG9uZyB0aGUgYm90dG9tIGVkZ2Ugb2YgdGhlIHpvb21lZC1pbiBib3guXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjcmVhdGVQaG90b24oKTogdm9pZCB7XHJcbiAgICB0aGlzLnBob3RvbkNyZWF0ZWRFbWl0dGVyLmVtaXQoIG5ldyBQaG90b24oIHtcclxuICAgICAgd2F2ZWxlbmd0aDogdGhpcy5nZXROZXh0UGhvdG9uV2F2ZWxlbmd0aCgpLFxyXG4gICAgICBwb3NpdGlvbjogdGhpcy5nZXROZXh0UGhvdG9uUG9zaXRpb24oKSxcclxuICAgICAgZGlyZWN0aW9uOiBNYXRoLlBJIC8gMiwgLy8gaW4gdGhlIGRpcmVjdGlvbiBvZiAreVxyXG4gICAgICB0YW5kZW06IFRhbmRlbS5PUFRfT1VUIC8vVE9ETyBjcmVhdGUgdmlhIFBoZXRpb0dyb3VwXHJcbiAgICB9ICkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBwaG90b24gYXQgdGhlIGJvdHRvbS1jZW50ZXIgb2YgdGhlIHpvb21lZC1pbiBib3guIFRoaXMgaXMgdXNlZCB3aGVuIHdlIHdhbnQgdG8gZW5zdXJlIHRoYXQgYVxyXG4gICAqIHBob3RvbiBoaXRzIHRoZSBhdG9tLCB3aGljaCBpcyBjZW50ZXJlZCBpbiB0aGUgem9vbWVkLWluIGJveC5cclxuICAgKi9cclxuICBwdWJsaWMgY3JlYXRlUGhvdG9uQXRDZW50ZXIoIHdhdmVsZW5ndGg6IG51bWJlciApOiB2b2lkIHtcclxuICAgIHRoaXMucGhvdG9uQ3JlYXRlZEVtaXR0ZXIuZW1pdCggbmV3IFBob3Rvbigge1xyXG4gICAgICB3YXZlbGVuZ3RoOiB3YXZlbGVuZ3RoLFxyXG4gICAgICBwb3NpdGlvbjogbmV3IFZlY3RvcjIoIHRoaXMuem9vbWVkSW5Cb3guY2VudGVyWCwgdGhpcy56b29tZWRJbkJveC5taW5ZICksXHJcbiAgICAgIGRpcmVjdGlvbjogTWF0aC5QSSAvIDIsIC8vIGluIHRoZSBkaXJlY3Rpb24gb2YgK3lcclxuICAgICAgdGFuZGVtOiBUYW5kZW0uT1BUX09VVCAvL1RPRE8gY3JlYXRlIHZpYSBQaGV0aW9Hcm91cFxyXG4gICAgfSApICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXRzIHRoZSBuZXh0IHJhbmRvbSBwb3NpdGlvbiBmb3IgYSBwaG90b24sIGFsb25nIHRoZSBib3R0b20gZWRnZSBvZiB0aGUgem9vbWVkLWluIGJveC5cclxuICAgKi9cclxuICBwcml2YXRlIGdldE5leHRQaG90b25Qb3NpdGlvbigpOiBWZWN0b3IyIHtcclxuICAgIGNvbnN0IHggPSBkb3RSYW5kb20ubmV4dERvdWJsZUJldHdlZW4oIHRoaXMuem9vbWVkSW5Cb3gubWluWCwgdGhpcy56b29tZWRJbkJveC5tYXhYICk7XHJcbiAgICBjb25zdCB5ID0gdGhpcy56b29tZWRJbkJveC5taW5ZO1xyXG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKCB4LCB5ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXRzIGEgd2F2ZWxlbmd0aCB0aGF0IHdvdWxkIGJlIGFwcHJvcHJpYXRlIGZvciBhIG5ldyBwaG90b24uXHJcbiAgICpcclxuICAgKiBGb3IgbW9ub2Nocm9tYXRpYyBsaWdodCwgd2Ugc2ltcGx5IHVzZSB0aGUgdmFsdWUgb2YgdGhlIGd1bidzIG1vbm9jaHJvbWF0aWMgd2F2ZWxlbmd0aC5cclxuICAgKlxyXG4gICAqIEZvciB3aGl0ZSBsaWdodCwgdGhlIHdhdmVsZW5ndGggaXMgcmFuZG9tbHkgY2hvc2VuLiBJbnN0ZWFkIG9mIHNpbXBseSBwaWNraW5nIGEgd2F2ZWxlbmd0aCBmcm9tIHRoZSBsaWdodCdzXHJcbiAgICogZW50aXJlIHJhbmdlLCB3ZSBnaXZlIGEgaGlnaGVyIHdlaWdodCB0byB0aG9zZSB3YXZlbGVuZ3RocyB0aGF0IHdvdWxkIGNhdXNlIGEgdHJhbnNpdGlvbiBmcm9tIHN0YXRlIDEgdG8gc29tZVxyXG4gICAqIG90aGVyIHN0YXRlLiBXZSBjb25zaWRlciBvbmx5IHRoZSB3YXZlbGVuZ3RocyByZWxldmFudCB0byBzdGF0ZT0xIGJlY2F1c2UgYWxsIG90aGVyIHRyYW5zaXRpb25zIGFyZSB2ZXJ5XHJcbiAgICogaW1wcm9iYWJsZSBpbiBwcmFjdGljZS4gVGhpcyBpbmNyZWFzZXMgdGhlIHByb2JhYmlsaXR5IHRoYXQgb3VyIHBob3RvbiB3aWxsIGludGVyYWN0IHdpdGggdGhlIGF0b20uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXROZXh0UGhvdG9uV2F2ZWxlbmd0aCgpOiBudW1iZXIge1xyXG5cclxuICAgIGxldCB3YXZlbGVuZ3RoID0gdGhpcy5tb25vY2hyb21hdGljV2F2ZWxlbmd0aFByb3BlcnR5LnZhbHVlO1xyXG5cclxuICAgIGlmICggdGhpcy5saWdodE1vZGVQcm9wZXJ0eS52YWx1ZSA9PT0gJ3doaXRlJyApIHtcclxuICAgICAgaWYgKCBkb3RSYW5kb20ubmV4dERvdWJsZSgpIDwgVFJBTlNJVElPTl9XQVZFTEVOR1RIU19XRUlHSFQgKSB7XHJcblxyXG4gICAgICAgIC8vIGNob29zZSBhIHJhbmRvbSB0cmFuc2l0aW9uIHdhdmVsZW5ndGhcclxuICAgICAgICBjb25zdCBpID0gZG90UmFuZG9tLm5leHRJbnRCZXR3ZWVuKCAwLCB0aGlzLnRyYW5zaXRpb25XYXZlbGVuZ3Rocy5sZW5ndGggLSAxICk7XHJcbiAgICAgICAgd2F2ZWxlbmd0aCA9IHRoaXMudHJhbnNpdGlvbldhdmVsZW5ndGhzWyBpIF07XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgIC8vIGNob29zZSBhIHJhbmRvbSB2aXNpYmxlIHdhdmVsZW5ndGhcclxuICAgICAgICB3YXZlbGVuZ3RoID0gZG90UmFuZG9tLm5leHREb3VibGVCZXR3ZWVuKCB0aGlzLm1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoUmFuZ2UubWluLCB0aGlzLm1vbm9jaHJvbWF0aWNXYXZlbGVuZ3RoUmFuZ2UubWF4ICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB3YXZlbGVuZ3RoO1xyXG4gIH1cclxufVxyXG5cclxubW9kZWxzT2ZUaGVIeWRyb2dlbkF0b20ucmVnaXN0ZXIoICdMaWdodCcsIExpZ2h0ICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxPQUFPLE1BQU0sZ0NBQWdDO0FBRXBELE9BQU9DLGNBQWMsTUFBTSx1Q0FBdUM7QUFDbEUsT0FBT0MsUUFBUSxNQUFNLGlDQUFpQztBQUN0RCxPQUFPQyxTQUFTLE1BQU0saUNBQWlDO0FBRXZELE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsT0FBT0MsU0FBUyxNQUE0Qix1Q0FBdUM7QUFFbkYsT0FBT0MsWUFBWSxNQUFNLDZDQUE2QztBQUN0RSxTQUFTQyxLQUFLLFFBQVEsbUNBQW1DO0FBRXpELE9BQU9DLFFBQVEsTUFBTSx5Q0FBeUM7QUFDOUQsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxPQUFPQyx1QkFBdUIsTUFBTSxrQ0FBa0M7QUFDdEUsT0FBT0MsU0FBUyxNQUFNLGdCQUFnQjtBQUN0QyxTQUFvQkMsZUFBZSxRQUFRLGdCQUFnQjtBQUMzRCxPQUFPQyxNQUFNLE1BQU0sYUFBYTtBQUVoQyxPQUFPQyxjQUFjLE1BQU0sc0JBQXNCO0FBQ2pELE9BQU9DLE1BQU0sTUFBTSxpQ0FBaUM7QUFHcEQ7QUFDQSxNQUFNQyw2QkFBNkIsR0FBRyxJQUFJO0FBQzFDQyxNQUFNLElBQUlBLE1BQU0sQ0FBRUQsNkJBQTZCLElBQUksQ0FBQyxJQUFJQSw2QkFBNkIsSUFBSSxDQUFFLENBQUM7O0FBRTVGO0FBQ0EsTUFBTUUsV0FBVyxHQUFHLEVBQUU7QUFNdEIsZUFBZSxNQUFNQyxLQUFLLENBQUM7RUFJekI7O0VBR0E7O0VBR0E7O0VBSUE7O0VBR0E7O0VBR0E7O0VBR0E7O0VBR0E7O0VBR0E7O0VBR09DLFdBQVdBLENBQUVDLFdBQXdCLEVBQUVDLGVBQTZCLEVBQUc7SUFFNUUsTUFBTUMsT0FBTyxHQUFHbEIsU0FBUyxDQUE0QixDQUFDLENBQUU7TUFDdEQ7SUFBQSxDQUNELEVBQUVpQixlQUFnQixDQUFDO0lBRXBCLElBQUksQ0FBQ0QsV0FBVyxHQUFHQSxXQUFXO0lBRTlCLElBQUksQ0FBQ0csVUFBVSxHQUFHLElBQUkxQixlQUFlLENBQUUsS0FBSyxFQUFFO01BQzVDMkIsTUFBTSxFQUFFRixPQUFPLENBQUNFLE1BQU0sQ0FBQ0MsWUFBWSxDQUFFLFlBQWE7SUFDcEQsQ0FBRSxDQUFDO0lBRUgsSUFBSSxDQUFDQyxpQkFBaUIsR0FBRyxJQUFJekIsUUFBUSxDQUFhLE9BQU8sRUFBRTtNQUN6RDBCLFdBQVcsRUFBRWhCLGVBQWU7TUFDNUJhLE1BQU0sRUFBRUYsT0FBTyxDQUFDRSxNQUFNLENBQUNDLFlBQVksQ0FBRSxtQkFBb0IsQ0FBQztNQUMxREcsZUFBZSxFQUFFcEI7SUFDbkIsQ0FBRSxDQUFDOztJQUVIO0lBQ0EsSUFBSSxDQUFDcUIsNEJBQTRCLEdBQUdoQixjQUFjLENBQUNpQiw4QkFBOEI7SUFDakZkLE1BQU0sSUFBSUEsTUFBTSxDQUFFLElBQUksQ0FBQ2EsNEJBQTRCLENBQUNFLEdBQUcsR0FBRzFCLFlBQVksQ0FBQzJCLGNBQWUsQ0FBQztJQUV2RixJQUFJLENBQUNDLCtCQUErQixHQUFHLElBQUlqQyxjQUFjLENBQUVLLFlBQVksQ0FBQzJCLGNBQWMsRUFBRTtNQUN0RkUsS0FBSyxFQUFFLElBQUksQ0FBQ0wsNEJBQTRCO01BQ3hDTCxNQUFNLEVBQUVGLE9BQU8sQ0FBQ0UsTUFBTSxDQUFDQyxZQUFZLENBQUUsaUNBQWtDO0lBQ3pFLENBQUUsQ0FBQztJQUVILElBQUksQ0FBQ1Usa0JBQWtCLEdBQUcsSUFBSXJDLGVBQWUsQ0FBRSxDQUFFLElBQUksQ0FBQzRCLGlCQUFpQixFQUFFLElBQUksQ0FBQ08sK0JBQStCLENBQUUsRUFDN0csQ0FBRUcsU0FBUyxFQUFFQyx1QkFBdUIsS0FDaENELFNBQVMsS0FBSyxPQUFPLEdBQUsvQixZQUFZLENBQUNpQyxnQkFBZ0IsR0FBR0QsdUJBQXVCLEVBQUU7TUFDckZiLE1BQU0sRUFBRUYsT0FBTyxDQUFDRSxNQUFNLENBQUNDLFlBQVksQ0FBRSxvQkFBcUIsQ0FBQztNQUMzREcsZUFBZSxFQUFFckI7SUFDbkIsQ0FBRSxDQUFDO0lBRUwsSUFBSSxDQUFDZ0MsYUFBYSxHQUFHLElBQUl6QyxlQUFlLENBQ3RDLENBQUUsSUFBSSxDQUFDNEIsaUJBQWlCLEVBQUUsSUFBSSxDQUFDUyxrQkFBa0IsQ0FBRSxFQUNuRCxDQUFFQyxTQUFTLEVBQUVJLFVBQVUsS0FBTW5DLFlBQVksQ0FBQ29DLGlCQUFpQixDQUFFRCxVQUFXLENBQUMsRUFBRTtNQUN6RWhCLE1BQU0sRUFBRUYsT0FBTyxDQUFDRSxNQUFNLENBQUNDLFlBQVksQ0FBRSxlQUFnQixDQUFDO01BQ3RERyxlQUFlLEVBQUV0QixLQUFLLENBQUNvQztJQUN6QixDQUFFLENBQUM7SUFFTCxJQUFJLENBQUNDLG9CQUFvQixHQUFHLElBQUk1QyxPQUFPLENBQWM7TUFDbkQ2QyxVQUFVLEVBQUUsQ0FBRTtRQUFFQyxTQUFTLEVBQUVqQztNQUFPLENBQUM7SUFDckMsQ0FBRSxDQUFDO0lBRUgsSUFBSSxDQUFDa0Msa0JBQWtCLEdBQUsxQixXQUFXLENBQUMyQixNQUFNLEdBQUdsQyxjQUFjLENBQUNtQyxvQkFBb0IsR0FBSy9CLFdBQVc7SUFFcEcsSUFBSSxDQUFDZ0MsNEJBQTRCLEdBQUcsSUFBSWpELGNBQWMsQ0FBRSxDQUFDLEVBQUU7TUFDekR3QixNQUFNLEVBQUVGLE9BQU8sQ0FBQ0UsTUFBTSxDQUFDQyxZQUFZLENBQUUsOEJBQStCLENBQUM7TUFDckV5QixjQUFjLEVBQUU7SUFDbEIsQ0FBRSxDQUFDOztJQUVIO0lBQ0EsSUFBSSxDQUFDQyxxQkFBcUIsR0FDeEJ6QyxTQUFTLENBQUMwQyx3QkFBd0IsQ0FBRSxJQUFJLENBQUN2Qiw0QkFBNEIsQ0FBQ0UsR0FBRyxFQUFFMUIsWUFBWSxDQUFDMkIsY0FBZSxDQUFDO0VBQzVHO0VBRU9xQixPQUFPQSxDQUFBLEVBQVM7SUFDckJyQyxNQUFNLElBQUlBLE1BQU0sQ0FBRSxLQUFLLEVBQUUsOERBQStELENBQUM7RUFDM0Y7RUFFT3NDLEtBQUtBLENBQUEsRUFBUztJQUNuQixJQUFJLENBQUMvQixVQUFVLENBQUMrQixLQUFLLENBQUMsQ0FBQztJQUN2QixJQUFJLENBQUM1QixpQkFBaUIsQ0FBQzRCLEtBQUssQ0FBQyxDQUFDO0lBQzlCLElBQUksQ0FBQ3JCLCtCQUErQixDQUFDcUIsS0FBSyxDQUFDLENBQUM7SUFDNUMsSUFBSSxDQUFDTCw0QkFBNEIsQ0FBQ0ssS0FBSyxDQUFDLENBQUM7RUFDM0M7O0VBRUE7QUFDRjtBQUNBO0FBQ0E7RUFDU0MsSUFBSUEsQ0FBRUMsRUFBVSxFQUFTO0lBQzlCLElBQUssSUFBSSxDQUFDakMsVUFBVSxDQUFDa0MsS0FBSyxFQUFHO01BQzNCLElBQUksQ0FBQ1IsNEJBQTRCLENBQUNRLEtBQUssSUFBSUQsRUFBRTtNQUM3QyxJQUFLLElBQUksQ0FBQ1AsNEJBQTRCLENBQUNRLEtBQUssSUFBSSxJQUFJLENBQUNYLGtCQUFrQixFQUFHO1FBRXhFO1FBQ0EsSUFBSSxDQUFDRyw0QkFBNEIsQ0FBQ1EsS0FBSyxHQUFHLElBQUksQ0FBQ1IsNEJBQTRCLENBQUNRLEtBQUssR0FBRyxJQUFJLENBQUNYLGtCQUFrQjs7UUFFM0c7UUFDQSxJQUFJLENBQUNZLFlBQVksQ0FBQyxDQUFDO01BQ3JCO0lBQ0Y7RUFDRjs7RUFFQTtBQUNGO0FBQ0E7RUFDVUEsWUFBWUEsQ0FBQSxFQUFTO0lBQzNCLElBQUksQ0FBQ2Ysb0JBQW9CLENBQUNnQixJQUFJLENBQUUsSUFBSS9DLE1BQU0sQ0FBRTtNQUMxQzRCLFVBQVUsRUFBRSxJQUFJLENBQUNvQix1QkFBdUIsQ0FBQyxDQUFDO01BQzFDQyxRQUFRLEVBQUUsSUFBSSxDQUFDQyxxQkFBcUIsQ0FBQyxDQUFDO01BQ3RDQyxTQUFTLEVBQUVDLElBQUksQ0FBQ0MsRUFBRSxHQUFHLENBQUM7TUFBRTtNQUN4QnpDLE1BQU0sRUFBRVYsTUFBTSxDQUFDb0QsT0FBTyxDQUFDO0lBQ3pCLENBQUUsQ0FBRSxDQUFDO0VBQ1A7O0VBRUE7QUFDRjtBQUNBO0FBQ0E7RUFDU0Msb0JBQW9CQSxDQUFFM0IsVUFBa0IsRUFBUztJQUN0RCxJQUFJLENBQUNHLG9CQUFvQixDQUFDZ0IsSUFBSSxDQUFFLElBQUkvQyxNQUFNLENBQUU7TUFDMUM0QixVQUFVLEVBQUVBLFVBQVU7TUFDdEJxQixRQUFRLEVBQUUsSUFBSTFELE9BQU8sQ0FBRSxJQUFJLENBQUNpQixXQUFXLENBQUNnRCxPQUFPLEVBQUUsSUFBSSxDQUFDaEQsV0FBVyxDQUFDaUQsSUFBSyxDQUFDO01BQ3hFTixTQUFTLEVBQUVDLElBQUksQ0FBQ0MsRUFBRSxHQUFHLENBQUM7TUFBRTtNQUN4QnpDLE1BQU0sRUFBRVYsTUFBTSxDQUFDb0QsT0FBTyxDQUFDO0lBQ3pCLENBQUUsQ0FBRSxDQUFDO0VBQ1A7O0VBRUE7QUFDRjtBQUNBO0VBQ1VKLHFCQUFxQkEsQ0FBQSxFQUFZO0lBQ3ZDLE1BQU1RLENBQUMsR0FBR3BFLFNBQVMsQ0FBQ3FFLGlCQUFpQixDQUFFLElBQUksQ0FBQ25ELFdBQVcsQ0FBQ29ELElBQUksRUFBRSxJQUFJLENBQUNwRCxXQUFXLENBQUNxRCxJQUFLLENBQUM7SUFDckYsTUFBTUMsQ0FBQyxHQUFHLElBQUksQ0FBQ3RELFdBQVcsQ0FBQ2lELElBQUk7SUFDL0IsT0FBTyxJQUFJbEUsT0FBTyxDQUFFbUUsQ0FBQyxFQUFFSSxDQUFFLENBQUM7RUFDNUI7O0VBRUE7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDVWQsdUJBQXVCQSxDQUFBLEVBQVc7SUFFeEMsSUFBSXBCLFVBQVUsR0FBRyxJQUFJLENBQUNQLCtCQUErQixDQUFDd0IsS0FBSztJQUUzRCxJQUFLLElBQUksQ0FBQy9CLGlCQUFpQixDQUFDK0IsS0FBSyxLQUFLLE9BQU8sRUFBRztNQUM5QyxJQUFLdkQsU0FBUyxDQUFDeUUsVUFBVSxDQUFDLENBQUMsR0FBRzVELDZCQUE2QixFQUFHO1FBRTVEO1FBQ0EsTUFBTTZELENBQUMsR0FBRzFFLFNBQVMsQ0FBQzJFLGNBQWMsQ0FBRSxDQUFDLEVBQUUsSUFBSSxDQUFDMUIscUJBQXFCLENBQUMyQixNQUFNLEdBQUcsQ0FBRSxDQUFDO1FBQzlFdEMsVUFBVSxHQUFHLElBQUksQ0FBQ1cscUJBQXFCLENBQUV5QixDQUFDLENBQUU7TUFDOUMsQ0FBQyxNQUNJO1FBRUg7UUFDQXBDLFVBQVUsR0FBR3RDLFNBQVMsQ0FBQ3FFLGlCQUFpQixDQUFFLElBQUksQ0FBQzFDLDRCQUE0QixDQUFDRSxHQUFHLEVBQUUsSUFBSSxDQUFDRiw0QkFBNEIsQ0FBQ2tELEdBQUksQ0FBQztNQUMxSDtJQUNGO0lBQ0EsT0FBT3ZDLFVBQVU7RUFDbkI7QUFDRjtBQUVBL0IsdUJBQXVCLENBQUN1RSxRQUFRLENBQUUsT0FBTyxFQUFFOUQsS0FBTSxDQUFDIn0=