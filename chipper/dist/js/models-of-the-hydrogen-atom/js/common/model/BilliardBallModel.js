// Copyright 2016-2022, University of Colorado Boulder

/**
 * BilliardBallModel is a predictive model of the hydrogen atom.
 *
 * Physical representation:
 * The ball is spherical, with its local origin at its center.
 *
 * Collision behavior:
 * When photons collide with the ball, they bounce off as if the ball were a rigid body.
 *
 * Absorption behavior:
 * Does not absorb photons.
 *
 * Emission behavior:
 * Does not emit photons.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import optionize from '../../../../phet-core/js/optionize.js';
import billiardBallButton_png from '../../../images/billiardBallButton_png.js';
import modelsOfTheHydrogenAtom from '../../modelsOfTheHydrogenAtom.js';
import ModelsOfTheHydrogenAtomStrings from '../../ModelsOfTheHydrogenAtomStrings.js';
import HydrogenAtom from './HydrogenAtom.js';
import dotRandom from '../../../../dot/js/dotRandom.js';
import Utils from '../../../../dot/js/Utils.js';
import MOTHAConstants from '../MOTHAConstants.js';

// constants
const MIN_DEFLECTION_ANGLE = Utils.toRadians(30);
const MAX_DEFLECTION_ANGLE = Utils.toRadians(60);
export default class BilliardBallModel extends HydrogenAtom {
  //TODO do all HydrogenAtom subclasses have radius?
  radius = MOTHAConstants.BILLIARD_BALL_RADIUS;
  constructor(zoomedInBox, providedOptions) {
    const options = optionize()({
      // HydrogenAtomOptions
      displayNameProperty: ModelsOfTheHydrogenAtomStrings.billiardBallStringProperty,
      iconHTMLImageElement: billiardBallButton_png,
      hasTransitionWavelengths: false
    }, providedOptions);
    super(zoomedInBox, options);
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
  step(dt) {
    // do nothing for this model
  }

  //TODO This does not look good in 'Fast' speed, because photos are inside the atom. Especially noticeable when stepping.
  /**
   * Moves a photon. If the photon collides with the atom, the photon bounces back at a 'steep but random' angle.
   * Otherwise, it continues to move in its current direction.
   */
  movePhoton(photon, dt) {
    // detect collision and adjust particle direction
    if (!photon.hasCollidedProperty.value) {
      if (photon.positionProperty.value.distance(this.position) <= this.radius) {
        const sign = photon.positionProperty.value.x > this.position.x ? 1 : -1;
        const deflectionAngle = sign * dotRandom.nextDoubleBetween(MIN_DEFLECTION_ANGLE, MAX_DEFLECTION_ANGLE);
        photon.directionProperty.value += Math.PI + deflectionAngle;
        photon.hasCollidedProperty.value = true;
      }
    }

    // move photon
    photon.move(dt);
  }
}
modelsOfTheHydrogenAtom.register('BilliardBallModel', BilliardBallModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25pemUiLCJiaWxsaWFyZEJhbGxCdXR0b25fcG5nIiwibW9kZWxzT2ZUaGVIeWRyb2dlbkF0b20iLCJNb2RlbHNPZlRoZUh5ZHJvZ2VuQXRvbVN0cmluZ3MiLCJIeWRyb2dlbkF0b20iLCJkb3RSYW5kb20iLCJVdGlscyIsIk1PVEhBQ29uc3RhbnRzIiwiTUlOX0RFRkxFQ1RJT05fQU5HTEUiLCJ0b1JhZGlhbnMiLCJNQVhfREVGTEVDVElPTl9BTkdMRSIsIkJpbGxpYXJkQmFsbE1vZGVsIiwicmFkaXVzIiwiQklMTElBUkRfQkFMTF9SQURJVVMiLCJjb25zdHJ1Y3RvciIsInpvb21lZEluQm94IiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsImRpc3BsYXlOYW1lUHJvcGVydHkiLCJiaWxsaWFyZEJhbGxTdHJpbmdQcm9wZXJ0eSIsImljb25IVE1MSW1hZ2VFbGVtZW50IiwiaGFzVHJhbnNpdGlvbldhdmVsZW5ndGhzIiwiZGlzcG9zZSIsImFzc2VydCIsInN0ZXAiLCJkdCIsIm1vdmVQaG90b24iLCJwaG90b24iLCJoYXNDb2xsaWRlZFByb3BlcnR5IiwidmFsdWUiLCJwb3NpdGlvblByb3BlcnR5IiwiZGlzdGFuY2UiLCJwb3NpdGlvbiIsInNpZ24iLCJ4IiwiZGVmbGVjdGlvbkFuZ2xlIiwibmV4dERvdWJsZUJldHdlZW4iLCJkaXJlY3Rpb25Qcm9wZXJ0eSIsIk1hdGgiLCJQSSIsIm1vdmUiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkJpbGxpYXJkQmFsbE1vZGVsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE2LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEJpbGxpYXJkQmFsbE1vZGVsIGlzIGEgcHJlZGljdGl2ZSBtb2RlbCBvZiB0aGUgaHlkcm9nZW4gYXRvbS5cclxuICpcclxuICogUGh5c2ljYWwgcmVwcmVzZW50YXRpb246XHJcbiAqIFRoZSBiYWxsIGlzIHNwaGVyaWNhbCwgd2l0aCBpdHMgbG9jYWwgb3JpZ2luIGF0IGl0cyBjZW50ZXIuXHJcbiAqXHJcbiAqIENvbGxpc2lvbiBiZWhhdmlvcjpcclxuICogV2hlbiBwaG90b25zIGNvbGxpZGUgd2l0aCB0aGUgYmFsbCwgdGhleSBib3VuY2Ugb2ZmIGFzIGlmIHRoZSBiYWxsIHdlcmUgYSByaWdpZCBib2R5LlxyXG4gKlxyXG4gKiBBYnNvcnB0aW9uIGJlaGF2aW9yOlxyXG4gKiBEb2VzIG5vdCBhYnNvcmIgcGhvdG9ucy5cclxuICpcclxuICogRW1pc3Npb24gYmVoYXZpb3I6XHJcbiAqIERvZXMgbm90IGVtaXQgcGhvdG9ucy5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgU3RyaWN0T21pdCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvU3RyaWN0T21pdC5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgYmlsbGlhcmRCYWxsQnV0dG9uX3BuZyBmcm9tICcuLi8uLi8uLi9pbWFnZXMvYmlsbGlhcmRCYWxsQnV0dG9uX3BuZy5qcyc7XHJcbmltcG9ydCBtb2RlbHNPZlRoZUh5ZHJvZ2VuQXRvbSBmcm9tICcuLi8uLi9tb2RlbHNPZlRoZUh5ZHJvZ2VuQXRvbS5qcyc7XHJcbmltcG9ydCBNb2RlbHNPZlRoZUh5ZHJvZ2VuQXRvbVN0cmluZ3MgZnJvbSAnLi4vLi4vTW9kZWxzT2ZUaGVIeWRyb2dlbkF0b21TdHJpbmdzLmpzJztcclxuaW1wb3J0IFBob3RvbiBmcm9tICcuL1Bob3Rvbi5qcyc7XHJcbmltcG9ydCBIeWRyb2dlbkF0b20sIHsgSHlkcm9nZW5BdG9tT3B0aW9ucyB9IGZyb20gJy4vSHlkcm9nZW5BdG9tLmpzJztcclxuaW1wb3J0IFpvb21lZEluQm94IGZyb20gJy4vWm9vbWVkSW5Cb3guanMnO1xyXG5pbXBvcnQgZG90UmFuZG9tIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9kb3RSYW5kb20uanMnO1xyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1V0aWxzLmpzJztcclxuaW1wb3J0IE1PVEhBQ29uc3RhbnRzIGZyb20gJy4uL01PVEhBQ29uc3RhbnRzLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBNSU5fREVGTEVDVElPTl9BTkdMRSA9IFV0aWxzLnRvUmFkaWFucyggMzAgKTtcclxuY29uc3QgTUFYX0RFRkxFQ1RJT05fQU5HTEUgPSBVdGlscy50b1JhZGlhbnMoIDYwICk7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0gRW1wdHlTZWxmT3B0aW9ucztcclxuXHJcbnR5cGUgQmlsbGlhcmRCYWxsTW9kZWxPcHRpb25zID0gU2VsZk9wdGlvbnMgJlxyXG4gIFN0cmljdE9taXQ8SHlkcm9nZW5BdG9tT3B0aW9ucywgJ2Rpc3BsYXlOYW1lUHJvcGVydHknIHwgJ2ljb25IVE1MSW1hZ2VFbGVtZW50JyB8ICdoYXNUcmFuc2l0aW9uV2F2ZWxlbmd0aHMnPjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJpbGxpYXJkQmFsbE1vZGVsIGV4dGVuZHMgSHlkcm9nZW5BdG9tIHtcclxuXHJcbiAgLy9UT0RPIGRvIGFsbCBIeWRyb2dlbkF0b20gc3ViY2xhc3NlcyBoYXZlIHJhZGl1cz9cclxuICBwdWJsaWMgcmVhZG9ubHkgcmFkaXVzID0gTU9USEFDb25zdGFudHMuQklMTElBUkRfQkFMTF9SQURJVVM7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggem9vbWVkSW5Cb3g6IFpvb21lZEluQm94LCBwcm92aWRlZE9wdGlvbnM6IEJpbGxpYXJkQmFsbE1vZGVsT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEJpbGxpYXJkQmFsbE1vZGVsT3B0aW9ucywgU2VsZk9wdGlvbnMsIEh5ZHJvZ2VuQXRvbU9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIEh5ZHJvZ2VuQXRvbU9wdGlvbnNcclxuICAgICAgZGlzcGxheU5hbWVQcm9wZXJ0eTogTW9kZWxzT2ZUaGVIeWRyb2dlbkF0b21TdHJpbmdzLmJpbGxpYXJkQmFsbFN0cmluZ1Byb3BlcnR5LFxyXG4gICAgICBpY29uSFRNTEltYWdlRWxlbWVudDogYmlsbGlhcmRCYWxsQnV0dG9uX3BuZyxcclxuICAgICAgaGFzVHJhbnNpdGlvbldhdmVsZW5ndGhzOiBmYWxzZVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIHpvb21lZEluQm94LCBvcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIHN0ZXAoIGR0OiBudW1iZXIgKTogdm9pZCB7XHJcbiAgICAvLyBkbyBub3RoaW5nIGZvciB0aGlzIG1vZGVsXHJcbiAgfVxyXG5cclxuICAvL1RPRE8gVGhpcyBkb2VzIG5vdCBsb29rIGdvb2QgaW4gJ0Zhc3QnIHNwZWVkLCBiZWNhdXNlIHBob3RvcyBhcmUgaW5zaWRlIHRoZSBhdG9tLiBFc3BlY2lhbGx5IG5vdGljZWFibGUgd2hlbiBzdGVwcGluZy5cclxuICAvKipcclxuICAgKiBNb3ZlcyBhIHBob3Rvbi4gSWYgdGhlIHBob3RvbiBjb2xsaWRlcyB3aXRoIHRoZSBhdG9tLCB0aGUgcGhvdG9uIGJvdW5jZXMgYmFjayBhdCBhICdzdGVlcCBidXQgcmFuZG9tJyBhbmdsZS5cclxuICAgKiBPdGhlcndpc2UsIGl0IGNvbnRpbnVlcyB0byBtb3ZlIGluIGl0cyBjdXJyZW50IGRpcmVjdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgbW92ZVBob3RvbiggcGhvdG9uOiBQaG90b24sIGR0OiBudW1iZXIgKTogdm9pZCB7XHJcblxyXG4gICAgLy8gZGV0ZWN0IGNvbGxpc2lvbiBhbmQgYWRqdXN0IHBhcnRpY2xlIGRpcmVjdGlvblxyXG4gICAgaWYgKCAhcGhvdG9uLmhhc0NvbGxpZGVkUHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgIGlmICggcGhvdG9uLnBvc2l0aW9uUHJvcGVydHkudmFsdWUuZGlzdGFuY2UoIHRoaXMucG9zaXRpb24gKSA8PSB0aGlzLnJhZGl1cyApIHtcclxuICAgICAgICBjb25zdCBzaWduID0gKCBwaG90b24ucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZS54ID4gdGhpcy5wb3NpdGlvbi54ICkgPyAxIDogLTE7XHJcbiAgICAgICAgY29uc3QgZGVmbGVjdGlvbkFuZ2xlID0gc2lnbiAqIGRvdFJhbmRvbS5uZXh0RG91YmxlQmV0d2VlbiggTUlOX0RFRkxFQ1RJT05fQU5HTEUsIE1BWF9ERUZMRUNUSU9OX0FOR0xFICk7XHJcbiAgICAgICAgcGhvdG9uLmRpcmVjdGlvblByb3BlcnR5LnZhbHVlICs9ICggTWF0aC5QSSArIGRlZmxlY3Rpb25BbmdsZSApO1xyXG4gICAgICAgIHBob3Rvbi5oYXNDb2xsaWRlZFByb3BlcnR5LnZhbHVlID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIG1vdmUgcGhvdG9uXHJcbiAgICBwaG90b24ubW92ZSggZHQgKTtcclxuICB9XHJcbn1cclxuXHJcbm1vZGVsc09mVGhlSHlkcm9nZW5BdG9tLnJlZ2lzdGVyKCAnQmlsbGlhcmRCYWxsTW9kZWwnLCBCaWxsaWFyZEJhbGxNb2RlbCApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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