// Copyright 2018-2023, University of Colorado Boulder

/**
 * Content for the "Keyboard Shortcuts" dialog that can be brought up from the sim navigation bar.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 * @author Michael Barlow
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

import merge from '../../../phet-core/js/merge.js';
import BasicActionsKeyboardHelpSection from '../../../scenery-phet/js/keyboard/help/BasicActionsKeyboardHelpSection.js';
import GrabReleaseKeyboardHelpSection from '../../../scenery-phet/js/keyboard/help/GrabReleaseKeyboardHelpSection.js';
import KeyboardHelpIconFactory from '../../../scenery-phet/js/keyboard/help/KeyboardHelpIconFactory.js';
import KeyboardHelpSection from '../../../scenery-phet/js/keyboard/help/KeyboardHelpSection.js';
import KeyboardHelpSectionRow from '../../../scenery-phet/js/keyboard/help/KeyboardHelpSectionRow.js';
import TwoColumnKeyboardHelpContent from '../../../scenery-phet/js/keyboard/help/TwoColumnKeyboardHelpContent.js';
import TextKeyNode from '../../../scenery-phet/js/keyboard/TextKeyNode.js';
import SceneryPhetStrings from '../../../scenery-phet/js/SceneryPhetStrings.js';
import { Node } from '../../../scenery/js/imports.js';
import gravityForceLab from '../gravityForceLab.js';
import GravityForceLabStrings from '../GravityForceLabStrings.js';
const changeMassHeadingString = GravityForceLabStrings.changeMassHeading;
const changeMassInLargerStepsString = GravityForceLabStrings.changeMassInLargerSteps;
const changeMassInSmallerStepsString = GravityForceLabStrings.changeMassInSmallerSteps;
const changeMassLabelString = GravityForceLabStrings.changeMassLabel;
const jumpToLeftString = GravityForceLabStrings.jumpToLeft;
const jumpToMaximumMassString = GravityForceLabStrings.jumpToMaximumMass;
const jumpToMinimumMassString = GravityForceLabStrings.jumpToMinimumMass;
const jumpToRightString = GravityForceLabStrings.jumpToRight;
const moveInLargerStepsString = GravityForceLabStrings.moveInLargerSteps;
const moveInSmallerStepsString = GravityForceLabStrings.moveInSmallerSteps;
const moveSphereLabelString = GravityForceLabStrings.moveSphereLabel;
const moveSpheresHeadingString = GravityForceLabStrings.moveSpheresHeading;
const jumpHomeString = GravityForceLabStrings.jumpHome;
const jumpStartOfSphereString = GravityForceLabStrings.jumpStartOfSphere;
const moveGrabbedRulerString = GravityForceLabStrings.moveGrabbedRuler;
const moveOrJumpGrabbedRulerString = GravityForceLabStrings.moveOrJumpGrabbedRuler;
const moveSphereDescriptionString = GravityForceLabStrings.a11y.keyboardHelp.moveSphereDescription;
const moveInSmallerStepsDescriptionString = GravityForceLabStrings.a11y.keyboardHelp.moveInSmallerStepsDescription;
const moveInLargerStepsDescriptionString = GravityForceLabStrings.a11y.keyboardHelp.moveInLargerStepsDescription;
const jumpToLeftDescriptionString = GravityForceLabStrings.a11y.keyboardHelp.jumpToLeftDescription;
const jumpToRightDescriptionString = GravityForceLabStrings.a11y.keyboardHelp.jumpToRightDescription;
const changeMassPDOMString = GravityForceLabStrings.a11y.keyboardHelp.changeMassPDOM;
const changeMassBasicsPDOMString = GravityForceLabStrings.a11y.keyboardHelp.changeMassBasicsPDOM;
const changeMassInLargerStepsDescriptionString = GravityForceLabStrings.a11y.keyboardHelp.changeMassInLargerStepsDescription;
const changeMassInSmallerStepsDescriptionString = GravityForceLabStrings.a11y.keyboardHelp.changeMassInSmallerStepsDescription;
const jumpToMaximumMassDescriptionString = GravityForceLabStrings.a11y.keyboardHelp.jumpToMaximumMassDescription;
const jumpToMinimumMassDescriptionString = GravityForceLabStrings.a11y.keyboardHelp.jumpToMinimumMassDescription;
const moveGrabbedRulerPDOMString = GravityForceLabStrings.a11y.keyboardHelp.moveGrabbedRulerPDOM;
const moveInSmallerStepsPDOMString = GravityForceLabStrings.a11y.keyboardHelp.moveInSmallerStepsPDOM;
const jumpStartOfSpherePDOMString = GravityForceLabStrings.a11y.keyboardHelp.jumpStartOfSpherePDOM;
const jumpHomePDOMString = GravityForceLabStrings.a11y.keyboardHelp.jumpHomePDOM;
class GravityForceLabKeyboardHelpContent extends TwoColumnKeyboardHelpContent {
  /**
   * @param {Object} [options]
   */
  constructor(options) {
    options = merge({
      // omit the "change mass in smaller steps" row when true
      isBasics: false
    }, options);

    // Mass movement help dialog section
    // move mass section
    const moveMassRow = KeyboardHelpSectionRow.labelWithIcon(moveSphereLabelString, KeyboardHelpIconFactory.leftRightArrowKeysRowIcon(), {
      labelInnerContent: moveSphereDescriptionString
    });
    const moveSmallStepsRow = KeyboardHelpSectionRow.labelWithIcon(moveInSmallerStepsString, KeyboardHelpIconFactory.shiftPlusIcon(KeyboardHelpIconFactory.leftRightArrowKeysRowIcon()), {
      labelInnerContent: moveInSmallerStepsDescriptionString
    });

    // 'move in larger steps' section
    const moveLargeStepsRow = KeyboardHelpSectionRow.labelWithIcon(moveInLargerStepsString, KeyboardHelpIconFactory.pageUpPageDownRowIcon(), {
      labelInnerContent: moveInLargerStepsDescriptionString
    });

    // 'jump to left' section
    const jumpLeftRow = KeyboardHelpSectionRow.labelWithIcon(jumpToLeftString, TextKeyNode.home(), {
      labelInnerContent: jumpToLeftDescriptionString
    });

    // 'jump to right' section
    const jumpRightRow = KeyboardHelpSectionRow.labelWithIcon(jumpToRightString, TextKeyNode.end(), {
      labelInnerContent: jumpToRightDescriptionString
    });
    const moveMassRows = [moveMassRow, moveSmallStepsRow, moveLargeStepsRow, jumpLeftRow, jumpRightRow];
    const moveMassHelpSection = new KeyboardHelpSection(moveSpheresHeadingString, moveMassRows);

    // Mass adjustment help section
    const changeMassIcon = options.isBasics ? KeyboardHelpIconFactory.upDownArrowKeysRowIcon() : KeyboardHelpIconFactory.leftRightArrowKeysRowIcon();

    // Surrounded in Node for DAG layout constraints. Otherwise changeMassIcon will be positioned overwritten.
    const shiftPlusChangeMassIcon = KeyboardHelpIconFactory.shiftPlusIcon(new Node({
      children: [changeMassIcon]
    }));
    const changeMassRow = KeyboardHelpSectionRow.labelWithIcon(changeMassLabelString, changeMassIcon, {
      labelInnerContent: options.isBasics ? changeMassBasicsPDOMString : changeMassPDOMString
    }); // up/down vs left/right
    const changeMassSmallStepsRow = KeyboardHelpSectionRow.labelWithIcon(changeMassInSmallerStepsString, shiftPlusChangeMassIcon, {
      labelInnerContent: changeMassInSmallerStepsDescriptionString
    });
    const changeMassLargeStepsRow = KeyboardHelpSectionRow.labelWithIcon(changeMassInLargerStepsString, KeyboardHelpIconFactory.pageUpPageDownRowIcon(), {
      labelInnerContent: changeMassInLargerStepsDescriptionString
    });
    const jumpToMinMassRow = KeyboardHelpSectionRow.labelWithIcon(jumpToMinimumMassString, TextKeyNode.home(), {
      labelInnerContent: jumpToMinimumMassDescriptionString
    });
    const jumpToMaxMassRow = KeyboardHelpSectionRow.labelWithIcon(jumpToMaximumMassString, TextKeyNode.end(), {
      labelInnerContent: jumpToMaximumMassDescriptionString
    });
    const adjustMassRows = [changeMassRow, changeMassSmallStepsRow, changeMassLargeStepsRow, jumpToMinMassRow, jumpToMaxMassRow];

    // leave out row if option is supplied
    if (options.isBasics) {
      adjustMassRows.splice(adjustMassRows.indexOf(changeMassSmallStepsRow), 1);
    }
    const adjustMassHelpSection = new KeyboardHelpSection(changeMassHeadingString, adjustMassRows);

    // align icons for the mass movement and adjustment sections
    KeyboardHelpSection.alignHelpSectionIcons([moveMassHelpSection, adjustMassHelpSection]);
    const basicActionsHelpSection = new BasicActionsKeyboardHelpSection({
      withCheckboxContent: true
    });
    const grabDragHelpContent = new GrabReleaseKeyboardHelpSection(SceneryPhetStrings.rulerCapitalizedStringProperty, SceneryPhetStrings.rulerStringProperty);
    const leftContent = [moveMassHelpSection, adjustMassHelpSection];
    const rightContent = [basicActionsHelpSection];
    if (!options.isBasics) {
      rightContent.unshift(grabDragHelpContent, new MoveOrJumpGrabbedRulerHelpSection());
    }
    super(leftContent, rightContent);
  }
}

/**
 * @param {Object} [options]
 * @constructor
 */
class MoveOrJumpGrabbedRulerHelpSection extends KeyboardHelpSection {
  /**
   * @param {Object} [options]
   */
  constructor(options) {
    const moveRulerIcon = KeyboardHelpIconFactory.arrowOrWasdKeysRowIcon();
    const moveRulerRow = KeyboardHelpSectionRow.labelWithIcon(moveGrabbedRulerString, moveRulerIcon, {
      labelInnerContent: moveGrabbedRulerPDOMString
    });
    const shiftPlusArrowKeys = KeyboardHelpIconFactory.shiftPlusIcon(KeyboardHelpIconFactory.arrowKeysRowIcon());
    const shiftPlusWASDKeys = KeyboardHelpIconFactory.shiftPlusIcon(KeyboardHelpIconFactory.wasdRowIcon());
    const moveInSmallerStepsRow = KeyboardHelpSectionRow.labelWithIconList(moveInSmallerStepsString, [shiftPlusArrowKeys, shiftPlusWASDKeys], {
      labelInnerContent: moveInSmallerStepsPDOMString
    });
    const jumpStartRow = KeyboardHelpSectionRow.createJumpKeyRow('C', jumpStartOfSphereString, {
      labelInnerContent: jumpStartOfSpherePDOMString
    });
    const jumpHomeRow = KeyboardHelpSectionRow.createJumpKeyRow('H', jumpHomeString, {
      labelInnerContent: jumpHomePDOMString
    });
    const rows = [jumpStartRow, jumpHomeRow, moveRulerRow, moveInSmallerStepsRow];
    super(moveOrJumpGrabbedRulerString, rows, options);
    this.disposeEmitter.addListener(() => rows.forEach(row => row.dispose()));
  }
}
gravityForceLab.register('GravityForceLabKeyboardHelpContent', GravityForceLabKeyboardHelpContent);
export default GravityForceLabKeyboardHelpContent;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtZXJnZSIsIkJhc2ljQWN0aW9uc0tleWJvYXJkSGVscFNlY3Rpb24iLCJHcmFiUmVsZWFzZUtleWJvYXJkSGVscFNlY3Rpb24iLCJLZXlib2FyZEhlbHBJY29uRmFjdG9yeSIsIktleWJvYXJkSGVscFNlY3Rpb24iLCJLZXlib2FyZEhlbHBTZWN0aW9uUm93IiwiVHdvQ29sdW1uS2V5Ym9hcmRIZWxwQ29udGVudCIsIlRleHRLZXlOb2RlIiwiU2NlbmVyeVBoZXRTdHJpbmdzIiwiTm9kZSIsImdyYXZpdHlGb3JjZUxhYiIsIkdyYXZpdHlGb3JjZUxhYlN0cmluZ3MiLCJjaGFuZ2VNYXNzSGVhZGluZ1N0cmluZyIsImNoYW5nZU1hc3NIZWFkaW5nIiwiY2hhbmdlTWFzc0luTGFyZ2VyU3RlcHNTdHJpbmciLCJjaGFuZ2VNYXNzSW5MYXJnZXJTdGVwcyIsImNoYW5nZU1hc3NJblNtYWxsZXJTdGVwc1N0cmluZyIsImNoYW5nZU1hc3NJblNtYWxsZXJTdGVwcyIsImNoYW5nZU1hc3NMYWJlbFN0cmluZyIsImNoYW5nZU1hc3NMYWJlbCIsImp1bXBUb0xlZnRTdHJpbmciLCJqdW1wVG9MZWZ0IiwianVtcFRvTWF4aW11bU1hc3NTdHJpbmciLCJqdW1wVG9NYXhpbXVtTWFzcyIsImp1bXBUb01pbmltdW1NYXNzU3RyaW5nIiwianVtcFRvTWluaW11bU1hc3MiLCJqdW1wVG9SaWdodFN0cmluZyIsImp1bXBUb1JpZ2h0IiwibW92ZUluTGFyZ2VyU3RlcHNTdHJpbmciLCJtb3ZlSW5MYXJnZXJTdGVwcyIsIm1vdmVJblNtYWxsZXJTdGVwc1N0cmluZyIsIm1vdmVJblNtYWxsZXJTdGVwcyIsIm1vdmVTcGhlcmVMYWJlbFN0cmluZyIsIm1vdmVTcGhlcmVMYWJlbCIsIm1vdmVTcGhlcmVzSGVhZGluZ1N0cmluZyIsIm1vdmVTcGhlcmVzSGVhZGluZyIsImp1bXBIb21lU3RyaW5nIiwianVtcEhvbWUiLCJqdW1wU3RhcnRPZlNwaGVyZVN0cmluZyIsImp1bXBTdGFydE9mU3BoZXJlIiwibW92ZUdyYWJiZWRSdWxlclN0cmluZyIsIm1vdmVHcmFiYmVkUnVsZXIiLCJtb3ZlT3JKdW1wR3JhYmJlZFJ1bGVyU3RyaW5nIiwibW92ZU9ySnVtcEdyYWJiZWRSdWxlciIsIm1vdmVTcGhlcmVEZXNjcmlwdGlvblN0cmluZyIsImExMXkiLCJrZXlib2FyZEhlbHAiLCJtb3ZlU3BoZXJlRGVzY3JpcHRpb24iLCJtb3ZlSW5TbWFsbGVyU3RlcHNEZXNjcmlwdGlvblN0cmluZyIsIm1vdmVJblNtYWxsZXJTdGVwc0Rlc2NyaXB0aW9uIiwibW92ZUluTGFyZ2VyU3RlcHNEZXNjcmlwdGlvblN0cmluZyIsIm1vdmVJbkxhcmdlclN0ZXBzRGVzY3JpcHRpb24iLCJqdW1wVG9MZWZ0RGVzY3JpcHRpb25TdHJpbmciLCJqdW1wVG9MZWZ0RGVzY3JpcHRpb24iLCJqdW1wVG9SaWdodERlc2NyaXB0aW9uU3RyaW5nIiwianVtcFRvUmlnaHREZXNjcmlwdGlvbiIsImNoYW5nZU1hc3NQRE9NU3RyaW5nIiwiY2hhbmdlTWFzc1BET00iLCJjaGFuZ2VNYXNzQmFzaWNzUERPTVN0cmluZyIsImNoYW5nZU1hc3NCYXNpY3NQRE9NIiwiY2hhbmdlTWFzc0luTGFyZ2VyU3RlcHNEZXNjcmlwdGlvblN0cmluZyIsImNoYW5nZU1hc3NJbkxhcmdlclN0ZXBzRGVzY3JpcHRpb24iLCJjaGFuZ2VNYXNzSW5TbWFsbGVyU3RlcHNEZXNjcmlwdGlvblN0cmluZyIsImNoYW5nZU1hc3NJblNtYWxsZXJTdGVwc0Rlc2NyaXB0aW9uIiwianVtcFRvTWF4aW11bU1hc3NEZXNjcmlwdGlvblN0cmluZyIsImp1bXBUb01heGltdW1NYXNzRGVzY3JpcHRpb24iLCJqdW1wVG9NaW5pbXVtTWFzc0Rlc2NyaXB0aW9uU3RyaW5nIiwianVtcFRvTWluaW11bU1hc3NEZXNjcmlwdGlvbiIsIm1vdmVHcmFiYmVkUnVsZXJQRE9NU3RyaW5nIiwibW92ZUdyYWJiZWRSdWxlclBET00iLCJtb3ZlSW5TbWFsbGVyU3RlcHNQRE9NU3RyaW5nIiwibW92ZUluU21hbGxlclN0ZXBzUERPTSIsImp1bXBTdGFydE9mU3BoZXJlUERPTVN0cmluZyIsImp1bXBTdGFydE9mU3BoZXJlUERPTSIsImp1bXBIb21lUERPTVN0cmluZyIsImp1bXBIb21lUERPTSIsIkdyYXZpdHlGb3JjZUxhYktleWJvYXJkSGVscENvbnRlbnQiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJpc0Jhc2ljcyIsIm1vdmVNYXNzUm93IiwibGFiZWxXaXRoSWNvbiIsImxlZnRSaWdodEFycm93S2V5c1Jvd0ljb24iLCJsYWJlbElubmVyQ29udGVudCIsIm1vdmVTbWFsbFN0ZXBzUm93Iiwic2hpZnRQbHVzSWNvbiIsIm1vdmVMYXJnZVN0ZXBzUm93IiwicGFnZVVwUGFnZURvd25Sb3dJY29uIiwianVtcExlZnRSb3ciLCJob21lIiwianVtcFJpZ2h0Um93IiwiZW5kIiwibW92ZU1hc3NSb3dzIiwibW92ZU1hc3NIZWxwU2VjdGlvbiIsImNoYW5nZU1hc3NJY29uIiwidXBEb3duQXJyb3dLZXlzUm93SWNvbiIsInNoaWZ0UGx1c0NoYW5nZU1hc3NJY29uIiwiY2hpbGRyZW4iLCJjaGFuZ2VNYXNzUm93IiwiY2hhbmdlTWFzc1NtYWxsU3RlcHNSb3ciLCJjaGFuZ2VNYXNzTGFyZ2VTdGVwc1JvdyIsImp1bXBUb01pbk1hc3NSb3ciLCJqdW1wVG9NYXhNYXNzUm93IiwiYWRqdXN0TWFzc1Jvd3MiLCJzcGxpY2UiLCJpbmRleE9mIiwiYWRqdXN0TWFzc0hlbHBTZWN0aW9uIiwiYWxpZ25IZWxwU2VjdGlvbkljb25zIiwiYmFzaWNBY3Rpb25zSGVscFNlY3Rpb24iLCJ3aXRoQ2hlY2tib3hDb250ZW50IiwiZ3JhYkRyYWdIZWxwQ29udGVudCIsInJ1bGVyQ2FwaXRhbGl6ZWRTdHJpbmdQcm9wZXJ0eSIsInJ1bGVyU3RyaW5nUHJvcGVydHkiLCJsZWZ0Q29udGVudCIsInJpZ2h0Q29udGVudCIsInVuc2hpZnQiLCJNb3ZlT3JKdW1wR3JhYmJlZFJ1bGVySGVscFNlY3Rpb24iLCJtb3ZlUnVsZXJJY29uIiwiYXJyb3dPcldhc2RLZXlzUm93SWNvbiIsIm1vdmVSdWxlclJvdyIsInNoaWZ0UGx1c0Fycm93S2V5cyIsImFycm93S2V5c1Jvd0ljb24iLCJzaGlmdFBsdXNXQVNES2V5cyIsIndhc2RSb3dJY29uIiwibW92ZUluU21hbGxlclN0ZXBzUm93IiwibGFiZWxXaXRoSWNvbkxpc3QiLCJqdW1wU3RhcnRSb3ciLCJjcmVhdGVKdW1wS2V5Um93IiwianVtcEhvbWVSb3ciLCJyb3dzIiwiZGlzcG9zZUVtaXR0ZXIiLCJhZGRMaXN0ZW5lciIsImZvckVhY2giLCJyb3ciLCJkaXNwb3NlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJHcmF2aXR5Rm9yY2VMYWJLZXlib2FyZEhlbHBDb250ZW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIENvbnRlbnQgZm9yIHRoZSBcIktleWJvYXJkIFNob3J0Y3V0c1wiIGRpYWxvZyB0aGF0IGNhbiBiZSBicm91Z2h0IHVwIGZyb20gdGhlIHNpbSBuYXZpZ2F0aW9uIGJhci5cclxuICpcclxuICogQGF1dGhvciBKZXNzZSBHcmVlbmJlcmcgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgTWljaGFlbCBCYXJsb3dcclxuICogQGF1dGhvciBNaWNoYWVsIEthdXptYW5uIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgQmFzaWNBY3Rpb25zS2V5Ym9hcmRIZWxwU2VjdGlvbiBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMva2V5Ym9hcmQvaGVscC9CYXNpY0FjdGlvbnNLZXlib2FyZEhlbHBTZWN0aW9uLmpzJztcclxuaW1wb3J0IEdyYWJSZWxlYXNlS2V5Ym9hcmRIZWxwU2VjdGlvbiBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMva2V5Ym9hcmQvaGVscC9HcmFiUmVsZWFzZUtleWJvYXJkSGVscFNlY3Rpb24uanMnO1xyXG5pbXBvcnQgS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkgZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL2tleWJvYXJkL2hlbHAvS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkuanMnO1xyXG5pbXBvcnQgS2V5Ym9hcmRIZWxwU2VjdGlvbiBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMva2V5Ym9hcmQvaGVscC9LZXlib2FyZEhlbHBTZWN0aW9uLmpzJztcclxuaW1wb3J0IEtleWJvYXJkSGVscFNlY3Rpb25Sb3cgZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL2tleWJvYXJkL2hlbHAvS2V5Ym9hcmRIZWxwU2VjdGlvblJvdy5qcyc7XHJcbmltcG9ydCBUd29Db2x1bW5LZXlib2FyZEhlbHBDb250ZW50IGZyb20gJy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9rZXlib2FyZC9oZWxwL1R3b0NvbHVtbktleWJvYXJkSGVscENvbnRlbnQuanMnO1xyXG5pbXBvcnQgVGV4dEtleU5vZGUgZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL2tleWJvYXJkL1RleHRLZXlOb2RlLmpzJztcclxuaW1wb3J0IFNjZW5lcnlQaGV0U3RyaW5ncyBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvU2NlbmVyeVBoZXRTdHJpbmdzLmpzJztcclxuaW1wb3J0IHsgTm9kZSB9IGZyb20gJy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBncmF2aXR5Rm9yY2VMYWIgZnJvbSAnLi4vZ3Jhdml0eUZvcmNlTGFiLmpzJztcclxuaW1wb3J0IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MgZnJvbSAnLi4vR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5qcyc7XHJcblxyXG5jb25zdCBjaGFuZ2VNYXNzSGVhZGluZ1N0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuY2hhbmdlTWFzc0hlYWRpbmc7XHJcbmNvbnN0IGNoYW5nZU1hc3NJbkxhcmdlclN0ZXBzU3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5jaGFuZ2VNYXNzSW5MYXJnZXJTdGVwcztcclxuY29uc3QgY2hhbmdlTWFzc0luU21hbGxlclN0ZXBzU3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5jaGFuZ2VNYXNzSW5TbWFsbGVyU3RlcHM7XHJcbmNvbnN0IGNoYW5nZU1hc3NMYWJlbFN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuY2hhbmdlTWFzc0xhYmVsO1xyXG5jb25zdCBqdW1wVG9MZWZ0U3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5qdW1wVG9MZWZ0O1xyXG5jb25zdCBqdW1wVG9NYXhpbXVtTWFzc1N0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuanVtcFRvTWF4aW11bU1hc3M7XHJcbmNvbnN0IGp1bXBUb01pbmltdW1NYXNzU3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5qdW1wVG9NaW5pbXVtTWFzcztcclxuY29uc3QganVtcFRvUmlnaHRTdHJpbmcgPSBHcmF2aXR5Rm9yY2VMYWJTdHJpbmdzLmp1bXBUb1JpZ2h0O1xyXG5jb25zdCBtb3ZlSW5MYXJnZXJTdGVwc1N0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MubW92ZUluTGFyZ2VyU3RlcHM7XHJcbmNvbnN0IG1vdmVJblNtYWxsZXJTdGVwc1N0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MubW92ZUluU21hbGxlclN0ZXBzO1xyXG5jb25zdCBtb3ZlU3BoZXJlTGFiZWxTdHJpbmcgPSBHcmF2aXR5Rm9yY2VMYWJTdHJpbmdzLm1vdmVTcGhlcmVMYWJlbDtcclxuY29uc3QgbW92ZVNwaGVyZXNIZWFkaW5nU3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5tb3ZlU3BoZXJlc0hlYWRpbmc7XHJcblxyXG5jb25zdCBqdW1wSG9tZVN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuanVtcEhvbWU7XHJcbmNvbnN0IGp1bXBTdGFydE9mU3BoZXJlU3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5qdW1wU3RhcnRPZlNwaGVyZTtcclxuY29uc3QgbW92ZUdyYWJiZWRSdWxlclN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MubW92ZUdyYWJiZWRSdWxlcjtcclxuY29uc3QgbW92ZU9ySnVtcEdyYWJiZWRSdWxlclN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MubW92ZU9ySnVtcEdyYWJiZWRSdWxlcjtcclxuXHJcbmNvbnN0IG1vdmVTcGhlcmVEZXNjcmlwdGlvblN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuYTExeS5rZXlib2FyZEhlbHAubW92ZVNwaGVyZURlc2NyaXB0aW9uO1xyXG5jb25zdCBtb3ZlSW5TbWFsbGVyU3RlcHNEZXNjcmlwdGlvblN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuYTExeS5rZXlib2FyZEhlbHAubW92ZUluU21hbGxlclN0ZXBzRGVzY3JpcHRpb247XHJcbmNvbnN0IG1vdmVJbkxhcmdlclN0ZXBzRGVzY3JpcHRpb25TdHJpbmcgPSBHcmF2aXR5Rm9yY2VMYWJTdHJpbmdzLmExMXkua2V5Ym9hcmRIZWxwLm1vdmVJbkxhcmdlclN0ZXBzRGVzY3JpcHRpb247XHJcbmNvbnN0IGp1bXBUb0xlZnREZXNjcmlwdGlvblN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuYTExeS5rZXlib2FyZEhlbHAuanVtcFRvTGVmdERlc2NyaXB0aW9uO1xyXG5jb25zdCBqdW1wVG9SaWdodERlc2NyaXB0aW9uU3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5hMTF5LmtleWJvYXJkSGVscC5qdW1wVG9SaWdodERlc2NyaXB0aW9uO1xyXG5jb25zdCBjaGFuZ2VNYXNzUERPTVN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuYTExeS5rZXlib2FyZEhlbHAuY2hhbmdlTWFzc1BET007XHJcbmNvbnN0IGNoYW5nZU1hc3NCYXNpY3NQRE9NU3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5hMTF5LmtleWJvYXJkSGVscC5jaGFuZ2VNYXNzQmFzaWNzUERPTTtcclxuY29uc3QgY2hhbmdlTWFzc0luTGFyZ2VyU3RlcHNEZXNjcmlwdGlvblN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuYTExeS5rZXlib2FyZEhlbHAuY2hhbmdlTWFzc0luTGFyZ2VyU3RlcHNEZXNjcmlwdGlvbjtcclxuY29uc3QgY2hhbmdlTWFzc0luU21hbGxlclN0ZXBzRGVzY3JpcHRpb25TdHJpbmcgPSBHcmF2aXR5Rm9yY2VMYWJTdHJpbmdzLmExMXkua2V5Ym9hcmRIZWxwLmNoYW5nZU1hc3NJblNtYWxsZXJTdGVwc0Rlc2NyaXB0aW9uO1xyXG5jb25zdCBqdW1wVG9NYXhpbXVtTWFzc0Rlc2NyaXB0aW9uU3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5hMTF5LmtleWJvYXJkSGVscC5qdW1wVG9NYXhpbXVtTWFzc0Rlc2NyaXB0aW9uO1xyXG5jb25zdCBqdW1wVG9NaW5pbXVtTWFzc0Rlc2NyaXB0aW9uU3RyaW5nID0gR3Jhdml0eUZvcmNlTGFiU3RyaW5ncy5hMTF5LmtleWJvYXJkSGVscC5qdW1wVG9NaW5pbXVtTWFzc0Rlc2NyaXB0aW9uO1xyXG5jb25zdCBtb3ZlR3JhYmJlZFJ1bGVyUERPTVN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuYTExeS5rZXlib2FyZEhlbHAubW92ZUdyYWJiZWRSdWxlclBET007XHJcbmNvbnN0IG1vdmVJblNtYWxsZXJTdGVwc1BET01TdHJpbmcgPSBHcmF2aXR5Rm9yY2VMYWJTdHJpbmdzLmExMXkua2V5Ym9hcmRIZWxwLm1vdmVJblNtYWxsZXJTdGVwc1BET007XHJcbmNvbnN0IGp1bXBTdGFydE9mU3BoZXJlUERPTVN0cmluZyA9IEdyYXZpdHlGb3JjZUxhYlN0cmluZ3MuYTExeS5rZXlib2FyZEhlbHAuanVtcFN0YXJ0T2ZTcGhlcmVQRE9NO1xyXG5jb25zdCBqdW1wSG9tZVBET01TdHJpbmcgPSBHcmF2aXR5Rm9yY2VMYWJTdHJpbmdzLmExMXkua2V5Ym9hcmRIZWxwLmp1bXBIb21lUERPTTtcclxuXHJcbmNsYXNzIEdyYXZpdHlGb3JjZUxhYktleWJvYXJkSGVscENvbnRlbnQgZXh0ZW5kcyBUd29Db2x1bW5LZXlib2FyZEhlbHBDb250ZW50IHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBvcHRpb25zICkge1xyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcblxyXG4gICAgICAvLyBvbWl0IHRoZSBcImNoYW5nZSBtYXNzIGluIHNtYWxsZXIgc3RlcHNcIiByb3cgd2hlbiB0cnVlXHJcbiAgICAgIGlzQmFzaWNzOiBmYWxzZVxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIE1hc3MgbW92ZW1lbnQgaGVscCBkaWFsb2cgc2VjdGlvblxyXG4gICAgLy8gbW92ZSBtYXNzIHNlY3Rpb25cclxuICAgIGNvbnN0IG1vdmVNYXNzUm93ID0gS2V5Ym9hcmRIZWxwU2VjdGlvblJvdy5sYWJlbFdpdGhJY29uKFxyXG4gICAgICBtb3ZlU3BoZXJlTGFiZWxTdHJpbmcsIEtleWJvYXJkSGVscEljb25GYWN0b3J5LmxlZnRSaWdodEFycm93S2V5c1Jvd0ljb24oKSwge1xyXG4gICAgICAgIGxhYmVsSW5uZXJDb250ZW50OiBtb3ZlU3BoZXJlRGVzY3JpcHRpb25TdHJpbmdcclxuICAgICAgfSApO1xyXG5cclxuICAgIGNvbnN0IG1vdmVTbWFsbFN0ZXBzUm93ID0gS2V5Ym9hcmRIZWxwU2VjdGlvblJvdy5sYWJlbFdpdGhJY29uKFxyXG4gICAgICBtb3ZlSW5TbWFsbGVyU3RlcHNTdHJpbmcsXHJcbiAgICAgIEtleWJvYXJkSGVscEljb25GYWN0b3J5LnNoaWZ0UGx1c0ljb24oIEtleWJvYXJkSGVscEljb25GYWN0b3J5LmxlZnRSaWdodEFycm93S2V5c1Jvd0ljb24oKSApLFxyXG4gICAgICB7XHJcbiAgICAgICAgbGFiZWxJbm5lckNvbnRlbnQ6IG1vdmVJblNtYWxsZXJTdGVwc0Rlc2NyaXB0aW9uU3RyaW5nXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAvLyAnbW92ZSBpbiBsYXJnZXIgc3RlcHMnIHNlY3Rpb25cclxuICAgIGNvbnN0IG1vdmVMYXJnZVN0ZXBzUm93ID0gS2V5Ym9hcmRIZWxwU2VjdGlvblJvdy5sYWJlbFdpdGhJY29uKFxyXG4gICAgICBtb3ZlSW5MYXJnZXJTdGVwc1N0cmluZywgS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkucGFnZVVwUGFnZURvd25Sb3dJY29uKCksIHtcclxuICAgICAgICBsYWJlbElubmVyQ29udGVudDogbW92ZUluTGFyZ2VyU3RlcHNEZXNjcmlwdGlvblN0cmluZ1xyXG4gICAgICB9ICk7XHJcblxyXG4gICAgLy8gJ2p1bXAgdG8gbGVmdCcgc2VjdGlvblxyXG4gICAgY29uc3QganVtcExlZnRSb3cgPSBLZXlib2FyZEhlbHBTZWN0aW9uUm93LmxhYmVsV2l0aEljb24oIGp1bXBUb0xlZnRTdHJpbmcsIFRleHRLZXlOb2RlLmhvbWUoKSwge1xyXG4gICAgICBsYWJlbElubmVyQ29udGVudDoganVtcFRvTGVmdERlc2NyaXB0aW9uU3RyaW5nXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gJ2p1bXAgdG8gcmlnaHQnIHNlY3Rpb25cclxuICAgIGNvbnN0IGp1bXBSaWdodFJvdyA9IEtleWJvYXJkSGVscFNlY3Rpb25Sb3cubGFiZWxXaXRoSWNvbigganVtcFRvUmlnaHRTdHJpbmcsIFRleHRLZXlOb2RlLmVuZCgpLCB7XHJcbiAgICAgIGxhYmVsSW5uZXJDb250ZW50OiBqdW1wVG9SaWdodERlc2NyaXB0aW9uU3RyaW5nXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgbW92ZU1hc3NSb3dzID0gWyBtb3ZlTWFzc1JvdywgbW92ZVNtYWxsU3RlcHNSb3csIG1vdmVMYXJnZVN0ZXBzUm93LCBqdW1wTGVmdFJvdywganVtcFJpZ2h0Um93IF07XHJcbiAgICBjb25zdCBtb3ZlTWFzc0hlbHBTZWN0aW9uID0gbmV3IEtleWJvYXJkSGVscFNlY3Rpb24oIG1vdmVTcGhlcmVzSGVhZGluZ1N0cmluZywgbW92ZU1hc3NSb3dzICk7XHJcblxyXG4gICAgLy8gTWFzcyBhZGp1c3RtZW50IGhlbHAgc2VjdGlvblxyXG4gICAgY29uc3QgY2hhbmdlTWFzc0ljb24gPSBvcHRpb25zLmlzQmFzaWNzID8gS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkudXBEb3duQXJyb3dLZXlzUm93SWNvbigpIDogS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkubGVmdFJpZ2h0QXJyb3dLZXlzUm93SWNvbigpO1xyXG5cclxuICAgIC8vIFN1cnJvdW5kZWQgaW4gTm9kZSBmb3IgREFHIGxheW91dCBjb25zdHJhaW50cy4gT3RoZXJ3aXNlIGNoYW5nZU1hc3NJY29uIHdpbGwgYmUgcG9zaXRpb25lZCBvdmVyd3JpdHRlbi5cclxuICAgIGNvbnN0IHNoaWZ0UGx1c0NoYW5nZU1hc3NJY29uID0gS2V5Ym9hcmRIZWxwSWNvbkZhY3Rvcnkuc2hpZnRQbHVzSWNvbiggbmV3IE5vZGUoIHsgY2hpbGRyZW46IFsgY2hhbmdlTWFzc0ljb24gXSB9ICkgKTtcclxuICAgIGNvbnN0IGNoYW5nZU1hc3NSb3cgPSBLZXlib2FyZEhlbHBTZWN0aW9uUm93LmxhYmVsV2l0aEljb24oIGNoYW5nZU1hc3NMYWJlbFN0cmluZywgY2hhbmdlTWFzc0ljb24sIHtcclxuICAgICAgbGFiZWxJbm5lckNvbnRlbnQ6IG9wdGlvbnMuaXNCYXNpY3MgPyBjaGFuZ2VNYXNzQmFzaWNzUERPTVN0cmluZyA6IGNoYW5nZU1hc3NQRE9NU3RyaW5nXHJcbiAgICB9ICk7IC8vIHVwL2Rvd24gdnMgbGVmdC9yaWdodFxyXG4gICAgY29uc3QgY2hhbmdlTWFzc1NtYWxsU3RlcHNSb3cgPSBLZXlib2FyZEhlbHBTZWN0aW9uUm93LmxhYmVsV2l0aEljb24oXHJcbiAgICAgIGNoYW5nZU1hc3NJblNtYWxsZXJTdGVwc1N0cmluZywgc2hpZnRQbHVzQ2hhbmdlTWFzc0ljb24sIHtcclxuICAgICAgICBsYWJlbElubmVyQ29udGVudDogY2hhbmdlTWFzc0luU21hbGxlclN0ZXBzRGVzY3JpcHRpb25TdHJpbmdcclxuICAgICAgfSApO1xyXG4gICAgY29uc3QgY2hhbmdlTWFzc0xhcmdlU3RlcHNSb3cgPSBLZXlib2FyZEhlbHBTZWN0aW9uUm93LmxhYmVsV2l0aEljb24oXHJcbiAgICAgIGNoYW5nZU1hc3NJbkxhcmdlclN0ZXBzU3RyaW5nLCBLZXlib2FyZEhlbHBJY29uRmFjdG9yeS5wYWdlVXBQYWdlRG93blJvd0ljb24oKSwge1xyXG4gICAgICAgIGxhYmVsSW5uZXJDb250ZW50OiBjaGFuZ2VNYXNzSW5MYXJnZXJTdGVwc0Rlc2NyaXB0aW9uU3RyaW5nXHJcbiAgICAgIH0gKTtcclxuICAgIGNvbnN0IGp1bXBUb01pbk1hc3NSb3cgPSBLZXlib2FyZEhlbHBTZWN0aW9uUm93LmxhYmVsV2l0aEljb24oXHJcbiAgICAgIGp1bXBUb01pbmltdW1NYXNzU3RyaW5nLCBUZXh0S2V5Tm9kZS5ob21lKCksIHtcclxuICAgICAgICBsYWJlbElubmVyQ29udGVudDoganVtcFRvTWluaW11bU1hc3NEZXNjcmlwdGlvblN0cmluZ1xyXG4gICAgICB9ICk7XHJcbiAgICBjb25zdCBqdW1wVG9NYXhNYXNzUm93ID0gS2V5Ym9hcmRIZWxwU2VjdGlvblJvdy5sYWJlbFdpdGhJY29uKFxyXG4gICAgICBqdW1wVG9NYXhpbXVtTWFzc1N0cmluZywgVGV4dEtleU5vZGUuZW5kKCksIHtcclxuICAgICAgICBsYWJlbElubmVyQ29udGVudDoganVtcFRvTWF4aW11bU1hc3NEZXNjcmlwdGlvblN0cmluZ1xyXG4gICAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgYWRqdXN0TWFzc1Jvd3MgPSBbXHJcbiAgICAgIGNoYW5nZU1hc3NSb3csXHJcbiAgICAgIGNoYW5nZU1hc3NTbWFsbFN0ZXBzUm93LFxyXG4gICAgICBjaGFuZ2VNYXNzTGFyZ2VTdGVwc1JvdyxcclxuICAgICAganVtcFRvTWluTWFzc1JvdyxcclxuICAgICAganVtcFRvTWF4TWFzc1Jvd1xyXG4gICAgXTtcclxuXHJcbiAgICAvLyBsZWF2ZSBvdXQgcm93IGlmIG9wdGlvbiBpcyBzdXBwbGllZFxyXG4gICAgaWYgKCBvcHRpb25zLmlzQmFzaWNzICkge1xyXG4gICAgICBhZGp1c3RNYXNzUm93cy5zcGxpY2UoIGFkanVzdE1hc3NSb3dzLmluZGV4T2YoIGNoYW5nZU1hc3NTbWFsbFN0ZXBzUm93ICksIDEgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBhZGp1c3RNYXNzSGVscFNlY3Rpb24gPSBuZXcgS2V5Ym9hcmRIZWxwU2VjdGlvbiggY2hhbmdlTWFzc0hlYWRpbmdTdHJpbmcsIGFkanVzdE1hc3NSb3dzICk7XHJcblxyXG4gICAgLy8gYWxpZ24gaWNvbnMgZm9yIHRoZSBtYXNzIG1vdmVtZW50IGFuZCBhZGp1c3RtZW50IHNlY3Rpb25zXHJcbiAgICBLZXlib2FyZEhlbHBTZWN0aW9uLmFsaWduSGVscFNlY3Rpb25JY29ucyggWyBtb3ZlTWFzc0hlbHBTZWN0aW9uLCBhZGp1c3RNYXNzSGVscFNlY3Rpb24gXSApO1xyXG5cclxuICAgIGNvbnN0IGJhc2ljQWN0aW9uc0hlbHBTZWN0aW9uID0gbmV3IEJhc2ljQWN0aW9uc0tleWJvYXJkSGVscFNlY3Rpb24oIHtcclxuICAgICAgd2l0aENoZWNrYm94Q29udGVudDogdHJ1ZVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGdyYWJEcmFnSGVscENvbnRlbnQgPSBuZXcgR3JhYlJlbGVhc2VLZXlib2FyZEhlbHBTZWN0aW9uKFxyXG4gICAgICBTY2VuZXJ5UGhldFN0cmluZ3MucnVsZXJDYXBpdGFsaXplZFN0cmluZ1Byb3BlcnR5LFxyXG4gICAgICBTY2VuZXJ5UGhldFN0cmluZ3MucnVsZXJTdHJpbmdQcm9wZXJ0eSApO1xyXG5cclxuICAgIGNvbnN0IGxlZnRDb250ZW50ID0gWyBtb3ZlTWFzc0hlbHBTZWN0aW9uLCBhZGp1c3RNYXNzSGVscFNlY3Rpb24gXTtcclxuICAgIGNvbnN0IHJpZ2h0Q29udGVudCA9IFsgYmFzaWNBY3Rpb25zSGVscFNlY3Rpb24gXTtcclxuXHJcbiAgICBpZiAoICFvcHRpb25zLmlzQmFzaWNzICkge1xyXG4gICAgICByaWdodENvbnRlbnQudW5zaGlmdCggZ3JhYkRyYWdIZWxwQ29udGVudCwgbmV3IE1vdmVPckp1bXBHcmFiYmVkUnVsZXJIZWxwU2VjdGlvbigpICk7XHJcbiAgICB9XHJcblxyXG4gICAgc3VwZXIoIGxlZnRDb250ZW50LCByaWdodENvbnRlbnQgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuY2xhc3MgTW92ZU9ySnVtcEdyYWJiZWRSdWxlckhlbHBTZWN0aW9uIGV4dGVuZHMgS2V5Ym9hcmRIZWxwU2VjdGlvbiB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvciggb3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBtb3ZlUnVsZXJJY29uID0gS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkuYXJyb3dPcldhc2RLZXlzUm93SWNvbigpO1xyXG4gICAgY29uc3QgbW92ZVJ1bGVyUm93ID0gS2V5Ym9hcmRIZWxwU2VjdGlvblJvdy5sYWJlbFdpdGhJY29uKCBtb3ZlR3JhYmJlZFJ1bGVyU3RyaW5nLCBtb3ZlUnVsZXJJY29uLCB7XHJcbiAgICAgIGxhYmVsSW5uZXJDb250ZW50OiBtb3ZlR3JhYmJlZFJ1bGVyUERPTVN0cmluZ1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHNoaWZ0UGx1c0Fycm93S2V5cyA9IEtleWJvYXJkSGVscEljb25GYWN0b3J5LnNoaWZ0UGx1c0ljb24oIEtleWJvYXJkSGVscEljb25GYWN0b3J5LmFycm93S2V5c1Jvd0ljb24oKSApO1xyXG4gICAgY29uc3Qgc2hpZnRQbHVzV0FTREtleXMgPSBLZXlib2FyZEhlbHBJY29uRmFjdG9yeS5zaGlmdFBsdXNJY29uKCBLZXlib2FyZEhlbHBJY29uRmFjdG9yeS53YXNkUm93SWNvbigpICk7XHJcbiAgICBjb25zdCBtb3ZlSW5TbWFsbGVyU3RlcHNSb3cgPSBLZXlib2FyZEhlbHBTZWN0aW9uUm93LmxhYmVsV2l0aEljb25MaXN0KCBtb3ZlSW5TbWFsbGVyU3RlcHNTdHJpbmcsXHJcbiAgICAgIFsgc2hpZnRQbHVzQXJyb3dLZXlzLCBzaGlmdFBsdXNXQVNES2V5cyBdLCB7XHJcbiAgICAgICAgbGFiZWxJbm5lckNvbnRlbnQ6IG1vdmVJblNtYWxsZXJTdGVwc1BET01TdHJpbmdcclxuICAgICAgfSApO1xyXG5cclxuXHJcbiAgICBjb25zdCBqdW1wU3RhcnRSb3cgPSBLZXlib2FyZEhlbHBTZWN0aW9uUm93LmNyZWF0ZUp1bXBLZXlSb3coICdDJyxcclxuICAgICAganVtcFN0YXJ0T2ZTcGhlcmVTdHJpbmcsIHtcclxuICAgICAgICBsYWJlbElubmVyQ29udGVudDoganVtcFN0YXJ0T2ZTcGhlcmVQRE9NU3RyaW5nXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBqdW1wSG9tZVJvdyA9IEtleWJvYXJkSGVscFNlY3Rpb25Sb3cuY3JlYXRlSnVtcEtleVJvdyggJ0gnLCBqdW1wSG9tZVN0cmluZywge1xyXG4gICAgICBsYWJlbElubmVyQ29udGVudDoganVtcEhvbWVQRE9NU3RyaW5nXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3Qgcm93cyA9IFsganVtcFN0YXJ0Um93LCBqdW1wSG9tZVJvdywgbW92ZVJ1bGVyUm93LCBtb3ZlSW5TbWFsbGVyU3RlcHNSb3cgXTtcclxuICAgIHN1cGVyKCBtb3ZlT3JKdW1wR3JhYmJlZFJ1bGVyU3RyaW5nLCByb3dzLCBvcHRpb25zICk7XHJcbiAgICB0aGlzLmRpc3Bvc2VFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiByb3dzLmZvckVhY2goIHJvdyA9PiByb3cuZGlzcG9zZSgpICkgKTtcclxuXHJcbiAgfVxyXG59XHJcblxyXG5ncmF2aXR5Rm9yY2VMYWIucmVnaXN0ZXIoICdHcmF2aXR5Rm9yY2VMYWJLZXlib2FyZEhlbHBDb250ZW50JywgR3Jhdml0eUZvcmNlTGFiS2V5Ym9hcmRIZWxwQ29udGVudCApO1xyXG5leHBvcnQgZGVmYXVsdCBHcmF2aXR5Rm9yY2VMYWJLZXlib2FyZEhlbHBDb250ZW50OyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsS0FBSyxNQUFNLGdDQUFnQztBQUNsRCxPQUFPQywrQkFBK0IsTUFBTSwyRUFBMkU7QUFDdkgsT0FBT0MsOEJBQThCLE1BQU0sMEVBQTBFO0FBQ3JILE9BQU9DLHVCQUF1QixNQUFNLG1FQUFtRTtBQUN2RyxPQUFPQyxtQkFBbUIsTUFBTSwrREFBK0Q7QUFDL0YsT0FBT0Msc0JBQXNCLE1BQU0sa0VBQWtFO0FBQ3JHLE9BQU9DLDRCQUE0QixNQUFNLHdFQUF3RTtBQUNqSCxPQUFPQyxXQUFXLE1BQU0sa0RBQWtEO0FBQzFFLE9BQU9DLGtCQUFrQixNQUFNLGdEQUFnRDtBQUMvRSxTQUFTQyxJQUFJLFFBQVEsZ0NBQWdDO0FBQ3JELE9BQU9DLGVBQWUsTUFBTSx1QkFBdUI7QUFDbkQsT0FBT0Msc0JBQXNCLE1BQU0sOEJBQThCO0FBRWpFLE1BQU1DLHVCQUF1QixHQUFHRCxzQkFBc0IsQ0FBQ0UsaUJBQWlCO0FBQ3hFLE1BQU1DLDZCQUE2QixHQUFHSCxzQkFBc0IsQ0FBQ0ksdUJBQXVCO0FBQ3BGLE1BQU1DLDhCQUE4QixHQUFHTCxzQkFBc0IsQ0FBQ00sd0JBQXdCO0FBQ3RGLE1BQU1DLHFCQUFxQixHQUFHUCxzQkFBc0IsQ0FBQ1EsZUFBZTtBQUNwRSxNQUFNQyxnQkFBZ0IsR0FBR1Qsc0JB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