// Copyright 2019-2022, University of Colorado Boulder

/**
 * BaseContainer is the base class for containers in all screens. This is a rectangular container for particles,
 * with fixed position, fixed height and depth, and mutable width. The origin is at the bottom-right corner, and
 * width expands to the left.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Bounds2 from '../../../../dot/js/Bounds2.js';
import RangeWithValue from '../../../../dot/js/RangeWithValue.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import optionize from '../../../../phet-core/js/optionize.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import gasProperties from '../../gasProperties.js';
export default class BaseContainer {
  // position of the container's bottom right corner, in pm
  // range and initial value of the container's width, in pm
  // width of the container, in pm
  // height of the container, in pm
  // depth of the container, in pm
  // wall thickness, in pm
  // volume of the container, in pm^3
  // inside bounds, in pm
  // maximum inside bounds, in pm. Used for sizing the CanvasNode that draws the particle system inside the container.
  // velocity of the left (movable) wall, pm/ps. This vector will be MUTATED!
  // Indicates whether the user is adjusting widthProperty. The width will also change automatically in
  // HoldConstant 'pressureV' mode. This is used to suppress model updates in the Ideal screen, when the user
  // is resizing the container with the sim paused.  See #125.
  constructor(providedOptions) {
    const options = optionize()({
      // SelfOptions
      position: Vector2.ZERO,
      widthRange: new RangeWithValue(5000, 15000, 10000)
    }, providedOptions);
    this.position = options.position;
    this.widthRange = options.widthRange;
    this.widthProperty = new NumberProperty(this.widthRange.defaultValue, {
      range: this.widthRange,
      units: 'pm',
      reentrant: true,
      // Occurring in PhET-iO State setting
      tandem: options.tandem.createTandem('widthProperty'),
      phetioReadOnly: true
    });
    this.height = 8750;
    this.depth = 4000;
    this.wallThickness = 75;
    this.volumeProperty = new DerivedProperty([this.widthProperty], width => width * this.height * this.depth, {
      units: 'pm^3',
      isValidValue: value => value > 0,
      tandem: options.tandem.createTandem('volumeProperty'),
      phetioValueType: NumberIO
    });
    this.boundsProperty = new DerivedProperty([this.widthProperty], width => new Bounds2(this.position.x - width, this.position.y, this.position.x, this.position.y + this.height), {
      valueType: Bounds2
    });
    this.maxBounds = new Bounds2(this.position.x - this.widthRange.max, this.position.y, this.position.x, this.position.y + this.height);
    this.leftWallVelocity = new Vector2(0, 0);
    this.userIsAdjustingWidthProperty = new BooleanProperty(false);
  }
  reset() {
    this.widthProperty.reset();
  }

  /**
   * Convenience getter for width, in pm
   */
  get width() {
    return this.widthProperty.value;
  }

  /**
   * Convenience getter for inside bounds, in pm.
   */
  get bounds() {
    return this.boundsProperty.value;
  }

  /**
   * Convenience getters for inside bounds of the container, in model coordinate frame (pm).
   * Bounds2 has similar getters, but uses a view coordinate frame, where 'top' is minY and 'bottom' is maxY.
   */
  get left() {
    return this.bounds.minX;
  }
  get right() {
    return this.bounds.maxX;
  }
  get bottom() {
    return this.bounds.minY;
  }
  get top() {
    return this.bounds.maxY;
  }

  /**
   * Determines whether the container fully contains a particle.
   */
  containsParticle(particle) {
    return particle.left >= this.bounds.minX && particle.right <= this.bounds.maxX && particle.bottom >= this.bounds.minY && particle.top <= this.bounds.maxY;
  }

  /**
   * Determines whether the container fully contains one or more collections of particles.
   */
  containsParticles(particleArrays) {
    assert && assert(Array.isArray(particleArrays), `invalid particlesArray: ${particleArrays}`);
    for (let i = particleArrays.length - 1; i >= 0; i--) {
      const particles = particleArrays[i];
      for (let j = particles.length - 1; j >= 0; j--) {
        const particle = particles[j];
        if (!this.containsParticle(particle)) {
          return false;
        }
      }
    }
    return true;
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
  }
}
gasProperties.register('BaseContainer', BaseContainer);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJEZXJpdmVkUHJvcGVydHkiLCJOdW1iZXJQcm9wZXJ0eSIsIkJvdW5kczIiLCJSYW5nZVdpdGhWYWx1ZSIsIlZlY3RvcjIiLCJvcHRpb25pemUiLCJOdW1iZXJJTyIsImdhc1Byb3BlcnRpZXMiLCJCYXNlQ29udGFpbmVyIiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwicG9zaXRpb24iLCJaRVJPIiwid2lkdGhSYW5nZSIsIndpZHRoUHJvcGVydHkiLCJkZWZhdWx0VmFsdWUiLCJyYW5nZSIsInVuaXRzIiwicmVlbnRyYW50IiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwicGhldGlvUmVhZE9ubHkiLCJoZWlnaHQiLCJkZXB0aCIsIndhbGxUaGlja25lc3MiLCJ2b2x1bWVQcm9wZXJ0eSIsIndpZHRoIiwiaXNWYWxpZFZhbHVlIiwidmFsdWUiLCJwaGV0aW9WYWx1ZVR5cGUiLCJib3VuZHNQcm9wZXJ0eSIsIngiLCJ5IiwidmFsdWVUeXBlIiwibWF4Qm91bmRzIiwibWF4IiwibGVmdFdhbGxWZWxvY2l0eSIsInVzZXJJc0FkanVzdGluZ1dpZHRoUHJvcGVydHkiLCJyZXNldCIsImJvdW5kcyIsImxlZnQiLCJtaW5YIiwicmlnaHQiLCJtYXhYIiwiYm90dG9tIiwibWluWSIsInRvcCIsIm1heFkiLCJjb250YWluc1BhcnRpY2xlIiwicGFydGljbGUiLCJjb250YWluc1BhcnRpY2xlcyIsInBhcnRpY2xlQXJyYXlzIiwiYXNzZXJ0IiwiQXJyYXkiLCJpc0FycmF5IiwiaSIsImxlbmd0aCIsInBhcnRpY2xlcyIsImoiLCJkaXNwb3NlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJCYXNlQ29udGFpbmVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE5LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEJhc2VDb250YWluZXIgaXMgdGhlIGJhc2UgY2xhc3MgZm9yIGNvbnRhaW5lcnMgaW4gYWxsIHNjcmVlbnMuIFRoaXMgaXMgYSByZWN0YW5ndWxhciBjb250YWluZXIgZm9yIHBhcnRpY2xlcyxcclxuICogd2l0aCBmaXhlZCBwb3NpdGlvbiwgZml4ZWQgaGVpZ2h0IGFuZCBkZXB0aCwgYW5kIG11dGFibGUgd2lkdGguIFRoZSBvcmlnaW4gaXMgYXQgdGhlIGJvdHRvbS1yaWdodCBjb3JuZXIsIGFuZFxyXG4gKiB3aWR0aCBleHBhbmRzIHRvIHRoZSBsZWZ0LlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBCb29sZWFuUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Cb29sZWFuUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgUmFuZ2VXaXRoVmFsdWUgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlV2l0aFZhbHVlLmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgeyBQaGV0aW9PYmplY3RPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1BoZXRpb09iamVjdC5qcyc7XHJcbmltcG9ydCBOdW1iZXJJTyBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvTnVtYmVySU8uanMnO1xyXG5pbXBvcnQgZ2FzUHJvcGVydGllcyBmcm9tICcuLi8uLi9nYXNQcm9wZXJ0aWVzLmpzJztcclxuaW1wb3J0IFBhcnRpY2xlIGZyb20gJy4vUGFydGljbGUuanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuICBwb3NpdGlvbj86IFZlY3RvcjI7IC8vIHBvc2l0aW9uIG9mIHRoZSBjb250YWluZXIncyBib3R0b20gcmlnaHQgY29ybmVyLCBpbiBwbVxyXG4gIHdpZHRoUmFuZ2U/OiBSYW5nZVdpdGhWYWx1ZTsgLy8gcmFuZ2UgYW5kIGluaXRpYWwgdmFsdWUgb2YgdGhlIGNvbnRhaW5lcidzIHdpZHRoLCBpbiBwbVxyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgQmFzZUNvbnRhaW5lck9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBpY2tSZXF1aXJlZDxQaGV0aW9PYmplY3RPcHRpb25zLCAndGFuZGVtJz47XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCYXNlQ29udGFpbmVyIHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IHBvc2l0aW9uOiBWZWN0b3IyOyAvLyBwb3NpdGlvbiBvZiB0aGUgY29udGFpbmVyJ3MgYm90dG9tIHJpZ2h0IGNvcm5lciwgaW4gcG1cclxuICBwdWJsaWMgcmVhZG9ubHkgd2lkdGhSYW5nZTogUmFuZ2VXaXRoVmFsdWU7IC8vIHJhbmdlIGFuZCBpbml0aWFsIHZhbHVlIG9mIHRoZSBjb250YWluZXIncyB3aWR0aCwgaW4gcG1cclxuICBwdWJsaWMgcmVhZG9ubHkgd2lkdGhQcm9wZXJ0eTogTnVtYmVyUHJvcGVydHk7IC8vIHdpZHRoIG9mIHRoZSBjb250YWluZXIsIGluIHBtXHJcbiAgcHVibGljIHJlYWRvbmx5IGhlaWdodDogbnVtYmVyOyAvLyBoZWlnaHQgb2YgdGhlIGNvbnRhaW5lciwgaW4gcG1cclxuICBwdWJsaWMgcmVhZG9ubHkgZGVwdGg6IG51bWJlcjsgLy8gZGVwdGggb2YgdGhlIGNvbnRhaW5lciwgaW4gcG1cclxuICBwdWJsaWMgcmVhZG9ubHkgd2FsbFRoaWNrbmVzczogbnVtYmVyOyAvLyB3YWxsIHRoaWNrbmVzcywgaW4gcG1cclxuICBwdWJsaWMgcmVhZG9ubHkgdm9sdW1lUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47IC8vIHZvbHVtZSBvZiB0aGUgY29udGFpbmVyLCBpbiBwbV4zXHJcbiAgcHVibGljIHJlYWRvbmx5IGJvdW5kc1Byb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxCb3VuZHMyPjsgLy8gaW5zaWRlIGJvdW5kcywgaW4gcG1cclxuXHJcbiAgLy8gbWF4aW11bSBpbnNpZGUgYm91bmRzLCBpbiBwbS4gVXNlZCBmb3Igc2l6aW5nIHRoZSBDYW52YXNOb2RlIHRoYXQgZHJhd3MgdGhlIHBhcnRpY2xlIHN5c3RlbSBpbnNpZGUgdGhlIGNvbnRhaW5lci5cclxuICBwdWJsaWMgcmVhZG9ubHkgbWF4Qm91bmRzOiBCb3VuZHMyO1xyXG5cclxuICAvLyB2ZWxvY2l0eSBvZiB0aGUgbGVmdCAobW92YWJsZSkgd2FsbCwgcG0vcHMuIFRoaXMgdmVjdG9yIHdpbGwgYmUgTVVUQVRFRCFcclxuICBwdWJsaWMgcmVhZG9ubHkgbGVmdFdhbGxWZWxvY2l0eTogVmVjdG9yMjtcclxuXHJcbiAgLy8gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHVzZXIgaXMgYWRqdXN0aW5nIHdpZHRoUHJvcGVydHkuIFRoZSB3aWR0aCB3aWxsIGFsc28gY2hhbmdlIGF1dG9tYXRpY2FsbHkgaW5cclxuICAvLyBIb2xkQ29uc3RhbnQgJ3ByZXNzdXJlVicgbW9kZS4gVGhpcyBpcyB1c2VkIHRvIHN1cHByZXNzIG1vZGVsIHVwZGF0ZXMgaW4gdGhlIElkZWFsIHNjcmVlbiwgd2hlbiB0aGUgdXNlclxyXG4gIC8vIGlzIHJlc2l6aW5nIHRoZSBjb250YWluZXIgd2l0aCB0aGUgc2ltIHBhdXNlZC4gIFNlZSAjMTI1LlxyXG4gIHB1YmxpYyByZWFkb25seSB1c2VySXNBZGp1c3RpbmdXaWR0aFByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPjtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBwcm92aWRlZE9wdGlvbnM6IEJhc2VDb250YWluZXJPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8QmFzZUNvbnRhaW5lck9wdGlvbnMsIFNlbGZPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBTZWxmT3B0aW9uc1xyXG4gICAgICBwb3NpdGlvbjogVmVjdG9yMi5aRVJPLFxyXG4gICAgICB3aWR0aFJhbmdlOiBuZXcgUmFuZ2VXaXRoVmFsdWUoIDUwMDAsIDE1MDAwLCAxMDAwMCApXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLnBvc2l0aW9uID0gb3B0aW9ucy5wb3NpdGlvbjtcclxuICAgIHRoaXMud2lkdGhSYW5nZSA9IG9wdGlvbnMud2lkdGhSYW5nZTtcclxuXHJcbiAgICB0aGlzLndpZHRoUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIHRoaXMud2lkdGhSYW5nZS5kZWZhdWx0VmFsdWUsIHtcclxuICAgICAgcmFuZ2U6IHRoaXMud2lkdGhSYW5nZSxcclxuICAgICAgdW5pdHM6ICdwbScsXHJcbiAgICAgIHJlZW50cmFudDogdHJ1ZSwgLy8gT2NjdXJyaW5nIGluIFBoRVQtaU8gU3RhdGUgc2V0dGluZ1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3dpZHRoUHJvcGVydHknICksXHJcbiAgICAgIHBoZXRpb1JlYWRPbmx5OiB0cnVlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5oZWlnaHQgPSA4NzUwO1xyXG4gICAgdGhpcy5kZXB0aCA9IDQwMDA7XHJcbiAgICB0aGlzLndhbGxUaGlja25lc3MgPSA3NTtcclxuXHJcbiAgICB0aGlzLnZvbHVtZVByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyB0aGlzLndpZHRoUHJvcGVydHkgXSxcclxuICAgICAgd2lkdGggPT4gd2lkdGggKiB0aGlzLmhlaWdodCAqIHRoaXMuZGVwdGgsIHtcclxuICAgICAgICB1bml0czogJ3BtXjMnLFxyXG4gICAgICAgIGlzVmFsaWRWYWx1ZTogdmFsdWUgPT4gKCB2YWx1ZSA+IDAgKSxcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3ZvbHVtZVByb3BlcnR5JyApLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVtYmVySU9cclxuICAgICAgfSApO1xyXG5cclxuICAgIHRoaXMuYm91bmRzUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHRoaXMud2lkdGhQcm9wZXJ0eSBdLFxyXG4gICAgICB3aWR0aCA9PiBuZXcgQm91bmRzMihcclxuICAgICAgICB0aGlzLnBvc2l0aW9uLnggLSB3aWR0aCwgdGhpcy5wb3NpdGlvbi55LFxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueCwgdGhpcy5wb3NpdGlvbi55ICsgdGhpcy5oZWlnaHRcclxuICAgICAgKSwge1xyXG4gICAgICAgIHZhbHVlVHlwZTogQm91bmRzMlxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5tYXhCb3VuZHMgPSBuZXcgQm91bmRzMihcclxuICAgICAgdGhpcy5wb3NpdGlvbi54IC0gdGhpcy53aWR0aFJhbmdlLm1heCwgdGhpcy5wb3NpdGlvbi55LFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLngsIHRoaXMucG9zaXRpb24ueSArIHRoaXMuaGVpZ2h0XHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMubGVmdFdhbGxWZWxvY2l0eSA9IG5ldyBWZWN0b3IyKCAwLCAwICk7XHJcblxyXG4gICAgdGhpcy51c2VySXNBZGp1c3RpbmdXaWR0aFByb3BlcnR5ID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyByZXNldCgpOiB2b2lkIHtcclxuICAgIHRoaXMud2lkdGhQcm9wZXJ0eS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ29udmVuaWVuY2UgZ2V0dGVyIGZvciB3aWR0aCwgaW4gcG1cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IHdpZHRoKCk6IG51bWJlciB7IHJldHVybiB0aGlzLndpZHRoUHJvcGVydHkudmFsdWU7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ29udmVuaWVuY2UgZ2V0dGVyIGZvciBpbnNpZGUgYm91bmRzLCBpbiBwbS5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IGJvdW5kcygpOiBCb3VuZHMyIHsgcmV0dXJuIHRoaXMuYm91bmRzUHJvcGVydHkudmFsdWU7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ29udmVuaWVuY2UgZ2V0dGVycyBmb3IgaW5zaWRlIGJvdW5kcyBvZiB0aGUgY29udGFpbmVyLCBpbiBtb2RlbCBjb29yZGluYXRlIGZyYW1lIChwbSkuXHJcbiAgICogQm91bmRzMiBoYXMgc2ltaWxhciBnZXR0ZXJzLCBidXQgdXNlcyBhIHZpZXcgY29vcmRpbmF0ZSBmcmFtZSwgd2hlcmUgJ3RvcCcgaXMgbWluWSBhbmQgJ2JvdHRvbScgaXMgbWF4WS5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IGxlZnQoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMuYm91bmRzLm1pblg7IH1cclxuXHJcbiAgcHVibGljIGdldCByaWdodCgpOiBudW1iZXIgeyByZXR1cm4gdGhpcy5ib3VuZHMubWF4WDsgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGJvdHRvbSgpOiBudW1iZXIgeyByZXR1cm4gdGhpcy5ib3VuZHMubWluWTsgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHRvcCgpOiBudW1iZXIgeyByZXR1cm4gdGhpcy5ib3VuZHMubWF4WTsgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGNvbnRhaW5lciBmdWxseSBjb250YWlucyBhIHBhcnRpY2xlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb250YWluc1BhcnRpY2xlKCBwYXJ0aWNsZTogUGFydGljbGUgKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gcGFydGljbGUubGVmdCA+PSB0aGlzLmJvdW5kcy5taW5YICYmXHJcbiAgICAgICAgICAgcGFydGljbGUucmlnaHQgPD0gdGhpcy5ib3VuZHMubWF4WCAmJlxyXG4gICAgICAgICAgIHBhcnRpY2xlLmJvdHRvbSA+PSB0aGlzLmJvdW5kcy5taW5ZICYmXHJcbiAgICAgICAgICAgcGFydGljbGUudG9wIDw9IHRoaXMuYm91bmRzLm1heFk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGNvbnRhaW5lciBmdWxseSBjb250YWlucyBvbmUgb3IgbW9yZSBjb2xsZWN0aW9ucyBvZiBwYXJ0aWNsZXMuXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnRhaW5zUGFydGljbGVzKCBwYXJ0aWNsZUFycmF5czogUGFydGljbGVbXVtdICk6IGJvb2xlYW4ge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggQXJyYXkuaXNBcnJheSggcGFydGljbGVBcnJheXMgKSwgYGludmFsaWQgcGFydGljbGVzQXJyYXk6ICR7cGFydGljbGVBcnJheXN9YCApO1xyXG5cclxuICAgIGZvciAoIGxldCBpID0gcGFydGljbGVBcnJheXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XHJcbiAgICAgIGNvbnN0IHBhcnRpY2xlcyA9IHBhcnRpY2xlQXJyYXlzWyBpIF07XHJcbiAgICAgIGZvciAoIGxldCBqID0gcGFydGljbGVzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tICkge1xyXG4gICAgICAgIGNvbnN0IHBhcnRpY2xlID0gcGFydGljbGVzWyBqIF07XHJcbiAgICAgICAgaWYgKCAhdGhpcy5jb250YWluc1BhcnRpY2xlKCBwYXJ0aWNsZSApICkge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gIH1cclxufVxyXG5cclxuZ2FzUHJvcGVydGllcy5yZWdpc3RlciggJ0Jhc2VDb250YWluZXInLCBCYXNlQ29udGFpbmVyICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsY0FBYyxNQUFNLHVDQUF1QztBQUdsRSxPQUFPQyxPQUFPLE1BQU0sK0JBQStCO0FBQ25ELE9BQU9DLGNBQWMsTUFBTSxzQ0FBc0M7QUFDakUsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxTQUFTLE1BQU0sdUNBQXVDO0FBRzdELE9BQU9DLFFBQVEsTUFBTSx5Q0FBeUM7QUFDOUQsT0FBT0MsYUFBYSxNQUFNLHdCQUF3QjtBQVVsRCxlQUFlLE1BQU1DLGFBQWEsQ0FBQztFQUVFO0VBQ1M7RUFDRztFQUNmO0VBQ0Q7RUFDUTtFQUNvQjtFQUNDO0VBRTVEO0VBR0E7RUFHQTtFQUNBO0VBQ0E7RUFHT0MsV0FBV0EsQ0FBRUMsZUFBcUMsRUFBRztJQUUxRCxNQUFNQyxPQUFPLEdBQUdOLFNBQVMsQ0FBb0MsQ0FBQyxDQUFFO01BRTlE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