// Copyright 2018-2023, University of Colorado Boulder

/**
 * CollisionCounterNode displays the number of collisions between particles and the container walls, during
 * some sample period.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import PatternStringProperty from '../../../../axon/js/PatternStringProperty.js';
import Bounds2 from '../../../../dot/js/Bounds2.js';
import Range from '../../../../dot/js/Range.js';
import optionize from '../../../../phet-core/js/optionize.js';
import DragBoundsProperty from '../../../../scenery-phet/js/DragBoundsProperty.js';
import NumberDisplay from '../../../../scenery-phet/js/NumberDisplay.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import ShadedRectangle from '../../../../scenery-phet/js/ShadedRectangle.js';
import { Circle, DragListener, HBox, Node, Rectangle, Text, VBox, VStrut } from '../../../../scenery/js/imports.js';
import ComboBox from '../../../../sun/js/ComboBox.js';
import gasProperties from '../../gasProperties.js';
import GasPropertiesStrings from '../../GasPropertiesStrings.js';
import GasPropertiesColors from '../GasPropertiesColors.js';
import GasPropertiesQueryParameters from '../GasPropertiesQueryParameters.js';
import PlayResetButton from './PlayResetButton.js';

// constants
const X_MARGIN = 15;
const Y_MARGIN = 10;
const X_SPACING = 10;
const Y_SPACING = 5;
const BEZEL_WIDTH = 6;
const NUMBER_DISPLAY_RANGE = new Range(0, 1E6);
const CONTROL_FONT = new PhetFont(14);
const LABEL_FONT = new PhetFont(16);
export default class CollisionCounterNode extends Node {
  constructor(collisionCounter, listboxParent, visibleBoundsProperty, providedOptions) {
    const options = optionize()({
      // NodeOptions
      cursor: 'pointer',
      visibleProperty: collisionCounter.visibleProperty
    }, providedOptions);
    const wallCollisionsText = new Text(GasPropertiesStrings.wallCollisionsStringProperty, {
      pickable: false,
      font: LABEL_FONT,
      maxWidth: 110 // determined empirically
    });

    const valueDisplay = new NumberDisplay(collisionCounter.numberOfCollisionsProperty, NUMBER_DISPLAY_RANGE, {
      backgroundFill: 'white',
      backgroundStroke: 'black',
      textOptions: {
        font: CONTROL_FONT
      },
      xMargin: 8,
      yMargin: 4,
      cornerRadius: 3,
      pickable: false // so we can drag
    });

    const playResetButton = new PlayResetButton(collisionCounter.isRunningProperty, {
      tandem: options.tandem.createTandem('playResetButton')
    });
    const samplePeriodText = new Text(GasPropertiesStrings.samplePeriodStringProperty, {
      pickable: false,
      font: LABEL_FONT,
      left: X_MARGIN,
      maxWidth: 110 // determined empirically
    });

    // Combo box items
    const comboBoxItems = collisionCounter.samplePeriods.map(samplePeriod => {
      return {
        value: samplePeriod,
        createNode: () => {
          // e.g. '10 ps'
          const samplePeriodStringProperty = new PatternStringProperty(GasPropertiesStrings.valueUnitsStringProperty, {
            value: samplePeriod,
            units: GasPropertiesStrings.picosecondsStringProperty
          });
          return new Text(samplePeriodStringProperty, {
            font: CONTROL_FONT,
            maxWidth: 100 // determined empirically
          });
        },

        tandemName: `samplePeriod${samplePeriod}${ComboBox.ITEM_TANDEM_NAME_SUFFIX}`
      };
    });

    // Combo box
    const samplePeriodComboBox = new ComboBox(collisionCounter.samplePeriodProperty, comboBoxItems, listboxParent, {
      listPosition: 'below',
      align: 'right',
      xMargin: 6,
      yMargin: 3,
      cornerRadius: 5,
      tandem: options.tandem.createTandem('samplePeriodComboBox')
    });

    // stuff that appears on the counter
    const content = new VBox({
      align: 'center',
      spacing: Y_SPACING,
      children: [wallCollisionsText, new HBox({
        spacing: X_SPACING,
        children: [valueDisplay, playResetButton]
      }), new VStrut(2), samplePeriodText, samplePeriodComboBox]
    });

    // Background, sized to fit the content
    const rectangleNode = new Rectangle(0, 0, content.width + 2 * X_MARGIN, content.height + 2 * Y_MARGIN, {
      cornerRadius: 6,
      fill: GasPropertiesColors.collisionCounterBackgroundColorProperty,
      stroke: 'black'
    });

    // Pseudo-3D bezel around the outside edge of the rectangle
    const bezelBounds = new Bounds2(0, 0, rectangleNode.width + 2 * BEZEL_WIDTH, rectangleNode.height + 2 * BEZEL_WIDTH);
    const bezelNode = new ShadedRectangle(bezelBounds, {
      baseColor: GasPropertiesColors.collisionCounterBezelColorProperty
    });
    rectangleNode.center = bezelNode.center;

    // The background include the bezel and rectangle.
    const backgroundNode = new Node({
      children: [bezelNode, rectangleNode]
    });
    content.center = backgroundNode.center;
    options.children = [backgroundNode, content];
    super(options);

    // Put a red dot at the origin, for debugging layout.
    if (GasPropertiesQueryParameters.origin) {
      this.addChild(new Circle(3, {
        fill: 'red'
      }));
    }

    // visibility
    this.visibleProperty.link(visible => {
      this.interruptSubtreeInput(); // interrupt user interactions
      if (visible) {
        this.moveToFront();
        listboxParent.moveToFront();
      }
    });

    // Move to the collision counter's position
    collisionCounter.positionProperty.link(position => {
      this.translation = position;
    });

    // drag bounds, adjusted to keep this entire Node inside visible bounds
    const dragBoundsProperty = new DragBoundsProperty(this, visibleBoundsProperty);

    // Interrupt user interactions when the visible bounds change, such as a device orientation change or window resize.
    visibleBoundsProperty.link(() => this.interruptSubtreeInput());

    // If the collision counter is outside the drag bounds, move it inside.
    dragBoundsProperty.link(dragBounds => {
      if (!dragBounds.containsPoint(collisionCounter.positionProperty.value)) {
        collisionCounter.positionProperty.value = dragBounds.closestPointTo(collisionCounter.positionProperty.value);
      }
    });

    // On any form of press, move everything related to this Node to the front.
    const onPress = () => {
      this.moveToFront();
      listboxParent.moveToFront();
    };

    // Dragging, added to background so that other UI components get input events on touch devices.
    // If added to 'this', touchSnag will lock out listeners for other UI components.
    backgroundNode.addInputListener(new DragListener({
      targetNode: this,
      positionProperty: collisionCounter.positionProperty,
      dragBoundsProperty: dragBoundsProperty,
      start: onPress,
      tandem: options.tandem.createTandem('dragListener')
    }));

    // Move to front on pointer down, anywhere on this Node, including interactive subcomponents.
    this.addInputListener({
      down: onPress
    });
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
}
gasProperties.register('CollisionCounterNode', CollisionCounterNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJCb3VuZHMyIiwiUmFuZ2UiLCJvcHRpb25pemUiLCJEcmFnQm91bmRzUHJvcGVydHkiLCJOdW1iZXJEaXNwbGF5IiwiUGhldEZvbnQiLCJTaGFkZWRSZWN0YW5nbGUiLCJDaXJjbGUiLCJEcmFnTGlzdGVuZXIiLCJIQm94IiwiTm9kZSIsIlJlY3RhbmdsZSIsIlRleHQiLCJWQm94IiwiVlN0cnV0IiwiQ29tYm9Cb3giLCJnYXNQcm9wZXJ0aWVzIiwiR2FzUHJvcGVydGllc1N0cmluZ3MiLCJHYXNQcm9wZXJ0aWVzQ29sb3JzIiwiR2FzUHJvcGVydGllc1F1ZXJ5UGFyYW1ldGVycyIsIlBsYXlSZXNldEJ1dHRvbiIsIlhfTUFSR0lOIiwiWV9NQVJHSU4iLCJYX1NQQUNJTkciLCJZX1NQQUNJTkciLCJCRVpFTF9XSURUSCIsIk5VTUJFUl9ESVNQTEFZX1JBTkdFIiwiQ09OVFJPTF9GT05UIiwiTEFCRUxfRk9OVCIsIkNvbGxpc2lvbkNvdW50ZXJOb2RlIiwiY29uc3RydWN0b3IiLCJjb2xsaXNpb25Db3VudGVyIiwibGlzdGJveFBhcmVudCIsInZpc2libGVCb3VuZHNQcm9wZXJ0eSIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJjdXJzb3IiLCJ2aXNpYmxlUHJvcGVydHkiLCJ3YWxsQ29sbGlzaW9uc1RleHQiLCJ3YWxsQ29sbGlzaW9uc1N0cmluZ1Byb3BlcnR5IiwicGlja2FibGUiLCJmb250IiwibWF4V2lkdGgiLCJ2YWx1ZURpc3BsYXkiLCJudW1iZXJPZkNvbGxpc2lvbnNQcm9wZXJ0eSIsImJhY2tncm91bmRGaWxsIiwiYmFja2dyb3VuZFN0cm9rZSIsInRleHRPcHRpb25zIiwieE1hcmdpbiIsInlNYXJnaW4iLCJjb3JuZXJSYWRpdXMiLCJwbGF5UmVzZXRCdXR0b24iLCJpc1J1bm5pbmdQcm9wZXJ0eSIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsInNhbXBsZVBlcmlvZFRleHQiLCJzYW1wbGVQZXJpb2RTdHJpbmdQcm9wZXJ0eSIsImxlZnQiLCJjb21ib0JveEl0ZW1zIiwic2FtcGxlUGVyaW9kcyIsIm1hcCIsInNhbXBsZVBlcmlvZCIsInZhbHVlIiwiY3JlYXRlTm9kZSIsInZhbHVlVW5pdHNTdHJpbmdQcm9wZXJ0eSIsInVuaXRzIiwicGljb3NlY29uZHNTdHJpbmdQcm9wZXJ0eSIsInRhbmRlbU5hbWUiLCJJVEVNX1RBTkRFTV9OQU1FX1NVRkZJWCIsInNhbXBsZVBlcmlvZENvbWJvQm94Iiwic2FtcGxlUGVyaW9kUHJvcGVydHkiLCJsaXN0UG9zaXRpb24iLCJhbGlnbiIsImNvbnRlbnQiLCJzcGFjaW5nIiwiY2hpbGRyZW4iLCJyZWN0YW5nbGVOb2RlIiwid2lkdGgiLCJoZWlnaHQiLCJmaWxsIiwiY29sbGlzaW9uQ291bnRlckJhY2tncm91bmRDb2xvclByb3BlcnR5Iiwic3Ryb2tlIiwiYmV6ZWxCb3VuZHMiLCJiZXplbE5vZGUiLCJiYXNlQ29sb3IiLCJjb2xsaXNpb25Db3VudGVyQmV6ZWxDb2xvclByb3BlcnR5IiwiY2VudGVyIiwiYmFja2dyb3VuZE5vZGUiLCJvcmlnaW4iLCJhZGRDaGlsZCIsImxpbmsiLCJ2aXNpYmxlIiwiaW50ZXJydXB0U3VidHJlZUlucHV0IiwibW92ZVRvRnJvbnQiLCJwb3NpdGlvblByb3BlcnR5IiwicG9zaXRpb24iLCJ0cmFuc2xhdGlvbiIsImRyYWdCb3VuZHNQcm9wZXJ0eSIsImRyYWdCb3VuZHMiLCJjb250YWluc1BvaW50IiwiY2xvc2VzdFBvaW50VG8iLCJvblByZXNzIiwiYWRkSW5wdXRMaXN0ZW5lciIsInRhcmdldE5vZGUiLCJzdGFydCIsImRvd24iLCJkaXNwb3NlIiwiYXNzZXJ0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJDb2xsaXNpb25Db3VudGVyTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOC0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBDb2xsaXNpb25Db3VudGVyTm9kZSBkaXNwbGF5cyB0aGUgbnVtYmVyIG9mIGNvbGxpc2lvbnMgYmV0d2VlbiBwYXJ0aWNsZXMgYW5kIHRoZSBjb250YWluZXIgd2FsbHMsIGR1cmluZ1xyXG4gKiBzb21lIHNhbXBsZSBwZXJpb2QuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1BhdHRlcm5TdHJpbmdQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBFbXB0eVNlbGZPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBQaWNrUmVxdWlyZWQgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1BpY2tSZXF1aXJlZC5qcyc7XHJcbmltcG9ydCBEcmFnQm91bmRzUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL0RyYWdCb3VuZHNQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBOdW1iZXJEaXNwbGF5IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9OdW1iZXJEaXNwbGF5LmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCBTaGFkZWRSZWN0YW5nbGUgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1NoYWRlZFJlY3RhbmdsZS5qcyc7XHJcbmltcG9ydCB7IENpcmNsZSwgRHJhZ0xpc3RlbmVyLCBIQm94LCBOb2RlLCBOb2RlT3B0aW9ucywgUmVjdGFuZ2xlLCBUZXh0LCBWQm94LCBWU3RydXQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgQ29tYm9Cb3ggZnJvbSAnLi4vLi4vLi4vLi4vc3VuL2pzL0NvbWJvQm94LmpzJztcclxuaW1wb3J0IGdhc1Byb3BlcnRpZXMgZnJvbSAnLi4vLi4vZ2FzUHJvcGVydGllcy5qcyc7XHJcbmltcG9ydCBHYXNQcm9wZXJ0aWVzU3RyaW5ncyBmcm9tICcuLi8uLi9HYXNQcm9wZXJ0aWVzU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBHYXNQcm9wZXJ0aWVzQ29sb3JzIGZyb20gJy4uL0dhc1Byb3BlcnRpZXNDb2xvcnMuanMnO1xyXG5pbXBvcnQgR2FzUHJvcGVydGllc1F1ZXJ5UGFyYW1ldGVycyBmcm9tICcuLi9HYXNQcm9wZXJ0aWVzUXVlcnlQYXJhbWV0ZXJzLmpzJztcclxuaW1wb3J0IENvbGxpc2lvbkNvdW50ZXIgZnJvbSAnLi4vbW9kZWwvQ29sbGlzaW9uQ291bnRlci5qcyc7XHJcbmltcG9ydCBQbGF5UmVzZXRCdXR0b24gZnJvbSAnLi9QbGF5UmVzZXRCdXR0b24uanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IFhfTUFSR0lOID0gMTU7XHJcbmNvbnN0IFlfTUFSR0lOID0gMTA7XHJcbmNvbnN0IFhfU1BBQ0lORyA9IDEwO1xyXG5jb25zdCBZX1NQQUNJTkcgPSA1O1xyXG5jb25zdCBCRVpFTF9XSURUSCA9IDY7XHJcbmNvbnN0IE5VTUJFUl9ESVNQTEFZX1JBTkdFID0gbmV3IFJhbmdlKCAwLCAxRTYgKTtcclxuY29uc3QgQ09OVFJPTF9GT05UID0gbmV3IFBoZXRGb250KCAxNCApO1xyXG5jb25zdCBMQUJFTF9GT05UID0gbmV3IFBoZXRGb250KCAxNiApO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcblxyXG50eXBlIENvbGxpc2lvbkNvdW50ZXJOb2RlT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgUGlja1JlcXVpcmVkPE5vZGVPcHRpb25zLCAndGFuZGVtJz47XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb2xsaXNpb25Db3VudGVyTm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGNvbGxpc2lvbkNvdW50ZXI6IENvbGxpc2lvbkNvdW50ZXIsIGxpc3Rib3hQYXJlbnQ6IE5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlQm91bmRzUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PEJvdW5kczI+LCBwcm92aWRlZE9wdGlvbnM6IENvbGxpc2lvbkNvdW50ZXJOb2RlT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPENvbGxpc2lvbkNvdW50ZXJOb2RlT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBOb2RlT3B0aW9uc1xyXG4gICAgICBjdXJzb3I6ICdwb2ludGVyJyxcclxuICAgICAgdmlzaWJsZVByb3BlcnR5OiBjb2xsaXNpb25Db3VudGVyLnZpc2libGVQcm9wZXJ0eVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgY29uc3Qgd2FsbENvbGxpc2lvbnNUZXh0ID0gbmV3IFRleHQoIEdhc1Byb3BlcnRpZXNTdHJpbmdzLndhbGxDb2xsaXNpb25zU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgcGlja2FibGU6IGZhbHNlLFxyXG4gICAgICBmb250OiBMQUJFTF9GT05ULFxyXG4gICAgICBtYXhXaWR0aDogMTEwIC8vIGRldGVybWluZWQgZW1waXJpY2FsbHlcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCB2YWx1ZURpc3BsYXkgPSBuZXcgTnVtYmVyRGlzcGxheSggY29sbGlzaW9uQ291bnRlci5udW1iZXJPZkNvbGxpc2lvbnNQcm9wZXJ0eSwgTlVNQkVSX0RJU1BMQVlfUkFOR0UsIHtcclxuICAgICAgYmFja2dyb3VuZEZpbGw6ICd3aGl0ZScsXHJcbiAgICAgIGJhY2tncm91bmRTdHJva2U6ICdibGFjaycsXHJcbiAgICAgIHRleHRPcHRpb25zOiB7XHJcbiAgICAgICAgZm9udDogQ09OVFJPTF9GT05UXHJcbiAgICAgIH0sXHJcbiAgICAgIHhNYXJnaW46IDgsXHJcbiAgICAgIHlNYXJnaW46IDQsXHJcbiAgICAgIGNvcm5lclJhZGl1czogMyxcclxuICAgICAgcGlja2FibGU6IGZhbHNlIC8vIHNvIHdlIGNhbiBkcmFnXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgcGxheVJlc2V0QnV0dG9uID0gbmV3IFBsYXlSZXNldEJ1dHRvbiggY29sbGlzaW9uQ291bnRlci5pc1J1bm5pbmdQcm9wZXJ0eSwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3BsYXlSZXNldEJ1dHRvbicgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHNhbXBsZVBlcmlvZFRleHQgPSBuZXcgVGV4dCggR2FzUHJvcGVydGllc1N0cmluZ3Muc2FtcGxlUGVyaW9kU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgcGlja2FibGU6IGZhbHNlLFxyXG4gICAgICBmb250OiBMQUJFTF9GT05ULFxyXG4gICAgICBsZWZ0OiBYX01BUkdJTixcclxuICAgICAgbWF4V2lkdGg6IDExMCAvLyBkZXRlcm1pbmVkIGVtcGlyaWNhbGx5XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQ29tYm8gYm94IGl0ZW1zXHJcbiAgICBjb25zdCBjb21ib0JveEl0ZW1zID0gY29sbGlzaW9uQ291bnRlci5zYW1wbGVQZXJpb2RzLm1hcCggc2FtcGxlUGVyaW9kID0+IHtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgdmFsdWU6IHNhbXBsZVBlcmlvZCxcclxuICAgICAgICBjcmVhdGVOb2RlOiAoKSA9PiB7XHJcblxyXG4gICAgICAgICAgLy8gZS5nLiAnMTAgcHMnXHJcbiAgICAgICAgICBjb25zdCBzYW1wbGVQZXJpb2RTdHJpbmdQcm9wZXJ0eSA9IG5ldyBQYXR0ZXJuU3RyaW5nUHJvcGVydHkoIEdhc1Byb3BlcnRpZXNTdHJpbmdzLnZhbHVlVW5pdHNTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICAgICAgICB2YWx1ZTogc2FtcGxlUGVyaW9kLFxyXG4gICAgICAgICAgICB1bml0czogR2FzUHJvcGVydGllc1N0cmluZ3MucGljb3NlY29uZHNTdHJpbmdQcm9wZXJ0eVxyXG4gICAgICAgICAgfSApO1xyXG4gICAgICAgICAgcmV0dXJuIG5ldyBUZXh0KCBzYW1wbGVQZXJpb2RTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICAgICAgICBmb250OiBDT05UUk9MX0ZPTlQsXHJcbiAgICAgICAgICAgIG1heFdpZHRoOiAxMDAgLy8gZGV0ZXJtaW5lZCBlbXBpcmljYWxseVxyXG4gICAgICAgICAgfSApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGFuZGVtTmFtZTogYHNhbXBsZVBlcmlvZCR7c2FtcGxlUGVyaW9kfSR7Q29tYm9Cb3guSVRFTV9UQU5ERU1fTkFNRV9TVUZGSVh9YFxyXG4gICAgICB9O1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIENvbWJvIGJveFxyXG4gICAgY29uc3Qgc2FtcGxlUGVyaW9kQ29tYm9Cb3ggPSBuZXcgQ29tYm9Cb3goIGNvbGxpc2lvbkNvdW50ZXIuc2FtcGxlUGVyaW9kUHJvcGVydHksIGNvbWJvQm94SXRlbXMsIGxpc3Rib3hQYXJlbnQsIHtcclxuICAgICAgbGlzdFBvc2l0aW9uOiAnYmVsb3cnLFxyXG4gICAgICBhbGlnbjogJ3JpZ2h0JyxcclxuICAgICAgeE1hcmdpbjogNixcclxuICAgICAgeU1hcmdpbjogMyxcclxuICAgICAgY29ybmVyUmFkaXVzOiA1LFxyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NhbXBsZVBlcmlvZENvbWJvQm94JyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gc3R1ZmYgdGhhdCBhcHBlYXJzIG9uIHRoZSBjb3VudGVyXHJcbiAgICBjb25zdCBjb250ZW50ID0gbmV3IFZCb3goIHtcclxuICAgICAgYWxpZ246ICdjZW50ZXInLFxyXG4gICAgICBzcGFjaW5nOiBZX1NQQUNJTkcsXHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgd2FsbENvbGxpc2lvbnNUZXh0LFxyXG4gICAgICAgIG5ldyBIQm94KCB7XHJcbiAgICAgICAgICBzcGFjaW5nOiBYX1NQQUNJTkcsXHJcbiAgICAgICAgICBjaGlsZHJlbjogWyB2YWx1ZURpc3BsYXksIHBsYXlSZXNldEJ1dHRvbiBdXHJcbiAgICAgICAgfSApLFxyXG4gICAgICAgIG5ldyBWU3RydXQoIDIgKSxcclxuICAgICAgICBzYW1wbGVQZXJpb2RUZXh0LFxyXG4gICAgICAgIHNhbXBsZVBlcmlvZENvbWJvQm94XHJcbiAgICAgIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBCYWNrZ3JvdW5kLCBzaXplZCB0byBmaXQgdGhlIGNvbnRlbnRcclxuICAgIGNvbnN0IHJlY3RhbmdsZU5vZGUgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCBjb250ZW50LndpZHRoICsgKCAyICogWF9NQVJHSU4gKSwgY29udGVudC5oZWlnaHQgKyAoIDIgKiBZX01BUkdJTiApLCB7XHJcbiAgICAgIGNvcm5lclJhZGl1czogNixcclxuICAgICAgZmlsbDogR2FzUHJvcGVydGllc0NvbG9ycy5jb2xsaXNpb25Db3VudGVyQmFja2dyb3VuZENvbG9yUHJvcGVydHksXHJcbiAgICAgIHN0cm9rZTogJ2JsYWNrJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFBzZXVkby0zRCBiZXplbCBhcm91bmQgdGhlIG91dHNpZGUgZWRnZSBvZiB0aGUgcmVjdGFuZ2xlXHJcbiAgICBjb25zdCBiZXplbEJvdW5kcyA9IG5ldyBCb3VuZHMyKCAwLCAwLFxyXG4gICAgICByZWN0YW5nbGVOb2RlLndpZHRoICsgKCAyICogQkVaRUxfV0lEVEggKSwgcmVjdGFuZ2xlTm9kZS5oZWlnaHQgKyAoIDIgKiBCRVpFTF9XSURUSCApICk7XHJcbiAgICBjb25zdCBiZXplbE5vZGUgPSBuZXcgU2hhZGVkUmVjdGFuZ2xlKCBiZXplbEJvdW5kcywge1xyXG4gICAgICBiYXNlQ29sb3I6IEdhc1Byb3BlcnRpZXNDb2xvcnMuY29sbGlzaW9uQ291bnRlckJlemVsQ29sb3JQcm9wZXJ0eVxyXG4gICAgfSApO1xyXG5cclxuICAgIHJlY3RhbmdsZU5vZGUuY2VudGVyID0gYmV6ZWxOb2RlLmNlbnRlcjtcclxuXHJcbiAgICAvLyBUaGUgYmFja2dyb3VuZCBpbmNsdWRlIHRoZSBiZXplbCBhbmQgcmVjdGFuZ2xlLlxyXG4gICAgY29uc3QgYmFja2dyb3VuZE5vZGUgPSBuZXcgTm9kZSgge1xyXG4gICAgICBjaGlsZHJlbjogWyBiZXplbE5vZGUsIHJlY3RhbmdsZU5vZGUgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnRlbnQuY2VudGVyID0gYmFja2dyb3VuZE5vZGUuY2VudGVyO1xyXG5cclxuICAgIG9wdGlvbnMuY2hpbGRyZW4gPSBbIGJhY2tncm91bmROb2RlLCBjb250ZW50IF07XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBQdXQgYSByZWQgZG90IGF0IHRoZSBvcmlnaW4sIGZvciBkZWJ1Z2dpbmcgbGF5b3V0LlxyXG4gICAgaWYgKCBHYXNQcm9wZXJ0aWVzUXVlcnlQYXJhbWV0ZXJzLm9yaWdpbiApIHtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggbmV3IENpcmNsZSggMywgeyBmaWxsOiAncmVkJyB9ICkgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2aXNpYmlsaXR5XHJcbiAgICB0aGlzLnZpc2libGVQcm9wZXJ0eS5saW5rKCB2aXNpYmxlID0+IHtcclxuICAgICAgdGhpcy5pbnRlcnJ1cHRTdWJ0cmVlSW5wdXQoKTsgLy8gaW50ZXJydXB0IHVzZXIgaW50ZXJhY3Rpb25zXHJcbiAgICAgIGlmICggdmlzaWJsZSApIHtcclxuICAgICAgICB0aGlzLm1vdmVUb0Zyb250KCk7XHJcbiAgICAgICAgbGlzdGJveFBhcmVudC5tb3ZlVG9Gcm9udCgpO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gTW92ZSB0byB0aGUgY29sbGlzaW9uIGNvdW50ZXIncyBwb3NpdGlvblxyXG4gICAgY29sbGlzaW9uQ291bnRlci5wb3NpdGlvblByb3BlcnR5LmxpbmsoIHBvc2l0aW9uID0+IHtcclxuICAgICAgdGhpcy50cmFuc2xhdGlvbiA9IHBvc2l0aW9uO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGRyYWcgYm91bmRzLCBhZGp1c3RlZCB0byBrZWVwIHRoaXMgZW50aXJlIE5vZGUgaW5zaWRlIHZpc2libGUgYm91bmRzXHJcbiAgICBjb25zdCBkcmFnQm91bmRzUHJvcGVydHkgPSBuZXcgRHJhZ0JvdW5kc1Byb3BlcnR5KCB0aGlzLCB2aXNpYmxlQm91bmRzUHJvcGVydHkgKTtcclxuXHJcbiAgICAvLyBJbnRlcnJ1cHQgdXNlciBpbnRlcmFjdGlvbnMgd2hlbiB0aGUgdmlzaWJsZSBib3VuZHMgY2hhbmdlLCBzdWNoIGFzIGEgZGV2aWNlIG9yaWVudGF0aW9uIGNoYW5nZSBvciB3aW5kb3cgcmVzaXplLlxyXG4gICAgdmlzaWJsZUJvdW5kc1Byb3BlcnR5LmxpbmsoICgpID0+IHRoaXMuaW50ZXJydXB0U3VidHJlZUlucHV0KCkgKTtcclxuXHJcbiAgICAvLyBJZiB0aGUgY29sbGlzaW9uIGNvdW50ZXIgaXMgb3V0c2lkZSB0aGUgZHJhZyBib3VuZHMsIG1vdmUgaXQgaW5zaWRlLlxyXG4gICAgZHJhZ0JvdW5kc1Byb3BlcnR5LmxpbmsoIGRyYWdCb3VuZHMgPT4ge1xyXG4gICAgICBpZiAoICFkcmFnQm91bmRzLmNvbnRhaW5zUG9pbnQoIGNvbGxpc2lvbkNvdW50ZXIucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZSApICkge1xyXG4gICAgICAgIGNvbGxpc2lvbkNvdW50ZXIucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZSA9XHJcbiAgICAgICAgICBkcmFnQm91bmRzLmNsb3Nlc3RQb2ludFRvKCBjb2xsaXNpb25Db3VudGVyLnBvc2l0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIE9uIGFueSBmb3JtIG9mIHByZXNzLCBtb3ZlIGV2ZXJ5dGhpbmcgcmVsYXRlZCB0byB0aGlzIE5vZGUgdG8gdGhlIGZyb250LlxyXG4gICAgY29uc3Qgb25QcmVzcyA9ICgpID0+IHtcclxuICAgICAgdGhpcy5tb3ZlVG9Gcm9udCgpO1xyXG4gICAgICBsaXN0Ym94UGFyZW50Lm1vdmVUb0Zyb250KCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIERyYWdnaW5nLCBhZGRlZCB0byBiYWNrZ3JvdW5kIHNvIHRoYXQgb3RoZXIgVUkgY29tcG9uZW50cyBnZXQgaW5wdXQgZXZlbnRzIG9uIHRvdWNoIGRldmljZXMuXHJcbiAgICAvLyBJZiBhZGRlZCB0byAndGhpcycsIHRvdWNoU25hZyB3aWxsIGxvY2sgb3V0IGxpc3RlbmVycyBmb3Igb3RoZXIgVUkgY29tcG9uZW50cy5cclxuICAgIGJhY2tncm91bmROb2RlLmFkZElucHV0TGlzdGVuZXIoIG5ldyBEcmFnTGlzdGVuZXIoIHtcclxuICAgICAgdGFyZ2V0Tm9kZTogdGhpcyxcclxuICAgICAgcG9zaXRpb25Qcm9wZXJ0eTogY29sbGlzaW9uQ291bnRlci5wb3NpdGlvblByb3BlcnR5LFxyXG4gICAgICBkcmFnQm91bmRzUHJvcGVydHk6IGRyYWdCb3VuZHNQcm9wZXJ0eSxcclxuICAgICAgc3RhcnQ6IG9uUHJlc3MsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZHJhZ0xpc3RlbmVyJyApXHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBNb3ZlIHRvIGZyb250IG9uIHBvaW50ZXIgZG93biwgYW55d2hlcmUgb24gdGhpcyBOb2RlLCBpbmNsdWRpbmcgaW50ZXJhY3RpdmUgc3ViY29tcG9uZW50cy5cclxuICAgIHRoaXMuYWRkSW5wdXRMaXN0ZW5lcigge1xyXG4gICAgICBkb3duOiBvblByZXNzXHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZ2FzUHJvcGVydGllcy5yZWdpc3RlciggJ0NvbGxpc2lvbkNvdW50ZXJOb2RlJywgQ29sbGlzaW9uQ291bnRlck5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxxQkFBcUIsTUFBTSw4Q0FBOEM7QUFFaEYsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxLQUFLLE1BQU0sNkJBQTZCO0FBQy9DLE9BQU9DLFNBQVMsTUFBNEIsdUNBQXVDO0FBRW5GLE9BQU9DLGtCQUFrQixNQUFNLG1EQUFtRDtBQUNsRixPQUFPQyxhQUFhLE1BQU0sOENBQThDO0FBQ3hFLE9BQU9DLFFBQVEsTUFBTSx5Q0FBeUM7QUFDOUQsT0FBT0MsZUFBZSxNQUFNLGdEQUFnRDtBQUM1RSxTQUFTQyxNQUFNLEVBQUVDLFlBQVksRUFBRUMsSUFBSSxFQUFFQyxJQUFJLEVBQWVDLFNBQVMsRUFBRUMsSUFBSSxFQUFFQyxJQUFJLEVBQUVDLE1BQU0sUUFBUSxtQ0FBbUM7QUFDaEksT0FBT0MsUUFBUSxNQUFNLGdDQUFnQztBQUNyRCxPQUFPQyxhQUFhLE1BQU0sd0JBQXdCO0FBQ2xELE9BQU9DLG9CQUFvQixN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