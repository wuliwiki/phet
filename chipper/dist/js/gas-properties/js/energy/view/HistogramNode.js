// Copyright 2019-2022, University of Colorado Boulder

/**
 * HistogramNode is the base class for the 'Speed' and 'Kinetic Energy' histograms.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
import optionize, { combineOptions } from '../../../../phet-core/js/optionize.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import GasPropertiesColors from '../../common/GasPropertiesColors.js';
import gasProperties from '../../gasProperties.js';
import BarPlotNode from './BarPlotNode.js';
import IntervalLinesNode from './IntervalLinesNode.js';
import LinePlotNode from './LinePlotNode.js';

// Options for all histogram axis labels
const HISTOGRAM_AXIS_LABEL_OPTIONS = {
  fill: GasPropertiesColors.textFillProperty,
  font: new PhetFont(14)
};
export default class HistogramNode extends Node {
  // visibility of species-specific plots

  // Whether updates are enabled, false ignores binCountsUpdatedEmitter.
  // This is used to prevent updates when the accordion box containing a histogram is collapsed.
  /**
   * @param numberOfBins
   * @param binWidth
   * @param binCountsUpdatedEmitter - notifies when the bin counts have changed
   * @param allBinCountsProperty  - bin counts for all particles
   * @param heavyBinCountsProperty - bin counts for heavy particles
   * @param lightBinCountsProperty - bin counts for light particles
   * @param yScaleProperty - scale of the y-axis
   * @param xAxisStringProperty - label on the x-axis
   * @param yAxisStringProperty - label on the y-axis
   * @param providedOptions
   */
  constructor(numberOfBins, binWidth, binCountsUpdatedEmitter, allBinCountsProperty, heavyBinCountsProperty, lightBinCountsProperty, yScaleProperty, xAxisStringProperty, yAxisStringProperty, providedOptions) {
    assert && assert(numberOfBins > 0, `invalid numberOfBins: ${numberOfBins}`);
    assert && assert(binWidth > 0, `invalid binWidth: ${binWidth}`);
    const options = optionize()({
      // SelfOptions
      chartSize: new Dimension2(150, 130),
      backgroundFill: 'black',
      borderStroke: GasPropertiesColors.panelStrokeProperty,
      borderLineWidth: 1,
      plotLineWidth: 2,
      barColor: 'white'
    }, providedOptions);

    // Background appears behind plotted data
    const background = new Rectangle(0, 0, options.chartSize.width, options.chartSize.height, {
      fill: options.backgroundFill
    });

    // Outside border appears on top of plotted data
    const border = new Rectangle(0, 0, options.chartSize.width, options.chartSize.height, {
      stroke: options.borderStroke,
      lineWidth: options.borderLineWidth
    });

    // The main plot, for all particles
    const allPlotNode = new BarPlotNode(options.chartSize, yScaleProperty, options.barColor);

    // Species-specific plots
    const heavyPlotNode = new LinePlotNode(options.chartSize, yScaleProperty, GasPropertiesColors.heavyParticleColorProperty, options.plotLineWidth);
    const lightPlotNode = new LinePlotNode(options.chartSize, yScaleProperty, GasPropertiesColors.lightParticleColorProperty, options.plotLineWidth);

    // parent Node for all plotted data
    const plotNodesParent = new Node({
      children: [allPlotNode, heavyPlotNode, lightPlotNode]
    });

    // Horizontal lines that indicate y-axis scale.
    const intervalLines = new IntervalLinesNode(options.chartSize);

    // x-axis label
    const xAxisLabelNode = new Text(xAxisStringProperty, combineOptions({}, HISTOGRAM_AXIS_LABEL_OPTIONS, {
      maxWidth: 0.9 * background.width
    }));
    xAxisLabelNode.boundsProperty.link(bounds => {
      xAxisLabelNode.centerX = background.centerX;
      xAxisLabelNode.top = background.bottom + 5;
    });

    // y-axis label
    const yAxisLabelNode = new Text(yAxisStringProperty, combineOptions({}, HISTOGRAM_AXIS_LABEL_OPTIONS, {
      rotation: -Math.PI / 2,
      maxWidth: 0.9 * background.height
    }));
    yAxisLabelNode.boundsProperty.link(bounds => {
      yAxisLabelNode.right = background.left - 8;
      yAxisLabelNode.centerY = background.centerY;
    });
    options.children = [background, intervalLines, plotNodesParent, border, xAxisLabelNode, yAxisLabelNode];
    super(options);
    this.heavyPlotVisibleProperty = new BooleanProperty(false, {
      tandem: options.tandem.createTandem('heavyPlotVisibleProperty'),
      phetioDocumentation: 'whether the plot for heavy particles is visible on the histogram'
    });
    this.lightPlotVisibleProperty = new BooleanProperty(false, {
      tandem: options.tandem.createTandem('lightPlotVisibleProperty'),
      phetioDocumentation: 'whether the plot for light particles is visible on the histogram'
    });

    // Update plots to display the current bin counts. Update species-specific plots only if they are visible.
    const updatePlots = () => {
      allPlotNode.plot(allBinCountsProperty.value);
      if (this.heavyPlotVisibleProperty.value) {
        heavyPlotNode.plot(heavyBinCountsProperty.value);
      }
      if (this.lightPlotVisibleProperty.value) {
        lightPlotNode.plot(lightBinCountsProperty.value);
      }
    };

    // Update everything
    const update = () => {
      updatePlots();
      intervalLines.update(yScaleProperty.value);
    };
    this.updateEnabledProperty = new BooleanProperty(true);
    this.updateEnabledProperty.lazyLink(updateEnabled => {
      if (updateEnabled) {
        update();
      }
    });

    // Update the histogram when the bin counts have been updated. We do this instead of observing the
    // individual bin count Properties to improve performance because the histogram should be updated atomically.
    binCountsUpdatedEmitter.addListener(() => {
      if (this.updateEnabledProperty.value) {
        update();
      }
    });

    // Visibility of heavy plot, update immediately when it's made visible
    this.heavyPlotVisibleProperty.link(visible => {
      heavyPlotNode.visible = visible;
      if (visible) {
        heavyPlotNode.plot(heavyBinCountsProperty.value);
      }
    });

    // Visibility of light plot, update immediately when it's made visible
    this.lightPlotVisibleProperty.link(visible => {
      lightPlotNode.visible = visible;
      if (visible) {
        lightPlotNode.plot(lightBinCountsProperty.value);
      }
    });
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
  reset() {
    this.heavyPlotVisibleProperty.reset();
    this.lightPlotVisibleProperty.reset();
  }
}
gasProperties.register('HistogramNode', HistogramNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJEaW1lbnNpb24yIiwib3B0aW9uaXplIiwiY29tYmluZU9wdGlvbnMiLCJQaGV0Rm9udCIsIk5vZGUiLCJSZWN0YW5nbGUiLCJUZXh0IiwiR2FzUHJvcGVydGllc0NvbG9ycyIsImdhc1Byb3BlcnRpZXMiLCJCYXJQbG90Tm9kZSIsIkludGVydmFsTGluZXNOb2RlIiwiTGluZVBsb3ROb2RlIiwiSElTVE9HUkFNX0FYSVNfTEFCRUxfT1BUSU9OUyIsImZpbGwiLCJ0ZXh0RmlsbFByb3BlcnR5IiwiZm9udCIsIkhpc3RvZ3JhbU5vZGUiLCJjb25zdHJ1Y3RvciIsIm51bWJlck9mQmlucyIsImJpbldpZHRoIiwiYmluQ291bnRzVXBkYXRlZEVtaXR0ZXIiLCJhbGxCaW5Db3VudHNQcm9wZXJ0eSIsImhlYXZ5QmluQ291bnRzUHJvcGVydHkiLCJsaWdodEJpbkNvdW50c1Byb3BlcnR5IiwieVNjYWxlUHJvcGVydHkiLCJ4QXhpc1N0cmluZ1Byb3BlcnR5IiwieUF4aXNTdHJpbmdQcm9wZXJ0eSIsInByb3ZpZGVkT3B0aW9ucyIsImFzc2VydCIsIm9wdGlvbnMiLCJjaGFydFNpemUiLCJiYWNrZ3JvdW5kRmlsbCIsImJvcmRlclN0cm9rZSIsInBhbmVsU3Ryb2tlUHJvcGVydHkiLCJib3JkZXJMaW5lV2lkdGgiLCJwbG90TGluZVdpZHRoIiwiYmFyQ29sb3IiLCJiYWNrZ3JvdW5kIiwid2lkdGgiLCJoZWlnaHQiLCJib3JkZXIiLCJzdHJva2UiLCJsaW5lV2lkdGgiLCJhbGxQbG90Tm9kZSIsImhlYXZ5UGxvdE5vZGUiLCJoZWF2eVBhcnRpY2xlQ29sb3JQcm9wZXJ0eSIsImxpZ2h0UGxvdE5vZGUiLCJsaWdodFBhcnRpY2xlQ29sb3JQcm9wZXJ0eSIsInBsb3ROb2Rlc1BhcmVudCIsImNoaWxkcmVuIiwiaW50ZXJ2YWxMaW5lcyIsInhBeGlzTGFiZWxOb2RlIiwibWF4V2lkdGgiLCJib3VuZHNQcm9wZXJ0eSIsImxpbmsiLCJib3VuZHMiLCJjZW50ZXJYIiwidG9wIiwiYm90dG9tIiwieUF4aXNMYWJlbE5vZGUiLCJyb3RhdGlvbiIsIk1hdGgiLCJQSSIsInJpZ2h0IiwibGVmdCIsImNlbnRlclkiLCJoZWF2eVBsb3RWaXNpYmxlUHJvcGVydHkiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJwaGV0aW9Eb2N1bWVudGF0aW9uIiwibGlnaHRQbG90VmlzaWJsZVByb3BlcnR5IiwidXBkYXRlUGxvdHMiLCJwbG90IiwidmFsdWUiLCJ1cGRhdGUiLCJ1cGRhdGVFbmFibGVkUHJvcGVydHkiLCJsYXp5TGluayIsInVwZGF0ZUVuYWJsZWQiLCJhZGRMaXN0ZW5lciIsInZpc2libGUiLCJkaXNwb3NlIiwicmVzZXQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkhpc3RvZ3JhbU5vZGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTktMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogSGlzdG9ncmFtTm9kZSBpcyB0aGUgYmFzZSBjbGFzcyBmb3IgdGhlICdTcGVlZCcgYW5kICdLaW5ldGljIEVuZXJneScgaGlzdG9ncmFtcy5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IEVtaXR0ZXIgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9FbWl0dGVyLmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEaW1lbnNpb24yIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9EaW1lbnNpb24yLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBjb21iaW5lT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgTm9kZSwgTm9kZU9wdGlvbnMsIFJlY3RhbmdsZSwgVENvbG9yLCBUZXh0LCBUZXh0T3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBHYXNQcm9wZXJ0aWVzQ29sb3JzIGZyb20gJy4uLy4uL2NvbW1vbi9HYXNQcm9wZXJ0aWVzQ29sb3JzLmpzJztcclxuaW1wb3J0IGdhc1Byb3BlcnRpZXMgZnJvbSAnLi4vLi4vZ2FzUHJvcGVydGllcy5qcyc7XHJcbmltcG9ydCBCYXJQbG90Tm9kZSBmcm9tICcuL0JhclBsb3ROb2RlLmpzJztcclxuaW1wb3J0IEludGVydmFsTGluZXNOb2RlIGZyb20gJy4vSW50ZXJ2YWxMaW5lc05vZGUuanMnO1xyXG5pbXBvcnQgTGluZVBsb3ROb2RlIGZyb20gJy4vTGluZVBsb3ROb2RlLmpzJztcclxuXHJcbi8vIE9wdGlvbnMgZm9yIGFsbCBoaXN0b2dyYW0gYXhpcyBsYWJlbHNcclxuY29uc3QgSElTVE9HUkFNX0FYSVNfTEFCRUxfT1BUSU9OUyA9IHtcclxuICBmaWxsOiBHYXNQcm9wZXJ0aWVzQ29sb3JzLnRleHRGaWxsUHJvcGVydHksXHJcbiAgZm9udDogbmV3IFBoZXRGb250KCAxNCApXHJcbn07XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIGNoYXJ0U2l6ZT86IERpbWVuc2lvbjI7IC8vIHNpemUgb2YgdGhlIFJlY3RhbmdsZSB0aGF0IGlzIHRoZSBoaXN0b2dyYW0gYmFja2dyb3VuZFxyXG4gIGJhY2tncm91bmRGaWxsPzogVENvbG9yOyAvLyBoaXN0b2dyYW0gYmFja2dyb3VuZCBjb2xvclxyXG4gIGJvcmRlclN0cm9rZT86IFRDb2xvcjtcclxuICBib3JkZXJMaW5lV2lkdGg/OiBudW1iZXI7XHJcbiAgcGxvdExpbmVXaWR0aD86IG51bWJlcjsgLy8gbGluZVdpZHRoIGZvciBsaW5lIHNlZ21lbnQgcGxvdHNcclxuICBiYXJDb2xvcj86IFRDb2xvcjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIEhpc3RvZ3JhbU5vZGVPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBQaWNrUmVxdWlyZWQ8Tm9kZU9wdGlvbnMsICd0YW5kZW0nPjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhpc3RvZ3JhbU5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgLy8gdmlzaWJpbGl0eSBvZiBzcGVjaWVzLXNwZWNpZmljIHBsb3RzXHJcbiAgcHVibGljIHJlYWRvbmx5IGhlYXZ5UGxvdFZpc2libGVQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj47XHJcbiAgcHVibGljIHJlYWRvbmx5IGxpZ2h0UGxvdFZpc2libGVQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj47XHJcblxyXG4gIC8vIFdoZXRoZXIgdXBkYXRlcyBhcmUgZW5hYmxlZCwgZmFsc2UgaWdub3JlcyBiaW5Db3VudHNVcGRhdGVkRW1pdHRlci5cclxuICAvLyBUaGlzIGlzIHVzZWQgdG8gcHJldmVudCB1cGRhdGVzIHdoZW4gdGhlIGFjY29yZGlvbiBib3ggY29udGFpbmluZyBhIGhpc3RvZ3JhbSBpcyBjb2xsYXBzZWQuXHJcbiAgcHVibGljIHJlYWRvbmx5IHVwZGF0ZUVuYWJsZWRQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj47XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBudW1iZXJPZkJpbnNcclxuICAgKiBAcGFyYW0gYmluV2lkdGhcclxuICAgKiBAcGFyYW0gYmluQ291bnRzVXBkYXRlZEVtaXR0ZXIgLSBub3RpZmllcyB3aGVuIHRoZSBiaW4gY291bnRzIGhhdmUgY2hhbmdlZFxyXG4gICAqIEBwYXJhbSBhbGxCaW5Db3VudHNQcm9wZXJ0eSAgLSBiaW4gY291bnRzIGZvciBhbGwgcGFydGljbGVzXHJcbiAgICogQHBhcmFtIGhlYXZ5QmluQ291bnRzUHJvcGVydHkgLSBiaW4gY291bnRzIGZvciBoZWF2eSBwYXJ0aWNsZXNcclxuICAgKiBAcGFyYW0gbGlnaHRCaW5Db3VudHNQcm9wZXJ0eSAtIGJpbiBjb3VudHMgZm9yIGxpZ2h0IHBhcnRpY2xlc1xyXG4gICAqIEBwYXJhbSB5U2NhbGVQcm9wZXJ0eSAtIHNjYWxlIG9mIHRoZSB5LWF4aXNcclxuICAgKiBAcGFyYW0geEF4aXNTdHJpbmdQcm9wZXJ0eSAtIGxhYmVsIG9uIHRoZSB4LWF4aXNcclxuICAgKiBAcGFyYW0geUF4aXNTdHJpbmdQcm9wZXJ0eSAtIGxhYmVsIG9uIHRoZSB5LWF4aXNcclxuICAgKiBAcGFyYW0gcHJvdmlkZWRPcHRpb25zXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBudW1iZXJPZkJpbnM6IG51bWJlcixcclxuICAgICAgICAgICAgICAgICAgICAgIGJpbldpZHRoOiBudW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICBiaW5Db3VudHNVcGRhdGVkRW1pdHRlcjogRW1pdHRlcixcclxuICAgICAgICAgICAgICAgICAgICAgIGFsbEJpbkNvdW50c1Byb3BlcnR5OiBQcm9wZXJ0eTxudW1iZXJbXT4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBoZWF2eUJpbkNvdW50c1Byb3BlcnR5OiBQcm9wZXJ0eTxudW1iZXJbXT4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBsaWdodEJpbkNvdW50c1Byb3BlcnR5OiBQcm9wZXJ0eTxudW1iZXJbXT4sXHJcbiAgICAgICAgICAgICAgICAgICAgICB5U2NhbGVQcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyPixcclxuICAgICAgICAgICAgICAgICAgICAgIHhBeGlzU3RyaW5nUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz4sXHJcbiAgICAgICAgICAgICAgICAgICAgICB5QXhpc1N0cmluZ1Byb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZWRPcHRpb25zOiBIaXN0b2dyYW1Ob2RlT3B0aW9ucyApIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG51bWJlck9mQmlucyA+IDAsIGBpbnZhbGlkIG51bWJlck9mQmluczogJHtudW1iZXJPZkJpbnN9YCApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggYmluV2lkdGggPiAwLCBgaW52YWxpZCBiaW5XaWR0aDogJHtiaW5XaWR0aH1gICk7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxIaXN0b2dyYW1Ob2RlT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBTZWxmT3B0aW9uc1xyXG4gICAgICBjaGFydFNpemU6IG5ldyBEaW1lbnNpb24yKCAxNTAsIDEzMCApLFxyXG4gICAgICBiYWNrZ3JvdW5kRmlsbDogJ2JsYWNrJyxcclxuICAgICAgYm9yZGVyU3Ryb2tlOiBHYXNQcm9wZXJ0aWVzQ29sb3JzLnBhbmVsU3Ryb2tlUHJvcGVydHksXHJcbiAgICAgIGJvcmRlckxpbmVXaWR0aDogMSxcclxuICAgICAgcGxvdExpbmVXaWR0aDogMixcclxuICAgICAgYmFyQ29sb3I6ICd3aGl0ZSdcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIEJhY2tncm91bmQgYXBwZWFycyBiZWhpbmQgcGxvdHRlZCBkYXRhXHJcbiAgICBjb25zdCBiYWNrZ3JvdW5kID0gbmV3IFJlY3RhbmdsZSggMCwgMCwgb3B0aW9ucy5jaGFydFNpemUud2lkdGgsIG9wdGlvbnMuY2hhcnRTaXplLmhlaWdodCwge1xyXG4gICAgICBmaWxsOiBvcHRpb25zLmJhY2tncm91bmRGaWxsXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gT3V0c2lkZSBib3JkZXIgYXBwZWFycyBvbiB0b3Agb2YgcGxvdHRlZCBkYXRhXHJcbiAgICBjb25zdCBib3JkZXIgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCBvcHRpb25zLmNoYXJ0U2l6ZS53aWR0aCwgb3B0aW9ucy5jaGFydFNpemUuaGVpZ2h0LCB7XHJcbiAgICAgIHN0cm9rZTogb3B0aW9ucy5ib3JkZXJTdHJva2UsXHJcbiAgICAgIGxpbmVXaWR0aDogb3B0aW9ucy5ib3JkZXJMaW5lV2lkdGhcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBUaGUgbWFpbiBwbG90LCBmb3IgYWxsIHBhcnRpY2xlc1xyXG4gICAgY29uc3QgYWxsUGxvdE5vZGUgPSBuZXcgQmFyUGxvdE5vZGUoIG9wdGlvbnMuY2hhcnRTaXplLCB5U2NhbGVQcm9wZXJ0eSwgb3B0aW9ucy5iYXJDb2xvciApO1xyXG5cclxuICAgIC8vIFNwZWNpZXMtc3BlY2lmaWMgcGxvdHNcclxuICAgIGNvbnN0IGhlYXZ5UGxvdE5vZGUgPSBuZXcgTGluZVBsb3ROb2RlKCBvcHRpb25zLmNoYXJ0U2l6ZSwgeVNjYWxlUHJvcGVydHksXHJcbiAgICAgIEdhc1Byb3BlcnRpZXNDb2xvcnMuaGVhdnlQYXJ0aWNsZUNvbG9yUHJvcGVydHksIG9wdGlvbnMucGxvdExpbmVXaWR0aCApO1xyXG4gICAgY29uc3QgbGlnaHRQbG90Tm9kZSA9IG5ldyBMaW5lUGxvdE5vZGUoIG9wdGlvbnMuY2hhcnRTaXplLCB5U2NhbGVQcm9wZXJ0eSxcclxuICAgICAgR2FzUHJvcGVydGllc0NvbG9ycy5saWdodFBhcnRpY2xlQ29sb3JQcm9wZXJ0eSwgb3B0aW9ucy5wbG90TGluZVdpZHRoICk7XHJcblxyXG4gICAgLy8gcGFyZW50IE5vZGUgZm9yIGFsbCBwbG90dGVkIGRhdGFcclxuICAgIGNvbnN0IHBsb3ROb2Rlc1BhcmVudCA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIGFsbFBsb3ROb2RlLCBoZWF2eVBsb3ROb2RlLCBsaWdodFBsb3ROb2RlIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBIb3Jpem9udGFsIGxpbmVzIHRoYXQgaW5kaWNhdGUgeS1heGlzIHNjYWxlLlxyXG4gICAgY29uc3QgaW50ZXJ2YWxMaW5lcyA9IG5ldyBJbnRlcnZhbExpbmVzTm9kZSggb3B0aW9ucy5jaGFydFNpemUgKTtcclxuXHJcbiAgICAvLyB4LWF4aXMgbGFiZWxcclxuICAgIGNvbnN0IHhBeGlzTGFiZWxOb2RlID0gbmV3IFRleHQoIHhBeGlzU3RyaW5nUHJvcGVydHksXHJcbiAgICAgIGNvbWJpbmVPcHRpb25zPFRleHRPcHRpb25zPigge30sIEhJU1RPR1JBTV9BWElTX0xBQkVMX09QVElPTlMsIHtcclxuICAgICAgICBtYXhXaWR0aDogMC45ICogYmFja2dyb3VuZC53aWR0aFxyXG4gICAgICB9ICkgKTtcclxuICAgIHhBeGlzTGFiZWxOb2RlLmJvdW5kc1Byb3BlcnR5LmxpbmsoIGJvdW5kcyA9PiB7XHJcbiAgICAgIHhBeGlzTGFiZWxOb2RlLmNlbnRlclggPSBiYWNrZ3JvdW5kLmNlbnRlclg7XHJcbiAgICAgIHhBeGlzTGFiZWxOb2RlLnRvcCA9IGJhY2tncm91bmQuYm90dG9tICsgNTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB5LWF4aXMgbGFiZWxcclxuICAgIGNvbnN0IHlBeGlzTGFiZWxOb2RlID0gbmV3IFRleHQoIHlBeGlzU3RyaW5nUHJvcGVydHksXHJcbiAgICAgIGNvbWJpbmVPcHRpb25zPFRleHRPcHRpb25zPigge30sIEhJU1RPR1JBTV9BWElTX0xBQkVMX09QVElPTlMsIHtcclxuICAgICAgICByb3RhdGlvbjogLU1hdGguUEkgLyAyLFxyXG4gICAgICAgIG1heFdpZHRoOiAwLjkgKiBiYWNrZ3JvdW5kLmhlaWdodFxyXG4gICAgICB9ICkgKTtcclxuICAgIHlBeGlzTGFiZWxOb2RlLmJvdW5kc1Byb3BlcnR5LmxpbmsoIGJvdW5kcyA9PiB7XHJcbiAgICAgIHlBeGlzTGFiZWxOb2RlLnJpZ2h0ID0gYmFja2dyb3VuZC5sZWZ0IC0gODtcclxuICAgICAgeUF4aXNMYWJlbE5vZGUuY2VudGVyWSA9IGJhY2tncm91bmQuY2VudGVyWTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBvcHRpb25zLmNoaWxkcmVuID0gWyBiYWNrZ3JvdW5kLCBpbnRlcnZhbExpbmVzLCBwbG90Tm9kZXNQYXJlbnQsIGJvcmRlciwgeEF4aXNMYWJlbE5vZGUsIHlBeGlzTGFiZWxOb2RlIF07XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLmhlYXZ5UGxvdFZpc2libGVQcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIGZhbHNlLCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnaGVhdnlQbG90VmlzaWJsZVByb3BlcnR5JyApLFxyXG4gICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnd2hldGhlciB0aGUgcGxvdCBmb3IgaGVhdnkgcGFydGljbGVzIGlzIHZpc2libGUgb24gdGhlIGhpc3RvZ3JhbSdcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmxpZ2h0UGxvdFZpc2libGVQcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIGZhbHNlLCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnbGlnaHRQbG90VmlzaWJsZVByb3BlcnR5JyApLFxyXG4gICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnd2hldGhlciB0aGUgcGxvdCBmb3IgbGlnaHQgcGFydGljbGVzIGlzIHZpc2libGUgb24gdGhlIGhpc3RvZ3JhbSdcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgcGxvdHMgdG8gZGlzcGxheSB0aGUgY3VycmVudCBiaW4gY291bnRzLiBVcGRhdGUgc3BlY2llcy1zcGVjaWZpYyBwbG90cyBvbmx5IGlmIHRoZXkgYXJlIHZpc2libGUuXHJcbiAgICBjb25zdCB1cGRhdGVQbG90cyA9ICgpID0+IHtcclxuXHJcbiAgICAgIGFsbFBsb3ROb2RlLnBsb3QoIGFsbEJpbkNvdW50c1Byb3BlcnR5LnZhbHVlICk7XHJcblxyXG4gICAgICBpZiAoIHRoaXMuaGVhdnlQbG90VmlzaWJsZVByb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICAgIGhlYXZ5UGxvdE5vZGUucGxvdCggaGVhdnlCaW5Db3VudHNQcm9wZXJ0eS52YWx1ZSApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIHRoaXMubGlnaHRQbG90VmlzaWJsZVByb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICAgIGxpZ2h0UGxvdE5vZGUucGxvdCggbGlnaHRCaW5Db3VudHNQcm9wZXJ0eS52YWx1ZSApO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFVwZGF0ZSBldmVyeXRoaW5nXHJcbiAgICBjb25zdCB1cGRhdGUgPSAoKSA9PiB7XHJcbiAgICAgIHVwZGF0ZVBsb3RzKCk7XHJcbiAgICAgIGludGVydmFsTGluZXMudXBkYXRlKCB5U2NhbGVQcm9wZXJ0eS52YWx1ZSApO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnVwZGF0ZUVuYWJsZWRQcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIHRydWUgKTtcclxuICAgIHRoaXMudXBkYXRlRW5hYmxlZFByb3BlcnR5LmxhenlMaW5rKCB1cGRhdGVFbmFibGVkID0+IHtcclxuICAgICAgaWYgKCB1cGRhdGVFbmFibGVkICkge1xyXG4gICAgICAgIHVwZGF0ZSgpO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHRoZSBoaXN0b2dyYW0gd2hlbiB0aGUgYmluIGNvdW50cyBoYXZlIGJlZW4gdXBkYXRlZC4gV2UgZG8gdGhpcyBpbnN0ZWFkIG9mIG9ic2VydmluZyB0aGVcclxuICAgIC8vIGluZGl2aWR1YWwgYmluIGNvdW50IFByb3BlcnRpZXMgdG8gaW1wcm92ZSBwZXJmb3JtYW5jZSBiZWNhdXNlIHRoZSBoaXN0b2dyYW0gc2hvdWxkIGJlIHVwZGF0ZWQgYXRvbWljYWxseS5cclxuICAgIGJpbkNvdW50c1VwZGF0ZWRFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiB7XHJcbiAgICAgIGlmICggdGhpcy51cGRhdGVFbmFibGVkUHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgICAgdXBkYXRlKCk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBWaXNpYmlsaXR5IG9mIGhlYXZ5IHBsb3QsIHVwZGF0ZSBpbW1lZGlhdGVseSB3aGVuIGl0J3MgbWFkZSB2aXNpYmxlXHJcbiAgICB0aGlzLmhlYXZ5UGxvdFZpc2libGVQcm9wZXJ0eS5saW5rKCB2aXNpYmxlID0+IHtcclxuICAgICAgaGVhdnlQbG90Tm9kZS52aXNpYmxlID0gdmlzaWJsZTtcclxuICAgICAgaWYgKCB2aXNpYmxlICkge1xyXG4gICAgICAgIGhlYXZ5UGxvdE5vZGUucGxvdCggaGVhdnlCaW5Db3VudHNQcm9wZXJ0eS52YWx1ZSApO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gVmlzaWJpbGl0eSBvZiBsaWdodCBwbG90LCB1cGRhdGUgaW1tZWRpYXRlbHkgd2hlbiBpdCdzIG1hZGUgdmlzaWJsZVxyXG4gICAgdGhpcy5saWdodFBsb3RWaXNpYmxlUHJvcGVydHkubGluayggdmlzaWJsZSA9PiB7XHJcbiAgICAgIGxpZ2h0UGxvdE5vZGUudmlzaWJsZSA9IHZpc2libGU7XHJcbiAgICAgIGlmICggdmlzaWJsZSApIHtcclxuICAgICAgICBsaWdodFBsb3ROb2RlLnBsb3QoIGxpZ2h0QmluQ291bnRzUHJvcGVydHkudmFsdWUgKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBmYWxzZSwgJ2Rpc3Bvc2UgaXMgbm90IHN1cHBvcnRlZCwgZXhpc3RzIGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIHNpbScgKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyByZXNldCgpOiB2b2lkIHtcclxuICAgIHRoaXMuaGVhdnlQbG90VmlzaWJsZVByb3BlcnR5LnJlc2V0KCk7XHJcbiAgICB0aGlzLmxpZ2h0UGxvdFZpc2libGVQcm9wZXJ0eS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG5cclxuZ2FzUHJvcGVydGllcy5yZWdpc3RlciggJ0hpc3RvZ3JhbU5vZGUnLCBIaXN0b2dyYW1Ob2RlICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFJcEUsT0FBT0MsVUFBVSxNQUFNLGtDQUFrQztBQUN6RCxPQUFPQyxTQUFTLElBQUlDLGNBQWMsUUFBUSx1Q0FBdUM7QUFFakYsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxJQUFJLEVBQWVDLFNBQVMsRUFBVUMsSUFBSSxRQUFxQixtQ0FBbUM7QUFDM0csT0FBT0MsbUJBQW1CLE1BQU0scUNBQXFDO0FBQ3JFLE9BQU9DLGFBQWEsTUFBTSx3QkFBd0I7QUFDbEQsT0FBT0MsV0FBVyxNQUFNLGtCQUFrQjtBQUMxQyxPQUFPQyxpQkFBaUIsTUFBTSx3QkFBd0I7QUFDdEQsT0FBT0MsWUFBWSxNQUFNLG1CQUFtQjs7QUFFNUM7QUFDQSxNQUFNQyw0QkFBNEIsR0FBRztFQUNuQ0MsSUFBSSxFQUFFTixtQkFBbUIsQ0FBQ08sZ0JBQWdCO0VBQzFDQyxJQUFJLEVBQUUsSUFBSVosUUFBUSxDQUFFLEVBQUc7QUFDekIsQ0FBQztBQWFELGVBQWUsTUFBTWEsYUFBYSxTQUFTWixJQUFJLENBQUM7RUFFOUM7O0VBSUE7RUFDQTtFQUdBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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