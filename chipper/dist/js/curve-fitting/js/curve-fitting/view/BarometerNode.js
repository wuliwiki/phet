// Copyright 2019-2022, University of Colorado Boulder

/**
 * A barometer superclass that is extended by BarometerR2Node and BarometerX2Node
 * Provides most of the base functionality for what a barometer node does
 *
 * @author Saurabh Totey
 */

import merge from '../../../../phet-core/js/merge.js';
import { Line, Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import curveFitting from '../../curveFitting.js';
import CurveFittingConstants from '../CurveFittingConstants.js';

// constants
const LINE_OPTIONS = {
  lineWidth: 1.5,
  stroke: 'black'
};
class BarometerNode extends Node {
  /**
   * @param {Property.<number>} fillProportionProperty - how much the barometer should be filled in a scale from 0 to 1
   * @param {Property.<boolean>} fillVisibleProperty - Property that controls whether the fill of the barometer is visible
   * @param {Object.<number, string>} tickPositionToLabels - a map of tick position from 0 to 1 to the corresponding label text
   * @param {Object} [options]
   */
  constructor(fillProportionProperty, fillVisibleProperty, tickPositionToLabels, options) {
    options = merge({
      // {ColorDef} the color of the barometer's fill
      fill: '#fff',
      // {Font} the font of the tick labels
      font: CurveFittingConstants.BAROMETER_TICK_LABEL_FONT,
      // {number} how tall this barometer is
      axisHeight: CurveFittingConstants.BAROMETER_AXIS_HEIGHT,
      // {number} how wide the ticks are
      tickWidth: CurveFittingConstants.BAROMETER_TICK_WIDTH
    }, options);
    super(options);

    // makes the fill rectangle and the axis and adds them to this barometer node
    const valueRectangle = new Rectangle(0, 0, CurveFittingConstants.BAROMETER_BAR_WIDTH, 0, {
      fill: options.fill
    });
    valueRectangle.rotation = Math.PI;
    const axisLine = new Line(0, 0, 0, -options.axisHeight, LINE_OPTIONS);
    this.addChild(valueRectangle);
    this.addChild(axisLine);
    valueRectangle.left = axisLine.right;

    // makes a line at the bottom of the barometer
    const baseLine = new Line(-5, 0, CurveFittingConstants.BAROMETER_BAR_WIDTH + 5, 0, LINE_OPTIONS);
    this.addChild(baseLine);

    // links the valueRectangle's properties to the relevant listeners; unlinks unnecessary, instances present for sim life
    fillProportionProperty.link(fillProportion => {
      valueRectangle.setRectHeight(fillProportion * options.axisHeight);
    });
    fillVisibleProperty.linkAttribute(valueRectangle, 'visible');

    // adds ticks for each tick position key in the tickPositionToLabels parameter
    Object.keys(tickPositionToLabels).forEach(tickPosition => {
      const tickLine = new Line(-5, -tickPosition * options.axisHeight, options.tickWidth - 5, -tickPosition * options.axisHeight, LINE_OPTIONS);
      this.addChild(tickLine);
      const tickLabel = new Text(tickPositionToLabels[tickPosition], {
        font: options.font,
        right: tickLine.left - 2,
        centerY: tickLine.centerY
      });
      this.addChild(tickLabel);
    });
  }
}
curveFitting.register('BarometerNode', BarometerNode);
export default BarometerNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtZXJnZSIsIkxpbmUiLCJOb2RlIiwiUmVjdGFuZ2xlIiwiVGV4dCIsImN1cnZlRml0dGluZyIsIkN1cnZlRml0dGluZ0NvbnN0YW50cyIsIkxJTkVfT1BUSU9OUyIsImxpbmVXaWR0aCIsInN0cm9rZSIsIkJhcm9tZXRlck5vZGUiLCJjb25zdHJ1Y3RvciIsImZpbGxQcm9wb3J0aW9uUHJvcGVydHkiLCJmaWxsVmlzaWJsZVByb3BlcnR5IiwidGlja1Bvc2l0aW9uVG9MYWJlbHMiLCJvcHRpb25zIiwiZmlsbCIsImZvbnQiLCJCQVJPTUVURVJfVElDS19MQUJFTF9GT05UIiwiYXhpc0hlaWdodCIsIkJBUk9NRVRFUl9BWElTX0hFSUdIVCIsInRpY2tXaWR0aCIsIkJBUk9NRVRFUl9USUNLX1dJRFRIIiwidmFsdWVSZWN0YW5nbGUiLCJCQVJPTUVURVJfQkFSX1dJRFRIIiwicm90YXRpb24iLCJNYXRoIiwiUEkiLCJheGlzTGluZSIsImFkZENoaWxkIiwibGVmdCIsInJpZ2h0IiwiYmFzZUxpbmUiLCJsaW5rIiwiZmlsbFByb3BvcnRpb24iLCJzZXRSZWN0SGVpZ2h0IiwibGlua0F0dHJpYnV0ZSIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwidGlja1Bvc2l0aW9uIiwidGlja0xpbmUiLCJ0aWNrTGFiZWwiLCJjZW50ZXJZIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJCYXJvbWV0ZXJOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE5LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEEgYmFyb21ldGVyIHN1cGVyY2xhc3MgdGhhdCBpcyBleHRlbmRlZCBieSBCYXJvbWV0ZXJSMk5vZGUgYW5kIEJhcm9tZXRlclgyTm9kZVxyXG4gKiBQcm92aWRlcyBtb3N0IG9mIHRoZSBiYXNlIGZ1bmN0aW9uYWxpdHkgZm9yIHdoYXQgYSBiYXJvbWV0ZXIgbm9kZSBkb2VzXHJcbiAqXHJcbiAqIEBhdXRob3IgU2F1cmFiaCBUb3RleVxyXG4gKi9cclxuXHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgeyBMaW5lLCBOb2RlLCBSZWN0YW5nbGUsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgY3VydmVGaXR0aW5nIGZyb20gJy4uLy4uL2N1cnZlRml0dGluZy5qcyc7XHJcbmltcG9ydCBDdXJ2ZUZpdHRpbmdDb25zdGFudHMgZnJvbSAnLi4vQ3VydmVGaXR0aW5nQ29uc3RhbnRzLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBMSU5FX09QVElPTlMgPSB7XHJcbiAgbGluZVdpZHRoOiAxLjUsXHJcbiAgc3Ryb2tlOiAnYmxhY2snXHJcbn07XHJcblxyXG5jbGFzcyBCYXJvbWV0ZXJOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPG51bWJlcj59IGZpbGxQcm9wb3J0aW9uUHJvcGVydHkgLSBob3cgbXVjaCB0aGUgYmFyb21ldGVyIHNob3VsZCBiZSBmaWxsZWQgaW4gYSBzY2FsZSBmcm9tIDAgdG8gMVxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPGJvb2xlYW4+fSBmaWxsVmlzaWJsZVByb3BlcnR5IC0gUHJvcGVydHkgdGhhdCBjb250cm9scyB3aGV0aGVyIHRoZSBmaWxsIG9mIHRoZSBiYXJvbWV0ZXIgaXMgdmlzaWJsZVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0LjxudW1iZXIsIHN0cmluZz59IHRpY2tQb3NpdGlvblRvTGFiZWxzIC0gYSBtYXAgb2YgdGljayBwb3NpdGlvbiBmcm9tIDAgdG8gMSB0byB0aGUgY29ycmVzcG9uZGluZyBsYWJlbCB0ZXh0XHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBmaWxsUHJvcG9ydGlvblByb3BlcnR5LCBmaWxsVmlzaWJsZVByb3BlcnR5LCB0aWNrUG9zaXRpb25Ub0xhYmVscywgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuXHJcbiAgICAgIC8vIHtDb2xvckRlZn0gdGhlIGNvbG9yIG9mIHRoZSBiYXJvbWV0ZXIncyBmaWxsXHJcbiAgICAgIGZpbGw6ICcjZmZmJyxcclxuXHJcbiAgICAgIC8vIHtGb250fSB0aGUgZm9udCBvZiB0aGUgdGljayBsYWJlbHNcclxuICAgICAgZm9udDogQ3VydmVGaXR0aW5nQ29uc3RhbnRzLkJBUk9NRVRFUl9USUNLX0xBQkVMX0ZPTlQsXHJcblxyXG4gICAgICAvLyB7bnVtYmVyfSBob3cgdGFsbCB0aGlzIGJhcm9tZXRlciBpc1xyXG4gICAgICBheGlzSGVpZ2h0OiBDdXJ2ZUZpdHRpbmdDb25zdGFudHMuQkFST01FVEVSX0FYSVNfSEVJR0hULFxyXG5cclxuICAgICAgLy8ge251bWJlcn0gaG93IHdpZGUgdGhlIHRpY2tzIGFyZVxyXG4gICAgICB0aWNrV2lkdGg6IEN1cnZlRml0dGluZ0NvbnN0YW50cy5CQVJPTUVURVJfVElDS19XSURUSFxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gbWFrZXMgdGhlIGZpbGwgcmVjdGFuZ2xlIGFuZCB0aGUgYXhpcyBhbmQgYWRkcyB0aGVtIHRvIHRoaXMgYmFyb21ldGVyIG5vZGVcclxuICAgIGNvbnN0IHZhbHVlUmVjdGFuZ2xlID0gbmV3IFJlY3RhbmdsZSggMCwgMCwgQ3VydmVGaXR0aW5nQ29uc3RhbnRzLkJBUk9NRVRFUl9CQVJfV0lEVEgsIDAsIHtcclxuICAgICAgZmlsbDogb3B0aW9ucy5maWxsXHJcbiAgICB9ICk7XHJcbiAgICB2YWx1ZVJlY3RhbmdsZS5yb3RhdGlvbiA9IE1hdGguUEk7XHJcbiAgICBjb25zdCBheGlzTGluZSA9IG5ldyBMaW5lKCAwLCAwLCAwLCAtb3B0aW9ucy5heGlzSGVpZ2h0LCBMSU5FX09QVElPTlMgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHZhbHVlUmVjdGFuZ2xlICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBheGlzTGluZSApO1xyXG4gICAgdmFsdWVSZWN0YW5nbGUubGVmdCA9IGF4aXNMaW5lLnJpZ2h0O1xyXG5cclxuICAgIC8vIG1ha2VzIGEgbGluZSBhdCB0aGUgYm90dG9tIG9mIHRoZSBiYXJvbWV0ZXJcclxuICAgIGNvbnN0IGJhc2VMaW5lID0gbmV3IExpbmUoIC01LCAwLCBDdXJ2ZUZpdHRpbmdDb25zdGFudHMuQkFST01FVEVSX0JBUl9XSURUSCArIDUsIDAsIExJTkVfT1BUSU9OUyApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggYmFzZUxpbmUgKTtcclxuXHJcbiAgICAvLyBsaW5rcyB0aGUgdmFsdWVSZWN0YW5nbGUncyBwcm9wZXJ0aWVzIHRvIHRoZSByZWxldmFudCBsaXN0ZW5lcnM7IHVubGlua3MgdW5uZWNlc3NhcnksIGluc3RhbmNlcyBwcmVzZW50IGZvciBzaW0gbGlmZVxyXG4gICAgZmlsbFByb3BvcnRpb25Qcm9wZXJ0eS5saW5rKCBmaWxsUHJvcG9ydGlvbiA9PiB7XHJcbiAgICAgIHZhbHVlUmVjdGFuZ2xlLnNldFJlY3RIZWlnaHQoIGZpbGxQcm9wb3J0aW9uICogb3B0aW9ucy5heGlzSGVpZ2h0ICk7XHJcbiAgICB9ICk7XHJcbiAgICBmaWxsVmlzaWJsZVByb3BlcnR5LmxpbmtBdHRyaWJ1dGUoIHZhbHVlUmVjdGFuZ2xlLCAndmlzaWJsZScgKTtcclxuXHJcbiAgICAvLyBhZGRzIHRpY2tzIGZvciBlYWNoIHRpY2sgcG9zaXRpb24ga2V5IGluIHRoZSB0aWNrUG9zaXRpb25Ub0xhYmVscyBwYXJhbWV0ZXJcclxuICAgIE9iamVjdC5rZXlzKCB0aWNrUG9zaXRpb25Ub0xhYmVscyApLmZvckVhY2goIHRpY2tQb3NpdGlvbiA9PiB7XHJcbiAgICAgIGNvbnN0IHRpY2tMaW5lID0gbmV3IExpbmUoXHJcbiAgICAgICAgLTUsXHJcbiAgICAgICAgLXRpY2tQb3NpdGlvbiAqIG9wdGlvbnMuYXhpc0hlaWdodCxcclxuICAgICAgICBvcHRpb25zLnRpY2tXaWR0aCAtIDUsXHJcbiAgICAgICAgLXRpY2tQb3NpdGlvbiAqIG9wdGlvbnMuYXhpc0hlaWdodCxcclxuICAgICAgICBMSU5FX09QVElPTlNcclxuICAgICAgKTtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggdGlja0xpbmUgKTtcclxuXHJcbiAgICAgIGNvbnN0IHRpY2tMYWJlbCA9IG5ldyBUZXh0KCB0aWNrUG9zaXRpb25Ub0xhYmVsc1sgdGlja1Bvc2l0aW9uIF0sIHtcclxuICAgICAgICBmb250OiBvcHRpb25zLmZvbnQsXHJcbiAgICAgICAgcmlnaHQ6IHRpY2tMaW5lLmxlZnQgLSAyLFxyXG4gICAgICAgIGNlbnRlclk6IHRpY2tMaW5lLmNlbnRlcllcclxuICAgICAgfSApO1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCB0aWNrTGFiZWwgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgfVxyXG5cclxufVxyXG5cclxuY3VydmVGaXR0aW5nLnJlZ2lzdGVyKCAnQmFyb21ldGVyTm9kZScsIEJhcm9tZXRlck5vZGUgKTtcclxuZXhwb3J0IGRlZmF1bHQgQmFyb21ldGVyTm9kZTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsS0FBSyxNQUFNLG1DQUFtQztBQUNyRCxTQUFTQyxJQUFJLEVBQUVDLElBQUksRUFBRUMsU0FBUyxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQy9FLE9BQU9DLFlBQVksTUFBTSx1QkFBdUI7QUFDaEQsT0FBT0MscUJBQXFCLE1BQU0sNkJBQTZCOztBQUUvRDtBQUNBLE1BQU1DLFlBQVksR0FBRztFQUNuQkMsU0FBUyxFQUFFLEdBQUc7RUFDZEMsTUFBTSxFQUFFO0FBQ1YsQ0FBQztBQUVELE1BQU1DLGFBQWEsU0FBU1IsSUFBSSxDQUFDO0VBRS9CO0FBQ0Y7QUFDQTtB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