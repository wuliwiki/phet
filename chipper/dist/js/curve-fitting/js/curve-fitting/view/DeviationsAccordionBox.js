// Copyright 2015-2023, University of Colorado Boulder

/**
 * Deviations accordion box in 'Curve Fitting' simulation.
 * Contains X^2 barometer, r^2 barometer and help button.
 *
 * @author Andrey Zelenkov (Mlearner)
 * @author Saurabh Totey
 */

import Utils from '../../../../dot/js/Utils.js';
import merge from '../../../../phet-core/js/merge.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import InfoButton from '../../../../scenery-phet/js/buttons/InfoButton.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import { HBox, Node, RichText, Text } from '../../../../scenery/js/imports.js';
import AccordionBox from '../../../../sun/js/AccordionBox.js';
import Panel from '../../../../sun/js/Panel.js';
import curveFitting from '../../curveFitting.js';
import CurveFittingStrings from '../../CurveFittingStrings.js';
import CurveFittingConstants from '../CurveFittingConstants.js';
import BarometerR2Node from './BarometerR2Node.js';
import BarometerX2Node from './BarometerX2Node.js';
import ReducedChiSquaredStatisticDialog from './ReducedChiSquaredStatisticDialog.js';
const deviationsString = CurveFittingStrings.deviations;

// constants
const VALUES_TEXT_FONT = CurveFittingConstants.BAROMETER_VALUE_FONT;
const MAX_CHI_SQUARE_VALUE = 1000;
const LABEL_TEXT_OPTIONS = {
  font: CurveFittingConstants.BAROMETER_SYMBOL_FONT,
  maxWidth: 35
};

// strings
const chiSymbolString = CurveFittingStrings.chiSymbol;
const rSymbolString = CurveFittingStrings.rSymbol;

// constants
const LABEL_MAX_WIDTH = 30;
const VALUE_MAX_WIDTH = 45;
const CHI_SQUARED_PATTERN = `${chiSymbolString}<sup>2</sup>&nbsp;{{relationalOperator}}&nbsp;`;
const R_SQUARED_EQUALS_STRING = `${rSymbolString}<sup>2</sup>&nbsp;${MathSymbols.EQUAL_TO}&nbsp;`;
class DeviationsAccordionBox extends AccordionBox {
  /**
   * @param {Property.<boolean>} expandedProperty - is this panel expanded?
   * @param {Points} points
   * @param {Property.<number>} chiSquaredProperty
   * @param {Property.<number>} rSquaredProperty
   * @param {Property.<boolean>} curveVisibleProperty
   * @param {Object} [options]
   */
  constructor(expandedProperty, points, chiSquaredProperty, rSquaredProperty, curveVisibleProperty, options) {
    options = merge({
      cornerRadius: CurveFittingConstants.PANEL_CORNER_RADIUS,
      fill: CurveFittingConstants.PANEL_BACKGROUND_COLOR,
      minWidth: CurveFittingConstants.PANEL_MIN_WIDTH,
      maxWidth: CurveFittingConstants.PANEL_MAX_WIDTH,
      expandedProperty: expandedProperty,
      titleNode: new Text(deviationsString, {
        font: CurveFittingConstants.ACCORDION_BOX_TITLE_FONT,
        maxWidth: 115
      }),
      titleAlignX: 'left',
      titleXSpacing: 8,
      showTitleWhenExpanded: true,
      buttonXMargin: CurveFittingConstants.PANEL_MARGIN,
      buttonYMargin: CurveFittingConstants.PANEL_MARGIN,
      expandCollapseButtonOptions: {
        touchAreaXDilation: 8,
        touchAreaYDilation: 8
      },
      valuePanelOptions: {
        fill: 'white',
        cornerRadius: CurveFittingConstants.PANEL_CORNER_RADIUS,
        xMargin: 4,
        yMargin: 4,
        resize: false,
        maxWidth: VALUE_MAX_WIDTH
      }
    }, options);
    const panelContent = new Node({
      width: options.maxWidth
    });

    // X^2 barometer
    const barometerX2 = new BarometerX2Node(points, chiSquaredProperty, curveVisibleProperty);

    // r^2 barometer
    const barometerR2 = new BarometerR2Node(rSquaredProperty, curveVisibleProperty);

    // informational dialog, created lazily because Dialog requires sim bounds during construction
    let dialog = null;

    // help button
    const helpButton = new InfoButton({
      listener: () => {
        if (!dialog) {
          dialog = new ReducedChiSquaredStatisticDialog();
        }
        dialog.show();
      },
      baseColor: 'rgb( 204, 204, 204 )',
      iconFill: 'rgb( 44, 107, 159 )',
      maxWidth: 30,
      touchAreaXDilation: 8,
      touchAreaYDilation: 8
    });

    // X^2 =
    const chiSquaredLabelText = new RichText('', LABEL_TEXT_OPTIONS);

    // X^2 value
    const chiSquaredValueText = new Text('0.00', {
      font: VALUES_TEXT_FONT,
      textAlign: 'left',
      maxWidth: LABEL_MAX_WIDTH
    });
    const chiSquaredValuePanel = new Panel(chiSquaredValueText, options.valuePanelOptions);

    // X^2 = value
    const chiSquaredInformationBox = new HBox({
      children: [chiSquaredLabelText, chiSquaredValuePanel]
    });

    // r^2 =
    const rSquaredLabelText = new RichText(R_SQUARED_EQUALS_STRING, LABEL_TEXT_OPTIONS);

    // r^2 value
    const rSquaredValueText = new Text('0.00', {
      font: VALUES_TEXT_FONT,
      textAlign: 'left',
      maxWidth: LABEL_MAX_WIDTH
    });
    const rSquaredValuePanel = new Panel(rSquaredValueText, options.valuePanelOptions);

    // r^2 = value
    const rSquaredInformationBox = new HBox({
      children: [rSquaredLabelText, rSquaredValuePanel]
    });

    // unlink unnecessary, present for the lifetime of the sim
    chiSquaredProperty.link(chiSquared => {
      // if chiSquared is larger than a 1000, the actual value will not be displayed, so use a '>' sign
      chiSquaredLabelText.string = StringUtils.fillIn(CHI_SQUARED_PATTERN, {
        relationalOperator: chiSquared > MAX_CHI_SQUARE_VALUE ? MathSymbols.GREATER_THAN : MathSymbols.EQUAL_TO
      });

      // If chiSquared is greater than 10 we have a bad fit so less precision is needed.
      // If chiSquared is greater than 100 we have a really bad fit and decimals are inconsequential.
      // If chiSquared is larger than 1000, round it to 1000; see #28
      chiSquaredValueText.string = formatNumber(Math.min(chiSquared, MAX_CHI_SQUARE_VALUE), 2);

      // centers the chiSquared text node within the panel
      // chi squared needs to be centered because the number of digits can change
      chiSquaredValueText.centerX = chiSquaredValuePanel.width / 2;
      chiSquaredValueText.centerY = chiSquaredValuePanel.height / 2;
    });

    // unlink unnecessary, present for the lifetime of the sim
    rSquaredProperty.link(rSquared => {
      let rSquaredString;
      if (isNaN(rSquared)) {
        rSquaredString = '';
      } else {
        rSquaredString = formatNumber(rSquared, 2);
      }
      rSquaredValueText.string = rSquaredString;
    });

    // unlinks unnecessary, present for the lifetime of the sim
    curveVisibleProperty.linkAttribute(rSquaredValueText, 'visible');
    curveVisibleProperty.linkAttribute(chiSquaredValueText, 'visible');
    panelContent.addChild(helpButton);
    panelContent.addChild(chiSquaredInformationBox);
    panelContent.addChild(rSquaredInformationBox);
    panelContent.addChild(barometerX2);
    panelContent.addChild(barometerR2);
    const xSpacing = 8;
    const ySpacing = 10;
    helpButton.centerX = panelContent.width / 2;
    chiSquaredInformationBox.right = helpButton.centerX - xSpacing;
    chiSquaredInformationBox.bottom = helpButton.top - ySpacing;
    rSquaredInformationBox.left = helpButton.centerX + xSpacing;
    rSquaredInformationBox.bottom = helpButton.top - ySpacing;
    barometerX2.centerX = chiSquaredInformationBox.centerX;
    barometerR2.centerX = rSquaredInformationBox.centerX;
    barometerX2.bottom = chiSquaredInformationBox.top - ySpacing;
    barometerR2.bottom = rSquaredInformationBox.top - ySpacing;
    super(panelContent, options);
  }
}

/**
 * For numbers smaller than ten, returns a number with digits decimal places.
 * For numbers larger than ten, returns a fixed number with (digits + 1) significant figures.
 *
 * @param {number} number
 * @param {number} digits
 * @returns {string}
 */
function formatNumber(number, digits) {
  // e.g. for digits = 3
  // 9999.11 -> 9999  (numbers greater than 10^3) are rounded to integers
  // 999.111 -> 999.1
  // 99.1111 -> 99.11
  // 9.11111 -> 9.111 (numbers less than 10) have 3 decimal places
  // 1.11111 -> 1.111
  // 0.11111 -> 0.111
  // 0.01111 -> 0.011
  // 0.00111 -> 0.001
  // 0.00011 -> 0.000

  // number = mantissa times 10^(exponent) where the mantissa is between 1 and 10 (or -1 and -10)
  const exponent = Math.floor(Utils.log10(Math.abs(number)));
  let decimalPlaces;
  if (exponent >= digits) {
    decimalPlaces = 0;
  } else if (exponent > 0) {
    decimalPlaces = digits - exponent;
  } else {
    decimalPlaces = digits;
  }
  return Utils.toFixed(number, decimalPlaces);
}
curveFitting.register('DeviationsAccordionBox', DeviationsAccordionBox);
export default DeviationsAccordionBox;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIm1lcmdlIiwiU3RyaW5nVXRpbHMiLCJJbmZvQnV0dG9uIiwiTWF0aFN5bWJvbHMiLCJIQm94IiwiTm9kZSIsIlJpY2hUZXh0IiwiVGV4dCIsIkFjY29yZGlvbkJveCIsIlBhbmVsIiwiY3VydmVGaXR0aW5nIiwiQ3VydmVGaXR0aW5nU3RyaW5ncyIsIkN1cnZlRml0dGluZ0NvbnN0YW50cyIsIkJhcm9tZXRlclIyTm9kZSIsIkJhcm9tZXRlclgyTm9kZSIsIlJlZHVjZWRDaGlTcXVhcmVkU3RhdGlzdGljRGlhbG9nIiwiZGV2aWF0aW9uc1N0cmluZyIsImRldmlhdGlvbnMiLCJWQUxVRVNfVEVYVF9GT05UIiwiQkFST01FVEVSX1ZBTFVFX0ZPTlQiLCJNQVhfQ0hJX1NRVUFSRV9WQUxVRSIsIkxBQkVMX1RFWFRfT1BUSU9OUyIsImZvbnQiLCJCQVJPTUVURVJfU1lNQk9MX0ZPTlQiLCJtYXhXaWR0aCIsImNoaVN5bWJvbFN0cmluZyIsImNoaVN5bWJvbCIsInJTeW1ib2xTdHJpbmciLCJyU3ltYm9sIiwiTEFCRUxfTUFYX1dJRFRIIiwiVkFMVUVfTUFYX1dJRFRIIiwiQ0hJX1NRVUFSRURfUEFUVEVSTiIsIlJfU1FVQVJFRF9FUVVBTFNfU1RSSU5HIiwiRVFVQUxfVE8iLCJEZXZpYXRpb25zQWNjb3JkaW9uQm94IiwiY29uc3RydWN0b3IiLCJleHBhbmRlZFByb3BlcnR5IiwicG9pbnRzIiwiY2hpU3F1YXJlZFByb3BlcnR5IiwiclNxdWFyZWRQcm9wZXJ0eSIsImN1cnZlVmlzaWJsZVByb3BlcnR5Iiwib3B0aW9ucyIsImNvcm5lclJhZGl1cyIsIlBBTkVMX0NPUk5FUl9SQURJVVMiLCJmaWxsIiwiUEFORUxfQkFDS0dST1VORF9DT0xPUiIsIm1pbldpZHRoIiwiUEFORUxfTUlOX1dJRFRIIiwiUEFORUxfTUFYX1dJRFRIIiwidGl0bGVOb2RlIiwiQUNDT1JESU9OX0JPWF9USVRMRV9GT05UIiwidGl0bGVBbGlnblgiLCJ0aXRsZVhTcGFjaW5nIiwic2hvd1RpdGxlV2hlbkV4cGFuZGVkIiwiYnV0dG9uWE1hcmdpbiIsIlBBTkVMX01BUkdJTiIsImJ1dHRvbllNYXJnaW4iLCJleHBhbmRDb2xsYXBzZUJ1dHRvbk9wdGlvbnMiLCJ0b3VjaEFyZWFYRGlsYXRpb24iLCJ0b3VjaEFyZWFZRGlsYXRpb24iLCJ2YWx1ZVBhbmVsT3B0aW9ucyIsInhNYXJnaW4iLCJ5TWFyZ2luIiwicmVzaXplIiwicGFuZWxDb250ZW50Iiwid2lkdGgiLCJiYXJvbWV0ZXJYMiIsImJhcm9tZXRlclIyIiwiZGlhbG9nIiwiaGVscEJ1dHRvbiIsImxpc3RlbmVyIiwic2hvdyIsImJhc2VDb2xvciIsImljb25GaWxsIiwiY2hpU3F1YXJlZExhYmVsVGV4dCIsImNoaVNxdWFyZWRWYWx1ZVRleHQiLCJ0ZXh0QWxpZ24iLCJjaGlTcXVhcmVkVmFsdWVQYW5lbCIsImNoaVNxdWFyZWRJbmZvcm1hdGlvbkJveCIsImNoaWxkcmVuIiwiclNxdWFyZWRMYWJlbFRleHQiLCJyU3F1YXJlZFZhbHVlVGV4dCIsInJTcXVhcmVkVmFsdWVQYW5lbCIsInJTcXVhcmVkSW5mb3JtYXRpb25Cb3giLCJsaW5rIiwiY2hpU3F1YXJlZCIsInN0cmluZyIsImZpbGxJbiIsInJlbGF0aW9uYWxPcGVyYXRvciIsIkdSRUFURVJfVEhBTiIsImZvcm1hdE51bWJlciIsIk1hdGgiLCJtaW4iLCJjZW50ZXJYIiwiY2VudGVyWSIsImhlaWdodCIsInJTcXVhcmVkIiwiclNxdWFyZWRTdHJpbmciLCJpc05hTiIsImxpbmtBdHRyaWJ1dGUiLCJhZGRDaGlsZCIsInhTcGFjaW5nIiwieVNwYWNpbmciLCJyaWdodCIsImJvdHRvbSIsInRvcCIsImxlZnQiLCJudW1iZXIiLCJkaWdpdHMiLCJleHBvbmVudCIsImZsb29yIiwibG9nMTAiLCJhYnMiLCJkZWNpbWFsUGxhY2VzIiwidG9GaXhlZCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRGV2aWF0aW9uc0FjY29yZGlvbkJveC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBEZXZpYXRpb25zIGFjY29yZGlvbiBib3ggaW4gJ0N1cnZlIEZpdHRpbmcnIHNpbXVsYXRpb24uXHJcbiAqIENvbnRhaW5zIFheMiBiYXJvbWV0ZXIsIHJeMiBiYXJvbWV0ZXIgYW5kIGhlbHAgYnV0dG9uLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEFuZHJleSBaZWxlbmtvdiAoTWxlYXJuZXIpXHJcbiAqIEBhdXRob3IgU2F1cmFiaCBUb3RleVxyXG4gKi9cclxuXHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IFN0cmluZ1V0aWxzIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdXRpbC9TdHJpbmdVdGlscy5qcyc7XHJcbmltcG9ydCBJbmZvQnV0dG9uIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9idXR0b25zL0luZm9CdXR0b24uanMnO1xyXG5pbXBvcnQgTWF0aFN5bWJvbHMgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL01hdGhTeW1ib2xzLmpzJztcclxuaW1wb3J0IHsgSEJveCwgTm9kZSwgUmljaFRleHQsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgQWNjb3JkaW9uQm94IGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9BY2NvcmRpb25Cb3guanMnO1xyXG5pbXBvcnQgUGFuZWwgZnJvbSAnLi4vLi4vLi4vLi4vc3VuL2pzL1BhbmVsLmpzJztcclxuaW1wb3J0IGN1cnZlRml0dGluZyBmcm9tICcuLi8uLi9jdXJ2ZUZpdHRpbmcuanMnO1xyXG5pbXBvcnQgQ3VydmVGaXR0aW5nU3RyaW5ncyBmcm9tICcuLi8uLi9DdXJ2ZUZpdHRpbmdTdHJpbmdzLmpzJztcclxuaW1wb3J0IEN1cnZlRml0dGluZ0NvbnN0YW50cyBmcm9tICcuLi9DdXJ2ZUZpdHRpbmdDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgQmFyb21ldGVyUjJOb2RlIGZyb20gJy4vQmFyb21ldGVyUjJOb2RlLmpzJztcclxuaW1wb3J0IEJhcm9tZXRlclgyTm9kZSBmcm9tICcuL0Jhcm9tZXRlclgyTm9kZS5qcyc7XHJcbmltcG9ydCBSZWR1Y2VkQ2hpU3F1YXJlZFN0YXRpc3RpY0RpYWxvZyBmcm9tICcuL1JlZHVjZWRDaGlTcXVhcmVkU3RhdGlzdGljRGlhbG9nLmpzJztcclxuXHJcbmNvbnN0IGRldmlhdGlvbnNTdHJpbmcgPSBDdXJ2ZUZpdHRpbmdTdHJpbmdzLmRldmlhdGlvbnM7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgVkFMVUVTX1RFWFRfRk9OVCA9IEN1cnZlRml0dGluZ0NvbnN0YW50cy5CQVJPTUVURVJfVkFMVUVfRk9OVDtcclxuY29uc3QgTUFYX0NISV9TUVVBUkVfVkFMVUUgPSAxMDAwO1xyXG5jb25zdCBMQUJFTF9URVhUX09QVElPTlMgPSB7XHJcbiAgZm9udDogQ3VydmVGaXR0aW5nQ29uc3RhbnRzLkJBUk9NRVRFUl9TWU1CT0xfRk9OVCxcclxuICBtYXhXaWR0aDogMzVcclxufTtcclxuXHJcbi8vIHN0cmluZ3NcclxuY29uc3QgY2hpU3ltYm9sU3RyaW5nID0gQ3VydmVGaXR0aW5nU3RyaW5ncy5jaGlTeW1ib2w7XHJcbmNvbnN0IHJTeW1ib2xTdHJpbmcgPSBDdXJ2ZUZpdHRpbmdTdHJpbmdzLnJTeW1ib2w7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgTEFCRUxfTUFYX1dJRFRIID0gMzA7XHJcbmNvbnN0IFZBTFVFX01BWF9XSURUSCA9IDQ1O1xyXG5cclxuY29uc3QgQ0hJX1NRVUFSRURfUEFUVEVSTiA9IGAke2NoaVN5bWJvbFN0cmluZ308c3VwPjI8L3N1cD4mbmJzcDt7e3JlbGF0aW9uYWxPcGVyYXRvcn19Jm5ic3A7YDtcclxuY29uc3QgUl9TUVVBUkVEX0VRVUFMU19TVFJJTkcgPSBgJHtyU3ltYm9sU3RyaW5nfTxzdXA+Mjwvc3VwPiZuYnNwOyR7TWF0aFN5bWJvbHMuRVFVQUxfVE99Jm5ic3A7YDtcclxuXHJcbmNsYXNzIERldmlhdGlvbnNBY2NvcmRpb25Cb3ggZXh0ZW5kcyBBY2NvcmRpb25Cb3gge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5Ljxib29sZWFuPn0gZXhwYW5kZWRQcm9wZXJ0eSAtIGlzIHRoaXMgcGFuZWwgZXhwYW5kZWQ/XHJcbiAgICogQHBhcmFtIHtQb2ludHN9IHBvaW50c1xyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPG51bWJlcj59IGNoaVNxdWFyZWRQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPG51bWJlcj59IHJTcXVhcmVkUHJvcGVydHlcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5Ljxib29sZWFuPn0gY3VydmVWaXNpYmxlUHJvcGVydHlcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIGV4cGFuZGVkUHJvcGVydHksIHBvaW50cywgY2hpU3F1YXJlZFByb3BlcnR5LCByU3F1YXJlZFByb3BlcnR5LCBjdXJ2ZVZpc2libGVQcm9wZXJ0eSwgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgY29ybmVyUmFkaXVzOiBDdXJ2ZUZpdHRpbmdDb25zdGFudHMuUEFORUxfQ09STkVSX1JBRElVUyxcclxuICAgICAgZmlsbDogQ3VydmVGaXR0aW5nQ29uc3RhbnRzLlBBTkVMX0JBQ0tHUk9VTkRfQ09MT1IsXHJcbiAgICAgIG1pbldpZHRoOiBDdXJ2ZUZpdHRpbmdDb25zdGFudHMuUEFORUxfTUlOX1dJRFRILFxyXG4gICAgICBtYXhXaWR0aDogQ3VydmVGaXR0aW5nQ29uc3RhbnRzLlBBTkVMX01BWF9XSURUSCxcclxuICAgICAgZXhwYW5kZWRQcm9wZXJ0eTogZXhwYW5kZWRQcm9wZXJ0eSxcclxuICAgICAgdGl0bGVOb2RlOiBuZXcgVGV4dCggZGV2aWF0aW9uc1N0cmluZywge1xyXG4gICAgICAgIGZvbnQ6IEN1cnZlRml0dGluZ0NvbnN0YW50cy5BQ0NPUkRJT05fQk9YX1RJVExFX0ZPTlQsXHJcbiAgICAgICAgbWF4V2lkdGg6IDExNVxyXG4gICAgICB9ICksXHJcbiAgICAgIHRpdGxlQWxpZ25YOiAnbGVmdCcsXHJcbiAgICAgIHRpdGxlWFNwYWNpbmc6IDgsXHJcbiAgICAgIHNob3dUaXRsZVdoZW5FeHBhbmRlZDogdHJ1ZSxcclxuICAgICAgYnV0dG9uWE1hcmdpbjogQ3VydmVGaXR0aW5nQ29uc3RhbnRzLlBBTkVMX01BUkdJTixcclxuICAgICAgYnV0dG9uWU1hcmdpbjogQ3VydmVGaXR0aW5nQ29uc3RhbnRzLlBBTkVMX01BUkdJTixcclxuICAgICAgZXhwYW5kQ29sbGFwc2VCdXR0b25PcHRpb25zOiB7XHJcbiAgICAgICAgdG91Y2hBcmVhWERpbGF0aW9uOiA4LFxyXG4gICAgICAgIHRvdWNoQXJlYVlEaWxhdGlvbjogOFxyXG4gICAgICB9LFxyXG4gICAgICB2YWx1ZVBhbmVsT3B0aW9uczoge1xyXG4gICAgICAgIGZpbGw6ICd3aGl0ZScsXHJcbiAgICAgICAgY29ybmVyUmFkaXVzOiBDdXJ2ZUZpdHRpbmdDb25zdGFudHMuUEFORUxfQ09STkVSX1JBRElVUyxcclxuICAgICAgICB4TWFyZ2luOiA0LFxyXG4gICAgICAgIHlNYXJnaW46IDQsXHJcbiAgICAgICAgcmVzaXplOiBmYWxzZSxcclxuICAgICAgICBtYXhXaWR0aDogVkFMVUVfTUFYX1dJRFRIXHJcbiAgICAgIH1cclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCBwYW5lbENvbnRlbnQgPSBuZXcgTm9kZSggeyB3aWR0aDogb3B0aW9ucy5tYXhXaWR0aCB9ICk7XHJcblxyXG4gICAgLy8gWF4yIGJhcm9tZXRlclxyXG4gICAgY29uc3QgYmFyb21ldGVyWDIgPSBuZXcgQmFyb21ldGVyWDJOb2RlKCBwb2ludHMsIGNoaVNxdWFyZWRQcm9wZXJ0eSwgY3VydmVWaXNpYmxlUHJvcGVydHkgKTtcclxuXHJcbiAgICAvLyByXjIgYmFyb21ldGVyXHJcbiAgICBjb25zdCBiYXJvbWV0ZXJSMiA9IG5ldyBCYXJvbWV0ZXJSMk5vZGUoIHJTcXVhcmVkUHJvcGVydHksIGN1cnZlVmlzaWJsZVByb3BlcnR5ICk7XHJcblxyXG4gICAgLy8gaW5mb3JtYXRpb25hbCBkaWFsb2csIGNyZWF0ZWQgbGF6aWx5IGJlY2F1c2UgRGlhbG9nIHJlcXVpcmVzIHNpbSBib3VuZHMgZHVyaW5nIGNvbnN0cnVjdGlvblxyXG4gICAgbGV0IGRpYWxvZyA9IG51bGw7XHJcblxyXG4gICAgLy8gaGVscCBidXR0b25cclxuICAgIGNvbnN0IGhlbHBCdXR0b24gPSBuZXcgSW5mb0J1dHRvbigge1xyXG4gICAgICBsaXN0ZW5lcjogKCkgPT4ge1xyXG4gICAgICAgIGlmICggIWRpYWxvZyApIHtcclxuICAgICAgICAgIGRpYWxvZyA9IG5ldyBSZWR1Y2VkQ2hpU3F1YXJlZFN0YXRpc3RpY0RpYWxvZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkaWFsb2cuc2hvdygpO1xyXG4gICAgICB9LFxyXG4gICAgICBiYXNlQ29sb3I6ICdyZ2IoIDIwNCwgMjA0LCAyMDQgKScsXHJcbiAgICAgIGljb25GaWxsOiAncmdiKCA0NCwgMTA3LCAxNTkgKScsXHJcbiAgICAgIG1heFdpZHRoOiAzMCxcclxuICAgICAgdG91Y2hBcmVhWERpbGF0aW9uOiA4LFxyXG4gICAgICB0b3VjaEFyZWFZRGlsYXRpb246IDhcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBYXjIgPVxyXG4gICAgY29uc3QgY2hpU3F1YXJlZExhYmVsVGV4dCA9IG5ldyBSaWNoVGV4dCggJycsIExBQkVMX1RFWFRfT1BUSU9OUyApO1xyXG5cclxuICAgIC8vIFheMiB2YWx1ZVxyXG4gICAgY29uc3QgY2hpU3F1YXJlZFZhbHVlVGV4dCA9IG5ldyBUZXh0KCAnMC4wMCcsIHtcclxuICAgICAgZm9udDogVkFMVUVTX1RFWFRfRk9OVCxcclxuICAgICAgdGV4dEFsaWduOiAnbGVmdCcsXHJcbiAgICAgIG1heFdpZHRoOiBMQUJFTF9NQVhfV0lEVEhcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGNoaVNxdWFyZWRWYWx1ZVBhbmVsID0gbmV3IFBhbmVsKCBjaGlTcXVhcmVkVmFsdWVUZXh0LCBvcHRpb25zLnZhbHVlUGFuZWxPcHRpb25zICk7XHJcblxyXG4gICAgLy8gWF4yID0gdmFsdWVcclxuICAgIGNvbnN0IGNoaVNxdWFyZWRJbmZvcm1hdGlvbkJveCA9IG5ldyBIQm94KCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIGNoaVNxdWFyZWRMYWJlbFRleHQsIGNoaVNxdWFyZWRWYWx1ZVBhbmVsIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyByXjIgPVxyXG4gICAgY29uc3QgclNxdWFyZWRMYWJlbFRleHQgPSBuZXcgUmljaFRleHQoIFJfU1FVQVJFRF9FUVVBTFNfU1RSSU5HLCBMQUJFTF9URVhUX09QVElPTlMgKTtcclxuXHJcbiAgICAvLyByXjIgdmFsdWVcclxuICAgIGNvbnN0IHJTcXVhcmVkVmFsdWVUZXh0ID0gbmV3IFRleHQoICcwLjAwJywge1xyXG4gICAgICBmb250OiBWQUxVRVNfVEVYVF9GT05ULFxyXG4gICAgICB0ZXh0QWxpZ246ICdsZWZ0JyxcclxuICAgICAgbWF4V2lkdGg6IExBQkVMX01BWF9XSURUSFxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgclNxdWFyZWRWYWx1ZVBhbmVsID0gbmV3IFBhbmVsKCByU3F1YXJlZFZhbHVlVGV4dCwgb3B0aW9ucy52YWx1ZVBhbmVsT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIHJeMiA9IHZhbHVlXHJcbiAgICBjb25zdCByU3F1YXJlZEluZm9ybWF0aW9uQm94ID0gbmV3IEhCb3goIHtcclxuICAgICAgY2hpbGRyZW46IFsgclNxdWFyZWRMYWJlbFRleHQsIHJTcXVhcmVkVmFsdWVQYW5lbCBdXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gdW5saW5rIHVubmVjZXNzYXJ5LCBwcmVzZW50IGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIHNpbVxyXG4gICAgY2hpU3F1YXJlZFByb3BlcnR5LmxpbmsoIGNoaVNxdWFyZWQgPT4ge1xyXG5cclxuICAgICAgLy8gaWYgY2hpU3F1YXJlZCBpcyBsYXJnZXIgdGhhbiBhIDEwMDAsIHRoZSBhY3R1YWwgdmFsdWUgd2lsbCBub3QgYmUgZGlzcGxheWVkLCBzbyB1c2UgYSAnPicgc2lnblxyXG4gICAgICBjaGlTcXVhcmVkTGFiZWxUZXh0LnN0cmluZyA9IFN0cmluZ1V0aWxzLmZpbGxJbiggQ0hJX1NRVUFSRURfUEFUVEVSTiwge1xyXG4gICAgICAgIHJlbGF0aW9uYWxPcGVyYXRvcjogKCBjaGlTcXVhcmVkID4gTUFYX0NISV9TUVVBUkVfVkFMVUUgKSA/IE1hdGhTeW1ib2xzLkdSRUFURVJfVEhBTiA6IE1hdGhTeW1ib2xzLkVRVUFMX1RPXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAgIC8vIElmIGNoaVNxdWFyZWQgaXMgZ3JlYXRlciB0aGFuIDEwIHdlIGhhdmUgYSBiYWQgZml0IHNvIGxlc3MgcHJlY2lzaW9uIGlzIG5lZWRlZC5cclxuICAgICAgLy8gSWYgY2hpU3F1YXJlZCBpcyBncmVhdGVyIHRoYW4gMTAwIHdlIGhhdmUgYSByZWFsbHkgYmFkIGZpdCBhbmQgZGVjaW1hbHMgYXJlIGluY29uc2VxdWVudGlhbC5cclxuICAgICAgLy8gSWYgY2hpU3F1YXJlZCBpcyBsYXJnZXIgdGhhbiAxMDAwLCByb3VuZCBpdCB0byAxMDAwOyBzZWUgIzI4XHJcbiAgICAgIGNoaVNxdWFyZWRWYWx1ZVRleHQuc3RyaW5nID0gZm9ybWF0TnVtYmVyKCBNYXRoLm1pbiggY2hpU3F1YXJlZCwgTUFYX0NISV9TUVVBUkVfVkFMVUUgKSwgMiApO1xyXG5cclxuICAgICAgLy8gY2VudGVycyB0aGUgY2hpU3F1YXJlZCB0ZXh0IG5vZGUgd2l0aGluIHRoZSBwYW5lbFxyXG4gICAgICAvLyBjaGkgc3F1YXJlZCBuZWVkcyB0byBiZSBjZW50ZXJlZCBiZWNhdXNlIHRoZSBudW1iZXIgb2YgZGlnaXRzIGNhbiBjaGFuZ2VcclxuICAgICAgY2hpU3F1YXJlZFZhbHVlVGV4dC5jZW50ZXJYID0gY2hpU3F1YXJlZFZhbHVlUGFuZWwud2lkdGggLyAyO1xyXG4gICAgICBjaGlTcXVhcmVkVmFsdWVUZXh0LmNlbnRlclkgPSBjaGlTcXVhcmVkVmFsdWVQYW5lbC5oZWlnaHQgLyAyO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHVubGluayB1bm5lY2Vzc2FyeSwgcHJlc2VudCBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBzaW1cclxuICAgIHJTcXVhcmVkUHJvcGVydHkubGluayggclNxdWFyZWQgPT4ge1xyXG5cclxuICAgICAgbGV0IHJTcXVhcmVkU3RyaW5nO1xyXG4gICAgICBpZiAoIGlzTmFOKCByU3F1YXJlZCApICkge1xyXG4gICAgICAgIHJTcXVhcmVkU3RyaW5nID0gJyc7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgclNxdWFyZWRTdHJpbmcgPSBmb3JtYXROdW1iZXIoIHJTcXVhcmVkLCAyICk7XHJcbiAgICAgIH1cclxuICAgICAgclNxdWFyZWRWYWx1ZVRleHQuc3RyaW5nID0gclNxdWFyZWRTdHJpbmc7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gdW5saW5rcyB1bm5lY2Vzc2FyeSwgcHJlc2VudCBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBzaW1cclxuICAgIGN1cnZlVmlzaWJsZVByb3BlcnR5LmxpbmtBdHRyaWJ1dGUoIHJTcXVhcmVkVmFsdWVUZXh0LCAndmlzaWJsZScgKTtcclxuICAgIGN1cnZlVmlzaWJsZVByb3BlcnR5LmxpbmtBdHRyaWJ1dGUoIGNoaVNxdWFyZWRWYWx1ZVRleHQsICd2aXNpYmxlJyApO1xyXG5cclxuICAgIHBhbmVsQ29udGVudC5hZGRDaGlsZCggaGVscEJ1dHRvbiApO1xyXG4gICAgcGFuZWxDb250ZW50LmFkZENoaWxkKCBjaGlTcXVhcmVkSW5mb3JtYXRpb25Cb3ggKTtcclxuICAgIHBhbmVsQ29udGVudC5hZGRDaGlsZCggclNxdWFyZWRJbmZvcm1hdGlvbkJveCApO1xyXG4gICAgcGFuZWxDb250ZW50LmFkZENoaWxkKCBiYXJvbWV0ZXJYMiApO1xyXG4gICAgcGFuZWxDb250ZW50LmFkZENoaWxkKCBiYXJvbWV0ZXJSMiApO1xyXG5cclxuICAgIGNvbnN0IHhTcGFjaW5nID0gODtcclxuICAgIGNvbnN0IHlTcGFjaW5nID0gMTA7XHJcbiAgICBoZWxwQnV0dG9uLmNlbnRlclggPSBwYW5lbENvbnRlbnQud2lkdGggLyAyO1xyXG4gICAgY2hpU3F1YXJlZEluZm9ybWF0aW9uQm94LnJpZ2h0ID0gaGVscEJ1dHRvbi5jZW50ZXJYIC0geFNwYWNpbmc7XHJcbiAgICBjaGlTcXVhcmVkSW5mb3JtYXRpb25Cb3guYm90dG9tID0gaGVscEJ1dHRvbi50b3AgLSB5U3BhY2luZztcclxuICAgIHJTcXVhcmVkSW5mb3JtYXRpb25Cb3gubGVmdCA9IGhlbHBCdXR0b24uY2VudGVyWCArIHhTcGFjaW5nO1xyXG4gICAgclNxdWFyZWRJbmZvcm1hdGlvbkJveC5ib3R0b20gPSBoZWxwQnV0dG9uLnRvcCAtIHlTcGFjaW5nO1xyXG4gICAgYmFyb21ldGVyWDIuY2VudGVyWCA9IGNoaVNxdWFyZWRJbmZvcm1hdGlvbkJveC5jZW50ZXJYO1xyXG4gICAgYmFyb21ldGVyUjIuY2VudGVyWCA9IHJTcXVhcmVkSW5mb3JtYXRpb25Cb3guY2VudGVyWDtcclxuICAgIGJhcm9tZXRlclgyLmJvdHRvbSA9IGNoaVNxdWFyZWRJbmZvcm1hdGlvbkJveC50b3AgLSB5U3BhY2luZztcclxuICAgIGJhcm9tZXRlclIyLmJvdHRvbSA9IHJTcXVhcmVkSW5mb3JtYXRpb25Cb3gudG9wIC0geVNwYWNpbmc7XHJcblxyXG4gICAgc3VwZXIoIHBhbmVsQ29udGVudCwgb3B0aW9ucyApO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGb3IgbnVtYmVycyBzbWFsbGVyIHRoYW4gdGVuLCByZXR1cm5zIGEgbnVtYmVyIHdpdGggZGlnaXRzIGRlY2ltYWwgcGxhY2VzLlxyXG4gKiBGb3IgbnVtYmVycyBsYXJnZXIgdGhhbiB0ZW4sIHJldHVybnMgYSBmaXhlZCBudW1iZXIgd2l0aCAoZGlnaXRzICsgMSkgc2lnbmlmaWNhbnQgZmlndXJlcy5cclxuICpcclxuICogQHBhcmFtIHtudW1iZXJ9IG51bWJlclxyXG4gKiBAcGFyYW0ge251bWJlcn0gZGlnaXRzXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG5mdW5jdGlvbiBmb3JtYXROdW1iZXIoIG51bWJlciwgZGlnaXRzICkge1xyXG5cclxuICAvLyBlLmcuIGZvciBkaWdpdHMgPSAzXHJcbiAgLy8gOTk5OS4xMSAtPiA5OTk5ICAobnVtYmVycyBncmVhdGVyIHRoYW4gMTBeMykgYXJlIHJvdW5kZWQgdG8gaW50ZWdlcnNcclxuICAvLyA5OTkuMTExIC0+IDk5OS4xXHJcbiAgLy8gOTkuMTExMSAtPiA5OS4xMVxyXG4gIC8vIDkuMTExMTEgLT4gOS4xMTEgKG51bWJlcnMgbGVzcyB0aGFuIDEwKSBoYXZlIDMgZGVjaW1hbCBwbGFjZXNcclxuICAvLyAxLjExMTExIC0+IDEuMTExXHJcbiAgLy8gMC4xMTExMSAtPiAwLjExMVxyXG4gIC8vIDAuMDExMTEgLT4gMC4wMTFcclxuICAvLyAwLjAwMTExIC0+IDAuMDAxXHJcbiAgLy8gMC4wMDAxMSAtPiAwLjAwMFxyXG5cclxuICAvLyBudW1iZXIgPSBtYW50aXNzYSB0aW1lcyAxMF4oZXhwb25lbnQpIHdoZXJlIHRoZSBtYW50aXNzYSBpcyBiZXR3ZWVuIDEgYW5kIDEwIChvciAtMSBhbmQgLTEwKVxyXG4gIGNvbnN0IGV4cG9uZW50ID0gTWF0aC5mbG9vciggVXRpbHMubG9nMTAoIE1hdGguYWJzKCBudW1iZXIgKSApICk7XHJcblxyXG4gIGxldCBkZWNpbWFsUGxhY2VzO1xyXG4gIGlmICggZXhwb25lbnQgPj0gZGlnaXRzICkge1xyXG4gICAgZGVjaW1hbFBsYWNlcyA9IDA7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKCBleHBvbmVudCA+IDAgKSB7XHJcbiAgICBkZWNpbWFsUGxhY2VzID0gZGlnaXRzIC0gZXhwb25lbnQ7XHJcbiAgfVxyXG4gIGVsc2Uge1xyXG4gICAgZGVjaW1hbFBsYWNlcyA9IGRpZ2l0cztcclxuICB9XHJcblxyXG4gIHJldHVybiBVdGlscy50b0ZpeGVkKCBudW1iZXIsIGRlY2ltYWxQbGFjZXMgKTtcclxufVxyXG5cclxuY3VydmVGaXR0aW5nLnJlZ2lzdGVyKCAnRGV2aWF0aW9uc0FjY29yZGlvbkJveCcsIERldmlhdGlvbnNBY2NvcmRpb25Cb3ggKTtcclxuZXhwb3J0IGRlZmF1bHQgRGV2aWF0aW9uc0FjY29yZGlvbkJveDtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxLQUFLLE1BQU0sNkJBQTZCO0FBQy9DLE9BQU9DLEtBQUssTUFBTSxtQ0FBbUM7QUFDckQsT0FBT0MsV0FBVyxNQUFNLCtDQUErQztBQUN2RSxPQUFPQyxVQUFVLE1BQU0sbURBQW1EO0FBQzFFLE9BQU9DLFdBQVcsTUFBTSw0Q0FBNEM7QUFDcEUsU0FBU0MsSUFBSSxFQUFFQyxJQUFJLEVBQUVDLFFBQVEsRUFBRUMsSUFBSSxRQUFRLG1DQUFtQztBQUM5RSxPQUFPQyxZQUFZLE1BQU0sb0NBQW9DO0FBQzdELE9BQU9DLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsWUFBWSxNQUFNLHVCQUF1QjtBQUNoRCxPQUFPQyxtQkFBbUIsTUFBTSw4QkFBOEI7QUFDOUQsT0FBT0MscUJBQXFCLE1BQU0sNkJBQTZCO0FBQy9ELE9BQU9DLGVBQWUsTUFBTSxzQkFBc0I7QUFDbEQsT0FBT0MsZUFBZSxNQUFNLHNCQUFzQjtBQUNsRCxPQUFPQyxnQ0FBZ0MsTUFBTSx1Q0FB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