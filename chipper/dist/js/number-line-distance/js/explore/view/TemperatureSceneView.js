// Copyright 2020-2022, University of Colorado Boulder

/**
 * 'Temperature' scene view for the explore screen
 *
 * @author Saurabh Totey
 */

import Utils from '../../../../dot/js/Utils.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Image, LinearGradient, Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import antarctic_png from '../../../images/antarctic_png.js';
import desert_png from '../../../images/desert_png.js';
import trees_png from '../../../images/trees_png.js';
import numberLineDistance from '../../numberLineDistance.js';
import NumberLineDistanceStrings from '../../NumberLineDistanceStrings.js';
import TemperatureSceneModel from '../model/TemperatureSceneModel.js';
import NLDSceneView from './NLDSceneView.js';
import TemperaturePointControllerNode from './TemperaturePointControllerNode.js';
const aString = NumberLineDistanceStrings.symbol.A;
const bString = NumberLineDistanceStrings.symbol.B;
const temperatureSceneAbsoluteDistanceTemplateString = NumberLineDistanceStrings.temperatureSceneAbsoluteDistanceTemplate;
const temperatureSceneDirectedPositiveDistanceTemplateString = NumberLineDistanceStrings.temperatureSceneDirectedPositiveDistanceTemplate;
const temperatureSceneDirectedNegativeDistanceTemplateString = NumberLineDistanceStrings.temperatureSceneDirectedNegativeDistanceTemplate;
const degreesCelsiusString = NumberLineDistanceStrings.symbol.degreesCelsius;
const degreeString = NumberLineDistanceStrings.degree;
const degreesString = NumberLineDistanceStrings.degrees;

// constants
const REPRESENTATION_TEXT_OPTIONS = {
  font: new PhetFont(25),
  maxWidth: 50
};
const NUMBER_OF_TEMPERATURE_GRADIENT_COLOR_STOPS = 5;
class TemperatureSceneView extends NLDSceneView {
  /**
   * @param {TemperatureSceneModel} model
   */
  constructor(model) {
    // texts that represent the point controllers in the swap area at the bottom left
    const aText = new Text(aString, REPRESENTATION_TEXT_OPTIONS);
    const bText = new Text(bString, REPRESENTATION_TEXT_OPTIONS);

    // Match the color of the point controller with the representation texts.
    aText.fill = model.pointControllers[0].color;
    bText.fill = model.pointControllers[1].color;

    // @private
    super(model, {
      pointControllerRepresentationOne: aText,
      pointControllerRepresentationTwo: bText,
      distanceDescriptionStrings: {
        absoluteDistanceDescriptionTemplate: temperatureSceneAbsoluteDistanceTemplateString,
        directedPositiveDistanceDescriptionTemplate: temperatureSceneDirectedPositiveDistanceTemplateString,
        directedNegativeDistanceDescriptionTemplate: temperatureSceneDirectedNegativeDistanceTemplateString,
        singularUnits: degreeString,
        pluralUnits: degreesString,
        getPrimaryPointControllerLabel: isPrimaryNodeSwapped => isPrimaryNodeSwapped ? bString : aString,
        getSecondaryPointControllerLabel: isPrimaryNodeSwapped => isPrimaryNodeSwapped ? aString : bString
      },
      distanceShadedNumberLineNodeOptions: {
        unitsString: degreesCelsiusString
      }
    });

    // Create the gradient which shows a continuous color representation of the number line temperature values.
    let rectangleGradient = new LinearGradient(model.temperatureAreaBounds.minX, model.temperatureAreaBounds.minY, model.temperatureAreaBounds.maxX, model.temperatureAreaBounds.minY);
    for (let i = 0; i < NUMBER_OF_TEMPERATURE_GRADIENT_COLOR_STOPS; i++) {
      const ratio = i / (NUMBER_OF_TEMPERATURE_GRADIENT_COLOR_STOPS - 1);
      const value = Utils.roundSymmetric(TemperatureSceneModel.TEMPERATURE_RANGE.getLength() * ratio + TemperatureSceneModel.TEMPERATURE_RANGE.min);
      rectangleGradient = rectangleGradient.addColorStop(ratio, model.temperatureToColorMapper.mapTemperatureToColor(value));
    }
    this.addChild(new Rectangle(model.temperatureAreaBounds, {
      fill: rectangleGradient
    }));

    // Add images on top of the rectangle gradient.
    this.addChild(new Image(antarctic_png, {
      left: model.temperatureAreaBounds.left,
      bottom: model.temperatureAreaBounds.bottom,
      maxHeight: model.temperatureAreaBounds.height
    }));
    this.addChild(new Image(trees_png, {
      centerX: model.temperatureAreaBounds.centerX,
      bottom: model.temperatureAreaBounds.bottom,
      maxHeight: model.temperatureAreaBounds.height
    }));
    this.addChild(new Image(desert_png, {
      right: model.temperatureAreaBounds.right,
      bottom: model.temperatureAreaBounds.bottom,
      maxHeight: model.temperatureAreaBounds.height
    }));

    // point controllers
    const pointControllerNodeLayer = new Node({
      children: [new TemperaturePointControllerNode(model.pointControllerOne, aString, {
        thermometerFluidHighlightColor: '#ad3dc3'
      }), new TemperaturePointControllerNode(model.pointControllerTwo, bString)]
    });
    this.addChild(pointControllerNodeLayer);
  }
}
numberLineDistance.register('TemperatureSceneView', TemperatureSceneView);
export default TemperatureSceneView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIlBoZXRGb250IiwiSW1hZ2UiLCJMaW5lYXJHcmFkaWVudCIsIk5vZGUiLCJSZWN0YW5nbGUiLCJUZXh0IiwiYW50YXJjdGljX3BuZyIsImRlc2VydF9wbmciLCJ0cmVlc19wbmciLCJudW1iZXJMaW5lRGlzdGFuY2UiLCJOdW1iZXJMaW5lRGlzdGFuY2VTdHJpbmdzIiwiVGVtcGVyYXR1cmVTY2VuZU1vZGVsIiwiTkxEU2NlbmVWaWV3IiwiVGVtcGVyYXR1cmVQb2ludENvbnRyb2xsZXJOb2RlIiwiYVN0cmluZyIsInN5bWJvbCIsIkEiLCJiU3RyaW5nIiwiQiIsInRlbXBlcmF0dXJlU2NlbmVBYnNvbHV0ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmciLCJ0ZW1wZXJhdHVyZVNjZW5lQWJzb2x1dGVEaXN0YW5jZVRlbXBsYXRlIiwidGVtcGVyYXR1cmVTY2VuZURpcmVjdGVkUG9zaXRpdmVEaXN0YW5jZVRlbXBsYXRlU3RyaW5nIiwidGVtcGVyYXR1cmVTY2VuZURpcmVjdGVkUG9zaXRpdmVEaXN0YW5jZVRlbXBsYXRlIiwidGVtcGVyYXR1cmVTY2VuZURpcmVjdGVkTmVnYXRpdmVEaXN0YW5jZVRlbXBsYXRlU3RyaW5nIiwidGVtcGVyYXR1cmVTY2VuZURpcmVjdGVkTmVnYXRpdmVEaXN0YW5jZVRlbXBsYXRlIiwiZGVncmVlc0NlbHNpdXNTdHJpbmciLCJkZWdyZWVzQ2Vsc2l1cyIsImRlZ3JlZVN0cmluZyIsImRlZ3JlZSIsImRlZ3JlZXNTdHJpbmciLCJkZWdyZWVzIiwiUkVQUkVTRU5UQVRJT05fVEVYVF9PUFRJT05TIiwiZm9udCIsIm1heFdpZHRoIiwiTlVNQkVSX09GX1RFTVBFUkFUVVJFX0dSQURJRU5UX0NPTE9SX1NUT1BTIiwiVGVtcGVyYXR1cmVTY2VuZVZpZXciLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwiYVRleHQiLCJiVGV4dCIsImZpbGwiLCJwb2ludENvbnRyb2xsZXJzIiwiY29sb3IiLCJwb2ludENvbnRyb2xsZXJSZXByZXNlbnRhdGlvbk9uZSIsInBvaW50Q29udHJvbGxlclJlcHJlc2VudGF0aW9uVHdvIiwiZGlzdGFuY2VEZXNjcmlwdGlvblN0cmluZ3MiLCJhYnNvbHV0ZURpc3RhbmNlRGVzY3JpcHRpb25UZW1wbGF0ZSIsImRpcmVjdGVkUG9zaXRpdmVEaXN0YW5jZURlc2NyaXB0aW9uVGVtcGxhdGUiLCJkaXJlY3RlZE5lZ2F0aXZlRGlzdGFuY2VEZXNjcmlwdGlvblRlbXBsYXRlIiwic2luZ3VsYXJVbml0cyIsInBsdXJhbFVuaXRzIiwiZ2V0UHJpbWFyeVBvaW50Q29udHJvbGxlckxhYmVsIiwiaXNQcmltYXJ5Tm9kZVN3YXBwZWQiLCJnZXRTZWNvbmRhcnlQb2ludENvbnRyb2xsZXJMYWJlbCIsImRpc3RhbmNlU2hhZGVkTnVtYmVyTGluZU5vZGVPcHRpb25zIiwidW5pdHNTdHJpbmciLCJyZWN0YW5nbGVHcmFkaWVudCIsInRlbXBlcmF0dXJlQXJlYUJvdW5kcyIsIm1pblgiLCJtaW5ZIiwibWF4WCIsImkiLCJyYXRpbyIsInZhbHVlIiwicm91bmRTeW1tZXRyaWMiLCJURU1QRVJBVFVSRV9SQU5HRSIsImdldExlbmd0aCIsIm1pbiIsImFkZENvbG9yU3RvcCIsInRlbXBlcmF0dXJlVG9Db2xvck1hcHBlciIsIm1hcFRlbXBlcmF0dXJlVG9Db2xvciIsImFkZENoaWxkIiwibGVmdCIsImJvdHRvbSIsIm1heEhlaWdodCIsImhlaWdodCIsImNlbnRlclgiLCJyaWdodCIsInBvaW50Q29udHJvbGxlck5vZGVMYXllciIsImNoaWxkcmVuIiwicG9pbnRDb250cm9sbGVyT25lIiwidGhlcm1vbWV0ZXJGbHVpZEhpZ2hsaWdodENvbG9yIiwicG9pbnRDb250cm9sbGVyVHdvIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJUZW1wZXJhdHVyZVNjZW5lVmlldy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiAnVGVtcGVyYXR1cmUnIHNjZW5lIHZpZXcgZm9yIHRoZSBleHBsb3JlIHNjcmVlblxyXG4gKlxyXG4gKiBAYXV0aG9yIFNhdXJhYmggVG90ZXlcclxuICovXHJcblxyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1V0aWxzLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IEltYWdlLCBMaW5lYXJHcmFkaWVudCwgTm9kZSwgUmVjdGFuZ2xlLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IGFudGFyY3RpY19wbmcgZnJvbSAnLi4vLi4vLi4vaW1hZ2VzL2FudGFyY3RpY19wbmcuanMnO1xyXG5pbXBvcnQgZGVzZXJ0X3BuZyBmcm9tICcuLi8uLi8uLi9pbWFnZXMvZGVzZXJ0X3BuZy5qcyc7XHJcbmltcG9ydCB0cmVlc19wbmcgZnJvbSAnLi4vLi4vLi4vaW1hZ2VzL3RyZWVzX3BuZy5qcyc7XHJcbmltcG9ydCBudW1iZXJMaW5lRGlzdGFuY2UgZnJvbSAnLi4vLi4vbnVtYmVyTGluZURpc3RhbmNlLmpzJztcclxuaW1wb3J0IE51bWJlckxpbmVEaXN0YW5jZVN0cmluZ3MgZnJvbSAnLi4vLi4vTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBUZW1wZXJhdHVyZVNjZW5lTW9kZWwgZnJvbSAnLi4vbW9kZWwvVGVtcGVyYXR1cmVTY2VuZU1vZGVsLmpzJztcclxuaW1wb3J0IE5MRFNjZW5lVmlldyBmcm9tICcuL05MRFNjZW5lVmlldy5qcyc7XHJcbmltcG9ydCBUZW1wZXJhdHVyZVBvaW50Q29udHJvbGxlck5vZGUgZnJvbSAnLi9UZW1wZXJhdHVyZVBvaW50Q29udHJvbGxlck5vZGUuanMnO1xyXG5cclxuY29uc3QgYVN0cmluZyA9IE51bWJlckxpbmVEaXN0YW5jZVN0cmluZ3Muc3ltYm9sLkE7XHJcbmNvbnN0IGJTdHJpbmcgPSBOdW1iZXJMaW5lRGlzdGFuY2VTdHJpbmdzLnN5bWJvbC5CO1xyXG5jb25zdCB0ZW1wZXJhdHVyZVNjZW5lQWJzb2x1dGVEaXN0YW5jZVRlbXBsYXRlU3RyaW5nID0gTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncy50ZW1wZXJhdHVyZVNjZW5lQWJzb2x1dGVEaXN0YW5jZVRlbXBsYXRlO1xyXG5jb25zdCB0ZW1wZXJhdHVyZVNjZW5lRGlyZWN0ZWRQb3NpdGl2ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmcgPSBOdW1iZXJMaW5lRGlzdGFuY2VTdHJpbmdzLnRlbXBlcmF0dXJlU2NlbmVEaXJlY3RlZFBvc2l0aXZlRGlzdGFuY2VUZW1wbGF0ZTtcclxuY29uc3QgdGVtcGVyYXR1cmVTY2VuZURpcmVjdGVkTmVnYXRpdmVEaXN0YW5jZVRlbXBsYXRlU3RyaW5nID0gTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncy50ZW1wZXJhdHVyZVNjZW5lRGlyZWN0ZWROZWdhdGl2ZURpc3RhbmNlVGVtcGxhdGU7XHJcbmNvbnN0IGRlZ3JlZXNDZWxzaXVzU3RyaW5nID0gTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncy5zeW1ib2wuZGVncmVlc0NlbHNpdXM7XHJcbmNvbnN0IGRlZ3JlZVN0cmluZyA9IE51bWJlckxpbmVEaXN0YW5jZVN0cmluZ3MuZGVncmVlO1xyXG5jb25zdCBkZWdyZWVzU3RyaW5nID0gTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncy5kZWdyZWVzO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IFJFUFJFU0VOVEFUSU9OX1RFWFRfT1BUSU9OUyA9IHsgZm9udDogbmV3IFBoZXRGb250KCAyNSApLCBtYXhXaWR0aDogNTAgfTtcclxuY29uc3QgTlVNQkVSX09GX1RFTVBFUkFUVVJFX0dSQURJRU5UX0NPTE9SX1NUT1BTID0gNTtcclxuXHJcbmNsYXNzIFRlbXBlcmF0dXJlU2NlbmVWaWV3IGV4dGVuZHMgTkxEU2NlbmVWaWV3IHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtUZW1wZXJhdHVyZVNjZW5lTW9kZWx9IG1vZGVsXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG1vZGVsICkge1xyXG5cclxuICAgIC8vIHRleHRzIHRoYXQgcmVwcmVzZW50IHRoZSBwb2ludCBjb250cm9sbGVycyBpbiB0aGUgc3dhcCBhcmVhIGF0IHRoZSBib3R0b20gbGVmdFxyXG4gICAgY29uc3QgYVRleHQgPSBuZXcgVGV4dCggYVN0cmluZywgUkVQUkVTRU5UQVRJT05fVEVYVF9PUFRJT05TICk7XHJcbiAgICBjb25zdCBiVGV4dCA9IG5ldyBUZXh0KCBiU3RyaW5nLCBSRVBSRVNFTlRBVElPTl9URVhUX09QVElPTlMgKTtcclxuXHJcbiAgICAvLyBNYXRjaCB0aGUgY29sb3Igb2YgdGhlIHBvaW50IGNvbnRyb2xsZXIgd2l0aCB0aGUgcmVwcmVzZW50YXRpb24gdGV4dHMuXHJcbiAgICBhVGV4dC5maWxsID0gbW9kZWwucG9pbnRDb250cm9sbGVyc1sgMCBdLmNvbG9yO1xyXG4gICAgYlRleHQuZmlsbCA9IG1vZGVsLnBvaW50Q29udHJvbGxlcnNbIDEgXS5jb2xvcjtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZVxyXG4gICAgc3VwZXIoXHJcbiAgICAgIG1vZGVsLFxyXG4gICAgICB7XHJcbiAgICAgICAgcG9pbnRDb250cm9sbGVyUmVwcmVzZW50YXRpb25PbmU6IGFUZXh0LFxyXG4gICAgICAgIHBvaW50Q29udHJvbGxlclJlcHJlc2VudGF0aW9uVHdvOiBiVGV4dCxcclxuICAgICAgICBkaXN0YW5jZURlc2NyaXB0aW9uU3RyaW5nczoge1xyXG4gICAgICAgICAgYWJzb2x1dGVEaXN0YW5jZURlc2NyaXB0aW9uVGVtcGxhdGU6IHRlbXBlcmF0dXJlU2NlbmVBYnNvbHV0ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmcsXHJcbiAgICAgICAgICBkaXJlY3RlZFBvc2l0aXZlRGlzdGFuY2VEZXNjcmlwdGlvblRlbXBsYXRlOiB0ZW1wZXJhdHVyZVNjZW5lRGlyZWN0ZWRQb3NpdGl2ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmcsXHJcbiAgICAgICAgICBkaXJlY3RlZE5lZ2F0aXZlRGlzdGFuY2VEZXNjcmlwdGlvblRlbXBsYXRlOiB0ZW1wZXJhdHVyZVNjZW5lRGlyZWN0ZWROZWdhdGl2ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmcsXHJcbiAgICAgICAgICBzaW5ndWxhclVuaXRzOiBkZWdyZWVTdHJpbmcsXHJcbiAgICAgICAgICBwbHVyYWxVbml0czogZGVncmVlc1N0cmluZyxcclxuICAgICAgICAgIGdldFByaW1hcnlQb2ludENvbnRyb2xsZXJMYWJlbDogaXNQcmltYXJ5Tm9kZVN3YXBwZWQgPT4gaXNQcmltYXJ5Tm9kZVN3YXBwZWQgPyBiU3RyaW5nIDogYVN0cmluZyxcclxuICAgICAgICAgIGdldFNlY29uZGFyeVBvaW50Q29udHJvbGxlckxhYmVsOiBpc1ByaW1hcnlOb2RlU3dhcHBlZCA9PiBpc1ByaW1hcnlOb2RlU3dhcHBlZCA/IGFTdHJpbmcgOiBiU3RyaW5nXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkaXN0YW5jZVNoYWRlZE51bWJlckxpbmVOb2RlT3B0aW9uczogeyB1bml0c1N0cmluZzogZGVncmVlc0NlbHNpdXNTdHJpbmcgfVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgZ3JhZGllbnQgd2hpY2ggc2hvd3MgYSBjb250aW51b3VzIGNvbG9yIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBudW1iZXIgbGluZSB0ZW1wZXJhdHVyZSB2YWx1ZXMuXHJcbiAgICBsZXQgcmVjdGFuZ2xlR3JhZGllbnQgPSBuZXcgTGluZWFyR3JhZGllbnQoXHJcbiAgICAgIG1vZGVsLnRlbXBlcmF0dXJlQXJlYUJvdW5kcy5taW5YLFxyXG4gICAgICBtb2RlbC50ZW1wZXJhdHVyZUFyZWFCb3VuZHMubWluWSxcclxuICAgICAgbW9kZWwudGVtcGVyYXR1cmVBcmVhQm91bmRzLm1heFgsXHJcbiAgICAgIG1vZGVsLnRlbXBlcmF0dXJlQXJlYUJvdW5kcy5taW5ZXHJcbiAgICApO1xyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgTlVNQkVSX09GX1RFTVBFUkFUVVJFX0dSQURJRU5UX0NPTE9SX1NUT1BTOyBpKysgKSB7XHJcbiAgICAgIGNvbnN0IHJhdGlvID0gaSAvICggTlVNQkVSX09GX1RFTVBFUkFUVVJFX0dSQURJRU5UX0NPTE9SX1NUT1BTIC0gMSApO1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IFV0aWxzLnJvdW5kU3ltbWV0cmljKFxyXG4gICAgICAgIFRlbXBlcmF0dXJlU2NlbmVNb2RlbC5URU1QRVJBVFVSRV9SQU5HRS5nZXRMZW5ndGgoKSAqIHJhdGlvICsgVGVtcGVyYXR1cmVTY2VuZU1vZGVsLlRFTVBFUkFUVVJFX1JBTkdFLm1pblxyXG4gICAgICApO1xyXG4gICAgICByZWN0YW5nbGVHcmFkaWVudCA9IHJlY3RhbmdsZUdyYWRpZW50LmFkZENvbG9yU3RvcChcclxuICAgICAgICByYXRpbyxcclxuICAgICAgICBtb2RlbC50ZW1wZXJhdHVyZVRvQ29sb3JNYXBwZXIubWFwVGVtcGVyYXR1cmVUb0NvbG9yKCB2YWx1ZSApXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmFkZENoaWxkKCBuZXcgUmVjdGFuZ2xlKCBtb2RlbC50ZW1wZXJhdHVyZUFyZWFCb3VuZHMsIHtcclxuICAgICAgZmlsbDogcmVjdGFuZ2xlR3JhZGllbnRcclxuICAgIH0gKSApO1xyXG5cclxuICAgIC8vIEFkZCBpbWFnZXMgb24gdG9wIG9mIHRoZSByZWN0YW5nbGUgZ3JhZGllbnQuXHJcbiAgICB0aGlzLmFkZENoaWxkKCBuZXcgSW1hZ2UoXHJcbiAgICAgIGFudGFyY3RpY19wbmcsXHJcbiAgICAgIHtcclxuICAgICAgICBsZWZ0OiBtb2RlbC50ZW1wZXJhdHVyZUFyZWFCb3VuZHMubGVmdCxcclxuICAgICAgICBib3R0b206IG1vZGVsLnRlbXBlcmF0dXJlQXJlYUJvdW5kcy5ib3R0b20sXHJcbiAgICAgICAgbWF4SGVpZ2h0OiBtb2RlbC50ZW1wZXJhdHVyZUFyZWFCb3VuZHMuaGVpZ2h0XHJcbiAgICAgIH1cclxuICAgICkgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBJbWFnZShcclxuICAgICAgdHJlZXNfcG5nLFxyXG4gICAgICB7XHJcbiAgICAgICAgY2VudGVyWDogbW9kZWwudGVtcGVyYXR1cmVBcmVhQm91bmRzLmNlbnRlclgsXHJcbiAgICAgICAgYm90dG9tOiBtb2RlbC50ZW1wZXJhdHVyZUFyZWFCb3VuZHMuYm90dG9tLFxyXG4gICAgICAgIG1heEhlaWdodDogbW9kZWwudGVtcGVyYXR1cmVBcmVhQm91bmRzLmhlaWdodFxyXG4gICAgICB9XHJcbiAgICApICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBuZXcgSW1hZ2UoXHJcbiAgICAgIGRlc2VydF9wbmcsXHJcbiAgICAgIHtcclxuICAgICAgICByaWdodDogbW9kZWwudGVtcGVyYXR1cmVBcmVhQm91bmRzLnJpZ2h0LFxyXG4gICAgICAgIGJvdHRvbTogbW9kZWwudGVtcGVyYXR1cmVBcmVhQm91bmRzLmJvdHRvbSxcclxuICAgICAgICBtYXhIZWlnaHQ6IG1vZGVsLnRlbXBlcmF0dXJlQXJlYUJvdW5kcy5oZWlnaHRcclxuICAgICAgfVxyXG4gICAgKSApO1xyXG5cclxuICAgIC8vIHBvaW50IGNvbnRyb2xsZXJzXHJcbiAgICBjb25zdCBwb2ludENvbnRyb2xsZXJOb2RlTGF5ZXIgPSBuZXcgTm9kZSgge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIG5ldyBUZW1wZXJhdHVyZVBvaW50Q29udHJvbGxlck5vZGUoIG1vZGVsLnBvaW50Q29udHJvbGxlck9uZSwgYVN0cmluZywge1xyXG4gICAgICAgICAgdGhlcm1vbWV0ZXJGbHVpZEhpZ2hsaWdodENvbG9yOiAnI2FkM2RjMydcclxuICAgICAgICB9ICksXHJcbiAgICAgICAgbmV3IFRlbXBlcmF0dXJlUG9pbnRDb250cm9sbGVyTm9kZSggbW9kZWwucG9pbnRDb250cm9sbGVyVHdvLCBiU3RyaW5nIClcclxuICAgICAgXVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggcG9pbnRDb250cm9sbGVyTm9kZUxheWVyICk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxubnVtYmVyTGluZURpc3RhbmNlLnJlZ2lzdGVyKCAnVGVtcGVyYXR1cmVTY2VuZVZpZXcnLCBUZW1wZXJhdHVyZVNjZW5lVmlldyApO1xyXG5leHBvcnQgZGVmYXVsdCBUZW1wZXJhdHVyZVNjZW5lVmlldztcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxLQUFLLEVBQUVDLGNBQWMsRUFBRUMsSUFBSSxFQUFFQyxTQUFTLEVBQUVDLElBQUksUUFBUSxtQ0FBbUM7QUFDaEcsT0FBT0MsYUFBYSxNQUFNLGtDQUFrQztBQUM1RCxPQUFPQyxVQUFVLE1BQU0sK0JBQStCO0FBQ3RELE9BQU9DLFNBQVMsTUFBTSw4QkFBOEI7QUFDcEQsT0FBT0Msa0JBQWtCLE1BQU0sNkJBQTZCO0FBQzVELE9BQU9DLHlCQUF5QixNQUFNLG9DQUFvQztBQUMxRSxPQUFPQyxxQkFBcUIsTUFBTSxtQ0FBbUM7QUFDckUsT0FBT0MsWUFBWSxNQUFNLG1CQUFtQjtBQUM1QyxPQUFPQyw4QkFBOEIsTUFBTSxxQ0FBcUM7QUFFaEYsTUFBTUMsT0FBTyxHQUFHSix5QkFBeUIsQ0FBQ0ssTUFBTSxDQUFDQyxDQUFDO0FBQ2xELE1BQU1DLE9BQU8sR0FBR1AseUJBQXlCLENBQUNLLE1BQU0sQ0FBQ0csQ0FBQztBQUNsRCxNQUFNQyw4Q0FBOEMsR0FBR1QseUJBQXlCLENBQUNVLHdDQUF3QztBQUN6SCxNQUFNQyxzREFBc0QsR0FBR1gseUJBQXlCLENBQUNZLGdEQUFnRDtBQUN6SSxNQUFNQyxzREFBc0QsR0FBR2IseUJBQXlCLENBQUNjLGdEQUFnRDtBQUN6SSxNQUFNQyxv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