// Copyright 2020-2022, University of Colorado Boulder

/**
 * A point controller that is a thermometer for use in the temperature scene
 *
 * @author Saurabh Totey
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import PointControllerNode from '../../../../number-line-common/js/common/view/PointControllerNode.js';
import merge from '../../../../phet-core/js/merge.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import ThermometerNode from '../../../../scenery-phet/js/ThermometerNode.js';
import { Color, Node, Text } from '../../../../scenery/js/imports.js';
import numberLineDistance from '../../numberLineDistance.js';
import TemperatureSceneModel from '../model/TemperatureSceneModel.js';

// constants
const DEFAULT_TEMPERATURE_VALUE = 0;
const TOUCH_DILATION = 5;
const MOUSE_DILATION = 1;
class TemperaturePointControllerNode extends PointControllerNode {
  /**
   * @param {TemperaturePointController} pointController
   * @param {string} label
   * @param {Object} [options]
   * @public
   */
  constructor(pointController, label, options) {
    // create a node that composites the thermometer and triangle (TemperatureAndColorSensorNode) with the label
    const compositeThermometerNode = new Node();
    options = merge({
      node: compositeThermometerNode,
      connectorLine: false,
      thermometerFluidHighlightColor: new Color(0, 210, 0)
    }, options);

    // a Property that reflects the value of the point controller: is needed for the ThermometerNode
    const valueProperty = new DerivedProperty([pointController.positionProperty], position => {
      if (pointController.isControllingNumberLinePoint() && pointController.playAreaBounds.containsPoint(position)) {
        return pointController.numberLinePoints.get(0).valueProperty.value;
      }
      return DEFAULT_TEMPERATURE_VALUE;
    });
    const thermometerNode = new ThermometerNode(valueProperty, TemperatureSceneModel.TEMPERATURE_RANGE.min, TemperatureSceneModel.TEMPERATURE_RANGE.max, {
      bulbDiameter: 30,
      tubeWidth: 18,
      lineWidth: 2,
      fluidMainColor: pointController.color,
      fluidHighlightColor: options.thermometerFluidHighlightColor,
      backgroundFill: 'rgba( 255, 255, 255, 0.9 )',
      majorTickLength: 0,
      minorTickLength: 0
    });
    compositeThermometerNode.addChild(thermometerNode);

    // Add the textual label for this thermometer.
    // offset and maxWidth multiplier empirically determined
    const thermometerLabel = new Text(label, {
      font: new PhetFont(16),
      centerX: thermometerNode.centerX,
      top: thermometerNode.top + 4,
      maxWidth: thermometerNode.width * 0.25
    });
    compositeThermometerNode.addChild(thermometerLabel);

    // dilate the touch and mouse areas for easier grabbing
    compositeThermometerNode.touchArea = thermometerNode.bounds.dilated(TOUCH_DILATION);
    compositeThermometerNode.mouseArea = thermometerNode.bounds.dilated(MOUSE_DILATION);
    super(pointController, options);
  }
}
numberLineDistance.register('TemperaturePointControllerNode', TemperaturePointControllerNode);
export default TemperaturePointControllerNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJQb2ludENvbnRyb2xsZXJOb2RlIiwibWVyZ2UiLCJQaGV0Rm9udCIsIlRoZXJtb21ldGVyTm9kZSIsIkNvbG9yIiwiTm9kZSIsIlRleHQiLCJudW1iZXJMaW5lRGlzdGFuY2UiLCJUZW1wZXJhdHVyZVNjZW5lTW9kZWwiLCJERUZBVUxUX1RFTVBFUkFUVVJFX1ZBTFVFIiwiVE9VQ0hfRElMQVRJT04iLCJNT1VTRV9ESUxBVElPTiIsIlRlbXBlcmF0dXJlUG9pbnRDb250cm9sbGVyTm9kZSIsImNvbnN0cnVjdG9yIiwicG9pbnRDb250cm9sbGVyIiwibGFiZWwiLCJvcHRpb25zIiwiY29tcG9zaXRlVGhlcm1vbWV0ZXJOb2RlIiwibm9kZSIsImNvbm5lY3RvckxpbmUiLCJ0aGVybW9tZXRlckZsdWlkSGlnaGxpZ2h0Q29sb3IiLCJ2YWx1ZVByb3BlcnR5IiwicG9zaXRpb25Qcm9wZXJ0eSIsInBvc2l0aW9uIiwiaXNDb250cm9sbGluZ051bWJlckxpbmVQb2ludCIsInBsYXlBcmVhQm91bmRzIiwiY29udGFpbnNQb2ludCIsIm51bWJlckxpbmVQb2ludHMiLCJnZXQiLCJ2YWx1ZSIsInRoZXJtb21ldGVyTm9kZSIsIlRFTVBFUkFUVVJFX1JBTkdFIiwibWluIiwibWF4IiwiYnVsYkRpYW1ldGVyIiwidHViZVdpZHRoIiwibGluZVdpZHRoIiwiZmx1aWRNYWluQ29sb3IiLCJjb2xvciIsImZsdWlkSGlnaGxpZ2h0Q29sb3IiLCJiYWNrZ3JvdW5kRmlsbCIsIm1ham9yVGlja0xlbmd0aCIsIm1pbm9yVGlja0xlbmd0aCIsImFkZENoaWxkIiwidGhlcm1vbWV0ZXJMYWJlbCIsImZvbnQiLCJjZW50ZXJYIiwidG9wIiwibWF4V2lkdGgiLCJ3aWR0aCIsInRvdWNoQXJlYSIsImJvdW5kcyIsImRpbGF0ZWQiLCJtb3VzZUFyZWEiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlRlbXBlcmF0dXJlUG9pbnRDb250cm9sbGVyTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBIHBvaW50IGNvbnRyb2xsZXIgdGhhdCBpcyBhIHRoZXJtb21ldGVyIGZvciB1c2UgaW4gdGhlIHRlbXBlcmF0dXJlIHNjZW5lXHJcbiAqXHJcbiAqIEBhdXRob3IgU2F1cmFiaCBUb3RleVxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUG9pbnRDb250cm9sbGVyTm9kZSBmcm9tICcuLi8uLi8uLi8uLi9udW1iZXItbGluZS1jb21tb24vanMvY29tbW9uL3ZpZXcvUG9pbnRDb250cm9sbGVyTm9kZS5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IFRoZXJtb21ldGVyTm9kZSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvVGhlcm1vbWV0ZXJOb2RlLmpzJztcclxuaW1wb3J0IHsgQ29sb3IsIE5vZGUsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgbnVtYmVyTGluZURpc3RhbmNlIGZyb20gJy4uLy4uL251bWJlckxpbmVEaXN0YW5jZS5qcyc7XHJcbmltcG9ydCBUZW1wZXJhdHVyZVNjZW5lTW9kZWwgZnJvbSAnLi4vbW9kZWwvVGVtcGVyYXR1cmVTY2VuZU1vZGVsLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBERUZBVUxUX1RFTVBFUkFUVVJFX1ZBTFVFID0gMDtcclxuY29uc3QgVE9VQ0hfRElMQVRJT04gPSA1O1xyXG5jb25zdCBNT1VTRV9ESUxBVElPTiA9IDE7XHJcblxyXG5jbGFzcyBUZW1wZXJhdHVyZVBvaW50Q29udHJvbGxlck5vZGUgZXh0ZW5kcyBQb2ludENvbnRyb2xsZXJOb2RlIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtUZW1wZXJhdHVyZVBvaW50Q29udHJvbGxlcn0gcG9pbnRDb250cm9sbGVyXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGxhYmVsXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggcG9pbnRDb250cm9sbGVyLCBsYWJlbCwgb3B0aW9ucyApIHtcclxuXHJcbiAgICAvLyBjcmVhdGUgYSBub2RlIHRoYXQgY29tcG9zaXRlcyB0aGUgdGhlcm1vbWV0ZXIgYW5kIHRyaWFuZ2xlIChUZW1wZXJhdHVyZUFuZENvbG9yU2Vuc29yTm9kZSkgd2l0aCB0aGUgbGFiZWxcclxuICAgIGNvbnN0IGNvbXBvc2l0ZVRoZXJtb21ldGVyTm9kZSA9IG5ldyBOb2RlKCk7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcbiAgICAgIG5vZGU6IGNvbXBvc2l0ZVRoZXJtb21ldGVyTm9kZSxcclxuICAgICAgY29ubmVjdG9yTGluZTogZmFsc2UsXHJcbiAgICAgIHRoZXJtb21ldGVyRmx1aWRIaWdobGlnaHRDb2xvcjogbmV3IENvbG9yKCAwLCAyMTAsIDAgKVxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIGEgUHJvcGVydHkgdGhhdCByZWZsZWN0cyB0aGUgdmFsdWUgb2YgdGhlIHBvaW50IGNvbnRyb2xsZXI6IGlzIG5lZWRlZCBmb3IgdGhlIFRoZXJtb21ldGVyTm9kZVxyXG4gICAgY29uc3QgdmFsdWVQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgcG9pbnRDb250cm9sbGVyLnBvc2l0aW9uUHJvcGVydHkgXSwgcG9zaXRpb24gPT4ge1xyXG4gICAgICBpZiAoIHBvaW50Q29udHJvbGxlci5pc0NvbnRyb2xsaW5nTnVtYmVyTGluZVBvaW50KCkgJiYgcG9pbnRDb250cm9sbGVyLnBsYXlBcmVhQm91bmRzLmNvbnRhaW5zUG9pbnQoIHBvc2l0aW9uICkgKSB7XHJcbiAgICAgICAgcmV0dXJuIHBvaW50Q29udHJvbGxlci5udW1iZXJMaW5lUG9pbnRzLmdldCggMCApLnZhbHVlUHJvcGVydHkudmFsdWU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIERFRkFVTFRfVEVNUEVSQVRVUkVfVkFMVUU7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgdGhlcm1vbWV0ZXJOb2RlID0gbmV3IFRoZXJtb21ldGVyTm9kZSggdmFsdWVQcm9wZXJ0eSwgVGVtcGVyYXR1cmVTY2VuZU1vZGVsLlRFTVBFUkFUVVJFX1JBTkdFLm1pbiwgVGVtcGVyYXR1cmVTY2VuZU1vZGVsLlRFTVBFUkFUVVJFX1JBTkdFLm1heCwge1xyXG4gICAgICBidWxiRGlhbWV0ZXI6IDMwLFxyXG4gICAgICB0dWJlV2lkdGg6IDE4LFxyXG4gICAgICBsaW5lV2lkdGg6IDIsXHJcbiAgICAgIGZsdWlkTWFpbkNvbG9yOiBwb2ludENvbnRyb2xsZXIuY29sb3IsXHJcbiAgICAgIGZsdWlkSGlnaGxpZ2h0Q29sb3I6IG9wdGlvbnMudGhlcm1vbWV0ZXJGbHVpZEhpZ2hsaWdodENvbG9yLFxyXG4gICAgICBiYWNrZ3JvdW5kRmlsbDogJ3JnYmEoIDI1NSwgMjU1LCAyNTUsIDAuOSApJyxcclxuICAgICAgbWFqb3JUaWNrTGVuZ3RoOiAwLFxyXG4gICAgICBtaW5vclRpY2tMZW5ndGg6IDBcclxuICAgIH0gKTtcclxuICAgIGNvbXBvc2l0ZVRoZXJtb21ldGVyTm9kZS5hZGRDaGlsZCggdGhlcm1vbWV0ZXJOb2RlICk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSB0ZXh0dWFsIGxhYmVsIGZvciB0aGlzIHRoZXJtb21ldGVyLlxyXG4gICAgLy8gb2Zmc2V0IGFuZCBtYXhXaWR0aCBtdWx0aXBsaWVyIGVtcGlyaWNhbGx5IGRldGVybWluZWRcclxuICAgIGNvbnN0IHRoZXJtb21ldGVyTGFiZWwgPSBuZXcgVGV4dCggbGFiZWwsIHtcclxuICAgICAgZm9udDogbmV3IFBoZXRGb250KCAxNiApLFxyXG4gICAgICBjZW50ZXJYOiB0aGVybW9tZXRlck5vZGUuY2VudGVyWCxcclxuICAgICAgdG9wOiB0aGVybW9tZXRlck5vZGUudG9wICsgNCxcclxuICAgICAgbWF4V2lkdGg6IHRoZXJtb21ldGVyTm9kZS53aWR0aCAqIDAuMjVcclxuICAgIH0gKTtcclxuICAgIGNvbXBvc2l0ZVRoZXJtb21ldGVyTm9kZS5hZGRDaGlsZCggdGhlcm1vbWV0ZXJMYWJlbCApO1xyXG5cclxuICAgIC8vIGRpbGF0ZSB0aGUgdG91Y2ggYW5kIG1vdXNlIGFyZWFzIGZvciBlYXNpZXIgZ3JhYmJpbmdcclxuICAgIGNvbXBvc2l0ZVRoZXJtb21ldGVyTm9kZS50b3VjaEFyZWEgPSB0aGVybW9tZXRlck5vZGUuYm91bmRzLmRpbGF0ZWQoIFRPVUNIX0RJTEFUSU9OICk7XHJcbiAgICBjb21wb3NpdGVUaGVybW9tZXRlck5vZGUubW91c2VBcmVhID0gdGhlcm1vbWV0ZXJOb2RlLmJvdW5kcy5kaWxhdGVkKCBNT1VTRV9ESUxBVElPTiApO1xyXG5cclxuICAgIHN1cGVyKCBwb2ludENvbnRyb2xsZXIsIG9wdGlvbnMgKTtcclxuICB9XHJcbn1cclxuXHJcbm51bWJlckxpbmVEaXN0YW5jZS5yZWdpc3RlciggJ1RlbXBlcmF0dXJlUG9pbnRDb250cm9sbGVyTm9kZScsIFRlbXBlcmF0dXJlUG9pbnRDb250cm9sbGVyTm9kZSApO1xyXG5leHBvcnQgZGVmYXVsdCBUZW1wZXJhdHVyZVBvaW50Q29udHJvbGxlck5vZGU7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLG1CQUFtQixNQUFNLHNFQUFzRTtBQUN0RyxPQUFPQyxL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