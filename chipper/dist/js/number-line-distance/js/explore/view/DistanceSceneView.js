// Copyright 2020-2022, University of Colorado Boulder

/**
 * 'Distance' scene view for the explore screen
 *
 * @author Saurabh Totey
 */

import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Image, Node, Text } from '../../../../scenery/js/imports.js';
import fireHydrant_png from '../../../images/fireHydrant_png.js';
import sidewalk_png from '../../../images/sidewalk_png.js';
import house_png from '../../../mipmaps/house_png.js';
import person_png from '../../../mipmaps/person_png.js';
import numberLineDistance from '../../numberLineDistance.js';
import NumberLineDistanceStrings from '../../NumberLineDistanceStrings.js';
import DistancePointControllerNode from './DistancePointControllerNode.js';
import NLDSceneView from './NLDSceneView.js';
const eastString = NumberLineDistanceStrings.symbol.east;
const westString = NumberLineDistanceStrings.symbol.west;
const houseString = NumberLineDistanceStrings.house;
const personString = NumberLineDistanceStrings.person;
const distanceSceneAbsoluteDistanceTemplateString = NumberLineDistanceStrings.distanceSceneAbsoluteDistanceTemplate;
const distanceSceneDirectedPositiveDistanceTemplateString = NumberLineDistanceStrings.distanceSceneDirectedPositiveDistanceTemplate;
const distanceSceneDirectedNegativeDistanceTemplateString = NumberLineDistanceStrings.distanceSceneDirectedNegativeDistanceTemplate;
const metersSymbol = NumberLineDistanceStrings.symbol.meters;
const meterString = NumberLineDistanceStrings.meter;
const metersString = NumberLineDistanceStrings.meters;
const DIRECTION_INDICATOR_FONT = new PhetFont(25);
const DIRECTION_INDICATOR_MAX_WIDTH = 50;
class DistanceSceneView extends NLDSceneView {
  /**
   * @param {DistanceSceneModel} model
   */
  constructor(model) {
    // Create the representations for the person and the house in the area that they can be swapped.
    // scales were empirically determined
    const houseRepresentation = new Image(house_png, {
      scale: 0.15
    });
    const personRepresentation = new Image(person_png, {
      scale: 0.1
    });
    const smallestWidth = Math.min(houseRepresentation.getImageWidth(), personRepresentation.getImageWidth());
    houseRepresentation.maxWidth = smallestWidth;
    personRepresentation.maxWidth = smallestWidth;
    super(model, {
      pointControllerRepresentationOne: houseRepresentation,
      pointControllerRepresentationTwo: personRepresentation,
      distanceDescriptionStrings: {
        absoluteDistanceDescriptionTemplate: distanceSceneAbsoluteDistanceTemplateString,
        directedPositiveDistanceDescriptionTemplate: distanceSceneDirectedPositiveDistanceTemplateString,
        directedNegativeDistanceDescriptionTemplate: distanceSceneDirectedNegativeDistanceTemplateString,
        singularUnits: meterString,
        pluralUnits: metersString,
        getPrimaryPointControllerLabel: isPrimaryNodeSwapped => isPrimaryNodeSwapped ? personString : houseString,
        getSecondaryPointControllerLabel: isPrimaryNodeSwapped => isPrimaryNodeSwapped ? houseString : personString
      },
      distanceShadedNumberLineNodeOptions: {
        unitsString: metersSymbol
      }
    });

    // image that represents the plane where the person and the house lie
    const sidewalkImage = new Image(sidewalk_png);
    sidewalkImage.scale(model.sidewalkBounds.width / sidewalkImage.width, model.sidewalkBounds.height / sidewalkImage.height);
    sidewalkImage.center = model.sidewalkBounds.center;
    this.addChild(sidewalkImage);

    // fire hydrant that sits at the 0 location of the number line
    // offset and scale empirically determined
    this.addChild(new Image(fireHydrant_png, {
      centerX: model.sidewalkBounds.center.x,
      bottom: model.sidewalkBounds.center.y - 5,
      scale: 0.15
    }));

    // Point controllers that are in different parent nodes so that the person is always on top of the house in terms of
    // layering. The mouse area dilation for the personPointControllerImage is for #38.
    // the image scales and dilations are empirically determined
    const personPointControllerImage = new Image(person_png, {
      scale: 0.22
    });
    personPointControllerImage.mouseArea = personPointControllerImage.localBounds.dilated(5 / personPointControllerImage.getScaleVector().x);
    const housePointControllerImage = new Image(house_png, {
      scale: 0.2
    });
    const pointControllersLayer = new Node();
    pointControllersLayer.addChild(new Node({
      children: [new DistancePointControllerNode(model.pointControllerOne, housePointControllerImage)]
    }));
    pointControllersLayer.addChild(new Node({
      children: [new DistancePointControllerNode(model.pointControllerTwo, personPointControllerImage)]
    }));
    this.addChild(pointControllersLayer);

    // symbols at edges of number line denoting east and west
    const textOffsetFromNumberLine = this.numberLineNode.options.displayedRangeInset + this.numberLineNode.options.arrowSize + 15; // empirically determined
    const range = model.numberLine.displayedRangeProperty.value;
    const eastSymbolText = new Text(eastString, {
      font: DIRECTION_INDICATOR_FONT,
      center: model.numberLine.valueToModelPosition(range.max).plusXY(textOffsetFromNumberLine, 0),
      maxWidth: DIRECTION_INDICATOR_MAX_WIDTH
    });
    const westSymbolText = new Text(westString, {
      font: DIRECTION_INDICATOR_FONT,
      center: model.numberLine.valueToModelPosition(range.min).plusXY(-textOffsetFromNumberLine, 0),
      maxWidth: DIRECTION_INDICATOR_MAX_WIDTH
    });
    this.addChild(eastSymbolText);
    this.addChild(westSymbolText);
    eastSymbolText.moveToBack();
    westSymbolText.moveToBack();
  }
}
numberLineDistance.register('DistanceSceneView', DistanceSceneView);
export default DistanceSceneView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQaGV0Rm9udCIsIkltYWdlIiwiTm9kZSIsIlRleHQiLCJmaXJlSHlkcmFudF9wbmciLCJzaWRld2Fsa19wbmciLCJob3VzZV9wbmciLCJwZXJzb25fcG5nIiwibnVtYmVyTGluZURpc3RhbmNlIiwiTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncyIsIkRpc3RhbmNlUG9pbnRDb250cm9sbGVyTm9kZSIsIk5MRFNjZW5lVmlldyIsImVhc3RTdHJpbmciLCJzeW1ib2wiLCJlYXN0Iiwid2VzdFN0cmluZyIsIndlc3QiLCJob3VzZVN0cmluZyIsImhvdXNlIiwicGVyc29uU3RyaW5nIiwicGVyc29uIiwiZGlzdGFuY2VTY2VuZUFic29sdXRlRGlzdGFuY2VUZW1wbGF0ZVN0cmluZyIsImRpc3RhbmNlU2NlbmVBYnNvbHV0ZURpc3RhbmNlVGVtcGxhdGUiLCJkaXN0YW5jZVNjZW5lRGlyZWN0ZWRQb3NpdGl2ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmciLCJkaXN0YW5jZVNjZW5lRGlyZWN0ZWRQb3NpdGl2ZURpc3RhbmNlVGVtcGxhdGUiLCJkaXN0YW5jZVNjZW5lRGlyZWN0ZWROZWdhdGl2ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmciLCJkaXN0YW5jZVNjZW5lRGlyZWN0ZWROZWdhdGl2ZURpc3RhbmNlVGVtcGxhdGUiLCJtZXRlcnNTeW1ib2wiLCJtZXRlcnMiLCJtZXRlclN0cmluZyIsIm1ldGVyIiwibWV0ZXJzU3RyaW5nIiwiRElSRUNUSU9OX0lORElDQVRPUl9GT05UIiwiRElSRUNUSU9OX0lORElDQVRPUl9NQVhfV0lEVEgiLCJEaXN0YW5jZVNjZW5lVmlldyIsImNvbnN0cnVjdG9yIiwibW9kZWwiLCJob3VzZVJlcHJlc2VudGF0aW9uIiwic2NhbGUiLCJwZXJzb25SZXByZXNlbnRhdGlvbiIsInNtYWxsZXN0V2lkdGgiLCJNYXRoIiwibWluIiwiZ2V0SW1hZ2VXaWR0aCIsIm1heFdpZHRoIiwicG9pbnRDb250cm9sbGVyUmVwcmVzZW50YXRpb25PbmUiLCJwb2ludENvbnRyb2xsZXJSZXByZXNlbnRhdGlvblR3byIsImRpc3RhbmNlRGVzY3JpcHRpb25TdHJpbmdzIiwiYWJzb2x1dGVEaXN0YW5jZURlc2NyaXB0aW9uVGVtcGxhdGUiLCJkaXJlY3RlZFBvc2l0aXZlRGlzdGFuY2VEZXNjcmlwdGlvblRlbXBsYXRlIiwiZGlyZWN0ZWROZWdhdGl2ZURpc3RhbmNlRGVzY3JpcHRpb25UZW1wbGF0ZSIsInNpbmd1bGFyVW5pdHMiLCJwbHVyYWxVbml0cyIsImdldFByaW1hcnlQb2ludENvbnRyb2xsZXJMYWJlbCIsImlzUHJpbWFyeU5vZGVTd2FwcGVkIiwiZ2V0U2Vjb25kYXJ5UG9pbnRDb250cm9sbGVyTGFiZWwiLCJkaXN0YW5jZVNoYWRlZE51bWJlckxpbmVOb2RlT3B0aW9ucyIsInVuaXRzU3RyaW5nIiwic2lkZXdhbGtJbWFnZSIsInNpZGV3YWxrQm91bmRzIiwid2lkdGgiLCJoZWlnaHQiLCJjZW50ZXIiLCJhZGRDaGlsZCIsImNlbnRlclgiLCJ4IiwiYm90dG9tIiwieSIsInBlcnNvblBvaW50Q29udHJvbGxlckltYWdlIiwibW91c2VBcmVhIiwibG9jYWxCb3VuZHMiLCJkaWxhdGVkIiwiZ2V0U2NhbGVWZWN0b3IiLCJob3VzZVBvaW50Q29udHJvbGxlckltYWdlIiwicG9pbnRDb250cm9sbGVyc0xheWVyIiwiY2hpbGRyZW4iLCJwb2ludENvbnRyb2xsZXJPbmUiLCJwb2ludENvbnRyb2xsZXJUd28iLCJ0ZXh0T2Zmc2V0RnJvbU51bWJlckxpbmUiLCJudW1iZXJMaW5lTm9kZSIsIm9wdGlvbnMiLCJkaXNwbGF5ZWRSYW5nZUluc2V0IiwiYXJyb3dTaXplIiwicmFuZ2UiLCJudW1iZXJMaW5lIiwiZGlzcGxheWVkUmFuZ2VQcm9wZXJ0eSIsInZhbHVlIiwiZWFzdFN5bWJvbFRleHQiLCJmb250IiwidmFsdWVUb01vZGVsUG9zaXRpb24iLCJtYXgiLCJwbHVzWFkiLCJ3ZXN0U3ltYm9sVGV4dCIsIm1vdmVUb0JhY2siLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkRpc3RhbmNlU2NlbmVWaWV3LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIwLTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqICdEaXN0YW5jZScgc2NlbmUgdmlldyBmb3IgdGhlIGV4cGxvcmUgc2NyZWVuXHJcbiAqXHJcbiAqIEBhdXRob3IgU2F1cmFiaCBUb3RleVxyXG4gKi9cclxuXHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBJbWFnZSwgTm9kZSwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBmaXJlSHlkcmFudF9wbmcgZnJvbSAnLi4vLi4vLi4vaW1hZ2VzL2ZpcmVIeWRyYW50X3BuZy5qcyc7XHJcbmltcG9ydCBzaWRld2Fsa19wbmcgZnJvbSAnLi4vLi4vLi4vaW1hZ2VzL3NpZGV3YWxrX3BuZy5qcyc7XHJcbmltcG9ydCBob3VzZV9wbmcgZnJvbSAnLi4vLi4vLi4vbWlwbWFwcy9ob3VzZV9wbmcuanMnO1xyXG5pbXBvcnQgcGVyc29uX3BuZyBmcm9tICcuLi8uLi8uLi9taXBtYXBzL3BlcnNvbl9wbmcuanMnO1xyXG5pbXBvcnQgbnVtYmVyTGluZURpc3RhbmNlIGZyb20gJy4uLy4uL251bWJlckxpbmVEaXN0YW5jZS5qcyc7XHJcbmltcG9ydCBOdW1iZXJMaW5lRGlzdGFuY2VTdHJpbmdzIGZyb20gJy4uLy4uL051bWJlckxpbmVEaXN0YW5jZVN0cmluZ3MuanMnO1xyXG5pbXBvcnQgRGlzdGFuY2VQb2ludENvbnRyb2xsZXJOb2RlIGZyb20gJy4vRGlzdGFuY2VQb2ludENvbnRyb2xsZXJOb2RlLmpzJztcclxuaW1wb3J0IE5MRFNjZW5lVmlldyBmcm9tICcuL05MRFNjZW5lVmlldy5qcyc7XHJcblxyXG5jb25zdCBlYXN0U3RyaW5nID0gTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncy5zeW1ib2wuZWFzdDtcclxuY29uc3Qgd2VzdFN0cmluZyA9IE51bWJlckxpbmVEaXN0YW5jZVN0cmluZ3Muc3ltYm9sLndlc3Q7XHJcbmNvbnN0IGhvdXNlU3RyaW5nID0gTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncy5ob3VzZTtcclxuY29uc3QgcGVyc29uU3RyaW5nID0gTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncy5wZXJzb247XHJcbmNvbnN0IGRpc3RhbmNlU2NlbmVBYnNvbHV0ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmcgPSBOdW1iZXJMaW5lRGlzdGFuY2VTdHJpbmdzLmRpc3RhbmNlU2NlbmVBYnNvbHV0ZURpc3RhbmNlVGVtcGxhdGU7XHJcbmNvbnN0IGRpc3RhbmNlU2NlbmVEaXJlY3RlZFBvc2l0aXZlRGlzdGFuY2VUZW1wbGF0ZVN0cmluZyA9IE51bWJlckxpbmVEaXN0YW5jZVN0cmluZ3MuZGlzdGFuY2VTY2VuZURpcmVjdGVkUG9zaXRpdmVEaXN0YW5jZVRlbXBsYXRlO1xyXG5jb25zdCBkaXN0YW5jZVNjZW5lRGlyZWN0ZWROZWdhdGl2ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmcgPSBOdW1iZXJMaW5lRGlzdGFuY2VTdHJpbmdzLmRpc3RhbmNlU2NlbmVEaXJlY3RlZE5lZ2F0aXZlRGlzdGFuY2VUZW1wbGF0ZTtcclxuY29uc3QgbWV0ZXJzU3ltYm9sID0gTnVtYmVyTGluZURpc3RhbmNlU3RyaW5ncy5zeW1ib2wubWV0ZXJzO1xyXG5jb25zdCBtZXRlclN0cmluZyA9IE51bWJlckxpbmVEaXN0YW5jZVN0cmluZ3MubWV0ZXI7XHJcbmNvbnN0IG1ldGVyc1N0cmluZyA9IE51bWJlckxpbmVEaXN0YW5jZVN0cmluZ3MubWV0ZXJzO1xyXG5cclxuY29uc3QgRElSRUNUSU9OX0lORElDQVRPUl9GT05UID0gbmV3IFBoZXRGb250KCAyNSApO1xyXG5jb25zdCBESVJFQ1RJT05fSU5ESUNBVE9SX01BWF9XSURUSCA9IDUwO1xyXG5cclxuY2xhc3MgRGlzdGFuY2VTY2VuZVZpZXcgZXh0ZW5kcyBOTERTY2VuZVZpZXcge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge0Rpc3RhbmNlU2NlbmVNb2RlbH0gbW9kZWxcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbW9kZWwgKSB7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRoZSByZXByZXNlbnRhdGlvbnMgZm9yIHRoZSBwZXJzb24gYW5kIHRoZSBob3VzZSBpbiB0aGUgYXJlYSB0aGF0IHRoZXkgY2FuIGJlIHN3YXBwZWQuXHJcbiAgICAvLyBzY2FsZXMgd2VyZSBlbXBpcmljYWxseSBkZXRlcm1pbmVkXHJcbiAgICBjb25zdCBob3VzZVJlcHJlc2VudGF0aW9uID0gbmV3IEltYWdlKCBob3VzZV9wbmcsIHsgc2NhbGU6IDAuMTUgfSApO1xyXG4gICAgY29uc3QgcGVyc29uUmVwcmVzZW50YXRpb24gPSBuZXcgSW1hZ2UoIHBlcnNvbl9wbmcsIHsgc2NhbGU6IDAuMSB9ICk7XHJcbiAgICBjb25zdCBzbWFsbGVzdFdpZHRoID0gTWF0aC5taW4oIGhvdXNlUmVwcmVzZW50YXRpb24uZ2V0SW1hZ2VXaWR0aCgpLCBwZXJzb25SZXByZXNlbnRhdGlvbi5nZXRJbWFnZVdpZHRoKCkgKTtcclxuICAgIGhvdXNlUmVwcmVzZW50YXRpb24ubWF4V2lkdGggPSBzbWFsbGVzdFdpZHRoO1xyXG4gICAgcGVyc29uUmVwcmVzZW50YXRpb24ubWF4V2lkdGggPSBzbWFsbGVzdFdpZHRoO1xyXG5cclxuICAgIHN1cGVyKFxyXG4gICAgICBtb2RlbCxcclxuICAgICAge1xyXG4gICAgICAgIHBvaW50Q29udHJvbGxlclJlcHJlc2VudGF0aW9uT25lOiBob3VzZVJlcHJlc2VudGF0aW9uLFxyXG4gICAgICAgIHBvaW50Q29udHJvbGxlclJlcHJlc2VudGF0aW9uVHdvOiBwZXJzb25SZXByZXNlbnRhdGlvbixcclxuICAgICAgICBkaXN0YW5jZURlc2NyaXB0aW9uU3RyaW5nczoge1xyXG4gICAgICAgICAgYWJzb2x1dGVEaXN0YW5jZURlc2NyaXB0aW9uVGVtcGxhdGU6IGRpc3RhbmNlU2NlbmVBYnNvbHV0ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmcsXHJcbiAgICAgICAgICBkaXJlY3RlZFBvc2l0aXZlRGlzdGFuY2VEZXNjcmlwdGlvblRlbXBsYXRlOiBkaXN0YW5jZVNjZW5lRGlyZWN0ZWRQb3NpdGl2ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmcsXHJcbiAgICAgICAgICBkaXJlY3RlZE5lZ2F0aXZlRGlzdGFuY2VEZXNjcmlwdGlvblRlbXBsYXRlOiBkaXN0YW5jZVNjZW5lRGlyZWN0ZWROZWdhdGl2ZURpc3RhbmNlVGVtcGxhdGVTdHJpbmcsXHJcbiAgICAgICAgICBzaW5ndWxhclVuaXRzOiBtZXRlclN0cmluZyxcclxuICAgICAgICAgIHBsdXJhbFVuaXRzOiBtZXRlcnNTdHJpbmcsXHJcbiAgICAgICAgICBnZXRQcmltYXJ5UG9pbnRDb250cm9sbGVyTGFiZWw6IGlzUHJpbWFyeU5vZGVTd2FwcGVkID0+IGlzUHJpbWFyeU5vZGVTd2FwcGVkID8gcGVyc29uU3RyaW5nIDogaG91c2VTdHJpbmcsXHJcbiAgICAgICAgICBnZXRTZWNvbmRhcnlQb2ludENvbnRyb2xsZXJMYWJlbDogaXNQcmltYXJ5Tm9kZVN3YXBwZWQgPT4gaXNQcmltYXJ5Tm9kZVN3YXBwZWQgPyBob3VzZVN0cmluZyA6IHBlcnNvblN0cmluZ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGlzdGFuY2VTaGFkZWROdW1iZXJMaW5lTm9kZU9wdGlvbnM6IHsgdW5pdHNTdHJpbmc6IG1ldGVyc1N5bWJvbCB9XHJcbiAgICAgIH1cclxuICAgICk7XHJcblxyXG4gICAgLy8gaW1hZ2UgdGhhdCByZXByZXNlbnRzIHRoZSBwbGFuZSB3aGVyZSB0aGUgcGVyc29uIGFuZCB0aGUgaG91c2UgbGllXHJcbiAgICBjb25zdCBzaWRld2Fsa0ltYWdlID0gbmV3IEltYWdlKCBzaWRld2Fsa19wbmcgKTtcclxuICAgIHNpZGV3YWxrSW1hZ2Uuc2NhbGUoIG1vZGVsLnNpZGV3YWxrQm91bmRzLndpZHRoIC8gc2lkZXdhbGtJbWFnZS53aWR0aCwgbW9kZWwuc2lkZXdhbGtCb3VuZHMuaGVpZ2h0IC8gc2lkZXdhbGtJbWFnZS5oZWlnaHQgKTtcclxuICAgIHNpZGV3YWxrSW1hZ2UuY2VudGVyID0gbW9kZWwuc2lkZXdhbGtCb3VuZHMuY2VudGVyO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggc2lkZXdhbGtJbWFnZSApO1xyXG5cclxuICAgIC8vIGZpcmUgaHlkcmFudCB0aGF0IHNpdHMgYXQgdGhlIDAgbG9jYXRpb24gb2YgdGhlIG51bWJlciBsaW5lXHJcbiAgICAvLyBvZmZzZXQgYW5kIHNjYWxlIGVtcGlyaWNhbGx5IGRldGVybWluZWRcclxuICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBJbWFnZShcclxuICAgICAgZmlyZUh5ZHJhbnRfcG5nLFxyXG4gICAgICB7XHJcbiAgICAgICAgY2VudGVyWDogbW9kZWwuc2lkZXdhbGtCb3VuZHMuY2VudGVyLngsXHJcbiAgICAgICAgYm90dG9tOiBtb2RlbC5zaWRld2Fsa0JvdW5kcy5jZW50ZXIueSAtIDUsXHJcbiAgICAgICAgc2NhbGU6IDAuMTVcclxuICAgICAgfVxyXG4gICAgKSApO1xyXG5cclxuICAgIC8vIFBvaW50IGNvbnRyb2xsZXJzIHRoYXQgYXJlIGluIGRpZmZlcmVudCBwYXJlbnQgbm9kZXMgc28gdGhhdCB0aGUgcGVyc29uIGlzIGFsd2F5cyBvbiB0b3Agb2YgdGhlIGhvdXNlIGluIHRlcm1zIG9mXHJcbiAgICAvLyBsYXllcmluZy4gVGhlIG1vdXNlIGFyZWEgZGlsYXRpb24gZm9yIHRoZSBwZXJzb25Qb2ludENvbnRyb2xsZXJJbWFnZSBpcyBmb3IgIzM4LlxyXG4gICAgLy8gdGhlIGltYWdlIHNjYWxlcyBhbmQgZGlsYXRpb25zIGFyZSBlbXBpcmljYWxseSBkZXRlcm1pbmVkXHJcbiAgICBjb25zdCBwZXJzb25Qb2ludENvbnRyb2xsZXJJbWFnZSA9IG5ldyBJbWFnZSggcGVyc29uX3BuZywgeyBzY2FsZTogMC4yMiB9ICk7XHJcbiAgICBwZXJzb25Qb2ludENvbnRyb2xsZXJJbWFnZS5tb3VzZUFyZWEgPSBwZXJzb25Qb2ludENvbnRyb2xsZXJJbWFnZS5sb2NhbEJvdW5kcy5kaWxhdGVkKFxyXG4gICAgICA1IC8gcGVyc29uUG9pbnRDb250cm9sbGVySW1hZ2UuZ2V0U2NhbGVWZWN0b3IoKS54XHJcbiAgICApO1xyXG4gICAgY29uc3QgaG91c2VQb2ludENvbnRyb2xsZXJJbWFnZSA9IG5ldyBJbWFnZSggaG91c2VfcG5nLCB7IHNjYWxlOiAwLjIgfSApO1xyXG4gICAgY29uc3QgcG9pbnRDb250cm9sbGVyc0xheWVyID0gbmV3IE5vZGUoKTtcclxuICAgIHBvaW50Q29udHJvbGxlcnNMYXllci5hZGRDaGlsZCggbmV3IE5vZGUoIHtcclxuICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICBuZXcgRGlzdGFuY2VQb2ludENvbnRyb2xsZXJOb2RlKFxyXG4gICAgICAgICAgbW9kZWwucG9pbnRDb250cm9sbGVyT25lLFxyXG4gICAgICAgICAgaG91c2VQb2ludENvbnRyb2xsZXJJbWFnZVxyXG4gICAgICAgIClcclxuICAgICAgXVxyXG4gICAgfSApICk7XHJcbiAgICBwb2ludENvbnRyb2xsZXJzTGF5ZXIuYWRkQ2hpbGQoIG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgbmV3IERpc3RhbmNlUG9pbnRDb250cm9sbGVyTm9kZShcclxuICAgICAgICAgIG1vZGVsLnBvaW50Q29udHJvbGxlclR3byxcclxuICAgICAgICAgIHBlcnNvblBvaW50Q29udHJvbGxlckltYWdlXHJcbiAgICAgICAgKVxyXG4gICAgICBdXHJcbiAgICB9ICkgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHBvaW50Q29udHJvbGxlcnNMYXllciApO1xyXG5cclxuICAgIC8vIHN5bWJvbHMgYXQgZWRnZXMgb2YgbnVtYmVyIGxpbmUgZGVub3RpbmcgZWFzdCBhbmQgd2VzdFxyXG4gICAgY29uc3QgdGV4dE9mZnNldEZyb21OdW1iZXJMaW5lID1cclxuICAgICAgdGhpcy5udW1iZXJMaW5lTm9kZS5vcHRpb25zLmRpc3BsYXllZFJhbmdlSW5zZXQgKyB0aGlzLm51bWJlckxpbmVOb2RlLm9wdGlvbnMuYXJyb3dTaXplICsgMTU7IC8vIGVtcGlyaWNhbGx5IGRldGVybWluZWRcclxuICAgIGNvbnN0IHJhbmdlID0gbW9kZWwubnVtYmVyTGluZS5kaXNwbGF5ZWRSYW5nZVByb3BlcnR5LnZhbHVlO1xyXG4gICAgY29uc3QgZWFzdFN5bWJvbFRleHQgPSBuZXcgVGV4dCggZWFzdFN0cmluZywge1xyXG4gICAgICBmb250OiBESVJFQ1RJT05fSU5ESUNBVE9SX0ZPTlQsXHJcbiAgICAgIGNlbnRlcjogbW9kZWwubnVtYmVyTGluZS52YWx1ZVRvTW9kZWxQb3NpdGlvbiggcmFuZ2UubWF4ICkucGx1c1hZKCB0ZXh0T2Zmc2V0RnJvbU51bWJlckxpbmUsIDAgKSxcclxuICAgICAgbWF4V2lkdGg6IERJUkVDVElPTl9JTkRJQ0FUT1JfTUFYX1dJRFRIXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCB3ZXN0U3ltYm9sVGV4dCA9IG5ldyBUZXh0KCB3ZXN0U3RyaW5nLCB7XHJcbiAgICAgIGZvbnQ6IERJUkVDVElPTl9JTkRJQ0FUT1JfRk9OVCxcclxuICAgICAgY2VudGVyOiBtb2RlbC5udW1iZXJMaW5lLnZhbHVlVG9Nb2RlbFBvc2l0aW9uKCByYW5nZS5taW4gKS5wbHVzWFkoIC10ZXh0T2Zmc2V0RnJvbU51bWJlckxpbmUsIDAgKSxcclxuICAgICAgbWF4V2lkdGg6IERJUkVDVElPTl9JTkRJQ0FUT1JfTUFYX1dJRFRIXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBlYXN0U3ltYm9sVGV4dCApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggd2VzdFN5bWJvbFRleHQgKTtcclxuICAgIGVhc3RTeW1ib2xUZXh0Lm1vdmVUb0JhY2soKTtcclxuICAgIHdlc3RTeW1ib2xUZXh0Lm1vdmVUb0JhY2soKTtcclxuICB9XHJcblxyXG59XHJcblxyXG5udW1iZXJMaW5lRGlzdGFuY2UucmVnaXN0ZXIoICdEaXN0YW5jZVNjZW5lVmlldycsIERpc3RhbmNlU2NlbmVWaWV3ICk7XHJcbmV4cG9ydCBkZWZhdWx0IERpc3RhbmNlU2NlbmVWaWV3O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxLQUFLLEVBQUVDLElBQUksRUFBRUMsSUFBSSxRQUFRLG1DQUFtQztBQUNyRSxPQUFPQyxlQUFlLE1BQU0sb0NBQW9DO0FBQ2hFLE9BQU9DLFlBQVksTUFBTSxpQ0FBaUM7QUFDMUQsT0FBT0MsU0FBUyxNQUFNLCtCQUErQjtBQUNyRCxPQUFPQyxVQUFVLE1BQU0sZ0NBQWdDO0FBQ3ZELE9BQU9DLGtCQUFrQixNQUFNLDZCQUE2QjtBQUM1RCxPQUFPQyx5QkFBeUIsTUFBTSxvQ0FBb0M7QUFDMUUsT0FBT0MsMkJBQTJCLE1BQU0sa0NBQWtDO0FBQzFFLE9BQU9DLFlBQVksTUFBTSxtQkFBbUI7QUFFNUMsTUFBTUMsVUFBVSxHQUFHSCx5QkFBeUIsQ0FBQ0ksTUFBTSxDQUFDQyxJQUFJO0FBQ3hELE1BQU1DLFVBQVUsR0FBR04seUJBQXlCLENBQUNJLE1BQU0sQ0FBQ0csSUFBSTtBQUN4RCxNQUFNQyxXQUFXLEdBQUdSLHlCQUF5QixDQUFDUyxLQUFLO0FBQ25ELE1BQU1DLFlBQVksR0FBR1YseUJBQXlCLENBQUNXLE1BQU07QUFDckQsTUFBTUMsMkNBQTJDLEdBQUdaLHlCQUF5QixDQUFDYSxxQ0FBcUM7QUFDbkgsTUFBTUMsbURBQW1ELEdBQUdkLHlCQUF5QixDQUFDZSw2Q0FBNkM7QUFDbkksTUFBTUMsbURBQW1ELEdBQUdoQix5QkFBeUIsQ0FBQ2lCLDZDQUE2QztBQUNuSSxNQUFNQyxZQUFZLEdBQUdsQix5QkFBeUIsQ0FBQ0ksTUFBTSxDQUFDZSxNQUFNO0FBQzVELE1BQU1DLFdBQVcs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