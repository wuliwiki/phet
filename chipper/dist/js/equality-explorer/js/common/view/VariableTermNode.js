// Copyright 2018-2022, University of Colorado Boulder

/**
 * Displays a variable term.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import MathSymbolFont from '../../../../scenery-phet/js/MathSymbolFont.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { HBox, Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import equalityExplorer from '../../equalityExplorer.js';
import EqualityExplorerColors from '../EqualityExplorerColors.js';
import EqualityExplorerConstants from '../EqualityExplorerConstants.js';
import ReducedFractionNode from './ReducedFractionNode.js';
import TermNode from './TermNode.js';
import optionize, { combineOptions } from '../../../../phet-core/js/optionize.js';
export default class VariableTermNode extends TermNode {
  constructor(termCreator, term, providedOptions) {
    const options = optionize()({
      // empty optionize call because we access options.interactiveTermNodeOptions below
    }, providedOptions);

    // contentNode must be disposed!
    const contentNode = VariableTermNode.createInteractiveTermNode(term.coefficient, term.variable.symbolProperty, combineOptions({}, options.interactiveTermNodeOptions, {
      diameter: term.diameter
    }));
    const shadowNode = new Rectangle(0, 0, term.diameter, term.diameter, {
      fill: 'black',
      opacity: EqualityExplorerConstants.SHADOW_OPACITY
    });
    super(termCreator, term, contentNode, shadowNode, options);
    this.disposeVariableTermNode = () => {
      contentNode.dispose();
    };
  }
  dispose() {
    this.disposeVariableTermNode();
    super.dispose();
  }

  /**
   * Creates the representation of a term that the user interacts with,
   */
  static createInteractiveTermNode(coefficient, symbolProperty, providedOptions) {
    return new InteractiveTermNode(coefficient, symbolProperty, providedOptions); //TODO https://github.com/phetsims/equality-explorer/issues/200 dynamic
  }

  /**
   * Creates the representation of a term that is shown in equations.
   */
  static createEquationTermNode(coefficient, symbolProperty, providedOptions) {
    return new EquationTermNode(coefficient, symbolProperty, providedOptions); //TODO https://github.com/phetsims/equality-explorer/issues/200 dynamic
  }
}

/**
 * The representation of a term that is shown in equations, a coefficient and variable.
 */
class EquationTermNode extends HBox {
  constructor(coefficient, symbolProperty, providedOptions) {
    assert && assert(coefficient.isReduced(), `coefficient must be reduced: ${coefficient}`);
    const options = optionize()({
      // EquationTermNodeSelfOptions
      integerXSpacing: 4,
      fractionXSpacing: 4,
      integerFont: new PhetFont(40),
      fractionFont: new PhetFont(20),
      symbolFont: new MathSymbolFont(40),
      showOne: false,
      // do not show 1 and -1 coefficients

      // HBoxOptions
      align: 'center'
    }, providedOptions);
    options.children = [];

    // coefficient, with option to show 1 and -1
    if (options.showOne || coefficient.abs().getValue() !== 1) {
      const coefficientNode = new ReducedFractionNode(coefficient, {
        fractionFont: options.fractionFont,
        integerFont: options.integerFont
      });
      options.children.push(coefficientNode);
    }

    // variable's symbol, with option to show 1 and -1
    const stringProperty = new DerivedProperty([symbolProperty], symbol => !options.showOne && coefficient.getValue() === -1 ? MathSymbols.UNARY_MINUS + symbol : symbol);
    const symbolText = new Text(stringProperty, {
      font: options.symbolFont
    });
    options.children.push(symbolText);
    options.spacing = coefficient.isInteger() ? options.integerXSpacing : options.fractionXSpacing;
    super(options);
    this.disposeEquationTermNode = () => {
      stringProperty.dispose();
      symbolText.dispose();
    };
  }
  dispose() {
    this.disposeEquationTermNode();
    super.dispose();
  }
}

/**
 * The representation of a term that the user interacts with, in this case a coefficient and variable inside a square.
 */
class InteractiveTermNode extends Node {
  constructor(coefficient, symbolProperty, providedOptions) {
    assert && assert(coefficient.isReduced(), `coefficient must be reduced: ${coefficient}`);
    const options = optionize()({
      // InteractiveTermNodeSelfOptions
      diameter: EqualityExplorerConstants.SMALL_TERM_DIAMETER,
      margin: null,
      positiveFill: EqualityExplorerColors.POSITIVE_X_FILL,
      negativeFill: EqualityExplorerColors.NEGATIVE_X_FILL,
      positiveLineDash: [],
      // solid border for positive coefficient
      negativeLineDash: [4, 4] // dashed border for negative coefficient
    }, providedOptions);
    if (options.margin === null) {
      options.margin = 0.12 * options.diameter; // determined empirically
    }

    const isPositive = coefficient.getValue() >= 0;

    // background square
    const squareNode = new Rectangle(0, 0, options.diameter, options.diameter, {
      stroke: 'black',
      fill: isPositive ? options.positiveFill : options.negativeFill,
      lineDash: isPositive ? options.positiveLineDash : options.negativeLineDash
    });

    // equationTermNode must be disposed, because it is linked to a translated string Property
    const equationTermNode = VariableTermNode.createEquationTermNode(coefficient, symbolProperty, combineOptions({}, options.equationTermNodeOptions, {
      align: 'center',
      maxWidth: squareNode.width - 2 * options.margin,
      maxHeight: squareNode.height - 2 * options.margin
    }));
    equationTermNode.boundsProperty.link(bounds => {
      equationTermNode.center = squareNode.center;
    });
    options.children = [squareNode, equationTermNode];
    super(options);
    this.disposeInteractiveTermNode = () => {
      equationTermNode.dispose();
    };
  }
  dispose() {
    this.disposeInteractiveTermNode();
    super.dispose();
  }
}
equalityExplorer.register('VariableTermNode', VariableTermNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJNYXRoU3ltYm9sRm9udCIsIk1hdGhTeW1ib2xzIiwiUGhldEZvbnQiLCJIQm94IiwiTm9kZSIsIlJlY3RhbmdsZSIsIlRleHQiLCJlcXVhbGl0eUV4cGxvcmVyIiwiRXF1YWxpdHlFeHBsb3JlckNvbG9ycyIsIkVxdWFsaXR5RXhwbG9yZXJDb25zdGFudHMiLCJSZWR1Y2VkRnJhY3Rpb25Ob2RlIiwiVGVybU5vZGUiLCJvcHRpb25pemUiLCJjb21iaW5lT3B0aW9ucyIsIlZhcmlhYmxlVGVybU5vZGUiLCJjb25zdHJ1Y3RvciIsInRlcm1DcmVhdG9yIiwidGVybSIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJjb250ZW50Tm9kZSIsImNyZWF0ZUludGVyYWN0aXZlVGVybU5vZGUiLCJjb2VmZmljaWVudCIsInZhcmlhYmxlIiwic3ltYm9sUHJvcGVydHkiLCJpbnRlcmFjdGl2ZVRlcm1Ob2RlT3B0aW9ucyIsImRpYW1ldGVyIiwic2hhZG93Tm9kZSIsImZpbGwiLCJvcGFjaXR5IiwiU0hBRE9XX09QQUNJVFkiLCJkaXNwb3NlVmFyaWFibGVUZXJtTm9kZSIsImRpc3Bvc2UiLCJJbnRlcmFjdGl2ZVRlcm1Ob2RlIiwiY3JlYXRlRXF1YXRpb25UZXJtTm9kZSIsIkVxdWF0aW9uVGVybU5vZGUiLCJhc3NlcnQiLCJpc1JlZHVjZWQiLCJpbnRlZ2VyWFNwYWNpbmciLCJmcmFjdGlvblhTcGFjaW5nIiwiaW50ZWdlckZvbnQiLCJmcmFjdGlvbkZvbnQiLCJzeW1ib2xGb250Iiwic2hvd09uZSIsImFsaWduIiwiY2hpbGRyZW4iLCJhYnMiLCJnZXRWYWx1ZSIsImNvZWZmaWNpZW50Tm9kZSIsInB1c2giLCJzdHJpbmdQcm9wZXJ0eSIsInN5bWJvbCIsIlVOQVJZX01JTlVTIiwic3ltYm9sVGV4dCIsImZvbnQiLCJzcGFjaW5nIiwiaXNJbnRlZ2VyIiwiZGlzcG9zZUVxdWF0aW9uVGVybU5vZGUiLCJTTUFMTF9URVJNX0RJQU1FVEVSIiwibWFyZ2luIiwicG9zaXRpdmVGaWxsIiwiUE9TSVRJVkVfWF9GSUxMIiwibmVnYXRpdmVGaWxsIiwiTkVHQVRJVkVfWF9GSUxMIiwicG9zaXRpdmVMaW5lRGFzaCIsIm5lZ2F0aXZlTGluZURhc2giLCJpc1Bvc2l0aXZlIiwic3F1YXJlTm9kZSIsInN0cm9rZSIsImxpbmVEYXNoIiwiZXF1YXRpb25UZXJtTm9kZSIsImVxdWF0aW9uVGVybU5vZGVPcHRpb25zIiwibWF4V2lkdGgiLCJ3aWR0aCIsIm1heEhlaWdodCIsImhlaWdodCIsImJvdW5kc1Byb3BlcnR5IiwibGluayIsImJvdW5kcyIsImNlbnRlciIsImRpc3Bvc2VJbnRlcmFjdGl2ZVRlcm1Ob2RlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJWYXJpYWJsZVRlcm1Ob2RlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERpc3BsYXlzIGEgdmFyaWFibGUgdGVybS5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IEZyYWN0aW9uIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvbW9kZWwvRnJhY3Rpb24uanMnO1xyXG5pbXBvcnQgTWF0aFN5bWJvbEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL01hdGhTeW1ib2xGb250LmpzJztcclxuaW1wb3J0IE1hdGhTeW1ib2xzIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9NYXRoU3ltYm9scy5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBGb250LCBIQm94LCBIQm94T3B0aW9ucywgTm9kZSwgTm9kZU9wdGlvbnMsIFJlY3RhbmdsZSwgVENvbG9yLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IGVxdWFsaXR5RXhwbG9yZXIgZnJvbSAnLi4vLi4vZXF1YWxpdHlFeHBsb3Jlci5qcyc7XHJcbmltcG9ydCBFcXVhbGl0eUV4cGxvcmVyQ29sb3JzIGZyb20gJy4uL0VxdWFsaXR5RXhwbG9yZXJDb2xvcnMuanMnO1xyXG5pbXBvcnQgRXF1YWxpdHlFeHBsb3JlckNvbnN0YW50cyBmcm9tICcuLi9FcXVhbGl0eUV4cGxvcmVyQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IFJlZHVjZWRGcmFjdGlvbk5vZGUgZnJvbSAnLi9SZWR1Y2VkRnJhY3Rpb25Ob2RlLmpzJztcclxuaW1wb3J0IFRlcm1Ob2RlLCB7IFRlcm1Ob2RlT3B0aW9ucyB9IGZyb20gJy4vVGVybU5vZGUuanMnO1xyXG5pbXBvcnQgVmFyaWFibGVUZXJtQ3JlYXRvciBmcm9tICcuLi9tb2RlbC9WYXJpYWJsZVRlcm1DcmVhdG9yLmpzJztcclxuaW1wb3J0IFZhcmlhYmxlVGVybSBmcm9tICcuLi9tb2RlbC9WYXJpYWJsZVRlcm0uanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBTdHJpY3RPbWl0IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9TdHJpY3RPbWl0LmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBjb21iaW5lT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgUGlja09wdGlvbmFsIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrT3B0aW9uYWwuanMnO1xyXG5cclxudHlwZSBFcXVhdGlvblRlcm1Ob2RlU2VsZk9wdGlvbnMgPSB7XHJcbiAgaW50ZWdlclhTcGFjaW5nPzogbnVtYmVyOyAvLyBzcGFjZSBiZXR3ZWVuIGludGVnZXIgY29lZmZpY2llbnQgYW5kIHZhcmlhYmxlIHN5bWJvbFxyXG4gIGZyYWN0aW9uWFNwYWNpbmc/OiBudW1iZXI7IC8vIHNwYWNlIGJldHdlZW4gZnJhY3Rpb25hbCBjb2VmZmljaWVudCBhbmQgdmFyaWFibGUgc3ltYm9sXHJcbiAgaW50ZWdlckZvbnQ/OiBGb250OyAvLyBmb250IGZvciBpbnRlZ2VyIGNvZWZmaWNpZW50XHJcbiAgZnJhY3Rpb25Gb250PzogRm9udDsgLy8gZm9udCBmb3IgZnJhY3Rpb25hbCBjb2VmZmljaWVudFxyXG4gIHN5bWJvbEZvbnQ/OiBNYXRoU3ltYm9sRm9udDsgLy8gZm9udCBmb3IgdmFyaWFibGUgc3ltYm9sXHJcbiAgc2hvd09uZT86IGJvb2xlYW47IC8vIHRydWUgd2lsbCBzaG93IDEgYW5kIC0xIGNvZWZmaWNpZW50c1xyXG59O1xyXG5cclxudHlwZSBFcXVhdGlvblRlcm1Ob2RlT3B0aW9ucyA9IEVxdWF0aW9uVGVybU5vZGVTZWxmT3B0aW9ucyAmXHJcbiAgUGlja09wdGlvbmFsPEhCb3hPcHRpb25zLCAnYWxpZ24nIHwgJ21heFdpZHRoJyB8ICdtYXhIZWlnaHQnPjtcclxuXHJcbnR5cGUgSW50ZXJhY3RpdmVUZXJtTm9kZVNlbGZPcHRpb25zID0ge1xyXG4gIGRpYW1ldGVyPzogbnVtYmVyO1xyXG4gIG1hcmdpbj86IG51bWJlciB8IG51bGw7IC8vIG1hcmdpbiwgZGV0ZXJtaW5lZCBlbXBpcmljYWxseSBpZiBudWxsXHJcbiAgcG9zaXRpdmVGaWxsPzogVENvbG9yOyAvLyBmaWxsIG9mIGJhY2tncm91bmQgc3F1YXJlIGZvciBwb3NpdGl2ZSBjb2VmZmljaWVudFxyXG4gIG5lZ2F0aXZlRmlsbD86IFRDb2xvcjsgLy8gZmlsbCBvZiBiYWNrZ3JvdW5kIHNxdWFyZSBmb3IgbmVnYXRpdmUgY29lZmZpY2llbnRcclxuICBwb3NpdGl2ZUxpbmVEYXNoPzogbnVtYmVyW107IC8vIGxpbmVEYXNoIGZvciBwb3NpdGl2ZSBjb2VmZmljaWVudFxyXG4gIG5lZ2F0aXZlTGluZURhc2g/OiBudW1iZXJbXTsgLy8gbGluZURhc2ggZm9yIG5lZ2F0aXZlIGNvZWZmaWNpZW50XHJcbiAgZXF1YXRpb25UZXJtTm9kZU9wdGlvbnM/OiBFcXVhdGlvblRlcm1Ob2RlT3B0aW9uczsgLy8gcHJvcGFnYXRlZCB0byBFcXVhdGlvblRlcm1Ob2RlXHJcbn07XHJcblxyXG50eXBlIEludGVyYWN0aXZlVGVybU5vZGVPcHRpb25zID0gSW50ZXJhY3RpdmVUZXJtTm9kZVNlbGZPcHRpb25zICZcclxuICBTdHJpY3RPbWl0PE5vZGVPcHRpb25zLCAnY2hpbGRyZW4nIHwgJ21heFdpZHRoJyB8ICdtYXhIZWlnaHQnPjtcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgaW50ZXJhY3RpdmVUZXJtTm9kZU9wdGlvbnM/OiBTdHJpY3RPbWl0PEludGVyYWN0aXZlVGVybU5vZGVPcHRpb25zLCAnZGlhbWV0ZXInPjsgLy8gcHJvcGFnYXRlZCB0byBJbnRlcmFjdGl2ZVRlcm1Ob2RlXHJcbn07XHJcblxyXG50eXBlIFZhcmlhYmxlVGVybU5vZGVPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBUZXJtTm9kZU9wdGlvbnM7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWYXJpYWJsZVRlcm1Ob2RlIGV4dGVuZHMgVGVybU5vZGUge1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGRpc3Bvc2VWYXJpYWJsZVRlcm1Ob2RlOiAoKSA9PiB2b2lkO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHRlcm1DcmVhdG9yOiBWYXJpYWJsZVRlcm1DcmVhdG9yLCB0ZXJtOiBWYXJpYWJsZVRlcm0sIHByb3ZpZGVkT3B0aW9ucz86IFZhcmlhYmxlVGVybU5vZGVPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8VmFyaWFibGVUZXJtTm9kZU9wdGlvbnMsIFN0cmljdE9taXQ8U2VsZk9wdGlvbnMsICdpbnRlcmFjdGl2ZVRlcm1Ob2RlT3B0aW9ucyc+LCBUZXJtTm9kZU9wdGlvbnM+KCkoIHtcclxuICAgICAgLy8gZW1wdHkgb3B0aW9uaXplIGNhbGwgYmVjYXVzZSB3ZSBhY2Nlc3Mgb3B0aW9ucy5pbnRlcmFjdGl2ZVRlcm1Ob2RlT3B0aW9ucyBiZWxvd1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gY29udGVudE5vZGUgbXVzdCBiZSBkaXNwb3NlZCFcclxuICAgIGNvbnN0IGNvbnRlbnROb2RlID0gVmFyaWFibGVUZXJtTm9kZS5jcmVhdGVJbnRlcmFjdGl2ZVRlcm1Ob2RlKCB0ZXJtLmNvZWZmaWNpZW50LCB0ZXJtLnZhcmlhYmxlLnN5bWJvbFByb3BlcnR5LFxyXG4gICAgICBjb21iaW5lT3B0aW9uczxJbnRlcmFjdGl2ZVRlcm1Ob2RlT3B0aW9ucz4oIHt9LCBvcHRpb25zLmludGVyYWN0aXZlVGVybU5vZGVPcHRpb25zLCB7XHJcbiAgICAgICAgZGlhbWV0ZXI6IHRlcm0uZGlhbWV0ZXJcclxuICAgICAgfSApICk7XHJcblxyXG4gICAgY29uc3Qgc2hhZG93Tm9kZSA9IG5ldyBSZWN0YW5nbGUoIDAsIDAsIHRlcm0uZGlhbWV0ZXIsIHRlcm0uZGlhbWV0ZXIsIHtcclxuICAgICAgZmlsbDogJ2JsYWNrJyxcclxuICAgICAgb3BhY2l0eTogRXF1YWxpdHlFeHBsb3JlckNvbnN0YW50cy5TSEFET1dfT1BBQ0lUWVxyXG4gICAgfSApO1xyXG5cclxuICAgIHN1cGVyKCB0ZXJtQ3JlYXRvciwgdGVybSwgY29udGVudE5vZGUsIHNoYWRvd05vZGUsIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VWYXJpYWJsZVRlcm1Ob2RlID0gKCkgPT4ge1xyXG4gICAgICBjb250ZW50Tm9kZS5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VWYXJpYWJsZVRlcm1Ob2RlKCk7XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIHRoZSByZXByZXNlbnRhdGlvbiBvZiBhIHRlcm0gdGhhdCB0aGUgdXNlciBpbnRlcmFjdHMgd2l0aCxcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGNyZWF0ZUludGVyYWN0aXZlVGVybU5vZGUoIGNvZWZmaWNpZW50OiBGcmFjdGlvbiwgc3ltYm9sUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM/OiBJbnRlcmFjdGl2ZVRlcm1Ob2RlT3B0aW9ucyApOiBOb2RlIHtcclxuICAgIHJldHVybiBuZXcgSW50ZXJhY3RpdmVUZXJtTm9kZSggY29lZmZpY2llbnQsIHN5bWJvbFByb3BlcnR5LCBwcm92aWRlZE9wdGlvbnMgKTsgLy9UT0RPIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9lcXVhbGl0eS1leHBsb3Jlci9pc3N1ZXMvMjAwIGR5bmFtaWNcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGEgdGVybSB0aGF0IGlzIHNob3duIGluIGVxdWF0aW9ucy5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGNyZWF0ZUVxdWF0aW9uVGVybU5vZGUoIGNvZWZmaWNpZW50OiBGcmFjdGlvbiwgc3ltYm9sUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM/OiBFcXVhdGlvblRlcm1Ob2RlT3B0aW9ucyApOiBOb2RlIHtcclxuICAgIHJldHVybiBuZXcgRXF1YXRpb25UZXJtTm9kZSggY29lZmZpY2llbnQsIHN5bWJvbFByb3BlcnR5LCBwcm92aWRlZE9wdGlvbnMgKTsgLy9UT0RPIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9lcXVhbGl0eS1leHBsb3Jlci9pc3N1ZXMvMjAwIGR5bmFtaWNcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGUgcmVwcmVzZW50YXRpb24gb2YgYSB0ZXJtIHRoYXQgaXMgc2hvd24gaW4gZXF1YXRpb25zLCBhIGNvZWZmaWNpZW50IGFuZCB2YXJpYWJsZS5cclxuICovXHJcbmNsYXNzIEVxdWF0aW9uVGVybU5vZGUgZXh0ZW5kcyBIQm94IHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlRXF1YXRpb25UZXJtTm9kZTogKCkgPT4gdm9pZDtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBjb2VmZmljaWVudDogRnJhY3Rpb24sIHN5bWJvbFByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+LCBwcm92aWRlZE9wdGlvbnM/OiBFcXVhdGlvblRlcm1Ob2RlT3B0aW9ucyApIHtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBjb2VmZmljaWVudC5pc1JlZHVjZWQoKSwgYGNvZWZmaWNpZW50IG11c3QgYmUgcmVkdWNlZDogJHtjb2VmZmljaWVudH1gICk7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxFcXVhdGlvblRlcm1Ob2RlT3B0aW9ucywgRXF1YXRpb25UZXJtTm9kZVNlbGZPcHRpb25zLCBIQm94T3B0aW9ucz4oKSgge1xyXG4gICAgICBcclxuICAgICAgLy8gRXF1YXRpb25UZXJtTm9kZVNlbGZPcHRpb25zXHJcbiAgICAgIGludGVnZXJYU3BhY2luZzogNCxcclxuICAgICAgZnJhY3Rpb25YU3BhY2luZzogNCxcclxuICAgICAgaW50ZWdlckZvbnQ6IG5ldyBQaGV0Rm9udCggNDAgKSxcclxuICAgICAgZnJhY3Rpb25Gb250OiBuZXcgUGhldEZvbnQoIDIwICksXHJcbiAgICAgIHN5bWJvbEZvbnQ6IG5ldyBNYXRoU3ltYm9sRm9udCggNDAgKSxcclxuICAgICAgc2hvd09uZTogZmFsc2UsIC8vIGRvIG5vdCBzaG93IDEgYW5kIC0xIGNvZWZmaWNpZW50c1xyXG4gICAgICBcclxuICAgICAgLy8gSEJveE9wdGlvbnNcclxuICAgICAgYWxpZ246ICdjZW50ZXInXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBvcHRpb25zLmNoaWxkcmVuID0gW107XHJcblxyXG4gICAgLy8gY29lZmZpY2llbnQsIHdpdGggb3B0aW9uIHRvIHNob3cgMSBhbmQgLTFcclxuICAgIGlmICggb3B0aW9ucy5zaG93T25lIHx8IGNvZWZmaWNpZW50LmFicygpLmdldFZhbHVlKCkgIT09IDEgKSB7XHJcbiAgICAgIGNvbnN0IGNvZWZmaWNpZW50Tm9kZSA9IG5ldyBSZWR1Y2VkRnJhY3Rpb25Ob2RlKCBjb2VmZmljaWVudCwge1xyXG4gICAgICAgIGZyYWN0aW9uRm9udDogb3B0aW9ucy5mcmFjdGlvbkZvbnQsXHJcbiAgICAgICAgaW50ZWdlckZvbnQ6IG9wdGlvbnMuaW50ZWdlckZvbnRcclxuICAgICAgfSApO1xyXG4gICAgICBvcHRpb25zLmNoaWxkcmVuLnB1c2goIGNvZWZmaWNpZW50Tm9kZSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZhcmlhYmxlJ3Mgc3ltYm9sLCB3aXRoIG9wdGlvbiB0byBzaG93IDEgYW5kIC0xXHJcbiAgICBjb25zdCBzdHJpbmdQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgc3ltYm9sUHJvcGVydHkgXSxcclxuICAgICAgc3ltYm9sID0+ICggIW9wdGlvbnMuc2hvd09uZSAmJiBjb2VmZmljaWVudC5nZXRWYWx1ZSgpID09PSAtMSApID8gKCBNYXRoU3ltYm9scy5VTkFSWV9NSU5VUyArIHN5bWJvbCApIDogc3ltYm9sICk7XHJcbiAgICBjb25zdCBzeW1ib2xUZXh0ID0gbmV3IFRleHQoIHN0cmluZ1Byb3BlcnR5LCB7XHJcbiAgICAgIGZvbnQ6IG9wdGlvbnMuc3ltYm9sRm9udFxyXG4gICAgfSApO1xyXG4gICAgb3B0aW9ucy5jaGlsZHJlbi5wdXNoKCBzeW1ib2xUZXh0ICk7XHJcblxyXG4gICAgb3B0aW9ucy5zcGFjaW5nID0gY29lZmZpY2llbnQuaXNJbnRlZ2VyKCkgPyBvcHRpb25zLmludGVnZXJYU3BhY2luZyA6IG9wdGlvbnMuZnJhY3Rpb25YU3BhY2luZztcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMuZGlzcG9zZUVxdWF0aW9uVGVybU5vZGUgPSAoKSA9PiB7XHJcbiAgICAgIHN0cmluZ1Byb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgc3ltYm9sVGV4dC5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VFcXVhdGlvblRlcm1Ob2RlKCk7XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVGhlIHJlcHJlc2VudGF0aW9uIG9mIGEgdGVybSB0aGF0IHRoZSB1c2VyIGludGVyYWN0cyB3aXRoLCBpbiB0aGlzIGNhc2UgYSBjb2VmZmljaWVudCBhbmQgdmFyaWFibGUgaW5zaWRlIGEgc3F1YXJlLlxyXG4gKi9cclxuY2xhc3MgSW50ZXJhY3RpdmVUZXJtTm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGRpc3Bvc2VJbnRlcmFjdGl2ZVRlcm1Ob2RlOiAoKSA9PiB2b2lkO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGNvZWZmaWNpZW50OiBGcmFjdGlvbiwgc3ltYm9sUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz4sIHByb3ZpZGVkT3B0aW9ucz86IEludGVyYWN0aXZlVGVybU5vZGVPcHRpb25zICkge1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGNvZWZmaWNpZW50LmlzUmVkdWNlZCgpLCBgY29lZmZpY2llbnQgbXVzdCBiZSByZWR1Y2VkOiAke2NvZWZmaWNpZW50fWAgKTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEludGVyYWN0aXZlVGVybU5vZGVPcHRpb25zLCBTdHJpY3RPbWl0PEludGVyYWN0aXZlVGVybU5vZGVTZWxmT3B0aW9ucywgJ2VxdWF0aW9uVGVybU5vZGVPcHRpb25zJz4sIE5vZGVPcHRpb25zPigpKCB7XHJcbiAgICAgIFxyXG4gICAgICAvLyBJbnRlcmFjdGl2ZVRlcm1Ob2RlU2VsZk9wdGlvbnNcclxuICAgICAgZGlhbWV0ZXI6IEVxdWFsaXR5RXhwbG9yZXJDb25zdGFudHMuU01BTExfVEVSTV9ESUFNRVRFUixcclxuICAgICAgbWFyZ2luOiBudWxsLFxyXG4gICAgICBwb3NpdGl2ZUZpbGw6IEVxdWFsaXR5RXhwbG9yZXJDb2xvcnMuUE9TSVRJVkVfWF9GSUxMLFxyXG4gICAgICBuZWdhdGl2ZUZpbGw6IEVxdWFsaXR5RXhwbG9yZXJDb2xvcnMuTkVHQVRJVkVfWF9GSUxMLFxyXG4gICAgICBwb3NpdGl2ZUxpbmVEYXNoOiBbXSwgLy8gc29saWQgYm9yZGVyIGZvciBwb3NpdGl2ZSBjb2VmZmljaWVudFxyXG4gICAgICBuZWdhdGl2ZUxpbmVEYXNoOiBbIDQsIDQgXSAvLyBkYXNoZWQgYm9yZGVyIGZvciBuZWdhdGl2ZSBjb2VmZmljaWVudFxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgaWYgKCBvcHRpb25zLm1hcmdpbiA9PT0gbnVsbCApIHtcclxuICAgICAgb3B0aW9ucy5tYXJnaW4gPSAwLjEyICogb3B0aW9ucy5kaWFtZXRlcjsgLy8gZGV0ZXJtaW5lZCBlbXBpcmljYWxseVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGlzUG9zaXRpdmUgPSAoIGNvZWZmaWNpZW50LmdldFZhbHVlKCkgPj0gMCApO1xyXG5cclxuICAgIC8vIGJhY2tncm91bmQgc3F1YXJlXHJcbiAgICBjb25zdCBzcXVhcmVOb2RlID0gbmV3IFJlY3RhbmdsZSggMCwgMCwgb3B0aW9ucy5kaWFtZXRlciwgb3B0aW9ucy5kaWFtZXRlciwge1xyXG4gICAgICBzdHJva2U6ICdibGFjaycsXHJcbiAgICAgIGZpbGw6IGlzUG9zaXRpdmUgPyBvcHRpb25zLnBvc2l0aXZlRmlsbCA6IG9wdGlvbnMubmVnYXRpdmVGaWxsLFxyXG4gICAgICBsaW5lRGFzaDogaXNQb3NpdGl2ZSA/IG9wdGlvbnMucG9zaXRpdmVMaW5lRGFzaCA6IG9wdGlvbnMubmVnYXRpdmVMaW5lRGFzaFxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGVxdWF0aW9uVGVybU5vZGUgbXVzdCBiZSBkaXNwb3NlZCwgYmVjYXVzZSBpdCBpcyBsaW5rZWQgdG8gYSB0cmFuc2xhdGVkIHN0cmluZyBQcm9wZXJ0eVxyXG4gICAgY29uc3QgZXF1YXRpb25UZXJtTm9kZSA9IFZhcmlhYmxlVGVybU5vZGUuY3JlYXRlRXF1YXRpb25UZXJtTm9kZSggY29lZmZpY2llbnQsIHN5bWJvbFByb3BlcnR5LFxyXG4gICAgICBjb21iaW5lT3B0aW9uczxFcXVhdGlvblRlcm1Ob2RlT3B0aW9ucz4oIHt9LCBvcHRpb25zLmVxdWF0aW9uVGVybU5vZGVPcHRpb25zLCB7XHJcbiAgICAgICAgYWxpZ246ICdjZW50ZXInLFxyXG4gICAgICAgIG1heFdpZHRoOiBzcXVhcmVOb2RlLndpZHRoIC0gKCAyICogb3B0aW9ucy5tYXJnaW4gKSxcclxuICAgICAgICBtYXhIZWlnaHQ6IHNxdWFyZU5vZGUuaGVpZ2h0IC0gKCAyICogb3B0aW9ucy5tYXJnaW4gKVxyXG4gICAgICB9IClcclxuICAgICk7XHJcbiAgICBlcXVhdGlvblRlcm1Ob2RlLmJvdW5kc1Byb3BlcnR5LmxpbmsoIGJvdW5kcyA9PiB7XHJcbiAgICAgIGVxdWF0aW9uVGVybU5vZGUuY2VudGVyID0gc3F1YXJlTm9kZS5jZW50ZXI7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgb3B0aW9ucy5jaGlsZHJlbiA9IFsgc3F1YXJlTm9kZSwgZXF1YXRpb25UZXJtTm9kZSBdO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5kaXNwb3NlSW50ZXJhY3RpdmVUZXJtTm9kZSA9ICgpID0+IHtcclxuICAgICAgZXF1YXRpb25UZXJtTm9kZS5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VJbnRlcmFjdGl2ZVRlcm1Ob2RlKCk7XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5lcXVhbGl0eUV4cGxvcmVyLnJlZ2lzdGVyKCAnVmFyaWFibGVUZXJtTm9kZScsIFZhcmlhYmxlVGVybU5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUVwRSxPQUFPQyxjQUFjLE1BQU0sK0NBQStDO0FBQzFFLE9BQU9DLFdBQVcsTUFBTSw0Q0FBNEM7QUFDcEUsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFlQyxJQUFJLEVBQWVDLElBQUksRUFBZUMsU0FBUyxFQUFVQyxJQUFJLFFBQVEsbUNBQW1DO0FBQ3ZILE9BQU9DLGdCQUFnQixNQUFNLDJCQUEyQjtBQUN4RCxPQUFPQyxzQkFBc0IsTUFBTSw4QkFBOEI7QUFDakUsT0FBT0MseUJBQXlCLE1BQU0saUNBQWlDO0FBQ3ZFLE9BQU9DLG1CQUFtQixNQUFNLDBCQUEwQjtBQUMxRCxPQUFPQyxRQUFRLE1BQTJCLGVBQWU7QUFLekQsT0FBT0MsU0FBUyxJQUFJQyxjQUFjLFFBQVEsdUNBQXVDO0FBa0NqRixlQUFlLE1BQU1DLGdCQUFnQixTQUFTSCxRQUFRLENBQUM7RUFJOUNJLFdBQVdBLENBQUVDLFdBQWdDLEVBQUVDLElBQWtCLEVBQUVDLGVBQXlD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