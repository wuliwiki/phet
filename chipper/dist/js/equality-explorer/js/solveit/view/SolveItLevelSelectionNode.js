// Copyright 2018-2022, University of Colorado Boulder

/**
 * User interface for level selection and other game settings in the 'Solve It!' screen.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import optionize, { combineOptions } from '../../../../phet-core/js/optionize.js';
import InfoButton from '../../../../scenery-phet/js/buttons/InfoButton.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, RichText, Text } from '../../../../scenery/js/imports.js';
import RectangularPushButton from '../../../../sun/js/buttons/RectangularPushButton.js';
import Dialog from '../../../../sun/js/Dialog.js';
import EqualityExplorerConstants from '../../common/EqualityExplorerConstants.js';
import equalityExplorer from '../../equalityExplorer.js';
import EqualityExplorerStrings from '../../EqualityExplorerStrings.js';
import SolveItInfoDialog from './SolveItInfoDialog.js';
import SolveItLevelSelectionButtonGroup from './SolveItLevelSelectionButtonGroup.js';
import SolveForXText from './SolveForXText.js';
export default class SolveItLevelSelectionNode extends Node {
  constructor(model, layoutBounds, providedOptions) {
    const options = optionize()({
      // NodeOptions
      phetioVisiblePropertyInstrumented: false
    }, providedOptions);

    // Level-selection buttons
    const levelSelectionButtonGroup = new SolveItLevelSelectionButtonGroup(model.levelProperty, model.levels, {
      tandem: options.tandem.createTandem('levelSelectionButtonGroup')
    });
    levelSelectionButtonGroup.boundsProperty.link(bounds => {
      levelSelectionButtonGroup.centerX = layoutBounds.centerX;
      levelSelectionButtonGroup.top = layoutBounds.centerY - 25; // top of buttons slightly above center
    });

    const textOptions = {
      font: new PhetFont(50),
      maxWidth: 0.65 * layoutBounds.width
    };

    // Organize the 2 lines of the title under a parent tandem.
    const titleTandem = options.tandem.createTandem('title');

    // 'Choose Your Level', centered above level-selection buttons
    const chooseYourLevelText = new Text(EqualityExplorerStrings.chooseYourLevelStringProperty, combineOptions({}, textOptions, {
      tandem: titleTandem.createTandem('chooseYourLevelText')
    }));
    chooseYourLevelText.boundsProperty.link(bounds => {
      chooseYourLevelText.centerX = levelSelectionButtonGroup.centerX;
      chooseYourLevelText.bottom = levelSelectionButtonGroup.top - 65;
    });

    // 'Solve for x'
    const solveForXText = new SolveForXText(combineOptions({}, textOptions, {
      tandem: titleTandem.createTandem('solveForXText')
    }));

    // Centered above 'Choose Your Level'
    solveForXText.boundsProperty.link(bounds => {
      solveForXText.centerX = chooseYourLevelText.centerX;
      solveForXText.bottom = chooseYourLevelText.top - 30;
    });

    // Info dialog is created eagerly and reused, so we don't have to deal with PhetioCapsule.
    const infoDialog = new SolveItInfoDialog(model.levels.map(level => level.descriptionProperty), options.tandem.createTandem('infoDialog'));

    // Info button, to right of 'Choose Your Level', opens the Info dialog.
    const infoButton = new InfoButton({
      iconFill: 'rgb( 41, 106, 163 )',
      maxHeight: 0.75 * chooseYourLevelText.height,
      listener: () => {
        infoDialog.show();
      },
      tandem: options.tandem.createTandem('infoButton')
    });
    chooseYourLevelText.boundsProperty.link(bounds => {
      infoButton.left = chooseYourLevelText.right + 20;
      infoButton.centerY = chooseYourLevelText.centerY;
    });

    // Reset All button, at lower right
    const resetAllButton = new ResetAllButton({
      listener: () => {
        phet.log && phet.log('ResetAllButton pressed');
        options.resetCallback();
      },
      right: layoutBounds.maxX - EqualityExplorerConstants.SCREEN_VIEW_X_MARGIN,
      bottom: layoutBounds.maxY - EqualityExplorerConstants.SCREEN_VIEW_Y_MARGIN,
      tandem: options.tandem.createTandem('resetAllButton')
    });
    const children = [solveForXText, chooseYourLevelText, infoButton, levelSelectionButtonGroup, resetAllButton];

    // Press this button to test challenge generators. See output in console.
    // This test is only useful if assertions are enabled.
    // Disable if fuzz is enabled, since this takes a long time and is not relevant to fuzz testing.
    // Note that this is conditional, so is not (and should be) instrumented for PhET-iO..
    if (assert && phet.chipper.queryParameters.showAnswers && !phet.chipper.isFuzzEnabled()) {
      const testButton = new RectangularPushButton({
        content: new Text('Test challenge generators', {
          fill: 'white',
          font: new PhetFont(20)
        }),
        baseColor: 'red',
        listener: () => {
          model.testChallengeGenerators();
          const messageText = new RichText('Test completed.<br>See results in browser console.');
          const dialog = new Dialog(messageText, {
            topMargin: 20,
            bottomMargin: 20,
            leftMargin: 20
          });
          dialog.show();
        },
        centerX: layoutBounds.centerX,
        bottom: layoutBounds.bottom - 20
      });
      children.push(testButton);
    }
    super({
      children: children
    });
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
}
equalityExplorer.register('SolveItLevelSelectionNode', SolveItLevelSelectionNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25pemUiLCJjb21iaW5lT3B0aW9ucyIsIkluZm9CdXR0b24iLCJSZXNldEFsbEJ1dHRvbiIsIlBoZXRGb250IiwiTm9kZSIsIlJpY2hUZXh0IiwiVGV4dCIsIlJlY3Rhbmd1bGFyUHVzaEJ1dHRvbiIsIkRpYWxvZyIsIkVxdWFsaXR5RXhwbG9yZXJDb25zdGFudHMiLCJlcXVhbGl0eUV4cGxvcmVyIiwiRXF1YWxpdHlFeHBsb3JlclN0cmluZ3MiLCJTb2x2ZUl0SW5mb0RpYWxvZyIsIlNvbHZlSXRMZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwIiwiU29sdmVGb3JYVGV4dCIsIlNvbHZlSXRMZXZlbFNlbGVjdGlvbk5vZGUiLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwibGF5b3V0Qm91bmRzIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInBoZXRpb1Zpc2libGVQcm9wZXJ0eUluc3RydW1lbnRlZCIsImxldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAiLCJsZXZlbFByb3BlcnR5IiwibGV2ZWxzIiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwiYm91bmRzUHJvcGVydHkiLCJsaW5rIiwiYm91bmRzIiwiY2VudGVyWCIsInRvcCIsImNlbnRlclkiLCJ0ZXh0T3B0aW9ucyIsImZvbnQiLCJtYXhXaWR0aCIsIndpZHRoIiwidGl0bGVUYW5kZW0iLCJjaG9vc2VZb3VyTGV2ZWxUZXh0IiwiY2hvb3NlWW91ckxldmVsU3RyaW5nUHJvcGVydHkiLCJib3R0b20iLCJzb2x2ZUZvclhUZXh0IiwiaW5mb0RpYWxvZyIsIm1hcCIsImxldmVsIiwiZGVzY3JpcHRpb25Qcm9wZXJ0eSIsImluZm9CdXR0b24iLCJpY29uRmlsbCIsIm1heEhlaWdodCIsImhlaWdodCIsImxpc3RlbmVyIiwic2hvdyIsImxlZnQiLCJyaWdodCIsInJlc2V0QWxsQnV0dG9uIiwicGhldCIsImxvZyIsInJlc2V0Q2FsbGJhY2siLCJtYXhYIiwiU0NSRUVOX1ZJRVdfWF9NQVJHSU4iLCJtYXhZIiwiU0NSRUVOX1ZJRVdfWV9NQVJHSU4iLCJjaGlsZHJlbiIsImFzc2VydCIsImNoaXBwZXIiLCJxdWVyeVBhcmFtZXRlcnMiLCJzaG93QW5zd2VycyIsImlzRnV6ekVuYWJsZWQiLCJ0ZXN0QnV0dG9uIiwiY29udGVudCIsImZpbGwiLCJiYXNlQ29sb3IiLCJ0ZXN0Q2hhbGxlbmdlR2VuZXJhdG9ycyIsIm1lc3NhZ2VUZXh0IiwiZGlhbG9nIiwidG9wTWFyZ2luIiwiYm90dG9tTWFyZ2luIiwibGVmdE1hcmdpbiIsInB1c2giLCJkaXNwb3NlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJTb2x2ZUl0TGV2ZWxTZWxlY3Rpb25Ob2RlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFVzZXIgaW50ZXJmYWNlIGZvciBsZXZlbCBzZWxlY3Rpb24gYW5kIG90aGVyIGdhbWUgc2V0dGluZ3MgaW4gdGhlICdTb2x2ZSBJdCEnIHNjcmVlbi5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgQm91bmRzMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvQm91bmRzMi5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgY29tYmluZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFBpY2tSZXF1aXJlZCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja1JlcXVpcmVkLmpzJztcclxuaW1wb3J0IEluZm9CdXR0b24gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL2J1dHRvbnMvSW5mb0J1dHRvbi5qcyc7XHJcbmltcG9ydCBSZXNldEFsbEJ1dHRvbiBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvYnV0dG9ucy9SZXNldEFsbEJ1dHRvbi5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBOb2RlLCBOb2RlT3B0aW9ucywgUmljaFRleHQsIFRleHQsIFRleHRPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbiBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvYnV0dG9ucy9SZWN0YW5ndWxhclB1c2hCdXR0b24uanMnO1xyXG5pbXBvcnQgRGlhbG9nIGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9EaWFsb2cuanMnO1xyXG5pbXBvcnQgRXF1YWxpdHlFeHBsb3JlckNvbnN0YW50cyBmcm9tICcuLi8uLi9jb21tb24vRXF1YWxpdHlFeHBsb3JlckNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBlcXVhbGl0eUV4cGxvcmVyIGZyb20gJy4uLy4uL2VxdWFsaXR5RXhwbG9yZXIuanMnO1xyXG5pbXBvcnQgRXF1YWxpdHlFeHBsb3JlclN0cmluZ3MgZnJvbSAnLi4vLi4vRXF1YWxpdHlFeHBsb3JlclN0cmluZ3MuanMnO1xyXG5pbXBvcnQgU29sdmVJdE1vZGVsIGZyb20gJy4uL21vZGVsL1NvbHZlSXRNb2RlbC5qcyc7XHJcbmltcG9ydCBTb2x2ZUl0SW5mb0RpYWxvZyBmcm9tICcuL1NvbHZlSXRJbmZvRGlhbG9nLmpzJztcclxuaW1wb3J0IFNvbHZlSXRMZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwIGZyb20gJy4vU29sdmVJdExldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAuanMnO1xyXG5pbXBvcnQgU29sdmVGb3JYVGV4dCwgeyBTb2x2ZUZvclhUZXh0T3B0aW9ucyB9IGZyb20gJy4vU29sdmVGb3JYVGV4dC5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG5cclxuICAvLyBjYWxsZWQgd2hlbiB0aGUgUmVzZXQgQWxsIGJ1dHRvbiBpcyBwcmVzc2VkXHJcbiAgcmVzZXRDYWxsYmFjazogKCkgPT4gdm9pZDtcclxufTtcclxuXHJcbnR5cGUgU29sdmVJdExldmVsU2VsZWN0aW9uTm9kZU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBpY2tSZXF1aXJlZDxOb2RlT3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU29sdmVJdExldmVsU2VsZWN0aW9uTm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIG1vZGVsOiBTb2x2ZUl0TW9kZWwsIGxheW91dEJvdW5kczogQm91bmRzMiwgcHJvdmlkZWRPcHRpb25zOiBTb2x2ZUl0TGV2ZWxTZWxlY3Rpb25Ob2RlT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFNvbHZlSXRMZXZlbFNlbGVjdGlvbk5vZGVPcHRpb25zLCBTZWxmT3B0aW9ucywgTm9kZU9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIE5vZGVPcHRpb25zXHJcbiAgICAgIHBoZXRpb1Zpc2libGVQcm9wZXJ0eUluc3RydW1lbnRlZDogZmFsc2VcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIExldmVsLXNlbGVjdGlvbiBidXR0b25zXHJcbiAgICBjb25zdCBsZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwID0gbmV3IFNvbHZlSXRMZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwKCBtb2RlbC5sZXZlbFByb3BlcnR5LCBtb2RlbC5sZXZlbHMsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdsZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwJyApXHJcbiAgICB9ICk7XHJcbiAgICBsZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwLmJvdW5kc1Byb3BlcnR5LmxpbmsoIGJvdW5kcyA9PiB7XHJcbiAgICAgIGxldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAuY2VudGVyWCA9IGxheW91dEJvdW5kcy5jZW50ZXJYO1xyXG4gICAgICBsZXZlbFNlbGVjdGlvbkJ1dHRvbkdyb3VwLnRvcCA9IGxheW91dEJvdW5kcy5jZW50ZXJZIC0gMjU7IC8vIHRvcCBvZiBidXR0b25zIHNsaWdodGx5IGFib3ZlIGNlbnRlclxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHRleHRPcHRpb25zID0ge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIDUwICksXHJcbiAgICAgIG1heFdpZHRoOiAwLjY1ICogbGF5b3V0Qm91bmRzLndpZHRoXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIE9yZ2FuaXplIHRoZSAyIGxpbmVzIG9mIHRoZSB0aXRsZSB1bmRlciBhIHBhcmVudCB0YW5kZW0uXHJcbiAgICBjb25zdCB0aXRsZVRhbmRlbSA9IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3RpdGxlJyApO1xyXG5cclxuICAgIC8vICdDaG9vc2UgWW91ciBMZXZlbCcsIGNlbnRlcmVkIGFib3ZlIGxldmVsLXNlbGVjdGlvbiBidXR0b25zXHJcbiAgICBjb25zdCBjaG9vc2VZb3VyTGV2ZWxUZXh0ID0gbmV3IFRleHQoIEVxdWFsaXR5RXhwbG9yZXJTdHJpbmdzLmNob29zZVlvdXJMZXZlbFN0cmluZ1Byb3BlcnR5LFxyXG4gICAgICBjb21iaW5lT3B0aW9uczxUZXh0T3B0aW9ucz4oIHt9LCB0ZXh0T3B0aW9ucywge1xyXG4gICAgICAgIHRhbmRlbTogdGl0bGVUYW5kZW0uY3JlYXRlVGFuZGVtKCAnY2hvb3NlWW91ckxldmVsVGV4dCcgKVxyXG4gICAgICB9ICkgKTtcclxuICAgIGNob29zZVlvdXJMZXZlbFRleHQuYm91bmRzUHJvcGVydHkubGluayggYm91bmRzID0+IHtcclxuICAgICAgY2hvb3NlWW91ckxldmVsVGV4dC5jZW50ZXJYID0gbGV2ZWxTZWxlY3Rpb25CdXR0b25Hcm91cC5jZW50ZXJYO1xyXG4gICAgICBjaG9vc2VZb3VyTGV2ZWxUZXh0LmJvdHRvbSA9IGxldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAudG9wIC0gNjU7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gJ1NvbHZlIGZvciB4J1xyXG4gICAgY29uc3Qgc29sdmVGb3JYVGV4dCA9IG5ldyBTb2x2ZUZvclhUZXh0KCBjb21iaW5lT3B0aW9uczxTb2x2ZUZvclhUZXh0T3B0aW9ucz4oIHt9LCB0ZXh0T3B0aW9ucywge1xyXG4gICAgICB0YW5kZW06IHRpdGxlVGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NvbHZlRm9yWFRleHQnIClcclxuICAgIH0gKSApO1xyXG5cclxuICAgIC8vIENlbnRlcmVkIGFib3ZlICdDaG9vc2UgWW91ciBMZXZlbCdcclxuICAgIHNvbHZlRm9yWFRleHQuYm91bmRzUHJvcGVydHkubGluayggYm91bmRzID0+IHtcclxuICAgICAgc29sdmVGb3JYVGV4dC5jZW50ZXJYID0gY2hvb3NlWW91ckxldmVsVGV4dC5jZW50ZXJYO1xyXG4gICAgICBzb2x2ZUZvclhUZXh0LmJvdHRvbSA9IGNob29zZVlvdXJMZXZlbFRleHQudG9wIC0gMzA7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gSW5mbyBkaWFsb2cgaXMgY3JlYXRlZCBlYWdlcmx5IGFuZCByZXVzZWQsIHNvIHdlIGRvbid0IGhhdmUgdG8gZGVhbCB3aXRoIFBoZXRpb0NhcHN1bGUuXHJcbiAgICBjb25zdCBpbmZvRGlhbG9nID0gbmV3IFNvbHZlSXRJbmZvRGlhbG9nKCBtb2RlbC5sZXZlbHMubWFwKCBsZXZlbCA9PiBsZXZlbC5kZXNjcmlwdGlvblByb3BlcnR5ICksXHJcbiAgICAgIG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2luZm9EaWFsb2cnICkgKTtcclxuXHJcbiAgICAvLyBJbmZvIGJ1dHRvbiwgdG8gcmlnaHQgb2YgJ0Nob29zZSBZb3VyIExldmVsJywgb3BlbnMgdGhlIEluZm8gZGlhbG9nLlxyXG4gICAgY29uc3QgaW5mb0J1dHRvbiA9IG5ldyBJbmZvQnV0dG9uKCB7XHJcbiAgICAgIGljb25GaWxsOiAncmdiKCA0MSwgMTA2LCAxNjMgKScsXHJcbiAgICAgIG1heEhlaWdodDogMC43NSAqIGNob29zZVlvdXJMZXZlbFRleHQuaGVpZ2h0LFxyXG4gICAgICBsaXN0ZW5lcjogKCkgPT4ge1xyXG4gICAgICAgIGluZm9EaWFsb2cuc2hvdygpO1xyXG4gICAgICB9LFxyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2luZm9CdXR0b24nIClcclxuICAgIH0gKTtcclxuICAgIGNob29zZVlvdXJMZXZlbFRleHQuYm91bmRzUHJvcGVydHkubGluayggYm91bmRzID0+IHtcclxuICAgICAgaW5mb0J1dHRvbi5sZWZ0ID0gY2hvb3NlWW91ckxldmVsVGV4dC5yaWdodCArIDIwO1xyXG4gICAgICBpbmZvQnV0dG9uLmNlbnRlclkgPSBjaG9vc2VZb3VyTGV2ZWxUZXh0LmNlbnRlclk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gUmVzZXQgQWxsIGJ1dHRvbiwgYXQgbG93ZXIgcmlnaHRcclxuICAgIGNvbnN0IHJlc2V0QWxsQnV0dG9uID0gbmV3IFJlc2V0QWxsQnV0dG9uKCB7XHJcbiAgICAgIGxpc3RlbmVyOiAoKSA9PiB7XHJcbiAgICAgICAgcGhldC5sb2cgJiYgcGhldC5sb2coICdSZXNldEFsbEJ1dHRvbiBwcmVzc2VkJyApO1xyXG4gICAgICAgIG9wdGlvbnMucmVzZXRDYWxsYmFjaygpO1xyXG4gICAgICB9LFxyXG4gICAgICByaWdodDogbGF5b3V0Qm91bmRzLm1heFggLSBFcXVhbGl0eUV4cGxvcmVyQ29uc3RhbnRzLlNDUkVFTl9WSUVXX1hfTUFSR0lOLFxyXG4gICAgICBib3R0b206IGxheW91dEJvdW5kcy5tYXhZIC0gRXF1YWxpdHlFeHBsb3JlckNvbnN0YW50cy5TQ1JFRU5fVklFV19ZX01BUkdJTixcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdyZXNldEFsbEJ1dHRvbicgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGNoaWxkcmVuOiBOb2RlW10gPSBbXHJcbiAgICAgIHNvbHZlRm9yWFRleHQsXHJcbiAgICAgIGNob29zZVlvdXJMZXZlbFRleHQsXHJcbiAgICAgIGluZm9CdXR0b24sXHJcbiAgICAgIGxldmVsU2VsZWN0aW9uQnV0dG9uR3JvdXAsXHJcbiAgICAgIHJlc2V0QWxsQnV0dG9uXHJcbiAgICBdO1xyXG5cclxuICAgIC8vIFByZXNzIHRoaXMgYnV0dG9uIHRvIHRlc3QgY2hhbGxlbmdlIGdlbmVyYXRvcnMuIFNlZSBvdXRwdXQgaW4gY29uc29sZS5cclxuICAgIC8vIFRoaXMgdGVzdCBpcyBvbmx5IHVzZWZ1bCBpZiBhc3NlcnRpb25zIGFyZSBlbmFibGVkLlxyXG4gICAgLy8gRGlzYWJsZSBpZiBmdXp6IGlzIGVuYWJsZWQsIHNpbmNlIHRoaXMgdGFrZXMgYSBsb25nIHRpbWUgYW5kIGlzIG5vdCByZWxldmFudCB0byBmdXp6IHRlc3RpbmcuXHJcbiAgICAvLyBOb3RlIHRoYXQgdGhpcyBpcyBjb25kaXRpb25hbCwgc28gaXMgbm90IChhbmQgc2hvdWxkIGJlKSBpbnN0cnVtZW50ZWQgZm9yIFBoRVQtaU8uLlxyXG4gICAgaWYgKCBhc3NlcnQgJiYgcGhldC5jaGlwcGVyLnF1ZXJ5UGFyYW1ldGVycy5zaG93QW5zd2VycyAmJiAhcGhldC5jaGlwcGVyLmlzRnV6ekVuYWJsZWQoKSApIHtcclxuICAgICAgY29uc3QgdGVzdEJ1dHRvbiA9IG5ldyBSZWN0YW5ndWxhclB1c2hCdXR0b24oIHtcclxuICAgICAgICBjb250ZW50OiBuZXcgVGV4dCggJ1Rlc3QgY2hhbGxlbmdlIGdlbmVyYXRvcnMnLCB7IGZpbGw6ICd3aGl0ZScsIGZvbnQ6IG5ldyBQaGV0Rm9udCggMjAgKSB9ICksXHJcbiAgICAgICAgYmFzZUNvbG9yOiAncmVkJyxcclxuICAgICAgICBsaXN0ZW5lcjogKCkgPT4ge1xyXG4gICAgICAgICAgbW9kZWwudGVzdENoYWxsZW5nZUdlbmVyYXRvcnMoKTtcclxuICAgICAgICAgIGNvbnN0IG1lc3NhZ2VUZXh0ID0gbmV3IFJpY2hUZXh0KCAnVGVzdCBjb21wbGV0ZWQuPGJyPlNlZSByZXN1bHRzIGluIGJyb3dzZXIgY29uc29sZS4nICk7XHJcbiAgICAgICAgICBjb25zdCBkaWFsb2cgPSBuZXcgRGlhbG9nKCBtZXNzYWdlVGV4dCwge1xyXG4gICAgICAgICAgICB0b3BNYXJnaW46IDIwLFxyXG4gICAgICAgICAgICBib3R0b21NYXJnaW46IDIwLFxyXG4gICAgICAgICAgICBsZWZ0TWFyZ2luOiAyMFxyXG4gICAgICAgICAgfSApO1xyXG4gICAgICAgICAgZGlhbG9nLnNob3coKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNlbnRlclg6IGxheW91dEJvdW5kcy5jZW50ZXJYLFxyXG4gICAgICAgIGJvdHRvbTogbGF5b3V0Qm91bmRzLmJvdHRvbSAtIDIwXHJcbiAgICAgIH0gKTtcclxuICAgICAgY2hpbGRyZW4ucHVzaCggdGVzdEJ1dHRvbiApO1xyXG4gICAgfVxyXG5cclxuICAgIHN1cGVyKCB7IGNoaWxkcmVuOiBjaGlsZHJlbiB9ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXF1YWxpdHlFeHBsb3Jlci5yZWdpc3RlciggJ1NvbHZlSXRMZXZlbFNlbGVjdGlvbk5vZGUnLCBTb2x2ZUl0TGV2ZWxTZWxlY3Rpb25Ob2RlICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBLE9BQU9BLFNBQVMsSUFBSUMsY0FBYyxRQUFRLHVDQUF1QztBQUVqRixPQUFPQyxVQUFVLE1BQU0sbURBQW1E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