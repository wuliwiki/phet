// Copyright 2021-2023, University of Colorado Boulder

/**
 * DiscreteSumChart is the model for the 'Sum' chart in the 'Discrete' screen.
 * It adds the following the base class:
 * - a data set for preset waveforms that shows what the waveform would look like if approximated by a Fourier Series
 *   with an infinite number of harmonics
 * - x-axis formatting that depends on Domain
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import FMWConstants from '../../common/FMWConstants.js';
import SumChart from '../../common/model/SumChart.js';
import fourierMakingWaves from '../../fourierMakingWaves.js';
// constants
const EMPTY_DATA_SET = FMWConstants.EMPTY_DATA_SET;
export default class DiscreteSumChart extends SumChart {
  // whether the Sum chart shows what the waveform looks like for an infinite Fourier series

  // Data set that corresponds to a waveform preset, as if it were approximated using a Fourier series with an
  // infinite number of harmonics. If the preset is not visible, then returns EMPTY_DATA_SET.
  constructor(fourierSeries, domainProperty, seriesTypeProperty, tProperty, xAxisTickLabelFormatProperty, xAxisDescriptionProperty, waveformProperty, tandem) {
    super(fourierSeries, domainProperty, seriesTypeProperty, tProperty, xAxisDescriptionProperty, tandem);
    this.xAxisTickLabelFormatProperty = xAxisTickLabelFormatProperty;
    this.waveformProperty = waveformProperty;
    this.infiniteHarmonicsVisibleProperty = new BooleanProperty(false, {
      tandem: tandem.createTandem('infiniteHarmonicsVisibleProperty')
    });

    // To improve readability
    const L = fourierSeries.L;
    const T = fourierSeries.T;
    this.infiniteHarmonicsDataSetProperty = new DerivedProperty([this.infiniteHarmonicsVisibleProperty, this.sumDataSetProperty, waveformProperty, domainProperty, seriesTypeProperty, tProperty], (infiniteHarmonicsVisible, sumDataSet, waveform, domain, seriesType, t) => {
      if (infiniteHarmonicsVisible && waveform.supportsInfiniteHarmonics) {
        assert && assert(waveform.getInfiniteHarmonicsDataSet);
        return waveform.getInfiniteHarmonicsDataSet(domain, seriesType, t, L, T);
      } else {
        return EMPTY_DATA_SET;
      }
    });
  }
  reset() {
    super.reset();
    this.infiniteHarmonicsVisibleProperty.reset();
  }
}
fourierMakingWaves.register('DiscreteSumChart', DiscreteSumChart);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJEZXJpdmVkUHJvcGVydHkiLCJGTVdDb25zdGFudHMiLCJTdW1DaGFydCIsImZvdXJpZXJNYWtpbmdXYXZlcyIsIkVNUFRZX0RBVEFfU0VUIiwiRGlzY3JldGVTdW1DaGFydCIsImNvbnN0cnVjdG9yIiwiZm91cmllclNlcmllcyIsImRvbWFpblByb3BlcnR5Iiwic2VyaWVzVHlwZVByb3BlcnR5IiwidFByb3BlcnR5IiwieEF4aXNUaWNrTGFiZWxGb3JtYXRQcm9wZXJ0eSIsInhBeGlzRGVzY3JpcHRpb25Qcm9wZXJ0eSIsIndhdmVmb3JtUHJvcGVydHkiLCJ0YW5kZW0iLCJpbmZpbml0ZUhhcm1vbmljc1Zpc2libGVQcm9wZXJ0eSIsImNyZWF0ZVRhbmRlbSIsIkwiLCJUIiwiaW5maW5pdGVIYXJtb25pY3NEYXRhU2V0UHJvcGVydHkiLCJzdW1EYXRhU2V0UHJvcGVydHkiLCJpbmZpbml0ZUhhcm1vbmljc1Zpc2libGUiLCJzdW1EYXRhU2V0Iiwid2F2ZWZvcm0iLCJkb21haW4iLCJzZXJpZXNUeXBlIiwidCIsInN1cHBvcnRzSW5maW5pdGVIYXJtb25pY3MiLCJhc3NlcnQiLCJnZXRJbmZpbml0ZUhhcm1vbmljc0RhdGFTZXQiLCJyZXNldCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRGlzY3JldGVTdW1DaGFydC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBEaXNjcmV0ZVN1bUNoYXJ0IGlzIHRoZSBtb2RlbCBmb3IgdGhlICdTdW0nIGNoYXJ0IGluIHRoZSAnRGlzY3JldGUnIHNjcmVlbi5cclxuICogSXQgYWRkcyB0aGUgZm9sbG93aW5nIHRoZSBiYXNlIGNsYXNzOlxyXG4gKiAtIGEgZGF0YSBzZXQgZm9yIHByZXNldCB3YXZlZm9ybXMgdGhhdCBzaG93cyB3aGF0IHRoZSB3YXZlZm9ybSB3b3VsZCBsb29rIGxpa2UgaWYgYXBwcm94aW1hdGVkIGJ5IGEgRm91cmllciBTZXJpZXNcclxuICogICB3aXRoIGFuIGluZmluaXRlIG51bWJlciBvZiBoYXJtb25pY3NcclxuICogLSB4LWF4aXMgZm9ybWF0dGluZyB0aGF0IGRlcGVuZHMgb24gRG9tYWluXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IEJvb2xlYW5Qcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Jvb2xlYW5Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRW51bWVyYXRpb25Qcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0VudW1lcmF0aW9uUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgRk1XQ29uc3RhbnRzIGZyb20gJy4uLy4uL2NvbW1vbi9GTVdDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgU3VtQ2hhcnQgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL1N1bUNoYXJ0LmpzJztcclxuaW1wb3J0IGZvdXJpZXJNYWtpbmdXYXZlcyBmcm9tICcuLi8uLi9mb3VyaWVyTWFraW5nV2F2ZXMuanMnO1xyXG5pbXBvcnQgV2F2ZWZvcm0gZnJvbSAnLi9XYXZlZm9ybS5qcyc7XHJcbmltcG9ydCBGb3VyaWVyU2VyaWVzIGZyb20gJy4uLy4uL2NvbW1vbi9tb2RlbC9Gb3VyaWVyU2VyaWVzLmpzJztcclxuaW1wb3J0IERvbWFpbiBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvRG9tYWluLmpzJztcclxuaW1wb3J0IFNlcmllc1R5cGUgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL1Nlcmllc1R5cGUuanMnO1xyXG5pbXBvcnQgVGlja0xhYmVsRm9ybWF0IGZyb20gJy4uLy4uL2NvbW1vbi9tb2RlbC9UaWNrTGFiZWxGb3JtYXQuanMnO1xyXG5pbXBvcnQgQXhpc0Rlc2NyaXB0aW9uIGZyb20gJy4uLy4uL2NvbW1vbi9tb2RlbC9BeGlzRGVzY3JpcHRpb24uanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IEVNUFRZX0RBVEFfU0VUID0gRk1XQ29uc3RhbnRzLkVNUFRZX0RBVEFfU0VUO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGlzY3JldGVTdW1DaGFydCBleHRlbmRzIFN1bUNoYXJ0IHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IHhBeGlzVGlja0xhYmVsRm9ybWF0UHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFRpY2tMYWJlbEZvcm1hdD47XHJcbiAgcHVibGljIHJlYWRvbmx5IHdhdmVmb3JtUHJvcGVydHk6IFByb3BlcnR5PFdhdmVmb3JtPjtcclxuXHJcbiAgLy8gd2hldGhlciB0aGUgU3VtIGNoYXJ0IHNob3dzIHdoYXQgdGhlIHdhdmVmb3JtIGxvb2tzIGxpa2UgZm9yIGFuIGluZmluaXRlIEZvdXJpZXIgc2VyaWVzXHJcbiAgcHVibGljIHJlYWRvbmx5IGluZmluaXRlSGFybW9uaWNzVmlzaWJsZVByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPjtcclxuXHJcbiAgLy8gRGF0YSBzZXQgdGhhdCBjb3JyZXNwb25kcyB0byBhIHdhdmVmb3JtIHByZXNldCwgYXMgaWYgaXQgd2VyZSBhcHByb3hpbWF0ZWQgdXNpbmcgYSBGb3VyaWVyIHNlcmllcyB3aXRoIGFuXHJcbiAgLy8gaW5maW5pdGUgbnVtYmVyIG9mIGhhcm1vbmljcy4gSWYgdGhlIHByZXNldCBpcyBub3QgdmlzaWJsZSwgdGhlbiByZXR1cm5zIEVNUFRZX0RBVEFfU0VULlxyXG4gIHB1YmxpYyByZWFkb25seSBpbmZpbml0ZUhhcm1vbmljc0RhdGFTZXRQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8VmVjdG9yMltdPjtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBmb3VyaWVyU2VyaWVzOiBGb3VyaWVyU2VyaWVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgZG9tYWluUHJvcGVydHk6IEVudW1lcmF0aW9uUHJvcGVydHk8RG9tYWluPixcclxuICAgICAgICAgICAgICAgICAgICAgIHNlcmllc1R5cGVQcm9wZXJ0eTogRW51bWVyYXRpb25Qcm9wZXJ0eTxTZXJpZXNUeXBlPixcclxuICAgICAgICAgICAgICAgICAgICAgIHRQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyPixcclxuICAgICAgICAgICAgICAgICAgICAgIHhBeGlzVGlja0xhYmVsRm9ybWF0UHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFRpY2tMYWJlbEZvcm1hdD4sXHJcbiAgICAgICAgICAgICAgICAgICAgICB4QXhpc0Rlc2NyaXB0aW9uUHJvcGVydHk6IFByb3BlcnR5PEF4aXNEZXNjcmlwdGlvbj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICB3YXZlZm9ybVByb3BlcnR5OiBQcm9wZXJ0eTxXYXZlZm9ybT4sXHJcbiAgICAgICAgICAgICAgICAgICAgICB0YW5kZW06IFRhbmRlbSApIHtcclxuXHJcbiAgICBzdXBlciggZm91cmllclNlcmllcywgZG9tYWluUHJvcGVydHksIHNlcmllc1R5cGVQcm9wZXJ0eSwgdFByb3BlcnR5LCB4QXhpc0Rlc2NyaXB0aW9uUHJvcGVydHksIHRhbmRlbSApO1xyXG5cclxuICAgIHRoaXMueEF4aXNUaWNrTGFiZWxGb3JtYXRQcm9wZXJ0eSA9IHhBeGlzVGlja0xhYmVsRm9ybWF0UHJvcGVydHk7XHJcbiAgICB0aGlzLndhdmVmb3JtUHJvcGVydHkgPSB3YXZlZm9ybVByb3BlcnR5O1xyXG5cclxuICAgIHRoaXMuaW5maW5pdGVIYXJtb25pY3NWaXNpYmxlUHJvcGVydHkgPSBuZXcgQm9vbGVhblByb3BlcnR5KCBmYWxzZSwge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdpbmZpbml0ZUhhcm1vbmljc1Zpc2libGVQcm9wZXJ0eScgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFRvIGltcHJvdmUgcmVhZGFiaWxpdHlcclxuICAgIGNvbnN0IEwgPSBmb3VyaWVyU2VyaWVzLkw7XHJcbiAgICBjb25zdCBUID0gZm91cmllclNlcmllcy5UO1xyXG5cclxuICAgIHRoaXMuaW5maW5pdGVIYXJtb25pY3NEYXRhU2V0UHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICBbIHRoaXMuaW5maW5pdGVIYXJtb25pY3NWaXNpYmxlUHJvcGVydHksIHRoaXMuc3VtRGF0YVNldFByb3BlcnR5LCB3YXZlZm9ybVByb3BlcnR5LCBkb21haW5Qcm9wZXJ0eSwgc2VyaWVzVHlwZVByb3BlcnR5LCB0UHJvcGVydHkgXSxcclxuICAgICAgKCBpbmZpbml0ZUhhcm1vbmljc1Zpc2libGUsIHN1bURhdGFTZXQsIHdhdmVmb3JtLCBkb21haW4sIHNlcmllc1R5cGUsIHQgKSA9PiB7XHJcbiAgICAgICAgaWYgKCBpbmZpbml0ZUhhcm1vbmljc1Zpc2libGUgJiYgd2F2ZWZvcm0uc3VwcG9ydHNJbmZpbml0ZUhhcm1vbmljcyApIHtcclxuICAgICAgICAgIGFzc2VydCAmJiBhc3NlcnQoIHdhdmVmb3JtLmdldEluZmluaXRlSGFybW9uaWNzRGF0YVNldCApO1xyXG4gICAgICAgICAgcmV0dXJuIHdhdmVmb3JtLmdldEluZmluaXRlSGFybW9uaWNzRGF0YVNldCEoIGRvbWFpbiwgc2VyaWVzVHlwZSwgdCwgTCwgVCApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBFTVBUWV9EQVRBX1NFVDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgcmVzZXQoKTogdm9pZCB7XHJcbiAgICBzdXBlci5yZXNldCgpO1xyXG4gICAgdGhpcy5pbmZpbml0ZUhhcm1vbmljc1Zpc2libGVQcm9wZXJ0eS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG5cclxuZm91cmllck1ha2luZ1dhdmVzLnJlZ2lzdGVyKCAnRGlzY3JldGVTdW1DaGFydCcsIERpc2NyZXRlU3VtQ2hhcnQgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLGVBQWUsTUFBTSx3Q0FBd0M7QUFNcEUsT0FBT0MsWUFBWSxNQUFNLDhCQUE4QjtBQUN2RCxPQUFPQyxRQUFRLE1BQU0sZ0NBQWdDO0FBQ3JELE9BQU9DLGtCQUFrQixNQUFNLDZCQUE2QjtBQVE1RDtBQUNBLE1BQU1DLGNBQWMsR0FBR0gsWUFBWSxDQUFDRyxjQUFjO0FBRWxELGVBQWUsTUFBTUMsZ0JBQWdCLFNBQVNILFFBQVEsQ0FBQztFQUtyRDs7RUFHQTtFQUNBO0VBR09JLFdBQVdBLENBQUVDLGFBQTRCLEVBQzVCQyxjQUEyQyxFQUMzQ0Msa0JBQW1ELEVBQ25EQyxTQUFvQyxFQUNwQ0MsNEJBQWdFLEVBQ2hFQyx3QkFBbUQsRUFDbkRDLGdCQUFvQyxFQUNwQ0MsTUFBYyxFQUFHO0lBRW5DLEtBQUssQ0FBRVAsYUFBYSxFQUFFQyxjQUFjLEVBQUVDLGtCQUFrQixFQUFFQyxTQUFTLEVBQUVFLHdCQUF3QixFQUFFRSxNQUFPLENBQUM7SUFFdkcsSUFBSSxDQUFDSCw0QkFBNEIsR0FBR0EsNEJBQTRCO0lBQ2hFLElBQUksQ0FBQ0UsZ0JBQWdCLEdBQUdBLGdCQUFnQjtJQUV4QyxJQUFJLENBQUNFLGdDQUFnQyxHQUFHLElBQUloQixlQUFlLENBQUUsS0FBSyxFQUFFO01BQ2xFZSxNQUFNLEVBQUVBLE1BQU0sQ0FBQ0UsWUFBWSxDQUFFLGtDQUFtQztJQUNsRSxDQUFFLENBQUM7O0lBRUg7SUFDQSxNQUFNQyxDQUFDLEdBQUdWLGFBQWEsQ0FBQ1UsQ0FBQztJQUN6QixNQUFNQyxDQUFDLEdBQUdYLGFBQWEsQ0FBQ1csQ0FBQztJQUV6QixJQUFJLENBQUNDLGdDQUFnQyxHQUFHLElBQUluQixlQUFlLENBQ3pELENBQUUsSUFBSSxDQUFDZSxnQ0FBZ0MsRUFBRSxJQUFJLENBQUNLLGtCQUFrQixFQUFFUCxnQkFBZ0IsRUFBRUwsY0FBYyxFQUFFQyxrQkFBa0IsRUFBRUMsU0FBUyxDQUFFLEVBQ25JLENBQUVXLHdCQUF3QixFQUFFQyxVQUFVLEVBQUVDLFFBQVEsRUFBRUMsTUFBTSxFQUFFQyxVQUFVLEVBQUVDLENBQUMsS0FBTTtNQUMzRSxJQUFLTCx3QkFBd0IsSUFBSUUsUUFBUSxDQUFDSSx5QkFBeUIsRUFBRztRQUNwRUMsTUFBTSxJQUFJQSxNQUFNLENBQUVMLFFBQVEsQ0FBQ00sMkJBQTRCLENBQUM7UUFDeEQsT0FBT04sUUFBUSxDQUFDTSwyQkFBMkIsQ0FBR0wsTUFBTSxFQUFFQyxVQUFVLEVBQUVDLENBQUMsRUFBRVQsQ0FBQyxFQUFFQyxDQUFFLENBQUM7TUFDN0UsQ0FBQyxNQUNJO1FBQ0gsT0FBT2QsY0FBYztNQUN2QjtJQUNGLENBQ0YsQ0FBQztFQUNIO0VBRWdCMEIsS0FBS0EsQ0FBQSxFQUFTO0lBQzVCLEtBQUssQ0FBQ0EsS0FBSyxDQUFDLENBQUM7SUFDYixJQUFJLENBQUNmLGdDQUFnQyxDQUFDZSxLQUFLLENBQUMsQ0FBQztFQUMvQztBQUNGO0FBRUEzQixrQkFBa0IsQ0FBQzRCLFFBQVEsQ0FBRSxrQkFBa0IsRUFBRTFCLGdCQUFpQixDQUFDIn0=