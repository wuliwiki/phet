// Copyright 2021-2022, University of Colorado Boulder

/**
 * FMWIconFactory contains factory methods for creating the icons needed throughout this sim's user interface.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Range from '../../../../dot/js/Range.js';
import ScreenIcon from '../../../../joist/js/ScreenIcon.js';
import merge from '../../../../phet-core/js/merge.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { HBox, Image, Line, Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import wavePacketHomeScreenIcon_png from '../../../images/wavePacketHomeScreenIcon_png.js';
import fourierMakingWaves from '../../fourierMakingWaves.js';
import PointsAwardedNode from '../../waveGame/view/PointsAwardedNode.js';
import HorizontalDimensionalArrowsNode from '../../wavepacket/view/HorizontalDimensionalArrowsNode.js';
import FMWColors from '../FMWColors.js';
import FMWConstants from '../FMWConstants.js';
import EmphasizedHarmonics from '../model/EmphasizedHarmonics.js';
import Harmonic from '../model/Harmonic.js';
import AmplitudeSlider from './AmplitudeSlider.js';
const FMWIconFactory = {
  /**
   * Creates the Home screen icon for the 'Discrete' screen.
   * @returns {ScreenIcon}
   * @public
   */
  createDiscreteHomeScreenIcon() {
    // AmplitudeSlider requires the range to be symmetric. So we're using a mixture of positive and negative
    // amplitudes to fill the vertical space.
    const amplitudes = [1, -0.85, 0.65, 0.3];
    const amplitudeRange = new Range(-1, 1);
    const iconNode = createSlidersIcon(amplitudes, amplitudeRange);
    return new ScreenIcon(iconNode, {
      fill: FMWColors.discreteScreenBackgroundColorProperty
    });
  },
  /**
   * Creates the Home screen icon for the 'Wave Game' screen.
   * @returns {ScreenIcon}
   * @public
   */
  createWaveGameHomeScreenIcon() {
    const iconNode = new PointsAwardedNode();
    return new ScreenIcon(iconNode, {
      fill: FMWColors.waveGameScreenBackgroundColorProperty
    });
  },
  /**
   * Creates the Home screen icon for the 'Wave Packet' screen.
   * @returns {ScreenIcon}
   * @public
   */
  createWavePacketHomeScreenIcon() {
    const iconNode = new Image(wavePacketHomeScreenIcon_png);
    return new ScreenIcon(iconNode, {
      fill: FMWColors.wavePacketScreenBackgroundColorProperty
    });
  },
  /**
   * Creates the icon that appears on a level-selection button in Wave Game.
   * It shows amplitude sliders, where the number of sliders equals the level number.
   * @param {number} levelNumber
   * @param {number} numberOfLevels
   * @returns {Node}
   * @public
   */
  createLevelSelectionButtonIcon(levelNumber, numberOfLevels) {
    // AmplitudeSlider requires the range to be symmetric. We're only going to use positive amplitudes here,
    // so that the level number can be centered in the space below the x axis.
    const possibleAmplitudes = [1, 0.5, 0.75, 1, 0.85];
    assert && assert(numberOfLevels <= possibleAmplitudes.length);
    assert && assert(_.every(possibleAmplitudes, amplitude => amplitude > 0));
    const amplitudeRange = new Range(-1, 1);
    const amplitudes = possibleAmplitudes.slice(0, levelNumber);

    // Pick some values that look nice. Generally the icons should be wider than they are tall.
    const iconWidth = 200;
    const iconHeight = 150;

    // Invisible rectangle, for constraining and laying out other subcomponents.
    const rectangle = new Rectangle(0, 0, iconWidth, iconHeight);

    // Create sliders
    const slidersIcon = createSlidersIcon(amplitudes, amplitudeRange, {
      maxWidth: rectangle.width,
      maxHeight: rectangle.height,
      center: rectangle.center
    });

    // Level number
    const levelString = levelNumber === numberOfLevels ? `${levelNumber}+` : `${levelNumber}`;
    const levelNode = new Text(levelString, {
      font: new PhetFont(200),
      maxWidth: rectangle.width,
      maxHeight: 0.4 * rectangle.height,
      centerX: rectangle.centerX,
      bottom: rectangle.bottom
    });
    return new Node({
      children: [rectangle, slidersIcon, levelNode],
      pdomVisible: false // so that focus traversal does not visit subcomponents of this icon
    });
  },

  /**
   * Creates the icon for the 'Width Indicators' checkbox
   * @returns {Node}
   * @public
   */
  createWidthIndicatorsIcon() {
    return new HorizontalDimensionalArrowsNode({
      x1: 0,
      x2: 45,
      color: FMWColors.widthIndicatorsColorProperty
    });
  }
};

/**
 * Creates an icon that contains one or more amplitude spinners, with an x axis.
 * @param {number[]} amplitudes
 * @param {Range} amplitudeRange
 * @param {Object} [options]
 */
function createSlidersIcon(amplitudes, amplitudeRange, options) {
  assert && assert(amplitudes.length < FMWConstants.MAX_HARMONICS);
  assert && assert(_.every(amplitudes, amplitude => amplitudeRange.contains(amplitude)));

  // Create harmonics
  const harmonics = amplitudes.map((amplitude, index) => new Harmonic({
    order: index + 1,
    frequency: 1,
    wavelength: 1,
    amplitudeRange: amplitudeRange,
    amplitude: amplitude,
    colorProperty: FMWColors.HARMONIC_COLOR_PROPERTIES[index],
    tandem: Tandem.OPT_OUT
  }));

  // Create sliders
  const emphasizedHarmonics = new EmphasizedHarmonics();
  const sliders = new HBox({
    spacing: 10,
    children: harmonics.map(harmonic => new AmplitudeSlider(harmonic, emphasizedHarmonics, {
      // Remove the PDOM content after creation to keep these input sliders out of the PDOM entirely, see https://github.com/phetsims/ratio-and-proportion/issues/444
      tagName: null
    }), {
      tandem: Tandem.OPT_OUT
    })
  });

  // x axis
  const xMargin = 10;
  const xAxis = new Line(-xMargin, sliders.height / 2, sliders.width + xMargin, sliders.height / 2, {
    stroke: FMWColors.axisStrokeProperty,
    lineWidth: 2
  });

  // Note that we could use node.rasterized( { resolution: 2 } ) to avoid memory, phet-io, and pdom issues
  // associated with all of the above elements. But the quality of the rendering is not as good.
  return new Node(merge({}, {
    children: [xAxis, sliders]
  }, options));
}
fourierMakingWaves.register('FMWIconFactory', FMWIconFactory);
export default FMWIconFactory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSYW5nZSIsIlNjcmVlbkljb24iLCJtZXJnZSIsIlBoZXRGb250IiwiSEJveCIsIkltYWdlIiwiTGluZSIsIk5vZGUiLCJSZWN0YW5nbGUiLCJUZXh0IiwiVGFuZGVtIiwid2F2ZVBhY2tldEhvbWVTY3JlZW5JY29uX3BuZyIsImZvdXJpZXJNYWtpbmdXYXZlcyIsIlBvaW50c0F3YXJkZWROb2RlIiwiSG9yaXpvbnRhbERpbWVuc2lvbmFsQXJyb3dzTm9kZSIsIkZNV0NvbG9ycyIsIkZNV0NvbnN0YW50cyIsIkVtcGhhc2l6ZWRIYXJtb25pY3MiLCJIYXJtb25pYyIsIkFtcGxpdHVkZVNsaWRlciIsIkZNV0ljb25GYWN0b3J5IiwiY3JlYXRlRGlzY3JldGVIb21lU2NyZWVuSWNvbiIsImFtcGxpdHVkZXMiLCJhbXBsaXR1ZGVSYW5nZSIsImljb25Ob2RlIiwiY3JlYXRlU2xpZGVyc0ljb24iLCJmaWxsIiwiZGlzY3JldGVTY3JlZW5CYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSIsImNyZWF0ZVdhdmVHYW1lSG9tZVNjcmVlbkljb24iLCJ3YXZlR2FtZVNjcmVlbkJhY2tncm91bmRDb2xvclByb3BlcnR5IiwiY3JlYXRlV2F2ZVBhY2tldEhvbWVTY3JlZW5JY29uIiwid2F2ZVBhY2tldFNjcmVlbkJhY2tncm91bmRDb2xvclByb3BlcnR5IiwiY3JlYXRlTGV2ZWxTZWxlY3Rpb25CdXR0b25JY29uIiwibGV2ZWxOdW1iZXIiLCJudW1iZXJPZkxldmVscyIsInBvc3NpYmxlQW1wbGl0dWRlcyIsImFzc2VydCIsImxlbmd0aCIsIl8iLCJldmVyeSIsImFtcGxpdHVkZSIsInNsaWNlIiwiaWNvbldpZHRoIiwiaWNvbkhlaWdodCIsInJlY3RhbmdsZSIsInNsaWRlcnNJY29uIiwibWF4V2lkdGgiLCJ3aWR0aCIsIm1heEhlaWdodCIsImhlaWdodCIsImNlbnRlciIsImxldmVsU3RyaW5nIiwibGV2ZWxOb2RlIiwiZm9udCIsImNlbnRlclgiLCJib3R0b20iLCJjaGlsZHJlbiIsInBkb21WaXNpYmxlIiwiY3JlYXRlV2lkdGhJbmRpY2F0b3JzSWNvbiIsIngxIiwieDIiLCJjb2xvciIsIndpZHRoSW5kaWNhdG9yc0NvbG9yUHJvcGVydHkiLCJvcHRpb25zIiwiTUFYX0hBUk1PTklDUyIsImNvbnRhaW5zIiwiaGFybW9uaWNzIiwibWFwIiwiaW5kZXgiLCJvcmRlciIsImZyZXF1ZW5jeSIsIndhdmVsZW5ndGgiLCJjb2xvclByb3BlcnR5IiwiSEFSTU9OSUNfQ09MT1JfUFJPUEVSVElFUyIsInRhbmRlbSIsIk9QVF9PVVQiLCJlbXBoYXNpemVkSGFybW9uaWNzIiwic2xpZGVycyIsInNwYWNpbmciLCJoYXJtb25pYyIsInRhZ05hbWUiLCJ4TWFyZ2luIiwieEF4aXMiLCJzdHJva2UiLCJheGlzU3Ryb2tlUHJvcGVydHkiLCJsaW5lV2lkdGgiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkZNV0ljb25GYWN0b3J5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIxLTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEZNV0ljb25GYWN0b3J5IGNvbnRhaW5zIGZhY3RvcnkgbWV0aG9kcyBmb3IgY3JlYXRpbmcgdGhlIGljb25zIG5lZWRlZCB0aHJvdWdob3V0IHRoaXMgc2ltJ3MgdXNlciBpbnRlcmZhY2UuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IFJhbmdlIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9SYW5nZS5qcyc7XHJcbmltcG9ydCBTY3JlZW5JY29uIGZyb20gJy4uLy4uLy4uLy4uL2pvaXN0L2pzL1NjcmVlbkljb24uanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IEhCb3gsIEltYWdlLCBMaW5lLCBOb2RlLCBSZWN0YW5nbGUsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgd2F2ZVBhY2tldEhvbWVTY3JlZW5JY29uX3BuZyBmcm9tICcuLi8uLi8uLi9pbWFnZXMvd2F2ZVBhY2tldEhvbWVTY3JlZW5JY29uX3BuZy5qcyc7XHJcbmltcG9ydCBmb3VyaWVyTWFraW5nV2F2ZXMgZnJvbSAnLi4vLi4vZm91cmllck1ha2luZ1dhdmVzLmpzJztcclxuaW1wb3J0IFBvaW50c0F3YXJkZWROb2RlIGZyb20gJy4uLy4uL3dhdmVHYW1lL3ZpZXcvUG9pbnRzQXdhcmRlZE5vZGUuanMnO1xyXG5pbXBvcnQgSG9yaXpvbnRhbERpbWVuc2lvbmFsQXJyb3dzTm9kZSBmcm9tICcuLi8uLi93YXZlcGFja2V0L3ZpZXcvSG9yaXpvbnRhbERpbWVuc2lvbmFsQXJyb3dzTm9kZS5qcyc7XHJcbmltcG9ydCBGTVdDb2xvcnMgZnJvbSAnLi4vRk1XQ29sb3JzLmpzJztcclxuaW1wb3J0IEZNV0NvbnN0YW50cyBmcm9tICcuLi9GTVdDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgRW1waGFzaXplZEhhcm1vbmljcyBmcm9tICcuLi9tb2RlbC9FbXBoYXNpemVkSGFybW9uaWNzLmpzJztcclxuaW1wb3J0IEhhcm1vbmljIGZyb20gJy4uL21vZGVsL0hhcm1vbmljLmpzJztcclxuaW1wb3J0IEFtcGxpdHVkZVNsaWRlciBmcm9tICcuL0FtcGxpdHVkZVNsaWRlci5qcyc7XHJcblxyXG5jb25zdCBGTVdJY29uRmFjdG9yeSA9IHtcclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyB0aGUgSG9tZSBzY3JlZW4gaWNvbiBmb3IgdGhlICdEaXNjcmV0ZScgc2NyZWVuLlxyXG4gICAqIEByZXR1cm5zIHtTY3JlZW5JY29ufVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBjcmVhdGVEaXNjcmV0ZUhvbWVTY3JlZW5JY29uKCkge1xyXG4gICAgLy8gQW1wbGl0dWRlU2xpZGVyIHJlcXVpcmVzIHRoZSByYW5nZSB0byBiZSBzeW1tZXRyaWMuIFNvIHdlJ3JlIHVzaW5nIGEgbWl4dHVyZSBvZiBwb3NpdGl2ZSBhbmQgbmVnYXRpdmVcclxuICAgIC8vIGFtcGxpdHVkZXMgdG8gZmlsbCB0aGUgdmVydGljYWwgc3BhY2UuXHJcbiAgICBjb25zdCBhbXBsaXR1ZGVzID0gWyAxLCAtMC44NSwgMC42NSwgMC4zIF07XHJcbiAgICBjb25zdCBhbXBsaXR1ZGVSYW5nZSA9IG5ldyBSYW5nZSggLTEsIDEgKTtcclxuICAgIGNvbnN0IGljb25Ob2RlID0gY3JlYXRlU2xpZGVyc0ljb24oIGFtcGxpdHVkZXMsIGFtcGxpdHVkZVJhbmdlICk7XHJcbiAgICByZXR1cm4gbmV3IFNjcmVlbkljb24oIGljb25Ob2RlLCB7XHJcbiAgICAgIGZpbGw6IEZNV0NvbG9ycy5kaXNjcmV0ZVNjcmVlbkJhY2tncm91bmRDb2xvclByb3BlcnR5XHJcbiAgICB9ICk7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyB0aGUgSG9tZSBzY3JlZW4gaWNvbiBmb3IgdGhlICdXYXZlIEdhbWUnIHNjcmVlbi5cclxuICAgKiBAcmV0dXJucyB7U2NyZWVuSWNvbn1cclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgY3JlYXRlV2F2ZUdhbWVIb21lU2NyZWVuSWNvbigpIHtcclxuICAgIGNvbnN0IGljb25Ob2RlID0gbmV3IFBvaW50c0F3YXJkZWROb2RlKCk7XHJcbiAgICByZXR1cm4gbmV3IFNjcmVlbkljb24oIGljb25Ob2RlLCB7XHJcbiAgICAgIGZpbGw6IEZNV0NvbG9ycy53YXZlR2FtZVNjcmVlbkJhY2tncm91bmRDb2xvclByb3BlcnR5XHJcbiAgICB9ICk7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyB0aGUgSG9tZSBzY3JlZW4gaWNvbiBmb3IgdGhlICdXYXZlIFBhY2tldCcgc2NyZWVuLlxyXG4gICAqIEByZXR1cm5zIHtTY3JlZW5JY29ufVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBjcmVhdGVXYXZlUGFja2V0SG9tZVNjcmVlbkljb24oKSB7XHJcbiAgICBjb25zdCBpY29uTm9kZSA9IG5ldyBJbWFnZSggd2F2ZVBhY2tldEhvbWVTY3JlZW5JY29uX3BuZyApO1xyXG4gICAgcmV0dXJuIG5ldyBTY3JlZW5JY29uKCBpY29uTm9kZSwge1xyXG4gICAgICBmaWxsOiBGTVdDb2xvcnMud2F2ZVBhY2tldFNjcmVlbkJhY2tncm91bmRDb2xvclByb3BlcnR5XHJcbiAgICB9ICk7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyB0aGUgaWNvbiB0aGF0IGFwcGVhcnMgb24gYSBsZXZlbC1zZWxlY3Rpb24gYnV0dG9uIGluIFdhdmUgR2FtZS5cclxuICAgKiBJdCBzaG93cyBhbXBsaXR1ZGUgc2xpZGVycywgd2hlcmUgdGhlIG51bWJlciBvZiBzbGlkZXJzIGVxdWFscyB0aGUgbGV2ZWwgbnVtYmVyLlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBsZXZlbE51bWJlclxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBudW1iZXJPZkxldmVsc1xyXG4gICAqIEByZXR1cm5zIHtOb2RlfVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBjcmVhdGVMZXZlbFNlbGVjdGlvbkJ1dHRvbkljb24oIGxldmVsTnVtYmVyLCBudW1iZXJPZkxldmVscyApIHtcclxuXHJcbiAgICAvLyBBbXBsaXR1ZGVTbGlkZXIgcmVxdWlyZXMgdGhlIHJhbmdlIHRvIGJlIHN5bW1ldHJpYy4gV2UncmUgb25seSBnb2luZyB0byB1c2UgcG9zaXRpdmUgYW1wbGl0dWRlcyBoZXJlLFxyXG4gICAgLy8gc28gdGhhdCB0aGUgbGV2ZWwgbnVtYmVyIGNhbiBiZSBjZW50ZXJlZCBpbiB0aGUgc3BhY2UgYmVsb3cgdGhlIHggYXhpcy5cclxuICAgIGNvbnN0IHBvc3NpYmxlQW1wbGl0dWRlcyA9IFsgMSwgMC41LCAwLjc1LCAxLCAwLjg1IF07XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBudW1iZXJPZkxldmVscyA8PSBwb3NzaWJsZUFtcGxpdHVkZXMubGVuZ3RoICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBfLmV2ZXJ5KCBwb3NzaWJsZUFtcGxpdHVkZXMsIGFtcGxpdHVkZSA9PiBhbXBsaXR1ZGUgPiAwICkgKTtcclxuXHJcbiAgICBjb25zdCBhbXBsaXR1ZGVSYW5nZSA9IG5ldyBSYW5nZSggLTEsIDEgKTtcclxuICAgIGNvbnN0IGFtcGxpdHVkZXMgPSBwb3NzaWJsZUFtcGxpdHVkZXMuc2xpY2UoIDAsIGxldmVsTnVtYmVyICk7XHJcblxyXG4gICAgLy8gUGljayBzb21lIHZhbHVlcyB0aGF0IGxvb2sgbmljZS4gR2VuZXJhbGx5IHRoZSBpY29ucyBzaG91bGQgYmUgd2lkZXIgdGhhbiB0aGV5IGFyZSB0YWxsLlxyXG4gICAgY29uc3QgaWNvbldpZHRoID0gMjAwO1xyXG4gICAgY29uc3QgaWNvbkhlaWdodCA9IDE1MDtcclxuXHJcbiAgICAvLyBJbnZpc2libGUgcmVjdGFuZ2xlLCBmb3IgY29uc3RyYWluaW5nIGFuZCBsYXlpbmcgb3V0IG90aGVyIHN1YmNvbXBvbmVudHMuXHJcbiAgICBjb25zdCByZWN0YW5nbGUgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCBpY29uV2lkdGgsIGljb25IZWlnaHQgKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgc2xpZGVyc1xyXG4gICAgY29uc3Qgc2xpZGVyc0ljb24gPSBjcmVhdGVTbGlkZXJzSWNvbiggYW1wbGl0dWRlcywgYW1wbGl0dWRlUmFuZ2UsIHtcclxuICAgICAgbWF4V2lkdGg6IHJlY3RhbmdsZS53aWR0aCxcclxuICAgICAgbWF4SGVpZ2h0OiByZWN0YW5nbGUuaGVpZ2h0LFxyXG4gICAgICBjZW50ZXI6IHJlY3RhbmdsZS5jZW50ZXJcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBMZXZlbCBudW1iZXJcclxuICAgIGNvbnN0IGxldmVsU3RyaW5nID0gKCBsZXZlbE51bWJlciA9PT0gbnVtYmVyT2ZMZXZlbHMgKSA/IGAke2xldmVsTnVtYmVyfStgIDogYCR7bGV2ZWxOdW1iZXJ9YDtcclxuICAgIGNvbnN0IGxldmVsTm9kZSA9IG5ldyBUZXh0KCBsZXZlbFN0cmluZywge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIDIwMCApLFxyXG4gICAgICBtYXhXaWR0aDogcmVjdGFuZ2xlLndpZHRoLFxyXG4gICAgICBtYXhIZWlnaHQ6IDAuNCAqIHJlY3RhbmdsZS5oZWlnaHQsXHJcbiAgICAgIGNlbnRlclg6IHJlY3RhbmdsZS5jZW50ZXJYLFxyXG4gICAgICBib3R0b206IHJlY3RhbmdsZS5ib3R0b21cclxuICAgIH0gKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IE5vZGUoIHtcclxuICAgICAgY2hpbGRyZW46IFsgcmVjdGFuZ2xlLCBzbGlkZXJzSWNvbiwgbGV2ZWxOb2RlIF0sXHJcbiAgICAgIHBkb21WaXNpYmxlOiBmYWxzZSAvLyBzbyB0aGF0IGZvY3VzIHRyYXZlcnNhbCBkb2VzIG5vdCB2aXNpdCBzdWJjb21wb25lbnRzIG9mIHRoaXMgaWNvblxyXG4gICAgfSApO1xyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgdGhlIGljb24gZm9yIHRoZSAnV2lkdGggSW5kaWNhdG9ycycgY2hlY2tib3hcclxuICAgKiBAcmV0dXJucyB7Tm9kZX1cclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgY3JlYXRlV2lkdGhJbmRpY2F0b3JzSWNvbigpIHtcclxuICAgIHJldHVybiBuZXcgSG9yaXpvbnRhbERpbWVuc2lvbmFsQXJyb3dzTm9kZSgge1xyXG4gICAgICB4MTogMCxcclxuICAgICAgeDI6IDQ1LFxyXG4gICAgICBjb2xvcjogRk1XQ29sb3JzLndpZHRoSW5kaWNhdG9yc0NvbG9yUHJvcGVydHlcclxuICAgIH0gKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhbiBpY29uIHRoYXQgY29udGFpbnMgb25lIG9yIG1vcmUgYW1wbGl0dWRlIHNwaW5uZXJzLCB3aXRoIGFuIHggYXhpcy5cclxuICogQHBhcmFtIHtudW1iZXJbXX0gYW1wbGl0dWRlc1xyXG4gKiBAcGFyYW0ge1JhbmdlfSBhbXBsaXR1ZGVSYW5nZVxyXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVTbGlkZXJzSWNvbiggYW1wbGl0dWRlcywgYW1wbGl0dWRlUmFuZ2UsIG9wdGlvbnMgKSB7XHJcblxyXG4gIGFzc2VydCAmJiBhc3NlcnQoIGFtcGxpdHVkZXMubGVuZ3RoIDwgRk1XQ29uc3RhbnRzLk1BWF9IQVJNT05JQ1MgKTtcclxuICBhc3NlcnQgJiYgYXNzZXJ0KCBfLmV2ZXJ5KCBhbXBsaXR1ZGVzLCBhbXBsaXR1ZGUgPT4gYW1wbGl0dWRlUmFuZ2UuY29udGFpbnMoIGFtcGxpdHVkZSApICkgKTtcclxuXHJcbiAgLy8gQ3JlYXRlIGhhcm1vbmljc1xyXG4gIGNvbnN0IGhhcm1vbmljcyA9IGFtcGxpdHVkZXMubWFwKCAoIGFtcGxpdHVkZSwgaW5kZXggKSA9PiBuZXcgSGFybW9uaWMoIHtcclxuICAgIG9yZGVyOiBpbmRleCArIDEsXHJcbiAgICBmcmVxdWVuY3k6IDEsXHJcbiAgICB3YXZlbGVuZ3RoOiAxLFxyXG4gICAgYW1wbGl0dWRlUmFuZ2U6IGFtcGxpdHVkZVJhbmdlLFxyXG4gICAgYW1wbGl0dWRlOiBhbXBsaXR1ZGUsXHJcbiAgICBjb2xvclByb3BlcnR5OiBGTVdDb2xvcnMuSEFSTU9OSUNfQ09MT1JfUFJPUEVSVElFU1sgaW5kZXggXSxcclxuICAgIHRhbmRlbTogVGFuZGVtLk9QVF9PVVRcclxuICB9ICkgKTtcclxuXHJcbiAgLy8gQ3JlYXRlIHNsaWRlcnNcclxuICBjb25zdCBlbXBoYXNpemVkSGFybW9uaWNzID0gbmV3IEVtcGhhc2l6ZWRIYXJtb25pY3MoKTtcclxuICBjb25zdCBzbGlkZXJzID0gbmV3IEhCb3goIHtcclxuICAgIHNwYWNpbmc6IDEwLFxyXG4gICAgY2hpbGRyZW46IGhhcm1vbmljcy5tYXAoIGhhcm1vbmljID0+IG5ldyBBbXBsaXR1ZGVTbGlkZXIoIGhhcm1vbmljLCBlbXBoYXNpemVkSGFybW9uaWNzLCB7XHJcblxyXG4gICAgICAvLyBSZW1vdmUgdGhlIFBET00gY29udGVudCBhZnRlciBjcmVhdGlvbiB0byBrZWVwIHRoZXNlIGlucHV0IHNsaWRlcnMgb3V0IG9mIHRoZSBQRE9NIGVudGlyZWx5LCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3JhdGlvLWFuZC1wcm9wb3J0aW9uL2lzc3Vlcy80NDRcclxuICAgICAgdGFnTmFtZTogbnVsbFxyXG4gICAgfSApLCB7XHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLk9QVF9PVVRcclxuICAgIH0gKVxyXG4gIH0gKTtcclxuXHJcbiAgLy8geCBheGlzXHJcbiAgY29uc3QgeE1hcmdpbiA9IDEwO1xyXG4gIGNvbnN0IHhBeGlzID0gbmV3IExpbmUoIC14TWFyZ2luLCBzbGlkZXJzLmhlaWdodCAvIDIsIHNsaWRlcnMud2lkdGggKyB4TWFyZ2luLCBzbGlkZXJzLmhlaWdodCAvIDIsIHtcclxuICAgIHN0cm9rZTogRk1XQ29sb3JzLmF4aXNTdHJva2VQcm9wZXJ0eSxcclxuICAgIGxpbmVXaWR0aDogMlxyXG4gIH0gKTtcclxuXHJcbiAgLy8gTm90ZSB0aGF0IHdlIGNvdWxkIHVzZSBub2RlLnJhc3Rlcml6ZWQoIHsgcmVzb2x1dGlvbjogMiB9ICkgdG8gYXZvaWQgbWVtb3J5LCBwaGV0LWlvLCBhbmQgcGRvbSBpc3N1ZXNcclxuICAvLyBhc3NvY2lhdGVkIHdpdGggYWxsIG9mIHRoZSBhYm92ZSBlbGVtZW50cy4gQnV0IHRoZSBxdWFsaXR5IG9mIHRoZSByZW5kZXJpbmcgaXMgbm90IGFzIGdvb2QuXHJcbiAgcmV0dXJuIG5ldyBOb2RlKCBtZXJnZSgge30sIHtcclxuICAgIGNoaWxkcmVuOiBbIHhBeGlzLCBzbGlkZXJzIF1cclxuICB9LCBvcHRpb25zICkgKTtcclxufVxyXG5cclxuZm91cmllck1ha2luZ1dhdmVzLnJlZ2lzdGVyKCAnRk1XSWNvbkZhY3RvcnknLCBGTVdJY29uRmFjdG9yeSApO1xyXG5leHBvcnQgZGVmYXVsdCBGTVdJY29uRmFjdG9yeTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxVQUFVLE1BQU0sb0NBQW9DO0FBQzNELE9BQU9DLEtBQUssTUFBTSxtQ0FBbUM7QUFDckQsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxJQUFJLEVBQUVDLEtBQUssRUFBRUMsSUFBSSxFQUFFQyxJQUFJLEVBQUVDLFNBQVMsRUFBRUMsSUFBSSxRQUFRLG1DQUFtQztBQUM1RixPQUFPQyxNQUFNLE1BQU0saUNBQWlDO0FBQ3BELE9BQU9DLDRCQUE0QixNQUFNLGlEQUFpRDtBQUMxRixPQUFPQyxrQkFBa0IsTUFBTSw2QkFBNkI7QUFDNUQsT0FBT0MsaUJBQWlCLE1BQU0sMENBQTBDO0FBQ3hFLE9BQU9DLCtCQUErQixNQUFNLDBEQUEwRDtBQUN0RyxPQUFPQyxTQUFTLE1BQU0saUJBQWlCO0FBQ3ZDLE9BQU9DLFlBQVksTUFBTSxvQkFBb0I7QUFDN0MsT0FBT0MsbUJBQW1CLE1BQU0saUNBQWlDO0FBQ2pFLE9BQU9DLFFBQVEsTUFBTSxzQkFBc0I7QUFDM0MsT0FBT0MsZUFBZSxNQUFNLHNCQUFzQjtBQUVsRCxNQUFNQyxjQUFjLEdBQUc7RUFFckI7QUFDRjtBQUNBO0FBQ0E7QUFDQTtFQUNFQyw0QkFBNEJBLENBQUEsRUFBRztJQUM3QjtJQUNBO0lBQ0EsTUFBTUMsVUFBVSxHQUFHLENBQUUsQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxHQUFHLENBQUU7SUFDMUMsTUFBTUMsY0FBYyxHQUFHLElBQUl2QixLQUFLLENBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBRSxDQUFDO0lBQ3pDLE1BQU13QixRQUFRLEdBQUdDLGlCQUFpQixDQUFFSCxVQUFVLEVBQUVDLGNBQWUsQ0FBQztJQUNoRSxPQUFPLElBQUl0QixVQUFVLENBQUV1QixRQUFRLEVBQUU7TUFDL0JFLElBQUksRUFBRVgsU0FBUyxDQUFDWTtJQUNsQixDQUFFLENBQUM7RUFDTCxDQUFDO0VBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtFQUNFQyw0QkFBNEJBLENBQUEsRUFBRztJQUM3QixNQUFNSixRQUFRLEdBQUcsSUFBSVgsaUJBQWlCLENBQUMsQ0FBQztJQUN4QyxPQUFPLElBQUlaLFVBQVUsQ0FBRXVCLFFBQVEsRUFBRTtNQUMvQkUsSUFBSSxFQUFFWCxTQUFTLENBQUNjO0lBQ2xCLENBQUUsQ0FBQztFQUNMLENBQUM7RUFFRDtBQUNGO0FBQ0E7QUFDQTtBQUNBO0VBQ0VDLDhCQUE4QkEsQ0FBQSxFQUFHO0lBQy9CLE1BQU1OLFFBQVEsR0FBRyxJQUFJbkIsS0FBSyxDQUFFTSw0QkFBNkIsQ0FBQztJQUMxRCxPQUFPLElBQUlWLFVBQVUsQ0FBRXVCLFFBQVEsRUFBRTtNQUMvQkUsSUFBSSxFQUFFWCxTQUFTLENBQUNnQjtJQUNsQixDQUFFLENBQUM7RUFDTCxDQUFDO0VBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFQyw4QkFBOEJBLENBQUVDLFdBQVcsRUFBRUMsY0FBYyxFQUFHO0lBRTVEO0lBQ0E7SUFDQSxNQUFNQyxrQkFBa0IsR0FBRyxDQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUU7SUFDcERDLE1BQU0sSUFBSUEsTUFBTSxDQUFFRixjQUFjLElBQUlDLGtCQUFrQixDQUFDRSxNQUFPLENBQUM7SUFDL0RELE1BQU0sSUFBSUEsTUFBTSxDQUFFRSxDQUFDLENBQUNDLEtBQUssQ0FBRUosa0JBQWtCLEVBQUVLLFNBQVMsSUFBSUEsU0FBUyxHQUFHLENBQUUsQ0FBRSxDQUFDO0lBRTdFLE1BQU1qQixjQUFjLEdBQUcsSUFBSXZCLEtBQUssQ0FBRSxDQUFDLENBQUMsRUFBRSxDQUFFLENBQUM7SUFDekMsTUFBTXNCLFVBQVUsR0FBR2Esa0JBQWtCLENBQUNNLEtBQUssQ0FBRSxDQUFDLEVBQUVSLFdBQVksQ0FBQzs7SUFFN0Q7SUFDQSxNQUFNUyxTQUFTLEdBQUcsR0FBRztJQUNyQixNQUFNQyxVQUFVLEdBQUcsR0FBRzs7SUFFdEI7SUFDQSxNQUFNQyxTQUFTLEdBQUcsSUFBSXBDLFNBQVMsQ0FBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFa0MsU0FBUyxFQUFFQyxVQUFXLENBQUM7O0lBRTlEO0lBQ0EsTUFBTUUsV0FBVyxHQUFHcEIsaUJBQWlCLENBQUVILFVBQVUsRUFBRUMsY0FBYyxFQUFFO01BQ2pFdUIsUUFBUSxFQUFFRixTQUFTLENBQUNHLEtBQUs7TUFDekJDLFNBQVMsRUFBRUosU0FBUyxDQUFDSyxNQUFNO01BQzNCQyxNQUFNLEVBQUVOLFNBQVMsQ0FBQ007SUFDcEIsQ0FBRSxDQUFDOztJQUVIO0lBQ0EsTUFBTUMsV0FBVyxHQUFLbEIsV0FBVyxLQUFLQyxjQUFjLEdBQU0sR0FBRUQsV0FBWSxHQUFFLEdBQUksR0FBRUEsV0FBWSxFQUFDO0lBQzdGLE1BQU1tQixTQUFTLEdBQUcsSUFBSTNDLElBQUksQ0FBRTBDLFdBQVcsRUFBRTtNQUN2Q0UsSUFBSSxFQUFFLElBQUlsRCxRQUFRLENBQUUsR0FBSSxDQUFDO01BQ3pCMkMsUUFBUSxFQUFFRixTQUFTLENBQUNHLEtBQUs7TUFDekJDLFNBQVMsRUFBRSxHQUFHLEdBQUdKLFNBQVMsQ0FBQ0ssTUFBTTtNQUNqQ0ssT0FBTyxFQUFFVixTQUFTLENBQUNVLE9BQU87TUFDMUJDLE1BQU0sRUFBRVgsU0FBUyxDQUFDVztJQUNwQixDQUFFLENBQUM7SUFFSCxPQUFPLElBQUloRCxJQUFJLENBQUU7TUFDZmlELFFBQVEsRUFBRSxDQUFFWixTQUFTLEVBQUVDLFdBQVcsRUFBRU8sU0FBUyxDQUFFO01BQy9DSyxXQUFXLEVBQUUsS0FBSyxDQUFDO0lBQ3JCLENBQUUsQ0FBQztFQUNMLENBQUM7O0VBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtFQUNFQyx5QkFBeUJBLENBQUEsRUFBRztJQUMxQixPQUFPLElBQUk1QywrQkFBK0IsQ0FBRTtNQUMxQzZDLEVBQUUsRUFBRSxDQUFDO01BQ0xDLEVBQUUsRUFBRSxFQUFFO01BQ05DLEtBQUssRUFBRTlDLFNBQVMsQ0FBQytDO0lBQ25CLENBQUUsQ0FBQztFQUNMO0FBQ0YsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTckMsaUJBQWlCQSxDQUFFSCxVQUFVLEVBQUVDLGNBQWMsRUFBRXdDLE9BQU8sRUFBRztFQUVoRTNCLE1BQU0sSUFBSUEsTUFBTSxDQUFFZCxVQUFVLENBQUNlLE1BQU0sR0FBR3JCLFlBQVksQ0FBQ2dELGFBQWMsQ0FBQztFQUNsRTVCLE1BQU0sSUFBSUEsTUFBTSxDQUFFRSxDQUFDLENBQUNDLEtBQUssQ0FBRWpCLFVBQVUsRUFBRWtCLFNBQVMsSUFBSWpCLGNBQWMsQ0FBQzBDLFFBQVEsQ0FBRXpCLFNBQVUsQ0FBRSxDQUFFLENBQUM7O0VBRTVGO0VBQ0EsTUFBTTBCLFNBQVMsR0FBRzVDLFVBQVUsQ0FBQzZDLEdBQUcsQ0FBRSxDQUFFM0IsU0FBUyxFQUFFNEIsS0FBSyxLQUFNLElBQUlsRCxRQUFRLENBQUU7SUFDdEVtRCxLQUFLLEVBQUVELEtBQUssR0FBRyxDQUFDO0lBQ2hCRSxTQUFTLEVBQUUsQ0FBQztJQUNaQyxVQUFVLEVBQUUsQ0FBQztJQUNiaEQsY0FBYyxFQUFFQSxjQUFjO0lBQzlCaUIsU0FBUyxFQUFFQSxTQUFTO0lBQ3BCZ0MsYUFBYSxFQUFFekQsU0FBUyxDQUFDMEQseUJBQXlCLENBQUVMLEtBQUssQ0FBRTtJQUMzRE0sTUFBTSxFQUFFaEUsTUFBTSxDQUFDaUU7RUFDakIsQ0FBRSxDQUFFLENBQUM7O0VBRUw7RUFDQSxNQUFNQyxtQkFBbUIsR0FBRyxJQUFJM0QsbUJBQW1CLENBQUMsQ0FBQztFQUNyRCxNQUFNNEQsT0FBTyxHQUFHLElBQUl6RSxJQUFJLENBQUU7SUFDeEIwRSxPQUFPLEVBQUUsRUFBRTtJQUNYdEIsUUFBUSxFQUFFVSxTQUFTLENBQUNDLEdBQUcsQ0FBRVksUUFBUSxJQUFJLElBQUk1RCxlQUFlLENBQUU0RCxRQUFRLEVBQUVILG1CQUFtQixFQUFFO01BRXZGO01BQ0FJLE9BQU8sRUFBRTtJQUNYLENBQUUsQ0FBQyxFQUFFO01BQ0hOLE1BQU0sRUFBRWhFLE1BQU0sQ0FBQ2lFO0lBQ2pCLENBQUU7RUFDSixDQUFFLENBQUM7O0VBRUg7RUFDQSxNQUFNTSxPQUFPLEdBQUcsRUFBRTtFQUNsQixNQUFNQyxLQUFLLEdBQUcsSUFBSTVFLElBQUksQ0FBRSxDQUFDMkUsT0FBTyxFQUFFSixPQUFPLENBQUM1QixNQUFNLEdBQUcsQ0FBQyxFQUFFNEIsT0FBTyxDQUFDOUIsS0FBSyxHQUFHa0MsT0FBTyxFQUFFSixPQUFPLENBQUM1QixNQUFNLEdBQUcsQ0FBQyxFQUFFO0lBQ2pHa0MsTUFBTSxFQUFFcEUsU0FBUyxDQUFDcUUsa0JBQWtCO0lBQ3BDQyxTQUFTLEVBQUU7RUFDYixDQUFFLENBQUM7O0VBRUg7RUFDQTtFQUNBLE9BQU8sSUFBSTlFLElBQUksQ0FBRUwsS0FBSyxDQUFFLENBQUMsQ0FBQyxFQUFFO0lBQzFCc0QsUUFBUSxFQUFFLENBQUUwQixLQUFLLEVBQUVMLE9BQU87RUFDNUIsQ0FBQyxFQUFFZCxPQUFRLENBQUUsQ0FBQztBQUNoQjtBQUVBbkQsa0JBQWtCLENBQUMwRSxRQUFRLENBQUUsZ0JBQWdCLEVBQUVsRSxjQUFlLENBQUM7QUFDL0QsZUFBZUEsY0FBYyJ9