// Copyright 2021-2023, University of Colorado Boulder

/**
 * SumSymbolNode displays a symbol that indicates a sum of quantities. It can use either the summation symbol
 * (sum of a small number of large quantities) or the integration symbol (sum of a large number of small quantities).
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Multilink from '../../../../axon/js/Multilink.js';
import merge from '../../../../phet-core/js/merge.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { HBox, Node, RichText, Text } from '../../../../scenery/js/imports.js';
import fourierMakingWaves from '../../fourierMakingWaves.js';
import FMWSymbols from '../FMWSymbols.js';

// constants
const DEFAULT_SYMBOL_FONT = new PhetFont(30);
const DEFAULT_N_EQUALS_FONT = new PhetFont(14);
const DEFAULT_MIN_MAX_FONT = new PhetFont(12);

// This extends Node instead of VBox so that the origin will be at the origin of symbolNode, useful for
// layout with other text.
export default class SumSymbolNode extends Node {
  /**
   * @param {TReadOnlyProperty.<string>} indexSymbolProperty - symbol for the index of summation
   * @param {number} indexMin - index min value
   * @param {Property.<number>} indexMaxProperty - index max value
   * @param {Object} [options]
   */
  constructor(indexSymbolProperty, indexMin, indexMaxProperty, options) {
    options = merge({
      // SumSymbolNode options
      integration: false,
      // true=integration, false=summation
      symbolFont: DEFAULT_SYMBOL_FONT,
      nEqualsFont: DEFAULT_N_EQUALS_FONT,
      // font for 'n ='
      minMaxFont: DEFAULT_MIN_MAX_FONT
    }, options);

    // The symbol for the type of sum.
    const symbolNode = new RichText('', {
      font: options.symbolFont
    });
    const nEqualsStringProperty = new DerivedProperty([indexSymbolProperty], indexSymbol => `${indexSymbol} ${MathSymbols.EQUAL_TO}&nbsp`);

    // Index and min (starting) value, which appears below the sum symbol. E.g. 'n = 0'
    // The 'n =' and '0' are separate Nodes so that we can tweak their font sizes separately.
    // See https://github.com/phetsims/fourier-making-waves/issues/186
    const nEqualsNode = new RichText(nEqualsStringProperty, {
      font: options.nEqualsFont
    });
    const minValueNode = new RichText('', {
      font: options.minMaxFont
    });
    const minNode = new HBox({
      spacing: 0,
      children: [nEqualsNode, minValueNode]
    });

    // Max (stopping) value, which appears above the sum symbol
    const maxValueNode = new Text('', {
      font: options.minMaxFont
    });
    assert && assert(!options.children, 'SumSymbolNode sets children');
    options.children = [maxValueNode, symbolNode, minNode];
    super(options);

    // @public true=integration, false=summation
    // dispose is required.
    this.integrationProperty = new BooleanProperty(options.integration);

    // Update the equation form and layout. dispose is required.
    const multilink = new Multilink([this.integrationProperty, indexMaxProperty, nEqualsNode.boundsProperty], (integration, indexMax, nEqualsBounds) => {
      // update text
      if (integration) {
        symbolNode.string = FMWSymbols.integral;
        minValueNode.string = indexToString(indexMin);
      } else {
        symbolNode.string = FMWSymbols.SIGMA;
        minValueNode.string = indexToString(indexMin);
      }
      maxValueNode.string = indexToString(indexMax);

      // update layout
      // WARNING - magic numbers herein were arrived at empirically, tuned because RichText bounds are inaccurate
      if (integration) {
        nEqualsNode.visible = false;
        minNode.left = symbolNode.right;
        minNode.bottom = symbolNode.bottom;
        maxValueNode.left = symbolNode.right + 3;
        maxValueNode.top = symbolNode.top - 5;
      } else {
        nEqualsNode.visible = true;
        minNode.centerX = symbolNode.centerX;
        minNode.top = symbolNode.bottom - 3;
        maxValueNode.centerX = symbolNode.centerX;
        maxValueNode.bottom = symbolNode.top + 5;
      }
    });

    // @private
    this.disposeSummationSymbolNode = () => {
      this.integrationProperty.dispose();
      multilink.dispose();
    };
  }

  /**
   * @public
   * @override
   */
  dispose() {
    this.disposeSummationSymbolNode();
    super.dispose();
  }
}

/**
 * Converts a summation index to a string.
 * @param {number} index
 * @returns {string}
 */
function indexToString(index) {
  if (index === Infinity) {
    return `${MathSymbols.INFINITY}`;
  } else if (index === -Infinity) {
    return `-${MathSymbols.INFINITY}`;
  } else {
    return `${index}`;
  }
}
fourierMakingWaves.register('SumSymbolNode', SumSymbolNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJEZXJpdmVkUHJvcGVydHkiLCJNdWx0aWxpbmsiLCJtZXJnZSIsIk1hdGhTeW1ib2xzIiwiUGhldEZvbnQiLCJIQm94IiwiTm9kZSIsIlJpY2hUZXh0IiwiVGV4dCIsImZvdXJpZXJNYWtpbmdXYXZlcyIsIkZNV1N5bWJvbHMiLCJERUZBVUxUX1NZTUJPTF9GT05UIiwiREVGQVVMVF9OX0VRVUFMU19GT05UIiwiREVGQVVMVF9NSU5fTUFYX0ZPTlQiLCJTdW1TeW1ib2xOb2RlIiwiY29uc3RydWN0b3IiLCJpbmRleFN5bWJvbFByb3BlcnR5IiwiaW5kZXhNaW4iLCJpbmRleE1heFByb3BlcnR5Iiwib3B0aW9ucyIsImludGVncmF0aW9uIiwic3ltYm9sRm9udCIsIm5FcXVhbHNGb250IiwibWluTWF4Rm9udCIsInN5bWJvbE5vZGUiLCJmb250IiwibkVxdWFsc1N0cmluZ1Byb3BlcnR5IiwiaW5kZXhTeW1ib2wiLCJFUVVBTF9UTyIsIm5FcXVhbHNOb2RlIiwibWluVmFsdWVOb2RlIiwibWluTm9kZSIsInNwYWNpbmciLCJjaGlsZHJlbiIsIm1heFZhbHVlTm9kZSIsImFzc2VydCIsImludGVncmF0aW9uUHJvcGVydHkiLCJtdWx0aWxpbmsiLCJib3VuZHNQcm9wZXJ0eSIsImluZGV4TWF4IiwibkVxdWFsc0JvdW5kcyIsInN0cmluZyIsImludGVncmFsIiwiaW5kZXhUb1N0cmluZyIsIlNJR01BIiwidmlzaWJsZSIsImxlZnQiLCJyaWdodCIsImJvdHRvbSIsInRvcCIsImNlbnRlclgiLCJkaXNwb3NlU3VtbWF0aW9uU3ltYm9sTm9kZSIsImRpc3Bvc2UiLCJpbmRleCIsIkluZmluaXR5IiwiSU5GSU5JVFkiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlN1bVN5bWJvbE5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjEtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogU3VtU3ltYm9sTm9kZSBkaXNwbGF5cyBhIHN5bWJvbCB0aGF0IGluZGljYXRlcyBhIHN1bSBvZiBxdWFudGl0aWVzLiBJdCBjYW4gdXNlIGVpdGhlciB0aGUgc3VtbWF0aW9uIHN5bWJvbFxyXG4gKiAoc3VtIG9mIGEgc21hbGwgbnVtYmVyIG9mIGxhcmdlIHF1YW50aXRpZXMpIG9yIHRoZSBpbnRlZ3JhdGlvbiBzeW1ib2wgKHN1bSBvZiBhIGxhcmdlIG51bWJlciBvZiBzbWFsbCBxdWFudGl0aWVzKS5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBNdWx0aWxpbmsgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9NdWx0aWxpbmsuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IE1hdGhTeW1ib2xzIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9NYXRoU3ltYm9scy5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBIQm94LCBOb2RlLCBSaWNoVGV4dCwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBmb3VyaWVyTWFraW5nV2F2ZXMgZnJvbSAnLi4vLi4vZm91cmllck1ha2luZ1dhdmVzLmpzJztcclxuaW1wb3J0IEZNV1N5bWJvbHMgZnJvbSAnLi4vRk1XU3ltYm9scy5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgREVGQVVMVF9TWU1CT0xfRk9OVCA9IG5ldyBQaGV0Rm9udCggMzAgKTtcclxuY29uc3QgREVGQVVMVF9OX0VRVUFMU19GT05UID0gbmV3IFBoZXRGb250KCAxNCApO1xyXG5jb25zdCBERUZBVUxUX01JTl9NQVhfRk9OVCA9IG5ldyBQaGV0Rm9udCggMTIgKTtcclxuXHJcbi8vIFRoaXMgZXh0ZW5kcyBOb2RlIGluc3RlYWQgb2YgVkJveCBzbyB0aGF0IHRoZSBvcmlnaW4gd2lsbCBiZSBhdCB0aGUgb3JpZ2luIG9mIHN5bWJvbE5vZGUsIHVzZWZ1bCBmb3JcclxuLy8gbGF5b3V0IHdpdGggb3RoZXIgdGV4dC5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3VtU3ltYm9sTm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge1RSZWFkT25seVByb3BlcnR5LjxzdHJpbmc+fSBpbmRleFN5bWJvbFByb3BlcnR5IC0gc3ltYm9sIGZvciB0aGUgaW5kZXggb2Ygc3VtbWF0aW9uXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4TWluIC0gaW5kZXggbWluIHZhbHVlXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48bnVtYmVyPn0gaW5kZXhNYXhQcm9wZXJ0eSAtIGluZGV4IG1heCB2YWx1ZVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggaW5kZXhTeW1ib2xQcm9wZXJ0eSwgaW5kZXhNaW4sIGluZGV4TWF4UHJvcGVydHksIG9wdGlvbnMgKSB7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcblxyXG4gICAgICAvLyBTdW1TeW1ib2xOb2RlIG9wdGlvbnNcclxuICAgICAgaW50ZWdyYXRpb246IGZhbHNlLCAvLyB0cnVlPWludGVncmF0aW9uLCBmYWxzZT1zdW1tYXRpb25cclxuICAgICAgc3ltYm9sRm9udDogREVGQVVMVF9TWU1CT0xfRk9OVCxcclxuICAgICAgbkVxdWFsc0ZvbnQ6IERFRkFVTFRfTl9FUVVBTFNfRk9OVCwgLy8gZm9udCBmb3IgJ24gPSdcclxuICAgICAgbWluTWF4Rm9udDogREVGQVVMVF9NSU5fTUFYX0ZPTlRcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBUaGUgc3ltYm9sIGZvciB0aGUgdHlwZSBvZiBzdW0uXHJcbiAgICBjb25zdCBzeW1ib2xOb2RlID0gbmV3IFJpY2hUZXh0KCAnJywge1xyXG4gICAgICBmb250OiBvcHRpb25zLnN5bWJvbEZvbnRcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBuRXF1YWxzU3RyaW5nUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIGluZGV4U3ltYm9sUHJvcGVydHkgXSxcclxuICAgICAgaW5kZXhTeW1ib2wgPT4gYCR7aW5kZXhTeW1ib2x9ICR7TWF0aFN5bWJvbHMuRVFVQUxfVE99Jm5ic3BgICk7XHJcblxyXG4gICAgLy8gSW5kZXggYW5kIG1pbiAoc3RhcnRpbmcpIHZhbHVlLCB3aGljaCBhcHBlYXJzIGJlbG93IHRoZSBzdW0gc3ltYm9sLiBFLmcuICduID0gMCdcclxuICAgIC8vIFRoZSAnbiA9JyBhbmQgJzAnIGFyZSBzZXBhcmF0ZSBOb2RlcyBzbyB0aGF0IHdlIGNhbiB0d2VhayB0aGVpciBmb250IHNpemVzIHNlcGFyYXRlbHkuXHJcbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2ZvdXJpZXItbWFraW5nLXdhdmVzL2lzc3Vlcy8xODZcclxuICAgIGNvbnN0IG5FcXVhbHNOb2RlID0gbmV3IFJpY2hUZXh0KCBuRXF1YWxzU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgZm9udDogb3B0aW9ucy5uRXF1YWxzRm9udFxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgbWluVmFsdWVOb2RlID0gbmV3IFJpY2hUZXh0KCAnJywge1xyXG4gICAgICBmb250OiBvcHRpb25zLm1pbk1heEZvbnRcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IG1pbk5vZGUgPSBuZXcgSEJveCgge1xyXG4gICAgICBzcGFjaW5nOiAwLFxyXG4gICAgICBjaGlsZHJlbjogWyBuRXF1YWxzTm9kZSwgbWluVmFsdWVOb2RlIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBNYXggKHN0b3BwaW5nKSB2YWx1ZSwgd2hpY2ggYXBwZWFycyBhYm92ZSB0aGUgc3VtIHN5bWJvbFxyXG4gICAgY29uc3QgbWF4VmFsdWVOb2RlID0gbmV3IFRleHQoICcnLCB7XHJcbiAgICAgIGZvbnQ6IG9wdGlvbnMubWluTWF4Rm9udFxyXG4gICAgfSApO1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoICFvcHRpb25zLmNoaWxkcmVuLCAnU3VtU3ltYm9sTm9kZSBzZXRzIGNoaWxkcmVuJyApO1xyXG4gICAgb3B0aW9ucy5jaGlsZHJlbiA9IFsgbWF4VmFsdWVOb2RlLCBzeW1ib2xOb2RlLCBtaW5Ob2RlIF07XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHRydWU9aW50ZWdyYXRpb24sIGZhbHNlPXN1bW1hdGlvblxyXG4gICAgLy8gZGlzcG9zZSBpcyByZXF1aXJlZC5cclxuICAgIHRoaXMuaW50ZWdyYXRpb25Qcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIG9wdGlvbnMuaW50ZWdyYXRpb24gKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIGVxdWF0aW9uIGZvcm0gYW5kIGxheW91dC4gZGlzcG9zZSBpcyByZXF1aXJlZC5cclxuICAgIGNvbnN0IG11bHRpbGluayA9IG5ldyBNdWx0aWxpbmsoXHJcbiAgICAgIFsgdGhpcy5pbnRlZ3JhdGlvblByb3BlcnR5LCBpbmRleE1heFByb3BlcnR5LCBuRXF1YWxzTm9kZS5ib3VuZHNQcm9wZXJ0eSBdLFxyXG4gICAgICAoIGludGVncmF0aW9uLCBpbmRleE1heCwgbkVxdWFsc0JvdW5kcyApID0+IHtcclxuXHJcbiAgICAgICAgLy8gdXBkYXRlIHRleHRcclxuICAgICAgICBpZiAoIGludGVncmF0aW9uICkge1xyXG4gICAgICAgICAgc3ltYm9sTm9kZS5zdHJpbmcgPSBGTVdTeW1ib2xzLmludGVncmFsO1xyXG4gICAgICAgICAgbWluVmFsdWVOb2RlLnN0cmluZyA9IGluZGV4VG9TdHJpbmcoIGluZGV4TWluICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgc3ltYm9sTm9kZS5zdHJpbmcgPSBGTVdTeW1ib2xzLlNJR01BO1xyXG4gICAgICAgICAgbWluVmFsdWVOb2RlLnN0cmluZyA9IGluZGV4VG9TdHJpbmcoIGluZGV4TWluICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1heFZhbHVlTm9kZS5zdHJpbmcgPSBpbmRleFRvU3RyaW5nKCBpbmRleE1heCApO1xyXG5cclxuICAgICAgICAvLyB1cGRhdGUgbGF5b3V0XHJcbiAgICAgICAgLy8gV0FSTklORyAtIG1hZ2ljIG51bWJlcnMgaGVyZWluIHdlcmUgYXJyaXZlZCBhdCBlbXBpcmljYWxseSwgdHVuZWQgYmVjYXVzZSBSaWNoVGV4dCBib3VuZHMgYXJlIGluYWNjdXJhdGVcclxuICAgICAgICBpZiAoIGludGVncmF0aW9uICkge1xyXG4gICAgICAgICAgbkVxdWFsc05vZGUudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgbWluTm9kZS5sZWZ0ID0gc3ltYm9sTm9kZS5yaWdodDtcclxuICAgICAgICAgIG1pbk5vZGUuYm90dG9tID0gc3ltYm9sTm9kZS5ib3R0b207XHJcbiAgICAgICAgICBtYXhWYWx1ZU5vZGUubGVmdCA9IHN5bWJvbE5vZGUucmlnaHQgKyAzO1xyXG4gICAgICAgICAgbWF4VmFsdWVOb2RlLnRvcCA9IHN5bWJvbE5vZGUudG9wIC0gNTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBuRXF1YWxzTm9kZS52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgIG1pbk5vZGUuY2VudGVyWCA9IHN5bWJvbE5vZGUuY2VudGVyWDtcclxuICAgICAgICAgIG1pbk5vZGUudG9wID0gc3ltYm9sTm9kZS5ib3R0b20gLSAzO1xyXG4gICAgICAgICAgbWF4VmFsdWVOb2RlLmNlbnRlclggPSBzeW1ib2xOb2RlLmNlbnRlclg7XHJcbiAgICAgICAgICBtYXhWYWx1ZU5vZGUuYm90dG9tID0gc3ltYm9sTm9kZS50b3AgKyA1O1xyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG5cclxuICAgIC8vIEBwcml2YXRlXHJcbiAgICB0aGlzLmRpc3Bvc2VTdW1tYXRpb25TeW1ib2xOb2RlID0gKCkgPT4ge1xyXG4gICAgICB0aGlzLmludGVncmF0aW9uUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgICBtdWx0aWxpbmsuZGlzcG9zZSgpO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwdWJsaWNcclxuICAgKiBAb3ZlcnJpZGVcclxuICAgKi9cclxuICBkaXNwb3NlKCkge1xyXG4gICAgdGhpcy5kaXNwb3NlU3VtbWF0aW9uU3ltYm9sTm9kZSgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENvbnZlcnRzIGEgc3VtbWF0aW9uIGluZGV4IHRvIGEgc3RyaW5nLlxyXG4gKiBAcGFyYW0ge251bWJlcn0gaW5kZXhcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbmZ1bmN0aW9uIGluZGV4VG9TdHJpbmcoIGluZGV4ICkge1xyXG4gIGlmICggaW5kZXggPT09IEluZmluaXR5ICkge1xyXG4gICAgcmV0dXJuIGAke01hdGhTeW1ib2xzLklORklOSVRZfWA7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKCBpbmRleCA9PT0gLUluZmluaXR5ICkge1xyXG4gICAgcmV0dXJuIGAtJHtNYXRoU3ltYm9scy5JTkZJTklUWX1gO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIHJldHVybiBgJHtpbmRleH1gO1xyXG4gIH1cclxufVxyXG5cclxuZm91cmllck1ha2luZ1dhdmVzLnJlZ2lzdGVyKCAnU3VtU3ltYm9sTm9kZScsIFN1bVN5bWJvbE5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsU0FBUyxNQUFNLGtDQUFrQztBQUN4RCxPQUFPQyxLQUFLLE1BQU0sbUNBQW1DO0FBQ3JELE9BQU9DLFdBQVcsTUFBTSw0Q0FBNEM7QUFDcEUsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxJQUFJLEVBQUVDLElBQUksRUFBRUMsUUFBUSxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQzlFLE9BQU9DLGtCQUFrQixNQUFNLDZCQUE2QjtBQUM1RCxPQUFPQyxVQUFVLE1BQU0sa0JBQWtCOztBQUV6QztBQUNBLE1BQU1DLG1CQUFtQixHQUFHLElBQUlQLFFBQVEsQ0FBRSxFQUFHLENBQUM7QUFDOUMsTUFBTVEscUJBQXFCLEdBQUcsSUFBSVIsUUFBUSxDQUFFLEVBQUcsQ0FBQztBQUNoRCxNQUFNUyxvQkFBb0IsR0FBRyxJQUFJVCxRQUFRLENBQUUsRUFBRyxDQUFDOztBQUUvQztBQUNBO0FBQ0EsZUFBZSxNQUFNVSxhQUFhLFNBQVNSLElBQUksQ0FBQztFQUU5QztBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRVMsV0FBV0EsQ0FBRUMsbUJBQW1CLEVBQUVDLFFBQVEsRUFBRUMsZ0JBQWdCLEVBQUVDLE9BQU8sRUFBRztJQUV0RUEsT0FBTyxHQUFHakIsS0FBSyxDQUFFO01BRWY7TUFDQWtCLFdBQVcsRUFBRSxLQUFLO01BQUU7TUFDcEJDLFVBQVUsRUFBRVYsbUJBQW1CO01BQy9CVyxXQUFXLEVBQUVWLHFCQUFxQjtNQUFFO01BQ3BDVyxVQUFVLEVBQUVWO0lBQ2QsQ0FBQyxFQUFFTSxPQUFRLENBQUM7O0lBRVo7SUFDQSxNQUFNSyxVQUFVLEdBQUcsSUFBSWpC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