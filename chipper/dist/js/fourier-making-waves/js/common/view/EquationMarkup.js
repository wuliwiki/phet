// Copyright 2020-2022, University of Colorado Boulder

/**
 * EquationMarkup is a set of utility functions for creating RichText markup, used to render equations that are
 * specific to this simulation.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import EquationForm from '../../discrete/model/EquationForm.js';
import fourierMakingWaves from '../../fourierMakingWaves.js';
import FMWSymbols from '../FMWSymbols.js';
import Domain from '../model/Domain.js';
import SeriesType from '../model/SeriesType.js';

// constants
const HIDDEN_STRING = ''; // string for EquationForm.HIDDEN

// To improve readability of markup creation. Each of these is a string that may also include markup, added by FMWSymbols.
const An = `${FMWSymbols.AStringProperty.value}<sub>${FMWSymbols.nStringProperty.value}</sub>`;
const F = FMWSymbols.FStringProperty.value;
const f = FMWSymbols.fStringProperty.value;
const k = FMWSymbols.kStringProperty.value;
const L = FMWSymbols.LStringProperty.value;
const lambda = FMWSymbols.lambdaStringProperty.value;
const MINUS = MathSymbols.MINUS;
const n = FMWSymbols.nStringProperty.value;
const omega = FMWSymbols.omegaStringProperty.value;
const pi = FMWSymbols.pi;
const T = FMWSymbols.TStringProperty.value;
const t = FMWSymbols.tStringProperty.value;
const x = FMWSymbols.xStringProperty.value;
const EquationMarkup = {
  /**
   * Gets the RichText markup for the general form that describes a Fourier series.
   * @param {Domain} domain
   * @param {SeriesType} seriesType
   * @param {EquationForm} equationForm
   * @returns {string}
   * @public
   */
  getGeneralFormMarkup(domain, seriesType, equationForm) {
    return EquationMarkup.getSpecificFormMarkup(domain, seriesType, equationForm, n, An);
  },
  /**
   * Gets the RichText markup for a specific form that describes a Fourier series.
   * @param {Domain} domain
   * @param {SeriesType} seriesType
   * @param {EquationForm} equationForm
   * @param {string|number} order - {string} for general form (e.g. 'n') or {number} for a specific harmonic
   * @param {string|number} amplitude - {string} for general form (e.g. 'An') or {number} for a specific amplitude
   * @returns {string}
   * @public
   */
  getSpecificFormMarkup(domain, seriesType, equationForm, order, amplitude) {
    assert && assert(Domain.enumeration.includes(domain));
    assert && assert(SeriesType.enumeration.includes(seriesType));
    assert && assert(EquationForm.enumeration.includes(equationForm));
    assert && assert(typeof order === 'string' || typeof order === 'number');
    assert && assert(typeof amplitude === 'string' || typeof amplitude === 'number');
    let markup;
    if (domain === Domain.SPACE) {
      markup = getSpaceMarkup(seriesType, equationForm, order, amplitude);
    } else if (domain === Domain.TIME) {
      markup = getTimeMarkup(seriesType, equationForm, order, amplitude);
    } else if (domain === Domain.SPACE_AND_TIME) {
      markup = getSpaceAndTimeMarkup(seriesType, equationForm, order, amplitude);
    } else {
      assert && assert(false, `unsupported domain: ${domain}`);
    }
    return markup;
  },
  /**
   * Gets the markup for 'F(...)', where the '...' depends on the Domain.
   * @param {Domain} domain
   * @returns {string}
   * @public
   */
  getFunctionOfMarkup(domain) {
    const variables = domain === Domain.SPACE ? x : domain === Domain.TIME ? t : `${x},${t}`;
    return `${F}(${variables})`;
  },
  /**
   * Gets the markup used for the equation above the Components graph in the Wave Packet screen.
   * @param {Domain} domain
   * @param {SeriesType} seriesType
   * @returns {string}
   * @public
   */
  getComponentsEquationMarkup(domain, seriesType) {
    assert && assert(domain === Domain.SPACE || domain === Domain.TIME);
    const domainSymbol = domain === Domain.SPACE ? FMWSymbols.xStringProperty.value : FMWSymbols.tStringProperty.value;
    const componentSymbol = domain === Domain.SPACE ? FMWSymbols.kStringProperty.value : FMWSymbols.omegaStringProperty.value;
    const seriesTypeString = seriesType === SeriesType.SIN ? FMWSymbols.sinStringProperty.value : FMWSymbols.cosStringProperty.value;
    return `${FMWSymbols.AStringProperty.value}<sub>${FMWSymbols.nStringProperty.value}</sub> ` + `${seriesTypeString}( ${componentSymbol}<sub>${FMWSymbols.nStringProperty.value}</sub>${domainSymbol} )`;
  }
};

/**
 * Gets the RichText markup for an equation in the space Domain.
 * @param {SeriesType} seriesType
 * @param {EquationForm} equationForm
 * @param {string|number} order - {string} for general form (e.g. 'n') or number for a specific harmonic
 * @param {string|number} amplitude - {string} for general form (e.g. 'An') or {number} for a specific amplitude
 * @returns {string}
 */
function getSpaceMarkup(seriesType, equationForm, order, amplitude) {
  assert && assert(SeriesType.enumeration.includes(seriesType));
  assert && assert([EquationForm.HIDDEN, EquationForm.WAVELENGTH, EquationForm.SPATIAL_WAVE_NUMBER, EquationForm.MODE].includes(equationForm), `unsupported equationForm: ${equationForm}`);
  assert && assert(typeof order === 'string' || typeof order === 'number');
  assert && assert(typeof amplitude === 'string' || typeof amplitude === 'number');
  const seriesTypeMarkup = seriesTypeToMarkup(seriesType);
  let markup;
  if (equationForm === EquationForm.HIDDEN) {
    markup = HIDDEN_STRING;
  } else if (equationForm === EquationForm.WAVELENGTH) {
    markup = `${amplitude} ${seriesTypeMarkup}( 2${pi}${x} / ${lambda}<sub>${order}</sub> )`;
  } else if (equationForm === EquationForm.SPATIAL_WAVE_NUMBER) {
    markup = `${amplitude} ${seriesTypeMarkup}( ${k}<sub>${order}</sub>${x} )`;
  } else if (equationForm === EquationForm.MODE) {
    markup = `${amplitude} ${seriesTypeMarkup}( 2${pi}${order}${x} / ${L} )`;
  } else {
    assert && assert(false, `unsupported equationForm: ${equationForm}`);
  }
  return markup;
}

/**
 * Gets the RichText markup for an equation in the time Domain.
 * @param {SeriesType} seriesType
 * @param {EquationForm} equationForm
 * @param {string|number} order - {string} for general form (e.g. 'n') or number for a specific harmonic
 * @param {string|number} amplitude - {string} for general form (e.g. 'An') or {number} for a specific amplitude
 * @returns {string}
 */
function getTimeMarkup(seriesType, equationForm, order, amplitude) {
  assert && assert(SeriesType.enumeration.includes(seriesType));
  assert && assert([EquationForm.HIDDEN, EquationForm.FREQUENCY, EquationForm.PERIOD, EquationForm.ANGULAR_WAVE_NUMBER, EquationForm.MODE].includes(equationForm), `unsupported equationForm: ${equationForm}`);
  assert && assert(typeof order === 'string' || typeof order === 'number');
  assert && assert(typeof amplitude === 'string' || typeof amplitude === 'number');
  const seriesTypeMarkup = seriesTypeToMarkup(seriesType);
  let markup;
  if (equationForm === EquationForm.HIDDEN) {
    markup = HIDDEN_STRING;
  } else if (equationForm === EquationForm.FREQUENCY) {
    markup = `${amplitude} ${seriesTypeMarkup}( 2${pi}${f}<sub>${order}</sub>${t} )`;
  } else if (equationForm === EquationForm.PERIOD) {
    markup = `${amplitude} ${seriesTypeMarkup}( 2${pi}${t} / ${T}<sub>${order}</sub> )`;
  } else if (equationForm === EquationForm.ANGULAR_WAVE_NUMBER) {
    markup = `${amplitude} ${seriesTypeMarkup}( ${omega}<sub>${order}</sub>${t} )`;
  } else if (equationForm === EquationForm.MODE) {
    return `${amplitude} ${seriesTypeMarkup}( 2${pi}${order}${t} / ${T} )`;
  } else {
    assert && assert(false, `unsupported equationForm: ${equationForm}`);
  }
  return markup;
}

/**
 * Gets the RichText markup for an equation in the space & time Domain.
 * @param {SeriesType} seriesType
 * @param {EquationForm} equationForm
 * @param {string|number} order - {string} for general form (e.g. 'n') or number for a specific harmonic
 * @param {string|number} amplitude - {string} for general form (e.g. 'An') or {number} for a specific amplitude
 * @returns {string}
 */
function getSpaceAndTimeMarkup(seriesType, equationForm, order, amplitude) {
  assert && assert(SeriesType.enumeration.includes(seriesType));
  assert && assert([EquationForm.HIDDEN, EquationForm.WAVELENGTH_AND_PERIOD, EquationForm.SPATIAL_WAVE_NUMBER_AND_ANGULAR_WAVE_NUMBER, EquationForm.MODE].includes(equationForm), `unsupported equationForm: ${equationForm}`);
  assert && assert(typeof order === 'string' || typeof order === 'number');
  assert && assert(typeof amplitude === 'string' || typeof amplitude === 'number');
  const seriesTypeMarkup = seriesTypeToMarkup(seriesType);
  let markup;
  if (equationForm === EquationForm.HIDDEN) {
    markup = HIDDEN_STRING;
  } else if (equationForm === EquationForm.WAVELENGTH_AND_PERIOD) {
    markup = `${amplitude} ${seriesTypeMarkup}( 2${pi}( ${x}/${lambda}<sub>${order}</sub> ${MINUS} ${t}/${T}<sub>${order}</sub> ) )`;
  } else if (equationForm === EquationForm.SPATIAL_WAVE_NUMBER_AND_ANGULAR_WAVE_NUMBER) {
    markup = `${amplitude} ${seriesTypeMarkup}( ${k}<sub>${order}</sub>${x} ${MINUS} ${omega}<sub>${order}</sub>${t} )`;
  } else if (equationForm === EquationForm.MODE) {
    markup = `${amplitude} ${seriesTypeMarkup}( 2${pi}${order}( ${x}/${L} ${MINUS} ${t}/${T} ) )`;
  } else {
    assert && assert(false, `unsupported equationForm: ${equationForm}`);
  }
  return markup;
}

/**
 * Converts a SeriesType to markup.
 * @param {SeriesType} seriesType
 * @returns {string}
 */
function seriesTypeToMarkup(seriesType) {
  assert && assert(SeriesType.enumeration.includes(seriesType));
  return seriesType === SeriesType.SIN ? FMWSymbols.sinStringProperty.value : FMWSymbols.cosStringProperty.value;
}
fourierMakingWaves.register('EquationMarkup', EquationMarkup);
export default EquationMarkup;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNYXRoU3ltYm9scyIsIkVxdWF0aW9uRm9ybSIsImZvdXJpZXJNYWtpbmdXYXZlcyIsIkZNV1N5bWJvbHMiLCJEb21haW4iLCJTZXJpZXNUeXBlIiwiSElEREVOX1NUUklORyIsIkFuIiwiQVN0cmluZ1Byb3BlcnR5IiwidmFsdWUiLCJuU3RyaW5nUHJvcGVydHkiLCJGIiwiRlN0cmluZ1Byb3BlcnR5IiwiZiIsImZTdHJpbmdQcm9wZXJ0eSIsImsiLCJrU3RyaW5nUHJvcGVydHkiLCJMIiwiTFN0cmluZ1Byb3BlcnR5IiwibGFtYmRhIiwibGFtYmRhU3RyaW5nUHJvcGVydHkiLCJNSU5VUyIsIm4iLCJvbWVnYSIsIm9tZWdhU3RyaW5nUHJvcGVydHkiLCJwaSIsIlQiLCJUU3RyaW5nUHJvcGVydHkiLCJ0IiwidFN0cmluZ1Byb3BlcnR5IiwieCIsInhTdHJpbmdQcm9wZXJ0eSIsIkVxdWF0aW9uTWFya3VwIiwiZ2V0R2VuZXJhbEZvcm1NYXJrdXAiLCJkb21haW4iLCJzZXJpZXNUeXBlIiwiZXF1YXRpb25Gb3JtIiwiZ2V0U3BlY2lmaWNGb3JtTWFya3VwIiwib3JkZXIiLCJhbXBsaXR1ZGUiLCJhc3NlcnQiLCJlbnVtZXJhdGlvbiIsImluY2x1ZGVzIiwibWFya3VwIiwiU1BBQ0UiLCJnZXRTcGFjZU1hcmt1cCIsIlRJTUUiLCJnZXRUaW1lTWFya3VwIiwiU1BBQ0VfQU5EX1RJTUUiLCJnZXRTcGFjZUFuZFRpbWVNYXJrdXAiLCJnZXRGdW5jdGlvbk9mTWFya3VwIiwidmFyaWFibGVzIiwiZ2V0Q29tcG9uZW50c0VxdWF0aW9uTWFya3VwIiwiZG9tYWluU3ltYm9sIiwiY29tcG9uZW50U3ltYm9sIiwic2VyaWVzVHlwZVN0cmluZyIsIlNJTiIsInNpblN0cmluZ1Byb3BlcnR5IiwiY29zU3RyaW5nUHJvcGVydHkiLCJISURERU4iLCJXQVZFTEVOR1RIIiwiU1BBVElBTF9XQVZFX05VTUJFUiIsIk1PREUiLCJzZXJpZXNUeXBlTWFya3VwIiwic2VyaWVzVHlwZVRvTWFya3VwIiwiRlJFUVVFTkNZIiwiUEVSSU9EIiwiQU5HVUxBUl9XQVZFX05VTUJFUiIsIldBVkVMRU5HVEhfQU5EX1BFUklPRCIsIlNQQVRJQUxfV0FWRV9OVU1CRVJfQU5EX0FOR1VMQVJfV0FWRV9OVU1CRVIiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkVxdWF0aW9uTWFya3VwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIwLTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEVxdWF0aW9uTWFya3VwIGlzIGEgc2V0IG9mIHV0aWxpdHkgZnVuY3Rpb25zIGZvciBjcmVhdGluZyBSaWNoVGV4dCBtYXJrdXAsIHVzZWQgdG8gcmVuZGVyIGVxdWF0aW9ucyB0aGF0IGFyZVxyXG4gKiBzcGVjaWZpYyB0byB0aGlzIHNpbXVsYXRpb24uXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IE1hdGhTeW1ib2xzIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9NYXRoU3ltYm9scy5qcyc7XHJcbmltcG9ydCBFcXVhdGlvbkZvcm0gZnJvbSAnLi4vLi4vZGlzY3JldGUvbW9kZWwvRXF1YXRpb25Gb3JtLmpzJztcclxuaW1wb3J0IGZvdXJpZXJNYWtpbmdXYXZlcyBmcm9tICcuLi8uLi9mb3VyaWVyTWFraW5nV2F2ZXMuanMnO1xyXG5pbXBvcnQgRk1XU3ltYm9scyBmcm9tICcuLi9GTVdTeW1ib2xzLmpzJztcclxuaW1wb3J0IERvbWFpbiBmcm9tICcuLi9tb2RlbC9Eb21haW4uanMnO1xyXG5pbXBvcnQgU2VyaWVzVHlwZSBmcm9tICcuLi9tb2RlbC9TZXJpZXNUeXBlLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBISURERU5fU1RSSU5HID0gJyc7IC8vIHN0cmluZyBmb3IgRXF1YXRpb25Gb3JtLkhJRERFTlxyXG5cclxuLy8gVG8gaW1wcm92ZSByZWFkYWJpbGl0eSBvZiBtYXJrdXAgY3JlYXRpb24uIEVhY2ggb2YgdGhlc2UgaXMgYSBzdHJpbmcgdGhhdCBtYXkgYWxzbyBpbmNsdWRlIG1hcmt1cCwgYWRkZWQgYnkgRk1XU3ltYm9scy5cclxuY29uc3QgQW4gPSBgJHtGTVdTeW1ib2xzLkFTdHJpbmdQcm9wZXJ0eS52YWx1ZX08c3ViPiR7Rk1XU3ltYm9scy5uU3RyaW5nUHJvcGVydHkudmFsdWV9PC9zdWI+YDtcclxuY29uc3QgRiA9IEZNV1N5bWJvbHMuRlN0cmluZ1Byb3BlcnR5LnZhbHVlO1xyXG5jb25zdCBmID0gRk1XU3ltYm9scy5mU3RyaW5nUHJvcGVydHkudmFsdWU7XHJcbmNvbnN0IGsgPSBGTVdTeW1ib2xzLmtTdHJpbmdQcm9wZXJ0eS52YWx1ZTtcclxuY29uc3QgTCA9IEZNV1N5bWJvbHMuTFN0cmluZ1Byb3BlcnR5LnZhbHVlO1xyXG5jb25zdCBsYW1iZGEgPSBGTVdTeW1ib2xzLmxhbWJkYVN0cmluZ1Byb3BlcnR5LnZhbHVlO1xyXG5jb25zdCBNSU5VUyA9IE1hdGhTeW1ib2xzLk1JTlVTO1xyXG5jb25zdCBuID0gRk1XU3ltYm9scy5uU3RyaW5nUHJvcGVydHkudmFsdWU7XHJcbmNvbnN0IG9tZWdhID0gRk1XU3ltYm9scy5vbWVnYVN0cmluZ1Byb3BlcnR5LnZhbHVlO1xyXG5jb25zdCBwaSA9IEZNV1N5bWJvbHMucGk7XHJcbmNvbnN0IFQgPSBGTVdTeW1ib2xzLlRTdHJpbmdQcm9wZXJ0eS52YWx1ZTtcclxuY29uc3QgdCA9IEZNV1N5bWJvbHMudFN0cmluZ1Byb3BlcnR5LnZhbHVlO1xyXG5jb25zdCB4ID0gRk1XU3ltYm9scy54U3RyaW5nUHJvcGVydHkudmFsdWU7XHJcblxyXG5jb25zdCBFcXVhdGlvbk1hcmt1cCA9IHtcclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyB0aGUgUmljaFRleHQgbWFya3VwIGZvciB0aGUgZ2VuZXJhbCBmb3JtIHRoYXQgZGVzY3JpYmVzIGEgRm91cmllciBzZXJpZXMuXHJcbiAgICogQHBhcmFtIHtEb21haW59IGRvbWFpblxyXG4gICAqIEBwYXJhbSB7U2VyaWVzVHlwZX0gc2VyaWVzVHlwZVxyXG4gICAqIEBwYXJhbSB7RXF1YXRpb25Gb3JtfSBlcXVhdGlvbkZvcm1cclxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBnZXRHZW5lcmFsRm9ybU1hcmt1cCggZG9tYWluLCBzZXJpZXNUeXBlLCBlcXVhdGlvbkZvcm0gKSB7XHJcbiAgICByZXR1cm4gRXF1YXRpb25NYXJrdXAuZ2V0U3BlY2lmaWNGb3JtTWFya3VwKCBkb21haW4sIHNlcmllc1R5cGUsIGVxdWF0aW9uRm9ybSwgbiwgQW4gKTtcclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiBHZXRzIHRoZSBSaWNoVGV4dCBtYXJrdXAgZm9yIGEgc3BlY2lmaWMgZm9ybSB0aGF0IGRlc2NyaWJlcyBhIEZvdXJpZXIgc2VyaWVzLlxyXG4gICAqIEBwYXJhbSB7RG9tYWlufSBkb21haW5cclxuICAgKiBAcGFyYW0ge1Nlcmllc1R5cGV9IHNlcmllc1R5cGVcclxuICAgKiBAcGFyYW0ge0VxdWF0aW9uRm9ybX0gZXF1YXRpb25Gb3JtXHJcbiAgICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBvcmRlciAtIHtzdHJpbmd9IGZvciBnZW5lcmFsIGZvcm0gKGUuZy4gJ24nKSBvciB7bnVtYmVyfSBmb3IgYSBzcGVjaWZpYyBoYXJtb25pY1xyXG4gICAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gYW1wbGl0dWRlIC0ge3N0cmluZ30gZm9yIGdlbmVyYWwgZm9ybSAoZS5nLiAnQW4nKSBvciB7bnVtYmVyfSBmb3IgYSBzcGVjaWZpYyBhbXBsaXR1ZGVcclxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBnZXRTcGVjaWZpY0Zvcm1NYXJrdXAoIGRvbWFpbiwgc2VyaWVzVHlwZSwgZXF1YXRpb25Gb3JtLCBvcmRlciwgYW1wbGl0dWRlICkge1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIERvbWFpbi5lbnVtZXJhdGlvbi5pbmNsdWRlcyggZG9tYWluICkgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIFNlcmllc1R5cGUuZW51bWVyYXRpb24uaW5jbHVkZXMoIHNlcmllc1R5cGUgKSApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggRXF1YXRpb25Gb3JtLmVudW1lcmF0aW9uLmluY2x1ZGVzKCBlcXVhdGlvbkZvcm0gKSApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdHlwZW9mIG9yZGVyID09PSAnc3RyaW5nJyB8fCB0eXBlb2Ygb3JkZXIgPT09ICdudW1iZXInICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2YgYW1wbGl0dWRlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgYW1wbGl0dWRlID09PSAnbnVtYmVyJyApO1xyXG5cclxuICAgIGxldCBtYXJrdXA7XHJcbiAgICBpZiAoIGRvbWFpbiA9PT0gRG9tYWluLlNQQUNFICkge1xyXG4gICAgICBtYXJrdXAgPSBnZXRTcGFjZU1hcmt1cCggc2VyaWVzVHlwZSwgZXF1YXRpb25Gb3JtLCBvcmRlciwgYW1wbGl0dWRlICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggZG9tYWluID09PSBEb21haW4uVElNRSApIHtcclxuICAgICAgbWFya3VwID0gZ2V0VGltZU1hcmt1cCggc2VyaWVzVHlwZSwgZXF1YXRpb25Gb3JtLCBvcmRlciwgYW1wbGl0dWRlICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggZG9tYWluID09PSBEb21haW4uU1BBQ0VfQU5EX1RJTUUgKSB7XHJcbiAgICAgIG1hcmt1cCA9IGdldFNwYWNlQW5kVGltZU1hcmt1cCggc2VyaWVzVHlwZSwgZXF1YXRpb25Gb3JtLCBvcmRlciwgYW1wbGl0dWRlICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgYXNzZXJ0ICYmIGFzc2VydCggZmFsc2UsIGB1bnN1cHBvcnRlZCBkb21haW46ICR7ZG9tYWlufWAgKTtcclxuICAgIH1cclxuICAgIHJldHVybiBtYXJrdXA7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyB0aGUgbWFya3VwIGZvciAnRiguLi4pJywgd2hlcmUgdGhlICcuLi4nIGRlcGVuZHMgb24gdGhlIERvbWFpbi5cclxuICAgKiBAcGFyYW0ge0RvbWFpbn0gZG9tYWluXHJcbiAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgZ2V0RnVuY3Rpb25PZk1hcmt1cCggZG9tYWluICkge1xyXG4gICAgY29uc3QgdmFyaWFibGVzID0gKCBkb21haW4gPT09IERvbWFpbi5TUEFDRSApID8geCA6ICggKCBkb21haW4gPT09IERvbWFpbi5USU1FICkgPyB0IDogYCR7eH0sJHt0fWAgKTtcclxuICAgIHJldHVybiBgJHtGfSgke3ZhcmlhYmxlc30pYDtcclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiBHZXRzIHRoZSBtYXJrdXAgdXNlZCBmb3IgdGhlIGVxdWF0aW9uIGFib3ZlIHRoZSBDb21wb25lbnRzIGdyYXBoIGluIHRoZSBXYXZlIFBhY2tldCBzY3JlZW4uXHJcbiAgICogQHBhcmFtIHtEb21haW59IGRvbWFpblxyXG4gICAqIEBwYXJhbSB7U2VyaWVzVHlwZX0gc2VyaWVzVHlwZVxyXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIGdldENvbXBvbmVudHNFcXVhdGlvbk1hcmt1cCggZG9tYWluLCBzZXJpZXNUeXBlICkge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggZG9tYWluID09PSBEb21haW4uU1BBQ0UgfHwgZG9tYWluID09PSBEb21haW4uVElNRSApO1xyXG5cclxuICAgIGNvbnN0IGRvbWFpblN5bWJvbCA9ICggZG9tYWluID09PSBEb21haW4uU1BBQ0UgKSA/IEZNV1N5bWJvbHMueFN0cmluZ1Byb3BlcnR5LnZhbHVlIDogRk1XU3ltYm9scy50U3RyaW5nUHJvcGVydHkudmFsdWU7XHJcbiAgICBjb25zdCBjb21wb25lbnRTeW1ib2wgPSAoIGRvbWFpbiA9PT0gRG9tYWluLlNQQUNFICkgPyBGTVdTeW1ib2xzLmtTdHJpbmdQcm9wZXJ0eS52YWx1ZSA6IEZNV1N5bWJvbHMub21lZ2FTdHJpbmdQcm9wZXJ0eS52YWx1ZTtcclxuICAgIGNvbnN0IHNlcmllc1R5cGVTdHJpbmcgPSAoIHNlcmllc1R5cGUgPT09IFNlcmllc1R5cGUuU0lOICkgPyBGTVdTeW1ib2xzLnNpblN0cmluZ1Byb3BlcnR5LnZhbHVlIDogRk1XU3ltYm9scy5jb3NTdHJpbmdQcm9wZXJ0eS52YWx1ZTtcclxuICAgIHJldHVybiBgJHtGTVdTeW1ib2xzLkFTdHJpbmdQcm9wZXJ0eS52YWx1ZX08c3ViPiR7Rk1XU3ltYm9scy5uU3RyaW5nUHJvcGVydHkudmFsdWV9PC9zdWI+IGAgK1xyXG4gICAgICAgICAgIGAke3Nlcmllc1R5cGVTdHJpbmd9KCAke2NvbXBvbmVudFN5bWJvbH08c3ViPiR7Rk1XU3ltYm9scy5uU3RyaW5nUHJvcGVydHkudmFsdWV9PC9zdWI+JHtkb21haW5TeW1ib2x9IClgO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXRzIHRoZSBSaWNoVGV4dCBtYXJrdXAgZm9yIGFuIGVxdWF0aW9uIGluIHRoZSBzcGFjZSBEb21haW4uXHJcbiAqIEBwYXJhbSB7U2VyaWVzVHlwZX0gc2VyaWVzVHlwZVxyXG4gKiBAcGFyYW0ge0VxdWF0aW9uRm9ybX0gZXF1YXRpb25Gb3JtXHJcbiAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gb3JkZXIgLSB7c3RyaW5nfSBmb3IgZ2VuZXJhbCBmb3JtIChlLmcuICduJykgb3IgbnVtYmVyIGZvciBhIHNwZWNpZmljIGhhcm1vbmljXHJcbiAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gYW1wbGl0dWRlIC0ge3N0cmluZ30gZm9yIGdlbmVyYWwgZm9ybSAoZS5nLiAnQW4nKSBvciB7bnVtYmVyfSBmb3IgYSBzcGVjaWZpYyBhbXBsaXR1ZGVcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbmZ1bmN0aW9uIGdldFNwYWNlTWFya3VwKCBzZXJpZXNUeXBlLCBlcXVhdGlvbkZvcm0sIG9yZGVyLCBhbXBsaXR1ZGUgKSB7XHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggU2VyaWVzVHlwZS5lbnVtZXJhdGlvbi5pbmNsdWRlcyggc2VyaWVzVHlwZSApICk7XHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggWyBFcXVhdGlvbkZvcm0uSElEREVOLCBFcXVhdGlvbkZvcm0uV0FWRUxFTkdUSCwgRXF1YXRpb25Gb3JtLlNQQVRJQUxfV0FWRV9OVU1CRVIsIEVxdWF0aW9uRm9ybS5NT0RFIF0uaW5jbHVkZXMoIGVxdWF0aW9uRm9ybSApLFxyXG4gICAgYHVuc3VwcG9ydGVkIGVxdWF0aW9uRm9ybTogJHtlcXVhdGlvbkZvcm19YCApO1xyXG4gIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBvcmRlciA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIG9yZGVyID09PSAnbnVtYmVyJyApO1xyXG4gIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBhbXBsaXR1ZGUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBhbXBsaXR1ZGUgPT09ICdudW1iZXInICk7XHJcblxyXG4gIGNvbnN0IHNlcmllc1R5cGVNYXJrdXAgPSBzZXJpZXNUeXBlVG9NYXJrdXAoIHNlcmllc1R5cGUgKTtcclxuXHJcbiAgbGV0IG1hcmt1cDtcclxuICBpZiAoIGVxdWF0aW9uRm9ybSA9PT0gRXF1YXRpb25Gb3JtLkhJRERFTiApIHtcclxuICAgIG1hcmt1cCA9IEhJRERFTl9TVFJJTkc7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKCBlcXVhdGlvbkZvcm0gPT09IEVxdWF0aW9uRm9ybS5XQVZFTEVOR1RIICkge1xyXG4gICAgbWFya3VwID0gYCR7YW1wbGl0dWRlfSAke3Nlcmllc1R5cGVNYXJrdXB9KCAyJHtwaX0ke3h9IC8gJHtsYW1iZGF9PHN1Yj4ke29yZGVyfTwvc3ViPiApYDtcclxuICB9XHJcbiAgZWxzZSBpZiAoIGVxdWF0aW9uRm9ybSA9PT0gRXF1YXRpb25Gb3JtLlNQQVRJQUxfV0FWRV9OVU1CRVIgKSB7XHJcbiAgICBtYXJrdXAgPSBgJHthbXBsaXR1ZGV9ICR7c2VyaWVzVHlwZU1hcmt1cH0oICR7a308c3ViPiR7b3JkZXJ9PC9zdWI+JHt4fSApYDtcclxuICB9XHJcbiAgZWxzZSBpZiAoIGVxdWF0aW9uRm9ybSA9PT0gRXF1YXRpb25Gb3JtLk1PREUgKSB7XHJcbiAgICBtYXJrdXAgPSBgJHthbXBsaXR1ZGV9ICR7c2VyaWVzVHlwZU1hcmt1cH0oIDIke3BpfSR7b3JkZXJ9JHt4fSAvICR7TH0gKWA7XHJcbiAgfVxyXG4gIGVsc2Uge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggZmFsc2UsIGB1bnN1cHBvcnRlZCBlcXVhdGlvbkZvcm06ICR7ZXF1YXRpb25Gb3JtfWAgKTtcclxuICB9XHJcbiAgcmV0dXJuIG1hcmt1cDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldHMgdGhlIFJpY2hUZXh0IG1hcmt1cCBmb3IgYW4gZXF1YXRpb24gaW4gdGhlIHRpbWUgRG9tYWluLlxyXG4gKiBAcGFyYW0ge1Nlcmllc1R5cGV9IHNlcmllc1R5cGVcclxuICogQHBhcmFtIHtFcXVhdGlvbkZvcm19IGVxdWF0aW9uRm9ybVxyXG4gKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IG9yZGVyIC0ge3N0cmluZ30gZm9yIGdlbmVyYWwgZm9ybSAoZS5nLiAnbicpIG9yIG51bWJlciBmb3IgYSBzcGVjaWZpYyBoYXJtb25pY1xyXG4gKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IGFtcGxpdHVkZSAtIHtzdHJpbmd9IGZvciBnZW5lcmFsIGZvcm0gKGUuZy4gJ0FuJykgb3Ige251bWJlcn0gZm9yIGEgc3BlY2lmaWMgYW1wbGl0dWRlXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRUaW1lTWFya3VwKCBzZXJpZXNUeXBlLCBlcXVhdGlvbkZvcm0sIG9yZGVyLCBhbXBsaXR1ZGUgKSB7XHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggU2VyaWVzVHlwZS5lbnVtZXJhdGlvbi5pbmNsdWRlcyggc2VyaWVzVHlwZSApICk7XHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggWyBFcXVhdGlvbkZvcm0uSElEREVOLCBFcXVhdGlvbkZvcm0uRlJFUVVFTkNZLCBFcXVhdGlvbkZvcm0uUEVSSU9ELCBFcXVhdGlvbkZvcm0uQU5HVUxBUl9XQVZFX05VTUJFUiwgRXF1YXRpb25Gb3JtLk1PREUgXS5pbmNsdWRlcyggZXF1YXRpb25Gb3JtICksXHJcbiAgICBgdW5zdXBwb3J0ZWQgZXF1YXRpb25Gb3JtOiAke2VxdWF0aW9uRm9ybX1gICk7XHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggdHlwZW9mIG9yZGVyID09PSAnc3RyaW5nJyB8fCB0eXBlb2Ygb3JkZXIgPT09ICdudW1iZXInICk7XHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggdHlwZW9mIGFtcGxpdHVkZSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIGFtcGxpdHVkZSA9PT0gJ251bWJlcicgKTtcclxuXHJcbiAgY29uc3Qgc2VyaWVzVHlwZU1hcmt1cCA9IHNlcmllc1R5cGVUb01hcmt1cCggc2VyaWVzVHlwZSApO1xyXG5cclxuICBsZXQgbWFya3VwO1xyXG4gIGlmICggZXF1YXRpb25Gb3JtID09PSBFcXVhdGlvbkZvcm0uSElEREVOICkge1xyXG4gICAgbWFya3VwID0gSElEREVOX1NUUklORztcclxuICB9XHJcbiAgZWxzZSBpZiAoIGVxdWF0aW9uRm9ybSA9PT0gRXF1YXRpb25Gb3JtLkZSRVFVRU5DWSApIHtcclxuICAgIG1hcmt1cCA9IGAke2FtcGxpdHVkZX0gJHtzZXJpZXNUeXBlTWFya3VwfSggMiR7cGl9JHtmfTxzdWI+JHtvcmRlcn08L3N1Yj4ke3R9IClgO1xyXG4gIH1cclxuICBlbHNlIGlmICggZXF1YXRpb25Gb3JtID09PSBFcXVhdGlvbkZvcm0uUEVSSU9EICkge1xyXG4gICAgbWFya3VwID0gYCR7YW1wbGl0dWRlfSAke3Nlcmllc1R5cGVNYXJrdXB9KCAyJHtwaX0ke3R9IC8gJHtUfTxzdWI+JHtvcmRlcn08L3N1Yj4gKWA7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKCBlcXVhdGlvbkZvcm0gPT09IEVxdWF0aW9uRm9ybS5BTkdVTEFSX1dBVkVfTlVNQkVSICkge1xyXG4gICAgbWFya3VwID0gYCR7YW1wbGl0dWRlfSAke3Nlcmllc1R5cGVNYXJrdXB9KCAke29tZWdhfTxzdWI+JHtvcmRlcn08L3N1Yj4ke3R9IClgO1xyXG4gIH1cclxuICBlbHNlIGlmICggZXF1YXRpb25Gb3JtID09PSBFcXVhdGlvbkZvcm0uTU9ERSApIHtcclxuICAgIHJldHVybiBgJHthbXBsaXR1ZGV9ICR7c2VyaWVzVHlwZU1hcmt1cH0oIDIke3BpfSR7b3JkZXJ9JHt0fSAvICR7VH0gKWA7XHJcbiAgfVxyXG4gIGVsc2Uge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggZmFsc2UsIGB1bnN1cHBvcnRlZCBlcXVhdGlvbkZvcm06ICR7ZXF1YXRpb25Gb3JtfWAgKTtcclxuICB9XHJcbiAgcmV0dXJuIG1hcmt1cDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldHMgdGhlIFJpY2hUZXh0IG1hcmt1cCBmb3IgYW4gZXF1YXRpb24gaW4gdGhlIHNwYWNlICYgdGltZSBEb21haW4uXHJcbiAqIEBwYXJhbSB7U2VyaWVzVHlwZX0gc2VyaWVzVHlwZVxyXG4gKiBAcGFyYW0ge0VxdWF0aW9uRm9ybX0gZXF1YXRpb25Gb3JtXHJcbiAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gb3JkZXIgLSB7c3RyaW5nfSBmb3IgZ2VuZXJhbCBmb3JtIChlLmcuICduJykgb3IgbnVtYmVyIGZvciBhIHNwZWNpZmljIGhhcm1vbmljXHJcbiAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gYW1wbGl0dWRlIC0ge3N0cmluZ30gZm9yIGdlbmVyYWwgZm9ybSAoZS5nLiAnQW4nKSBvciB7bnVtYmVyfSBmb3IgYSBzcGVjaWZpYyBhbXBsaXR1ZGVcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbmZ1bmN0aW9uIGdldFNwYWNlQW5kVGltZU1hcmt1cCggc2VyaWVzVHlwZSwgZXF1YXRpb25Gb3JtLCBvcmRlciwgYW1wbGl0dWRlICkge1xyXG4gIGFzc2VydCAmJiBhc3NlcnQoIFNlcmllc1R5cGUuZW51bWVyYXRpb24uaW5jbHVkZXMoIHNlcmllc1R5cGUgKSApO1xyXG4gIGFzc2VydCAmJiBhc3NlcnQoIFsgRXF1YXRpb25Gb3JtLkhJRERFTiwgRXF1YXRpb25Gb3JtLldBVkVMRU5HVEhfQU5EX1BFUklPRCxcclxuICAgICAgRXF1YXRpb25Gb3JtLlNQQVRJQUxfV0FWRV9OVU1CRVJfQU5EX0FOR1VMQVJfV0FWRV9OVU1CRVIsIEVxdWF0aW9uRm9ybS5NT0RFIF0uaW5jbHVkZXMoIGVxdWF0aW9uRm9ybSApLFxyXG4gICAgYHVuc3VwcG9ydGVkIGVxdWF0aW9uRm9ybTogJHtlcXVhdGlvbkZvcm19YCApO1xyXG4gIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBvcmRlciA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIG9yZGVyID09PSAnbnVtYmVyJyApO1xyXG4gIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBhbXBsaXR1ZGUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBhbXBsaXR1ZGUgPT09ICdudW1iZXInICk7XHJcblxyXG4gIGNvbnN0IHNlcmllc1R5cGVNYXJrdXAgPSBzZXJpZXNUeXBlVG9NYXJrdXAoIHNlcmllc1R5cGUgKTtcclxuXHJcbiAgbGV0IG1hcmt1cDtcclxuICBpZiAoIGVxdWF0aW9uRm9ybSA9PT0gRXF1YXRpb25Gb3JtLkhJRERFTiApIHtcclxuICAgIG1hcmt1cCA9IEhJRERFTl9TVFJJTkc7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKCBlcXVhdGlvbkZvcm0gPT09IEVxdWF0aW9uRm9ybS5XQVZFTEVOR1RIX0FORF9QRVJJT0QgKSB7XHJcbiAgICBtYXJrdXAgPSBgJHthbXBsaXR1ZGV9ICR7c2VyaWVzVHlwZU1hcmt1cH0oIDIke3BpfSggJHt4fS8ke2xhbWJkYX08c3ViPiR7b3JkZXJ9PC9zdWI+ICR7TUlOVVN9ICR7dH0vJHtUfTxzdWI+JHtvcmRlcn08L3N1Yj4gKSApYDtcclxuICB9XHJcbiAgZWxzZSBpZiAoIGVxdWF0aW9uRm9ybSA9PT0gRXF1YXRpb25Gb3JtLlNQQVRJQUxfV0FWRV9OVU1CRVJfQU5EX0FOR1VMQVJfV0FWRV9OVU1CRVIgKSB7XHJcbiAgICBtYXJrdXAgPSBgJHthbXBsaXR1ZGV9ICR7c2VyaWVzVHlwZU1hcmt1cH0oICR7a308c3ViPiR7b3JkZXJ9PC9zdWI+JHt4fSAke01JTlVTfSAke29tZWdhfTxzdWI+JHtvcmRlcn08L3N1Yj4ke3R9IClgO1xyXG4gIH1cclxuICBlbHNlIGlmICggZXF1YXRpb25Gb3JtID09PSBFcXVhdGlvbkZvcm0uTU9ERSApIHtcclxuICAgIG1hcmt1cCA9IGAke2FtcGxpdHVkZX0gJHtzZXJpZXNUeXBlTWFya3VwfSggMiR7cGl9JHtvcmRlcn0oICR7eH0vJHtMfSAke01JTlVTfSAke3R9LyR7VH0gKSApYDtcclxuICB9XHJcbiAgZWxzZSB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBmYWxzZSwgYHVuc3VwcG9ydGVkIGVxdWF0aW9uRm9ybTogJHtlcXVhdGlvbkZvcm19YCApO1xyXG4gIH1cclxuICByZXR1cm4gbWFya3VwO1xyXG59XHJcblxyXG4vKipcclxuICogQ29udmVydHMgYSBTZXJpZXNUeXBlIHRvIG1hcmt1cC5cclxuICogQHBhcmFtIHtTZXJpZXNUeXBlfSBzZXJpZXNUeXBlXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG5mdW5jdGlvbiBzZXJpZXNUeXBlVG9NYXJrdXAoIHNlcmllc1R5cGUgKSB7XHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggU2VyaWVzVHlwZS5lbnVtZXJhdGlvbi5pbmNsdWRlcyggc2VyaWVzVHlwZSApICk7XHJcbiAgcmV0dXJuICggc2VyaWVzVHlwZSA9PT0gU2VyaWVzVHlwZS5TSU4gKSA/IEZNV1N5bWJvbHMuc2luU3RyaW5nUHJvcGVydHkudmFsdWUgOiBGTVdTeW1ib2xzLmNvc1N0cmluZ1Byb3BlcnR5LnZhbHVlO1xyXG59XHJcblxyXG5mb3VyaWVyTWFraW5nV2F2ZXMucmVnaXN0ZXIoICdFcXVhdGlvbk1hcmt1cCcsIEVxdWF0aW9uTWFya3VwICk7XHJcbmV4cG9ydCBkZWZhdWx0IEVxdWF0aW9uTWFya3VwOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFdBQVcsTUFBTSw0Q0FBNEM7QUFDcEUsT0FBT0MsWUFBWSxNQUFNLHNDQUFzQztBQUMvRCxPQUFPQyxrQkFBa0IsTUFBTSw2QkFBNkI7QUFDNUQsT0FBT0MsVUFBVSxNQUFNLGtCQUFrQjtBQUN6QyxPQUFPQyxNQUFNLE1BQU0sb0JBQW9CO0FBQ3ZDLE9BQU9DLFVBQVUsTUFBTSx3QkFBd0I7O0FBRS9DO0FBQ0EsTUFBTUMsYUFBYSxHQUFHLEVBQUUsQ0FBQyxDQUFDOztBQUUxQjtBQUNBLE1BQU1DLEVBQUUsR0FBSSxHQUFFSixVQUFVLENBQUNLLGVBQWUsQ0FBQ0MsS0FBTSxRQUFPTixVQUFVLENBQUNPLGVBQWUsQ0FBQ0QsS0FBTSxRQUFPO0FBQzlGLE1BQU1FLENBQUMsR0FBR1IsVUFBVSxDQUFDUyxlQUFlLENBQUNILEtBQUs7QUFDMUMsTUFBTUksQ0FBQyxHQUFHVixVQUFVLENBQUNXLGVBQWUsQ0FBQ0wsS0FBSztBQUMxQyxNQUFNTSxDQUFDLEdBQUdaLFVBQVUsQ0FBQ2EsZUFBZSxDQUFDUCxLQUFLO0FBQzFDLE1BQU1RLENBQUMsR0FBR2QsVUFBVSxDQUFDZSxlQUFlLENBQUNULEtBQUs7QUFDMUMsTUFBTVUsTUFBTSxHQUFHaEIsVUFBVSxDQUFDaUIsb0JBQW9CLENBQUNYLEtBQUs7QUFDcEQsTUFBTVksS0FBSyxHQUFHckIsV0FBVyxDQUFDcUIsS0FBSztBQUMvQixNQUFNQyxDQUFDLEdBQUduQixVQUFVLENBQUNPLGVBQWUsQ0FBQ0QsS0FBSztBQUMxQyxNQUFNYyxLQUFL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