// Copyright 2020-2023, University of Colorado Boulder

/**
 * DomainChartNode is the base class for all of the charts in this simulation, with the exception of the Amplitudes
 * chart in the 'Discrete' and 'Wave Game' screens.
 *
 * Responsibilities:
 * - assembles all of the necessary bamboo components
 * - all things related to updating the x (Domain) axis, hence its name. Includes adjusting the x-axis range and
 *   decorations (grid lines, tick marks, labels) to match the Domain.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Multilink from '../../../../axon/js/Multilink.js';
import PatternStringProperty from '../../../../axon/js/PatternStringProperty.js';
import AxisLine from '../../../../bamboo/js/AxisLine.js';
import ChartRectangle from '../../../../bamboo/js/ChartRectangle.js';
import ChartTransform from '../../../../bamboo/js/ChartTransform.js';
import GridLineSet from '../../../../bamboo/js/GridLineSet.js';
import TickLabelSet from '../../../../bamboo/js/TickLabelSet.js';
import TickMarkSet from '../../../../bamboo/js/TickMarkSet.js';
import Bounds2 from '../../../../dot/js/Bounds2.js';
import Range from '../../../../dot/js/Range.js';
import { Shape } from '../../../../kite/js/imports.js';
import merge from '../../../../phet-core/js/merge.js';
import Orientation from '../../../../phet-core/js/Orientation.js';
import PlusMinusZoomButtonGroup from '../../../../scenery-phet/js/PlusMinusZoomButtonGroup.js';
import { Node, RichText } from '../../../../scenery/js/imports.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import fourierMakingWaves from '../../fourierMakingWaves.js';
import FourierMakingWavesStrings from '../../FourierMakingWavesStrings.js';
import FMWColors from '../FMWColors.js';
import FMWConstants from '../FMWConstants.js';
import FMWSymbols from '../FMWSymbols.js';
import Domain from '../model/Domain.js';
import DomainChart from '../model/DomainChart.js';

// constants
const DEFAULT_X_SPACE_LABEL_PROPERTY = new PatternStringProperty(FourierMakingWavesStrings.symbolUnitsStringProperty, {
  symbol: FMWSymbols.xStringProperty,
  units: FourierMakingWavesStrings.units.metersStringProperty
});
const DEFAULT_X_TIME_LABEL_PROPERTY = new PatternStringProperty(FourierMakingWavesStrings.symbolUnitsStringProperty, {
  symbol: FMWSymbols.tStringProperty,
  units: FourierMakingWavesStrings.units.millisecondsStringProperty
});
const DEFAULT_EDGE = 'min';
export default class DomainChartNode extends Node {
  /**
   * @param {DomainChart} chart
   * @param {Object} [options]
   */
  constructor(chart, options) {
    assert && assert(chart instanceof DomainChart);

    // Fields of interest in chart, to improve readability
    const domainProperty = chart.domainProperty;
    const xAxisDescriptionProperty = chart.xAxisDescriptionProperty;
    const spaceMultiplier = chart.spaceMultiplier;
    const timeMultiplier = chart.timeMultiplier;
    options = merge({
      // x axis
      xSpaceLabelProperty: DEFAULT_X_SPACE_LABEL_PROPERTY,
      xTimeLabelProperty: DEFAULT_X_TIME_LABEL_PROPERTY,
      xGridLineSpacing: 1,
      xTickMarkSpacing: 1,
      xTickLabelSpacing: 1,
      xZoomLevelProperty: null,
      // {NumberProperty|null} adds optional zoom buttons

      // y axis
      yAxisStringProperty: FourierMakingWavesStrings.amplitudeStringProperty,
      yGridLineSpacing: 1,
      yTickMarkSpacing: 1,
      yTickLabelSpacing: 1,
      // ChartTransform options
      chartTransformOptions: {
        modelXRange: xAxisDescriptionProperty.value.createRangeForDomain(domainProperty.value, spaceMultiplier, timeMultiplier),
        modelYRange: new Range(0, 1),
        // expected to be set by subclasses
        viewWidth: FMWConstants.CHART_RECTANGLE_SIZE.width,
        viewHeight: FMWConstants.CHART_RECTANGLE_SIZE.height
      },
      // ChartRectangle options
      chartRectangleOptions: {
        // Use the same color as the grid lines. If use a different color (e.g. 'black') then we'll occasionally
        // see a black line appearing and disappearing at the top of the chart as the y-axis range changes.
        // This is because sometimes a grid line will coincide with min/max of the range, and sometimes it won't.
        stroke: FMWColors.chartGridLinesStrokeProperty,
        fill: 'white'
      },
      // RichText options for the x-axis label
      xAxisLabelOptions: {
        font: FMWConstants.AXIS_LABEL_FONT,
        maxWidth: FMWConstants.X_AXIS_LABEL_MAX_WIDTH
      },
      // RichText options for the x-axis label
      yAxisLabelOptions: {
        font: FMWConstants.AXIS_LABEL_FONT,
        maxWidth: 0.85 * FMWConstants.CHART_RECTANGLE_SIZE.height,
        rotation: -Math.PI / 2
      },
      // AxisLine options for both axes
      axisLineOptions: {
        stroke: FMWColors.axisStrokeProperty,
        lineWidth: 1
      },
      // GridLineSet options for both axes
      gridLineSetOptions: {
        stroke: FMWColors.chartGridLinesStrokeProperty,
        lineWidth: 0.5
      },
      // TickMarkSet options for both axes
      tickMarkSetOptions: {
        edge: DEFAULT_EDGE,
        extent: 6
      },
      // TickLabelSet options for the x-axis tick labels
      xTickLabelSetOptions: {
        edge: DEFAULT_EDGE
      },
      // TickLabelSet options for the x-axis tick labels
      yTickLabelSetOptions: {
        edge: DEFAULT_EDGE
      },
      // phet-io options
      tandem: Tandem.REQUIRED
    }, options);

    // the transform between model and view coordinate frames
    const chartTransform = new ChartTransform(options.chartTransformOptions);

    // the chart's background rectangle
    const chartRectangle = new ChartRectangle(chartTransform, options.chartRectangleOptions);
    const xAxisLabelStringProperty = new DerivedProperty([domainProperty, options.xTimeLabelProperty, options.xSpaceLabelProperty], (domain, xTimeLabel, xSpaceLabel) => domain === Domain.TIME ? xTimeLabel : xSpaceLabel);

    // x axis
    const xAxis = new AxisLine(chartTransform, Orientation.HORIZONTAL, options.axisLineOptions);
    const xAxisLabel = new RichText(xAxisLabelStringProperty, options.xAxisLabelOptions); // set based on Domain below
    const xGridLines = new GridLineSet(chartTransform, Orientation.HORIZONTAL, options.xGridLineSpacing, options.gridLineSetOptions);
    const xTickMarks = new TickMarkSet(chartTransform, Orientation.HORIZONTAL, options.xTickMarkSpacing, options.tickMarkSetOptions);
    const xTickLabels = new TickLabelSet(chartTransform, Orientation.HORIZONTAL, options.xTickLabelSpacing, options.xTickLabelSetOptions);

    // y axis
    const yAxis = new AxisLine(chartTransform, Orientation.VERTICAL, options.axisLineOptions);
    const yAxisLabel = new RichText(options.yAxisStringProperty, options.yAxisLabelOptions);
    const yGridLines = new GridLineSet(chartTransform, Orientation.VERTICAL, options.yGridLineSpacing, options.gridLineSetOptions);
    const yTickMarks = new TickMarkSet(chartTransform, Orientation.VERTICAL, options.yTickMarkSpacing, options.tickMarkSetOptions);
    const yTickLabels = new TickLabelSet(chartTransform, Orientation.VERTICAL, options.yTickLabelSpacing, options.yTickLabelSetOptions);

    // Optional x-axis zoom buttons
    let xZoomButtonGroup;
    if (options.xZoomLevelProperty) {
      xZoomButtonGroup = new PlusMinusZoomButtonGroup(options.xZoomLevelProperty, {
        orientation: 'horizontal',
        scale: FMWConstants.ZOOM_BUTTON_GROUP_SCALE,
        touchAreaXDilation: 5,
        touchAreaYDilation: 10,
        // right-bottom corner of chartRectangle
        left: chartRectangle.right + 6,
        bottom: chartRectangle.bottom,
        tandem: options.tandem.createTandem('xZoomButtonGroup')
      });
    }
    assert && assert(!options.children);
    options.children = [xTickMarks, yTickMarks,
    // ticks behind chartRectangle, so we don't see how they extend into chart's interior
    chartRectangle, xAxis, xAxisLabel, xGridLines, xTickLabels, yAxis, yAxisLabel, yGridLines, yTickLabels];
    xZoomButtonGroup && options.children.push(xZoomButtonGroup);
    super(options);

    // Position the x-axis label at the right of the chart. The y position depends on the y range. If the y range
    // is non-negative, then the y-axis label is aligned with the bottom of the chart. Otherwise it's vertically
    // centered on the chart.
    xAxisLabel.boundsProperty.link(bounds => {
      xAxisLabel.left = chartRectangle.right + FMWConstants.X_AXIS_LABEL_SPACING;
      if (chartTransform.modelYRange.min >= 0) {
        xAxisLabel.bottom = chartRectangle.bottom;
      } else {
        xAxisLabel.centerY = chartRectangle.centerY;
      }
    });

    // Position the y-axis label at the left of the chart, vertically centered on chartRectangle.
    yAxisLabel.boundsProperty.link(bounds => {
      yAxisLabel.right = chartRectangle.left - FMWConstants.Y_AXIS_LABEL_SPACING;
      yAxisLabel.centerY = chartRectangle.centerY;
    });

    // Update the x-axis range and decorations.
    Multilink.multilink([domainProperty, xAxisDescriptionProperty], (domain, xAxisDescription) => {
      const value = domain === Domain.TIME ? timeMultiplier : spaceMultiplier;
      const xMin = value * xAxisDescription.range.min;
      const xMax = value * xAxisDescription.range.max;
      chartTransform.setModelXRange(new Range(xMin, xMax));
      xGridLines.setSpacing(xAxisDescription.gridLineSpacing * value);
      xTickMarks.setSpacing(xAxisDescription.tickMarkSpacing * value);
      xTickLabels.setSpacing(xAxisDescription.tickLabelSpacing * value);
      xTickLabels.invalidateTickLabelSet();
    });

    // pdom - traversal order
    // See https://github.com/phetsims/fourier-making-waves/issues/53
    const pdomOrder = [];
    xZoomButtonGroup && pdomOrder.push(xZoomButtonGroup);
    this.pdomOrder = pdomOrder;

    // @protected x-axis fields, for use by subclasses
    this.xGridLines = xGridLines; // {GridLineSet}
    this.xTickLabels = xTickLabels; // {TickLabelSet}

    // @protected y-axis fields, for use by subclasses
    this.yGridLines = yGridLines; // {GridLineSet}
    this.yTickMarks = yTickMarks; // {TickMarkSet}
    this.yTickLabels = yTickLabels; // {TickLabelSet}

    // @public
    this.chartTransform = chartTransform; // {ChartTransform}
    this.chartRectangle = chartRectangle; // {ChartRectangle}
  }

  /**
   * @public
   * @override
   */
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }

  /**
   * Computes the clipArea that will trim any data that is outside of a given amplitude range.
   * This is used to trim anomalies that occur when the x-axis is zoomed way out.
   * See https://github.com/phetsims/fourier-making-waves/issues/121
   * @param {number} minAmplitude
   * @param {number} maxAmplitude
   * @returns {Shape}
   * @protected
   */
  computeClipAreaForAmplitudeRange(minAmplitude, maxAmplitude) {
    assert && assert(typeof minAmplitude === 'number');
    assert && assert(typeof maxAmplitude === 'number');
    assert && assert(minAmplitude < maxAmplitude);
    const chartRectangleBounds = this.chartRectangle.bounds;
    const x1 = chartRectangleBounds.left;
    const x2 = chartRectangleBounds.right;
    const rangeHeight = this.chartTransform.modelToViewY(minAmplitude) - this.chartTransform.modelToViewY(maxAmplitude);
    const yTrim = Math.max(0, (chartRectangleBounds.height - rangeHeight) / 2);
    const y1 = chartRectangleBounds.top + yTrim;
    const y2 = chartRectangleBounds.bottom - yTrim;
    return Shape.bounds(new Bounds2(x1, y1, x2, y2));
  }
}
fourierMakingWaves.register('DomainChartNode', DomainChartNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJNdWx0aWxpbmsiLCJQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJBeGlzTGluZSIsIkNoYXJ0UmVjdGFuZ2xlIiwiQ2hhcnRUcmFuc2Zvcm0iLCJHcmlkTGluZVNldCIsIlRpY2tMYWJlbFNldCIsIlRpY2tNYXJrU2V0IiwiQm91bmRzMiIsIlJhbmdlIiwiU2hhcGUiLCJtZXJnZSIsIk9yaWVudGF0aW9uIiwiUGx1c01pbnVzWm9vbUJ1dHRvbkdyb3VwIiwiTm9kZSIsIlJpY2hUZXh0IiwiVGFuZGVtIiwiZm91cmllck1ha2luZ1dhdmVzIiwiRm91cmllck1ha2luZ1dhdmVzU3RyaW5ncyIsIkZNV0NvbG9ycyIsIkZNV0NvbnN0YW50cyIsIkZNV1N5bWJvbHMiLCJEb21haW4iLCJEb21haW5DaGFydCIsIkRFRkFVTFRfWF9TUEFDRV9MQUJFTF9QUk9QRVJUWSIsInN5bWJvbFVuaXRzU3RyaW5nUHJvcGVydHkiLCJzeW1ib2wiLCJ4U3RyaW5nUHJvcGVydHkiLCJ1bml0cyIsIm1ldGVyc1N0cmluZ1Byb3BlcnR5IiwiREVGQVVMVF9YX1RJTUVfTEFCRUxfUFJPUEVSVFkiLCJ0U3RyaW5nUHJvcGVydHkiLCJtaWxsaXNlY29uZHNTdHJpbmdQcm9wZXJ0eSIsIkRFRkFVTFRfRURHRSIsIkRvbWFpbkNoYXJ0Tm9kZSIsImNvbnN0cnVjdG9yIiwiY2hhcnQiLCJvcHRpb25zIiwiYXNzZXJ0IiwiZG9tYWluUHJvcGVydHkiLCJ4QXhpc0Rlc2NyaXB0aW9uUHJvcGVydHkiLCJzcGFjZU11bHRpcGxpZXIiLCJ0aW1lTXVsdGlwbGllciIsInhTcGFjZUxhYmVsUHJvcGVydHkiLCJ4VGltZUxhYmVsUHJvcGVydHkiLCJ4R3JpZExpbmVTcGFjaW5nIiwieFRpY2tNYXJrU3BhY2luZyIsInhUaWNrTGFiZWxTcGFjaW5nIiwieFpvb21MZXZlbFByb3BlcnR5IiwieUF4aXNTdHJpbmdQcm9wZXJ0eSIsImFtcGxpdHVkZVN0cmluZ1Byb3BlcnR5IiwieUdyaWRMaW5lU3BhY2luZyIsInlUaWNrTWFya1NwYWNpbmciLCJ5VGlja0xhYmVsU3BhY2luZyIsImNoYXJ0VHJhbnNmb3JtT3B0aW9ucyIsIm1vZGVsWFJhbmdlIiwidmFsdWUiLCJjcmVhdGVSYW5nZUZvckRvbWFpbiIsIm1vZGVsWVJhbmdlIiwidmlld1dpZHRoIiwiQ0hBUlRfUkVDVEFOR0xFX1NJWkUiLCJ3aWR0aCIsInZpZXdIZWlnaHQiLCJoZWlnaHQiLCJjaGFydFJlY3RhbmdsZU9wdGlvbnMiLCJzdHJva2UiLCJjaGFydEdyaWRMaW5lc1N0cm9rZVByb3BlcnR5IiwiZmlsbCIsInhBeGlzTGFiZWxPcHRpb25zIiwiZm9udCIsIkFYSVNfTEFCRUxfRk9OVCIsIm1heFdpZHRoIiwiWF9BWElTX0xBQkVMX01BWF9XSURUSCIsInlBeGlzTGFiZWxPcHRpb25zIiwicm90YXRpb24iLCJNYXRoIiwiUEkiLCJheGlzTGluZU9wdGlvbnMiLCJheGlzU3Ryb2tlUHJvcGVydHkiLCJsaW5lV2lkdGgiLCJncmlkTGluZVNldE9wdGlvbnMiLCJ0aWNrTWFya1NldE9wdGlvbnMiLCJlZGdlIiwiZXh0ZW50IiwieFRpY2tMYWJlbFNldE9wdGlvbnMiLCJ5VGlja0xhYmVsU2V0T3B0aW9ucyIsInRhbmRlbSIsIlJFUVVJUkVEIiwiY2hhcnRUcmFuc2Zvcm0iLCJjaGFydFJlY3RhbmdsZSIsInhBeGlzTGFiZWxTdHJpbmdQcm9wZXJ0eSIsImRvbWFpbiIsInhUaW1lTGFiZWwiLCJ4U3BhY2VMYWJlbCIsIlRJTUUiLCJ4QXhpcyIsIkhPUklaT05UQUwiLCJ4QXhpc0xhYmVsIiwieEdyaWRMaW5lcyIsInhUaWNrTWFya3MiLCJ4VGlja0xhYmVscyIsInlBeGlzIiwiVkVSVElDQUwiLCJ5QXhpc0xhYmVsIiwieUdyaWRMaW5lcyIsInlUaWNrTWFya3MiLCJ5VGlja0xhYmVscyIsInhab29tQnV0dG9uR3JvdXAiLCJvcmllbnRhdGlvbiIsInNjYWxlIiwiWk9PTV9CVVRUT05fR1JPVVBfU0NBTEUiLCJ0b3VjaEFyZWFYRGlsYXRpb24iLCJ0b3VjaEFyZWFZRGlsYXRpb24iLCJsZWZ0IiwicmlnaHQiLCJib3R0b20iLCJjcmVhdGVUYW5kZW0iLCJjaGlsZHJlbiIsInB1c2giLCJib3VuZHNQcm9wZXJ0eSIsImxpbmsiLCJib3VuZHMiLCJYX0FYSVNfTEFCRUxfU1BBQ0lORyIsIm1pbiIsImNlbnRlclkiLCJZX0FYSVNfTEFCRUxfU1BBQ0lORyIsIm11bHRpbGluayIsInhBeGlzRGVzY3JpcHRpb24iLCJ4TWluIiwicmFuZ2UiLCJ4TWF4IiwibWF4Iiwic2V0TW9kZWxYUmFuZ2UiLCJzZXRTcGFjaW5nIiwiZ3JpZExpbmVTcGFjaW5nIiwidGlja01hcmtTcGFjaW5nIiwidGlja0xhYmVsU3BhY2luZyIsImludmFsaWRhdGVUaWNrTGFiZWxTZXQiLCJwZG9tT3JkZXIiLCJkaXNwb3NlIiwiY29tcHV0ZUNsaXBBcmVhRm9yQW1wbGl0dWRlUmFuZ2UiLCJtaW5BbXBsaXR1ZGUiLCJtYXhBbXBsaXR1ZGUiLCJjaGFydFJlY3RhbmdsZUJvdW5kcyIsIngxIiwieDIiLCJyYW5nZUhlaWdodCIsIm1vZGVsVG9WaWV3WSIsInlUcmltIiwieTEiLCJ0b3AiLCJ5MiIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRG9tYWluQ2hhcnROb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIwLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERvbWFpbkNoYXJ0Tm9kZSBpcyB0aGUgYmFzZSBjbGFzcyBmb3IgYWxsIG9mIHRoZSBjaGFydHMgaW4gdGhpcyBzaW11bGF0aW9uLCB3aXRoIHRoZSBleGNlcHRpb24gb2YgdGhlIEFtcGxpdHVkZXNcclxuICogY2hhcnQgaW4gdGhlICdEaXNjcmV0ZScgYW5kICdXYXZlIEdhbWUnIHNjcmVlbnMuXHJcbiAqXHJcbiAqIFJlc3BvbnNpYmlsaXRpZXM6XHJcbiAqIC0gYXNzZW1ibGVzIGFsbCBvZiB0aGUgbmVjZXNzYXJ5IGJhbWJvbyBjb21wb25lbnRzXHJcbiAqIC0gYWxsIHRoaW5ncyByZWxhdGVkIHRvIHVwZGF0aW5nIHRoZSB4IChEb21haW4pIGF4aXMsIGhlbmNlIGl0cyBuYW1lLiBJbmNsdWRlcyBhZGp1c3RpbmcgdGhlIHgtYXhpcyByYW5nZSBhbmRcclxuICogICBkZWNvcmF0aW9ucyAoZ3JpZCBsaW5lcywgdGljayBtYXJrcywgbGFiZWxzKSB0byBtYXRjaCB0aGUgRG9tYWluLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgTXVsdGlsaW5rIGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTXVsdGlsaW5rLmpzJztcclxuaW1wb3J0IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1BhdHRlcm5TdHJpbmdQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBBeGlzTGluZSBmcm9tICcuLi8uLi8uLi8uLi9iYW1ib28vanMvQXhpc0xpbmUuanMnO1xyXG5pbXBvcnQgQ2hhcnRSZWN0YW5nbGUgZnJvbSAnLi4vLi4vLi4vLi4vYmFtYm9vL2pzL0NoYXJ0UmVjdGFuZ2xlLmpzJztcclxuaW1wb3J0IENoYXJ0VHJhbnNmb3JtIGZyb20gJy4uLy4uLy4uLy4uL2JhbWJvby9qcy9DaGFydFRyYW5zZm9ybS5qcyc7XHJcbmltcG9ydCBHcmlkTGluZVNldCBmcm9tICcuLi8uLi8uLi8uLi9iYW1ib28vanMvR3JpZExpbmVTZXQuanMnO1xyXG5pbXBvcnQgVGlja0xhYmVsU2V0IGZyb20gJy4uLy4uLy4uLy4uL2JhbWJvby9qcy9UaWNrTGFiZWxTZXQuanMnO1xyXG5pbXBvcnQgVGlja01hcmtTZXQgZnJvbSAnLi4vLi4vLi4vLi4vYmFtYm9vL2pzL1RpY2tNYXJrU2V0LmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IE9yaWVudGF0aW9uIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9PcmllbnRhdGlvbi5qcyc7XHJcbmltcG9ydCBQbHVzTWludXNab29tQnV0dG9uR3JvdXAgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BsdXNNaW51c1pvb21CdXR0b25Hcm91cC5qcyc7XHJcbmltcG9ydCB7IE5vZGUsIFJpY2hUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IGZvdXJpZXJNYWtpbmdXYXZlcyBmcm9tICcuLi8uLi9mb3VyaWVyTWFraW5nV2F2ZXMuanMnO1xyXG5pbXBvcnQgRm91cmllck1ha2luZ1dhdmVzU3RyaW5ncyBmcm9tICcuLi8uLi9Gb3VyaWVyTWFraW5nV2F2ZXNTdHJpbmdzLmpzJztcclxuaW1wb3J0IEZNV0NvbG9ycyBmcm9tICcuLi9GTVdDb2xvcnMuanMnO1xyXG5pbXBvcnQgRk1XQ29uc3RhbnRzIGZyb20gJy4uL0ZNV0NvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBGTVdTeW1ib2xzIGZyb20gJy4uL0ZNV1N5bWJvbHMuanMnO1xyXG5pbXBvcnQgRG9tYWluIGZyb20gJy4uL21vZGVsL0RvbWFpbi5qcyc7XHJcbmltcG9ydCBEb21haW5DaGFydCBmcm9tICcuLi9tb2RlbC9Eb21haW5DaGFydC5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgREVGQVVMVF9YX1NQQUNFX0xBQkVMX1BST1BFUlRZID0gbmV3IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSggRm91cmllck1ha2luZ1dhdmVzU3RyaW5ncy5zeW1ib2xVbml0c1N0cmluZ1Byb3BlcnR5LCB7XHJcbiAgc3ltYm9sOiBGTVdTeW1ib2xzLnhTdHJpbmdQcm9wZXJ0eSxcclxuICB1bml0czogRm91cmllck1ha2luZ1dhdmVzU3RyaW5ncy51bml0cy5tZXRlcnNTdHJpbmdQcm9wZXJ0eVxyXG59ICk7XHJcbmNvbnN0IERFRkFVTFRfWF9USU1FX0xBQkVMX1BST1BFUlRZID0gbmV3IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSggRm91cmllck1ha2luZ1dhdmVzU3RyaW5ncy5zeW1ib2xVbml0c1N0cmluZ1Byb3BlcnR5LCB7XHJcbiAgc3ltYm9sOiBGTVdTeW1ib2xzLnRTdHJpbmdQcm9wZXJ0eSxcclxuICB1bml0czogRm91cmllck1ha2luZ1dhdmVzU3RyaW5ncy51bml0cy5taWxsaXNlY29uZHNTdHJpbmdQcm9wZXJ0eVxyXG59ICk7XHJcbmNvbnN0IERFRkFVTFRfRURHRSA9ICdtaW4nO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRG9tYWluQ2hhcnROb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7RG9tYWluQ2hhcnR9IGNoYXJ0XHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBjaGFydCwgb3B0aW9ucyApIHtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBjaGFydCBpbnN0YW5jZW9mIERvbWFpbkNoYXJ0ICk7XHJcblxyXG4gICAgLy8gRmllbGRzIG9mIGludGVyZXN0IGluIGNoYXJ0LCB0byBpbXByb3ZlIHJlYWRhYmlsaXR5XHJcbiAgICBjb25zdCBkb21haW5Qcm9wZXJ0eSA9IGNoYXJ0LmRvbWFpblByb3BlcnR5O1xyXG4gICAgY29uc3QgeEF4aXNEZXNjcmlwdGlvblByb3BlcnR5ID0gY2hhcnQueEF4aXNEZXNjcmlwdGlvblByb3BlcnR5O1xyXG4gICAgY29uc3Qgc3BhY2VNdWx0aXBsaWVyID0gY2hhcnQuc3BhY2VNdWx0aXBsaWVyO1xyXG4gICAgY29uc3QgdGltZU11bHRpcGxpZXIgPSBjaGFydC50aW1lTXVsdGlwbGllcjtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuXHJcbiAgICAgIC8vIHggYXhpc1xyXG4gICAgICB4U3BhY2VMYWJlbFByb3BlcnR5OiBERUZBVUxUX1hfU1BBQ0VfTEFCRUxfUFJPUEVSVFksXHJcbiAgICAgIHhUaW1lTGFiZWxQcm9wZXJ0eTogREVGQVVMVF9YX1RJTUVfTEFCRUxfUFJPUEVSVFksXHJcbiAgICAgIHhHcmlkTGluZVNwYWNpbmc6IDEsXHJcbiAgICAgIHhUaWNrTWFya1NwYWNpbmc6IDEsXHJcbiAgICAgIHhUaWNrTGFiZWxTcGFjaW5nOiAxLFxyXG4gICAgICB4Wm9vbUxldmVsUHJvcGVydHk6IG51bGwsIC8vIHtOdW1iZXJQcm9wZXJ0eXxudWxsfSBhZGRzIG9wdGlvbmFsIHpvb20gYnV0dG9uc1xyXG5cclxuICAgICAgLy8geSBheGlzXHJcbiAgICAgIHlBeGlzU3RyaW5nUHJvcGVydHk6IEZvdXJpZXJNYWtpbmdXYXZlc1N0cmluZ3MuYW1wbGl0dWRlU3RyaW5nUHJvcGVydHksXHJcbiAgICAgIHlHcmlkTGluZVNwYWNpbmc6IDEsXHJcbiAgICAgIHlUaWNrTWFya1NwYWNpbmc6IDEsXHJcbiAgICAgIHlUaWNrTGFiZWxTcGFjaW5nOiAxLFxyXG5cclxuICAgICAgLy8gQ2hhcnRUcmFuc2Zvcm0gb3B0aW9uc1xyXG4gICAgICBjaGFydFRyYW5zZm9ybU9wdGlvbnM6IHtcclxuICAgICAgICBtb2RlbFhSYW5nZTogeEF4aXNEZXNjcmlwdGlvblByb3BlcnR5LnZhbHVlLmNyZWF0ZVJhbmdlRm9yRG9tYWluKCBkb21haW5Qcm9wZXJ0eS52YWx1ZSwgc3BhY2VNdWx0aXBsaWVyLCB0aW1lTXVsdGlwbGllciApLFxyXG4gICAgICAgIG1vZGVsWVJhbmdlOiBuZXcgUmFuZ2UoIDAsIDEgKSwgLy8gZXhwZWN0ZWQgdG8gYmUgc2V0IGJ5IHN1YmNsYXNzZXNcclxuICAgICAgICB2aWV3V2lkdGg6IEZNV0NvbnN0YW50cy5DSEFSVF9SRUNUQU5HTEVfU0laRS53aWR0aCxcclxuICAgICAgICB2aWV3SGVpZ2h0OiBGTVdDb25zdGFudHMuQ0hBUlRfUkVDVEFOR0xFX1NJWkUuaGVpZ2h0XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBDaGFydFJlY3RhbmdsZSBvcHRpb25zXHJcbiAgICAgIGNoYXJ0UmVjdGFuZ2xlT3B0aW9uczoge1xyXG5cclxuICAgICAgICAvLyBVc2UgdGhlIHNhbWUgY29sb3IgYXMgdGhlIGdyaWQgbGluZXMuIElmIHVzZSBhIGRpZmZlcmVudCBjb2xvciAoZS5nLiAnYmxhY2snKSB0aGVuIHdlJ2xsIG9jY2FzaW9uYWxseVxyXG4gICAgICAgIC8vIHNlZSBhIGJsYWNrIGxpbmUgYXBwZWFyaW5nIGFuZCBkaXNhcHBlYXJpbmcgYXQgdGhlIHRvcCBvZiB0aGUgY2hhcnQgYXMgdGhlIHktYXhpcyByYW5nZSBjaGFuZ2VzLlxyXG4gICAgICAgIC8vIFRoaXMgaXMgYmVjYXVzZSBzb21ldGltZXMgYSBncmlkIGxpbmUgd2lsbCBjb2luY2lkZSB3aXRoIG1pbi9tYXggb2YgdGhlIHJhbmdlLCBhbmQgc29tZXRpbWVzIGl0IHdvbid0LlxyXG4gICAgICAgIHN0cm9rZTogRk1XQ29sb3JzLmNoYXJ0R3JpZExpbmVzU3Ryb2tlUHJvcGVydHksXHJcbiAgICAgICAgZmlsbDogJ3doaXRlJ1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gUmljaFRleHQgb3B0aW9ucyBmb3IgdGhlIHgtYXhpcyBsYWJlbFxyXG4gICAgICB4QXhpc0xhYmVsT3B0aW9uczoge1xyXG4gICAgICAgIGZvbnQ6IEZNV0NvbnN0YW50cy5BWElTX0xBQkVMX0ZPTlQsXHJcbiAgICAgICAgbWF4V2lkdGg6IEZNV0NvbnN0YW50cy5YX0FYSVNfTEFCRUxfTUFYX1dJRFRIXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBSaWNoVGV4dCBvcHRpb25zIGZvciB0aGUgeC1heGlzIGxhYmVsXHJcbiAgICAgIHlBeGlzTGFiZWxPcHRpb25zOiB7XHJcbiAgICAgICAgZm9udDogRk1XQ29uc3RhbnRzLkFYSVNfTEFCRUxfRk9OVCxcclxuICAgICAgICBtYXhXaWR0aDogMC44NSAqIEZNV0NvbnN0YW50cy5DSEFSVF9SRUNUQU5HTEVfU0laRS5oZWlnaHQsXHJcbiAgICAgICAgcm90YXRpb246IC1NYXRoLlBJIC8gMlxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gQXhpc0xpbmUgb3B0aW9ucyBmb3IgYm90aCBheGVzXHJcbiAgICAgIGF4aXNMaW5lT3B0aW9uczoge1xyXG4gICAgICAgIHN0cm9rZTogRk1XQ29sb3JzLmF4aXNTdHJva2VQcm9wZXJ0eSxcclxuICAgICAgICBsaW5lV2lkdGg6IDFcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIEdyaWRMaW5lU2V0IG9wdGlvbnMgZm9yIGJvdGggYXhlc1xyXG4gICAgICBncmlkTGluZVNldE9wdGlvbnM6IHtcclxuICAgICAgICBzdHJva2U6IEZNV0NvbG9ycy5jaGFydEdyaWRMaW5lc1N0cm9rZVByb3BlcnR5LFxyXG4gICAgICAgIGxpbmVXaWR0aDogMC41XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBUaWNrTWFya1NldCBvcHRpb25zIGZvciBib3RoIGF4ZXNcclxuICAgICAgdGlja01hcmtTZXRPcHRpb25zOiB7XHJcbiAgICAgICAgZWRnZTogREVGQVVMVF9FREdFLFxyXG4gICAgICAgIGV4dGVudDogNlxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gVGlja0xhYmVsU2V0IG9wdGlvbnMgZm9yIHRoZSB4LWF4aXMgdGljayBsYWJlbHNcclxuICAgICAgeFRpY2tMYWJlbFNldE9wdGlvbnM6IHtcclxuICAgICAgICBlZGdlOiBERUZBVUxUX0VER0VcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIFRpY2tMYWJlbFNldCBvcHRpb25zIGZvciB0aGUgeC1heGlzIHRpY2sgbGFiZWxzXHJcbiAgICAgIHlUaWNrTGFiZWxTZXRPcHRpb25zOiB7XHJcbiAgICAgICAgZWRnZTogREVGQVVMVF9FREdFXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBwaGV0LWlvIG9wdGlvbnNcclxuICAgICAgdGFuZGVtOiBUYW5kZW0uUkVRVUlSRURcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyB0aGUgdHJhbnNmb3JtIGJldHdlZW4gbW9kZWwgYW5kIHZpZXcgY29vcmRpbmF0ZSBmcmFtZXNcclxuICAgIGNvbnN0IGNoYXJ0VHJhbnNmb3JtID0gbmV3IENoYXJ0VHJhbnNmb3JtKCBvcHRpb25zLmNoYXJ0VHJhbnNmb3JtT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIHRoZSBjaGFydCdzIGJhY2tncm91bmQgcmVjdGFuZ2xlXHJcbiAgICBjb25zdCBjaGFydFJlY3RhbmdsZSA9IG5ldyBDaGFydFJlY3RhbmdsZSggY2hhcnRUcmFuc2Zvcm0sIG9wdGlvbnMuY2hhcnRSZWN0YW5nbGVPcHRpb25zICk7XHJcblxyXG4gICAgY29uc3QgeEF4aXNMYWJlbFN0cmluZ1Byb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyBkb21haW5Qcm9wZXJ0eSwgb3B0aW9ucy54VGltZUxhYmVsUHJvcGVydHksIG9wdGlvbnMueFNwYWNlTGFiZWxQcm9wZXJ0eSBdLFxyXG4gICAgICAoIGRvbWFpbiwgeFRpbWVMYWJlbCwgeFNwYWNlTGFiZWwgKSA9PiAoIGRvbWFpbiA9PT0gRG9tYWluLlRJTUUgKSA/IHhUaW1lTGFiZWwgOiB4U3BhY2VMYWJlbFxyXG4gICAgKTtcclxuXHJcbiAgICAvLyB4IGF4aXNcclxuICAgIGNvbnN0IHhBeGlzID0gbmV3IEF4aXNMaW5lKCBjaGFydFRyYW5zZm9ybSwgT3JpZW50YXRpb24uSE9SSVpPTlRBTCwgb3B0aW9ucy5heGlzTGluZU9wdGlvbnMgKTtcclxuICAgIGNvbnN0IHhBeGlzTGFiZWwgPSBuZXcgUmljaFRleHQoIHhBeGlzTGFiZWxTdHJpbmdQcm9wZXJ0eSwgb3B0aW9ucy54QXhpc0xhYmVsT3B0aW9ucyApOyAvLyBzZXQgYmFzZWQgb24gRG9tYWluIGJlbG93XHJcbiAgICBjb25zdCB4R3JpZExpbmVzID0gbmV3IEdyaWRMaW5lU2V0KCBjaGFydFRyYW5zZm9ybSwgT3JpZW50YXRpb24uSE9SSVpPTlRBTCwgb3B0aW9ucy54R3JpZExpbmVTcGFjaW5nLCBvcHRpb25zLmdyaWRMaW5lU2V0T3B0aW9ucyApO1xyXG4gICAgY29uc3QgeFRpY2tNYXJrcyA9IG5ldyBUaWNrTWFya1NldCggY2hhcnRUcmFuc2Zvcm0sIE9yaWVudGF0aW9uLkhPUklaT05UQUwsIG9wdGlvbnMueFRpY2tNYXJrU3BhY2luZywgb3B0aW9ucy50aWNrTWFya1NldE9wdGlvbnMgKTtcclxuICAgIGNvbnN0IHhUaWNrTGFiZWxzID0gbmV3IFRpY2tMYWJlbFNldCggY2hhcnRUcmFuc2Zvcm0sIE9yaWVudGF0aW9uLkhPUklaT05UQUwsIG9wdGlvbnMueFRpY2tMYWJlbFNwYWNpbmcsIG9wdGlvbnMueFRpY2tMYWJlbFNldE9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyB5IGF4aXNcclxuICAgIGNvbnN0IHlBeGlzID0gbmV3IEF4aXNMaW5lKCBjaGFydFRyYW5zZm9ybSwgT3JpZW50YXRpb24uVkVSVElDQUwsIG9wdGlvbnMuYXhpc0xpbmVPcHRpb25zICk7XHJcbiAgICBjb25zdCB5QXhpc0xhYmVsID0gbmV3IFJpY2hUZXh0KCBvcHRpb25zLnlBeGlzU3RyaW5nUHJvcGVydHksIG9wdGlvbnMueUF4aXNMYWJlbE9wdGlvbnMgKTtcclxuICAgIGNvbnN0IHlHcmlkTGluZXMgPSBuZXcgR3JpZExpbmVTZXQoIGNoYXJ0VHJhbnNmb3JtLCBPcmllbnRhdGlvbi5WRVJUSUNBTCwgb3B0aW9ucy55R3JpZExpbmVTcGFjaW5nLCBvcHRpb25zLmdyaWRMaW5lU2V0T3B0aW9ucyApO1xyXG4gICAgY29uc3QgeVRpY2tNYXJrcyA9IG5ldyBUaWNrTWFya1NldCggY2hhcnRUcmFuc2Zvcm0sIE9yaWVudGF0aW9uLlZFUlRJQ0FMLCBvcHRpb25zLnlUaWNrTWFya1NwYWNpbmcsIG9wdGlvbnMudGlja01hcmtTZXRPcHRpb25zICk7XHJcbiAgICBjb25zdCB5VGlja0xhYmVscyA9IG5ldyBUaWNrTGFiZWxTZXQoIGNoYXJ0VHJhbnNmb3JtLCBPcmllbnRhdGlvbi5WRVJUSUNBTCwgb3B0aW9ucy55VGlja0xhYmVsU3BhY2luZywgb3B0aW9ucy55VGlja0xhYmVsU2V0T3B0aW9ucyApO1xyXG5cclxuICAgIC8vIE9wdGlvbmFsIHgtYXhpcyB6b29tIGJ1dHRvbnNcclxuICAgIGxldCB4Wm9vbUJ1dHRvbkdyb3VwO1xyXG4gICAgaWYgKCBvcHRpb25zLnhab29tTGV2ZWxQcm9wZXJ0eSApIHtcclxuICAgICAgeFpvb21CdXR0b25Hcm91cCA9IG5ldyBQbHVzTWludXNab29tQnV0dG9uR3JvdXAoIG9wdGlvbnMueFpvb21MZXZlbFByb3BlcnR5LCB7XHJcbiAgICAgICAgb3JpZW50YXRpb246ICdob3Jpem9udGFsJyxcclxuICAgICAgICBzY2FsZTogRk1XQ29uc3RhbnRzLlpPT01fQlVUVE9OX0dST1VQX1NDQUxFLFxyXG4gICAgICAgIHRvdWNoQXJlYVhEaWxhdGlvbjogNSxcclxuICAgICAgICB0b3VjaEFyZWFZRGlsYXRpb246IDEwLFxyXG5cclxuICAgICAgICAvLyByaWdodC1ib3R0b20gY29ybmVyIG9mIGNoYXJ0UmVjdGFuZ2xlXHJcbiAgICAgICAgbGVmdDogY2hhcnRSZWN0YW5nbGUucmlnaHQgKyA2LFxyXG4gICAgICAgIGJvdHRvbTogY2hhcnRSZWN0YW5nbGUuYm90dG9tLFxyXG5cclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3hab29tQnV0dG9uR3JvdXAnIClcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoICFvcHRpb25zLmNoaWxkcmVuICk7XHJcbiAgICBvcHRpb25zLmNoaWxkcmVuID0gW1xyXG4gICAgICB4VGlja01hcmtzLCB5VGlja01hcmtzLCAvLyB0aWNrcyBiZWhpbmQgY2hhcnRSZWN0YW5nbGUsIHNvIHdlIGRvbid0IHNlZSBob3cgdGhleSBleHRlbmQgaW50byBjaGFydCdzIGludGVyaW9yXHJcbiAgICAgIGNoYXJ0UmVjdGFuZ2xlLFxyXG4gICAgICB4QXhpcywgeEF4aXNMYWJlbCwgeEdyaWRMaW5lcywgeFRpY2tMYWJlbHMsXHJcbiAgICAgIHlBeGlzLCB5QXhpc0xhYmVsLCB5R3JpZExpbmVzLCB5VGlja0xhYmVsc1xyXG4gICAgXTtcclxuICAgIHhab29tQnV0dG9uR3JvdXAgJiYgb3B0aW9ucy5jaGlsZHJlbi5wdXNoKCB4Wm9vbUJ1dHRvbkdyb3VwICk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBQb3NpdGlvbiB0aGUgeC1heGlzIGxhYmVsIGF0IHRoZSByaWdodCBvZiB0aGUgY2hhcnQuIFRoZSB5IHBvc2l0aW9uIGRlcGVuZHMgb24gdGhlIHkgcmFuZ2UuIElmIHRoZSB5IHJhbmdlXHJcbiAgICAvLyBpcyBub24tbmVnYXRpdmUsIHRoZW4gdGhlIHktYXhpcyBsYWJlbCBpcyBhbGlnbmVkIHdpdGggdGhlIGJvdHRvbSBvZiB0aGUgY2hhcnQuIE90aGVyd2lzZSBpdCdzIHZlcnRpY2FsbHlcclxuICAgIC8vIGNlbnRlcmVkIG9uIHRoZSBjaGFydC5cclxuICAgIHhBeGlzTGFiZWwuYm91bmRzUHJvcGVydHkubGluayggYm91bmRzID0+IHtcclxuICAgICAgeEF4aXNMYWJlbC5sZWZ0ID0gY2hhcnRSZWN0YW5nbGUucmlnaHQgKyBGTVdDb25zdGFudHMuWF9BWElTX0xBQkVMX1NQQUNJTkc7XHJcbiAgICAgIGlmICggY2hhcnRUcmFuc2Zvcm0ubW9kZWxZUmFuZ2UubWluID49IDAgKSB7XHJcbiAgICAgICAgeEF4aXNMYWJlbC5ib3R0b20gPSBjaGFydFJlY3RhbmdsZS5ib3R0b207XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgeEF4aXNMYWJlbC5jZW50ZXJZID0gY2hhcnRSZWN0YW5nbGUuY2VudGVyWTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFBvc2l0aW9uIHRoZSB5LWF4aXMgbGFiZWwgYXQgdGhlIGxlZnQgb2YgdGhlIGNoYXJ0LCB2ZXJ0aWNhbGx5IGNlbnRlcmVkIG9uIGNoYXJ0UmVjdGFuZ2xlLlxyXG4gICAgeUF4aXNMYWJlbC5ib3VuZHNQcm9wZXJ0eS5saW5rKCBib3VuZHMgPT4ge1xyXG4gICAgICB5QXhpc0xhYmVsLnJpZ2h0ID0gY2hhcnRSZWN0YW5nbGUubGVmdCAtIEZNV0NvbnN0YW50cy5ZX0FYSVNfTEFCRUxfU1BBQ0lORztcclxuICAgICAgeUF4aXNMYWJlbC5jZW50ZXJZID0gY2hhcnRSZWN0YW5nbGUuY2VudGVyWTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIHgtYXhpcyByYW5nZSBhbmQgZGVjb3JhdGlvbnMuXHJcbiAgICBNdWx0aWxpbmsubXVsdGlsaW5rKFxyXG4gICAgICBbIGRvbWFpblByb3BlcnR5LCB4QXhpc0Rlc2NyaXB0aW9uUHJvcGVydHkgXSxcclxuICAgICAgKCBkb21haW4sIHhBeGlzRGVzY3JpcHRpb24gKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSAoIGRvbWFpbiA9PT0gRG9tYWluLlRJTUUgKSA/IHRpbWVNdWx0aXBsaWVyIDogc3BhY2VNdWx0aXBsaWVyO1xyXG4gICAgICAgIGNvbnN0IHhNaW4gPSB2YWx1ZSAqIHhBeGlzRGVzY3JpcHRpb24ucmFuZ2UubWluO1xyXG4gICAgICAgIGNvbnN0IHhNYXggPSB2YWx1ZSAqIHhBeGlzRGVzY3JpcHRpb24ucmFuZ2UubWF4O1xyXG4gICAgICAgIGNoYXJ0VHJhbnNmb3JtLnNldE1vZGVsWFJhbmdlKCBuZXcgUmFuZ2UoIHhNaW4sIHhNYXggKSApO1xyXG4gICAgICAgIHhHcmlkTGluZXMuc2V0U3BhY2luZyggeEF4aXNEZXNjcmlwdGlvbi5ncmlkTGluZVNwYWNpbmcgKiB2YWx1ZSApO1xyXG4gICAgICAgIHhUaWNrTWFya3Muc2V0U3BhY2luZyggeEF4aXNEZXNjcmlwdGlvbi50aWNrTWFya1NwYWNpbmcgKiB2YWx1ZSApO1xyXG4gICAgICAgIHhUaWNrTGFiZWxzLnNldFNwYWNpbmcoIHhBeGlzRGVzY3JpcHRpb24udGlja0xhYmVsU3BhY2luZyAqIHZhbHVlICk7XHJcbiAgICAgICAgeFRpY2tMYWJlbHMuaW52YWxpZGF0ZVRpY2tMYWJlbFNldCgpO1xyXG4gICAgICB9ICk7XHJcblxyXG4gICAgLy8gcGRvbSAtIHRyYXZlcnNhbCBvcmRlclxyXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9mb3VyaWVyLW1ha2luZy13YXZlcy9pc3N1ZXMvNTNcclxuICAgIGNvbnN0IHBkb21PcmRlciA9IFtdO1xyXG4gICAgeFpvb21CdXR0b25Hcm91cCAmJiBwZG9tT3JkZXIucHVzaCggeFpvb21CdXR0b25Hcm91cCApO1xyXG4gICAgdGhpcy5wZG9tT3JkZXIgPSBwZG9tT3JkZXI7XHJcblxyXG4gICAgLy8gQHByb3RlY3RlZCB4LWF4aXMgZmllbGRzLCBmb3IgdXNlIGJ5IHN1YmNsYXNzZXNcclxuICAgIHRoaXMueEdyaWRMaW5lcyA9IHhHcmlkTGluZXM7IC8vIHtHcmlkTGluZVNldH1cclxuICAgIHRoaXMueFRpY2tMYWJlbHMgPSB4VGlja0xhYmVsczsgLy8ge1RpY2tMYWJlbFNldH1cclxuXHJcbiAgICAvLyBAcHJvdGVjdGVkIHktYXhpcyBmaWVsZHMsIGZvciB1c2UgYnkgc3ViY2xhc3Nlc1xyXG4gICAgdGhpcy55R3JpZExpbmVzID0geUdyaWRMaW5lczsgLy8ge0dyaWRMaW5lU2V0fVxyXG4gICAgdGhpcy55VGlja01hcmtzID0geVRpY2tNYXJrczsgLy8ge1RpY2tNYXJrU2V0fVxyXG4gICAgdGhpcy55VGlja0xhYmVscyA9IHlUaWNrTGFiZWxzOyAvLyB7VGlja0xhYmVsU2V0fVxyXG5cclxuICAgIC8vIEBwdWJsaWNcclxuICAgIHRoaXMuY2hhcnRUcmFuc2Zvcm0gPSBjaGFydFRyYW5zZm9ybTsgLy8ge0NoYXJ0VHJhbnNmb3JtfVxyXG4gICAgdGhpcy5jaGFydFJlY3RhbmdsZSA9IGNoYXJ0UmVjdGFuZ2xlOyAvLyB7Q2hhcnRSZWN0YW5nbGV9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHVibGljXHJcbiAgICogQG92ZXJyaWRlXHJcbiAgICovXHJcbiAgZGlzcG9zZSgpIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ29tcHV0ZXMgdGhlIGNsaXBBcmVhIHRoYXQgd2lsbCB0cmltIGFueSBkYXRhIHRoYXQgaXMgb3V0c2lkZSBvZiBhIGdpdmVuIGFtcGxpdHVkZSByYW5nZS5cclxuICAgKiBUaGlzIGlzIHVzZWQgdG8gdHJpbSBhbm9tYWxpZXMgdGhhdCBvY2N1ciB3aGVuIHRoZSB4LWF4aXMgaXMgem9vbWVkIHdheSBvdXQuXHJcbiAgICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9mb3VyaWVyLW1ha2luZy13YXZlcy9pc3N1ZXMvMTIxXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IG1pbkFtcGxpdHVkZVxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtYXhBbXBsaXR1ZGVcclxuICAgKiBAcmV0dXJucyB7U2hhcGV9XHJcbiAgICogQHByb3RlY3RlZFxyXG4gICAqL1xyXG4gIGNvbXB1dGVDbGlwQXJlYUZvckFtcGxpdHVkZVJhbmdlKCBtaW5BbXBsaXR1ZGUsIG1heEFtcGxpdHVkZSApIHtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2YgbWluQW1wbGl0dWRlID09PSAnbnVtYmVyJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdHlwZW9mIG1heEFtcGxpdHVkZSA9PT0gJ251bWJlcicgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG1pbkFtcGxpdHVkZSA8IG1heEFtcGxpdHVkZSApO1xyXG5cclxuICAgIGNvbnN0IGNoYXJ0UmVjdGFuZ2xlQm91bmRzID0gdGhpcy5jaGFydFJlY3RhbmdsZS5ib3VuZHM7XHJcbiAgICBjb25zdCB4MSA9IGNoYXJ0UmVjdGFuZ2xlQm91bmRzLmxlZnQ7XHJcbiAgICBjb25zdCB4MiA9IGNoYXJ0UmVjdGFuZ2xlQm91bmRzLnJpZ2h0O1xyXG4gICAgY29uc3QgcmFuZ2VIZWlnaHQgPSB0aGlzLmNoYXJ0VHJhbnNmb3JtLm1vZGVsVG9WaWV3WSggbWluQW1wbGl0dWRlICkgLSB0aGlzLmNoYXJ0VHJhbnNmb3JtLm1vZGVsVG9WaWV3WSggbWF4QW1wbGl0dWRlICk7XHJcbiAgICBjb25zdCB5VHJpbSA9IE1hdGgubWF4KCAwLCAoIGNoYXJ0UmVjdGFuZ2xlQm91bmRzLmhlaWdodCAtIHJhbmdlSGVpZ2h0ICkgLyAyICk7XHJcbiAgICBjb25zdCB5MSA9IGNoYXJ0UmVjdGFuZ2xlQm91bmRzLnRvcCArIHlUcmltO1xyXG4gICAgY29uc3QgeTIgPSBjaGFydFJlY3RhbmdsZUJvdW5kcy5ib3R0b20gLSB5VHJpbTtcclxuICAgIHJldHVybiBTaGFwZS5ib3VuZHMoIG5ldyBCb3VuZHMyKCB4MSwgeTEsIHgyLCB5MiApICk7XHJcbiAgfVxyXG59XHJcblxyXG5mb3VyaWVyTWFraW5nV2F2ZXMucmVnaXN0ZXIoICdEb21haW5DaGFydE5vZGUnLCBEb21haW5DaGFydE5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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