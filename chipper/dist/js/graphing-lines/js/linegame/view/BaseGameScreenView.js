// Copyright 2013-2023, University of Colorado Boulder

/**
 * The base type for the 'Line Game' view.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import ScreenView from '../../../../joist/js/ScreenView.js';
import optionize, { combineOptions } from '../../../../phet-core/js/optionize.js';
import GameAudioPlayer from '../../../../vegas/js/GameAudioPlayer.js';
import GLConstants from '../../common/GLConstants.js';
import graphingLines from '../../graphingLines.js';
import GamePhase from '../model/GamePhase.js';
import PlayNode from './PlayNode.js';
import ResultsNode from './ResultsNode.js';
import SettingsNode from './SettingsNode.js';
export default class BaseGameScreenView extends ScreenView {
  // a node for each 'phase' of the game

  /**
   * @param model
   * @param levelImages - grid of images for the level-selection buttons, ordered by level
   * @param rewardNodeFunctions - functions that create nodes for the game reward, ordered by level
   * @param tandem
   * @param [providedOptions]
   */
  constructor(model, levelImages, rewardNodeFunctions, tandem, providedOptions) {
    const options = optionize()({
      // SelfOptions
      settingsNodeOptions: {},
      // ScreenViewOptions
      layoutBounds: GLConstants.SCREEN_VIEW_LAYOUT_BOUNDS,
      tandem: tandem
    }, providedOptions);
    super(options);

    // sounds
    const audioPlayer = new GameAudioPlayer();
    this.settingsNode = new SettingsNode(model, this.layoutBounds, levelImages, combineOptions({
      tandem: tandem.createTandem('settingsNode')
    }, options.settingsNodeOptions));
    this.playNode = new PlayNode(model, this.layoutBounds, this.visibleBoundsProperty, audioPlayer);
    this.resultsNode = new ResultsNode(model, this.layoutBounds, audioPlayer, rewardNodeFunctions);

    // rendering order
    this.addChild(this.resultsNode);
    this.addChild(this.playNode);
    this.addChild(this.settingsNode);

    // game 'phase' changes
    // unlink unnecessary because BaseGameScreenView exists for the lifetime of the sim.
    model.gamePhaseProperty.link(gamePhase => {
      this.settingsNode.visible = gamePhase === GamePhase.SETTINGS;
      this.playNode.visible = gamePhase === GamePhase.PLAY;
      this.resultsNode.visible = gamePhase === GamePhase.RESULTS;
    });
  }
  step(dt) {
    if (this.resultsNode.visible) {
      this.resultsNode.step(dt);
    }
    super.step(dt);
  }
}
graphingLines.register('BaseGameScreenView', BaseGameScreenView);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTY3JlZW5WaWV3Iiwib3B0aW9uaXplIiwiY29tYmluZU9wdGlvbnMiLCJHYW1lQXVkaW9QbGF5ZXIiLCJHTENvbnN0YW50cyIsImdyYXBoaW5nTGluZXMiLCJHYW1lUGhhc2UiLCJQbGF5Tm9kZSIsIlJlc3VsdHNOb2RlIiwiU2V0dGluZ3NOb2RlIiwiQmFzZUdhbWVTY3JlZW5WaWV3IiwiY29uc3RydWN0b3IiLCJtb2RlbCIsImxldmVsSW1hZ2VzIiwicmV3YXJkTm9kZUZ1bmN0aW9ucyIsInRhbmRlbSIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJzZXR0aW5nc05vZGVPcHRpb25zIiwibGF5b3V0Qm91bmRzIiwiU0NSRUVOX1ZJRVdfTEFZT1VUX0JPVU5EUyIsImF1ZGlvUGxheWVyIiwic2V0dGluZ3NOb2RlIiwiY3JlYXRlVGFuZGVtIiwicGxheU5vZGUiLCJ2aXNpYmxlQm91bmRzUHJvcGVydHkiLCJyZXN1bHRzTm9kZSIsImFkZENoaWxkIiwiZ2FtZVBoYXNlUHJvcGVydHkiLCJsaW5rIiwiZ2FtZVBoYXNlIiwidmlzaWJsZSIsIlNFVFRJTkdTIiwiUExBWSIsIlJFU1VMVFMiLCJzdGVwIiwiZHQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkJhc2VHYW1lU2NyZWVuVmlldy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBUaGUgYmFzZSB0eXBlIGZvciB0aGUgJ0xpbmUgR2FtZScgdmlldy5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgU2NyZWVuVmlldywgeyBTY3JlZW5WaWV3T3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL2pvaXN0L2pzL1NjcmVlblZpZXcuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IGNvbWJpbmVPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBTdHJpY3RPbWl0IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9TdHJpY3RPbWl0LmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IEdhbWVBdWRpb1BsYXllciBmcm9tICcuLi8uLi8uLi8uLi92ZWdhcy9qcy9HYW1lQXVkaW9QbGF5ZXIuanMnO1xyXG5pbXBvcnQgR0xDb25zdGFudHMgZnJvbSAnLi4vLi4vY29tbW9uL0dMQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IGdyYXBoaW5nTGluZXMgZnJvbSAnLi4vLi4vZ3JhcGhpbmdMaW5lcy5qcyc7XHJcbmltcG9ydCBCYXNlR2FtZU1vZGVsIGZyb20gJy4uL21vZGVsL0Jhc2VHYW1lTW9kZWwuanMnO1xyXG5pbXBvcnQgR2FtZVBoYXNlIGZyb20gJy4uL21vZGVsL0dhbWVQaGFzZS5qcyc7XHJcbmltcG9ydCBQbGF5Tm9kZSBmcm9tICcuL1BsYXlOb2RlLmpzJztcclxuaW1wb3J0IFJlc3VsdHNOb2RlLCB7IFJld2FyZE5vZGVGdW5jdGlvbiB9IGZyb20gJy4vUmVzdWx0c05vZGUuanMnO1xyXG5pbXBvcnQgU2V0dGluZ3NOb2RlLCB7IFNldHRpbmdzTm9kZU9wdGlvbnMgfSBmcm9tICcuL1NldHRpbmdzTm9kZS5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIHNldHRpbmdzTm9kZU9wdGlvbnM/OiBTdHJpY3RPbWl0PFNldHRpbmdzTm9kZU9wdGlvbnMsICd0YW5kZW0nPjsgLy8gcHJvcGFnYXRlZCB0byBTZXR0aW5nc05vZGVcclxufTtcclxuXHJcbnR5cGUgQmFzZUdhbWVTY3JlZW5WaWV3T3B0aW9ucyA9IFNlbGZPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZUdhbWVTY3JlZW5WaWV3IGV4dGVuZHMgU2NyZWVuVmlldyB7XHJcblxyXG4gIC8vIGEgbm9kZSBmb3IgZWFjaCAncGhhc2UnIG9mIHRoZSBnYW1lXHJcbiAgcHJpdmF0ZSByZWFkb25seSBzZXR0aW5nc05vZGU6IFNldHRpbmdzTm9kZTtcclxuICBwcml2YXRlIHJlYWRvbmx5IHBsYXlOb2RlOiBQbGF5Tm9kZTtcclxuICBwcml2YXRlIHJlYWRvbmx5IHJlc3VsdHNOb2RlOiBSZXN1bHRzTm9kZTtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIG1vZGVsXHJcbiAgICogQHBhcmFtIGxldmVsSW1hZ2VzIC0gZ3JpZCBvZiBpbWFnZXMgZm9yIHRoZSBsZXZlbC1zZWxlY3Rpb24gYnV0dG9ucywgb3JkZXJlZCBieSBsZXZlbFxyXG4gICAqIEBwYXJhbSByZXdhcmROb2RlRnVuY3Rpb25zIC0gZnVuY3Rpb25zIHRoYXQgY3JlYXRlIG5vZGVzIGZvciB0aGUgZ2FtZSByZXdhcmQsIG9yZGVyZWQgYnkgbGV2ZWxcclxuICAgKiBAcGFyYW0gdGFuZGVtXHJcbiAgICogQHBhcmFtIFtwcm92aWRlZE9wdGlvbnNdXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBtb2RlbDogQmFzZUdhbWVNb2RlbCxcclxuICAgICAgICAgICAgICAgICAgICAgIGxldmVsSW1hZ2VzOiBIVE1MSW1hZ2VFbGVtZW50W10sXHJcbiAgICAgICAgICAgICAgICAgICAgICByZXdhcmROb2RlRnVuY3Rpb25zOiBSZXdhcmROb2RlRnVuY3Rpb25bXSxcclxuICAgICAgICAgICAgICAgICAgICAgIHRhbmRlbTogVGFuZGVtLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZWRPcHRpb25zPzogQmFzZUdhbWVTY3JlZW5WaWV3T3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEJhc2VHYW1lU2NyZWVuVmlld09wdGlvbnMsIFNlbGZPcHRpb25zLCBTY3JlZW5WaWV3T3B0aW9ucz4oKSgge1xyXG5cclxuICAgICAgLy8gU2VsZk9wdGlvbnNcclxuICAgICAgc2V0dGluZ3NOb2RlT3B0aW9uczoge30sXHJcblxyXG4gICAgICAvLyBTY3JlZW5WaWV3T3B0aW9uc1xyXG4gICAgICBsYXlvdXRCb3VuZHM6IEdMQ29uc3RhbnRzLlNDUkVFTl9WSUVXX0xBWU9VVF9CT1VORFMsXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIHNvdW5kc1xyXG4gICAgY29uc3QgYXVkaW9QbGF5ZXIgPSBuZXcgR2FtZUF1ZGlvUGxheWVyKCk7XHJcblxyXG4gICAgdGhpcy5zZXR0aW5nc05vZGUgPSBuZXcgU2V0dGluZ3NOb2RlKCBtb2RlbCwgdGhpcy5sYXlvdXRCb3VuZHMsIGxldmVsSW1hZ2VzLCBjb21iaW5lT3B0aW9uczxTZXR0aW5nc05vZGVPcHRpb25zPigge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdzZXR0aW5nc05vZGUnIClcclxuICAgIH0sIG9wdGlvbnMuc2V0dGluZ3NOb2RlT3B0aW9ucyApICk7XHJcbiAgICB0aGlzLnBsYXlOb2RlID0gbmV3IFBsYXlOb2RlKCBtb2RlbCwgdGhpcy5sYXlvdXRCb3VuZHMsIHRoaXMudmlzaWJsZUJvdW5kc1Byb3BlcnR5LCBhdWRpb1BsYXllciApO1xyXG4gICAgdGhpcy5yZXN1bHRzTm9kZSA9IG5ldyBSZXN1bHRzTm9kZSggbW9kZWwsIHRoaXMubGF5b3V0Qm91bmRzLCBhdWRpb1BsYXllciwgcmV3YXJkTm9kZUZ1bmN0aW9ucyApO1xyXG5cclxuICAgIC8vIHJlbmRlcmluZyBvcmRlclxyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5yZXN1bHRzTm9kZSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5wbGF5Tm9kZSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5zZXR0aW5nc05vZGUgKTtcclxuXHJcbiAgICAvLyBnYW1lICdwaGFzZScgY2hhbmdlc1xyXG4gICAgLy8gdW5saW5rIHVubmVjZXNzYXJ5IGJlY2F1c2UgQmFzZUdhbWVTY3JlZW5WaWV3IGV4aXN0cyBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBzaW0uXHJcbiAgICBtb2RlbC5nYW1lUGhhc2VQcm9wZXJ0eS5saW5rKCBnYW1lUGhhc2UgPT4ge1xyXG4gICAgICB0aGlzLnNldHRpbmdzTm9kZS52aXNpYmxlID0gKCBnYW1lUGhhc2UgPT09IEdhbWVQaGFzZS5TRVRUSU5HUyApO1xyXG4gICAgICB0aGlzLnBsYXlOb2RlLnZpc2libGUgPSAoIGdhbWVQaGFzZSA9PT0gR2FtZVBoYXNlLlBMQVkgKTtcclxuICAgICAgdGhpcy5yZXN1bHRzTm9kZS52aXNpYmxlID0gKCBnYW1lUGhhc2UgPT09IEdhbWVQaGFzZS5SRVNVTFRTICk7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgc3RlcCggZHQ6IG51bWJlciApOiB2b2lkIHtcclxuICAgIGlmICggdGhpcy5yZXN1bHRzTm9kZS52aXNpYmxlICkge1xyXG4gICAgICB0aGlzLnJlc3VsdHNOb2RlLnN0ZXAoIGR0ICk7XHJcbiAgICB9XHJcbiAgICBzdXBlci5zdGVwKCBkdCApO1xyXG4gIH1cclxufVxyXG5cclxuZ3JhcGhpbmdMaW5lcy5yZWdpc3RlciggJ0Jhc2VHYW1lU2NyZWVuVmlldycsIEJhc2VHYW1lU2NyZWVuVmlldyApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxVQUFVLE1BQTZCLG9DQUFvQztBQUNsRixPQUFPQyxTQUFTLElBQUlDLGNBQWMsUUFBUSx1Q0FBdUM7QUFHakYsT0FBT0MsZUFBZSxNQUFNLHlDQUF5QztBQUNyRSxPQUFPQyxXQUFXLE1BQU0sNkJBQTZCO0FBQ3JELE9BQU9DLGFBQWEsTUFBTSx3QkFBd0I7QUFFbEQsT0FBT0MsU0FBUyxNQUFNLHVCQUF1QjtBQUM3QyxPQUFPQyxRQUFRLE1BQU0sZUFBZTtBQUNwQyxPQUFPQyxXQUFXLE1BQThCLGtCQUFrQjtBQUNsRSxPQUFPQyxZQUFZLE1BQStCLG1CQUFtQjtBQVFyRSxlQUFlLE1BQU1DLGtCQUFrQixTQUFTVixVQUFVLENBQUM7RUFFekQ7O0VBS0E7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDU1csV0FBV0EsQ0FBRUMsS0FBb0IsRUFDcEJDLFdBQStCLEVBQy9CQyxtQkFBeUMsRUFDekNDLE1BQWMsRUFDZEMsZUFBMkMsRUFBRztJQUVoRSxNQUFNQyxPQUFPLEdBQUdoQixTQUFTLENBQTRELENBQUMsQ0FBRTtNQUV0RjtNQUNBaUIsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDO01BRXZCO01BQ0FDLFlBQVksRUFBRWYsV0FBVyxDQUFDZ0IseUJBQXlCO01BQ25ETCxNQUFNLEVBQUVBO0lBQ1YsQ0FBQyxFQUFFQyxlQUFnQixDQUFDO0lBRXBCLEtBQUssQ0FBRUMsT0FBUSxDQUFDOztJQUVoQjtJQUNBLE1BQU1JLFdBQVcsR0FBRyxJQUFJbEIsZUFBZSxDQUFDLENBQUM7SUFFekMsSUFBSSxDQUFDbUIsWUFBWSxHQUFHLElBQUliLFlBQVksQ0FBRUcsS0FBSyxFQUFFLElBQUksQ0FBQ08sWUFBWSxFQUFFTixXQUFXLEVBQUVYLGNBQWMsQ0FBdUI7TUFDaEhhLE1BQU0sRUFBRUEsTUFBTSxDQUFDUSxZQUFZLENBQUUsY0FBZTtJQUM5QyxDQUFDLEVBQUVOLE9BQU8sQ0FBQ0MsbUJBQW9CLENBQUUsQ0FBQztJQUNsQyxJQUFJLENBQUNNLFFBQVEsR0FBRyxJQUFJakIsUUFBUSxDQUFFSyxLQUFLLEVBQUUsSUFBSSxDQUFDTyxZQUFZLEVBQUUsSUFBSSxDQUFDTSxxQkFBcUIsRUFBRUosV0FBWSxDQUFDO0lBQ2pHLElBQUksQ0FBQ0ssV0FBVyxHQUFHLElBQUlsQixXQUFXLENBQUVJLEtBQUssRUFBRSxJQUFJLENBQUNPLFlBQVksRUFBRUUsV0FBVyxFQUFFUCxtQkFBb0IsQ0FBQzs7SUFFaEc7SUFDQSxJQUFJLENBQUNhLFFBQVEsQ0FBRSxJQUFJLENBQUNELFdBQVksQ0FBQztJQUNqQyxJQUFJLENBQUNDLFFBQVEsQ0FBRSxJQUFJLENBQUNILFFBQVMsQ0FBQztJQUM5QixJQUFJLENBQUNHLFFBQVEsQ0FBRSxJQUFJLENBQUNMLFlBQWEsQ0FBQzs7SUFFbEM7SUFDQTtJQUNBVixLQUFLLENBQUNnQixpQkFBaUIsQ0FBQ0MsSUFBSSxDQUFFQyxTQUFTLElBQUk7TUFDekMsSUFBSSxDQUFDUixZQUFZLENBQUNTLE9BQU8sR0FBS0QsU0FBUyxLQUFLeEIsU0FBUyxDQUFDMEIsUUFBVTtNQUNoRSxJQUFJLENBQUNSLFFBQVEsQ0FBQ08sT0FBTyxHQUFLRCxTQUFTLEtBQUt4QixTQUFTLENBQUMyQixJQUFNO01BQ3hELElBQUksQ0FBQ1AsV0FBVyxDQUFDSyxPQUFPLEdBQUtELFNBQVMsS0FBS3hCLFNBQVMsQ0FBQzRCLE9BQVM7SUFDaEUsQ0FBRSxDQUFDO0VBQ0w7RUFFZ0JDLElBQUlBLENBQUVDLEVBQVUsRUFBUztJQUN2QyxJQUFLLElBQUksQ0FBQ1YsV0FBVyxDQUFDSyxPQUFPLEVBQUc7TUFDOUIsSUFBSSxDQUFDTCxXQUFXLENBQUNTLElBQUksQ0FBRUMsRUFBRyxDQUFDO0lBQzdCO0lBQ0EsS0FBSyxDQUFDRCxJQUFJLENBQUVDLEVBQUcsQ0FBQztFQUNsQjtBQUNGO0FBRUEvQixhQUFhLENBQUNnQyxRQUFRLENBQUUsb0JBQW9CLEVBQUUzQixrQkFBbUIsQ0FBQyJ9