// Copyright 2013-2023, University of Colorado Boulder

/**
 * BaseGameModel is the base class for LineGameModel and GSILineGameModel.
 *
 * Responsibilities include:
 * - creation of challenges (delegated to factory)
 * - management of game state
 * - management of game results
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import EnumerationProperty from '../../../../axon/js/EnumerationProperty.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Property from '../../../../axon/js/Property.js';
import dotRandom from '../../../../dot/js/dotRandom.js';
import GameTimer from '../../../../vegas/js/GameTimer.js';
import GLConstants from '../../common/GLConstants.js';
import GLQueryParameters from '../../common/GLQueryParameters.js';
import Line from '../../common/model/Line.js';
import graphingLines from '../../graphingLines.js';
import EquationForm from './EquationForm.js';
import GamePhase from './GamePhase.js';
import GraphTheLine from './GraphTheLine.js';
import ManipulationMode from './ManipulationMode.js';
import PlayState from './PlayState.js';

// constants
const INITIAL_GAME_PHASE = GamePhase.SETTINGS;
const CHALLENGES_PER_GAME = 6;
const DUMMY_CHALLENGE = new GraphTheLine('', Line.createSlopeIntercept(1, 1, 1), EquationForm.SLOPE_INTERCEPT, ManipulationMode.SLOPE, GLConstants.X_AXIS_RANGE, GLConstants.Y_AXIS_RANGE);
export default class BaseGameModel {
  // how many points the user has earned for the current game

  // null if a level has no best time yet

  // set this using setGamePhase

  constructor(challengeFactories, tandem) {
    this.challengeFactories = challengeFactories;
    this.levelProperty = new NumberProperty(0, {
      numberType: 'Integer'
    });
    this.soundEnabledProperty = new BooleanProperty(true);
    this.timerEnabledProperty = new BooleanProperty(false);
    this.scoreProperty = new NumberProperty(0, {
      numberType: 'Integer'
    });
    this.challengeProperty = new Property(DUMMY_CHALLENGE);
    this.challengeIndexProperty = new NumberProperty(0, {
      numberType: 'Integer'
    });
    this.challengesPerGameProperty = new NumberProperty(CHALLENGES_PER_GAME, {
      numberType: 'Integer'
    });
    this.playStateProperty = new EnumerationProperty(PlayState.NONE, {
      reentrant: true // see https://github.com/phetsims/graphing-lines/issues/102
    });

    this.challenges = []; // {Challenge[]}
    this.timer = new GameTimer();
    this.numberOfLevels = challengeFactories.length;
    this.maxPointsPerChallenge = 2;
    this.bestScoreProperties = []; // {NumberProperty[]} best scores for each level
    this.bestTimeProperties = []; // {Property.<number|null>[]} best times for each level, in ms
    this.isNewBestTime = false; // is the time for the most-recently-completed game a new best time?
    for (let level = 0; level < this.numberOfLevels; level++) {
      this.bestScoreProperties.push(new NumberProperty(0, {
        numberType: 'Integer'
      }));
      this.bestTimeProperties.push(new Property(null));
    }
    this.gamePhaseProperty = new EnumerationProperty(INITIAL_GAME_PHASE);
    this.initChallenges();

    // Do this after initChallenges, because this will fire immediately and needs to have an initial set of challenges.
    // unlink is unnecessary since BaseGameModel exists for the lifetime of the sim.
    this.playStateProperty.link(playState => {
      const challengeIndex = this.challengeIndexProperty.value;
      const isLastChallenge = challengeIndex === this.challenges.length - 1;
      if (isLastChallenge && (playState === PlayState.NEXT || playState === PlayState.SHOW_ANSWER)) {
        // game over, stop the timer
        this.timer.stop();
      }
      if (playState === PlayState.FIRST_CHECK) {
        const level = this.levelProperty.value;
        const score = this.scoreProperty.value;
        if (isLastChallenge) {
          // game has been completed
          this.setGamePhase(GamePhase.RESULTS);
          if (score > this.bestScoreProperties[level].value) {
            this.bestScoreProperties[level].value = score;
          }
        } else {
          // next challenge
          const nextChallengeIndex = challengeIndex + 1;
          this.challengeIndexProperty.value = nextChallengeIndex;
          this.challengeProperty.value = this.challenges[nextChallengeIndex];
        }
      } else if (playState === PlayState.NEXT) {
        this.challengeProperty.value.setAnswerVisible(true);
      }
    });
    if (GLQueryParameters.verifyChallenges) {
      this.verifyChallenges();
    }
  }

  /**
   * Sets the game phase. Call this instead of setting gamePhaseProperty directly,
   * because there are tasks that needs to be done before listeners are notified.
   */
  setGamePhase(gamePhase) {
    if (gamePhase !== this.gamePhaseProperty.value) {
      // Do tasks that need to be done before notifying listeners.
      if (gamePhase === GamePhase.SETTINGS) {
        this.playStateProperty.value = PlayState.NONE;
        this.timer.stop();
      } else if (gamePhase === GamePhase.PLAY) {
        this.initChallenges();
        this.playStateProperty.value = PlayState.FIRST_CHECK;
        this.scoreProperty.value = 0;
        this.timer.start();
      } else if (gamePhase === GamePhase.RESULTS) {
        this.playStateProperty.value = PlayState.NONE;
        this.updateBestTime();
      } else {
        throw new Error(`unsupported game phase: ${gamePhase}`);
      }

      // Change the Property, which notifies listeners
      this.gamePhaseProperty.value = gamePhase;
    }
  }
  reset() {
    this.levelProperty.reset();
    this.soundEnabledProperty.reset();
    this.timerEnabledProperty.reset();
    this.scoreProperty.reset();
    this.challengeProperty.reset();
    this.challengeIndexProperty.reset();
    this.challengesPerGameProperty.reset();
    this.playStateProperty.reset();
    this.setGamePhase(INITIAL_GAME_PHASE);
    this.resetBestScores();
    this.resetBestTimes();
    this.initChallenges(); // takes care of challengeProperty, challengeIndexProperty, challengesPerGameProperty
  }

  // Resets the best score to zero for every level.
  resetBestScores() {
    this.bestScoreProperties.forEach(property => {
      property.value = 0;
    });
  }

  // Resets the best times to null (no time) for every level.
  resetBestTimes() {
    this.bestTimeProperties.forEach(property => {
      property.value = null;
    });
  }
  isPerfectScore() {
    return this.scoreProperty.value === this.getPerfectScore();
  }

  // Gets the number of points in a perfect score (ie, correct answers for all challenges on the first try)
  getPerfectScore() {
    return this.challenges.length * this.computePoints(1);
  }

  // Compute points to be awarded for a correct answer.
  computePoints(attempts) {
    return Math.max(0, this.maxPointsPerChallenge - attempts + 1);
  }

  /**
   * Skips the current challenge.
   * This is a developer feature.
   * Score and best times are meaningless after using this.
   */
  skipCurrentChallenge() {
    this.playStateProperty.value = PlayState.NEXT;
    this.playStateProperty.value = PlayState.FIRST_CHECK;
  }

  /**
   * Replays the current challenge.
   * This is a developer feature.
   * Score and best times are meaningless after using this.
   */
  replayCurrentChallenge() {
    this.challengeProperty.value.reset();
    this.challengeIndexProperty.value = this.challengeIndexProperty.value - 1;
    this.challengeProperty.value = DUMMY_CHALLENGE; // force an update
    this.playStateProperty.value = PlayState.FIRST_CHECK;
  }

  // Updates the best time for the current level, at the end of a timed game with a perfect score.
  updateBestTime() {
    assert && assert(!this.timer.isRunningProperty.value);
    this.isNewBestTime = false;
    if (this.timerEnabledProperty.value && this.isPerfectScore()) {
      const level = this.levelProperty.value;
      const time = this.timer.elapsedTimeProperty.value;
      const bestTime = this.bestTimeProperties[level].value;
      if (!bestTime) {
        // There was no previous best time for this level.
        this.bestTimeProperties[level].value = time;
      } else if (time < bestTime) {
        // We have a new best time for this level.
        this.bestTimeProperties[level].value = time;
        this.isNewBestTime = true;
      }
    }
  }

  // Initializes a new set of challenges for the current level.
  initChallenges() {
    // force update
    this.challengeIndexProperty.value = -1;

    // level
    const level = this.levelProperty.value;
    assert && assert(level >= 0 && level < this.challengeFactories.length);

    // generate challenges
    this.challenges = this.challengeFactories[level].createChallenges();
    if (GLQueryParameters.shuffle) {
      this.challenges = dotRandom.shuffle(this.challenges);
    }

    // set the number of challenges
    this.challengesPerGameProperty.value = this.challenges.length;
    assert && assert(this.challengesPerGameProperty.value === CHALLENGES_PER_GAME);
  }

  // Verify challenge creation.
  verifyChallenges() {
    console.log('begin: verify creation of challenges');
    for (let level = 0; level < this.challengeFactories.length; level++) {
      console.log(`verifying level ${level}...`);
      for (let i = 0; i < 2000; i++) {
        this.challengeFactories[level].createChallenges();
      }
    }
    console.log('end: verify creation of challenges');
  }
}
graphingLines.register('BaseGameModel', BaseGameModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJFbnVtZXJhdGlvblByb3BlcnR5IiwiTnVtYmVyUHJvcGVydHkiLCJQcm9wZXJ0eSIsImRvdFJhbmRvbSIsIkdhbWVUaW1lciIsIkdMQ29uc3RhbnRzIiwiR0xRdWVyeVBhcmFtZXRlcnMiLCJMaW5lIiwiZ3JhcGhpbmdMaW5lcyIsIkVxdWF0aW9uRm9ybSIsIkdhbWVQaGFzZSIsIkdyYXBoVGhlTGluZSIsIk1hbmlwdWxhdGlvbk1vZGUiLCJQbGF5U3RhdGUiLCJJTklUSUFMX0dBTUVfUEhBU0UiLCJTRVRUSU5HUyIsIkNIQUxMRU5HRVNfUEVSX0dBTUUiLCJEVU1NWV9DSEFMTEVOR0UiLCJjcmVhdGVTbG9wZUludGVyY2VwdCIsIlNMT1BFX0lOVEVSQ0VQVCIsIlNMT1BFIiwiWF9BWElTX1JBTkdFIiwiWV9BWElTX1JBTkdFIiwiQmFzZUdhbWVNb2RlbCIsImNvbnN0cnVjdG9yIiwiY2hhbGxlbmdlRmFjdG9yaWVzIiwidGFuZGVtIiwibGV2ZWxQcm9wZXJ0eSIsIm51bWJlclR5cGUiLCJzb3VuZEVuYWJsZWRQcm9wZXJ0eSIsInRpbWVyRW5hYmxlZFByb3BlcnR5Iiwic2NvcmVQcm9wZXJ0eSIsImNoYWxsZW5nZVByb3BlcnR5IiwiY2hhbGxlbmdlSW5kZXhQcm9wZXJ0eSIsImNoYWxsZW5nZXNQZXJHYW1lUHJvcGVydHkiLCJwbGF5U3RhdGVQcm9wZXJ0eSIsIk5PTkUiLCJyZWVudHJhbnQiLCJjaGFsbGVuZ2VzIiwidGltZXIiLCJudW1iZXJPZkxldmVscyIsImxlbmd0aCIsIm1heFBvaW50c1BlckNoYWxsZW5nZSIsImJlc3RTY29yZVByb3BlcnRpZXMiLCJiZXN0VGltZVByb3BlcnRpZXMiLCJpc05ld0Jlc3RUaW1lIiwibGV2ZWwiLCJwdXNoIiwiZ2FtZVBoYXNlUHJvcGVydHkiLCJpbml0Q2hhbGxlbmdlcyIsImxpbmsiLCJwbGF5U3RhdGUiLCJjaGFsbGVuZ2VJbmRleCIsInZhbHVlIiwiaXNMYXN0Q2hhbGxlbmdlIiwiTkVYVCIsIlNIT1dfQU5TV0VSIiwic3RvcCIsIkZJUlNUX0NIRUNLIiwic2NvcmUiLCJzZXRHYW1lUGhhc2UiLCJSRVNVTFRTIiwibmV4dENoYWxsZW5nZUluZGV4Iiwic2V0QW5zd2VyVmlzaWJsZSIsInZlcmlmeUNoYWxsZW5nZXMiLCJnYW1lUGhhc2UiLCJQTEFZIiwic3RhcnQiLCJ1cGRhdGVCZXN0VGltZSIsIkVycm9yIiwicmVzZXQiLCJyZXNldEJlc3RTY29yZXMiLCJyZXNldEJlc3RUaW1lcyIsImZvckVhY2giLCJwcm9wZXJ0eSIsImlzUGVyZmVjdFNjb3JlIiwiZ2V0UGVyZmVjdFNjb3JlIiwiY29tcHV0ZVBvaW50cyIsImF0dGVtcHRzIiwiTWF0aCIsIm1heCIsInNraXBDdXJyZW50Q2hhbGxlbmdlIiwicmVwbGF5Q3VycmVudENoYWxsZW5nZSIsImFzc2VydCIsImlzUnVubmluZ1Byb3BlcnR5IiwidGltZSIsImVsYXBzZWRUaW1lUHJvcGVydHkiLCJiZXN0VGltZSIsImNyZWF0ZUNoYWxsZW5nZXMiLCJzaHVmZmxlIiwiY29uc29sZSIsImxvZyIsImkiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkJhc2VHYW1lTW9kZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTMtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQmFzZUdhbWVNb2RlbCBpcyB0aGUgYmFzZSBjbGFzcyBmb3IgTGluZUdhbWVNb2RlbCBhbmQgR1NJTGluZUdhbWVNb2RlbC5cclxuICpcclxuICogUmVzcG9uc2liaWxpdGllcyBpbmNsdWRlOlxyXG4gKiAtIGNyZWF0aW9uIG9mIGNoYWxsZW5nZXMgKGRlbGVnYXRlZCB0byBmYWN0b3J5KVxyXG4gKiAtIG1hbmFnZW1lbnQgb2YgZ2FtZSBzdGF0ZVxyXG4gKiAtIG1hbmFnZW1lbnQgb2YgZ2FtZSByZXN1bHRzXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IEJvb2xlYW5Qcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Jvb2xlYW5Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBFbnVtZXJhdGlvblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRW51bWVyYXRpb25Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBOdW1iZXJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL051bWJlclByb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgZG90UmFuZG9tIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9kb3RSYW5kb20uanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgR2FtZVRpbWVyIGZyb20gJy4uLy4uLy4uLy4uL3ZlZ2FzL2pzL0dhbWVUaW1lci5qcyc7XHJcbmltcG9ydCBHTENvbnN0YW50cyBmcm9tICcuLi8uLi9jb21tb24vR0xDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgR0xRdWVyeVBhcmFtZXRlcnMgZnJvbSAnLi4vLi4vY29tbW9uL0dMUXVlcnlQYXJhbWV0ZXJzLmpzJztcclxuaW1wb3J0IExpbmUgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0xpbmUuanMnO1xyXG5pbXBvcnQgZ3JhcGhpbmdMaW5lcyBmcm9tICcuLi8uLi9ncmFwaGluZ0xpbmVzLmpzJztcclxuaW1wb3J0IEJhc2VDaGFsbGVuZ2VGYWN0b3J5IGZyb20gJy4vQmFzZUNoYWxsZW5nZUZhY3RvcnkuanMnO1xyXG5pbXBvcnQgQ2hhbGxlbmdlIGZyb20gJy4vQ2hhbGxlbmdlLmpzJztcclxuaW1wb3J0IEVxdWF0aW9uRm9ybSBmcm9tICcuL0VxdWF0aW9uRm9ybS5qcyc7XHJcbmltcG9ydCBHYW1lUGhhc2UgZnJvbSAnLi9HYW1lUGhhc2UuanMnO1xyXG5pbXBvcnQgR3JhcGhUaGVMaW5lIGZyb20gJy4vR3JhcGhUaGVMaW5lLmpzJztcclxuaW1wb3J0IE1hbmlwdWxhdGlvbk1vZGUgZnJvbSAnLi9NYW5pcHVsYXRpb25Nb2RlLmpzJztcclxuaW1wb3J0IFBsYXlTdGF0ZSBmcm9tICcuL1BsYXlTdGF0ZS5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgSU5JVElBTF9HQU1FX1BIQVNFID0gR2FtZVBoYXNlLlNFVFRJTkdTO1xyXG5jb25zdCBDSEFMTEVOR0VTX1BFUl9HQU1FID0gNjtcclxuY29uc3QgRFVNTVlfQ0hBTExFTkdFID0gbmV3IEdyYXBoVGhlTGluZSggJycsIExpbmUuY3JlYXRlU2xvcGVJbnRlcmNlcHQoIDEsIDEsIDEgKSxcclxuICBFcXVhdGlvbkZvcm0uU0xPUEVfSU5URVJDRVBULCBNYW5pcHVsYXRpb25Nb2RlLlNMT1BFLCBHTENvbnN0YW50cy5YX0FYSVNfUkFOR0UsIEdMQ29uc3RhbnRzLllfQVhJU19SQU5HRSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZUdhbWVNb2RlbCB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgY2hhbGxlbmdlRmFjdG9yaWVzOiBCYXNlQ2hhbGxlbmdlRmFjdG9yeVtdO1xyXG4gIHB1YmxpYyByZWFkb25seSBsZXZlbFByb3BlcnR5OiBQcm9wZXJ0eTxudW1iZXI+O1xyXG4gIHB1YmxpYyByZWFkb25seSBzb3VuZEVuYWJsZWRQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj47XHJcbiAgcHVibGljIHJlYWRvbmx5IHRpbWVyRW5hYmxlZFByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPjtcclxuICBwdWJsaWMgcmVhZG9ubHkgc2NvcmVQcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyPjsgLy8gaG93IG1hbnkgcG9pbnRzIHRoZSB1c2VyIGhhcyBlYXJuZWQgZm9yIHRoZSBjdXJyZW50IGdhbWVcclxuICBwdWJsaWMgcmVhZG9ubHkgY2hhbGxlbmdlUHJvcGVydHk6IFByb3BlcnR5PENoYWxsZW5nZT47XHJcbiAgcHVibGljIHJlYWRvbmx5IGNoYWxsZW5nZUluZGV4UHJvcGVydHk6IFByb3BlcnR5PG51bWJlcj47XHJcbiAgcHVibGljIHJlYWRvbmx5IGNoYWxsZW5nZXNQZXJHYW1lUHJvcGVydHk6IFByb3BlcnR5PG51bWJlcj47XHJcbiAgcHVibGljIHJlYWRvbmx5IHBsYXlTdGF0ZVByb3BlcnR5OiBFbnVtZXJhdGlvblByb3BlcnR5PFBsYXlTdGF0ZT47XHJcblxyXG4gIHB1YmxpYyBjaGFsbGVuZ2VzOiBDaGFsbGVuZ2VbXTtcclxuICBwdWJsaWMgcmVhZG9ubHkgdGltZXI6IEdhbWVUaW1lcjtcclxuICBwdWJsaWMgcmVhZG9ubHkgbnVtYmVyT2ZMZXZlbHM6IG51bWJlcjtcclxuICBwdWJsaWMgcmVhZG9ubHkgbWF4UG9pbnRzUGVyQ2hhbGxlbmdlOiBudW1iZXI7XHJcbiAgcHVibGljIHJlYWRvbmx5IGJlc3RTY29yZVByb3BlcnRpZXM6IFByb3BlcnR5PG51bWJlcj5bXTtcclxuICBwdWJsaWMgcmVhZG9ubHkgYmVzdFRpbWVQcm9wZXJ0aWVzOiBQcm9wZXJ0eTxudW1iZXIgfCBudWxsPltdOyAvLyBudWxsIGlmIGEgbGV2ZWwgaGFzIG5vIGJlc3QgdGltZSB5ZXRcclxuICBwdWJsaWMgaXNOZXdCZXN0VGltZTogYm9vbGVhbjtcclxuICBwdWJsaWMgcmVhZG9ubHkgZ2FtZVBoYXNlUHJvcGVydHk6IEVudW1lcmF0aW9uUHJvcGVydHk8R2FtZVBoYXNlPjsgLy8gc2V0IHRoaXMgdXNpbmcgc2V0R2FtZVBoYXNlXHJcblxyXG4gIHByb3RlY3RlZCBjb25zdHJ1Y3RvciggY2hhbGxlbmdlRmFjdG9yaWVzOiBCYXNlQ2hhbGxlbmdlRmFjdG9yeVtdLCB0YW5kZW06IFRhbmRlbSApIHtcclxuXHJcbiAgICB0aGlzLmNoYWxsZW5nZUZhY3RvcmllcyA9IGNoYWxsZW5nZUZhY3RvcmllcztcclxuXHJcbiAgICB0aGlzLmxldmVsUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIDAsIHtcclxuICAgICAgbnVtYmVyVHlwZTogJ0ludGVnZXInXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5zb3VuZEVuYWJsZWRQcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIHRydWUgKTtcclxuXHJcbiAgICB0aGlzLnRpbWVyRW5hYmxlZFByb3BlcnR5ID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UgKTtcclxuXHJcbiAgICB0aGlzLnNjb3JlUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIDAsIHtcclxuICAgICAgbnVtYmVyVHlwZTogJ0ludGVnZXInXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5jaGFsbGVuZ2VQcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eTxDaGFsbGVuZ2U+KCBEVU1NWV9DSEFMTEVOR0UgKTtcclxuXHJcbiAgICB0aGlzLmNoYWxsZW5nZUluZGV4UHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIDAsIHtcclxuICAgICAgbnVtYmVyVHlwZTogJ0ludGVnZXInXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5jaGFsbGVuZ2VzUGVyR2FtZVByb3BlcnR5ID0gbmV3IE51bWJlclByb3BlcnR5KCBDSEFMTEVOR0VTX1BFUl9HQU1FLCB7XHJcbiAgICAgIG51bWJlclR5cGU6ICdJbnRlZ2VyJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMucGxheVN0YXRlUHJvcGVydHkgPSBuZXcgRW51bWVyYXRpb25Qcm9wZXJ0eSggUGxheVN0YXRlLk5PTkUsIHtcclxuICAgICAgcmVlbnRyYW50OiB0cnVlIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvZ3JhcGhpbmctbGluZXMvaXNzdWVzLzEwMlxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuY2hhbGxlbmdlcyA9IFtdOyAvLyB7Q2hhbGxlbmdlW119XHJcbiAgICB0aGlzLnRpbWVyID0gbmV3IEdhbWVUaW1lcigpO1xyXG4gICAgdGhpcy5udW1iZXJPZkxldmVscyA9IGNoYWxsZW5nZUZhY3Rvcmllcy5sZW5ndGg7XHJcbiAgICB0aGlzLm1heFBvaW50c1BlckNoYWxsZW5nZSA9IDI7XHJcbiAgICB0aGlzLmJlc3RTY29yZVByb3BlcnRpZXMgPSBbXTsgLy8ge051bWJlclByb3BlcnR5W119IGJlc3Qgc2NvcmVzIGZvciBlYWNoIGxldmVsXHJcbiAgICB0aGlzLmJlc3RUaW1lUHJvcGVydGllcyA9IFtdOyAvLyB7UHJvcGVydHkuPG51bWJlcnxudWxsPltdfSBiZXN0IHRpbWVzIGZvciBlYWNoIGxldmVsLCBpbiBtc1xyXG4gICAgdGhpcy5pc05ld0Jlc3RUaW1lID0gZmFsc2U7IC8vIGlzIHRoZSB0aW1lIGZvciB0aGUgbW9zdC1yZWNlbnRseS1jb21wbGV0ZWQgZ2FtZSBhIG5ldyBiZXN0IHRpbWU/XHJcbiAgICBmb3IgKCBsZXQgbGV2ZWwgPSAwOyBsZXZlbCA8IHRoaXMubnVtYmVyT2ZMZXZlbHM7IGxldmVsKysgKSB7XHJcbiAgICAgIHRoaXMuYmVzdFNjb3JlUHJvcGVydGllcy5wdXNoKCBuZXcgTnVtYmVyUHJvcGVydHkoIDAsIHtcclxuICAgICAgICBudW1iZXJUeXBlOiAnSW50ZWdlcidcclxuICAgICAgfSApICk7XHJcbiAgICAgIHRoaXMuYmVzdFRpbWVQcm9wZXJ0aWVzLnB1c2goIG5ldyBQcm9wZXJ0eTxudW1iZXIgfCBudWxsPiggbnVsbCApICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5nYW1lUGhhc2VQcm9wZXJ0eSA9IG5ldyBFbnVtZXJhdGlvblByb3BlcnR5KCBJTklUSUFMX0dBTUVfUEhBU0UgKTtcclxuXHJcbiAgICB0aGlzLmluaXRDaGFsbGVuZ2VzKCk7XHJcblxyXG4gICAgLy8gRG8gdGhpcyBhZnRlciBpbml0Q2hhbGxlbmdlcywgYmVjYXVzZSB0aGlzIHdpbGwgZmlyZSBpbW1lZGlhdGVseSBhbmQgbmVlZHMgdG8gaGF2ZSBhbiBpbml0aWFsIHNldCBvZiBjaGFsbGVuZ2VzLlxyXG4gICAgLy8gdW5saW5rIGlzIHVubmVjZXNzYXJ5IHNpbmNlIEJhc2VHYW1lTW9kZWwgZXhpc3RzIGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIHNpbS5cclxuICAgIHRoaXMucGxheVN0YXRlUHJvcGVydHkubGluayggcGxheVN0YXRlID0+IHtcclxuXHJcbiAgICAgIGNvbnN0IGNoYWxsZW5nZUluZGV4ID0gdGhpcy5jaGFsbGVuZ2VJbmRleFByb3BlcnR5LnZhbHVlO1xyXG4gICAgICBjb25zdCBpc0xhc3RDaGFsbGVuZ2UgPSAoIGNoYWxsZW5nZUluZGV4ID09PSB0aGlzLmNoYWxsZW5nZXMubGVuZ3RoIC0gMSApO1xyXG5cclxuICAgICAgaWYgKCBpc0xhc3RDaGFsbGVuZ2UgJiYgKCBwbGF5U3RhdGUgPT09IFBsYXlTdGF0ZS5ORVhUIHx8IHBsYXlTdGF0ZSA9PT0gUGxheVN0YXRlLlNIT1dfQU5TV0VSICkgKSB7XHJcbiAgICAgICAgLy8gZ2FtZSBvdmVyLCBzdG9wIHRoZSB0aW1lclxyXG4gICAgICAgIHRoaXMudGltZXIuc3RvcCgpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIHBsYXlTdGF0ZSA9PT0gUGxheVN0YXRlLkZJUlNUX0NIRUNLICkge1xyXG5cclxuICAgICAgICBjb25zdCBsZXZlbCA9IHRoaXMubGV2ZWxQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb25zdCBzY29yZSA9IHRoaXMuc2NvcmVQcm9wZXJ0eS52YWx1ZTtcclxuXHJcbiAgICAgICAgaWYgKCBpc0xhc3RDaGFsbGVuZ2UgKSB7XHJcbiAgICAgICAgICAvLyBnYW1lIGhhcyBiZWVuIGNvbXBsZXRlZFxyXG4gICAgICAgICAgdGhpcy5zZXRHYW1lUGhhc2UoIEdhbWVQaGFzZS5SRVNVTFRTICk7XHJcbiAgICAgICAgICBpZiAoIHNjb3JlID4gdGhpcy5iZXN0U2NvcmVQcm9wZXJ0aWVzWyBsZXZlbCBdLnZhbHVlICkge1xyXG4gICAgICAgICAgICB0aGlzLmJlc3RTY29yZVByb3BlcnRpZXNbIGxldmVsIF0udmFsdWUgPSBzY29yZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAvLyBuZXh0IGNoYWxsZW5nZVxyXG4gICAgICAgICAgY29uc3QgbmV4dENoYWxsZW5nZUluZGV4ID0gY2hhbGxlbmdlSW5kZXggKyAxO1xyXG4gICAgICAgICAgdGhpcy5jaGFsbGVuZ2VJbmRleFByb3BlcnR5LnZhbHVlID0gbmV4dENoYWxsZW5nZUluZGV4O1xyXG4gICAgICAgICAgdGhpcy5jaGFsbGVuZ2VQcm9wZXJ0eS52YWx1ZSA9IHRoaXMuY2hhbGxlbmdlc1sgbmV4dENoYWxsZW5nZUluZGV4IF07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCBwbGF5U3RhdGUgPT09IFBsYXlTdGF0ZS5ORVhUICkge1xyXG4gICAgICAgIHRoaXMuY2hhbGxlbmdlUHJvcGVydHkudmFsdWUuc2V0QW5zd2VyVmlzaWJsZSggdHJ1ZSApO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgaWYgKCBHTFF1ZXJ5UGFyYW1ldGVycy52ZXJpZnlDaGFsbGVuZ2VzICkge1xyXG4gICAgICB0aGlzLnZlcmlmeUNoYWxsZW5nZXMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldHMgdGhlIGdhbWUgcGhhc2UuIENhbGwgdGhpcyBpbnN0ZWFkIG9mIHNldHRpbmcgZ2FtZVBoYXNlUHJvcGVydHkgZGlyZWN0bHksXHJcbiAgICogYmVjYXVzZSB0aGVyZSBhcmUgdGFza3MgdGhhdCBuZWVkcyB0byBiZSBkb25lIGJlZm9yZSBsaXN0ZW5lcnMgYXJlIG5vdGlmaWVkLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRHYW1lUGhhc2UoIGdhbWVQaGFzZTogR2FtZVBoYXNlICk6IHZvaWQge1xyXG4gICAgaWYgKCBnYW1lUGhhc2UgIT09IHRoaXMuZ2FtZVBoYXNlUHJvcGVydHkudmFsdWUgKSB7XHJcblxyXG4gICAgICAvLyBEbyB0YXNrcyB0aGF0IG5lZWQgdG8gYmUgZG9uZSBiZWZvcmUgbm90aWZ5aW5nIGxpc3RlbmVycy5cclxuICAgICAgaWYgKCBnYW1lUGhhc2UgPT09IEdhbWVQaGFzZS5TRVRUSU5HUyApIHtcclxuICAgICAgICB0aGlzLnBsYXlTdGF0ZVByb3BlcnR5LnZhbHVlID0gUGxheVN0YXRlLk5PTkU7XHJcbiAgICAgICAgdGhpcy50aW1lci5zdG9wKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIGdhbWVQaGFzZSA9PT0gR2FtZVBoYXNlLlBMQVkgKSB7XHJcbiAgICAgICAgdGhpcy5pbml0Q2hhbGxlbmdlcygpO1xyXG4gICAgICAgIHRoaXMucGxheVN0YXRlUHJvcGVydHkudmFsdWUgPSBQbGF5U3RhdGUuRklSU1RfQ0hFQ0s7XHJcbiAgICAgICAgdGhpcy5zY29yZVByb3BlcnR5LnZhbHVlID0gMDtcclxuICAgICAgICB0aGlzLnRpbWVyLnN0YXJ0KCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIGdhbWVQaGFzZSA9PT0gR2FtZVBoYXNlLlJFU1VMVFMgKSB7XHJcbiAgICAgICAgdGhpcy5wbGF5U3RhdGVQcm9wZXJ0eS52YWx1ZSA9IFBsYXlTdGF0ZS5OT05FO1xyXG4gICAgICAgIHRoaXMudXBkYXRlQmVzdFRpbWUoKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIGB1bnN1cHBvcnRlZCBnYW1lIHBoYXNlOiAke2dhbWVQaGFzZX1gICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIENoYW5nZSB0aGUgUHJvcGVydHksIHdoaWNoIG5vdGlmaWVzIGxpc3RlbmVyc1xyXG4gICAgICB0aGlzLmdhbWVQaGFzZVByb3BlcnR5LnZhbHVlID0gZ2FtZVBoYXNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlc2V0KCk6IHZvaWQge1xyXG5cclxuICAgIHRoaXMubGV2ZWxQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5zb3VuZEVuYWJsZWRQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy50aW1lckVuYWJsZWRQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5zY29yZVByb3BlcnR5LnJlc2V0KCk7XHJcbiAgICB0aGlzLmNoYWxsZW5nZVByb3BlcnR5LnJlc2V0KCk7XHJcbiAgICB0aGlzLmNoYWxsZW5nZUluZGV4UHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMuY2hhbGxlbmdlc1BlckdhbWVQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5wbGF5U3RhdGVQcm9wZXJ0eS5yZXNldCgpO1xyXG5cclxuICAgIHRoaXMuc2V0R2FtZVBoYXNlKCBJTklUSUFMX0dBTUVfUEhBU0UgKTtcclxuICAgIHRoaXMucmVzZXRCZXN0U2NvcmVzKCk7XHJcbiAgICB0aGlzLnJlc2V0QmVzdFRpbWVzKCk7XHJcblxyXG4gICAgdGhpcy5pbml0Q2hhbGxlbmdlcygpOyAvLyB0YWtlcyBjYXJlIG9mIGNoYWxsZW5nZVByb3BlcnR5LCBjaGFsbGVuZ2VJbmRleFByb3BlcnR5LCBjaGFsbGVuZ2VzUGVyR2FtZVByb3BlcnR5XHJcbiAgfVxyXG5cclxuICAvLyBSZXNldHMgdGhlIGJlc3Qgc2NvcmUgdG8gemVybyBmb3IgZXZlcnkgbGV2ZWwuXHJcbiAgcHJpdmF0ZSByZXNldEJlc3RTY29yZXMoKTogdm9pZCB7XHJcbiAgICB0aGlzLmJlc3RTY29yZVByb3BlcnRpZXMuZm9yRWFjaCggcHJvcGVydHkgPT4ge1xyXG4gICAgICBwcm9wZXJ0eS52YWx1ZSA9IDA7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICAvLyBSZXNldHMgdGhlIGJlc3QgdGltZXMgdG8gbnVsbCAobm8gdGltZSkgZm9yIGV2ZXJ5IGxldmVsLlxyXG4gIHByaXZhdGUgcmVzZXRCZXN0VGltZXMoKTogdm9pZCB7XHJcbiAgICB0aGlzLmJlc3RUaW1lUHJvcGVydGllcy5mb3JFYWNoKCBwcm9wZXJ0eSA9PiB7XHJcbiAgICAgIHByb3BlcnR5LnZhbHVlID0gbnVsbDtcclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBpc1BlcmZlY3RTY29yZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiAoIHRoaXMuc2NvcmVQcm9wZXJ0eS52YWx1ZSA9PT0gdGhpcy5nZXRQZXJmZWN0U2NvcmUoKSApO1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0cyB0aGUgbnVtYmVyIG9mIHBvaW50cyBpbiBhIHBlcmZlY3Qgc2NvcmUgKGllLCBjb3JyZWN0IGFuc3dlcnMgZm9yIGFsbCBjaGFsbGVuZ2VzIG9uIHRoZSBmaXJzdCB0cnkpXHJcbiAgcHVibGljIGdldFBlcmZlY3RTY29yZSgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuY2hhbGxlbmdlcy5sZW5ndGggKiB0aGlzLmNvbXB1dGVQb2ludHMoIDEgKTtcclxuICB9XHJcblxyXG4gIC8vIENvbXB1dGUgcG9pbnRzIHRvIGJlIGF3YXJkZWQgZm9yIGEgY29ycmVjdCBhbnN3ZXIuXHJcbiAgcHVibGljIGNvbXB1dGVQb2ludHMoIGF0dGVtcHRzOiBudW1iZXIgKTogbnVtYmVyIHtcclxuICAgIHJldHVybiBNYXRoLm1heCggMCwgdGhpcy5tYXhQb2ludHNQZXJDaGFsbGVuZ2UgLSBhdHRlbXB0cyArIDEgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNraXBzIHRoZSBjdXJyZW50IGNoYWxsZW5nZS5cclxuICAgKiBUaGlzIGlzIGEgZGV2ZWxvcGVyIGZlYXR1cmUuXHJcbiAgICogU2NvcmUgYW5kIGJlc3QgdGltZXMgYXJlIG1lYW5pbmdsZXNzIGFmdGVyIHVzaW5nIHRoaXMuXHJcbiAgICovXHJcbiAgcHVibGljIHNraXBDdXJyZW50Q2hhbGxlbmdlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5wbGF5U3RhdGVQcm9wZXJ0eS52YWx1ZSA9IFBsYXlTdGF0ZS5ORVhUO1xyXG4gICAgdGhpcy5wbGF5U3RhdGVQcm9wZXJ0eS52YWx1ZSA9IFBsYXlTdGF0ZS5GSVJTVF9DSEVDSztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlcGxheXMgdGhlIGN1cnJlbnQgY2hhbGxlbmdlLlxyXG4gICAqIFRoaXMgaXMgYSBkZXZlbG9wZXIgZmVhdHVyZS5cclxuICAgKiBTY29yZSBhbmQgYmVzdCB0aW1lcyBhcmUgbWVhbmluZ2xlc3MgYWZ0ZXIgdXNpbmcgdGhpcy5cclxuICAgKi9cclxuICBwdWJsaWMgcmVwbGF5Q3VycmVudENoYWxsZW5nZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuY2hhbGxlbmdlUHJvcGVydHkudmFsdWUucmVzZXQoKTtcclxuICAgIHRoaXMuY2hhbGxlbmdlSW5kZXhQcm9wZXJ0eS52YWx1ZSA9IHRoaXMuY2hhbGxlbmdlSW5kZXhQcm9wZXJ0eS52YWx1ZSAtIDE7XHJcbiAgICB0aGlzLmNoYWxsZW5nZVByb3BlcnR5LnZhbHVlID0gRFVNTVlfQ0hBTExFTkdFOyAvLyBmb3JjZSBhbiB1cGRhdGVcclxuICAgIHRoaXMucGxheVN0YXRlUHJvcGVydHkudmFsdWUgPSBQbGF5U3RhdGUuRklSU1RfQ0hFQ0s7XHJcbiAgfVxyXG5cclxuICAvLyBVcGRhdGVzIHRoZSBiZXN0IHRpbWUgZm9yIHRoZSBjdXJyZW50IGxldmVsLCBhdCB0aGUgZW5kIG9mIGEgdGltZWQgZ2FtZSB3aXRoIGEgcGVyZmVjdCBzY29yZS5cclxuICBwcml2YXRlIHVwZGF0ZUJlc3RUaW1lKCk6IHZvaWQge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggIXRoaXMudGltZXIuaXNSdW5uaW5nUHJvcGVydHkudmFsdWUgKTtcclxuICAgIHRoaXMuaXNOZXdCZXN0VGltZSA9IGZhbHNlO1xyXG4gICAgaWYgKCB0aGlzLnRpbWVyRW5hYmxlZFByb3BlcnR5LnZhbHVlICYmIHRoaXMuaXNQZXJmZWN0U2NvcmUoKSApIHtcclxuICAgICAgY29uc3QgbGV2ZWwgPSB0aGlzLmxldmVsUHJvcGVydHkudmFsdWU7XHJcbiAgICAgIGNvbnN0IHRpbWUgPSB0aGlzLnRpbWVyLmVsYXBzZWRUaW1lUHJvcGVydHkudmFsdWU7XHJcbiAgICAgIGNvbnN0IGJlc3RUaW1lID0gdGhpcy5iZXN0VGltZVByb3BlcnRpZXNbIGxldmVsIF0udmFsdWU7XHJcbiAgICAgIGlmICggIWJlc3RUaW1lICkge1xyXG4gICAgICAgIC8vIFRoZXJlIHdhcyBubyBwcmV2aW91cyBiZXN0IHRpbWUgZm9yIHRoaXMgbGV2ZWwuXHJcbiAgICAgICAgdGhpcy5iZXN0VGltZVByb3BlcnRpZXNbIGxldmVsIF0udmFsdWUgPSB0aW1lO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCB0aW1lIDwgYmVzdFRpbWUgKSB7XHJcbiAgICAgICAgLy8gV2UgaGF2ZSBhIG5ldyBiZXN0IHRpbWUgZm9yIHRoaXMgbGV2ZWwuXHJcbiAgICAgICAgdGhpcy5iZXN0VGltZVByb3BlcnRpZXNbIGxldmVsIF0udmFsdWUgPSB0aW1lO1xyXG4gICAgICAgIHRoaXMuaXNOZXdCZXN0VGltZSA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEluaXRpYWxpemVzIGEgbmV3IHNldCBvZiBjaGFsbGVuZ2VzIGZvciB0aGUgY3VycmVudCBsZXZlbC5cclxuICBwcml2YXRlIGluaXRDaGFsbGVuZ2VzKCk6IHZvaWQge1xyXG5cclxuICAgIC8vIGZvcmNlIHVwZGF0ZVxyXG4gICAgdGhpcy5jaGFsbGVuZ2VJbmRleFByb3BlcnR5LnZhbHVlID0gLTE7XHJcblxyXG4gICAgLy8gbGV2ZWxcclxuICAgIGNvbnN0IGxldmVsID0gdGhpcy5sZXZlbFByb3BlcnR5LnZhbHVlO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggbGV2ZWwgPj0gMCAmJiBsZXZlbCA8IHRoaXMuY2hhbGxlbmdlRmFjdG9yaWVzLmxlbmd0aCApO1xyXG5cclxuICAgIC8vIGdlbmVyYXRlIGNoYWxsZW5nZXNcclxuICAgIHRoaXMuY2hhbGxlbmdlcyA9IHRoaXMuY2hhbGxlbmdlRmFjdG9yaWVzWyBsZXZlbCBdLmNyZWF0ZUNoYWxsZW5nZXMoKTtcclxuICAgIGlmICggR0xRdWVyeVBhcmFtZXRlcnMuc2h1ZmZsZSApIHtcclxuICAgICAgdGhpcy5jaGFsbGVuZ2VzID0gZG90UmFuZG9tLnNodWZmbGUoIHRoaXMuY2hhbGxlbmdlcyApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHNldCB0aGUgbnVtYmVyIG9mIGNoYWxsZW5nZXNcclxuICAgIHRoaXMuY2hhbGxlbmdlc1BlckdhbWVQcm9wZXJ0eS52YWx1ZSA9IHRoaXMuY2hhbGxlbmdlcy5sZW5ndGg7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLmNoYWxsZW5nZXNQZXJHYW1lUHJvcGVydHkudmFsdWUgPT09IENIQUxMRU5HRVNfUEVSX0dBTUUgKTtcclxuICB9XHJcblxyXG4gIC8vIFZlcmlmeSBjaGFsbGVuZ2UgY3JlYXRpb24uXHJcbiAgcHJpdmF0ZSB2ZXJpZnlDaGFsbGVuZ2VzKCk6IHZvaWQge1xyXG4gICAgY29uc29sZS5sb2coICdiZWdpbjogdmVyaWZ5IGNyZWF0aW9uIG9mIGNoYWxsZW5nZXMnICk7XHJcbiAgICBmb3IgKCBsZXQgbGV2ZWwgPSAwOyBsZXZlbCA8IHRoaXMuY2hhbGxlbmdlRmFjdG9yaWVzLmxlbmd0aDsgbGV2ZWwrKyApIHtcclxuICAgICAgY29uc29sZS5sb2coIGB2ZXJpZnlpbmcgbGV2ZWwgJHtsZXZlbH0uLi5gICk7XHJcbiAgICAgIGZvciAoIGxldCBpID0gMDsgaSA8IDIwMDA7IGkrKyApIHtcclxuICAgICAgICB0aGlzLmNoYWxsZW5nZUZhY3Rvcmllc1sgbGV2ZWwgXS5jcmVhdGVDaGFsbGVuZ2VzKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKCAnZW5kOiB2ZXJpZnkgY3JlYXRpb24gb2YgY2hhbGxlbmdlcycgKTtcclxuICB9XHJcbn1cclxuXHJcbmdyYXBoaW5nTGluZXMucmVnaXN0ZXIoICdCYXNlR2FtZU1vZGVsJywgQmFzZUdhbWVNb2RlbCApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxtQkFBbUIsTUFBTSw0Q0FBNEM7QUFDNUUsT0FBT0MsY0FBYyxNQUFNLHVDQUF1QztBQUNsRSxPQUFPQyxRQUFRLE1BQU0saUNBQWlDO0FBQ3RELE9BQU9DLFNBQVMsTUFBTSxpQ0FBaUM7QUFFdkQsT0FBT0MsU0FBUyxNQUFNLG1DQUFtQztBQUN6RCxPQUFPQyxXQUFXLE1BQU0sNkJBQTZCO0FBQ3JELE9BQU9DLGlCQUFpQixNQUFNLG1DQUFtQztBQUNqRSxPQUFPQyxJQUFJLE1BQU0sNEJBQTRCO0FBQzdDLE9BQU9DLGFBQWEsTUFBTSx3QkFBd0I7QUFHbEQsT0FBT0MsWUFBWSxNQUFNLG1CQUFtQjtBQUM1QyxPQUFPQyxTQUFTLE1BQU0sZ0JBQWdCO0FBQ3RDLE9BQU9DLFlBQVksTUFBTSxtQkFBbUI7QUFDNUMsT0FBT0MsZ0JBQWdCLE1BQU0sdUJBQXVCO0FBQ3BELE9BQU9DLFNBQVMsTUFBTSxnQkFBZ0I7O0FBRXRDO0FBQ0EsTUFBTUMsa0JBQWtCLEdBQUdKLFNBQVMsQ0FBQ0ssUUFBUTtBQUM3QyxNQUFNQyxtQkFBbUIsR0FBRyxDQUFDO0FBQzdCLE1BQU1DLGVBQWUsR0FBRyxJQUFJTixZQUFZLENBQUUsRUFBRSxFQUFFSixJQUFJLENBQUNXLG9CQUFvQixDQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBRSxDQUFDLEVBQ2hGVCxZQUFZLENBQUNVLGVBQWUsRUFBRVAsZ0JBQWdCLENBQUNRLEtBQUssRUFBRWYsV0FBVyxDQUFDZ0IsWUFBWSxFQUFFaEIsV0FBVyxDQUFDaUIsWUFBYSxDQUFDO0FBRTVHLGVBQWUsTUFBTUMsYUFBYSxDQUFDO0VBTWdCOztFQVdjOztFQUVJOztFQUV6REMsV0FBV0EsQ0FBRUMsa0JBQTBDLEVBQUVDLE1BQWMsRUFBRztJQUVsRixJQUFJLENBQUNELGtCQUFrQixHQUFHQSxrQkFBa0I7SUFFNUMsSUFBSSxDQUFDRSxhQUFhLEdBQUcsSUFBSTFCLGNBQWMsQ0FBRSxDQUFDLEVBQUU7TUFDMUMyQixVQUFVLEVBQUU7SUFDZCxDQUFFLENBQUM7SUFFSCxJQUFJLENBQUNDLG9CQUFvQixHQUFHLElBQUk5QixlQUFlLENBQUUsSUFBSyxDQUFDO0lBRXZELElBQUksQ0FBQytCLG9CQUFvQixHQUFHLElBQUkvQixlQUFlLENBQUUsS0FBTSxDQUFDO0lBRXhELElBQUksQ0FBQ2dDLGFBQWEsR0FBRyxJQUFJOUIsY0FBYyxDQUFFLENBQUMsRUFBRTtNQUMxQzJCLFVBQVUsRUFBRTtJQUNkLENBQUUsQ0FBQztJQUVILElBQUksQ0FBQ0ksaUJBQWlCLEdBQUcsSUFBSTlCLFFBQVEsQ0FBYWUsZUFBZ0IsQ0FBQztJQUVuRSxJQUFJLENBQUNnQixzQkFBc0IsR0FBRyxJQUFJaEMsY0FBYyxDQUFFLENBQUMsRUFBRTtNQUNuRDJCLFVBQVUsRUFBRTtJQUNkLENBQUUsQ0FBQztJQUVILElBQUksQ0FBQ00seUJBQXlCLEdBQUcsSUFBSWpDLGNBQWMsQ0FBRWUsbUJBQW1CLEVBQUU7TUFDeEVZLFVBQVUsRUFBRTtJQUNkLENBQUUsQ0FBQztJQUVILElBQUksQ0FBQ08saUJBQWlCLEdBQUcsSUFBSW5DLG1CQUFtQixDQUFFYSxTQUFTLENBQUN1QixJQUFJLEVBQUU7TUFDaEVDLFNBQVMsRUFBRSxJQUFJLENBQUM7SUFDbEIsQ0FBRSxDQUFDOztJQUVILElBQUksQ0FBQ0MsVUFBVSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3RCLElBQUksQ0FBQ0MsS0FBSyxHQUFHLElBQUluQyxTQUFTLENBQUMsQ0FBQztJQUM1QixJQUFJLENBQUNvQyxjQUFjLEdBQUdmLGtCQUFrQixDQUFDZ0IsTUFBTTtJQUMvQyxJQUFJLENBQUNDLHFCQUFxQixHQUFHLENBQUM7SUFDOUIsSUFBSSxDQUFDQyxtQkFBbUIsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUMvQixJQUFJLENBQUNDLGtCQUFrQixHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzlCLElBQUksQ0FBQ0MsYUFBYSxHQUFHLEtBQUssQ0FBQyxDQUFDO0lBQzVCLEtBQU0sSUFBSUMsS0FBSyxHQUFHLENBQUMsRUFBRUEsS0FBSyxHQUFHLElBQUksQ0FBQ04sY0FBYyxFQUFFTSxLQUFLLEVBQUUsRUFBRztNQUMxRCxJQUFJLENBQUNILG1CQUFtQixDQUFDSSxJQUFJLENBQUUsSUFBSTlDLGNBQWMsQ0FBRSxDQUFDLEVBQUU7UUFDcEQyQixVQUFVLEVBQUU7TUFDZCxDQUFFLENBQUUsQ0FBQztNQUNMLElBQUksQ0FBQ2dCLGtCQUFrQixDQUFDRyxJQUFJLENBQUUsSUFBSTdDLFFBQVEsQ0FBaUIsSUFBSyxDQUFFLENBQUM7SUFDckU7SUFFQSxJQUFJLENBQUM4QyxpQkFBaUIsR0FBRyxJQUFJaEQsbUJBQW1CLENBQUVjLGtCQUFtQixDQUFDO0lBRXRFLElBQUksQ0FBQ21DLGNBQWMsQ0FBQyxDQUFDOztJQUVyQjtJQUNBO0lBQ0EsSUFBSSxDQUFDZCxpQkFBaUIsQ0FBQ2UsSUFBSSxDQUFFQyxTQUFTLElBQUk7TUFFeEMsTUFBTUMsY0FBYyxHQUFHLElBQUksQ0FBQ25CLHNCQUFzQixDQUFDb0IsS0FBSztNQUN4RCxNQUFNQyxlQUFlLEdBQUtGLGNBQWMsS0FBSyxJQUFJLENBQUNkLFVBQVUsQ0FBQ0csTUFBTSxHQUFHLENBQUc7TUFFekUsSUFBS2EsZUFBZSxLQUFNSCxTQUFTLEtBQUt0QyxTQUFTLENBQUMwQyxJQUFJLElBQUlKLFNBQVMsS0FBS3RDLFNBQVMsQ0FBQzJDLFdBQVcsQ0FBRSxFQUFHO1FBQ2hHO1FBQ0EsSUFBSSxDQUFDakIsS0FBSyxDQUFDa0IsSUFBSSxDQUFDLENBQUM7TUFDbkI7TUFFQSxJQUFLTixTQUFTLEtBQUt0QyxTQUFTLENBQUM2QyxXQUFXLEVBQUc7UUFFekMsTUFBTVosS0FBSyxHQUFHLElBQUksQ0FBQ25CLGFBQWEsQ0FBQzBCLEtBQUs7UUFDdEMsTUFBTU0sS0FBSyxHQUFHLElBQUksQ0FBQzVCLGFBQWEsQ0FBQ3NCLEtBQUs7UUFFdEMsSUFBS0MsZUFBZSxFQUFHO1VBQ3JCO1VBQ0EsSUFBSSxDQUFDTSxZQUFZLENBQUVsRCxTQUFTLENBQUNtRCxPQUFRLENBQUM7VUFDdEMsSUFBS0YsS0FBSyxHQUFHLElBQUksQ0FBQ2hCLG1CQUFtQixDQUFFRyxLQUFLLENBQUUsQ0FBQ08sS0FBSyxFQUFHO1lBQ3JELElBQUksQ0FBQ1YsbUJBQW1CLENBQUVHLEtBQUssQ0FBRSxDQUFDTyxLQUFLLEdBQUdNLEtBQUs7VUFDakQ7UUFDRixDQUFDLE1BQ0k7VUFDSDtVQUNBLE1BQU1HLGtCQUFrQixHQUFHVixjQUFjLEdBQUcsQ0FBQztVQUM3QyxJQUFJLENBQUNuQixzQkFBc0IsQ0FBQ29CLEtBQUssR0FBR1Msa0JBQWtCO1VBQ3RELElBQUksQ0FBQzlCLGlCQUFpQixDQUFDcUIsS0FBSyxHQUFHLElBQUksQ0FBQ2YsVUFBVSxDQUFFd0Isa0JBQWtCLENBQUU7UUFDdEU7TUFDRixDQUFDLE1BQ0ksSUFBS1gsU0FBUyxLQUFLdEMsU0FBUyxDQUFDMEMsSUFBSSxFQUFHO1FBQ3ZDLElBQUksQ0FBQ3ZCLGlCQUFpQixDQUFDcUIsS0FBSyxDQUFDVSxnQkFBZ0IsQ0FBRSxJQUFLLENBQUM7TUFDdkQ7SUFDRixDQUFFLENBQUM7SUFFSCxJQUFLekQsaUJBQWlCLENBQUMwRCxnQkFBZ0IsRUFBRztNQUN4QyxJQUFJLENBQUNBLGdCQUFnQixDQUFDLENBQUM7SUFDekI7RUFDRjs7RUFFQTtBQUNGO0FBQ0E7QUFDQTtFQUNTSixZQUFZQSxDQUFFSyxTQUFvQixFQUFTO0lBQ2hELElBQUtBLFNBQVMsS0FBSyxJQUFJLENBQUNqQixpQkFBaUIsQ0FBQ0ssS0FBSyxFQUFHO01BRWhEO01BQ0EsSUFBS1ksU0FBUyxLQUFLdkQsU0FBUyxDQUFDSyxRQUFRLEVBQUc7UUFDdEMsSUFBSSxDQUFDb0IsaUJBQWlCLENBQUNrQixLQUFLLEdBQUd4QyxTQUFTLENBQUN1QixJQUFJO1FBQzdDLElBQUksQ0FBQ0csS0FBSyxDQUFDa0IsSUFBSSxDQUFDLENBQUM7TUFDbkIsQ0FBQyxNQUNJLElBQUtRLFNBQVMsS0FBS3ZELFNBQVMsQ0FBQ3dELElBQUksRUFBRztRQUN2QyxJQUFJLENBQUNqQixjQUFjLENBQUMsQ0FBQztRQUNyQixJQUFJLENBQUNkLGlCQUFpQixDQUFDa0IsS0FBSyxHQUFHeEMsU0FBUyxDQUFDNkMsV0FBVztRQUNwRCxJQUFJLENBQUMzQixhQUFhLENBQUNzQixLQUFLLEdBQUcsQ0FBQztRQUM1QixJQUFJLENBQUNkLEtBQUssQ0FBQzRCLEtBQUssQ0FBQyxDQUFDO01BQ3BCLENBQUMsTUFDSSxJQUFLRixTQUFTLEtBQUt2RCxTQUFTLENBQUNtRCxPQUFPLEVBQUc7UUFDMUMsSUFBSSxDQUFDMUIsaUJBQWlCLENBQUNrQixLQUFLLEdBQUd4QyxTQUFTLENBQUN1QixJQUFJO1FBQzdDLElBQUksQ0FBQ2dDLGNBQWMsQ0FBQyxDQUFDO01BQ3ZCLENBQUMsTUFDSTtRQUNILE1BQU0sSUFBSUMsS0FBSyxDQUFHLDJCQUEwQkosU0FBVSxFQUFFLENBQUM7TUFDM0Q7O01BRUE7TUFDQSxJQUFJLENBQUNqQixpQkFBaUIsQ0FBQ0ssS0FBSyxHQUFHWSxTQUFTO0lBQzFDO0VBQ0Y7RUFFT0ssS0FBS0EsQ0FBQSxFQUFTO0lBRW5CLElBQUksQ0FBQzNDLGFBQWEsQ0FBQzJDLEtBQUssQ0FBQyxDQUFDO0lBQzFCLElBQUksQ0FBQ3pDLG9CQUFvQixDQUFDeUMsS0FBSyxDQUFDLENBQUM7SUFDakMsSUFBSSxDQUFDeEMsb0JBQW9CLENBQUN3QyxLQUFLLENBQUMsQ0FBQztJQUNqQyxJQUFJLENBQUN2QyxhQUFhLENBQUN1QyxLQUFLLENBQUMsQ0FBQztJQUMxQixJQUFJLENBQUN0QyxpQkFBaUIsQ0FBQ3NDLEtBQUssQ0FBQyxDQUFDO0lBQzlCLElBQUksQ0FBQ3JDLHNCQUFzQixDQUFDcUMsS0FBSyxDQUFDLENBQUM7SUFDbkMsSUFBSSxDQUFDcEMseUJBQXlCLENBQUNvQyxLQUFLLENBQUMsQ0FBQztJQUN0QyxJQUFJLENBQUNuQyxpQkFBaUIsQ0FBQ21DLEtBQUssQ0FBQyxDQUFDO0lBRTlCLElBQUksQ0FBQ1YsWUFBWSxDQUFFOUMsa0JBQW1CLENBQUM7SUFDdkMsSUFBSSxDQUFDeUQsZUFBZSxDQUFDLENBQUM7SUFDdEIsSUFBSSxDQUFDQyxjQUFjLENBQUMsQ0FBQztJQUVyQixJQUFJLENBQUN2QixjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDekI7O0VBRUE7RUFDUXNCLGVBQWVBLENBQUEsRUFBUztJQUM5QixJQUFJLENBQUM1QixtQkFBbUIsQ0FBQzhCLE9BQU8sQ0FBRUMsUUFBUSxJQUFJO01BQzVDQSxRQUFRLENBQUNyQixLQUFLLEdBQUcsQ0FBQztJQUNwQixDQUFFLENBQUM7RUFDTDs7RUFFQTtFQUNRbUIsY0FBY0EsQ0FBQSxFQUFTO0lBQzdCLElBQUksQ0FBQzVCLGtCQUFrQixDQUFDNkIsT0FBTyxDQUFFQyxRQUFRLElBQUk7TUFDM0NBLFFBQVEsQ0FBQ3JCLEtBQUssR0FBRyxJQUFJO0lBQ3ZCLENBQUUsQ0FBQztFQUNMO0VBRU9zQixjQUFjQSxDQUFBLEVBQVk7SUFDL0IsT0FBUyxJQUFJLENBQUM1QyxhQUFhLENBQUNzQixLQUFLLEtBQUssSUFBSSxDQUFDdUIsZUFBZSxDQUFDLENBQUM7RUFDOUQ7O0VBRUE7RUFDT0EsZUFBZUEsQ0FBQSxFQUFXO0lBQy9CLE9BQU8sSUFBSSxDQUFDdEMsVUFBVSxDQUFDRyxNQUFNLEdBQUcsSUFBSSxDQUFDb0MsYUFBYSxDQUFFLENBQUUsQ0FBQztFQUN6RDs7RUFFQTtFQUNPQSxhQUFhQSxDQUFFQyxRQUFnQixFQUFXO0lBQy9DLE9BQU9DLElBQUksQ0FBQ0MsR0FBRyxDQUFFLENBQUMsRUFBRSxJQUFJLENBQUN0QyxxQkFBcUIsR0FBR29DLFFBQVEsR0FBRyxDQUFFLENBQUM7RUFDakU7O0VBRUE7QUFDRjtBQUNBO0FBQ0E7QUFDQTtFQUNTRyxvQkFBb0JBLENBQUEsRUFBUztJQUNsQyxJQUFJLENBQUM5QyxpQkFBaUIsQ0FBQ2tCLEtBQUssR0FBR3hDLFNBQVMsQ0FBQzBDLElBQUk7SUFDN0MsSUFBSSxDQUFDcEIsaUJBQWlCLENBQUNrQixLQUFLLEdBQUd4QyxTQUFTLENBQUM2QyxXQUFXO0VBQ3REOztFQUVBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7RUFDU3dCLHNCQUFzQkEsQ0FBQSxFQUFTO0lBQ3BDLElBQUksQ0FBQ2xELGlCQUFpQixDQUFDcUIsS0FBSyxDQUFDaUIsS0FBSyxDQUFDLENBQUM7SUFDcEMsSUFBSSxDQUFDckMsc0JBQXNCLENBQUNvQixLQUFLLEdBQUcsSUFBSSxDQUFDcEIsc0JBQXNCLENBQUNvQixLQUFLLEdBQUcsQ0FBQztJQUN6RSxJQUFJLENBQUNyQixpQkFBaUIsQ0FBQ3FCLEtBQUssR0FBR3BDLGVBQWUsQ0FBQyxDQUFDO0lBQ2hELElBQUksQ0FBQ2tCLGlCQUFpQixDQUFDa0IsS0FBSyxHQUFHeEMsU0FBUyxDQUFDNkMsV0FBVztFQUN0RDs7RUFFQTtFQUNRVSxjQUFjQSxDQUFBLEVBQVM7SUFDN0JlLE1BQU0sSUFBSUEsTUFBTSxDQUFFLENBQUMsSUFBSSxDQUFDNUMsS0FBSyxDQUFDNkMsaUJBQWlCLENBQUMvQixLQUFNLENBQUM7SUFDdkQsSUFBSSxDQUFDUixhQUFhLEdBQUcsS0FBSztJQUMxQixJQUFLLElBQUksQ0FBQ2Ysb0JBQW9CLENBQUN1QixLQUFLLElBQUksSUFBSSxDQUFDc0IsY0FBYyxDQUFDLENBQUMsRUFBRztNQUM5RCxNQUFNN0IsS0FBSyxHQUFHLElBQUksQ0FBQ25CLGFBQWEsQ0FBQzBCLEtBQUs7TUFDdEMsTUFBTWdDLElBQUksR0FBRyxJQUFJLENBQUM5QyxLQUFLLENBQUMrQyxtQkFBbUIsQ0FBQ2pDLEtBQUs7TUFDakQsTUFBTWtDLFFBQVEsR0FBRyxJQUFJLENBQUMzQyxrQkFBa0IsQ0FBRUUsS0FBSyxDQUFFLENBQUNPLEtBQUs7TUFDdkQsSUFBSyxDQUFDa0MsUUFBUSxFQUFHO1FBQ2Y7UUFDQSxJQUFJLENBQUMzQyxrQkFBa0IsQ0FBRUUsS0FBSyxDQUFFLENBQUNPLEtBQUssR0FBR2dDLElBQUk7TUFDL0MsQ0FBQyxNQUNJLElBQUtBLElBQUksR0FBR0UsUUFBUSxFQUFHO1FBQzFCO1FBQ0EsSUFBSSxDQUFDM0Msa0JBQWtCLENBQUVFLEtBQUssQ0FBRSxDQUFDTyxLQUFLLEdBQUdnQyxJQUFJO1FBQzdDLElBQUksQ0FBQ3hDLGFBQWEsR0FBRyxJQUFJO01BQzNCO0lBQ0Y7RUFDRjs7RUFFQTtFQUNRSSxjQUFjQSxDQUFBLEVBQVM7SUFFN0I7SUFDQSxJQUFJLENBQUNoQixzQkFBc0IsQ0FBQ29CLEtBQUssR0FBRyxDQUFDLENBQUM7O0lBRXRDO0lBQ0EsTUFBTVAsS0FBSyxHQUFHLElBQUksQ0FBQ25CLGFBQWEsQ0FBQzBCLEtBQUs7SUFDdEM4QixNQUFNLElBQUlBLE1BQU0sQ0FBRXJDLEtBQUssSUFBSSxDQUFDLElBQUlBLEtBQUssR0FBRyxJQUFJLENBQUNyQixrQkFBa0IsQ0FBQ2dCLE1BQU8sQ0FBQzs7SUFFeEU7SUFDQSxJQUFJLENBQUNILFVBQVUsR0FBRyxJQUFJLENBQUNiLGtCQUFrQixDQUFFcUIsS0FBSyxDQUFFLENBQUMwQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQ3JFLElBQUtsRixpQkFBaUIsQ0FBQ21GLE9BQU8sRUFBRztNQUMvQixJQUFJLENBQUNuRCxVQUFVLEdBQUduQyxTQUFTLENBQUNzRixPQUFPLENBQUUsSUFBSSxDQUFDbkQsVUFBVyxDQUFDO0lBQ3hEOztJQUVBO0lBQ0EsSUFBSSxDQUFDSix5QkFBeUIsQ0FBQ21CLEtBQUssR0FBRyxJQUFJLENBQUNmLFVBQVUsQ0FBQ0csTUFBTTtJQUM3RDBDLE1BQU0sSUFBSUEsTUFBTSxDQUFFLElBQUksQ0FBQ2pELHlCQUF5QixDQUFDbUIsS0FBSyxLQUFLckMsbUJBQW9CLENBQUM7RUFDbEY7O0VBRUE7RUFDUWdELGdCQUFnQkEsQ0FBQSxFQUFTO0lBQy9CMEIsT0FBTyxDQUFDQyxHQUFHLENBQUUsc0NBQXVDLENBQUM7SUFDckQsS0FBTSxJQUFJN0MsS0FBSyxHQUFHLENBQUMsRUFBRUEsS0FBSyxHQUFHLElBQUksQ0FBQ3JCLGtCQUFrQixDQUFDZ0IsTUFBTSxFQUFFSyxLQUFLLEVBQUUsRUFBRztNQUNyRTRDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFHLG1CQUFrQjdDLEtBQU0sS0FBSyxDQUFDO01BQzVDLEtBQU0sSUFBSThDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBRyxJQUFJLEVBQUVBLENBQUMsRUFBRSxFQUFHO1FBQy9CLElBQUksQ0FBQ25FLGtCQUFrQixDQUFFcUIsS0FBSyxDQUFFLENBQUMwQyxnQkFBZ0IsQ0FBQyxDQUFDO01BQ3JEO0lBQ0Y7SUFDQUUsT0FBTyxDQUFDQyxHQUFHLENBQUUsb0NBQXFDLENBQUM7RUFDckQ7QUFDRjtBQUVBbkYsYUFBYSxDQUFDcUYsUUFBUSxDQUFFLGVBQWUsRUFBRXRFLGFBQWMsQ0FBQyJ9