// Copyright 2013-2023, University of Colorado Boulder

/**
 * EquationNode is the base class for all equations.
 * Dimensions and layout offsets are computed as percentages of the font's point size.
 * These multipliers were determined empirically by committee - modify at your peril!
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Property from '../../../../axon/js/Property.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
import { Node } from '../../../../scenery/js/imports.js';
import graphingLines from '../../graphingLines.js';
import SlopePicker from './picker/SlopePicker.js';
import optionize from '../../../../phet-core/js/optionize.js';
export default class EquationNode extends Node {
  decimalPlaces = 0;

  // Controls the vertical offset of the slope's sign.
  // Zero is vertically centered on the equals sign, positive values move it down, negative move it up.
  // This was created because there was a great deal of discussion about where the sign should be placed.
  slopeSignYOffset = 0;

  // Fudge factors for horizontal lines, to vertically center them with equals sign (set by visual inspection).
  // Note that these are currently all zero, and that looks good in JavaScript.
  // In Java, they were a function of fontSize.
  // We're keeping this feature in case future 'tweaks' are needed.
  slopeSignYFudgeFactor = 0;
  operatorYFudgeFactor = 0;
  fractionLineYFudgeFactor = 0;
  undefinedSlopeYFudgeFactor = 0;
  equalsSignFudgeFactor = 0;

  // thickness of the fraction divisor line

  // size of the lines used to create + and - operators

  // size of the lines used to create + and - signs

  // spacing between components of an equation
  // spacing between a sign and the integer to the right of it
  // spacing between a sign and the fraction to the right of it
  // spacing between a fractional slope and what's to the right of it
  // spacing between an integer slope and what's to the right of it
  // space around an operator (eg, +)
  // space around the relational operator (eg, =)
  // space between a parenthesis and the thing it encloses
  // y spacing between spinners and fraction line
  // y spacing between rise and run values (with blue backgrounds) and fraction line

  // all other y spacing

  constructor(providedOptions) {
    const options = optionize()({
      // SelfOptions
      fontSize: 18
    }, providedOptions);
    super();
    const fontSize = options.fontSize;

    // Multipliers were chosen empirically.
    this.fractionLineThickness = 0.06 * fontSize;
    this.operatorLineSize = new Dimension2(0.54 * fontSize, 0.07 * fontSize);
    this.signLineSize = new Dimension2(0.54 * fontSize, 0.11 * fontSize);
    this.integerSignXSpacing = 0.18 * fontSize;
    this.fractionSignXSpacing = 0.36 * fontSize;
    this.integerSlopeXSpacing = 0.04 * fontSize;
    this.fractionalSlopeXSpacing = 0.15 * fontSize;
    this.operatorXSpacing = 0.25 * fontSize;
    this.relationalOperatorXSpacing = 0.35 * fontSize;
    this.parenXSpacing = 0.07 * fontSize;
    this.pickersYSpacing = 0.2 * fontSize;
    this.slopeYSpacing = 0.4 * fontSize;
    this.ySpacing = 0.1 * fontSize;
    this.mutate(options);
  }

  /**
   * Gets the max width for the rise and run pickers used in an interactive equation.
   */
  static computeMaxSlopePickerWidth(riseRangeProperty, runRangeProperty, font, decimalPlaces) {
    const pickerOptions = {
      font: font,
      decimalPlaces: decimalPlaces
    };

    // Create prototypical pickers.
    const maxRiseNode = new SlopePicker(new Property(riseRangeProperty.value.max), new Property(runRangeProperty.value.max), riseRangeProperty, pickerOptions);
    const minRiseNode = new SlopePicker(new Property(riseRangeProperty.value.min), new Property(runRangeProperty.value.max), riseRangeProperty, pickerOptions);
    const maxRunNode = new SlopePicker(new Property(runRangeProperty.value.max), new Property(riseRangeProperty.value.max), runRangeProperty, pickerOptions);
    const minRunNode = new SlopePicker(new Property(runRangeProperty.value.min), new Property(riseRangeProperty.value.min), runRangeProperty, pickerOptions);

    // Compute the max width
    const maxRiseWidth = Math.max(maxRiseNode.width, minRiseNode.width);
    const maxRunWidth = Math.max(maxRunNode.width, minRunNode.width);
    return Math.max(maxRiseWidth, maxRunWidth);
  }
}
graphingLines.register('EquationNode', EquationNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIkRpbWVuc2lvbjIiLCJOb2RlIiwiZ3JhcGhpbmdMaW5lcyIsIlNsb3BlUGlja2VyIiwib3B0aW9uaXplIiwiRXF1YXRpb25Ob2RlIiwiZGVjaW1hbFBsYWNlcyIsInNsb3BlU2lnbllPZmZzZXQiLCJzbG9wZVNpZ25ZRnVkZ2VGYWN0b3IiLCJvcGVyYXRvcllGdWRnZUZhY3RvciIsImZyYWN0aW9uTGluZVlGdWRnZUZhY3RvciIsInVuZGVmaW5lZFNsb3BlWUZ1ZGdlRmFjdG9yIiwiZXF1YWxzU2lnbkZ1ZGdlRmFjdG9yIiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwiZm9udFNpemUiLCJmcmFjdGlvbkxpbmVUaGlja25lc3MiLCJvcGVyYXRvckxpbmVTaXplIiwic2lnbkxpbmVTaXplIiwiaW50ZWdlclNpZ25YU3BhY2luZyIsImZyYWN0aW9uU2lnblhTcGFjaW5nIiwiaW50ZWdlclNsb3BlWFNwYWNpbmciLCJmcmFjdGlvbmFsU2xvcGVYU3BhY2luZyIsIm9wZXJhdG9yWFNwYWNpbmciLCJyZWxhdGlvbmFsT3BlcmF0b3JYU3BhY2luZyIsInBhcmVuWFNwYWNpbmciLCJwaWNrZXJzWVNwYWNpbmciLCJzbG9wZVlTcGFjaW5nIiwieVNwYWNpbmciLCJtdXRhdGUiLCJjb21wdXRlTWF4U2xvcGVQaWNrZXJXaWR0aCIsInJpc2VSYW5nZVByb3BlcnR5IiwicnVuUmFuZ2VQcm9wZXJ0eSIsImZvbnQiLCJwaWNrZXJPcHRpb25zIiwibWF4UmlzZU5vZGUiLCJ2YWx1ZSIsIm1heCIsIm1pblJpc2VOb2RlIiwibWluIiwibWF4UnVuTm9kZSIsIm1pblJ1bk5vZGUiLCJtYXhSaXNlV2lkdGgiLCJNYXRoIiwid2lkdGgiLCJtYXhSdW5XaWR0aCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRXF1YXRpb25Ob2RlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDEzLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEVxdWF0aW9uTm9kZSBpcyB0aGUgYmFzZSBjbGFzcyBmb3IgYWxsIGVxdWF0aW9ucy5cclxuICogRGltZW5zaW9ucyBhbmQgbGF5b3V0IG9mZnNldHMgYXJlIGNvbXB1dGVkIGFzIHBlcmNlbnRhZ2VzIG9mIHRoZSBmb250J3MgcG9pbnQgc2l6ZS5cclxuICogVGhlc2UgbXVsdGlwbGllcnMgd2VyZSBkZXRlcm1pbmVkIGVtcGlyaWNhbGx5IGJ5IGNvbW1pdHRlZSAtIG1vZGlmeSBhdCB5b3VyIHBlcmlsIVxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IERpbWVuc2lvbjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0RpbWVuc2lvbjIuanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IHsgTm9kZSwgTm9kZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgZ3JhcGhpbmdMaW5lcyBmcm9tICcuLi8uLi9ncmFwaGluZ0xpbmVzLmpzJztcclxuaW1wb3J0IFNsb3BlUGlja2VyIGZyb20gJy4vcGlja2VyL1Nsb3BlUGlja2VyLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IFBpY2tPcHRpb25hbCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja09wdGlvbmFsLmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgZm9udFNpemU/OiBudW1iZXI7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBFcXVhdGlvbk5vZGVPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBQaWNrT3B0aW9uYWw8Tm9kZU9wdGlvbnMsICdtYXhXaWR0aCc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXF1YXRpb25Ob2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBkZWNpbWFsUGxhY2VzID0gMDtcclxuXHJcbiAgLy8gQ29udHJvbHMgdGhlIHZlcnRpY2FsIG9mZnNldCBvZiB0aGUgc2xvcGUncyBzaWduLlxyXG4gIC8vIFplcm8gaXMgdmVydGljYWxseSBjZW50ZXJlZCBvbiB0aGUgZXF1YWxzIHNpZ24sIHBvc2l0aXZlIHZhbHVlcyBtb3ZlIGl0IGRvd24sIG5lZ2F0aXZlIG1vdmUgaXQgdXAuXHJcbiAgLy8gVGhpcyB3YXMgY3JlYXRlZCBiZWNhdXNlIHRoZXJlIHdhcyBhIGdyZWF0IGRlYWwgb2YgZGlzY3Vzc2lvbiBhYm91dCB3aGVyZSB0aGUgc2lnbiBzaG91bGQgYmUgcGxhY2VkLlxyXG4gIHByb3RlY3RlZCByZWFkb25seSBzbG9wZVNpZ25ZT2Zmc2V0ID0gMDtcclxuXHJcbiAgLy8gRnVkZ2UgZmFjdG9ycyBmb3IgaG9yaXpvbnRhbCBsaW5lcywgdG8gdmVydGljYWxseSBjZW50ZXIgdGhlbSB3aXRoIGVxdWFscyBzaWduIChzZXQgYnkgdmlzdWFsIGluc3BlY3Rpb24pLlxyXG4gIC8vIE5vdGUgdGhhdCB0aGVzZSBhcmUgY3VycmVudGx5IGFsbCB6ZXJvLCBhbmQgdGhhdCBsb29rcyBnb29kIGluIEphdmFTY3JpcHQuXHJcbiAgLy8gSW4gSmF2YSwgdGhleSB3ZXJlIGEgZnVuY3Rpb24gb2YgZm9udFNpemUuXHJcbiAgLy8gV2UncmUga2VlcGluZyB0aGlzIGZlYXR1cmUgaW4gY2FzZSBmdXR1cmUgJ3R3ZWFrcycgYXJlIG5lZWRlZC5cclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgc2xvcGVTaWduWUZ1ZGdlRmFjdG9yID0gMDtcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgb3BlcmF0b3JZRnVkZ2VGYWN0b3IgPSAwO1xyXG4gIHByb3RlY3RlZCByZWFkb25seSBmcmFjdGlvbkxpbmVZRnVkZ2VGYWN0b3IgPSAwO1xyXG4gIHByb3RlY3RlZCByZWFkb25seSB1bmRlZmluZWRTbG9wZVlGdWRnZUZhY3RvciA9IDA7XHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IGVxdWFsc1NpZ25GdWRnZUZhY3RvciA9IDA7XHJcblxyXG4gIC8vIHRoaWNrbmVzcyBvZiB0aGUgZnJhY3Rpb24gZGl2aXNvciBsaW5lXHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IGZyYWN0aW9uTGluZVRoaWNrbmVzczogbnVtYmVyO1xyXG5cclxuICAvLyBzaXplIG9mIHRoZSBsaW5lcyB1c2VkIHRvIGNyZWF0ZSArIGFuZCAtIG9wZXJhdG9yc1xyXG4gIHByb3RlY3RlZCByZWFkb25seSBvcGVyYXRvckxpbmVTaXplOiBEaW1lbnNpb24yO1xyXG5cclxuICAvLyBzaXplIG9mIHRoZSBsaW5lcyB1c2VkIHRvIGNyZWF0ZSArIGFuZCAtIHNpZ25zXHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHNpZ25MaW5lU2l6ZTogRGltZW5zaW9uMjtcclxuXHJcbiAgLy8gc3BhY2luZyBiZXR3ZWVuIGNvbXBvbmVudHMgb2YgYW4gZXF1YXRpb25cclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgaW50ZWdlclNpZ25YU3BhY2luZzogbnVtYmVyOyAvLyBzcGFjaW5nIGJldHdlZW4gYSBzaWduIGFuZCB0aGUgaW50ZWdlciB0byB0aGUgcmlnaHQgb2YgaXRcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgZnJhY3Rpb25TaWduWFNwYWNpbmc6IG51bWJlcjsgLy8gc3BhY2luZyBiZXR3ZWVuIGEgc2lnbiBhbmQgdGhlIGZyYWN0aW9uIHRvIHRoZSByaWdodCBvZiBpdFxyXG4gIHByb3RlY3RlZCByZWFkb25seSBpbnRlZ2VyU2xvcGVYU3BhY2luZzogbnVtYmVyOyAvLyBzcGFjaW5nIGJldHdlZW4gYSBmcmFjdGlvbmFsIHNsb3BlIGFuZCB3aGF0J3MgdG8gdGhlIHJpZ2h0IG9mIGl0XHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IGZyYWN0aW9uYWxTbG9wZVhTcGFjaW5nOiBudW1iZXI7IC8vIHNwYWNpbmcgYmV0d2VlbiBhbiBpbnRlZ2VyIHNsb3BlIGFuZCB3aGF0J3MgdG8gdGhlIHJpZ2h0IG9mIGl0XHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IG9wZXJhdG9yWFNwYWNpbmc6IG51bWJlcjsgLy8gc3BhY2UgYXJvdW5kIGFuIG9wZXJhdG9yIChlZywgKylcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgcmVsYXRpb25hbE9wZXJhdG9yWFNwYWNpbmc6IG51bWJlcjsgLy8gc3BhY2UgYXJvdW5kIHRoZSByZWxhdGlvbmFsIG9wZXJhdG9yIChlZywgPSlcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgcGFyZW5YU3BhY2luZzogbnVtYmVyOyAvLyBzcGFjZSBiZXR3ZWVuIGEgcGFyZW50aGVzaXMgYW5kIHRoZSB0aGluZyBpdCBlbmNsb3Nlc1xyXG4gIHByb3RlY3RlZCByZWFkb25seSBwaWNrZXJzWVNwYWNpbmc6IG51bWJlcjsgLy8geSBzcGFjaW5nIGJldHdlZW4gc3Bpbm5lcnMgYW5kIGZyYWN0aW9uIGxpbmVcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgc2xvcGVZU3BhY2luZzogbnVtYmVyOyAvLyB5IHNwYWNpbmcgYmV0d2VlbiByaXNlIGFuZCBydW4gdmFsdWVzICh3aXRoIGJsdWUgYmFja2dyb3VuZHMpIGFuZCBmcmFjdGlvbiBsaW5lXHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHlTcGFjaW5nOiBudW1iZXI7IC8vIGFsbCBvdGhlciB5IHNwYWNpbmdcclxuXHJcbiAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKCBwcm92aWRlZE9wdGlvbnM/OiBFcXVhdGlvbk5vZGVPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8RXF1YXRpb25Ob2RlT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBTZWxmT3B0aW9uc1xyXG4gICAgICBmb250U2l6ZTogMThcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgY29uc3QgZm9udFNpemUgPSBvcHRpb25zLmZvbnRTaXplO1xyXG5cclxuICAgIC8vIE11bHRpcGxpZXJzIHdlcmUgY2hvc2VuIGVtcGlyaWNhbGx5LlxyXG4gICAgdGhpcy5mcmFjdGlvbkxpbmVUaGlja25lc3MgPSAwLjA2ICogZm9udFNpemU7XHJcbiAgICB0aGlzLm9wZXJhdG9yTGluZVNpemUgPSBuZXcgRGltZW5zaW9uMiggMC41NCAqIGZvbnRTaXplLCAwLjA3ICogZm9udFNpemUgKTtcclxuICAgIHRoaXMuc2lnbkxpbmVTaXplID0gbmV3IERpbWVuc2lvbjIoIDAuNTQgKiBmb250U2l6ZSwgMC4xMSAqIGZvbnRTaXplICk7XHJcbiAgICB0aGlzLmludGVnZXJTaWduWFNwYWNpbmcgPSAwLjE4ICogZm9udFNpemU7XHJcbiAgICB0aGlzLmZyYWN0aW9uU2lnblhTcGFjaW5nID0gMC4zNiAqIGZvbnRTaXplO1xyXG4gICAgdGhpcy5pbnRlZ2VyU2xvcGVYU3BhY2luZyA9IDAuMDQgKiBmb250U2l6ZTtcclxuICAgIHRoaXMuZnJhY3Rpb25hbFNsb3BlWFNwYWNpbmcgPSAwLjE1ICogZm9udFNpemU7XHJcbiAgICB0aGlzLm9wZXJhdG9yWFNwYWNpbmcgPSAwLjI1ICogZm9udFNpemU7XHJcbiAgICB0aGlzLnJlbGF0aW9uYWxPcGVyYXRvclhTcGFjaW5nID0gMC4zNSAqIGZvbnRTaXplO1xyXG4gICAgdGhpcy5wYXJlblhTcGFjaW5nID0gMC4wNyAqIGZvbnRTaXplO1xyXG4gICAgdGhpcy5waWNrZXJzWVNwYWNpbmcgPSAwLjIgKiBmb250U2l6ZTtcclxuICAgIHRoaXMuc2xvcGVZU3BhY2luZyA9IDAuNCAqIGZvbnRTaXplO1xyXG4gICAgdGhpcy55U3BhY2luZyA9IDAuMSAqIGZvbnRTaXplO1xyXG5cclxuICAgIHRoaXMubXV0YXRlKCBvcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXRzIHRoZSBtYXggd2lkdGggZm9yIHRoZSByaXNlIGFuZCBydW4gcGlja2VycyB1c2VkIGluIGFuIGludGVyYWN0aXZlIGVxdWF0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgY29tcHV0ZU1heFNsb3BlUGlja2VyV2lkdGgoIHJpc2VSYW5nZVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxSYW5nZT4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuUmFuZ2VQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8UmFuZ2U+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IFBoZXRGb250LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2ltYWxQbGFjZXM6IG51bWJlciApOiBudW1iZXIge1xyXG5cclxuICAgIGNvbnN0IHBpY2tlck9wdGlvbnMgPSB7XHJcbiAgICAgIGZvbnQ6IGZvbnQsXHJcbiAgICAgIGRlY2ltYWxQbGFjZXM6IGRlY2ltYWxQbGFjZXNcclxuICAgIH07XHJcblxyXG4gICAgLy8gQ3JlYXRlIHByb3RvdHlwaWNhbCBwaWNrZXJzLlxyXG4gICAgY29uc3QgbWF4UmlzZU5vZGUgPSBuZXcgU2xvcGVQaWNrZXIoIG5ldyBQcm9wZXJ0eSggcmlzZVJhbmdlUHJvcGVydHkudmFsdWUubWF4ICksXHJcbiAgICAgIG5ldyBQcm9wZXJ0eSggcnVuUmFuZ2VQcm9wZXJ0eS52YWx1ZS5tYXggKSwgcmlzZVJhbmdlUHJvcGVydHksIHBpY2tlck9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCBtaW5SaXNlTm9kZSA9IG5ldyBTbG9wZVBpY2tlciggbmV3IFByb3BlcnR5KCByaXNlUmFuZ2VQcm9wZXJ0eS52YWx1ZS5taW4gKSxcclxuICAgICAgbmV3IFByb3BlcnR5KCBydW5SYW5nZVByb3BlcnR5LnZhbHVlLm1heCApLCByaXNlUmFuZ2VQcm9wZXJ0eSwgcGlja2VyT3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IG1heFJ1bk5vZGUgPSBuZXcgU2xvcGVQaWNrZXIoXHJcbiAgICAgIG5ldyBQcm9wZXJ0eSggcnVuUmFuZ2VQcm9wZXJ0eS52YWx1ZS5tYXggKSxcclxuICAgICAgbmV3IFByb3BlcnR5KCByaXNlUmFuZ2VQcm9wZXJ0eS52YWx1ZS5tYXggKSwgcnVuUmFuZ2VQcm9wZXJ0eSwgcGlja2VyT3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IG1pblJ1bk5vZGUgPSBuZXcgU2xvcGVQaWNrZXIoIG5ldyBQcm9wZXJ0eSggcnVuUmFuZ2VQcm9wZXJ0eS52YWx1ZS5taW4gKSxcclxuICAgICAgbmV3IFByb3BlcnR5KCByaXNlUmFuZ2VQcm9wZXJ0eS52YWx1ZS5taW4gKSwgcnVuUmFuZ2VQcm9wZXJ0eSwgcGlja2VyT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIENvbXB1dGUgdGhlIG1heCB3aWR0aFxyXG4gICAgY29uc3QgbWF4UmlzZVdpZHRoID0gTWF0aC5tYXgoIG1heFJpc2VOb2RlLndpZHRoLCBtaW5SaXNlTm9kZS53aWR0aCApO1xyXG4gICAgY29uc3QgbWF4UnVuV2lkdGggPSBNYXRoLm1heCggbWF4UnVuTm9kZS53aWR0aCwgbWluUnVuTm9kZS53aWR0aCApO1xyXG4gICAgcmV0dXJuIE1hdGgubWF4KCBtYXhSaXNlV2lkdGgsIG1heFJ1bldpZHRoICk7XHJcbiAgfVxyXG59XHJcblxyXG5ncmFwaGluZ0xpbmVzLnJlZ2lzdGVyKCAnRXF1YXRpb25O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