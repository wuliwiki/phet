// Copyright 2013-2023, University of Colorado Boulder

/**
 * Base class for graphs, displays a 2D grid and axes.
 * The node's origin is at model coordinate (0,0).
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Dimension2 from '../../../../dot/js/Dimension2.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import { Shape } from '../../../../kite/js/imports.js';
import ArrowNode from '../../../../scenery-phet/js/ArrowNode.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Line, Node, Path, Rectangle, RichText, Text } from '../../../../scenery/js/imports.js';
import graphingLines from '../../graphingLines.js';
import GLSymbols from '../GLSymbols.js';
//----------------------------------------------------------------------------------------
// constants
//----------------------------------------------------------------------------------------
// grid
const GRID_BACKGROUND = 'white';
const MINOR_GRID_LINE_WIDTH = 1.0;
const MINOR_GRID_LINE_COLOR = 'rgb( 230, 230, 230 )';
const MAJOR_GRID_LINE_WIDTH = 1.0;
const MAJOR_GRID_LINE_COLOR = 'rgb( 192, 192, 192 )';

// axes
const AXIS_ARROW_SIZE = new Dimension2(10, 10);
const AXIS_THICKNESS = 1;
const AXIS_COLOR = 'black';
const AXIS_EXTENT = 1.0; // how far the arrow extends past the min/max ticks, in model coordinates
const AXIS_LABEL_FONT = new PhetFont({
  size: 16,
  weight: 'bold'
});
const AXIS_LABEL_SPACING = 2; // space between end of axis and label

// ticks
const MAJOR_TICK_SPACING = 5; // model units
const MINOR_TICK_LENGTH = 3; // how far a minor tick extends from the axis
const MINOR_TICK_LINE_WIDTH = 0.5;
const MINOR_TICK_COLOR = 'black';
const MAJOR_TICK_LENGTH = 6; // how far a major tick extends from the axis
const MAJOR_TICK_LINE_WIDTH = 1;
const MAJOR_TICK_COLOR = 'black';
const MAJOR_TICK_FONT = new PhetFont(16);
const TICK_LABEL_SPACING = 2;
const MINUS_SIGN_WIDTH = new Text('-', {
  font: MAJOR_TICK_FONT
}).width;
export default class GraphNode extends Node {
  constructor(graph, modelViewTransform) {
    // (0,0) and quadrant 1 is visible
    assert && assert(graph.contains(new Vector2(0, 0)) && graph.contains(new Vector2(1, 1)));
    const gridNode = new GridNode(graph, modelViewTransform);
    super({
      children: [gridNode, new XAxisNode(graph, modelViewTransform), new YAxisNode(graph, modelViewTransform)]
    });
    this.gridNode = gridNode;
  }

  // Sets the visibility of the grid
  setGridVisible(visible) {
    this.gridNode.setLinesVisible(visible);
  }
}

//----------------------------------------------------------------------------------------

/**
 * A major or minor line in the grid, drawn from (x1,y1) to (x2,y2).
 */
class GridLineNode extends Line {
  constructor(x1, y1, x2, y2, isMajor) {
    super(x1, y1, x2, y2, {
      lineWidth: isMajor ? MAJOR_GRID_LINE_WIDTH : MINOR_GRID_LINE_WIDTH,
      stroke: isMajor ? MAJOR_GRID_LINE_COLOR : MINOR_GRID_LINE_COLOR
    });
  }
}

/**
 * Major tick with label, orientation is vertical or horizontal
 */
class MajorTickNode extends Node {
  constructor(x, y, value, isVertical) {
    super();

    // tick line
    const tickLineNode = new Path(isVertical ? Shape.lineSegment(x, y - MAJOR_TICK_LENGTH, x, y + MAJOR_TICK_LENGTH) : Shape.lineSegment(x - MAJOR_TICK_LENGTH, y, x + MAJOR_TICK_LENGTH, y), {
      stroke: MAJOR_TICK_COLOR,
      lineWidth: MAJOR_TICK_LINE_WIDTH
    });
    this.addChild(tickLineNode);

    // tick label
    const tickLabelNode = new Text(value, {
      font: MAJOR_TICK_FONT,
      fill: MAJOR_TICK_COLOR
    });
    this.addChild(tickLabelNode);

    // label position
    if (isVertical) {
      // center the label under the line, compensate for minus sign
      const signXOffset = value < 0 ? -(MINUS_SIGN_WIDTH / 2) : 0;
      tickLabelNode.left = tickLineNode.centerX - tickLabelNode.width / 2 + signXOffset;
      tickLabelNode.top = tickLineNode.bottom + TICK_LABEL_SPACING;
    } else {
      // center label to left of line
      tickLabelNode.right = tickLineNode.left - TICK_LABEL_SPACING;
      tickLabelNode.centerY = tickLineNode.centerY;
    }
  }
}

/**
 * Minor tick mark, no label, orientation is vertical or horizontal.
 */
class MinorTickNode extends Path {
  constructor(x, y, isVertical) {
    super(isVertical ? Shape.lineSegment(x, y - MINOR_TICK_LENGTH, x, y + MINOR_TICK_LENGTH) : Shape.lineSegment(x - MINOR_TICK_LENGTH, y, x + MINOR_TICK_LENGTH, y), {
      lineWidth: MINOR_TICK_LINE_WIDTH,
      stroke: MINOR_TICK_COLOR
    });
  }
}

/**
 * X-axis (horizontal)
 */
class XAxisNode extends Node {
  constructor(graph, modelViewTransform) {
    super();

    // horizontal line with arrows at both ends
    const tailPosition = new Vector2(modelViewTransform.modelToViewX(graph.xRange.min - AXIS_EXTENT), modelViewTransform.modelToViewY(0));
    const tipPosition = new Vector2(modelViewTransform.modelToViewX(graph.xRange.max + AXIS_EXTENT), modelViewTransform.modelToViewY(0));
    const lineNode = new ArrowNode(tailPosition.x, tailPosition.y, tipPosition.x, tipPosition.y, {
      doubleHead: true,
      headHeight: AXIS_ARROW_SIZE.height,
      headWidth: AXIS_ARROW_SIZE.width,
      tailWidth: AXIS_THICKNESS,
      fill: AXIS_COLOR,
      stroke: null
    });
    this.addChild(lineNode);

    // label at positive (right) end
    const labelNode = new RichText(GLSymbols.x, {
      font: AXIS_LABEL_FONT,
      maxWidth: 30
    });
    this.addChild(labelNode);
    labelNode.left = lineNode.right + AXIS_LABEL_SPACING;
    labelNode.centerY = lineNode.centerY;

    // ticks
    const numberOfTicks = graph.getWidth() + 1;
    for (let i = 0; i < numberOfTicks; i++) {
      const modelX = graph.xRange.min + i;
      if (modelX !== 0) {
        // skip the origin
        const x = modelViewTransform.modelToViewX(modelX);
        const y = modelViewTransform.modelToViewY(0);
        if (Math.abs(modelX) % MAJOR_TICK_SPACING === 0) {
          // major tick
          this.addChild(new MajorTickNode(x, y, modelX, true));
        } else {
          // minor tick
          this.addChild(new MinorTickNode(x, y, true));
        }
      }
    }
  }
}

/**
 * Y-axis (vertical)
 */
class YAxisNode extends Node {
  constructor(graph, modelViewTransform) {
    super();

    // vertical line with arrows at both ends
    const tailPosition = new Vector2(modelViewTransform.modelToViewX(0), modelViewTransform.modelToViewY(graph.yRange.min - AXIS_EXTENT));
    const tipPosition = new Vector2(modelViewTransform.modelToViewX(0), modelViewTransform.modelToViewY(graph.yRange.max + AXIS_EXTENT));
    const lineNode = new ArrowNode(tailPosition.x, tailPosition.y, tipPosition.x, tipPosition.y, {
      doubleHead: true,
      headHeight: AXIS_ARROW_SIZE.height,
      headWidth: AXIS_ARROW_SIZE.width,
      tailWidth: AXIS_THICKNESS,
      fill: AXIS_COLOR,
      stroke: null
    });
    this.addChild(lineNode);

    // label at positive (top) end
    const labelNode = new RichText(GLSymbols.y, {
      font: AXIS_LABEL_FONT,
      maxWidth: 30
    });
    this.addChild(labelNode);
    labelNode.centerX = lineNode.centerX;
    labelNode.bottom = lineNode.top - AXIS_LABEL_SPACING;

    // ticks
    const numberOfTicks = graph.getHeight() + 1;
    for (let i = 0; i < numberOfTicks; i++) {
      const modelY = graph.yRange.min + i;
      if (modelY !== 0) {
        // skip the origin
        const x = modelViewTransform.modelToViewX(0);
        const y = modelViewTransform.modelToViewY(modelY);
        if (Math.abs(modelY) % MAJOR_TICK_SPACING === 0) {
          // major tick
          this.addChild(new MajorTickNode(x, y, modelY, false));
        } else {
          // minor tick
          this.addChild(new MinorTickNode(x, y, false));
        }
      }
    }
  }
}

/**
 * 2D grid
 */
class GridNode extends Node {
  constructor(graph, modelViewTransform) {
    super();

    // background
    const backgroundNode = new Rectangle(modelViewTransform.modelToViewX(graph.xRange.min), modelViewTransform.modelToViewY(graph.yRange.max), modelViewTransform.modelToViewDeltaX(graph.getWidth()), modelViewTransform.modelToViewDeltaY(-graph.getHeight()), {
      fill: GRID_BACKGROUND,
      stroke: MAJOR_GRID_LINE_COLOR
    });
    this.addChild(backgroundNode);

    // horizontal grid lines, one line for each unit of grid spacing
    this.horizontalGridLinesNode = new Node();
    this.addChild(this.horizontalGridLinesNode);
    const numberOfHorizontalGridLines = graph.getHeight() + 1;
    const minX = modelViewTransform.modelToViewX(graph.xRange.min);
    const maxX = modelViewTransform.modelToViewX(graph.xRange.max);
    for (let i = 0; i < numberOfHorizontalGridLines; i++) {
      const modelY = graph.yRange.min + i;
      if (modelY !== 0) {
        // skip origin, x axis will live here
        const yOffset = modelViewTransform.modelToViewY(modelY);
        const isMajorX = Math.abs(modelY) % MAJOR_TICK_SPACING === 0;
        this.horizontalGridLinesNode.addChild(new GridLineNode(minX, yOffset, maxX, yOffset, isMajorX));
      }
    }

    // vertical grid lines, one line for each unit of grid spacing
    this.verticalGridLinesNode = new Node();
    this.addChild(this.verticalGridLinesNode);
    const numberOfVerticalGridLines = graph.getWidth() + 1;
    const minY = modelViewTransform.modelToViewY(graph.yRange.max); // yes, swap min and max
    const maxY = modelViewTransform.modelToViewY(graph.yRange.min);
    for (let j = 0; j < numberOfVerticalGridLines; j++) {
      const modelX = graph.xRange.min + j;
      if (modelX !== 0) {
        // skip origin, y axis will live here
        const xOffset = modelViewTransform.modelToViewX(modelX);
        const isMajorY = Math.abs(modelX) % MAJOR_TICK_SPACING === 0;
        this.verticalGridLinesNode.addChild(new GridLineNode(xOffset, minY, xOffset, maxY, isMajorY));
      }
    }
  }

  // Sets visibility of grid lines.
  setLinesVisible(visible) {
    this.horizontalGridLinesNode.visible = this.verticalGridLinesNode.visible = visible;
  }
}
graphingLines.register('GraphNode', GraphNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEaW1lbnNpb24yIiwiVmVjdG9yMiIsIlNoYXBlIiwiQXJyb3dOb2RlIiwiUGhldEZvbnQiLCJMaW5lIiwiTm9kZSIsIlBhdGgiLCJSZWN0YW5nbGUiLCJSaWNoVGV4dCIsIlRleHQiLCJncmFwaGluZ0xpbmVzIiwiR0xTeW1ib2xzIiwiR1JJRF9CQUNLR1JPVU5EIiwiTUlOT1JfR1JJRF9MSU5FX1dJRFRIIiwiTUlOT1JfR1JJRF9MSU5FX0NPTE9SIiwiTUFKT1JfR1JJRF9MSU5FX1dJRFRIIiwiTUFKT1JfR1JJRF9MSU5FX0NPTE9SIiwiQVhJU19BUlJPV19TSVpFIiwiQVhJU19USElDS05FU1MiLCJBWElTX0NPTE9SIiwiQVhJU19FWFRFTlQiLCJBWElTX0xBQkVMX0ZPTlQiLCJzaXplIiwid2VpZ2h0IiwiQVhJU19MQUJFTF9TUEFDSU5HIiwiTUFKT1JfVElDS19TUEFDSU5HIiwiTUlOT1JfVElDS19MRU5HVEgiLCJNSU5PUl9USUNLX0xJTkVfV0lEVEgiLCJNSU5PUl9USUNLX0NPTE9SIiwiTUFKT1JfVElDS19MRU5HVEgiLCJNQUpPUl9USUNLX0xJTkVfV0lEVEgiLCJNQUpPUl9USUNLX0NPTE9SIiwiTUFKT1JfVElDS19GT05UIiwiVElDS19MQUJFTF9TUEFDSU5HIiwiTUlOVVNfU0lHTl9XSURUSCIsImZvbnQiLCJ3aWR0aCIsIkdyYXBoTm9kZSIsImNvbnN0cnVjdG9yIiwiZ3JhcGgiLCJtb2RlbFZpZXdUcmFuc2Zvcm0iLCJhc3NlcnQiLCJjb250YWlucyIsImdyaWROb2RlIiwiR3JpZE5vZGUiLCJjaGlsZHJlbiIsIlhBeGlzTm9kZSIsIllBeGlzTm9kZSIsInNldEdyaWRWaXNpYmxlIiwidmlzaWJsZSIsInNldExpbmVzVmlzaWJsZSIsIkdyaWRMaW5lTm9kZSIsIngxIiwieTEiLCJ4MiIsInkyIiwiaXNNYWpvciIsImxpbmVXaWR0aCIsInN0cm9rZSIsIk1ham9yVGlja05vZGUiLCJ4IiwieSIsInZhbHVlIiwiaXNWZXJ0aWNhbCIsInRpY2tMaW5lTm9kZSIsImxpbmVTZWdtZW50IiwiYWRkQ2hpbGQiLCJ0aWNrTGFiZWxOb2RlIiwiZmlsbCIsInNpZ25YT2Zmc2V0IiwibGVmdCIsImNlbnRlclgiLCJ0b3AiLCJib3R0b20iLCJyaWdodCIsImNlbnRlclkiLCJNaW5vclRpY2tOb2RlIiwidGFpbFBvc2l0aW9uIiwibW9kZWxUb1ZpZXdYIiwieFJhbmdlIiwibWluIiwibW9kZWxUb1ZpZXdZIiwidGlwUG9zaXRpb24iLCJtYXgiLCJsaW5lTm9kZSIsImRvdWJsZUhlYWQiLCJoZWFkSGVpZ2h0IiwiaGVpZ2h0IiwiaGVhZFdpZHRoIiwidGFpbFdpZHRoIiwibGFiZWxOb2RlIiwibWF4V2lkdGgiLCJudW1iZXJPZlRpY2tzIiwiZ2V0V2lkdGgiLCJpIiwibW9kZWxYIiwiTWF0aCIsImFicyIsInlSYW5nZSIsImdldEhlaWdodCIsIm1vZGVsWSIsImJhY2tncm91bmROb2RlIiwibW9kZWxUb1ZpZXdEZWx0YVgiLCJtb2RlbFRvVmlld0RlbHRhWSIsImhvcml6b250YWxHcmlkTGluZXNOb2RlIiwibnVtYmVyT2ZIb3Jpem9udGFsR3JpZExpbmVzIiwibWluWCIsIm1heFgiLCJ5T2Zmc2V0IiwiaXNNYWpvclgiLCJ2ZXJ0aWNhbEdyaWRMaW5lc05vZGUiLCJudW1iZXJPZlZlcnRpY2FsR3JpZExpbmVzIiwibWluWSIsIm1heFkiLCJqIiwieE9mZnNldCIsImlzTWFqb3JZIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJHcmFwaE5vZGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTMtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQmFzZSBjbGFzcyBmb3IgZ3JhcGhzLCBkaXNwbGF5cyBhIDJEIGdyaWQgYW5kIGF4ZXMuXHJcbiAqIFRoZSBub2RlJ3Mgb3JpZ2luIGlzIGF0IG1vZGVsIGNvb3JkaW5hdGUgKDAsMCkuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IERpbWVuc2lvbjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0RpbWVuc2lvbjIuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgQXJyb3dOb2RlIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9BcnJvd05vZGUuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgTGluZSwgTm9kZSwgUGF0aCwgUmVjdGFuZ2xlLCBSaWNoVGV4dCwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBncmFwaGluZ0xpbmVzIGZyb20gJy4uLy4uL2dyYXBoaW5nTGluZXMuanMnO1xyXG5pbXBvcnQgR0xTeW1ib2xzIGZyb20gJy4uL0dMU3ltYm9scy5qcyc7XHJcbmltcG9ydCBHcmFwaCBmcm9tICcuLi9tb2RlbC9HcmFwaC5qcyc7XHJcblxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gY29uc3RhbnRzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy8gZ3JpZFxyXG5jb25zdCBHUklEX0JBQ0tHUk9VTkQgPSAnd2hpdGUnO1xyXG5jb25zdCBNSU5PUl9HUklEX0xJTkVfV0lEVEggPSAxLjA7XHJcbmNvbnN0IE1JTk9SX0dSSURfTElORV9DT0xPUiA9ICdyZ2IoIDIzMCwgMjMwLCAyMzAgKSc7XHJcbmNvbnN0IE1BSk9SX0dSSURfTElORV9XSURUSCA9IDEuMDtcclxuY29uc3QgTUFKT1JfR1JJRF9MSU5FX0NPTE9SID0gJ3JnYiggMTkyLCAxOTIsIDE5MiApJztcclxuXHJcbi8vIGF4ZXNcclxuY29uc3QgQVhJU19BUlJPV19TSVpFID0gbmV3IERpbWVuc2lvbjIoIDEwLCAxMCApO1xyXG5jb25zdCBBWElTX1RISUNLTkVTUyA9IDE7XHJcbmNvbnN0IEFYSVNfQ09MT1IgPSAnYmxhY2snO1xyXG5jb25zdCBBWElTX0VYVEVOVCA9IDEuMDsgLy8gaG93IGZhciB0aGUgYXJyb3cgZXh0ZW5kcyBwYXN0IHRoZSBtaW4vbWF4IHRpY2tzLCBpbiBtb2RlbCBjb29yZGluYXRlc1xyXG5jb25zdCBBWElTX0xBQkVMX0ZPTlQgPSBuZXcgUGhldEZvbnQoIHsgc2l6ZTogMTYsIHdlaWdodDogJ2JvbGQnIH0gKTtcclxuY29uc3QgQVhJU19MQUJFTF9TUEFDSU5HID0gMjsgLy8gc3BhY2UgYmV0d2VlbiBlbmQgb2YgYXhpcyBhbmQgbGFiZWxcclxuXHJcbi8vIHRpY2tzXHJcbmNvbnN0IE1BSk9SX1RJQ0tfU1BBQ0lORyA9IDU7IC8vIG1vZGVsIHVuaXRzXHJcbmNvbnN0IE1JTk9SX1RJQ0tfTEVOR1RIID0gMzsgLy8gaG93IGZhciBhIG1pbm9yIHRpY2sgZXh0ZW5kcyBmcm9tIHRoZSBheGlzXHJcbmNvbnN0IE1JTk9SX1RJQ0tfTElORV9XSURUSCA9IDAuNTtcclxuY29uc3QgTUlOT1JfVElDS19DT0xPUiA9ICdibGFjayc7XHJcbmNvbnN0IE1BSk9SX1RJQ0tfTEVOR1RIID0gNjsgLy8gaG93IGZhciBhIG1ham9yIHRpY2sgZXh0ZW5kcyBmcm9tIHRoZSBheGlzXHJcbmNvbnN0IE1BSk9SX1RJQ0tfTElORV9XSURUSCA9IDE7XHJcbmNvbnN0IE1BSk9SX1RJQ0tfQ09MT1IgPSAnYmxhY2snO1xyXG5jb25zdCBNQUpPUl9USUNLX0ZPTlQgPSBuZXcgUGhldEZvbnQoIDE2ICk7XHJcbmNvbnN0IFRJQ0tfTEFCRUxfU1BBQ0lORyA9IDI7XHJcbmNvbnN0IE1JTlVTX1NJR05fV0lEVEggPSBuZXcgVGV4dCggJy0nLCB7IGZvbnQ6IE1BSk9SX1RJQ0tfRk9OVCB9ICkud2lkdGg7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHcmFwaE5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBncmlkTm9kZTogR3JpZE5vZGU7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggZ3JhcGg6IEdyYXBoLCBtb2RlbFZpZXdUcmFuc2Zvcm06IE1vZGVsVmlld1RyYW5zZm9ybTIgKSB7XHJcblxyXG4gICAgLy8gKDAsMCkgYW5kIHF1YWRyYW50IDEgaXMgdmlzaWJsZVxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggZ3JhcGguY29udGFpbnMoIG5ldyBWZWN0b3IyKCAwLCAwICkgKSAmJiBncmFwaC5jb250YWlucyggbmV3IFZlY3RvcjIoIDEsIDEgKSApICk7XHJcblxyXG4gICAgY29uc3QgZ3JpZE5vZGUgPSBuZXcgR3JpZE5vZGUoIGdyYXBoLCBtb2RlbFZpZXdUcmFuc2Zvcm0gKTtcclxuXHJcbiAgICBzdXBlcigge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIGdyaWROb2RlLFxyXG4gICAgICAgIG5ldyBYQXhpc05vZGUoIGdyYXBoLCBtb2RlbFZpZXdUcmFuc2Zvcm0gKSxcclxuICAgICAgICBuZXcgWUF4aXNOb2RlKCBncmFwaCwgbW9kZWxWaWV3VHJhbnNmb3JtIClcclxuICAgICAgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuZ3JpZE5vZGUgPSBncmlkTm9kZTtcclxuICB9XHJcblxyXG4gIC8vIFNldHMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGdyaWRcclxuICBwdWJsaWMgc2V0R3JpZFZpc2libGUoIHZpc2libGU6IGJvb2xlYW4gKTogdm9pZCB7XHJcbiAgICB0aGlzLmdyaWROb2RlLnNldExpbmVzVmlzaWJsZSggdmlzaWJsZSApO1xyXG4gIH1cclxufVxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vKipcclxuICogQSBtYWpvciBvciBtaW5vciBsaW5lIGluIHRoZSBncmlkLCBkcmF3biBmcm9tICh4MSx5MSkgdG8gKHgyLHkyKS5cclxuICovXHJcbmNsYXNzIEdyaWRMaW5lTm9kZSBleHRlbmRzIExpbmUge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHgxOiBudW1iZXIsIHkxOiBudW1iZXIsIHgyOiBudW1iZXIsIHkyOiBudW1iZXIsIGlzTWFqb3I6IGJvb2xlYW4gKSB7XHJcbiAgICBzdXBlciggeDEsIHkxLCB4MiwgeTIsIHtcclxuICAgICAgbGluZVdpZHRoOiBpc01ham9yID8gTUFKT1JfR1JJRF9MSU5FX1dJRFRIIDogTUlOT1JfR1JJRF9MSU5FX1dJRFRILFxyXG4gICAgICBzdHJva2U6IGlzTWFqb3IgPyBNQUpPUl9HUklEX0xJTkVfQ09MT1IgOiBNSU5PUl9HUklEX0xJTkVfQ09MT1JcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNYWpvciB0aWNrIHdpdGggbGFiZWwsIG9yaWVudGF0aW9uIGlzIHZlcnRpY2FsIG9yIGhvcml6b250YWxcclxuICovXHJcbmNsYXNzIE1ham9yVGlja05vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCB4OiBudW1iZXIsIHk6IG51bWJlciwgdmFsdWU6IG51bWJlciwgaXNWZXJ0aWNhbDogYm9vbGVhbiApIHtcclxuXHJcbiAgICBzdXBlcigpO1xyXG5cclxuICAgIC8vIHRpY2sgbGluZVxyXG4gICAgY29uc3QgdGlja0xpbmVOb2RlID0gbmV3IFBhdGgoIGlzVmVydGljYWwgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNoYXBlLmxpbmVTZWdtZW50KCB4LCB5IC0gTUFKT1JfVElDS19MRU5HVEgsIHgsIHkgKyBNQUpPUl9USUNLX0xFTkdUSCApIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaGFwZS5saW5lU2VnbWVudCggeCAtIE1BSk9SX1RJQ0tfTEVOR1RILCB5LCB4ICsgTUFKT1JfVElDS19MRU5HVEgsIHkgKSwge1xyXG4gICAgICBzdHJva2U6IE1BSk9SX1RJQ0tfQ09MT1IsXHJcbiAgICAgIGxpbmVXaWR0aDogTUFKT1JfVElDS19MSU5FX1dJRFRIXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aWNrTGluZU5vZGUgKTtcclxuXHJcbiAgICAvLyB0aWNrIGxhYmVsXHJcbiAgICBjb25zdCB0aWNrTGFiZWxOb2RlID0gbmV3IFRleHQoIHZhbHVlLCB7IGZvbnQ6IE1BSk9SX1RJQ0tfRk9OVCwgZmlsbDogTUFKT1JfVElDS19DT0xPUiB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aWNrTGFiZWxOb2RlICk7XHJcblxyXG4gICAgLy8gbGFiZWwgcG9zaXRpb25cclxuICAgIGlmICggaXNWZXJ0aWNhbCApIHtcclxuICAgICAgLy8gY2VudGVyIHRoZSBsYWJlbCB1bmRlciB0aGUgbGluZSwgY29tcGVuc2F0ZSBmb3IgbWludXMgc2lnblxyXG4gICAgICBjb25zdCBzaWduWE9mZnNldCA9ICggdmFsdWUgPCAwICkgPyAtKCBNSU5VU19TSUdOX1dJRFRIIC8gMiApIDogMDtcclxuICAgICAgdGlja0xhYmVsTm9kZS5sZWZ0ID0gdGlja0xpbmVOb2RlLmNlbnRlclggLSAoIHRpY2tMYWJlbE5vZGUud2lkdGggLyAyICkgKyBzaWduWE9mZnNldDtcclxuICAgICAgdGlja0xhYmVsTm9kZS50b3AgPSB0aWNrTGluZU5vZGUuYm90dG9tICsgVElDS19MQUJFTF9TUEFDSU5HO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIC8vIGNlbnRlciBsYWJlbCB0byBsZWZ0IG9mIGxpbmVcclxuICAgICAgdGlja0xhYmVsTm9kZS5yaWdodCA9IHRpY2tMaW5lTm9kZS5sZWZ0IC0gVElDS19MQUJFTF9TUEFDSU5HO1xyXG4gICAgICB0aWNrTGFiZWxOb2RlLmNlbnRlclkgPSB0aWNrTGluZU5vZGUuY2VudGVyWTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNaW5vciB0aWNrIG1hcmssIG5vIGxhYmVsLCBvcmllbnRhdGlvbiBpcyB2ZXJ0aWNhbCBvciBob3Jpem9udGFsLlxyXG4gKi9cclxuY2xhc3MgTWlub3JUaWNrTm9kZSBleHRlbmRzIFBhdGgge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHg6IG51bWJlciwgeTogbnVtYmVyLCBpc1ZlcnRpY2FsOiBib29sZWFuICkge1xyXG4gICAgc3VwZXIoIGlzVmVydGljYWwgP1xyXG4gICAgICAgICAgIFNoYXBlLmxpbmVTZWdtZW50KCB4LCB5IC0gTUlOT1JfVElDS19MRU5HVEgsIHgsIHkgKyBNSU5PUl9USUNLX0xFTkdUSCApIDpcclxuICAgICAgICAgICBTaGFwZS5saW5lU2VnbWVudCggeCAtIE1JTk9SX1RJQ0tfTEVOR1RILCB5LCB4ICsgTUlOT1JfVElDS19MRU5HVEgsIHkgKSwge1xyXG4gICAgICBsaW5lV2lkdGg6IE1JTk9SX1RJQ0tfTElORV9XSURUSCxcclxuICAgICAgc3Ryb2tlOiBNSU5PUl9USUNLX0NPTE9SXHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogWC1heGlzIChob3Jpem9udGFsKVxyXG4gKi9cclxuY2xhc3MgWEF4aXNOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggZ3JhcGg6IEdyYXBoLCBtb2RlbFZpZXdUcmFuc2Zvcm06IE1vZGVsVmlld1RyYW5zZm9ybTIgKSB7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICAvLyBob3Jpem9udGFsIGxpbmUgd2l0aCBhcnJvd3MgYXQgYm90aCBlbmRzXHJcbiAgICBjb25zdCB0YWlsUG9zaXRpb24gPSBuZXcgVmVjdG9yMiggbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WCggZ3JhcGgueFJhbmdlLm1pbiAtIEFYSVNfRVhURU5UICksIG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIDAgKSApO1xyXG4gICAgY29uc3QgdGlwUG9zaXRpb24gPSBuZXcgVmVjdG9yMiggbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WCggZ3JhcGgueFJhbmdlLm1heCArIEFYSVNfRVhURU5UICksIG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIDAgKSApO1xyXG4gICAgY29uc3QgbGluZU5vZGUgPSBuZXcgQXJyb3dOb2RlKCB0YWlsUG9zaXRpb24ueCwgdGFpbFBvc2l0aW9uLnksIHRpcFBvc2l0aW9uLngsIHRpcFBvc2l0aW9uLnksIHtcclxuICAgICAgZG91YmxlSGVhZDogdHJ1ZSxcclxuICAgICAgaGVhZEhlaWdodDogQVhJU19BUlJPV19TSVpFLmhlaWdodCxcclxuICAgICAgaGVhZFdpZHRoOiBBWElTX0FSUk9XX1NJWkUud2lkdGgsXHJcbiAgICAgIHRhaWxXaWR0aDogQVhJU19USElDS05FU1MsXHJcbiAgICAgIGZpbGw6IEFYSVNfQ09MT1IsXHJcbiAgICAgIHN0cm9rZTogbnVsbFxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggbGluZU5vZGUgKTtcclxuXHJcbiAgICAvLyBsYWJlbCBhdCBwb3NpdGl2ZSAocmlnaHQpIGVuZFxyXG4gICAgY29uc3QgbGFiZWxOb2RlID0gbmV3IFJpY2hUZXh0KCBHTFN5bWJvbHMueCwgeyBmb250OiBBWElTX0xBQkVMX0ZPTlQsIG1heFdpZHRoOiAzMCB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBsYWJlbE5vZGUgKTtcclxuICAgIGxhYmVsTm9kZS5sZWZ0ID0gbGluZU5vZGUucmlnaHQgKyBBWElTX0xBQkVMX1NQQUNJTkc7XHJcbiAgICBsYWJlbE5vZGUuY2VudGVyWSA9IGxpbmVOb2RlLmNlbnRlclk7XHJcblxyXG4gICAgLy8gdGlja3NcclxuICAgIGNvbnN0IG51bWJlck9mVGlja3MgPSBncmFwaC5nZXRXaWR0aCgpICsgMTtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IG51bWJlck9mVGlja3M7IGkrKyApIHtcclxuICAgICAgY29uc3QgbW9kZWxYID0gZ3JhcGgueFJhbmdlLm1pbiArIGk7XHJcbiAgICAgIGlmICggbW9kZWxYICE9PSAwICkgeyAvLyBza2lwIHRoZSBvcmlnaW5cclxuICAgICAgICBjb25zdCB4ID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WCggbW9kZWxYICk7XHJcbiAgICAgICAgY29uc3QgeSA9IG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIDAgKTtcclxuICAgICAgICBpZiAoIE1hdGguYWJzKCBtb2RlbFggKSAlIE1BSk9SX1RJQ0tfU1BBQ0lORyA9PT0gMCApIHtcclxuICAgICAgICAgIC8vIG1ham9yIHRpY2tcclxuICAgICAgICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBNYWpvclRpY2tOb2RlKCB4LCB5LCBtb2RlbFgsIHRydWUgKSApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIC8vIG1pbm9yIHRpY2tcclxuICAgICAgICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBNaW5vclRpY2tOb2RlKCB4LCB5LCB0cnVlICkgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBZLWF4aXMgKHZlcnRpY2FsKVxyXG4gKi9cclxuY2xhc3MgWUF4aXNOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggZ3JhcGg6IEdyYXBoLCBtb2RlbFZpZXdUcmFuc2Zvcm06IE1vZGVsVmlld1RyYW5zZm9ybTIgKSB7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICAvLyB2ZXJ0aWNhbCBsaW5lIHdpdGggYXJyb3dzIGF0IGJvdGggZW5kc1xyXG4gICAgY29uc3QgdGFpbFBvc2l0aW9uID0gbmV3IFZlY3RvcjIoIG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1goIDAgKSwgbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WSggZ3JhcGgueVJhbmdlLm1pbiAtIEFYSVNfRVhURU5UICkgKTtcclxuICAgIGNvbnN0IHRpcFBvc2l0aW9uID0gbmV3IFZlY3RvcjIoIG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1goIDAgKSwgbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WSggZ3JhcGgueVJhbmdlLm1heCArIEFYSVNfRVhURU5UICkgKTtcclxuICAgIGNvbnN0IGxpbmVOb2RlID0gbmV3IEFycm93Tm9kZSggdGFpbFBvc2l0aW9uLngsIHRhaWxQb3NpdGlvbi55LCB0aXBQb3NpdGlvbi54LCB0aXBQb3NpdGlvbi55LCB7XHJcbiAgICAgIGRvdWJsZUhlYWQ6IHRydWUsXHJcbiAgICAgIGhlYWRIZWlnaHQ6IEFYSVNfQVJST1dfU0laRS5oZWlnaHQsXHJcbiAgICAgIGhlYWRXaWR0aDogQVhJU19BUlJPV19TSVpFLndpZHRoLFxyXG4gICAgICB0YWlsV2lkdGg6IEFYSVNfVEhJQ0tORVNTLFxyXG4gICAgICBmaWxsOiBBWElTX0NPTE9SLFxyXG4gICAgICBzdHJva2U6IG51bGxcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGxpbmVOb2RlICk7XHJcblxyXG4gICAgLy8gbGFiZWwgYXQgcG9zaXRpdmUgKHRvcCkgZW5kXHJcbiAgICBjb25zdCBsYWJlbE5vZGUgPSBuZXcgUmljaFRleHQoIEdMU3ltYm9scy55LCB7IGZvbnQ6IEFYSVNfTEFCRUxfRk9OVCwgbWF4V2lkdGg6IDMwIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGxhYmVsTm9kZSApO1xyXG4gICAgbGFiZWxOb2RlLmNlbnRlclggPSBsaW5lTm9kZS5jZW50ZXJYO1xyXG4gICAgbGFiZWxOb2RlLmJvdHRvbSA9IGxpbmVOb2RlLnRvcCAtIEFYSVNfTEFCRUxfU1BBQ0lORztcclxuXHJcbiAgICAvLyB0aWNrc1xyXG4gICAgY29uc3QgbnVtYmVyT2ZUaWNrcyA9IGdyYXBoLmdldEhlaWdodCgpICsgMTtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IG51bWJlck9mVGlja3M7IGkrKyApIHtcclxuICAgICAgY29uc3QgbW9kZWxZID0gZ3JhcGgueVJhbmdlLm1pbiArIGk7XHJcbiAgICAgIGlmICggbW9kZWxZICE9PSAwICkgeyAvLyBza2lwIHRoZSBvcmlnaW5cclxuICAgICAgICBjb25zdCB4ID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WCggMCApO1xyXG4gICAgICAgIGNvbnN0IHkgPSBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdZKCBtb2RlbFkgKTtcclxuICAgICAgICBpZiAoIE1hdGguYWJzKCBtb2RlbFkgKSAlIE1BSk9SX1RJQ0tfU1BBQ0lORyA9PT0gMCApIHtcclxuICAgICAgICAgIC8vIG1ham9yIHRpY2tcclxuICAgICAgICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBNYWpvclRpY2tOb2RlKCB4LCB5LCBtb2RlbFksIGZhbHNlICkgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAvLyBtaW5vciB0aWNrXHJcbiAgICAgICAgICB0aGlzLmFkZENoaWxkKCBuZXcgTWlub3JUaWNrTm9kZSggeCwgeSwgZmFsc2UgKSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIDJEIGdyaWRcclxuICovXHJcbmNsYXNzIEdyaWROb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgaG9yaXpvbnRhbEdyaWRMaW5lc05vZGU6IE5vZGU7XHJcbiAgcHJpdmF0ZSByZWFkb25seSB2ZXJ0aWNhbEdyaWRMaW5lc05vZGU6IE5vZGU7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggZ3JhcGg6IEdyYXBoLCBtb2RlbFZpZXdUcmFuc2Zvcm06IE1vZGVsVmlld1RyYW5zZm9ybTIgKSB7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICAvLyBiYWNrZ3JvdW5kXHJcbiAgICBjb25zdCBiYWNrZ3JvdW5kTm9kZSA9IG5ldyBSZWN0YW5nbGUoXHJcbiAgICAgIG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1goIGdyYXBoLnhSYW5nZS5taW4gKSwgbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WSggZ3JhcGgueVJhbmdlLm1heCApLFxyXG4gICAgICBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdEZWx0YVgoIGdyYXBoLmdldFdpZHRoKCkgKSwgbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3RGVsdGFZKCAtZ3JhcGguZ2V0SGVpZ2h0KCkgKSwge1xyXG4gICAgICAgIGZpbGw6IEdSSURfQkFDS0dST1VORCxcclxuICAgICAgICBzdHJva2U6IE1BSk9SX0dSSURfTElORV9DT0xPUlxyXG4gICAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBiYWNrZ3JvdW5kTm9kZSApO1xyXG5cclxuICAgIC8vIGhvcml6b250YWwgZ3JpZCBsaW5lcywgb25lIGxpbmUgZm9yIGVhY2ggdW5pdCBvZiBncmlkIHNwYWNpbmdcclxuICAgIHRoaXMuaG9yaXpvbnRhbEdyaWRMaW5lc05vZGUgPSBuZXcgTm9kZSgpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5ob3Jpem9udGFsR3JpZExpbmVzTm9kZSApO1xyXG4gICAgY29uc3QgbnVtYmVyT2ZIb3Jpem9udGFsR3JpZExpbmVzID0gZ3JhcGguZ2V0SGVpZ2h0KCkgKyAxO1xyXG4gICAgY29uc3QgbWluWCA9IG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1goIGdyYXBoLnhSYW5nZS5taW4gKTtcclxuICAgIGNvbnN0IG1heFggPSBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdYKCBncmFwaC54UmFuZ2UubWF4ICk7XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBudW1iZXJPZkhvcml6b250YWxHcmlkTGluZXM7IGkrKyApIHtcclxuICAgICAgY29uc3QgbW9kZWxZID0gZ3JhcGgueVJhbmdlLm1pbiArIGk7XHJcbiAgICAgIGlmICggbW9kZWxZICE9PSAwICkgeyAvLyBza2lwIG9yaWdpbiwgeCBheGlzIHdpbGwgbGl2ZSBoZXJlXHJcbiAgICAgICAgY29uc3QgeU9mZnNldCA9IG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIG1vZGVsWSApO1xyXG4gICAgICAgIGNvbnN0IGlzTWFqb3JYID0gTWF0aC5hYnMoIG1vZGVsWSApICUgTUFKT1JfVElDS19TUEFDSU5HID09PSAwO1xyXG4gICAgICAgIHRoaXMuaG9yaXpvbnRhbEdyaWRMaW5lc05vZGUuYWRkQ2hpbGQoIG5ldyBHcmlkTGluZU5vZGUoIG1pblgsIHlPZmZzZXQsIG1heFgsIHlPZmZzZXQsIGlzTWFqb3JYICkgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcnRpY2FsIGdyaWQgbGluZXMsIG9uZSBsaW5lIGZvciBlYWNoIHVuaXQgb2YgZ3JpZCBzcGFjaW5nXHJcbiAgICB0aGlzLnZlcnRpY2FsR3JpZExpbmVzTm9kZSA9IG5ldyBOb2RlKCk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLnZlcnRpY2FsR3JpZExpbmVzTm9kZSApO1xyXG4gICAgY29uc3QgbnVtYmVyT2ZWZXJ0aWNhbEdyaWRMaW5lcyA9IGdyYXBoLmdldFdpZHRoKCkgKyAxO1xyXG4gICAgY29uc3QgbWluWSA9IG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIGdyYXBoLnlSYW5nZS5tYXggKTsgLy8geWVzLCBzd2FwIG1pbiBhbmQgbWF4XHJcbiAgICBjb25zdCBtYXhZID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WSggZ3JhcGgueVJhbmdlLm1pbiApO1xyXG4gICAgZm9yICggbGV0IGogPSAwOyBqIDwgbnVtYmVyT2ZWZXJ0aWNhbEdyaWRMaW5lczsgaisrICkge1xyXG4gICAgICBjb25zdCBtb2RlbFggPSBncmFwaC54UmFuZ2UubWluICsgajtcclxuICAgICAgaWYgKCBtb2RlbFggIT09IDAgKSB7IC8vIHNraXAgb3JpZ2luLCB5IGF4aXMgd2lsbCBsaXZlIGhlcmVcclxuICAgICAgICBjb25zdCB4T2Zmc2V0ID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WCggbW9kZWxYICk7XHJcbiAgICAgICAgY29uc3QgaXNNYWpvclkgPSBNYXRoLmFicyggbW9kZWxYICkgJSBNQUpPUl9USUNLX1NQQUNJTkcgPT09IDA7XHJcbiAgICAgICAgdGhpcy52ZXJ0aWNhbEdyaWRMaW5lc05vZGUuYWRkQ2hpbGQoIG5ldyBHcmlkTGluZU5vZGUoIHhPZmZzZXQsIG1pblksIHhPZmZzZXQsIG1heFksIGlzTWFqb3JZICkgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gU2V0cyB2aXNpYmlsaXR5IG9mIGdyaWQgbGluZXMuXHJcbiAgcHVibGljIHNldExpbmVzVmlzaWJsZSggdmlzaWJsZTogYm9vbGVhbiApOiB2b2lkIHtcclxuICAgIHRoaXMuaG9yaXpvbnRhbEdyaWRMaW5lc05vZGUudmlzaWJsZSA9IHRoaXMudmVydGljYWxHcmlkTGluZXNOb2RlLnZpc2libGUgPSB2aXNpYmxlO1xyXG4gIH1cclxufVxyXG5cclxuZ3JhcGhpbmdMaW5lcy5yZWdpc3RlciggJ0dyYXBoTm9kZScsIEdyYXBoTm9kZSApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9B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