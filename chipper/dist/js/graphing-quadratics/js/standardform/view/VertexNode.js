// Copyright 2018-2023, University of Colorado Boulder

/**
 * Displays the vertex as a non-interactive point with coordinates label.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import BooleanIO from '../../../../tandem/js/types/BooleanIO.js';
import NullableIO from '../../../../tandem/js/types/NullableIO.js';
import GQColors from '../../common/GQColors.js';
import GQConstants from '../../common/GQConstants.js';
import graphingQuadratics from '../../graphingQuadratics.js';
import PointNode from './PointNode.js';

// constants
const COORDINATES_Y_SPACING = 5;
export default class VertexNode extends PointNode {
  constructor(quadraticProperty, graph, modelViewTransform, vertexVisibleProperty, coordinatesVisibleProperty, tandem) {
    const options = {
      // PointNode options
      radius: modelViewTransform.modelToViewDeltaX(GQConstants.POINT_RADIUS),
      coordinatesForegroundColor: 'white',
      coordinatesBackgroundColor: GQColors.VERTEX,
      coordinatesDecimals: GQConstants.VERTEX_DECIMALS,
      tandem: tandem,
      phetioDocumentation: 'displays the vertex of the interactive quadratic'
    };

    // position coordinates on the outside of the parabola
    options.layoutCoordinates = (coordinatesNode, pointNode) => {
      coordinatesNode.centerX = pointNode.centerX;
      if (quadraticProperty.value.a > 0) {
        // center coordinates below a parabola that opens down
        coordinatesNode.top = pointNode.bottom + COORDINATES_Y_SPACING;
      } else {
        // center coordinates above a parabola that opens up
        coordinatesNode.bottom = pointNode.top - COORDINATES_Y_SPACING;
      }
    };

    // coordinates correspond to the quadratic's vertex (if it has one)
    const coordinatesProperty = new DerivedProperty([quadraticProperty], quadratic => quadratic.vertex ? quadratic.vertex : null, {
      valueType: [Vector2, null],
      tandem: options.tandem.createTandem('coordinatesProperty'),
      phetioDocumentation: 'coordinates displayed on the vertex point, null means no vertex',
      phetioValueType: NullableIO(Vector2.Vector2IO)
    });

    // visibility of this Node
    options.visibleProperty = new DerivedProperty([vertexVisibleProperty, quadraticProperty], (vertexVisible, quadratic) => vertexVisible &&
    // the Vertex checkbox is checked
    quadratic.isaParabola() && quadratic.vertex !== undefined &&
    // the quadratic is a parabola, so has a vertex
    graph.contains(quadratic.vertex),
    // the vertex is on the graph
    {
      tandem: options.tandem.createTandem('visibleProperty'),
      phetioValueType: BooleanIO
    });
    super(coordinatesProperty, coordinatesVisibleProperty, options);

    // move to the vertex position
    quadraticProperty.link(quadratic => {
      if (quadratic.vertex) {
        this.translation = modelViewTransform.modelToViewPosition(quadratic.vertex);
      }
    });
  }
}
graphingQuadratics.register('VertexNode', VertexNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJWZWN0b3IyIiwiQm9vbGVhbklPIiwiTnVsbGFibGVJTyIsIkdRQ29sb3JzIiwiR1FDb25zdGFudHMiLCJncmFwaGluZ1F1YWRyYXRpY3MiLCJQb2ludE5vZGUiLCJDT09SRElOQVRFU19ZX1NQQUNJTkciLCJWZXJ0ZXhOb2RlIiwiY29uc3RydWN0b3IiLCJxdWFkcmF0aWNQcm9wZXJ0eSIsImdyYXBoIiwibW9kZWxWaWV3VHJhbnNmb3JtIiwidmVydGV4VmlzaWJsZVByb3BlcnR5IiwiY29vcmRpbmF0ZXNWaXNpYmxlUHJvcGVydHkiLCJ0YW5kZW0iLCJvcHRpb25zIiwicmFkaXVzIiwibW9kZWxUb1ZpZXdEZWx0YVgiLCJQT0lOVF9SQURJVVMiLCJjb29yZGluYXRlc0ZvcmVncm91bmRDb2xvciIsImNvb3JkaW5hdGVzQmFja2dyb3VuZENvbG9yIiwiVkVSVEVYIiwiY29vcmRpbmF0ZXNEZWNpbWFscyIsIlZFUlRFWF9ERUNJTUFMUyIsInBoZXRpb0RvY3VtZW50YXRpb24iLCJsYXlvdXRDb29yZGluYXRlcyIsImNvb3JkaW5hdGVzTm9kZSIsInBvaW50Tm9kZSIsImNlbnRlclgiLCJ2YWx1ZSIsImEiLCJ0b3AiLCJib3R0b20iLCJjb29yZGluYXRlc1Byb3BlcnR5IiwicXVhZHJhdGljIiwidmVydGV4IiwidmFsdWVUeXBlIiwiY3JlYXRlVGFuZGVtIiwicGhldGlvVmFsdWVUeXBlIiwiVmVjdG9yMklPIiwidmlzaWJsZVByb3BlcnR5IiwidmVydGV4VmlzaWJsZSIsImlzYVBhcmFib2xhIiwidW5kZWZpbmVkIiwiY29udGFpbnMiLCJsaW5rIiwidHJhbnNsYXRpb24iLCJtb2RlbFRvVmlld1Bvc2l0aW9uIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJWZXJ0ZXhOb2RlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERpc3BsYXlzIHRoZSB2ZXJ0ZXggYXMgYSBub24taW50ZXJhY3RpdmUgcG9pbnQgd2l0aCBjb29yZGluYXRlcyBsYWJlbC5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCBHcmFwaCBmcm9tICcuLi8uLi8uLi8uLi9ncmFwaGluZy1saW5lcy9qcy9jb21tb24vbW9kZWwvR3JhcGguanMnO1xyXG5pbXBvcnQgTW9kZWxWaWV3VHJhbnNmb3JtMiBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3ZpZXcvTW9kZWxWaWV3VHJhbnNmb3JtMi5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBCb29sZWFuSU8gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL0Jvb2xlYW5JTy5qcyc7XHJcbmltcG9ydCBOdWxsYWJsZUlPIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy90eXBlcy9OdWxsYWJsZUlPLmpzJztcclxuaW1wb3J0IEdRQ29sb3JzIGZyb20gJy4uLy4uL2NvbW1vbi9HUUNvbG9ycy5qcyc7XHJcbmltcG9ydCBHUUNvbnN0YW50cyBmcm9tICcuLi8uLi9jb21tb24vR1FDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgUXVhZHJhdGljIGZyb20gJy4uLy4uL2NvbW1vbi9tb2RlbC9RdWFkcmF0aWMuanMnO1xyXG5pbXBvcnQgZ3JhcGhpbmdRdWFkcmF0aWNzIGZyb20gJy4uLy4uL2dyYXBoaW5nUXVhZHJhdGljcy5qcyc7XHJcbmltcG9ydCBQb2ludE5vZGUsIHsgUG9pbnROb2RlT3B0aW9ucyB9IGZyb20gJy4vUG9pbnROb2RlLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBDT09SRElOQVRFU19ZX1NQQUNJTkcgPSA1O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmVydGV4Tm9kZSBleHRlbmRzIFBvaW50Tm9kZSB7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcXVhZHJhdGljUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFF1YWRyYXRpYz4sIGdyYXBoOiBHcmFwaCxcclxuICAgICAgICAgICAgICAgICAgICAgIG1vZGVsVmlld1RyYW5zZm9ybTogTW9kZWxWaWV3VHJhbnNmb3JtMixcclxuICAgICAgICAgICAgICAgICAgICAgIHZlcnRleFZpc2libGVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlc1Zpc2libGVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICB0YW5kZW06IFRhbmRlbSApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zOiBQb2ludE5vZGVPcHRpb25zID0ge1xyXG5cclxuICAgICAgLy8gUG9pbnROb2RlIG9wdGlvbnNcclxuICAgICAgcmFkaXVzOiBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdEZWx0YVgoIEdRQ29uc3RhbnRzLlBPSU5UX1JBRElVUyApLFxyXG4gICAgICBjb29yZGluYXRlc0ZvcmVncm91bmRDb2xvcjogJ3doaXRlJyxcclxuICAgICAgY29vcmRpbmF0ZXNCYWNrZ3JvdW5kQ29sb3I6IEdRQ29sb3JzLlZFUlRFWCxcclxuICAgICAgY29vcmRpbmF0ZXNEZWNpbWFsczogR1FDb25zdGFudHMuVkVSVEVYX0RFQ0lNQUxTLFxyXG4gICAgICB0YW5kZW06IHRhbmRlbSxcclxuICAgICAgcGhldGlvRG9jdW1lbnRhdGlvbjogJ2Rpc3BsYXlzIHRoZSB2ZXJ0ZXggb2YgdGhlIGludGVyYWN0aXZlIHF1YWRyYXRpYydcclxuICAgIH07XHJcblxyXG4gICAgLy8gcG9zaXRpb24gY29vcmRpbmF0ZXMgb24gdGhlIG91dHNpZGUgb2YgdGhlIHBhcmFib2xhXHJcbiAgICBvcHRpb25zLmxheW91dENvb3JkaW5hdGVzID0gKCBjb29yZGluYXRlc05vZGUsIHBvaW50Tm9kZSApID0+IHtcclxuICAgICAgY29vcmRpbmF0ZXNOb2RlLmNlbnRlclggPSBwb2ludE5vZGUuY2VudGVyWDtcclxuICAgICAgaWYgKCBxdWFkcmF0aWNQcm9wZXJ0eS52YWx1ZS5hID4gMCApIHtcclxuICAgICAgICAvLyBjZW50ZXIgY29vcmRpbmF0ZXMgYmVsb3cgYSBwYXJhYm9sYSB0aGF0IG9wZW5zIGRvd25cclxuICAgICAgICBjb29yZGluYXRlc05vZGUudG9wID0gcG9pbnROb2RlLmJvdHRvbSArIENPT1JESU5BVEVTX1lfU1BBQ0lORztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAvLyBjZW50ZXIgY29vcmRpbmF0ZXMgYWJvdmUgYSBwYXJhYm9sYSB0aGF0IG9wZW5zIHVwXHJcbiAgICAgICAgY29vcmRpbmF0ZXNOb2RlLmJvdHRvbSA9IHBvaW50Tm9kZS50b3AgLSBDT09SRElOQVRFU19ZX1NQQUNJTkc7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gY29vcmRpbmF0ZXMgY29ycmVzcG9uZCB0byB0aGUgcXVhZHJhdGljJ3MgdmVydGV4IChpZiBpdCBoYXMgb25lKVxyXG4gICAgY29uc3QgY29vcmRpbmF0ZXNQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgcXVhZHJhdGljUHJvcGVydHkgXSxcclxuICAgICAgcXVhZHJhdGljID0+ICggcXVhZHJhdGljLnZlcnRleCA/IHF1YWRyYXRpYy52ZXJ0ZXggOiBudWxsICksIHtcclxuICAgICAgICB2YWx1ZVR5cGU6IFsgVmVjdG9yMiwgbnVsbCBdLFxyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnY29vcmRpbmF0ZXNQcm9wZXJ0eScgKSxcclxuICAgICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnY29vcmRpbmF0ZXMgZGlzcGxheWVkIG9uIHRoZSB2ZXJ0ZXggcG9pbnQsIG51bGwgbWVhbnMgbm8gdmVydGV4JyxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bGxhYmxlSU8oIFZlY3RvcjIuVmVjdG9yMklPIClcclxuICAgICAgfSApO1xyXG5cclxuICAgIC8vIHZpc2liaWxpdHkgb2YgdGhpcyBOb2RlXHJcbiAgICBvcHRpb25zLnZpc2libGVQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdmVydGV4VmlzaWJsZVByb3BlcnR5LCBxdWFkcmF0aWNQcm9wZXJ0eSBdLFxyXG4gICAgICAoIHZlcnRleFZpc2libGUsIHF1YWRyYXRpYyApID0+XHJcbiAgICAgICAgdmVydGV4VmlzaWJsZSAmJiAgLy8gdGhlIFZlcnRleCBjaGVja2JveCBpcyBjaGVja2VkXHJcbiAgICAgICAgcXVhZHJhdGljLmlzYVBhcmFib2xhKCkgJiYgKCBxdWFkcmF0aWMudmVydGV4ICE9PSB1bmRlZmluZWQgKSAmJiAgLy8gdGhlIHF1YWRyYXRpYyBpcyBhIHBhcmFib2xhLCBzbyBoYXMgYSB2ZXJ0ZXhcclxuICAgICAgICBncmFwaC5jb250YWlucyggcXVhZHJhdGljLnZlcnRleCApLCAvLyB0aGUgdmVydGV4IGlzIG9uIHRoZSBncmFwaFxyXG4gICAgICB7XHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICd2aXNpYmxlUHJvcGVydHknICksXHJcbiAgICAgICAgcGhldGlvVmFsdWVUeXBlOiBCb29sZWFuSU9cclxuICAgICAgfSApO1xyXG5cclxuICAgIHN1cGVyKCBjb29yZGluYXRlc1Byb3BlcnR5LCBjb29yZGluYXRlc1Zpc2libGVQcm9wZXJ0eSwgb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIG1vdmUgdG8gdGhlIHZlcnRleCBwb3NpdGlvblxyXG4gICAgcXVhZHJhdGljUHJvcGVydHkubGluayggcXVhZHJhdGljID0+IHtcclxuICAgICAgaWYgKCBxdWFkcmF0aWMudmVydGV4ICkge1xyXG4gICAgICAgIHRoaXMudHJhbnNsYXRpb24gPSBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdQb3NpdGlvbiggcXVhZHJhdGljLnZlcnRleCApO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG5ncmFwaGluZ1F1YWRyYXRpY3MucmVnaXN0ZXIoICdWZXJ0ZXhOb2RlJywgVmVydGV4Tm9kZSApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBRXBFLE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFJbkQsT0FBT0MsU0FBUyxNQUFNLDBDQUEwQztBQUNoRSxPQUFPQyxVQUFVLE1BQU0sMkNBQTJDO0FBQ2xFLE9BQU9DLFFBQVEsTUFBTSwwQkFBMEI7QUFDL0MsT0FBT0MsV0FBVyxNQUFNLDZCQUE2QjtBQUVyRCxPQUFPQyxrQkFBa0IsTUFBTSw2QkFBNkI7QUFDNUQsT0FBT0MsU0FBUyxNQUE0QixnQkFBZ0I7O0FBRTVEO0FBQ0EsTUFBTUMscUJBQXFCLEdBQUcsQ0FBQztBQUUvQixlQUFlLE1BQU1DLFVBQVUsU0FBU0YsU0FBUyxDQUFDO0VBRXpDRyxXQUFXQSxDQUFFQyxpQkFBK0MsRUFBRUMsS0FBWSxFQUM3REMsa0JBQXVDLEVBQ3ZDQyxxQkFBaUQsRUFDakRDLDBCQUFzRCxFQUN0REMsTUFBYyxFQUFHO0lBRW5DLE1BQU1DLE9BQXlCLEdBQUc7TUFFaEM7TUFDQUMsTUFBTSxFQUFFTCxrQkFBa0IsQ0FBQ00saUJBQWlCLENBQUVkLFdBQVcsQ0FBQ2UsWUFBYSxDQUFDO01BQ3hFQywwQkFBMEIsRUFBRSxPQUFPO01BQ25DQywwQkFBMEIsRUFBRWxCLFFBQVEsQ0FBQ21CLE1BQU07TUFDM0NDLG1CQUFtQixFQUFFbkIsV0FBVyxDQUFDb0IsZUFBZTtNQUNoRFQsTUFBTSxFQUFFQSxNQUFNO01BQ2RVLG1CQUFtQixFQUFFO0lBQ3ZCLENBQUM7O0lBRUQ7SUFDQVQsT0FBTyxDQUFDVSxpQkFBaUIsR0FBRyxDQUFFQyxlQUFlLEVBQUVDLFNBQVMsS0FBTTtNQUM1REQsZUFBZSxDQUFDRSxPQUFPLEdBQUdELFNBQVMsQ0FBQ0MsT0FBTztNQUMzQyxJQUFLbkIsaUJBQWlCLENBQUNvQixLQUFLLENBQUNDLENBQUMsR0FBRyxDQUFDLEVBQUc7UUFDbkM7UUFDQUosZUFBZSxDQUFDSyxHQUFHLEdBQUdKLFNBQVMsQ0FBQ0ssTUFBTSxHQUFHMUIscUJBQXFCO01BQ2hFLENBQUMsTUFDSTtRQUNIO1FBQ0FvQixlQUFlLENBQUNNLE1BQU0sR0FBR0wsU0FBUyxDQUFDSSxHQUFHLEdBQUd6QixxQkFBcUI7TUFDaEU7SUFDRixDQUFDOztJQUVEO0lBQ0EsTUFBTTJCLG1CQUFtQixHQUFHLElBQUluQyxlQUFlLENBQUUsQ0FBRVcsaUJBQWlCLENBQUUsRUFDcEV5QixTQUFTLElBQU1BLFNBQVMsQ0FBQ0MsTUFBTSxHQUFHRCxTQUFTLENBQUNDLE1BQU0sR0FBRyxJQUFNLEVBQUU7TUFDM0RDLFNBQVMsRUFBRSxDQUFFckMsT0FBTyxFQUFFLElBQUksQ0FBRTtNQUM1QmUsTUFBTSxFQUFFQyxPQUFPLENBQUNELE1BQU0sQ0FBQ3VCLFlBQVksQ0FBRSxxQkFBc0IsQ0FBQztNQUM1RGIsbUJBQW1CLEVBQUUsaUVBQWlFO01BQ3RGYyxlQUFlLEVBQUVyQyxVQUFVLENBQUVGLE9BQU8sQ0FBQ3dDLFNBQVU7SUFDakQsQ0FBRSxDQUFDOztJQUVMO0lBQ0F4QixPQUFPLENBQUN5QixlQUFlLEdBQUcsSUFBSTFDLGVBQWUsQ0FDM0MsQ0FBRWMscUJBQXFCLEVBQUVILGlCQUFpQixDQUFFLEVBQzVDLENBQUVnQyxhQUFhLEVBQUVQLFNBQVMsS0FDeEJPLGFBQWE7SUFBSztJQUNsQlAsU0FBUyxDQUFDUSxXQUFXLENBQUMsQ0FBQyxJQUFNUixTQUFTLENBQUNDLE1BQU0sS0FBS1EsU0FBVztJQUFLO0lBQ2xFakMsS0FBSyxDQUFDa0MsUUFBUSxDQUFFVixTQUFTLENBQUNDLE1BQU8sQ0FBQztJQUFFO0lBQ3RDO01BQ0VyQixNQUFNLEVBQUVDLE9BQU8sQ0FBQ0QsTUFBTSxDQUFDdUIsWUFBWSxDQUFFLGlCQUFrQixDQUFDO01BQ3hEQyxlQUFlLEVBQUV0QztJQUNuQixDQUFFLENBQUM7SUFFTCxLQUFLLENBQUVpQyxtQkFBbUIsRUFBRXBCLDBCQUEwQixFQUFFRSxPQUFRLENBQUM7O0lBRWpFO0lBQ0FOLGlCQUFpQixDQUFDb0MsSUFBSSxDQUFFWCxTQUFTLElBQUk7TUFDbkMsSUFBS0EsU0FBUyxDQUFDQyxNQUFNLEVBQUc7UUFDdEIsSUFBSSxDQUFDVyxXQUFXLEdBQUduQyxrQkFBa0IsQ0FBQ29DLG1CQUFtQixDQUFFYixTQUFTLENBQUNDLE1BQU8sQ0FBQztNQUMvRTtJQUNGLENBQUUsQ0FBQztFQUNMO0FBQ0Y7QUFFQS9CLGtCQUFrQixDQUFDNEMsUUFBUSxDQUFFLFlBQVksRUFBRXpDLFVBQVcsQ0FBQyJ9