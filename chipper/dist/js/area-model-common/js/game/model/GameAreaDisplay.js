// Copyright 2017-2021, University of Colorado Boulder

/**
 * A model for a displayed area.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import DynamicProperty from '../../../../axon/js/DynamicProperty.js';
import Property from '../../../../axon/js/Property.js';
import areaModelCommon from '../../areaModelCommon.js';
import OrientationPair from '../../common/model/OrientationPair.js';
import GenericAreaDisplay from '../../generic/model/GenericAreaDisplay.js';
import AreaChallenge from './AreaChallenge.js';
import AreaChallengeDescription from './AreaChallengeDescription.js';
import Entry from './Entry.js';
import EntryType from './EntryType.js';
class GameAreaDisplay extends GenericAreaDisplay {
  /**
   * @param {Property.<AreaChallenge|null>} areaChallengeProperty
   */
  constructor(areaChallengeProperty) {
    // This placeholder will never be seen in the user interface, it is to help make sure areaChallengeProperty is never
    // null, see below.
    const placeholderChallenge = new AreaChallenge(AreaChallengeDescription.LEVEL_1_NUMBERS_1);
    const placeholderChallengeProperty = new Property(placeholderChallenge);
    super(new DerivedProperty([placeholderChallengeProperty], _.property('area')));

    // @public {Property.<AreaChallenge>} - Always has an AreaChallenge, unlike the passed-in nullable variety. This is
    // because we want to show the view of the last challenge as we animate back to the level-selection screen.
    this.areaChallengeProperty = placeholderChallengeProperty;
    areaChallengeProperty.link(areaChallenge => {
      if (areaChallenge) {
        this.areaChallengeProperty.value = areaChallenge;
      }
    });

    // @public {OrientationPair.<Property.<TermList|null>>} - Values for dimension line label and product box, null is
    // hidden.
    // NOTE: Overridden from the AreaDisplay version.
    this.totalProperties = OrientationPair.create(orientation => new DynamicProperty(this.areaChallengeProperty, {
      derive: areaChallenge => areaChallenge.totalProperties.get(orientation)
    }));

    // @public {OrientationPair.<Property.<Array.<Entry>>>}
    // Partition sizes. Inner values may be changed by the view client.

    this.partitionSizeEntriesProperties = OrientationPair.create(orientation => new DerivedProperty([this.areaChallengeProperty], areaChallenge => {
      // If there's only one value on a side (and it's a given), there is no use showing a size here.
      if (areaChallenge.partitionSizeEntries.get(orientation).length === 1 && areaChallenge.description.partitionTypes.get(orientation)[0] === EntryType.GIVEN) {
        return [new Entry(null)];
      } else {
        return areaChallenge.partitionSizeEntries.get(orientation);
      }
    }));

    // @public {Property.<Array.<Array.<Entry>>} - Reference to a 2D array for the grid of partial products.
    // First index is vertical (for the row), second is horizontal (for the column)
    this.partialProductEntriesProperty = new DerivedProperty([this.areaChallengeProperty], _.property('partialProductSizeEntries'));

    // @public {Property.<Array.<Entry>>} - Reference to an array of editable properties for the total area.
    // Uses just one for an editable "constant" value, and multiple properties for polynomial entry (one per term).
    this.totalEntriesProperty = new DerivedProperty([this.areaChallengeProperty], _.property('totalCoefficientEntries'));

    // @public {Property.<Polynomial|null>} - The "total area" property reference
    this.totalProperty = new DynamicProperty(this.areaChallengeProperty, {
      derive: 'totalProperty'
    });
  }
}
areaModelCommon.register('GameAreaDisplay', GameAreaDisplay);
export default GameAreaDisplay;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJEeW5hbWljUHJvcGVydHkiLCJQcm9wZXJ0eSIsImFyZWFNb2RlbENvbW1vbiIsIk9yaWVudGF0aW9uUGFpciIsIkdlbmVyaWNBcmVhRGlzcGxheSIsIkFyZWFDaGFsbGVuZ2UiLCJBcmVhQ2hhbGxlbmdlRGVzY3JpcHRpb24iLCJFbnRyeSIsIkVudHJ5VHlwZSIsIkdhbWVBcmVhRGlzcGxheSIsImNvbnN0cnVjdG9yIiwiYXJlYUNoYWxsZW5nZVByb3BlcnR5IiwicGxhY2Vob2xkZXJDaGFsbGVuZ2UiLCJMRVZFTF8xX05VTUJFUlNfMSIsInBsYWNlaG9sZGVyQ2hhbGxlbmdlUHJvcGVydHkiLCJfIiwicHJvcGVydHkiLCJsaW5rIiwiYXJlYUNoYWxsZW5nZSIsInZhbHVlIiwidG90YWxQcm9wZXJ0aWVzIiwiY3JlYXRlIiwib3JpZW50YXRpb24iLCJkZXJpdmUiLCJnZXQiLCJwYXJ0aXRpb25TaXplRW50cmllc1Byb3BlcnRpZXMiLCJwYXJ0aXRpb25TaXplRW50cmllcyIsImxlbmd0aCIsImRlc2NyaXB0aW9uIiwicGFydGl0aW9uVHlwZXMiLCJHSVZFTiIsInBhcnRpYWxQcm9kdWN0RW50cmllc1Byb3BlcnR5IiwidG90YWxFbnRyaWVzUHJvcGVydHkiLCJ0b3RhbFByb3BlcnR5IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJHYW1lQXJlYURpc3BsYXkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTctMjAyMSwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQSBtb2RlbCBmb3IgYSBkaXNwbGF5ZWQgYXJlYS5cclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRHluYW1pY1Byb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRHluYW1pY1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgYXJlYU1vZGVsQ29tbW9uIGZyb20gJy4uLy4uL2FyZWFNb2RlbENvbW1vbi5qcyc7XHJcbmltcG9ydCBPcmllbnRhdGlvblBhaXIgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL09yaWVudGF0aW9uUGFpci5qcyc7XHJcbmltcG9ydCBHZW5lcmljQXJlYURpc3BsYXkgZnJvbSAnLi4vLi4vZ2VuZXJpYy9tb2RlbC9HZW5lcmljQXJlYURpc3BsYXkuanMnO1xyXG5pbXBvcnQgQXJlYUNoYWxsZW5nZSBmcm9tICcuL0FyZWFDaGFsbGVuZ2UuanMnO1xyXG5pbXBvcnQgQXJlYUNoYWxsZW5nZURlc2NyaXB0aW9uIGZyb20gJy4vQXJlYUNoYWxsZW5nZURlc2NyaXB0aW9uLmpzJztcclxuaW1wb3J0IEVudHJ5IGZyb20gJy4vRW50cnkuanMnO1xyXG5pbXBvcnQgRW50cnlUeXBlIGZyb20gJy4vRW50cnlUeXBlLmpzJztcclxuXHJcbmNsYXNzIEdhbWVBcmVhRGlzcGxheSBleHRlbmRzIEdlbmVyaWNBcmVhRGlzcGxheSB7XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48QXJlYUNoYWxsZW5nZXxudWxsPn0gYXJlYUNoYWxsZW5nZVByb3BlcnR5XHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIGFyZWFDaGFsbGVuZ2VQcm9wZXJ0eSApIHtcclxuXHJcbiAgICAvLyBUaGlzIHBsYWNlaG9sZGVyIHdpbGwgbmV2ZXIgYmUgc2VlbiBpbiB0aGUgdXNlciBpbnRlcmZhY2UsIGl0IGlzIHRvIGhlbHAgbWFrZSBzdXJlIGFyZWFDaGFsbGVuZ2VQcm9wZXJ0eSBpcyBuZXZlclxyXG4gICAgLy8gbnVsbCwgc2VlIGJlbG93LlxyXG4gICAgY29uc3QgcGxhY2Vob2xkZXJDaGFsbGVuZ2UgPSBuZXcgQXJlYUNoYWxsZW5nZSggQXJlYUNoYWxsZW5nZURlc2NyaXB0aW9uLkxFVkVMXzFfTlVNQkVSU18xICk7XHJcblxyXG4gICAgY29uc3QgcGxhY2Vob2xkZXJDaGFsbGVuZ2VQcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eSggcGxhY2Vob2xkZXJDaGFsbGVuZ2UgKTtcclxuXHJcbiAgICBzdXBlciggbmV3IERlcml2ZWRQcm9wZXJ0eSggWyBwbGFjZWhvbGRlckNoYWxsZW5nZVByb3BlcnR5IF0sIF8ucHJvcGVydHkoICdhcmVhJyApICkgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtQcm9wZXJ0eS48QXJlYUNoYWxsZW5nZT59IC0gQWx3YXlzIGhhcyBhbiBBcmVhQ2hhbGxlbmdlLCB1bmxpa2UgdGhlIHBhc3NlZC1pbiBudWxsYWJsZSB2YXJpZXR5LiBUaGlzIGlzXHJcbiAgICAvLyBiZWNhdXNlIHdlIHdhbnQgdG8gc2hvdyB0aGUgdmlldyBvZiB0aGUgbGFzdCBjaGFsbGVuZ2UgYXMgd2UgYW5pbWF0ZSBiYWNrIHRvIHRoZSBsZXZlbC1zZWxlY3Rpb24gc2NyZWVuLlxyXG4gICAgdGhpcy5hcmVhQ2hhbGxlbmdlUHJvcGVydHkgPSBwbGFjZWhvbGRlckNoYWxsZW5nZVByb3BlcnR5O1xyXG4gICAgYXJlYUNoYWxsZW5nZVByb3BlcnR5LmxpbmsoIGFyZWFDaGFsbGVuZ2UgPT4ge1xyXG4gICAgICBpZiAoIGFyZWFDaGFsbGVuZ2UgKSB7XHJcbiAgICAgICAgdGhpcy5hcmVhQ2hhbGxlbmdlUHJvcGVydHkudmFsdWUgPSBhcmVhQ2hhbGxlbmdlO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyB7T3JpZW50YXRpb25QYWlyLjxQcm9wZXJ0eS48VGVybUxpc3R8bnVsbD4+fSAtIFZhbHVlcyBmb3IgZGltZW5zaW9uIGxpbmUgbGFiZWwgYW5kIHByb2R1Y3QgYm94LCBudWxsIGlzXHJcbiAgICAvLyBoaWRkZW4uXHJcbiAgICAvLyBOT1RFOiBPdmVycmlkZGVuIGZyb20gdGhlIEFyZWFEaXNwbGF5IHZlcnNpb24uXHJcbiAgICB0aGlzLnRvdGFsUHJvcGVydGllcyA9IE9yaWVudGF0aW9uUGFpci5jcmVhdGUoIG9yaWVudGF0aW9uID0+IG5ldyBEeW5hbWljUHJvcGVydHkoIHRoaXMuYXJlYUNoYWxsZW5nZVByb3BlcnR5LCB7XHJcbiAgICAgIGRlcml2ZTogYXJlYUNoYWxsZW5nZSA9PiBhcmVhQ2hhbGxlbmdlLnRvdGFsUHJvcGVydGllcy5nZXQoIG9yaWVudGF0aW9uIClcclxuICAgIH0gKSApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMge09yaWVudGF0aW9uUGFpci48UHJvcGVydHkuPEFycmF5LjxFbnRyeT4+Pn1cclxuICAgIC8vIFBhcnRpdGlvbiBzaXplcy4gSW5uZXIgdmFsdWVzIG1heSBiZSBjaGFuZ2VkIGJ5IHRoZSB2aWV3IGNsaWVudC5cclxuXHJcbiAgICB0aGlzLnBhcnRpdGlvblNpemVFbnRyaWVzUHJvcGVydGllcyA9IE9yaWVudGF0aW9uUGFpci5jcmVhdGUoIG9yaWVudGF0aW9uID0+IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgdGhpcy5hcmVhQ2hhbGxlbmdlUHJvcGVydHkgXSwgYXJlYUNoYWxsZW5nZSA9PiB7XHJcbiAgICAgIC8vIElmIHRoZXJlJ3Mgb25seSBvbmUgdmFsdWUgb24gYSBzaWRlIChhbmQgaXQncyBhIGdpdmVuKSwgdGhlcmUgaXMgbm8gdXNlIHNob3dpbmcgYSBzaXplIGhlcmUuXHJcbiAgICAgIGlmICggYXJlYUNoYWxsZW5nZS5wYXJ0aXRpb25TaXplRW50cmllcy5nZXQoIG9yaWVudGF0aW9uICkubGVuZ3RoID09PSAxICYmXHJcbiAgICAgICAgICAgYXJlYUNoYWxsZW5nZS5kZXNjcmlwdGlvbi5wYXJ0aXRpb25UeXBlcy5nZXQoIG9yaWVudGF0aW9uIClbIDAgXSA9PT0gRW50cnlUeXBlLkdJVkVOICkge1xyXG4gICAgICAgIHJldHVybiBbIG5ldyBFbnRyeSggbnVsbCApIF07XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZWFDaGFsbGVuZ2UucGFydGl0aW9uU2l6ZUVudHJpZXMuZ2V0KCBvcmllbnRhdGlvbiApO1xyXG4gICAgICB9XHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtQcm9wZXJ0eS48QXJyYXkuPEFycmF5LjxFbnRyeT4+fSAtIFJlZmVyZW5jZSB0byBhIDJEIGFycmF5IGZvciB0aGUgZ3JpZCBvZiBwYXJ0aWFsIHByb2R1Y3RzLlxyXG4gICAgLy8gRmlyc3QgaW5kZXggaXMgdmVydGljYWwgKGZvciB0aGUgcm93KSwgc2Vjb25kIGlzIGhvcml6b250YWwgKGZvciB0aGUgY29sdW1uKVxyXG4gICAgdGhpcy5wYXJ0aWFsUHJvZHVjdEVudHJpZXNQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgdGhpcy5hcmVhQ2hhbGxlbmdlUHJvcGVydHkgXSwgXy5wcm9wZXJ0eSggJ3BhcnRpYWxQcm9kdWN0U2l6ZUVudHJpZXMnICkgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtQcm9wZXJ0eS48QXJyYXkuPEVudHJ5Pj59IC0gUmVmZXJlbmNlIHRvIGFuIGFycmF5IG9mIGVkaXRhYmxlIHByb3BlcnRpZXMgZm9yIHRoZSB0b3RhbCBhcmVhLlxyXG4gICAgLy8gVXNlcyBqdXN0IG9uZSBmb3IgYW4gZWRpdGFibGUgXCJjb25zdGFudFwiIHZhbHVlLCBhbmQgbXVsdGlwbGUgcHJvcGVydGllcyBmb3IgcG9seW5vbWlhbCBlbnRyeSAob25lIHBlciB0ZXJtKS5cclxuICAgIHRoaXMudG90YWxFbnRyaWVzUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHRoaXMuYXJlYUNoYWxsZW5nZVByb3BlcnR5IF0sIF8ucHJvcGVydHkoICd0b3RhbENvZWZmaWNpZW50RW50cmllcycgKSApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMge1Byb3BlcnR5LjxQb2x5bm9taWFsfG51bGw+fSAtIFRoZSBcInRvdGFsIGFyZWFcIiBwcm9wZXJ0eSByZWZlcmVuY2VcclxuICAgIHRoaXMudG90YWxQcm9wZXJ0eSA9IG5ldyBEeW5hbWljUHJvcGVydHkoIHRoaXMuYXJlYUNoYWxsZW5nZVByb3BlcnR5LCB7XHJcbiAgICAgIGRlcml2ZTogJ3RvdGFsUHJvcGVydHknXHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG5hcmVhTW9kZWxDb21tb24ucmVnaXN0ZXIoICdHYW1lQXJlYURpc3BsYXknLCBHYW1lQXJlYURpc3BsYXkgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEdhbWVBcmVhRGlzcGxheTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLFFBQVEsTUFBTSxpQ0FBaUM7QUFDdEQsT0FBT0MsZUFBZSxNQUFNLDBCQUEwQjtBQUN0RCxPQUFPQyxlQUFlLE1BQU0sdUNBQXVDO0FBQ25FLE9BQU9DLGtCQUFrQixNQUFNLDJDQUEyQztBQUMxRSxPQUFPQyxhQUFhLE1BQU0sb0JBQW9CO0FBQzlDLE9BQU9DLHdCQUF3QixNQUFNLCtCQUErQjtBQUNwRSxPQUFPQyxLQUFLLE1BQU0sWUFBWTtBQUM5QixPQUFPQyxTQUFTLE1BQU0sZ0JBQWdCO0FBRXRDLE1BQU1DLGVBQWUsU0FBU0wsa0JBQWtCLENBQUM7RUFDL0M7QUFDRjtBQUNBO0VBQ0VNLFdBQVdBLENBQUVDLHFCQUFxQixFQUFHO0lBRW5DO0lBQ0E7SUFDQSxNQUFNQyxvQkFBb0IsR0FBRyxJQUFJUCxhQUFhLENBQUVDLHdCQUF3QixDQUFDTyxpQkFBa0IsQ0FBQztJQUU1RixNQUFNQyw0QkFBNEIsR0FBRyxJQUFJYixRQUFRLENBQUVXLG9CQUFxQixDQUFDO0lBRXpFLEtBQUssQ0FBRSxJQUFJYixlQUFlLENBQUUsQ0FBRWUsNEJBQTRCLENBQUUsRUFBRUMsQ0FBQyxDQUFDQyxRQUFRLENBQUUsTUFBTyxDQUFFLENBQUUsQ0FBQzs7SUFFdEY7SUFDQTtJQUNBLElBQUksQ0FBQ0wscUJBQXFCLEdBQUdHLDRCQUE0QjtJQUN6REgscUJBQXFCLENBQUNNLElBQUksQ0FBRUMsYUFBYSxJQUFJO01BQzNDLElBQUtBLGFBQWEsRUFBRztRQUNuQixJQUFJLENBQUNQLHFCQUFxQixDQUFDUSxLQUFLLEdBQUdELGFBQWE7TUFDbEQ7SUFDRixDQUFFLENBQUM7O0lBRUg7SUFDQTtJQUNBO0lBQ0EsSUFBSSxDQUFDRSxlQUFlLEdBQUdqQixlQUFlLENBQUNrQixNQUFNLENBQUVDLFdBQVcsSUFBSSxJQUFJdEIsZUFBZSxDQUFFLElBQUksQ0FBQ1cscUJBQXFCLEVBQUU7TUFDN0dZLE1BQU0sRUFBRUwsYUFBYSxJQUFJQSxhQUFhLENBQUNFLGVBQWUsQ0FBQ0ksR0FBRyxDQUFFRixXQUFZO0lBQzFFLENBQUUsQ0FBRSxDQUFDOztJQUVMO0lBQ0E7O0lBRUEsSUFBSSxDQUFDRyw4QkFBOEIsR0FBR3RCLGVBQWUsQ0FBQ2tCLE1BQU0sQ0FBRUMsV0FBVyxJQUFJLElBQUl2QixlQUFlLENBQUUsQ0FBRSxJQUFJLENBQUNZLHFCQUFxQixDQUFFLEVBQUVPLGFBQWEsSUFBSTtNQUNqSjtNQUNBLElBQUtBLGFBQWEsQ0FBQ1Esb0JBQW9CLENBQUNGLEdBQUcsQ0FBRUYsV0FBWSxDQUFDLENBQUNLLE1BQU0sS0FBSyxDQUFDLElBQ2xFVCxhQUFhLENBQUNVLFdBQVcsQ0FBQ0MsY0FBYyxDQUFDTCxHQUFHLENBQUVGLFdBQVksQ0FBQyxDQUFFLENBQUMsQ0FBRSxLQUFLZCxTQUFTLENBQUNzQixLQUFLLEVBQUc7UUFDMUYsT0FBTyxDQUFFLElBQUl2QixLQUFLLENBQUUsSUFBSyxDQUFDLENBQUU7TUFDOUIsQ0FBQyxNQUNJO1FBQ0gsT0FBT1csYUFBYSxDQUFDUSxvQkFBb0IsQ0FBQ0YsR0FBRyxDQUFFRixXQUFZLENBQUM7TUFDOUQ7SUFDRixDQUFFLENBQUUsQ0FBQzs7SUFFTDtJQUNBO0lBQ0EsSUFBSSxDQUFDUyw2QkFBNkIsR0FBRyxJQUFJaEMsZUFBZSxDQUFFLENBQUUsSUFBSSxDQUFDWSxxQkFBcUIsQ0FBRSxFQUFFSSxDQUFDLENBQUNDLFFBQVEsQ0FBRSwyQkFBNEIsQ0FBRSxDQUFDOztJQUVySTtJQUNBO0lBQ0EsSUFBSSxDQUFDZ0Isb0JBQW9CLEdBQUcsSUFBSWpDLGVBQWUsQ0FBRSxDQUFFLElBQUksQ0FBQ1kscUJBQXFCLENBQUUsRUFBRUksQ0FBQyxDQUFDQyxRQUFRLENBQUUseUJBQTBCLENBQUUsQ0FBQzs7SUFFMUg7SUFDQSxJQUFJLENBQUNpQixhQUFhLEdBQUcsSUFBSWpDLGVBQWUsQ0FBRSxJQUFJLENBQUNXLHFCQUFxQixFQUFFO01BQ3BFWSxNQUFNLEVBQUU7SUFDVixDQUFFLENBQUM7RUFDTDtBQUNGO0FBRUFyQixlQUFlLENBQUNnQyxRQUFRLENBQUUsaUJBQWlCLEVBQUV6QixlQUFnQixDQUFDO0FBRTlELGVBQWVBLGVBQWUifQ==