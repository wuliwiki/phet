// Copyright 2017-2022, University of Colorado Boulder

/**
 * An edit button and readout for the associated term.
 *
 * NOTE: This type is designed to be persistent, and will not need to release references to avoid memory leaks.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import DynamicProperty from '../../../../axon/js/DynamicProperty.js';
import Property from '../../../../axon/js/Property.js';
import Range from '../../../../dot/js/Range.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import { Node, Rectangle, RichText, Text, VBox } from '../../../../scenery/js/imports.js';
import NumberPicker from '../../../../sun/js/NumberPicker.js';
import areaModelCommon from '../../areaModelCommon.js';
import AreaModelCommonConstants from '../../common/AreaModelCommonConstants.js';
import Polynomial from '../../common/model/Polynomial.js';
import Term from '../../common/model/Term.js';
import AreaModelCommonColors from '../../common/view/AreaModelCommonColors.js';
import Entry from '../model/Entry.js';
import EntryStatus from '../model/EntryStatus.js';
import InputMethod from '../model/InputMethod.js';
class PolynomialEditNode extends VBox {
  /**
   * @param {Property.<Polynomial|null>} polynomialProperty
   * @param {Property.<Array.<Entry>>} totalEntriesProperty
   * @param {function} editedCallback - Called with no arguments when something is edited
   */
  constructor(polynomialProperty, totalEntriesProperty, editedCallback) {
    const longestString = new Polynomial([new Term(-9, 2), new Term(-9, 1), new Term(-9, 0)]).toRichString();
    const readoutText = new RichText(longestString, {
      font: AreaModelCommonConstants.POLYNOMIAL_EDIT_READOUT_FONT
    });
    const readoutBackgroundRectangle = Rectangle.bounds(readoutText.bounds.dilatedXY(30, 5), {
      cornerRadius: 3,
      stroke: 'black',
      fill: 'white'
    });
    readoutText.centerY = readoutBackgroundRectangle.centerY; // Don't reposition vertically with exponents
    polynomialProperty.link(polynomial => {
      readoutText.string = polynomial === null ? '0' : polynomial.toRichString();
      readoutText.centerX = readoutBackgroundRectangle.centerX;
    });
    const readout = new Node({
      children: [readoutBackgroundRectangle, readoutText]
    });
    const editFont = AreaModelCommonConstants.GAME_POLYNOMIAL_EDIT_FONT;

    // {Property.<Entry>}
    const constantEntryProperty = new DerivedProperty([totalEntriesProperty], totalEntries => totalEntries.length > 1 ? totalEntries[0] : new Entry(null));
    const xEntryProperty = new DerivedProperty([totalEntriesProperty], totalEntries => totalEntries.length > 1 ? totalEntries[1] : new Entry(null));
    const xSquaredEntryProperty = new DerivedProperty([totalEntriesProperty], totalEntries => totalEntries.length > 2 ? totalEntries[2] : new Entry(null));
    const constantProperty = new DynamicProperty(constantEntryProperty, {
      derive: 'valueProperty',
      map: term => term === null ? 0 : term.coefficient,
      inverseMap: number => new Term(number, 0),
      bidirectional: true
    });
    const xProperty = new DynamicProperty(xEntryProperty, {
      derive: 'valueProperty',
      map: term => term === null ? 0 : term.coefficient,
      inverseMap: number => new Term(number, 1),
      bidirectional: true
    });
    const xSquaredProperty = new DynamicProperty(xSquaredEntryProperty, {
      derive: 'valueProperty',
      map: term => term === null ? 0 : term.coefficient,
      inverseMap: number => new Term(number, 2),
      bidirectional: true
    });

    // When one is changed, we want to make sure that all entries are not marked as dirty internally (so that the user
    // can submit after just changing one value). This is done by providing an actual value to the property.
    function provideEntryValues() {
      [constantEntryProperty, xEntryProperty, xSquaredEntryProperty].forEach((entryProperty, index) => {
        const valueProperty = entryProperty.value.valueProperty;
        if (valueProperty.value === null) {
          valueProperty.value = new Term(0, index);
        }
      });
    }
    function linkProperty(property, entryProperty) {
      property.link(() => {
        // Only flag the values as edited when the user makes a change (not when we set it as part of a challenge)
        if (property.isExternallyChanging) {
          editedCallback();
          provideEntryValues();
          entryProperty.value.statusProperty.value = EntryStatus.NORMAL;
        }
      });
    }
    linkProperty(constantProperty, constantEntryProperty);
    linkProperty(xProperty, xEntryProperty);
    linkProperty(xSquaredProperty, xSquaredEntryProperty);

    // [-81,81] is the actual range we need for editable values,
    // see https://github.com/phetsims/area-model-common/issues/94
    const rangeProperty = new Property(new Range(-81, 81));
    function getPickerColorProperty(entryProperty) {
      return new DerivedProperty([new DynamicProperty(entryProperty, {
        derive: 'statusProperty'
      }), AreaModelCommonColors.errorStatusProperty, AreaModelCommonColors.dirtyStatusProperty], (highlight, errorColor, dirtyColor) => {
        if (highlight === EntryStatus.NORMAL) {
          return 'black';
        } else if (highlight === EntryStatus.DIRTY) {
          return dirtyColor;
        } else {
          return errorColor;
        }
      });
    }
    const constantPicker = new NumberPicker(constantProperty, rangeProperty, {
      color: getPickerColorProperty(constantEntryProperty)
    });
    const xPicker = new NumberPicker(xProperty, rangeProperty, {
      color: getPickerColorProperty(xEntryProperty)
    });
    const xSquaredPicker = new NumberPicker(xSquaredProperty, rangeProperty, {
      color: getPickerColorProperty(xSquaredEntryProperty)
    });
    const xText = new RichText(AreaModelCommonConstants.X_VARIABLE_RICH_STRING, {
      font: editFont
    });
    const xSquaredText = new RichText(`${AreaModelCommonConstants.X_VARIABLE_RICH_STRING}<sup>2</sup>`, {
      font: editFont
    });
    const plus1 = new Text(MathSymbols.PLUS, {
      font: editFont
    });
    const plus2 = new Text(MathSymbols.PLUS, {
      font: editFont
    });
    const xSquaredChildren = [xSquaredPicker, xSquaredText, plus1, xPicker, xText, plus2, constantPicker];
    const xChildren = [xPicker, xText, plus2, constantPicker];
    const pickerContainer = new Node();
    // Hide the x^2 term if we won't use it
    constantEntryProperty.link(constantEntry => {
      pickerContainer.children = constantEntry.inputMethod === InputMethod.POLYNOMIAL_2 ? xSquaredChildren : xChildren;
    });
    xSquaredChildren.forEach((node, index) => {
      if (index > 0) {
        node.left = xSquaredChildren[index - 1].right + 5;
      }
    });
    constantPicker.centerY = xText.centerY;
    xPicker.centerY = xText.centerY;
    xSquaredPicker.centerY = xText.centerY;
    super({
      children: [readout, pickerContainer],
      spacing: 10
    });
  }
}
areaModelCommon.register('PolynomialEditNode', PolynomialEditNode);
export default PolynomialEditNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJEeW5hbWljUHJvcGVydHkiLCJQcm9wZXJ0eSIsIlJhbmdlIiwiTWF0aFN5bWJvbHMiLCJOb2RlIiwiUmVjdGFuZ2xlIiwiUmljaFRleHQiLCJUZXh0IiwiVkJveCIsIk51bWJlclBpY2tlciIsImFyZWFNb2RlbENvbW1vbiIsIkFyZWFNb2RlbENvbW1vbkNvbnN0YW50cyIsIlBvbHlub21pYWwiLCJUZXJtIiwiQXJlYU1vZGVsQ29tbW9uQ29sb3JzIiwiRW50cnkiLCJFbnRyeVN0YXR1cyIsIklucHV0TWV0aG9kIiwiUG9seW5vbWlhbEVkaXROb2RlIiwiY29uc3RydWN0b3IiLCJwb2x5bm9taWFsUHJvcGVydHkiLCJ0b3RhbEVudHJpZXNQcm9wZXJ0eSIsImVkaXRlZENhbGxiYWNrIiwibG9uZ2VzdFN0cmluZyIsInRvUmljaFN0cmluZyIsInJlYWRvdXRUZXh0IiwiZm9udCIsIlBPTFlOT01JQUxfRURJVF9SRUFET1VUX0ZPTlQiLCJyZWFkb3V0QmFja2dyb3VuZFJlY3RhbmdsZSIsImJvdW5kcyIsImRpbGF0ZWRYWSIsImNvcm5lclJhZGl1cyIsInN0cm9rZSIsImZpbGwiLCJjZW50ZXJZIiwibGluayIsInBvbHlub21pYWwiLCJzdHJpbmciLCJjZW50ZXJYIiwicmVhZG91dCIsImNoaWxkcmVuIiwiZWRpdEZvbnQiLCJHQU1FX1BPTFlOT01JQUxfRURJVF9GT05UIiwiY29uc3RhbnRFbnRyeVByb3BlcnR5IiwidG90YWxFbnRyaWVzIiwibGVuZ3RoIiwieEVudHJ5UHJvcGVydHkiLCJ4U3F1YXJlZEVudHJ5UHJvcGVydHkiLCJjb25zdGFudFByb3BlcnR5IiwiZGVyaXZlIiwibWFwIiwidGVybSIsImNvZWZmaWNpZW50IiwiaW52ZXJzZU1hcCIsIm51bWJlciIsImJpZGlyZWN0aW9uYWwiLCJ4UHJvcGVydHkiLCJ4U3F1YXJlZFByb3BlcnR5IiwicHJvdmlkZUVudHJ5VmFsdWVzIiwiZm9yRWFjaCIsImVudHJ5UHJvcGVydHkiLCJpbmRleCIsInZhbHVlUHJvcGVydHkiLCJ2YWx1ZSIsImxpbmtQcm9wZXJ0eSIsInByb3BlcnR5IiwiaXNFeHRlcm5hbGx5Q2hhbmdpbmciLCJzdGF0dXNQcm9wZXJ0eSIsIk5PUk1BTCIsInJhbmdlUHJvcGVydHkiLCJnZXRQaWNrZXJDb2xvclByb3BlcnR5IiwiZXJyb3JTdGF0dXNQcm9wZXJ0eSIsImRpcnR5U3RhdHVzUHJvcGVydHkiLCJoaWdobGlnaHQiLCJlcnJvckNvbG9yIiwiZGlydHlDb2xvciIsIkRJUlRZIiwiY29uc3RhbnRQaWNrZXIiLCJjb2xvciIsInhQaWNrZXIiLCJ4U3F1YXJlZFBpY2tlciIsInhUZXh0IiwiWF9WQVJJQUJMRV9SSUNIX1NUUklORyIsInhTcXVhcmVkVGV4dCIsInBsdXMxIiwiUExVUyIsInBsdXMyIiwieFNxdWFyZWRDaGlsZHJlbiIsInhDaGlsZHJlbiIsInBpY2tlckNvbnRhaW5lciIsImNvbnN0YW50RW50cnkiLCJpbnB1dE1ldGhvZCIsIlBPTFlOT01JQUxfMiIsIm5vZGUiLCJsZWZ0IiwicmlnaHQiLCJzcGFjaW5nIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJQb2x5bm9taWFsRWRpdE5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTctMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQW4gZWRpdCBidXR0b24gYW5kIHJlYWRvdXQgZm9yIHRoZSBhc3NvY2lhdGVkIHRlcm0uXHJcbiAqXHJcbiAqIE5PVEU6IFRoaXMgdHlwZSBpcyBkZXNpZ25lZCB0byBiZSBwZXJzaXN0ZW50LCBhbmQgd2lsbCBub3QgbmVlZCB0byByZWxlYXNlIHJlZmVyZW5jZXMgdG8gYXZvaWQgbWVtb3J5IGxlYWtzLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEeW5hbWljUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EeW5hbWljUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBSYW5nZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2UuanMnO1xyXG5pbXBvcnQgTWF0aFN5bWJvbHMgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL01hdGhTeW1ib2xzLmpzJztcclxuaW1wb3J0IHsgTm9kZSwgUmVjdGFuZ2xlLCBSaWNoVGV4dCwgVGV4dCwgVkJveCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBOdW1iZXJQaWNrZXIgZnJvbSAnLi4vLi4vLi4vLi4vc3VuL2pzL051bWJlclBpY2tlci5qcyc7XHJcbmltcG9ydCBhcmVhTW9kZWxDb21tb24gZnJvbSAnLi4vLi4vYXJlYU1vZGVsQ29tbW9uLmpzJztcclxuaW1wb3J0IEFyZWFNb2RlbENvbW1vbkNvbnN0YW50cyBmcm9tICcuLi8uLi9jb21tb24vQXJlYU1vZGVsQ29tbW9uQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IFBvbHlub21pYWwgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL1BvbHlub21pYWwuanMnO1xyXG5pbXBvcnQgVGVybSBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvVGVybS5qcyc7XHJcbmltcG9ydCBBcmVhTW9kZWxDb21tb25Db2xvcnMgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvQXJlYU1vZGVsQ29tbW9uQ29sb3JzLmpzJztcclxuaW1wb3J0IEVudHJ5IGZyb20gJy4uL21vZGVsL0VudHJ5LmpzJztcclxuaW1wb3J0IEVudHJ5U3RhdHVzIGZyb20gJy4uL21vZGVsL0VudHJ5U3RhdHVzLmpzJztcclxuaW1wb3J0IElucHV0TWV0aG9kIGZyb20gJy4uL21vZGVsL0lucHV0TWV0aG9kLmpzJztcclxuXHJcbmNsYXNzIFBvbHlub21pYWxFZGl0Tm9kZSBleHRlbmRzIFZCb3gge1xyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPFBvbHlub21pYWx8bnVsbD59IHBvbHlub21pYWxQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPEFycmF5LjxFbnRyeT4+fSB0b3RhbEVudHJpZXNQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGVkaXRlZENhbGxiYWNrIC0gQ2FsbGVkIHdpdGggbm8gYXJndW1lbnRzIHdoZW4gc29tZXRoaW5nIGlzIGVkaXRlZFxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBwb2x5bm9taWFsUHJvcGVydHksIHRvdGFsRW50cmllc1Byb3BlcnR5LCBlZGl0ZWRDYWxsYmFjayApIHtcclxuICAgIGNvbnN0IGxvbmdlc3RTdHJpbmcgPSBuZXcgUG9seW5vbWlhbCggW1xyXG4gICAgICBuZXcgVGVybSggLTksIDIgKSxcclxuICAgICAgbmV3IFRlcm0oIC05LCAxICksXHJcbiAgICAgIG5ldyBUZXJtKCAtOSwgMCApXHJcbiAgICBdICkudG9SaWNoU3RyaW5nKCk7XHJcblxyXG4gICAgY29uc3QgcmVhZG91dFRleHQgPSBuZXcgUmljaFRleHQoIGxvbmdlc3RTdHJpbmcsIHtcclxuICAgICAgZm9udDogQXJlYU1vZGVsQ29tbW9uQ29uc3RhbnRzLlBPTFlOT01JQUxfRURJVF9SRUFET1VUX0ZPTlRcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCByZWFkb3V0QmFja2dyb3VuZFJlY3RhbmdsZSA9IFJlY3RhbmdsZS5ib3VuZHMoIHJlYWRvdXRUZXh0LmJvdW5kcy5kaWxhdGVkWFkoIDMwLCA1ICksIHtcclxuICAgICAgY29ybmVyUmFkaXVzOiAzLFxyXG4gICAgICBzdHJva2U6ICdibGFjaycsXHJcbiAgICAgIGZpbGw6ICd3aGl0ZSdcclxuICAgIH0gKTtcclxuICAgIHJlYWRvdXRUZXh0LmNlbnRlclkgPSByZWFkb3V0QmFja2dyb3VuZFJlY3RhbmdsZS5jZW50ZXJZOyAvLyBEb24ndCByZXBvc2l0aW9uIHZlcnRpY2FsbHkgd2l0aCBleHBvbmVudHNcclxuICAgIHBvbHlub21pYWxQcm9wZXJ0eS5saW5rKCBwb2x5bm9taWFsID0+IHtcclxuICAgICAgcmVhZG91dFRleHQuc3RyaW5nID0gcG9seW5vbWlhbCA9PT0gbnVsbCA/ICcwJyA6IHBvbHlub21pYWwudG9SaWNoU3RyaW5nKCk7XHJcbiAgICAgIHJlYWRvdXRUZXh0LmNlbnRlclggPSByZWFkb3V0QmFja2dyb3VuZFJlY3RhbmdsZS5jZW50ZXJYO1xyXG4gICAgfSApO1xyXG4gICAgY29uc3QgcmVhZG91dCA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgcmVhZG91dEJhY2tncm91bmRSZWN0YW5nbGUsXHJcbiAgICAgICAgcmVhZG91dFRleHRcclxuICAgICAgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGVkaXRGb250ID0gQXJlYU1vZGVsQ29tbW9uQ29uc3RhbnRzLkdBTUVfUE9MWU5PTUlBTF9FRElUX0ZPTlQ7XHJcblxyXG4gICAgLy8ge1Byb3BlcnR5LjxFbnRyeT59XHJcbiAgICBjb25zdCBjb25zdGFudEVudHJ5UHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHRvdGFsRW50cmllc1Byb3BlcnR5IF0sIHRvdGFsRW50cmllcyA9PiB0b3RhbEVudHJpZXMubGVuZ3RoID4gMSA/IHRvdGFsRW50cmllc1sgMCBdIDogbmV3IEVudHJ5KCBudWxsICkgKTtcclxuICAgIGNvbnN0IHhFbnRyeVByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyB0b3RhbEVudHJpZXNQcm9wZXJ0eSBdLCB0b3RhbEVudHJpZXMgPT4gdG90YWxFbnRyaWVzLmxlbmd0aCA+IDEgPyB0b3RhbEVudHJpZXNbIDEgXSA6IG5ldyBFbnRyeSggbnVsbCApICk7XHJcbiAgICBjb25zdCB4U3F1YXJlZEVudHJ5UHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHRvdGFsRW50cmllc1Byb3BlcnR5IF0sIHRvdGFsRW50cmllcyA9PiB0b3RhbEVudHJpZXMubGVuZ3RoID4gMiA/IHRvdGFsRW50cmllc1sgMiBdIDogbmV3IEVudHJ5KCBudWxsICkgKTtcclxuXHJcbiAgICBjb25zdCBjb25zdGFudFByb3BlcnR5ID0gbmV3IER5bmFtaWNQcm9wZXJ0eSggY29uc3RhbnRFbnRyeVByb3BlcnR5LCB7XHJcbiAgICAgIGRlcml2ZTogJ3ZhbHVlUHJvcGVydHknLFxyXG4gICAgICBtYXA6IHRlcm0gPT4gdGVybSA9PT0gbnVsbCA/IDAgOiB0ZXJtLmNvZWZmaWNpZW50LFxyXG4gICAgICBpbnZlcnNlTWFwOiBudW1iZXIgPT4gbmV3IFRlcm0oIG51bWJlciwgMCApLFxyXG4gICAgICBiaWRpcmVjdGlvbmFsOiB0cnVlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgeFByb3BlcnR5ID0gbmV3IER5bmFtaWNQcm9wZXJ0eSggeEVudHJ5UHJvcGVydHksIHtcclxuICAgICAgZGVyaXZlOiAndmFsdWVQcm9wZXJ0eScsXHJcbiAgICAgIG1hcDogdGVybSA9PiB0ZXJtID09PSBudWxsID8gMCA6IHRlcm0uY29lZmZpY2llbnQsXHJcbiAgICAgIGludmVyc2VNYXA6IG51bWJlciA9PiBuZXcgVGVybSggbnVtYmVyLCAxICksXHJcbiAgICAgIGJpZGlyZWN0aW9uYWw6IHRydWVcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCB4U3F1YXJlZFByb3BlcnR5ID0gbmV3IER5bmFtaWNQcm9wZXJ0eSggeFNxdWFyZWRFbnRyeVByb3BlcnR5LCB7XHJcbiAgICAgIGRlcml2ZTogJ3ZhbHVlUHJvcGVydHknLFxyXG4gICAgICBtYXA6IHRlcm0gPT4gdGVybSA9PT0gbnVsbCA/IDAgOiB0ZXJtLmNvZWZmaWNpZW50LFxyXG4gICAgICBpbnZlcnNlTWFwOiBudW1iZXIgPT4gbmV3IFRlcm0oIG51bWJlciwgMiApLFxyXG4gICAgICBiaWRpcmVjdGlvbmFsOiB0cnVlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gV2hlbiBvbmUgaXMgY2hhbmdlZCwgd2Ugd2FudCB0byBtYWtlIHN1cmUgdGhhdCBhbGwgZW50cmllcyBhcmUgbm90IG1hcmtlZCBhcyBkaXJ0eSBpbnRlcm5hbGx5IChzbyB0aGF0IHRoZSB1c2VyXHJcbiAgICAvLyBjYW4gc3VibWl0IGFmdGVyIGp1c3QgY2hhbmdpbmcgb25lIHZhbHVlKS4gVGhpcyBpcyBkb25lIGJ5IHByb3ZpZGluZyBhbiBhY3R1YWwgdmFsdWUgdG8gdGhlIHByb3BlcnR5LlxyXG4gICAgZnVuY3Rpb24gcHJvdmlkZUVudHJ5VmFsdWVzKCkge1xyXG4gICAgICBbIGNvbnN0YW50RW50cnlQcm9wZXJ0eSwgeEVudHJ5UHJvcGVydHksIHhTcXVhcmVkRW50cnlQcm9wZXJ0eSBdLmZvckVhY2goICggZW50cnlQcm9wZXJ0eSwgaW5kZXggKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmFsdWVQcm9wZXJ0eSA9IGVudHJ5UHJvcGVydHkudmFsdWUudmFsdWVQcm9wZXJ0eTtcclxuICAgICAgICBpZiAoIHZhbHVlUHJvcGVydHkudmFsdWUgPT09IG51bGwgKSB7XHJcbiAgICAgICAgICB2YWx1ZVByb3BlcnR5LnZhbHVlID0gbmV3IFRlcm0oIDAsIGluZGV4ICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbGlua1Byb3BlcnR5KCBwcm9wZXJ0eSwgZW50cnlQcm9wZXJ0eSApIHtcclxuICAgICAgcHJvcGVydHkubGluayggKCkgPT4ge1xyXG4gICAgICAgIC8vIE9ubHkgZmxhZyB0aGUgdmFsdWVzIGFzIGVkaXRlZCB3aGVuIHRoZSB1c2VyIG1ha2VzIGEgY2hhbmdlIChub3Qgd2hlbiB3ZSBzZXQgaXQgYXMgcGFydCBvZiBhIGNoYWxsZW5nZSlcclxuICAgICAgICBpZiAoIHByb3BlcnR5LmlzRXh0ZXJuYWxseUNoYW5naW5nICkge1xyXG4gICAgICAgICAgZWRpdGVkQ2FsbGJhY2soKTtcclxuICAgICAgICAgIHByb3ZpZGVFbnRyeVZhbHVlcygpO1xyXG4gICAgICAgICAgZW50cnlQcm9wZXJ0eS52YWx1ZS5zdGF0dXNQcm9wZXJ0eS52YWx1ZSA9IEVudHJ5U3RhdHVzLk5PUk1BTDtcclxuICAgICAgICB9XHJcbiAgICAgIH0gKTtcclxuICAgIH1cclxuXHJcbiAgICBsaW5rUHJvcGVydHkoIGNvbnN0YW50UHJvcGVydHksIGNvbnN0YW50RW50cnlQcm9wZXJ0eSApO1xyXG4gICAgbGlua1Byb3BlcnR5KCB4UHJvcGVydHksIHhFbnRyeVByb3BlcnR5ICk7XHJcbiAgICBsaW5rUHJvcGVydHkoIHhTcXVhcmVkUHJvcGVydHksIHhTcXVhcmVkRW50cnlQcm9wZXJ0eSApO1xyXG5cclxuICAgIC8vIFstODEsODFdIGlzIHRoZSBhY3R1YWwgcmFuZ2Ugd2UgbmVlZCBmb3IgZWRpdGFibGUgdmFsdWVzLFxyXG4gICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9hcmVhLW1vZGVsLWNvbW1vbi9pc3N1ZXMvOTRcclxuICAgIGNvbnN0IHJhbmdlUHJvcGVydHkgPSBuZXcgUHJvcGVydHkoIG5ldyBSYW5nZSggLTgxLCA4MSApICk7XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0UGlja2VyQ29sb3JQcm9wZXJ0eSggZW50cnlQcm9wZXJ0eSApIHtcclxuICAgICAgcmV0dXJuIG5ldyBEZXJpdmVkUHJvcGVydHkoIFtcclxuICAgICAgICBuZXcgRHluYW1pY1Byb3BlcnR5KCBlbnRyeVByb3BlcnR5LCB7IGRlcml2ZTogJ3N0YXR1c1Byb3BlcnR5JyB9ICksXHJcbiAgICAgICAgQXJlYU1vZGVsQ29tbW9uQ29sb3JzLmVycm9yU3RhdHVzUHJvcGVydHksXHJcbiAgICAgICAgQXJlYU1vZGVsQ29tbW9uQ29sb3JzLmRpcnR5U3RhdHVzUHJvcGVydHlcclxuICAgICAgXSwgKCBoaWdobGlnaHQsIGVycm9yQ29sb3IsIGRpcnR5Q29sb3IgKSA9PiB7XHJcbiAgICAgICAgaWYgKCBoaWdobGlnaHQgPT09IEVudHJ5U3RhdHVzLk5PUk1BTCApIHtcclxuICAgICAgICAgIHJldHVybiAnYmxhY2snO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICggaGlnaGxpZ2h0ID09PSBFbnRyeVN0YXR1cy5ESVJUWSApIHtcclxuICAgICAgICAgIHJldHVybiBkaXJ0eUNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBlcnJvckNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNvbnN0YW50UGlja2VyID0gbmV3IE51bWJlclBpY2tlciggY29uc3RhbnRQcm9wZXJ0eSwgcmFuZ2VQcm9wZXJ0eSwge1xyXG4gICAgICBjb2xvcjogZ2V0UGlja2VyQ29sb3JQcm9wZXJ0eSggY29uc3RhbnRFbnRyeVByb3BlcnR5IClcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IHhQaWNrZXIgPSBuZXcgTnVtYmVyUGlja2VyKCB4UHJvcGVydHksIHJhbmdlUHJvcGVydHksIHtcclxuICAgICAgY29sb3I6IGdldFBpY2tlckNvbG9yUHJvcGVydHkoIHhFbnRyeVByb3BlcnR5IClcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IHhTcXVhcmVkUGlja2VyID0gbmV3IE51bWJlclBpY2tlciggeFNxdWFyZWRQcm9wZXJ0eSwgcmFuZ2VQcm9wZXJ0eSwge1xyXG4gICAgICBjb2xvcjogZ2V0UGlja2VyQ29sb3JQcm9wZXJ0eSggeFNxdWFyZWRFbnRyeVByb3BlcnR5IClcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCB4VGV4dCA9IG5ldyBSaWNoVGV4dCggQXJlYU1vZGVsQ29tbW9uQ29uc3RhbnRzLlhfVkFSSUFCTEVfUklDSF9TVFJJTkcsIHsgZm9udDogZWRpdEZvbnQgfSApO1xyXG4gICAgY29uc3QgeFNxdWFyZWRUZXh0ID0gbmV3IFJpY2hUZXh0KCBgJHtBcmVhTW9kZWxDb21tb25Db25zdGFudHMuWF9WQVJJQUJMRV9SSUNIX1NUUklOR308c3VwPjI8L3N1cD5gLCB7IGZvbnQ6IGVkaXRGb250IH0gKTtcclxuICAgIGNvbnN0IHBsdXMxID0gbmV3IFRleHQoIE1hdGhTeW1ib2xzLlBMVVMsIHsgZm9udDogZWRpdEZvbnQgfSApO1xyXG4gICAgY29uc3QgcGx1czIgPSBuZXcgVGV4dCggTWF0aFN5bWJvbHMuUExVUywgeyBmb250OiBlZGl0Rm9udCB9ICk7XHJcblxyXG4gICAgY29uc3QgeFNxdWFyZWRDaGlsZHJlbiA9IFtcclxuICAgICAgeFNxdWFyZWRQaWNrZXIsXHJcbiAgICAgIHhTcXVhcmVkVGV4dCxcclxuICAgICAgcGx1czEsXHJcbiAgICAgIHhQaWNrZXIsXHJcbiAgICAgIHhUZXh0LFxyXG4gICAgICBwbHVzMixcclxuICAgICAgY29uc3RhbnRQaWNrZXJcclxuICAgIF07XHJcbiAgICBjb25zdCB4Q2hpbGRyZW4gPSBbXHJcbiAgICAgIHhQaWNrZXIsXHJcbiAgICAgIHhUZXh0LFxyXG4gICAgICBwbHVzMixcclxuICAgICAgY29uc3RhbnRQaWNrZXJcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgcGlja2VyQ29udGFpbmVyID0gbmV3IE5vZGUoKTtcclxuICAgIC8vIEhpZGUgdGhlIHheMiB0ZXJtIGlmIHdlIHdvbid0IHVzZSBpdFxyXG4gICAgY29uc3RhbnRFbnRyeVByb3BlcnR5LmxpbmsoIGNvbnN0YW50RW50cnkgPT4ge1xyXG4gICAgICBwaWNrZXJDb250YWluZXIuY2hpbGRyZW4gPSBjb25zdGFudEVudHJ5LmlucHV0TWV0aG9kID09PSBJbnB1dE1ldGhvZC5QT0xZTk9NSUFMXzJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB4U3F1YXJlZENoaWxkcmVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogeENoaWxkcmVuO1xyXG4gICAgfSApO1xyXG5cclxuICAgIHhTcXVhcmVkQ2hpbGRyZW4uZm9yRWFjaCggKCBub2RlLCBpbmRleCApID0+IHtcclxuICAgICAgaWYgKCBpbmRleCA+IDAgKSB7XHJcbiAgICAgICAgbm9kZS5sZWZ0ID0geFNxdWFyZWRDaGlsZHJlblsgaW5kZXggLSAxIF0ucmlnaHQgKyA1O1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcbiAgICBjb25zdGFudFBpY2tlci5jZW50ZXJZID0geFRleHQuY2VudGVyWTtcclxuICAgIHhQaWNrZXIuY2VudGVyWSA9IHhUZXh0LmNlbnRlclk7XHJcbiAgICB4U3F1YXJlZFBpY2tlci5jZW50ZXJZID0geFRleHQuY2VudGVyWTtcclxuXHJcbiAgICBzdXBlcigge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIHJlYWRvdXQsXHJcbiAgICAgICAgcGlja2VyQ29udGFpbmVyXHJcbiAgICAgIF0sXHJcbiAgICAgIHNwYWNpbmc6IDEwXHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG5hcmVhTW9kZWxDb21tb24ucmVnaXN0ZXIoICdQb2x5bm9taWFsRWRpdE5vZGUnLCBQb2x5bm9taWFsRWRpdE5vZGUgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvbHlub21pYWxFZGl0Tm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxRQUFRLE1BQU0saUNBQWlDO0FBQ3RELE9BQU9DLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsV0FBVyxNQUFNLDRDQUE0QztBQUNwRSxTQUFTQyxJQUFJLEVBQUVDLFNBQVMsRUFBRUMsUUFBUSxFQUFFQyxJQUFJLEVBQUVDLElBQUksUUFBUSxtQ0FBbUM7QUFDekYsT0FBT0MsWUFBWSxNQUFNLG9D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