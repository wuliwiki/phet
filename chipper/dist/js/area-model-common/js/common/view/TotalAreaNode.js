// Copyright 2017-2022, University of Colorado Boulder

/**
 * Shows the total area, handling alignment
 *
 * NOTE: This type is designed to be persistent, and will not need to release references to avoid memory leaks.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Bounds2 from '../../../../dot/js/Bounds2.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import { AlignBox, HBox, Node, RichText, Text } from '../../../../scenery/js/imports.js';
import Panel from '../../../../sun/js/Panel.js';
import areaModelCommon from '../../areaModelCommon.js';
import AreaModelCommonStrings from '../../AreaModelCommonStrings.js';
import AreaModelCommonConstants from '../AreaModelCommonConstants.js';
import Term from '../model/Term.js';
import AreaModelCommonColors from './AreaModelCommonColors.js';
const areaString = AreaModelCommonStrings.area;
const areaEqualsPatternString = AreaModelCommonStrings.a11y.areaEqualsPattern;
class TotalAreaNode extends Node {
  /**
   * @param {Property.<Polynomial|null>} totalAreaProperty
   * @param {boolean} isProportional - Whether the area is shown as proportional (instead of generic)
   * @param {string} maximumWidthString - If proportional
   * @param {boolean} useTileLikeBackground - Whether the "tile" color should be used with an area background (if any)
   */
  constructor(totalAreaProperty, isProportional, maximumWidthString, useTileLikeBackground) {
    // If powers of x are supported, we need to have a slightly different initial height so we can align-bottom.
    const areaText = new RichText(Term.getLargestGenericString(true, 3), {
      font: AreaModelCommonConstants.TOTAL_AREA_VALUE_FONT
    });
    let areaNode;
    if (isProportional) {
      // Has numeric display, so it doesn't need maxWidth
      areaText.string = maximumWidthString;
      areaNode = new HBox({
        spacing: 8,
        children: [new Text(areaString, {
          font: AreaModelCommonConstants.TOTAL_AREA_LABEL_FONT
        }), new Text(MathSymbols.EQUAL_TO, {
          font: AreaModelCommonConstants.TOTAL_AREA_LABEL_FONT
        }),
        // AlignBox it so that it is always centered and keeps the same bounds
        new Panel(new AlignBox(areaText, {
          alignBounds: areaText.bounds.copy(),
          yAlign: 'bottom'
        }), {
          fill: useTileLikeBackground ? AreaModelCommonColors.smallTileProperty : AreaModelCommonColors.proportionalActiveAreaBackgroundProperty
        })]
      });
    } else {
      areaText.maxWidth = AreaModelCommonConstants.PANEL_INTERIOR_MAX;

      // AlignBox it so that it is always centered and keeps the same bounds
      areaNode = new AlignBox(areaText, {
        alignBounds: new Bounds2(0, 0, AreaModelCommonConstants.PANEL_INTERIOR_MAX, areaText.height)
      });
    }
    super({
      children: [areaNode],
      maxWidth: AreaModelCommonConstants.PANEL_INTERIOR_MAX,
      // pdom
      tagName: 'p'
    });

    // Update the text.
    totalAreaProperty.link(polynomial => {
      const labelString = polynomial === null ? '?' : polynomial.toRichString();
      areaText.string = labelString;
      this.innerContent = StringUtils.fillIn(areaEqualsPatternString, {
        area: labelString
      });
    });
  }
}
areaModelCommon.register('TotalAreaNode', TotalAreaNode);
export default TotalAreaNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb3VuZHMyIiwiU3RyaW5nVXRpbHMiLCJNYXRoU3ltYm9scyIsIkFsaWduQm94IiwiSEJveCIsIk5vZGUiLCJSaWNoVGV4dCIsIlRleHQiLCJQYW5lbCIsImFyZWFNb2RlbENvbW1vbiIsIkFyZWFNb2RlbENvbW1vblN0cmluZ3MiLCJBcmVhTW9kZWxDb21tb25Db25zdGFudHMiLCJUZXJtIiwiQXJlYU1vZGVsQ29tbW9uQ29sb3JzIiwiYXJlYVN0cmluZyIsImFyZWEiLCJhcmVhRXF1YWxzUGF0dGVyblN0cmluZyIsImExMXkiLCJhcmVhRXF1YWxzUGF0dGVybiIsIlRvdGFsQXJlYU5vZGUiLCJjb25zdHJ1Y3RvciIsInRvdGFsQXJlYVByb3BlcnR5IiwiaXNQcm9wb3J0aW9uYWwiLCJtYXhpbXVtV2lkdGhTdHJpbmciLCJ1c2VUaWxlTGlrZUJhY2tncm91bmQiLCJhcmVhVGV4dCIsImdldExhcmdlc3RHZW5lcmljU3RyaW5nIiwiZm9udCIsIlRPVEFMX0FSRUFfVkFMVUVfRk9OVCIsImFyZWFOb2RlIiwic3RyaW5nIiwic3BhY2luZyIsImNoaWxkcmVuIiwiVE9UQUxfQVJFQV9MQUJFTF9GT05UIiwiRVFVQUxfVE8iLCJhbGlnbkJvdW5kcyIsImJvdW5kcyIsImNvcHkiLCJ5QWxpZ24iLCJmaWxsIiwic21hbGxUaWxlUHJvcGVydHkiLCJwcm9wb3J0aW9uYWxBY3RpdmVBcmVhQmFja2dyb3VuZFByb3BlcnR5IiwibWF4V2lkdGgiLCJQQU5FTF9JTlRFUklPUl9NQVgiLCJoZWlnaHQiLCJ0YWdOYW1lIiwibGluayIsInBvbHlub21pYWwiLCJsYWJlbFN0cmluZyIsInRvUmljaFN0cmluZyIsImlubmVyQ29udGVudCIsImZpbGxJbiIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiVG90YWxBcmVhTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNy0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBTaG93cyB0aGUgdG90YWwgYXJlYSwgaGFuZGxpbmcgYWxpZ25tZW50XHJcbiAqXHJcbiAqIE5PVEU6IFRoaXMgdHlwZSBpcyBkZXNpZ25lZCB0byBiZSBwZXJzaXN0ZW50LCBhbmQgd2lsbCBub3QgbmVlZCB0byByZWxlYXNlIHJlZmVyZW5jZXMgdG8gYXZvaWQgbWVtb3J5IGxlYWtzLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgU3RyaW5nVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy91dGlsL1N0cmluZ1V0aWxzLmpzJztcclxuaW1wb3J0IE1hdGhTeW1ib2xzIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9NYXRoU3ltYm9scy5qcyc7XHJcbmltcG9ydCB7IEFsaWduQm94LCBIQm94LCBOb2RlLCBSaWNoVGV4dCwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBQYW5lbCBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvUGFuZWwuanMnO1xyXG5pbXBvcnQgYXJlYU1vZGVsQ29tbW9uIGZyb20gJy4uLy4uL2FyZWFNb2RlbENvbW1vbi5qcyc7XHJcbmltcG9ydCBBcmVhTW9kZWxDb21tb25TdHJpbmdzIGZyb20gJy4uLy4uL0FyZWFNb2RlbENvbW1vblN0cmluZ3MuanMnO1xyXG5pbXBvcnQgQXJlYU1vZGVsQ29tbW9uQ29uc3RhbnRzIGZyb20gJy4uL0FyZWFNb2RlbENvbW1vbkNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBUZXJtIGZyb20gJy4uL21vZGVsL1Rlcm0uanMnO1xyXG5pbXBvcnQgQXJlYU1vZGVsQ29tbW9uQ29sb3JzIGZyb20gJy4vQXJlYU1vZGVsQ29tbW9uQ29sb3JzLmpzJztcclxuXHJcbmNvbnN0IGFyZWFTdHJpbmcgPSBBcmVhTW9kZWxDb21tb25TdHJpbmdzLmFyZWE7XHJcbmNvbnN0IGFyZWFFcXVhbHNQYXR0ZXJuU3RyaW5nID0gQXJlYU1vZGVsQ29tbW9uU3RyaW5ncy5hMTF5LmFyZWFFcXVhbHNQYXR0ZXJuO1xyXG5cclxuY2xhc3MgVG90YWxBcmVhTm9kZSBleHRlbmRzIE5vZGUge1xyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPFBvbHlub21pYWx8bnVsbD59IHRvdGFsQXJlYVByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtib29sZWFufSBpc1Byb3BvcnRpb25hbCAtIFdoZXRoZXIgdGhlIGFyZWEgaXMgc2hvd24gYXMgcHJvcG9ydGlvbmFsIChpbnN0ZWFkIG9mIGdlbmVyaWMpXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1heGltdW1XaWR0aFN0cmluZyAtIElmIHByb3BvcnRpb25hbFxyXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlVGlsZUxpa2VCYWNrZ3JvdW5kIC0gV2hldGhlciB0aGUgXCJ0aWxlXCIgY29sb3Igc2hvdWxkIGJlIHVzZWQgd2l0aCBhbiBhcmVhIGJhY2tncm91bmQgKGlmIGFueSlcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggdG90YWxBcmVhUHJvcGVydHksIGlzUHJvcG9ydGlvbmFsLCBtYXhpbXVtV2lkdGhTdHJpbmcsIHVzZVRpbGVMaWtlQmFja2dyb3VuZCApIHtcclxuXHJcbiAgICAvLyBJZiBwb3dlcnMgb2YgeCBhcmUgc3VwcG9ydGVkLCB3ZSBuZWVkIHRvIGhhdmUgYSBzbGlnaHRseSBkaWZmZXJlbnQgaW5pdGlhbCBoZWlnaHQgc28gd2UgY2FuIGFsaWduLWJvdHRvbS5cclxuICAgIGNvbnN0IGFyZWFUZXh0ID0gbmV3IFJpY2hUZXh0KCBUZXJtLmdldExhcmdlc3RHZW5lcmljU3RyaW5nKCB0cnVlLCAzICksIHtcclxuICAgICAgZm9udDogQXJlYU1vZGVsQ29tbW9uQ29uc3RhbnRzLlRPVEFMX0FSRUFfVkFMVUVfRk9OVFxyXG4gICAgfSApO1xyXG5cclxuICAgIGxldCBhcmVhTm9kZTtcclxuICAgIGlmICggaXNQcm9wb3J0aW9uYWwgKSB7XHJcblxyXG4gICAgICAvLyBIYXMgbnVtZXJpYyBkaXNwbGF5LCBzbyBpdCBkb2Vzbid0IG5lZWQgbWF4V2lkdGhcclxuICAgICAgYXJlYVRleHQuc3RyaW5nID0gbWF4aW11bVdpZHRoU3RyaW5nO1xyXG4gICAgICBhcmVhTm9kZSA9IG5ldyBIQm94KCB7XHJcbiAgICAgICAgc3BhY2luZzogOCxcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgbmV3IFRleHQoIGFyZWFTdHJpbmcsIHsgZm9udDogQXJlYU1vZGVsQ29tbW9uQ29uc3RhbnRzLlRPVEFMX0FSRUFfTEFCRUxfRk9OVCB9ICksXHJcbiAgICAgICAgICBuZXcgVGV4dCggTWF0aFN5bWJvbHMuRVFVQUxfVE8sIHsgZm9udDogQXJlYU1vZGVsQ29tbW9uQ29uc3RhbnRzLlRPVEFMX0FSRUFfTEFCRUxfRk9OVCB9ICksXHJcbiAgICAgICAgICAvLyBBbGlnbkJveCBpdCBzbyB0aGF0IGl0IGlzIGFsd2F5cyBjZW50ZXJlZCBhbmQga2VlcHMgdGhlIHNhbWUgYm91bmRzXHJcbiAgICAgICAgICBuZXcgUGFuZWwoIG5ldyBBbGlnbkJveCggYXJlYVRleHQsIHsgYWxpZ25Cb3VuZHM6IGFyZWFUZXh0LmJvdW5kcy5jb3B5KCksIHlBbGlnbjogJ2JvdHRvbScgfSApLCB7XHJcbiAgICAgICAgICAgIGZpbGw6IHVzZVRpbGVMaWtlQmFja2dyb3VuZFxyXG4gICAgICAgICAgICAgICAgICA/IEFyZWFNb2RlbENvbW1vbkNvbG9ycy5zbWFsbFRpbGVQcm9wZXJ0eVxyXG4gICAgICAgICAgICAgICAgICA6IEFyZWFNb2RlbENvbW1vbkNvbG9ycy5wcm9wb3J0aW9uYWxBY3RpdmVBcmVhQmFja2dyb3VuZFByb3BlcnR5XHJcbiAgICAgICAgICB9IClcclxuICAgICAgICBdXHJcbiAgICAgIH0gKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBhcmVhVGV4dC5tYXhXaWR0aCA9IEFyZWFNb2RlbENvbW1vbkNvbnN0YW50cy5QQU5FTF9JTlRFUklPUl9NQVg7XHJcblxyXG4gICAgICAvLyBBbGlnbkJveCBpdCBzbyB0aGF0IGl0IGlzIGFsd2F5cyBjZW50ZXJlZCBhbmQga2VlcHMgdGhlIHNhbWUgYm91bmRzXHJcbiAgICAgIGFyZWFOb2RlID0gbmV3IEFsaWduQm94KCBhcmVhVGV4dCwgeyBhbGlnbkJvdW5kczogbmV3IEJvdW5kczIoIDAsIDAsIEFyZWFNb2RlbENvbW1vbkNvbnN0YW50cy5QQU5FTF9JTlRFUklPUl9NQVgsIGFyZWFUZXh0LmhlaWdodCApIH0gKTtcclxuICAgIH1cclxuXHJcbiAgICBzdXBlcigge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIGFyZWFOb2RlXHJcbiAgICAgIF0sXHJcbiAgICAgIG1heFdpZHRoOiBBcmVhTW9kZWxDb21tb25Db25zdGFudHMuUEFORUxfSU5URVJJT1JfTUFYLFxyXG5cclxuICAgICAgLy8gcGRvbVxyXG4gICAgICB0YWdOYW1lOiAncCdcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIHRleHQuXHJcbiAgICB0b3RhbEFyZWFQcm9wZXJ0eS5saW5rKCBwb2x5bm9taWFsID0+IHtcclxuICAgICAgY29uc3QgbGFiZWxTdHJpbmcgPSBwb2x5bm9taWFsID09PSBudWxsID8gJz8nIDogcG9seW5vbWlhbC50b1JpY2hTdHJpbmcoKTtcclxuICAgICAgYXJlYVRleHQuc3RyaW5nID0gbGFiZWxTdHJpbmc7XHJcbiAgICAgIHRoaXMuaW5uZXJDb250ZW50ID0gU3RyaW5nVXRpbHMuZmlsbEluKCBhcmVhRXF1YWxzUGF0dGVyblN0cmluZywge1xyXG4gICAgICAgIGFyZWE6IGxhYmVsU3RyaW5nXHJcbiAgICAgIH0gKTtcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbmFyZWFNb2RlbENvbW1vbi5yZWdpc3RlciggJ1RvdGFsQXJlYU5vZGUnLCBUb3RhbEFyZWFOb2RlICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBUb3RhbEFyZWFOb2RlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxXQUFXLE1BQU0sK0NBQStDO0FBQ3ZFLE9BQU9DLFdBQVcsTUFBTSw0Q0FBNEM7QUFDcEUsU0FBU0MsUUFBUSxFQUFFQyxJQUFJLEVBQUVDLElBQUksRUFBRUMsUUFBUSxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQ3hGLE9BQU9DLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsZUFBZSxNQUFNLDBCQUEwQjtBQUN0RCxPQUFPQyxzQkFBc0IsTUFBTSxpQ0FBaUM7QUFDcEUsT0FBT0Msd0JBQXdCLE1BQU0sZ0NBQWdDO0FBQ3JFLE9BQU9DLElBQUksTUFBTSxrQkFBa0I7QUFDbkMsT0FBT0MscUJBQXFCLE1BQU0sNEJBQTRCO0FBRTlELE1BQU1DLFVBQVUsR0FBR0osc0JBQXNCLENBQUNLLElBQUk7QUFDOUMsTUFBTUMsdUJBQXVCLEdBQUdOLHNCQUFzQixDQUFDTyxJQUFJLENBQUNDLGlCQUFpQjtBQUU3RSxNQUFNQyxhQUFhLFNBQVNkLElBQUksQ0FBQztFQUMvQjtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRWUsV0FBV0EsQ0FBRUMsaUJBQWlCLEVBQUVDLGNBQWMsRUFBRUMsa0JBQWtCLEVBQUVDLHFCQUFxQixFQUFHO0lBRTFGO0lBQ0EsTUFBTUMsUUFBUSxHQUFHLElBQUluQixRQUFRLENBQUVNLElBQUksQ0FBQ2MsdUJBQXVCLENBQUUsSUFBSSxFQUFFLENBQUUsQ0FBQyxFQUFFO01BQ3RFQyxJQUFJLEVBQUVoQix3QkFBd0IsQ0FBQ2lCO0lBQ2pDLENBQUUsQ0FBQztJQUVILElBQUlDLFFBQVE7SUFDWixJQUFLUCxjQUFjLEVBQUc7TUFFcEI7TUFDQUcsUUFBUSxDQUFDSyxNQUFNLEdBQUdQLGtCQUFrQjtNQUNwQ00sUUFBUSxHQUFHLElBQUl6QixJQUFJLENBQUU7UUFDbkIyQixPQUFPLEVBQUUsQ0FBQztRQUNWQyxRQUFRLEVBQUUsQ0FDUixJQUFJekIsSUFBSSxDQUFFTyxVQUFVLEVBQUU7VUFBRWEsSUFBSSxFQUFFaEIsd0JBQXdCLENBQUNzQjtRQUFzQixDQUFFLENBQUMsRUFDaEYsSUFBSTFCLElBQUksQ0FBRUwsV0FBVyxDQUFDZ0MsUUFBUSxFQUFFO1VBQUVQLElBQUksRUFBRWhCLHdCQUF3QixDQUFDc0I7UUFBc0IsQ0FBRSxDQUFDO1FBQzFGO1FBQ0EsSUFBSXpCLEtBQUssQ0FBRSxJQUFJTCxRQUFRLENBQUVzQixRQUFRLEVBQUU7VUFBRVUsV0FBVyxFQUFFVixRQUFRLENBQUNXLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLENBQUM7VUFBRUMsTUFBTSxFQUFFO1FBQVMsQ0FBRSxDQUFDLEVBQUU7VUFDOUZDLElBQUksRUFBRWYscUJBQXFCLEdBQ25CWCxxQkFBcUIsQ0FBQzJCLGlCQUFpQixHQUN2QzNCLHFCQUFxQixDQUFDNEI7UUFDaEMsQ0FBRSxDQUFDO01BRVAsQ0FBRSxDQUFDO0lBQ0wsQ0FBQyxNQUNJO01BQ0hoQixRQUFRLENBQUNpQixRQUFRLEdBQUcvQix3QkFBd0IsQ0FBQ2dDLGtCQUFrQjs7TUFFL0Q7TUFDQWQsUUFBUSxHQUFHLElBQUkxQixRQUFRLENBQUVzQixRQUFRLEVBQUU7UUFBRVUsV0FBVyxFQUFFLElBQUluQyxPQUFPLENBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRVcsd0JBQXdCLENBQUNnQyxrQkFBa0IsRUFBRWxCLFFBQVEsQ0FBQ21CLE1BQU87TUFBRSxDQUFFLENBQUM7SUFDekk7SUFFQSxLQUFLLENBQUU7TUFDTFosUUFBUSxFQUFFLENBQ1JILFFBQVEsQ0FDVDtNQUNEYSxRQUFRLEVBQUUvQix3QkFBd0IsQ0FBQ2dDLGtCQUFrQjtNQUVyRDtNQUNBRSxPQUFPLEVBQUU7SUFDWCxDQUFFLENBQUM7O0lBRUg7SUFDQXhCLGlCQUFpQixDQUFDeUIsSUFBSSxDQUFFQyxVQUFVLElBQUk7TUFDcEMsTUFBTUMsV0FBVyxHQUFHRCxVQUFVLEtBQUssSUFBSSxHQUFHLEdBQUcsR0FBR0EsVUFBVSxDQUFDRSxZQUFZLENBQUMsQ0FBQztNQUN6RXhCLFFBQVEsQ0FBQ0ssTUFBTSxHQUFHa0IsV0FBVztNQUM3QixJQUFJLENBQUNFLFlBQVksR0FBR2pELFdBQVcsQ0FBQ2tELE1BQU0sQ0FBRW5DLHVCQUF1QixFQUFFO1FBQy9ERCxJQUFJLEVBQUVpQztNQUNSLENBQUUsQ0FBQztJQUNMLENBQUUsQ0FBQztFQUNMO0FBQ0Y7QUFFQXZDLGVBQWUsQ0FBQzJDLFFBQVEsQ0FBRSxlQUFlLEVBQUVqQyxhQUFjLENBQUM7QUFFMUQsZUFBZUEsYUFBYSJ9