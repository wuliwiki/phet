// Copyright 2018-2023, University of Colorado Boulder

/**
 * A single calculation line (for the display of the calculation panel/box)
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import DerivedProperty from '../../../../../axon/js/DerivedProperty.js';
import areaModelCommon from '../../../areaModelCommon.js';
import AreaModelCommonConstants from '../../AreaModelCommonConstants.js';
import OrientationPair from '../../model/OrientationPair.js';
import AreaModelCommonColors from '../AreaModelCommonColors.js';
import CalculationGroup from './CalculationGroup.js';
import Minus from './Minus.js';
import MultiplyX from './MultiplyX.js';
import Parentheses from './Parentheses.js';
import PlaceholderBox from './PlaceholderBox.js';
import Plus from './Plus.js';
import QuestionMark from './QuestionMark.js';
import TermText from './TermText.js';
class CalculationLine {
  /**
   * @param {number} index
   * @param {OrientationPair.<Property.<Color>>} colorProperties
   * @param {Property.<number|null>} activeIndexProperty
   * @param {boolean} allowExponents - Whether exponents (powers of x) are allowed
   * @param {boolean} isProportional - Whether the area is shown as proportional (instead of generic)
   */
  constructor(index, colorProperties, activeIndexProperty, allowExponents, isProportional) {
    assert && assert(typeof index === 'number');

    // @public {Node|null} - The {Node}, if provided, should have a `node.clean()` method to release references
    // (usually freeing it to a pool) and a `node.accessibleText` {string} representing the description of the line.
    // Filled in later, should be non-null outside CalculationLine usage.
    this.node = null;

    // @public {number}
    this.index = index;

    // @public {CalculationLine|null} - Linked-list support for easy traversal through lines
    this.previousLine = null;
    this.nextLine = null;

    // @private {boolean}
    this.allowExponents = allowExponents;
    this.isProportional = isProportional;

    // @private {Property.<boolean>}
    this.isActiveProperty = new DerivedProperty([activeIndexProperty], activeIndex => activeIndex === null || activeIndex === index);

    // @private {Property.<Color>}
    this.baseColorProperty = new DerivedProperty([this.isActiveProperty, AreaModelCommonColors.calculationActiveProperty, AreaModelCommonColors.calculationInactiveProperty], (isActive, activeColor, inactiveColor) => isActive ? activeColor : inactiveColor, {
      valueComparisonStrategy: 'equalsFunction'
    });

    // @private {OrientationPair.<Property.<Color>>}
    this.orientedColorProperties = OrientationPair.create(orientation => new DerivedProperty([this.isActiveProperty, colorProperties.get(orientation), AreaModelCommonColors.calculationInactiveProperty], (isActive, activeColor, inactiveColor) => isActive ? activeColor : inactiveColor, {
      valueComparisonStrategy: 'equalsFunction'
    }));
  }

  /**
   * Creates a TermText with the baseColor.
   * @public
   *
   * @param {TermList|Term} term
   * @param {boolean} excludeSign
   * @returns {TermText}
   */
  baseTermText(term, excludeSign) {
    assert && assert(typeof excludeSign === 'boolean');
    return TermText.createFromPool(term, this.baseColorProperty, excludeSign);
  }

  /**
   * Creates a TermText with the color of a specific orientation.
   * @public
   *
   * @param {Orientation} orientation
   * @param {TermList|Term} term
   * @returns {TermText}
   */
  orientedTermText(orientation, term) {
    return TermText.createFromPool(term, this.orientedColorProperties.get(orientation), false);
  }

  /**
   * Creates a PlaceholderBox with the color of a specific orientation.
   * @public
   *
   * @param {Orientation} orientation
   * @returns {PlaceholderBox}
   */
  orientedPlaceholderBox(orientation) {
    return PlaceholderBox.createFromPool(this.orientedColorProperties.get(orientation), this.allowExponents);
  }

  /**
   * Creates a MultiplyX with the specified content.
   * @public
   *
   * @param {Node} leftContent
   * @param {Node} rightContent
   * @returns {MultiplyX}
   */
  multiplyX(leftContent, rightContent) {
    return MultiplyX.createFromPool(leftContent, rightContent, this.baseColorProperty);
  }

  /**
   * Creates a Parentheses with the specified content.
   * @public
   *
   * @param {Node} content
   * @returns {Parentheses}
   */
  parentheses(content) {
    return Parentheses.createFromPool(content, this.baseColorProperty);
  }

  /**
   * Creates a QuestionMark
   * @public
   *
   * @returns {QuestionMark}
   */
  questionMark() {
    return QuestionMark.createFromPool(this.baseColorProperty);
  }

  /**
   * Creates a Plus
   * @public
   *
   * @returns {Plus}
   */
  plus() {
    return Plus.createFromPool(this.baseColorProperty);
  }

  /**
   * Creates a Minus
   * @public
   *
   * @returns {Minus}
   */
  minus() {
    return Minus.createFromPool(this.baseColorProperty);
  }

  /**
   * Creates a calculation group.
   * @public
   *
   * @param {Array.<Node>} nodes
   * @param {number} spacing
   * @returns {Parentheses}
   */
  group(nodes, spacing) {
    return CalculationGroup.createFromPool(nodes, spacing);
  }

  /**
   * Returns the grouping of all nodes provided, with plusses in-between each node.
   * @public
   *
   * @param {Array.<Node>} nodes
   * @returns {Node}
   */
  sumGroup(nodes) {
    return this.group(_.flatten(nodes.map((node, index) => index > 0 ? [this.plus(), node] : [node])), AreaModelCommonConstants.CALCULATION_OP_PADDING);
  }

  /**
   * Returns a grouping of all (oriented) terms provided, with plusses in-between each term.
   * @public
   *
   * @param {Array.<Term>} terms
   * @param {Orientation} orientation
   * @returns {Node}
   */
  sumOrientedTerms(terms, orientation) {
    return this.sumGroup(terms.map(term => this.orientedTermText(orientation, term)));
  }

  /**
   * Returns a grouping of all (non-oriented) terms, with plusses/minuses in-between each term (depending on the sign)
   * @public
   *
   * @param {Array.<Term>} terms
   * @returns {Node}
   */
  sumOrDifferenceOfTerms(terms) {
    return this.group(_.flatten(terms.map((term, index) => {
      const result = [];
      if (index > 0) {
        result.push(term.coefficient >= 0 ? this.plus() : this.minus());
      }
      result.push(this.baseTermText(term, index > 0));
      return result;
    })), AreaModelCommonConstants.CALCULATION_OP_PADDING);
  }

  /**
   * Returns a grouping of all (oriented) terms provided, with plusses in-between each term (negative grouped in
   * parentheses).
   * @public
   *
   * @param {Array.<Term>} terms
   * @returns {Node}
   */
  sumWithNegativeParens(terms) {
    return this.sumGroup(terms.map(term => {
      let text = this.baseTermText(term, false);
      if (term.coefficient < 0) {
        text = this.parentheses(text);
      }
      return text;
    }));
  }

  /**
   * Returns an array with this lines (and any previous/next lines) in the correct order (up to 3 lines).
   * @public
   *
   * @returns {Array.<CalculationLine>}
   */
  getAdjacentLines() {
    const result = [];
    if (this.previousLine) {
      result.push(this.previousLine);
    }
    result.push(this);
    if (this.nextLine) {
      result.push(this.nextLine);
    }
    return result;
  }

  /**
   * Removes external references.
   * @public
   */
  dispose() {
    this.node.clean();
    this.orientedColorProperties.horizontal.dispose();
    this.orientedColorProperties.vertical.dispose();
    this.baseColorProperty.dispose();
    this.isActiveProperty.dispose();
  }
}

// @public {number} - Calculation line indices. Each individual type of line will have an index value in the order
// it would show up in the calculation panel. This index is used to determine what the "active" line is (for the
// line-by-line view), so that when updating the calculation it can attempt to stay on the same active line.
CalculationLine.TOTALS_LINE_INDEX = 0;
CalculationLine.EXPANDED_LINE_INDEX = 1;
CalculationLine.DISTRIBUTION_LINE_INDEX = 2;
CalculationLine.MULTIPLIED_LINE_INDEX = 3;
CalculationLine.ORDERED_LINE_INDEX = 4;
CalculationLine.MINUSES_LINE_INDEX = 5;
CalculationLine.SUM_LINE_INDEX = 6;
areaModelCommon.register('CalculationLine', CalculationLine);
export default CalculationLine;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJhcmVhTW9kZWxDb21tb24iLCJBcmVhTW9kZWxDb21tb25Db25zdGFudHMiLCJPcmllbnRhdGlvblBhaXIiLCJBcmVhTW9kZWxDb21tb25Db2xvcnMiLCJDYWxjdWxhdGlvbkdyb3VwIiwiTWludXMiLCJNdWx0aXBseVgiLCJQYXJlbnRoZXNlcyIsIlBsYWNlaG9sZGVyQm94IiwiUGx1cyIsIlF1ZXN0aW9uTWFyayIsIlRlcm1UZXh0IiwiQ2FsY3VsYXRpb25MaW5lIiwiY29uc3RydWN0b3IiLCJpbmRleCIsImNvbG9yUHJvcGVydGllcyIsImFjdGl2ZUluZGV4UHJvcGVydHkiLCJhbGxvd0V4cG9uZW50cyIsImlzUHJvcG9ydGlvbmFsIiwiYXNzZXJ0Iiwibm9kZSIsInByZXZpb3VzTGluZSIsIm5leHRMaW5lIiwiaXNBY3RpdmVQcm9wZXJ0eSIsImFjdGl2ZUluZGV4IiwiYmFzZUNvbG9yUHJvcGVydHkiLCJjYWxjdWxhdGlvbkFjdGl2ZVByb3BlcnR5IiwiY2FsY3VsYXRpb25JbmFjdGl2ZVByb3BlcnR5IiwiaXNBY3RpdmUiLCJhY3RpdmVDb2xvciIsImluYWN0aXZlQ29sb3IiLCJ2YWx1ZUNvbXBhcmlzb25TdHJhdGVneSIsIm9yaWVudGVkQ29sb3JQcm9wZXJ0aWVzIiwiY3JlYXRlIiwib3JpZW50YXRpb24iLCJnZXQiLCJiYXNlVGVybVRleHQiLCJ0ZXJtIiwiZXhjbHVkZVNpZ24iLCJjcmVhdGVGcm9tUG9vbCIsIm9yaWVudGVkVGVybVRleHQiLCJvcmllbnRlZFBsYWNlaG9sZGVyQm94IiwibXVsdGlwbHlYIiwibGVmdENvbnRlbnQiLCJyaWdodENvbnRlbnQiLCJwYXJlbnRoZXNlcyIsImNvbnRlbnQiLCJxdWVzdGlvbk1hcmsiLCJwbHVzIiwibWludXMiLCJncm91cCIsIm5vZGVzIiwic3BhY2luZyIsInN1bUdyb3VwIiwiXyIsImZsYXR0ZW4iLCJtYXAiLCJDQUxDVUxBVElPTl9PUF9QQURESU5HIiwic3VtT3JpZW50ZWRUZXJtcyIsInRlcm1zIiwic3VtT3JEaWZmZXJlbmNlT2ZUZXJtcyIsInJlc3VsdCIsInB1c2giLCJjb2VmZmljaWVudCIsInN1bVdpdGhOZWdhdGl2ZVBhcmVucyIsInRleHQiLCJnZXRBZGphY2VudExpbmVzIiwiZGlzcG9zZSIsImNsZWFuIiwiaG9yaXpvbnRhbCIsInZlcnRpY2FsIiwiVE9UQUxTX0xJTkVfSU5ERVgiLCJFWFBBTkRFRF9MSU5FX0lOREVYIiwiRElTVFJJQlVUSU9OX0xJTkVfSU5ERVgiLCJNVUxUSVBMSUVEX0xJTkVfSU5ERVgiLCJPUkRFUkVEX0xJTkVfSU5ERVgiLCJNSU5VU0VTX0xJTkVfSU5ERVgiLCJTVU1fTElORV9JTkRFWCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQ2FsY3VsYXRpb25MaW5lLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEEgc2luZ2xlIGNhbGN1bGF0aW9uIGxpbmUgKGZvciB0aGUgZGlzcGxheSBvZiB0aGUgY2FsY3VsYXRpb24gcGFuZWwvYm94KVxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBhcmVhTW9kZWxDb21tb24gZnJvbSAnLi4vLi4vLi4vYXJlYU1vZGVsQ29tbW9uLmpzJztcclxuaW1wb3J0IEFyZWFNb2RlbENvbW1vbkNvbnN0YW50cyBmcm9tICcuLi8uLi9BcmVhTW9kZWxDb21tb25Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgT3JpZW50YXRpb25QYWlyIGZyb20gJy4uLy4uL21vZGVsL09yaWVudGF0aW9uUGFpci5qcyc7XHJcbmltcG9ydCBBcmVhTW9kZWxDb21tb25Db2xvcnMgZnJvbSAnLi4vQXJlYU1vZGVsQ29tbW9uQ29sb3JzLmpzJztcclxuaW1wb3J0IENhbGN1bGF0aW9uR3JvdXAgZnJvbSAnLi9DYWxjdWxhdGlvbkdyb3VwLmpzJztcclxuaW1wb3J0IE1pbnVzIGZyb20gJy4vTWludXMuanMnO1xyXG5pbXBvcnQgTXVsdGlwbHlYIGZyb20gJy4vTXVsdGlwbHlYLmpzJztcclxuaW1wb3J0IFBhcmVudGhlc2VzIGZyb20gJy4vUGFyZW50aGVzZXMuanMnO1xyXG5pbXBvcnQgUGxhY2Vob2xkZXJCb3ggZnJvbSAnLi9QbGFjZWhvbGRlckJveC5qcyc7XHJcbmltcG9ydCBQbHVzIGZyb20gJy4vUGx1cy5qcyc7XHJcbmltcG9ydCBRdWVzdGlvbk1hcmsgZnJvbSAnLi9RdWVzdGlvbk1hcmsuanMnO1xyXG5pbXBvcnQgVGVybVRleHQgZnJvbSAnLi9UZXJtVGV4dC5qcyc7XHJcblxyXG5jbGFzcyBDYWxjdWxhdGlvbkxpbmUge1xyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleFxyXG4gICAqIEBwYXJhbSB7T3JpZW50YXRpb25QYWlyLjxQcm9wZXJ0eS48Q29sb3I+Pn0gY29sb3JQcm9wZXJ0aWVzXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48bnVtYmVyfG51bGw+fSBhY3RpdmVJbmRleFByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtib29sZWFufSBhbGxvd0V4cG9uZW50cyAtIFdoZXRoZXIgZXhwb25lbnRzIChwb3dlcnMgb2YgeCkgYXJlIGFsbG93ZWRcclxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzUHJvcG9ydGlvbmFsIC0gV2hldGhlciB0aGUgYXJlYSBpcyBzaG93biBhcyBwcm9wb3J0aW9uYWwgKGluc3RlYWQgb2YgZ2VuZXJpYylcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggaW5kZXgsIGNvbG9yUHJvcGVydGllcywgYWN0aXZlSW5kZXhQcm9wZXJ0eSwgYWxsb3dFeHBvbmVudHMsIGlzUHJvcG9ydGlvbmFsICkge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdHlwZW9mIGluZGV4ID09PSAnbnVtYmVyJyApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMge05vZGV8bnVsbH0gLSBUaGUge05vZGV9LCBpZiBwcm92aWRlZCwgc2hvdWxkIGhhdmUgYSBgbm9kZS5jbGVhbigpYCBtZXRob2QgdG8gcmVsZWFzZSByZWZlcmVuY2VzXHJcbiAgICAvLyAodXN1YWxseSBmcmVlaW5nIGl0IHRvIGEgcG9vbCkgYW5kIGEgYG5vZGUuYWNjZXNzaWJsZVRleHRgIHtzdHJpbmd9IHJlcHJlc2VudGluZyB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIGxpbmUuXHJcbiAgICAvLyBGaWxsZWQgaW4gbGF0ZXIsIHNob3VsZCBiZSBub24tbnVsbCBvdXRzaWRlIENhbGN1bGF0aW9uTGluZSB1c2FnZS5cclxuICAgIHRoaXMubm9kZSA9IG51bGw7XHJcblxyXG4gICAgLy8gQHB1YmxpYyB7bnVtYmVyfVxyXG4gICAgdGhpcy5pbmRleCA9IGluZGV4O1xyXG5cclxuICAgIC8vIEBwdWJsaWMge0NhbGN1bGF0aW9uTGluZXxudWxsfSAtIExpbmtlZC1saXN0IHN1cHBvcnQgZm9yIGVhc3kgdHJhdmVyc2FsIHRocm91Z2ggbGluZXNcclxuICAgIHRoaXMucHJldmlvdXNMaW5lID0gbnVsbDtcclxuICAgIHRoaXMubmV4dExpbmUgPSBudWxsO1xyXG5cclxuICAgIC8vIEBwcml2YXRlIHtib29sZWFufVxyXG4gICAgdGhpcy5hbGxvd0V4cG9uZW50cyA9IGFsbG93RXhwb25lbnRzO1xyXG4gICAgdGhpcy5pc1Byb3BvcnRpb25hbCA9IGlzUHJvcG9ydGlvbmFsO1xyXG5cclxuICAgIC8vIEBwcml2YXRlIHtQcm9wZXJ0eS48Ym9vbGVhbj59XHJcbiAgICB0aGlzLmlzQWN0aXZlUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIGFjdGl2ZUluZGV4UHJvcGVydHkgXSwgYWN0aXZlSW5kZXggPT4gYWN0aXZlSW5kZXggPT09IG51bGwgfHwgYWN0aXZlSW5kZXggPT09IGluZGV4ICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge1Byb3BlcnR5LjxDb2xvcj59XHJcbiAgICB0aGlzLmJhc2VDb2xvclByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggW1xyXG4gICAgICB0aGlzLmlzQWN0aXZlUHJvcGVydHksXHJcbiAgICAgIEFyZWFNb2RlbENvbW1vbkNvbG9ycy5jYWxjdWxhdGlvbkFjdGl2ZVByb3BlcnR5LFxyXG4gICAgICBBcmVhTW9kZWxDb21tb25Db2xvcnMuY2FsY3VsYXRpb25JbmFjdGl2ZVByb3BlcnR5XHJcbiAgICBdLCAoIGlzQWN0aXZlLCBhY3RpdmVDb2xvciwgaW5hY3RpdmVDb2xvciApID0+IGlzQWN0aXZlID8gYWN0aXZlQ29sb3IgOiBpbmFjdGl2ZUNvbG9yLCB7XHJcbiAgICAgIHZhbHVlQ29tcGFyaXNvblN0cmF0ZWd5OiAnZXF1YWxzRnVuY3Rpb24nXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge09yaWVudGF0aW9uUGFpci48UHJvcGVydHkuPENvbG9yPj59XHJcbiAgICB0aGlzLm9yaWVudGVkQ29sb3JQcm9wZXJ0aWVzID0gT3JpZW50YXRpb25QYWlyLmNyZWF0ZSggb3JpZW50YXRpb24gPT4gbmV3IERlcml2ZWRQcm9wZXJ0eSggW1xyXG4gICAgICB0aGlzLmlzQWN0aXZlUHJvcGVydHksXHJcbiAgICAgIGNvbG9yUHJvcGVydGllcy5nZXQoIG9yaWVudGF0aW9uICksXHJcbiAgICAgIEFyZWFNb2RlbENvbW1vbkNvbG9ycy5jYWxjdWxhdGlvbkluYWN0aXZlUHJvcGVydHlcclxuICAgIF0sICggaXNBY3RpdmUsIGFjdGl2ZUNvbG9yLCBpbmFjdGl2ZUNvbG9yICkgPT4gaXNBY3RpdmUgPyBhY3RpdmVDb2xvciA6IGluYWN0aXZlQ29sb3IsIHtcclxuICAgICAgdmFsdWVDb21wYXJpc29uU3RyYXRlZ3k6ICdlcXVhbHNGdW5jdGlvbidcclxuICAgIH0gKSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyBhIFRlcm1UZXh0IHdpdGggdGhlIGJhc2VDb2xvci5cclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge1Rlcm1MaXN0fFRlcm19IHRlcm1cclxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGV4Y2x1ZGVTaWduXHJcbiAgICogQHJldHVybnMge1Rlcm1UZXh0fVxyXG4gICAqL1xyXG4gIGJhc2VUZXJtVGV4dCggdGVybSwgZXhjbHVkZVNpZ24gKSB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2YgZXhjbHVkZVNpZ24gPT09ICdib29sZWFuJyApO1xyXG5cclxuICAgIHJldHVybiBUZXJtVGV4dC5jcmVhdGVGcm9tUG9vbCggdGVybSwgdGhpcy5iYXNlQ29sb3JQcm9wZXJ0eSwgZXhjbHVkZVNpZ24gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBUZXJtVGV4dCB3aXRoIHRoZSBjb2xvciBvZiBhIHNwZWNpZmljIG9yaWVudGF0aW9uLlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7T3JpZW50YXRpb259IG9yaWVudGF0aW9uXHJcbiAgICogQHBhcmFtIHtUZXJtTGlzdHxUZXJtfSB0ZXJtXHJcbiAgICogQHJldHVybnMge1Rlcm1UZXh0fVxyXG4gICAqL1xyXG4gIG9yaWVudGVkVGVybVRleHQoIG9yaWVudGF0aW9uLCB0ZXJtICkge1xyXG4gICAgcmV0dXJuIFRlcm1UZXh0LmNyZWF0ZUZyb21Qb29sKCB0ZXJtLCB0aGlzLm9yaWVudGVkQ29sb3JQcm9wZXJ0aWVzLmdldCggb3JpZW50YXRpb24gKSwgZmFsc2UgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBQbGFjZWhvbGRlckJveCB3aXRoIHRoZSBjb2xvciBvZiBhIHNwZWNpZmljIG9yaWVudGF0aW9uLlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7T3JpZW50YXRpb259IG9yaWVudGF0aW9uXHJcbiAgICogQHJldHVybnMge1BsYWNlaG9sZGVyQm94fVxyXG4gICAqL1xyXG4gIG9yaWVudGVkUGxhY2Vob2xkZXJCb3goIG9yaWVudGF0aW9uICkge1xyXG4gICAgcmV0dXJuIFBsYWNlaG9sZGVyQm94LmNyZWF0ZUZyb21Qb29sKCB0aGlzLm9yaWVudGVkQ29sb3JQcm9wZXJ0aWVzLmdldCggb3JpZW50YXRpb24gKSwgdGhpcy5hbGxvd0V4cG9uZW50cyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyBhIE11bHRpcGx5WCB3aXRoIHRoZSBzcGVjaWZpZWQgY29udGVudC5cclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge05vZGV9IGxlZnRDb250ZW50XHJcbiAgICogQHBhcmFtIHtOb2RlfSByaWdodENvbnRlbnRcclxuICAgKiBAcmV0dXJucyB7TXVsdGlwbHlYfVxyXG4gICAqL1xyXG4gIG11bHRpcGx5WCggbGVmdENvbnRlbnQsIHJpZ2h0Q29udGVudCApIHtcclxuICAgIHJldHVybiBNdWx0aXBseVguY3JlYXRlRnJvbVBvb2woIGxlZnRDb250ZW50LCByaWdodENvbnRlbnQsIHRoaXMuYmFzZUNvbG9yUHJvcGVydHkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBQYXJlbnRoZXNlcyB3aXRoIHRoZSBzcGVjaWZpZWQgY29udGVudC5cclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge05vZGV9IGNvbnRlbnRcclxuICAgKiBAcmV0dXJucyB7UGFyZW50aGVzZXN9XHJcbiAgICovXHJcbiAgcGFyZW50aGVzZXMoIGNvbnRlbnQgKSB7XHJcbiAgICByZXR1cm4gUGFyZW50aGVzZXMuY3JlYXRlRnJvbVBvb2woIGNvbnRlbnQsIHRoaXMuYmFzZUNvbG9yUHJvcGVydHkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBRdWVzdGlvbk1hcmtcclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcmV0dXJucyB7UXVlc3Rpb25NYXJrfVxyXG4gICAqL1xyXG4gIHF1ZXN0aW9uTWFyaygpIHtcclxuICAgIHJldHVybiBRdWVzdGlvbk1hcmsuY3JlYXRlRnJvbVBvb2woIHRoaXMuYmFzZUNvbG9yUHJvcGVydHkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBQbHVzXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHJldHVybnMge1BsdXN9XHJcbiAgICovXHJcbiAgcGx1cygpIHtcclxuICAgIHJldHVybiBQbHVzLmNyZWF0ZUZyb21Qb29sKCB0aGlzLmJhc2VDb2xvclByb3BlcnR5ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIGEgTWludXNcclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcmV0dXJucyB7TWludXN9XHJcbiAgICovXHJcbiAgbWludXMoKSB7XHJcbiAgICByZXR1cm4gTWludXMuY3JlYXRlRnJvbVBvb2woIHRoaXMuYmFzZUNvbG9yUHJvcGVydHkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBjYWxjdWxhdGlvbiBncm91cC5cclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge0FycmF5LjxOb2RlPn0gbm9kZXNcclxuICAgKiBAcGFyYW0ge251bWJlcn0gc3BhY2luZ1xyXG4gICAqIEByZXR1cm5zIHtQYXJlbnRoZXNlc31cclxuICAgKi9cclxuICBncm91cCggbm9kZXMsIHNwYWNpbmcgKSB7XHJcbiAgICByZXR1cm4gQ2FsY3VsYXRpb25Hcm91cC5jcmVhdGVGcm9tUG9vbCggbm9kZXMsIHNwYWNpbmcgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIGdyb3VwaW5nIG9mIGFsbCBub2RlcyBwcm92aWRlZCwgd2l0aCBwbHVzc2VzIGluLWJldHdlZW4gZWFjaCBub2RlLlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7QXJyYXkuPE5vZGU+fSBub2Rlc1xyXG4gICAqIEByZXR1cm5zIHtOb2RlfVxyXG4gICAqL1xyXG4gIHN1bUdyb3VwKCBub2RlcyApIHtcclxuICAgIHJldHVybiB0aGlzLmdyb3VwKCBfLmZsYXR0ZW4oIG5vZGVzLm1hcCggKCBub2RlLCBpbmRleCApID0+IGluZGV4ID4gMCA/IFsgdGhpcy5wbHVzKCksIG5vZGUgXSA6IFsgbm9kZSBdICkgKSwgQXJlYU1vZGVsQ29tbW9uQ29uc3RhbnRzLkNBTENVTEFUSU9OX09QX1BBRERJTkcgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgYSBncm91cGluZyBvZiBhbGwgKG9yaWVudGVkKSB0ZXJtcyBwcm92aWRlZCwgd2l0aCBwbHVzc2VzIGluLWJldHdlZW4gZWFjaCB0ZXJtLlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7QXJyYXkuPFRlcm0+fSB0ZXJtc1xyXG4gICAqIEBwYXJhbSB7T3JpZW50YXRpb259IG9yaWVudGF0aW9uXHJcbiAgICogQHJldHVybnMge05vZGV9XHJcbiAgICovXHJcbiAgc3VtT3JpZW50ZWRUZXJtcyggdGVybXMsIG9yaWVudGF0aW9uICkge1xyXG4gICAgcmV0dXJuIHRoaXMuc3VtR3JvdXAoIHRlcm1zLm1hcCggdGVybSA9PiB0aGlzLm9yaWVudGVkVGVybVRleHQoIG9yaWVudGF0aW9uLCB0ZXJtICkgKSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhIGdyb3VwaW5nIG9mIGFsbCAobm9uLW9yaWVudGVkKSB0ZXJtcywgd2l0aCBwbHVzc2VzL21pbnVzZXMgaW4tYmV0d2VlbiBlYWNoIHRlcm0gKGRlcGVuZGluZyBvbiB0aGUgc2lnbilcclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge0FycmF5LjxUZXJtPn0gdGVybXNcclxuICAgKiBAcmV0dXJucyB7Tm9kZX1cclxuICAgKi9cclxuICBzdW1PckRpZmZlcmVuY2VPZlRlcm1zKCB0ZXJtcyApIHtcclxuICAgIHJldHVybiB0aGlzLmdyb3VwKCBfLmZsYXR0ZW4oIHRlcm1zLm1hcCggKCB0ZXJtLCBpbmRleCApID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gW107XHJcblxyXG4gICAgICBpZiAoIGluZGV4ID4gMCApIHtcclxuICAgICAgICByZXN1bHQucHVzaCggdGVybS5jb2VmZmljaWVudCA+PSAwID8gdGhpcy5wbHVzKCkgOiB0aGlzLm1pbnVzKCkgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmVzdWx0LnB1c2goIHRoaXMuYmFzZVRlcm1UZXh0KCB0ZXJtLCBpbmRleCA+IDAgKSApO1xyXG5cclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0gKSApLCBBcmVhTW9kZWxDb21tb25Db25zdGFudHMuQ0FMQ1VMQVRJT05fT1BfUEFERElORyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhIGdyb3VwaW5nIG9mIGFsbCAob3JpZW50ZWQpIHRlcm1zIHByb3ZpZGVkLCB3aXRoIHBsdXNzZXMgaW4tYmV0d2VlbiBlYWNoIHRlcm0gKG5lZ2F0aXZlIGdyb3VwZWQgaW5cclxuICAgKiBwYXJlbnRoZXNlcykuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtBcnJheS48VGVybT59IHRlcm1zXHJcbiAgICogQHJldHVybnMge05vZGV9XHJcbiAgICovXHJcbiAgc3VtV2l0aE5lZ2F0aXZlUGFyZW5zKCB0ZXJtcyApIHtcclxuICAgIHJldHVybiB0aGlzLnN1bUdyb3VwKCB0ZXJtcy5tYXAoIHRlcm0gPT4ge1xyXG4gICAgICBsZXQgdGV4dCA9IHRoaXMuYmFzZVRlcm1UZXh0KCB0ZXJtLCBmYWxzZSApO1xyXG4gICAgICBpZiAoIHRlcm0uY29lZmZpY2llbnQgPCAwICkge1xyXG4gICAgICAgIHRleHQgPSB0aGlzLnBhcmVudGhlc2VzKCB0ZXh0ICk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICB9ICkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgYW4gYXJyYXkgd2l0aCB0aGlzIGxpbmVzIChhbmQgYW55IHByZXZpb3VzL25leHQgbGluZXMpIGluIHRoZSBjb3JyZWN0IG9yZGVyICh1cCB0byAzIGxpbmVzKS5cclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcmV0dXJucyB7QXJyYXkuPENhbGN1bGF0aW9uTGluZT59XHJcbiAgICovXHJcbiAgZ2V0QWRqYWNlbnRMaW5lcygpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xyXG4gICAgaWYgKCB0aGlzLnByZXZpb3VzTGluZSApIHtcclxuICAgICAgcmVzdWx0LnB1c2goIHRoaXMucHJldmlvdXNMaW5lICk7XHJcbiAgICB9XHJcbiAgICByZXN1bHQucHVzaCggdGhpcyApO1xyXG4gICAgaWYgKCB0aGlzLm5leHRMaW5lICkge1xyXG4gICAgICByZXN1bHQucHVzaCggdGhpcy5uZXh0TGluZSApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbW92ZXMgZXh0ZXJuYWwgcmVmZXJlbmNlcy5cclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgZGlzcG9zZSgpIHtcclxuICAgIHRoaXMubm9kZS5jbGVhbigpO1xyXG5cclxuICAgIHRoaXMub3JpZW50ZWRDb2xvclByb3BlcnRpZXMuaG9yaXpvbnRhbC5kaXNwb3NlKCk7XHJcbiAgICB0aGlzLm9yaWVudGVkQ29sb3JQcm9wZXJ0aWVzLnZlcnRpY2FsLmRpc3Bvc2UoKTtcclxuICAgIHRoaXMuYmFzZUNvbG9yUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgdGhpcy5pc0FjdGl2ZVByb3BlcnR5LmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG59XHJcblxyXG4vLyBAcHVibGljIHtudW1iZXJ9IC0gQ2FsY3VsYXRpb24gbGluZSBpbmRpY2VzLiBFYWNoIGluZGl2aWR1YWwgdHlwZSBvZiBsaW5lIHdpbGwgaGF2ZSBhbiBpbmRleCB2YWx1ZSBpbiB0aGUgb3JkZXJcclxuLy8gaXQgd291bGQgc2hvdyB1cCBpbiB0aGUgY2FsY3VsYXRpb24gcGFuZWwuIFRoaXMgaW5kZXggaXMgdXNlZCB0byBkZXRlcm1pbmUgd2hhdCB0aGUgXCJhY3RpdmVcIiBsaW5lIGlzIChmb3IgdGhlXHJcbi8vIGxpbmUtYnktbGluZSB2aWV3KSwgc28gdGhhdCB3aGVuIHVwZGF0aW5nIHRoZSBjYWxjdWxhdGlvbiBpdCBjYW4gYXR0ZW1wdCB0byBzdGF5IG9uIHRoZSBzYW1lIGFjdGl2ZSBsaW5lLlxyXG5DYWxjdWxhdGlvbkxpbmUuVE9UQUxTX0xJTkVfSU5ERVggPSAwO1xyXG5DYWxjdWxhdGlvbkxpbmUuRVhQQU5ERURfTElORV9JTkRFWCA9IDE7XHJcbkNhbGN1bGF0aW9uTGluZS5ESVNUUklCVVRJT05fTElORV9JTkRFWCA9IDI7XHJcbkNhbGN1bGF0aW9uTGluZS5NVUxUSVBMSUVEX0xJTkVfSU5ERVggPSAzO1xyXG5DYWxjdWxhdGlvbkxpbmUuT1JERVJFRF9MSU5FX0lOREVYID0gNDtcclxuQ2FsY3VsYXRpb25MaW5lLk1JTlVTRVNfTElORV9JTkRFWCA9IDU7XHJcbkNhbGN1bGF0aW9uTGluZS5TVU1fTElORV9JTkRFWCA9IDY7XHJcblxyXG5hcmVhTW9kZWxDb21tb24ucmVnaXN0ZXIoICdDYWxjdWxhdGlvbkxpbmUnLCBDYWxjdWxhdGlvbkxpbmUgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhbGN1bGF0aW9uTGluZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLDJDQUEyQztBQUN2RSxPQUFPQyxlQUFlLE1BQU0sNkJBQTZCO0FBQ3pELE9BQU9DLHdCQUF3QixNQUFNLG1DQUFtQztBQUN4RSxPQUFPQyxlQUFlLE1BQU0sZ0NBQWdDO0FBQzVELE9B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