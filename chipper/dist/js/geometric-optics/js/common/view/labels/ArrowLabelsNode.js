// Copyright 2021-2023, University of Colorado Boulder

/**
 * ArrowLabelsNode labels things in the 'Arrow' scene.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../../axon/js/DerivedProperty.js';
import Vector2 from '../../../../../dot/js/Vector2.js';
import geometricOptics from '../../../geometricOptics.js';
import GOLabelsNode from './GOLabelsNode.js';
import OpticalObjectLabelNode from './OpticalObjectLabelNode.js';
import OpticalImageLabelNode from './OpticalImageLabelNode.js';
export default class ArrowLabelsNode extends GOLabelsNode {
  /**
   * @param sceneNode - the scene whose arrows we are labeling
   * @param zoomTransformProperty - model-view transform that the user controls by zooming in/out
   * @param modelVisibleBoundsProperty - ScreenView's visibleBounds in the model coordinate frame, with the zoom transform applied
   * @param providedOptions
   */
  constructor(sceneNode, zoomTransformProperty, modelVisibleBoundsProperty, providedOptions) {
    super(sceneNode, zoomTransformProperty, modelVisibleBoundsProperty, providedOptions);
    const scene = sceneNode.scene;

    // Use numbering in the full version of the sim, or in the Basics version if Object 2 is made visible.
    const isNumberedProperty = new DerivedProperty([sceneNode.arrowObject2NodeVisibleProperty], arrowObject2NodeVisible => !providedOptions.isBasicsVersion || arrowObject2NodeVisible);

    // Object labels ------------------------------------------------------------------------------------

    const object1Label = new ArrowObjectLabelNode(scene.arrowObject1, scene.optic.positionProperty, zoomTransformProperty, {
      visibleProperty: sceneNode.arrowObject1NodeVisibleProperty,
      isNumberedProperty: isNumberedProperty,
      tandem: providedOptions.tandem.createTandem('object1Label')
    });
    this.addChild(object1Label);
    const object2Label = new ArrowObjectLabelNode(scene.arrowObject2, scene.optic.positionProperty, zoomTransformProperty, {
      visibleProperty: sceneNode.arrowObject2NodeVisibleProperty,
      // 2nd object is always numbered, so isNumberedProperty is unnecessary,
      tandem: providedOptions.tandem.createTandem('object2Label')
    });
    this.addChild(object2Label);

    // Image labels ------------------------------------------------------------------------------------

    const image1Label = new ArrowImageLabelNode(scene.arrowImage1, scene.optic.positionProperty, zoomTransformProperty, {
      visibleProperty: sceneNode.arrowImage1NodeVisibleProperty,
      isNumberedProperty: isNumberedProperty,
      tandem: providedOptions.tandem.createTandem('image1Label')
    });
    this.addChild(image1Label);
    const image2Label = new ArrowImageLabelNode(scene.arrowImage2, scene.optic.positionProperty, zoomTransformProperty, {
      visibleProperty: sceneNode.arrowImage2NodeVisibleProperty,
      // 2nd image is always numbered, so isNumberedProperty is unnecessary
      tandem: providedOptions.tandem.createTandem('image2Label')
    });
    this.addChild(image2Label);
  }
}

// Label for an arrow object.
class ArrowObjectLabelNode extends OpticalObjectLabelNode {
  constructor(arrowObject, opticPositionProperty, zoomTransformProperty, providedOptions) {
    // If the arrow points up, position the label below the optical axis.
    // Otherwise, position the label below the arrow's tip.
    const labelPositionProperty = new DerivedProperty([arrowObject.positionProperty, opticPositionProperty], (arrowPosition, opticPosition) => arrowPosition.y > opticPosition.y ? new Vector2(arrowPosition.x, opticPosition.y) : arrowPosition);
    super(arrowObject.opticalObjectNumber, labelPositionProperty, zoomTransformProperty, providedOptions);
  }
}

// Label for an arrow image.
class ArrowImageLabelNode extends OpticalImageLabelNode {
  constructor(arrowImage, opticPositionProperty, zoomTransformProperty, providedOptions) {
    const labelPositionProperty = new DerivedProperty([arrowImage.positionProperty, opticPositionProperty], (arrowPosition, opticPosition) => {
      if (arrowPosition.y > opticPosition.y) {
        return new Vector2(arrowPosition.x, opticPosition.y);
      } else {
        return arrowPosition;
      }
    });
    super(arrowImage, labelPositionProperty, zoomTransformProperty, providedOptions);
  }
}
geometricOptics.register('ArrowLabelsNode', ArrowLabelsNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJWZWN0b3IyIiwiZ2VvbWV0cmljT3B0aWNzIiwiR09MYWJlbHNOb2RlIiwiT3B0aWNhbE9iamVjdExhYmVsTm9kZSIsIk9wdGljYWxJbWFnZUxhYmVsTm9kZSIsIkFycm93TGFiZWxzTm9kZSIsImNvbnN0cnVjdG9yIiwic2NlbmVOb2RlIiwiem9vbVRyYW5zZm9ybVByb3BlcnR5IiwibW9kZWxWaXNpYmxlQm91bmRzUHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJzY2VuZSIsImlzTnVtYmVyZWRQcm9wZXJ0eSIsImFycm93T2JqZWN0Mk5vZGVWaXNpYmxlUHJvcGVydHkiLCJhcnJvd09iamVjdDJOb2RlVmlzaWJsZSIsImlzQmFzaWNzVmVyc2lvbiIsIm9iamVjdDFMYWJlbCIsIkFycm93T2JqZWN0TGFiZWxOb2RlIiwiYXJyb3dPYmplY3QxIiwib3B0aWMiLCJwb3NpdGlvblByb3BlcnR5IiwidmlzaWJsZVByb3BlcnR5IiwiYXJyb3dPYmplY3QxTm9kZVZpc2libGVQcm9wZXJ0eSIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsImFkZENoaWxkIiwib2JqZWN0MkxhYmVsIiwiYXJyb3dPYmplY3QyIiwiaW1hZ2UxTGFiZWwiLCJBcnJvd0ltYWdlTGFiZWxOb2RlIiwiYXJyb3dJbWFnZTEiLCJhcnJvd0ltYWdlMU5vZGVWaXNpYmxlUHJvcGVydHkiLCJpbWFnZTJMYWJlbCIsImFycm93SW1hZ2UyIiwiYXJyb3dJbWFnZTJOb2RlVmlzaWJsZVByb3BlcnR5IiwiYXJyb3dPYmplY3QiLCJvcHRpY1Bvc2l0aW9uUHJvcGVydHkiLCJsYWJlbFBvc2l0aW9uUHJvcGVydHkiLCJhcnJvd1Bvc2l0aW9uIiwib3B0aWNQb3NpdGlvbiIsInkiLCJ4Iiwib3B0aWNhbE9iamVjdE51bWJlciIsImFycm93SW1hZ2UiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkFycm93TGFiZWxzTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBcnJvd0xhYmVsc05vZGUgbGFiZWxzIHRoaW5ncyBpbiB0aGUgJ0Fycm93JyBzY2VuZS5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgZ2VvbWV0cmljT3B0aWNzIGZyb20gJy4uLy4uLy4uL2dlb21ldHJpY09wdGljcy5qcyc7XHJcbmltcG9ydCBNb2RlbFZpZXdUcmFuc2Zvcm0yIGZyb20gJy4uLy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdmlldy9Nb2RlbFZpZXdUcmFuc2Zvcm0yLmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBHT0xhYmVsc05vZGUsIHsgR09TY2VuZUxhYmVsc05vZGVPcHRpb25zIH0gZnJvbSAnLi9HT0xhYmVsc05vZGUuanMnO1xyXG5pbXBvcnQgQXJyb3dJbWFnZSBmcm9tICcuLi8uLi9tb2RlbC9BcnJvd0ltYWdlLmpzJztcclxuaW1wb3J0IEFycm93T2JqZWN0IGZyb20gJy4uLy4uL21vZGVsL0Fycm93T2JqZWN0LmpzJztcclxuaW1wb3J0IE9wdGljYWxPYmplY3RMYWJlbE5vZGUsIHsgT3B0aWNhbE9iamVjdExhYmVsTm9kZU9wdGlvbnMgfSBmcm9tICcuL09wdGljYWxPYmplY3RMYWJlbE5vZGUuanMnO1xyXG5pbXBvcnQgT3B0aWNhbEltYWdlTGFiZWxOb2RlLCB7IE9wdGljYWxJbWFnZUxhYmVsTm9kZU9wdGlvbnMgfSBmcm9tICcuL09wdGljYWxJbWFnZUxhYmVsTm9kZS5qcyc7XHJcbmltcG9ydCBBcnJvd1NjZW5lTm9kZSBmcm9tICcuLi9BcnJvd1NjZW5lTm9kZS5qcyc7XHJcbmltcG9ydCB7IEdPU2ltT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL0dPU2ltLmpzJztcclxuaW1wb3J0IFBpY2tSZXF1aXJlZCBmcm9tICcuLi8uLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja1JlcXVpcmVkLmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBQaWNrUmVxdWlyZWQ8R09TaW1PcHRpb25zLCAnaXNCYXNpY3NWZXJzaW9uJz47XHJcblxyXG50eXBlIEFycm93T2JqZWN0U2NlbmVMYWJlbHNOb2RlT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgR09TY2VuZUxhYmVsc05vZGVPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXJyb3dMYWJlbHNOb2RlIGV4dGVuZHMgR09MYWJlbHNOb2RlIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHNjZW5lTm9kZSAtIHRoZSBzY2VuZSB3aG9zZSBhcnJvd3Mgd2UgYXJlIGxhYmVsaW5nXHJcbiAgICogQHBhcmFtIHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eSAtIG1vZGVsLXZpZXcgdHJhbnNmb3JtIHRoYXQgdGhlIHVzZXIgY29udHJvbHMgYnkgem9vbWluZyBpbi9vdXRcclxuICAgKiBAcGFyYW0gbW9kZWxWaXNpYmxlQm91bmRzUHJvcGVydHkgLSBTY3JlZW5WaWV3J3MgdmlzaWJsZUJvdW5kcyBpbiB0aGUgbW9kZWwgY29vcmRpbmF0ZSBmcmFtZSwgd2l0aCB0aGUgem9vbSB0cmFuc2Zvcm0gYXBwbGllZFxyXG4gICAqIEBwYXJhbSBwcm92aWRlZE9wdGlvbnNcclxuICAgKi9cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHNjZW5lTm9kZTogQXJyb3dTY2VuZU5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICB6b29tVHJhbnNmb3JtUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PE1vZGVsVmlld1RyYW5zZm9ybTI+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgbW9kZWxWaXNpYmxlQm91bmRzUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PEJvdW5kczI+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZWRPcHRpb25zOiBBcnJvd09iamVjdFNjZW5lTGFiZWxzTm9kZU9wdGlvbnMgKSB7XHJcblxyXG4gICAgc3VwZXIoIHNjZW5lTm9kZSwgem9vbVRyYW5zZm9ybVByb3BlcnR5LCBtb2RlbFZpc2libGVCb3VuZHNQcm9wZXJ0eSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgY29uc3Qgc2NlbmUgPSBzY2VuZU5vZGUuc2NlbmU7XHJcblxyXG4gICAgLy8gVXNlIG51bWJlcmluZyBpbiB0aGUgZnVsbCB2ZXJzaW9uIG9mIHRoZSBzaW0sIG9yIGluIHRoZSBCYXNpY3MgdmVyc2lvbiBpZiBPYmplY3QgMiBpcyBtYWRlIHZpc2libGUuXHJcbiAgICBjb25zdCBpc051bWJlcmVkUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHNjZW5lTm9kZS5hcnJvd09iamVjdDJOb2RlVmlzaWJsZVByb3BlcnR5IF0sXHJcbiAgICAgIGFycm93T2JqZWN0Mk5vZGVWaXNpYmxlID0+ICggIXByb3ZpZGVkT3B0aW9ucy5pc0Jhc2ljc1ZlcnNpb24gfHwgYXJyb3dPYmplY3QyTm9kZVZpc2libGUgKSApO1xyXG5cclxuICAgIC8vIE9iamVjdCBsYWJlbHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgY29uc3Qgb2JqZWN0MUxhYmVsID0gbmV3IEFycm93T2JqZWN0TGFiZWxOb2RlKCBzY2VuZS5hcnJvd09iamVjdDEsIHNjZW5lLm9wdGljLnBvc2l0aW9uUHJvcGVydHksIHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eSwge1xyXG4gICAgICB2aXNpYmxlUHJvcGVydHk6IHNjZW5lTm9kZS5hcnJvd09iamVjdDFOb2RlVmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICBpc051bWJlcmVkUHJvcGVydHk6IGlzTnVtYmVyZWRQcm9wZXJ0eSxcclxuICAgICAgdGFuZGVtOiBwcm92aWRlZE9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ29iamVjdDFMYWJlbCcgKVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggb2JqZWN0MUxhYmVsICk7XHJcblxyXG4gICAgY29uc3Qgb2JqZWN0MkxhYmVsID0gbmV3IEFycm93T2JqZWN0TGFiZWxOb2RlKCBzY2VuZS5hcnJvd09iamVjdDIsIHNjZW5lLm9wdGljLnBvc2l0aW9uUHJvcGVydHksIHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eSwge1xyXG4gICAgICB2aXNpYmxlUHJvcGVydHk6IHNjZW5lTm9kZS5hcnJvd09iamVjdDJOb2RlVmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICAvLyAybmQgb2JqZWN0IGlzIGFsd2F5cyBudW1iZXJlZCwgc28gaXNOdW1iZXJlZFByb3BlcnR5IGlzIHVubmVjZXNzYXJ5LFxyXG4gICAgICB0YW5kZW06IHByb3ZpZGVkT3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnb2JqZWN0MkxhYmVsJyApXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBvYmplY3QyTGFiZWwgKTtcclxuXHJcbiAgICAvLyBJbWFnZSBsYWJlbHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgY29uc3QgaW1hZ2UxTGFiZWwgPSBuZXcgQXJyb3dJbWFnZUxhYmVsTm9kZSggc2NlbmUuYXJyb3dJbWFnZTEsIHNjZW5lLm9wdGljLnBvc2l0aW9uUHJvcGVydHksIHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eSwge1xyXG4gICAgICB2aXNpYmxlUHJvcGVydHk6IHNjZW5lTm9kZS5hcnJvd0ltYWdlMU5vZGVWaXNpYmxlUHJvcGVydHksXHJcbiAgICAgIGlzTnVtYmVyZWRQcm9wZXJ0eTogaXNOdW1iZXJlZFByb3BlcnR5LFxyXG4gICAgICB0YW5kZW06IHByb3ZpZGVkT3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnaW1hZ2UxTGFiZWwnIClcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGltYWdlMUxhYmVsICk7XHJcblxyXG4gICAgY29uc3QgaW1hZ2UyTGFiZWwgPSBuZXcgQXJyb3dJbWFnZUxhYmVsTm9kZSggc2NlbmUuYXJyb3dJbWFnZTIsIHNjZW5lLm9wdGljLnBvc2l0aW9uUHJvcGVydHksIHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eSwge1xyXG4gICAgICB2aXNpYmxlUHJvcGVydHk6IHNjZW5lTm9kZS5hcnJvd0ltYWdlMk5vZGVWaXNpYmxlUHJvcGVydHksXHJcbiAgICAgIC8vIDJuZCBpbWFnZSBpcyBhbHdheXMgbnVtYmVyZWQsIHNvIGlzTnVtYmVyZWRQcm9wZXJ0eSBpcyB1bm5lY2Vzc2FyeVxyXG4gICAgICB0YW5kZW06IHByb3ZpZGVkT3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnaW1hZ2UyTGFiZWwnIClcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGltYWdlMkxhYmVsICk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBMYWJlbCBmb3IgYW4gYXJyb3cgb2JqZWN0LlxyXG5jbGFzcyBBcnJvd09iamVjdExhYmVsTm9kZSBleHRlbmRzIE9wdGljYWxPYmplY3RMYWJlbE5vZGUge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGFycm93T2JqZWN0OiBBcnJvd09iamVjdCxcclxuICAgICAgICAgICAgICAgICAgICAgIG9wdGljUG9zaXRpb25Qcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8VmVjdG9yMj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICB6b29tVHJhbnNmb3JtUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PE1vZGVsVmlld1RyYW5zZm9ybTI+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZWRPcHRpb25zOiBPcHRpY2FsT2JqZWN0TGFiZWxOb2RlT3B0aW9ucyApIHtcclxuXHJcbiAgICAvLyBJZiB0aGUgYXJyb3cgcG9pbnRzIHVwLCBwb3NpdGlvbiB0aGUgbGFiZWwgYmVsb3cgdGhlIG9wdGljYWwgYXhpcy5cclxuICAgIC8vIE90aGVyd2lzZSwgcG9zaXRpb24gdGhlIGxhYmVsIGJlbG93IHRoZSBhcnJvdydzIHRpcC5cclxuICAgIGNvbnN0IGxhYmVsUG9zaXRpb25Qcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgYXJyb3dPYmplY3QucG9zaXRpb25Qcm9wZXJ0eSwgb3B0aWNQb3NpdGlvblByb3BlcnR5IF0sXHJcbiAgICAgICggYXJyb3dQb3NpdGlvbiwgb3B0aWNQb3NpdGlvbiApID0+XHJcbiAgICAgICAgKCBhcnJvd1Bvc2l0aW9uLnkgPiBvcHRpY1Bvc2l0aW9uLnkgKSA/IG5ldyBWZWN0b3IyKCBhcnJvd1Bvc2l0aW9uLngsIG9wdGljUG9zaXRpb24ueSApIDogYXJyb3dQb3NpdGlvblxyXG4gICAgKTtcclxuXHJcbiAgICBzdXBlciggYXJyb3dPYmplY3Qub3B0aWNhbE9iamVjdE51bWJlciwgbGFiZWxQb3NpdGlvblByb3BlcnR5LCB6b29tVHJhbnNmb3JtUHJvcGVydHksIHByb3ZpZGVkT3B0aW9ucyApO1xyXG4gIH1cclxufVxyXG5cclxuLy8gTGFiZWwgZm9yIGFuIGFycm93IGltYWdlLlxyXG5jbGFzcyBBcnJvd0ltYWdlTGFiZWxOb2RlIGV4dGVuZHMgT3B0aWNhbEltYWdlTGFiZWxOb2RlIHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBhcnJvd0ltYWdlOiBBcnJvd0ltYWdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgb3B0aWNQb3NpdGlvblByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxWZWN0b3IyPixcclxuICAgICAgICAgICAgICAgICAgICAgIHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8TW9kZWxWaWV3VHJhbnNmb3JtMj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM6IE9wdGljYWxJbWFnZUxhYmVsTm9kZU9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3QgbGFiZWxQb3NpdGlvblByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyBhcnJvd0ltYWdlLnBvc2l0aW9uUHJvcGVydHksIG9wdGljUG9zaXRpb25Qcm9wZXJ0eSBdLFxyXG4gICAgICAoIGFycm93UG9zaXRpb24sIG9wdGljUG9zaXRpb24gKSA9PiB7XHJcbiAgICAgICAgaWYgKCBhcnJvd1Bvc2l0aW9uLnkgPiBvcHRpY1Bvc2l0aW9uLnkgKSB7XHJcbiAgICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjIoIGFycm93UG9zaXRpb24ueCwgb3B0aWNQb3NpdGlvbi55ICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGFycm93UG9zaXRpb247XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIHN1cGVyKCBhcnJvd0ltYWdlLCBsYWJlbFBvc2l0aW9uUHJvcGVydHksIHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eSwgcHJvdmlkZWRPcHRpb25zICk7XHJcbiAgfVxyXG59XHJcblxyXG5nZW9tZXRyaWNPcHRpY3MucmVnaXN0ZXIoICdBcnJvd0xhYmVsc05vZGUnLCBBcnJvd0xhYmVsc05vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFB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