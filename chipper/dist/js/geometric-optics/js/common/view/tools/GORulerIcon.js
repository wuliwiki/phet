// Copyright 2021-2022, University of Colorado Boulder

/**
 * GORulerIcon is a ruler icon that appears in the toolbox. It is associated with a specific ruler Node,
 * and forwards events to that Node.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import RulerNode from '../../../../../scenery-phet/js/RulerNode.js';
import Tandem from '../../../../../tandem/js/Tandem.js';
import geometricOptics from '../../../geometricOptics.js';
import GOToolIcon from './GOToolIcon.js';

// constants
const ICON_WIDTH = 48;
const ICON_HEIGHT = 17;
const NUMBER_OF_MAJOR_TICKS = 5;
export default class GORulerIcon extends GOToolIcon {
  /**
   * @param ruler - model element associated with this icon
   * @param rulerNode - view element associated with this icon
   * @param zoomTransformProperty - model-view transform that the user controls by zooming in/out
   */
  constructor(ruler, rulerNode, zoomTransformProperty) {
    // GOToolIconOptions
    const options = {
      rotation: ruler.orientation === 'vertical' ? -Math.PI / 2 : 0,
      touchAreaDilationX: 4,
      touchAreaDilationY: 4,
      mouseAreaDilationX: 4,
      mouseAreaDilationY: 4
    };

    // The ruler icon has no ticks labels, it would be too much detail in an icon.
    const majorTickLabels = [''];
    for (let i = 1; i < NUMBER_OF_MAJOR_TICKS; i++) {
      majorTickLabels.push('');
    }
    const majorTickWidth = ICON_WIDTH / (majorTickLabels.length - 1);

    // The ruler icon has no units, it would be too much detail in an icon.
    const units = '';
    const contentNode = new RulerNode(ICON_WIDTH, ICON_HEIGHT, majorTickWidth, majorTickLabels, units, {
      backgroundLineWidth: 0.5,
      majorTickLineWidth: 0.5,
      minorTickLineWidth: 0.25,
      minorTicksPerMajorTick: 5,
      majorTickHeight: 0.6 * ICON_HEIGHT / 2,
      minorTickHeight: 0.4 * ICON_HEIGHT / 2,
      insetsWidth: 0,
      tandem: Tandem.OPT_OUT // because RulerNode is Tandem.REQUIRED by default
    });

    const pointerPositionToToolPosition = pointerPosition => {
      const zoomTransform = zoomTransformProperty.value;
      const viewPosition = rulerNode.globalToParentPoint(pointerPosition);
      let x;
      let y;
      if (ruler.orientation === 'vertical') {
        x = viewPosition.x - rulerNode.width / 2;
        y = viewPosition.y - zoomTransform.modelToViewDeltaY(ruler.length) / 2;
      } else {
        x = viewPosition.x - zoomTransform.modelToViewDeltaX(ruler.length) / 2;
        y = viewPosition.y - rulerNode.height / 2;
      }
      return zoomTransform.viewToModelXY(x, y);
    };
    super(contentNode, ruler, rulerNode, zoomTransformProperty, pointerPositionToToolPosition, options);
  }
}
geometricOptics.register('GORulerIcon', GORulerIcon);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSdWxlck5vZGUiLCJUYW5kZW0iLCJnZW9tZXRyaWNPcHRpY3MiLCJHT1Rvb2xJY29uIiwiSUNPTl9XSURUSCIsIklDT05fSEVJR0hUIiwiTlVNQkVSX09GX01BSk9SX1RJQ0tTIiwiR09SdWxlckljb24iLCJjb25zdHJ1Y3RvciIsInJ1bGVyIiwicnVsZXJOb2RlIiwiem9vbVRyYW5zZm9ybVByb3BlcnR5Iiwib3B0aW9ucyIsInJvdGF0aW9uIiwib3JpZW50YXRpb24iLCJNYXRoIiwiUEkiLCJ0b3VjaEFyZWFEaWxhdGlvblgiLCJ0b3VjaEFyZWFEaWxhdGlvblkiLCJtb3VzZUFyZWFEaWxhdGlvblgiLCJtb3VzZUFyZWFEaWxhdGlvblkiLCJtYWpvclRpY2tMYWJlbHMiLCJpIiwicHVzaCIsIm1ham9yVGlja1dpZHRoIiwibGVuZ3RoIiwidW5pdHMiLCJjb250ZW50Tm9kZSIsImJhY2tncm91bmRMaW5lV2lkdGgiLCJtYWpvclRpY2tMaW5lV2lkdGgiLCJtaW5vclRpY2tMaW5lV2lkdGgiLCJtaW5vclRpY2tzUGVyTWFqb3JUaWNrIiwibWFqb3JUaWNrSGVpZ2h0IiwibWlub3JUaWNrSGVpZ2h0IiwiaW5zZXRzV2lkdGgiLCJ0YW5kZW0iLCJPUFRfT1VUIiwicG9pbnRlclBvc2l0aW9uVG9Ub29sUG9zaXRpb24iLCJwb2ludGVyUG9zaXRpb24iLCJ6b29tVHJhbnNmb3JtIiwidmFsdWUiLCJ2aWV3UG9zaXRpb24iLCJnbG9iYWxUb1BhcmVudFBvaW50IiwieCIsInkiLCJ3aWR0aCIsIm1vZGVsVG9WaWV3RGVsdGFZIiwibW9kZWxUb1ZpZXdEZWx0YVgiLCJoZWlnaHQiLCJ2aWV3VG9Nb2RlbFhZIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJHT1J1bGVySWNvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMS0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBHT1J1bGVySWNvbiBpcyBhIHJ1bGVyIGljb24gdGhhdCBhcHBlYXJzIGluIHRoZSB0b29sYm94LiBJdCBpcyBhc3NvY2lhdGVkIHdpdGggYSBzcGVjaWZpYyBydWxlciBOb2RlLFxyXG4gKiBhbmQgZm9yd2FyZHMgZXZlbnRzIHRvIHRoYXQgTm9kZS5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgUnVsZXJOb2RlIGZyb20gJy4uLy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9SdWxlck5vZGUuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgZ2VvbWV0cmljT3B0aWNzIGZyb20gJy4uLy4uLy4uL2dlb21ldHJpY09wdGljcy5qcyc7XHJcbmltcG9ydCBHT1J1bGVyIGZyb20gJy4uLy4uL21vZGVsL3Rvb2xzL0dPUnVsZXIuanMnO1xyXG5pbXBvcnQgR09SdWxlck5vZGUgZnJvbSAnLi9HT1J1bGVyTm9kZS5qcyc7XHJcbmltcG9ydCBHT1Rvb2xJY29uIGZyb20gJy4vR09Ub29sSWNvbi5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgSUNPTl9XSURUSCA9IDQ4O1xyXG5jb25zdCBJQ09OX0hFSUdIVCA9IDE3O1xyXG5jb25zdCBOVU1CRVJfT0ZfTUFKT1JfVElDS1MgPSA1O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR09SdWxlckljb24gZXh0ZW5kcyBHT1Rvb2xJY29uIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHJ1bGVyIC0gbW9kZWwgZWxlbWVudCBhc3NvY2lhdGVkIHdpdGggdGhpcyBpY29uXHJcbiAgICogQHBhcmFtIHJ1bGVyTm9kZSAtIHZpZXcgZWxlbWVudCBhc3NvY2lhdGVkIHdpdGggdGhpcyBpY29uXHJcbiAgICogQHBhcmFtIHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eSAtIG1vZGVsLXZpZXcgdHJhbnNmb3JtIHRoYXQgdGhlIHVzZXIgY29udHJvbHMgYnkgem9vbWluZyBpbi9vdXRcclxuICAgKi9cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHJ1bGVyOiBHT1J1bGVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcnVsZXJOb2RlOiBHT1J1bGVyTm9kZSxcclxuICAgICAgICAgICAgICAgICAgICAgIHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8TW9kZWxWaWV3VHJhbnNmb3JtMj4gKSB7XHJcblxyXG4gICAgLy8gR09Ub29sSWNvbk9wdGlvbnNcclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgIHJvdGF0aW9uOiAoIHJ1bGVyLm9yaWVudGF0aW9uID09PSAndmVydGljYWwnICkgPyAoIC1NYXRoLlBJIC8gMiApIDogMCxcclxuICAgICAgdG91Y2hBcmVhRGlsYXRpb25YOiA0LFxyXG4gICAgICB0b3VjaEFyZWFEaWxhdGlvblk6IDQsXHJcbiAgICAgIG1vdXNlQXJlYURpbGF0aW9uWDogNCxcclxuICAgICAgbW91c2VBcmVhRGlsYXRpb25ZOiA0XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFRoZSBydWxlciBpY29uIGhhcyBubyB0aWNrcyBsYWJlbHMsIGl0IHdvdWxkIGJlIHRvbyBtdWNoIGRldGFpbCBpbiBhbiBpY29uLlxyXG4gICAgY29uc3QgbWFqb3JUaWNrTGFiZWxzID0gWyAnJyBdO1xyXG4gICAgZm9yICggbGV0IGkgPSAxOyBpIDwgTlVNQkVSX09GX01BSk9SX1RJQ0tTOyBpKysgKSB7XHJcbiAgICAgIG1ham9yVGlja0xhYmVscy5wdXNoKCAnJyApO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbWFqb3JUaWNrV2lkdGggPSBJQ09OX1dJRFRIIC8gKCBtYWpvclRpY2tMYWJlbHMubGVuZ3RoIC0gMSApO1xyXG5cclxuICAgIC8vIFRoZSBydWxlciBpY29uIGhhcyBubyB1bml0cywgaXQgd291bGQgYmUgdG9vIG11Y2ggZGV0YWlsIGluIGFuIGljb24uXHJcbiAgICBjb25zdCB1bml0cyA9ICcnO1xyXG5cclxuICAgIGNvbnN0IGNvbnRlbnROb2RlID0gbmV3IFJ1bGVyTm9kZSggSUNPTl9XSURUSCwgSUNPTl9IRUlHSFQsIG1ham9yVGlja1dpZHRoLCBtYWpvclRpY2tMYWJlbHMsIHVuaXRzLCB7XHJcbiAgICAgIGJhY2tncm91bmRMaW5lV2lkdGg6IDAuNSxcclxuICAgICAgbWFqb3JUaWNrTGluZVdpZHRoOiAwLjUsXHJcbiAgICAgIG1pbm9yVGlja0xpbmVXaWR0aDogMC4yNSxcclxuICAgICAgbWlub3JUaWNrc1Blck1ham9yVGljazogNSxcclxuICAgICAgbWFqb3JUaWNrSGVpZ2h0OiAoIDAuNiAqIElDT05fSEVJR0hUICkgLyAyLFxyXG4gICAgICBtaW5vclRpY2tIZWlnaHQ6ICggMC40ICogSUNPTl9IRUlHSFQgKSAvIDIsXHJcbiAgICAgIGluc2V0c1dpZHRoOiAwLFxyXG4gICAgICB0YW5kZW06IFRhbmRlbS5PUFRfT1VUIC8vIGJlY2F1c2UgUnVsZXJOb2RlIGlzIFRhbmRlbS5SRVFVSVJFRCBieSBkZWZhdWx0XHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgcG9pbnRlclBvc2l0aW9uVG9Ub29sUG9zaXRpb24gPSAoIHBvaW50ZXJQb3NpdGlvbjogVmVjdG9yMiApID0+IHtcclxuICAgICAgY29uc3Qgem9vbVRyYW5zZm9ybSA9IHpvb21UcmFuc2Zvcm1Qcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgY29uc3Qgdmlld1Bvc2l0aW9uID0gcnVsZXJOb2RlLmdsb2JhbFRvUGFyZW50UG9pbnQoIHBvaW50ZXJQb3NpdGlvbiApO1xyXG4gICAgICBsZXQgeDtcclxuICAgICAgbGV0IHk7XHJcbiAgICAgIGlmICggcnVsZXIub3JpZW50YXRpb24gPT09ICd2ZXJ0aWNhbCcgKSB7XHJcbiAgICAgICAgeCA9IHZpZXdQb3NpdGlvbi54IC0gcnVsZXJOb2RlLndpZHRoIC8gMjtcclxuICAgICAgICB5ID0gdmlld1Bvc2l0aW9uLnkgLSB6b29tVHJhbnNmb3JtLm1vZGVsVG9WaWV3RGVsdGFZKCBydWxlci5sZW5ndGggKSAvIDI7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgeCA9IHZpZXdQb3NpdGlvbi54IC0gem9vbVRyYW5zZm9ybS5tb2RlbFRvVmlld0RlbHRhWCggcnVsZXIubGVuZ3RoICkgLyAyO1xyXG4gICAgICAgIHkgPSB2aWV3UG9zaXRpb24ueSAtIHJ1bGVyTm9kZS5oZWlnaHQgLyAyO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB6b29tVHJhbnNmb3JtLnZpZXdUb01vZGVsWFkoIHgsIHkgKTtcclxuICAgIH07XHJcblxyXG4gICAgc3VwZXIoIGNvbnRlbnROb2RlLCBydWxlciwgcnVsZXJOb2RlLCB6b29tVHJhbnNmb3JtUHJvcGVydHksIHBvaW50ZXJQb3NpdGlvblRvVG9vbFBvc2l0aW9uLCBvcHRpb25zICk7XHJcbiAgfVxyXG59XHJcblxyXG5nZW9tZXRyaWNPcHRpY3MucmVnaXN0ZXIoICdHT1J1bGVySWNvbicsIEdPUnVsZXJJY29uICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBS0EsT0FBT0EsU0FBUyxNQUFNLDZDQUE2QztBQUNuRSxPQUFPQyxNQUFNLE1BQU0sb0NBQW9DO0FBQ3ZELE9BQU9DLGVBQWUsTUFBTSw2QkFBNkI7QUFHekQsT0FBT0MsVUFBVSxNQUFNLGlCQUFpQjs7QUFFeEM7QUFDQSxNQUFNQyxVQUFVLEdBQUcsRUFBRTtBQUNyQixNQUFNQyxXQUFXLEdBQUcsRUFBRTtBQUN0QixNQUFNQyxxQkFBcUIsR0FBRyxDQUFDO0FBRS9CLGVBQWUsTUFBTUMsV0FBVyxTQUFTSixVQUFVLENBQUM7RUFFbEQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtFQUNTSyxXQUFXQSxDQUFFQyxLQUFjLEVBQ2RDLFNBQXNCLEVBQ3RCQyxxQkFBNkQsRUFBRztJQUVsRjtJQUNBLE1BQU1DLE9BQU8sR0FBRztNQUNkQyxRQUFRLEVBQUlKLEtBQUssQ0FBQ0ssV0FBVyxLQUFLLFVBQVUsR0FBTyxDQUFDQyxJQUFJLENBQUNDLEVBQUUsR0FBRyxDQUFDLEdBQUssQ0FBQztNQUNyRUMsa0JBQWtCLEVBQUUsQ0FBQztNQUNyQkMsa0JBQWtCLEVBQUUsQ0FBQztNQUNyQkMsa0JBQWtCLEVBQUUsQ0FBQztNQUNyQkMsa0JBQWtCLEVBQUU7SUFDdEIsQ0FBQzs7SUFFRDtJQUNBLE1BQU1DLGVBQWUsR0FBRyxDQUFFLEVBQUUsQ0FBRTtJQUM5QixLQUFNLElBQUlDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR2hCLHFCQUFxQixFQUFFZ0IsQ0FBQyxFQUFFLEVBQUc7TUFDaERELGVBQWUsQ0FBQ0UsSUFBSSxDQUFFLEVBQUcsQ0FBQztJQUM1QjtJQUNBLE1BQU1DLGNBQWMsR0FBR3BCLFVBQVUsSUFBS2lCLGVBQWUsQ0FBQ0ksTUFBTSxHQUFHLENBQUMsQ0FBRTs7SUFFbEU7SUFDQSxNQUFNQyxLQUFLLEdBQUcsRUFBRTtJQUVoQixNQUFNQyxXQUFXLEdBQUcsSUFBSTNCLFNBQVMsQ0FBRUksVUFBVSxFQUFFQyxXQUFXLEVBQUVtQixjQUFjLEVBQUVILGVBQWUsRUFBRUssS0FBSyxFQUFFO01BQ2xHRSxtQkFBbUIsRUFBRSxHQUFHO01BQ3hCQyxrQkFBa0IsRUFBRSxHQUFHO01BQ3ZCQyxrQkFBa0IsRUFBRSxJQUFJO01BQ3hCQyxzQkFBc0IsRUFBRSxDQUFDO01BQ3pCQyxlQUFlLEVBQUksR0FBRyxHQUFHM0IsV0FBVyxHQUFLLENBQUM7TUFDMUM0QixlQUFlLEVBQUksR0FBRyxHQUFHNUIsV0FBVyxHQUFLLENBQUM7TUFDMUM2QixXQUFXLEVBQUUsQ0FBQztNQUNkQyxNQUFNLEVBQUVsQyxNQUFNLENBQUNtQyxPQUFPLENBQUM7SUFDekIsQ0FBRSxDQUFDOztJQUVILE1BQU1DLDZCQUE2QixHQUFLQyxlQUF3QixJQUFNO01BQ3BFLE1BQU1DLGFBQWEsR0FBRzVCLHFCQUFxQixDQUFDNkIsS0FBSztNQUNqRCxNQUFNQyxZQUFZLEdBQUcvQixTQUFTLENBQUNnQyxtQkFBbUIsQ0FBRUosZUFBZ0IsQ0FBQztNQUNyRSxJQUFJSyxDQUFDO01BQ0wsSUFBSUMsQ0FBQztNQUNMLElBQUtuQyxLQUFLLENBQUNLLFdBQVcsS0FBSyxVQUFVLEVBQUc7UUFDdEM2QixDQUFDLEdBQUdGLFlBQVksQ0FBQ0UsQ0FBQyxHQUFHakMsU0FBUyxDQUFDbUMsS0FBSyxHQUFHLENBQUM7UUFDeENELENBQUMsR0FBR0gsWUFBWSxDQUFDRyxDQUFDLEdBQUdMLGFBQWEsQ0FBQ08saUJBQWlCLENBQUVyQyxLQUFLLENBQUNnQixNQUFPLENBQUMsR0FBRyxDQUFDO01BQzFFLENBQUMsTUFDSTtRQUNIa0IsQ0FBQyxHQUFHRixZQUFZLENBQUNFLENBQUMsR0FBR0osYUFBYSxDQUFDUSxpQkFBaUIsQ0FBRXRDLEtBQUssQ0FBQ2dCLE1BQU8sQ0FBQyxHQUFHLENBQUM7UUFDeEVtQixDQUFDLEdBQUdILFlBQVksQ0FBQ0csQ0FBQyxHQUFHbEMsU0FBUyxDQUFDc0MsTUFBTSxHQUFHLENBQUM7TUFDM0M7TUFDQSxPQUFPVCxhQUFhLENBQUNVLGFBQWEsQ0FBRU4sQ0FBQyxFQUFFQyxDQUFFLENBQUM7SUFDNUMsQ0FBQztJQUVELEtBQUssQ0FBRWpCLFdBQVcsRUFBRWxCLEtBQUssRUFBRUMsU0FBUyxFQUFFQyxxQkFBcUIsRUFBRTBCLDZCQUE2QixFQUFFekIsT0FBUSxDQUFDO0VBQ3ZHO0FBQ0Y7QUFFQVYsZUFBZSxDQUFDZ0QsUUFBUSxDQUFFLGFBQWEsRUFBRTNDLFdBQVksQ0FBQyJ9