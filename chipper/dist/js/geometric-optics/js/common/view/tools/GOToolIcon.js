// Copyright 2022, University of Colorado Boulder

/**
 * GOToolIcon is the abstract base class for icons that appear in the toolbox.
 * An icon is associated with a specific tool Node, and forwards events to that Node.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Vector2 from '../../../../../dot/js/Vector2.js';
import optionize from '../../../../../phet-core/js/optionize.js';
import { DragListener, InteractiveHighlighting, Node } from '../../../../../scenery/js/imports.js';
import geometricOptics from '../../../geometricOptics.js';
export default class GOToolIcon extends InteractiveHighlighting(Node) {
  /**
   * @param contentNode - the icon's content, what it looks like
   * @param tool - model element
   * @param toolNode - view element
   * @param zoomTransformProperty - model-view transform that the user controls by zooming in/out
   * @param pointerPositionToToolPosition - given the pointer position, determine the tool's model position
   * @param providedOptions
   */
  constructor(contentNode, tool, toolNode, zoomTransformProperty, pointerPositionToToolPosition, providedOptions) {
    const options = optionize()({
      // pointer areas
      touchAreaDilationX: 5,
      touchAreaDilationY: 5,
      mouseAreaDilationX: 5,
      mouseAreaDilationY: 5,
      // NodeOptions
      children: [contentNode],
      cursor: 'pointer',
      tagName: 'button'
    }, providedOptions);
    super(options);

    // pointer areas
    this.touchArea = this.localBounds.dilatedXY(options.touchAreaDilationX, options.touchAreaDilationY);
    this.mouseArea = this.localBounds.dilatedXY(options.mouseAreaDilationX, options.mouseAreaDilationY);
    tool.isInToolboxProperty.link(isInToolbox => {
      this.visible = isInToolbox;
    });

    // Dragging with mouse/touch. Drag events are forwarded from the icon to its associated tool Node.
    this.addInputListener(DragListener.createForwardingListener(event => {
      // Take the tool out of the toolbox.
      tool.isInToolboxProperty.value = false;

      // Set the position of the tool.
      tool.positionProperty.value = pointerPositionToToolPosition(event.pointer.point);

      // Forward the event to toolNode.
      toolNode.startDrag(event);
    }));

    // When the icon is clicked via the keyboard, take the tool out of the toolbox, and place it at the model origin.
    this.addInputListener({
      click: () => {
        tool.isInToolboxProperty.value = false;
        tool.positionProperty.value = Vector2.ZERO;
        toolNode.focus();
      }
    });
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
}
geometricOptics.register('GOToolIcon', GOToolIcon);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWZWN0b3IyIiwib3B0aW9uaXplIiwiRHJhZ0xpc3RlbmVyIiwiSW50ZXJhY3RpdmVIaWdobGlnaHRpbmciLCJOb2RlIiwiZ2VvbWV0cmljT3B0aWNzIiwiR09Ub29sSWNvbiIsImNvbnN0cnVjdG9yIiwiY29udGVudE5vZGUiLCJ0b29sIiwidG9vbE5vZGUiLCJ6b29tVHJhbnNmb3JtUHJvcGVydHkiLCJwb2ludGVyUG9zaXRpb25Ub1Rvb2xQb3NpdGlvbiIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJ0b3VjaEFyZWFEaWxhdGlvblgiLCJ0b3VjaEFyZWFEaWxhdGlvblkiLCJtb3VzZUFyZWFEaWxhdGlvblgiLCJtb3VzZUFyZWFEaWxhdGlvblkiLCJjaGlsZHJlbiIsImN1cnNvciIsInRhZ05hbWUiLCJ0b3VjaEFyZWEiLCJsb2NhbEJvdW5kcyIsImRpbGF0ZWRYWSIsIm1vdXNlQXJlYSIsImlzSW5Ub29sYm94UHJvcGVydHkiLCJsaW5rIiwiaXNJblRvb2xib3giLCJ2aXNpYmxlIiwiYWRkSW5wdXRMaXN0ZW5lciIsImNyZWF0ZUZvcndhcmRpbmdMaXN0ZW5lciIsImV2ZW50IiwidmFsdWUiLCJwb3NpdGlvblByb3BlcnR5IiwicG9pbnRlciIsInBvaW50Iiwic3RhcnREcmFnIiwiY2xpY2siLCJaRVJPIiwiZm9jdXMiLCJkaXNwb3NlIiwiYXNzZXJ0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJHT1Rvb2xJY29uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBHT1Rvb2xJY29uIGlzIHRoZSBhYnN0cmFjdCBiYXNlIGNsYXNzIGZvciBpY29ucyB0aGF0IGFwcGVhciBpbiB0aGUgdG9vbGJveC5cclxuICogQW4gaWNvbiBpcyBhc3NvY2lhdGVkIHdpdGggYSBzcGVjaWZpYyB0b29sIE5vZGUsIGFuZCBmb3J3YXJkcyBldmVudHMgdG8gdGhhdCBOb2RlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgTW9kZWxWaWV3VHJhbnNmb3JtMiBmcm9tICcuLi8uLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3ZpZXcvTW9kZWxWaWV3VHJhbnNmb3JtMi5qcyc7XHJcbmltcG9ydCB7IERyYWdMaXN0ZW5lciwgSW50ZXJhY3RpdmVIaWdobGlnaHRpbmcsIE5vZGUsIE5vZGVPcHRpb25zLCBQcmVzc0xpc3RlbmVyRXZlbnQgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgZ2VvbWV0cmljT3B0aWNzIGZyb20gJy4uLy4uLy4uL2dlb21ldHJpY09wdGljcy5qcyc7XHJcbmltcG9ydCBHT1Rvb2wgZnJvbSAnLi4vLi4vbW9kZWwvdG9vbHMvR09Ub29sLmpzJztcclxuaW1wb3J0IEdPVG9vbE5vZGUgZnJvbSAnLi9HT1Rvb2xOb2RlLmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgdG91Y2hBcmVhRGlsYXRpb25YPzogbnVtYmVyO1xyXG4gIHRvdWNoQXJlYURpbGF0aW9uWT86IG51bWJlcjtcclxuICBtb3VzZUFyZWFEaWxhdGlvblg/OiBudW1iZXI7XHJcbiAgbW91c2VBcmVhRGlsYXRpb25ZPzogbnVtYmVyO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgR09Ub29sSWNvbk9wdGlvbnMgPSBTZWxmT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFic3RyYWN0IGNsYXNzIEdPVG9vbEljb24gZXh0ZW5kcyBJbnRlcmFjdGl2ZUhpZ2hsaWdodGluZyggTm9kZSApIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIGNvbnRlbnROb2RlIC0gdGhlIGljb24ncyBjb250ZW50LCB3aGF0IGl0IGxvb2tzIGxpa2VcclxuICAgKiBAcGFyYW0gdG9vbCAtIG1vZGVsIGVsZW1lbnRcclxuICAgKiBAcGFyYW0gdG9vbE5vZGUgLSB2aWV3IGVsZW1lbnRcclxuICAgKiBAcGFyYW0gem9vbVRyYW5zZm9ybVByb3BlcnR5IC0gbW9kZWwtdmlldyB0cmFuc2Zvcm0gdGhhdCB0aGUgdXNlciBjb250cm9scyBieSB6b29taW5nIGluL291dFxyXG4gICAqIEBwYXJhbSBwb2ludGVyUG9zaXRpb25Ub1Rvb2xQb3NpdGlvbiAtIGdpdmVuIHRoZSBwb2ludGVyIHBvc2l0aW9uLCBkZXRlcm1pbmUgdGhlIHRvb2wncyBtb2RlbCBwb3NpdGlvblxyXG4gICAqIEBwYXJhbSBwcm92aWRlZE9wdGlvbnNcclxuICAgKi9cclxuICBwcm90ZWN0ZWQgY29uc3RydWN0b3IoIGNvbnRlbnROb2RlOiBOb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgdG9vbDogR09Ub29sLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgdG9vbE5vZGU6IEdPVG9vbE5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICB6b29tVHJhbnNmb3JtUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PE1vZGVsVmlld1RyYW5zZm9ybTI+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlclBvc2l0aW9uVG9Ub29sUG9zaXRpb246ICggcG9pbnRlclBvc2l0aW9uOiBWZWN0b3IyICkgPT4gVmVjdG9yMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVkT3B0aW9uczogR09Ub29sSWNvbk9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxHT1Rvb2xJY29uT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBwb2ludGVyIGFyZWFzXHJcbiAgICAgIHRvdWNoQXJlYURpbGF0aW9uWDogNSxcclxuICAgICAgdG91Y2hBcmVhRGlsYXRpb25ZOiA1LFxyXG4gICAgICBtb3VzZUFyZWFEaWxhdGlvblg6IDUsXHJcbiAgICAgIG1vdXNlQXJlYURpbGF0aW9uWTogNSxcclxuXHJcbiAgICAgIC8vIE5vZGVPcHRpb25zXHJcbiAgICAgIGNoaWxkcmVuOiBbIGNvbnRlbnROb2RlIF0sXHJcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG4gICAgICB0YWdOYW1lOiAnYnV0dG9uJ1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBwb2ludGVyIGFyZWFzXHJcbiAgICB0aGlzLnRvdWNoQXJlYSA9IHRoaXMubG9jYWxCb3VuZHMuZGlsYXRlZFhZKCBvcHRpb25zLnRvdWNoQXJlYURpbGF0aW9uWCwgb3B0aW9ucy50b3VjaEFyZWFEaWxhdGlvblkgKTtcclxuICAgIHRoaXMubW91c2VBcmVhID0gdGhpcy5sb2NhbEJvdW5kcy5kaWxhdGVkWFkoIG9wdGlvbnMubW91c2VBcmVhRGlsYXRpb25YLCBvcHRpb25zLm1vdXNlQXJlYURpbGF0aW9uWSApO1xyXG5cclxuICAgIHRvb2wuaXNJblRvb2xib3hQcm9wZXJ0eS5saW5rKCBpc0luVG9vbGJveCA9PiB7XHJcbiAgICAgIHRoaXMudmlzaWJsZSA9IGlzSW5Ub29sYm94O1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIERyYWdnaW5nIHdpdGggbW91c2UvdG91Y2guIERyYWcgZXZlbnRzIGFyZSBmb3J3YXJkZWQgZnJvbSB0aGUgaWNvbiB0byBpdHMgYXNzb2NpYXRlZCB0b29sIE5vZGUuXHJcbiAgICB0aGlzLmFkZElucHV0TGlzdGVuZXIoIERyYWdMaXN0ZW5lci5jcmVhdGVGb3J3YXJkaW5nTGlzdGVuZXIoICggZXZlbnQ6IFByZXNzTGlzdGVuZXJFdmVudCApID0+IHtcclxuXHJcbiAgICAgIC8vIFRha2UgdGhlIHRvb2wgb3V0IG9mIHRoZSB0b29sYm94LlxyXG4gICAgICB0b29sLmlzSW5Ub29sYm94UHJvcGVydHkudmFsdWUgPSBmYWxzZTtcclxuXHJcbiAgICAgIC8vIFNldCB0aGUgcG9zaXRpb24gb2YgdGhlIHRvb2wuXHJcbiAgICAgIHRvb2wucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZSA9IHBvaW50ZXJQb3NpdGlvblRvVG9vbFBvc2l0aW9uKCBldmVudC5wb2ludGVyLnBvaW50ICk7XHJcblxyXG4gICAgICAvLyBGb3J3YXJkIHRoZSBldmVudCB0byB0b29sTm9kZS5cclxuICAgICAgdG9vbE5vZGUuc3RhcnREcmFnKCBldmVudCApO1xyXG4gICAgfSApICk7XHJcblxyXG4gICAgLy8gV2hlbiB0aGUgaWNvbiBpcyBjbGlja2VkIHZpYSB0aGUga2V5Ym9hcmQsIHRha2UgdGhlIHRvb2wgb3V0IG9mIHRoZSB0b29sYm94LCBhbmQgcGxhY2UgaXQgYXQgdGhlIG1vZGVsIG9yaWdpbi5cclxuICAgIHRoaXMuYWRkSW5wdXRMaXN0ZW5lcigge1xyXG4gICAgICBjbGljazogKCkgPT4ge1xyXG4gICAgICAgIHRvb2wuaXNJblRvb2xib3hQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRvb2wucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZSA9IFZlY3RvcjIuWkVSTztcclxuICAgICAgICB0b29sTm9kZS5mb2N1cygpO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZ2VvbWV0cmljT3B0aWNzLnJlZ2lzdGVyKCAnR09Ub29sSWNvbicsIEdPVG9vbEljb24gKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQSxPQUFPQSxPQUFPLE1BQU0sa0NBQWtDO0FBQ3RELE9BQU9DLFNBQVMsTUFBTSwwQ0FBMEM7QUFFaEUsU0FBU0MsWUFBWSxFQUFFQyx1QkFBdUIsRUFBRUMsSUFBSSxRQUF5QyxzQ0FBc0M7QUFDbkksT0FBT0MsZUFBZSxNQUFNLDZCQUE2QjtBQWF6RCxlQUFlLE1BQWVDLFVBQVUsU0FBU0gsdUJBQXVCLENBQUVDLElBQUssQ0FBQyxDQUFDO0VBRS9FO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDWUcsV0FBV0EsQ0FBRUMsV0FBaUIsRUFDakJDLElBQVksRUFDWkMsUUFBb0IsRUFDcEJDLHFCQUE2RCxFQUM3REMsNkJBQXNFLEVBQ3RFQyxlQUFrQyxFQUFHO0lBRTFELE1BQU1DLE9BQU8sR0FBR2IsU0FBUyxDQUE4QyxDQUFDLENBQUU7TUFFeEU7TUFDQWMsa0JBQWtCLEVBQUUsQ0FBQztNQUNyQkMsa0JBQWtCLEVBQUUsQ0FBQztNQUNyQkMsa0JBQWtCLEVBQUUsQ0FBQztNQUNyQkMsa0JBQWtCLEVBQUUsQ0FBQztNQUVyQjtNQUNBQyxRQUFRLEVBQUUsQ0FBRVgsV0FBVyxDQUFFO01BQ3pCWSxNQUFNLEVBQUUsU0FBUztNQUNqQkMsT0FBTyxFQUFFO0lBQ1gsQ0FBQyxFQUFFUixlQUFnQixDQUFDO0lBRXBCLEtBQUssQ0FBRUMsT0FBUSxDQUFDOztJQUVoQjtJQUNBLElBQUksQ0FBQ1EsU0FBUyxHQUFHLElBQUksQ0FBQ0MsV0FBVyxDQUFDQyxTQUFTLENBQUVWLE9BQU8sQ0FBQ0Msa0JBQWtCLEVBQUVELE9BQU8sQ0FBQ0Usa0JBQW1CLENBQUM7SUFDckcsSUFBSSxDQUFDUyxTQUFTLEdBQUcsSUFBSSxDQUFDRixXQUFXLENBQUNDLFNBQVMsQ0FBRVYsT0FBTyxDQUFDRyxrQkFBa0IsRUFBRUgsT0FBTyxDQUFDSSxrQkFBbUIsQ0FBQztJQUVyR1QsSUFBSSxDQUFDaUIsbUJBQW1CLENBQUNDLElBQUksQ0FBRUMsV0FBVyxJQUFJO01BQzVDLElBQUksQ0FBQ0MsT0FBTyxHQUFHRCxXQUFXO0lBQzVCLENBQUUsQ0FBQzs7SUFFSDtJQUNBLElBQUksQ0FBQ0UsZ0JBQWdCLENBQUU1QixZQUFZLENBQUM2Qix3QkFBd0IsQ0FBSUMsS0FBeUIsSUFBTTtNQUU3RjtNQUNBdkIsSUFBSSxDQUFDaUIsbUJBQW1CLENBQUNPLEtBQUssR0FBRyxLQUFLOztNQUV0QztNQUNBeEIsSUFBSSxDQUFDeUIsZ0JBQWdCLENBQUNELEtBQUssR0FBR3JCLDZCQUE2QixDQUFFb0IsS0FBSyxDQUFDRyxPQUFPLENBQUNDLEtBQU0sQ0FBQzs7TUFFbEY7TUFDQTFCLFFBQVEsQ0FBQzJCLFNBQVMsQ0FBRUwsS0FBTSxDQUFDO0lBQzdCLENBQUUsQ0FBRSxDQUFDOztJQUVMO0lBQ0EsSUFBSSxDQUFDRixnQkFBZ0IsQ0FBRTtNQUNyQlEsS0FBSyxFQUFFQSxDQUFBLEtBQU07UUFDWDdCLElBQUksQ0FBQ2lCLG1CQUFtQixDQUFDTyxLQUFLLEdBQUcsS0FBSztRQUN0Q3hCLElBQUksQ0FBQ3lCLGdCQUFnQixDQUFDRCxLQUFLLEdBQUdqQyxPQUFPLENBQUN1QyxJQUFJO1FBQzFDN0IsUUFBUSxDQUFDOEIsS0FBSyxDQUFDLENBQUM7TUFDbEI7SUFDRixDQUFFLENBQUM7RUFDTDtFQUVnQkMsT0FBT0EsQ0FBQSxFQUFTO0lBQzlCQyxNQUFNLElBQUlBLE1BQU0sQ0FBRSxLQUFLLEVBQUUsOERBQStELENBQUM7SUFDekYsS0FBSyxDQUFDRCxPQUFPLENBQUMsQ0FBQztFQUNqQjtBQUNGO0FBRUFwQyxlQUFlLENBQUNzQyxRQUFRLENBQUUsWUFBWSxFQUFFckMsVUFBVyxDQUFDIn0=