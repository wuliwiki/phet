// Copyright 2022, University of Colorado Boulder

/**
 * RealLightRaysForegroundNode is a subclass of RealLightRaysNode that (using clipArea) renders the parts of RealLightRaysNode
 * that are in front of a real framed image, which has 3D perspective. It is intended to be used in
 * FramedSceneNode, where it is layered in front of the real image Node in the scene graph.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import RealLightRaysNode from './RealLightRaysNode.js';
import geometricOptics from '../../geometricOptics.js';
import GOQueryParameters from '../GOQueryParameters.js';
import { Shape } from '../../../../kite/js/imports.js';
import { Path } from '../../../../scenery/js/imports.js';
import { optionize3 } from '../../../../phet-core/js/optionize.js';
export default class RealLightRaysForegroundNode extends RealLightRaysNode {
  /**
   * @param lightRays - model element
   * @param modelViewTransform
   * @param modelVisibleBoundsProperty - ScreenView's visibleBounds in the model coordinate frame, with the zoom transform applied
   * @param opticPositionProperty - position of the optic
   * @param framedImagePositionProperty - position of the optical object
   * @param opticalImageTypeProperty - type of optical image (real or virtual)
   * @param providedOptions
   */
  constructor(lightRays, modelViewTransform, modelVisibleBoundsProperty, opticPositionProperty, framedImagePositionProperty, opticalImageTypeProperty, providedOptions) {
    const options = optionize3()({}, providedOptions, {
      stroke: GOQueryParameters.debugRays ? 'red' : providedOptions.stroke
    });
    super(lightRays, modelViewTransform, options);

    // Show the clipArea.
    let clipAreaNode;
    if (GOQueryParameters.debugRays) {
      clipAreaNode = new Path(null, {
        stroke: 'red'
      });
      this.addChild(clipAreaNode);
    }

    // Update the clipArea, to make rays look like they pass through a real Image.
    // This shows only the parts of this Node that are in the foreground, i.e. not occluded by other things.
    // Run with ?debugRays to see the clipArea rendered as a rectangle.
    const updateClipArea = () => {
      let clipArea; // in view coordinates

      if (opticalImageTypeProperty.value === 'virtual') {
        // virtual image
        clipArea = null;
      } else {
        // real image
        const opticPosition = opticPositionProperty.value;
        const framedImagePosition = framedImagePositionProperty.value;
        const viewVisibleBounds = modelViewTransform.modelToViewBounds(modelVisibleBoundsProperty.value);
        let minX;
        let maxX;
        if (framedImagePosition.x > opticPosition.x) {
          // For a real Image to the right of the optic, the clipArea is everything to the left of the Image,
          // because the Image is facing left in perspective.
          minX = viewVisibleBounds.minX;
          maxX = modelViewTransform.modelToViewX(framedImagePosition.x);
        } else {
          // For a real Image to the left of the optic, the clipArea is everything to the right of the Image,
          // because the Image is facing right in perspective.
          minX = modelViewTransform.modelToViewX(framedImagePosition.x);
          maxX = viewVisibleBounds.maxX;
        }
        clipArea = Shape.rectangle(minX, viewVisibleBounds.minY, maxX - minX, viewVisibleBounds.height);
      }
      this.clipArea = clipArea;
      if (clipAreaNode) {
        clipAreaNode.shape = clipArea;
      }
    };
    lightRays.raysProcessedEmitter.addListener(() => {
      if (this.visible) {
        updateClipArea();
      }
    });
    this.visibleProperty.link(visible => {
      if (visible) {
        updateClipArea();
      }
    });
  }
}
geometricOptics.register('RealLightRaysForegroundNode', RealLightRaysForegroundNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFsTGlnaHRSYXlzTm9kZSIsImdlb21ldHJpY09wdGljcyIsIkdPUXVlcnlQYXJhbWV0ZXJzIiwiU2hhcGUiLCJQYXRoIiwib3B0aW9uaXplMyIsIlJlYWxMaWdodFJheXNGb3JlZ3JvdW5kTm9kZSIsImNvbnN0cnVjdG9yIiwibGlnaHRSYXlzIiwibW9kZWxWaWV3VHJhbnNmb3JtIiwibW9kZWxWaXNpYmxlQm91bmRzUHJvcGVydHkiLCJvcHRpY1Bvc2l0aW9uUHJvcGVydHkiLCJmcmFtZWRJbWFnZVBvc2l0aW9uUHJvcGVydHkiLCJvcHRpY2FsSW1hZ2VUeXBlUHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwic3Ryb2tlIiwiZGVidWdSYXlzIiwiY2xpcEFyZWFOb2RlIiwiYWRkQ2hpbGQiLCJ1cGRhdGVDbGlwQXJlYSIsImNsaXBBcmVhIiwidmFsdWUiLCJvcHRpY1Bvc2l0aW9uIiwiZnJhbWVkSW1hZ2VQb3NpdGlvbiIsInZpZXdWaXNpYmxlQm91bmRzIiwibW9kZWxUb1ZpZXdCb3VuZHMiLCJtaW5YIiwibWF4WCIsIngiLCJtb2RlbFRvVmlld1giLCJyZWN0YW5nbGUiLCJtaW5ZIiwiaGVpZ2h0Iiwic2hhcGUiLCJyYXlzUHJvY2Vzc2VkRW1pdHRlciIsImFkZExpc3RlbmVyIiwidmlzaWJsZSIsInZpc2libGVQcm9wZXJ0eSIsImxpbmsiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlJlYWxMaWdodFJheXNGb3JlZ3JvdW5kTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogUmVhbExpZ2h0UmF5c0ZvcmVncm91bmROb2RlIGlzIGEgc3ViY2xhc3Mgb2YgUmVhbExpZ2h0UmF5c05vZGUgdGhhdCAodXNpbmcgY2xpcEFyZWEpIHJlbmRlcnMgdGhlIHBhcnRzIG9mIFJlYWxMaWdodFJheXNOb2RlXHJcbiAqIHRoYXQgYXJlIGluIGZyb250IG9mIGEgcmVhbCBmcmFtZWQgaW1hZ2UsIHdoaWNoIGhhcyAzRCBwZXJzcGVjdGl2ZS4gSXQgaXMgaW50ZW5kZWQgdG8gYmUgdXNlZCBpblxyXG4gKiBGcmFtZWRTY2VuZU5vZGUsIHdoZXJlIGl0IGlzIGxheWVyZWQgaW4gZnJvbnQgb2YgdGhlIHJlYWwgaW1hZ2UgTm9kZSBpbiB0aGUgc2NlbmUgZ3JhcGguXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IFJlYWxMaWdodFJheXNOb2RlLCB7IFJlYWxMaWdodFJheXNOb2RlT3B0aW9ucyB9IGZyb20gJy4vUmVhbExpZ2h0UmF5c05vZGUuanMnO1xyXG5pbXBvcnQgZ2VvbWV0cmljT3B0aWNzIGZyb20gJy4uLy4uL2dlb21ldHJpY09wdGljcy5qcyc7XHJcbmltcG9ydCBMaWdodFJheXMgZnJvbSAnLi4vbW9kZWwvTGlnaHRSYXlzLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgTW9kZWxWaWV3VHJhbnNmb3JtMiBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3ZpZXcvTW9kZWxWaWV3VHJhbnNmb3JtMi5qcyc7XHJcbmltcG9ydCBHT1F1ZXJ5UGFyYW1ldGVycyBmcm9tICcuLi9HT1F1ZXJ5UGFyYW1ldGVycy5qcyc7XHJcbmltcG9ydCBCb3VuZHMyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9Cb3VuZHMyLmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCB7IFBhdGggfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgeyBPcHRpY2FsSW1hZ2VUeXBlIH0gZnJvbSAnLi4vbW9kZWwvT3B0aWNhbEltYWdlVHlwZS5qcyc7XHJcbmltcG9ydCB7IEVtcHR5U2VsZk9wdGlvbnMsIG9wdGlvbml6ZTMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBFbXB0eVNlbGZPcHRpb25zO1xyXG5cclxudHlwZSBSZWFsTGlnaHRSYXlzRm9yZWdyb3VuZE5vZGVPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBSZWFsTGlnaHRSYXlzTm9kZU9wdGlvbnM7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZWFsTGlnaHRSYXlzRm9yZWdyb3VuZE5vZGUgZXh0ZW5kcyBSZWFsTGlnaHRSYXlzTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBsaWdodFJheXMgLSBtb2RlbCBlbGVtZW50XHJcbiAgICogQHBhcmFtIG1vZGVsVmlld1RyYW5zZm9ybVxyXG4gICAqIEBwYXJhbSBtb2RlbFZpc2libGVCb3VuZHNQcm9wZXJ0eSAtIFNjcmVlblZpZXcncyB2aXNpYmxlQm91bmRzIGluIHRoZSBtb2RlbCBjb29yZGluYXRlIGZyYW1lLCB3aXRoIHRoZSB6b29tIHRyYW5zZm9ybSBhcHBsaWVkXHJcbiAgICogQHBhcmFtIG9wdGljUG9zaXRpb25Qcm9wZXJ0eSAtIHBvc2l0aW9uIG9mIHRoZSBvcHRpY1xyXG4gICAqIEBwYXJhbSBmcmFtZWRJbWFnZVBvc2l0aW9uUHJvcGVydHkgLSBwb3NpdGlvbiBvZiB0aGUgb3B0aWNhbCBvYmplY3RcclxuICAgKiBAcGFyYW0gb3B0aWNhbEltYWdlVHlwZVByb3BlcnR5IC0gdHlwZSBvZiBvcHRpY2FsIGltYWdlIChyZWFsIG9yIHZpcnR1YWwpXHJcbiAgICogQHBhcmFtIHByb3ZpZGVkT3B0aW9uc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggbGlnaHRSYXlzOiBMaWdodFJheXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICBtb2RlbFZpZXdUcmFuc2Zvcm06IE1vZGVsVmlld1RyYW5zZm9ybTIsXHJcbiAgICAgICAgICAgICAgICAgICAgICBtb2RlbFZpc2libGVCb3VuZHNQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Qm91bmRzMj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBvcHRpY1Bvc2l0aW9uUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFZlY3RvcjI+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgZnJhbWVkSW1hZ2VQb3NpdGlvblByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxWZWN0b3IyPixcclxuICAgICAgICAgICAgICAgICAgICAgIG9wdGljYWxJbWFnZVR5cGVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8T3B0aWNhbEltYWdlVHlwZT4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM6IFJlYWxMaWdodFJheXNGb3JlZ3JvdW5kTm9kZU9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTM8UmVhbExpZ2h0UmF5c0ZvcmVncm91bmROb2RlT3B0aW9ucywgU2VsZk9wdGlvbnMsIFJlYWxMaWdodFJheXNOb2RlT3B0aW9ucz4oKSgge30sXHJcbiAgICAgIHByb3ZpZGVkT3B0aW9ucywge1xyXG4gICAgICAgIHN0cm9rZTogKCBHT1F1ZXJ5UGFyYW1ldGVycy5kZWJ1Z1JheXMgKSA/ICdyZWQnIDogcHJvdmlkZWRPcHRpb25zLnN0cm9rZVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgc3VwZXIoIGxpZ2h0UmF5cywgbW9kZWxWaWV3VHJhbnNmb3JtLCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gU2hvdyB0aGUgY2xpcEFyZWEuXHJcbiAgICBsZXQgY2xpcEFyZWFOb2RlOiBQYXRoO1xyXG4gICAgaWYgKCBHT1F1ZXJ5UGFyYW1ldGVycy5kZWJ1Z1JheXMgKSB7XHJcbiAgICAgIGNsaXBBcmVhTm9kZSA9IG5ldyBQYXRoKCBudWxsLCB7XHJcbiAgICAgICAgc3Ryb2tlOiAncmVkJ1xyXG4gICAgICB9ICk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIGNsaXBBcmVhTm9kZSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgY2xpcEFyZWEsIHRvIG1ha2UgcmF5cyBsb29rIGxpa2UgdGhleSBwYXNzIHRocm91Z2ggYSByZWFsIEltYWdlLlxyXG4gICAgLy8gVGhpcyBzaG93cyBvbmx5IHRoZSBwYXJ0cyBvZiB0aGlzIE5vZGUgdGhhdCBhcmUgaW4gdGhlIGZvcmVncm91bmQsIGkuZS4gbm90IG9jY2x1ZGVkIGJ5IG90aGVyIHRoaW5ncy5cclxuICAgIC8vIFJ1biB3aXRoID9kZWJ1Z1JheXMgdG8gc2VlIHRoZSBjbGlwQXJlYSByZW5kZXJlZCBhcyBhIHJlY3RhbmdsZS5cclxuICAgIGNvbnN0IHVwZGF0ZUNsaXBBcmVhID0gKCkgPT4ge1xyXG4gICAgICBsZXQgY2xpcEFyZWE6IFNoYXBlIHwgbnVsbDsgLy8gaW4gdmlldyBjb29yZGluYXRlc1xyXG5cclxuICAgICAgaWYgKCBvcHRpY2FsSW1hZ2VUeXBlUHJvcGVydHkudmFsdWUgPT09ICd2aXJ0dWFsJyApIHtcclxuXHJcbiAgICAgICAgLy8gdmlydHVhbCBpbWFnZVxyXG4gICAgICAgIGNsaXBBcmVhID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgLy8gcmVhbCBpbWFnZVxyXG4gICAgICAgIGNvbnN0IG9wdGljUG9zaXRpb24gPSBvcHRpY1Bvc2l0aW9uUHJvcGVydHkudmFsdWU7XHJcbiAgICAgICAgY29uc3QgZnJhbWVkSW1hZ2VQb3NpdGlvbiA9IGZyYW1lZEltYWdlUG9zaXRpb25Qcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb25zdCB2aWV3VmlzaWJsZUJvdW5kcyA9IG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld0JvdW5kcyggbW9kZWxWaXNpYmxlQm91bmRzUHJvcGVydHkudmFsdWUgKTtcclxuXHJcbiAgICAgICAgbGV0IG1pblg6IG51bWJlcjtcclxuICAgICAgICBsZXQgbWF4WDogbnVtYmVyO1xyXG4gICAgICAgIGlmICggZnJhbWVkSW1hZ2VQb3NpdGlvbi54ID4gb3B0aWNQb3NpdGlvbi54ICkge1xyXG5cclxuICAgICAgICAgIC8vIEZvciBhIHJlYWwgSW1hZ2UgdG8gdGhlIHJpZ2h0IG9mIHRoZSBvcHRpYywgdGhlIGNsaXBBcmVhIGlzIGV2ZXJ5dGhpbmcgdG8gdGhlIGxlZnQgb2YgdGhlIEltYWdlLFxyXG4gICAgICAgICAgLy8gYmVjYXVzZSB0aGUgSW1hZ2UgaXMgZmFjaW5nIGxlZnQgaW4gcGVyc3BlY3RpdmUuXHJcbiAgICAgICAgICBtaW5YID0gdmlld1Zpc2libGVCb3VuZHMubWluWDtcclxuICAgICAgICAgIG1heFggPSBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdYKCBmcmFtZWRJbWFnZVBvc2l0aW9uLnggKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgICAgLy8gRm9yIGEgcmVhbCBJbWFnZSB0byB0aGUgbGVmdCBvZiB0aGUgb3B0aWMsIHRoZSBjbGlwQXJlYSBpcyBldmVyeXRoaW5nIHRvIHRoZSByaWdodCBvZiB0aGUgSW1hZ2UsXHJcbiAgICAgICAgICAvLyBiZWNhdXNlIHRoZSBJbWFnZSBpcyBmYWNpbmcgcmlnaHQgaW4gcGVyc3BlY3RpdmUuXHJcbiAgICAgICAgICBtaW5YID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WCggZnJhbWVkSW1hZ2VQb3NpdGlvbi54ICk7XHJcbiAgICAgICAgICBtYXhYID0gdmlld1Zpc2libGVCb3VuZHMubWF4WDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2xpcEFyZWEgPSBTaGFwZS5yZWN0YW5nbGUoIG1pblgsIHZpZXdWaXNpYmxlQm91bmRzLm1pblksIG1heFggLSBtaW5YLCB2aWV3VmlzaWJsZUJvdW5kcy5oZWlnaHQgKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmNsaXBBcmVhID0gY2xpcEFyZWE7XHJcblxyXG4gICAgICBpZiAoIGNsaXBBcmVhTm9kZSApIHtcclxuICAgICAgICBjbGlwQXJlYU5vZGUuc2hhcGUgPSBjbGlwQXJlYTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBsaWdodFJheXMucmF5c1Byb2Nlc3NlZEVtaXR0ZXIuYWRkTGlzdGVuZXIoICgpID0+IHtcclxuICAgICAgaWYgKCB0aGlzLnZpc2libGUgKSB7XHJcbiAgICAgICAgdXBkYXRlQ2xpcEFyZWEoKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMudmlzaWJsZVByb3BlcnR5LmxpbmsoIHZpc2libGUgPT4ge1xyXG4gICAgICBpZiAoIHZpc2libGUgKSB7XHJcbiAgICAgICAgdXBkYXRlQ2xpcEFyZWEoKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxufVxyXG5cclxuZ2VvbWV0cmljT3B0aWNzLnJlZ2lzdGVyKCAnUmVhbExpZ2h0UmF5c0ZvcmVncm91bmROb2RlJywgUmVhbExpZ2h0UmF5c0ZvcmVncm91bmROb2RlICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxpQkFBaUIsTUFBb0Msd0JBQXdCO0FBQ3BGLE9BQU9DLGVBQWUsTUFBTSwwQkFBMEI7QUFJdEQsT0FBT0MsaUJBQWlCLE1BQU0seUJBQXlCO0FBR3ZELFNBQVNDLEtBQUssUUFBUSxnQ0FBZ0M7QUFDdEQsU0FBU0MsSUFBSSxRQUFRLG1DQUFtQztBQUV4RCxTQUEyQkMsVUFBVSxRQUFRLHVDQUF1QztBQU1wRixlQUFlLE1BQU1DLDJCQUEyQixTQUFTTixpQkFBaUIsQ0FBQztFQUV6RTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDU08sV0FBV0EsQ0FBRUMsU0FBb0IsRUFDcEJD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