// Copyright 2022, University of Colorado Boulder

/**
 * HTMLImageElementObject is the base-class model for all optical objects that use an HTMLImageElement for their
 * visual representation. Framed objects and light objects are subclasses of this object type.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 * @author Martin Veillette
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import geometricOptics from '../../geometricOptics.js';
import OpticalObject from './OpticalObject.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
export default class HTMLImageElementObject extends OpticalObject {
  // The HTMLImageElement (PNG file) used to visually represent the optical object.

  // Where the point-of-interest is relative to the left-top corner of the HTMLImageElement.
  // This should be uniform for all values of htmlImageElementProperty.
  // View-to-model scale for the associated HTMLImageElement.
  // This should be uniform for all values of htmlImageElementProperty.
  // model bounds of this object's visual representation
  /**
   * @param opticalObjectNumber - positive integer used when labeling this object
   * @param opticPositionProperty - position of the optic
   * @param htmlImageElementProperty - see field htmlImageElementProperty
   * @param originOffset - see field originOffset
   * @param scaleFactor - see field scaleFactor
   * @param providedOptions
   */
  constructor(opticalObjectNumber, opticPositionProperty, htmlImageElementProperty, originOffset, scaleFactor, providedOptions) {
    super(opticalObjectNumber, opticPositionProperty, providedOptions);
    this.htmlImageElementProperty = htmlImageElementProperty;
    this.originOffset = originOffset;
    this.scaleFactor = scaleFactor;
    this.boundsProperty = new DerivedProperty([htmlImageElementProperty, this.positionProperty], (htmlImageElement, position) => computeBounds(htmlImageElement, position, scaleFactor, originOffset));
  }
}

/**
 * Computes the bounds for an optical object that uses an HTMLImageElement for its visual representation.
 * @param htmlImageElement - the PNG file shown for this optical object
 * @param position - position of the optical object
 * @param scaleFactor - see field scaleFactor
 * @param originOffset - see field originOffset
 */
function computeBounds(htmlImageElement, position, scaleFactor, originOffset) {
  assert && assert(htmlImageElement.width !== 0 && htmlImageElement.height !== 0, 'htmlImageElement is not loaded');
  const size = new Dimension2(scaleFactor * htmlImageElement.width, scaleFactor * htmlImageElement.height);
  const origin = originOffset.timesScalar(scaleFactor);
  const offsetX = origin.x;
  const offsetY = -origin.y; // flip sign of offset.y because +y is up in the model
  const left = position.x - offsetX;
  const bottom = position.y - offsetY - size.height;
  return size.toBounds(left, bottom);
}
geometricOptics.register('HTMLImageElementObject', HTMLImageElementObject);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJnZW9tZXRyaWNPcHRpY3MiLCJPcHRpY2FsT2JqZWN0IiwiRGltZW5zaW9uMiIsIkhUTUxJbWFnZUVsZW1lbnRPYmplY3QiLCJjb25zdHJ1Y3RvciIsIm9wdGljYWxPYmplY3ROdW1iZXIiLCJvcHRpY1Bvc2l0aW9uUHJvcGVydHkiLCJodG1sSW1hZ2VFbGVtZW50UHJvcGVydHkiLCJvcmlnaW5PZmZzZXQiLCJzY2FsZUZhY3RvciIsInByb3ZpZGVkT3B0aW9ucyIsImJvdW5kc1Byb3BlcnR5IiwicG9zaXRpb25Qcm9wZXJ0eSIsImh0bWxJbWFnZUVsZW1lbnQiLCJwb3NpdGlvbiIsImNvbXB1dGVCb3VuZHMiLCJhc3NlcnQiLCJ3aWR0aCIsImhlaWdodCIsInNpemUiLCJvcmlnaW4iLCJ0aW1lc1NjYWxhciIsIm9mZnNldFgiLCJ4Iiwib2Zmc2V0WSIsInkiLCJsZWZ0IiwiYm90dG9tIiwidG9Cb3VuZHMiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkhUTUxJbWFnZUVsZW1lbnRPYmplY3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEhUTUxJbWFnZUVsZW1lbnRPYmplY3QgaXMgdGhlIGJhc2UtY2xhc3MgbW9kZWwgZm9yIGFsbCBvcHRpY2FsIG9iamVjdHMgdGhhdCB1c2UgYW4gSFRNTEltYWdlRWxlbWVudCBmb3IgdGhlaXJcclxuICogdmlzdWFsIHJlcHJlc2VudGF0aW9uLiBGcmFtZWQgb2JqZWN0cyBhbmQgbGlnaHQgb2JqZWN0cyBhcmUgc3ViY2xhc3NlcyBvZiB0aGlzIG9iamVjdCB0eXBlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKiBAYXV0aG9yIE1hcnRpbiBWZWlsbGV0dGVcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IGdlb21ldHJpY09wdGljcyBmcm9tICcuLi8uLi9nZW9tZXRyaWNPcHRpY3MuanMnO1xyXG5pbXBvcnQgQm91bmRzMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvQm91bmRzMi5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IE9wdGljYWxPYmplY3QsIHsgT3B0aWNhbE9iamVjdE9wdGlvbnMgfSBmcm9tICcuL09wdGljYWxPYmplY3QuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgUGlja09wdGlvbmFsIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrT3B0aW9uYWwuanMnO1xyXG5pbXBvcnQgRGltZW5zaW9uMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvRGltZW5zaW9uMi5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuXHJcbmV4cG9ydCB0eXBlIEhUTUxJbWFnZUVsZW1lbnRPYmplY3RPcHRpb25zID0gUGlja1JlcXVpcmVkPE9wdGljYWxPYmplY3RPcHRpb25zLCAncG9zaXRpb24nIHwgJ3RhbmRlbSc+XHJcbiAgJiBQaWNrT3B0aW9uYWw8T3B0aWNhbE9iamVjdE9wdGlvbnMsICdwaGV0aW9Eb2N1bWVudGF0aW9uJz47XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBIVE1MSW1hZ2VFbGVtZW50T2JqZWN0IGV4dGVuZHMgT3B0aWNhbE9iamVjdCB7XHJcblxyXG4gIC8vIFRoZSBIVE1MSW1hZ2VFbGVtZW50IChQTkcgZmlsZSkgdXNlZCB0byB2aXN1YWxseSByZXByZXNlbnQgdGhlIG9wdGljYWwgb2JqZWN0LlxyXG4gIHB1YmxpYyByZWFkb25seSBodG1sSW1hZ2VFbGVtZW50UHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PEhUTUxJbWFnZUVsZW1lbnQ+O1xyXG5cclxuICAvLyBXaGVyZSB0aGUgcG9pbnQtb2YtaW50ZXJlc3QgaXMgcmVsYXRpdmUgdG8gdGhlIGxlZnQtdG9wIGNvcm5lciBvZiB0aGUgSFRNTEltYWdlRWxlbWVudC5cclxuICAvLyBUaGlzIHNob3VsZCBiZSB1bmlmb3JtIGZvciBhbGwgdmFsdWVzIG9mIGh0bWxJbWFnZUVsZW1lbnRQcm9wZXJ0eS5cclxuICBwdWJsaWMgcmVhZG9ubHkgb3JpZ2luT2Zmc2V0OiBWZWN0b3IyO1xyXG5cclxuICAvLyBWaWV3LXRvLW1vZGVsIHNjYWxlIGZvciB0aGUgYXNzb2NpYXRlZCBIVE1MSW1hZ2VFbGVtZW50LlxyXG4gIC8vIFRoaXMgc2hvdWxkIGJlIHVuaWZvcm0gZm9yIGFsbCB2YWx1ZXMgb2YgaHRtbEltYWdlRWxlbWVudFByb3BlcnR5LlxyXG4gIHB1YmxpYyByZWFkb25seSBzY2FsZUZhY3RvcjogbnVtYmVyO1xyXG5cclxuICAvLyBtb2RlbCBib3VuZHMgb2YgdGhpcyBvYmplY3QncyB2aXN1YWwgcmVwcmVzZW50YXRpb25cclxuICBwdWJsaWMgcmVhZG9ubHkgYm91bmRzUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PEJvdW5kczI+O1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0gb3B0aWNhbE9iamVjdE51bWJlciAtIHBvc2l0aXZlIGludGVnZXIgdXNlZCB3aGVuIGxhYmVsaW5nIHRoaXMgb2JqZWN0XHJcbiAgICogQHBhcmFtIG9wdGljUG9zaXRpb25Qcm9wZXJ0eSAtIHBvc2l0aW9uIG9mIHRoZSBvcHRpY1xyXG4gICAqIEBwYXJhbSBodG1sSW1hZ2VFbGVtZW50UHJvcGVydHkgLSBzZWUgZmllbGQgaHRtbEltYWdlRWxlbWVudFByb3BlcnR5XHJcbiAgICogQHBhcmFtIG9yaWdpbk9mZnNldCAtIHNlZSBmaWVsZCBvcmlnaW5PZmZzZXRcclxuICAgKiBAcGFyYW0gc2NhbGVGYWN0b3IgLSBzZWUgZmllbGQgc2NhbGVGYWN0b3JcclxuICAgKiBAcGFyYW0gcHJvdmlkZWRPcHRpb25zXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBvcHRpY2FsT2JqZWN0TnVtYmVyOiBudW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICBvcHRpY1Bvc2l0aW9uUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFZlY3RvcjI+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgaHRtbEltYWdlRWxlbWVudFByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxIVE1MSW1hZ2VFbGVtZW50PixcclxuICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbk9mZnNldDogVmVjdG9yMixcclxuICAgICAgICAgICAgICAgICAgICAgIHNjYWxlRmFjdG9yOiBudW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM6IEhUTUxJbWFnZUVsZW1lbnRPYmplY3RPcHRpb25zICkge1xyXG5cclxuICAgIHN1cGVyKCBvcHRpY2FsT2JqZWN0TnVtYmVyLCBvcHRpY1Bvc2l0aW9uUHJvcGVydHksIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMuaHRtbEltYWdlRWxlbWVudFByb3BlcnR5ID0gaHRtbEltYWdlRWxlbWVudFByb3BlcnR5O1xyXG4gICAgdGhpcy5vcmlnaW5PZmZzZXQgPSBvcmlnaW5PZmZzZXQ7XHJcbiAgICB0aGlzLnNjYWxlRmFjdG9yID0gc2NhbGVGYWN0b3I7XHJcblxyXG4gICAgdGhpcy5ib3VuZHNQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgaHRtbEltYWdlRWxlbWVudFByb3BlcnR5LCB0aGlzLnBvc2l0aW9uUHJvcGVydHkgXSxcclxuICAgICAgKCBodG1sSW1hZ2VFbGVtZW50LCBwb3NpdGlvbiApID0+XHJcbiAgICAgICAgY29tcHV0ZUJvdW5kcyggaHRtbEltYWdlRWxlbWVudCwgcG9zaXRpb24sIHNjYWxlRmFjdG9yLCBvcmlnaW5PZmZzZXQgKVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb21wdXRlcyB0aGUgYm91bmRzIGZvciBhbiBvcHRpY2FsIG9iamVjdCB0aGF0IHVzZXMgYW4gSFRNTEltYWdlRWxlbWVudCBmb3IgaXRzIHZpc3VhbCByZXByZXNlbnRhdGlvbi5cclxuICogQHBhcmFtIGh0bWxJbWFnZUVsZW1lbnQgLSB0aGUgUE5HIGZpbGUgc2hvd24gZm9yIHRoaXMgb3B0aWNhbCBvYmplY3RcclxuICogQHBhcmFtIHBvc2l0aW9uIC0gcG9zaXRpb24gb2YgdGhlIG9wdGljYWwgb2JqZWN0XHJcbiAqIEBwYXJhbSBzY2FsZUZhY3RvciAtIHNlZSBmaWVsZCBzY2FsZUZhY3RvclxyXG4gKiBAcGFyYW0gb3JpZ2luT2Zmc2V0IC0gc2VlIGZpZWxkIG9yaWdpbk9mZnNldFxyXG4gKi9cclxuZnVuY3Rpb24gY29tcHV0ZUJvdW5kcyggaHRtbEltYWdlRWxlbWVudDogSFRNTEltYWdlRWxlbWVudCwgcG9zaXRpb246IFZlY3RvcjIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlRmFjdG9yOiBudW1iZXIsIG9yaWdpbk9mZnNldDogVmVjdG9yMiApOiBCb3VuZHMyIHtcclxuXHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggaHRtbEltYWdlRWxlbWVudC53aWR0aCAhPT0gMCAmJiBodG1sSW1hZ2VFbGVtZW50LmhlaWdodCAhPT0gMCwgJ2h0bWxJbWFnZUVsZW1lbnQgaXMgbm90IGxvYWRlZCcgKTtcclxuICBjb25zdCBzaXplID0gbmV3IERpbWVuc2lvbjIoIHNjYWxlRmFjdG9yICogaHRtbEltYWdlRWxlbWVudC53aWR0aCwgc2NhbGVGYWN0b3IgKiBodG1sSW1hZ2VFbGVtZW50LmhlaWdodCApO1xyXG4gIGNvbnN0IG9yaWdpbiA9IG9yaWdpbk9mZnNldC50aW1lc1NjYWxhciggc2NhbGVGYWN0b3IgKTtcclxuICBjb25zdCBvZmZzZXRYID0gb3JpZ2luLng7XHJcbiAgY29uc3Qgb2Zmc2V0WSA9IC1vcmlnaW4ueTsgIC8vIGZsaXAgc2lnbiBvZiBvZmZzZXQueSBiZWNhdXNlICt5IGlzIHVwIGluIHRoZSBtb2RlbFxyXG4gIGNvbnN0IGxlZnQgPSBwb3NpdGlvbi54IC0gb2Zmc2V0WDtcclxuICBjb25zdCBib3R0b20gPSBwb3NpdGlvbi55IC0gb2Zmc2V0WSAtIHNpemUuaGVpZ2h0O1xyXG5cclxuICByZXR1cm4gc2l6ZS50b0JvdW5kcyggbGVmdCwgYm90dG9tICk7XHJcbn1cclxuXHJcbmdlb21ldHJpY09wdGljcy5yZWdpc3RlciggJ0hUTUxJbWFnZUVsZW1lbnRPYmplY3QnLCBIVE1MSW1hZ2VFbGVtZW50T2JqZWN0ICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLGVBQWUsTUFBTSwwQkFBMEI7QUFHdEQsT0FBT0MsYUFBYSxNQUFnQyxvQkFBb0I7QUFHeEUsT0FBT0MsVUFBVSxNQUFNLGtDQUFrQztBQU16RCxlQUFlLE1BQU1DLHNCQUFzQixTQUFTRixhQUFhLENBQUM7RUFFaEU7O0VBR0E7RUFDQTtFQUdBO0VBQ0E7RUFHQTtFQUdBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDU0csV0FBV0EsQ0FBRUMsbUJBQTJCLEVBQzNCQyxxQkFBaUQsRUFDakRDLHdCQUE2RCxFQUM3REMsWUFBcUIsRUFDckJDLFdBQW1CLEVBQ25CQyxlQUE4QyxFQUFHO0lBRW5FLEtBQUssQ0FBRUwsbUJBQW1CLEVBQUVDLHFCQUFxQixFQUFFSSxlQUFnQixDQUFDO0lBRXBFLElBQUksQ0FBQ0gsd0JBQXdCLEdBQUdBLHdCQUF3QjtJQUN4RCxJQUFJLENBQUNDLFlBQVksR0FBR0EsWUFBWTtJQUNoQyxJQUFJLENBQUNDLFdBQVcsR0FBR0EsV0FBVztJQUU5QixJQUFJLENBQUNFLGNBQWMsR0FBRyxJQUFJWixlQUFlLENBQ3ZDLENBQUVRLHdCQUF3QixFQUFFLElBQUksQ0FBQ0ssZ0JBQWdCLENBQUUsRUFDbkQsQ0FBRUMsZ0JBQWdCLEVBQUVDLFFBQVEsS0FDMUJDLGFBQWEsQ0FBRUYsZ0JBQWdCLEVBQUVDLFFBQVEsRUFBRUwsV0FBVyxFQUFFRCxZQUFhLENBQ3pFLENBQUM7RUFDSDtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBU08sYUFBYUEsQ0FBRUYsZ0JBQWtDLEVBQUVDLFFBQWlCLEVBQ3JETCxXQUFtQixFQUFFRCxZQUFxQixFQUFZO0VBRTVFUSxNQUFNLElBQUlBLE1BQU0sQ0FBRUgsZ0JBQWdCLENBQUNJLEtBQUssS0FBSyxDQUFDLElBQUlKLGdCQUFnQixDQUFDSyxNQUFNLEtBQUssQ0FBQyxFQUFFLGdDQUFpQyxDQUFDO0VBQ25ILE1BQU1DLElBQUksR0FBRyxJQUFJakIsVUFBVSxDQUFFTyxXQUFXLEdBQUdJLGdCQUFnQixDQUFDSSxLQUFLLEVBQUVSLFdBQVcsR0FBR0ksZ0JBQWdCLENBQUNLLE1BQU8sQ0FBQztFQUMxRyxNQUFNRSxNQUFNLEdBQUdaLFlBQVksQ0FBQ2EsV0FBVyxDQUFFWixXQUFZLENBQUM7RUFDdEQsTUFBTWEsT0FBTyxHQUFHRixNQUFNLENBQUNHLENBQUM7RUFDeEIsTUFBTUMsT0FBTyxHQUFHLENBQUNKLE1BQU0sQ0FBQ0ssQ0FBQyxDQUFDLENBQUU7RUFDNUIsTUFBTUMsSUFBSSxHQUFHWixRQUFRLENBQUNTLENBQUMsR0FBR0QsT0FBTztFQUNqQyxNQUFNSyxNQUFNLEdBQUdiLFFBQVEsQ0FBQ1csQ0FBQyxHQUFHRCxPQUFPLEdBQUdMLElBQUksQ0FBQ0QsTUFBTTtFQUVqRCxPQUFPQyxJQUFJLENBQUNTLFFBQVEsQ0FBRUYsSUFBSSxFQUFFQyxNQUFPLENBQUM7QUFDdEM7QUFFQTNCLGVBQWUsQ0FBQzZCLFFBQVEsQ0FBRSx3QkFBd0IsRUFBRTFCLHNCQUF1QixDQUFDIn0=