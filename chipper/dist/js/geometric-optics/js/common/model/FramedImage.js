// Copyright 2021-2023, University of Colorado Boulder

/**
 * FramedImage is the model of the optical image associated with a framed object.
 *
 * @author Martin Veillette
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Bounds2 from '../../../../dot/js/Bounds2.js';
import geometricOptics from '../../geometricOptics.js';
import Lens from '../../lens/model/Lens.js';
import OpticalImage from './OpticalImage.js';
import GOConstants from '../GOConstants.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
export default class FramedImage extends OpticalImage {
  // the HTMLImageElement (PNG file) to display

  // bounds of the optical image's visual representation, in model coordinates

  // opacity of the framed image

  /**
   * @param framedObject - the optical object that this image is associated with
   * @param optic - the optic is responsible for forming the optical image
   * @param providedOptions
   */
  constructor(framedObject, optic, providedOptions) {
    super(framedObject, optic, providedOptions);
    this.htmlImageElementProperty = new DerivedProperty([framedObject.objectHTMLImageElementsProperty, this.opticalImageTypeProperty], (objectHTMLImageElements, opticalImageType) => {
      const isLens = optic instanceof Lens;
      const realImage = isLens ? objectHTMLImageElements.leftFacingInverted : objectHTMLImageElements.rightFacingInverted;
      const virtualImage = isLens ? objectHTMLImageElements.rightFacingUpright : objectHTMLImageElements.leftFacingUpright;
      return opticalImageType === 'real' ? realImage : virtualImage;
    });
    this.boundsProperty = new DerivedProperty([this.htmlImageElementProperty, this.positionProperty, this.magnificationProperty], (htmlImageElement, position, magnification) => {
      const scaleFactor = framedObject.scaleFactor;
      const initialOrigin = framedObject.originOffset.timesScalar(scaleFactor);
      assert && assert(htmlImageElement.width !== 0 && htmlImageElement.height !== 0, 'htmlImageElement is not loaded');
      const initialWidth = htmlImageElement.width * scaleFactor;
      const initialHeight = htmlImageElement.height * scaleFactor;
      const origin = initialOrigin.timesScalar(magnification);
      const offsetX = -origin.x;
      const offsetY = origin.y;
      const width = initialWidth * magnification;
      const height = initialHeight * magnification;
      const x1 = optic.sign * offsetX;
      const x2 = optic.sign * (offsetX + width);
      const y1 = offsetY;
      const y2 = offsetY - height;
      const bounds = new Bounds2(Math.min(x1, x2), Math.min(y1, y2), Math.max(x1, x2), Math.max(y1, y2));
      return bounds.shifted(position);
    });
    const diameterRange = optic.diameterProperty.range;

    // This algorithm was specified by Kathy Perkins in https://github.com/phetsims/geometric-optics/issues/350.
    this.opacityProperty = new DerivedProperty([framedObject.objectDistanceProperty, optic.diameterProperty, this.magnificationProperty], (objectDistance, diameter, magnification) => {
      // Kathy Perkins described this constant as "a comfortable distance from the lens, and nominally where the
      // image/object sizes are the same". This is a horizontal distance.
      const referenceObjectDistance = 160; // cm

      // Effect of object's distance from the optic.
      const objectDistanceFactor = referenceObjectDistance / objectDistance;

      // Effect of optic diameter
      const diameterFactor = diameter / diameterRange.max;

      // Effect of magnification.
      const magnificationFactor = Math.abs(1 / magnification);

      // Prior to rewriting this algorithm, the opacity range was [0,0.75]. Kathy Perkins described this constant
      // like this: "it was easiest to find ... where you would get a value of 1, and then just multiply that
      // by 0.75 to create the visual effect we wanted".
      const multiplier = 0.75;

      // Multiply factors, constrain to range.
      return GOConstants.OPACITY_RANGE.constrainValue(multiplier * objectDistanceFactor * diameterFactor * magnificationFactor);
    }, {
      isValidValue: value => GOConstants.OPACITY_RANGE.contains(value),
      // Not necessarily useful to iO clients, but very useful when verifying this algorithm.
      tandem: providedOptions.tandem.createTandem('opacityProperty'),
      phetioFeatured: true,
      phetioValueType: NumberIO
    });
  }
}
geometricOptics.register('FramedImage', FramedImage);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJCb3VuZHMyIiwiZ2VvbWV0cmljT3B0aWNzIiwiTGVucyIsIk9wdGljYWxJbWFnZSIsIkdPQ29uc3RhbnRzIiwiTnVtYmVySU8iLCJGcmFtZWRJbWFnZSIsImNvbnN0cnVjdG9yIiwiZnJhbWVkT2JqZWN0Iiwib3B0aWMiLCJwcm92aWRlZE9wdGlvbnMiLCJodG1sSW1hZ2VFbGVtZW50UHJvcGVydHkiLCJvYmplY3RIVE1MSW1hZ2VFbGVtZW50c1Byb3BlcnR5Iiwib3B0aWNhbEltYWdlVHlwZVByb3BlcnR5Iiwib2JqZWN0SFRNTEltYWdlRWxlbWVudHMiLCJvcHRpY2FsSW1hZ2VUeXBlIiwiaXNMZW5zIiwicmVhbEltYWdlIiwibGVmdEZhY2luZ0ludmVydGVkIiwicmlnaHRGYWNpbmdJbnZlcnRlZCIsInZpcnR1YWxJbWFnZSIsInJpZ2h0RmFjaW5nVXByaWdodCIsImxlZnRGYWNpbmdVcHJpZ2h0IiwiYm91bmRzUHJvcGVydHkiLCJwb3NpdGlvblByb3BlcnR5IiwibWFnbmlmaWNhdGlvblByb3BlcnR5IiwiaHRtbEltYWdlRWxlbWVudCIsInBvc2l0aW9uIiwibWFnbmlmaWNhdGlvbiIsInNjYWxlRmFjdG9yIiwiaW5pdGlhbE9yaWdpbiIsIm9yaWdpbk9mZnNldCIsInRpbWVzU2NhbGFyIiwiYXNzZXJ0Iiwid2lkdGgiLCJoZWlnaHQiLCJpbml0aWFsV2lkdGgiLCJpbml0aWFsSGVpZ2h0Iiwib3JpZ2luIiwib2Zmc2V0WCIsIngiLCJvZmZzZXRZIiwieSIsIngxIiwic2lnbiIsIngyIiwieTEiLCJ5MiIsImJvdW5kcyIsIk1hdGgiLCJtaW4iLCJtYXgiLCJzaGlmdGVkIiwiZGlhbWV0ZXJSYW5nZSIsImRpYW1ldGVyUHJvcGVydHkiLCJyYW5nZSIsIm9wYWNpdHlQcm9wZXJ0eSIsIm9iamVjdERpc3RhbmNlUHJvcGVydHkiLCJvYmplY3REaXN0YW5jZSIsImRpYW1ldGVyIiwicmVmZXJlbmNlT2JqZWN0RGlzdGFuY2UiLCJvYmplY3REaXN0YW5jZUZhY3RvciIsImRpYW1ldGVyRmFjdG9yIiwibWFnbmlmaWNhdGlvbkZhY3RvciIsImFicyIsIm11bHRpcGxpZXIiLCJPUEFDSVRZX1JBTkdFIiwiY29uc3RyYWluVmFsdWUiLCJpc1ZhbGlkVmFsdWUiLCJ2YWx1ZSIsImNvbnRhaW5zIiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwicGhldGlvRmVhdHVyZWQiLCJwaGV0aW9WYWx1ZVR5cGUiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkZyYW1lZEltYWdlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIxLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEZyYW1lZEltYWdlIGlzIHRoZSBtb2RlbCBvZiB0aGUgb3B0aWNhbCBpbWFnZSBhc3NvY2lhdGVkIHdpdGggYSBmcmFtZWQgb2JqZWN0LlxyXG4gKlxyXG4gKiBAYXV0aG9yIE1hcnRpbiBWZWlsbGV0dGVcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgZ2VvbWV0cmljT3B0aWNzIGZyb20gJy4uLy4uL2dlb21ldHJpY09wdGljcy5qcyc7XHJcbmltcG9ydCBMZW5zIGZyb20gJy4uLy4uL2xlbnMvbW9kZWwvTGVucy5qcyc7XHJcbmltcG9ydCBPcHRpYyBmcm9tICcuL09wdGljLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgT3B0aWNhbEltYWdlLCB7IE9wdGljYWxJbWFnZU9wdGlvbnMgfSBmcm9tICcuL09wdGljYWxJbWFnZS5qcyc7XHJcbmltcG9ydCBGcmFtZWRPYmplY3QgZnJvbSAnLi9GcmFtZWRPYmplY3QuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgUGlja09wdGlvbmFsIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrT3B0aW9uYWwuanMnO1xyXG5pbXBvcnQgR09Db25zdGFudHMgZnJvbSAnLi4vR09Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgTnVtYmVySU8gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL051bWJlcklPLmpzJztcclxuXHJcbnR5cGUgRnJhbWVkSW1hZ2VPcHRpb25zID0gUGlja09wdGlvbmFsPE9wdGljYWxJbWFnZU9wdGlvbnMsICdvcHRpY2FsT2JqZWN0UG9zaXRpb25Qcm9wZXJ0eSc+ICZcclxuICBQaWNrUmVxdWlyZWQ8T3B0aWNhbEltYWdlT3B0aW9ucywgJ3RhbmRlbScgfCAncGhldGlvRG9jdW1lbnRhdGlvbic+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRnJhbWVkSW1hZ2UgZXh0ZW5kcyBPcHRpY2FsSW1hZ2Uge1xyXG5cclxuICAvLyB0aGUgSFRNTEltYWdlRWxlbWVudCAoUE5HIGZpbGUpIHRvIGRpc3BsYXlcclxuICBwdWJsaWMgcmVhZG9ubHkgaHRtbEltYWdlRWxlbWVudFByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxIVE1MSW1hZ2VFbGVtZW50PjtcclxuXHJcbiAgLy8gYm91bmRzIG9mIHRoZSBvcHRpY2FsIGltYWdlJ3MgdmlzdWFsIHJlcHJlc2VudGF0aW9uLCBpbiBtb2RlbCBjb29yZGluYXRlc1xyXG4gIHB1YmxpYyByZWFkb25seSBib3VuZHNQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Qm91bmRzMj47XHJcblxyXG4gIC8vIG9wYWNpdHkgb2YgdGhlIGZyYW1lZCBpbWFnZVxyXG4gIHB1YmxpYyByZWFkb25seSBvcGFjaXR5UHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBmcmFtZWRPYmplY3QgLSB0aGUgb3B0aWNhbCBvYmplY3QgdGhhdCB0aGlzIGltYWdlIGlzIGFzc29jaWF0ZWQgd2l0aFxyXG4gICAqIEBwYXJhbSBvcHRpYyAtIHRoZSBvcHRpYyBpcyByZXNwb25zaWJsZSBmb3IgZm9ybWluZyB0aGUgb3B0aWNhbCBpbWFnZVxyXG4gICAqIEBwYXJhbSBwcm92aWRlZE9wdGlvbnNcclxuICAgKi9cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGZyYW1lZE9iamVjdDogRnJhbWVkT2JqZWN0LCBvcHRpYzogT3B0aWMsIHByb3ZpZGVkT3B0aW9uczogRnJhbWVkSW1hZ2VPcHRpb25zICkge1xyXG5cclxuICAgIHN1cGVyKCBmcmFtZWRPYmplY3QsIG9wdGljLCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLmh0bWxJbWFnZUVsZW1lbnRQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgZnJhbWVkT2JqZWN0Lm9iamVjdEhUTUxJbWFnZUVsZW1lbnRzUHJvcGVydHksIHRoaXMub3B0aWNhbEltYWdlVHlwZVByb3BlcnR5IF0sXHJcbiAgICAgICggb2JqZWN0SFRNTEltYWdlRWxlbWVudHMsIG9wdGljYWxJbWFnZVR5cGUgKSA9PiB7XHJcbiAgICAgICAgY29uc3QgaXNMZW5zID0gKCBvcHRpYyBpbnN0YW5jZW9mIExlbnMgKTtcclxuICAgICAgICBjb25zdCByZWFsSW1hZ2UgPSBpc0xlbnMgPyBvYmplY3RIVE1MSW1hZ2VFbGVtZW50cy5sZWZ0RmFjaW5nSW52ZXJ0ZWQgOiBvYmplY3RIVE1MSW1hZ2VFbGVtZW50cy5yaWdodEZhY2luZ0ludmVydGVkO1xyXG4gICAgICAgIGNvbnN0IHZpcnR1YWxJbWFnZSA9IGlzTGVucyA/IG9iamVjdEhUTUxJbWFnZUVsZW1lbnRzLnJpZ2h0RmFjaW5nVXByaWdodCA6IG9iamVjdEhUTUxJbWFnZUVsZW1lbnRzLmxlZnRGYWNpbmdVcHJpZ2h0O1xyXG4gICAgICAgIHJldHVybiAoIG9wdGljYWxJbWFnZVR5cGUgPT09ICdyZWFsJyApID8gcmVhbEltYWdlIDogdmlydHVhbEltYWdlO1xyXG4gICAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5ib3VuZHNQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5odG1sSW1hZ2VFbGVtZW50UHJvcGVydHksIHRoaXMucG9zaXRpb25Qcm9wZXJ0eSwgdGhpcy5tYWduaWZpY2F0aW9uUHJvcGVydHkgXSxcclxuICAgICAgKCBodG1sSW1hZ2VFbGVtZW50LCBwb3NpdGlvbiwgbWFnbmlmaWNhdGlvbiApID0+IHtcclxuXHJcbiAgICAgICAgY29uc3Qgc2NhbGVGYWN0b3IgPSBmcmFtZWRPYmplY3Quc2NhbGVGYWN0b3I7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbE9yaWdpbiA9IGZyYW1lZE9iamVjdC5vcmlnaW5PZmZzZXQudGltZXNTY2FsYXIoIHNjYWxlRmFjdG9yICk7XHJcblxyXG4gICAgICAgIGFzc2VydCAmJiBhc3NlcnQoIGh0bWxJbWFnZUVsZW1lbnQud2lkdGggIT09IDAgJiYgaHRtbEltYWdlRWxlbWVudC5oZWlnaHQgIT09IDAsICdodG1sSW1hZ2VFbGVtZW50IGlzIG5vdCBsb2FkZWQnICk7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbFdpZHRoID0gaHRtbEltYWdlRWxlbWVudC53aWR0aCAqIHNjYWxlRmFjdG9yO1xyXG4gICAgICAgIGNvbnN0IGluaXRpYWxIZWlnaHQgPSBodG1sSW1hZ2VFbGVtZW50LmhlaWdodCAqIHNjYWxlRmFjdG9yO1xyXG5cclxuICAgICAgICBjb25zdCBvcmlnaW4gPSBpbml0aWFsT3JpZ2luLnRpbWVzU2NhbGFyKCBtYWduaWZpY2F0aW9uICk7XHJcbiAgICAgICAgY29uc3Qgb2Zmc2V0WCA9IC1vcmlnaW4ueDtcclxuICAgICAgICBjb25zdCBvZmZzZXRZID0gb3JpZ2luLnk7XHJcbiAgICAgICAgY29uc3Qgd2lkdGggPSBpbml0aWFsV2lkdGggKiBtYWduaWZpY2F0aW9uO1xyXG4gICAgICAgIGNvbnN0IGhlaWdodCA9IGluaXRpYWxIZWlnaHQgKiBtYWduaWZpY2F0aW9uO1xyXG5cclxuICAgICAgICBjb25zdCB4MSA9IG9wdGljLnNpZ24gKiBvZmZzZXRYO1xyXG4gICAgICAgIGNvbnN0IHgyID0gb3B0aWMuc2lnbiAqICggb2Zmc2V0WCArIHdpZHRoICk7XHJcbiAgICAgICAgY29uc3QgeTEgPSBvZmZzZXRZO1xyXG4gICAgICAgIGNvbnN0IHkyID0gb2Zmc2V0WSAtIGhlaWdodDtcclxuXHJcbiAgICAgICAgY29uc3QgYm91bmRzID0gbmV3IEJvdW5kczIoIE1hdGgubWluKCB4MSwgeDIgKSwgTWF0aC5taW4oIHkxLCB5MiApLCBNYXRoLm1heCggeDEsIHgyICksIE1hdGgubWF4KCB5MSwgeTIgKSApO1xyXG5cclxuICAgICAgICByZXR1cm4gYm91bmRzLnNoaWZ0ZWQoIHBvc2l0aW9uICk7XHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBkaWFtZXRlclJhbmdlID0gb3B0aWMuZGlhbWV0ZXJQcm9wZXJ0eS5yYW5nZTtcclxuXHJcbiAgICAvLyBUaGlzIGFsZ29yaXRobSB3YXMgc3BlY2lmaWVkIGJ5IEthdGh5IFBlcmtpbnMgaW4gaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2dlb21ldHJpYy1vcHRpY3MvaXNzdWVzLzM1MC5cclxuICAgIHRoaXMub3BhY2l0eVByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyBmcmFtZWRPYmplY3Qub2JqZWN0RGlzdGFuY2VQcm9wZXJ0eSwgb3B0aWMuZGlhbWV0ZXJQcm9wZXJ0eSwgdGhpcy5tYWduaWZpY2F0aW9uUHJvcGVydHkgXSxcclxuICAgICAgKCBvYmplY3REaXN0YW5jZSwgZGlhbWV0ZXIsIG1hZ25pZmljYXRpb24gKSA9PiB7XHJcblxyXG4gICAgICAgIC8vIEthdGh5IFBlcmtpbnMgZGVzY3JpYmVkIHRoaXMgY29uc3RhbnQgYXMgXCJhIGNvbWZvcnRhYmxlIGRpc3RhbmNlIGZyb20gdGhlIGxlbnMsIGFuZCBub21pbmFsbHkgd2hlcmUgdGhlXHJcbiAgICAgICAgLy8gaW1hZ2Uvb2JqZWN0IHNpemVzIGFyZSB0aGUgc2FtZVwiLiBUaGlzIGlzIGEgaG9yaXpvbnRhbCBkaXN0YW5jZS5cclxuICAgICAgICBjb25zdCByZWZlcmVuY2VPYmplY3REaXN0YW5jZSA9IDE2MDsgLy8gY21cclxuXHJcbiAgICAgICAgLy8gRWZmZWN0IG9mIG9iamVjdCdzIGRpc3RhbmNlIGZyb20gdGhlIG9wdGljLlxyXG4gICAgICAgIGNvbnN0IG9iamVjdERpc3RhbmNlRmFjdG9yID0gcmVmZXJlbmNlT2JqZWN0RGlzdGFuY2UgLyBvYmplY3REaXN0YW5jZTtcclxuXHJcbiAgICAgICAgLy8gRWZmZWN0IG9mIG9wdGljIGRpYW1ldGVyXHJcbiAgICAgICAgY29uc3QgZGlhbWV0ZXJGYWN0b3IgPSBkaWFtZXRlciAvIGRpYW1ldGVyUmFuZ2UubWF4O1xyXG5cclxuICAgICAgICAvLyBFZmZlY3Qgb2YgbWFnbmlmaWNhdGlvbi5cclxuICAgICAgICBjb25zdCBtYWduaWZpY2F0aW9uRmFjdG9yID0gTWF0aC5hYnMoIDEgLyBtYWduaWZpY2F0aW9uICk7XHJcblxyXG4gICAgICAgIC8vIFByaW9yIHRvIHJld3JpdGluZyB0aGlzIGFsZ29yaXRobSwgdGhlIG9wYWNpdHkgcmFuZ2Ugd2FzIFswLDAuNzVdLiBLYXRoeSBQZXJraW5zIGRlc2NyaWJlZCB0aGlzIGNvbnN0YW50XHJcbiAgICAgICAgLy8gbGlrZSB0aGlzOiBcIml0IHdhcyBlYXNpZXN0IHRvIGZpbmQgLi4uIHdoZXJlIHlvdSB3b3VsZCBnZXQgYSB2YWx1ZSBvZiAxLCBhbmQgdGhlbiBqdXN0IG11bHRpcGx5IHRoYXRcclxuICAgICAgICAvLyBieSAwLjc1IHRvIGNyZWF0ZSB0aGUgdmlzdWFsIGVmZmVjdCB3ZSB3YW50ZWRcIi5cclxuICAgICAgICBjb25zdCBtdWx0aXBsaWVyID0gMC43NTtcclxuXHJcbiAgICAgICAgLy8gTXVsdGlwbHkgZmFjdG9ycywgY29uc3RyYWluIHRvIHJhbmdlLlxyXG4gICAgICAgIHJldHVybiBHT0NvbnN0YW50cy5PUEFDSVRZX1JBTkdFLmNvbnN0cmFpblZhbHVlKCBtdWx0aXBsaWVyICogb2JqZWN0RGlzdGFuY2VGYWN0b3IgKiBkaWFtZXRlckZhY3RvciAqIG1hZ25pZmljYXRpb25GYWN0b3IgKTtcclxuICAgICAgfSwge1xyXG4gICAgICAgIGlzVmFsaWRWYWx1ZTogKCB2YWx1ZTogbnVtYmVyICkgPT4gR09Db25zdGFudHMuT1BBQ0lUWV9SQU5HRS5jb250YWlucyggdmFsdWUgKSxcclxuXHJcbiAgICAgICAgLy8gTm90IG5lY2Vzc2FyaWx5IHVzZWZ1bCB0byBpTyBjbGllbnRzLCBidXQgdmVyeSB1c2VmdWwgd2hlbiB2ZXJpZnlpbmcgdGhpcyBhbGdvcml0aG0uXHJcbiAgICAgICAgdGFuZGVtOiBwcm92aWRlZE9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ29wYWNpdHlQcm9wZXJ0eScgKSxcclxuICAgICAgICBwaGV0aW9GZWF0dXJlZDogdHJ1ZSxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bWJlcklPXHJcbiAgICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbmdlb21ldHJpY09wdGljcy5yZWdpc3RlciggJ0ZyYW1lZEltYWdlJywgRnJhbWVkSW1hZ2UgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsT0FBT0MsZUFBZSxNQUFNLDBCQUEwQjtBQUN0RCxPQUFPQyxJQUFJLE1BQU0sMEJBQTBCO0FBRzNDLE9BQU9DLFlBQVksTUFBK0IsbUJBQW1CO0FBSXJFLE9BQU9DLFdBQVcsTUFBTSxtQkFBbUI7QUFDM0MsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUs5RCxlQUFlLE1BQU1DLFdBQVcsU0FBU0gsWUFBWSxDQUFDO0VBRXBEOztFQUdBOztFQUdBOztFQUdBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7RUFDU0ksV0FBV0EsQ0FBRUMsWUFBMEIsRUFBRUMsS0FBWSxFQUFFQyxlQUFtQyxFQUFHO0lBRWxHLEtBQUssQ0FBRUYsWUFBWSxFQUFFQyxLQUFLLEVBQUVDLGVBQWdCLENBQUM7SUFFN0MsSUFBSSxDQUFDQyx3QkFBd0IsR0FBRyxJQUFJWixlQUFlLENBQ2pELENBQUVTLFlBQVksQ0FBQ0ksK0JBQStCLEVBQUUsSUFBSSxDQUFDQyx3QkFBd0IsQ0FBRSxFQUMvRSxDQUFFQyx1QkFBdUIsRUFBRUMsZ0JBQWdCLEtBQU07TUFDL0MsTUFBTUMsTUFBTSxHQUFLUCxLQUFLLFlBQVlQLElBQU07TUFDeEMsTUFBTWUsU0FBUyxHQUFHRCxNQUFNLEdBQUdGLHVCQUF1QixDQUFDSSxrQkFBa0IsR0FBR0osdUJBQXVCLENBQUNLLG1CQUFtQjtNQUNuSCxNQUFNQyxZQUFZLEdBQUdKLE1BQU0sR0FBR0YsdUJBQXVCLENBQUNPLGtCQUFrQixHQUFHUCx1QkFBdUIsQ0FBQ1EsaUJBQWlCO01BQ3BILE9BQVNQLGdCQUFnQixLQUFLLE1BQU0sR0FBS0UsU0FBUyxHQUFHRyxZQUFZO0lBQ25FLENBQUUsQ0FBQztJQUVMLElBQUksQ0FBQ0csY0FBYyxHQUFHLElBQUl4QixlQUFlLENBQ3ZDLENBQUUsSUFBSSxDQUFDWSx3QkFBd0IsRUFBRSxJQUFJLENBQUNhLGdCQUFnQixFQUFFLElBQUksQ0FBQ0MscUJBQXFCLENBQUUsRUFDcEYsQ0FBRUMsZ0JBQWdCLEVBQUVDLFFBQVEsRUFBRUMsYUFBYSxLQUFNO01BRS9DLE1BQU1DLFdBQVcsR0FBR3JCLFlBQVksQ0FBQ3FCLFdBQVc7TUFDNUMsTUFBTUMsYUFBYSxHQUFHdEIsWUFBWSxDQUFDdUIsWUFBWSxDQUFDQyxXQUFXLENBQUVILFdBQVksQ0FBQztNQUUxRUksTUFBTSxJQUFJQSxNQUFNLENBQUVQLGdCQUFnQixDQUFDUSxLQUFLLEtBQUssQ0FBQyxJQUFJUixnQkFBZ0IsQ0FBQ1MsTUFBTSxLQUFLLENBQUMsRUFBRSxnQ0FBaUMsQ0FBQztNQUNuSCxNQUFNQyxZQUFZLEdBQUdWLGdCQUFnQixDQUFDUSxLQUFLLEdBQUdMLFdBQVc7TUFDekQsTUFBTVEsYUFBYSxHQUFHWCxnQkFBZ0IsQ0FBQ1MsTUFBTSxHQUFHTixXQUFXO01BRTNELE1BQU1TLE1BQU0sR0FBR1IsYUFBYSxDQUFDRSxXQUFXLENBQUVKLGFBQWMsQ0FBQztNQUN6RCxNQUFNVyxPQUFPLEdBQUcsQ0FBQ0QsTUFBTSxDQUFDRSxDQUFDO01BQ3pCLE1BQU1DLE9BQU8sR0FBR0gsTUFBTSxDQUFDSSxDQUFDO01BQ3hCLE1BQU1SLEtBQUssR0FBR0UsWUFBWSxHQUFHUixhQUFhO01BQzFDLE1BQU1PLE1BQU0sR0FBR0UsYUFBYSxHQUFHVCxhQUFhO01BRTVDLE1BQU1lLEVBQUUsR0FBR2xDLEtBQUssQ0FBQ21DLElBQUksR0FBR0wsT0FBTztNQUMvQixNQUFNTSxFQUFFLEdBQUdwQyxLQUFLLENBQUNtQyxJQUFJLElBQUtMLE9BQU8sR0FBR0wsS0FBSyxDQUFFO01BQzNDLE1BQU1ZLEVBQUUsR0FBR0wsT0FBTztNQUNsQixNQUFNTSxFQUFFLEdBQUdOLE9BQU8sR0FBR04sTUFBTTtNQUUzQixNQUFNYSxNQUFNLEdBQUcsSUFBSWhELE9BQU8sQ0FBRWlELElBQUksQ0FBQ0MsR0FBRyxDQUFFUCxFQUFFLEVBQUVFLEVBQUcsQ0FBQyxFQUFFSSxJQUFJLENBQUNDLEdBQUcsQ0FBRUosRUFBRSxFQUFFQyxFQUFHLENBQUMsRUFBRUUsSUFBSSxDQUFDRSxHQUFHLENBQUVSLEVBQUUsRUFBRUUsRUFBRyxDQUFDLEVBQUVJLElBQUksQ0FBQ0UsR0FBRyxDQUFFTCxFQUFFLEVBQUVDLEVBQUcsQ0FBRSxDQUFDO01BRTVHLE9BQU9DLE1BQU0sQ0FBQ0ksT0FBTyxDQUFFekIsUUFBUyxDQUFDO0lBQ25DLENBQUUsQ0FBQztJQUVMLE1BQU0wQixhQUFhLEdBQUc1QyxLQUFLLENBQUM2QyxnQkFBZ0IsQ0FBQ0MsS0FBSzs7SUFFbEQ7SUFDQSxJQUFJLENBQUNDLGVBQWUsR0FBRyxJQUFJekQsZUFBZSxDQUN4QyxDQUFFUyxZQUFZLENBQUNpRCxzQkFBc0IsRUFBRWhELEtBQUssQ0FBQzZDLGdCQUFnQixFQUFFLElBQUksQ0FBQzdCLHFCQUFxQixDQUFFLEVBQzNGLENBQUVpQyxjQUFjLEVBQUVDLFFBQVEsRUFBRS9CLGFBQWEsS0FBTTtNQUU3QztNQUNBO01BQ0EsTUFBTWdDLHVCQUF1QixHQUFHLEdBQUcsQ0FBQyxDQUFDOztNQUVyQztNQUNBLE1BQU1DLG9CQUFvQixHQUFHRCx1QkFBdUIsR0FBR0YsY0FBYzs7TUFFckU7TUFDQSxNQUFNSSxjQUFjLEdBQUdILFFBQVEsR0FBR04sYUFBYSxDQUFDRixHQUFHOztNQUVuRDtNQUNBLE1BQU1ZLG1CQUFtQixHQUFHZCxJQUFJLENBQUNlLEdBQUcsQ0FBRSxDQUFDLEdBQUdwQyxhQUFjLENBQUM7O01BRXpEO01BQ0E7TUFDQTtNQUNBLE1BQU1xQyxVQUFVLEdBQUcsSUFBSTs7TUFFdkI7TUFDQSxPQUFPN0QsV0FBVyxDQUFDOEQsYUFBYSxDQUFDQyxjQUFjLENBQUVGLFVBQVUsR0FBR0osb0JBQW9CLEdBQUdDLGNBQWMsR0FBR0MsbUJBQW9CLENBQUM7SUFDN0gsQ0FBQyxFQUFFO01BQ0RLLFlBQVksRUFBSUMsS0FBYSxJQUFNakUsV0FBVyxDQUFDOEQsYUFBYSxDQUFDSSxRQUFRLENBQUVELEtBQU0sQ0FBQztNQUU5RTtNQUNBRSxNQUFNLEVBQUU3RCxlQUFlLENBQUM2RCxNQUFNLENBQUNDLFlBQVksQ0FBRSxpQkFBa0IsQ0FBQztNQUNoRUMsY0FBYyxFQUFFLElBQUk7TUFDcEJDLGVBQWUsRUFBRXJFO0lBQ25CLENBQUUsQ0FBQztFQUNQO0FBQ0Y7QUFFQUosZUFBZSxDQUFDMEUsUUFBUSxDQUFFLGFBQWEsRUFBRXJFLFdBQVksQ0FBQyJ9