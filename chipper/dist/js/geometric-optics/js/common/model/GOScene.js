// Copyright 2022-2023, University of Colorado Boulder

/**
 * GOScene is base class for all scenes.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Range from '../../../../dot/js/Range.js';
import geometricOptics from '../../geometricOptics.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import PhetioObject from '../../../../tandem/js/PhetioObject.js';
import Guides from './Guides.js';
import optionize from '../../../../phet-core/js/optionize.js';
// How long the animation of light rays lasts, in seconds
const RAYS_ANIMATION_DURATION = 10;
export default class GOScene extends PhetioObject {
  // the optic, provided by the client, and associated with all scenes

  // animation time for the light rays animation, determines how far the rays have propagated from the optical object

  // optional guides, supported by the Lens screen

  // Resets things that are specific to this class.

  /**
   * @param optic - the optic, shared by all scenes
   * @param providedOptions
   */
  constructor(optic, providedOptions) {
    const options = optionize()({
      // PhetioObjectOptions
      phetioState: false
    }, providedOptions);
    super(options);
    this.optic = optic;
    this.addLinkedElement(optic, {
      tandem: options.tandem.createTandem(optic.tandem.name)
    });
    this.raysAnimationTimeProperty = new NumberProperty(0, {
      units: 's',
      range: new Range(0, RAYS_ANIMATION_DURATION),
      tandem: options.tandem.createTandem('raysAnimationTimeProperty'),
      phetioReadOnly: true
    });
    this.resetGOObjectScene = () => {
      this.raysAnimationTimeProperty.reset();
    };
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
  reset() {
    this.resetGOObjectScene();
  }
  get guides1() {
    return this._guides1;
  }
  get guides2() {
    return this._guides2;
  }

  /**
   * Begins the animation of light rays.
   */
  beginLightRaysAnimation() {
    this.raysAnimationTimeProperty.reset();
  }

  /**
   * Steps the animation of light rays.
   * @param dt - time step, in seconds
   */
  stepLightRays(dt) {
    const tNow = this.raysAnimationTimeProperty.value;
    if (tNow < RAYS_ANIMATION_DURATION) {
      this.raysAnimationTimeProperty.value = Math.min(tNow + dt, RAYS_ANIMATION_DURATION);
    }
  }

  /**
   * Initializes the optional guides, called by subclasses.
   */
  initializeGuides(guides1PositionProperty, guides2PositionProperty) {
    this._guides1 = new Guides(this.optic, guides1PositionProperty);
    this._guides2 = new Guides(this.optic, guides2PositionProperty);
  }
}
geometricOptics.register('GOScene', GOScene);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSYW5nZSIsImdlb21ldHJpY09wdGljcyIsIk51bWJlclByb3BlcnR5IiwiUGhldGlvT2JqZWN0IiwiR3VpZGVzIiwib3B0aW9uaXplIiwiUkFZU19BTklNQVRJT05fRFVSQVRJT04iLCJHT1NjZW5lIiwiY29uc3RydWN0b3IiLCJvcHRpYyIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJwaGV0aW9TdGF0ZSIsImFkZExpbmtlZEVsZW1lbnQiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJuYW1lIiwicmF5c0FuaW1hdGlvblRpbWVQcm9wZXJ0eSIsInVuaXRzIiwicmFuZ2UiLCJwaGV0aW9SZWFkT25seSIsInJlc2V0R09PYmplY3RTY2VuZSIsInJlc2V0IiwiZGlzcG9zZSIsImFzc2VydCIsImd1aWRlczEiLCJfZ3VpZGVzMSIsImd1aWRlczIiLCJfZ3VpZGVzMiIsImJlZ2luTGlnaHRSYXlzQW5pbWF0aW9uIiwic3RlcExpZ2h0UmF5cyIsImR0IiwidE5vdyIsInZhbHVlIiwiTWF0aCIsIm1pbiIsImluaXRpYWxpemVHdWlkZXMiLCJndWlkZXMxUG9zaXRpb25Qcm9wZXJ0eSIsImd1aWRlczJQb3NpdGlvblByb3BlcnR5IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJHT1NjZW5lLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIyLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEdPU2NlbmUgaXMgYmFzZSBjbGFzcyBmb3IgYWxsIHNjZW5lcy5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IGdlb21ldHJpY09wdGljcyBmcm9tICcuLi8uLi9nZW9tZXRyaWNPcHRpY3MuanMnO1xyXG5pbXBvcnQgT3B0aWMgZnJvbSAnLi9PcHRpYy5qcyc7XHJcbmltcG9ydCBOdW1iZXJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL051bWJlclByb3BlcnR5LmpzJztcclxuaW1wb3J0IFBoZXRpb09iamVjdCwgeyBQaGV0aW9PYmplY3RPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1BoZXRpb09iamVjdC5qcyc7XHJcbmltcG9ydCBHdWlkZXMgZnJvbSAnLi9HdWlkZXMuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFBpY2tSZXF1aXJlZCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja1JlcXVpcmVkLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcblxyXG4vLyBIb3cgbG9uZyB0aGUgYW5pbWF0aW9uIG9mIGxpZ2h0IHJheXMgbGFzdHMsIGluIHNlY29uZHNcclxuY29uc3QgUkFZU19BTklNQVRJT05fRFVSQVRJT04gPSAxMDtcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBFbXB0eVNlbGZPcHRpb25zO1xyXG5cclxuZXhwb3J0IHR5cGUgR09TY2VuZU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBpY2tSZXF1aXJlZDxQaGV0aW9PYmplY3RPcHRpb25zLCAndGFuZGVtJz47XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBHT1NjZW5lIGV4dGVuZHMgUGhldGlvT2JqZWN0IHtcclxuXHJcbiAgLy8gdGhlIG9wdGljLCBwcm92aWRlZCBieSB0aGUgY2xpZW50LCBhbmQgYXNzb2NpYXRlZCB3aXRoIGFsbCBzY2VuZXNcclxuICBwdWJsaWMgcmVhZG9ubHkgb3B0aWM6IE9wdGljO1xyXG5cclxuICAvLyBhbmltYXRpb24gdGltZSBmb3IgdGhlIGxpZ2h0IHJheXMgYW5pbWF0aW9uLCBkZXRlcm1pbmVzIGhvdyBmYXIgdGhlIHJheXMgaGF2ZSBwcm9wYWdhdGVkIGZyb20gdGhlIG9wdGljYWwgb2JqZWN0XHJcbiAgcHVibGljIHJlYWRvbmx5IHJheXNBbmltYXRpb25UaW1lUHJvcGVydHk6IE51bWJlclByb3BlcnR5O1xyXG5cclxuICAvLyBvcHRpb25hbCBndWlkZXMsIHN1cHBvcnRlZCBieSB0aGUgTGVucyBzY3JlZW5cclxuICBwcml2YXRlIF9ndWlkZXMxPzogR3VpZGVzO1xyXG4gIHByaXZhdGUgX2d1aWRlczI/OiBHdWlkZXM7XHJcblxyXG4gIC8vIFJlc2V0cyB0aGluZ3MgdGhhdCBhcmUgc3BlY2lmaWMgdG8gdGhpcyBjbGFzcy5cclxuICBwcml2YXRlIHJlYWRvbmx5IHJlc2V0R09PYmplY3RTY2VuZTogKCkgPT4gdm9pZDtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIG9wdGljIC0gdGhlIG9wdGljLCBzaGFyZWQgYnkgYWxsIHNjZW5lc1xyXG4gICAqIEBwYXJhbSBwcm92aWRlZE9wdGlvbnNcclxuICAgKi9cclxuICBwcm90ZWN0ZWQgY29uc3RydWN0b3IoIG9wdGljOiBPcHRpYywgcHJvdmlkZWRPcHRpb25zOiBHT1NjZW5lT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEdPU2NlbmVPcHRpb25zLCBTZWxmT3B0aW9ucywgUGhldGlvT2JqZWN0T3B0aW9ucz4oKSgge1xyXG5cclxuICAgICAgLy8gUGhldGlvT2JqZWN0T3B0aW9uc1xyXG4gICAgICBwaGV0aW9TdGF0ZTogZmFsc2VcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5vcHRpYyA9IG9wdGljO1xyXG5cclxuICAgIHRoaXMuYWRkTGlua2VkRWxlbWVudCggb3B0aWMsIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oIG9wdGljLnRhbmRlbS5uYW1lIClcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLnJheXNBbmltYXRpb25UaW1lUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIDAsIHtcclxuICAgICAgdW5pdHM6ICdzJyxcclxuICAgICAgcmFuZ2U6IG5ldyBSYW5nZSggMCwgUkFZU19BTklNQVRJT05fRFVSQVRJT04gKSxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdyYXlzQW5pbWF0aW9uVGltZVByb3BlcnR5JyApLFxyXG4gICAgICBwaGV0aW9SZWFkT25seTogdHJ1ZVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMucmVzZXRHT09iamVjdFNjZW5lID0gKCkgPT4ge1xyXG4gICAgICB0aGlzLnJheXNBbmltYXRpb25UaW1lUHJvcGVydHkucmVzZXQoKTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnZGlzcG9zZSBpcyBub3Qgc3VwcG9ydGVkLCBleGlzdHMgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgc2ltJyApO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5yZXNldEdPT2JqZWN0U2NlbmUoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgZ3VpZGVzMSgpOiBHdWlkZXMgfCB1bmRlZmluZWQgeyByZXR1cm4gdGhpcy5fZ3VpZGVzMTsgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGd1aWRlczIoKTogR3VpZGVzIHwgdW5kZWZpbmVkIHsgcmV0dXJuIHRoaXMuX2d1aWRlczI7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogQmVnaW5zIHRoZSBhbmltYXRpb24gb2YgbGlnaHQgcmF5cy5cclxuICAgKi9cclxuICBwdWJsaWMgYmVnaW5MaWdodFJheXNBbmltYXRpb24oKTogdm9pZCB7XHJcbiAgICB0aGlzLnJheXNBbmltYXRpb25UaW1lUHJvcGVydHkucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0ZXBzIHRoZSBhbmltYXRpb24gb2YgbGlnaHQgcmF5cy5cclxuICAgKiBAcGFyYW0gZHQgLSB0aW1lIHN0ZXAsIGluIHNlY29uZHNcclxuICAgKi9cclxuICBwdWJsaWMgc3RlcExpZ2h0UmF5cyggZHQ6IG51bWJlciApOiB2b2lkIHtcclxuICAgIGNvbnN0IHROb3cgPSB0aGlzLnJheXNBbmltYXRpb25UaW1lUHJvcGVydHkudmFsdWU7XHJcbiAgICBpZiAoIHROb3cgPCBSQVlTX0FOSU1BVElPTl9EVVJBVElPTiApIHtcclxuICAgICAgdGhpcy5yYXlzQW5pbWF0aW9uVGltZVByb3BlcnR5LnZhbHVlID0gTWF0aC5taW4oIHROb3cgKyBkdCwgUkFZU19BTklNQVRJT05fRFVSQVRJT04gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemVzIHRoZSBvcHRpb25hbCBndWlkZXMsIGNhbGxlZCBieSBzdWJjbGFzc2VzLlxyXG4gICAqL1xyXG4gIHByb3RlY3RlZCBpbml0aWFsaXplR3VpZGVzKCBndWlkZXMxUG9zaXRpb25Qcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8VmVjdG9yMj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGd1aWRlczJQb3NpdGlvblByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxWZWN0b3IyPiApOiB2b2lkIHtcclxuXHJcbiAgICB0aGlzLl9ndWlkZXMxID0gbmV3IEd1aWRlcyggdGhpcy5vcHRpYywgZ3VpZGVzMVBvc2l0aW9uUHJvcGVydHkgKTtcclxuXHJcbiAgICB0aGlzLl9ndWlkZXMyID0gbmV3IEd1aWRlcyggdGhpcy5vcHRpYywgZ3VpZGVzMlBvc2l0aW9uUHJvcGVydHkgKTtcclxuICB9XHJcbn1cclxuXHJcbmdlb21ldHJpY09wdGljcy5yZWdpc3RlciggJ0dPU2NlbmUnLCBHT1NjZW5lICk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxLQUFLLE1BQU0sNkJBQTZCO0FBQy9DLE9BQU9DLGVBQWUsTUFBTSwwQkFBMEI7QUFFdEQsT0FBT0MsY0FBYyxNQUFNLHVDQUF1QztBQUNsRSxPQUFPQyxZQUFZLE1BQStCLHVDQUF1QztBQUN6RixPQUFPQyxNQUFNLE1BQU0sYUFBYTtBQUNoQyxPQUFPQyxTQUFTLE1BQTRCLHVDQUF1QztBQUtuRjtBQUNBLE1BQU1DLHVCQUF1QixHQUFHLEVBQUU7QUFNbEMsZUFBZSxNQUFlQyxPQUFPLFNBQVNKLFlBQVksQ0FBQztFQUV6RDs7RUFHQTs7RUFHQTs7RUFJQTs7RUFHQTtBQUNGO0FBQ0E7QUFDQTtFQUNZSyxXQUFXQSxDQUFFQyxLQUFZLEVBQUVDLGVBQStCLEVBQUc7SUFFckUsTUFBTUMsT0FBTyxHQUFHTixTQUFTLENBQW1ELENBQUMsQ0FBRTtNQUU3RTtNQUNBTyxXQUFXLEVBQUU7SUFDZixDQUFDLEVBQUVGLGVBQWdCLENBQUM7SUFFcEIsS0FBSyxDQUFFQyxPQUFRLENBQUM7SUFFaEIsSUFBSSxDQUFDRixLQUFLLEdBQUdBLEtBQUs7SUFFbEIsSUFBSSxDQUFDSSxnQkFBZ0IsQ0FBRUosS0FBSyxFQUFFO01BQzVCSyxNQUFNLEVBQUVILE9BQU8sQ0FBQ0csTUFBTSxDQUFDQyxZQUFZLENBQUVOLEtBQUssQ0FBQ0ssTUFBTSxDQUFDRSxJQUFLO0lBQ3pELENBQUUsQ0FBQztJQUVILElBQUksQ0FBQ0MseUJBQXlCLEdBQUcsSUFBSWYsY0FBYyxDQUFFLENBQUMsRUFBRTtNQUN0RGdCLEtBQUssRUFBRSxHQUFHO01BQ1ZDLEtBQUssRUFBRSxJQUFJbkIsS0FBSyxDQUFFLENBQUMsRUFBRU0sdUJBQXdCLENBQUM7TUFDOUNRLE1BQU0sRUFBRUgsT0FBTyxDQUFDRyxNQUFNLENBQUNDLFlBQVksQ0FBRSwyQkFBNEIsQ0FBQztNQUNsRUssY0FBYyxFQUFFO0lBQ2xCLENBQUUsQ0FBQztJQUVILElBQUksQ0FBQ0Msa0JBQWtCLEdBQUcsTUFBTTtNQUM5QixJQUFJLENBQUNKLHlCQUF5QixDQUFDSyxLQUFLLENBQUMsQ0FBQztJQUN4QyxDQUFDO0VBQ0g7RUFFZ0JDLE9BQU9BLENBQUEsRUFBUztJQUM5QkMsTUFBTSxJQUFJQSxNQUFNLENBQUUsS0FBSyxFQUFFLDhEQUErRCxDQUFDO0lBQ3pGLEtBQUssQ0FBQ0QsT0FBTyxDQUFDLENBQUM7RUFDakI7RUFFT0QsS0FBS0EsQ0FBQSxFQUFTO0lBQ25CLElBQUksQ0FBQ0Qsa0JBQWtCLENBQUMsQ0FBQztFQUMzQjtFQUVBLElBQVdJLE9BQU9BLENBQUEsRUFBdUI7SUFBRSxPQUFPLElBQUksQ0FBQ0MsUUFBUTtFQUFFO0VBRWpFLElBQVdDLE9BQU9BLENBQUEsRUFBdUI7SUFBRSxPQUFPLElBQUksQ0FBQ0MsUUFBUTtFQUFFOztFQUVqRTtBQUNGO0FBQ0E7RUFDU0MsdUJBQXVCQSxDQUFBLEVBQVM7SUFDckMsSUFBSSxDQUFDWix5QkFBeUIsQ0FBQ0ssS0FBSyxDQUFDLENBQUM7RUFDeEM7O0VBRUE7QUFDRjtBQUNBO0FBQ0E7RUFDU1EsYUFBYUEsQ0FBRUMsRUFBVSxFQUFTO0lBQ3ZDLE1BQU1DLElBQUksR0FBRyxJQUFJLENBQUNmLHlCQUF5QixDQUFDZ0IsS0FBSztJQUNqRCxJQUFLRCxJQUFJLEdBQUcxQix1QkFBdUIsRUFBRztNQUNwQyxJQUFJLENBQUNXLHlCQUF5QixDQUFDZ0IsS0FBSyxHQUFHQyxJQUFJLENBQUNDLEdBQUcsQ0FBRUgsSUFBSSxHQUFHRCxFQUFFLEVBQUV6Qix1QkFBd0IsQ0FBQztJQUN2RjtFQUNGOztFQUVBO0FBQ0Y7QUFDQTtFQUNZOEIsZ0JBQWdCQSxDQUFFQyx1QkFBbUQsRUFDbkRDLHVCQUFtRCxFQUFTO0lBRXRGLElBQUksQ0FBQ1osUUFBUSxHQUFHLElBQUl0QixNQUFNLENBQUUsSUFBSSxDQUFDSyxLQUFLLEVBQUU0Qix1QkFBd0IsQ0FBQztJQUVqRSxJQUFJLENBQUNULFFBQVEsR0FBRyxJQUFJeEIsTUFBTSxDQUFFLElBQUksQ0FBQ0ssS0FBSyxFQUFFNkIsdUJBQXdCLENBQUM7RUFDbkU7QUFDRjtBQUVBckMsZUFBZSxDQUFDc0MsUUFBUSxDQUFFLFNBQVMsRUFBRWhDLE9BQVEsQ0FBQyJ9