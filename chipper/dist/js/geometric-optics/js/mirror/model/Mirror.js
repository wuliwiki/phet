// Copyright 2021-2023, University of Colorado Boulder

/**
 * Mirror is the model of a mirror.
 *
 * @author Martin Veillette
 * @author Chris Malley (PixelZoom, Inc.)
 */

import RangeWithValue from '../../../../dot/js/RangeWithValue.js';
import Optic from '../../common/model/Optic.js';
import geometricOptics from '../../geometricOptics.js';
import MirrorShapes from './MirrorShapes.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import optionize from '../../../../phet-core/js/optionize.js';
import GOQueryParameters from '../../common/GOQueryParameters.js';
// IOR is a fixed value for both the 'direct' and 'indirect' focal-length models.
// Although a mirror does not have an IOR, its focal length is equivalent to a lens with an IOR of 2.
const INDEX_OF_REFRACTION_RANGE = new RangeWithValue(2, 2, 2); // fixed

export default class Mirror extends Optic {
  // See Optic

  constructor(providedOptions) {
    const focalLengthModelsTandem = providedOptions.tandem.createTandem('focalLengthModels');
    const radiusOfCurvatureMagnitudePropertyFeatured = !providedOptions.isBasicsVersion; // because Basics version only has a flat mirror
    const indexOfRefractionPropertyFeatured = false; // because index of refraction is 'Hollywooded' for Mirror

    const options = optionize()({
      // OpticOptions
      opticSurfaceTypes: providedOptions.isBasicsVersion ? ['flat'] : ['concave', 'convex', 'flat'],
      diameterRange: GOQueryParameters.dRangeMirror,
      // in cm
      sign: -1,
      // a positive distance indicates that the image is to the left of the mirror, so invert the sign
      indexOfRefractionPropertyFeatured: indexOfRefractionPropertyFeatured,
      radiusOfCurvaturePropertyFeatured: radiusOfCurvatureMagnitudePropertyFeatured,
      directFocalLengthModelOptions: {
        focalLengthMagnitudeRange: GOQueryParameters.fRangeMirror,
        // in cm
        indexOfRefractionRange: INDEX_OF_REFRACTION_RANGE,
        tandem: focalLengthModelsTandem.createTandem('directFocalLengthModel')
      },
      indirectFocalLengthModelOptions: {
        radiusOfCurvatureMagnitudeRange: GOQueryParameters.rocRangeMirror,
        // in cm
        radiusOfCurvatureMagnitudePropertyFeatured: radiusOfCurvatureMagnitudePropertyFeatured,
        indexOfRefractionRange: INDEX_OF_REFRACTION_RANGE,
        indexOfRefractionPropertyFeatured: indexOfRefractionPropertyFeatured,
        tandem: focalLengthModelsTandem.createTandem('indirectFocalLengthModel')
      }
    }, providedOptions);
    assert && assert(2 * options.directFocalLengthModelOptions.focalLengthMagnitudeRange.defaultValue === options.indirectFocalLengthModelOptions.radiusOfCurvatureMagnitudeRange.defaultValue);
    super(options);
    this.shapesProperty = new DerivedProperty([this.radiusOfCurvatureProperty, this.diameterProperty], (radiusOfCurvature, diameter) => new MirrorShapes(radiusOfCurvature, diameter));
  }

  /**
   * A mirror is converging if it is concave.
   */
  isConverging(opticSurfaceType) {
    return opticSurfaceType === 'concave';
  }

  /**
   * Returns the most extreme position within the mirror that would ensure that a ray would be transmitted (or reflected).
   * See https://github.com/phetsims/geometric-optics/issues/111
   * @param opticalObjectPosition
   * @param opticalImagePosition
   * @param isTop - true = top extreme, false = bottom extreme
   */
  getExtremumPoint(opticalObjectPosition, opticalImagePosition, isTop) {
    // Erode the bounds a tiny bit so that the point is always within the bounds.
    const activeBounds = this.getActiveBoundsTranslated().erodedY(1e-6);

    // convenience variables
    const isConcave = this.opticSurfaceTypeProperty.value === 'concave';
    const leftPoint = isTop ? activeBounds.leftTop : activeBounds.leftBottom;
    const rightPoint = isTop ? activeBounds.rightTop : activeBounds.rightBottom;

    // since mirror reflects light, the extremum point is on the mirror itself
    return isConcave ? leftPoint : rightPoint;
  }

  /**
   * Is the optic a mirror whose shape is exclusively flat?  This is (regrettably) needed to conditionally
   * instrument/omit PhET-iO elements for the Basics version of the sim, which has only a flat mirror.
   */
  isExclusivelyFlatMirror() {
    return this.opticSurfaceTypeProperty.validValues.length === 1 && this.opticSurfaceTypeProperty.value === 'flat';
  }
}
geometricOptics.register('Mirror', Mirror);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSYW5nZVdpdGhWYWx1ZSIsIk9wdGljIiwiZ2VvbWV0cmljT3B0aWNzIiwiTWlycm9yU2hhcGVzIiwiRGVyaXZlZFByb3BlcnR5Iiwib3B0aW9uaXplIiwiR09RdWVyeVBhcmFtZXRlcnMiLCJJTkRFWF9PRl9SRUZSQUNUSU9OX1JBTkdFIiwiTWlycm9yIiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJmb2NhbExlbmd0aE1vZGVsc1RhbmRlbSIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsInJhZGl1c09mQ3VydmF0dXJlTWFnbml0dWRlUHJvcGVydHlGZWF0dXJlZCIsImlzQmFzaWNzVmVyc2lvbiIsImluZGV4T2ZSZWZyYWN0aW9uUHJvcGVydHlGZWF0dXJlZCIsIm9wdGlvbnMiLCJvcHRpY1N1cmZhY2VUeXBlcyIsImRpYW1ldGVyUmFuZ2UiLCJkUmFuZ2VNaXJyb3IiLCJzaWduIiwicmFkaXVzT2ZDdXJ2YXR1cmVQcm9wZXJ0eUZlYXR1cmVkIiwiZGlyZWN0Rm9jYWxMZW5ndGhNb2RlbE9wdGlvbnMiLCJmb2NhbExlbmd0aE1hZ25pdHVkZVJhbmdlIiwiZlJhbmdlTWlycm9yIiwiaW5kZXhPZlJlZnJhY3Rpb25SYW5nZSIsImluZGlyZWN0Rm9jYWxMZW5ndGhNb2RlbE9wdGlvbnMiLCJyYWRpdXNPZkN1cnZhdHVyZU1hZ25pdHVkZVJhbmdlIiwicm9jUmFuZ2VNaXJyb3IiLCJhc3NlcnQiLCJkZWZhdWx0VmFsdWUiLCJzaGFwZXNQcm9wZXJ0eSIsInJhZGl1c09mQ3VydmF0dXJlUHJvcGVydHkiLCJkaWFtZXRlclByb3BlcnR5IiwicmFkaXVzT2ZDdXJ2YXR1cmUiLCJkaWFtZXRlciIsImlzQ29udmVyZ2luZyIsIm9wdGljU3VyZmFjZVR5cGUiLCJnZXRFeHRyZW11bVBvaW50Iiwib3B0aWNhbE9iamVjdFBvc2l0aW9uIiwib3B0aWNhbEltYWdlUG9zaXRpb24iLCJpc1RvcCIsImFjdGl2ZUJvdW5kcyIsImdldEFjdGl2ZUJvdW5kc1RyYW5zbGF0ZWQiLCJlcm9kZWRZIiwiaXNDb25jYXZlIiwib3B0aWNTdXJmYWNlVHlwZVByb3BlcnR5IiwidmFsdWUiLCJsZWZ0UG9pbnQiLCJsZWZ0VG9wIiwibGVmdEJvdHRvbSIsInJpZ2h0UG9pbnQiLCJyaWdodFRvcCIsInJpZ2h0Qm90dG9tIiwiaXNFeGNsdXNpdmVseUZsYXRNaXJyb3IiLCJ2YWxpZFZhbHVlcyIsImxlbmd0aCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiTWlycm9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIxLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIE1pcnJvciBpcyB0aGUgbW9kZWwgb2YgYSBtaXJyb3IuXHJcbiAqXHJcbiAqIEBhdXRob3IgTWFydGluIFZlaWxsZXR0ZVxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBSYW5nZVdpdGhWYWx1ZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2VXaXRoVmFsdWUuanMnO1xyXG5pbXBvcnQgT3B0aWMsIHsgT3B0aWNPcHRpb25zIH0gZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL09wdGljLmpzJztcclxuaW1wb3J0IGdlb21ldHJpY09wdGljcyBmcm9tICcuLi8uLi9nZW9tZXRyaWNPcHRpY3MuanMnO1xyXG5pbXBvcnQgeyBPcHRpY1N1cmZhY2VUeXBlIH0gZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL09wdGljU3VyZmFjZVR5cGUuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCBNaXJyb3JTaGFwZXMgZnJvbSAnLi9NaXJyb3JTaGFwZXMuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgR09RdWVyeVBhcmFtZXRlcnMgZnJvbSAnLi4vLi4vY29tbW9uL0dPUXVlcnlQYXJhbWV0ZXJzLmpzJztcclxuaW1wb3J0IHsgR09TaW1PcHRpb25zIH0gZnJvbSAnLi4vLi4vR09TaW0uanMnO1xyXG5cclxuLy8gSU9SIGlzIGEgZml4ZWQgdmFsdWUgZm9yIGJvdGggdGhlICdkaXJlY3QnIGFuZCAnaW5kaXJlY3QnIGZvY2FsLWxlbmd0aCBtb2RlbHMuXHJcbi8vIEFsdGhvdWdoIGEgbWlycm9yIGRvZXMgbm90IGhhdmUgYW4gSU9SLCBpdHMgZm9jYWwgbGVuZ3RoIGlzIGVxdWl2YWxlbnQgdG8gYSBsZW5zIHdpdGggYW4gSU9SIG9mIDIuXHJcbmNvbnN0IElOREVYX09GX1JFRlJBQ1RJT05fUkFOR0UgPSBuZXcgUmFuZ2VXaXRoVmFsdWUoIDIsIDIsIDIgKTsgLy8gZml4ZWRcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBQaWNrUmVxdWlyZWQ8R09TaW1PcHRpb25zLCAnaXNCYXNpY3NWZXJzaW9uJz47XHJcblxyXG50eXBlIE1pcnJvck9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBpY2tSZXF1aXJlZDxPcHRpY09wdGlvbnMsICd0YW5kZW0nPjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1pcnJvciBleHRlbmRzIE9wdGljIHtcclxuXHJcbiAgLy8gU2VlIE9wdGljXHJcbiAgcHVibGljIHJlYWRvbmx5IHNoYXBlc1Byb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxNaXJyb3JTaGFwZXM+O1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3ZpZGVkT3B0aW9uczogTWlycm9yT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBmb2NhbExlbmd0aE1vZGVsc1RhbmRlbSA9IHByb3ZpZGVkT3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZm9jYWxMZW5ndGhNb2RlbHMnICk7XHJcblxyXG4gICAgY29uc3QgcmFkaXVzT2ZDdXJ2YXR1cmVNYWduaXR1ZGVQcm9wZXJ0eUZlYXR1cmVkID0gIXByb3ZpZGVkT3B0aW9ucy5pc0Jhc2ljc1ZlcnNpb247IC8vIGJlY2F1c2UgQmFzaWNzIHZlcnNpb24gb25seSBoYXMgYSBmbGF0IG1pcnJvclxyXG4gICAgY29uc3QgaW5kZXhPZlJlZnJhY3Rpb25Qcm9wZXJ0eUZlYXR1cmVkID0gZmFsc2U7IC8vIGJlY2F1c2UgaW5kZXggb2YgcmVmcmFjdGlvbiBpcyAnSG9sbHl3b29kZWQnIGZvciBNaXJyb3JcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPE1pcnJvck9wdGlvbnMsIFNlbGZPcHRpb25zLCBPcHRpY09wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIE9wdGljT3B0aW9uc1xyXG4gICAgICBvcHRpY1N1cmZhY2VUeXBlczogcHJvdmlkZWRPcHRpb25zLmlzQmFzaWNzVmVyc2lvbiA/IFsgJ2ZsYXQnIF0gOiBbICdjb25jYXZlJywgJ2NvbnZleCcsICdmbGF0JyBdLFxyXG4gICAgICBkaWFtZXRlclJhbmdlOiBHT1F1ZXJ5UGFyYW1ldGVycy5kUmFuZ2VNaXJyb3IsIC8vIGluIGNtXHJcbiAgICAgIHNpZ246IC0xLCAvLyBhIHBvc2l0aXZlIGRpc3RhbmNlIGluZGljYXRlcyB0aGF0IHRoZSBpbWFnZSBpcyB0byB0aGUgbGVmdCBvZiB0aGUgbWlycm9yLCBzbyBpbnZlcnQgdGhlIHNpZ25cclxuICAgICAgaW5kZXhPZlJlZnJhY3Rpb25Qcm9wZXJ0eUZlYXR1cmVkOiBpbmRleE9mUmVmcmFjdGlvblByb3BlcnR5RmVhdHVyZWQsXHJcbiAgICAgIHJhZGl1c09mQ3VydmF0dXJlUHJvcGVydHlGZWF0dXJlZDogcmFkaXVzT2ZDdXJ2YXR1cmVNYWduaXR1ZGVQcm9wZXJ0eUZlYXR1cmVkLFxyXG4gICAgICBkaXJlY3RGb2NhbExlbmd0aE1vZGVsT3B0aW9uczoge1xyXG4gICAgICAgIGZvY2FsTGVuZ3RoTWFnbml0dWRlUmFuZ2U6IEdPUXVlcnlQYXJhbWV0ZXJzLmZSYW5nZU1pcnJvciwgLy8gaW4gY21cclxuICAgICAgICBpbmRleE9mUmVmcmFjdGlvblJhbmdlOiBJTkRFWF9PRl9SRUZSQUNUSU9OX1JBTkdFLFxyXG4gICAgICAgIHRhbmRlbTogZm9jYWxMZW5ndGhNb2RlbHNUYW5kZW0uY3JlYXRlVGFuZGVtKCAnZGlyZWN0Rm9jYWxMZW5ndGhNb2RlbCcgKVxyXG4gICAgICB9LFxyXG4gICAgICBpbmRpcmVjdEZvY2FsTGVuZ3RoTW9kZWxPcHRpb25zOiB7XHJcbiAgICAgICAgcmFkaXVzT2ZDdXJ2YXR1cmVNYWduaXR1ZGVSYW5nZTogR09RdWVyeVBhcmFtZXRlcnMucm9jUmFuZ2VNaXJyb3IsIC8vIGluIGNtXHJcbiAgICAgICAgcmFkaXVzT2ZDdXJ2YXR1cmVNYWduaXR1ZGVQcm9wZXJ0eUZlYXR1cmVkOiByYWRpdXNPZkN1cnZhdHVyZU1hZ25pdHVkZVByb3BlcnR5RmVhdHVyZWQsXHJcbiAgICAgICAgaW5kZXhPZlJlZnJhY3Rpb25SYW5nZTogSU5ERVhfT0ZfUkVGUkFDVElPTl9SQU5HRSxcclxuICAgICAgICBpbmRleE9mUmVmcmFjdGlvblByb3BlcnR5RmVhdHVyZWQ6IGluZGV4T2ZSZWZyYWN0aW9uUHJvcGVydHlGZWF0dXJlZCxcclxuICAgICAgICB0YW5kZW06IGZvY2FsTGVuZ3RoTW9kZWxzVGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2luZGlyZWN0Rm9jYWxMZW5ndGhNb2RlbCcgKVxyXG4gICAgICB9XHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCAyICogb3B0aW9ucy5kaXJlY3RGb2NhbExlbmd0aE1vZGVsT3B0aW9ucy5mb2NhbExlbmd0aE1hZ25pdHVkZVJhbmdlLmRlZmF1bHRWYWx1ZSA9PT1cclxuICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuaW5kaXJlY3RGb2NhbExlbmd0aE1vZGVsT3B0aW9ucy5yYWRpdXNPZkN1cnZhdHVyZU1hZ25pdHVkZVJhbmdlLmRlZmF1bHRWYWx1ZSApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5zaGFwZXNQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5yYWRpdXNPZkN1cnZhdHVyZVByb3BlcnR5LCB0aGlzLmRpYW1ldGVyUHJvcGVydHkgXSxcclxuICAgICAgKCByYWRpdXNPZkN1cnZhdHVyZSwgZGlhbWV0ZXIgKSA9PiBuZXcgTWlycm9yU2hhcGVzKCByYWRpdXNPZkN1cnZhdHVyZSwgZGlhbWV0ZXIgKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEEgbWlycm9yIGlzIGNvbnZlcmdpbmcgaWYgaXQgaXMgY29uY2F2ZS5cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgaXNDb252ZXJnaW5nKCBvcHRpY1N1cmZhY2VUeXBlOiBPcHRpY1N1cmZhY2VUeXBlICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICggb3B0aWNTdXJmYWNlVHlwZSA9PT0gJ2NvbmNhdmUnICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBtb3N0IGV4dHJlbWUgcG9zaXRpb24gd2l0aGluIHRoZSBtaXJyb3IgdGhhdCB3b3VsZCBlbnN1cmUgdGhhdCBhIHJheSB3b3VsZCBiZSB0cmFuc21pdHRlZCAob3IgcmVmbGVjdGVkKS5cclxuICAgKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2dlb21ldHJpYy1vcHRpY3MvaXNzdWVzLzExMVxyXG4gICAqIEBwYXJhbSBvcHRpY2FsT2JqZWN0UG9zaXRpb25cclxuICAgKiBAcGFyYW0gb3B0aWNhbEltYWdlUG9zaXRpb25cclxuICAgKiBAcGFyYW0gaXNUb3AgLSB0cnVlID0gdG9wIGV4dHJlbWUsIGZhbHNlID0gYm90dG9tIGV4dHJlbWVcclxuICAgKi9cclxuICBwcm90ZWN0ZWQgZ2V0RXh0cmVtdW1Qb2ludCggb3B0aWNhbE9iamVjdFBvc2l0aW9uOiBWZWN0b3IyLCBvcHRpY2FsSW1hZ2VQb3NpdGlvbjogVmVjdG9yMiwgaXNUb3A6IGJvb2xlYW4gKTogVmVjdG9yMiB7XHJcblxyXG4gICAgLy8gRXJvZGUgdGhlIGJvdW5kcyBhIHRpbnkgYml0IHNvIHRoYXQgdGhlIHBvaW50IGlzIGFsd2F5cyB3aXRoaW4gdGhlIGJvdW5kcy5cclxuICAgIGNvbnN0IGFjdGl2ZUJvdW5kcyA9IHRoaXMuZ2V0QWN0aXZlQm91bmRzVHJhbnNsYXRlZCgpLmVyb2RlZFkoIDFlLTYgKTtcclxuXHJcbiAgICAvLyBjb252ZW5pZW5jZSB2YXJpYWJsZXNcclxuICAgIGNvbnN0IGlzQ29uY2F2ZSA9ICggdGhpcy5vcHRpY1N1cmZhY2VUeXBlUHJvcGVydHkudmFsdWUgPT09ICdjb25jYXZlJyApO1xyXG4gICAgY29uc3QgbGVmdFBvaW50ID0gaXNUb3AgPyBhY3RpdmVCb3VuZHMubGVmdFRvcCA6IGFjdGl2ZUJvdW5kcy5sZWZ0Qm90dG9tO1xyXG4gICAgY29uc3QgcmlnaHRQb2ludCA9IGlzVG9wID8gYWN0aXZlQm91bmRzLnJpZ2h0VG9wIDogYWN0aXZlQm91bmRzLnJpZ2h0Qm90dG9tO1xyXG5cclxuICAgIC8vIHNpbmNlIG1pcnJvciByZWZsZWN0cyBsaWdodCwgdGhlIGV4dHJlbXVtIHBvaW50IGlzIG9uIHRoZSBtaXJyb3IgaXRzZWxmXHJcbiAgICByZXR1cm4gaXNDb25jYXZlID8gbGVmdFBvaW50IDogcmlnaHRQb2ludDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIElzIHRoZSBvcHRpYyBhIG1pcnJvciB3aG9zZSBzaGFwZSBpcyBleGNsdXNpdmVseSBmbGF0PyAgVGhpcyBpcyAocmVncmV0dGFibHkpIG5lZWRlZCB0byBjb25kaXRpb25hbGx5XHJcbiAgICogaW5zdHJ1bWVudC9vbWl0IFBoRVQtaU8gZWxlbWVudHMgZm9yIHRoZSBCYXNpY3MgdmVyc2lvbiBvZiB0aGUgc2ltLCB3aGljaCBoYXMgb25seSBhIGZsYXQgbWlycm9yLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBpc0V4Y2x1c2l2ZWx5RmxhdE1pcnJvcigpOiBib29sZWFuIHtcclxuICAgIHJldHVybiAoIHRoaXMub3B0aWNTdXJmYWNlVHlwZVByb3BlcnR5LnZhbGlkVmFsdWVzIS5sZW5ndGggPT09IDEgKSAmJlxyXG4gICAgICAgICAgICggdGhpcy5vcHRpY1N1cmZhY2VUeXBlUHJvcGVydHkudmFsdWUgPT09ICdmbGF0JyApO1xyXG4gIH1cclxufVxyXG5cclxuZ2VvbWV0cmljT3B0aWNzLnJlZ2lzdGVyKCAnTWlycm9yJywgTWlycm9yICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsY0FBYyxNQUFNLHNDQUFzQztBQUNqRSxPQUFPQyxLQUFLLE1BQXdCLDZCQUE2QjtBQUNqRSxPQUFPQyxlQUFlLE1BQU0sMEJBQTBCO0FBR3RELE9BQU9DLFlBQVksTUFBTSxtQkFBbUI7QUFFNUMsT0FBT0MsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxTQUFTLE1BQU0sdUNBQXVDO0FBRTdELE9BQU9DLGlCQUFpQixNQUFNLG1DQUFtQztBQUdqRTtBQUNBO0FBQ0EsTUFBTUMseUJBQXlCLEdBQUcsSUFBSVAsY0FBYyxDQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBRSxDQUFDLENBQUMsQ0FBQzs7QUFNakUsZUFBZSxNQUFNUSxNQUFNLFNBQVNQLEtBQUssQ0FBQztFQUV4Qzs7RUFHT1EsV0FBV0EsQ0FBRUMsZUFBOEIsRUFBRztJQUVuRCxNQUFNQyx1QkFBdUIsR0FBR0QsZUFBZSxDQUFDRSxN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