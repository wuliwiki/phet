// Copyright 2022-2023, University of Colorado Boulder

/**
 * GOSim is the subclass of Sim used by both geometric-optics and geometric-optics-basics.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Sim from '../../joist/js/Sim.js';
import Tandem from '../../tandem/js/Tandem.js';
import geometricOptics from './geometricOptics.js';
import LensScreen from './lens/LensScreen.js';
import MirrorScreen from './mirror/MirrorScreen.js';
import GOConstants from './common/GOConstants.js';
import optionize from '../../phet-core/js/optionize.js';
import GOPreferencesNode from './common/view/GOPreferencesNode.js';
import PreferencesModel from '../../joist/js/preferences/PreferencesModel.js';
import GOPreferences from './common/model/GOPreferences.js';
import GOKeyboardHelpContent from './common/view/GOKeyboardHelpContent.js';
export default class GOSim extends Sim {
  constructor(titleProperty, providedOptions) {
    const options = optionize()({
      // SimOptions
      credits: GOConstants.CREDITS,
      preferencesModel: new PreferencesModel({
        simulationOptions: {
          customPreferences: [{
            createContent: tandem => new GOPreferencesNode({
              isBasicsVersion: providedOptions.isBasicsVersion,
              tandem: tandem.createTandem('simPreferences')
            }),
            modelLinkables: [{
              property: GOPreferences.focalLengthModelTypeProperty
            }, {
              property: GOPreferences.add2FPointsCheckboxProperty
            }, {
              property: GOPreferences.cueingArrowsEnabledProperty
            }]
          }]
        }
      })
    }, providedOptions);

    // Since keyboard-help is identical for both screens, save memory by reusing the same instance of keyboardHelpNode
    // for both screens, without creating a memory leak.
    let keyboardHelpNode = null;
    const createKeyboardHelpNode = () => {
      if (!keyboardHelpNode) {
        keyboardHelpNode = new GOKeyboardHelpContent();
        keyboardHelpNode.disposeEmitter.addListener(function disposeListener() {
          if (keyboardHelpNode) {
            if (keyboardHelpNode.disposeEmitter.hasListener(disposeListener)) {
              keyboardHelpNode.disposeEmitter.removeListener(disposeListener);
            }
            keyboardHelpNode = null;
          }
        });
      }
      return keyboardHelpNode;
    };
    super(titleProperty, [new LensScreen({
      isBasicsVersion: options.isBasicsVersion,
      createKeyboardHelpNode: createKeyboardHelpNode,
      tandem: Tandem.ROOT.createTandem('lensScreen')
    }), new MirrorScreen({
      isBasicsVersion: options.isBasicsVersion,
      createKeyboardHelpNode: createKeyboardHelpNode,
      tandem: Tandem.ROOT.createTandem('mirrorScreen')
    })], options);
  }
}
geometricOptics.register('GOSim', GOSim);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaW0iLCJUYW5kZW0iLCJnZW9tZXRyaWNPcHRpY3MiLCJMZW5zU2NyZWVuIiwiTWlycm9yU2NyZWVuIiwiR09Db25zdGFudHMiLCJvcHRpb25pemUiLCJHT1ByZWZlcmVuY2VzTm9kZSIsIlByZWZlcmVuY2VzTW9kZWwiLCJHT1ByZWZlcmVuY2VzIiwiR09LZXlib2FyZEhlbHBDb250ZW50IiwiR09TaW0iLCJjb25zdHJ1Y3RvciIsInRpdGxlUHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwiY3JlZGl0cyIsIkNSRURJVFMiLCJwcmVmZXJlbmNlc01vZGVsIiwic2ltdWxhdGlvbk9wdGlvbnMiLCJjdXN0b21QcmVmZXJlbmNlcyIsImNyZWF0ZUNvbnRlbnQiLCJ0YW5kZW0iLCJpc0Jhc2ljc1ZlcnNpb24iLCJjcmVhdGVUYW5kZW0iLCJtb2RlbExpbmthYmxlcyIsInByb3BlcnR5IiwiZm9jYWxMZW5ndGhNb2RlbFR5cGVQcm9wZXJ0eSIsImFkZDJGUG9pbnRzQ2hlY2tib3hQcm9wZXJ0eSIsImN1ZWluZ0Fycm93c0VuYWJsZWRQcm9wZXJ0eSIsImtleWJvYXJkSGVscE5vZGUiLCJjcmVhdGVLZXlib2FyZEhlbHBOb2RlIiwiZGlzcG9zZUVtaXR0ZXIiLCJhZGRMaXN0ZW5lciIsImRpc3Bvc2VMaXN0ZW5lciIsImhhc0xpc3RlbmVyIiwicmVtb3ZlTGlzdGVuZXIiLCJST09UIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJHT1NpbS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMi0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBHT1NpbSBpcyB0aGUgc3ViY2xhc3Mgb2YgU2ltIHVzZWQgYnkgYm90aCBnZW9tZXRyaWMtb3B0aWNzIGFuZCBnZW9tZXRyaWMtb3B0aWNzLWJhc2ljcy5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgU2ltLCB7IFNpbU9wdGlvbnMgfSBmcm9tICcuLi8uLi9qb2lzdC9qcy9TaW0uanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgZ2VvbWV0cmljT3B0aWNzIGZyb20gJy4vZ2VvbWV0cmljT3B0aWNzLmpzJztcclxuaW1wb3J0IExlbnNTY3JlZW4gZnJvbSAnLi9sZW5zL0xlbnNTY3JlZW4uanMnO1xyXG5pbXBvcnQgTWlycm9yU2NyZWVuIGZyb20gJy4vbWlycm9yL01pcnJvclNjcmVlbi5qcyc7XHJcbmltcG9ydCBHT0NvbnN0YW50cyBmcm9tICcuL2NvbW1vbi9HT0NvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBHT1ByZWZlcmVuY2VzTm9kZSBmcm9tICcuL2NvbW1vbi92aWV3L0dPUHJlZmVyZW5jZXNOb2RlLmpzJztcclxuaW1wb3J0IFBpY2tPcHRpb25hbCBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja09wdGlvbmFsLmpzJztcclxuaW1wb3J0IFByZWZlcmVuY2VzTW9kZWwgZnJvbSAnLi4vLi4vam9pc3QvanMvcHJlZmVyZW5jZXMvUHJlZmVyZW5jZXNNb2RlbC5qcyc7XHJcbmltcG9ydCBHT1ByZWZlcmVuY2VzIGZyb20gJy4vY29tbW9uL21vZGVsL0dPUHJlZmVyZW5jZXMuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCB7IE5vZGUgfSBmcm9tICcuLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgR09LZXlib2FyZEhlbHBDb250ZW50IGZyb20gJy4vY29tbW9uL3ZpZXcvR09LZXlib2FyZEhlbHBDb250ZW50LmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcblxyXG4gIC8vIElzIHRoaXMgJ0dlb21ldHJpYyBPcHRpY3M6IEJhc2ljcycsIGFrYSB0aGUgJ0Jhc2ljcyB2ZXJzaW9uJyBvZiB0aGUgc2ltP1xyXG4gIC8vIFRoaXMgZmxhZyBpcyBwcm9wYWdhdGVkIHRvIG1hbnkgY29tcG9uZW50cyBvZiB0aGUgc2ltLiBUbyBpZGVudGlmeSBob3cgdGhlIEJhc2ljcyB2ZXJzaW9uIGlzIGN1c3RvbWl6ZWQsXHJcbiAgLy8gc2VhcmNoIHRoZSBjb2RlIGJhc2UgZm9yIGlzQmFzaWNzVmVyc2lvbiwgYW5kIGluc3BlY3QgZ2VvbWV0cmljLW9wdGljcy1iYXNpY3MtbWFpbi50cy5cclxuICBpc0Jhc2ljc1ZlcnNpb246IGJvb2xlYW47XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBHT1NpbU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBpY2tPcHRpb25hbDxTaW1PcHRpb25zLCAncGhldGlvRGVzaWduZWQnPjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdPU2ltIGV4dGVuZHMgU2ltIHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCB0aXRsZVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+LCBwcm92aWRlZE9wdGlvbnM6IEdPU2ltT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEdPU2ltT3B0aW9ucywgU2VsZk9wdGlvbnMsIFNpbU9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIFNpbU9wdGlvbnNcclxuICAgICAgY3JlZGl0czogR09Db25zdGFudHMuQ1JFRElUUyxcclxuICAgICAgcHJlZmVyZW5jZXNNb2RlbDogbmV3IFByZWZlcmVuY2VzTW9kZWwoIHtcclxuICAgICAgICBzaW11bGF0aW9uT3B0aW9uczoge1xyXG4gICAgICAgICAgY3VzdG9tUHJlZmVyZW5jZXM6IFsge1xyXG4gICAgICAgICAgICBjcmVhdGVDb250ZW50OiB0YW5kZW0gPT4gbmV3IEdPUHJlZmVyZW5jZXNOb2RlKCB7XHJcbiAgICAgICAgICAgICAgaXNCYXNpY3NWZXJzaW9uOiBwcm92aWRlZE9wdGlvbnMuaXNCYXNpY3NWZXJzaW9uLFxyXG4gICAgICAgICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NpbVByZWZlcmVuY2VzJyApXHJcbiAgICAgICAgICAgIH0gKSxcclxuICAgICAgICAgICAgbW9kZWxMaW5rYWJsZXM6IFtcclxuICAgICAgICAgICAgICB7IHByb3BlcnR5OiBHT1ByZWZlcmVuY2VzLmZvY2FsTGVuZ3RoTW9kZWxUeXBlUHJvcGVydHkgfSxcclxuICAgICAgICAgICAgICB7IHByb3BlcnR5OiBHT1ByZWZlcmVuY2VzLmFkZDJGUG9pbnRzQ2hlY2tib3hQcm9wZXJ0eSB9LFxyXG4gICAgICAgICAgICAgIHsgcHJvcGVydHk6IEdPUHJlZmVyZW5jZXMuY3VlaW5nQXJyb3dzRW5hYmxlZFByb3BlcnR5IH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgICAgfSBdXHJcbiAgICAgICAgfVxyXG4gICAgICB9IClcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIFNpbmNlIGtleWJvYXJkLWhlbHAgaXMgaWRlbnRpY2FsIGZvciBib3RoIHNjcmVlbnMsIHNhdmUgbWVtb3J5IGJ5IHJldXNpbmcgdGhlIHNhbWUgaW5zdGFuY2Ugb2Yga2V5Ym9hcmRIZWxwTm9kZVxyXG4gICAgLy8gZm9yIGJvdGggc2NyZWVucywgd2l0aG91dCBjcmVhdGluZyBhIG1lbW9yeSBsZWFrLlxyXG4gICAgbGV0IGtleWJvYXJkSGVscE5vZGU6IG51bGwgfCBOb2RlID0gbnVsbDtcclxuICAgIGNvbnN0IGNyZWF0ZUtleWJvYXJkSGVscE5vZGUgPSAoKSA9PiB7XHJcbiAgICAgIGlmICggIWtleWJvYXJkSGVscE5vZGUgKSB7XHJcbiAgICAgICAga2V5Ym9hcmRIZWxwTm9kZSA9IG5ldyBHT0tleWJvYXJkSGVscENvbnRlbnQoKTtcclxuICAgICAgICBrZXlib2FyZEhlbHBOb2RlLmRpc3Bvc2VFbWl0dGVyLmFkZExpc3RlbmVyKCBmdW5jdGlvbiBkaXNwb3NlTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgICBpZiAoIGtleWJvYXJkSGVscE5vZGUgKSB7XHJcbiAgICAgICAgICAgIGlmICgga2V5Ym9hcmRIZWxwTm9kZS5kaXNwb3NlRW1pdHRlci5oYXNMaXN0ZW5lciggZGlzcG9zZUxpc3RlbmVyICkgKSB7XHJcbiAgICAgICAgICAgICAga2V5Ym9hcmRIZWxwTm9kZS5kaXNwb3NlRW1pdHRlci5yZW1vdmVMaXN0ZW5lciggZGlzcG9zZUxpc3RlbmVyICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAga2V5Ym9hcmRIZWxwTm9kZSA9IG51bGw7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSApO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBrZXlib2FyZEhlbHBOb2RlO1xyXG4gICAgfTtcclxuXHJcbiAgICBzdXBlciggdGl0bGVQcm9wZXJ0eSwgW1xyXG4gICAgICBuZXcgTGVuc1NjcmVlbigge1xyXG4gICAgICAgIGlzQmFzaWNzVmVyc2lvbjogb3B0aW9ucy5pc0Jhc2ljc1ZlcnNpb24sXHJcbiAgICAgICAgY3JlYXRlS2V5Ym9hcmRIZWxwTm9kZTogY3JlYXRlS2V5Ym9hcmRIZWxwTm9kZSxcclxuICAgICAgICB0YW5kZW06IFRhbmRlbS5ST09ULmNyZWF0ZVRhbmRlbSggJ2xlbnNTY3JlZW4nIClcclxuICAgICAgfSApLFxyXG4gICAgICBuZXcgTWlycm9yU2NyZWVuKCB7XHJcbiAgICAgICAgaXNCYXNpY3NWZXJzaW9uOiBvcHRpb25zLmlzQmFzaWNzVmVyc2lvbixcclxuICAgICAgICBjcmVhdGVLZXlib2FyZEhlbHBOb2RlOiBjcmVhdGVLZXlib2FyZEhlbHBOb2RlLFxyXG4gICAgICAgIHRhbmRlbTogVGFuZGVtLlJPT1QuY3JlYXRlVGFuZGVtKCAnbWlycm9yU2NyZWVuJyApXHJcbiAgICAgIH0gKVxyXG4gICAgXSwgb3B0aW9ucyApO1xyXG4gIH1cclxufVxyXG5cclxuZ2VvbWV0cmljT3B0aWNzLnJlZ2lzdGVyKCAnR09TaW0nLCBHT1NpbSApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxHQUFHLE1BQXNCLHVCQUF1QjtBQUN2RCxPQUFPQyxNQUFNLE1BQU0sMkJBQTJCO0FBQzlDLE9BQU9DLGVBQWUsTUFBTSxzQkFBc0I7QUFDbEQsT0FBT0MsVUFBVSxNQUFNLHNCQUFzQjtBQUM3QyxPQUFPQyxZQUFZLE1BQU0sMEJBQTBCO0FBQ25ELE9BQU9DLFdBQVcsTUFBTSx5QkFBeUI7QUFDakQsT0FBT0MsU0FBUyxNQUFNLGlDQUFpQztBQUN2RCxPQUFPQyxpQkFBaUIsTUFBTSxvQ0FBb0M7QUFFbEUsT0FBT0MsZ0JBQWdCLE1BQU0sZ0RBQWdEO0FBQzdFLE9BQU9DLGFBQWEsTUFBTSxpQ0FBaUM7QUFHM0QsT0FBT0MscUJBQXFCLE1BQU0sd0NBQXdDO0FBWTFFLGVBQWUsTUFBTUMsS0FBSyxTQUFTWCxHQUFHLENBQUM7RUFFOUJZLFdBQVdBLENBQUVDLGFBQXdDLEVBQUVDLGVBQTZCLEVBQUc7SUFFNUYsTUFBTUMsT0FBTyxHQUFHVCxTQUFTLENBQXdDLENBQUMsQ0FBRTtNQUVsRTtNQUNBVSxPQUFPLEVBQUVYLFdBQVcsQ0FBQ1ksT0FBTztNQUM1QkMsZ0JBQWdCLEVBQUUsSUFBSVYsZ0JBQWdCLENBQUU7UUFDdENXLGlCQUFpQixFQUFFO1VBQ2pCQyxpQkFBaUIsRUFBRSxDQUFFO1lBQ25CQyxhQUFhLEVBQUVDLE1BQU0sSUFBSSxJQUFJZixpQkFBaUIsQ0FBRTtjQUM5Q2dCLGVBQWUsRUFBRVQsZUFBZSxDQUFDUyxlQUFlO2NBQ2hERCxNQUFNLEVBQUVBLE1BQU0sQ0FBQ0UsWUFBWSxDQUFFLGdCQUFpQjtZQUNoRCxDQUFFLENBQUM7WUFDSEMsY0FBYyxFQUFFLENBQ2Q7Y0FBRUMsUUFBUSxFQUFFakIsYUFBYSxDQUFDa0I7WUFBNkIsQ0FBQyxFQUN4RDtjQUFFRCxRQUFRLEVBQUVqQixhQUFhLENBQUNtQjtZQUE0QixDQUFDLEVBQ3ZEO2NBQUVGLFFBQVEsRUFBRWpCLGFBQWEsQ0FBQ29CO1lBQTRCLENBQUM7VUFFM0QsQ0FBQztRQUNIO01BQ0YsQ0FBRTtJQUNKLENBQUMsRUFBRWYsZUFBZ0IsQ0FBQzs7SUFFcEI7SUFDQTtJQUNBLElBQUlnQixnQkFBNkIsR0FBRyxJQUFJO0lBQ3hDLE1BQU1DLHNCQUFzQixHQUFHQSxDQUFBLEtBQU07TUFDbkMsSUFBSyxDQUFDRCxnQkFBZ0IsRUFBRztRQUN2QkEsZ0JBQWdCLEdBQUcsSUFBSXBCLHFCQUFxQixDQUFDLENBQUM7UUFDOUNvQixnQkFBZ0IsQ0FBQ0UsY0FBYyxDQUFDQyxXQUFXLENBQUUsU0FBU0MsZUFBZUEsQ0FBQSxFQUFHO1VBQ3RFLElBQUtKLGdCQUFnQixFQUFHO1lBQ3RCLElBQUtBLGdCQUFnQixDQUFDRSxjQUFjLENBQUNHLFdBQVcsQ0FBRUQsZUFBZ0IsQ0FBQyxFQUFHO2NBQ3BFSixnQkFBZ0IsQ0FBQ0UsY0FBYyxDQUFDSSxjQUFjLENBQUVGLGVBQWdCLENBQUM7WUFDbkU7WUFDQUosZ0JBQWdCLEdBQUcsSUFBSTtVQUN6QjtRQUNGLENBQUUsQ0FBQztNQUNMO01BQ0EsT0FBT0EsZ0JBQWdCO0lBQ3pCLENBQUM7SUFFRCxLQUFLLENBQUVqQixhQUFhLEVBQUUsQ0FDcEIsSUFBSVYsVUFBVSxDQUFFO01BQ2RvQixlQUFlLEVBQUVSLE9BQU8sQ0FBQ1EsZUFBZTtNQUN4Q1Esc0JBQXNCLEVBQUVBLHNCQUFzQjtNQUM5Q1QsTUFBTSxFQUFFckIsTUFBTSxDQUFDb0MsSUFBSSxDQUFDYixZQUFZLENBQUUsWUFBYTtJQUNqRCxDQUFFLENBQUMsRUFDSCxJQUFJcEIsWUFBWSxDQUFFO01BQ2hCbUIsZUFBZSxFQUFFUixPQUFPLENBQUNRLGVBQWU7TUFDeENRLHNCQUFzQixFQUFFQSxzQkFBc0I7TUFDOUNULE1BQU0sRUFBRXJCLE1BQU0sQ0FBQ29DLElBQUksQ0FBQ2IsWUFBWSxDQUFFLGNBQWU7SUFDbkQsQ0FBRSxDQUFDLENBQ0osRUFBRVQsT0FBUSxDQUFDO0VBQ2Q7QUFDRjtBQUVBYixlQUFlLENBQUNvQyxRQUFRLENBQUUsT0FBTyxFQUFFM0IsS0FBTSxDQUFDIn0=