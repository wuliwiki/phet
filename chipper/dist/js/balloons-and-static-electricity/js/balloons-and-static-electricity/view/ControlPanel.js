// Copyright 2013-2023, University of Colorado Boulder

/**
 * All buttons and control elements for Balloons and Static Electricity.
 *
 * buttons and model control elements
 * @author Vasily Shakhov (Mlearner)
 */

import merge from '../../../../phet-core/js/merge.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { HBox, Image, Node, RichText, Text, VBox } from '../../../../scenery/js/imports.js';
import BooleanToggleNode from '../../../../sun/js/BooleanToggleNode.js';
import BooleanRectangularToggleButton from '../../../../sun/js/buttons/BooleanRectangularToggleButton.js';
import RectangularPushButton from '../../../../sun/js/buttons/RectangularPushButton.js';
import Panel from '../../../../sun/js/Panel.js';
import VerticalAquaRadioButtonGroup from '../../../../sun/js/VerticalAquaRadioButtonGroup.js';
import balloonGreen_png from '../../../images/balloonGreen_png.js';
import balloonYellow_png from '../../../images/balloonYellow_png.js';
import balloonsAndStaticElectricity from '../../balloonsAndStaticElectricity.js';
import BalloonsAndStaticElectricityStrings from '../../BalloonsAndStaticElectricityStrings.js';
import BASEA11yStrings from '../BASEA11yStrings.js';
import BASEConstants from '../BASEConstants.js';
import BASEQueryParameters from '../BASEQueryParameters.js';
import TwoSceneSelectionNode from './TwoSceneSelectionNode.js';
const addWallString = BalloonsAndStaticElectricityStrings.addWall;
const balloonAppletShowAllChargesString = BalloonsAndStaticElectricityStrings.BalloonApplet.ShowAllCharges;
const balloonAppletShowChargeDifferencesString = BalloonsAndStaticElectricityStrings.BalloonApplet.ShowChargeDifferences;
const balloonAppletShowNoChargesString = BalloonsAndStaticElectricityStrings.BalloonApplet.ShowNoCharges;
const removeWallString = BalloonsAndStaticElectricityStrings.removeWall;
const resetBalloonsString = BalloonsAndStaticElectricityStrings.resetBalloons;
const resetBalloonString = BalloonsAndStaticElectricityStrings.resetBalloon;
const twoBalloonExperimentLabelString = BASEA11yStrings.twoBalloonExperimentLabel.value;
const chargeSettingsLabelString = BASEA11yStrings.chargeSettingsLabel.value;
const chargeSettingsDescriptionString = BASEA11yStrings.chargeSettingsDescription.value;
const showAllChargesAlertString = BASEA11yStrings.showAllChargesAlert.value;
const shoNoChargesAlertString = BASEA11yStrings.shoNoChargesAlert.value;
const showChargeDifferencesAlertString = BASEA11yStrings.showChargeDifferencesAlert.value;
const removeWallDescriptionString = BASEA11yStrings.removeWallDescription.value;
const twoBalloonExperimentDescriptionString = BASEA11yStrings.twoBalloonExperimentDescription.value;
const resetBalloonsAlertPatternString = BASEA11yStrings.resetBalloonsAlertPattern.value;
const balloonString = BASEA11yStrings.balloon.value;
const balloonsString = BASEA11yStrings.balloons.value;
const wallAddedString = BASEA11yStrings.wallAdded.value;
const wallRemovedString = BASEA11yStrings.wallRemoved.value;
const positionsString = BASEA11yStrings.positions.value;
const positionString = BASEA11yStrings.position.value;
const balloonSettingsLabelString = BASEA11yStrings.balloonSettingsLabel.value;
const resetBalloonsDescriptionPatternString = BASEA11yStrings.resetBalloonsDescriptionPattern.value;

// constants
const BOTTOM_CONTROL_SPACING = 10;
const CONTROLS_FONT = new PhetFont(15);
class ControlPanel extends Node {
  /**
   * @param {BASEModel} model
   * @param {BASEView} view
   * @param {Tandem} tandem
   */
  constructor(model, view, tandem) {
    // super constructor
    super();

    // options for text in the wall toggle button
    const textOptions = {
      font: CONTROLS_FONT,
      maxWidth: 100
    };

    // content for Add/Remove wall button.
    const addWallText = new RichText(addWallString, merge({
      replaceNewlines: true,
      align: 'center',
      tandem: tandem.createTandem('addWallText')
    }, textOptions));
    const removeWallText = new RichText(removeWallString, merge({
      replaceNewlines: true,
      align: 'center',
      center: addWallText.center,
      tandem: tandem.createTandem('removeWallText')
    }, textOptions));

    // @private
    this.wallButton = new BooleanRectangularToggleButton(model.wall.isVisibleProperty, removeWallText, addWallText, {
      baseColor: 'rgb( 255, 200, 0 )',
      tandem: tandem.createTandem('wallButton'),
      // pdom
      descriptionContent: removeWallDescriptionString,
      innerContent: removeWallString,
      appendDescription: true
    });

    // when the wall toggles visibility, make an alert that this has happened and update the button text content
    model.wall.isVisibleProperty.lazyLink(wallVisible => {
      this.wallButton.innerContent = model.wall.isVisibleProperty.get() ? removeWallString : addWallString;
      const alertDescription = wallVisible ? wallAddedString : wallRemovedString;
      this.alertDescriptionUtterance(alertDescription);
    });

    // Radio buttons related to charges
    const RADIO_BUTTON_TEXT_OPTIONS = {
      font: CONTROLS_FONT,
      maxWidth: 200
    };
    const showChargesRadioButtonGroup = new VerticalAquaRadioButtonGroup(model.showChargesProperty, [{
      createNode: tandem => new Text(balloonAppletShowAllChargesString, merge({
        tandem: tandem.createTandem('allChargesText')
      }, RADIO_BUTTON_TEXT_OPTIONS)),
      value: 'all',
      tandemName: 'showAllChargesRadioButton',
      labelContent: balloonAppletShowAllChargesString
    }, {
      createNode: tandem => new Text(balloonAppletShowNoChargesString, merge({
        tandem: tandem.createTandem('noChargesText')
      }, RADIO_BUTTON_TEXT_OPTIONS)),
      value: 'none',
      tandemName: 'showNoChargesRadioButton',
      labelContent: balloonAppletShowNoChargesString
    }, {
      createNode: tandem => new Text(balloonAppletShowChargeDifferencesString, merge({
        tandem: tandem.createTandem('differentialChargesText')
      }, RADIO_BUTTON_TEXT_OPTIONS)),
      value: 'diff',
      tandemName: 'showChargeDifferencesRadioButton',
      labelContent: balloonAppletShowChargeDifferencesString
    }], {
      touchAreaXDilation: 5,
      tandem: tandem.createTandem('showChargesRadioButtonGroup'),
      // pdom
      containerTagName: 'div',
      labelContent: chargeSettingsLabelString,
      descriptionContent: chargeSettingsDescriptionString
    });

    // pdom - announce an alert that describes the state of charge visibility, linked lazily
    // so that we don't get any alerts on sim startup
    model.showChargesProperty.lazyLink(value => {
      let alertString;
      if (value === 'all') {
        alertString = showAllChargesAlertString;
      } else if (value === 'none') {
        alertString = shoNoChargesAlertString;
      } else if (value === 'diff') {
        alertString = showChargeDifferencesAlertString;
      }
      assert && assert(alertString, `no interactive alert for showChargesProperty value ${value}`);
      this.alertDescriptionUtterance(alertString);
    });

    // Radio buttons for selecting 1 vs 2 balloons
    const scale = 0.14;
    const yellowBalloonImage = new Image(balloonYellow_png, {
      tandem: tandem.createTandem('yellowBalloonImage')
    });
    const twoBalloonIconTandem = tandem.createTandem('twoBalloonIcon');
    const twoBalloonIcon = new Node({
      children: [new Image(balloonGreen_png, {
        x: 160,
        tandem: twoBalloonIconTandem.createTandem('greenBalloonImage')
      }), yellowBalloonImage],
      scale: scale,
      tandem: twoBalloonIconTandem
    });
    const oneBalloonIconTandem = tandem.createTandem('oneBalloonIcon');
    const oneBalloonIcon = new Node({
      children: [new Image(balloonYellow_png, {
        x: twoBalloonIcon.width / scale / 2 - yellowBalloonImage.width / 2,
        tandem: oneBalloonIconTandem.createTandem('yellowBalloonImage')
      })],
      scale: scale,
      tandem: oneBalloonIconTandem
    });
    let showSecondBalloonSelector = null;
    if (!BASEQueryParameters.hideBalloonSwitch) {
      showSecondBalloonSelector = new TwoSceneSelectionNode(model.greenBalloon.isVisibleProperty, false, true, oneBalloonIcon, twoBalloonIcon, {
        tandem: tandem.createTandem('showSecondBalloonSelector'),
        maskFill: BASEConstants.backgroundColorProperty,
        ariaLabel: twoBalloonExperimentLabelString,
        containerTagName: 'div',
        descriptionContent: twoBalloonExperimentDescriptionString
      });
    }

    // 'Reset Balloons' button
    const resetBalloonToggleNode = new BooleanToggleNode(model.greenBalloon.isVisibleProperty, new Text(resetBalloonsString, {
      font: CONTROLS_FONT,
      tandem: tandem.createTandem('resetBalloonsText')
    }), new Text(resetBalloonString, {
      font: CONTROLS_FONT,
      tandem: tandem.createTandem('resetBalloonText')
    }), {
      maxWidth: 140,
      tandem: tandem.createTandem('resetBalloonToggleNode')
    });
    const resetBalloonButtonListener = () => {
      // disable other alerts until after we are finished resetting the balloons
      this.forEachUtteranceQueue(utteranceQueue => {
        utteranceQueue.enabled = false;
      });
      model.sweater.reset();
      model.balloons.forEach(balloon => {
        balloon.reset(true);
      });

      // Make sure the balloons are correctly layered in the view.
      view.setDefaultBalloonZOrder();
      this.forEachUtteranceQueue(utteranceQueue => {
        utteranceQueue.enabled = true;
      });

      // alert to assistive technology
      this.alertDescriptionUtterance(StringUtils.fillIn(resetBalloonsAlertPatternString, {
        balloons: model.greenBalloon.isVisibleProperty.get() ? balloonsString : balloonString
      }));
    };
    const resetBalloonButton = new RectangularPushButton({
      content: resetBalloonToggleNode,
      baseColor: 'rgb( 255, 200, 0 )',
      listener: resetBalloonButtonListener,
      tandem: tandem.createTandem('resetBalloonButton'),
      // pdom
      containerTagName: 'div',
      appendDescription: true
    });

    // create the accessible description for the reset balloon button
    const generateDescriptionString = balloonVisible => {
      const balloonDescriptionString = balloonVisible ? balloonsString : balloonString;
      const positionDescriptionString = balloonVisible ? positionsString : positionString;
      return StringUtils.fillIn(resetBalloonsDescriptionPatternString, {
        balloons: balloonDescriptionString,
        positions: positionDescriptionString
      });
    };

    // update the button description when the green balloon is made visible
    model.greenBalloon.isVisibleProperty.link(isVisible => {
      resetBalloonButton.descriptionContent = generateDescriptionString(isVisible);
      resetBalloonButton.innerContent = isVisible ? resetBalloonsString : resetBalloonString;
    });
    const balloonsPanel = new VBox({
      spacing: 2,
      children: showSecondBalloonSelector ? [showSecondBalloonSelector, resetBalloonButton] : [resetBalloonButton],
      // pdom
      tagName: 'div',
      labelTagName: 'h3',
      labelContent: balloonSettingsLabelString
    });

    //Add the controls at the right, with the reset all button and the wall button
    const resetAllButton = new ResetAllButton({
      listener: () => {
        model.reset();
        view.setDefaultBalloonZOrder();
      },
      scale: 0.96,
      tandem: tandem.createTandem('resetAllButton')
    });
    const controls = new HBox({
      spacing: 14,
      align: 'bottom',
      children: [resetAllButton, this.wallButton]
    });
    const layoutBounds = view.layoutBounds;

    // more than other controls so the reset button touch area doesn't overlap the nav bar
    controls.bottom = layoutBounds.maxY - BOTTOM_CONTROL_SPACING;
    controls.right = layoutBounds.maxX - 4.5; // so "Remove Wall" button looks centered with wall

    let visibilityControls;
    let controlsLeft;
    if (BASEQueryParameters.hideChargeControls) {
      visibilityControls = [balloonsPanel];
      controlsLeft = layoutBounds.width / 2 - balloonsPanel.width / 2;
    } else {
      visibilityControls = [new Panel(showChargesRadioButtonGroup, {
        tandem: tandem.createTandem('visibilityPanel')
      }), balloonsPanel];
      controlsLeft = 70;
    }
    this.addChild(new HBox({
      spacing: 50,
      children: visibilityControls,
      align: 'bottom',
      left: controlsLeft,
      bottom: layoutBounds.maxY - BOTTOM_CONTROL_SPACING
    }));
    this.addChild(controls);
    this.pdomOrder = [this.wallButton, balloonsPanel, showChargesRadioButtonGroup, resetAllButton];
  }
}
balloonsAndStaticElectricity.register('ControlPanel', ControlPanel);
export default ControlPanel;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtZXJnZSIsIlN0cmluZ1V0aWxzIiwiUmVzZXRBbGxCdXR0b24iLCJQaGV0Rm9udCIsIkhCb3giLCJJbWFnZSIsIk5vZGUiLCJSaWNoVGV4dCIsIlRleHQiLCJWQm94IiwiQm9vbGVhblRvZ2dsZU5vZGUiLCJCb29sZWFuUmVjdGFuZ3VsYXJUb2dnbGVCdXR0b24iLCJSZWN0YW5ndWxhclB1c2hCdXR0b24iLCJQYW5lbCIsIlZlcnRpY2FsQXF1YVJhZGlvQnV0dG9uR3JvdXAiLCJiYWxsb29uR3JlZW5fcG5nIiwiYmFsbG9vblllbGxvd19wbmciLCJiYWxsb29uc0FuZFN0YXRpY0VsZWN0cmljaXR5IiwiQmFsbG9vbnNBbmRTdGF0aWNFbGVjdHJpY2l0eVN0cmluZ3MiLCJCQVNFQTExeVN0cmluZ3MiLCJCQVNFQ29uc3RhbnRzIiwiQkFTRVF1ZXJ5UGFyYW1ldGVycyIsIlR3b1NjZW5lU2VsZWN0aW9uTm9kZSIsImFkZFdhbGxTdHJpbmciLCJhZGRXYWxsIiwiYmFsbG9vbkFwcGxldFNob3dBbGxDaGFyZ2VzU3RyaW5nIiwiQmFsbG9vbkFwcGxldCIsIlNob3dBbGxDaGFyZ2VzIiwiYmFsbG9vbkFwcGxldFNob3dDaGFyZ2VEaWZmZXJlbmNlc1N0cmluZyIsIlNob3dDaGFyZ2VEaWZmZXJlbmNlcyIsImJhbGxvb25BcHBsZXRTaG93Tm9DaGFyZ2VzU3RyaW5nIiwiU2hvd05vQ2hhcmdlcyIsInJlbW92ZVdhbGxTdHJpbmciLCJyZW1vdmVXYWxsIiwicmVzZXRCYWxsb29uc1N0cmluZyIsInJlc2V0QmFsbG9vbnMiLCJyZXNldEJhbGxvb25TdHJpbmciLCJyZXNldEJhbGxvb24iLCJ0d29CYWxsb29uRXhwZXJpbWVudExhYmVsU3RyaW5nIiwidHdvQmFsbG9vbkV4cGVyaW1lbnRMYWJlbCIsInZhbHVlIiwiY2hhcmdlU2V0dGluZ3NMYWJlbFN0cmluZyIsImNoYXJnZVNldHRpbmdzTGFiZWwiLCJjaGFyZ2VTZXR0aW5nc0Rlc2NyaXB0aW9uU3RyaW5nIiwiY2hhcmdlU2V0dGluZ3NEZXNjcmlwdGlvbiIsInNob3dBbGxDaGFyZ2VzQWxlcnRTdHJpbmciLCJzaG93QWxsQ2hhcmdlc0FsZXJ0Iiwic2hvTm9DaGFyZ2VzQWxlcnRTdHJpbmciLCJzaG9Ob0NoYXJnZXNBbGVydCIsInNob3dDaGFyZ2VEaWZmZXJlbmNlc0FsZXJ0U3RyaW5nIiwic2hvd0NoYXJnZURpZmZlcmVuY2VzQWxlcnQiLCJyZW1vdmVXYWxsRGVzY3JpcHRpb25TdHJpbmciLCJyZW1vdmVXYWxsRGVzY3JpcHRpb24iLCJ0d29CYWxsb29uRXhwZXJpbWVudERlc2NyaXB0aW9uU3RyaW5nIiwidHdvQmFsbG9vbkV4cGVyaW1lbnREZXNjcmlwdGlvbiIsInJlc2V0QmFsbG9vbnNBbGVydFBhdHRlcm5TdHJpbmciLCJyZXNldEJhbGxvb25zQWxlcnRQYXR0ZXJuIiwiYmFsbG9vblN0cmluZyIsImJhbGxvb24iLCJiYWxsb29uc1N0cmluZyIsImJhbGxvb25zIiwid2FsbEFkZGVkU3RyaW5nIiwid2FsbEFkZGVkIiwid2FsbFJlbW92ZWRTdHJpbmciLCJ3YWxsUmVtb3ZlZCIsInBvc2l0aW9uc1N0cmluZyIsInBvc2l0aW9ucyIsInBvc2l0aW9uU3RyaW5nIiwicG9zaXRpb24iLCJiYWxsb29uU2V0dGluZ3NMYWJlbFN0cmluZyIsImJhbGxvb25TZXR0aW5nc0xhYmVsIiwicmVzZXRCYWxsb29uc0Rlc2NyaXB0aW9uUGF0dGVyblN0cmluZyIsInJlc2V0QmFsbG9vbnNEZXNjcmlwdGlvblBhdHRlcm4iLCJCT1RUT01fQ09OVFJPTF9TUEFDSU5HIiwiQ09OVFJPTFNfRk9OVCIsIkNvbnRyb2xQYW5lbCIsImNvbnN0cnVjdG9yIiwibW9kZWwiLCJ2aWV3IiwidGFuZGVtIiwidGV4dE9wdGlvbnMiLCJmb250IiwibWF4V2lkdGgiLCJhZGRXYWxsVGV4dCIsInJlcGxhY2VOZXdsaW5lcyIsImFsaWduIiwiY3JlYXRlVGFuZGVtIiwicmVtb3ZlV2FsbFRleHQiLCJjZW50ZXIiLCJ3YWxsQnV0dG9uIiwid2FsbCIsImlzVmlzaWJsZVByb3BlcnR5IiwiYmFzZUNvbG9yIiwiZGVzY3JpcHRpb25Db250ZW50IiwiaW5uZXJDb250ZW50IiwiYXBwZW5kRGVzY3JpcHRpb24iLCJsYXp5TGluayIsIndhbGxWaXNpYmxlIiwiZ2V0IiwiYWxlcnREZXNjcmlwdGlvbiIsImFsZXJ0RGVzY3JpcHRpb25VdHRlcmFuY2UiLCJSQURJT19CVVRUT05fVEVYVF9PUFRJT05TIiwic2hvd0NoYXJnZXNSYWRpb0J1dHRvbkdyb3VwIiwic2hvd0NoYXJnZXNQcm9wZXJ0eSIsImNyZWF0ZU5vZGUiLCJ0YW5kZW1OYW1lIiwibGFiZWxDb250ZW50IiwidG91Y2hBcmVhWERpbGF0aW9uIiwiY29udGFpbmVyVGFnTmFtZSIsImFsZXJ0U3RyaW5nIiwiYXNzZXJ0Iiwic2NhbGUiLCJ5ZWxsb3dCYWxsb29uSW1hZ2UiLCJ0d29CYWxsb29uSWNvblRhbmRlbSIsInR3b0JhbGxvb25JY29uIiwiY2hpbGRyZW4iLCJ4Iiwib25lQmFsbG9vbkljb25UYW5kZW0iLCJvbmVCYWxsb29uSWNvbiIsIndpZHRoIiwic2hvd1NlY29uZEJhbGxvb25TZWxlY3RvciIsImhpZGVCYWxsb29uU3dpdGNoIiwiZ3JlZW5CYWxsb29uIiwibWFza0ZpbGwiLCJiYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSIsImFyaWFMYWJlbCIsInJlc2V0QmFsbG9vblRvZ2dsZU5vZGUiLCJyZXNldEJhbGxvb25CdXR0b25MaXN0ZW5lciIsImZvckVhY2hVdHRlcmFuY2VRdWV1ZSIsInV0dGVyYW5jZVF1ZXVlIiwiZW5hYmxlZCIsInN3ZWF0ZXIiLCJyZXNldCIsImZvckVhY2giLCJzZXREZWZhdWx0QmFsbG9vblpPcmRlciIsImZpbGxJbiIsInJlc2V0QmFsbG9vbkJ1dHRvbiIsImNvbnRlbnQiLCJsaXN0ZW5lciIsImdlbmVyYXRlRGVzY3JpcHRpb25TdHJpbmciLCJiYWxsb29uVmlzaWJsZSIsImJhbGxvb25EZXNjcmlwdGlvblN0cmluZyIsInBvc2l0aW9uRGVzY3JpcHRpb25TdHJpbmciLCJsaW5rIiwiaXNWaXNpYmxlIiwiYmFsbG9vbnNQYW5lbCIsInNwYWNpbmciLCJ0YWdOYW1lIiwibGFiZWxUYWdOYW1lIiwicmVzZXRBbGxCdXR0b24iLCJjb250cm9scyIsImxheW91dEJvdW5kcyIsImJvdHRvbSIsIm1heFkiLCJyaWdodCIsIm1heFgiLCJ2aXNpYmlsaXR5Q29udHJvbHMiLCJjb250cm9sc0xlZnQiLCJoaWRlQ2hhcmdlQ29udHJvbHMiLCJhZGRDaGlsZCIsImxlZnQiLCJwZG9tT3JkZXIiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkNvbnRyb2xQYW5lbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBbGwgYnV0dG9ucyBhbmQgY29udHJvbCBlbGVtZW50cyBmb3IgQmFsbG9vbnMgYW5kIFN0YXRpYyBFbGVjdHJpY2l0eS5cclxuICpcclxuICogYnV0dG9ucyBhbmQgbW9kZWwgY29udHJvbCBlbGVtZW50c1xyXG4gKiBAYXV0aG9yIFZhc2lseSBTaGFraG92IChNbGVhcm5lcilcclxuICovXHJcblxyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IFN0cmluZ1V0aWxzIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdXRpbC9TdHJpbmdVdGlscy5qcyc7XHJcbmltcG9ydCBSZXNldEFsbEJ1dHRvbiBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvYnV0dG9ucy9SZXNldEFsbEJ1dHRvbi5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBIQm94LCBJbWFnZSwgTm9kZSwgUmljaFRleHQsIFRleHQsIFZCb3ggfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgQm9vbGVhblRvZ2dsZU5vZGUgZnJvbSAnLi4vLi4vLi4vLi4vc3VuL2pzL0Jvb2xlYW5Ub2dnbGVOb2RlLmpzJztcclxuaW1wb3J0IEJvb2xlYW5SZWN0YW5ndWxhclRvZ2dsZUJ1dHRvbiBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvYnV0dG9ucy9Cb29sZWFuUmVjdGFuZ3VsYXJUb2dnbGVCdXR0b24uanMnO1xyXG5pbXBvcnQgUmVjdGFuZ3VsYXJQdXNoQnV0dG9uIGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9idXR0b25zL1JlY3Rhbmd1bGFyUHVzaEJ1dHRvbi5qcyc7XHJcbmltcG9ydCBQYW5lbCBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvUGFuZWwuanMnO1xyXG5pbXBvcnQgVmVydGljYWxBcXVhUmFkaW9CdXR0b25Hcm91cCBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvVmVydGljYWxBcXVhUmFkaW9CdXR0b25Hcm91cC5qcyc7XHJcbmltcG9ydCBiYWxsb29uR3JlZW5fcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9iYWxsb29uR3JlZW5fcG5nLmpzJztcclxuaW1wb3J0IGJhbGxvb25ZZWxsb3dfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9iYWxsb29uWWVsbG93X3BuZy5qcyc7XHJcbmltcG9ydCBiYWxsb29uc0FuZFN0YXRpY0VsZWN0cmljaXR5IGZyb20gJy4uLy4uL2JhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHkuanMnO1xyXG5pbXBvcnQgQmFsbG9vbnNBbmRTdGF0aWNFbGVjdHJpY2l0eVN0cmluZ3MgZnJvbSAnLi4vLi4vQmFsbG9vbnNBbmRTdGF0aWNFbGVjdHJpY2l0eVN0cmluZ3MuanMnO1xyXG5pbXBvcnQgQkFTRUExMXlTdHJpbmdzIGZyb20gJy4uL0JBU0VBMTF5U3RyaW5ncy5qcyc7XHJcbmltcG9ydCBCQVNFQ29uc3RhbnRzIGZyb20gJy4uL0JBU0VDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgQkFTRVF1ZXJ5UGFyYW1ldGVycyBmcm9tICcuLi9CQVNFUXVlcnlQYXJhbWV0ZXJzLmpzJztcclxuaW1wb3J0IFR3b1NjZW5lU2VsZWN0aW9uTm9kZSBmcm9tICcuL1R3b1NjZW5lU2VsZWN0aW9uTm9kZS5qcyc7XHJcblxyXG5jb25zdCBhZGRXYWxsU3RyaW5nID0gQmFsbG9vbnNBbmRTdGF0aWNFbGVjdHJpY2l0eVN0cmluZ3MuYWRkV2FsbDtcclxuY29uc3QgYmFsbG9vbkFwcGxldFNob3dBbGxDaGFyZ2VzU3RyaW5nID0gQmFsbG9vbnNBbmRTdGF0aWNFbGVjdHJpY2l0eVN0cmluZ3MuQmFsbG9vbkFwcGxldC5TaG93QWxsQ2hhcmdlcztcclxuY29uc3QgYmFsbG9vbkFwcGxldFNob3dDaGFyZ2VEaWZmZXJlbmNlc1N0cmluZyA9IEJhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHlTdHJpbmdzLkJhbGxvb25BcHBsZXQuU2hvd0NoYXJnZURpZmZlcmVuY2VzO1xyXG5jb25zdCBiYWxsb29uQXBwbGV0U2hvd05vQ2hhcmdlc1N0cmluZyA9IEJhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHlTdHJpbmdzLkJhbGxvb25BcHBsZXQuU2hvd05vQ2hhcmdlcztcclxuY29uc3QgcmVtb3ZlV2FsbFN0cmluZyA9IEJhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHlTdHJpbmdzLnJlbW92ZVdhbGw7XHJcbmNvbnN0IHJlc2V0QmFsbG9vbnNTdHJpbmcgPSBCYWxsb29uc0FuZFN0YXRpY0VsZWN0cmljaXR5U3RyaW5ncy5yZXNldEJhbGxvb25zO1xyXG5jb25zdCByZXNldEJhbGxvb25TdHJpbmcgPSBCYWxsb29uc0FuZFN0YXRpY0VsZWN0cmljaXR5U3RyaW5ncy5yZXNldEJhbGxvb247XHJcblxyXG5jb25zdCB0d29CYWxsb29uRXhwZXJpbWVudExhYmVsU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnR3b0JhbGxvb25FeHBlcmltZW50TGFiZWwudmFsdWU7XHJcbmNvbnN0IGNoYXJnZVNldHRpbmdzTGFiZWxTdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MuY2hhcmdlU2V0dGluZ3NMYWJlbC52YWx1ZTtcclxuY29uc3QgY2hhcmdlU2V0dGluZ3NEZXNjcmlwdGlvblN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5jaGFyZ2VTZXR0aW5nc0Rlc2NyaXB0aW9uLnZhbHVlO1xyXG5jb25zdCBzaG93QWxsQ2hhcmdlc0FsZXJ0U3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnNob3dBbGxDaGFyZ2VzQWxlcnQudmFsdWU7XHJcbmNvbnN0IHNob05vQ2hhcmdlc0FsZXJ0U3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnNob05vQ2hhcmdlc0FsZXJ0LnZhbHVlO1xyXG5jb25zdCBzaG93Q2hhcmdlRGlmZmVyZW5jZXNBbGVydFN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5zaG93Q2hhcmdlRGlmZmVyZW5jZXNBbGVydC52YWx1ZTtcclxuY29uc3QgcmVtb3ZlV2FsbERlc2NyaXB0aW9uU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnJlbW92ZVdhbGxEZXNjcmlwdGlvbi52YWx1ZTtcclxuY29uc3QgdHdvQmFsbG9vbkV4cGVyaW1lbnREZXNjcmlwdGlvblN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy50d29CYWxsb29uRXhwZXJpbWVudERlc2NyaXB0aW9uLnZhbHVlO1xyXG5jb25zdCByZXNldEJhbGxvb25zQWxlcnRQYXR0ZXJuU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnJlc2V0QmFsbG9vbnNBbGVydFBhdHRlcm4udmFsdWU7XHJcbmNvbnN0IGJhbGxvb25TdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MuYmFsbG9vbi52YWx1ZTtcclxuY29uc3QgYmFsbG9vbnNTdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MuYmFsbG9vbnMudmFsdWU7XHJcbmNvbnN0IHdhbGxBZGRlZFN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy53YWxsQWRkZWQudmFsdWU7XHJcbmNvbnN0IHdhbGxSZW1vdmVkU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLndhbGxSZW1vdmVkLnZhbHVlO1xyXG5jb25zdCBwb3NpdGlvbnNTdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MucG9zaXRpb25zLnZhbHVlO1xyXG5jb25zdCBwb3NpdGlvblN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5wb3NpdGlvbi52YWx1ZTtcclxuY29uc3QgYmFsbG9vblNldHRpbmdzTGFiZWxTdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MuYmFsbG9vblNldHRpbmdzTGFiZWwudmFsdWU7XHJcbmNvbnN0IHJlc2V0QmFsbG9vbnNEZXNjcmlwdGlvblBhdHRlcm5TdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MucmVzZXRCYWxsb29uc0Rlc2NyaXB0aW9uUGF0dGVybi52YWx1ZTtcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBCT1RUT01fQ09OVFJPTF9TUEFDSU5HID0gMTA7XHJcbmNvbnN0IENPTlRST0xTX0ZPTlQgPSBuZXcgUGhldEZvbnQoIDE1ICk7XHJcblxyXG5jbGFzcyBDb250cm9sUGFuZWwgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtCQVNFTW9kZWx9IG1vZGVsXHJcbiAgICogQHBhcmFtIHtCQVNFVmlld30gdmlld1xyXG4gICAqIEBwYXJhbSB7VGFuZGVtfSB0YW5kZW1cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbW9kZWwsIHZpZXcsIHRhbmRlbSApIHtcclxuXHJcbiAgICAvLyBzdXBlciBjb25zdHJ1Y3RvclxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICAvLyBvcHRpb25zIGZvciB0ZXh0IGluIHRoZSB3YWxsIHRvZ2dsZSBidXR0b25cclxuICAgIGNvbnN0IHRleHRPcHRpb25zID0ge1xyXG4gICAgICBmb250OiBDT05UUk9MU19GT05ULFxyXG4gICAgICBtYXhXaWR0aDogMTAwXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIGNvbnRlbnQgZm9yIEFkZC9SZW1vdmUgd2FsbCBidXR0b24uXHJcbiAgICBjb25zdCBhZGRXYWxsVGV4dCA9IG5ldyBSaWNoVGV4dCggYWRkV2FsbFN0cmluZywgbWVyZ2UoIHtcclxuICAgICAgcmVwbGFjZU5ld2xpbmVzOiB0cnVlLFxyXG4gICAgICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2FkZFdhbGxUZXh0JyApXHJcbiAgICB9LCB0ZXh0T3B0aW9ucyApICk7XHJcbiAgICBjb25zdCByZW1vdmVXYWxsVGV4dCA9IG5ldyBSaWNoVGV4dCggcmVtb3ZlV2FsbFN0cmluZywgbWVyZ2UoIHtcclxuICAgICAgcmVwbGFjZU5ld2xpbmVzOiB0cnVlLFxyXG4gICAgICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgIGNlbnRlcjogYWRkV2FsbFRleHQuY2VudGVyLFxyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdyZW1vdmVXYWxsVGV4dCcgKVxyXG4gICAgfSwgdGV4dE9wdGlvbnMgKSApO1xyXG5cclxuICAgIC8vIEBwcml2YXRlXHJcbiAgICB0aGlzLndhbGxCdXR0b24gPSBuZXcgQm9vbGVhblJlY3Rhbmd1bGFyVG9nZ2xlQnV0dG9uKCBtb2RlbC53YWxsLmlzVmlzaWJsZVByb3BlcnR5LCByZW1vdmVXYWxsVGV4dCwgYWRkV2FsbFRleHQsIHtcclxuICAgICAgYmFzZUNvbG9yOiAncmdiKCAyNTUsIDIwMCwgMCApJyxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnd2FsbEJ1dHRvbicgKSxcclxuXHJcbiAgICAgIC8vIHBkb21cclxuICAgICAgZGVzY3JpcHRpb25Db250ZW50OiByZW1vdmVXYWxsRGVzY3JpcHRpb25TdHJpbmcsXHJcbiAgICAgIGlubmVyQ29udGVudDogcmVtb3ZlV2FsbFN0cmluZyxcclxuICAgICAgYXBwZW5kRGVzY3JpcHRpb246IHRydWVcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB3aGVuIHRoZSB3YWxsIHRvZ2dsZXMgdmlzaWJpbGl0eSwgbWFrZSBhbiBhbGVydCB0aGF0IHRoaXMgaGFzIGhhcHBlbmVkIGFuZCB1cGRhdGUgdGhlIGJ1dHRvbiB0ZXh0IGNvbnRlbnRcclxuICAgIG1vZGVsLndhbGwuaXNWaXNpYmxlUHJvcGVydHkubGF6eUxpbmsoIHdhbGxWaXNpYmxlID0+IHtcclxuICAgICAgdGhpcy53YWxsQnV0dG9uLmlubmVyQ29udGVudCA9IG1vZGVsLndhbGwuaXNWaXNpYmxlUHJvcGVydHkuZ2V0KCkgPyByZW1vdmVXYWxsU3RyaW5nIDogYWRkV2FsbFN0cmluZztcclxuXHJcbiAgICAgIGNvbnN0IGFsZXJ0RGVzY3JpcHRpb24gPSB3YWxsVmlzaWJsZSA/IHdhbGxBZGRlZFN0cmluZyA6IHdhbGxSZW1vdmVkU3RyaW5nO1xyXG4gICAgICB0aGlzLmFsZXJ0RGVzY3JpcHRpb25VdHRlcmFuY2UoIGFsZXJ0RGVzY3JpcHRpb24gKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBSYWRpbyBidXR0b25zIHJlbGF0ZWQgdG8gY2hhcmdlc1xyXG4gICAgY29uc3QgUkFESU9fQlVUVE9OX1RFWFRfT1BUSU9OUyA9IHtcclxuICAgICAgZm9udDogQ09OVFJPTFNfRk9OVCxcclxuICAgICAgbWF4V2lkdGg6IDIwMFxyXG4gICAgfTtcclxuICAgIGNvbnN0IHNob3dDaGFyZ2VzUmFkaW9CdXR0b25Hcm91cCA9IG5ldyBWZXJ0aWNhbEFxdWFSYWRpb0J1dHRvbkdyb3VwKCBtb2RlbC5zaG93Q2hhcmdlc1Byb3BlcnR5LCBbIHtcclxuICAgICAgY3JlYXRlTm9kZTogdGFuZGVtID0+IG5ldyBUZXh0KFxyXG4gICAgICAgIGJhbGxvb25BcHBsZXRTaG93QWxsQ2hhcmdlc1N0cmluZyxcclxuICAgICAgICBtZXJnZSggeyB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdhbGxDaGFyZ2VzVGV4dCcgKSB9LCBSQURJT19CVVRUT05fVEVYVF9PUFRJT05TIClcclxuICAgICAgKSxcclxuICAgICAgdmFsdWU6ICdhbGwnLFxyXG4gICAgICB0YW5kZW1OYW1lOiAnc2hvd0FsbENoYXJnZXNSYWRpb0J1dHRvbicsXHJcbiAgICAgIGxhYmVsQ29udGVudDogYmFsbG9vbkFwcGxldFNob3dBbGxDaGFyZ2VzU3RyaW5nXHJcbiAgICB9LCB7XHJcbiAgICAgIGNyZWF0ZU5vZGU6IHRhbmRlbSA9PiBuZXcgVGV4dChcclxuICAgICAgICBiYWxsb29uQXBwbGV0U2hvd05vQ2hhcmdlc1N0cmluZyxcclxuICAgICAgICBtZXJnZSggeyB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdub0NoYXJnZXNUZXh0JyApIH0sIFJBRElPX0JVVFRPTl9URVhUX09QVElPTlMgKVxyXG4gICAgICApLFxyXG4gICAgICB2YWx1ZTogJ25vbmUnLFxyXG4gICAgICB0YW5kZW1OYW1lOiAnc2hvd05vQ2hhcmdlc1JhZGlvQnV0dG9uJyxcclxuICAgICAgbGFiZWxDb250ZW50OiBiYWxsb29uQXBwbGV0U2hvd05vQ2hhcmdlc1N0cmluZ1xyXG4gICAgfSwge1xyXG4gICAgICBjcmVhdGVOb2RlOiB0YW5kZW0gPT4gbmV3IFRleHQoXHJcbiAgICAgICAgYmFsbG9vbkFwcGxldFNob3dDaGFyZ2VEaWZmZXJlbmNlc1N0cmluZyxcclxuICAgICAgICBtZXJnZSggeyB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdkaWZmZXJlbnRpYWxDaGFyZ2VzVGV4dCcgKSB9LCBSQURJT19CVVRUT05fVEVYVF9PUFRJT05TIClcclxuICAgICAgKSxcclxuICAgICAgdmFsdWU6ICdkaWZmJyxcclxuICAgICAgdGFuZGVtTmFtZTogJ3Nob3dDaGFyZ2VEaWZmZXJlbmNlc1JhZGlvQnV0dG9uJyxcclxuICAgICAgbGFiZWxDb250ZW50OiBiYWxsb29uQXBwbGV0U2hvd0NoYXJnZURpZmZlcmVuY2VzU3RyaW5nXHJcbiAgICB9IF0sIHtcclxuICAgICAgdG91Y2hBcmVhWERpbGF0aW9uOiA1LFxyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdzaG93Q2hhcmdlc1JhZGlvQnV0dG9uR3JvdXAnICksXHJcblxyXG4gICAgICAvLyBwZG9tXHJcbiAgICAgIGNvbnRhaW5lclRhZ05hbWU6ICdkaXYnLFxyXG4gICAgICBsYWJlbENvbnRlbnQ6IGNoYXJnZVNldHRpbmdzTGFiZWxTdHJpbmcsXHJcbiAgICAgIGRlc2NyaXB0aW9uQ29udGVudDogY2hhcmdlU2V0dGluZ3NEZXNjcmlwdGlvblN0cmluZ1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHBkb20gLSBhbm5vdW5jZSBhbiBhbGVydCB0aGF0IGRlc2NyaWJlcyB0aGUgc3RhdGUgb2YgY2hhcmdlIHZpc2liaWxpdHksIGxpbmtlZCBsYXppbHlcclxuICAgIC8vIHNvIHRoYXQgd2UgZG9uJ3QgZ2V0IGFueSBhbGVydHMgb24gc2ltIHN0YXJ0dXBcclxuICAgIG1vZGVsLnNob3dDaGFyZ2VzUHJvcGVydHkubGF6eUxpbmsoIHZhbHVlID0+IHtcclxuICAgICAgbGV0IGFsZXJ0U3RyaW5nO1xyXG4gICAgICBpZiAoIHZhbHVlID09PSAnYWxsJyApIHtcclxuICAgICAgICBhbGVydFN0cmluZyA9IHNob3dBbGxDaGFyZ2VzQWxlcnRTdHJpbmc7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIHZhbHVlID09PSAnbm9uZScgKSB7XHJcbiAgICAgICAgYWxlcnRTdHJpbmcgPSBzaG9Ob0NoYXJnZXNBbGVydFN0cmluZztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggdmFsdWUgPT09ICdkaWZmJyApIHtcclxuICAgICAgICBhbGVydFN0cmluZyA9IHNob3dDaGFyZ2VEaWZmZXJlbmNlc0FsZXJ0U3RyaW5nO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCBhbGVydFN0cmluZywgYG5vIGludGVyYWN0aXZlIGFsZXJ0IGZvciBzaG93Q2hhcmdlc1Byb3BlcnR5IHZhbHVlICR7dmFsdWV9YCApO1xyXG4gICAgICB0aGlzLmFsZXJ0RGVzY3JpcHRpb25VdHRlcmFuY2UoIGFsZXJ0U3RyaW5nICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gUmFkaW8gYnV0dG9ucyBmb3Igc2VsZWN0aW5nIDEgdnMgMiBiYWxsb29uc1xyXG4gICAgY29uc3Qgc2NhbGUgPSAwLjE0O1xyXG4gICAgY29uc3QgeWVsbG93QmFsbG9vbkltYWdlID0gbmV3IEltYWdlKCBiYWxsb29uWWVsbG93X3BuZywgeyB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICd5ZWxsb3dCYWxsb29uSW1hZ2UnICkgfSApO1xyXG4gICAgY29uc3QgdHdvQmFsbG9vbkljb25UYW5kZW0gPSB0YW5kZW0uY3JlYXRlVGFuZGVtKCAndHdvQmFsbG9vbkljb24nICk7XHJcbiAgICBjb25zdCB0d29CYWxsb29uSWNvbiA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgbmV3IEltYWdlKCBiYWxsb29uR3JlZW5fcG5nLCB7IHg6IDE2MCwgdGFuZGVtOiB0d29CYWxsb29uSWNvblRhbmRlbS5jcmVhdGVUYW5kZW0oICdncmVlbkJhbGxvb25JbWFnZScgKSB9ICksXHJcbiAgICAgICAgeWVsbG93QmFsbG9vbkltYWdlXHJcbiAgICAgIF0sXHJcbiAgICAgIHNjYWxlOiBzY2FsZSxcclxuICAgICAgdGFuZGVtOiB0d29CYWxsb29uSWNvblRhbmRlbVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IG9uZUJhbGxvb25JY29uVGFuZGVtID0gdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ29uZUJhbGxvb25JY29uJyApO1xyXG4gICAgY29uc3Qgb25lQmFsbG9vbkljb24gPSBuZXcgTm9kZSgge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIG5ldyBJbWFnZSggYmFsbG9vblllbGxvd19wbmcsIHtcclxuICAgICAgICAgIHg6IHR3b0JhbGxvb25JY29uLndpZHRoIC8gc2NhbGUgLyAyIC0geWVsbG93QmFsbG9vbkltYWdlLndpZHRoIC8gMixcclxuICAgICAgICAgIHRhbmRlbTogb25lQmFsbG9vbkljb25UYW5kZW0uY3JlYXRlVGFuZGVtKCAneWVsbG93QmFsbG9vbkltYWdlJyApXHJcbiAgICAgICAgfSApXHJcbiAgICAgIF0sXHJcbiAgICAgIHNjYWxlOiBzY2FsZSxcclxuICAgICAgdGFuZGVtOiBvbmVCYWxsb29uSWNvblRhbmRlbVxyXG4gICAgfSApO1xyXG5cclxuICAgIGxldCBzaG93U2Vjb25kQmFsbG9vblNlbGVjdG9yID0gbnVsbDtcclxuICAgIGlmICggIUJBU0VRdWVyeVBhcmFtZXRlcnMuaGlkZUJhbGxvb25Td2l0Y2ggKSB7XHJcbiAgICAgIHNob3dTZWNvbmRCYWxsb29uU2VsZWN0b3IgPSBuZXcgVHdvU2NlbmVTZWxlY3Rpb25Ob2RlKFxyXG4gICAgICAgIG1vZGVsLmdyZWVuQmFsbG9vbi5pc1Zpc2libGVQcm9wZXJ0eSxcclxuICAgICAgICBmYWxzZSxcclxuICAgICAgICB0cnVlLFxyXG4gICAgICAgIG9uZUJhbGxvb25JY29uLFxyXG4gICAgICAgIHR3b0JhbGxvb25JY29uLCB7XHJcbiAgICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdzaG93U2Vjb25kQmFsbG9vblNlbGVjdG9yJyApLFxyXG4gICAgICAgICAgbWFza0ZpbGw6IEJBU0VDb25zdGFudHMuYmFja2dyb3VuZENvbG9yUHJvcGVydHksXHJcbiAgICAgICAgICBhcmlhTGFiZWw6IHR3b0JhbGxvb25FeHBlcmltZW50TGFiZWxTdHJpbmcsXHJcbiAgICAgICAgICBjb250YWluZXJUYWdOYW1lOiAnZGl2JyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uQ29udGVudDogdHdvQmFsbG9vbkV4cGVyaW1lbnREZXNjcmlwdGlvblN0cmluZ1xyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAnUmVzZXQgQmFsbG9vbnMnIGJ1dHRvblxyXG4gICAgY29uc3QgcmVzZXRCYWxsb29uVG9nZ2xlTm9kZSA9IG5ldyBCb29sZWFuVG9nZ2xlTm9kZSggbW9kZWwuZ3JlZW5CYWxsb29uLmlzVmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICBuZXcgVGV4dCggcmVzZXRCYWxsb29uc1N0cmluZywge1xyXG4gICAgICAgIGZvbnQ6IENPTlRST0xTX0ZPTlQsXHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAncmVzZXRCYWxsb29uc1RleHQnIClcclxuICAgICAgfSApLFxyXG4gICAgICBuZXcgVGV4dCggcmVzZXRCYWxsb29uU3RyaW5nLCB7XHJcbiAgICAgICAgZm9udDogQ09OVFJPTFNfRk9OVCxcclxuICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdyZXNldEJhbGxvb25UZXh0JyApXHJcbiAgICAgIH0gKSwgeyBtYXhXaWR0aDogMTQwLCB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdyZXNldEJhbGxvb25Ub2dnbGVOb2RlJyApIH0gKTtcclxuICAgIGNvbnN0IHJlc2V0QmFsbG9vbkJ1dHRvbkxpc3RlbmVyID0gKCkgPT4ge1xyXG5cclxuICAgICAgLy8gZGlzYWJsZSBvdGhlciBhbGVydHMgdW50aWwgYWZ0ZXIgd2UgYXJlIGZpbmlzaGVkIHJlc2V0dGluZyB0aGUgYmFsbG9vbnNcclxuICAgICAgdGhpcy5mb3JFYWNoVXR0ZXJhbmNlUXVldWUoIHV0dGVyYW5jZVF1ZXVlID0+IHsgdXR0ZXJhbmNlUXVldWUuZW5hYmxlZCA9IGZhbHNlOyB9ICk7XHJcblxyXG4gICAgICBtb2RlbC5zd2VhdGVyLnJlc2V0KCk7XHJcbiAgICAgIG1vZGVsLmJhbGxvb25zLmZvckVhY2goIGJhbGxvb24gPT4ge1xyXG4gICAgICAgIGJhbGxvb24ucmVzZXQoIHRydWUgKTtcclxuICAgICAgfSApO1xyXG5cclxuICAgICAgLy8gTWFrZSBzdXJlIHRoZSBiYWxsb29ucyBhcmUgY29ycmVjdGx5IGxheWVyZWQgaW4gdGhlIHZpZXcuXHJcbiAgICAgIHZpZXcuc2V0RGVmYXVsdEJhbGxvb25aT3JkZXIoKTtcclxuXHJcbiAgICAgIHRoaXMuZm9yRWFjaFV0dGVyYW5jZVF1ZXVlKCB1dHRlcmFuY2VRdWV1ZSA9PiB7IHV0dGVyYW5jZVF1ZXVlLmVuYWJsZWQgPSB0cnVlOyB9ICk7XHJcblxyXG4gICAgICAvLyBhbGVydCB0byBhc3Npc3RpdmUgdGVjaG5vbG9neVxyXG4gICAgICB0aGlzLmFsZXJ0RGVzY3JpcHRpb25VdHRlcmFuY2UoIFN0cmluZ1V0aWxzLmZpbGxJbiggcmVzZXRCYWxsb29uc0FsZXJ0UGF0dGVyblN0cmluZywge1xyXG4gICAgICAgIGJhbGxvb25zOiBtb2RlbC5ncmVlbkJhbGxvb24uaXNWaXNpYmxlUHJvcGVydHkuZ2V0KCkgPyBiYWxsb29uc1N0cmluZyA6IGJhbGxvb25TdHJpbmdcclxuICAgICAgfSApICk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcmVzZXRCYWxsb29uQnV0dG9uID0gbmV3IFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbigge1xyXG4gICAgICBjb250ZW50OiByZXNldEJhbGxvb25Ub2dnbGVOb2RlLFxyXG4gICAgICBiYXNlQ29sb3I6ICdyZ2IoIDI1NSwgMjAwLCAwICknLFxyXG4gICAgICBsaXN0ZW5lcjogcmVzZXRCYWxsb29uQnV0dG9uTGlzdGVuZXIsXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3Jlc2V0QmFsbG9vbkJ1dHRvbicgKSxcclxuXHJcbiAgICAgIC8vIHBkb21cclxuICAgICAgY29udGFpbmVyVGFnTmFtZTogJ2RpdicsXHJcbiAgICAgIGFwcGVuZERlc2NyaXB0aW9uOiB0cnVlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gY3JlYXRlIHRoZSBhY2Nlc3NpYmxlIGRlc2NyaXB0aW9uIGZvciB0aGUgcmVzZXQgYmFsbG9vbiBidXR0b25cclxuICAgIGNvbnN0IGdlbmVyYXRlRGVzY3JpcHRpb25TdHJpbmcgPSBiYWxsb29uVmlzaWJsZSA9PiB7XHJcbiAgICAgIGNvbnN0IGJhbGxvb25EZXNjcmlwdGlvblN0cmluZyA9IGJhbGxvb25WaXNpYmxlID8gYmFsbG9vbnNTdHJpbmcgOiBiYWxsb29uU3RyaW5nO1xyXG4gICAgICBjb25zdCBwb3NpdGlvbkRlc2NyaXB0aW9uU3RyaW5nID0gYmFsbG9vblZpc2libGUgPyBwb3NpdGlvbnNTdHJpbmcgOiBwb3NpdGlvblN0cmluZztcclxuICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZpbGxJbiggcmVzZXRCYWxsb29uc0Rlc2NyaXB0aW9uUGF0dGVyblN0cmluZywge1xyXG4gICAgICAgIGJhbGxvb25zOiBiYWxsb29uRGVzY3JpcHRpb25TdHJpbmcsXHJcbiAgICAgICAgcG9zaXRpb25zOiBwb3NpdGlvbkRlc2NyaXB0aW9uU3RyaW5nXHJcbiAgICAgIH0gKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gdXBkYXRlIHRoZSBidXR0b24gZGVzY3JpcHRpb24gd2hlbiB0aGUgZ3JlZW4gYmFsbG9vbiBpcyBtYWRlIHZpc2libGVcclxuICAgIG1vZGVsLmdyZWVuQmFsbG9vbi5pc1Zpc2libGVQcm9wZXJ0eS5saW5rKCBpc1Zpc2libGUgPT4ge1xyXG4gICAgICByZXNldEJhbGxvb25CdXR0b24uZGVzY3JpcHRpb25Db250ZW50ID0gZ2VuZXJhdGVEZXNjcmlwdGlvblN0cmluZyggaXNWaXNpYmxlICk7XHJcbiAgICAgIHJlc2V0QmFsbG9vbkJ1dHRvbi5pbm5lckNvbnRlbnQgPSBpc1Zpc2libGUgPyByZXNldEJhbGxvb25zU3RyaW5nIDogcmVzZXRCYWxsb29uU3RyaW5nO1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGJhbGxvb25zUGFuZWwgPSBuZXcgVkJveCgge1xyXG4gICAgICBzcGFjaW5nOiAyLFxyXG4gICAgICBjaGlsZHJlbjogc2hvd1NlY29uZEJhbGxvb25TZWxlY3RvciA/IFsgc2hvd1NlY29uZEJhbGxvb25TZWxlY3RvciwgcmVzZXRCYWxsb29uQnV0dG9uIF0gOiBbIHJlc2V0QmFsbG9vbkJ1dHRvbiBdLFxyXG5cclxuICAgICAgLy8gcGRvbVxyXG4gICAgICB0YWdOYW1lOiAnZGl2JyxcclxuICAgICAgbGFiZWxUYWdOYW1lOiAnaDMnLFxyXG4gICAgICBsYWJlbENvbnRlbnQ6IGJhbGxvb25TZXR0aW5nc0xhYmVsU3RyaW5nXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy9BZGQgdGhlIGNvbnRyb2xzIGF0IHRoZSByaWdodCwgd2l0aCB0aGUgcmVzZXQgYWxsIGJ1dHRvbiBhbmQgdGhlIHdhbGwgYnV0dG9uXHJcbiAgICBjb25zdCByZXNldEFsbEJ1dHRvbiA9IG5ldyBSZXNldEFsbEJ1dHRvbigge1xyXG4gICAgICBsaXN0ZW5lcjogKCkgPT4ge1xyXG4gICAgICAgIG1vZGVsLnJlc2V0KCk7XHJcbiAgICAgICAgdmlldy5zZXREZWZhdWx0QmFsbG9vblpPcmRlcigpO1xyXG4gICAgICB9LFxyXG4gICAgICBzY2FsZTogMC45NixcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAncmVzZXRBbGxCdXR0b24nIClcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBjb250cm9scyA9IG5ldyBIQm94KCB7XHJcbiAgICAgIHNwYWNpbmc6IDE0LFxyXG4gICAgICBhbGlnbjogJ2JvdHRvbScsXHJcbiAgICAgIGNoaWxkcmVuOiBbIHJlc2V0QWxsQnV0dG9uLCB0aGlzLndhbGxCdXR0b24gXVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGxheW91dEJvdW5kcyA9IHZpZXcubGF5b3V0Qm91bmRzO1xyXG5cclxuICAgIC8vIG1vcmUgdGhhbiBvdGhlciBjb250cm9scyBzbyB0aGUgcmVzZXQgYnV0dG9uIHRvdWNoIGFyZWEgZG9lc24ndCBvdmVybGFwIHRoZSBuYXYgYmFyXHJcbiAgICBjb250cm9scy5ib3R0b20gPSBsYXlvdXRCb3VuZHMubWF4WSAtIEJPVFRPTV9DT05UUk9MX1NQQUNJTkc7XHJcbiAgICBjb250cm9scy5yaWdodCA9IGxheW91dEJvdW5kcy5tYXhYIC0gNC41Oy8vIHNvIFwiUmVtb3ZlIFdhbGxcIiBidXR0b24gbG9va3MgY2VudGVyZWQgd2l0aCB3YWxsXHJcblxyXG4gICAgbGV0IHZpc2liaWxpdHlDb250cm9scztcclxuICAgIGxldCBjb250cm9sc0xlZnQ7XHJcbiAgICBpZiAoIEJBU0VRdWVyeVBhcmFtZXRlcnMuaGlkZUNoYXJnZUNvbnRyb2xzICkge1xyXG4gICAgICB2aXNpYmlsaXR5Q29udHJvbHMgPSBbIGJhbGxvb25zUGFuZWwgXTtcclxuICAgICAgY29udHJvbHNMZWZ0ID0gbGF5b3V0Qm91bmRzLndpZHRoIC8gMiAtIGJhbGxvb25zUGFuZWwud2lkdGggLyAyO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHZpc2liaWxpdHlDb250cm9scyA9IFtcclxuICAgICAgICBuZXcgUGFuZWwoIHNob3dDaGFyZ2VzUmFkaW9CdXR0b25Hcm91cCwgeyB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICd2aXNpYmlsaXR5UGFuZWwnICkgfSApLFxyXG4gICAgICAgIGJhbGxvb25zUGFuZWxcclxuICAgICAgXTtcclxuICAgICAgY29udHJvbHNMZWZ0ID0gNzA7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5hZGRDaGlsZCggbmV3IEhCb3goIHtcclxuICAgICAgc3BhY2luZzogNTAsXHJcbiAgICAgIGNoaWxkcmVuOiB2aXNpYmlsaXR5Q29udHJvbHMsXHJcbiAgICAgIGFsaWduOiAnYm90dG9tJyxcclxuICAgICAgbGVmdDogY29udHJvbHNMZWZ0LFxyXG4gICAgICBib3R0b206IGxheW91dEJvdW5kcy5tYXhZIC0gQk9UVE9NX0NPTlRST0xfU1BBQ0lOR1xyXG4gICAgfSApICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBjb250cm9scyApO1xyXG5cclxuICAgIHRoaXMucGRvbU9yZGVyID0gWyB0aGlzLndhbGxCdXR0b24sIGJhbGxvb25zUGFuZWwsIHNob3dDaGFyZ2VzUmFkaW9CdXR0b25Hcm91cCwgcmVzZXRBbGxCdXR0b24gXTtcclxuXHJcbiAgfVxyXG59XHJcblxyXG5iYWxsb29uc0FuZFN0YXRpY0VsZWN0cmljaXR5LnJlZ2lzdGVyKCAnQ29udHJvbFBh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