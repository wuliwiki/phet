// Copyright 2016-2022, University of Colorado Boulder

/**
 * Creates a scene selection switch for two scenes.  The visual is styled similar to radio
 * buttons, but clicking anywhere within the bounds of the switch will change the value,
 * which makes the interaction different from a radio group.
 *
 * Therefore, this is a single button styled like two buttons.  It uses custom input listeners
 * because the typical sun button model would have modeled and styled these as two separate
 * buttons.
 *
 * This was created in support of accessibility.  It may be moved into common code at some point.  Alternatively, it
 * may be obsoleted and replaced with a regular, accessible radio button group.  See
 * https://github.com/phetsims/balloons-and-static-electricity/issues/213 for the discussion on this topic.
 *
 * @author Jesse Greenberg
 * @author John Blanco
 */

import Emitter from '../../../../axon/js/Emitter.js';
import { Shape } from '../../../../kite/js/imports.js';
import merge from '../../../../phet-core/js/merge.js';
import { AlignGroup, Color, DownUpListener, FlowBox, InteractiveHighlighting, Node, Path, PressListener, SceneryConstants } from '../../../../scenery/js/imports.js';
import multiSelectionSoundPlayerFactory from '../../../../tambo/js/multiSelectionSoundPlayerFactory.js';
import EventType from '../../../../tandem/js/EventType.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import balloonsAndStaticElectricity from '../../balloonsAndStaticElectricity.js';

// constants
const DEFAULT_FILL = new Color('white');
class TwoSceneSelectionNode extends InteractiveHighlighting(Node) {
  /**
   * @param {Property} property
   * @param {Object} valueA - valid value for the property
   * @param {Object} valueB - alternate valid value for the property
   * @param {Node} nodeA
   * @param {Node} nodeB
   * @param {Object} [options]
   */
  constructor(property, valueA, valueB, nodeA, nodeB, options) {
    options = merge({
      // FlowBox options - buttons oriented with a FlowBox
      spacing: 10,
      orientation: 'horizontal',
      align: 'center',
      // mask behind the buttons - if non null, hides everything behind
      maskFill: null,
      // The fill for the buttons - default is white
      baseColor: DEFAULT_FILL,
      pressedColor: DEFAULT_FILL.colorUtilsDarker(0.4),
      // Opacity can be set separately for the buttons and button content.

      opacityWhenDisabled: SceneryConstants.DISABLED_OPACITY,
      // Don't collide with Node.disabledOpacity option

      buttonAppearanceStrategyOptions: {
        selectedButtonOpacity: 1,
        deselectedButtonOpacity: 0.6,
        selectedStroke: 'black',
        deselectedStroke: new Color(50, 50, 50),
        selectedLineWidth: 1.5,
        deselectedLineWidth: 1,
        overButtonOpacity: 0.8
      },
      contentAppearanceStrategyOptions: {
        overContentOpacity: 0.8,
        selectedContentOpacity: 1,
        deselectedContentOpacity: 0.6
      },
      // These margins are *within* each button, relative to the largest of the two icons
      buttonContentXMargin: 5,
      buttonContentYMargin: 5,
      cornerRadius: 4,
      // TouchArea expansion
      touchAreaXDilation: 0,
      touchAreaYDilation: 0,
      // MouseArea expansion
      mouseAreaXDilation: 0,
      mouseAreaYDilation: 0,
      cursor: 'pointer',
      // tandem support
      tandem: Tandem.REQUIRED,
      // pdom
      tagName: 'input',
      inputType: 'checkbox',
      appendDescription: true
    }, options);
    super(options);

    // place the nodes in an align group so that the two buttons will have identical sizing
    const buttonAlignGroup = new AlignGroup();
    const aBox = buttonAlignGroup.createBox(nodeA);
    const bBox = buttonAlignGroup.createBox(nodeB);

    // use a path so that the line width can be updated
    const xMargin = options.buttonContentXMargin;
    const yMargin = options.buttonContentYMargin;
    const cornerRadius = options.cornerRadius;
    const aButton = new Node();
    const bButton = new Node();

    // aBox.bounds === bBox.bounds since we are using AlignGroup
    const rectShape = Shape.roundRect(-xMargin, -yMargin, aBox.width + 2 * xMargin, aBox.height + 2 * yMargin, cornerRadius, cornerRadius);
    const aButtonPath = new Path(rectShape);
    const bButtonPath = new Path(rectShape);

    // if there should be a mask, add before the buttons
    if (options.maskFill) {
      aButton.addChild(new Path(rectShape, {
        fill: options.maskFill
      }));
      bButton.addChild(new Path(rectShape, {
        fill: options.maskFill
      }));
    }
    aButton.addChild(aButtonPath);
    bButton.addChild(bButtonPath);

    // add the icons
    aButtonPath.addChild(aBox);
    bButtonPath.addChild(bBox);
    const buttonBox = new FlowBox({
      spacing: options.spacing,
      orientation: options.orientation,
      align: options.align,
      children: [aButton, bButton],
      resize: false
    });
    this.addChild(buttonBox);

    // sets the styles of the buttons after an interaction, including the stroke, opacity, lineWidth, and fill,
    // depending on whether or not the button is enabled
    const setStyles = enabled => {
      let selectedButton;
      let deselectedButton;
      let selectedContent;
      let deselectedContent;
      if (property.get() === valueA) {
        selectedButton = aButtonPath;
        deselectedButton = bButtonPath;
        selectedContent = nodeA;
        deselectedContent = nodeB;
      } else {
        selectedButton = bButtonPath;
        deselectedButton = aButtonPath;
        selectedContent = nodeB;
        deselectedContent = nodeA;
      }
      selectedButton.stroke = options.buttonAppearanceStrategyOptions.selectedStroke;
      deselectedButton.stroke = options.buttonAppearanceStrategyOptions.deselectedStroke;
      selectedButton.opacity = options.buttonAppearanceStrategyOptions.selectedButtonOpacity;
      deselectedButton.opacity = options.buttonAppearanceStrategyOptions.deselectedButtonOpacity;
      selectedContent.opacity = options.contentAppearanceStrategyOptions.selectedContentOpacity;
      deselectedContent.opacity = options.contentAppearanceStrategyOptions.deselectedContentOpacity;
      selectedButton.lineWidth = options.buttonAppearanceStrategyOptions.selectedLineWidth;
      deselectedButton.lineWidth = options.buttonAppearanceStrategyOptions.deselectedLineWidth;
      if (!enabled) {
        this.opacity = options.opacityWhenDisabled;
        selectedButton.fill = options.baseColor;
        deselectedButton.fill = options.baseColor;
      } else {
        selectedButton.fill = options.baseColor;
        deselectedButton.fill = options.baseColor;
      }
    };
    property.link(value => {
      // update the button look and its accessible pressed state
      setStyles(this.enabledProperty.get());
    });

    // sound players
    const soundPlayerForOneBalloon = multiSelectionSoundPlayerFactory.getSelectionSoundPlayer(4);
    const soundPlayerForTwoBalloons = multiSelectionSoundPlayerFactory.getSelectionSoundPlayer(5);
    const upFunction = () => {
      const newValue = property.get() === valueA ? valueB : valueA;
      newValue ? soundPlayerForTwoBalloons.play() : soundPlayerForOneBalloon.play();
      property.set(newValue);
      setStyles(this.enabledProperty.get());
    };

    // Internal emitter for the PhET-iO data stream, see https://github.com/phetsims/sun/issues/396
    const firedEmitter = new Emitter({
      tandem: options.tandem.createTandem('firedEmitter'),
      phetioDocumentation: 'emits to change the selection',
      phetioEventType: EventType.USER
    });
    firedEmitter.addListener(upFunction);
    const downUpListener = new DownUpListener({
      up: () => {
        firedEmitter.emit();
      },
      down: () => {
        const otherButton = property.get() === valueA ? bButtonPath : aButtonPath;
        otherButton.fill = options.pressedColor;
      }
    });

    // considered "checked" for accessibility when node B is selected
    const propertyListener = value => {
      this.setPDOMChecked(value === valueB);
    };

    // listener that highlights the unselected button when mouse is over
    const highlightListener = new PressListener({
      tandem: options.tandem.createTandem('highlightListener')
    });
    highlightListener.isHighlightedProperty.link(highlighted => {
      const otherButton = property.get() === valueA ? bButtonPath : aButtonPath;
      const otherContent = property.get() === valueA ? nodeB : nodeA;
      const buttonOpacity = highlighted ? options.buttonAppearanceStrategyOptions.overButtonOpacity : options.buttonAppearanceStrategyOptions.deselectedButtonOpacity;
      const contentOpacity = highlighted ? options.contentAppearanceStrategyOptions.overContentOpacity : options.contentAppearanceStrategyOptions.deselectedContentOpacity;
      otherButton.opacity = buttonOpacity;
      otherContent.opacity = contentOpacity;
    });

    // listener that is called when the button is pressed with 'enter' or 'spacebar'
    const clickListener = {
      click: upFunction
    };

    // add listeners
    this.addInputListener(downUpListener);
    this.addInputListener(highlightListener);
    this.enabledProperty.link(setStyles);
    property.link(propertyListener);
    this.addInputListener(clickListener);

    // set mouse and touch areas
    this.mouseArea = this.bounds.dilatedXY(options.mouseAreaXDilation, options.mouseAreaYDilation);
    this.touchArea = this.bounds.dilatedXY(options.touchAreaXDilation, options.touchAreaYDilation);
  }
}
balloonsAndStaticElectricity.register('TwoSceneSelectionNode', TwoSceneSelectionNode);
export default TwoSceneSelectionNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFbWl0dGVyIiwiU2hhcGUiLCJtZXJnZSIsIkFsaWduR3JvdXAiLCJDb2xvciIsIkRvd25VcExpc3RlbmVyIiwiRmxvd0JveCIsIkludGVyYWN0aXZlSGlnaGxpZ2h0aW5nIiwiTm9kZSIsIlBhdGgiLCJQcmVzc0xpc3RlbmVyIiwiU2NlbmVyeUNvbnN0YW50cyIsIm11bHRpU2VsZWN0aW9uU291bmRQbGF5ZXJGYWN0b3J5IiwiRXZlbnRUeXBlIiwiVGFuZGVtIiwiYmFsbG9vbnNBbmRTdGF0aWNFbGVjdHJpY2l0eSIsIkRFRkFVTFRfRklMTCIsIlR3b1NjZW5lU2VsZWN0aW9uTm9kZSIsImNvbnN0cnVjdG9yIiwicHJvcGVydHkiLCJ2YWx1ZUEiLCJ2YWx1ZUIiLCJub2RlQSIsIm5vZGVCIiwib3B0aW9ucyIsInNwYWNpbmciLCJvcmllbnRhdGlvbiIsImFsaWduIiwibWFza0ZpbGwiLCJiYXNlQ29sb3IiLCJwcmVzc2VkQ29sb3IiLCJjb2xvclV0aWxzRGFya2VyIiwib3BhY2l0eVdoZW5EaXNhYmxlZCIsIkRJU0FCTEVEX09QQUNJVFkiLCJidXR0b25BcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zIiwic2VsZWN0ZWRCdXR0b25PcGFjaXR5IiwiZGVzZWxlY3RlZEJ1dHRvbk9wYWNpdHkiLCJzZWxlY3RlZFN0cm9rZSIsImRlc2VsZWN0ZWRTdHJva2UiLCJzZWxlY3RlZExpbmVXaWR0aCIsImRlc2VsZWN0ZWRMaW5lV2lkdGgiLCJvdmVyQnV0dG9uT3BhY2l0eSIsImNvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zIiwib3ZlckNvbnRlbnRPcGFjaXR5Iiwic2VsZWN0ZWRDb250ZW50T3BhY2l0eSIsImRlc2VsZWN0ZWRDb250ZW50T3BhY2l0eSIsImJ1dHRvbkNvbnRlbnRYTWFyZ2luIiwiYnV0dG9uQ29udGVudFlNYXJnaW4iLCJjb3JuZXJSYWRpdXMiLCJ0b3VjaEFyZWFYRGlsYXRpb24iLCJ0b3VjaEFyZWFZRGlsYXRpb24iLCJtb3VzZUFyZWFYRGlsYXRpb24iLCJtb3VzZUFyZWFZRGlsYXRpb24iLCJjdXJzb3IiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsInRhZ05hbWUiLCJpbnB1dFR5cGUiLCJhcHBlbmREZXNjcmlwdGlvbiIsImJ1dHRvbkFsaWduR3JvdXAiLCJhQm94IiwiY3JlYXRlQm94IiwiYkJveCIsInhNYXJnaW4iLCJ5TWFyZ2luIiwiYUJ1dHRvbiIsImJCdXR0b24iLCJyZWN0U2hhcGUiLCJyb3VuZFJlY3QiLCJ3aWR0aCIsImhlaWdodCIsImFCdXR0b25QYXRoIiwiYkJ1dHRvblBhdGgiLCJhZGRDaGlsZCIsImZpbGwiLCJidXR0b25Cb3giLCJjaGlsZHJlbiIsInJlc2l6ZSIsInNldFN0eWxlcyIsImVuYWJsZWQiLCJzZWxlY3RlZEJ1dHRvbiIsImRlc2VsZWN0ZWRCdXR0b24iLCJzZWxlY3RlZENvbnRlbnQiLCJkZXNlbGVjdGVkQ29udGVudCIsImdldCIsInN0cm9rZSIsIm9wYWNpdHkiLCJsaW5lV2lkdGgiLCJsaW5rIiwidmFsdWUiLCJlbmFibGVkUHJvcGVydHkiLCJzb3VuZFBsYXllckZvck9uZUJhbGxvb24iLCJnZXRTZWxlY3Rpb25Tb3VuZFBsYXllciIsInNvdW5kUGxheWVyRm9yVHdvQmFsbG9vbnMiLCJ1cEZ1bmN0aW9uIiwibmV3VmFsdWUiLCJwbGF5Iiwic2V0IiwiZmlyZWRFbWl0dGVyIiwiY3JlYXRlVGFuZGVtIiwicGhldGlvRG9jdW1lbnRhdGlvbiIsInBoZXRpb0V2ZW50VHlwZSIsIlVTRVIiLCJhZGRMaXN0ZW5lciIsImRvd25VcExpc3RlbmVyIiwidXAiLCJlbWl0IiwiZG93biIsIm90aGVyQnV0dG9uIiwicHJvcGVydHlMaXN0ZW5lciIsInNldFBET01DaGVja2VkIiwiaGlnaGxpZ2h0TGlzdGVuZXIiLCJpc0hpZ2hsaWdodGVkUHJvcGVydHkiLCJoaWdobGlnaHRlZCIsIm90aGVyQ29udGVudCIsImJ1dHRvbk9wYWNpdHkiLCJjb250ZW50T3BhY2l0eSIsImNsaWNrTGlzdGVuZXIiLCJjbGljayIsImFkZElucHV0TGlzdGVuZXIiLCJtb3VzZUFyZWEiLCJib3VuZHMiLCJkaWxhdGVkWFkiLCJ0b3VjaEFyZWEiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlR3b1NjZW5lU2VsZWN0aW9uTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNi0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgc2NlbmUgc2VsZWN0aW9uIHN3aXRjaCBmb3IgdHdvIHNjZW5lcy4gIFRoZSB2aXN1YWwgaXMgc3R5bGVkIHNpbWlsYXIgdG8gcmFkaW9cclxuICogYnV0dG9ucywgYnV0IGNsaWNraW5nIGFueXdoZXJlIHdpdGhpbiB0aGUgYm91bmRzIG9mIHRoZSBzd2l0Y2ggd2lsbCBjaGFuZ2UgdGhlIHZhbHVlLFxyXG4gKiB3aGljaCBtYWtlcyB0aGUgaW50ZXJhY3Rpb24gZGlmZmVyZW50IGZyb20gYSByYWRpbyBncm91cC5cclxuICpcclxuICogVGhlcmVmb3JlLCB0aGlzIGlzIGEgc2luZ2xlIGJ1dHRvbiBzdHlsZWQgbGlrZSB0d28gYnV0dG9ucy4gIEl0IHVzZXMgY3VzdG9tIGlucHV0IGxpc3RlbmVyc1xyXG4gKiBiZWNhdXNlIHRoZSB0eXBpY2FsIHN1biBidXR0b24gbW9kZWwgd291bGQgaGF2ZSBtb2RlbGVkIGFuZCBzdHlsZWQgdGhlc2UgYXMgdHdvIHNlcGFyYXRlXHJcbiAqIGJ1dHRvbnMuXHJcbiAqXHJcbiAqIFRoaXMgd2FzIGNyZWF0ZWQgaW4gc3VwcG9ydCBvZiBhY2Nlc3NpYmlsaXR5LiAgSXQgbWF5IGJlIG1vdmVkIGludG8gY29tbW9uIGNvZGUgYXQgc29tZSBwb2ludC4gIEFsdGVybmF0aXZlbHksIGl0XHJcbiAqIG1heSBiZSBvYnNvbGV0ZWQgYW5kIHJlcGxhY2VkIHdpdGggYSByZWd1bGFyLCBhY2Nlc3NpYmxlIHJhZGlvIGJ1dHRvbiBncm91cC4gIFNlZVxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvYmFsbG9vbnMtYW5kLXN0YXRpYy1lbGVjdHJpY2l0eS9pc3N1ZXMvMjEzIGZvciB0aGUgZGlzY3Vzc2lvbiBvbiB0aGlzIHRvcGljLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZ1xyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvXHJcbiAqL1xyXG5cclxuaW1wb3J0IEVtaXR0ZXIgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9FbWl0dGVyLmpzJztcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IHsgQWxpZ25Hcm91cCwgQ29sb3IsIERvd25VcExpc3RlbmVyLCBGbG93Qm94LCBJbnRlcmFjdGl2ZUhpZ2hsaWdodGluZywgTm9kZSwgUGF0aCwgUHJlc3NMaXN0ZW5lciwgU2NlbmVyeUNvbnN0YW50cyB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBtdWx0aVNlbGVjdGlvblNvdW5kUGxheWVyRmFjdG9yeSBmcm9tICcuLi8uLi8uLi8uLi90YW1iby9qcy9tdWx0aVNlbGVjdGlvblNvdW5kUGxheWVyRmFjdG9yeS5qcyc7XHJcbmltcG9ydCBFdmVudFR5cGUgZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL0V2ZW50VHlwZS5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBiYWxsb29uc0FuZFN0YXRpY0VsZWN0cmljaXR5IGZyb20gJy4uLy4uL2JhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHkuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IERFRkFVTFRfRklMTCA9IG5ldyBDb2xvciggJ3doaXRlJyApO1xyXG5cclxuY2xhc3MgVHdvU2NlbmVTZWxlY3Rpb25Ob2RlIGV4dGVuZHMgSW50ZXJhY3RpdmVIaWdobGlnaHRpbmcoIE5vZGUgKSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHl9IHByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtPYmplY3R9IHZhbHVlQSAtIHZhbGlkIHZhbHVlIGZvciB0aGUgcHJvcGVydHlcclxuICAgKiBAcGFyYW0ge09iamVjdH0gdmFsdWVCIC0gYWx0ZXJuYXRlIHZhbGlkIHZhbHVlIGZvciB0aGUgcHJvcGVydHlcclxuICAgKiBAcGFyYW0ge05vZGV9IG5vZGVBXHJcbiAgICogQHBhcmFtIHtOb2RlfSBub2RlQlxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggcHJvcGVydHksIHZhbHVlQSwgdmFsdWVCLCBub2RlQSwgbm9kZUIsIG9wdGlvbnMgKSB7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcblxyXG4gICAgICAvLyBGbG93Qm94IG9wdGlvbnMgLSBidXR0b25zIG9yaWVudGVkIHdpdGggYSBGbG93Qm94XHJcbiAgICAgIHNwYWNpbmc6IDEwLFxyXG4gICAgICBvcmllbnRhdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICBhbGlnbjogJ2NlbnRlcicsXHJcblxyXG4gICAgICAvLyBtYXNrIGJlaGluZCB0aGUgYnV0dG9ucyAtIGlmIG5vbiBudWxsLCBoaWRlcyBldmVyeXRoaW5nIGJlaGluZFxyXG4gICAgICBtYXNrRmlsbDogbnVsbCxcclxuXHJcbiAgICAgIC8vIFRoZSBmaWxsIGZvciB0aGUgYnV0dG9ucyAtIGRlZmF1bHQgaXMgd2hpdGVcclxuICAgICAgYmFzZUNvbG9yOiBERUZBVUxUX0ZJTEwsXHJcbiAgICAgIHByZXNzZWRDb2xvcjogREVGQVVMVF9GSUxMLmNvbG9yVXRpbHNEYXJrZXIoIDAuNCApLFxyXG5cclxuICAgICAgLy8gT3BhY2l0eSBjYW4gYmUgc2V0IHNlcGFyYXRlbHkgZm9yIHRoZSBidXR0b25zIGFuZCBidXR0b24gY29udGVudC5cclxuXHJcbiAgICAgIG9wYWNpdHlXaGVuRGlzYWJsZWQ6IFNjZW5lcnlDb25zdGFudHMuRElTQUJMRURfT1BBQ0lUWSwgLy8gRG9uJ3QgY29sbGlkZSB3aXRoIE5vZGUuZGlzYWJsZWRPcGFjaXR5IG9wdGlvblxyXG5cclxuICAgICAgYnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5T3B0aW9uczoge1xyXG4gICAgICAgIHNlbGVjdGVkQnV0dG9uT3BhY2l0eTogMSxcclxuICAgICAgICBkZXNlbGVjdGVkQnV0dG9uT3BhY2l0eTogMC42LFxyXG4gICAgICAgIHNlbGVjdGVkU3Ryb2tlOiAnYmxhY2snLFxyXG4gICAgICAgIGRlc2VsZWN0ZWRTdHJva2U6IG5ldyBDb2xvciggNTAsIDUwLCA1MCApLFxyXG4gICAgICAgIHNlbGVjdGVkTGluZVdpZHRoOiAxLjUsXHJcbiAgICAgICAgZGVzZWxlY3RlZExpbmVXaWR0aDogMSxcclxuICAgICAgICBvdmVyQnV0dG9uT3BhY2l0eTogMC44XHJcbiAgICAgIH0sXHJcbiAgICAgIGNvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zOiB7XHJcbiAgICAgICAgb3ZlckNvbnRlbnRPcGFjaXR5OiAwLjgsXHJcbiAgICAgICAgc2VsZWN0ZWRDb250ZW50T3BhY2l0eTogMSxcclxuICAgICAgICBkZXNlbGVjdGVkQ29udGVudE9wYWNpdHk6IDAuNlxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gVGhlc2UgbWFyZ2lucyBhcmUgKndpdGhpbiogZWFjaCBidXR0b24sIHJlbGF0aXZlIHRvIHRoZSBsYXJnZXN0IG9mIHRoZSB0d28gaWNvbnNcclxuICAgICAgYnV0dG9uQ29udGVudFhNYXJnaW46IDUsXHJcbiAgICAgIGJ1dHRvbkNvbnRlbnRZTWFyZ2luOiA1LFxyXG5cclxuICAgICAgY29ybmVyUmFkaXVzOiA0LFxyXG5cclxuICAgICAgLy8gVG91Y2hBcmVhIGV4cGFuc2lvblxyXG4gICAgICB0b3VjaEFyZWFYRGlsYXRpb246IDAsXHJcbiAgICAgIHRvdWNoQXJlYVlEaWxhdGlvbjogMCxcclxuXHJcbiAgICAgIC8vIE1vdXNlQXJlYSBleHBhbnNpb25cclxuICAgICAgbW91c2VBcmVhWERpbGF0aW9uOiAwLFxyXG4gICAgICBtb3VzZUFyZWFZRGlsYXRpb246IDAsXHJcblxyXG4gICAgICBjdXJzb3I6ICdwb2ludGVyJyxcclxuXHJcbiAgICAgIC8vIHRhbmRlbSBzdXBwb3J0XHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVELFxyXG5cclxuICAgICAgLy8gcGRvbVxyXG4gICAgICB0YWdOYW1lOiAnaW5wdXQnLFxyXG4gICAgICBpbnB1dFR5cGU6ICdjaGVja2JveCcsXHJcbiAgICAgIGFwcGVuZERlc2NyaXB0aW9uOiB0cnVlXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBwbGFjZSB0aGUgbm9kZXMgaW4gYW4gYWxpZ24gZ3JvdXAgc28gdGhhdCB0aGUgdHdvIGJ1dHRvbnMgd2lsbCBoYXZlIGlkZW50aWNhbCBzaXppbmdcclxuICAgIGNvbnN0IGJ1dHRvbkFsaWduR3JvdXAgPSBuZXcgQWxpZ25Hcm91cCgpO1xyXG4gICAgY29uc3QgYUJveCA9IGJ1dHRvbkFsaWduR3JvdXAuY3JlYXRlQm94KCBub2RlQSApO1xyXG4gICAgY29uc3QgYkJveCA9IGJ1dHRvbkFsaWduR3JvdXAuY3JlYXRlQm94KCBub2RlQiApO1xyXG5cclxuICAgIC8vIHVzZSBhIHBhdGggc28gdGhhdCB0aGUgbGluZSB3aWR0aCBjYW4gYmUgdXBkYXRlZFxyXG4gICAgY29uc3QgeE1hcmdpbiA9IG9wdGlvbnMuYnV0dG9uQ29udGVudFhNYXJnaW47XHJcbiAgICBjb25zdCB5TWFyZ2luID0gb3B0aW9ucy5idXR0b25Db250ZW50WU1hcmdpbjtcclxuICAgIGNvbnN0IGNvcm5lclJhZGl1cyA9IG9wdGlvbnMuY29ybmVyUmFkaXVzO1xyXG5cclxuICAgIGNvbnN0IGFCdXR0b24gPSBuZXcgTm9kZSgpO1xyXG4gICAgY29uc3QgYkJ1dHRvbiA9IG5ldyBOb2RlKCk7XHJcblxyXG4gICAgLy8gYUJveC5ib3VuZHMgPT09IGJCb3guYm91bmRzIHNpbmNlIHdlIGFyZSB1c2luZyBBbGlnbkdyb3VwXHJcbiAgICBjb25zdCByZWN0U2hhcGUgPSBTaGFwZS5yb3VuZFJlY3QoXHJcbiAgICAgIC14TWFyZ2luLFxyXG4gICAgICAteU1hcmdpbixcclxuICAgICAgYUJveC53aWR0aCArIDIgKiB4TWFyZ2luLFxyXG4gICAgICBhQm94LmhlaWdodCArIDIgKiB5TWFyZ2luLFxyXG4gICAgICBjb3JuZXJSYWRpdXMsXHJcbiAgICAgIGNvcm5lclJhZGl1c1xyXG4gICAgKTtcclxuICAgIGNvbnN0IGFCdXR0b25QYXRoID0gbmV3IFBhdGgoIHJlY3RTaGFwZSApO1xyXG4gICAgY29uc3QgYkJ1dHRvblBhdGggPSBuZXcgUGF0aCggcmVjdFNoYXBlICk7XHJcblxyXG4gICAgLy8gaWYgdGhlcmUgc2hvdWxkIGJlIGEgbWFzaywgYWRkIGJlZm9yZSB0aGUgYnV0dG9uc1xyXG4gICAgaWYgKCBvcHRpb25zLm1hc2tGaWxsICkge1xyXG4gICAgICBhQnV0dG9uLmFkZENoaWxkKCBuZXcgUGF0aCggcmVjdFNoYXBlLCB7IGZpbGw6IG9wdGlvbnMubWFza0ZpbGwgfSApICk7XHJcbiAgICAgIGJCdXR0b24uYWRkQ2hpbGQoIG5ldyBQYXRoKCByZWN0U2hhcGUsIHsgZmlsbDogb3B0aW9ucy5tYXNrRmlsbCB9ICkgKTtcclxuICAgIH1cclxuXHJcbiAgICBhQnV0dG9uLmFkZENoaWxkKCBhQnV0dG9uUGF0aCApO1xyXG4gICAgYkJ1dHRvbi5hZGRDaGlsZCggYkJ1dHRvblBhdGggKTtcclxuXHJcbiAgICAvLyBhZGQgdGhlIGljb25zXHJcbiAgICBhQnV0dG9uUGF0aC5hZGRDaGlsZCggYUJveCApO1xyXG4gICAgYkJ1dHRvblBhdGguYWRkQ2hpbGQoIGJCb3ggKTtcclxuXHJcbiAgICBjb25zdCBidXR0b25Cb3ggPSBuZXcgRmxvd0JveCgge1xyXG4gICAgICBzcGFjaW5nOiBvcHRpb25zLnNwYWNpbmcsXHJcbiAgICAgIG9yaWVudGF0aW9uOiBvcHRpb25zLm9yaWVudGF0aW9uLFxyXG4gICAgICBhbGlnbjogb3B0aW9ucy5hbGlnbixcclxuICAgICAgY2hpbGRyZW46IFsgYUJ1dHRvbiwgYkJ1dHRvbiBdLFxyXG4gICAgICByZXNpemU6IGZhbHNlXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBidXR0b25Cb3ggKTtcclxuXHJcbiAgICAvLyBzZXRzIHRoZSBzdHlsZXMgb2YgdGhlIGJ1dHRvbnMgYWZ0ZXIgYW4gaW50ZXJhY3Rpb24sIGluY2x1ZGluZyB0aGUgc3Ryb2tlLCBvcGFjaXR5LCBsaW5lV2lkdGgsIGFuZCBmaWxsLFxyXG4gICAgLy8gZGVwZW5kaW5nIG9uIHdoZXRoZXIgb3Igbm90IHRoZSBidXR0b24gaXMgZW5hYmxlZFxyXG4gICAgY29uc3Qgc2V0U3R5bGVzID0gZW5hYmxlZCA9PiB7XHJcblxyXG4gICAgICBsZXQgc2VsZWN0ZWRCdXR0b247XHJcbiAgICAgIGxldCBkZXNlbGVjdGVkQnV0dG9uO1xyXG4gICAgICBsZXQgc2VsZWN0ZWRDb250ZW50O1xyXG4gICAgICBsZXQgZGVzZWxlY3RlZENvbnRlbnQ7XHJcblxyXG4gICAgICBpZiAoIHByb3BlcnR5LmdldCgpID09PSB2YWx1ZUEgKSB7XHJcbiAgICAgICAgc2VsZWN0ZWRCdXR0b24gPSBhQnV0dG9uUGF0aDtcclxuICAgICAgICBkZXNlbGVjdGVkQnV0dG9uID0gYkJ1dHRvblBhdGg7XHJcbiAgICAgICAgc2VsZWN0ZWRDb250ZW50ID0gbm9kZUE7XHJcbiAgICAgICAgZGVzZWxlY3RlZENvbnRlbnQgPSBub2RlQjtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBzZWxlY3RlZEJ1dHRvbiA9IGJCdXR0b25QYXRoO1xyXG4gICAgICAgIGRlc2VsZWN0ZWRCdXR0b24gPSBhQnV0dG9uUGF0aDtcclxuICAgICAgICBzZWxlY3RlZENvbnRlbnQgPSBub2RlQjtcclxuICAgICAgICBkZXNlbGVjdGVkQ29udGVudCA9IG5vZGVBO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBzZWxlY3RlZEJ1dHRvbi5zdHJva2UgPSBvcHRpb25zLmJ1dHRvbkFwcGVhcmFuY2VTdHJhdGVneU9wdGlvbnMuc2VsZWN0ZWRTdHJva2U7XHJcbiAgICAgIGRlc2VsZWN0ZWRCdXR0b24uc3Ryb2tlID0gb3B0aW9ucy5idXR0b25BcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zLmRlc2VsZWN0ZWRTdHJva2U7XHJcblxyXG4gICAgICBzZWxlY3RlZEJ1dHRvbi5vcGFjaXR5ID0gb3B0aW9ucy5idXR0b25BcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zLnNlbGVjdGVkQnV0dG9uT3BhY2l0eTtcclxuICAgICAgZGVzZWxlY3RlZEJ1dHRvbi5vcGFjaXR5ID0gb3B0aW9ucy5idXR0b25BcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zLmRlc2VsZWN0ZWRCdXR0b25PcGFjaXR5O1xyXG5cclxuICAgICAgc2VsZWN0ZWRDb250ZW50Lm9wYWNpdHkgPSBvcHRpb25zLmNvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zLnNlbGVjdGVkQ29udGVudE9wYWNpdHk7XHJcbiAgICAgIGRlc2VsZWN0ZWRDb250ZW50Lm9wYWNpdHkgPSBvcHRpb25zLmNvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zLmRlc2VsZWN0ZWRDb250ZW50T3BhY2l0eTtcclxuXHJcbiAgICAgIHNlbGVjdGVkQnV0dG9uLmxpbmVXaWR0aCA9IG9wdGlvbnMuYnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5T3B0aW9ucy5zZWxlY3RlZExpbmVXaWR0aDtcclxuICAgICAgZGVzZWxlY3RlZEJ1dHRvbi5saW5lV2lkdGggPSBvcHRpb25zLmJ1dHRvbkFwcGVhcmFuY2VTdHJhdGVneU9wdGlvbnMuZGVzZWxlY3RlZExpbmVXaWR0aDtcclxuXHJcbiAgICAgIGlmICggIWVuYWJsZWQgKSB7XHJcbiAgICAgICAgdGhpcy5vcGFjaXR5ID0gb3B0aW9ucy5vcGFjaXR5V2hlbkRpc2FibGVkO1xyXG5cclxuICAgICAgICBzZWxlY3RlZEJ1dHRvbi5maWxsID0gb3B0aW9ucy5iYXNlQ29sb3I7XHJcbiAgICAgICAgZGVzZWxlY3RlZEJ1dHRvbi5maWxsID0gb3B0aW9ucy5iYXNlQ29sb3I7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgc2VsZWN0ZWRCdXR0b24uZmlsbCA9IG9wdGlvbnMuYmFzZUNvbG9yO1xyXG4gICAgICAgIGRlc2VsZWN0ZWRCdXR0b24uZmlsbCA9IG9wdGlvbnMuYmFzZUNvbG9yO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgcHJvcGVydHkubGluayggdmFsdWUgPT4ge1xyXG5cclxuICAgICAgLy8gdXBkYXRlIHRoZSBidXR0b24gbG9vayBhbmQgaXRzIGFjY2Vzc2libGUgcHJlc3NlZCBzdGF0ZVxyXG4gICAgICBzZXRTdHlsZXMoIHRoaXMuZW5hYmxlZFByb3BlcnR5LmdldCgpICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gc291bmQgcGxheWVyc1xyXG4gICAgY29uc3Qgc291bmRQbGF5ZXJGb3JPbmVCYWxsb29uID0gbXVsdGlTZWxlY3Rpb25Tb3VuZFBsYXllckZhY3RvcnkuZ2V0U2VsZWN0aW9uU291bmRQbGF5ZXIoIDQgKTtcclxuICAgIGNvbnN0IHNvdW5kUGxheWVyRm9yVHdvQmFsbG9vbnMgPSBtdWx0aVNlbGVjdGlvblNvdW5kUGxheWVyRmFjdG9yeS5nZXRTZWxlY3Rpb25Tb3VuZFBsYXllciggNSApO1xyXG5cclxuICAgIGNvbnN0IHVwRnVuY3Rpb24gPSAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG5ld1ZhbHVlID0gcHJvcGVydHkuZ2V0KCkgPT09IHZhbHVlQSA/IHZhbHVlQiA6IHZhbHVlQTtcclxuICAgICAgbmV3VmFsdWUgPyBzb3VuZFBsYXllckZvclR3b0JhbGxvb25zLnBsYXkoKSA6IHNvdW5kUGxheWVyRm9yT25lQmFsbG9vbi5wbGF5KCk7XHJcbiAgICAgIHByb3BlcnR5LnNldCggbmV3VmFsdWUgKTtcclxuICAgICAgc2V0U3R5bGVzKCB0aGlzLmVuYWJsZWRQcm9wZXJ0eS5nZXQoKSApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBJbnRlcm5hbCBlbWl0dGVyIGZvciB0aGUgUGhFVC1pTyBkYXRhIHN0cmVhbSwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzM5NlxyXG4gICAgY29uc3QgZmlyZWRFbWl0dGVyID0gbmV3IEVtaXR0ZXIoIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdmaXJlZEVtaXR0ZXInICksXHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdlbWl0cyB0byBjaGFuZ2UgdGhlIHNlbGVjdGlvbicsXHJcbiAgICAgIHBoZXRpb0V2ZW50VHlwZTogRXZlbnRUeXBlLlVTRVJcclxuICAgIH0gKTtcclxuICAgIGZpcmVkRW1pdHRlci5hZGRMaXN0ZW5lciggdXBGdW5jdGlvbiApO1xyXG5cclxuICAgIGNvbnN0IGRvd25VcExpc3RlbmVyID0gbmV3IERvd25VcExpc3RlbmVyKCB7XHJcbiAgICAgIHVwOiAoKSA9PiB7XHJcbiAgICAgICAgZmlyZWRFbWl0dGVyLmVtaXQoKTtcclxuICAgICAgfSxcclxuICAgICAgZG93bjogKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG90aGVyQnV0dG9uID0gcHJvcGVydHkuZ2V0KCkgPT09IHZhbHVlQSA/IGJCdXR0b25QYXRoIDogYUJ1dHRvblBhdGg7XHJcbiAgICAgICAgb3RoZXJCdXR0b24uZmlsbCA9IG9wdGlvbnMucHJlc3NlZENvbG9yO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gY29uc2lkZXJlZCBcImNoZWNrZWRcIiBmb3IgYWNjZXNzaWJpbGl0eSB3aGVuIG5vZGUgQiBpcyBzZWxlY3RlZFxyXG4gICAgY29uc3QgcHJvcGVydHlMaXN0ZW5lciA9IHZhbHVlID0+IHtcclxuICAgICAgdGhpcy5zZXRQRE9NQ2hlY2tlZCggdmFsdWUgPT09IHZhbHVlQiApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBsaXN0ZW5lciB0aGF0IGhpZ2hsaWdodHMgdGhlIHVuc2VsZWN0ZWQgYnV0dG9uIHdoZW4gbW91c2UgaXMgb3ZlclxyXG4gICAgY29uc3QgaGlnaGxpZ2h0TGlzdGVuZXIgPSBuZXcgUHJlc3NMaXN0ZW5lcigge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2hpZ2hsaWdodExpc3RlbmVyJyApXHJcbiAgICB9ICk7XHJcbiAgICBoaWdobGlnaHRMaXN0ZW5lci5pc0hpZ2hsaWdodGVkUHJvcGVydHkubGluayggaGlnaGxpZ2h0ZWQgPT4ge1xyXG4gICAgICBjb25zdCBvdGhlckJ1dHRvbiA9IHByb3BlcnR5LmdldCgpID09PSB2YWx1ZUEgPyBiQnV0dG9uUGF0aCA6IGFCdXR0b25QYXRoO1xyXG4gICAgICBjb25zdCBvdGhlckNvbnRlbnQgPSBwcm9wZXJ0eS5nZXQoKSA9PT0gdmFsdWVBID8gbm9kZUIgOiBub2RlQTtcclxuXHJcbiAgICAgIGNvbnN0IGJ1dHRvbk9wYWNpdHkgPSBoaWdobGlnaHRlZCA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmJ1dHRvbkFwcGVhcmFuY2VTdHJhdGVneU9wdGlvbnMub3ZlckJ1dHRvbk9wYWNpdHkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5idXR0b25BcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zLmRlc2VsZWN0ZWRCdXR0b25PcGFjaXR5O1xyXG4gICAgICBjb25zdCBjb250ZW50T3BhY2l0eSA9IGhpZ2hsaWdodGVkID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmNvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zLm92ZXJDb250ZW50T3BhY2l0eSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5jb250ZW50QXBwZWFyYW5jZVN0cmF0ZWd5T3B0aW9ucy5kZXNlbGVjdGVkQ29udGVudE9wYWNpdHk7XHJcblxyXG4gICAgICBvdGhlckJ1dHRvbi5vcGFjaXR5ID0gYnV0dG9uT3BhY2l0eTtcclxuICAgICAgb3RoZXJDb250ZW50Lm9wYWNpdHkgPSBjb250ZW50T3BhY2l0eTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBsaXN0ZW5lciB0aGF0IGlzIGNhbGxlZCB3aGVuIHRoZSBidXR0b24gaXMgcHJlc3NlZCB3aXRoICdlbnRlcicgb3IgJ3NwYWNlYmFyJ1xyXG4gICAgY29uc3QgY2xpY2tMaXN0ZW5lciA9IHsgY2xpY2s6IHVwRnVuY3Rpb24gfTtcclxuXHJcbiAgICAvLyBhZGQgbGlzdGVuZXJzXHJcbiAgICB0aGlzLmFkZElucHV0TGlzdGVuZXIoIGRvd25VcExpc3RlbmVyICk7XHJcbiAgICB0aGlzLmFkZElucHV0TGlzdGVuZXIoIGhpZ2hsaWdodExpc3RlbmVyICk7XHJcbiAgICB0aGlzLmVuYWJsZWRQcm9wZXJ0eS5saW5rKCBzZXRTdHlsZXMgKTtcclxuICAgIHByb3BlcnR5LmxpbmsoIHByb3BlcnR5TGlzdGVuZXIgKTtcclxuICAgIHRoaXMuYWRkSW5wdXRMaXN0ZW5lciggY2xpY2tMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIHNldCBtb3VzZSBhbmQgdG91Y2ggYXJlYXNcclxuICAgIHRoaXMubW91c2VBcmVhID0gdGhpcy5ib3VuZHMuZGlsYXRlZFhZKCBvcHRpb25zLm1vdXNlQXJlYVhEaWxhdGlvbiwgb3B0aW9ucy5tb3VzZUFyZWFZRGlsYXRpb24gKTtcclxuICAgIHRoaXMudG91Y2hBcmVhID0gdGhpcy5ib3VuZHMuZGlsYXRlZFhZKCBvcHRpb25zLnRvdWNoQXJlYVhEaWxhdGlvbiwgb3B0aW9ucy50b3VjaEFyZWFZRGlsYXRpb24gKTtcclxuICB9XHJcbn1cclxuXHJcbmJhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHkucmVnaXN0ZXIoICdUd29TY2VuZVNlbGVjdGlvbk5vZGUnLCBUd29TY2VuZVNlbGVjdGlvbk5vZGUgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFR3b1NjZW5lU2VsZWN0aW9uTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLE9BQU8sTUFBTSxnQ0FBZ0M7QUFDcEQsU0FBU0MsS0FBSyxRQUFRLGdDQUFnQztBQUN0RCxPQUFPQyxLQUFLLE1BQU0sbUNBQW1DO0FBQ3JELFNBQVNDLFVBQVUsRUFBRUMsS0FBSyxFQUFFQyxjQUFjLEVBQUVDLE9BQU8sRUFBRUMsdUJBQXVCLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxhQUFhLEVBQUVDLGdCQUFnQixRQUFRLG1DQUFtQztBQUNwSyxPQUFPQyxnQ0FBZ0MsTUFBTSwwREFBMEQ7QUFDdkcsT0FBT0MsU0FBUyxNQUFNLG9DQUFvQztBQUMxRCxPQUFPQyxNQUFNLE1BQU0saUNBQWlDO0FBQ3BELE9BQU9DLDRCQUE0QixNQUFNLHVDQUF1Qzs7QUFFaEY7QUFDQSxNQUFNQyxZQUFZLEdBQUcsSUFBSVosS0FBSyxDQUFFLE9BQVEsQ0FBQztBQUV6QyxNQUFNYSxxQkFBcUIsU0FBU1YsdUJBQXVCLENBQUVDLElBQUssQ0FBQyxDQUFDO0VBRWxFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRVUsV0FBV0EsQ0FBRUMsUUFBUSxFQUFFQyxNQUFNLEVBQUVDLE1BQU0sRUFBRUMsS0FBSyxFQUFFQyxLQUFLLEVBQUVDLE9BQU8sRUFBRztJQUU3REEsT0FBTyxHQUFHdEIsS0FBSyxDQUFFO01BRWY7TUFDQXVCLE9BQU8sRUFBRSxFQUFFO01BQ1hDLFdBQVcsRUFBRSxZQUFZO01BQ3pCQyxLQUFLLEVBQUUsUUFBUTtN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