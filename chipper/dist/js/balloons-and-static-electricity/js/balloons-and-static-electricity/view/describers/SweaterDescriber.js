// Copyright 2017-2021, University of Colorado Boulder

/**
 * A view type that presents the accessibility descriptions for the Sweater.
 *
 * @author Jesse Greenberg
 */

import StringUtils from '../../../../../phetcommon/js/util/StringUtils.js';
import balloonsAndStaticElectricity from '../../../balloonsAndStaticElectricity.js';
import BASEA11yStrings from '../../BASEA11yStrings.js';
import BASEConstants from '../../BASEConstants.js';
import BalloonDirectionEnum from '../../model/BalloonDirectionEnum.js';
import BalloonModel from '../../model/BalloonModel.js';
import BASEDescriber from './BASEDescriber.js';

// strings
const sweaterPositionString = BASEA11yStrings.sweaterPosition.value;
const zeroString = BASEA11yStrings.zero.value;
const manyString = BASEA11yStrings.many.value;
const allString = BASEA11yStrings.all.value;
const positiveString = BASEA11yStrings.positive.value;
const sweaterDescriptionPatternString = BASEA11yStrings.sweaterDescriptionPattern.value;
const sweaterRelativeChargeAllPatternString = BASEA11yStrings.sweaterRelativeChargeAllPattern.value;
const sweaterRelativeChargeDifferencesPatternString = BASEA11yStrings.sweaterRelativeChargeDifferencesPattern.value;
const sweaterNoMoreChargesString = BASEA11yStrings.sweaterNoMoreCharges.value;
const sweaterNetChargePatternString = BASEA11yStrings.sweaterNetChargePattern.value;
const sweaterChargePatternString = BASEA11yStrings.sweaterChargePattern.value;
const showingNoChargesString = BASEA11yStrings.showingNoCharges.value;
const sweaterHasRelativeChargePatternString = BASEA11yStrings.sweaterHasRelativeChargePattern.value;
const sweaterHasNetChargeShowingPatternString = BASEA11yStrings.sweaterHasNetChargeShowingPattern.value;
const moreChargesPatternString = BASEA11yStrings.moreChargesPattern.value;
const moreChargesFurtherPatternString = BASEA11yStrings.moreChargesFurtherPattern.value;
const morePairsOfChargesString = BASEA11yStrings.morePairsOfCharges.value;
const sweaterLabelString = BASEA11yStrings.sweaterLabel.value;
const moreHiddenPairsOfChargesString = BASEA11yStrings.moreHiddenPairsOfCharges.value;
const positiveNetChargeString = BASEA11yStrings.positiveNetCharge.value;
const neutralNetChargeString = BASEA11yStrings.neutralNetCharge.value;
const summaryObjectHasChargePatternString = BASEA11yStrings.summaryObjectHasChargePattern.value;
const sweaterRelativeChargePatternString = BASEA11yStrings.sweaterRelativeChargePattern.value;
const summaryObjectChargePatternString = BASEA11yStrings.summaryObjectChargePattern.value;
const summaryNeutralChargesPatternString = BASEA11yStrings.summaryNeutralChargesPattern.value;
const sweaterShowingPatternString = BASEA11yStrings.sweaterShowingPattern.value;
const showingAllPositiveChargesString = BASEA11yStrings.showingAllPositiveCharges.value;
const singleStatementPatternString = BASEA11yStrings.singleStatementPattern.value;
class SweaterDescriber {
  /**
   * Manages all descriptions relating to the sweater.
   *
   * @param {BASEModel} model
   * @param {Sweater} sweaterModel
   */
  constructor(model, sweaterModel) {
    this.model = model;
    this.sweaterModel = sweaterModel;
  }

  /**
   * Get the descrition of the sweater, which includes its position in the play area, its net charge, and its
   * relative proportion of positive and negative charges.  Will be dependent on what charges are visible.
   * "At left edge of Play Area. Has positive net charge, a few more positive charges than negative charges." or
   * "At left edge of Play Area. Has positive net charge, showing all positive charges." or
   * "At left edge of Play Area. Has positive net charge, no more negative charges, only positive charges." or
   * "At left edge of Play Area. Has positive net charge, several more positive charges than negative charges."
   * @public
   *
   * @param {Property.<string>} showCharges
   * @returns {string}
   */
  getSweaterDescription(showCharges) {
    // if we are not showing any charges, just return a description for the position
    if (showCharges === 'none') {
      return sweaterPositionString;
    }

    // relative charge like "no" or "several"
    const sweaterCharge = this.sweaterModel.chargeProperty.get();
    const relativeChargeString = BASEDescriber.getRelativeChargeDescription(sweaterCharge);

    // assemble net charge string, like "Has zero net charge"
    const netChargeString = StringUtils.fillIn(sweaterNetChargePatternString, {
      netCharge: sweaterCharge > 0 ? positiveString : zeroString
    });
    let chargeString;
    if (showCharges === 'all') {
      // special case - if sweater is totally out of charges, say "no more negative charges, only positive charges""
      if (sweaterCharge === BASEConstants.MAX_BALLOON_CHARGE) {
        chargeString = sweaterNoMoreChargesString;
      } else {
        chargeString = StringUtils.fillIn(sweaterRelativeChargeAllPatternString, {
          charge: relativeChargeString
        });
      }
    } else {
      if (sweaterCharge === 0) {
        // special case - if sweater has neutral charge, just say "showing no charges"
        chargeString = showingNoChargesString;
      } else if (sweaterCharge === BASEConstants.MAX_BALLOON_CHARGE) {
        // special case - if sweater is out of  charges, say "showing all positive charges"
        chargeString = showingAllPositiveChargesString;
      } else {
        chargeString = StringUtils.fillIn(sweaterRelativeChargeDifferencesPatternString, {
          charge: relativeChargeString
        });
      }
    }

    // description for charge
    chargeString = StringUtils.fillIn(sweaterChargePatternString, {
      netCharge: netChargeString,
      relativeCharge: chargeString
    });

    // full description,  without punctuation
    const description = StringUtils.fillIn(sweaterDescriptionPatternString, {
      position: sweaterPositionString,
      charge: chargeString
    });
    return StringUtils.fillIn(singleStatementPatternString, {
      statement: description
    });
  }

  /**
   * Get a description of the relative charge of the sweater, including the label. Dependent on
   * what charges are visible in the view. This will form a full sentence. Will produce something like
   *
   * "Sweater has several more positive charges than negative charges." or
   * "Sweater has positive net charge, showing several positive charges." or
   * "Sweater has no more negative charges, only positive charges."
   * @public
   *
   * @param  {number} charge
   * @param  {string} shownCharges
   * @returns {string}
   */
  static getRelativeChargeDescriptionWithLabel(charge, shownCharges) {
    let description;

    // the relative charge on the sweater, something like 'several' or 'many'
    const absCharge = Math.abs(charge);
    const relative = SweaterDescriber.getRelativeChargeDescription(absCharge);
    if (shownCharges === 'all') {
      if (absCharge === BASEConstants.MAX_BALLOON_CHARGE) {
        // if no more charges remaining on sweater, special description like "no more negative charges, only positive"
        description = StringUtils.fillIn(sweaterHasRelativeChargePatternString, {
          relativeCharge: sweaterNoMoreChargesString
        });
      } else {
        // else something like "Sweater has several more positive charges than negative charges"
        const relativeChargeString = StringUtils.fillIn(sweaterRelativeChargeAllPatternString, {
          charge: relative
        });
        description = StringUtils.fillIn(sweaterHasRelativeChargePatternString, {
          relativeCharge: relativeChargeString
        });
      }
    } else if (shownCharges === 'diff') {
      const showingString = StringUtils.fillIn(sweaterRelativeChargeDifferencesPatternString, {
        charge: relative
      });
      description = StringUtils.fillIn(sweaterHasNetChargeShowingPatternString, {
        showing: showingString
      });
    }
    return description;
  }

  /**
   * Get the relative charge on the sweater.  Usually just returns the relative description
   * from BASEDescriber, but if all charges are gone, the sweater uses a special
   * word to indicate this.
   * @public
   *
   * @param {number} charge
   * @returns {string}
   */
  static getRelativeChargeDescription(charge) {
    if (charge === BASEConstants.MAX_BALLOON_CHARGE) {
      return allString;
    } else {
      return BASEDescriber.getRelativeChargeDescription(charge);
    }
  }

  /**
   * Get an alert describing the sweater when it runs out of charges.  Dependent on the
   * charge visibility.
   * @public
   *
   * @param  {string} shownCharges
   * @returns {string}
   */
  static getNoMoreChargesAlert(charge, shownCharges) {
    let alert;
    if (shownCharges === 'all') {
      alert = StringUtils.fillIn(sweaterHasRelativeChargePatternString, {
        relativeCharge: sweaterNoMoreChargesString
      });
    } else if (shownCharges === 'diff') {
      alert = SweaterDescriber.getRelativeChargeDescriptionWithLabel(charge, shownCharges);
    }
    return alert;
  }

  /**
   * Get a description of the net charge of the sweater, will return either
   * "Sweater has positive net charge." or
   * "Sweater has neutral net charge."
   * @public
   *
   * @param {number} sweaterCharge
   * @returns {string}
   */
  static getNetChargeDescription(sweaterCharge) {
    const relativeChargeString = sweaterCharge === 0 ? neutralNetChargeString : positiveNetChargeString;
    return StringUtils.fillIn(sweaterHasRelativeChargePatternString, {
      relativeCharge: relativeChargeString
    });
  }

  /**
   * Get a description that includes information about where additional charges are on the sweater. This is
   * dependent on charge visibility setting. Will return something like
   * "More pairs of charges up and to the left". or
   * "More pairs of hidden charges down".
   * @public
   *
   * @param {BalloonModel} balloon
   * @param {string} shownCharges
   * @returns {string}
   */
  static getMoreChargesDescription(balloon, sweaterCharge, sweaterCharges, shownCharges) {
    assert && assert(sweaterCharge < BASEConstants.MAX_BALLOON_CHARGE, 'no more charges on sweater');
    assert && assert(shownCharges !== 'none', 'this description should not be used when no charges are shown');

    // get the next charge to describe
    let charge;
    for (let i = 0; i < sweaterCharges.length; i++) {
      charge = sweaterCharges[i];
      if (!charge.movedProperty.get()) {
        break;
      }
    }

    // get the description of the direction to the closest charge
    const direction = BalloonModel.getDirection(charge.position, balloon.getCenter());
    const directionDescription = BASEDescriber.getDirectionDescription(direction);
    const patternString = BalloonDirectionEnum.isRelativeDirection(direction) ? moreChargesFurtherPatternString : moreChargesPatternString;
    let moreChargesString;
    if (shownCharges === 'all') {
      moreChargesString = morePairsOfChargesString;
    } else if (shownCharges === 'diff') {
      moreChargesString = moreHiddenPairsOfChargesString;
    }
    return StringUtils.fillIn(patternString, {
      moreCharges: moreChargesString,
      direction: directionDescription
    });
  }

  /**
   * Get a description of the sweater's charge for the screen summary. Will return something like
   * "Sweater has positive net charge, a few more positive charges than negative charges."
   * "Sweater has positive net charge, showing a few positive charges."
   * "Sweater has zero net charge, many pairs of positive and negative charges."
   * "Sweater has zero net charge, showing no charges."
   * @public
   *
   * @returns {string}
   */
  static getSummaryChargeDescription(chargesShown, charge) {
    // description of the sweater object, like "Sweater has zero net charge"
    const chargeSignString = charge > 0 ? positiveString : zeroString;
    const sweaterObjectString = StringUtils.fillIn(summaryObjectHasChargePatternString, {
      object: sweaterLabelString,
      charge: chargeSignString
    });

    // description of the charges shown, like 'a few more positive charges than negative charges'
    let chargeString;
    const relativeChargeString = BASEDescriber.getRelativeChargeDescription(charge);
    if (chargesShown === 'all') {
      chargeString = charge === 0 ? StringUtils.fillIn(summaryNeutralChargesPatternString, {
        amount: manyString
      }) : StringUtils.fillIn(sweaterRelativeChargePatternString, {
        charge: relativeChargeString
      });
    } else if (chargesShown === 'diff') {
      chargeString = charge === 0 ? showingNoChargesString : chargeString = StringUtils.fillIn(sweaterShowingPatternString, {
        charge: relativeChargeString
      });
    }
    return StringUtils.fillIn(summaryObjectChargePatternString, {
      object: sweaterObjectString,
      charge: chargeString
    });
  }
}
balloonsAndStaticElectricity.register('SweaterDescriber', SweaterDescriber);
export default SweaterDescriber;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTdHJpbmdVdGlscyIsImJhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHkiLCJCQVNFQTExeVN0cmluZ3MiLCJCQVNFQ29uc3RhbnRzIiwiQmFsbG9vbkRpcmVjdGlvbkVudW0iLCJCYWxsb29uTW9kZWwiLCJCQVNFRGVzY3JpYmVyIiwic3dlYXRlclBvc2l0aW9uU3RyaW5nIiwic3dlYXRlclBvc2l0aW9uIiwidmFsdWUiLCJ6ZXJvU3RyaW5nIiwiemVybyIsIm1hbnlTdHJpbmciLCJtYW55IiwiYWxsU3RyaW5nIiwiYWxsIiwicG9zaXRpdmVTdHJpbmciLCJwb3NpdGl2ZSIsInN3ZWF0ZXJEZXNjcmlwdGlvblBhdHRlcm5TdHJpbmciLCJzd2VhdGVyRGVzY3JpcHRpb25QYXR0ZXJuIiwic3dlYXRlclJlbGF0aXZlQ2hhcmdlQWxsUGF0dGVyblN0cmluZyIsInN3ZWF0ZXJSZWxhdGl2ZUNoYXJnZUFsbFBhdHRlcm4iLCJzd2VhdGVyUmVsYXRpdmVDaGFyZ2VEaWZmZXJlbmNlc1BhdHRlcm5TdHJpbmciLCJzd2VhdGVyUmVsYXRpdmVDaGFyZ2VEaWZmZXJlbmNlc1BhdHRlcm4iLCJzd2VhdGVyTm9Nb3JlQ2hhcmdlc1N0cmluZyIsInN3ZWF0ZXJOb01vcmVDaGFyZ2VzIiwic3dlYXRlck5ldENoYXJnZVBhdHRlcm5TdHJpbmciLCJzd2VhdGVyTmV0Q2hhcmdlUGF0dGVybiIsInN3ZWF0ZXJDaGFyZ2VQYXR0ZXJuU3RyaW5nIiwic3dlYXRlckNoYXJnZVBhdHRlcm4iLCJzaG93aW5nTm9DaGFyZ2VzU3RyaW5nIiwic2hvd2luZ05vQ2hhcmdlcyIsInN3ZWF0ZXJIYXNSZWxhdGl2ZUNoYXJnZVBhdHRlcm5TdHJpbmciLCJzd2VhdGVySGFzUmVsYXRpdmVDaGFyZ2VQYXR0ZXJuIiwic3dlYXRlckhhc05ldENoYXJnZVNob3dpbmdQYXR0ZXJuU3RyaW5nIiwic3dlYXRlckhhc05ldENoYXJnZVNob3dpbmdQYXR0ZXJuIiwibW9yZUNoYXJnZXNQYXR0ZXJuU3RyaW5nIiwibW9yZUNoYXJnZXNQYXR0ZXJuIiwibW9yZUNoYXJnZXNGdXJ0aGVyUGF0dGVyblN0cmluZyIsIm1vcmVDaGFyZ2VzRnVydGhlclBhdHRlcm4iLCJtb3JlUGFpcnNPZkNoYXJnZXNTdHJpbmciLCJtb3JlUGFpcnNPZkNoYXJnZXMiLCJzd2VhdGVyTGFiZWxTdHJpbmciLCJzd2VhdGVyTGFiZWwiLCJtb3JlSGlkZGVuUGFpcnNPZkNoYXJnZXNTdHJpbmciLCJtb3JlSGlkZGVuUGFpcnNPZkNoYXJnZXMiLCJwb3NpdGl2ZU5ldENoYXJnZVN0cmluZyIsInBvc2l0aXZlTmV0Q2hhcmdlIiwibmV1dHJhbE5ldENoYXJnZVN0cmluZyIsIm5ldXRyYWxOZXRDaGFyZ2UiLCJzdW1tYXJ5T2JqZWN0SGFzQ2hhcmdlUGF0dGVyblN0cmluZyIsInN1bW1hcnlPYmplY3RIYXNDaGFyZ2VQYXR0ZXJuIiwic3dlYXRlclJlbGF0aXZlQ2hhcmdlUGF0dGVyblN0cmluZyIsInN3ZWF0ZXJSZWxhdGl2ZUNoYXJnZVBhdHRlcm4iLCJzdW1tYXJ5T2JqZWN0Q2hhcmdlUGF0dGVyblN0cmluZyIsInN1bW1hcnlPYmplY3RDaGFyZ2VQYXR0ZXJuIiwic3VtbWFyeU5ldXRyYWxDaGFyZ2VzUGF0dGVyblN0cmluZyIsInN1bW1hcnlOZXV0cmFsQ2hhcmdlc1BhdHRlcm4iLCJzd2VhdGVyU2hvd2luZ1BhdHRlcm5TdHJpbmciLCJzd2VhdGVyU2hvd2luZ1BhdHRlcm4iLCJzaG93aW5nQWxsUG9zaXRpdmVDaGFyZ2VzU3RyaW5nIiwic2hvd2luZ0FsbFBvc2l0aXZlQ2hhcmdlcyIsInNpbmdsZVN0YXRlbWVudFBhdHRlcm5TdHJpbmciLCJzaW5nbGVTdGF0ZW1lbnRQYXR0ZXJuIiwiU3dlYXRlckRlc2NyaWJlciIsImNvbnN0cnVjdG9yIiwibW9kZWwiLCJzd2VhdGVyTW9kZWwiLCJnZXRTd2VhdGVyRGVzY3JpcHRpb24iLCJzaG93Q2hhcmdlcyIsInN3ZWF0ZXJDaGFyZ2UiLCJjaGFyZ2VQcm9wZXJ0eSIsImdldCIsInJlbGF0aXZlQ2hhcmdlU3RyaW5nIiwiZ2V0UmVsYXRpdmVDaGFyZ2VEZXNjcmlwdGlvbiIsIm5ldENoYXJnZVN0cmluZyIsImZpbGxJbiIsIm5ldENoYXJnZSIsImNoYXJnZVN0cmluZyIsIk1BWF9CQUxMT09OX0NIQVJHRSIsImNoYXJnZSIsInJlbGF0aXZlQ2hhcmdlIiwiZGVzY3JpcHRpb24iLCJwb3NpdGlvbiIsInN0YXRlbWVudCIsImdldFJlbGF0aXZlQ2hhcmdlRGVzY3JpcHRpb25XaXRoTGFiZWwiLCJzaG93bkNoYXJnZXMiLCJhYnNDaGFyZ2UiLCJNYXRoIiwiYWJzIiwicmVsYXRpdmUiLCJzaG93aW5nU3RyaW5nIiwic2hvd2luZyIsImdldE5vTW9yZUNoYXJnZXNBbGVydCIsImFsZXJ0IiwiZ2V0TmV0Q2hhcmdlRGVzY3JpcHRpb24iLCJnZXRNb3JlQ2hhcmdlc0Rlc2NyaXB0aW9uIiwiYmFsbG9vbiIsInN3ZWF0ZXJDaGFyZ2VzIiwiYXNzZXJ0IiwiaSIsImxlbmd0aCIsIm1vdmVkUHJvcGVydHkiLCJkaXJlY3Rpb24iLCJnZXREaXJlY3Rpb24iLCJnZXRDZW50ZXIiLCJkaXJlY3Rpb25EZXNjcmlwdGlvbiIsImdldERpcmVjdGlvbkRlc2NyaXB0aW9uIiwicGF0dGVyblN0cmluZyIsImlzUmVsYXRpdmVEaXJlY3Rpb24iLCJtb3JlQ2hhcmdlc1N0cmluZyIsIm1vcmVDaGFyZ2VzIiwiZ2V0U3VtbWFyeUNoYXJnZURlc2NyaXB0aW9uIiwiY2hhcmdlc1Nob3duIiwiY2hhcmdlU2lnblN0cmluZyIsInN3ZWF0ZXJPYmplY3RTdHJpbmciLCJvYmplY3QiLCJhbW91bnQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlN3ZWF0ZXJEZXNjcmliZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTctMjAyMSwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQSB2aWV3IHR5cGUgdGhhdCBwcmVzZW50cyB0aGUgYWNjZXNzaWJpbGl0eSBkZXNjcmlwdGlvbnMgZm9yIHRoZSBTd2VhdGVyLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZ1xyXG4gKi9cclxuXHJcbmltcG9ydCBTdHJpbmdVdGlscyBmcm9tICcuLi8uLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3V0aWwvU3RyaW5nVXRpbHMuanMnO1xyXG5pbXBvcnQgYmFsbG9vbnNBbmRTdGF0aWNFbGVjdHJpY2l0eSBmcm9tICcuLi8uLi8uLi9iYWxsb29uc0FuZFN0YXRpY0VsZWN0cmljaXR5LmpzJztcclxuaW1wb3J0IEJBU0VBMTF5U3RyaW5ncyBmcm9tICcuLi8uLi9CQVNFQTExeVN0cmluZ3MuanMnO1xyXG5pbXBvcnQgQkFTRUNvbnN0YW50cyBmcm9tICcuLi8uLi9CQVNFQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IEJhbGxvb25EaXJlY3Rpb25FbnVtIGZyb20gJy4uLy4uL21vZGVsL0JhbGxvb25EaXJlY3Rpb25FbnVtLmpzJztcclxuaW1wb3J0IEJhbGxvb25Nb2RlbCBmcm9tICcuLi8uLi9tb2RlbC9CYWxsb29uTW9kZWwuanMnO1xyXG5pbXBvcnQgQkFTRURlc2NyaWJlciBmcm9tICcuL0JBU0VEZXNjcmliZXIuanMnO1xyXG5cclxuLy8gc3RyaW5nc1xyXG5jb25zdCBzd2VhdGVyUG9zaXRpb25TdHJpbmcgPSBCQVNFQTExeVN0cmluZ3Muc3dlYXRlclBvc2l0aW9uLnZhbHVlO1xyXG5jb25zdCB6ZXJvU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnplcm8udmFsdWU7XHJcbmNvbnN0IG1hbnlTdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MubWFueS52YWx1ZTtcclxuY29uc3QgYWxsU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLmFsbC52YWx1ZTtcclxuY29uc3QgcG9zaXRpdmVTdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MucG9zaXRpdmUudmFsdWU7XHJcbmNvbnN0IHN3ZWF0ZXJEZXNjcmlwdGlvblBhdHRlcm5TdHJpbmcgPSBCQVNFQTExeVN0cmluZ3Muc3dlYXRlckRlc2NyaXB0aW9uUGF0dGVybi52YWx1ZTtcclxuY29uc3Qgc3dlYXRlclJlbGF0aXZlQ2hhcmdlQWxsUGF0dGVyblN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5zd2VhdGVyUmVsYXRpdmVDaGFyZ2VBbGxQYXR0ZXJuLnZhbHVlO1xyXG5jb25zdCBzd2VhdGVyUmVsYXRpdmVDaGFyZ2VEaWZmZXJlbmNlc1BhdHRlcm5TdHJpbmcgPSBCQVNFQTExeVN0cmluZ3Muc3dlYXRlclJlbGF0aXZlQ2hhcmdlRGlmZmVyZW5jZXNQYXR0ZXJuLnZhbHVlO1xyXG5jb25zdCBzd2VhdGVyTm9Nb3JlQ2hhcmdlc1N0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5zd2VhdGVyTm9Nb3JlQ2hhcmdlcy52YWx1ZTtcclxuY29uc3Qgc3dlYXRlck5ldENoYXJnZVBhdHRlcm5TdHJpbmcgPSBCQVNFQTExeVN0cmluZ3Muc3dlYXRlck5ldENoYXJnZVBhdHRlcm4udmFsdWU7XHJcbmNvbnN0IHN3ZWF0ZXJDaGFyZ2VQYXR0ZXJuU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnN3ZWF0ZXJDaGFyZ2VQYXR0ZXJuLnZhbHVlO1xyXG5jb25zdCBzaG93aW5nTm9DaGFyZ2VzU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnNob3dpbmdOb0NoYXJnZXMudmFsdWU7XHJcbmNvbnN0IHN3ZWF0ZXJIYXNSZWxhdGl2ZUNoYXJnZVBhdHRlcm5TdHJpbmcgPSBCQVNFQTExeVN0cmluZ3Muc3dlYXRlckhhc1JlbGF0aXZlQ2hhcmdlUGF0dGVybi52YWx1ZTtcclxuY29uc3Qgc3dlYXRlckhhc05ldENoYXJnZVNob3dpbmdQYXR0ZXJuU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnN3ZWF0ZXJIYXNOZXRDaGFyZ2VTaG93aW5nUGF0dGVybi52YWx1ZTtcclxuY29uc3QgbW9yZUNoYXJnZXNQYXR0ZXJuU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLm1vcmVDaGFyZ2VzUGF0dGVybi52YWx1ZTtcclxuY29uc3QgbW9yZUNoYXJnZXNGdXJ0aGVyUGF0dGVyblN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5tb3JlQ2hhcmdlc0Z1cnRoZXJQYXR0ZXJuLnZhbHVlO1xyXG5jb25zdCBtb3JlUGFpcnNPZkNoYXJnZXNTdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MubW9yZVBhaXJzT2ZDaGFyZ2VzLnZhbHVlO1xyXG5jb25zdCBzd2VhdGVyTGFiZWxTdHJpbmcgPSBCQVNFQTExeVN0cmluZ3Muc3dlYXRlckxhYmVsLnZhbHVlO1xyXG5jb25zdCBtb3JlSGlkZGVuUGFpcnNPZkNoYXJnZXNTdHJpbmcgPSBCQVNFQTExeVN0cmluZ3MubW9yZUhpZGRlblBhaXJzT2ZDaGFyZ2VzLnZhbHVlO1xyXG5jb25zdCBwb3NpdGl2ZU5ldENoYXJnZVN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5wb3NpdGl2ZU5ldENoYXJnZS52YWx1ZTtcclxuY29uc3QgbmV1dHJhbE5ldENoYXJnZVN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5uZXV0cmFsTmV0Q2hhcmdlLnZhbHVlO1xyXG5jb25zdCBzdW1tYXJ5T2JqZWN0SGFzQ2hhcmdlUGF0dGVyblN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5zdW1tYXJ5T2JqZWN0SGFzQ2hhcmdlUGF0dGVybi52YWx1ZTtcclxuY29uc3Qgc3dlYXRlclJlbGF0aXZlQ2hhcmdlUGF0dGVyblN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5zd2VhdGVyUmVsYXRpdmVDaGFyZ2VQYXR0ZXJuLnZhbHVlO1xyXG5jb25zdCBzdW1tYXJ5T2JqZWN0Q2hhcmdlUGF0dGVyblN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5zdW1tYXJ5T2JqZWN0Q2hhcmdlUGF0dGVybi52YWx1ZTtcclxuY29uc3Qgc3VtbWFyeU5ldXRyYWxDaGFyZ2VzUGF0dGVyblN0cmluZyA9IEJBU0VBMTF5U3RyaW5ncy5zdW1tYXJ5TmV1dHJhbENoYXJnZXNQYXR0ZXJuLnZhbHVlO1xyXG5jb25zdCBzd2VhdGVyU2hvd2luZ1BhdHRlcm5TdHJpbmcgPSBCQVNFQTExeVN0cmluZ3Muc3dlYXRlclNob3dpbmdQYXR0ZXJuLnZhbHVlO1xyXG5jb25zdCBzaG93aW5nQWxsUG9zaXRpdmVDaGFyZ2VzU3RyaW5nID0gQkFTRUExMXlTdHJpbmdzLnNob3dpbmdBbGxQb3NpdGl2ZUNoYXJnZXMudmFsdWU7XHJcbmNvbnN0IHNpbmdsZVN0YXRlbWVudFBhdHRlcm5TdHJpbmcgPSBCQVNFQTExeVN0cmluZ3Muc2luZ2xlU3RhdGVtZW50UGF0dGVybi52YWx1ZTtcclxuXHJcbmNsYXNzIFN3ZWF0ZXJEZXNjcmliZXIge1xyXG4gIC8qKlxyXG4gICAqIE1hbmFnZXMgYWxsIGRlc2NyaXB0aW9ucyByZWxhdGluZyB0byB0aGUgc3dlYXRlci5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7QkFTRU1vZGVsfSBtb2RlbFxyXG4gICAqIEBwYXJhbSB7U3dlYXRlcn0gc3dlYXRlck1vZGVsXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG1vZGVsLCBzd2VhdGVyTW9kZWwgKSB7XHJcbiAgICB0aGlzLm1vZGVsID0gbW9kZWw7XHJcbiAgICB0aGlzLnN3ZWF0ZXJNb2RlbCA9IHN3ZWF0ZXJNb2RlbDtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIGRlc2NyaXRpb24gb2YgdGhlIHN3ZWF0ZXIsIHdoaWNoIGluY2x1ZGVzIGl0cyBwb3NpdGlvbiBpbiB0aGUgcGxheSBhcmVhLCBpdHMgbmV0IGNoYXJnZSwgYW5kIGl0c1xyXG4gICAqIHJlbGF0aXZlIHByb3BvcnRpb24gb2YgcG9zaXRpdmUgYW5kIG5lZ2F0aXZlIGNoYXJnZXMuICBXaWxsIGJlIGRlcGVuZGVudCBvbiB3aGF0IGNoYXJnZXMgYXJlIHZpc2libGUuXHJcbiAgICogXCJBdCBsZWZ0IGVkZ2Ugb2YgUGxheSBBcmVhLiBIYXMgcG9zaXRpdmUgbmV0IGNoYXJnZSwgYSBmZXcgbW9yZSBwb3NpdGl2ZSBjaGFyZ2VzIHRoYW4gbmVnYXRpdmUgY2hhcmdlcy5cIiBvclxyXG4gICAqIFwiQXQgbGVmdCBlZGdlIG9mIFBsYXkgQXJlYS4gSGFzIHBvc2l0aXZlIG5ldCBjaGFyZ2UsIHNob3dpbmcgYWxsIHBvc2l0aXZlIGNoYXJnZXMuXCIgb3JcclxuICAgKiBcIkF0IGxlZnQgZWRnZSBvZiBQbGF5IEFyZWEuIEhhcyBwb3NpdGl2ZSBuZXQgY2hhcmdlLCBubyBtb3JlIG5lZ2F0aXZlIGNoYXJnZXMsIG9ubHkgcG9zaXRpdmUgY2hhcmdlcy5cIiBvclxyXG4gICAqIFwiQXQgbGVmdCBlZGdlIG9mIFBsYXkgQXJlYS4gSGFzIHBvc2l0aXZlIG5ldCBjaGFyZ2UsIHNldmVyYWwgbW9yZSBwb3NpdGl2ZSBjaGFyZ2VzIHRoYW4gbmVnYXRpdmUgY2hhcmdlcy5cIlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPHN0cmluZz59IHNob3dDaGFyZ2VzXHJcbiAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgKi9cclxuICBnZXRTd2VhdGVyRGVzY3JpcHRpb24oIHNob3dDaGFyZ2VzICkge1xyXG5cclxuICAgIC8vIGlmIHdlIGFyZSBub3Qgc2hvd2luZyBhbnkgY2hhcmdlcywganVzdCByZXR1cm4gYSBkZXNjcmlwdGlvbiBmb3IgdGhlIHBvc2l0aW9uXHJcbiAgICBpZiAoIHNob3dDaGFyZ2VzID09PSAnbm9uZScgKSB7XHJcbiAgICAgIHJldHVybiBzd2VhdGVyUG9zaXRpb25TdHJpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmVsYXRpdmUgY2hhcmdlIGxpa2UgXCJub1wiIG9yIFwic2V2ZXJhbFwiXHJcbiAgICBjb25zdCBzd2VhdGVyQ2hhcmdlID0gdGhpcy5zd2VhdGVyTW9kZWwuY2hhcmdlUHJvcGVydHkuZ2V0KCk7XHJcbiAgICBjb25zdCByZWxhdGl2ZUNoYXJnZVN0cmluZyA9IEJBU0VEZXNjcmliZXIuZ2V0UmVsYXRpdmVDaGFyZ2VEZXNjcmlwdGlvbiggc3dlYXRlckNoYXJnZSApO1xyXG5cclxuICAgIC8vIGFzc2VtYmxlIG5ldCBjaGFyZ2Ugc3RyaW5nLCBsaWtlIFwiSGFzIHplcm8gbmV0IGNoYXJnZVwiXHJcbiAgICBjb25zdCBuZXRDaGFyZ2VTdHJpbmcgPSBTdHJpbmdVdGlscy5maWxsSW4oIHN3ZWF0ZXJOZXRDaGFyZ2VQYXR0ZXJuU3RyaW5nLCB7XHJcbiAgICAgIG5ldENoYXJnZTogc3dlYXRlckNoYXJnZSA+IDAgPyBwb3NpdGl2ZVN0cmluZyA6IHplcm9TdHJpbmdcclxuICAgIH0gKTtcclxuXHJcbiAgICBsZXQgY2hhcmdlU3RyaW5nO1xyXG4gICAgaWYgKCBzaG93Q2hhcmdlcyA9PT0gJ2FsbCcgKSB7XHJcblxyXG4gICAgICAvLyBzcGVjaWFsIGNhc2UgLSBpZiBzd2VhdGVyIGlzIHRvdGFsbHkgb3V0IG9mIGNoYXJnZXMsIHNheSBcIm5vIG1vcmUgbmVnYXRpdmUgY2hhcmdlcywgb25seSBwb3NpdGl2ZSBjaGFyZ2VzXCJcIlxyXG4gICAgICBpZiAoIHN3ZWF0ZXJDaGFyZ2UgPT09IEJBU0VDb25zdGFudHMuTUFYX0JBTExPT05fQ0hBUkdFICkge1xyXG4gICAgICAgIGNoYXJnZVN0cmluZyA9IHN3ZWF0ZXJOb01vcmVDaGFyZ2VzU3RyaW5nO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGNoYXJnZVN0cmluZyA9IFN0cmluZ1V0aWxzLmZpbGxJbiggc3dlYXRlclJlbGF0aXZlQ2hhcmdlQWxsUGF0dGVyblN0cmluZywge1xyXG4gICAgICAgICAgY2hhcmdlOiByZWxhdGl2ZUNoYXJnZVN0cmluZ1xyXG4gICAgICAgIH0gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcblxyXG4gICAgICBpZiAoIHN3ZWF0ZXJDaGFyZ2UgPT09IDAgKSB7XHJcblxyXG4gICAgICAgIC8vIHNwZWNpYWwgY2FzZSAtIGlmIHN3ZWF0ZXIgaGFzIG5ldXRyYWwgY2hhcmdlLCBqdXN0IHNheSBcInNob3dpbmcgbm8gY2hhcmdlc1wiXHJcbiAgICAgICAgY2hhcmdlU3RyaW5nID0gc2hvd2luZ05vQ2hhcmdlc1N0cmluZztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggc3dlYXRlckNoYXJnZSA9PT0gQkFTRUNvbnN0YW50cy5NQVhfQkFMTE9PTl9DSEFSR0UgKSB7XHJcblxyXG4gICAgICAgIC8vIHNwZWNpYWwgY2FzZSAtIGlmIHN3ZWF0ZXIgaXMgb3V0IG9mICBjaGFyZ2VzLCBzYXkgXCJzaG93aW5nIGFsbCBwb3NpdGl2ZSBjaGFyZ2VzXCJcclxuICAgICAgICBjaGFyZ2VTdHJpbmcgPSBzaG93aW5nQWxsUG9zaXRpdmVDaGFyZ2VzU3RyaW5nO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGNoYXJnZVN0cmluZyA9IFN0cmluZ1V0aWxzLmZpbGxJbiggc3dlYXRlclJlbGF0aXZlQ2hhcmdlRGlmZmVyZW5jZXNQYXR0ZXJuU3RyaW5nLCB7XHJcbiAgICAgICAgICBjaGFyZ2U6IHJlbGF0aXZlQ2hhcmdlU3RyaW5nXHJcbiAgICAgICAgfSApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZGVzY3JpcHRpb24gZm9yIGNoYXJnZVxyXG4gICAgY2hhcmdlU3RyaW5nID0gU3RyaW5nVXRpbHMuZmlsbEluKCBzd2VhdGVyQ2hhcmdlUGF0dGVyblN0cmluZywge1xyXG4gICAgICBuZXRDaGFyZ2U6IG5ldENoYXJnZVN0cmluZyxcclxuICAgICAgcmVsYXRpdmVDaGFyZ2U6IGNoYXJnZVN0cmluZ1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGZ1bGwgZGVzY3JpcHRpb24sICB3aXRob3V0IHB1bmN0dWF0aW9uXHJcbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IFN0cmluZ1V0aWxzLmZpbGxJbiggc3dlYXRlckRlc2NyaXB0aW9uUGF0dGVyblN0cmluZywge1xyXG4gICAgICBwb3NpdGlvbjogc3dlYXRlclBvc2l0aW9uU3RyaW5nLFxyXG4gICAgICBjaGFyZ2U6IGNoYXJnZVN0cmluZ1xyXG4gICAgfSApO1xyXG5cclxuICAgIHJldHVybiBTdHJpbmdVdGlscy5maWxsSW4oIHNpbmdsZVN0YXRlbWVudFBhdHRlcm5TdHJpbmcsIHtcclxuICAgICAgc3RhdGVtZW50OiBkZXNjcmlwdGlvblxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhIGRlc2NyaXB0aW9uIG9mIHRoZSByZWxhdGl2ZSBjaGFyZ2Ugb2YgdGhlIHN3ZWF0ZXIsIGluY2x1ZGluZyB0aGUgbGFiZWwuIERlcGVuZGVudCBvblxyXG4gICAqIHdoYXQgY2hhcmdlcyBhcmUgdmlzaWJsZSBpbiB0aGUgdmlldy4gVGhpcyB3aWxsIGZvcm0gYSBmdWxsIHNlbnRlbmNlLiBXaWxsIHByb2R1Y2Ugc29tZXRoaW5nIGxpa2VcclxuICAgKlxyXG4gICAqIFwiU3dlYXRlciBoYXMgc2V2ZXJhbCBtb3JlIHBvc2l0aXZlIGNoYXJnZXMgdGhhbiBuZWdhdGl2ZSBjaGFyZ2VzLlwiIG9yXHJcbiAgICogXCJTd2VhdGVyIGhhcyBwb3NpdGl2ZSBuZXQgY2hhcmdlLCBzaG93aW5nIHNldmVyYWwgcG9zaXRpdmUgY2hhcmdlcy5cIiBvclxyXG4gICAqIFwiU3dlYXRlciBoYXMgbm8gbW9yZSBuZWdhdGl2ZSBjaGFyZ2VzLCBvbmx5IHBvc2l0aXZlIGNoYXJnZXMuXCJcclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0gIHtudW1iZXJ9IGNoYXJnZVxyXG4gICAqIEBwYXJhbSAge3N0cmluZ30gc2hvd25DaGFyZ2VzXHJcbiAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgKi9cclxuICBzdGF0aWMgZ2V0UmVsYXRpdmVDaGFyZ2VEZXNjcmlwdGlvbldpdGhMYWJlbCggY2hhcmdlLCBzaG93bkNoYXJnZXMgKSB7XHJcbiAgICBsZXQgZGVzY3JpcHRpb247XHJcblxyXG4gICAgLy8gdGhlIHJlbGF0aXZlIGNoYXJnZSBvbiB0aGUgc3dlYXRlciwgc29tZXRoaW5nIGxpa2UgJ3NldmVyYWwnIG9yICdtYW55J1xyXG4gICAgY29uc3QgYWJzQ2hhcmdlID0gTWF0aC5hYnMoIGNoYXJnZSApO1xyXG4gICAgY29uc3QgcmVsYXRpdmUgPSBTd2VhdGVyRGVzY3JpYmVyLmdldFJlbGF0aXZlQ2hhcmdlRGVzY3JpcHRpb24oIGFic0NoYXJnZSApO1xyXG5cclxuICAgIGlmICggc2hvd25DaGFyZ2VzID09PSAnYWxsJyApIHtcclxuICAgICAgaWYgKCBhYnNDaGFyZ2UgPT09IEJBU0VDb25zdGFudHMuTUFYX0JBTExPT05fQ0hBUkdFICkge1xyXG5cclxuICAgICAgICAvLyBpZiBubyBtb3JlIGNoYXJnZXMgcmVtYWluaW5nIG9uIHN3ZWF0ZXIsIHNwZWNpYWwgZGVzY3JpcHRpb24gbGlrZSBcIm5vIG1vcmUgbmVnYXRpdmUgY2hhcmdlcywgb25seSBwb3NpdGl2ZVwiXHJcbiAgICAgICAgZGVzY3JpcHRpb24gPSBTdHJpbmdVdGlscy5maWxsSW4oIHN3ZWF0ZXJIYXNSZWxhdGl2ZUNoYXJnZVBhdHRlcm5TdHJpbmcsIHtcclxuICAgICAgICAgIHJlbGF0aXZlQ2hhcmdlOiBzd2VhdGVyTm9Nb3JlQ2hhcmdlc1N0cmluZ1xyXG4gICAgICAgIH0gKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgLy8gZWxzZSBzb21ldGhpbmcgbGlrZSBcIlN3ZWF0ZXIgaGFzIHNldmVyYWwgbW9yZSBwb3NpdGl2ZSBjaGFyZ2VzIHRoYW4gbmVnYXRpdmUgY2hhcmdlc1wiXHJcbiAgICAgICAgY29uc3QgcmVsYXRpdmVDaGFyZ2VTdHJpbmcgPSBTdHJpbmdVdGlscy5maWxsSW4oIHN3ZWF0ZXJSZWxhdGl2ZUNoYXJnZUFsbFBhdHRlcm5TdHJpbmcsIHtcclxuICAgICAgICAgIGNoYXJnZTogcmVsYXRpdmVcclxuICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgIGRlc2NyaXB0aW9uID0gU3RyaW5nVXRpbHMuZmlsbEluKCBzd2VhdGVySGFzUmVsYXRpdmVDaGFyZ2VQYXR0ZXJuU3RyaW5nLCB7XHJcbiAgICAgICAgICByZWxhdGl2ZUNoYXJnZTogcmVsYXRpdmVDaGFyZ2VTdHJpbmdcclxuICAgICAgICB9ICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBzaG93bkNoYXJnZXMgPT09ICdkaWZmJyApIHtcclxuICAgICAgY29uc3Qgc2hvd2luZ1N0cmluZyA9IFN0cmluZ1V0aWxzLmZpbGxJbiggc3dlYXRlclJlbGF0aXZlQ2hhcmdlRGlmZmVyZW5jZXNQYXR0ZXJuU3RyaW5nLCB7XHJcbiAgICAgICAgY2hhcmdlOiByZWxhdGl2ZVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICBkZXNjcmlwdGlvbiA9IFN0cmluZ1V0aWxzLmZpbGxJbiggc3dlYXRlckhhc05ldENoYXJnZVNob3dpbmdQYXR0ZXJuU3RyaW5nLCB7XHJcbiAgICAgICAgc2hvd2luZzogc2hvd2luZ1N0cmluZ1xyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGRlc2NyaXB0aW9uO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSByZWxhdGl2ZSBjaGFyZ2Ugb24gdGhlIHN3ZWF0ZXIuICBVc3VhbGx5IGp1c3QgcmV0dXJucyB0aGUgcmVsYXRpdmUgZGVzY3JpcHRpb25cclxuICAgKiBmcm9tIEJBU0VEZXNjcmliZXIsIGJ1dCBpZiBhbGwgY2hhcmdlcyBhcmUgZ29uZSwgdGhlIHN3ZWF0ZXIgdXNlcyBhIHNwZWNpYWxcclxuICAgKiB3b3JkIHRvIGluZGljYXRlIHRoaXMuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGNoYXJnZVxyXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICovXHJcbiAgc3RhdGljIGdldFJlbGF0aXZlQ2hhcmdlRGVzY3JpcHRpb24oIGNoYXJnZSApIHtcclxuXHJcbiAgICBpZiAoIGNoYXJnZSA9PT0gQkFTRUNvbnN0YW50cy5NQVhfQkFMTE9PTl9DSEFSR0UgKSB7XHJcbiAgICAgIHJldHVybiBhbGxTdHJpbmc7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgcmV0dXJuIEJBU0VEZXNjcmliZXIuZ2V0UmVsYXRpdmVDaGFyZ2VEZXNjcmlwdGlvbiggY2hhcmdlICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYW4gYWxlcnQgZGVzY3JpYmluZyB0aGUgc3dlYXRlciB3aGVuIGl0IHJ1bnMgb3V0IG9mIGNoYXJnZXMuICBEZXBlbmRlbnQgb24gdGhlXHJcbiAgICogY2hhcmdlIHZpc2liaWxpdHkuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHBhcmFtICB7c3RyaW5nfSBzaG93bkNoYXJnZXNcclxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gICAqL1xyXG4gIHN0YXRpYyBnZXROb01vcmVDaGFyZ2VzQWxlcnQoIGNoYXJnZSwgc2hvd25DaGFyZ2VzICkge1xyXG4gICAgbGV0IGFsZXJ0O1xyXG4gICAgaWYgKCBzaG93bkNoYXJnZXMgPT09ICdhbGwnICkge1xyXG4gICAgICBhbGVydCA9IFN0cmluZ1V0aWxzLmZpbGxJbiggc3dlYXRlckhhc1JlbGF0aXZlQ2hhcmdlUGF0dGVyblN0cmluZywge1xyXG4gICAgICAgIHJlbGF0aXZlQ2hhcmdlOiBzd2VhdGVyTm9Nb3JlQ2hhcmdlc1N0cmluZ1xyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggc2hvd25DaGFyZ2VzID09PSAnZGlmZicgKSB7XHJcbiAgICAgIGFsZXJ0ID0gU3dlYXRlckRlc2NyaWJlci5nZXRSZWxhdGl2ZUNoYXJnZURlc2NyaXB0aW9uV2l0aExhYmVsKCBjaGFyZ2UsIHNob3duQ2hhcmdlcyApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhbGVydDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhIGRlc2NyaXB0aW9uIG9mIHRoZSBuZXQgY2hhcmdlIG9mIHRoZSBzd2VhdGVyLCB3aWxsIHJldHVybiBlaXRoZXJcclxuICAgKiBcIlN3ZWF0ZXIgaGFzIHBvc2l0aXZlIG5ldCBjaGFyZ2UuXCIgb3JcclxuICAgKiBcIlN3ZWF0ZXIgaGFzIG5ldXRyYWwgbmV0IGNoYXJnZS5cIlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzd2VhdGVyQ2hhcmdlXHJcbiAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgKi9cclxuICBzdGF0aWMgZ2V0TmV0Q2hhcmdlRGVzY3JpcHRpb24oIHN3ZWF0ZXJDaGFyZ2UgKSB7XHJcbiAgICBjb25zdCByZWxhdGl2ZUNoYXJnZVN0cmluZyA9ICggc3dlYXRlckNoYXJnZSA9PT0gMCApID8gbmV1dHJhbE5ldENoYXJnZVN0cmluZyA6IHBvc2l0aXZlTmV0Q2hhcmdlU3RyaW5nO1xyXG4gICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZpbGxJbiggc3dlYXRlckhhc1JlbGF0aXZlQ2hhcmdlUGF0dGVyblN0cmluZywge1xyXG4gICAgICByZWxhdGl2ZUNoYXJnZTogcmVsYXRpdmVDaGFyZ2VTdHJpbmdcclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhIGRlc2NyaXB0aW9uIHRoYXQgaW5jbHVkZXMgaW5mb3JtYXRpb24gYWJvdXQgd2hlcmUgYWRkaXRpb25hbCBjaGFyZ2VzIGFyZSBvbiB0aGUgc3dlYXRlci4gVGhpcyBpc1xyXG4gICAqIGRlcGVuZGVudCBvbiBjaGFyZ2UgdmlzaWJpbGl0eSBzZXR0aW5nLiBXaWxsIHJldHVybiBzb21ldGhpbmcgbGlrZVxyXG4gICAqIFwiTW9yZSBwYWlycyBvZiBjaGFyZ2VzIHVwIGFuZCB0byB0aGUgbGVmdFwiLiBvclxyXG4gICAqIFwiTW9yZSBwYWlycyBvZiBoaWRkZW4gY2hhcmdlcyBkb3duXCIuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtCYWxsb29uTW9kZWx9IGJhbGxvb25cclxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2hvd25DaGFyZ2VzXHJcbiAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgKi9cclxuICBzdGF0aWMgZ2V0TW9yZUNoYXJnZXNEZXNjcmlwdGlvbiggYmFsbG9vbiwgc3dlYXRlckNoYXJnZSwgc3dlYXRlckNoYXJnZXMsIHNob3duQ2hhcmdlcyApIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHN3ZWF0ZXJDaGFyZ2UgPCBCQVNFQ29uc3RhbnRzLk1BWF9CQUxMT09OX0NIQVJHRSwgJ25vIG1vcmUgY2hhcmdlcyBvbiBzd2VhdGVyJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggc2hvd25DaGFyZ2VzICE9PSAnbm9uZScsICd0aGlzIGRlc2NyaXB0aW9uIHNob3VsZCBub3QgYmUgdXNlZCB3aGVuIG5vIGNoYXJnZXMgYXJlIHNob3duJyApO1xyXG5cclxuICAgIC8vIGdldCB0aGUgbmV4dCBjaGFyZ2UgdG8gZGVzY3JpYmVcclxuICAgIGxldCBjaGFyZ2U7XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBzd2VhdGVyQ2hhcmdlcy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgY2hhcmdlID0gc3dlYXRlckNoYXJnZXNbIGkgXTtcclxuICAgICAgaWYgKCAhY2hhcmdlLm1vdmVkUHJvcGVydHkuZ2V0KCkgKSB7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBnZXQgdGhlIGRlc2NyaXB0aW9uIG9mIHRoZSBkaXJlY3Rpb24gdG8gdGhlIGNsb3Nlc3QgY2hhcmdlXHJcbiAgICBjb25zdCBkaXJlY3Rpb24gPSBCYWxsb29uTW9kZWwuZ2V0RGlyZWN0aW9uKCBjaGFyZ2UucG9zaXRpb24sIGJhbGxvb24uZ2V0Q2VudGVyKCkgKTtcclxuICAgIGNvbnN0IGRpcmVjdGlvbkRlc2NyaXB0aW9uID0gQkFTRURlc2NyaWJlci5nZXREaXJlY3Rpb25EZXNjcmlwdGlvbiggZGlyZWN0aW9uICk7XHJcblxyXG4gICAgY29uc3QgcGF0dGVyblN0cmluZyA9IEJhbGxvb25EaXJlY3Rpb25FbnVtLmlzUmVsYXRpdmVEaXJlY3Rpb24oIGRpcmVjdGlvbiApID8gbW9yZUNoYXJnZXNGdXJ0aGVyUGF0dGVyblN0cmluZyA6IG1vcmVDaGFyZ2VzUGF0dGVyblN0cmluZztcclxuXHJcbiAgICBsZXQgbW9yZUNoYXJnZXNTdHJpbmc7XHJcbiAgICBpZiAoIHNob3duQ2hhcmdlcyA9PT0gJ2FsbCcgKSB7XHJcbiAgICAgIG1vcmVDaGFyZ2VzU3RyaW5nID0gbW9yZVBhaXJzT2ZDaGFyZ2VzU3RyaW5nO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIHNob3duQ2hhcmdlcyA9PT0gJ2RpZmYnICkge1xyXG4gICAgICBtb3JlQ2hhcmdlc1N0cmluZyA9IG1vcmVIaWRkZW5QYWlyc09mQ2hhcmdlc1N0cmluZztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gU3RyaW5nVXRpbHMuZmlsbEluKCBwYXR0ZXJuU3RyaW5nLCB7XHJcbiAgICAgIG1vcmVDaGFyZ2VzOiBtb3JlQ2hhcmdlc1N0cmluZyxcclxuICAgICAgZGlyZWN0aW9uOiBkaXJlY3Rpb25EZXNjcmlwdGlvblxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGEgZGVzY3JpcHRpb24gb2YgdGhlIHN3ZWF0ZXIncyBjaGFyZ2UgZm9yIHRoZSBzY3JlZW4gc3VtbWFyeS4gV2lsbCByZXR1cm4gc29tZXRoaW5nIGxpa2VcclxuICAgKiBcIlN3ZWF0ZXIgaGFzIHBvc2l0aXZlIG5ldCBjaGFyZ2UsIGEgZmV3IG1vcmUgcG9zaXRpdmUgY2hhcmdlcyB0aGFuIG5lZ2F0aXZlIGNoYXJnZXMuXCJcclxuICAgKiBcIlN3ZWF0ZXIgaGFzIHBvc2l0aXZlIG5ldCBjaGFyZ2UsIHNob3dpbmcgYSBmZXcgcG9zaXRpdmUgY2hhcmdlcy5cIlxyXG4gICAqIFwiU3dlYXRlciBoYXMgemVybyBuZXQgY2hhcmdlLCBtYW55IHBhaXJzIG9mIHBvc2l0aXZlIGFuZCBuZWdhdGl2ZSBjaGFyZ2VzLlwiXHJcbiAgICogXCJTd2VhdGVyIGhhcyB6ZXJvIG5ldCBjaGFyZ2UsIHNob3dpbmcgbm8gY2hhcmdlcy5cIlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICovXHJcbiAgc3RhdGljIGdldFN1bW1hcnlDaGFyZ2VEZXNjcmlwdGlvbiggY2hhcmdlc1Nob3duLCBjaGFyZ2UgKSB7XHJcblxyXG4gICAgLy8gZGVzY3JpcHRpb24gb2YgdGhlIHN3ZWF0ZXIgb2JqZWN0LCBsaWtlIFwiU3dlYXRlciBoYXMgemVybyBuZXQgY2hhcmdlXCJcclxuICAgIGNvbnN0IGNoYXJnZVNpZ25TdHJpbmcgPSBjaGFyZ2UgPiAwID8gcG9zaXRpdmVTdHJpbmcgOiB6ZXJvU3RyaW5nO1xyXG4gICAgY29uc3Qgc3dlYXRlck9iamVjdFN0cmluZyA9IFN0cmluZ1V0aWxzLmZpbGxJbiggc3VtbWFyeU9iamVjdEhhc0NoYXJnZVBhdHRlcm5TdHJpbmcsIHtcclxuICAgICAgb2JqZWN0OiBzd2VhdGVyTGFiZWxTdHJpbmcsXHJcbiAgICAgIGNoYXJnZTogY2hhcmdlU2lnblN0cmluZ1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGRlc2NyaXB0aW9uIG9mIHRoZSBjaGFyZ2VzIHNob3duLCBsaWtlICdhIGZldyBtb3JlIHBvc2l0aXZlIGNoYXJnZXMgdGhhbiBuZWdhdGl2ZSBjaGFyZ2VzJ1xyXG4gICAgbGV0IGNoYXJnZVN0cmluZztcclxuICAgIGNvbnN0IHJlbGF0aXZlQ2hhcmdlU3RyaW5nID0gQkFTRURlc2NyaWJlci5nZXRSZWxhdGl2ZUNoYXJnZURlc2NyaXB0aW9uKCBjaGFyZ2UgKTtcclxuICAgIGlmICggY2hhcmdlc1Nob3duID09PSAnYWxsJyApIHtcclxuICAgICAgY2hhcmdlU3RyaW5nID0gKCBjaGFyZ2UgPT09IDAgKSA/XHJcbiAgICAgICAgICAgICAgICAgICAgIFN0cmluZ1V0aWxzLmZpbGxJbiggc3VtbWFyeU5ldXRyYWxDaGFyZ2VzUGF0dGVyblN0cmluZywgeyBhbW91bnQ6IG1hbnlTdHJpbmcgfSApIDpcclxuICAgICAgICAgICAgICAgICAgICAgU3RyaW5nVXRpbHMuZmlsbEluKCBzd2VhdGVyUmVsYXRpdmVDaGFyZ2VQYXR0ZXJuU3RyaW5nLCB7IGNoYXJnZTogcmVsYXRpdmVDaGFyZ2VTdHJpbmcgfSApO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIGNoYXJnZXNTaG93biA9PT0gJ2RpZmYnICkge1xyXG4gICAgICBjaGFyZ2VTdHJpbmcgPSAoIGNoYXJnZSA9PT0gMCApID9cclxuICAgICAgICAgICAgICAgICAgICAgc2hvd2luZ05vQ2hhcmdlc1N0cmluZyA6XHJcbiAgICAgICAgICAgICAgICAgICAgIGNoYXJnZVN0cmluZyA9IFN0cmluZ1V0aWxzLmZpbGxJbiggc3dlYXRlclNob3dpbmdQYXR0ZXJuU3RyaW5nLCB7IGNoYXJnZTogcmVsYXRpdmVDaGFyZ2VTdHJpbmcgfSApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBTdHJpbmdVdGlscy5maWxsSW4oIHN1bW1hcnlPYmplY3RDaGFyZ2VQYXR0ZXJuU3RyaW5nLCB7XHJcbiAgICAgIG9iamVjdDogc3dlYXRlck9iamVjdFN0cmluZyxcclxuICAgICAgY2hhcmdlOiBjaGFyZ2VTdHJpbmdcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbmJhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHkucmVnaXN0ZXIoICdTd2VhdGVyRGVzY3JpYmVyJywgU3dlYXRlckRlc2NyaWJlciApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgU3dlYXRlckRlc2NyaWJlcjsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsV0FBVyxNQUFNLGtEQUFrRDtBQUMxRSxPQUFPQyw0QkFBNEIsTUFBTSwwQ0FBMEM7QUFDbkYsT0FBT0MsZUFBZSxNQUFNLDBCQUEwQjtBQUN0RCxPQUFPQyxhQUFhLE1BQU0sd0JBQXdCO0FBQ2xELE9BQU9DLG9CQUFvQixNQUFNLHFDQUFxQztBQUN0RSxPQUFPQyxZQUFZLE1BQU0sNkJBQTZCO0FBQ3RELE9BQU9DLGFBQWEsTUFBTSxvQkFBb0I7O0FBRTlD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