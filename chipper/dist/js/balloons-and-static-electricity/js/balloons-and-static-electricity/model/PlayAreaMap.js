// Copyright 2017-2021, University of Colorado Boulder

/**
 * A map of the 2D play area for this simulation.  The play area includes anywhere that the Balloons can move about,
 * so it contains the entire bounds of the model.  This map is used for accessibility to generate descriptions about
 * where the balloons are as they move around the play area.
 *
 * The map is composed of regions and critical landmarks. For the regions, the map has columns and rows that are
 * broken up into ranges. Each intersection of a column and row creates a described region in the play area.
 *
 * The X_POSITIONS define critical places in the play area and the landmarks are slim columns around these, with
 * width LANDMARK_WIDTH.
 *
 * @author Jesse Greenberg
 */

import Range from '../../../../dot/js/Range.js';
import balloonsAndStaticElectricity from '../../balloonsAndStaticElectricity.js';

// constants
// when within this width of an X_POSITION, balloon is considered in a landmark
const LANDMARK_WIDTH = 20;
const HALF_LANDMARK_WIDTH = LANDMARK_WIDTH / 2;

// critical x positions for the balloon (relative to the balloon's center)
const X_POSITIONS = {
  AT_NEAR_SWEATER: 393,
  AT_CENTER_PLAY_AREA: 507,
  AT_NEAR_WALL: 596,
  AT_WALL: 621,
  AT_NEAR_RIGHT_EDGE: 676
};

// critical y positions for the balloon (relative to the balloon's center)
const Y_POSITIONS = {
  AT_BOTTOM: 393,
  AT_CENTER_PLAY_AREA: 249
};

// horizontal boundary positions, the left and right edges
const X_BOUNDARY_POSITIONS = {
  AT_LEFT_EDGE: 67,
  AT_RIGHT_EDGE: 701
};

// vertical boundary positions, the top and bottom edges
const Y_BOUNDARY_POSITIONS = {
  AT_TOP: 111,
  AT_BOTTOM: 393
};

/**
 * Create a range of the play area, optionally taking a previous range. If provided, the range that is returned will
 * start from the max value of the previous range.
 *
 * @param {number} width - desired width of the next range
 * @param {Range} [previousRange] - if provided, next range will start from max of this range
 *
 * @returns {Range}
 */
const createNextRange = (width, previousRange) => {
  const min = previousRange ? previousRange.max : 0;
  return new Range(min, min + width);
};

/**
 * Create a range in the play area that signifies a landmark. A landmark is a specific position in the Play Area
 * that is critical and has more important information. It is generally more narrow than the larger regions of the
 * PlayArea that define how the balloon's position should be described.
 *
 * @param {number} xPosition - center of the landmark
 * @returns {Range}
 */
const createLandmarkRange = xPosition => {
  return new Range(xPosition - HALF_LANDMARK_WIDTH, xPosition + HALF_LANDMARK_WIDTH);
};

// landmark ranges that surround critical x positions, but more are added below that depend on these ranges
const atNearSweaterRange = createLandmarkRange(X_POSITIONS.AT_NEAR_SWEATER);
const atCenterPlayAreaRange = createLandmarkRange(X_POSITIONS.AT_CENTER_PLAY_AREA);
const atNearWallRange = createLandmarkRange(X_POSITIONS.AT_NEAR_WALL);
const atNearRightEdgeRange = createLandmarkRange(X_POSITIONS.AT_NEAR_RIGHT_EDGE);

// special ranges with slightly different widths, but that behave just like a landmark in the play area
// at 'very close to sweater' landmark which extends to the left off the 'near sweater' landmark until we hit the
// sweater
const atVeryCloseToSweaterRange = new Range(atNearSweaterRange.min - LANDMARK_WIDTH, atNearSweaterRange.min);

// at 'very close to wall' landmark which extends to the right  off the 'near wall' landmark until just before we hit
// the wall
const atVeryCloseToWallRange = new Range(atNearWallRange.max, X_POSITIONS.AT_WALL - 1);

// at 'very close to right edge' landmark, which extends to right of the 'near right edge' landmark until just before
// we hit the right edge
const atVeryCloseToRightEdgeRange = new Range(atNearRightEdgeRange.max, X_BOUNDARY_POSITIONS.AT_RIGHT_EDGE - 1);
const LANDMARK_RANGES = {
  AT_NEAR_SWEATER: atNearSweaterRange,
  AT_CENTER_PLAY_AREA: atCenterPlayAreaRange,
  AT_NEAR_WALL: atNearWallRange,
  AT_NEAR_RIGHT_EDGE: atNearRightEdgeRange,
  AT_VERY_CLOSE_TO_SWEATER: atVeryCloseToSweaterRange,
  AT_VERY_CLOSE_TO_WALL: atVeryCloseToWallRange,
  AT_VERY_CLOSE_TO_RIGHT_EDGE: atVeryCloseToRightEdgeRange
};

// ranges that define columns in the play area, exact widths chosen by inspection to match mockup provided in #222
const leftArmRange = createNextRange(138);
const leftSideOfSweaterRange = createNextRange(65, leftArmRange);
const rightSideOfSweaterRange = createNextRange(67, leftSideOfSweaterRange);
const rightArmRange = createNextRange(65, rightSideOfSweaterRange);
const leftPlayAreaRange = createNextRange(132, rightArmRange);
const centerPlayAreaRange = createNextRange(77, leftPlayAreaRange);
const rightPlayAreaRange = createNextRange(132, centerPlayAreaRange);
const rightEdgeRange = createNextRange(500, rightPlayAreaRange); // extends far beyond the play area bounds
const COLUMN_RANGES = {
  LEFT_ARM: leftArmRange,
  LEFT_SIDE_OF_SWEATER: leftSideOfSweaterRange,
  RIGHT_SIDE_OF_SWEATER: rightSideOfSweaterRange,
  RIGHT_ARM: rightArmRange,
  LEFT_PLAY_AREA: leftPlayAreaRange,
  CENTER_PLAY_AREA: centerPlayAreaRange,
  RIGHT_PLAY_AREA: rightPlayAreaRange,
  RIGHT_EDGE: rightEdgeRange
};

// ranges that define the rows of the play area, exact heights chosen by inspection to match mockup in #222
const upperPlayAreaRange = createNextRange(172);
const centerPlayAreaRowRange = createNextRange(154, upperPlayAreaRange);
const lowerPlayAreaRange = createNextRange(500, centerPlayAreaRowRange);
const ROW_RANGES = {
  UPPER_PLAY_AREA: upperPlayAreaRange,
  CENTER_PLAY_AREA: centerPlayAreaRowRange,
  LOWER_PLAY_AREA: lowerPlayAreaRange
};
const PlayAreaMap = {
  X_POSITIONS: X_POSITIONS,
  Y_POSITIONS: Y_POSITIONS,
  X_BOUNDARY_POSITIONS: X_BOUNDARY_POSITIONS,
  Y_BOUNDARY_POSITIONS: Y_BOUNDARY_POSITIONS,
  COLUMN_RANGES: COLUMN_RANGES,
  ROW_RANGES: ROW_RANGES,
  LANDMARK_RANGES: LANDMARK_RANGES,
  WIDTH: 768,
  HEIGHT: 504,
  /**
   * Get the column of the play area for the a given position in the model, including landmark positions.
   *
   * @param  {Vector2} position
   * @returns {string}
   */
  getPlayAreaColumn(position, wallVisible) {
    const columns = COLUMN_RANGES;

    // loop through keys manually to prevent a many closures from being created during object iteration in 'for in'
    // loops
    const columnsKeys = Object.keys(columns);
    let column;
    for (let i = 0; i < columnsKeys.length; i++) {
      if (columns[columnsKeys[i]].contains(position.x)) {
        column = columnsKeys[i];
      }
    }
    assert && assert(column, 'object should be in a column of the play area');

    // the wall and the right edge of the play area overlap, so if the wall is visible, chose that description
    if (wallVisible && column === 'RIGHT_EDGE') {
      column = 'WALL';
    }
    return column;
  },
  /**
   * Get the landmark of the play area for the a given position in the model.
   *
   * @param  {Vector2} position
   * @returns {string}
   */
  getPlayAreaLandmark(position, wallVisible) {
    const landmarks = LANDMARK_RANGES;

    // loop through keys manually to prevent a many closures from being created during object iteration in 'for in'
    // loops
    const landmarksKeys = Object.keys(landmarks);
    let landmark = null;
    for (let i = 0; i < landmarksKeys.length; i++) {
      if (landmarks[landmarksKeys[i]].contains(position.x)) {
        landmark = landmarksKeys[i];
      }
    }

    // the wall and the right edge of the play area overlap, so if the wall is visible, chose that description
    if (wallVisible && landmark === 'RIGHT_EDGE') {
      landmark = 'WALL';
    }
    return landmark;
  },
  /**
   * Get a row in the play area that contains the position in the model.
   *
   * @param  {Vector2} position
   * @returns {strint}
   */
  getPlayAreaRow(position) {
    const rows = PlayAreaMap.ROW_RANGES;

    // loop through keys manually to prevent a many closures from being created during object iteration in 'for in' loops
    const rowKeys = Object.keys(rows);
    let row;
    let i;
    for (i = 0; i < rowKeys.length; i++) {
      if (rows[rowKeys[i]].contains(position.y)) {
        row = rowKeys[i];
      }
    }
    assert && assert(row, 'item should be in a row of the play area');
    return row;
  },
  /**
   * Returns true if the position is determined to be in one of the landmark columns. These are the ranges
   * that surround critical x positions.
   *
   * @param {Vector2} position
   * @returns {boolean}
   */
  inLandmarkColumn(position) {
    const landmarks = PlayAreaMap.LANDMARK_RANGES;

    // loop through keys manually to prevent many closures from being created during object iteration in for loops
    const landmarkKeys = Object.keys(landmarks);
    let inLandmarkColumn = false;
    for (let i = 0; i < landmarkKeys.length; i++) {
      if (landmarks[landmarkKeys[i]].contains(position.x)) {
        inLandmarkColumn = true;
        break;
      }
    }
    return inLandmarkColumn;
  }
};
balloonsAndStaticElectricity.register('PlayAreaMap', PlayAreaMap);
export default PlayAreaMap;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSYW5nZSIsImJhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHkiLCJMQU5ETUFSS19XSURUSCIsIkhBTEZfTEFORE1BUktfV0lEVEgiLCJYX1BPU0lUSU9OUyIsIkFUX05FQVJfU1dFQVRFUiIsIkFUX0NFTlRFUl9QTEFZX0FSRUEiLCJBVF9ORUFSX1dBTEwiLCJBVF9XQUxMIiwiQVRfTkVBUl9SSUdIVF9FREdFIiwiWV9QT1NJVElPTlMiLCJBVF9CT1RUT00iLCJYX0JPVU5EQVJZX1BPU0lUSU9OUyIsIkFUX0xFRlRfRURHRSIsIkFUX1JJR0hUX0VER0UiLCJZX0JPVU5EQVJZX1BPU0lUSU9OUyIsIkFUX1RPUCIsImNyZWF0ZU5leHRSYW5nZSIsIndpZHRoIiwicHJldmlvdXNSYW5nZSIsIm1pbiIsIm1heCIsImNyZWF0ZUxhbmRtYXJrUmFuZ2UiLCJ4UG9zaXRpb24iLCJhdE5lYXJTd2VhdGVyUmFuZ2UiLCJhdENlbnRlclBsYXlBcmVhUmFuZ2UiLCJhdE5lYXJXYWxsUmFuZ2UiLCJhdE5lYXJSaWdodEVkZ2VSYW5nZSIsImF0VmVyeUNsb3NlVG9Td2VhdGVyUmFuZ2UiLCJhdFZlcnlDbG9zZVRvV2FsbFJhbmdlIiwiYXRWZXJ5Q2xvc2VUb1JpZ2h0RWRnZVJhbmdlIiwiTEFORE1BUktfUkFOR0VTIiwiQVRfVkVSWV9DTE9TRV9UT19TV0VBVEVSIiwiQVRfVkVSWV9DTE9TRV9UT19XQUxMIiwiQVRfVkVSWV9DTE9TRV9UT19SSUdIVF9FREdFIiwibGVmdEFybVJhbmdlIiwibGVmdFNpZGVPZlN3ZWF0ZXJSYW5nZSIsInJpZ2h0U2lkZU9mU3dlYXRlclJhbmdlIiwicmlnaHRBcm1SYW5nZSIsImxlZnRQbGF5QXJlYVJhbmdlIiwiY2VudGVyUGxheUFyZWFSYW5nZSIsInJpZ2h0UGxheUFyZWFSYW5nZSIsInJpZ2h0RWRnZVJhbmdlIiwiQ09MVU1OX1JBTkdFUyIsIkxFRlRfQVJNIiwiTEVGVF9TSURFX09GX1NXRUFURVIiLCJSSUdIVF9TSURFX09GX1NXRUFURVIiLCJSSUdIVF9BUk0iLCJMRUZUX1BMQVlfQVJFQSIsIkNFTlRFUl9QTEFZX0FSRUEiLCJSSUdIVF9QTEFZX0FSRUEiLCJSSUdIVF9FREdFIiwidXBwZXJQbGF5QXJlYVJhbmdlIiwiY2VudGVyUGxheUFyZWFSb3dSYW5nZSIsImxvd2VyUGxheUFyZWFSYW5nZSIsIlJPV19SQU5HRVMiLCJVUFBFUl9QTEFZX0FSRUEiLCJMT1dFUl9QTEFZX0FSRUEiLCJQbGF5QXJlYU1hcCIsIldJRFRIIiwiSEVJR0hUIiwiZ2V0UGxheUFyZWFDb2x1bW4iLCJwb3NpdGlvbiIsIndhbGxWaXNpYmxlIiwiY29sdW1ucyIsImNvbHVtbnNLZXlzIiwiT2JqZWN0Iiwia2V5cyIsImNvbHVtbiIsImkiLCJsZW5ndGgiLCJjb250YWlucyIsIngiLCJhc3NlcnQiLCJnZXRQbGF5QXJlYUxhbmRtYXJrIiwibGFuZG1hcmtzIiwibGFuZG1hcmtzS2V5cyIsImxhbmRtYXJrIiwiZ2V0UGxheUFyZWFSb3ciLCJyb3dzIiwicm93S2V5cyIsInJvdyIsInkiLCJpbkxhbmRtYXJrQ29sdW1uIiwibGFuZG1hcmtLZXlzIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJQbGF5QXJlYU1hcC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNy0yMDIxLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBIG1hcCBvZiB0aGUgMkQgcGxheSBhcmVhIGZvciB0aGlzIHNpbXVsYXRpb24uICBUaGUgcGxheSBhcmVhIGluY2x1ZGVzIGFueXdoZXJlIHRoYXQgdGhlIEJhbGxvb25zIGNhbiBtb3ZlIGFib3V0LFxyXG4gKiBzbyBpdCBjb250YWlucyB0aGUgZW50aXJlIGJvdW5kcyBvZiB0aGUgbW9kZWwuICBUaGlzIG1hcCBpcyB1c2VkIGZvciBhY2Nlc3NpYmlsaXR5IHRvIGdlbmVyYXRlIGRlc2NyaXB0aW9ucyBhYm91dFxyXG4gKiB3aGVyZSB0aGUgYmFsbG9vbnMgYXJlIGFzIHRoZXkgbW92ZSBhcm91bmQgdGhlIHBsYXkgYXJlYS5cclxuICpcclxuICogVGhlIG1hcCBpcyBjb21wb3NlZCBvZiByZWdpb25zIGFuZCBjcml0aWNhbCBsYW5kbWFya3MuIEZvciB0aGUgcmVnaW9ucywgdGhlIG1hcCBoYXMgY29sdW1ucyBhbmQgcm93cyB0aGF0IGFyZVxyXG4gKiBicm9rZW4gdXAgaW50byByYW5nZXMuIEVhY2ggaW50ZXJzZWN0aW9uIG9mIGEgY29sdW1uIGFuZCByb3cgY3JlYXRlcyBhIGRlc2NyaWJlZCByZWdpb24gaW4gdGhlIHBsYXkgYXJlYS5cclxuICpcclxuICogVGhlIFhfUE9TSVRJT05TIGRlZmluZSBjcml0aWNhbCBwbGFjZXMgaW4gdGhlIHBsYXkgYXJlYSBhbmQgdGhlIGxhbmRtYXJrcyBhcmUgc2xpbSBjb2x1bW5zIGFyb3VuZCB0aGVzZSwgd2l0aFxyXG4gKiB3aWR0aCBMQU5ETUFSS19XSURUSC5cclxuICpcclxuICogQGF1dGhvciBKZXNzZSBHcmVlbmJlcmdcclxuICovXHJcblxyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IGJhbGxvb25zQW5kU3RhdGljRWxlY3RyaWNpdHkgZnJvbSAnLi4vLi4vYmFsbG9vbnNBbmRTdGF0aWNFbGVjdHJpY2l0eS5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuLy8gd2hlbiB3aXRoaW4gdGhpcyB3aWR0aCBvZiBhbiBYX1BPU0lUSU9OLCBiYWxsb29uIGlzIGNvbnNpZGVyZWQgaW4gYSBsYW5kbWFya1xyXG5jb25zdCBMQU5ETUFSS19XSURUSCA9IDIwO1xyXG5jb25zdCBIQUxGX0xBTkRNQVJLX1dJRFRIID0gTEFORE1BUktfV0lEVEggLyAyO1xyXG5cclxuLy8gY3JpdGljYWwgeCBwb3NpdGlvbnMgZm9yIHRoZSBiYWxsb29uIChyZWxhdGl2ZSB0byB0aGUgYmFsbG9vbidzIGNlbnRlcilcclxuY29uc3QgWF9QT1NJVElPTlMgPSB7XHJcbiAgQVRfTkVBUl9TV0VBVEVSOiAzOTMsXHJcbiAgQVRfQ0VOVEVSX1BMQVlfQVJFQTogNTA3LFxyXG4gIEFUX05FQVJfV0FMTDogNTk2LFxyXG4gIEFUX1dBTEw6IDYyMSxcclxuICBBVF9ORUFSX1JJR0hUX0VER0U6IDY3NlxyXG59O1xyXG5cclxuLy8gY3JpdGljYWwgeSBwb3NpdGlvbnMgZm9yIHRoZSBiYWxsb29uIChyZWxhdGl2ZSB0byB0aGUgYmFsbG9vbidzIGNlbnRlcilcclxuY29uc3QgWV9QT1NJVElPTlMgPSB7XHJcbiAgQVRfQk9UVE9NOiAzOTMsXHJcbiAgQVRfQ0VOVEVSX1BMQVlfQVJFQTogMjQ5XHJcbn07XHJcblxyXG4vLyBob3Jpem9udGFsIGJvdW5kYXJ5IHBvc2l0aW9ucywgdGhlIGxlZnQgYW5kIHJpZ2h0IGVkZ2VzXHJcbmNvbnN0IFhfQk9VTkRBUllfUE9TSVRJT05TID0ge1xyXG4gIEFUX0xFRlRfRURHRTogNjcsXHJcbiAgQVRfUklHSFRfRURHRTogNzAxXHJcbn07XHJcblxyXG4vLyB2ZXJ0aWNhbCBib3VuZGFyeSBwb3NpdGlvbnMsIHRoZSB0b3AgYW5kIGJvdHRvbSBlZGdlc1xyXG5jb25zdCBZX0JPVU5EQVJZX1BPU0lUSU9OUyA9IHtcclxuICBBVF9UT1A6IDExMSxcclxuICBBVF9CT1RUT006IDM5M1xyXG59O1xyXG5cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYSByYW5nZSBvZiB0aGUgcGxheSBhcmVhLCBvcHRpb25hbGx5IHRha2luZyBhIHByZXZpb3VzIHJhbmdlLiBJZiBwcm92aWRlZCwgdGhlIHJhbmdlIHRoYXQgaXMgcmV0dXJuZWQgd2lsbFxyXG4gKiBzdGFydCBmcm9tIHRoZSBtYXggdmFsdWUgb2YgdGhlIHByZXZpb3VzIHJhbmdlLlxyXG4gKlxyXG4gKiBAcGFyYW0ge251bWJlcn0gd2lkdGggLSBkZXNpcmVkIHdpZHRoIG9mIHRoZSBuZXh0IHJhbmdlXHJcbiAqIEBwYXJhbSB7UmFuZ2V9IFtwcmV2aW91c1JhbmdlXSAtIGlmIHByb3ZpZGVkLCBuZXh0IHJhbmdlIHdpbGwgc3RhcnQgZnJvbSBtYXggb2YgdGhpcyByYW5nZVxyXG4gKlxyXG4gKiBAcmV0dXJucyB7UmFuZ2V9XHJcbiAqL1xyXG5jb25zdCBjcmVhdGVOZXh0UmFuZ2UgPSAoIHdpZHRoLCBwcmV2aW91c1JhbmdlICkgPT4ge1xyXG4gIGNvbnN0IG1pbiA9IHByZXZpb3VzUmFuZ2UgPyBwcmV2aW91c1JhbmdlLm1heCA6IDA7XHJcbiAgcmV0dXJuIG5ldyBSYW5nZSggbWluLCBtaW4gKyB3aWR0aCApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhIHJhbmdlIGluIHRoZSBwbGF5IGFyZWEgdGhhdCBzaWduaWZpZXMgYSBsYW5kbWFyay4gQSBsYW5kbWFyayBpcyBhIHNwZWNpZmljIHBvc2l0aW9uIGluIHRoZSBQbGF5IEFyZWFcclxuICogdGhhdCBpcyBjcml0aWNhbCBhbmQgaGFzIG1vcmUgaW1wb3J0YW50IGluZm9ybWF0aW9uLiBJdCBpcyBnZW5lcmFsbHkgbW9yZSBuYXJyb3cgdGhhbiB0aGUgbGFyZ2VyIHJlZ2lvbnMgb2YgdGhlXHJcbiAqIFBsYXlBcmVhIHRoYXQgZGVmaW5lIGhvdyB0aGUgYmFsbG9vbidzIHBvc2l0aW9uIHNob3VsZCBiZSBkZXNjcmliZWQuXHJcbiAqXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSB4UG9zaXRpb24gLSBjZW50ZXIgb2YgdGhlIGxhbmRtYXJrXHJcbiAqIEByZXR1cm5zIHtSYW5nZX1cclxuICovXHJcbmNvbnN0IGNyZWF0ZUxhbmRtYXJrUmFuZ2UgPSB4UG9zaXRpb24gPT4ge1xyXG4gIHJldHVybiBuZXcgUmFuZ2UoIHhQb3NpdGlvbiAtIEhBTEZfTEFORE1BUktfV0lEVEgsIHhQb3NpdGlvbiArIEhBTEZfTEFORE1BUktfV0lEVEggKTtcclxufTtcclxuXHJcbi8vIGxhbmRtYXJrIHJhbmdlcyB0aGF0IHN1cnJvdW5kIGNyaXRpY2FsIHggcG9zaXRpb25zLCBidXQgbW9yZSBhcmUgYWRkZWQgYmVsb3cgdGhhdCBkZXBlbmQgb24gdGhlc2UgcmFuZ2VzXHJcbmNvbnN0IGF0TmVhclN3ZWF0ZXJSYW5nZSA9IGNyZWF0ZUxhbmRtYXJrUmFuZ2UoIFhfUE9TSVRJT05TLkFUX05FQVJfU1dFQVRFUiApO1xyXG5jb25zdCBhdENlbnRlclBsYXlBcmVhUmFuZ2UgPSBjcmVhdGVMYW5kbWFya1JhbmdlKCBYX1BPU0lUSU9OUy5BVF9DRU5URVJfUExBWV9BUkVBICk7XHJcbmNvbnN0IGF0TmVhcldhbGxSYW5nZSA9IGNyZWF0ZUxhbmRtYXJrUmFuZ2UoIFhfUE9TSVRJT05TLkFUX05FQVJfV0FMTCApO1xyXG5jb25zdCBhdE5lYXJSaWdodEVkZ2VSYW5nZSA9IGNyZWF0ZUxhbmRtYXJrUmFuZ2UoIFhfUE9TSVRJT05TLkFUX05FQVJfUklHSFRfRURHRSApO1xyXG5cclxuLy8gc3BlY2lhbCByYW5nZXMgd2l0aCBzbGlnaHRseSBkaWZmZXJlbnQgd2lkdGhzLCBidXQgdGhhdCBiZWhhdmUganVzdCBsaWtlIGEgbGFuZG1hcmsgaW4gdGhlIHBsYXkgYXJlYVxyXG4vLyBhdCAndmVyeSBjbG9zZSB0byBzd2VhdGVyJyBsYW5kbWFyayB3aGljaCBleHRlbmRzIHRvIHRoZSBsZWZ0IG9mZiB0aGUgJ25lYXIgc3dlYXRlcicgbGFuZG1hcmsgdW50aWwgd2UgaGl0IHRoZVxyXG4vLyBzd2VhdGVyXHJcbmNvbnN0IGF0VmVyeUNsb3NlVG9Td2VhdGVyUmFuZ2UgPSBuZXcgUmFuZ2UoIGF0TmVhclN3ZWF0ZXJSYW5nZS5taW4gLSBMQU5ETUFSS19XSURUSCwgYXROZWFyU3dlYXRlclJhbmdlLm1pbiApO1xyXG5cclxuLy8gYXQgJ3ZlcnkgY2xvc2UgdG8gd2FsbCcgbGFuZG1hcmsgd2hpY2ggZXh0ZW5kcyB0byB0aGUgcmlnaHQgIG9mZiB0aGUgJ25lYXIgd2FsbCcgbGFuZG1hcmsgdW50aWwganVzdCBiZWZvcmUgd2UgaGl0XHJcbi8vIHRoZSB3YWxsXHJcbmNvbnN0IGF0VmVyeUNsb3NlVG9XYWxsUmFuZ2UgPSBuZXcgUmFuZ2UoIGF0TmVhcldhbGxSYW5nZS5tYXgsIFhfUE9TSVRJT05TLkFUX1dBTEwgLSAxICk7XHJcblxyXG4vLyBhdCAndmVyeSBjbG9zZSB0byByaWdodCBlZGdlJyBsYW5kbWFyaywgd2hpY2ggZXh0ZW5kcyB0byByaWdodCBvZiB0aGUgJ25lYXIgcmlnaHQgZWRnZScgbGFuZG1hcmsgdW50aWwganVzdCBiZWZvcmVcclxuLy8gd2UgaGl0IHRoZSByaWdodCBlZGdlXHJcbmNvbnN0IGF0VmVyeUNsb3NlVG9SaWdodEVkZ2VSYW5nZSA9IG5ldyBSYW5nZSggYXROZWFyUmlnaHRFZGdlUmFuZ2UubWF4LCBYX0JPVU5EQVJZX1BPU0lUSU9OUy5BVF9SSUdIVF9FREdFIC0gMSApO1xyXG5jb25zdCBMQU5ETUFSS19SQU5HRVMgPSB7XHJcbiAgQVRfTkVBUl9TV0VBVEVSOiBhdE5lYXJTd2VhdGVyUmFuZ2UsXHJcbiAgQVRfQ0VOVEVSX1BMQVlfQVJFQTogYXRDZW50ZXJQbGF5QXJlYVJhbmdlLFxyXG4gIEFUX05FQVJfV0FMTDogYXROZWFyV2FsbFJhbmdlLFxyXG4gIEFUX05FQVJfUklHSFRfRURHRTogYXROZWFyUmlnaHRFZGdlUmFuZ2UsXHJcbiAgQVRfVkVSWV9DTE9TRV9UT19TV0VBVEVSOiBhdFZlcnlDbG9zZVRvU3dlYXRlclJhbmdlLFxyXG4gIEFUX1ZFUllfQ0xPU0VfVE9fV0FMTDogYXRWZXJ5Q2xvc2VUb1dhbGxSYW5nZSxcclxuICBBVF9WRVJZX0NMT1NFX1RPX1JJR0hUX0VER0U6IGF0VmVyeUNsb3NlVG9SaWdodEVkZ2VSYW5nZVxyXG59O1xyXG5cclxuLy8gcmFuZ2VzIHRoYXQgZGVmaW5lIGNvbHVtbnMgaW4gdGhlIHBsYXkgYXJlYSwgZXhhY3Qgd2lkdGhzIGNob3NlbiBieSBpbnNwZWN0aW9uIHRvIG1hdGNoIG1vY2t1cCBwcm92aWRlZCBpbiAjMjIyXHJcbmNvbnN0IGxlZnRBcm1SYW5nZSA9IGNyZWF0ZU5leHRSYW5nZSggMTM4ICk7XHJcbmNvbnN0IGxlZnRTaWRlT2ZTd2VhdGVyUmFuZ2UgPSBjcmVhdGVOZXh0UmFuZ2UoIDY1LCBsZWZ0QXJtUmFuZ2UgKTtcclxuY29uc3QgcmlnaHRTaWRlT2ZTd2VhdGVyUmFuZ2UgPSBjcmVhdGVOZXh0UmFuZ2UoIDY3LCBsZWZ0U2lkZU9mU3dlYXRlclJhbmdlICk7XHJcbmNvbnN0IHJpZ2h0QXJtUmFuZ2UgPSBjcmVhdGVOZXh0UmFuZ2UoIDY1LCByaWdodFNpZGVPZlN3ZWF0ZXJSYW5nZSApO1xyXG5jb25zdCBsZWZ0UGxheUFyZWFSYW5nZSA9IGNyZWF0ZU5leHRSYW5nZSggMTMyLCByaWdodEFybVJhbmdlICk7XHJcbmNvbnN0IGNlbnRlclBsYXlBcmVhUmFuZ2UgPSBjcmVhdGVOZXh0UmFuZ2UoIDc3LCBsZWZ0UGxheUFyZWFSYW5nZSApO1xyXG5jb25zdCByaWdodFBsYXlBcmVhUmFuZ2UgPSBjcmVhdGVOZXh0UmFuZ2UoIDEzMiwgY2VudGVyUGxheUFyZWFSYW5nZSApO1xyXG5jb25zdCByaWdodEVkZ2VSYW5nZSA9IGNyZWF0ZU5leHRSYW5nZSggNTAwLCByaWdodFBsYXlBcmVhUmFuZ2UgKTsgLy8gZXh0ZW5kcyBmYXIgYmV5b25kIHRoZSBwbGF5IGFyZWEgYm91bmRzXHJcbmNvbnN0IENPTFVNTl9SQU5HRVMgPSB7XHJcbiAgTEVGVF9BUk06IGxlZnRBcm1SYW5nZSxcclxuICBMRUZUX1NJREVfT0ZfU1dFQVRFUjogbGVmdFNpZGVPZlN3ZWF0ZXJSYW5nZSxcclxuICBSSUdIVF9TSURFX09GX1NXRUFURVI6IHJpZ2h0U2lkZU9mU3dlYXRlclJhbmdlLFxyXG4gIFJJR0hUX0FSTTogcmlnaHRBcm1SYW5nZSxcclxuICBMRUZUX1BMQVlfQVJFQTogbGVmdFBsYXlBcmVhUmFuZ2UsXHJcbiAgQ0VOVEVSX1BMQVlfQVJFQTogY2VudGVyUGxheUFyZWFSYW5nZSxcclxuICBSSUdIVF9QTEFZX0FSRUE6IHJpZ2h0UGxheUFyZWFSYW5nZSxcclxuICBSSUdIVF9FREdFOiByaWdodEVkZ2VSYW5nZVxyXG59O1xyXG5cclxuLy8gcmFuZ2VzIHRoYXQgZGVmaW5lIHRoZSByb3dzIG9mIHRoZSBwbGF5IGFyZWEsIGV4YWN0IGhlaWdodHMgY2hvc2VuIGJ5IGluc3BlY3Rpb24gdG8gbWF0Y2ggbW9ja3VwIGluICMyMjJcclxuY29uc3QgdXBwZXJQbGF5QXJlYVJhbmdlID0gY3JlYXRlTmV4dFJhbmdlKCAxNzIgKTtcclxuY29uc3QgY2VudGVyUGxheUFyZWFSb3dSYW5nZSA9IGNyZWF0ZU5leHRSYW5nZSggMTU0LCB1cHBlclBsYXlBcmVhUmFuZ2UgKTtcclxuY29uc3QgbG93ZXJQbGF5QXJlYVJhbmdlID0gY3JlYXRlTmV4dFJhbmdlKCA1MDAsIGNlbnRlclBsYXlBcmVhUm93UmFuZ2UgKTtcclxuY29uc3QgUk9XX1JBTkdFUyA9IHtcclxuICBVUFBFUl9QTEFZX0FSRUE6IHVwcGVyUGxheUFyZWFSYW5nZSxcclxuICBDRU5URVJfUExBWV9BUkVBOiBjZW50ZXJQbGF5QXJlYVJvd1JhbmdlLFxyXG4gIExPV0VSX1BMQVlfQVJFQTogbG93ZXJQbGF5QXJlYVJhbmdlXHJcbn07XHJcblxyXG5jb25zdCBQbGF5QXJlYU1hcCA9IHtcclxuICBYX1BPU0lUSU9OUzogWF9QT1NJVElPTlMsXHJcbiAgWV9QT1NJVElPTlM6IFlfUE9TSVRJT05TLFxyXG4gIFhfQk9VTkRBUllfUE9TSVRJT05TOiBYX0JPVU5EQVJZX1BPU0lUSU9OUyxcclxuICBZX0JPVU5EQVJZX1BPU0lUSU9OUzogWV9CT1VOREFSWV9QT1NJVElPTlMsXHJcbiAgQ09MVU1OX1JBTkdFUzogQ09MVU1OX1JBTkdFUyxcclxuICBST1dfUkFOR0VTOiBST1dfUkFOR0VTLFxyXG4gIExBTkRNQVJLX1JBTkdFUzogTEFORE1BUktfUkFOR0VTLFxyXG4gIFdJRFRIOiA3NjgsXHJcbiAgSEVJR0hUOiA1MDQsXHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgY29sdW1uIG9mIHRoZSBwbGF5IGFyZWEgZm9yIHRoZSBhIGdpdmVuIHBvc2l0aW9uIGluIHRoZSBtb2RlbCwgaW5jbHVkaW5nIGxhbmRtYXJrIHBvc2l0aW9ucy5cclxuICAgKlxyXG4gICAqIEBwYXJhbSAge1ZlY3RvcjJ9IHBvc2l0aW9uXHJcbiAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgKi9cclxuICBnZXRQbGF5QXJlYUNvbHVtbiggcG9zaXRpb24sIHdhbGxWaXNpYmxlICkge1xyXG4gICAgY29uc3QgY29sdW1ucyA9IENPTFVNTl9SQU5HRVM7XHJcblxyXG4gICAgLy8gbG9vcCB0aHJvdWdoIGtleXMgbWFudWFsbHkgdG8gcHJldmVudCBhIG1hbnkgY2xvc3VyZXMgZnJvbSBiZWluZyBjcmVhdGVkIGR1cmluZyBvYmplY3QgaXRlcmF0aW9uIGluICdmb3IgaW4nXHJcbiAgICAvLyBsb29wc1xyXG4gICAgY29uc3QgY29sdW1uc0tleXMgPSBPYmplY3Qua2V5cyggY29sdW1ucyApO1xyXG5cclxuICAgIGxldCBjb2x1bW47XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBjb2x1bW5zS2V5cy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgaWYgKCBjb2x1bW5zWyBjb2x1bW5zS2V5c1sgaSBdIF0uY29udGFpbnMoIHBvc2l0aW9uLnggKSApIHtcclxuICAgICAgICBjb2x1bW4gPSBjb2x1bW5zS2V5c1sgaSBdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBjb2x1bW4sICdvYmplY3Qgc2hvdWxkIGJlIGluIGEgY29sdW1uIG9mIHRoZSBwbGF5IGFyZWEnICk7XHJcblxyXG4gICAgLy8gdGhlIHdhbGwgYW5kIHRoZSByaWdodCBlZGdlIG9mIHRoZSBwbGF5IGFyZWEgb3ZlcmxhcCwgc28gaWYgdGhlIHdhbGwgaXMgdmlzaWJsZSwgY2hvc2UgdGhhdCBkZXNjcmlwdGlvblxyXG4gICAgaWYgKCB3YWxsVmlzaWJsZSAmJiBjb2x1bW4gPT09ICdSSUdIVF9FREdFJyApIHtcclxuICAgICAgY29sdW1uID0gJ1dBTEwnO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjb2x1bW47XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBsYW5kbWFyayBvZiB0aGUgcGxheSBhcmVhIGZvciB0aGUgYSBnaXZlbiBwb3NpdGlvbiBpbiB0aGUgbW9kZWwuXHJcbiAgICpcclxuICAgKiBAcGFyYW0gIHtWZWN0b3IyfSBwb3NpdGlvblxyXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICovXHJcbiAgZ2V0UGxheUFyZWFMYW5kbWFyayggcG9zaXRpb24sIHdhbGxWaXNpYmxlICkge1xyXG4gICAgY29uc3QgbGFuZG1hcmtzID0gTEFORE1BUktfUkFOR0VTO1xyXG5cclxuICAgIC8vIGxvb3AgdGhyb3VnaCBrZXlzIG1hbnVhbGx5IHRvIHByZXZlbnQgYSBtYW55IGNsb3N1cmVzIGZyb20gYmVpbmcgY3JlYXRlZCBkdXJpbmcgb2JqZWN0IGl0ZXJhdGlvbiBpbiAnZm9yIGluJ1xyXG4gICAgLy8gbG9vcHNcclxuICAgIGNvbnN0IGxhbmRtYXJrc0tleXMgPSBPYmplY3Qua2V5cyggbGFuZG1hcmtzICk7XHJcblxyXG4gICAgbGV0IGxhbmRtYXJrID0gbnVsbDtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IGxhbmRtYXJrc0tleXMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgIGlmICggbGFuZG1hcmtzWyBsYW5kbWFya3NLZXlzWyBpIF0gXS5jb250YWlucyggcG9zaXRpb24ueCApICkge1xyXG4gICAgICAgIGxhbmRtYXJrID0gbGFuZG1hcmtzS2V5c1sgaSBdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdGhlIHdhbGwgYW5kIHRoZSByaWdodCBlZGdlIG9mIHRoZSBwbGF5IGFyZWEgb3ZlcmxhcCwgc28gaWYgdGhlIHdhbGwgaXMgdmlzaWJsZSwgY2hvc2UgdGhhdCBkZXNjcmlwdGlvblxyXG4gICAgaWYgKCB3YWxsVmlzaWJsZSAmJiBsYW5kbWFyayA9PT0gJ1JJR0hUX0VER0UnICkge1xyXG4gICAgICBsYW5kbWFyayA9ICdXQUxMJztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbGFuZG1hcms7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGEgcm93IGluIHRoZSBwbGF5IGFyZWEgdGhhdCBjb250YWlucyB0aGUgcG9zaXRpb24gaW4gdGhlIG1vZGVsLlxyXG4gICAqXHJcbiAgICogQHBhcmFtICB7VmVjdG9yMn0gcG9zaXRpb25cclxuICAgKiBAcmV0dXJucyB7c3RyaW50fVxyXG4gICAqL1xyXG4gIGdldFBsYXlBcmVhUm93KCBwb3NpdGlvbiApIHtcclxuICAgIGNvbnN0IHJvd3MgPSBQbGF5QXJlYU1hcC5ST1dfUkFOR0VTO1xyXG5cclxuICAgIC8vIGxvb3AgdGhyb3VnaCBrZXlzIG1hbnVhbGx5IHRvIHByZXZlbnQgYSBtYW55IGNsb3N1cmVzIGZyb20gYmVpbmcgY3JlYXRlZCBkdXJpbmcgb2JqZWN0IGl0ZXJhdGlvbiBpbiAnZm9yIGluJyBsb29wc1xyXG4gICAgY29uc3Qgcm93S2V5cyA9IE9iamVjdC5rZXlzKCByb3dzICk7XHJcblxyXG4gICAgbGV0IHJvdztcclxuICAgIGxldCBpO1xyXG4gICAgZm9yICggaSA9IDA7IGkgPCByb3dLZXlzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBpZiAoIHJvd3NbIHJvd0tleXNbIGkgXSBdLmNvbnRhaW5zKCBwb3NpdGlvbi55ICkgKSB7XHJcbiAgICAgICAgcm93ID0gcm93S2V5c1sgaSBdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCByb3csICdpdGVtIHNob3VsZCBiZSBpbiBhIHJvdyBvZiB0aGUgcGxheSBhcmVhJyApO1xyXG5cclxuICAgIHJldHVybiByb3c7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBwb3NpdGlvbiBpcyBkZXRlcm1pbmVkIHRvIGJlIGluIG9uZSBvZiB0aGUgbGFuZG1hcmsgY29sdW1ucy4gVGhlc2UgYXJlIHRoZSByYW5nZXNcclxuICAgKiB0aGF0IHN1cnJvdW5kIGNyaXRpY2FsIHggcG9zaXRpb25zLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtWZWN0b3IyfSBwb3NpdGlvblxyXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAqL1xyXG4gIGluTGFuZG1hcmtDb2x1bW4oIHBvc2l0aW9uICkge1xyXG4gICAgY29uc3QgbGFuZG1hcmtzID0gUGxheUFyZWFNYXAuTEFORE1BUktfUkFOR0VTO1xyXG5cclxuICAgIC8vIGxvb3AgdGhyb3VnaCBrZXlzIG1hbnVhbGx5IHRvIHByZXZlbnQgbWFueSBjbG9zdXJlcyBmcm9tIGJlaW5nIGNyZWF0ZWQgZHVyaW5nIG9iamVjdCBpdGVyYXRpb24gaW4gZm9yIGxvb3BzXHJcbiAgICBjb25zdCBsYW5kbWFya0tleXMgPSBPYmplY3Qua2V5cyggbGFuZG1hcmtzICk7XHJcbiAgICBsZXQgaW5MYW5kbWFya0NvbHVtbiA9IGZhbHNlO1xyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgbGFuZG1hcmtLZXlzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBpZiAoIGxhbmRtYXJrc1sgbGFuZG1hcmtLZXlzWyBpIF0gXS5jb250YWlucyggcG9zaXRpb24ueCApICkge1xyXG4gICAgICAgIGluTGFuZG1hcmtDb2x1bW4gPSB0cnVlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGluTGFuZG1hcmtDb2x1bW47XHJcbiAgfVxyXG59O1xyXG5cclxuYmFsbG9vbnNBbmRTdGF0aWNFbGVjdHJpY2l0eS5yZWdpc3RlciggJ1BsYXlBcmVhTWFwJywgUGxheUFyZWFNYXAgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBsYXlBcmVhTWFwOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyw0QkFBNEIsTUFBTSx1Q0FBdUM7O0FBRWhG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