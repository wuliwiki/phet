// Copyright 2015-2022, University of Colorado Boulder

/**
 * Model of a capacitor whose geometry can be directly manipulated by the user.
 *
 * A capacitor consists of 2 parallel, square plates, separated by vacuum.
 * There is no modeling of non-vacuum dielectric materials whatsoever in
 * Capacitor Lab: Basics.
 *
 * The capacitance (C) is solely dependent on its geometry. Charge (Q) on the
 * plates is a function of capacitance and voltage (V) across the plates: Q = CV
 *
 * Variable names used in this implementation where chosen to match the
 * specification in the design document, and therefore violate Java naming
 * conventions.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 * @author Jesse Greenberg (PhET Interactive Simulations)
 * @author Andrew Adare (PhET Interactive Simulations)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Property from '../../../../axon/js/Property.js';
import Bounds3 from '../../../../dot/js/Bounds3.js';
import Vector3 from '../../../../dot/js/Vector3.js';
import merge from '../../../../phet-core/js/merge.js';
import BoxShapeCreator from '../../../../scenery-phet/js/capacitor/BoxShapeCreator.js';
import CapacitorConstants from '../../../../scenery-phet/js/capacitor/CapacitorConstants.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import capacitorLabBasics from '../../capacitorLabBasics.js';
import CLBConstants from '../CLBConstants.js';
import CircuitPosition from './CircuitPosition.js';
import CircuitState from './CircuitState.js';
import CircuitSwitch from './CircuitSwitch.js';
class Capacitor {
  /**
   * @param {CircuitConfig} config
   * @param {Property.<CircuitState>} circuitConnectionProperty
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(config, circuitConnectionProperty, tandem, options) {
    // options that populate the capacitor with various geometric properties
    options = merge({
      plateWidth: CapacitorConstants.PLATE_WIDTH_RANGE.defaultValue,
      plateSeparation: CapacitorConstants.PLATE_SEPARATION_RANGE.defaultValue
    }, options);

    // @public {number}
    this.voltageAtSwitchClose = 0; // voltage of the plates when the bulb switch is initially closed

    // @public {YawPitchModelViewTransform3}
    this.modelViewTransform = config.modelViewTransform;

    // @public {Vector3}
    this.position = new Vector3(CLBConstants.BATTERY_POSITION.x + config.capacitorXSpacing, CLBConstants.BATTERY_POSITION.y + config.capacitorYSpacing, CLBConstants.BATTERY_POSITION.z);

    // @private {BoxShapeCreator}
    this.shapeCreator = new BoxShapeCreator(config.modelViewTransform);

    // Square plates.
    const plateBounds = new Bounds3(0, 0, 0, options.plateWidth, CapacitorConstants.PLATE_HEIGHT, options.plateWidth);

    // @public {Property.<Bounds3>}
    this.plateSizeProperty = new Property(plateBounds, {
      tandem: tandem.createTandem('plateSizeProperty'),
      phetioValueType: Bounds3.Bounds3IO,
      phetioReadOnly: true
    });

    // @public {Property.<number>}
    this.plateSeparationProperty = new NumberProperty(options.plateSeparation, {
      tandem: tandem.createTandem('plateSeparationProperty'),
      units: 'm',
      range: CapacitorConstants.PLATE_SEPARATION_RANGE
    });

    // @public {Property.<number>} - zero until it's connected into a circuit
    this.plateVoltageProperty = new NumberProperty(0, {
      tandem: tandem.createTandem('plateVoltageProperty'),
      units: 'V',
      phetioReadOnly: true
    });

    // @public {Property.<number>}
    this.capacitanceProperty = new DerivedProperty([this.plateSeparationProperty, this.plateSizeProperty], (plateSeparation, plateSize) => {
      assert && assert(plateSeparation > 0, `Plate separation is ${plateSeparation}`);
      return CLBConstants.EPSILON_0 * plateSize.width * plateSize.depth / plateSeparation;
    }, {
      tandem: tandem.createTandem('capacitanceProperty'),
      units: 'F',
      phetioValueType: NumberIO
    });
    this.capacitanceProperty.lazyLink((capacitance, oldCapacitance) => {
      // plateSizeProperty => capacitanceProperty => changes plateVoltageProperty after plateVoltageProperty was set, so
      // since this doesn't apply when we're setting state, we opt out.
      if (circuitConnectionProperty.value === CircuitState.LIGHT_BULB_CONNECTED && !phet.joist.sim.isSettingPhetioStateProperty.value) {
        this.updateDischargeParameters(capacitance, oldCapacitance);
      }
    });

    // @public {Property.<number>} Charge on top plate of capacitor
    this.plateChargeProperty = new DerivedProperty([this.capacitanceProperty, this.plateVoltageProperty, circuitConnectionProperty], (capacitance, voltage, circuitConnection) => {
      const charge = capacitance * voltage;

      // Force an underflow to zero below the threshold for stability
      return circuitConnection ? Math.abs(charge) < CLBConstants.MIN_PLATE_CHARGE ? 0 : charge : 0;
    }, {
      tandem: tandem.createTandem('plateChargeProperty'),
      units: 'C',
      phetioValueType: NumberIO
    });

    // @public {Property.<number>}
    this.storedEnergyProperty = new DerivedProperty([this.capacitanceProperty, this.plateVoltageProperty], (capacitance, voltage) => 0.5 * capacitance * voltage * voltage, {
      tandem: tandem.createTandem('storedEnergyProperty'),
      units: 'J',
      phetioValueType: NumberIO
    });

    // @public {CircuitSwitch}
    this.topCircuitSwitch = CircuitSwitch.TOP(config, circuitConnectionProperty, tandem.createTandem('topCircuitSwitch'));

    // @public {CircuitSwitch}
    this.bottomCircuitSwitch = CircuitSwitch.BOTTOM(config, circuitConnectionProperty, tandem.createTandem('bottomCircuitSwitch'));

    // link the top and bottom circuit switches together so that they rotate together
    // as the user drags

    // JS handles negative numbers precisely so there will not be an infinite
    // loop here due to mutual recursion.
    this.topCircuitSwitch.angleProperty.link(angle => {
      this.bottomCircuitSwitch.angleProperty.set(-angle);
    });
    this.bottomCircuitSwitch.angleProperty.link(angle => {
      this.topCircuitSwitch.angleProperty.set(-angle);
    });
  }

  /**
   * Convenience method, gets the area of one plate's top (or bottom) surfaces.
   * (design doc symbol: A)
   * @public
   *
   * @returns {number} area in meters^2
   */
  getPlateArea() {
    return this.plateSizeProperty.value.width * this.plateSizeProperty.value.depth;
  }

  /**
   * Sets width and depth of square plates. Thickness is constant.
   * (design doc symbol: L)
   * @public
   *
   * @param {number} plateWidth - meters
   */
  setPlateWidth(plateWidth) {
    assert && assert(plateWidth > 0, `plateWidth must be > 0: ${plateWidth}`);
    this.plateSizeProperty.set(new Bounds3(0, 0, 0, plateWidth, this.plateSizeProperty.value.height, plateWidth));
  }

  /**
   * Convenience method for determining the outside center of the top plate.  This is a wire attachment point.
   * @public
   *
   * @returns {Vector3}
   */
  getTopConnectionPoint() {
    return new Vector3(this.position.x, this.position.y - this.plateSeparationProperty.value / 2 - this.plateSizeProperty.value.height, this.position.z);
  }

  /**
   * Convenience method for determining the outside center of the bottom plate.  This is a wire attachment point.
   * @public
   *
   * @returns {Vector3}
   */
  getBottomConnectionPoint() {
    return new Vector3(this.position.x, this.position.y + this.plateSeparationProperty.value / 2 + this.plateSizeProperty.value.height, this.position.z);
  }

  /**
   * Check for intersection between a voltmeter probe and the plate faces at either the top or
   * bottom plate positions, as specified by the position parameter. Assumes that the probe shape
   * is much smaller than the top plate.
   * @public
   *
   * @param {Shape} probe
   * @param {CircuitPosition} position - CircuitPosition.CAPACITOR_TOP or CircuitPosition.CAPACITOR_BOTTOM
   * @returns {boolean}
   */
  contacts(probe, position) {
    assert && assert(position === CircuitPosition.CAPACITOR_TOP || position === CircuitPosition.CAPACITOR_BOTTOM, `Invalid capacitor position: ${position}`);
    let shape;
    const size = this.plateSizeProperty.value;
    if (position === CircuitPosition.CAPACITOR_TOP) {
      shape = this.shapeCreator.createBoxShape(this.position.x, this.getTopConnectionPoint().y, this.position.z, size.width, size.height, size.depth);
    } else if (position === CircuitPosition.CAPACITOR_BOTTOM) {
      shape = this.shapeCreator.createBoxShape(this.position.x, this.position.y + this.plateSeparationProperty.value / 2, this.position.z, size.width, size.height, size.depth);
    }
    let contacts = probe.bounds.intersectsBounds(shape.bounds) && probe.shapeIntersection(shape).getNonoverlappingArea() > 0;
    if (!contacts && position === CircuitPosition.CAPACITOR_TOP) {
      contacts = this.topCircuitSwitch.contacts(probe);
    } else if (!contacts && position === CircuitPosition.CAPACITOR_BOTTOM) {
      contacts = this.bottomCircuitSwitch.contacts(probe);
    }
    return contacts;
  }

  /**
   * Gets the effective (net) field between the plates. This is uniform everywhere between the plates.
   * If the total charge on the plate is less than half that of a single electron, effective field is zero.
   * @public
   *
   * (design doc symbol: E_effective)
   *
   * @returns {number} Volts/meter
   */
  getEffectiveEField() {
    const plateCharge = this.plateChargeProperty.value;
    if (Math.abs(plateCharge) < CLBConstants.MIN_PLATE_CHARGE) {
      return 0;
    } else {
      return this.plateVoltageProperty.value / this.plateSeparationProperty.value;
    }
  }

  /**
   * Discharge the capacitor when it is in parallel with some resistance.  This updates the voltage of the plates
   * assuming the solution
   *
   * Vc = Vo*exp( -t / ( R * C ) )
   *
   * to the differential equation
   *
   * Ic = - R*C * dVc/dt
   *
   * @public
   *
   * @param {number} R
   * @param {number} dt
   */
  discharge(R, dt) {
    this.plateVoltageProperty.value *= Math.exp(-dt / (R * this.capacitanceProperty.value));
  }

  /**
   * It is possible to change the capacitance while the capacitor is discharging.  The parameters
   * for the solution
   *
   * Vc = Vo*exp( -t / ( R * C ) )
   *
   * need to change.
   *
   * Suppose that the capacitor has capacitance C1 with charge Q1 and voltage V1.  The capacitance
   * is instantaneously increased to C2.  The charge will remain Q1, but the voltage will decrease
   * proportionally from V1 to V2, like V2 = V1 / ( C2 / C1 ).  The RC time constant also needs to
   * change since C has been updated.  This assumes that the capacitance changes instantaneously.
   *
   * Therefore, the solution needs to change to
   * Vc = V2 * exp( -t / ( R * C2 ) )
   *
   * @public
   *
   * @param {number} newCapacitance
   * @param {number} oldCapacitance
   */
  updateDischargeParameters(newCapacitance, oldCapacitance) {
    // in the discharge function, C is recalculated every time step, so we only need to adjust Vo.
    const capacitanceRatio = newCapacitance / oldCapacitance;
    this.plateVoltageProperty.value = this.plateVoltageProperty.value / capacitanceRatio;
  }

  // @public
  reset() {
    this.plateSizeProperty.reset();
    this.plateSeparationProperty.reset();
    this.plateVoltageProperty.reset();
  }
}
capacitorLabBasics.register('Capacitor', Capacitor);
export default Capacitor;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJOdW1iZXJQcm9wZXJ0eSIsIlByb3BlcnR5IiwiQm91bmRzMyIsIlZlY3RvcjMiLCJtZXJnZSIsIkJveFNoYXBlQ3JlYXRvciIsIkNhcGFjaXRvckNvbnN0YW50cyIsIk51bWJlcklPIiwiY2FwYWNpdG9yTGFiQmFzaWNzIiwiQ0xCQ29uc3RhbnRzIiwiQ2lyY3VpdFBvc2l0aW9uIiwiQ2lyY3VpdFN0YXRlIiwiQ2lyY3VpdFN3aXRjaCIsIkNhcGFjaXRvciIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwiY2lyY3VpdENvbm5lY3Rpb25Qcm9wZXJ0eSIsInRhbmRlbSIsIm9wdGlvbnMiLCJwbGF0ZVdpZHRoIiwiUExBVEVfV0lEVEhfUkFOR0UiLCJkZWZhdWx0VmFsdWUiLCJwbGF0ZVNlcGFyYXRpb24iLCJQTEFURV9TRVBBUkFUSU9OX1JBTkdFIiwidm9sdGFnZUF0U3dpdGNoQ2xvc2UiLCJtb2RlbFZpZXdUcmFuc2Zvcm0iLCJwb3NpdGlvbiIsIkJBVFRFUllfUE9TSVRJT04iLCJ4IiwiY2FwYWNpdG9yWFNwYWNpbmciLCJ5IiwiY2FwYWNpdG9yWVNwYWNpbmciLCJ6Iiwic2hhcGVDcmVhdG9yIiwicGxhdGVCb3VuZHMiLCJQTEFURV9IRUlHSFQiLCJwbGF0ZVNpemVQcm9wZXJ0eSIsImNyZWF0ZVRhbmRlbSIsInBoZXRpb1ZhbHVlVHlwZSIsIkJvdW5kczNJTyIsInBoZXRpb1JlYWRPbmx5IiwicGxhdGVTZXBhcmF0aW9uUHJvcGVydHkiLCJ1bml0cyIsInJhbmdlIiwicGxhdGVWb2x0YWdlUHJvcGVydHkiLCJjYXBhY2l0YW5jZVByb3BlcnR5IiwicGxhdGVTaXplIiwiYXNzZXJ0IiwiRVBTSUxPTl8wIiwid2lkdGgiLCJkZXB0aCIsImxhenlMaW5rIiwiY2FwYWNpdGFuY2UiLCJvbGRDYXBhY2l0YW5jZSIsInZhbHVlIiwiTElHSFRfQlVMQl9DT05ORUNURUQiLCJwaGV0Iiwiam9pc3QiLCJzaW0iLCJpc1NldHRpbmdQaGV0aW9TdGF0ZVByb3BlcnR5IiwidXBkYXRlRGlzY2hhcmdlUGFyYW1ldGVycyIsInBsYXRlQ2hhcmdlUHJvcGVydHkiLCJ2b2x0YWdlIiwiY2lyY3VpdENvbm5lY3Rpb24iLCJjaGFyZ2UiLCJNYXRoIiwiYWJzIiwiTUlOX1BMQVRFX0NIQVJHRSIsInN0b3JlZEVuZXJneVByb3BlcnR5IiwidG9wQ2lyY3VpdFN3aXRjaCIsIlRPUCIsImJvdHRvbUNpcmN1aXRTd2l0Y2giLCJCT1RUT00iLCJhbmdsZVByb3BlcnR5IiwibGluayIsImFuZ2xlIiwic2V0IiwiZ2V0UGxhdGVBcmVhIiwic2V0UGxhdGVXaWR0aCIsImhlaWdodCIsImdldFRvcENvbm5lY3Rpb25Qb2ludCIsImdldEJvdHRvbUNvbm5lY3Rpb25Qb2ludCIsImNvbnRhY3RzIiwicHJvYmUiLCJDQVBBQ0lUT1JfVE9QIiwiQ0FQQUNJVE9SX0JPVFRPTSIsInNoYXBlIiwic2l6ZSIsImNyZWF0ZUJveFNoYXBlIiwiYm91bmRzIiwiaW50ZXJzZWN0c0JvdW5kcyIsInNoYXBlSW50ZXJzZWN0aW9uIiwiZ2V0Tm9ub3ZlcmxhcHBpbmdBcmVhIiwiZ2V0RWZmZWN0aXZlRUZpZWxkIiwicGxhdGVDaGFyZ2UiLCJkaXNjaGFyZ2UiLCJSIiwiZHQiLCJleHAiLCJuZXdDYXBhY2l0YW5jZSIsImNhcGFjaXRhbmNlUmF0aW8iLCJyZXNldCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQ2FwYWNpdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE1LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIE1vZGVsIG9mIGEgY2FwYWNpdG9yIHdob3NlIGdlb21ldHJ5IGNhbiBiZSBkaXJlY3RseSBtYW5pcHVsYXRlZCBieSB0aGUgdXNlci5cclxuICpcclxuICogQSBjYXBhY2l0b3IgY29uc2lzdHMgb2YgMiBwYXJhbGxlbCwgc3F1YXJlIHBsYXRlcywgc2VwYXJhdGVkIGJ5IHZhY3V1bS5cclxuICogVGhlcmUgaXMgbm8gbW9kZWxpbmcgb2Ygbm9uLXZhY3V1bSBkaWVsZWN0cmljIG1hdGVyaWFscyB3aGF0c29ldmVyIGluXHJcbiAqIENhcGFjaXRvciBMYWI6IEJhc2ljcy5cclxuICpcclxuICogVGhlIGNhcGFjaXRhbmNlIChDKSBpcyBzb2xlbHkgZGVwZW5kZW50IG9uIGl0cyBnZW9tZXRyeS4gQ2hhcmdlIChRKSBvbiB0aGVcclxuICogcGxhdGVzIGlzIGEgZnVuY3Rpb24gb2YgY2FwYWNpdGFuY2UgYW5kIHZvbHRhZ2UgKFYpIGFjcm9zcyB0aGUgcGxhdGVzOiBRID0gQ1ZcclxuICpcclxuICogVmFyaWFibGUgbmFtZXMgdXNlZCBpbiB0aGlzIGltcGxlbWVudGF0aW9uIHdoZXJlIGNob3NlbiB0byBtYXRjaCB0aGVcclxuICogc3BlY2lmaWNhdGlvbiBpbiB0aGUgZGVzaWduIGRvY3VtZW50LCBhbmQgdGhlcmVmb3JlIHZpb2xhdGUgSmF2YSBuYW1pbmdcclxuICogY29udmVudGlvbnMuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIEFuZHJldyBBZGFyZSAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBCb3VuZHMzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9Cb3VuZHMzLmpzJztcclxuaW1wb3J0IFZlY3RvcjMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjMuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IEJveFNoYXBlQ3JlYXRvciBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvY2FwYWNpdG9yL0JveFNoYXBlQ3JlYXRvci5qcyc7XHJcbmltcG9ydCBDYXBhY2l0b3JDb25zdGFudHMgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL2NhcGFjaXRvci9DYXBhY2l0b3JDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgTnVtYmVySU8gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL3R5cGVzL051bWJlcklPLmpzJztcclxuaW1wb3J0IGNhcGFjaXRvckxhYkJhc2ljcyBmcm9tICcuLi8uLi9jYXBhY2l0b3JMYWJCYXNpY3MuanMnO1xyXG5pbXBvcnQgQ0xCQ29uc3RhbnRzIGZyb20gJy4uL0NMQkNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBDaXJjdWl0UG9zaXRpb24gZnJvbSAnLi9DaXJjdWl0UG9zaXRpb24uanMnO1xyXG5pbXBvcnQgQ2lyY3VpdFN0YXRlIGZyb20gJy4vQ2lyY3VpdFN0YXRlLmpzJztcclxuaW1wb3J0IENpcmN1aXRTd2l0Y2ggZnJvbSAnLi9DaXJjdWl0U3dpdGNoLmpzJztcclxuXHJcbmNsYXNzIENhcGFjaXRvciB7XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtDaXJjdWl0Q29uZmlnfSBjb25maWdcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5LjxDaXJjdWl0U3RhdGU+fSBjaXJjdWl0Q29ubmVjdGlvblByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtUYW5kZW19IHRhbmRlbVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggY29uZmlnLCBjaXJjdWl0Q29ubmVjdGlvblByb3BlcnR5LCB0YW5kZW0sIG9wdGlvbnMgKSB7XHJcblxyXG4gICAgLy8gb3B0aW9ucyB0aGF0IHBvcHVsYXRlIHRoZSBjYXBhY2l0b3Igd2l0aCB2YXJpb3VzIGdlb21ldHJpYyBwcm9wZXJ0aWVzXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgcGxhdGVXaWR0aDogQ2FwYWNpdG9yQ29uc3RhbnRzLlBMQVRFX1dJRFRIX1JBTkdFLmRlZmF1bHRWYWx1ZSxcclxuICAgICAgcGxhdGVTZXBhcmF0aW9uOiBDYXBhY2l0b3JDb25zdGFudHMuUExBVEVfU0VQQVJBVElPTl9SQU5HRS5kZWZhdWx0VmFsdWVcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtudW1iZXJ9XHJcbiAgICB0aGlzLnZvbHRhZ2VBdFN3aXRjaENsb3NlID0gMDsgLy8gdm9sdGFnZSBvZiB0aGUgcGxhdGVzIHdoZW4gdGhlIGJ1bGIgc3dpdGNoIGlzIGluaXRpYWxseSBjbG9zZWRcclxuXHJcbiAgICAvLyBAcHVibGljIHtZYXdQaXRjaE1vZGVsVmlld1RyYW5zZm9ybTN9XHJcbiAgICB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybSA9IGNvbmZpZy5tb2RlbFZpZXdUcmFuc2Zvcm07XHJcblxyXG4gICAgLy8gQHB1YmxpYyB7VmVjdG9yM31cclxuICAgIHRoaXMucG9zaXRpb24gPSBuZXcgVmVjdG9yMyhcclxuICAgICAgQ0xCQ29uc3RhbnRzLkJBVFRFUllfUE9TSVRJT04ueCArIGNvbmZpZy5jYXBhY2l0b3JYU3BhY2luZyxcclxuICAgICAgQ0xCQ29uc3RhbnRzLkJBVFRFUllfUE9TSVRJT04ueSArIGNvbmZpZy5jYXBhY2l0b3JZU3BhY2luZyxcclxuICAgICAgQ0xCQ29uc3RhbnRzLkJBVFRFUllfUE9TSVRJT04ueiApO1xyXG5cclxuICAgIC8vIEBwcml2YXRlIHtCb3hTaGFwZUNyZWF0b3J9XHJcbiAgICB0aGlzLnNoYXBlQ3JlYXRvciA9IG5ldyBCb3hTaGFwZUNyZWF0b3IoIGNvbmZpZy5tb2RlbFZpZXdUcmFuc2Zvcm0gKTtcclxuXHJcbiAgICAvLyBTcXVhcmUgcGxhdGVzLlxyXG4gICAgY29uc3QgcGxhdGVCb3VuZHMgPSBuZXcgQm91bmRzMyggMCwgMCwgMCwgb3B0aW9ucy5wbGF0ZVdpZHRoLCBDYXBhY2l0b3JDb25zdGFudHMuUExBVEVfSEVJR0hULCBvcHRpb25zLnBsYXRlV2lkdGggKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtQcm9wZXJ0eS48Qm91bmRzMz59XHJcbiAgICB0aGlzLnBsYXRlU2l6ZVByb3BlcnR5ID0gbmV3IFByb3BlcnR5KCBwbGF0ZUJvdW5kcywge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdwbGF0ZVNpemVQcm9wZXJ0eScgKSxcclxuICAgICAgcGhldGlvVmFsdWVUeXBlOiBCb3VuZHMzLkJvdW5kczNJTyxcclxuICAgICAgcGhldGlvUmVhZE9ubHk6IHRydWVcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtQcm9wZXJ0eS48bnVtYmVyPn1cclxuICAgIHRoaXMucGxhdGVTZXBhcmF0aW9uUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIG9wdGlvbnMucGxhdGVTZXBhcmF0aW9uLCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3BsYXRlU2VwYXJhdGlvblByb3BlcnR5JyApLFxyXG4gICAgICB1bml0czogJ20nLFxyXG4gICAgICByYW5nZTogQ2FwYWNpdG9yQ29uc3RhbnRzLlBMQVRFX1NFUEFSQVRJT05fUkFOR0VcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtQcm9wZXJ0eS48bnVtYmVyPn0gLSB6ZXJvIHVudGlsIGl0J3MgY29ubmVjdGVkIGludG8gYSBjaXJjdWl0XHJcbiAgICB0aGlzLnBsYXRlVm9sdGFnZVByb3BlcnR5ID0gbmV3IE51bWJlclByb3BlcnR5KCAwLCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3BsYXRlVm9sdGFnZVByb3BlcnR5JyApLFxyXG4gICAgICB1bml0czogJ1YnLFxyXG4gICAgICBwaGV0aW9SZWFkT25seTogdHJ1ZVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMge1Byb3BlcnR5LjxudW1iZXI+fVxyXG4gICAgdGhpcy5jYXBhY2l0YW5jZVByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyB0aGlzLnBsYXRlU2VwYXJhdGlvblByb3BlcnR5LCB0aGlzLnBsYXRlU2l6ZVByb3BlcnR5IF0sXHJcbiAgICAgICggcGxhdGVTZXBhcmF0aW9uLCBwbGF0ZVNpemUgKSA9PiB7XHJcbiAgICAgICAgYXNzZXJ0ICYmIGFzc2VydCggcGxhdGVTZXBhcmF0aW9uID4gMCwgYFBsYXRlIHNlcGFyYXRpb24gaXMgJHtwbGF0ZVNlcGFyYXRpb259YCApO1xyXG4gICAgICAgIHJldHVybiBDTEJDb25zdGFudHMuRVBTSUxPTl8wICogcGxhdGVTaXplLndpZHRoICogcGxhdGVTaXplLmRlcHRoIC8gcGxhdGVTZXBhcmF0aW9uO1xyXG4gICAgICB9LCB7XHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnY2FwYWNpdGFuY2VQcm9wZXJ0eScgKSxcclxuICAgICAgICB1bml0czogJ0YnLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVtYmVySU9cclxuICAgICAgfSApO1xyXG5cclxuICAgIHRoaXMuY2FwYWNpdGFuY2VQcm9wZXJ0eS5sYXp5TGluayggKCBjYXBhY2l0YW5jZSwgb2xkQ2FwYWNpdGFuY2UgKSA9PiB7XHJcbiAgICAgIC8vIHBsYXRlU2l6ZVByb3BlcnR5ID0+IGNhcGFjaXRhbmNlUHJvcGVydHkgPT4gY2hhbmdlcyBwbGF0ZVZvbHRhZ2VQcm9wZXJ0eSBhZnRlciBwbGF0ZVZvbHRhZ2VQcm9wZXJ0eSB3YXMgc2V0LCBzb1xyXG4gICAgICAvLyBzaW5jZSB0aGlzIGRvZXNuJ3QgYXBwbHkgd2hlbiB3ZSdyZSBzZXR0aW5nIHN0YXRlLCB3ZSBvcHQgb3V0LlxyXG4gICAgICBpZiAoIGNpcmN1aXRDb25uZWN0aW9uUHJvcGVydHkudmFsdWUgPT09IENpcmN1aXRTdGF0ZS5MSUdIVF9CVUxCX0NPTk5FQ1RFRCAmJiAhcGhldC5qb2lzdC5zaW0uaXNTZXR0aW5nUGhldGlvU3RhdGVQcm9wZXJ0eS52YWx1ZSApIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZURpc2NoYXJnZVBhcmFtZXRlcnMoIGNhcGFjaXRhbmNlLCBvbGRDYXBhY2l0YW5jZSApO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyB7UHJvcGVydHkuPG51bWJlcj59IENoYXJnZSBvbiB0b3AgcGxhdGUgb2YgY2FwYWNpdG9yXHJcbiAgICB0aGlzLnBsYXRlQ2hhcmdlUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHRoaXMuY2FwYWNpdGFuY2VQcm9wZXJ0eSwgdGhpcy5wbGF0ZVZvbHRhZ2VQcm9wZXJ0eSwgY2lyY3VpdENvbm5lY3Rpb25Qcm9wZXJ0eSBdLFxyXG4gICAgICAoIGNhcGFjaXRhbmNlLCB2b2x0YWdlLCBjaXJjdWl0Q29ubmVjdGlvbiApID0+IHtcclxuICAgICAgICBjb25zdCBjaGFyZ2UgPSBjYXBhY2l0YW5jZSAqIHZvbHRhZ2U7XHJcblxyXG4gICAgICAgIC8vIEZvcmNlIGFuIHVuZGVyZmxvdyB0byB6ZXJvIGJlbG93IHRoZSB0aHJlc2hvbGQgZm9yIHN0YWJpbGl0eVxyXG4gICAgICAgIHJldHVybiBjaXJjdWl0Q29ubmVjdGlvbiA/ICggTWF0aC5hYnMoIGNoYXJnZSApIDwgQ0xCQ29uc3RhbnRzLk1JTl9QTEFURV9DSEFSR0UgPyAwIDogY2hhcmdlICkgOiAwO1xyXG4gICAgICB9LCB7XHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAncGxhdGVDaGFyZ2VQcm9wZXJ0eScgKSxcclxuICAgICAgICB1bml0czogJ0MnLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVtYmVySU9cclxuICAgICAgfSApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMge1Byb3BlcnR5LjxudW1iZXI+fVxyXG4gICAgdGhpcy5zdG9yZWRFbmVyZ3lQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgdGhpcy5jYXBhY2l0YW5jZVByb3BlcnR5LCB0aGlzLnBsYXRlVm9sdGFnZVByb3BlcnR5IF0sXHJcbiAgICAgICggY2FwYWNpdGFuY2UsIHZvbHRhZ2UgKSA9PiAwLjUgKiBjYXBhY2l0YW5jZSAqIHZvbHRhZ2UgKiB2b2x0YWdlLCB7XHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnc3RvcmVkRW5lcmd5UHJvcGVydHknICksXHJcbiAgICAgICAgdW5pdHM6ICdKJyxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bWJlcklPXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtDaXJjdWl0U3dpdGNofVxyXG4gICAgdGhpcy50b3BDaXJjdWl0U3dpdGNoID0gQ2lyY3VpdFN3aXRjaC5UT1AoIGNvbmZpZywgY2lyY3VpdENvbm5lY3Rpb25Qcm9wZXJ0eSxcclxuICAgICAgdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3RvcENpcmN1aXRTd2l0Y2gnICkgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtDaXJjdWl0U3dpdGNofVxyXG4gICAgdGhpcy5ib3R0b21DaXJjdWl0U3dpdGNoID0gQ2lyY3VpdFN3aXRjaC5CT1RUT00oIGNvbmZpZywgY2lyY3VpdENvbm5lY3Rpb25Qcm9wZXJ0eSxcclxuICAgICAgdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2JvdHRvbUNpcmN1aXRTd2l0Y2gnICkgKTtcclxuXHJcbiAgICAvLyBsaW5rIHRoZSB0b3AgYW5kIGJvdHRvbSBjaXJjdWl0IHN3aXRjaGVzIHRvZ2V0aGVyIHNvIHRoYXQgdGhleSByb3RhdGUgdG9nZXRoZXJcclxuICAgIC8vIGFzIHRoZSB1c2VyIGRyYWdzXHJcblxyXG4gICAgLy8gSlMgaGFuZGxlcyBuZWdhdGl2ZSBudW1iZXJzIHByZWNpc2VseSBzbyB0aGVyZSB3aWxsIG5vdCBiZSBhbiBpbmZpbml0ZVxyXG4gICAgLy8gbG9vcCBoZXJlIGR1ZSB0byBtdXR1YWwgcmVjdXJzaW9uLlxyXG4gICAgdGhpcy50b3BDaXJjdWl0U3dpdGNoLmFuZ2xlUHJvcGVydHkubGluayggYW5nbGUgPT4ge1xyXG4gICAgICB0aGlzLmJvdHRvbUNpcmN1aXRTd2l0Y2guYW5nbGVQcm9wZXJ0eS5zZXQoIC1hbmdsZSApO1xyXG4gICAgfSApO1xyXG4gICAgdGhpcy5ib3R0b21DaXJjdWl0U3dpdGNoLmFuZ2xlUHJvcGVydHkubGluayggYW5nbGUgPT4ge1xyXG4gICAgICB0aGlzLnRvcENpcmN1aXRTd2l0Y2guYW5nbGVQcm9wZXJ0eS5zZXQoIC1hbmdsZSApO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIENvbnZlbmllbmNlIG1ldGhvZCwgZ2V0cyB0aGUgYXJlYSBvZiBvbmUgcGxhdGUncyB0b3AgKG9yIGJvdHRvbSkgc3VyZmFjZXMuXHJcbiAgICogKGRlc2lnbiBkb2Mgc3ltYm9sOiBBKVxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9IGFyZWEgaW4gbWV0ZXJzXjJcclxuICAgKi9cclxuICBnZXRQbGF0ZUFyZWEoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wbGF0ZVNpemVQcm9wZXJ0eS52YWx1ZS53aWR0aCAqIHRoaXMucGxhdGVTaXplUHJvcGVydHkudmFsdWUuZGVwdGg7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXRzIHdpZHRoIGFuZCBkZXB0aCBvZiBzcXVhcmUgcGxhdGVzLiBUaGlja25lc3MgaXMgY29uc3RhbnQuXHJcbiAgICogKGRlc2lnbiBkb2Mgc3ltYm9sOiBMKVxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBwbGF0ZVdpZHRoIC0gbWV0ZXJzXHJcbiAgICovXHJcbiAgc2V0UGxhdGVXaWR0aCggcGxhdGVXaWR0aCApIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHBsYXRlV2lkdGggPiAwLCBgcGxhdGVXaWR0aCBtdXN0IGJlID4gMDogJHtwbGF0ZVdpZHRofWAgKTtcclxuICAgIHRoaXMucGxhdGVTaXplUHJvcGVydHkuc2V0KCBuZXcgQm91bmRzMyggMCwgMCwgMCwgcGxhdGVXaWR0aCwgdGhpcy5wbGF0ZVNpemVQcm9wZXJ0eS52YWx1ZS5oZWlnaHQsIHBsYXRlV2lkdGggKSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ29udmVuaWVuY2UgbWV0aG9kIGZvciBkZXRlcm1pbmluZyB0aGUgb3V0c2lkZSBjZW50ZXIgb2YgdGhlIHRvcCBwbGF0ZS4gIFRoaXMgaXMgYSB3aXJlIGF0dGFjaG1lbnQgcG9pbnQuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHJldHVybnMge1ZlY3RvcjN9XHJcbiAgICovXHJcbiAgZ2V0VG9wQ29ubmVjdGlvblBvaW50KCkge1xyXG4gICAgcmV0dXJuIG5ldyBWZWN0b3IzKFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLngsXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSAtICggdGhpcy5wbGF0ZVNlcGFyYXRpb25Qcm9wZXJ0eS52YWx1ZSAvIDIgKSAtIHRoaXMucGxhdGVTaXplUHJvcGVydHkudmFsdWUuaGVpZ2h0LFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLnogKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENvbnZlbmllbmNlIG1ldGhvZCBmb3IgZGV0ZXJtaW5pbmcgdGhlIG91dHNpZGUgY2VudGVyIG9mIHRoZSBib3R0b20gcGxhdGUuICBUaGlzIGlzIGEgd2lyZSBhdHRhY2htZW50IHBvaW50LlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEByZXR1cm5zIHtWZWN0b3IzfVxyXG4gICAqL1xyXG4gIGdldEJvdHRvbUNvbm5lY3Rpb25Qb2ludCgpIHtcclxuICAgIHJldHVybiBuZXcgVmVjdG9yMyhcclxuICAgICAgdGhpcy5wb3NpdGlvbi54LFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLnkgKyAoIHRoaXMucGxhdGVTZXBhcmF0aW9uUHJvcGVydHkudmFsdWUgLyAyICkgKyB0aGlzLnBsYXRlU2l6ZVByb3BlcnR5LnZhbHVlLmhlaWdodCxcclxuICAgICAgdGhpcy5wb3NpdGlvbi56ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBmb3IgaW50ZXJzZWN0aW9uIGJldHdlZW4gYSB2b2x0bWV0ZXIgcHJvYmUgYW5kIHRoZSBwbGF0ZSBmYWNlcyBhdCBlaXRoZXIgdGhlIHRvcCBvclxyXG4gICAqIGJvdHRvbSBwbGF0ZSBwb3NpdGlvbnMsIGFzIHNwZWNpZmllZCBieSB0aGUgcG9zaXRpb24gcGFyYW1ldGVyLiBBc3N1bWVzIHRoYXQgdGhlIHByb2JlIHNoYXBlXHJcbiAgICogaXMgbXVjaCBzbWFsbGVyIHRoYW4gdGhlIHRvcCBwbGF0ZS5cclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge1NoYXBlfSBwcm9iZVxyXG4gICAqIEBwYXJhbSB7Q2lyY3VpdFBvc2l0aW9ufSBwb3NpdGlvbiAtIENpcmN1aXRQb3NpdGlvbi5DQVBBQ0lUT1JfVE9QIG9yIENpcmN1aXRQb3NpdGlvbi5DQVBBQ0lUT1JfQk9UVE9NXHJcbiAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICovXHJcbiAgY29udGFjdHMoIHByb2JlLCBwb3NpdGlvbiApIHtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBwb3NpdGlvbiA9PT0gQ2lyY3VpdFBvc2l0aW9uLkNBUEFDSVRPUl9UT1AgfHwgcG9zaXRpb24gPT09IENpcmN1aXRQb3NpdGlvbi5DQVBBQ0lUT1JfQk9UVE9NLFxyXG4gICAgICBgSW52YWxpZCBjYXBhY2l0b3IgcG9zaXRpb246ICR7cG9zaXRpb259YCApO1xyXG5cclxuICAgIGxldCBzaGFwZTtcclxuICAgIGNvbnN0IHNpemUgPSB0aGlzLnBsYXRlU2l6ZVByb3BlcnR5LnZhbHVlO1xyXG4gICAgaWYgKCBwb3NpdGlvbiA9PT0gQ2lyY3VpdFBvc2l0aW9uLkNBUEFDSVRPUl9UT1AgKSB7XHJcbiAgICAgIHNoYXBlID0gdGhpcy5zaGFwZUNyZWF0b3IuY3JlYXRlQm94U2hhcGUoIHRoaXMucG9zaXRpb24ueCwgdGhpcy5nZXRUb3BDb25uZWN0aW9uUG9pbnQoKS55LCB0aGlzLnBvc2l0aW9uLnosIHNpemUud2lkdGgsIHNpemUuaGVpZ2h0LCBzaXplLmRlcHRoICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggcG9zaXRpb24gPT09IENpcmN1aXRQb3NpdGlvbi5DQVBBQ0lUT1JfQk9UVE9NICkge1xyXG4gICAgICBzaGFwZSA9IHRoaXMuc2hhcGVDcmVhdG9yLmNyZWF0ZUJveFNoYXBlKCB0aGlzLnBvc2l0aW9uLngsIHRoaXMucG9zaXRpb24ueSArIHRoaXMucGxhdGVTZXBhcmF0aW9uUHJvcGVydHkudmFsdWUgLyAyLCB0aGlzLnBvc2l0aW9uLnosIHNpemUud2lkdGgsIHNpemUuaGVpZ2h0LCBzaXplLmRlcHRoICk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGNvbnRhY3RzID0gcHJvYmUuYm91bmRzLmludGVyc2VjdHNCb3VuZHMoIHNoYXBlLmJvdW5kcyApICYmXHJcbiAgICAgICAgICAgICAgICAgICBwcm9iZS5zaGFwZUludGVyc2VjdGlvbiggc2hhcGUgKS5nZXROb25vdmVybGFwcGluZ0FyZWEoKSA+IDA7XHJcblxyXG4gICAgaWYgKCAhY29udGFjdHMgJiYgcG9zaXRpb24gPT09IENpcmN1aXRQb3NpdGlvbi5DQVBBQ0lUT1JfVE9QICkge1xyXG4gICAgICBjb250YWN0cyA9IHRoaXMudG9wQ2lyY3VpdFN3aXRjaC5jb250YWN0cyggcHJvYmUgKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCAhY29udGFjdHMgJiYgcG9zaXRpb24gPT09IENpcmN1aXRQb3NpdGlvbi5DQVBBQ0lUT1JfQk9UVE9NICkge1xyXG4gICAgICBjb250YWN0cyA9IHRoaXMuYm90dG9tQ2lyY3VpdFN3aXRjaC5jb250YWN0cyggcHJvYmUgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gY29udGFjdHM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXRzIHRoZSBlZmZlY3RpdmUgKG5ldCkgZmllbGQgYmV0d2VlbiB0aGUgcGxhdGVzLiBUaGlzIGlzIHVuaWZvcm0gZXZlcnl3aGVyZSBiZXR3ZWVuIHRoZSBwbGF0ZXMuXHJcbiAgICogSWYgdGhlIHRvdGFsIGNoYXJnZSBvbiB0aGUgcGxhdGUgaXMgbGVzcyB0aGFuIGhhbGYgdGhhdCBvZiBhIHNpbmdsZSBlbGVjdHJvbiwgZWZmZWN0aXZlIGZpZWxkIGlzIHplcm8uXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogKGRlc2lnbiBkb2Mgc3ltYm9sOiBFX2VmZmVjdGl2ZSlcclxuICAgKlxyXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9IFZvbHRzL21ldGVyXHJcbiAgICovXHJcbiAgZ2V0RWZmZWN0aXZlRUZpZWxkKCkge1xyXG4gICAgY29uc3QgcGxhdGVDaGFyZ2UgPSB0aGlzLnBsYXRlQ2hhcmdlUHJvcGVydHkudmFsdWU7XHJcbiAgICBpZiAoIE1hdGguYWJzKCBwbGF0ZUNoYXJnZSApIDwgQ0xCQ29uc3RhbnRzLk1JTl9QTEFURV9DSEFSR0UgKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnBsYXRlVm9sdGFnZVByb3BlcnR5LnZhbHVlIC8gdGhpcy5wbGF0ZVNlcGFyYXRpb25Qcm9wZXJ0eS52YWx1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERpc2NoYXJnZSB0aGUgY2FwYWNpdG9yIHdoZW4gaXQgaXMgaW4gcGFyYWxsZWwgd2l0aCBzb21lIHJlc2lzdGFuY2UuICBUaGlzIHVwZGF0ZXMgdGhlIHZvbHRhZ2Ugb2YgdGhlIHBsYXRlc1xyXG4gICAqIGFzc3VtaW5nIHRoZSBzb2x1dGlvblxyXG4gICAqXHJcbiAgICogVmMgPSBWbypleHAoIC10IC8gKCBSICogQyApIClcclxuICAgKlxyXG4gICAqIHRvIHRoZSBkaWZmZXJlbnRpYWwgZXF1YXRpb25cclxuICAgKlxyXG4gICAqIEljID0gLSBSKkMgKiBkVmMvZHRcclxuICAgKlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBSXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGR0XHJcbiAgICovXHJcbiAgZGlzY2hhcmdlKCBSLCBkdCApIHtcclxuICAgIHRoaXMucGxhdGVWb2x0YWdlUHJvcGVydHkudmFsdWUgKj0gTWF0aC5leHAoIC1kdCAvICggUiAqIHRoaXMuY2FwYWNpdGFuY2VQcm9wZXJ0eS52YWx1ZSApICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJdCBpcyBwb3NzaWJsZSB0byBjaGFuZ2UgdGhlIGNhcGFjaXRhbmNlIHdoaWxlIHRoZSBjYXBhY2l0b3IgaXMgZGlzY2hhcmdpbmcuICBUaGUgcGFyYW1ldGVyc1xyXG4gICAqIGZvciB0aGUgc29sdXRpb25cclxuICAgKlxyXG4gICAqIFZjID0gVm8qZXhwKCAtdCAvICggUiAqIEMgKSApXHJcbiAgICpcclxuICAgKiBuZWVkIHRvIGNoYW5nZS5cclxuICAgKlxyXG4gICAqIFN1cHBvc2UgdGhhdCB0aGUgY2FwYWNpdG9yIGhhcyBjYXBhY2l0YW5jZSBDMSB3aXRoIGNoYXJnZSBRMSBhbmQgdm9sdGFnZSBWMS4gIFRoZSBjYXBhY2l0YW5jZVxyXG4gICAqIGlzIGluc3RhbnRhbmVvdXNseSBpbmNyZWFzZWQgdG8gQzIuICBUaGUgY2hhcmdlIHdpbGwgcmVtYWluIFExLCBidXQgdGhlIHZvbHRhZ2Ugd2lsbCBkZWNyZWFzZVxyXG4gICAqIHByb3BvcnRpb25hbGx5IGZyb20gVjEgdG8gVjIsIGxpa2UgVjIgPSBWMSAvICggQzIgLyBDMSApLiAgVGhlIFJDIHRpbWUgY29uc3RhbnQgYWxzbyBuZWVkcyB0b1xyXG4gICAqIGNoYW5nZSBzaW5jZSBDIGhhcyBiZWVuIHVwZGF0ZWQuICBUaGlzIGFzc3VtZXMgdGhhdCB0aGUgY2FwYWNpdGFuY2UgY2hhbmdlcyBpbnN0YW50YW5lb3VzbHkuXHJcbiAgICpcclxuICAgKiBUaGVyZWZvcmUsIHRoZSBzb2x1dGlvbiBuZWVkcyB0byBjaGFuZ2UgdG9cclxuICAgKiBWYyA9IFYyICogZXhwKCAtdCAvICggUiAqIEMyICkgKVxyXG4gICAqXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IG5ld0NhcGFjaXRhbmNlXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9sZENhcGFjaXRhbmNlXHJcbiAgICovXHJcbiAgdXBkYXRlRGlzY2hhcmdlUGFyYW1ldGVycyggbmV3Q2FwYWNpdGFuY2UsIG9sZENhcGFjaXRhbmNlICkge1xyXG5cclxuICAgIC8vIGluIHRoZSBkaXNjaGFyZ2UgZnVuY3Rpb24sIEMgaXMgcmVjYWxjdWxhdGVkIGV2ZXJ5IHRpbWUgc3RlcCwgc28gd2Ugb25seSBuZWVkIHRvIGFkanVzdCBWby5cclxuICAgIGNvbnN0IGNhcGFjaXRhbmNlUmF0aW8gPSBuZXdDYXBhY2l0YW5jZSAvIG9sZENhcGFjaXRhbmNlO1xyXG5cclxuICAgIHRoaXMucGxhdGVWb2x0YWdlUHJvcGVydHkudmFsdWUgPSB0aGlzLnBsYXRlVm9sdGFnZVByb3BlcnR5LnZhbHVlIC8gY2FwYWNpdGFuY2VSYXRpbztcclxuICB9XHJcblxyXG4gIC8vIEBwdWJsaWNcclxuICByZXNldCgpIHtcclxuICAgIHRoaXMucGxhdGVTaXplUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMucGxhdGVTZXBhcmF0aW9uUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMucGxhdGVWb2x0YWdlUHJvcGVydHkucmVzZXQoKTtcclxuICB9XHJcbn1cclxuXHJcbmNhcGFjaXRvckxhYkJhc2ljcy5yZWdpc3RlciggJ0NhcGFjaXRvcicsIENhcGFjaXRvciApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2FwYWNpdG9yOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsY0FBYyxNQUFNLHVDQUF1QztBQUNsRSxPQUFPQyxRQUFRLE1BQU0saUNBQWlDO0FBQ3RELE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxLQUFLLE1BQU0sbUNBQW1DO0FBQ3JELE9BQU9DLGVBQWUsTUFBTSwwREFBMEQ7QUFDdEYsT0FBT0Msa0JBQWtCLE1BQU0sNkRBQTZEO0FBQzVGLE9BQU9DLFFBQVEsTUFBTSx5Q0FBeUM7QUFDOUQsT0FBT0Msa0JBQWtCLE1BQU0sNkJBQTZCO0FBQzVELE9BQU9DLFlBQVksTUFBTSxvQkFBb0I7QUFDN0MsT0FBT0MsZUFBZSxNQUFNLHNCQUFzQjtBQUNsRCxPQUFPQyxZQUFZLE1BQU0sbUJBQW1CO0FBQzVDLE9BQU9DLGFBQWEsTUFBTSxvQkFBb0I7QUFFOUMsTUFBTUMsU0FBUyxDQUFDO0VBQ2Q7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0VDLFdBQVdBLENBQUVDLE1BQU0sRUFBRUMseUJBQXlCLEVBQUVDLE1BQU0sRUFBRUMsT0FBTyxFQUFHO0lBRWhFO0lBQ0FBLE9BQU8sR0FBR2QsS0FBSyxDQUFFO01BQ2ZlLFVBQVUsRUFBRWIsa0JBQWtCLENBQUNjLGlCQUFpQixDQUFDQyxZQUFZO01BQzdEQyxlQUFlLEVBQUVoQixrQkFBa0IsQ0FBQ2lCLHNCQUFzQixDQUFDRjtJQUM3RCxDQUFDLEVBQUVILE9BQVEsQ0FBQzs7SUFFWjtJQUNBLElBQUksQ0FBQ00sb0JBQW9CLEdBQUcsQ0FBQyxDQUFDLENBQUM7O0lBRS9CO0lBQ0EsSUFBSSxDQUFDQyxrQkFBa0IsR0FBR1YsTUFBTSxDQUFDVSxrQkFBa0I7O0lBRW5EO0lBQ0EsSUFBSSxDQUFDQyxRQUFRLEdBQUcsSUFBSXZCLE9BQU8sQ0FDekJNLFlBQVksQ0FBQ2tCLGdCQUFnQixDQUFDQyxDQUFDLEdBQUdiLE1BQU0sQ0FBQ2MsaUJBQWlCLEVBQzFEcEIsWUFBWSxDQUFDa0IsZ0JBQWdCLENBQUNHLENBQUMsR0FBR2YsTUFBTSxDQUFDZ0IsaUJBQWlCLEVBQzFEdEIsWUFBWSxDQUFDa0IsZ0JBQWdCLENBQUNLLENBQUUsQ0FBQzs7SUFFbkM7SUFDQSxJQUFJLENBQUNDLFlBQVksR0FBRyxJQUFJNUIsZUFBZSxDQUFFVSxNQUFNLENBQUNVLGtCQUFtQixDQUFDOztJQUVwRTtJQUNBLE1BQU1TLFdBQVcsR0FBRyxJQUFJaEMsT0FBTyxDQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFZ0IsT0FBTyxDQUFDQyxVQUFVLEVBQUViLGtCQUFrQixDQUFDNkIsWUFBWSxFQUFFakIsT0FBTyxDQUFDQyxVQUFXLENBQUM7O0lBRW5IO0lBQ0EsSUFBSSxDQUFDaUIsaUJBQWlCLEdBQUcsSUFBSW5DLFFBQVEsQ0FBRWlDLFdBQVcsRUFBRTtNQUNsRGpCLE1BQU0sRUFBRUEsTUFBTSxDQUFDb0IsWUFBWSxDQUFFLG1CQUFvQixDQUFDO01BQ2xEQyxlQUFlLEVBQUVwQyxPQUFPLENBQUNxQyxTQUFTO01BQ2xDQyxjQUFjLEVBQUU7SUFDbEIsQ0FBRSxDQUFDOztJQUVIO0lBQ0EsSUFBSSxDQUFDQyx1QkFBdUIsR0FBRyxJQUFJekMsY0FBYyxDQUFFa0IsT0FBTyxDQUFDSSxlQUFlLEVBQUU7TUFDMUVMLE1BQU0sRUFBRUEsTUFBTSxDQUFDb0IsWUFBWSxDQUFFLHlCQUEwQixDQUFDO01BQ3hESyxLQUFLLEVBQUUsR0FBRztNQUNWQyxLQUFLLEVBQUVyQyxrQkFBa0IsQ0FBQ2lCO0lBQzVCLENBQUUsQ0FBQzs7SUFFSDtJQUNBLElBQUksQ0FBQ3FCLG9CQUFvQixHQUFHLElBQUk1QyxjQUFjLENBQUUsQ0FBQyxFQUFFO01BQ2pEaUIsTUFBTSxFQUFFQSxNQUFNLENBQUNvQixZQUFZLENBQUUsc0JBQXVCLENBQUM7TUFDckRLLEtBQUssRUFBRSxHQUFHO01BQ1ZGLGNBQWMsRUFBRTtJQUNsQixDQUFFLENBQUM7O0lBRUg7SUFDQSxJQUFJLENBQUNLLG1CQUFtQixHQUFHLElBQUk5QyxlQUFlLENBQUUsQ0FBRSxJQUFJLENBQUMwQyx1QkFBdUIsRUFBRSxJQUFJLENBQUNMLGlCQUFpQixDQUFFLEVBQ3RHLENBQUVkLGVBQWUsRUFBRXdCLFNBQVMsS0FBTTtNQUNoQ0MsTUFBTSxJQUFJQSxNQUFNLENBQUV6QixlQUFlLEdBQUcsQ0FBQyxFQUFHLHVCQUFzQkEsZUFBZ0IsRUFBRSxDQUFDO01BQ2pGLE9BQU9iLFlBQVksQ0FBQ3VDLFNBQVMsR0FBR0YsU0FBUyxDQUFDRyxLQUFLLEdBQUdILFNBQVMsQ0FBQ0ksS0FBSyxHQUFHNUIsZUFBZTtJQUNyRixDQUFDLEVBQUU7TUFDREwsTUFBTSxFQUFFQSxNQUFNLENBQUNvQixZQUFZLENBQUUscUJBQXNCLENBQUM7TUFDcERLLEtBQUssRUFBRSxHQUFHO01BQ1ZKLGVBQWUsRUFBRS9CO0lBQ25CLENBQUUsQ0FBQztJQUVMLElBQUksQ0FBQ3NDLG1CQUFtQixDQUFDTSxRQUFRLENBQUUsQ0FBRUMsV0FBVyxFQUFFQyxjQUFjLEtBQU07TUFDcEU7TUFDQTtNQUNBLElBQUtyQyx5QkFBeUIsQ0FBQ3NDLEtBQUssS0FBSzNDLFlBQVksQ0FBQzRDLG9CQUFvQixJQUFJLENBQUNDLElBQUksQ0FBQ0MsS0FBSyxDQUFDQyxHQUFHLENBQUNDLDRCQUE0QixDQUFDTCxLQUFLLEVBQUc7UUFDakksSUFBSSxDQUFDTSx5QkFBeUIsQ0FBRVIsV0FBVyxFQUFFQyxjQUFlLENBQUM7TUFDL0Q7SUFDRixDQUFFLENBQUM7O0lBRUg7SUFDQSxJQUFJLENBQUNRLG1CQUFtQixHQUFHLElBQUk5RCxlQUFlLENBQUUsQ0FBRSxJQUFJLENBQUM4QyxtQkFBbUIsRUFBRSxJQUFJLENBQUNELG9CQUFvQixFQUFFNUIseUJBQXlCLENBQUUsRUFDaEksQ0FBRW9DLFdBQVcsRUFBRVUsT0FBTyxFQUFFQyxpQkFBaUIsS0FBTTtNQUM3QyxNQUFNQyxNQUFNLEdBQUdaLFdBQVcsR0FBR1UsT0FBTzs7TUFFcEM7TUFDQSxPQUFPQyxpQkFBaUIsR0FBS0UsSUFBSSxDQUFDQyxHQUFHLENBQUVGLE1BQU8sQ0FBQyxHQUFHdkQsWUFBWSxDQUFDMEQsZ0JBQWdCLEdBQUcsQ0FBQyxHQUFHSCxNQUFNLEdBQUssQ0FBQztJQUNwRyxDQUFDLEVBQUU7TUFDRC9DLE1BQU0sRUFBRUEsTUFBTSxDQUFDb0IsWUFBWSxDQUFFLHFCQUFzQixDQUFDO01BQ3BESyxLQUFLLEVBQUUsR0FBRztNQUNWSixlQUFlLEVBQUUvQjtJQUNuQixDQUFFLENBQUM7O0lBRUw7SUFDQSxJQUFJLENBQUM2RCxvQkFBb0IsR0FBRyxJQUFJckUsZUFBZSxDQUFFLENBQUUsSUFBSSxDQUFDOEMsbUJBQW1CLEVBQUUsSUFBSSxDQUFDRCxvQkFBb0IsQ0FBRSxFQUN0RyxDQUFFUSxXQUFXLEVBQUVVLE9BQU8sS0FBTSxHQUFHLEdBQUdWLFdBQVcsR0FBR1UsT0FBTyxHQUFHQSxPQUFPLEVBQUU7TUFDakU3QyxNQUFNLEVBQUVBLE1BQU0sQ0FBQ29CLFlBQVksQ0FBRSxzQkFBdUIsQ0FBQztNQUNyREssS0FBSyxFQUFFLEdBQUc7TUFDVkosZUFBZSxFQUFFL0I7SUFDbkIsQ0FBRSxDQUFDOztJQUVMO0lBQ0EsSUFBSSxDQUFDOEQsZ0JBQWdCLEdBQUd6RCxhQUFhLENBQUMwRCxHQUFHLENBQUV2RCxNQUFNLEVBQUVDLHlCQUF5QixFQUMxRUMsTUFBTSxDQUFDb0IsWUFBWSxDQUFFLGtCQUFtQixDQUFFLENBQUM7O0lBRTdDO0lBQ0EsSUFBSSxDQUFDa0MsbUJBQW1CLEdBQUczRCxhQUFhLENBQUM0RCxNQUFNLENBQUV6RCxNQUFNLEVBQUVDLHlCQUF5QixFQUNoRkMsTUFBTSxDQUFDb0IsWUFBWSxDQUFFLHFCQUFzQixDQUFFLENBQUM7O0lBRWhEO0lBQ0E7O0lBRUE7SUFDQTtJQUNBLElBQUksQ0FBQ2dDLGdCQUFnQixDQUFDSSxhQUFhLENBQUNDLElBQUksQ0FBRUMsS0FBSyxJQUFJO01BQ2pELElBQUksQ0FBQ0osbUJBQW1CLENBQUNFLGFBQWEsQ0FBQ0csR0FBRyxDQUFFLENBQUNELEtBQU0sQ0FBQztJQUN0RCxDQUFFLENBQUM7SUFDSCxJQUFJLENBQUNKLG1CQUFtQixDQUFDRSxhQUFhLENBQUNDLElBQUksQ0FBRUMsS0FBSyxJQUFJO01BQ3BELElBQUksQ0FBQ04sZ0JBQWdCLENBQUNJLGFBQWEsQ0FBQ0csR0FBRyxDQUFFLENBQUNELEtBQU0sQ0FBQztJQUNuRCxDQUFFLENBQUM7RUFDTDs7RUFHQTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFRSxZQUFZQSxDQUFBLEVBQUc7SUFDYixPQUFPLElBQUksQ0FBQ3pDLGlCQUFpQixDQUFDa0IsS0FBSyxDQUFDTCxLQUFLLEdBQUcsSUFBSSxDQUFDYixpQkFBaUIsQ0FBQ2tCLEtBQUssQ0FBQ0osS0FBSztFQUNoRjs7RUFFQTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFNEIsYUFBYUEsQ0FBRTNELFVBQVUsRUFBRztJQUMxQjRCLE1BQU0sSUFBSUEsTUFBTSxDQUFFNUIsVUFBVSxHQUFHLENBQUMsRUFBRywyQkFBMEJBLFVBQVcsRUFBRSxDQUFDO0lBQzNFLElBQUksQ0FBQ2lCLGlCQUFpQixDQUFDd0MsR0FBRyxDQUFFLElBQUkxRSxPQUFPLENBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUVpQixVQUFVLEVBQUUsSUFBSSxDQUFDaUIsaUJBQWlCLENBQUNrQixLQUFLLENBQUN5QixNQUFNLEVBQUU1RCxVQUFXLENBQUUsQ0FBQztFQUNuSDs7RUFFQTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRTZELHFCQUFxQkEsQ0FBQSxFQUFHO0lBQ3RCLE9BQU8sSUFBSTdFLE9BQU8sQ0FDaEIsSUFBSSxDQUFDdUIsUUFBUSxDQUFDRSxDQUFDLEVBQ2YsSUFBSSxDQUFDRixRQUFRLENBQUNJLENBQUMsR0FBSyxJQUFJLENBQUNXLHVCQUF1QixDQUFDYSxLQUFLLEdBQUcsQ0FBRyxHQUFHLElBQUksQ0FBQ2xCLGlCQUFpQixDQUFDa0IsS0FBSyxDQUFDeUIsTUFBTSxFQUNsRyxJQUFJLENBQUNyRCxRQUFRLENBQUNNLENBQUUsQ0FBQztFQUNyQjs7RUFFQTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRWlELHdCQUF3QkEsQ0FBQSxFQUFHO0lBQ3pCLE9BQU8sSUFBSTlFLE9BQU8sQ0FDaEIsSUFBSSxDQUFDdUIsUUFBUSxDQUFDRSxDQUFDLEVBQ2YsSUFBSSxDQUFDRixRQUFRLENBQUNJLENBQUMsR0FBSyxJQUFJLENBQUNXLHVCQUF1QixDQUFDYSxLQUFLLEdBQUcsQ0FBRyxHQUFHLElBQUksQ0FBQ2xCLGlCQUFpQixDQUFDa0IsS0FBSyxDQUFDeUIsTUFBTSxFQUNsRyxJQUFJLENBQUNyRCxRQUFRLENBQUNNLENBQUUsQ0FBQztFQUNyQjs7RUFFQTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFa0QsUUFBUUEsQ0FBRUMsS0FBSyxFQUFFekQsUUFBUSxFQUFHO0lBRTFCcUIsTUFBTSxJQUFJQSxNQUFNLENBQUVyQixRQUFRLEtBQUtoQixlQUFlLENBQUMwRSxhQUFhLElBQUkxRCxRQUFRLEtBQUtoQixlQUFlLENBQUMyRSxnQkFBZ0IsRUFDMUcsK0JBQThCM0QsUUFBUyxFQUFFLENBQUM7SUFFN0MsSUFBSTRELEtBQUs7SUFDVCxNQUFNQyxJQUFJLEdBQUcsSUFBSSxDQUFDbkQsaUJBQWlCLENBQUNrQixLQUFLO0lBQ3pDLElBQUs1QixRQUFRLEtBQUtoQixlQUFlLENBQUMwRSxhQUFhLEVBQUc7TUFDaERFLEtBQUssR0FBRyxJQUFJLENBQUNyRCxZQUFZLENBQUN1RCxjQUFjLENBQUUsSUFBSSxDQUFDOUQsUUFBUSxDQUFDRSxDQUFDLEVBQUUsSUFBSSxDQUFDb0QscUJBQXFCLENBQUMsQ0FBQyxDQUFDbEQsQ0FBQyxFQUFFLElBQUksQ0FBQ0osUUFBUSxDQUFDTSxDQUFDLEVBQUV1RCxJQUFJLENBQUN0QyxLQUFLLEVBQUVzQyxJQUFJLENBQUNSLE1BQU0sRUFBRVEsSUFBSSxDQUFDckMsS0FBTSxDQUFDO0lBQ25KLENBQUMsTUFDSSxJQUFLeEIsUUFBUSxLQUFLaEIsZUFBZSxDQUFDMkUsZ0JBQWdCLEVBQUc7TUFDeERDLEtBQUssR0FBRyxJQUFJLENBQUNyRCxZQUFZLENBQUN1RCxjQUFjLENBQUUsSUFBSSxDQUFDOUQsUUFBUSxDQUFDRSxDQUFDLEVBQUUsSUFBSSxDQUFDRixRQUFRLENBQUNJLENBQUMsR0FBRyxJQUFJLENBQUNXLHVCQUF1QixDQUFDYSxLQUFLLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQzVCLFFBQVEsQ0FBQ00sQ0FBQyxFQUFFdUQsSUFBSSxDQUFDdEMsS0FBSyxFQUFFc0MsSUFBSSxDQUFDUixNQUFNLEVBQUVRLElBQUksQ0FBQ3JDLEtBQU0sQ0FBQztJQUM3SztJQUVBLElBQUlnQyxRQUFRLEdBQUdDLEtBQUssQ0FBQ00sTUFBTSxDQUFDQyxnQkFBZ0IsQ0FBRUosS0FBSyxDQUFDRyxNQUFPLENBQUMsSUFDN0NOLEtBQUssQ0FBQ1EsaUJBQWlCLENBQUVMLEtBQU0sQ0FBQyxDQUFDTSxxQkFBcUIsQ0FBQyxDQUFDLEdBQUcsQ0FBQztJQUUzRSxJQUFLLENBQUNWLFFBQVEsSUFBSXhELFFBQVEsS0FBS2hCLGVBQWUsQ0FBQzBFLGFBQWEsRUFBRztNQUM3REYsUUFBUSxHQUFHLElBQUksQ0FBQ2IsZ0JBQWdCLENBQUNhLFFBQVEsQ0FBRUMsS0FBTSxDQUFDO0lBQ3BELENBQUMsTUFDSSxJQUFLLENBQUNELFFBQVEsSUFBSXhELFFBQVEsS0FBS2hCLGVBQWUsQ0FBQzJFLGdCQUFnQixFQUFHO01BQ3JFSCxRQUFRLEdBQUcsSUFBSSxDQUFDWCxtQkFBbUIsQ0FBQ1csUUFBUSxDQUFFQyxLQUFNLENBQUM7SUFDdkQ7SUFFQSxPQUFPRCxRQUFRO0VBQ2pCOztFQUVBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFVyxrQkFBa0JBLENBQUEsRUFBRztJQUNuQixNQUFNQyxXQUFXLEdBQUcsSUFBSSxDQUFDakMsbUJBQW1CLENBQUNQLEtBQUs7SUFDbEQsSUFBS1csSUFBSSxDQUFDQyxHQUFHLENBQUU0QixXQUFZLENBQUMsR0FBR3JGLFlBQVksQ0FBQzBELGdCQUFnQixFQUFHO01BQzdELE9BQU8sQ0FBQztJQUNWLENBQUMsTUFDSTtNQUNILE9BQU8sSUFBSSxDQUFDdkIsb0JBQW9CLENBQUNVLEtBQUssR0FBRyxJQUFJLENBQUNiLHVCQUF1QixDQUFDYSxLQUFLO0lBQzdFO0VBQ0Y7O0VBRUE7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0V5QyxTQUFTQSxDQUFFQyxDQUFDLEVBQUVDLEVBQUUsRUFBRztJQUNqQixJQUFJLENBQUNyRCxvQkFBb0IsQ0FBQ1UsS0FBSyxJQUFJVyxJQUFJLENBQUNpQyxHQUFHLENBQUUsQ0FBQ0QsRUFBRSxJQUFLRCxDQUFDLEdBQUcsSUFBSSxDQUFDbkQsbUJBQW1CLENBQUNTLEtBQUssQ0FBRyxDQUFDO0VBQzdGOztFQUVBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFTSx5QkFBeUJBLENBQUV1QyxjQUFjLEVBQUU5QyxjQUFjLEVBQUc7SUFFMUQ7SUFDQSxNQUFNK0MsZ0JBQWdCLEdBQUdELGNBQWMsR0FBRzlDLGNBQWM7SUFFeEQsSUFBSSxDQUFDVCxvQkFBb0IsQ0FBQ1UsS0FBSyxHQUFHLElBQUksQ0FBQ1Ysb0JBQW9CLENBQUNVLEtBQUssR0FBRzhDLGdCQUFnQjtFQUN0Rjs7RUFFQTtFQUNBQyxLQUFLQSxDQUFBLEVBQUc7SUFDTixJQUFJLENBQUNqRSxpQkFBaUIsQ0FBQ2lFLEtBQUssQ0FBQyxDQUFDO0lBQzlCLElBQUksQ0FBQzVELHVCQUF1QixDQUFDNEQsS0FBSyxDQUFDLENBQUM7SUFDcEMsSUFBSSxDQUFDekQsb0JBQW9CLENBQUN5RCxLQUFLLENBQUMsQ0FBQztFQUNuQztBQUNGO0FBRUE3RixrQkFBa0IsQ0FBQzhGLFFBQVEsQ0FBRSxXQUFXLEVBQUV6RixTQUFVLENBQUM7QUFFckQsZUFBZUEsU0FBUyJ9