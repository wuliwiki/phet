// Copyright 2022-2023, University of Colorado Boulder

/**
 * KeypadDialog is a Dialog sub-type that handles the creation and management of a Keypad for the 'collision lab'
 * simulation. It is present on all screens.
 *
 * The KeypadDialog is shown when requested through the beginEdit() method, which occurs when the user presses on a
 * BallValuesPanelNumberDisplay, to allow the user to manipulate a Ball Property. Edits must be within a specified
 * range. There will be a 'Enter' button to allow the user to submit a edit, and edits are canceled if the user hides
 * the Dialog.
 *
 * KeypadDialog is created at the start of the sim and is never disposed, so no dispose method is necessary and
 * internal links are left as-is.
 *
 * @author Brandon Li
 */

import PatternStringProperty from '../../../axon/js/PatternStringProperty.js';
import Keypad from '../../../scenery-phet/js/keypad/Keypad.js';
import PhetFont from '../../../scenery-phet/js/PhetFont.js';
import { Color, KeyboardListener, Node, Rectangle, RichText, Text, VBox } from '../../../scenery/js/imports.js';
import RectangularPushButton from '../../../sun/js/buttons/RectangularPushButton.js';
import Dialog from '../../../sun/js/Dialog.js';
import sceneryPhet from '../sceneryPhet.js';
import optionize, { combineOptions } from '../../../phet-core/js/optionize.js';
import SceneryPhetStrings from '../SceneryPhetStrings.js';
class KeypadDialog extends Dialog {
  // Reference to the function called when a edit in-range successfully occurs. If null, the Keypad dialog is currently
  // not shown.
  editValue = null;

  // Reference to the Range of the value that the Keypad is editing, if non-null.
  valueRange = null;

  // Reference to a potential callback function for when the Keypad is finished editing. This is provided by the client
  // in the beginEdit() method.
  editFinishedCallback = null;

  // The Keypad of the KeypadDialog

  // The Text Node that displays the Range of the current edit.

  // So we can dispose it
  rangeStringProperty = null;

  // The Text Node that shows the current value of the Keypad edit.

  constructor(providedOptions) {
    const options = optionize()({
      font: new PhetFont(15),
      valueBoxWidth: 85,
      valueYMargin: 3,
      contentSpacing: 10,
      useRichTextRange: false,
      keypadLayout: Keypad.PositiveAndNegativeFloatingPointLayout,
      keypadDefaultTextColor: Color.BLACK,
      keypadErrorTextColor: Color.RED,
      enterButtonOptions: {
        // baseColor: CollisionLabColors.KEYPAD_ENTER_BUTTON,
      },
      keypadOptions: {}
    }, providedOptions);

    //----------------------------------------------------------------------------------------

    // Reference the content of the Dialog. Children are added later.
    const contentNode = new VBox({
      spacing: options.contentSpacing,
      align: 'center'
    });
    const keypad = new Keypad(options.keypadLayout, options.keypadOptions);
    options.focusOnShowNode = keypad;
    super(contentNode, options);
    this.defaultTextColor = options.keypadDefaultTextColor;
    this.errorTextColor = options.keypadErrorTextColor;
    this.keypad = keypad;
    this.rangeText = options.useRichTextRange ? new RichText('', {
      font: options.font,
      maxWidth: this.keypad.width
    }) : new Text('', {
      font: options.font,
      maxWidth: this.keypad.width
    });
    this.valueText = new Text('', {
      font: options.font
    });

    // Create the Background to the valueText Node.
    const valueBackgroundNode = new Rectangle(0, 0, options.valueBoxWidth, this.height + 2 * options.valueYMargin, {
      cornerRadius: 3,
      fill: Color.WHITE,
      stroke: Color.BLACK
    });
    const valueDisplayBox = new Node({
      children: [valueBackgroundNode, this.valueText]
    });

    // Create the enterButton, which allows the user to submit an Edit.
    const enterText = new Text(SceneryPhetStrings.key.enterStringProperty, {
      font: options.font,
      maxWidth: this.keypad.width // constrain width for i18n
    });

    const enterButton = new RectangularPushButton(combineOptions({
      listener: this.submitEdit.bind(this),
      content: enterText,
      accessibleName: SceneryPhetStrings.key.enterStringProperty
    }, options.enterButtonOptions));

    // Set the children of the content of the KeypadDialog, in the correct rendering order.
    contentNode.children = [this.rangeText, valueDisplayBox, this.keypad, enterButton];

    //----------------------------------------------------------------------------------------

    // Observe when the Keypad is edited and update our valueText display. Link is never disposed as KeypadDialogs
    // are never disposed.
    this.keypad.stringProperty.link(string => {
      this.valueText.string = string;
      this.valueText.center = valueBackgroundNode.center;
    });

    // Observe when a key is pressed and reset text colors. Link is never disposed.
    this.keypad.accumulatedKeysProperty.link(() => {
      this.valueText.fill = this.defaultTextColor;
      this.rangeText.fill = this.defaultTextColor;
    });
    const submitFromKeypadListener = new KeyboardListener({
      keys: ['space', 'enter'],
      listenerFireTrigger: 'up',
      callback: () => this.submitEdit()
    });
    this.keypad.addInputListener(submitFromKeypadListener);
    this.disposeKeypadDialog = () => {
      submitFromKeypadListener.dispose();
      this.keypad.dispose();
      this.rangeStringProperty && this.rangeStringProperty.dispose();
      enterText.dispose(); // linked to a translated string Property
    };
  }

  /**
   * Begins an edit by showing the KeypadDialog. Called when the user presses on a BallValuesPanelNumberDisplay to allow
   * the user to manipulate a Ball.
   *
   * @param editValue - the function called when a edit in-range successfully occurs.
   * @param valueRange - the Range that the user can edit the valueProperty
   * @param patternStringProperty - the template string that formats the text on the rangeText.
   * @param editFinishedCallback - callback when edit is entered or canceled.
   */
  beginEdit(editValue, valueRange, patternStringProperty, editFinishedCallback) {
    this.keypad.clear();

    // Update references. These references are released when the edit is canceled or finished.
    this.editValue = editValue;
    this.valueRange = valueRange;
    this.editFinishedCallback = editFinishedCallback;

    // Clear a previous value out if it exists
    this.rangeStringProperty && this.rangeStringProperty.dispose();
    this.rangeStringProperty = new PatternStringProperty(patternStringProperty, {
      min: valueRange.min,
      max: valueRange.max
    });
    this.rangeText.mutate({
      stringProperty: this.rangeStringProperty
    });

    // Display the KeypadDialog.
    this.show();
  }

  /**
   * Attempts to submit the current Keypad edit. If the edit is valid, the valueProperty is set and the edit is
   * finished. Otherwise, the edit is invalid, and the warnOutOfRange() method is invoked.
   *
   * This is called when the user presses the 'Enter' button.
   */
  submitEdit() {
    // If the user didn't enter anything, treat this as a cancel.
    if (this.keypad.stringProperty.value === '') {
      this.finishEdit();
      return;
    }

    // Retrieve the value from the Keypad
    const value = this.keypad.valueProperty.value;

    // If the edit is valid, the valueProperty is set and the edit.
    if (value !== null && Number.isFinite(value) && (!this.valueRange || this.valueRange.contains(value))) {
      this.editValue !== null && this.editValue(value);
      this.finishEdit();
    } else {
      this.warnOutOfRange();
    }
  }

  /**
   * Changes the text colors of the Value and the Range Text to indicate that a entered Edit is out of range.
   */
  warnOutOfRange() {
    this.valueText.fill = this.errorTextColor;
    this.rangeText.fill = this.errorTextColor;
    this.keypad.setClearOnNextKeyPress(true);
  }

  /**
   * Convenience method to finish the KeypadDialog.
   *
   * This method is invoked when a edit is canceled or when a valid edit is entered.
   */
  finishEdit() {
    this.hide(); // Hide the KeypadDialog
    this.keypad.clear(); // Clear the Keypad

    // Release references.
    this.valueRange = null;
    this.editFinishedCallback = null;
  }

  /**
   * Hides the dialog. Overridden to also call the editFinishedCallback function when edits are canceled.
   */
  hide() {
    this.editFinishedCallback && this.editFinishedCallback();
    super.hide();
  }
  dispose() {
    this.disposeKeypadDialog();
    super.dispose();
  }
}
sceneryPhet.register('KeypadDialog', KeypadDialog);
export default KeypadDialog;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJLZXlwYWQiLCJQaGV0Rm9udCIsIkNvbG9yIiwiS2V5Ym9hcmRMaXN0ZW5lciIsIk5vZGUiLCJSZWN0YW5nbGUiLCJSaWNoVGV4dCIsIlRleHQiLCJWQm94IiwiUmVjdGFuZ3VsYXJQdXNoQnV0dG9uIiwiRGlhbG9nIiwic2NlbmVyeVBoZXQiLCJvcHRpb25pemUiLCJjb21iaW5lT3B0aW9ucyIsIlNjZW5lcnlQaGV0U3RyaW5ncyIsIktleXBhZERpYWxvZyIsImVkaXRWYWx1ZSIsInZhbHVlUmFuZ2UiLCJlZGl0RmluaXNoZWRDYWxsYmFjayIsInJhbmdlU3RyaW5nUHJvcGVydHkiLCJjb25zdHJ1Y3RvciIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJmb250IiwidmFsdWVCb3hXaWR0aCIsInZhbHVlWU1hcmdpbiIsImNvbnRlbnRTcGFjaW5nIiwidXNlUmljaFRleHRSYW5nZSIsImtleXBhZExheW91dCIsIlBvc2l0aXZlQW5kTmVnYXRpdmVGbG9hdGluZ1BvaW50TGF5b3V0Iiwia2V5cGFkRGVmYXVsdFRleHRDb2xvciIsIkJMQUNLIiwia2V5cGFkRXJyb3JUZXh0Q29sb3IiLCJSRUQiLCJlbnRlckJ1dHRvbk9wdGlvbnMiLCJrZXlwYWRPcHRpb25zIiwiY29udGVudE5vZGUiLCJzcGFjaW5nIiwiYWxpZ24iLCJrZXlwYWQiLCJmb2N1c09uU2hvd05vZGUiLCJkZWZhdWx0VGV4dENvbG9yIiwiZXJyb3JUZXh0Q29sb3IiLCJyYW5nZVRleHQiLCJtYXhXaWR0aCIsIndpZHRoIiwidmFsdWVUZXh0IiwidmFsdWVCYWNrZ3JvdW5kTm9kZSIsImhlaWdodCIsImNvcm5lclJhZGl1cyIsImZpbGwiLCJXSElURSIsInN0cm9rZSIsInZhbHVlRGlzcGxheUJveCIsImNoaWxkcmVuIiwiZW50ZXJUZXh0Iiwia2V5IiwiZW50ZXJTdHJpbmdQcm9wZXJ0eSIsImVudGVyQnV0dG9uIiwibGlzdGVuZXIiLCJzdWJtaXRFZGl0IiwiYmluZCIsImNvbnRlbnQiLCJhY2Nlc3NpYmxlTmFtZSIsInN0cmluZ1Byb3BlcnR5IiwibGluayIsInN0cmluZyIsImNlbnRlciIsImFjY3VtdWxhdGVkS2V5c1Byb3BlcnR5Iiwic3VibWl0RnJvbUtleXBhZExpc3RlbmVyIiwia2V5cyIsImxpc3RlbmVyRmlyZVRyaWdnZXIiLCJjYWxsYmFjayIsImFkZElucHV0TGlzdGVuZXIiLCJkaXNwb3NlS2V5cGFkRGlhbG9nIiwiZGlzcG9zZSIsImJlZ2luRWRpdCIsInBhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsImNsZWFyIiwibWluIiwibWF4IiwibXV0YXRlIiwic2hvdyIsInZhbHVlIiwiZmluaXNoRWRpdCIsInZhbHVlUHJvcGVydHkiLCJOdW1iZXIiLCJpc0Zpbml0ZSIsImNvbnRhaW5zIiwid2Fybk91dE9mUmFuZ2UiLCJzZXRDbGVhck9uTmV4dEtleVByZXNzIiwiaGlkZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiS2V5cGFkRGlhbG9nLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIyLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEtleXBhZERpYWxvZyBpcyBhIERpYWxvZyBzdWItdHlwZSB0aGF0IGhhbmRsZXMgdGhlIGNyZWF0aW9uIGFuZCBtYW5hZ2VtZW50IG9mIGEgS2V5cGFkIGZvciB0aGUgJ2NvbGxpc2lvbiBsYWInXHJcbiAqIHNpbXVsYXRpb24uIEl0IGlzIHByZXNlbnQgb24gYWxsIHNjcmVlbnMuXHJcbiAqXHJcbiAqIFRoZSBLZXlwYWREaWFsb2cgaXMgc2hvd24gd2hlbiByZXF1ZXN0ZWQgdGhyb3VnaCB0aGUgYmVnaW5FZGl0KCkgbWV0aG9kLCB3aGljaCBvY2N1cnMgd2hlbiB0aGUgdXNlciBwcmVzc2VzIG9uIGFcclxuICogQmFsbFZhbHVlc1BhbmVsTnVtYmVyRGlzcGxheSwgdG8gYWxsb3cgdGhlIHVzZXIgdG8gbWFuaXB1bGF0ZSBhIEJhbGwgUHJvcGVydHkuIEVkaXRzIG11c3QgYmUgd2l0aGluIGEgc3BlY2lmaWVkXHJcbiAqIHJhbmdlLiBUaGVyZSB3aWxsIGJlIGEgJ0VudGVyJyBidXR0b24gdG8gYWxsb3cgdGhlIHVzZXIgdG8gc3VibWl0IGEgZWRpdCwgYW5kIGVkaXRzIGFyZSBjYW5jZWxlZCBpZiB0aGUgdXNlciBoaWRlc1xyXG4gKiB0aGUgRGlhbG9nLlxyXG4gKlxyXG4gKiBLZXlwYWREaWFsb2cgaXMgY3JlYXRlZCBhdCB0aGUgc3RhcnQgb2YgdGhlIHNpbSBhbmQgaXMgbmV2ZXIgZGlzcG9zZWQsIHNvIG5vIGRpc3Bvc2UgbWV0aG9kIGlzIG5lY2Vzc2FyeSBhbmRcclxuICogaW50ZXJuYWwgbGlua3MgYXJlIGxlZnQgYXMtaXMuXHJcbiAqXHJcbiAqIEBhdXRob3IgQnJhbmRvbiBMaVxyXG4gKi9cclxuXHJcbmltcG9ydCBQYXR0ZXJuU3RyaW5nUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9QYXR0ZXJuU3RyaW5nUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IEtleXBhZCwgeyBLZXlwYWRMYXlvdXQsIEtleXBhZE9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMva2V5cGFkL0tleXBhZC5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBDb2xvciwgRm9udCwgS2V5Ym9hcmRMaXN0ZW5lciwgTm9kZSwgUmVjdGFuZ2xlLCBSaWNoVGV4dCwgVENvbG9yLCBUZXh0LCBWQm94IH0gZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbiwgeyBSZWN0YW5ndWxhclB1c2hCdXR0b25PcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vc3VuL2pzL2J1dHRvbnMvUmVjdGFuZ3VsYXJQdXNoQnV0dG9uLmpzJztcclxuaW1wb3J0IERpYWxvZywgeyBEaWFsb2dPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vc3VuL2pzL0RpYWxvZy5qcyc7XHJcbmltcG9ydCBzY2VuZXJ5UGhldCBmcm9tICcuLi9zY2VuZXJ5UGhldC5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgY29tYmluZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgU2NlbmVyeVBoZXRTdHJpbmdzIGZyb20gJy4uL1NjZW5lcnlQaGV0U3RyaW5ncy5qcyc7XHJcbmltcG9ydCBTdHJpY3RPbWl0IGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9TdHJpY3RPbWl0LmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgLy8gRm9udCB1c2VkIGZvciBhbGwgVGV4dCBpbnN0YW5jZXMgd2l0aGluIHRoZSBEaWFsb2cuXHJcbiAgZm9udD86IEZvbnQ7XHJcblxyXG4gIC8vIFdpZHRoIG9mIHRoZSB2YWx1ZSBmaWVsZCwgaGVpZ2h0IGRldGVybWluZWQgYnkgdmFsdWVGb250LlxyXG4gIHZhbHVlQm94V2lkdGg/OiBudW1iZXI7XHJcblxyXG4gIC8vIFZlcnRpY2FsIG1hcmdpbiBpbnNpZGUgdGhlIHZhbHVlIGJveC5cclxuICB2YWx1ZVlNYXJnaW4/OiBudW1iZXI7XHJcblxyXG4gIC8vIFZlcnRpY2FsIHNwYWNpbmcgYmV0d2VlbiB0aGUgY29udGVudCBvZiB0aGUgS2V5cGFkRGlhbG9nLlxyXG4gIGNvbnRlbnRTcGFjaW5nPzogbnVtYmVyO1xyXG5cclxuICAvLyBJZiB0cnVlLCB0aGUgcmFuZ2UgVGV4dCB3aWxsIGJlIGNyZWF0ZWQgYXMgYSBSaWNoVGV4dFxyXG4gIHVzZVJpY2hUZXh0UmFuZ2U/OiBib29sZWFuO1xyXG5cclxuICBrZXlwYWRMYXlvdXQ/OiBLZXlwYWRMYXlvdXQ7XHJcblxyXG4gIGtleXBhZE9wdGlvbnM/OiBLZXlwYWRPcHRpb25zO1xyXG5cclxuICBlbnRlckJ1dHRvbk9wdGlvbnM/OiBSZWN0YW5ndWxhclB1c2hCdXR0b25PcHRpb25zO1xyXG5cclxuICBrZXlwYWREZWZhdWx0VGV4dENvbG9yPzogVENvbG9yO1xyXG4gIGtleXBhZEVycm9yVGV4dENvbG9yPzogVENvbG9yO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgS2V5cGFkRGlhbG9nT3B0aW9ucyA9IFN0cmljdE9taXQ8RGlhbG9nT3B0aW9ucywgJ2ZvY3VzT25TaG93Tm9kZSc+ICYgU2VsZk9wdGlvbnM7XHJcblxyXG5jbGFzcyBLZXlwYWREaWFsb2cgZXh0ZW5kcyBEaWFsb2cge1xyXG5cclxuICAvLyBSZWZlcmVuY2UgdG8gdGhlIGZ1bmN0aW9uIGNhbGxlZCB3aGVuIGEgZWRpdCBpbi1yYW5nZSBzdWNjZXNzZnVsbHkgb2NjdXJzLiBJZiBudWxsLCB0aGUgS2V5cGFkIGRpYWxvZyBpcyBjdXJyZW50bHlcclxuICAvLyBub3Qgc2hvd24uXHJcbiAgcHJpdmF0ZSBlZGl0VmFsdWU6ICggKCB2YWx1ZTogbnVtYmVyICkgPT4gdm9pZCApIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIC8vIFJlZmVyZW5jZSB0byB0aGUgUmFuZ2Ugb2YgdGhlIHZhbHVlIHRoYXQgdGhlIEtleXBhZCBpcyBlZGl0aW5nLCBpZiBub24tbnVsbC5cclxuICBwcml2YXRlIHZhbHVlUmFuZ2U6IFJhbmdlIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIC8vIFJlZmVyZW5jZSB0byBhIHBvdGVudGlhbCBjYWxsYmFjayBmdW5jdGlvbiBmb3Igd2hlbiB0aGUgS2V5cGFkIGlzIGZpbmlzaGVkIGVkaXRpbmcuIFRoaXMgaXMgcHJvdmlkZWQgYnkgdGhlIGNsaWVudFxyXG4gIC8vIGluIHRoZSBiZWdpbkVkaXQoKSBtZXRob2QuXHJcbiAgcHJpdmF0ZSBlZGl0RmluaXNoZWRDYWxsYmFjazogKCAoKSA9PiB2b2lkICkgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgLy8gVGhlIEtleXBhZCBvZiB0aGUgS2V5cGFkRGlhbG9nXHJcbiAgcHJpdmF0ZSByZWFkb25seSBrZXlwYWQ6IEtleXBhZDtcclxuXHJcbiAgLy8gVGhlIFRleHQgTm9kZSB0aGF0IGRpc3BsYXlzIHRoZSBSYW5nZSBvZiB0aGUgY3VycmVudCBlZGl0LlxyXG4gIHByaXZhdGUgcmVhZG9ubHkgcmFuZ2VUZXh0OiBUZXh0IHwgUmljaFRleHQ7XHJcblxyXG4gIC8vIFNvIHdlIGNhbiBkaXNwb3NlIGl0XHJcbiAgcHJpdmF0ZSByYW5nZVN0cmluZ1Byb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIC8vIFRoZSBUZXh0IE5vZGUgdGhhdCBzaG93cyB0aGUgY3VycmVudCB2YWx1ZSBvZiB0aGUgS2V5cGFkIGVkaXQuXHJcbiAgcHJpdmF0ZSByZWFkb25seSB2YWx1ZVRleHQ6IFRleHQ7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGVmYXVsdFRleHRDb2xvcjogVENvbG9yO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZXJyb3JUZXh0Q29sb3I6IFRDb2xvcjtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlS2V5cGFkRGlhbG9nOiAoKSA9PiB2b2lkO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3ZpZGVkT3B0aW9ucz86IEtleXBhZERpYWxvZ09wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxLZXlwYWREaWFsb2dPcHRpb25zLCBTZWxmT3B0aW9ucywgRGlhbG9nT3B0aW9ucz4oKSgge1xyXG5cclxuICAgICAgZm9udDogbmV3IFBoZXRGb250KCAxNSApLFxyXG5cclxuICAgICAgdmFsdWVCb3hXaWR0aDogODUsXHJcbiAgICAgIHZhbHVlWU1hcmdpbjogMyxcclxuICAgICAgY29udGVudFNwYWNpbmc6IDEwLFxyXG5cclxuICAgICAgdXNlUmljaFRleHRSYW5nZTogZmFsc2UsXHJcblxyXG4gICAgICBrZXlwYWRMYXlvdXQ6IEtleXBhZC5Qb3NpdGl2ZUFuZE5lZ2F0aXZlRmxvYXRpbmdQb2ludExheW91dCxcclxuXHJcbiAgICAgIGtleXBhZERlZmF1bHRUZXh0Q29sb3I6IENvbG9yLkJMQUNLLFxyXG4gICAgICBrZXlwYWRFcnJvclRleHRDb2xvcjogQ29sb3IuUkVELFxyXG5cclxuICAgICAgZW50ZXJCdXR0b25PcHRpb25zOiB7XHJcbiAgICAgICAgLy8gYmFzZUNvbG9yOiBDb2xsaXNpb25MYWJDb2xvcnMuS0VZUEFEX0VOVEVSX0JVVFRPTixcclxuICAgICAgfSxcclxuICAgICAga2V5cGFkT3B0aW9uczoge31cclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIC8vIFJlZmVyZW5jZSB0aGUgY29udGVudCBvZiB0aGUgRGlhbG9nLiBDaGlsZHJlbiBhcmUgYWRkZWQgbGF0ZXIuXHJcbiAgICBjb25zdCBjb250ZW50Tm9kZSA9IG5ldyBWQm94KCB7IHNwYWNpbmc6IG9wdGlvbnMuY29udGVudFNwYWNpbmcsIGFsaWduOiAnY2VudGVyJyB9ICk7XHJcblxyXG4gICAgY29uc3Qga2V5cGFkID0gbmV3IEtleXBhZCggb3B0aW9ucy5rZXlwYWRMYXlvdXQsIG9wdGlvbnMua2V5cGFkT3B0aW9ucyApO1xyXG5cclxuICAgIG9wdGlvbnMuZm9jdXNPblNob3dOb2RlID0ga2V5cGFkO1xyXG5cclxuICAgIHN1cGVyKCBjb250ZW50Tm9kZSwgb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMuZGVmYXVsdFRleHRDb2xvciA9IG9wdGlvbnMua2V5cGFkRGVmYXVsdFRleHRDb2xvcjtcclxuICAgIHRoaXMuZXJyb3JUZXh0Q29sb3IgPSBvcHRpb25zLmtleXBhZEVycm9yVGV4dENvbG9yO1xyXG5cclxuICAgIHRoaXMua2V5cGFkID0ga2V5cGFkO1xyXG4gICAgdGhpcy5yYW5nZVRleHQgPSBvcHRpb25zLnVzZVJpY2hUZXh0UmFuZ2VcclxuICAgICAgICAgICAgICAgICAgICAgPyBuZXcgUmljaFRleHQoICcnLCB7IGZvbnQ6IG9wdGlvbnMuZm9udCwgbWF4V2lkdGg6IHRoaXMua2V5cGFkLndpZHRoIH0gKVxyXG4gICAgICAgICAgICAgICAgICAgICA6IG5ldyBUZXh0KCAnJywgeyBmb250OiBvcHRpb25zLmZvbnQsIG1heFdpZHRoOiB0aGlzLmtleXBhZC53aWR0aCB9ICk7XHJcbiAgICB0aGlzLnZhbHVlVGV4dCA9IG5ldyBUZXh0KCAnJywgeyBmb250OiBvcHRpb25zLmZvbnQgfSApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgQmFja2dyb3VuZCB0byB0aGUgdmFsdWVUZXh0IE5vZGUuXHJcbiAgICBjb25zdCB2YWx1ZUJhY2tncm91bmROb2RlID0gbmV3IFJlY3RhbmdsZSggMCwgMCwgb3B0aW9ucy52YWx1ZUJveFdpZHRoLCB0aGlzLmhlaWdodCArIDIgKiBvcHRpb25zLnZhbHVlWU1hcmdpbiwge1xyXG4gICAgICBjb3JuZXJSYWRpdXM6IDMsXHJcbiAgICAgIGZpbGw6IENvbG9yLldISVRFLFxyXG4gICAgICBzdHJva2U6IENvbG9yLkJMQUNLXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgdmFsdWVEaXNwbGF5Qm94ID0gbmV3IE5vZGUoIHsgY2hpbGRyZW46IFsgdmFsdWVCYWNrZ3JvdW5kTm9kZSwgdGhpcy52YWx1ZVRleHQgXSB9ICk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRoZSBlbnRlckJ1dHRvbiwgd2hpY2ggYWxsb3dzIHRoZSB1c2VyIHRvIHN1Ym1pdCBhbiBFZGl0LlxyXG4gICAgY29uc3QgZW50ZXJUZXh0ID0gbmV3IFRleHQoIFNjZW5lcnlQaGV0U3RyaW5ncy5rZXkuZW50ZXJTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICBmb250OiBvcHRpb25zLmZvbnQsXHJcbiAgICAgIG1heFdpZHRoOiB0aGlzLmtleXBhZC53aWR0aCAvLyBjb25zdHJhaW4gd2lkdGggZm9yIGkxOG5cclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGVudGVyQnV0dG9uID0gbmV3IFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbiggY29tYmluZU9wdGlvbnM8UmVjdGFuZ3VsYXJQdXNoQnV0dG9uT3B0aW9ucz4oIHtcclxuICAgICAgbGlzdGVuZXI6IHRoaXMuc3VibWl0RWRpdC5iaW5kKCB0aGlzICksXHJcblxyXG4gICAgICBjb250ZW50OiBlbnRlclRleHQsXHJcbiAgICAgIGFjY2Vzc2libGVOYW1lOiBTY2VuZXJ5UGhldFN0cmluZ3Mua2V5LmVudGVyU3RyaW5nUHJvcGVydHlcclxuICAgIH0sIG9wdGlvbnMuZW50ZXJCdXR0b25PcHRpb25zICkgKTtcclxuXHJcbiAgICAvLyBTZXQgdGhlIGNoaWxkcmVuIG9mIHRoZSBjb250ZW50IG9mIHRoZSBLZXlwYWREaWFsb2csIGluIHRoZSBjb3JyZWN0IHJlbmRlcmluZyBvcmRlci5cclxuICAgIGNvbnRlbnROb2RlLmNoaWxkcmVuID0gW1xyXG4gICAgICB0aGlzLnJhbmdlVGV4dCxcclxuICAgICAgdmFsdWVEaXNwbGF5Qm94LFxyXG4gICAgICB0aGlzLmtleXBhZCxcclxuICAgICAgZW50ZXJCdXR0b25cclxuICAgIF07XHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgLy8gT2JzZXJ2ZSB3aGVuIHRoZSBLZXlwYWQgaXMgZWRpdGVkIGFuZCB1cGRhdGUgb3VyIHZhbHVlVGV4dCBkaXNwbGF5LiBMaW5rIGlzIG5ldmVyIGRpc3Bvc2VkIGFzIEtleXBhZERpYWxvZ3NcclxuICAgIC8vIGFyZSBuZXZlciBkaXNwb3NlZC5cclxuICAgIHRoaXMua2V5cGFkLnN0cmluZ1Byb3BlcnR5LmxpbmsoIHN0cmluZyA9PiB7XHJcbiAgICAgIHRoaXMudmFsdWVUZXh0LnN0cmluZyA9IHN0cmluZztcclxuICAgICAgdGhpcy52YWx1ZVRleHQuY2VudGVyID0gdmFsdWVCYWNrZ3JvdW5kTm9kZS5jZW50ZXI7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gT2JzZXJ2ZSB3aGVuIGEga2V5IGlzIHByZXNzZWQgYW5kIHJlc2V0IHRleHQgY29sb3JzLiBMaW5rIGlzIG5ldmVyIGRpc3Bvc2VkLlxyXG4gICAgdGhpcy5rZXlwYWQuYWNjdW11bGF0ZWRLZXlzUHJvcGVydHkubGluayggKCkgPT4ge1xyXG4gICAgICB0aGlzLnZhbHVlVGV4dC5maWxsID0gdGhpcy5kZWZhdWx0VGV4dENvbG9yO1xyXG4gICAgICB0aGlzLnJhbmdlVGV4dC5maWxsID0gdGhpcy5kZWZhdWx0VGV4dENvbG9yO1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHN1Ym1pdEZyb21LZXlwYWRMaXN0ZW5lciA9IG5ldyBLZXlib2FyZExpc3RlbmVyKCB7XHJcbiAgICAgIGtleXM6IFsgJ3NwYWNlJywgJ2VudGVyJyBdLFxyXG4gICAgICBsaXN0ZW5lckZpcmVUcmlnZ2VyOiAndXAnLFxyXG4gICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zdWJtaXRFZGl0KClcclxuICAgIH0gKTtcclxuICAgIHRoaXMua2V5cGFkLmFkZElucHV0TGlzdGVuZXIoIHN1Ym1pdEZyb21LZXlwYWRMaXN0ZW5lciApO1xyXG5cclxuICAgIHRoaXMuZGlzcG9zZUtleXBhZERpYWxvZyA9ICgpID0+IHtcclxuICAgICAgc3VibWl0RnJvbUtleXBhZExpc3RlbmVyLmRpc3Bvc2UoKTtcclxuICAgICAgdGhpcy5rZXlwYWQuZGlzcG9zZSgpO1xyXG4gICAgICB0aGlzLnJhbmdlU3RyaW5nUHJvcGVydHkgJiYgdGhpcy5yYW5nZVN0cmluZ1Byb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgZW50ZXJUZXh0LmRpc3Bvc2UoKTsgLy8gbGlua2VkIHRvIGEgdHJhbnNsYXRlZCBzdHJpbmcgUHJvcGVydHlcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBCZWdpbnMgYW4gZWRpdCBieSBzaG93aW5nIHRoZSBLZXlwYWREaWFsb2cuIENhbGxlZCB3aGVuIHRoZSB1c2VyIHByZXNzZXMgb24gYSBCYWxsVmFsdWVzUGFuZWxOdW1iZXJEaXNwbGF5IHRvIGFsbG93XHJcbiAgICogdGhlIHVzZXIgdG8gbWFuaXB1bGF0ZSBhIEJhbGwuXHJcbiAgICpcclxuICAgKiBAcGFyYW0gZWRpdFZhbHVlIC0gdGhlIGZ1bmN0aW9uIGNhbGxlZCB3aGVuIGEgZWRpdCBpbi1yYW5nZSBzdWNjZXNzZnVsbHkgb2NjdXJzLlxyXG4gICAqIEBwYXJhbSB2YWx1ZVJhbmdlIC0gdGhlIFJhbmdlIHRoYXQgdGhlIHVzZXIgY2FuIGVkaXQgdGhlIHZhbHVlUHJvcGVydHlcclxuICAgKiBAcGFyYW0gcGF0dGVyblN0cmluZ1Byb3BlcnR5IC0gdGhlIHRlbXBsYXRlIHN0cmluZyB0aGF0IGZvcm1hdHMgdGhlIHRleHQgb24gdGhlIHJhbmdlVGV4dC5cclxuICAgKiBAcGFyYW0gZWRpdEZpbmlzaGVkQ2FsbGJhY2sgLSBjYWxsYmFjayB3aGVuIGVkaXQgaXMgZW50ZXJlZCBvciBjYW5jZWxlZC5cclxuICAgKi9cclxuICBwdWJsaWMgYmVnaW5FZGl0KCBlZGl0VmFsdWU6ICggdmFsdWU6IG51bWJlciApID0+IHZvaWQsIHZhbHVlUmFuZ2U6IFJhbmdlLCBwYXR0ZXJuU3RyaW5nUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz4sIGVkaXRGaW5pc2hlZENhbGxiYWNrOiAoKSA9PiB2b2lkICk6IHZvaWQge1xyXG5cclxuICAgIHRoaXMua2V5cGFkLmNsZWFyKCk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHJlZmVyZW5jZXMuIFRoZXNlIHJlZmVyZW5jZXMgYXJlIHJlbGVhc2VkIHdoZW4gdGhlIGVkaXQgaXMgY2FuY2VsZWQgb3IgZmluaXNoZWQuXHJcbiAgICB0aGlzLmVkaXRWYWx1ZSA9IGVkaXRWYWx1ZTtcclxuICAgIHRoaXMudmFsdWVSYW5nZSA9IHZhbHVlUmFuZ2U7XHJcbiAgICB0aGlzLmVkaXRGaW5pc2hlZENhbGxiYWNrID0gZWRpdEZpbmlzaGVkQ2FsbGJhY2s7XHJcblxyXG4gICAgLy8gQ2xlYXIgYSBwcmV2aW91cyB2YWx1ZSBvdXQgaWYgaXQgZXhpc3RzXHJcbiAgICB0aGlzLnJhbmdlU3RyaW5nUHJvcGVydHkgJiYgdGhpcy5yYW5nZVN0cmluZ1Byb3BlcnR5LmRpc3Bvc2UoKTtcclxuXHJcbiAgICB0aGlzLnJhbmdlU3RyaW5nUHJvcGVydHkgPSBuZXcgUGF0dGVyblN0cmluZ1Byb3BlcnR5KCBwYXR0ZXJuU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgbWluOiB2YWx1ZVJhbmdlLm1pbixcclxuICAgICAgbWF4OiB2YWx1ZVJhbmdlLm1heFxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5yYW5nZVRleHQubXV0YXRlKCB7XHJcbiAgICAgIHN0cmluZ1Byb3BlcnR5OiB0aGlzLnJhbmdlU3RyaW5nUHJvcGVydHlcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBEaXNwbGF5IHRoZSBLZXlwYWREaWFsb2cuXHJcbiAgICB0aGlzLnNob3coKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEF0dGVtcHRzIHRvIHN1Ym1pdCB0aGUgY3VycmVudCBLZXlwYWQgZWRpdC4gSWYgdGhlIGVkaXQgaXMgdmFsaWQsIHRoZSB2YWx1ZVByb3BlcnR5IGlzIHNldCBhbmQgdGhlIGVkaXQgaXNcclxuICAgKiBmaW5pc2hlZC4gT3RoZXJ3aXNlLCB0aGUgZWRpdCBpcyBpbnZhbGlkLCBhbmQgdGhlIHdhcm5PdXRPZlJhbmdlKCkgbWV0aG9kIGlzIGludm9rZWQuXHJcbiAgICpcclxuICAgKiBUaGlzIGlzIGNhbGxlZCB3aGVuIHRoZSB1c2VyIHByZXNzZXMgdGhlICdFbnRlcicgYnV0dG9uLlxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3VibWl0RWRpdCgpOiB2b2lkIHtcclxuXHJcbiAgICAvLyBJZiB0aGUgdXNlciBkaWRuJ3QgZW50ZXIgYW55dGhpbmcsIHRyZWF0IHRoaXMgYXMgYSBjYW5jZWwuXHJcbiAgICBpZiAoIHRoaXMua2V5cGFkLnN0cmluZ1Byb3BlcnR5LnZhbHVlID09PSAnJyApIHtcclxuICAgICAgdGhpcy5maW5pc2hFZGl0KCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXRyaWV2ZSB0aGUgdmFsdWUgZnJvbSB0aGUgS2V5cGFkXHJcbiAgICBjb25zdCB2YWx1ZSA9IHRoaXMua2V5cGFkLnZhbHVlUHJvcGVydHkudmFsdWU7XHJcblxyXG4gICAgLy8gSWYgdGhlIGVkaXQgaXMgdmFsaWQsIHRoZSB2YWx1ZVByb3BlcnR5IGlzIHNldCBhbmQgdGhlIGVkaXQuXHJcbiAgICBpZiAoIHZhbHVlICE9PSBudWxsICYmIE51bWJlci5pc0Zpbml0ZSggdmFsdWUgKSAmJiAoICF0aGlzLnZhbHVlUmFuZ2UgfHwgdGhpcy52YWx1ZVJhbmdlLmNvbnRhaW5zKCB2YWx1ZSApICkgKSB7XHJcbiAgICAgIHRoaXMuZWRpdFZhbHVlICE9PSBudWxsICYmIHRoaXMuZWRpdFZhbHVlKCB2YWx1ZSApO1xyXG4gICAgICB0aGlzLmZpbmlzaEVkaXQoKTtcclxuICAgIH1cclxuICAgIGVsc2UgeyB0aGlzLndhcm5PdXRPZlJhbmdlKCk7IH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoYW5nZXMgdGhlIHRleHQgY29sb3JzIG9mIHRoZSBWYWx1ZSBhbmQgdGhlIFJhbmdlIFRleHQgdG8gaW5kaWNhdGUgdGhhdCBhIGVudGVyZWQgRWRpdCBpcyBvdXQgb2YgcmFuZ2UuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB3YXJuT3V0T2ZSYW5nZSgpOiB2b2lkIHtcclxuICAgIHRoaXMudmFsdWVUZXh0LmZpbGwgPSB0aGlzLmVycm9yVGV4dENvbG9yO1xyXG4gICAgdGhpcy5yYW5nZVRleHQuZmlsbCA9IHRoaXMuZXJyb3JUZXh0Q29sb3I7XHJcbiAgICB0aGlzLmtleXBhZC5zZXRDbGVhck9uTmV4dEtleVByZXNzKCB0cnVlICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb252ZW5pZW5jZSBtZXRob2QgdG8gZmluaXNoIHRoZSBLZXlwYWREaWFsb2cuXHJcbiAgICpcclxuICAgKiBUaGlzIG1ldGhvZCBpcyBpbnZva2VkIHdoZW4gYSBlZGl0IGlzIGNhbmNlbGVkIG9yIHdoZW4gYSB2YWxpZCBlZGl0IGlzIGVudGVyZWQuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBmaW5pc2hFZGl0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5oaWRlKCk7IC8vIEhpZGUgdGhlIEtleXBhZERpYWxvZ1xyXG4gICAgdGhpcy5rZXlwYWQuY2xlYXIoKTsgLy8gQ2xlYXIgdGhlIEtleXBhZFxyXG5cclxuICAgIC8vIFJlbGVhc2UgcmVmZXJlbmNlcy5cclxuICAgIHRoaXMudmFsdWVSYW5nZSA9IG51bGw7XHJcbiAgICB0aGlzLmVkaXRGaW5pc2hlZENhbGxiYWNrID0gbnVsbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhpZGVzIHRoZSBkaWFsb2cuIE92ZXJyaWRkZW4gdG8gYWxzbyBjYWxsIHRoZSBlZGl0RmluaXNoZWRDYWxsYmFjayBmdW5jdGlvbiB3aGVuIGVkaXRzIGFyZSBjYW5jZWxlZC5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgaGlkZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZWRpdEZpbmlzaGVkQ2FsbGJhY2sgJiYgdGhpcy5lZGl0RmluaXNoZWRDYWxsYmFjaygpO1xyXG5cclxuICAgIHN1cGVyLmhpZGUoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5kaXNwb3NlS2V5cGFkRGlhbG9nKCk7XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5zY2VuZXJ5UGhldC5yZWdpc3RlciggJ0tleXBhZERpYWxvZycsIEtleXBhZERpYWxvZyApO1xyXG5leHBvcnQgZGVmYXVsdCBLZXlwYWREaWFsb2c7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLHFCQUFxQixNQUFNLDJDQUEyQztBQUU3RSxPQUFPQyxNQUFNLE1BQXVDLDJDQUEyQztBQUMvRixPQUFPQyxRQUFRLE1BQU0sc0NBQXNDO0FBQzNELFNBQVNDLEtBQUssRUFBUUMsZ0JBQWdCLEVBQUVDLElBQUksRUFBRUMsU0FBUyxFQUFFQyxRQUFRLEVBQVVDLElBQUksRUFBRUMsSUFBSSxRQUFRLGdDQUFnQztBQUM3SCxPQUFPQyxxQkFBcUIsTUFBd0Msa0RBQWtEO0FBQ3RILE9BQU9DLE1BQU0sTUFBeUIsMkJBQTJCO0FBQ2pFLE9BQU9DLFdBQVcsTUFBTSxtQkFBbUI7QUFDM0MsT0FBT0MsU0FBUyxJQUFJQyxjQUFjLFFBQVEsb0NBQW9DO0FBRTlFLE9BQU9DLGtCQUFrQixNQUFNLDBCQUEwQjtBQStCekQsTUFBTUMsWUFBWSxTQUFTTCxNQUFNLENBQUM7RUFFaEM7RUFDQTtFQUNRTSxTQUFTLEdBQXlDLElBQUk7O0VBRTlEO0VBQ1FDLFVBQVUsR0FBaUIsSUFBSTs7RUFFdkM7RUFDQTtFQUNRQyxvQkFBb0IsR0FBMEIsSUFBSTs7RUFFMUQ7O0VBR0E7O0VBR0E7RUFDUUMsbUJBQW1CLEdBQXFDLElBQUk7O0VBRXBFOztFQVFPQyxXQUFXQSxDQUFFQyxlQUFxQyxFQUFHO0lBRTFELE1BQU1DLE9BQU8sR0FBR1YsU0FBUyxDQUFrRCxDQUFDLENBQUU7TUFFNUVXLElBQUksRUFBRSxJQUFJdEIsUUFBUSxDQUFFLEVBQUcsQ0FBQztNQUV4QnVCLGFBQWEsRUFBRSxFQUFFO01BQ2pCQyxZQUFZ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