// Copyright 2017-2023, University of Colorado Boulder

/**
 * KeyboardHelpSection contains a section of text and icons for a KeyboardHelpDialog. Typically multiple KeyboardHelpSections
 * are assembled to describe the keyboard interactions for the sim. Takes a heading string for the section label and
 * an array of contents for rows of labels and icons.
 *
 * This type has many static functions for creating and laying out rows of content.
 * Default values for spacing and fonts are also available through statics if necessary.
 *
 * Help sections are aligned with two groups. Text labels are aligned in one VBox, icons are aligned in another. To
 * structure the accessible content, we chose to instrument a11y on the icons in the section. To label content
 * in your own KeyboardHelpSection, instrument the icons not the label Text so a11y content is placed correctly in the DOM.
 * KeyboardHelpSections are generally a list of items, so each icon has a  tagName of 'li' be default.
 *
 * @author Jesse Greenberg
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import StringProperty from '../../../../axon/js/StringProperty.js';
import { isTReadOnlyProperty } from '../../../../axon/js/TReadOnlyProperty.js';
import optionize, { combineOptions } from '../../../../phet-core/js/optionize.js';
import { HBox, ReadingBlock, Text, VBox } from '../../../../scenery/js/imports.js';
import ResponsePacket from '../../../../utterance-queue/js/ResponsePacket.js';
import PhetFont from '../../PhetFont.js';
import sceneryPhet from '../../sceneryPhet.js';
// heading defaults
const DEFAULT_HEADING_CONTENT_SPACING = 13; // spacing between h
const DEFAULT_HEADING_FONT = new PhetFont({
  size: 19,
  weight: 'bold'
});
const DEFAULT_LABEL_ICON_SPACING = 28; // spacing between Text labels and icons in a KeyboardHelpSectionRow
const DEFAULT_VERTICAL_ICON_SPACING = 13;

// text fonts and max widths
const DEFAULT_LABEL_MAX_WIDTH = 235;
const DEFAULT_HEADING_MAX_WIDTH = 335;
export default class KeyboardHelpSection extends ReadingBlock(VBox) {
  // the translatable heading for this section

  // collection of icons in this section

  // used by methods to adjust spacing if necessary

  static DEFAULT_VERTICAL_ICON_SPACING = DEFAULT_VERTICAL_ICON_SPACING;

  /**
   * @param headingString - the translatable heading for this section
   * @param content -  icons and labels are each placed in their own VBox, and these layout boxes are aligned
   *   horizontally. It is assumed that label and icon have identical bounds so that each row of content can be
   *   aligned by KeyboardHelpSection. Static functions in this file use AlignGroup to achieve this. For examples,
   *   see labelWithIcon() and labelWithIconList().
   * @param [providedOptions]
   */
  constructor(headingString, content, providedOptions) {
    const options = optionize()({
      // SelfOptions
      headingOptions: {
        font: DEFAULT_HEADING_FONT,
        maxWidth: DEFAULT_HEADING_MAX_WIDTH,
        // pdom
        tagName: 'h2',
        innerContent: headingString
      },
      textMaxWidth: DEFAULT_LABEL_MAX_WIDTH,
      vBoxOptions: {
        align: 'left',
        spacing: DEFAULT_VERTICAL_ICON_SPACING
      },
      a11yContentTagName: 'ul',
      // ParentOptions
      spacing: DEFAULT_HEADING_CONTENT_SPACING,
      align: 'left'
    }, providedOptions);

    // create the heading
    const headingText = new Text(headingString, options.headingOptions);

    // place icons in labels in unique layout boxes for alignment
    const icons = [];
    const labels = [];
    for (let i = 0; i < content.length; i++) {
      const helpSectionRow = content[i];
      assert && assert(helpSectionRow.text.maxWidth === null, 'KeyboardHelpSection sets maxWidth for children');
      helpSectionRow.text.maxWidth = options.textMaxWidth;
      icons.push(helpSectionRow.icon);
      labels.push(helpSectionRow.label);
    }

    // parent for all labels
    const labelVBox = new VBox(combineOptions({
      children: labels
    }, options.vBoxOptions));

    // parent for all icons
    const iconVBox = new VBox(combineOptions({
      children: icons,
      // pdom
      tagName: options.a11yContentTagName
    }, options.vBoxOptions));

    // labels and icons horizontally aligned
    const contentHBox = new HBox({
      children: [labelVBox, iconVBox],
      spacing: DEFAULT_LABEL_ICON_SPACING
    });

    // heading and content aligned in a VBox
    assert && assert(!options.children, 'KeyboardHelpSection sets children');
    options.children = [headingText, contentHBox];
    super(options);
    this.headingStringProperty = typeof headingString === 'string' ? new StringProperty(headingString) : headingString;
    this.icons = icons;
    this.iconVBox = iconVBox;
    this.contentHBox = contentHBox;
    this.keyboardHelpSectionRows = content;
    const readingBlockResponseProperty = this.createReadingBlockResponseProperty();
    this.setReadingBlockNameResponse(readingBlockResponseProperty);
    this.disposeKeyboardHelpSection = () => {
      readingBlockResponseProperty.dispose();
      headingText.dispose();
      this.keyboardHelpSectionRows = []; // defensive in case one row has a memory leak
    };
  }

  dispose() {
    this.disposeKeyboardHelpSection();
    super.dispose();
  }

  /**
   * Assemble the content that is read for this KeyboardHelpSection as a ReadingBlock. When
   * Voicing is enabled, activating the section will read all the content to the user.
   *
   * NOTE: Though this supports dynamic string Properties, this probably doesn't hold up for i18n. That said Voicing
   * does not support translation and that will have to be worked on another time.
   */
  createReadingBlockResponseProperty() {
    const dependencies = [this.headingStringProperty];
    for (let i = 0; i < this.keyboardHelpSectionRows.length; i++) {
      const keyboardHelpSectionRow = this.keyboardHelpSectionRows[i];
      if (isTReadOnlyProperty(keyboardHelpSectionRow.readingBlockContent)) {
        dependencies.push(keyboardHelpSectionRow.readingBlockContent);
      }
    }
    return DerivedProperty.deriveAny(dependencies, () => {
      let readingBlockNameResponse = '';

      // Include the section heading. Headings typically don't have punctuation, but don't use a period because
      // it may appear to the synth as an abbreviation and change the pronunciation.
      readingBlockNameResponse += `${this.headingStringProperty.value}, `;

      // Append the readingBlockNameResponse assigned to each row.
      this.keyboardHelpSectionRows.forEach(row => {
        if (row.readingBlockContent) {
          readingBlockNameResponse += `${ResponsePacket.getResponseText(row.readingBlockContent)} `;
        }
      });
      return readingBlockNameResponse;
    });
  }

  /**
   * Vertically align icons for a number of different KeyboardHelpSections. Useful when two KeyboardHelpSection
   * sections are stacked vertically in a Dialog. Loops through sectionArray and finds the max x value of the left
   * edge of the icon VBox. Then increases spacing of all other content HBoxes accordingly.
   */
  static alignHelpSectionIcons(sectionArray) {
    assert && assert(sectionArray.length > 0, 'Must provide at least one KeyboardHelpSection to align.');

    // left edge of icons farthest to the right in the array of KeyboardHelpSection
    const leftMostKeyboardHelpSection = _.maxBy(sectionArray, section => section.iconVBox.left);
    assert && assert(leftMostKeyboardHelpSection, 'There must be a KeyboardHelpSection if sectionArray has entries.');
    const maxLeftEdge = leftMostKeyboardHelpSection.iconVBox.left;

    // adjust the spacing of all section HBoxes so that they align
    sectionArray.forEach(section => {
      section.contentHBox.spacing = section.contentHBox.spacing + maxLeftEdge - section.iconVBox.left;
    });
  }
}
sceneryPhet.register('KeyboardHelpSection', KeyboardHelpSection);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJTdHJpbmdQcm9wZXJ0eSIsImlzVFJlYWRPbmx5UHJvcGVydHkiLCJvcHRpb25pemUiLCJjb21iaW5lT3B0aW9ucyIsIkhCb3giLCJSZWFkaW5nQmxvY2siLCJUZXh0IiwiVkJveCIsIlJlc3BvbnNlUGFja2V0IiwiUGhldEZvbnQiLCJzY2VuZXJ5UGhldCIsIkRFRkFVTFRfSEVBRElOR19DT05URU5UX1NQQUNJTkciLCJERUZBVUxUX0hFQURJTkdfRk9OVCIsInNpemUiLCJ3ZWlnaHQiLCJERUZBVUxUX0xBQkVMX0lDT05fU1BBQ0lORyIsIkRFRkFVTFRfVkVSVElDQUxfSUNPTl9TUEFDSU5HIiwiREVGQVVMVF9MQUJFTF9NQVhfV0lEVEgiLCJERUZBVUxUX0hFQURJTkdfTUFYX1dJRFRIIiwiS2V5Ym9hcmRIZWxwU2VjdGlvbiIsImNvbnN0cnVjdG9yIiwiaGVhZGluZ1N0cmluZyIsImNvbnRlbnQiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwiaGVhZGluZ09wdGlvbnMiLCJmb250IiwibWF4V2lkdGgiLCJ0YWdOYW1lIiwiaW5uZXJDb250ZW50IiwidGV4dE1heFdpZHRoIiwidkJveE9wdGlvbnMiLCJhbGlnbiIsInNwYWNpbmciLCJhMTF5Q29udGVudFRhZ05hbWUiLCJoZWFkaW5nVGV4dCIsImljb25zIiwibGFiZWxzIiwiaSIsImxlbmd0aCIsImhlbHBTZWN0aW9uUm93IiwiYXNzZXJ0IiwidGV4dCIsInB1c2giLCJpY29uIiwibGFiZWwiLCJsYWJlbFZCb3giLCJjaGlsZHJlbiIsImljb25WQm94IiwiY29udGVudEhCb3giLCJoZWFkaW5nU3RyaW5nUHJvcGVydHkiLCJrZXlib2FyZEhlbHBTZWN0aW9uUm93cyIsInJlYWRpbmdCbG9ja1Jlc3BvbnNlUHJvcGVydHkiLCJjcmVhdGVSZWFkaW5nQmxvY2tSZXNwb25zZVByb3BlcnR5Iiwic2V0UmVhZGluZ0Jsb2NrTmFtZVJlc3BvbnNlIiwiZGlzcG9zZUtleWJvYXJkSGVscFNlY3Rpb24iLCJkaXNwb3NlIiwiZGVwZW5kZW5jaWVzIiwia2V5Ym9hcmRIZWxwU2VjdGlvblJvdyIsInJlYWRpbmdCbG9ja0NvbnRlbnQiLCJkZXJpdmVBbnkiLCJyZWFkaW5nQmxvY2tOYW1lUmVzcG9uc2UiLCJ2YWx1ZSIsImZvckVhY2giLCJyb3ciLCJnZXRSZXNwb25zZVRleHQiLCJhbGlnbkhlbHBTZWN0aW9uSWNvbnMiLCJzZWN0aW9uQXJyYXkiLCJsZWZ0TW9zdEtleWJvYXJkSGVscFNlY3Rpb24iLCJfIiwibWF4QnkiLCJzZWN0aW9uIiwibGVmdCIsIm1heExlZnRFZGdlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJLZXlib2FyZEhlbHBTZWN0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE3LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEtleWJvYXJkSGVscFNlY3Rpb24gY29udGFpbnMgYSBzZWN0aW9uIG9mIHRleHQgYW5kIGljb25zIGZvciBhIEtleWJvYXJkSGVscERpYWxvZy4gVHlwaWNhbGx5IG11bHRpcGxlIEtleWJvYXJkSGVscFNlY3Rpb25zXHJcbiAqIGFyZSBhc3NlbWJsZWQgdG8gZGVzY3JpYmUgdGhlIGtleWJvYXJkIGludGVyYWN0aW9ucyBmb3IgdGhlIHNpbS4gVGFrZXMgYSBoZWFkaW5nIHN0cmluZyBmb3IgdGhlIHNlY3Rpb24gbGFiZWwgYW5kXHJcbiAqIGFuIGFycmF5IG9mIGNvbnRlbnRzIGZvciByb3dzIG9mIGxhYmVscyBhbmQgaWNvbnMuXHJcbiAqXHJcbiAqIFRoaXMgdHlwZSBoYXMgbWFueSBzdGF0aWMgZnVuY3Rpb25zIGZvciBjcmVhdGluZyBhbmQgbGF5aW5nIG91dCByb3dzIG9mIGNvbnRlbnQuXHJcbiAqIERlZmF1bHQgdmFsdWVzIGZvciBzcGFjaW5nIGFuZCBmb250cyBhcmUgYWxzbyBhdmFpbGFibGUgdGhyb3VnaCBzdGF0aWNzIGlmIG5lY2Vzc2FyeS5cclxuICpcclxuICogSGVscCBzZWN0aW9ucyBhcmUgYWxpZ25lZCB3aXRoIHR3byBncm91cHMuIFRleHQgbGFiZWxzIGFyZSBhbGlnbmVkIGluIG9uZSBWQm94LCBpY29ucyBhcmUgYWxpZ25lZCBpbiBhbm90aGVyLiBUb1xyXG4gKiBzdHJ1Y3R1cmUgdGhlIGFjY2Vzc2libGUgY29udGVudCwgd2UgY2hvc2UgdG8gaW5zdHJ1bWVudCBhMTF5IG9uIHRoZSBpY29ucyBpbiB0aGUgc2VjdGlvbi4gVG8gbGFiZWwgY29udGVudFxyXG4gKiBpbiB5b3VyIG93biBLZXlib2FyZEhlbHBTZWN0aW9uLCBpbnN0cnVtZW50IHRoZSBpY29ucyBub3QgdGhlIGxhYmVsIFRleHQgc28gYTExeSBjb250ZW50IGlzIHBsYWNlZCBjb3JyZWN0bHkgaW4gdGhlIERPTS5cclxuICogS2V5Ym9hcmRIZWxwU2VjdGlvbnMgYXJlIGdlbmVyYWxseSBhIGxpc3Qgb2YgaXRlbXMsIHNvIGVhY2ggaWNvbiBoYXMgYSAgdGFnTmFtZSBvZiAnbGknIGJlIGRlZmF1bHQuXHJcbiAqXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnXHJcbiAqL1xyXG5cclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBTdHJpbmdQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1N0cmluZ1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5LCB7IGlzVFJlYWRPbmx5UHJvcGVydHkgfSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBjb21iaW5lT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgU3RyaWN0T21pdCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvU3RyaWN0T21pdC5qcyc7XHJcbmltcG9ydCB7IEhCb3gsIE5vZGUsIFJlYWRpbmdCbG9jaywgUmVhZGluZ0Jsb2NrT3B0aW9ucywgVGV4dCwgVGV4dE9wdGlvbnMsIFZCb3gsIFZCb3hPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFJlc3BvbnNlUGFja2V0IGZyb20gJy4uLy4uLy4uLy4uL3V0dGVyYW5jZS1xdWV1ZS9qcy9SZXNwb25zZVBhY2tldC5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCBzY2VuZXJ5UGhldCBmcm9tICcuLi8uLi9zY2VuZXJ5UGhldC5qcyc7XHJcbmltcG9ydCBLZXlib2FyZEhlbHBTZWN0aW9uUm93IGZyb20gJy4vS2V5Ym9hcmRIZWxwU2VjdGlvblJvdy5qcyc7XHJcblxyXG4vLyBoZWFkaW5nIGRlZmF1bHRzXHJcbmNvbnN0IERFRkFVTFRfSEVBRElOR19DT05URU5UX1NQQUNJTkcgPSAxMzsgLy8gc3BhY2luZyBiZXR3ZWVuIGhcclxuY29uc3QgREVGQVVMVF9IRUFESU5HX0ZPTlQgPSBuZXcgUGhldEZvbnQoIHsgc2l6ZTogMTksIHdlaWdodDogJ2JvbGQnIH0gKTtcclxuXHJcbmNvbnN0IERFRkFVTFRfTEFCRUxfSUNPTl9TUEFDSU5HID0gMjg7IC8vIHNwYWNpbmcgYmV0d2VlbiBUZXh0IGxhYmVscyBhbmQgaWNvbnMgaW4gYSBLZXlib2FyZEhlbHBTZWN0aW9uUm93XHJcbmNvbnN0IERFRkFVTFRfVkVSVElDQUxfSUNPTl9TUEFDSU5HID0gMTM7XHJcblxyXG4vLyB0ZXh0IGZvbnRzIGFuZCBtYXggd2lkdGhzXHJcbmNvbnN0IERFRkFVTFRfTEFCRUxfTUFYX1dJRFRIID0gMjM1O1xyXG5jb25zdCBERUZBVUxUX0hFQURJTkdfTUFYX1dJRFRIID0gMzM1O1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuXHJcbiAgLy8gcHJvcGFnYXRlZCB0byB0aGUgVGV4dCBmb3IgdGhlIHNlY3Rpb24gaGVhZGluZ1xyXG4gIGhlYWRpbmdPcHRpb25zPzogVGV4dE9wdGlvbnM7XHJcblxyXG4gIC8vIFVzZWQgYXMgbWF4V2lkdGggZm9yIGVhY2ggS2V5Ym9hcmRIZWxwU2VjdGlvblJvdy50ZXh0XHJcbiAgdGV4dE1heFdpZHRoPzogbnVtYmVyO1xyXG5cclxuICAvLyBwcm9wYWdhdGVkIHRvIFZCb3ggZm9yIGxheW91dFxyXG4gIHZCb3hPcHRpb25zPzogU3RyaWN0T21pdDxWQm94T3B0aW9ucywgJ3RhZ05hbWUnPjtcclxuXHJcbiAgLy8gdGFnIG5hbWUgZm9yIHRoZSBlbnRpcmUgY29udGVudCwgdXN1YWxseSBjb250ZW50IGlzIGEgbGlzdCBvZiBpdGVtc1xyXG4gIGExMXlDb250ZW50VGFnTmFtZT86IHN0cmluZyB8IG51bGw7XHJcbn07XHJcbnR5cGUgUGFyZW50T3B0aW9ucyA9IFJlYWRpbmdCbG9ja09wdGlvbnMgJiBWQm94T3B0aW9ucztcclxuZXhwb3J0IHR5cGUgS2V5Ym9hcmRIZWxwU2VjdGlvbk9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBhcmVudE9wdGlvbnM7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLZXlib2FyZEhlbHBTZWN0aW9uIGV4dGVuZHMgUmVhZGluZ0Jsb2NrKCBWQm94ICkge1xyXG5cclxuICAvLyB0aGUgdHJhbnNsYXRhYmxlIGhlYWRpbmcgZm9yIHRoaXMgc2VjdGlvblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgaGVhZGluZ1N0cmluZ1Byb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+O1xyXG5cclxuICAvLyBjb2xsZWN0aW9uIG9mIGljb25zIGluIHRoaXMgc2VjdGlvblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgaWNvbnM6IE5vZGVbXTtcclxuXHJcbiAgcHJpdmF0ZSBrZXlib2FyZEhlbHBTZWN0aW9uUm93czogS2V5Ym9hcmRIZWxwU2VjdGlvblJvd1tdO1xyXG5cclxuICAvLyB1c2VkIGJ5IG1ldGhvZHMgdG8gYWRqdXN0IHNwYWNpbmcgaWYgbmVjZXNzYXJ5XHJcbiAgcHJpdmF0ZSByZWFkb25seSBpY29uVkJveDogVkJveDtcclxuICBwcml2YXRlIHJlYWRvbmx5IGNvbnRlbnRIQm94OiBIQm94O1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGRpc3Bvc2VLZXlib2FyZEhlbHBTZWN0aW9uOiAoKSA9PiB2b2lkO1xyXG5cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IERFRkFVTFRfVkVSVElDQUxfSUNPTl9TUEFDSU5HID0gREVGQVVMVF9WRVJUSUNBTF9JQ09OX1NQQUNJTkc7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBoZWFkaW5nU3RyaW5nIC0gdGhlIHRyYW5zbGF0YWJsZSBoZWFkaW5nIGZvciB0aGlzIHNlY3Rpb25cclxuICAgKiBAcGFyYW0gY29udGVudCAtICBpY29ucyBhbmQgbGFiZWxzIGFyZSBlYWNoIHBsYWNlZCBpbiB0aGVpciBvd24gVkJveCwgYW5kIHRoZXNlIGxheW91dCBib3hlcyBhcmUgYWxpZ25lZFxyXG4gICAqICAgaG9yaXpvbnRhbGx5LiBJdCBpcyBhc3N1bWVkIHRoYXQgbGFiZWwgYW5kIGljb24gaGF2ZSBpZGVudGljYWwgYm91bmRzIHNvIHRoYXQgZWFjaCByb3cgb2YgY29udGVudCBjYW4gYmVcclxuICAgKiAgIGFsaWduZWQgYnkgS2V5Ym9hcmRIZWxwU2VjdGlvbi4gU3RhdGljIGZ1bmN0aW9ucyBpbiB0aGlzIGZpbGUgdXNlIEFsaWduR3JvdXAgdG8gYWNoaWV2ZSB0aGlzLiBGb3IgZXhhbXBsZXMsXHJcbiAgICogICBzZWUgbGFiZWxXaXRoSWNvbigpIGFuZCBsYWJlbFdpdGhJY29uTGlzdCgpLlxyXG4gICAqIEBwYXJhbSBbcHJvdmlkZWRPcHRpb25zXVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggaGVhZGluZ1N0cmluZzogc3RyaW5nIHwgVFJlYWRPbmx5UHJvcGVydHk8c3RyaW5nPiwgY29udGVudDogS2V5Ym9hcmRIZWxwU2VjdGlvblJvd1tdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZWRPcHRpb25zPzogS2V5Ym9hcmRIZWxwU2VjdGlvbk9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxLZXlib2FyZEhlbHBTZWN0aW9uT3B0aW9ucywgU2VsZk9wdGlvbnMsIFBhcmVudE9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIFNlbGZPcHRpb25zXHJcbiAgICAgIGhlYWRpbmdPcHRpb25zOiB7XHJcbiAgICAgICAgZm9udDogREVGQVVMVF9IRUFESU5HX0ZPTlQsXHJcbiAgICAgICAgbWF4V2lkdGg6IERFRkFVTFRfSEVBRElOR19NQVhfV0lEVEgsXHJcblxyXG4gICAgICAgIC8vIHBkb21cclxuICAgICAgICB0YWdOYW1lOiAnaDInLFxyXG5cclxuICAgICAgICBpbm5lckNvbnRlbnQ6IGhlYWRpbmdTdHJpbmdcclxuICAgICAgfSxcclxuICAgICAgdGV4dE1heFdpZHRoOiBERUZBVUxUX0xBQkVMX01BWF9XSURUSCxcclxuICAgICAgdkJveE9wdGlvbnM6IHtcclxuICAgICAgICBhbGlnbjogJ2xlZnQnLFxyXG4gICAgICAgIHNwYWNpbmc6IERFRkFVTFRfVkVSVElDQUxfSUNPTl9TUEFDSU5HXHJcbiAgICAgIH0sXHJcbiAgICAgIGExMXlDb250ZW50VGFnTmFtZTogJ3VsJyxcclxuXHJcbiAgICAgIC8vIFBhcmVudE9wdGlvbnNcclxuICAgICAgc3BhY2luZzogREVGQVVMVF9IRUFESU5HX0NPTlRFTlRfU1BBQ0lORyxcclxuICAgICAgYWxpZ246ICdsZWZ0J1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gY3JlYXRlIHRoZSBoZWFkaW5nXHJcbiAgICBjb25zdCBoZWFkaW5nVGV4dCA9IG5ldyBUZXh0KCBoZWFkaW5nU3RyaW5nLCBvcHRpb25zLmhlYWRpbmdPcHRpb25zICk7XHJcblxyXG4gICAgLy8gcGxhY2UgaWNvbnMgaW4gbGFiZWxzIGluIHVuaXF1ZSBsYXlvdXQgYm94ZXMgZm9yIGFsaWdubWVudFxyXG4gICAgY29uc3QgaWNvbnMgPSBbXTtcclxuICAgIGNvbnN0IGxhYmVscyA9IFtdO1xyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgY29udGVudC5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgY29uc3QgaGVscFNlY3Rpb25Sb3cgPSBjb250ZW50WyBpIF07XHJcblxyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCBoZWxwU2VjdGlvblJvdy50ZXh0Lm1heFdpZHRoID09PSBudWxsLCAnS2V5Ym9hcmRIZWxwU2VjdGlvbiBzZXRzIG1heFdpZHRoIGZvciBjaGlsZHJlbicgKTtcclxuICAgICAgaGVscFNlY3Rpb25Sb3cudGV4dC5tYXhXaWR0aCA9IG9wdGlvbnMudGV4dE1heFdpZHRoO1xyXG5cclxuICAgICAgaWNvbnMucHVzaCggaGVscFNlY3Rpb25Sb3cuaWNvbiApO1xyXG4gICAgICBsYWJlbHMucHVzaCggaGVscFNlY3Rpb25Sb3cubGFiZWwgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBwYXJlbnQgZm9yIGFsbCBsYWJlbHNcclxuICAgIGNvbnN0IGxhYmVsVkJveCA9IG5ldyBWQm94KCBjb21iaW5lT3B0aW9uczxWQm94T3B0aW9ucz4oIHtcclxuICAgICAgY2hpbGRyZW46IGxhYmVsc1xyXG4gICAgfSwgb3B0aW9ucy52Qm94T3B0aW9ucyApICk7XHJcblxyXG4gICAgLy8gcGFyZW50IGZvciBhbGwgaWNvbnNcclxuICAgIGNvbnN0IGljb25WQm94ID0gbmV3IFZCb3goIGNvbWJpbmVPcHRpb25zPFZCb3hPcHRpb25zPigge1xyXG4gICAgICBjaGlsZHJlbjogaWNvbnMsXHJcblxyXG4gICAgICAvLyBwZG9tXHJcbiAgICAgIHRhZ05hbWU6IG9wdGlvbnMuYTExeUNvbnRlbnRUYWdOYW1lXHJcbiAgICB9LCBvcHRpb25zLnZCb3hPcHRpb25zICkgKTtcclxuXHJcbiAgICAvLyBsYWJlbHMgYW5kIGljb25zIGhvcml6b250YWxseSBhbGlnbmVkXHJcbiAgICBjb25zdCBjb250ZW50SEJveCA9IG5ldyBIQm94KCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIGxhYmVsVkJveCwgaWNvblZCb3ggXSxcclxuICAgICAgc3BhY2luZzogREVGQVVMVF9MQUJFTF9JQ09OX1NQQUNJTkdcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBoZWFkaW5nIGFuZCBjb250ZW50IGFsaWduZWQgaW4gYSBWQm94XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCAhb3B0aW9ucy5jaGlsZHJlbiwgJ0tleWJvYXJkSGVscFNlY3Rpb24gc2V0cyBjaGlsZHJlbicgKTtcclxuICAgIG9wdGlvbnMuY2hpbGRyZW4gPSBbIGhlYWRpbmdUZXh0LCBjb250ZW50SEJveCBdO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5oZWFkaW5nU3RyaW5nUHJvcGVydHkgPSAoIHR5cGVvZiBoZWFkaW5nU3RyaW5nID09PSAnc3RyaW5nJyApID8gbmV3IFN0cmluZ1Byb3BlcnR5KCBoZWFkaW5nU3RyaW5nICkgOiBoZWFkaW5nU3RyaW5nO1xyXG4gICAgdGhpcy5pY29ucyA9IGljb25zO1xyXG4gICAgdGhpcy5pY29uVkJveCA9IGljb25WQm94O1xyXG4gICAgdGhpcy5jb250ZW50SEJveCA9IGNvbnRlbnRIQm94O1xyXG4gICAgdGhpcy5rZXlib2FyZEhlbHBTZWN0aW9uUm93cyA9IGNvbnRlbnQ7XHJcblxyXG4gICAgY29uc3QgcmVhZGluZ0Jsb2NrUmVzcG9uc2VQcm9wZXJ0eSA9IHRoaXMuY3JlYXRlUmVhZGluZ0Jsb2NrUmVzcG9uc2VQcm9wZXJ0eSgpO1xyXG4gICAgdGhpcy5zZXRSZWFkaW5nQmxvY2tOYW1lUmVzcG9uc2UoIHJlYWRpbmdCbG9ja1Jlc3BvbnNlUHJvcGVydHkgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VLZXlib2FyZEhlbHBTZWN0aW9uID0gKCkgPT4ge1xyXG4gICAgICByZWFkaW5nQmxvY2tSZXNwb25zZVByb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgaGVhZGluZ1RleHQuZGlzcG9zZSgpO1xyXG4gICAgICB0aGlzLmtleWJvYXJkSGVscFNlY3Rpb25Sb3dzID0gW107IC8vIGRlZmVuc2l2ZSBpbiBjYXNlIG9uZSByb3cgaGFzIGEgbWVtb3J5IGxlYWtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZGlzcG9zZUtleWJvYXJkSGVscFNlY3Rpb24oKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFzc2VtYmxlIHRoZSBjb250ZW50IHRoYXQgaXMgcmVhZCBmb3IgdGhpcyBLZXlib2FyZEhlbHBTZWN0aW9uIGFzIGEgUmVhZGluZ0Jsb2NrLiBXaGVuXHJcbiAgICogVm9pY2luZyBpcyBlbmFibGVkLCBhY3RpdmF0aW5nIHRoZSBzZWN0aW9uIHdpbGwgcmVhZCBhbGwgdGhlIGNvbnRlbnQgdG8gdGhlIHVzZXIuXHJcbiAgICpcclxuICAgKiBOT1RFOiBUaG91Z2ggdGhpcyBzdXBwb3J0cyBkeW5hbWljIHN0cmluZyBQcm9wZXJ0aWVzLCB0aGlzIHByb2JhYmx5IGRvZXNuJ3QgaG9sZCB1cCBmb3IgaTE4bi4gVGhhdCBzYWlkIFZvaWNpbmdcclxuICAgKiBkb2VzIG5vdCBzdXBwb3J0IHRyYW5zbGF0aW9uIGFuZCB0aGF0IHdpbGwgaGF2ZSB0byBiZSB3b3JrZWQgb24gYW5vdGhlciB0aW1lLlxyXG4gICAqL1xyXG4gIHByaXZhdGUgY3JlYXRlUmVhZGluZ0Jsb2NrUmVzcG9uc2VQcm9wZXJ0eSgpOiBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+IHtcclxuXHJcbiAgICBjb25zdCBkZXBlbmRlbmNpZXM6IFRSZWFkT25seVByb3BlcnR5PHVua25vd24+W10gPSBbIHRoaXMuaGVhZGluZ1N0cmluZ1Byb3BlcnR5IF07XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmtleWJvYXJkSGVscFNlY3Rpb25Sb3dzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBjb25zdCBrZXlib2FyZEhlbHBTZWN0aW9uUm93ID0gdGhpcy5rZXlib2FyZEhlbHBTZWN0aW9uUm93c1sgaSBdO1xyXG5cclxuICAgICAgaWYgKCBpc1RSZWFkT25seVByb3BlcnR5KCBrZXlib2FyZEhlbHBTZWN0aW9uUm93LnJlYWRpbmdCbG9ja0NvbnRlbnQgKSApIHtcclxuICAgICAgICBkZXBlbmRlbmNpZXMucHVzaCgga2V5Ym9hcmRIZWxwU2VjdGlvblJvdy5yZWFkaW5nQmxvY2tDb250ZW50ICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gRGVyaXZlZFByb3BlcnR5LmRlcml2ZUFueSggZGVwZW5kZW5jaWVzLCAoKSA9PiB7XHJcblxyXG4gICAgICBsZXQgcmVhZGluZ0Jsb2NrTmFtZVJlc3BvbnNlID0gJyc7XHJcblxyXG4gICAgICAvLyBJbmNsdWRlIHRoZSBzZWN0aW9uIGhlYWRpbmcuIEhlYWRpbmdzIHR5cGljYWxseSBkb24ndCBoYXZlIHB1bmN0dWF0aW9uLCBidXQgZG9uJ3QgdXNlIGEgcGVyaW9kIGJlY2F1c2VcclxuICAgICAgLy8gaXQgbWF5IGFwcGVhciB0byB0aGUgc3ludGggYXMgYW4gYWJicmV2aWF0aW9uIGFuZCBjaGFuZ2UgdGhlIHByb251bmNpYXRpb24uXHJcbiAgICAgIHJlYWRpbmdCbG9ja05hbWVSZXNwb25zZSArPSBgJHt0aGlzLmhlYWRpbmdTdHJpbmdQcm9wZXJ0eS52YWx1ZX0sIGA7XHJcblxyXG4gICAgICAvLyBBcHBlbmQgdGhlIHJlYWRpbmdCbG9ja05hbWVSZXNwb25zZSBhc3NpZ25lZCB0byBlYWNoIHJvdy5cclxuICAgICAgdGhpcy5rZXlib2FyZEhlbHBTZWN0aW9uUm93cy5mb3JFYWNoKCByb3cgPT4ge1xyXG4gICAgICAgIGlmICggcm93LnJlYWRpbmdCbG9ja0NvbnRlbnQgKSB7XHJcbiAgICAgICAgICByZWFkaW5nQmxvY2tOYW1lUmVzcG9uc2UgKz0gYCR7UmVzcG9uc2VQYWNrZXQuZ2V0UmVzcG9uc2VUZXh0KCByb3cucmVhZGluZ0Jsb2NrQ29udGVudCApfSBgO1xyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG4gICAgICByZXR1cm4gcmVhZGluZ0Jsb2NrTmFtZVJlc3BvbnNlO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmVydGljYWxseSBhbGlnbiBpY29ucyBmb3IgYSBudW1iZXIgb2YgZGlmZmVyZW50IEtleWJvYXJkSGVscFNlY3Rpb25zLiBVc2VmdWwgd2hlbiB0d28gS2V5Ym9hcmRIZWxwU2VjdGlvblxyXG4gICAqIHNlY3Rpb25zIGFyZSBzdGFja2VkIHZlcnRpY2FsbHkgaW4gYSBEaWFsb2cuIExvb3BzIHRocm91Z2ggc2VjdGlvbkFycmF5IGFuZCBmaW5kcyB0aGUgbWF4IHggdmFsdWUgb2YgdGhlIGxlZnRcclxuICAgKiBlZGdlIG9mIHRoZSBpY29uIFZCb3guIFRoZW4gaW5jcmVhc2VzIHNwYWNpbmcgb2YgYWxsIG90aGVyIGNvbnRlbnQgSEJveGVzIGFjY29yZGluZ2x5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgYWxpZ25IZWxwU2VjdGlvbkljb25zKCBzZWN0aW9uQXJyYXk6IEtleWJvYXJkSGVscFNlY3Rpb25bXSApOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHNlY3Rpb25BcnJheS5sZW5ndGggPiAwLCAnTXVzdCBwcm92aWRlIGF0IGxlYXN0IG9uZSBLZXlib2FyZEhlbHBTZWN0aW9uIHRvIGFsaWduLicgKTtcclxuXHJcbiAgICAvLyBsZWZ0IGVkZ2Ugb2YgaWNvbnMgZmFydGhlc3QgdG8gdGhlIHJpZ2h0IGluIHRoZSBhcnJheSBvZiBLZXlib2FyZEhlbHBTZWN0aW9uXHJcbiAgICBjb25zdCBsZWZ0TW9zdEtleWJvYXJkSGVscFNlY3Rpb24gPSBfLm1heEJ5KCBzZWN0aW9uQXJyYXksIHNlY3Rpb24gPT4gc2VjdGlvbi5pY29uVkJveC5sZWZ0ICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBsZWZ0TW9zdEtleWJvYXJkSGVscFNlY3Rpb24sXHJcbiAgICAgICdUaGVyZSBtdXN0IGJlIGEgS2V5Ym9hcmRIZWxwU2VjdGlvbiBpZiBzZWN0aW9uQXJyYXkgaGFzIGVudHJpZXMuJyApO1xyXG4gICAgY29uc3QgbWF4TGVmdEVkZ2UgPSBsZWZ0TW9zdEtleWJvYXJkSGVscFNlY3Rpb24hLmljb25WQm94LmxlZnQ7XHJcblxyXG4gICAgLy8gYWRqdXN0IHRoZSBzcGFjaW5nIG9mIGFsbCBzZWN0aW9uIEhCb3hlcyBzbyB0aGF0IHRoZXkgYWxpZ25cclxuICAgIHNlY3Rpb25BcnJheS5mb3JFYWNoKCBzZWN0aW9uID0+IHtcclxuICAgICAgc2VjdGlvbi5jb250ZW50SEJveC5zcGFjaW5nID0gc2VjdGlvbi5jb250ZW50SEJveC5zcGFjaW5nICsgbWF4TGVmdEVkZ2UgLSBzZWN0aW9uLmljb25WQm94LmxlZnQ7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG5zY2VuZXJ5UGhldC5yZWdpc3RlciggJ0tleWJvYXJkSGVscFNlY3Rpb24nLCBLZXlib2FyZEhlbHBTZWN0aW9uICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxjQUFjLE1BQU0sdUNBQXVDO0FBQ2xFLFNBQTRCQyxtQkFBbUIsUUFBUSwwQ0FBMEM7QUFDakcsT0FBT0MsU0FBUyxJQUFJQyxjQUFjLFFBQVEsdUNBQXVDO0FBRWpGLFNBQVNDLElBQUksRUFBUUMsWUFBWSxFQUF1QkMsSUFBSSxFQUFlQyxJQUFJLFFBQXFCLG1DQUFtQztBQUN2SSxPQUFPQyxjQUFjLE1BQU0sa0RBQWtEO0FBQzdFLE9BQU9DLFFB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