// Copyright 2019-2023, University of Colorado Boulder

/**
 * Reusable icons to be created for keyboard help shortcuts dialogs.
 * This type is only a collection of static methods, and should not be instantiated.
 *
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

import Dimension2 from '../../../../dot/js/Dimension2.js';
import optionize, { combineOptions } from '../../../../phet-core/js/optionize.js';
import { HBox, Node, Text } from '../../../../scenery/js/imports.js';
import PhetFont from '../../PhetFont.js';
import PlusNode from '../../PlusNode.js';
import sceneryPhet from '../../sceneryPhet.js';
import SceneryPhetStrings from '../../SceneryPhetStrings.js';
import ArrowKeyNode from '../ArrowKeyNode.js';
import LetterKeyNode from '../LetterKeyNode.js';
import TextKeyNode from '../TextKeyNode.js';

// constants
const DEFAULT_HORIZONTAL_KEY_SPACING = 1.3;
const OR_TEXT_MAX_WIDTH = 16;
const LABEL_FONT = new PhetFont(16);

// Options for most static methods herein

// Options for the handful of static methods that additionally involve PlusNode

export default class KeyboardHelpIconFactory {
  static DEFAULT_ICON_SPACING = 6.5;
  constructor() {
    assert && assert(false, 'do not construct this, instead use its helper static methods for icon creation');
  }

  /**
   * Horizontal layout of a set of icons, in left-to-right order.
   */
  static iconRow(icons, providedOptions) {
    const options = optionize()({
      spacing: DEFAULT_HORIZONTAL_KEY_SPACING,
      children: icons
    }, providedOptions);
    return new HBox(options);
  }

  /**
   * Two icons with horizontal layout, separated by 'or' text.
   */
  static iconOrIcon(leftIcon, rightIcon, providedOptions) {
    const options = combineOptions({
      spacing: KeyboardHelpIconFactory.DEFAULT_ICON_SPACING
    }, providedOptions);
    const orText = new Text(SceneryPhetStrings.keyboardHelpDialog.orStringProperty, {
      font: LABEL_FONT,
      maxWidth: OR_TEXT_MAX_WIDTH
    });
    const icon = KeyboardHelpIconFactory.iconRow([new Node({
      children: [leftIcon]
    }), orText, new Node({
      children: [rightIcon]
    })], options);
    icon.disposeEmitter.addListener(() => orText.dispose());
    return icon;
  }

  /**
   * Two icons with horizontal layout, and separated by '-' text. This is useful for a range, like 0-9.
   */
  static iconToIcon(leftIcon, rightIcon, providedOptions) {
    const options = combineOptions({
      spacing: KeyboardHelpIconFactory.DEFAULT_ICON_SPACING / 2
    }, providedOptions);
    const hyphenText = new Text(SceneryPhetStrings.keyboardHelpDialog.hyphenStringProperty, {
      font: LABEL_FONT,
      maxWidth: OR_TEXT_MAX_WIDTH
    });
    const icon = KeyboardHelpIconFactory.iconRow([new Node({
      children: [leftIcon]
    }), hyphenText, new Node({
      children: [rightIcon]
    })], options);
    icon.disposeEmitter.addListener(() => hyphenText.dispose());
    return icon;
  }

  /**
   * Two icons with horizontal layout, separated by '+' text.
   */
  static iconPlusIcon(leftIcon, rightIcon, providedOptions) {
    return KeyboardHelpIconFactory.iconPlusIconRow([leftIcon, rightIcon], providedOptions);
  }

  /**
   * Returns a row of icons separated by '+'. Useful when a keyboard shortcut has multiple modifier keys for one
   * key press listener.
   */
  static iconPlusIconRow(iconList, providedOptions) {
    const options = combineOptions({
      plusIconSize: new Dimension2(8, 1.2),
      spacing: KeyboardHelpIconFactory.DEFAULT_ICON_SPACING
    }, providedOptions);

    // Weave plus icons into the provided array of icons. Like Array.join, but with a new array instead of a string.
    const iconListWithSeparators = [];
    for (let i = 0; i < iconList.length; i++) {
      // Scenery layout controls transforms of children. Since we don't own the iconNode, we have to wrap it in another
      // so that layout will work in cases of DAG.
      iconListWithSeparators.push(new Node({
        children: [iconList[i]]
      }));

      // don't add the separator to the last item
      if (i < iconList.length - 1) {
        iconListWithSeparators.push(new PlusNode({
          size: options.plusIconSize
        }));
      }
    }
    return KeyboardHelpIconFactory.iconRow(iconListWithSeparators, {
      spacing: options.spacing
    });
  }

  /**
   * An icon with horizontal layout in order: shift, plus, and provided icon.
   */
  static shiftPlusIcon(icon, providedOptions) {
    const shiftKeyIcon = TextKeyNode.shift();
    const iconPlusIconNode = KeyboardHelpIconFactory.iconPlusIcon(shiftKeyIcon, icon, providedOptions);
    iconPlusIconNode.disposeEmitter.addListener(() => shiftKeyIcon.dispose());
    return iconPlusIconNode;
  }

  /**
   * An icon with horizontal layout in order: alt, plus, and provided icon.
   */
  static altPlusIcon(icon, providedOptions) {
    const altKeyIcon = TextKeyNode.altOrOption();
    const altPlusIconNode = KeyboardHelpIconFactory.iconPlusIcon(altKeyIcon, icon, providedOptions);
    altPlusIconNode.disposeEmitter.addListener(() => altKeyIcon.dispose());
    return altPlusIconNode;
  }

  /**
   * "Space or Enter" icon
   */
  static spaceOrEnter() {
    const spaceKey = TextKeyNode.space();
    const enterKey = TextKeyNode.enter();
    const icon = KeyboardHelpIconFactory.iconOrIcon(spaceKey, enterKey);
    icon.disposeEmitter.addListener(() => {
      spaceKey.dispose();
      enterKey.dispose();
    });
    return icon;
  }

  /**
   * An icon with up and down arrows, separated by 'or', in horizontal layout.
   */
  static upOrDown() {
    const upArrowKeyNode = new ArrowKeyNode('up');
    const downArrowKeyNode = new ArrowKeyNode('down');
    const icon = KeyboardHelpIconFactory.iconOrIcon(upArrowKeyNode, downArrowKeyNode);
    icon.disposeEmitter.addListener(() => {
      upArrowKeyNode.dispose();
      downArrowKeyNode.dispose();
    });
    return icon;
  }

  /**
   * An icon with up and down arrow keys, in a horizontal layout.
   */
  static wasdRowIcon(providedOptions) {
    const options = optionize()({
      spacing: DEFAULT_HORIZONTAL_KEY_SPACING
    }, providedOptions);
    const WKeyNode = LetterKeyNode.w();
    const AKeyNode = LetterKeyNode.a();
    const SKeyNode = LetterKeyNode.s();
    const DKeyNode = LetterKeyNode.d();

    // Strings are not translated because they map directly to specific key codes.
    const icons = [WKeyNode, AKeyNode, SKeyNode, DKeyNode];
    const icon = KeyboardHelpIconFactory.iconRow(icons, options);
    icon.disposeEmitter.addListener(() => {
      WKeyNode.dispose();
      AKeyNode.dispose();
      SKeyNode.dispose();
      DKeyNode.dispose();
    });
    return icon;
  }

  /**
   * An icon with the 4 arrow keys, in a horizontal layout.
   */
  static arrowKeysRowIcon(providedOptions) {
    const options = optionize()({
      spacing: DEFAULT_HORIZONTAL_KEY_SPACING
    }, providedOptions);

    // order of these icons matches movement with the WASD keys
    const upArrowKeyNode = new ArrowKeyNode('up');
    const leftArrowKeyNode = new ArrowKeyNode('left');
    const downArrowKeyNode = new ArrowKeyNode('down');
    const rightArrowKeyNode = new ArrowKeyNode('right');
    const icon = KeyboardHelpIconFactory.iconRow([upArrowKeyNode, leftArrowKeyNode, downArrowKeyNode, rightArrowKeyNode], options);
    icon.disposeEmitter.addListener(() => {
      upArrowKeyNode.dispose();
      downArrowKeyNode.dispose();
      leftArrowKeyNode.dispose();
      rightArrowKeyNode.dispose();
    });
    return icon;
  }

  /**
   * An icon with the 4 arrow keys, WASD keys, separated by "or", in horizontal layout.
   */
  static arrowOrWasdKeysRowIcon(providedOptions) {
    const options = optionize()({
      spacing: KeyboardHelpIconFactory.DEFAULT_ICON_SPACING
    }, providedOptions);
    const arrowKeys = KeyboardHelpIconFactory.arrowKeysRowIcon();
    const wasdKeys = KeyboardHelpIconFactory.wasdRowIcon();
    const icon = KeyboardHelpIconFactory.iconOrIcon(arrowKeys, wasdKeys, options);
    icon.disposeEmitter.addListener(() => {
      arrowKeys.dispose();
      wasdKeys.dispose();
    });
    return icon;
  }

  /**
   * An icon with page up/down keys, in horizontal layout.
   */
  static pageUpPageDownRowIcon(providedOptions) {
    const options = optionize()({
      spacing: KeyboardHelpIconFactory.DEFAULT_ICON_SPACING
    }, providedOptions);
    const pageUpKeyNode = TextKeyNode.pageUp();
    const pageDownKeyNode = TextKeyNode.pageDown();
    const icons = [pageUpKeyNode, pageDownKeyNode];
    const icon = KeyboardHelpIconFactory.iconRow(icons, options);
    icon.disposeEmitter.addListener(() => {
      pageUpKeyNode.dispose();
      pageDownKeyNode.dispose();
    });
    return icon;
  }

  /**
   * An icon with up and down arrow keys, in horizontal layout.
   */
  static upDownArrowKeysRowIcon(providedOptions) {
    const upArrowKeyNode = new ArrowKeyNode('up');
    const downArrowKeyNode = new ArrowKeyNode('down');
    const icon = KeyboardHelpIconFactory.iconRow([upArrowKeyNode, downArrowKeyNode], providedOptions);
    icon.disposeEmitter.addListener(() => {
      upArrowKeyNode.dispose();
      downArrowKeyNode.dispose();
    });
    return icon;
  }

  /**
   * An icon with left and right arrow keys, in horizontal layout.
   */
  static leftRightArrowKeysRowIcon(providedOptions) {
    const leftArrowKeyNode = new ArrowKeyNode('left');
    const rightArrowKeyNode = new ArrowKeyNode('right');
    const icon = KeyboardHelpIconFactory.iconRow([leftArrowKeyNode, rightArrowKeyNode], providedOptions);
    icon.disposeEmitter.addListener(() => {
      leftArrowKeyNode.dispose();
      rightArrowKeyNode.dispose();
    });
    return icon;
  }
}
assert && assert(Object.keys(KeyboardHelpIconFactory.prototype).length === 0, 'KeyboardHelpIconFactory only has static functions');
sceneryPhet.register('KeyboardHelpIconFactory', KeyboardHelpIconFactory);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEaW1lbnNpb24yIiwib3B0aW9uaXplIiwiY29tYmluZU9wdGlvbnMiLCJIQm94IiwiTm9kZSIsIlRleHQiLCJQaGV0Rm9udCIsIlBsdXNOb2RlIiwic2NlbmVyeVBoZXQiLCJTY2VuZXJ5UGhldFN0cmluZ3MiLCJBcnJvd0tleU5vZGUiLCJMZXR0ZXJLZXlOb2RlIiwiVGV4dEtleU5vZGUiLCJERUZBVUxUX0hPUklaT05UQUxfS0VZX1NQQUNJTkciLCJPUl9URVhUX01BWF9XSURUSCIsIkxBQkVMX0ZPTlQiLCJLZXlib2FyZEhlbHBJY29uRmFjdG9yeSIsIkRFRkFVTFRfSUNPTl9TUEFDSU5HIiwiY29uc3RydWN0b3IiLCJhc3NlcnQiLCJpY29uUm93IiwiaWNvbnMiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwic3BhY2luZyIsImNoaWxkcmVuIiwiaWNvbk9ySWNvbiIsImxlZnRJY29uIiwicmlnaHRJY29uIiwib3JUZXh0Iiwia2V5Ym9hcmRIZWxwRGlhbG9nIiwib3JTdHJpbmdQcm9wZXJ0eSIsImZvbnQiLCJtYXhXaWR0aCIsImljb24iLCJkaXNwb3NlRW1pdHRlciIsImFkZExpc3RlbmVyIiwiZGlzcG9zZSIsImljb25Ub0ljb24iLCJoeXBoZW5UZXh0IiwiaHlwaGVuU3RyaW5nUHJvcGVydHkiLCJpY29uUGx1c0ljb24iLCJpY29uUGx1c0ljb25Sb3ciLCJpY29uTGlzdCIsInBsdXNJY29uU2l6ZSIsImljb25MaXN0V2l0aFNlcGFyYXRvcnMiLCJpIiwibGVuZ3RoIiwicHVzaCIsInNpemUiLCJzaGlmdFBsdXNJY29uIiwic2hpZnRLZXlJY29uIiwic2hpZnQiLCJpY29uUGx1c0ljb25Ob2RlIiwiYWx0UGx1c0ljb24iLCJhbHRLZXlJY29uIiwiYWx0T3JPcHRpb24iLCJhbHRQbHVzSWNvbk5vZGUiLCJzcGFjZU9yRW50ZXIiLCJzcGFjZUtleSIsInNwYWNlIiwiZW50ZXJLZXkiLCJlbnRlciIsInVwT3JEb3duIiwidXBBcnJvd0tleU5vZGUiLCJkb3duQXJyb3dLZXlOb2RlIiwid2FzZFJvd0ljb24iLCJXS2V5Tm9kZSIsInciLCJBS2V5Tm9kZSIsImEiLCJTS2V5Tm9kZSIsInMiLCJES2V5Tm9kZSIsImQiLCJhcnJvd0tleXNSb3dJY29uIiwibGVmdEFycm93S2V5Tm9kZSIsInJpZ2h0QXJyb3dLZXlOb2RlIiwiYXJyb3dPcldhc2RLZXlzUm93SWNvbiIsImFycm93S2V5cyIsIndhc2RLZXlzIiwicGFnZVVwUGFnZURvd25Sb3dJY29uIiwicGFnZVVwS2V5Tm9kZSIsInBhZ2VVcCIsInBhZ2VEb3duS2V5Tm9kZSIsInBhZ2VEb3duIiwidXBEb3duQXJyb3dLZXlzUm93SWNvbiIsImxlZnRSaWdodEFycm93S2V5c1Jvd0ljb24iLCJPYmplY3QiLCJrZXlzIiwicHJvdG90eXBlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJLZXlib2FyZEhlbHBJY29uRmFjdG9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBSZXVzYWJsZSBpY29ucyB0byBiZSBjcmVhdGVkIGZvciBrZXlib2FyZCBoZWxwIHNob3J0Y3V0cyBkaWFsb2dzLlxyXG4gKiBUaGlzIHR5cGUgaXMgb25seSBhIGNvbGxlY3Rpb24gb2Ygc3RhdGljIG1ldGhvZHMsIGFuZCBzaG91bGQgbm90IGJlIGluc3RhbnRpYXRlZC5cclxuICpcclxuICogQGF1dGhvciBNaWNoYWVsIEthdXptYW5uIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEaW1lbnNpb24yIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9EaW1lbnNpb24yLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBjb21iaW5lT3B0aW9ucywgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgU3RyaWN0T21pdCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvU3RyaWN0T21pdC5qcyc7XHJcbmltcG9ydCB7IEhCb3gsIEhCb3hPcHRpb25zLCBOb2RlLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uL1BoZXRGb250LmpzJztcclxuaW1wb3J0IFBsdXNOb2RlIGZyb20gJy4uLy4uL1BsdXNOb2RlLmpzJztcclxuaW1wb3J0IHNjZW5lcnlQaGV0IGZyb20gJy4uLy4uL3NjZW5lcnlQaGV0LmpzJztcclxuaW1wb3J0IFNjZW5lcnlQaGV0U3RyaW5ncyBmcm9tICcuLi8uLi9TY2VuZXJ5UGhldFN0cmluZ3MuanMnO1xyXG5pbXBvcnQgQXJyb3dLZXlOb2RlIGZyb20gJy4uL0Fycm93S2V5Tm9kZS5qcyc7XHJcbmltcG9ydCBMZXR0ZXJLZXlOb2RlIGZyb20gJy4uL0xldHRlcktleU5vZGUuanMnO1xyXG5pbXBvcnQgVGV4dEtleU5vZGUgZnJvbSAnLi4vVGV4dEtleU5vZGUuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IERFRkFVTFRfSE9SSVpPTlRBTF9LRVlfU1BBQ0lORyA9IDEuMztcclxuY29uc3QgT1JfVEVYVF9NQVhfV0lEVEggPSAxNjtcclxuY29uc3QgTEFCRUxfRk9OVCA9IG5ldyBQaGV0Rm9udCggMTYgKTtcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBFbXB0eVNlbGZPcHRpb25zO1xyXG5cclxuLy8gT3B0aW9ucyBmb3IgbW9zdCBzdGF0aWMgbWV0aG9kcyBoZXJlaW5cclxudHlwZSBLZXlib2FyZEhlbHBJY29uRmFjdG9yeU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFN0cmljdE9taXQ8SEJveE9wdGlvbnMsICdjaGlsZHJlbic+O1xyXG5cclxuLy8gT3B0aW9ucyBmb3IgdGhlIGhhbmRmdWwgb2Ygc3RhdGljIG1ldGhvZHMgdGhhdCBhZGRpdGlvbmFsbHkgaW52b2x2ZSBQbHVzTm9kZVxyXG50eXBlIFdpdGhQbHVzSWNvblNlbGZPcHRpb25zID0ge1xyXG4gIHBsdXNJY29uU2l6ZT86IERpbWVuc2lvbjI7XHJcbn07XHJcbnR5cGUgV2l0aFBsdXNJY29uT3B0aW9ucyA9IFdpdGhQbHVzSWNvblNlbGZPcHRpb25zICYgS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnlPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgS2V5Ym9hcmRIZWxwSWNvbkZhY3Rvcnkge1xyXG5cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IERFRkFVTFRfSUNPTl9TUEFDSU5HID0gNi41O1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoKSB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBmYWxzZSwgJ2RvIG5vdCBjb25zdHJ1Y3QgdGhpcywgaW5zdGVhZCB1c2UgaXRzIGhlbHBlciBzdGF0aWMgbWV0aG9kcyBmb3IgaWNvbiBjcmVhdGlvbicgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhvcml6b250YWwgbGF5b3V0IG9mIGEgc2V0IG9mIGljb25zLCBpbiBsZWZ0LXRvLXJpZ2h0IG9yZGVyLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgaWNvblJvdyggaWNvbnM6IE5vZGVbXSwgcHJvdmlkZWRPcHRpb25zPzogS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnlPcHRpb25zICk6IE5vZGUge1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxLZXlib2FyZEhlbHBJY29uRmFjdG9yeU9wdGlvbnMsIFNlbGZPcHRpb25zLCBIQm94T3B0aW9ucz4oKSgge1xyXG4gICAgICBzcGFjaW5nOiBERUZBVUxUX0hPUklaT05UQUxfS0VZX1NQQUNJTkcsXHJcbiAgICAgIGNoaWxkcmVuOiBpY29uc1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcbiAgICByZXR1cm4gbmV3IEhCb3goIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFR3byBpY29ucyB3aXRoIGhvcml6b250YWwgbGF5b3V0LCBzZXBhcmF0ZWQgYnkgJ29yJyB0ZXh0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgaWNvbk9ySWNvbiggbGVmdEljb246IE5vZGUsIHJpZ2h0SWNvbjogTm9kZSwgcHJvdmlkZWRPcHRpb25zPzogS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnlPcHRpb25zICk6IE5vZGUge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBjb21iaW5lT3B0aW9uczxLZXlib2FyZEhlbHBJY29uRmFjdG9yeU9wdGlvbnM+KCB7XHJcbiAgICAgIHNwYWNpbmc6IEtleWJvYXJkSGVscEljb25GYWN0b3J5LkRFRkFVTFRfSUNPTl9TUEFDSU5HXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCBvclRleHQgPSBuZXcgVGV4dCggU2NlbmVyeVBoZXRTdHJpbmdzLmtleWJvYXJkSGVscERpYWxvZy5vclN0cmluZ1Byb3BlcnR5LCB7XHJcbiAgICAgIGZvbnQ6IExBQkVMX0ZPTlQsXHJcbiAgICAgIG1heFdpZHRoOiBPUl9URVhUX01BWF9XSURUSFxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGljb24gPSBLZXlib2FyZEhlbHBJY29uRmFjdG9yeS5pY29uUm93KCBbIG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIGxlZnRJY29uIF0gfSApLCBvclRleHQsXHJcbiAgICAgIG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIHJpZ2h0SWNvbiBdIH0gKSBdLCBvcHRpb25zICk7XHJcbiAgICBpY29uLmRpc3Bvc2VFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiBvclRleHQuZGlzcG9zZSgpICk7XHJcbiAgICByZXR1cm4gaWNvbjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFR3byBpY29ucyB3aXRoIGhvcml6b250YWwgbGF5b3V0LCBhbmQgc2VwYXJhdGVkIGJ5ICctJyB0ZXh0LiBUaGlzIGlzIHVzZWZ1bCBmb3IgYSByYW5nZSwgbGlrZSAwLTkuXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBpY29uVG9JY29uKCBsZWZ0SWNvbjogTm9kZSwgcmlnaHRJY29uOiBOb2RlLCBwcm92aWRlZE9wdGlvbnM/OiBLZXlib2FyZEhlbHBJY29uRmFjdG9yeU9wdGlvbnMgKTogTm9kZSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IGNvbWJpbmVPcHRpb25zPEtleWJvYXJkSGVscEljb25GYWN0b3J5T3B0aW9ucz4oIHtcclxuICAgICAgc3BhY2luZzogS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkuREVGQVVMVF9JQ09OX1NQQUNJTkcgLyAyXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCBoeXBoZW5UZXh0ID0gbmV3IFRleHQoIFNjZW5lcnlQaGV0U3RyaW5ncy5rZXlib2FyZEhlbHBEaWFsb2cuaHlwaGVuU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgZm9udDogTEFCRUxfRk9OVCxcclxuICAgICAgbWF4V2lkdGg6IE9SX1RFWFRfTUFYX1dJRFRIXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgaWNvbiA9IEtleWJvYXJkSGVscEljb25GYWN0b3J5Lmljb25Sb3coIFsgbmV3IE5vZGUoIHsgY2hpbGRyZW46IFsgbGVmdEljb24gXSB9ICksIGh5cGhlblRleHQsIG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIHJpZ2h0SWNvbiBdIH0gKSBdLCBvcHRpb25zICk7XHJcbiAgICBpY29uLmRpc3Bvc2VFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiBoeXBoZW5UZXh0LmRpc3Bvc2UoKSApO1xyXG4gICAgcmV0dXJuIGljb247XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUd28gaWNvbnMgd2l0aCBob3Jpem9udGFsIGxheW91dCwgc2VwYXJhdGVkIGJ5ICcrJyB0ZXh0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgaWNvblBsdXNJY29uKCBsZWZ0SWNvbjogTm9kZSwgcmlnaHRJY29uOiBOb2RlLCBwcm92aWRlZE9wdGlvbnM/OiBXaXRoUGx1c0ljb25PcHRpb25zICk6IE5vZGUge1xyXG4gICAgcmV0dXJuIEtleWJvYXJkSGVscEljb25GYWN0b3J5Lmljb25QbHVzSWNvblJvdyggWyBsZWZ0SWNvbiwgcmlnaHRJY29uIF0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhIHJvdyBvZiBpY29ucyBzZXBhcmF0ZWQgYnkgJysnLiBVc2VmdWwgd2hlbiBhIGtleWJvYXJkIHNob3J0Y3V0IGhhcyBtdWx0aXBsZSBtb2RpZmllciBrZXlzIGZvciBvbmVcclxuICAgKiBrZXkgcHJlc3MgbGlzdGVuZXIuXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBpY29uUGx1c0ljb25Sb3coIGljb25MaXN0OiBOb2RlW10sIHByb3ZpZGVkT3B0aW9ucz86IFdpdGhQbHVzSWNvbk9wdGlvbnMgKTogTm9kZSB7XHJcbiAgICBjb25zdCBvcHRpb25zID0gY29tYmluZU9wdGlvbnM8V2l0aFBsdXNJY29uT3B0aW9ucz4oIHtcclxuICAgICAgcGx1c0ljb25TaXplOiBuZXcgRGltZW5zaW9uMiggOCwgMS4yICksXHJcbiAgICAgIHNwYWNpbmc6IEtleWJvYXJkSGVscEljb25GYWN0b3J5LkRFRkFVTFRfSUNPTl9TUEFDSU5HXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBXZWF2ZSBwbHVzIGljb25zIGludG8gdGhlIHByb3ZpZGVkIGFycmF5IG9mIGljb25zLiBMaWtlIEFycmF5LmpvaW4sIGJ1dCB3aXRoIGEgbmV3IGFycmF5IGluc3RlYWQgb2YgYSBzdHJpbmcuXHJcbiAgICBjb25zdCBpY29uTGlzdFdpdGhTZXBhcmF0b3JzID0gW107XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBpY29uTGlzdC5sZW5ndGg7IGkrKyApIHtcclxuXHJcbiAgICAgIC8vIFNjZW5lcnkgbGF5b3V0IGNvbnRyb2xzIHRyYW5zZm9ybXMgb2YgY2hpbGRyZW4uIFNpbmNlIHdlIGRvbid0IG93biB0aGUgaWNvbk5vZGUsIHdlIGhhdmUgdG8gd3JhcCBpdCBpbiBhbm90aGVyXHJcbiAgICAgIC8vIHNvIHRoYXQgbGF5b3V0IHdpbGwgd29yayBpbiBjYXNlcyBvZiBEQUcuXHJcbiAgICAgIGljb25MaXN0V2l0aFNlcGFyYXRvcnMucHVzaChcclxuICAgICAgICBuZXcgTm9kZSgge1xyXG4gICAgICAgICAgY2hpbGRyZW46IFsgaWNvbkxpc3RbIGkgXSBdXHJcbiAgICAgICAgfSApXHJcbiAgICAgICk7XHJcblxyXG4gICAgICAvLyBkb24ndCBhZGQgdGhlIHNlcGFyYXRvciB0byB0aGUgbGFzdCBpdGVtXHJcbiAgICAgIGlmICggaSA8IGljb25MaXN0Lmxlbmd0aCAtIDEgKSB7XHJcbiAgICAgICAgaWNvbkxpc3RXaXRoU2VwYXJhdG9ycy5wdXNoKCBuZXcgUGx1c05vZGUoIHtcclxuICAgICAgICAgIHNpemU6IG9wdGlvbnMucGx1c0ljb25TaXplXHJcbiAgICAgICAgfSApICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkuaWNvblJvdyggaWNvbkxpc3RXaXRoU2VwYXJhdG9ycywge1xyXG4gICAgICBzcGFjaW5nOiBvcHRpb25zLnNwYWNpbmdcclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFuIGljb24gd2l0aCBob3Jpem9udGFsIGxheW91dCBpbiBvcmRlcjogc2hpZnQsIHBsdXMsIGFuZCBwcm92aWRlZCBpY29uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgc2hpZnRQbHVzSWNvbiggaWNvbjogTm9kZSwgcHJvdmlkZWRPcHRpb25zPzogV2l0aFBsdXNJY29uT3B0aW9ucyApOiBOb2RlIHtcclxuICAgIGNvbnN0IHNoaWZ0S2V5SWNvbiA9IFRleHRLZXlOb2RlLnNoaWZ0KCk7XHJcbiAgICBjb25zdCBpY29uUGx1c0ljb25Ob2RlID0gS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkuaWNvblBsdXNJY29uKCBzaGlmdEtleUljb24sIGljb24sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG4gICAgaWNvblBsdXNJY29uTm9kZS5kaXNwb3NlRW1pdHRlci5hZGRMaXN0ZW5lciggKCkgPT4gc2hpZnRLZXlJY29uLmRpc3Bvc2UoKSApO1xyXG4gICAgcmV0dXJuIGljb25QbHVzSWNvbk5vZGU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBbiBpY29uIHdpdGggaG9yaXpvbnRhbCBsYXlvdXQgaW4gb3JkZXI6IGFsdCwgcGx1cywgYW5kIHByb3ZpZGVkIGljb24uXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBhbHRQbHVzSWNvbiggaWNvbjogTm9kZSwgcHJvdmlkZWRPcHRpb25zPzogV2l0aFBsdXNJY29uT3B0aW9ucyApOiBOb2RlIHtcclxuICAgIGNvbnN0IGFsdEtleUljb24gPSBUZXh0S2V5Tm9kZS5hbHRPck9wdGlvbigpO1xyXG4gICAgY29uc3QgYWx0UGx1c0ljb25Ob2RlID0gS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkuaWNvblBsdXNJY29uKCBhbHRLZXlJY29uLCBpY29uLCBwcm92aWRlZE9wdGlvbnMgKTtcclxuICAgIGFsdFBsdXNJY29uTm9kZS5kaXNwb3NlRW1pdHRlci5hZGRMaXN0ZW5lciggKCkgPT4gYWx0S2V5SWNvbi5kaXNwb3NlKCkgKTtcclxuICAgIHJldHVybiBhbHRQbHVzSWNvbk5vZGU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBcIlNwYWNlIG9yIEVudGVyXCIgaWNvblxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgc3BhY2VPckVudGVyKCk6IE5vZGUge1xyXG4gICAgY29uc3Qgc3BhY2VLZXkgPSBUZXh0S2V5Tm9kZS5zcGFjZSgpO1xyXG4gICAgY29uc3QgZW50ZXJLZXkgPSBUZXh0S2V5Tm9kZS5lbnRlcigpO1xyXG4gICAgY29uc3QgaWNvbiA9IEtleWJvYXJkSGVscEljb25GYWN0b3J5Lmljb25Pckljb24oIHNwYWNlS2V5LCBlbnRlcktleSApO1xyXG4gICAgaWNvbi5kaXNwb3NlRW1pdHRlci5hZGRMaXN0ZW5lciggKCkgPT4ge1xyXG4gICAgICBzcGFjZUtleS5kaXNwb3NlKCk7XHJcbiAgICAgIGVudGVyS2V5LmRpc3Bvc2UoKTtcclxuICAgIH0gKTtcclxuICAgIHJldHVybiBpY29uO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQW4gaWNvbiB3aXRoIHVwIGFuZCBkb3duIGFycm93cywgc2VwYXJhdGVkIGJ5ICdvcicsIGluIGhvcml6b250YWwgbGF5b3V0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgdXBPckRvd24oKTogTm9kZSB7XHJcbiAgICBjb25zdCB1cEFycm93S2V5Tm9kZSA9IG5ldyBBcnJvd0tleU5vZGUoICd1cCcgKTtcclxuICAgIGNvbnN0IGRvd25BcnJvd0tleU5vZGUgPSBuZXcgQXJyb3dLZXlOb2RlKCAnZG93bicgKTtcclxuICAgIGNvbnN0IGljb24gPSBLZXlib2FyZEhlbHBJY29uRmFjdG9yeS5pY29uT3JJY29uKCB1cEFycm93S2V5Tm9kZSwgZG93bkFycm93S2V5Tm9kZSApO1xyXG4gICAgaWNvbi5kaXNwb3NlRW1pdHRlci5hZGRMaXN0ZW5lciggKCkgPT4ge1xyXG4gICAgICB1cEFycm93S2V5Tm9kZS5kaXNwb3NlKCk7XHJcbiAgICAgIGRvd25BcnJvd0tleU5vZGUuZGlzcG9zZSgpO1xyXG4gICAgfSApO1xyXG4gICAgcmV0dXJuIGljb247XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBbiBpY29uIHdpdGggdXAgYW5kIGRvd24gYXJyb3cga2V5cywgaW4gYSBob3Jpem9udGFsIGxheW91dC5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIHdhc2RSb3dJY29uKCBwcm92aWRlZE9wdGlvbnM/OiBLZXlib2FyZEhlbHBJY29uRmFjdG9yeU9wdGlvbnMgKTogTm9kZSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxLZXlib2FyZEhlbHBJY29uRmFjdG9yeU9wdGlvbnMsIFNlbGZPcHRpb25zLCBIQm94T3B0aW9ucz4oKSgge1xyXG4gICAgICBzcGFjaW5nOiBERUZBVUxUX0hPUklaT05UQUxfS0VZX1NQQUNJTkdcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IFdLZXlOb2RlID0gTGV0dGVyS2V5Tm9kZS53KCk7XHJcbiAgICBjb25zdCBBS2V5Tm9kZSA9IExldHRlcktleU5vZGUuYSgpO1xyXG4gICAgY29uc3QgU0tleU5vZGUgPSBMZXR0ZXJLZXlOb2RlLnMoKTtcclxuICAgIGNvbnN0IERLZXlOb2RlID0gTGV0dGVyS2V5Tm9kZS5kKCk7XHJcblxyXG4gICAgLy8gU3RyaW5ncyBhcmUgbm90IHRyYW5zbGF0ZWQgYmVjYXVzZSB0aGV5IG1hcCBkaXJlY3RseSB0byBzcGVjaWZpYyBrZXkgY29kZXMuXHJcbiAgICBjb25zdCBpY29ucyA9IFsgV0tleU5vZGUsIEFLZXlOb2RlLCBTS2V5Tm9kZSwgREtleU5vZGUgXTtcclxuXHJcbiAgICBjb25zdCBpY29uID0gS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkuaWNvblJvdyggaWNvbnMsIG9wdGlvbnMgKTtcclxuICAgIGljb24uZGlzcG9zZUVtaXR0ZXIuYWRkTGlzdGVuZXIoICgpID0+IHtcclxuICAgICAgV0tleU5vZGUuZGlzcG9zZSgpO1xyXG4gICAgICBBS2V5Tm9kZS5kaXNwb3NlKCk7XHJcbiAgICAgIFNLZXlOb2RlLmRpc3Bvc2UoKTtcclxuICAgICAgREtleU5vZGUuZGlzcG9zZSgpO1xyXG4gICAgfSApO1xyXG4gICAgcmV0dXJuIGljb247XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBbiBpY29uIHdpdGggdGhlIDQgYXJyb3cga2V5cywgaW4gYSBob3Jpem9udGFsIGxheW91dC5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGFycm93S2V5c1Jvd0ljb24oIHByb3ZpZGVkT3B0aW9ucz86IEtleWJvYXJkSGVscEljb25GYWN0b3J5T3B0aW9ucyApOiBOb2RlIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEtleWJvYXJkSGVscEljb25GYWN0b3J5T3B0aW9ucywgU2VsZk9wdGlvbnMsIEhCb3hPcHRpb25zPigpKCB7XHJcbiAgICAgIHNwYWNpbmc6IERFRkFVTFRfSE9SSVpPTlRBTF9LRVlfU1BBQ0lOR1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gb3JkZXIgb2YgdGhlc2UgaWNvbnMgbWF0Y2hlcyBtb3ZlbWVudCB3aXRoIHRoZSBXQVNEIGtleXNcclxuICAgIGNvbnN0IHVwQXJyb3dLZXlOb2RlID0gbmV3IEFycm93S2V5Tm9kZSggJ3VwJyApO1xyXG4gICAgY29uc3QgbGVmdEFycm93S2V5Tm9kZSA9IG5ldyBBcnJvd0tleU5vZGUoICdsZWZ0JyApO1xyXG4gICAgY29uc3QgZG93bkFycm93S2V5Tm9kZSA9IG5ldyBBcnJvd0tleU5vZGUoICdkb3duJyApO1xyXG4gICAgY29uc3QgcmlnaHRBcnJvd0tleU5vZGUgPSBuZXcgQXJyb3dLZXlOb2RlKCAncmlnaHQnICk7XHJcbiAgICBjb25zdCBpY29uID0gS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkuaWNvblJvdyggWyB1cEFycm93S2V5Tm9kZSwgbGVmdEFycm93S2V5Tm9kZSwgZG93bkFycm93S2V5Tm9kZSwgcmlnaHRBcnJvd0tleU5vZGUgXSwgb3B0aW9ucyApO1xyXG4gICAgaWNvbi5kaXNwb3NlRW1pdHRlci5hZGRMaXN0ZW5lciggKCkgPT4ge1xyXG4gICAgICB1cEFycm93S2V5Tm9kZS5kaXNwb3NlKCk7XHJcbiAgICAgIGRvd25BcnJvd0tleU5vZGUuZGlzcG9zZSgpO1xyXG4gICAgICBsZWZ0QXJyb3dLZXlOb2RlLmRpc3Bvc2UoKTtcclxuICAgICAgcmlnaHRBcnJvd0tleU5vZGUuZGlzcG9zZSgpO1xyXG4gICAgfSApO1xyXG4gICAgcmV0dXJuIGljb247XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBbiBpY29uIHdpdGggdGhlIDQgYXJyb3cga2V5cywgV0FTRCBrZXlzLCBzZXBhcmF0ZWQgYnkgXCJvclwiLCBpbiBob3Jpem9udGFsIGxheW91dC5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGFycm93T3JXYXNkS2V5c1Jvd0ljb24oIHByb3ZpZGVkT3B0aW9ucz86IEtleWJvYXJkSGVscEljb25GYWN0b3J5T3B0aW9ucyApOiBOb2RlIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEtleWJvYXJkSGVscEljb25GYWN0b3J5T3B0aW9ucywgU2VsZk9wdGlvbnMsIEhCb3hPcHRpb25zPigpKCB7XHJcbiAgICAgIHNwYWNpbmc6IEtleWJvYXJkSGVscEljb25GYWN0b3J5LkRFRkFVTFRfSUNPTl9TUEFDSU5HXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCBhcnJvd0tleXMgPSBLZXlib2FyZEhlbHBJY29uRmFjdG9yeS5hcnJvd0tleXNSb3dJY29uKCk7XHJcbiAgICBjb25zdCB3YXNkS2V5cyA9IEtleWJvYXJkSGVscEljb25GYWN0b3J5Lndhc2RSb3dJY29uKCk7XHJcblxyXG4gICAgY29uc3QgaWNvbiA9IEtleWJvYXJkSGVscEljb25GYWN0b3J5Lmljb25Pckljb24oIGFycm93S2V5cywgd2FzZEtleXMsIG9wdGlvbnMgKTtcclxuICAgIGljb24uZGlzcG9zZUVtaXR0ZXIuYWRkTGlzdGVuZXIoICgpID0+IHtcclxuICAgICAgYXJyb3dLZXlzLmRpc3Bvc2UoKTtcclxuICAgICAgd2FzZEtleXMuZGlzcG9zZSgpO1xyXG4gICAgfSApO1xyXG4gICAgcmV0dXJuIGljb247XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBbiBpY29uIHdpdGggcGFnZSB1cC9kb3duIGtleXMsIGluIGhvcml6b250YWwgbGF5b3V0LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgcGFnZVVwUGFnZURvd25Sb3dJY29uKCBwcm92aWRlZE9wdGlvbnM/OiBLZXlib2FyZEhlbHBJY29uRmFjdG9yeU9wdGlvbnMgKTogTm9kZSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxLZXlib2FyZEhlbHBJY29uRmFjdG9yeU9wdGlvbnMsIFNlbGZPcHRpb25zLCBIQm94T3B0aW9ucz4oKSgge1xyXG4gICAgICBzcGFjaW5nOiBLZXlib2FyZEhlbHBJY29uRmFjdG9yeS5ERUZBVUxUX0lDT05fU1BBQ0lOR1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgY29uc3QgcGFnZVVwS2V5Tm9kZSA9IFRleHRLZXlOb2RlLnBhZ2VVcCgpO1xyXG4gICAgY29uc3QgcGFnZURvd25LZXlOb2RlID0gVGV4dEtleU5vZGUucGFnZURvd24oKTtcclxuICAgIGNvbnN0IGljb25zID0gWyBwYWdlVXBLZXlOb2RlLCBwYWdlRG93bktleU5vZGUgXTtcclxuXHJcbiAgICBjb25zdCBpY29uID0gS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkuaWNvblJvdyggaWNvbnMsIG9wdGlvbnMgKTtcclxuICAgIGljb24uZGlzcG9zZUVtaXR0ZXIuYWRkTGlzdGVuZXIoICgpID0+IHtcclxuICAgICAgcGFnZVVwS2V5Tm9kZS5kaXNwb3NlKCk7XHJcbiAgICAgIHBhZ2VEb3duS2V5Tm9kZS5kaXNwb3NlKCk7XHJcbiAgICB9ICk7XHJcbiAgICByZXR1cm4gaWNvbjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFuIGljb24gd2l0aCB1cCBhbmQgZG93biBhcnJvdyBrZXlzLCBpbiBob3Jpem9udGFsIGxheW91dC5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIHVwRG93bkFycm93S2V5c1Jvd0ljb24oIHByb3ZpZGVkT3B0aW9ucz86IEtleWJvYXJkSGVscEljb25GYWN0b3J5T3B0aW9ucyApOiBOb2RlIHtcclxuICAgIGNvbnN0IHVwQXJyb3dLZXlOb2RlID0gbmV3IEFycm93S2V5Tm9kZSggJ3VwJyApO1xyXG4gICAgY29uc3QgZG93bkFycm93S2V5Tm9kZSA9IG5ldyBBcnJvd0tleU5vZGUoICdkb3duJyApO1xyXG4gICAgY29uc3QgaWNvbiA9IEtleWJvYXJkSGVscEljb25GYWN0b3J5Lmljb25Sb3coIFsgdXBBcnJvd0tleU5vZGUsIGRvd25BcnJvd0tleU5vZGUgXSwgcHJvdmlkZWRPcHRpb25zICk7XHJcbiAgICBpY29uLmRpc3Bvc2VFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiB7XHJcbiAgICAgIHVwQXJyb3dLZXlOb2RlLmRpc3Bvc2UoKTtcclxuICAgICAgZG93bkFycm93S2V5Tm9kZS5kaXNwb3NlKCk7XHJcbiAgICB9ICk7XHJcbiAgICByZXR1cm4gaWNvbjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFuIGljb24gd2l0aCBsZWZ0IGFuZCByaWdodCBhcnJvdyBrZXlzLCBpbiBob3Jpem9udGFsIGxheW91dC5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGxlZnRSaWdodEFycm93S2V5c1Jvd0ljb24oIHByb3ZpZGVkT3B0aW9ucz86IEtleWJvYXJkSGVscEljb25GYWN0b3J5T3B0aW9ucyApOiBOb2RlIHtcclxuICAgIGNvbnN0IGxlZnRBcnJvd0tleU5vZGUgPSBuZXcgQXJyb3dLZXlOb2RlKCAnbGVmdCcgKTtcclxuICAgIGNvbnN0IHJpZ2h0QXJyb3dLZXlOb2RlID0gbmV3IEFycm93S2V5Tm9kZSggJ3JpZ2h0JyApO1xyXG4gICAgY29uc3QgaWNvbiA9IEtleWJvYXJkSGVscEljb25GYWN0b3J5Lmljb25Sb3coIFsgbGVmdEFycm93S2V5Tm9kZSwgcmlnaHRBcnJvd0tleU5vZGUgXSwgcHJvdmlkZWRPcHRpb25zICk7XHJcbiAgICBpY29uLmRpc3Bvc2VFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiB7XHJcbiAgICAgIGxlZnRBcnJvd0tleU5vZGUuZGlzcG9zZSgpO1xyXG4gICAgICByaWdodEFycm93S2V5Tm9kZS5kaXNwb3NlKCk7XHJcbiAgICB9ICk7XHJcbiAgICByZXR1cm4gaWNvbjtcclxuICB9XHJcbn1cclxuXHJcbmFzc2VydCAmJiBhc3NlcnQoIE9iamVjdC5rZXlzKCBLZXlib2FyZEhlbHBJY29uRmFjdG9yeS5wcm90b3R5cGUgKS5sZW5ndGggPT09IDAsXHJcbiAgJ0tleWJvYXJkSGVscEljb25GYWN0b3J5IG9ubHkgaGFzIHN0YXRpYyBmdW5jdGlvbnMnICk7XHJcblxyXG5zY2VuZXJ5UGhldC5yZWdpc3RlciggJ0tleWJvYXJkSGVscEljb25GYWN0b3J5JywgS2V5Ym9hcmRIZWxwSWNvbkZhY3RvcnkgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxVQUFVLE1BQU0sa0NBQWtDO0FBQ3pELE9BQU9DLFNBQVMsSUFBSUMsY0FBYyxRQUEwQix1Q0FBdUM7QUFFbkcsU0FBU0MsSUFBSSxFQUFlQyxJQUFJLEVBQUVDLElBQUksUUFBUSxtQ0FBbUM7QUFDakYsT0FBT0MsUUFBUSxNQUFNLG1CQUFtQjtBQUN4QyxPQUFPQyxRQUFRLE1BQU0sbUJBQW1CO0FBQ3hDLE9BQU9DLFdBQVcsTUFBTSxzQkFBc0I7QUFDOUMsT0FBT0Msa0JBQWtCLE1BQU0sNkJBQTZCO0FBQzVELE9BQU9DLFlBQVksTUFBTSxvQkFBb0I7QUFDN0MsT0FBT0MsYUFBYSxNQUFNLHFCQUFxQjtBQUMvQyxPQUFPQyxXQUFXLE1BQU0sbUJBQW1COztBQUUzQztBQUNBLE1BQU1DLDhCQUE4QixHQUFHLEdBQUc7QUFDMUMsTUFBTUMsaUJBQWlCLEdBQUcsRUFBRTtBQUM1QixNQUFNQyxVQUFVLEdBQUcsSUFBSVQsUUFBUSxDQUFFLEVBQUcsQ0FBQzs7QUFJckM7O0FBR0E7O0FBTUEsZUFBZSxNQUFNVSx1QkFBdUIsQ0FBQztFQUUzQyxPQUF1QkMsb0JBQW9CLEdBQUcsR0FBRztFQUUxQ0MsV0FBV0EsQ0FBQSxFQUFHO0lBQ25CQyxNQUFNLElBQUlBLE1BQU0sQ0FBRSxLQUFLLEVBQUUsZ0ZBQWlGLENBQUM7RUFDN0c7O0VBRUE7QUFDRjtBQUNBO0VBQ0UsT0FBY0MsT0FBT0EsQ0FBRUMsS0FBYSxFQUFFQyxlQUFnRCxFQUFTO0lBQzdGLE1BQU1DLE9BQU8sR0FBR3RCLFNBQVMsQ0FBMkQsQ0FBQyxDQUFFO01BQ3JGdUIsT0FBTyxFQUFFWCw4QkFBOEI7TUFDdkNZLFFBQVEsRUFBRUo7SUFDWixDQUFDLEVBQUVDLGVBQWdCLENBQUM7SUFDcEIsT0FBTyxJQUFJbkIsSUFBSSxDQUFFb0IsT0FBUSxDQUFDO0VBQzVCOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE9BQWNHLFVBQVVBLENBQUVDLFFBQWMsRUFBRUMsU0FBZSxFQUFFTixlQUFnRCxFQUFTO0lBRWxILE1BQU1DLE9BQU8sR0FBR3JCLGNBQWMsQ0FBa0M7TUFDOURzQixPQUFPLEVBQUVSLHVCQUF1QixDQUFDQztJQUNuQyxDQUFDLEVBQUVLLGVBQWdCLENBQUM7SUFFcEIsTUFBTU8sTUFBTSxHQUFHLElBQUl4QixJQUFJLENBQUVJLGtCQUFrQixDQUFDcUIsa0JBQWtCLENBQUNDLGdCQUFnQixFQUFFO01BQy9FQyxJQUFJLEVBQUVqQixVQUFVO01BQ2hCa0IsUUFBUSxFQUFFbkI7SUFDWixDQUFFLENBQUM7SUFFSCxNQUFNb0IsSUFBSSxHQUFHbEIsdUJBQXVCLENBQUNJLE9BQU8sQ0FBRSxDQUFFLElBQUloQixJQUFJLENBQUU7TUFBRXFCLFFBQVEsRUFBRSxDQUFFRSxRQUFRO0lBQUcsQ0FBRSxDQUFDLEVBQUVFLE1BQU0sRUFDNUYsSUFBSXpCLElBQUksQ0FBRTtNQUFFcUIsUUFBUSxFQUFFLENBQUVHLFNBQVM7SUFBRyxDQUFFLENBQUMsQ0FBRSxFQUFFTCxPQUFRLENBQUM7SUFDdERXLElBQUksQ0FBQ0MsY0FBYyxDQUFDQyxXQUFXLENBQUUsTUFBTVAsTUFBTSxDQUFDUSxPQUFPLENBQUMsQ0FBRSxDQUFDO0lBQ3pELE9BQU9ILElBQUk7RUFDYjs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxPQUFjSSxVQUFVQSxDQUFFWCxRQUFjLEVBQUVDLFNBQWUsRUFBRU4sZUFBZ0QsRUFBUztJQUVsSCxNQUFNQyxPQUFPLEdBQUdyQixjQUFjLENBQWtDO01BQzlEc0IsT0FBTyxFQUFFUix1QkFBdUIsQ0FBQ0Msb0JBQW9CLEdBQUc7SUFDMUQsQ0FBQyxFQUFFSyxlQUFnQixDQUFDO0lBRXBCLE1BQU1pQixVQUFVLEdBQUcsSUFBSWxDLElBQUksQ0FBRUksa0JBQWtCLENBQUNxQixrQkFBa0IsQ0FBQ1Usb0JBQW9CLEVBQUU7TUFDdkZSLElBQUksRUFBRWpCLFVBQVU7TUFDaEJrQixRQUFRLEVBQUVuQjtJQUNaLENBQUUsQ0FBQztJQUVILE1BQU1vQixJQUFJLEdBQUdsQix1QkFBdUIsQ0FBQ0ksT0FBTyxDQUFFLENBQUUsSUFBSWhCLElBQUksQ0FBRTtNQUFFcUIsUUFBUSxFQUFFLENBQUVFLFFBQVE7SUFBRyxDQUFFLENBQUMsRUFBRVksVUFBVSxFQUFFLElBQUluQyxJQUFJLENBQUU7TUFBRXFCLFFBQVEsRUFBRSxDQUFFRyxTQUFTO0lBQUcsQ0FBRSxDQUFDLENBQUUsRUFBRUwsT0FBUSxDQUFDO0lBQ3hKVyxJQUFJLENBQUNDLGNBQWMsQ0FBQ0MsV0FBVyxDQUFFLE1BQU1HLFVBQVUsQ0FBQ0YsT0FBTyxDQUFDLENBQUUsQ0FBQztJQUM3RCxPQUFPSCxJQUFJO0VBQ2I7O0VBRUE7QUFDRjtBQUNBO0VBQ0UsT0FBY08sWUFBWUEsQ0FBRWQsUUFBYyxFQUFFQyxTQUFlLEVBQUVOLGVBQXFDLEVBQVM7SUFDekcsT0FBT04sdUJBQXVCLENBQUMwQixlQUFlLENBQUUsQ0FBRWYsUUFBUSxFQUFFQyxTQUFTLENBQUUsRUFBRU4sZUFBZ0IsQ0FBQztFQUM1Rjs7RUFFQTtBQUNGO0FBQ0E7QUFDQTtFQUNFLE9BQWNvQixlQUFlQSxDQUFFQyxRQUFnQixFQUFFckIsZUFBcUMsRUFBUztJQUM3RixNQUFNQyxPQUFPLEdBQUdyQixjQUFjLENBQXVCO01BQ25EMEMsWUFBWSxFQUFFLElBQUk1QyxVQUFVLENBQUUsQ0FBQyxFQUFFLEdBQUksQ0FBQztNQUN0Q3dCLE9BQU8sRUFBRVIsdUJBQXVCLENBQUNDO0lBQ25DLENBQUMsRUFBRUssZUFBZ0IsQ0FBQzs7SUFFcEI7SUFDQSxNQUFNdUIsc0JBQXNCLEdBQUcsRUFBRTtJQUNqQyxLQUFNLElBQUlDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR0gsUUFBUSxDQUFDSSxNQUFNLEVBQUVELENBQUMsRUFBRSxFQUFHO01BRTFDO01BQ0E7TUFDQUQsc0JBQXNCLENBQUNHLElBQUksQ0FDekIsSUFBSTVDLElBQUksQ0FBRTtRQUNScUIsUUFBUSxFQUFFLENBQUVrQixRQUFRLENBQUVHLENBQUMsQ0FBRTtNQUMzQixDQUFFLENBQ0osQ0FBQzs7TUFFRDtNQUNBLElBQUtBLENBQUMsR0FBR0gsUUFBUSxDQUFDSSxNQUFNLEdBQUcsQ0FBQyxFQUFHO1FBQzdCRixzQkFBc0IsQ0FBQ0csSUFBSSxDQUFFLElBQUl6QyxRQUFRLENBQUU7VUFDekMwQyxJQUFJLEVBQUUxQixPQUFPLENBQUNxQjtRQUNoQixDQUFFLENBQUUsQ0FBQztNQUNQO0lBQ0Y7SUFFQSxPQUFPNUIsdUJBQXVCLENBQUNJLE9BQU8sQ0FBRXlCLHNCQUFzQixFQUFFO01BQzlEckIsT0FBTyxFQUFFRCxPQUFPLENBQUNDO0lBQ25CLENBQUUsQ0FBQztFQUNMOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE9BQWMwQixhQUFhQSxDQUFFaEIsSUFBVSxFQUFFWixlQUFxQyxFQUFTO0lBQ3JGLE1BQU02QixZQUFZLEdBQUd2QyxXQUFXLENBQUN3QyxLQUFLLENBQUMsQ0FBQztJQUN4QyxNQUFNQyxnQkFBZ0IsR0FBR3JDLHVCQUF1QixDQUFDeUIsWUFBWSxDQUFFVSxZQUFZLEVBQUVqQixJQUFJLEVBQUVaLGVBQWdCLENBQUM7SUFDcEcrQixnQkFBZ0IsQ0FBQ2xCLGNBQWMsQ0FBQ0MsV0FBVyxDQUFFLE1BQU1lLFlBQVksQ0FBQ2QsT0FBTyxDQUFDLENBQUUsQ0FBQztJQUMzRSxPQUFPZ0IsZ0JBQWdCO0VBQ3pCOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE9BQWNDLFdBQVdBLENBQUVwQixJQUFVLEVBQUVaLGVBQXFDLEVBQVM7SUFDbkYsTUFBTWlDLFVBQVUsR0FBRzNDLFdBQVcsQ0FBQzRDLFdBQVcsQ0FBQyxDQUFDO0lBQzVDLE1BQU1DLGVBQWUsR0FBR3pDLHVCQUF1QixDQUFDeUIsWUFBWSxDQUFFYyxVQUFVLEVBQUVyQixJQUFJLEVBQUVaLGVBQWdCLENBQUM7SUFDakdtQyxlQUFlLENBQUN0QixjQUFjLENBQUNDLFdBQVcsQ0FBRSxNQUFNbUIsVUFBVSxDQUFDbEIsT0FBTyxDQUFDLENBQUUsQ0FBQztJQUN4RSxPQUFPb0IsZUFBZTtFQUN4Qjs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxPQUFjQyxZQUFZQSxDQUFBLEVBQVM7SUFDakMsTUFBTUMsUUFBUSxHQUFHL0MsV0FBVyxDQUFDZ0QsS0FBSyxDQUFDLENBQUM7SUFDcEMsTUFBTUMsUUFBUSxHQUFHakQsV0FBVyxDQUFDa0QsS0FBSyxDQUFDLENBQUM7SUFDcEMsTUFBTTVCLElBQUksR0FBR2xCLHVCQUF1QixDQUFDVSxVQUFVLENBQUVpQyxRQUFRLEVBQUVFLFFBQVMsQ0FBQztJQUNyRTNCLElBQUksQ0FBQ0MsY0FBYyxDQUFDQyxXQUFXLENBQUUsTUFBTTtNQUNyQ3VCLFFBQVEsQ0FBQ3RCLE9BQU8sQ0FBQyxDQUFDO01BQ2xCd0IsUUFBUSxDQUFDeEIsT0FBTyxDQUFDLENBQUM7SUFDcEIsQ0FBRSxDQUFDO0lBQ0gsT0FBT0gsSUFBSTtFQUNiOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE9BQWM2QixRQUFRQSxDQUFBLEVBQVM7SUFDN0IsTUFBTUMsY0FBYyxHQUFHLElBQUl0RCxZQUFZLENBQUUsSUFBSyxDQUFDO0lBQy9DLE1BQU11RCxnQkFBZ0IsR0FBRyxJQUFJdkQsWUFBWSxDQUFFLE1BQU8sQ0FBQztJQUNuRCxNQUFNd0IsSUFBSSxHQUFHbEIsdUJBQXVCLENBQUNVLFVBQVUsQ0FBRXNDLGNBQWMsRUFBRUMsZ0JBQWlCLENBQUM7SUFDbkYvQixJQUFJLENBQUNDLGNBQWMsQ0FBQ0MsV0FBVyxDQUFFLE1BQU07TUFDckM0QixjQUFjLENBQUMzQixPQUFPLENBQUMsQ0FBQztNQUN4QjRCLGdCQUFnQixDQUFDNUIsT0FBTyxDQUFDLENBQUM7SUFDNUIsQ0FBRSxDQUFDO0lBQ0gsT0FBT0gsSUFBSTtFQUNiOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE9BQWNnQyxXQUFXQSxDQUFFNUMsZUFBZ0QsRUFBUztJQUVsRixNQUFNQyxPQUFPLEdBQUd0QixTQUFTLENBQTJELENBQUMsQ0FBRTtNQUNyRnVCLE9BQU8sRUFBRVg7SUFDWCxDQUFDLEVBQUVTLGVBQWdCLENBQUM7SUFFcEIsTUFBTTZDLFFBQVEsR0FBR3hELGFBQWEsQ0FBQ3lELENBQUMsQ0FBQyxDQUFDO0lBQ2xDLE1BQU1DLFFBQVEsR0FBRzFELGFBQWEsQ0FBQzJELENBQUMsQ0FBQyxDQUFDO0lBQ2xDLE1BQU1DLFFBQVEsR0FBRzVELGFBQWEsQ0FBQzZELENBQUMsQ0FBQyxDQUFDO0lBQ2xDLE1BQU1DLFFBQVEsR0FBRzlELGFBQWEsQ0FBQytELENBQUMsQ0FBQyxDQUFDOztJQUVsQztJQUNBLE1BQU1yRCxLQUFLLEdBQUcsQ0FBRThDLFFBQVEsRUFBRUUsUUFBUSxFQUFFRSxRQUFRLEVBQUVFLFFBQVEsQ0FBRTtJQUV4RCxNQUFNdkMsSUFBSSxHQUFHbEIsdUJBQXVCLENBQUNJLE9BQU8sQ0FBRUMsS0FBSyxFQUFFRSxPQUFRLENBQUM7SUFDOURXLElBQUksQ0FBQ0MsY0FBYyxDQUFDQyxXQUFXLENBQUUsTUFBTTtNQUNyQytCLFFBQVEsQ0FBQzlCLE9BQU8sQ0FBQyxDQUFDO01BQ2xCZ0MsUUFBUSxDQUFDaEMsT0FBTyxDQUFDLENBQUM7TUFDbEJrQyxRQUFRLENBQUNsQyxPQUFPLENBQUMsQ0FBQztNQUNsQm9DLFFBQVEsQ0FBQ3BDLE9BQU8sQ0FBQyxDQUFDO0lBQ3BCLENBQUUsQ0FBQztJQUNILE9BQU9ILElBQUk7RUFDYjs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxPQUFjeUMsZ0JBQWdCQSxDQUFFckQsZUFBZ0QsRUFBUztJQUV2RixNQUFNQyxPQUFPLEdBQUd0QixTQUFTLENBQTJELENBQUMsQ0FBRTtNQUNyRnVCLE9BQU8sRUFBRVg7SUFDWCxDQUFDLEVBQUVTLGVBQWdCLENBQUM7O0lBRXBCO0lBQ0EsTUFBTTBDLGNBQWMsR0FBRyxJQUFJdEQsWUFBWSxDQUFFLElBQUssQ0FBQztJQUMvQyxNQUFNa0UsZ0JBQWdCLEdBQUcsSUFBSWxFLFlBQVksQ0FBRSxNQUFPLENBQUM7SUFDbkQsTUFBTXVELGdCQUFnQixHQUFHLElBQUl2RCxZQUFZLENBQUUsTUFBTyxDQUFDO0lBQ25ELE1BQU1tRSxpQkFBaUIsR0FBRyxJQUFJbkUsWUFBWSxDQUFFLE9BQVEsQ0FBQztJQUNyRCxNQUFNd0IsSUFBSSxHQUFHbEIsdUJBQXVCLENBQUNJLE9BQU8sQ0FBRSxDQUFFNEMsY0FBYyxFQUFFWSxnQkFBZ0IsRUFBRVgsZ0JBQWdCLEVBQUVZLGlCQUFpQixDQUFFLEVBQUV0RCxPQUFRLENBQUM7SUFDbElXLElBQUksQ0FBQ0MsY0FBYyxDQUFDQyxXQUFXLENBQUUsTUFBTTtNQUNyQzRCLGNBQWMsQ0FBQzNCLE9BQU8sQ0FBQyxDQUFDO01BQ3hCNEIsZ0JBQWdCLENBQUM1QixPQUFPLENBQUMsQ0FBQztNQUMxQnVDLGdCQUFnQixDQUFDdkMsT0FBTyxDQUFDLENBQUM7TUFDMUJ3QyxpQkFBaUIsQ0FBQ3hDLE9BQU8sQ0FBQyxDQUFDO0lBQzdCLENBQUUsQ0FBQztJQUNILE9BQU9ILElBQUk7RUFDYjs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxPQUFjNEMsc0JBQXNCQSxDQUFFeEQsZUFBZ0QsRUFBUztJQUU3RixNQUFNQyxPQUFPLEdBQUd0QixTQUFTLENBQTJELENBQUMsQ0FBRTtNQUNyRnVCLE9BQU8sRUFBRVIsdUJBQXVCLENBQUNDO0lBQ25DLENBQUMsRUFBRUssZUFBZ0IsQ0FBQztJQUVwQixNQUFNeUQsU0FBUyxHQUFHL0QsdUJBQXVCLENBQUMyRCxnQkFBZ0IsQ0FBQyxDQUFDO0lBQzVELE1BQU1LLFFBQVEsR0FBR2hFLHVCQUF1QixDQUFDa0QsV0FBVyxDQUFDLENBQUM7SUFFdEQsTUFBTWhDLElBQUksR0FBR2xCLHVCQUF1QixDQUFDVSxVQUFVLENBQUVxRCxTQUFTLEVBQUVDLFFBQVEsRUFBRXpELE9BQVEsQ0FBQztJQUMvRVcsSUFBSSxDQUFDQyxjQUFjLENBQUNDLFdBQVcsQ0FBRSxNQUFNO01BQ3JDMkMsU0FBUyxDQUFDMUMsT0FBTyxDQUFDLENBQUM7TUFDbkIyQyxRQUFRLENBQUMzQyxPQUFPLENBQUMsQ0FBQztJQUNwQixDQUFFLENBQUM7SUFDSCxPQUFPSCxJQUFJO0VBQ2I7O0VBRUE7QUFDRjtBQUNBO0VBQ0UsT0FBYytDLHFCQUFxQkEsQ0FBRTNELGVBQWdELEVBQVM7SUFFNUYsTUFBTUMsT0FBTyxHQUFHdEIsU0FBUyxDQUEyRCxDQUFDLENBQUU7TUFDckZ1QixPQUFPLEVBQUVSLHVCQUF1QixDQUFDQztJQUNuQyxDQUFDLEVBQUVLLGVBQWdCLENBQUM7SUFFcEIsTUFBTTRELGFBQWEsR0FBR3RFLFdBQVcsQ0FBQ3VFLE1BQU0sQ0FBQyxDQUFDO0lBQzFDLE1BQU1DLGVBQWUsR0FBR3hFLFdBQVcsQ0FBQ3lFLFFBQVEsQ0FBQyxDQUFDO0lBQzlDLE1BQU1oRSxLQUFLLEdBQUcsQ0FBRTZELGFBQWEsRUFBRUUsZUFBZSxDQUFFO0lBRWhELE1BQU1sRCxJQUFJLEdBQUdsQix1QkFBdUIsQ0FBQ0ksT0FBTyxDQUFFQyxLQUFLLEVBQUVFLE9BQVEsQ0FBQztJQUM5RFcsSUFBSSxDQUFDQyxjQUFjLENBQUNDLFdBQVcsQ0FBRSxNQUFNO01BQ3JDOEMsYUFBYSxDQUFDN0MsT0FBTyxDQUFDLENBQUM7TUFDdkIrQyxlQUFlLENBQUMvQyxPQUFPLENBQUMsQ0FBQztJQUMzQixDQUFFLENBQUM7SUFDSCxPQUFPSCxJQUFJO0VBQ2I7O0VBRUE7QUFDRjtBQUNBO0VBQ0UsT0FBY29ELHNCQUFzQkEsQ0FBRWhFLGVBQWdELEVBQVM7SUFDN0YsTUFBTTBDLGNBQWMsR0FBRyxJQUFJdEQsWUFBWSxDQUFFLElBQUssQ0FBQztJQUMvQyxNQUFNdUQsZ0JBQWdCLEdBQUcsSUFBSXZELFlBQVksQ0FBRSxNQUFPLENBQUM7SUFDbkQsTUFBTXdCLElBQUksR0FBR2xCLHVCQUF1QixDQUFDSSxPQUFPLENBQUUsQ0FBRTRDLGNBQWMsRUFBRUMsZ0JBQWdCLENBQUUsRUFBRTNDLGVBQWdCLENBQUM7SUFDckdZLElBQUksQ0FBQ0MsY0FBYyxDQUFDQyxXQUFXLENBQUUsTUFBTTtNQUNyQzRCLGNBQWMsQ0FBQzNCLE9BQU8sQ0FBQyxDQUFDO01BQ3hCNEIsZ0JBQWdCLENBQUM1QixPQUFPLENBQUMsQ0FBQztJQUM1QixDQUFFLENBQUM7SUFDSCxPQUFPSCxJQUFJO0VBQ2I7O0VBRUE7QUFDRjtBQUNBO0VBQ0UsT0FBY3FELHlCQUF5QkEsQ0FBRWpFLGVBQWdELEVBQVM7SUFDaEcsTUFBTXNELGdCQUFnQixHQUFHLElBQUlsRSxZQUFZLENBQUUsTUFBTyxDQUFDO0lBQ25ELE1BQU1tRSxpQkFBaUIsR0FBRyxJQUFJbkUsWUFBWSxDQUFFLE9BQVEsQ0FBQztJQUNyRCxNQUFNd0IsSUFBSSxHQUFHbEIsdUJBQXVCLENBQUNJLE9BQU8sQ0FBRSxDQUFFd0QsZ0JBQWdCLEVBQUVDLGlCQUFpQixDQUFFLEVBQUV2RCxlQUFnQixDQUFDO0lBQ3hHWSxJQUFJLENBQUNDLGNBQWMsQ0FBQ0MsV0FBVyxDQUFFLE1BQU07TUFDckN3QyxnQkFBZ0IsQ0FBQ3ZDLE9BQU8sQ0FBQyxDQUFDO01BQzFCd0MsaUJBQWlCLENBQUN4QyxPQUFPLENBQUMsQ0FBQztJQUM3QixDQUFFLENBQUM7SUFDSCxPQUFPSCxJQUFJO0VBQ2I7QUFDRjtBQUVBZixNQUFNLElBQUlBLE1BQU0sQ0FBRXFFLE1BQU0sQ0FBQ0MsSUFBSSxDQUFFekUsdUJBQXVCLENBQUMwRSxTQUFVLENBQUMsQ0FBQzNDLE1BQU0sS0FBSyxDQUFDLEVBQzdFLG1EQUFvRCxDQUFDO0FBRXZEdkMsV0FBVyxDQUFDbUYsUUFBUSxDQUFFLHlCQUF5QixFQUFFM0UsdUJBQXdCLENBQUMifQ==