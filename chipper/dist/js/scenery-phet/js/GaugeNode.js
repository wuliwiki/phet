// Copyright 2013-2022, University of Colorado Boulder

/**
 * GaugeNode is a circular gauge that depicts some dynamic value.
 * This was originally ported from the speedometer node in forces-and-motion-basics.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author John Blanco (PhET Interactive Simulations)
 */

import Matrix3 from '../../dot/js/Matrix3.js';
import Utils from '../../dot/js/Utils.js';
import { Shape } from '../../kite/js/imports.js';
import InstanceRegistry from '../../phet-core/js/documentation/InstanceRegistry.js';
import optionize from '../../phet-core/js/optionize.js';
import { Circle, Node, Path, Text } from '../../scenery/js/imports.js';
import Tandem from '../../tandem/js/Tandem.js';
import PhetFont from './PhetFont.js';
import sceneryPhet from './sceneryPhet.js';
export default class GaugeNode extends Node {
  /**
   * @param valueProperty
   * @param labelProperty - label to display, scaled to fit if necessary
   * @param range - range of the needle. If valueProperty exceeds this range, the needle will stop at min or max.
   * @param providedOptions
   */
  constructor(valueProperty, labelProperty, range, providedOptions) {
    const options = optionize()({
      // SelfOptions
      radius: 100,
      backgroundFill: 'white',
      backgroundStroke: 'rgb( 85, 85, 85 )',
      backgroundLineWidth: 2,
      maxLabelWidthScale: 1.3,
      numberOfTicks: 21,
      // 10 ticks each on the right side and left side, plus 1 in the center
      majorTickStroke: 'gray',
      minorTickStroke: 'gray',
      majorTickLength: 10,
      minorTickLength: 5,
      majorTickLineWidth: 2,
      minorTickLineWidth: 1,
      span: Math.PI + Math.PI / 4,
      needleLineWidth: 3,
      updateWhenInvisible: true,
      // NodeOptions
      tandem: Tandem.REQUIRED,
      tandemNameSuffix: 'Node'
    }, providedOptions);
    assert && assert(options.span <= 2 * Math.PI, `options.span must be <= 2 * Math.PI: ${options.span}`);
    super();
    this.radius = options.radius;
    const anglePerTick = options.span / options.numberOfTicks;
    const tandem = options.tandem;
    this.addChild(new Circle(this.radius, {
      fill: options.backgroundFill,
      stroke: options.backgroundStroke,
      lineWidth: options.backgroundLineWidth
    }));
    const foregroundNode = new Node({
      pickable: false
    });
    this.addChild(foregroundNode);
    const needle = new Path(Shape.lineSegment(0, 0, this.radius - options.majorTickLength / 2, 0), {
      stroke: 'red',
      lineWidth: options.needleLineWidth
    });
    const labelText = new Text(labelProperty, {
      font: new PhetFont(20),
      maxWidth: this.radius * options.maxLabelWidthScale,
      tandem: tandem.createTandem('labelText')
    });
    labelText.boundsProperty.link(() => {
      labelText.centerX = 0;
      labelText.centerY = -this.radius / 3;
    });
    foregroundNode.addChild(labelText);
    const pin = new Circle(2, {
      fill: 'black'
    });
    foregroundNode.addChild(pin);
    const totalAngle = (options.numberOfTicks - 1) * anglePerTick;
    const startAngle = -1 / 2 * Math.PI - totalAngle / 2;
    const endAngle = startAngle + totalAngle;
    const scratchMatrix = new Matrix3();
    const updateNeedle = () => {
      if (this.visibleProperty.value || options.updateWhenInvisible) {
        if (typeof valueProperty.get() === 'number') {
          // clamp value to valid range and map it to an angle
          const clampedValue = Utils.clamp(valueProperty.get(), range.min, range.max);
          const needleAngle = Utils.linear(range.min, range.max, startAngle, endAngle, clampedValue);

          // 2d rotation, but reusing our matrix above
          needle.setMatrix(scratchMatrix.setToRotationZ(needleAngle));
          needle.visible = true;
        } else {
          // Hide the needle if there is no number value.
          needle.visible = false;
        }
      }
    };
    valueProperty.link(updateNeedle);

    // If options.updateWhenInvisible is true, updateNeedle will be called by the valueProperty listener above.
    // Otherwise, we need to listen to visibleProperty, and call updateNeedle when the gauge becomes visible.
    if (!options.updateWhenInvisible) {
      this.visibleProperty.link(visible => {
        visible && updateNeedle();
      });
    }

    // Render all of the ticks into Shapes layers (since they have different strokes)
    // see https://github.com/phetsims/energy-skate-park-basics/issues/208
    const bigTicksShape = new Shape();
    const smallTicksShape = new Shape();

    // Add the tick marks
    for (let i = 0; i < options.numberOfTicks; i++) {
      const tickAngle = i * anglePerTick + startAngle;
      const tickLength = i % 2 === 0 ? options.majorTickLength : options.minorTickLength;
      const x1 = (this.radius - tickLength) * Math.cos(tickAngle);
      const y1 = (this.radius - tickLength) * Math.sin(tickAngle);
      const x2 = this.radius * Math.cos(tickAngle);
      const y2 = this.radius * Math.sin(tickAngle);
      if (i % 2 === 0) {
        bigTicksShape.moveTo(x1, y1);
        bigTicksShape.lineTo(x2, y2);
      } else {
        smallTicksShape.moveTo(x1, y1);
        smallTicksShape.lineTo(x2, y2);
      }
    }
    foregroundNode.addChild(new Path(bigTicksShape, {
      stroke: options.majorTickStroke,
      lineWidth: options.majorTickLineWidth
    }));
    foregroundNode.addChild(new Path(smallTicksShape, {
      stroke: options.minorTickStroke,
      lineWidth: options.minorTickLineWidth
    }));

    // Add needle last, so it's on top of ticks. See https://github.com/phetsims/scenery-phet/issues/502
    foregroundNode.addChild(needle);
    this.mutate(options);
    this.disposeGaugeNode = () => {
      if (valueProperty.hasListener(updateNeedle)) {
        valueProperty.unlink(updateNeedle);
      }

      // de-register phet-io tandems
      foregroundNode.dispose();
      labelText.dispose();
    };

    // support for binder documentation, stripped out in builds and only runs when ?binder is specified
    assert && phet.chipper.queryParameters.binder && InstanceRegistry.registerDataURL('scenery-phet', 'GaugeNode', this);
  }
  dispose() {
    this.disposeGaugeNode();
    super.dispose();
  }
}
sceneryPhet.register('GaugeNode', GaugeNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNYXRyaXgzIiwiVXRpbHMiLCJTaGFwZSIsIkluc3RhbmNlUmVnaXN0cnkiLCJvcHRpb25pemUiLCJDaXJjbGUiLCJOb2RlIiwiUGF0aCIsIlRleHQiLCJUYW5kZW0iLCJQaGV0Rm9udCIsInNjZW5lcnlQaGV0IiwiR2F1Z2VOb2RlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZVByb3BlcnR5IiwibGFiZWxQcm9wZXJ0eSIsInJhbmdlIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInJhZGl1cyIsImJhY2tncm91bmRGaWxsIiwiYmFja2dyb3VuZFN0cm9rZSIsImJhY2tncm91bmRMaW5lV2lkdGgiLCJtYXhMYWJlbFdpZHRoU2NhbGUiLCJudW1iZXJPZlRpY2tzIiwibWFqb3JUaWNrU3Ryb2tlIiwibWlub3JUaWNrU3Ryb2tlIiwibWFqb3JUaWNrTGVuZ3RoIiwibWlub3JUaWNrTGVuZ3RoIiwibWFqb3JUaWNrTGluZVdpZHRoIiwibWlub3JUaWNrTGluZVdpZHRoIiwic3BhbiIsIk1hdGgiLCJQSSIsIm5lZWRsZUxpbmVXaWR0aCIsInVwZGF0ZVdoZW5JbnZpc2libGUiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsInRhbmRlbU5hbWVTdWZmaXgiLCJhc3NlcnQiLCJhbmdsZVBlclRpY2siLCJhZGRDaGlsZCIsImZpbGwiLCJzdHJva2UiLCJsaW5lV2lkdGgiLCJmb3JlZ3JvdW5kTm9kZSIsInBpY2thYmxlIiwibmVlZGxlIiwibGluZVNlZ21lbnQiLCJsYWJlbFRleHQiLCJmb250IiwibWF4V2lkdGgiLCJjcmVhdGVUYW5kZW0iLCJib3VuZHNQcm9wZXJ0eSIsImxpbmsiLCJjZW50ZXJYIiwiY2VudGVyWSIsInBpbiIsInRvdGFsQW5nbGUiLCJzdGFydEFuZ2xlIiwiZW5kQW5nbGUiLCJzY3JhdGNoTWF0cml4IiwidXBkYXRlTmVlZGxlIiwidmlzaWJsZVByb3BlcnR5IiwidmFsdWUiLCJnZXQiLCJjbGFtcGVkVmFsdWUiLCJjbGFtcCIsIm1pbiIsIm1heCIsIm5lZWRsZUFuZ2xlIiwibGluZWFyIiwic2V0TWF0cml4Iiwic2V0VG9Sb3RhdGlvbloiLCJ2aXNpYmxlIiwiYmlnVGlja3NTaGFwZSIsInNtYWxsVGlja3NTaGFwZSIsImkiLCJ0aWNrQW5nbGUiLCJ0aWNrTGVuZ3RoIiwieDEiLCJjb3MiLCJ5MSIsInNpbiIsIngyIiwieTIiLCJtb3ZlVG8iLCJsaW5lVG8iLCJtdXRhdGUiLCJkaXNwb3NlR2F1Z2VOb2RlIiwiaGFzTGlzdGVuZXIiLCJ1bmxpbmsiLCJkaXNwb3NlIiwicGhldCIsImNoaXBwZXIiLCJxdWVyeVBhcmFtZXRlcnMiLCJiaW5kZXIiLCJyZWdpc3RlckRhdGFVUkwiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkdhdWdlTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBHYXVnZU5vZGUgaXMgYSBjaXJjdWxhciBnYXVnZSB0aGF0IGRlcGljdHMgc29tZSBkeW5hbWljIHZhbHVlLlxyXG4gKiBUaGlzIHdhcyBvcmlnaW5hbGx5IHBvcnRlZCBmcm9tIHRoZSBzcGVlZG9tZXRlciBub2RlIGluIGZvcmNlcy1hbmQtbW90aW9uLWJhc2ljcy5cclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBKb2huIEJsYW5jbyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBNYXRyaXgzIGZyb20gJy4uLy4uL2RvdC9qcy9NYXRyaXgzLmpzJztcclxuaW1wb3J0IFJhbmdlIGZyb20gJy4uLy4uL2RvdC9qcy9SYW5nZS5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBJbnN0YW5jZVJlZ2lzdHJ5IGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy9kb2N1bWVudGF0aW9uL0luc3RhbmNlUmVnaXN0cnkuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgeyBDaXJjbGUsIFRDb2xvciwgTm9kZSwgTm9kZU9wdGlvbnMsIFBhdGgsIFRleHQgfSBmcm9tICcuLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCBzY2VuZXJ5UGhldCBmcm9tICcuL3NjZW5lcnlQaGV0LmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcblxyXG4gIHJhZGl1cz86IG51bWJlcjtcclxuICBiYWNrZ3JvdW5kRmlsbD86IFRDb2xvcjtcclxuICBiYWNrZ3JvdW5kU3Ryb2tlPzogVENvbG9yO1xyXG4gIGJhY2tncm91bmRMaW5lV2lkdGg/OiBudW1iZXI7XHJcbiAgbWF4TGFiZWxXaWR0aFNjYWxlPzogbnVtYmVyOyAvLyBkZWZpbmVzIG1heCB3aWR0aCBvZiB0aGUgbGFiZWwsIHJlbGF0aXZlIHRvIHRoZSByYWRpdXNcclxuXHJcbiAgLy8gdGlja3NcclxuICBudW1iZXJPZlRpY2tzPzogbnVtYmVyO1xyXG4gIG1ham9yVGlja1N0cm9rZT86IFRDb2xvcjtcclxuICBtaW5vclRpY2tTdHJva2U/OiBUQ29sb3I7XHJcbiAgbWFqb3JUaWNrTGVuZ3RoPzogbnVtYmVyO1xyXG4gIG1pbm9yVGlja0xlbmd0aD86IG51bWJlcjtcclxuICBtYWpvclRpY2tMaW5lV2lkdGg/OiBudW1iZXI7XHJcbiAgbWlub3JUaWNrTGluZVdpZHRoPzogbnVtYmVyO1xyXG5cclxuICAvLyB0aGUgdG9wIGhhbGYgb2YgdGhlIGdhdWdlLCBwbHVzIFBJLzggZXh0ZW5kZWQgYmVsb3cgdGhlIHRvcCBoYWxmIG9uIGVhY2ggc2lkZVxyXG4gIHNwYW4/OiBudW1iZXI7IC8vIHRoZSB2aXNpYmxlIHNwYW4gb2YgdGhlIGdhdWdlIHZhbHVlIHJhbmdlLCBpbiByYWRpYW5zXHJcblxyXG4gIG5lZWRsZUxpbmVXaWR0aD86IG51bWJlcjtcclxuXHJcbiAgLy8gdHJ1ZSAtIGFsd2F5cyB1cGRhdGVzLCBldmVuIHdoZW4gaW52aXNpYmxlXHJcbiAgLy8gZmFsc2UgLSBkb2VzIG5vdCB1cGRhdGUgd2hlbiBpbnZpc2libGUsIHVzZSB0byBvcHRpbWl6ZSBwZXJmb3JtYW5jZVxyXG4gIHVwZGF0ZVdoZW5JbnZpc2libGU/OiBib29sZWFuO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgR2F1Z2VOb2RlT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgTm9kZU9wdGlvbnM7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYXVnZU5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IHJhZGl1czogbnVtYmVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZUdhdWdlTm9kZTogKCkgPT4gdm9pZDtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHZhbHVlUHJvcGVydHlcclxuICAgKiBAcGFyYW0gbGFiZWxQcm9wZXJ0eSAtIGxhYmVsIHRvIGRpc3BsYXksIHNjYWxlZCB0byBmaXQgaWYgbmVjZXNzYXJ5XHJcbiAgICogQHBhcmFtIHJhbmdlIC0gcmFuZ2Ugb2YgdGhlIG5lZWRsZS4gSWYgdmFsdWVQcm9wZXJ0eSBleGNlZWRzIHRoaXMgcmFuZ2UsIHRoZSBuZWVkbGUgd2lsbCBzdG9wIGF0IG1pbiBvciBtYXguXHJcbiAgICogQHBhcmFtIHByb3ZpZGVkT3B0aW9uc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggdmFsdWVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyPiwgbGFiZWxQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8c3RyaW5nPiwgcmFuZ2U6IFJhbmdlLCBwcm92aWRlZE9wdGlvbnM/OiBHYXVnZU5vZGVPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8R2F1Z2VOb2RlT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBTZWxmT3B0aW9uc1xyXG4gICAgICByYWRpdXM6IDEwMCxcclxuICAgICAgYmFja2dyb3VuZEZpbGw6ICd3aGl0ZScsXHJcbiAgICAgIGJhY2tncm91bmRTdHJva2U6ICdyZ2IoIDg1LCA4NSwgODUgKScsXHJcbiAgICAgIGJhY2tncm91bmRMaW5lV2lkdGg6IDIsXHJcbiAgICAgIG1heExhYmVsV2lkdGhTY2FsZTogMS4zLFxyXG4gICAgICBudW1iZXJPZlRpY2tzOiAyMSwgLy8gMTAgdGlja3MgZWFjaCBvbiB0aGUgcmlnaHQgc2lkZSBhbmQgbGVmdCBzaWRlLCBwbHVzIDEgaW4gdGhlIGNlbnRlclxyXG4gICAgICBtYWpvclRpY2tTdHJva2U6ICdncmF5JyxcclxuICAgICAgbWlub3JUaWNrU3Ryb2tlOiAnZ3JheScsXHJcbiAgICAgIG1ham9yVGlja0xlbmd0aDogMTAsXHJcbiAgICAgIG1pbm9yVGlja0xlbmd0aDogNSxcclxuICAgICAgbWFqb3JUaWNrTGluZVdpZHRoOiAyLFxyXG4gICAgICBtaW5vclRpY2tMaW5lV2lkdGg6IDEsXHJcbiAgICAgIHNwYW46IE1hdGguUEkgKyBNYXRoLlBJIC8gNCxcclxuICAgICAgbmVlZGxlTGluZVdpZHRoOiAzLFxyXG4gICAgICB1cGRhdGVXaGVuSW52aXNpYmxlOiB0cnVlLFxyXG5cclxuICAgICAgLy8gTm9kZU9wdGlvbnNcclxuICAgICAgdGFuZGVtOiBUYW5kZW0uUkVRVUlSRUQsXHJcbiAgICAgIHRhbmRlbU5hbWVTdWZmaXg6ICdOb2RlJ1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy5zcGFuIDw9IDIgKiBNYXRoLlBJLCBgb3B0aW9ucy5zcGFuIG11c3QgYmUgPD0gMiAqIE1hdGguUEk6ICR7b3B0aW9ucy5zcGFufWAgKTtcclxuXHJcbiAgICBzdXBlcigpO1xyXG5cclxuICAgIHRoaXMucmFkaXVzID0gb3B0aW9ucy5yYWRpdXM7XHJcblxyXG4gICAgY29uc3QgYW5nbGVQZXJUaWNrID0gb3B0aW9ucy5zcGFuIC8gb3B0aW9ucy5udW1iZXJPZlRpY2tzO1xyXG4gICAgY29uc3QgdGFuZGVtID0gb3B0aW9ucy50YW5kZW07XHJcblxyXG4gICAgdGhpcy5hZGRDaGlsZCggbmV3IENpcmNsZSggdGhpcy5yYWRpdXMsIHtcclxuICAgICAgZmlsbDogb3B0aW9ucy5iYWNrZ3JvdW5kRmlsbCxcclxuICAgICAgc3Ryb2tlOiBvcHRpb25zLmJhY2tncm91bmRTdHJva2UsXHJcbiAgICAgIGxpbmVXaWR0aDogb3B0aW9ucy5iYWNrZ3JvdW5kTGluZVdpZHRoXHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICBjb25zdCBmb3JlZ3JvdW5kTm9kZSA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIHBpY2thYmxlOiBmYWxzZVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggZm9yZWdyb3VuZE5vZGUgKTtcclxuXHJcbiAgICBjb25zdCBuZWVkbGUgPSBuZXcgUGF0aCggU2hhcGUubGluZVNlZ21lbnQoIDAsIDAsIHRoaXMucmFkaXVzIC0gb3B0aW9ucy5tYWpvclRpY2tMZW5ndGggLyAyLCAwICksIHtcclxuICAgICAgc3Ryb2tlOiAncmVkJyxcclxuICAgICAgbGluZVdpZHRoOiBvcHRpb25zLm5lZWRsZUxpbmVXaWR0aFxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGxhYmVsVGV4dCA9IG5ldyBUZXh0KCBsYWJlbFByb3BlcnR5LCB7XHJcbiAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggMjAgKSxcclxuICAgICAgbWF4V2lkdGg6IHRoaXMucmFkaXVzICogb3B0aW9ucy5tYXhMYWJlbFdpZHRoU2NhbGUsXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2xhYmVsVGV4dCcgKVxyXG4gICAgfSApO1xyXG4gICAgbGFiZWxUZXh0LmJvdW5kc1Byb3BlcnR5LmxpbmsoICgpID0+IHtcclxuICAgICAgbGFiZWxUZXh0LmNlbnRlclggPSAwO1xyXG4gICAgICBsYWJlbFRleHQuY2VudGVyWSA9IC10aGlzLnJhZGl1cyAvIDM7XHJcbiAgICB9ICk7XHJcbiAgICBmb3JlZ3JvdW5kTm9kZS5hZGRDaGlsZCggbGFiZWxUZXh0ICk7XHJcblxyXG4gICAgY29uc3QgcGluID0gbmV3IENpcmNsZSggMiwgeyBmaWxsOiAnYmxhY2snIH0gKTtcclxuICAgIGZvcmVncm91bmROb2RlLmFkZENoaWxkKCBwaW4gKTtcclxuXHJcbiAgICBjb25zdCB0b3RhbEFuZ2xlID0gKCBvcHRpb25zLm51bWJlck9mVGlja3MgLSAxICkgKiBhbmdsZVBlclRpY2s7XHJcbiAgICBjb25zdCBzdGFydEFuZ2xlID0gLTEgLyAyICogTWF0aC5QSSAtIHRvdGFsQW5nbGUgLyAyO1xyXG4gICAgY29uc3QgZW5kQW5nbGUgPSBzdGFydEFuZ2xlICsgdG90YWxBbmdsZTtcclxuXHJcbiAgICBjb25zdCBzY3JhdGNoTWF0cml4ID0gbmV3IE1hdHJpeDMoKTtcclxuXHJcbiAgICBjb25zdCB1cGRhdGVOZWVkbGUgPSAoKSA9PiB7XHJcbiAgICAgIGlmICggdGhpcy52aXNpYmxlUHJvcGVydHkudmFsdWUgfHwgb3B0aW9ucy51cGRhdGVXaGVuSW52aXNpYmxlICkge1xyXG4gICAgICAgIGlmICggdHlwZW9mICggdmFsdWVQcm9wZXJ0eS5nZXQoKSApID09PSAnbnVtYmVyJyApIHtcclxuXHJcbiAgICAgICAgICAvLyBjbGFtcCB2YWx1ZSB0byB2YWxpZCByYW5nZSBhbmQgbWFwIGl0IHRvIGFuIGFuZ2xlXHJcbiAgICAgICAgICBjb25zdCBjbGFtcGVkVmFsdWUgPSBVdGlscy5jbGFtcCggdmFsdWVQcm9wZXJ0eS5nZXQoKSwgcmFuZ2UubWluLCByYW5nZS5tYXggKTtcclxuICAgICAgICAgIGNvbnN0IG5lZWRsZUFuZ2xlID0gVXRpbHMubGluZWFyKCByYW5nZS5taW4sIHJhbmdlLm1heCwgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGNsYW1wZWRWYWx1ZSApO1xyXG5cclxuICAgICAgICAgIC8vIDJkIHJvdGF0aW9uLCBidXQgcmV1c2luZyBvdXIgbWF0cml4IGFib3ZlXHJcbiAgICAgICAgICBuZWVkbGUuc2V0TWF0cml4KCBzY3JhdGNoTWF0cml4LnNldFRvUm90YXRpb25aKCBuZWVkbGVBbmdsZSApICk7XHJcbiAgICAgICAgICBuZWVkbGUudmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG5cclxuICAgICAgICAgIC8vIEhpZGUgdGhlIG5lZWRsZSBpZiB0aGVyZSBpcyBubyBudW1iZXIgdmFsdWUuXHJcbiAgICAgICAgICBuZWVkbGUudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHZhbHVlUHJvcGVydHkubGluayggdXBkYXRlTmVlZGxlICk7XHJcblxyXG4gICAgLy8gSWYgb3B0aW9ucy51cGRhdGVXaGVuSW52aXNpYmxlIGlzIHRydWUsIHVwZGF0ZU5lZWRsZSB3aWxsIGJlIGNhbGxlZCBieSB0aGUgdmFsdWVQcm9wZXJ0eSBsaXN0ZW5lciBhYm92ZS5cclxuICAgIC8vIE90aGVyd2lzZSwgd2UgbmVlZCB0byBsaXN0ZW4gdG8gdmlzaWJsZVByb3BlcnR5LCBhbmQgY2FsbCB1cGRhdGVOZWVkbGUgd2hlbiB0aGUgZ2F1Z2UgYmVjb21lcyB2aXNpYmxlLlxyXG4gICAgaWYgKCAhb3B0aW9ucy51cGRhdGVXaGVuSW52aXNpYmxlICkge1xyXG4gICAgICB0aGlzLnZpc2libGVQcm9wZXJ0eS5saW5rKCB2aXNpYmxlID0+IHtcclxuICAgICAgICB2aXNpYmxlICYmIHVwZGF0ZU5lZWRsZSgpO1xyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVuZGVyIGFsbCBvZiB0aGUgdGlja3MgaW50byBTaGFwZXMgbGF5ZXJzIChzaW5jZSB0aGV5IGhhdmUgZGlmZmVyZW50IHN0cm9rZXMpXHJcbiAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2VuZXJneS1za2F0ZS1wYXJrLWJhc2ljcy9pc3N1ZXMvMjA4XHJcbiAgICBjb25zdCBiaWdUaWNrc1NoYXBlID0gbmV3IFNoYXBlKCk7XHJcbiAgICBjb25zdCBzbWFsbFRpY2tzU2hhcGUgPSBuZXcgU2hhcGUoKTtcclxuXHJcbiAgICAvLyBBZGQgdGhlIHRpY2sgbWFya3NcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IG9wdGlvbnMubnVtYmVyT2ZUaWNrczsgaSsrICkge1xyXG4gICAgICBjb25zdCB0aWNrQW5nbGUgPSBpICogYW5nbGVQZXJUaWNrICsgc3RhcnRBbmdsZTtcclxuXHJcbiAgICAgIGNvbnN0IHRpY2tMZW5ndGggPSBpICUgMiA9PT0gMCA/IG9wdGlvbnMubWFqb3JUaWNrTGVuZ3RoIDogb3B0aW9ucy5taW5vclRpY2tMZW5ndGg7XHJcbiAgICAgIGNvbnN0IHgxID0gKCB0aGlzLnJhZGl1cyAtIHRpY2tMZW5ndGggKSAqIE1hdGguY29zKCB0aWNrQW5nbGUgKTtcclxuICAgICAgY29uc3QgeTEgPSAoIHRoaXMucmFkaXVzIC0gdGlja0xlbmd0aCApICogTWF0aC5zaW4oIHRpY2tBbmdsZSApO1xyXG4gICAgICBjb25zdCB4MiA9IHRoaXMucmFkaXVzICogTWF0aC5jb3MoIHRpY2tBbmdsZSApO1xyXG4gICAgICBjb25zdCB5MiA9IHRoaXMucmFkaXVzICogTWF0aC5zaW4oIHRpY2tBbmdsZSApO1xyXG4gICAgICBpZiAoIGkgJSAyID09PSAwICkge1xyXG4gICAgICAgIGJpZ1RpY2tzU2hhcGUubW92ZVRvKCB4MSwgeTEgKTtcclxuICAgICAgICBiaWdUaWNrc1NoYXBlLmxpbmVUbyggeDIsIHkyICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgc21hbGxUaWNrc1NoYXBlLm1vdmVUbyggeDEsIHkxICk7XHJcbiAgICAgICAgc21hbGxUaWNrc1NoYXBlLmxpbmVUbyggeDIsIHkyICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmb3JlZ3JvdW5kTm9kZS5hZGRDaGlsZCggbmV3IFBhdGgoIGJpZ1RpY2tzU2hhcGUsIHtcclxuICAgICAgc3Ryb2tlOiBvcHRpb25zLm1ham9yVGlja1N0cm9rZSxcclxuICAgICAgbGluZVdpZHRoOiBvcHRpb25zLm1ham9yVGlja0xpbmVXaWR0aFxyXG4gICAgfSApICk7XHJcbiAgICBmb3JlZ3JvdW5kTm9kZS5hZGRDaGlsZCggbmV3IFBhdGgoIHNtYWxsVGlja3NTaGFwZSwge1xyXG4gICAgICBzdHJva2U6IG9wdGlvbnMubWlub3JUaWNrU3Ryb2tlLFxyXG4gICAgICBsaW5lV2lkdGg6IG9wdGlvbnMubWlub3JUaWNrTGluZVdpZHRoXHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBBZGQgbmVlZGxlIGxhc3QsIHNvIGl0J3Mgb24gdG9wIG9mIHRpY2tzLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3NjZW5lcnktcGhldC9pc3N1ZXMvNTAyXHJcbiAgICBmb3JlZ3JvdW5kTm9kZS5hZGRDaGlsZCggbmVlZGxlICk7XHJcblxyXG4gICAgdGhpcy5tdXRhdGUoIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VHYXVnZU5vZGUgPSAoKSA9PiB7XHJcbiAgICAgIGlmICggdmFsdWVQcm9wZXJ0eS5oYXNMaXN0ZW5lciggdXBkYXRlTmVlZGxlICkgKSB7XHJcbiAgICAgICAgdmFsdWVQcm9wZXJ0eS51bmxpbmsoIHVwZGF0ZU5lZWRsZSApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBkZS1yZWdpc3RlciBwaGV0LWlvIHRhbmRlbXNcclxuICAgICAgZm9yZWdyb3VuZE5vZGUuZGlzcG9zZSgpO1xyXG4gICAgICBsYWJlbFRleHQuZGlzcG9zZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBzdXBwb3J0IGZvciBiaW5kZXIgZG9jdW1lbnRhdGlvbiwgc3RyaXBwZWQgb3V0IGluIGJ1aWxkcyBhbmQgb25seSBydW5zIHdoZW4gP2JpbmRlciBpcyBzcGVjaWZpZWRcclxuICAgIGFzc2VydCAmJiBwaGV0LmNoaXBwZXIucXVlcnlQYXJhbWV0ZXJzLmJpbmRlciAmJiBJbnN0YW5jZVJlZ2lzdHJ5LnJlZ2lzdGVyRGF0YVVSTCggJ3NjZW5lcnktcGhldCcsICdHYXVnZU5vZGUnLCB0aGlzICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZGlzcG9zZUdhdWdlTm9kZSgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuc2NlbmVyeVBoZXQucmVnaXN0ZXIoICdHYXVnZU5vZGUnLCBHYXVnZU5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBLE9BQU9BLE9BQU8sTUFBTSx5QkFBeUI7QUFFN0MsT0FBT0MsS0FBSyxNQUFNLHVCQUF1QjtBQUN6QyxTQUFTQyxLQUFLLFFBQVEsMEJBQTBCO0FBQ2hELE9BQU9DLGdCQUFnQixNQUFNLHNEQUFzRDtBQUNuRixPQUFPQyxTQUFTLE1BQU0saUNBQWlDO0FBQ3ZELFNBQVNDLE1BQU0sRUFBVUMsSUFBSSxFQUFlQyxJQUFJLEVBQUVDLElBQUksUUFBUSw2QkFBNkI7QUFDM0YsT0FBT0MsTUFBTSxNQUFNLDJCQUEyQjtBQUM5QyxPQUFPQyxRQUFRLE1BQU0sZUFBZTtBQUNwQyxPQUFPQyxXQUFXLE1BQU0sa0JBQWtCO0FBK0IxQyxlQUFlLE1BQU1DLFNBQVMsU0FBU04sSUFBSSxDQUFDO0VBSzFDO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNTTyxXQUFXQSxDQUFFQyxhQUF3QyxFQUFFQyxhQUF3QyxFQUFFQyxLQUFZLEVBQUVDLGVBQWtDLEVBQUc7SUFFekosTUFBTUMsT0FBTyxHQUFHZCxTQUFTLENBQTZDLENBQUMsQ0FBRTtNQUV2RTtNQUNBZSxNQUFNLEVBQUUsR0FBRztNQUNYQyxjQUFjLEVBQUUsT0FBTztNQUN2QkMsZ0JBQWdCLEVBQUUsbUJBQW1CO01BQ3JDQyxtQkFBbUIsRUFBRSxDQUFDO01BQ3RCQyxrQkFBa0IsRUFBRSxHQUFHO01BQ3ZCQyxhQUFhLEVBQUUsRUFBRTtNQUFFO01BQ25CQyxlQUFlLEVBQUUsTUFBTTtNQUN2QkMsZUFBZSxFQUFFLE1BQU07TUFDdkJDLGVBQWUsRUFBRSxFQUFFO01BQ25CQyxlQUFlLEVBQUUsQ0FBQztNQUNsQkMsa0JBQWtCLEVBQUUsQ0FBQztNQUNyQkMsa0JBQWtCLEVBQUUsQ0FBQztNQUNyQkMsSUFBSSxFQUFFQyxJQUFJLENBQUNDLEVBQUUsR0FBR0QsSUFBSSxDQUFDQyxFQUFFLEdBQUcsQ0FBQztNQUMzQkMsZUFBZSxFQUFFLENBQUM7TUFDbEJDLG1CQUFtQixFQUFFLElBQUk7TUFFekI7TUFDQUMsTUFBTSxFQUFFM0IsTUFBTSxDQUFDNEIsUUFBUTtNQUN2QkMsZ0JBQWdCLEVBQUU7SUFDcEIsQ0FBQyxFQUFFckIsZUFBZ0IsQ0FBQztJQUVwQnNCLE1BQU0sSUFBSUEsTUFBTSxDQUFFckIsT0FBTyxDQUFDYSxJQUFJLElBQUksQ0FBQyxHQUFHQyxJQUFJLENBQUNDLEVBQUUsRUFBRyx3Q0FBdUNmLE9BQU8sQ0FBQ2EsSUFBSyxFQUFFLENBQUM7SUFFdkcsS0FBSyxDQUFDLENBQUM7SUFFUCxJQUFJLENBQUNaLE1BQU0sR0FBR0QsT0FBTyxDQUFDQyxNQUFNO0lBRTVCLE1BQU1xQixZQUFZLEdBQUd0QixPQUFPLENBQUNhLElBQUksR0FBR2IsT0FBTyxDQUFDTSxhQUFhO0lBQ3pELE1BQU1ZLE1BQU0sR0FBR2xCLE9BQU8sQ0FBQ2tCLE1BQU07SUFFN0IsSUFBSSxDQUFDSyxRQUFRLENBQUUsSUFBSXBDLE1BQU0sQ0FBRSxJQUFJLENBQUNjLE1BQU0sRUFBRTtNQUN0Q3VCLElBQUksRUFBRXhCLE9BQU8sQ0FBQ0UsY0FBYztNQUM1QnVCLE1BQU0sRUFBRXpCLE9BQU8sQ0FBQ0csZ0JBQWdCO01BQ2hDdUIsU0FBUyxFQUFFMUIsT0FBTyxDQUFDSTtJQUNyQixDQUFFLENBQUUsQ0FBQztJQUVMLE1BQU11QixjQUFjLEdBQUcsSUFBSXZDLElBQUksQ0FBRTtNQUMvQndDLFFBQVEsRUFBRTtJQUNaLENBQUUsQ0FBQztJQUNILElBQUksQ0FBQ0wsUUFBUSxDQUFFSSxjQUFlLENBQUM7SUFFL0IsTUFBTUUsTUFBTSxHQUFHLElBQUl4QyxJQUFJLENBQUVMLEtBQUssQ0FBQzhDLFdBQVcsQ0FBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQzdCLE1BQU0sR0FBR0QsT0FBTyxDQUFDUyxlQUFlLEdBQUcsQ0FBQyxFQUFFLENBQUUsQ0FBQyxFQUFFO01BQ2hHZ0IsTUFBTSxFQUFFLEtBQUs7TUFDYkMsU0FBUyxFQUFFMUIsT0FBTyxDQUFDZ0I7SUFDckIsQ0FBRSxDQUFDO0lBRUgsTUFBTWUsU0FBUyxHQUFHLElBQUl6QyxJQUFJLENBQUVPLGFBQWEsRUFBRTtNQUN6Q21DLElBQUksRUFBRSxJQUFJeEMsUUFBUSxDQUFFLEVBQUcsQ0FBQztNQUN4QnlDLFFBQVEsRUFBRSxJQUFJLENBQUNoQyxNQUFNLEdBQUdELE9BQU8sQ0FBQ0ssa0JBQWtCO01BQ2xEYSxNQUFNLEVBQUVBLE1BQU0sQ0FBQ2dCLFlBQVksQ0FBRSxXQUFZO0lBQzNDLENBQUUsQ0FBQztJQUNISCxTQUFTLENBQUNJLGNBQWMsQ0FBQ0MsSUFBSSxDQUFFLE1BQU07TUFDbkNMLFNBQVMsQ0FBQ00sT0FBTyxHQUFHLENBQUM7TUFDckJOLFNBQVMsQ0FBQ08sT0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDckMsTUFBTSxHQUFHLENBQUM7SUFDdEMsQ0FBRSxDQUFDO0lBQ0gwQixjQUFjLENBQUNKLFFBQVEsQ0FBRVEsU0FBVSxDQUFDO0lBRXBDLE1BQU1RLEdBQUcsR0FBRyxJQUFJcEQsTUFBTSxDQUFFLENBQUMsRUFBRTtNQUFFcUMsSUFBSSxFQUFFO0lBQVEsQ0FBRSxDQUFDO0lBQzlDRyxjQUFjLENBQUNKLFFBQVEsQ0FBRWdCLEdBQUksQ0FBQztJQUU5QixNQUFNQyxVQUFVLEdBQUcsQ0FBRXhDLE9BQU8sQ0FBQ00sYUFBYSxHQUFHLENBQUMsSUFBS2dCLFlBQVk7SUFDL0QsTUFBTW1CLFVBQVUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUczQixJQUFJLENBQUNDLEVBQUUsR0FBR3lCLFVBQVUsR0FBRyxDQUFDO0lBQ3BELE1BQU1FLFFBQVEsR0FBR0QsVUFBVSxHQUFHRCxVQUFVO0lBRXhDLE1BQU1HLGFBQWEsR0FBRyxJQUFJN0QsT0FBTyxDQUFDLENBQUM7SUFFbkMsTUFBTThELFlBQVksR0FBR0EsQ0FBQSxLQUFNO01BQ3pCLElBQUssSUFBSSxDQUFDQyxlQUFlLENBQUNDLEtBQUssSUFBSTlDLE9BQU8sQ0FBQ2lCLG1CQUFtQixFQUFHO1FBQy9ELElBQUssT0FBU3JCLGFBQWEsQ0FBQ21ELEdBQUcsQ0FBQyxDQUFHLEtBQUssUUFBUSxFQUFHO1VBRWpEO1VBQ0EsTUFBTUMsWUFBWSxHQUFHakUsS0FBSyxDQUFDa0UsS0FBSyxDQUFFckQsYUFBYSxDQUFDbUQsR0FBRyxDQUFDLENBQUMsRUFBRWpELEtBQUssQ0FBQ29ELEdBQUcsRUFBRXBELEtBQUssQ0FBQ3FELEdBQUksQ0FBQztVQUM3RSxNQUFNQyxXQUFXLEdBQUdyRSxLQUFLLENBQUNzRSxNQUFNLENBQUV2RCxLQUFLLENBQUNvRCxHQUFHLEVBQUVwRCxLQUFLLENBQUNxRCxHQUFHLEVBQUVWLFVBQVUsRUFBRUMsUUFBUSxFQUFFTSxZQUFhLENBQUM7O1VBRTVGO1VBQ0FuQixNQUFNLENBQUN5QixTQUFTLENBQUVYLGFBQWEsQ0FBQ1ksY0FBYyxDQUFFSCxXQUFZLENBQUUsQ0FBQztVQUMvRHZCLE1BQU0sQ0FBQzJCLE9BQU8sR0FBRyxJQUFJO1FBQ3ZCLENBQUMsTUFDSTtVQUVIO1VBQ0EzQixNQUFNLENBQUMyQixPQUFPLEdBQUcsS0FBSztRQUN4QjtNQUNGO0lBQ0YsQ0FBQztJQUNENUQsYUFBYSxDQUFDd0MsSUFBSSxDQUFFUSxZQUFhLENBQUM7O0lBRWxDO0lBQ0E7SUFDQSxJQUFLLENBQUM1QyxPQUFPLENBQUNpQixtQkFBbUIsRUFBRztNQUNsQyxJQUFJLENBQUM0QixlQUFlLENBQUNULElBQUksQ0FBRW9CLE9BQU8sSUFBSTtRQUNwQ0EsT0FBTyxJQUFJWixZQUFZLENBQUMsQ0FBQztNQUMzQixDQUFFLENBQUM7SUFDTDs7SUFFQTtJQUNBO0lBQ0EsTUFBTWEsYUFBYSxHQUFHLElBQUl6RSxLQUFLLENBQUMsQ0FBQztJQUNqQyxNQUFNMEUsZUFBZSxHQUFHLElBQUkxRSxLQUFLLENBQUMsQ0FBQzs7SUFFbkM7SUFDQSxLQUFNLElBQUkyRSxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUczRCxPQUFPLENBQUNNLGFBQWEsRUFBRXFELENBQUMsRUFBRSxFQUFHO01BQ2hELE1BQU1DLFNBQVMsR0FBR0QsQ0FBQyxHQUFHckMsWUFBWSxHQUFHbUIsVUFBVTtNQUUvQyxNQUFNb0IsVUFBVSxHQUFHRixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRzNELE9BQU8sQ0FBQ1MsZUFBZSxHQUFHVCxPQUFPLENBQUNVLGVBQWU7TUFDbEYsTUFBTW9ELEVBQUUsR0FBRyxDQUFFLElBQUksQ0FBQzdELE1BQU0sR0FBRzRELFVBQVUsSUFBSy9DLElBQUksQ0FBQ2lELEdBQUcsQ0FBRUgsU0FBVSxDQUFDO01BQy9ELE1BQU1JLEVBQUUsR0FBRyxDQUFFLElBQUksQ0FBQy9ELE1BQU0sR0FBRzRELFVBQVUsSUFBSy9DLElBQUksQ0FBQ21ELEdBQUcsQ0FBRUwsU0FBVSxDQUFDO01BQy9ELE1BQU1NLEVBQUUsR0FBRyxJQUFJLENBQUNqRSxNQUFNLEdBQUdhLElBQUksQ0FBQ2lELEdBQUcsQ0FBRUgsU0FBVSxDQUFDO01BQzlDLE1BQU1PLEVBQUUsR0FBRyxJQUFJLENBQUNsRSxNQUFNLEdBQUdhLElBQUksQ0FBQ21ELEdBQUcsQ0FBRUwsU0FBVSxDQUFDO01BQzlDLElBQUtELENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFHO1FBQ2pCRixhQUFhLENBQUNXLE1BQU0sQ0FBRU4sRUFBRSxFQUFFRSxFQUFHLENBQUM7UUFDOUJQLGFBQWEsQ0FBQ1ksTUFBTSxDQUFFSCxFQUFFLEVBQUVDLEVBQUcsQ0FBQztNQUNoQyxDQUFDLE1BQ0k7UUFDSFQsZUFBZSxDQUFDVSxNQUFNLENBQUVOLEVBQUUsRUFBRUUsRUFBRyxDQUFDO1FBQ2hDTixlQUFlLENBQUNXLE1BQU0sQ0FBRUgsRUFBRSxFQUFFQyxFQUFHLENBQUM7TUFDbEM7SUFDRjtJQUVBeEMsY0FBYyxDQUFDSixRQUFRLENBQUUsSUFBSWxDLElBQUksQ0FBRW9FLGFBQWEsRUFBRTtNQUNoRGhDLE1BQU0sRUFBRXpCLE9BQU8sQ0FBQ08sZUFBZTtNQUMvQm1CLFNBQVMsRUFBRTFCLE9BQU8sQ0FBQ1c7SUFDckIsQ0FBRSxDQUFFLENBQUM7SUFDTGdCLGNBQWMsQ0FBQ0osUUFBUSxDQUFFLElBQUlsQyxJQUFJLENBQUVxRSxlQUFlLEVBQUU7TUFDbERqQyxNQUFNLEVBQUV6QixPQUFPLENBQUNRLGVBQWU7TUFDL0JrQixTQUFTLEVBQUUxQixPQUFPLENBQUNZO0lBQ3JCLENBQUUsQ0FBRSxDQUFDOztJQUVMO0lBQ0FlLGNBQWMsQ0FBQ0osUUFBUSxDQUFFTSxNQUFPLENBQUM7SUFFakMsSUFBSSxDQUFDeUMsTUFBTSxDQUFFdEUsT0FBUSxDQUFDO0lBRXRCLElBQUksQ0FBQ3VFLGdCQUFnQixHQUFHLE1BQU07TUFDNUIsSUFBSzNFLGFBQWEsQ0FBQzRFLFdBQVcsQ0FBRTVCLFlBQWEsQ0FBQyxFQUFHO1FBQy9DaEQsYUFBYSxDQUFDNkUsTUFBTSxDQUFFN0IsWUFBYSxDQUFDO01BQ3RDOztNQUVBO01BQ0FqQixjQUFjLENBQUMrQyxPQUFPLENBQUMsQ0FBQztNQUN4QjNDLFNBQVMsQ0FBQzJDLE9BQU8sQ0FBQyxDQUFDO0lBQ3JCLENBQUM7O0lBRUQ7SUFDQXJELE1BQU0sSUFBSXNELElBQUksQ0FBQ0MsT0FBTyxDQUFDQyxlQUFlLENBQUNDLE1BQU0sSUFBSTdGLGdCQUFnQixDQUFDOEYsZUFBZSxDQUFFLGNBQWMsRUFBRSxXQUFXLEVBQUUsSUFBSyxDQUFDO0VBQ3hIO0VBRWdCTCxPQUFPQSxDQUFBLEVBQVM7SUFDOUIsSUFBSSxDQUFDSCxnQkFBZ0IsQ0FBQyxDQUFDO0lBQ3ZCLEtBQUssQ0FBQ0csT0FBTyxDQUFDLENBQUM7RUFDakI7QUFDRjtBQUVBakYsV0FBVyxDQUFDdUYsUUFBUSxDQUFFLFdBQVcsRUFBRXRGLFNBQVUsQ0FBQyJ9