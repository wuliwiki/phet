// Copyright 2021-2023, University of Colorado Boulder

/**
 * The model for a side of the quadrilateral. A QuadrilateralSide is defined by the line between two Vertices.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import Vector2 from '../../../../dot/js/Vector2.js';
import quadrilateral from '../../quadrilateral.js';
import { Line } from '../../../../scenery/js/imports.js';
import { Line as LineShape, Shape } from '../../../../kite/js/imports.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import QuadrilateralMovable from './QuadrilateralMovable.js';
import Property from '../../../../axon/js/Property.js';
export default class QuadrilateralSide extends QuadrilateralMovable {
  // Reference to the vertices that compose this QuadrilateralSide.

  // Indicates that this side has been connected to another to form the shape.
  isConnected = false;

  // Length of the side in model coordinates.

  // Identifies this side within the quadrilateral shape.

  // The shape of the side - A Line determined by the distance between the vertices and model width.

  // In model coordinates, the length of a side segment in model coordinates. The full side is divided into segments of
  // this length with the final segment length being the remainder.
  static SIDE_SEGMENT_LENGTH = 0.25;

  // in model coordinates, the width of a side - Sides exist in model space to apply rules that vertices and
  // sides can never overlap
  static SIDE_WIDTH = 0.1;

  // A Line between Vertex1 and Vertex2, which may be useful for calculations - Property value
  // is reused to avoid excessive allocations.
  // Used to calculate the line shape (full stroked shape) - reused to avoid excessive allocations.
  scratchLineNode = new Line(0, 0, 0, 0, {
    lineWidth: QuadrilateralSide.SIDE_WIDTH
  });

  /**
   * @param vertex1 - The first vertex of this QuadrilateralSide.
   * @param vertex2 - The second vertex of this QuadrilateralSide.
   * @param sideLabel - To identify this QuadrilateralSide within the shape.
   * @param tandem
   */
  constructor(vertex1, vertex2, sideLabel, tandem) {
    super(tandem);
    this.vertex1 = vertex1;
    this.vertex2 = vertex2;
    this.sideLabel = sideLabel;
    this.modelLineProperty = new Property(new LineShape(vertex1.positionProperty.value, vertex2.positionProperty.value));
    this.lengthProperty = new NumberProperty(0, {
      tandem: tandem.createTandem('lengthProperty')
    });
    this.shapeProperty = new Property(new Shape());
  }

  /**
   * Update the length and model shape of this QuadrilateralSide from vertex positions. This must be calculated in order by the
   * model, after QuadrilateralVertex positions are changed and before these values are used to calculate other shape attributes.
   * See QuadrilateralShapeModel.updateOrderDependentProperties for more information.
   */
  updateLengthAndShape() {
    const vertex1Position = this.vertex1.positionProperty.value;
    const vertex2Position = this.vertex2.positionProperty.value;
    this.lengthProperty.value = Vector2.getDistanceBetweenVectors(vertex2Position, vertex1Position);

    // Update the model Line shape and notify listeners (static to avoid excessive Line instances)
    const modelLine = this.modelLineProperty.value;
    modelLine.start = vertex1Position;
    modelLine.end = vertex2Position;
    this.modelLineProperty.notifyListenersStatic();
    this.scratchLineNode.setLine(vertex1Position.x, vertex1Position.y, vertex2Position.x, vertex2Position.y);
    this.shapeProperty.value = this.scratchLineNode.getStrokedShape();
  }

  /**
   * Returns true if this QuadrilateralSide includes the provided QuadrilateralVertex.
   */
  includesVertex(vertex) {
    return this.vertex1 === vertex || this.vertex2 === vertex;
  }

  /**
   * Returns the position in model coordinates between the two Vertices of this QuadrilateralSide.
   */
  getMidpoint() {
    return this.vertex2.positionProperty.value.average(this.vertex1.positionProperty.value);
  }

  /**
   * Connect this side to another to form a shape. Connects this.vertex1 to otherSide.vertex2, illustrated like this.
   * This sets the relationship between sides and determines how angles are calculated.
   *
   *  otherSide.vertex1---------------otherSide.vertex2
   *                                  thisSide.vertex1
   *                                    |
   *                                    |
   *                                    |
   *                                    |
   *                                  this.vertex2
   *
   */
  connectToSide(otherSide) {
    assert && assert(!this.isConnected, 'Cannot connect a side that is already connected to another.');
    assert && assert(otherSide !== this, 'Cannot connect a side to itself.');
    this.isConnected = true;
    this.vertex1.connectToOthers(otherSide.vertex1, this.vertex2);
  }
}
quadrilateral.register('QuadrilateralSide', QuadrilateralSide);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWZWN0b3IyIiwicXVhZHJpbGF0ZXJhbCIsIkxpbmUiLCJMaW5lU2hhcGUiLCJTaGFwZSIsIk51bWJlclByb3BlcnR5IiwiUXVhZHJpbGF0ZXJhbE1vdmFibGUiLCJQcm9wZXJ0eSIsIlF1YWRyaWxhdGVyYWxTaWRlIiwiaXNDb25uZWN0ZWQiLCJTSURFX1NFR01FTlRfTEVOR1RIIiwiU0lERV9XSURUSCIsInNjcmF0Y2hMaW5lTm9kZSIsImxpbmVXaWR0aCIsImNvbnN0cnVjdG9yIiwidmVydGV4MSIsInZlcnRleDIiLCJzaWRlTGFiZWwiLCJ0YW5kZW0iLCJtb2RlbExpbmVQcm9wZXJ0eSIsInBvc2l0aW9uUHJvcGVydHkiLCJ2YWx1ZSIsImxlbmd0aFByb3BlcnR5IiwiY3JlYXRlVGFuZGVtIiwic2hhcGVQcm9wZXJ0eSIsInVwZGF0ZUxlbmd0aEFuZFNoYXBlIiwidmVydGV4MVBvc2l0aW9uIiwidmVydGV4MlBvc2l0aW9uIiwiZ2V0RGlzdGFuY2VCZXR3ZWVuVmVjdG9ycyIsIm1vZGVsTGluZSIsInN0YXJ0IiwiZW5kIiwibm90aWZ5TGlzdGVuZXJzU3RhdGljIiwic2V0TGluZSIsIngiLCJ5IiwiZ2V0U3Ryb2tlZFNoYXBlIiwiaW5jbHVkZXNWZXJ0ZXgiLCJ2ZXJ0ZXgiLCJnZXRNaWRwb2ludCIsImF2ZXJhZ2UiLCJjb25uZWN0VG9TaWRlIiwib3RoZXJTaWRlIiwiYXNzZXJ0IiwiY29ubmVjdFRvT3RoZXJzIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJRdWFkcmlsYXRlcmFsU2lkZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBUaGUgbW9kZWwgZm9yIGEgc2lkZSBvZiB0aGUgcXVhZHJpbGF0ZXJhbC4gQSBRdWFkcmlsYXRlcmFsU2lkZSBpcyBkZWZpbmVkIGJ5IHRoZSBsaW5lIGJldHdlZW4gdHdvIFZlcnRpY2VzLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBxdWFkcmlsYXRlcmFsIGZyb20gJy4uLy4uL3F1YWRyaWxhdGVyYWwuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbFZlcnRleCBmcm9tICcuL1F1YWRyaWxhdGVyYWxWZXJ0ZXguanMnO1xyXG5pbXBvcnQgeyBMaW5lIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IHsgTGluZSBhcyBMaW5lU2hhcGUsIFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbFNpZGVMYWJlbCBmcm9tICcuL1F1YWRyaWxhdGVyYWxTaWRlTGFiZWwuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbE1vdmFibGUgZnJvbSAnLi9RdWFkcmlsYXRlcmFsTW92YWJsZS5qcyc7XHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RQcm9wZXJ0eS5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBRdWFkcmlsYXRlcmFsU2lkZSBleHRlbmRzIFF1YWRyaWxhdGVyYWxNb3ZhYmxlIHtcclxuXHJcbiAgLy8gUmVmZXJlbmNlIHRvIHRoZSB2ZXJ0aWNlcyB0aGF0IGNvbXBvc2UgdGhpcyBRdWFkcmlsYXRlcmFsU2lkZS5cclxuICBwdWJsaWMgcmVhZG9ubHkgdmVydGV4MTogUXVhZHJpbGF0ZXJhbFZlcnRleDtcclxuICBwdWJsaWMgcmVhZG9ubHkgdmVydGV4MjogUXVhZHJpbGF0ZXJhbFZlcnRleDtcclxuXHJcbiAgLy8gSW5kaWNhdGVzIHRoYXQgdGhpcyBzaWRlIGhhcyBiZWVuIGNvbm5lY3RlZCB0byBhbm90aGVyIHRvIGZvcm0gdGhlIHNoYXBlLlxyXG4gIHByaXZhdGUgaXNDb25uZWN0ZWQgPSBmYWxzZTtcclxuXHJcbiAgLy8gTGVuZ3RoIG9mIHRoZSBzaWRlIGluIG1vZGVsIGNvb3JkaW5hdGVzLlxyXG4gIHB1YmxpYyByZWFkb25seSBsZW5ndGhQcm9wZXJ0eTogTnVtYmVyUHJvcGVydHk7XHJcblxyXG4gIC8vIElkZW50aWZpZXMgdGhpcyBzaWRlIHdpdGhpbiB0aGUgcXVhZHJpbGF0ZXJhbCBzaGFwZS5cclxuICBwdWJsaWMgcmVhZG9ubHkgc2lkZUxhYmVsOiBRdWFkcmlsYXRlcmFsU2lkZUxhYmVsO1xyXG5cclxuICAvLyBUaGUgc2hhcGUgb2YgdGhlIHNpZGUgLSBBIExpbmUgZGV0ZXJtaW5lZCBieSB0aGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgdmVydGljZXMgYW5kIG1vZGVsIHdpZHRoLlxyXG4gIHB1YmxpYyByZWFkb25seSBzaGFwZVByb3BlcnR5OiBUUHJvcGVydHk8U2hhcGU+O1xyXG5cclxuICAvLyBJbiBtb2RlbCBjb29yZGluYXRlcywgdGhlIGxlbmd0aCBvZiBhIHNpZGUgc2VnbWVudCBpbiBtb2RlbCBjb29yZGluYXRlcy4gVGhlIGZ1bGwgc2lkZSBpcyBkaXZpZGVkIGludG8gc2VnbWVudHMgb2ZcclxuICAvLyB0aGlzIGxlbmd0aCB3aXRoIHRoZSBmaW5hbCBzZWdtZW50IGxlbmd0aCBiZWluZyB0aGUgcmVtYWluZGVyLlxyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgU0lERV9TRUdNRU5UX0xFTkdUSCA9IDAuMjU7XHJcblxyXG4gIC8vIGluIG1vZGVsIGNvb3JkaW5hdGVzLCB0aGUgd2lkdGggb2YgYSBzaWRlIC0gU2lkZXMgZXhpc3QgaW4gbW9kZWwgc3BhY2UgdG8gYXBwbHkgcnVsZXMgdGhhdCB2ZXJ0aWNlcyBhbmRcclxuICAvLyBzaWRlcyBjYW4gbmV2ZXIgb3ZlcmxhcFxyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgU0lERV9XSURUSCA9IDAuMTtcclxuXHJcbiAgLy8gQSBMaW5lIGJldHdlZW4gVmVydGV4MSBhbmQgVmVydGV4Miwgd2hpY2ggbWF5IGJlIHVzZWZ1bCBmb3IgY2FsY3VsYXRpb25zIC0gUHJvcGVydHkgdmFsdWVcclxuICAvLyBpcyByZXVzZWQgdG8gYXZvaWQgZXhjZXNzaXZlIGFsbG9jYXRpb25zLlxyXG4gIHB1YmxpYyByZWFkb25seSBtb2RlbExpbmVQcm9wZXJ0eTogUHJvcGVydHk8TGluZVNoYXBlPjtcclxuXHJcbiAgLy8gVXNlZCB0byBjYWxjdWxhdGUgdGhlIGxpbmUgc2hhcGUgKGZ1bGwgc3Ryb2tlZCBzaGFwZSkgLSByZXVzZWQgdG8gYXZvaWQgZXhjZXNzaXZlIGFsbG9jYXRpb25zLlxyXG4gIHByaXZhdGUgcmVhZG9ubHkgc2NyYXRjaExpbmVOb2RlID0gbmV3IExpbmUoIDAsIDAsIDAsIDAsIHtcclxuICAgIGxpbmVXaWR0aDogUXVhZHJpbGF0ZXJhbFNpZGUuU0lERV9XSURUSFxyXG4gIH0gKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHZlcnRleDEgLSBUaGUgZmlyc3QgdmVydGV4IG9mIHRoaXMgUXVhZHJpbGF0ZXJhbFNpZGUuXHJcbiAgICogQHBhcmFtIHZlcnRleDIgLSBUaGUgc2Vjb25kIHZlcnRleCBvZiB0aGlzIFF1YWRyaWxhdGVyYWxTaWRlLlxyXG4gICAqIEBwYXJhbSBzaWRlTGFiZWwgLSBUbyBpZGVudGlmeSB0aGlzIFF1YWRyaWxhdGVyYWxTaWRlIHdpdGhpbiB0aGUgc2hhcGUuXHJcbiAgICogQHBhcmFtIHRhbmRlbVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggdmVydGV4MTogUXVhZHJpbGF0ZXJhbFZlcnRleCwgdmVydGV4MjogUXVhZHJpbGF0ZXJhbFZlcnRleCwgc2lkZUxhYmVsOiBRdWFkcmlsYXRlcmFsU2lkZUxhYmVsLCB0YW5kZW06IFRhbmRlbSApIHtcclxuICAgIHN1cGVyKCB0YW5kZW0gKTtcclxuXHJcbiAgICB0aGlzLnZlcnRleDEgPSB2ZXJ0ZXgxO1xyXG4gICAgdGhpcy52ZXJ0ZXgyID0gdmVydGV4MjtcclxuICAgIHRoaXMuc2lkZUxhYmVsID0gc2lkZUxhYmVsO1xyXG5cclxuICAgIHRoaXMubW9kZWxMaW5lUHJvcGVydHkgPSBuZXcgUHJvcGVydHkoIG5ldyBMaW5lU2hhcGUoIHZlcnRleDEucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZSwgdmVydGV4Mi5wb3NpdGlvblByb3BlcnR5LnZhbHVlICkgKTtcclxuXHJcbiAgICB0aGlzLmxlbmd0aFByb3BlcnR5ID0gbmV3IE51bWJlclByb3BlcnR5KCAwLCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2xlbmd0aFByb3BlcnR5JyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5zaGFwZVByb3BlcnR5ID0gbmV3IFByb3BlcnR5KCBuZXcgU2hhcGUoKSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIHRoZSBsZW5ndGggYW5kIG1vZGVsIHNoYXBlIG9mIHRoaXMgUXVhZHJpbGF0ZXJhbFNpZGUgZnJvbSB2ZXJ0ZXggcG9zaXRpb25zLiBUaGlzIG11c3QgYmUgY2FsY3VsYXRlZCBpbiBvcmRlciBieSB0aGVcclxuICAgKiBtb2RlbCwgYWZ0ZXIgUXVhZHJpbGF0ZXJhbFZlcnRleCBwb3NpdGlvbnMgYXJlIGNoYW5nZWQgYW5kIGJlZm9yZSB0aGVzZSB2YWx1ZXMgYXJlIHVzZWQgdG8gY2FsY3VsYXRlIG90aGVyIHNoYXBlIGF0dHJpYnV0ZXMuXHJcbiAgICogU2VlIFF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLnVwZGF0ZU9yZGVyRGVwZW5kZW50UHJvcGVydGllcyBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgdXBkYXRlTGVuZ3RoQW5kU2hhcGUoKTogdm9pZCB7XHJcbiAgICBjb25zdCB2ZXJ0ZXgxUG9zaXRpb24gPSB0aGlzLnZlcnRleDEucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZTtcclxuICAgIGNvbnN0IHZlcnRleDJQb3NpdGlvbiA9IHRoaXMudmVydGV4Mi5wb3NpdGlvblByb3BlcnR5LnZhbHVlO1xyXG5cclxuICAgIHRoaXMubGVuZ3RoUHJvcGVydHkudmFsdWUgPSBWZWN0b3IyLmdldERpc3RhbmNlQmV0d2VlblZlY3RvcnMoIHZlcnRleDJQb3NpdGlvbiwgdmVydGV4MVBvc2l0aW9uICk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHRoZSBtb2RlbCBMaW5lIHNoYXBlIGFuZCBub3RpZnkgbGlzdGVuZXJzIChzdGF0aWMgdG8gYXZvaWQgZXhjZXNzaXZlIExpbmUgaW5zdGFuY2VzKVxyXG4gICAgY29uc3QgbW9kZWxMaW5lID0gdGhpcy5tb2RlbExpbmVQcm9wZXJ0eS52YWx1ZTtcclxuICAgIG1vZGVsTGluZS5zdGFydCA9IHZlcnRleDFQb3NpdGlvbjtcclxuICAgIG1vZGVsTGluZS5lbmQgPSB2ZXJ0ZXgyUG9zaXRpb247XHJcbiAgICB0aGlzLm1vZGVsTGluZVByb3BlcnR5Lm5vdGlmeUxpc3RlbmVyc1N0YXRpYygpO1xyXG5cclxuICAgIHRoaXMuc2NyYXRjaExpbmVOb2RlLnNldExpbmUoIHZlcnRleDFQb3NpdGlvbi54LCB2ZXJ0ZXgxUG9zaXRpb24ueSwgdmVydGV4MlBvc2l0aW9uLngsIHZlcnRleDJQb3NpdGlvbi55ICk7XHJcbiAgICB0aGlzLnNoYXBlUHJvcGVydHkudmFsdWUgPSB0aGlzLnNjcmF0Y2hMaW5lTm9kZS5nZXRTdHJva2VkU2hhcGUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIFF1YWRyaWxhdGVyYWxTaWRlIGluY2x1ZGVzIHRoZSBwcm92aWRlZCBRdWFkcmlsYXRlcmFsVmVydGV4LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBpbmNsdWRlc1ZlcnRleCggdmVydGV4OiBRdWFkcmlsYXRlcmFsVmVydGV4ICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMudmVydGV4MSA9PT0gdmVydGV4IHx8IHRoaXMudmVydGV4MiA9PT0gdmVydGV4O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgcG9zaXRpb24gaW4gbW9kZWwgY29vcmRpbmF0ZXMgYmV0d2VlbiB0aGUgdHdvIFZlcnRpY2VzIG9mIHRoaXMgUXVhZHJpbGF0ZXJhbFNpZGUuXHJcbiAgICovXHJcbiAgcHVibGljIGdldE1pZHBvaW50KCk6IFZlY3RvcjIge1xyXG4gICAgcmV0dXJuIHRoaXMudmVydGV4Mi5wb3NpdGlvblByb3BlcnR5LnZhbHVlLmF2ZXJhZ2UoIHRoaXMudmVydGV4MS5wb3NpdGlvblByb3BlcnR5LnZhbHVlICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb25uZWN0IHRoaXMgc2lkZSB0byBhbm90aGVyIHRvIGZvcm0gYSBzaGFwZS4gQ29ubmVjdHMgdGhpcy52ZXJ0ZXgxIHRvIG90aGVyU2lkZS52ZXJ0ZXgyLCBpbGx1c3RyYXRlZCBsaWtlIHRoaXMuXHJcbiAgICogVGhpcyBzZXRzIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBzaWRlcyBhbmQgZGV0ZXJtaW5lcyBob3cgYW5nbGVzIGFyZSBjYWxjdWxhdGVkLlxyXG4gICAqXHJcbiAgICogIG90aGVyU2lkZS52ZXJ0ZXgxLS0tLS0tLS0tLS0tLS0tb3RoZXJTaWRlLnZlcnRleDJcclxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzU2lkZS52ZXJ0ZXgxXHJcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJ0ZXgyXHJcbiAgICpcclxuICAgKi9cclxuICBwdWJsaWMgY29ubmVjdFRvU2lkZSggb3RoZXJTaWRlOiBRdWFkcmlsYXRlcmFsU2lkZSApOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoICF0aGlzLmlzQ29ubmVjdGVkLCAnQ2Fubm90IGNvbm5lY3QgYSBzaWRlIHRoYXQgaXMgYWxyZWFkeSBjb25uZWN0ZWQgdG8gYW5vdGhlci4nICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvdGhlclNpZGUgIT09IHRoaXMsICdDYW5ub3QgY29ubmVjdCBhIHNpZGUgdG8gaXRzZWxmLicgKTtcclxuXHJcbiAgICB0aGlzLmlzQ29ubmVjdGVkID0gdHJ1ZTtcclxuICAgIHRoaXMudmVydGV4MS5jb25uZWN0VG9PdGhlcnMoIG90aGVyU2lkZS52ZXJ0ZXgxLCB0aGlzLnZlcnRleDIgKTtcclxuICB9XHJcbn1cclxuXHJcbnF1YWRyaWxhdGVyYWwucmVnaXN0ZXIoICdRdWFkcmlsYXRlcmFsU2lkZScsIFF1YWRyaWxhdGVyYWxTaWRlICk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxPQUFPLE1BQU0sK0JBQStCO0FBRW5ELE9BQU9DLGFBQWEsTUFBTSx3QkFBd0I7QUFFbEQsU0FBU0MsSUFBSSxRQUFRLG1DQUFtQztBQUN4RCxTQUFTQSxJQUFJLElBQUlDLFNBQVMsRUFBRUMsS0FBSyxRQUFRLGdDQUFnQztBQUN6RSxPQUFPQyxjQUFjLE1BQU0sdUNBQXVDO0FBRWxFLE9BQU9DLG9CQUFvQixNQUFNLDJCQUEyQjtBQUM1RCxPQUFPQyxRQUFRLE1BQU0saUNBQWlDO0FBR3RELGVBQWUs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