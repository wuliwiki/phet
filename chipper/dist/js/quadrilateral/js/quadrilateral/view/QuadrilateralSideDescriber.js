// Copyright 2022-2023, University of Colorado Boulder

/**
 * Responsible for generating descriptions related to Sides.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import quadrilateral from '../../quadrilateral.js';
import QuadrilateralSide from '../model/QuadrilateralSide.js';
import Range from '../../../../dot/js/Range.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import QuadrilateralStrings from '../../QuadrilateralStrings.js';
import NamedQuadrilateral from '../model/NamedQuadrilateral.js';
// constants
const farShorterThanStringProperty = QuadrilateralStrings.a11y.voicing.farShorterThanStringProperty;
const aboutHalfAsLongAsStringProperty = QuadrilateralStrings.a11y.voicing.aboutHalfAsLongAsStringProperty;
const aLittleShorterThanStringProperty = QuadrilateralStrings.a11y.voicing.aLittleShorterThanStringProperty;
const muchShorterThanStringProperty = QuadrilateralStrings.a11y.voicing.muchShorterThanStringProperty;
const similarButShorterThanStringProperty = QuadrilateralStrings.a11y.voicing.similarButShorterThanStringProperty;
const similarButLongerThanStringProperty = QuadrilateralStrings.a11y.voicing.similarButLongerThanStringProperty;
const aLittleLongerThanStringProperty = QuadrilateralStrings.a11y.voicing.aLittleLongerThanStringProperty;
const muchLongerThanStringProperty = QuadrilateralStrings.a11y.voicing.muchLongerThanStringProperty;
const aboutTwiceAsLongAsStringProperty = QuadrilateralStrings.a11y.voicing.aboutTwiceAsLongAsStringProperty;
const farLongerThanStringProperty = QuadrilateralStrings.a11y.voicing.farLongerThanStringProperty;
const equalToStringProperty = QuadrilateralStrings.a11y.voicing.equalToStringProperty;
const twiceAsLongAsStringProperty = QuadrilateralStrings.a11y.voicing.twiceAsLongAsStringProperty;
const halfAsLongAsStringProperty = QuadrilateralStrings.a11y.voicing.halfAsLongAsStringProperty;
const parallelSideObjectResponsePatternStringProperty = QuadrilateralStrings.a11y.voicing.parallelSideObjectResponsePatternStringProperty;
const parallelEqualSideObjectResponsePatternStringProperty = QuadrilateralStrings.a11y.voicing.parallelEqualSideObjectResponsePatternStringProperty;
const sideObjectResponsePatternStringProperty = QuadrilateralStrings.a11y.voicing.sideObjectResponsePatternStringProperty;
const equalToAdjacentSidesStringProperty = QuadrilateralStrings.a11y.voicing.equalToAdjacentSidesStringProperty;
const equalToOneAdjacentSideStringProperty = QuadrilateralStrings.a11y.voicing.equalToOneAdjacentSideStringProperty;
const equalAdjacentSidesPatternStringProperty = QuadrilateralStrings.a11y.voicing.equalAdjacentSidesPatternStringProperty;
const equalAdjacentParallelSidesPatternStringProperty = QuadrilateralStrings.a11y.voicing.equalAdjacentParallelSidesPatternStringProperty;
const shorterThanAdjacentSidesStringProperty = QuadrilateralStrings.a11y.voicing.shorterThanAdjacentSidesStringProperty;
const longerThanAdjacentSidesStringProperty = QuadrilateralStrings.a11y.voicing.longerThanAdjacentSidesStringProperty;
const notEqualToAdjacentSidesStringProperty = QuadrilateralStrings.a11y.voicing.notEqualToAdjacentSidesStringProperty;
const shorterThanParallelAdjacentSidesStringProperty = QuadrilateralStrings.a11y.voicing.shorterThanParallelAdjacentSidesStringProperty;
const longerThanParallelAdjacentSidesStringProperty = QuadrilateralStrings.a11y.voicing.longerThanParallelAdjacentSidesStringProperty;
const notEqualToParallelAdjacentSidesStringProperty = QuadrilateralStrings.a11y.voicing.notEqualToParallelAdjacentSidesStringProperty;
const oneUnitStringProperty = QuadrilateralStrings.a11y.voicing.oneUnitStringProperty;
const numberOfUnitsPatternStringProperty = QuadrilateralStrings.a11y.voicing.numberOfUnitsPatternStringProperty;
const numberOfUnitsAndAHalfPatternStringProperty = QuadrilateralStrings.a11y.voicing.numberOfUnitsAndAHalfPatternStringProperty;
const sideUnitsObjectResponsePatternStringProperty = QuadrilateralStrings.a11y.voicing.sideUnitsObjectResponsePatternStringProperty;
const oneQuarterUnitStringProperty = QuadrilateralStrings.a11y.voicing.oneQuarterUnitStringProperty;
const numberAndOneQuarterUnitsPatternStringProperty = QuadrilateralStrings.a11y.voicing.numberAndOneQuarterUnitsPatternStringProperty;
const threeQuarterUnitsStringProperty = QuadrilateralStrings.a11y.voicing.threeQuarterUnitsStringProperty;
const numberAndThreeQuarterUnitsPatternStringProperty = QuadrilateralStrings.a11y.voicing.numberAndThreeQuarterUnitsPatternStringProperty;
const aboutOneUnitStringProperty = QuadrilateralStrings.a11y.voicing.aboutOneUnitStringProperty;
const aboutNumberUnitsPatternStringProperty = QuadrilateralStrings.a11y.voicing.aboutNumberUnitsPatternStringProperty;
const aboutOneHalfUnitsStringProperty = QuadrilateralStrings.a11y.voicing.aboutOneHalfUnitsStringProperty;
const aboutNumberAndAHalfUnitsPatternStringProperty = QuadrilateralStrings.a11y.voicing.aboutNumberAndAHalfUnitsPatternStringProperty;
const aboutNumberQuarterUnitsPatternStringProperty = QuadrilateralStrings.a11y.voicing.aboutNumberQuarterUnitsPatternStringProperty;
const aboutFullNumberAndNumberQuarterUnitsPatternStringProperty = QuadrilateralStrings.a11y.voicing.aboutFullNumberAndNumberQuarterUnitsPatternStringProperty;
const oneHalfUnitsStringProperty = QuadrilateralStrings.a11y.voicing.oneHalfUnitsStringProperty;

// A map that will provide comparison descriptions for side lengths. Range values are the ratio between lengths
// of different sides.
const LENGTH_COMPARISON_DESCRIPTION_MAP = new Map();
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(0, 0.1), farShorterThanStringProperty);
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(0.1, 0.4), muchShorterThanStringProperty);
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(0.4, 0.6), aboutHalfAsLongAsStringProperty);
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(0.6, 0.8), aLittleShorterThanStringProperty);
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(0.8, 1), similarButShorterThanStringProperty);
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(1, 1.3), similarButLongerThanStringProperty);
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(1.3, 1.6), aLittleLongerThanStringProperty);
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(1.6, 1.8), muchLongerThanStringProperty);
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(1.8, 2.2), aboutTwiceAsLongAsStringProperty);
LENGTH_COMPARISON_DESCRIPTION_MAP.set(new Range(2.2, Number.POSITIVE_INFINITY), farLongerThanStringProperty);
export default class QuadrilateralSideDescriber {
  constructor(side, quadrilateralShapeModel, markersVisibleProperty, modelViewTransform) {
    this.side = side;
    this.quadrilateralShapeModel = quadrilateralShapeModel;
    this.modelViewTransform = modelViewTransform;
    this.markersVisibleProperty = markersVisibleProperty;
  }

  /**
   * Returns the Object response for the QuadrilateralSide for Voicing. Returns something like
   *
   * "equal to opposite side, equal to adjacent sides." or
   * "parallel and a little longer than opposite, shorter than adjacent sides"
   */
  getSideObjectResponse() {
    let response = '';
    const oppositeSide = this.quadrilateralShapeModel.oppositeSideMap.get(this.side);
    const parallelSidePairs = this.quadrilateralShapeModel.parallelSidePairsProperty.value;
    const thisSideIsParallel = _.some(parallelSidePairs, sidePair => sidePair.component1 === this.side || sidePair.component2 === this.side);
    const thisSideEqualToOppositeSide = this.quadrilateralShapeModel.isInterLengthEqualToOther(oppositeSide.lengthProperty.value, this.side.lengthProperty.value);

    // Unique string patterns to support more natural english when opposite sides are both parallel AND equal in length.
    const patternStringProperty = thisSideIsParallel && thisSideEqualToOppositeSide ? parallelEqualSideObjectResponsePatternStringProperty : thisSideIsParallel ? parallelSideObjectResponsePatternStringProperty : sideObjectResponsePatternStringProperty;

    // If the quadrilateral is a rhombus or a square, always describe that the opposite side is equal in length to the
    // other. This may not happen naturally by comparing side lengths because a rhombus and square may be detected
    // when sides are not perfectly equal due to the angle tolerance interval.
    const shapeName = this.quadrilateralShapeModel.shapeNameProperty.value;
    const oppositeComparison = shapeName === NamedQuadrilateral.SQUARE || shapeName === NamedQuadrilateral.RHOMBUS ? equalToStringProperty : this.getLengthComparisonDescription(oppositeSide);
    response = StringUtils.fillIn(patternStringProperty, {
      oppositeComparison: oppositeComparison,
      adjacentSideDescription: this.getAdjacentSideDescription()
    });

    // if 'markers' are visible describe the side length units by appending that information to the object response
    if (this.markersVisibleProperty.value) {
      const unitsDescription = this.getSideUnitsDescription();
      response = StringUtils.fillIn(sideUnitsObjectResponsePatternStringProperty, {
        unitsDescription: unitsDescription,
        objectResponse: response
      });
    }
    return response;
  }

  /**
   * Returns a description of the number of length units for this side. Returns something like
   *
   * "1 unit" or
   * "just over 3 units" or
   * "2 and a half units" or
   * "2 and a quarter units" or
   * "2 and three-quarter units".
   */
  getSideUnitsDescription() {
    const shapeModel = this.quadrilateralShapeModel;
    const sideLength = this.side.lengthProperty.value;
    const numberOfFullUnits = Math.floor(sideLength / QuadrilateralSide.SIDE_SEGMENT_LENGTH);
    const remainder = sideLength % QuadrilateralSide.SIDE_SEGMENT_LENGTH;
    if (shapeModel.isInterLengthEqualToOther(remainder, 0)) {
      if (numberOfFullUnits === 1) {
        // "one unit"
        return oneUnitStringProperty;
      } else {
        // "3 units"
        return StringUtils.fillIn(numberOfUnitsPatternStringProperty, {
          numberOfUnits: numberOfFullUnits
        });
      }
    } else if (shapeModel.isInterLengthEqualToOther(remainder, QuadrilateralSide.SIDE_SEGMENT_LENGTH / 2)) {
      if (numberOfFullUnits === 0) {
        return oneHalfUnitsStringProperty;
      } else {
        // three and a half units
        return StringUtils.fillIn(numberOfUnitsAndAHalfPatternStringProperty, {
          numberOfUnits: numberOfFullUnits
        });
      }
    } else if (shapeModel.isInterLengthEqualToOther(remainder, QuadrilateralSide.SIDE_SEGMENT_LENGTH / 4)) {
      if (numberOfFullUnits === 0) {
        // "one quarter units"
        return oneQuarterUnitStringProperty;
      } else {
        // 2 and three-quarter units
        return StringUtils.fillIn(numberAndOneQuarterUnitsPatternStringProperty, {
          fullNumber: numberOfFullUnits
        });
      }
    } else if (shapeModel.isInterLengthEqualToOther(remainder, 3 * QuadrilateralSide.SIDE_SEGMENT_LENGTH / 4)) {
      if (numberOfFullUnits === 0) {
        // "one quarter units"
        return threeQuarterUnitsStringProperty;
      } else {
        // 2 and three-quarter units
        return StringUtils.fillIn(numberAndThreeQuarterUnitsPatternStringProperty, {
          fullNumber: numberOfFullUnits
        });
      }
    } else {
      const numberOfQuarterUnits = Math.ceil(sideLength / QuadrilateralSide.SIDE_SEGMENT_LENGTH * 4);
      const numberOfExtraCornerUnits = numberOfQuarterUnits % 4;
      if (numberOfExtraCornerUnits === 0) {
        if (numberOfFullUnits === 0) {
          return aboutOneUnitStringProperty;
        } else {
          // about 3 units (just under, currently)
          return StringUtils.fillIn(aboutNumberUnitsPatternStringProperty, {
            number: numberOfFullUnits + 1
          });
        }
      } else if (numberOfExtraCornerUnits === 2) {
        if (numberOfFullUnits === 0) {
          // about one-half units
          return aboutOneHalfUnitsStringProperty;
        } else {
          // about 1 and a half units
          return StringUtils.fillIn(aboutNumberAndAHalfUnitsPatternStringProperty, {
            number: numberOfFullUnits
          });
        }
      } else {
        if (numberOfFullUnits === 0) {
          // about three-quarter units
          // about one-quarter units
          return StringUtils.fillIn(aboutNumberQuarterUnitsPatternStringProperty, {
            number: numberOfExtraCornerUnits
          });
        } else {
          // about 2 and one quarter units
          // about 3 and three-quarter units
          return StringUtils.fillIn(aboutFullNumberAndNumberQuarterUnitsPatternStringProperty, {
            fullNumber: numberOfFullUnits,
            number: numberOfExtraCornerUnits
          });
        }
      }
    }
  }

  /**
   * Get a description of the adjacent sides and how this side compares to them in length. Also includes information
   * about them if they are parallel. Used for the Object response of this vertex. Will return something like
   *
   * "much smaller than adjacent equal sides" or
   * "equal to adjacent sides" or
   * "not equal to parallel adjacent sides"
   */
  getAdjacentSideDescription() {
    let description = null;
    const adjacentSides = this.quadrilateralShapeModel.adjacentSideMap.get(this.side);
    const adjacentSidesEqual = this.quadrilateralShapeModel.isInterLengthEqualToOther(adjacentSides[0].lengthProperty.value, adjacentSides[1].lengthProperty.value);
    let numberOfEqualAdjacentSidePairs = 0;
    const adjacentSidePairs = this.quadrilateralShapeModel.adjacentEqualSidePairsProperty.value;
    adjacentSidePairs.forEach(sidePair => {
      if (sidePair.component1 === this.side || sidePair.component2 === this.side) {
        numberOfEqualAdjacentSidePairs++;
      }
    });
    const parallelSideChecker = _.find(this.quadrilateralShapeModel.parallelSideCheckers, checker => {
      return checker.sidePair.component1 === adjacentSides[0] || checker.sidePair.component1 === adjacentSides[1];
    });
    assert && assert(parallelSideChecker, 'did not find ParallelSideChecker');
    const adjacentSidesParallel = parallelSideChecker.areSidesParallel();
    if (numberOfEqualAdjacentSidePairs === 2) {
      // This side and both adjacent sides are all equal
      if (adjacentSidesParallel) {
        description = 'equal to parallel adjacent sides';
      } else {
        description = equalToAdjacentSidesStringProperty;
      }
    } else if (numberOfEqualAdjacentSidePairs === 1) {
      // Just one 'equal' side, that is all we need to describe
      description = equalToOneAdjacentSideStringProperty;
    } else if (adjacentSidesEqual) {
      const patternStringProperty = adjacentSidesParallel ? equalAdjacentParallelSidesPatternStringProperty : equalAdjacentSidesPatternStringProperty;

      // the adjacent sides are equal in length but not equal to this side, describe the length of
      // this side relative to the other sides but we can use either side since they are equal in length
      description = StringUtils.fillIn(patternStringProperty, {
        comparison: this.getLengthComparisonDescription(adjacentSides[0])
      });
    } else {
      // None of this side or adjacent sides are equal. Describe how this side is shorter than both, longer
      // than both, or simply equal to neither.
      const sideLength = this.side.lengthProperty.value;
      const firstAdjacentLength = adjacentSides[0].lengthProperty.value;
      const secondAdjacentLength = adjacentSides[1].lengthProperty.value;
      if (firstAdjacentLength > sideLength && secondAdjacentLength > sideLength) {
        description = adjacentSidesParallel ? shorterThanParallelAdjacentSidesStringProperty : shorterThanAdjacentSidesStringProperty;
      } else if (firstAdjacentLength < sideLength && secondAdjacentLength < sideLength) {
        description = adjacentSidesParallel ? longerThanParallelAdjacentSidesStringProperty : longerThanAdjacentSidesStringProperty;
      } else {
        description = adjacentSidesParallel ? notEqualToParallelAdjacentSidesStringProperty : notEqualToAdjacentSidesStringProperty;
      }
    }
    return description;
  }

  /**
   * Returns a description of comparison between two sides, using entries of LENGTH_COMPARISON_DESCRIPTION_MAP.
   * Description compares this side to otherSide. For example, if this side (SideAB) is longer than (sideCD) the output
   * will be something like:
   * "SideAB is much longer than sideCD."
   */
  getLengthComparisonDescription(otherSide) {
    const shapeModel = this.quadrilateralShapeModel;
    const length1 = this.side.lengthProperty.value;
    const length2 = otherSide.lengthProperty.value;
    if (shapeModel.isInterLengthEqualToOther(length1, length2)) {
      return equalToStringProperty;
    } else if (shapeModel.isInterLengthEqualToOther(length1, length2 * 2)) {
      return twiceAsLongAsStringProperty;
    } else if (shapeModel.isInterLengthEqualToOther(length1, length2 / 2)) {
      return halfAsLongAsStringProperty;
    } else {
      let description = null;
      const lengthRatio = length1 / length2;
      LENGTH_COMPARISON_DESCRIPTION_MAP.forEach((value, key) => {
        if (key.contains(lengthRatio)) {
          description = value;
        }
      });
      assert && assert(description, 'No description found for length ratio');
      return description;
    }
  }
}
quadrilateral.register('QuadrilateralSideDescriber', QuadrilateralSideDescriber);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJxdWFkcmlsYXRlcmFsIiwiUXVhZHJpbGF0ZXJhbFNpZGUiLCJSYW5nZSIsIlN0cmluZ1V0aWxzIiwiUXVhZHJpbGF0ZXJhbFN0cmluZ3MiLCJOYW1lZFF1YWRyaWxhdGVyYWwiLCJmYXJTaG9ydGVyVGhhblN0cmluZ1Byb3BlcnR5IiwiYTExeSIsInZvaWNpbmciLCJhYm91dEhhbGZBc0xvbmdBc1N0cmluZ1Byb3BlcnR5IiwiYUxpdHRsZVNob3J0ZXJUaGFuU3RyaW5nUHJvcGVydHkiLCJtdWNoU2hvcnRlclRoYW5TdHJpbmdQcm9wZXJ0eSIsInNpbWlsYXJCdXRTaG9ydGVyVGhhblN0cmluZ1Byb3BlcnR5Iiwic2ltaWxhckJ1dExvbmdlclRoYW5TdHJpbmdQcm9wZXJ0eSIsImFMaXR0bGVMb25nZXJUaGFuU3RyaW5nUHJvcGVydHkiLCJtdWNoTG9uZ2VyVGhhblN0cmluZ1Byb3BlcnR5IiwiYWJvdXRUd2ljZUFzTG9uZ0FzU3RyaW5nUHJvcGVydHkiLCJmYXJMb25nZXJUaGFuU3RyaW5nUHJvcGVydHkiLCJlcXVhbFRvU3RyaW5nUHJvcGVydHkiLCJ0d2ljZUFzTG9uZ0FzU3RyaW5nUHJvcGVydHkiLCJoYWxmQXNMb25nQXNTdHJpbmdQcm9wZXJ0eSIsInBhcmFsbGVsU2lkZU9iamVjdFJlc3BvbnNlUGF0dGVyblN0cmluZ1Byb3BlcnR5IiwicGFyYWxsZWxFcXVhbFNpZGVPYmplY3RSZXNwb25zZVBhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsInNpZGVPYmplY3RSZXNwb25zZVBhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsImVxdWFsVG9BZGphY2VudFNpZGVzU3RyaW5nUHJvcGVydHkiLCJlcXVhbFRvT25lQWRqYWNlbnRTaWRlU3RyaW5nUHJvcGVydHkiLCJlcXVhbEFkamFjZW50U2lkZXNQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJlcXVhbEFkamFjZW50UGFyYWxsZWxTaWRlc1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsInNob3J0ZXJUaGFuQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5IiwibG9uZ2VyVGhhbkFkamFjZW50U2lkZXNTdHJpbmdQcm9wZXJ0eSIsIm5vdEVxdWFsVG9BZGphY2VudFNpZGVzU3RyaW5nUHJvcGVydHkiLCJzaG9ydGVyVGhhblBhcmFsbGVsQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5IiwibG9uZ2VyVGhhblBhcmFsbGVsQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5Iiwibm90RXF1YWxUb1BhcmFsbGVsQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5Iiwib25lVW5pdFN0cmluZ1Byb3BlcnR5IiwibnVtYmVyT2ZVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsIm51bWJlck9mVW5pdHNBbmRBSGFsZlBhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsInNpZGVVbml0c09iamVjdFJlc3BvbnNlUGF0dGVyblN0cmluZ1Byb3BlcnR5Iiwib25lUXVhcnRlclVuaXRTdHJpbmdQcm9wZXJ0eSIsIm51bWJlckFuZE9uZVF1YXJ0ZXJVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsInRocmVlUXVhcnRlclVuaXRzU3RyaW5nUHJvcGVydHkiLCJudW1iZXJBbmRUaHJlZVF1YXJ0ZXJVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsImFib3V0T25lVW5pdFN0cmluZ1Byb3BlcnR5IiwiYWJvdXROdW1iZXJVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsImFib3V0T25lSGFsZlVuaXRzU3RyaW5nUHJvcGVydHkiLCJhYm91dE51bWJlckFuZEFIYWxmVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJhYm91dE51bWJlclF1YXJ0ZXJVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsImFib3V0RnVsbE51bWJlckFuZE51bWJlclF1YXJ0ZXJVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsIm9uZUhhbGZVbml0c1N0cmluZ1Byb3BlcnR5IiwiTEVOR1RIX0NPTVBBUklTT05fREVTQ1JJUFRJT05fTUFQIiwiTWFwIiwic2V0IiwiTnVtYmVyIiwiUE9TSVRJVkVfSU5GSU5JVFkiLCJRdWFkcmlsYXRlcmFsU2lkZURlc2NyaWJlciIsImNvbnN0cnVjdG9yIiwic2lkZSIsInF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsIiwibWFya2Vyc1Zpc2libGVQcm9wZXJ0eSIsIm1vZGVsVmlld1RyYW5zZm9ybSIsImdldFNpZGVPYmplY3RSZXNwb25zZSIsInJlc3BvbnNlIiwib3Bwb3NpdGVTaWRlIiwib3Bwb3NpdGVTaWRlTWFwIiwiZ2V0IiwicGFyYWxsZWxTaWRlUGFpcnMiLCJwYXJhbGxlbFNpZGVQYWlyc1Byb3BlcnR5IiwidmFsdWUiLCJ0aGlzU2lkZUlzUGFyYWxsZWwiLCJfIiwic29tZSIsInNpZGVQYWlyIiwiY29tcG9uZW50MSIsImNvbXBvbmVudDIiLCJ0aGlzU2lkZUVxdWFsVG9PcHBvc2l0ZVNpZGUiLCJpc0ludGVyTGVuZ3RoRXF1YWxUb090aGVyIiwibGVuZ3RoUHJvcGVydHkiLCJwYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJzaGFwZU5hbWUiLCJzaGFwZU5hbWVQcm9wZXJ0eSIsIm9wcG9zaXRlQ29tcGFyaXNvbiIsIlNRVUFSRSIsIlJIT01CVVMiLCJnZXRMZW5ndGhDb21wYXJpc29uRGVzY3JpcHRpb24iLCJmaWxsSW4iLCJhZGphY2VudFNpZGVEZXNjcmlwdGlvbiIsImdldEFkamFjZW50U2lkZURlc2NyaXB0aW9uIiwidW5pdHNEZXNjcmlwdGlvbiIsImdldFNpZGVVbml0c0Rlc2NyaXB0aW9uIiwib2JqZWN0UmVzcG9uc2UiLCJzaGFwZU1vZGVsIiwic2lkZUxlbmd0aCIsIm51bWJlck9mRnVsbFVuaXRzIiwiTWF0aCIsImZsb29yIiwiU0lERV9TRUdNRU5UX0xFTkdUSCIsInJlbWFpbmRlciIsIm51bWJlck9mVW5pdHMiLCJmdWxsTnVtYmVyIiwibnVtYmVyT2ZRdWFydGVyVW5pdHMiLCJjZWlsIiwibnVtYmVyT2ZFeHRyYUNvcm5lclVuaXRzIiwibnVtYmVyIiwiZGVzY3JpcHRpb24iLCJhZGphY2VudFNpZGVzIiwiYWRqYWNlbnRTaWRlTWFwIiwiYWRqYWNlbnRTaWRlc0VxdWFsIiwibnVtYmVyT2ZFcXVhbEFkamFjZW50U2lkZVBhaXJzIiwiYWRqYWNlbnRTaWRlUGFpcnMiLCJhZGphY2VudEVxdWFsU2lkZVBhaXJzUHJvcGVydHkiLCJmb3JFYWNoIiwicGFyYWxsZWxTaWRlQ2hlY2tlciIsImZpbmQiLCJwYXJhbGxlbFNpZGVDaGVja2VycyIsImNoZWNrZXIiLCJhc3NlcnQiLCJhZGphY2VudFNpZGVzUGFyYWxsZWwiLCJhcmVTaWRlc1BhcmFsbGVsIiwiY29tcGFyaXNvbiIsImZpcnN0QWRqYWNlbnRMZW5ndGgiLCJzZWNvbmRBZGphY2VudExlbmd0aCIsIm90aGVyU2lkZSIsImxlbmd0aDEiLCJsZW5ndGgyIiwibGVuZ3RoUmF0aW8iLCJrZXkiLCJjb250YWlucyIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiUXVhZHJpbGF0ZXJhbFNpZGVEZXNjcmliZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjItMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogUmVzcG9uc2libGUgZm9yIGdlbmVyYXRpbmcgZGVzY3JpcHRpb25zIHJlbGF0ZWQgdG8gU2lkZXMuXHJcbiAqXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBxdWFkcmlsYXRlcmFsIGZyb20gJy4uLy4uL3F1YWRyaWxhdGVyYWwuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbFNpZGUgZnJvbSAnLi4vbW9kZWwvUXVhZHJpbGF0ZXJhbFNpZGUuanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IFF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsIGZyb20gJy4uL21vZGVsL1F1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLmpzJztcclxuaW1wb3J0IFN0cmluZ1V0aWxzIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdXRpbC9TdHJpbmdVdGlscy5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsU3RyaW5ncyBmcm9tICcuLi8uLi9RdWFkcmlsYXRlcmFsU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBOYW1lZFF1YWRyaWxhdGVyYWwgZnJvbSAnLi4vbW9kZWwvTmFtZWRRdWFkcmlsYXRlcmFsLmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCB7IE51bGxhYmxlUXVhZHJpbGF0ZXJhbFN0cmluZ1R5cGUgfSBmcm9tICcuL1F1YWRyaWxhdGVyYWxEZXNjcmliZXIuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IGZhclNob3J0ZXJUaGFuU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcuZmFyU2hvcnRlclRoYW5TdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgYWJvdXRIYWxmQXNMb25nQXNTdHJpbmdQcm9wZXJ0eSA9IFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5hYm91dEhhbGZBc0xvbmdBc1N0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBhTGl0dGxlU2hvcnRlclRoYW5TdHJpbmdQcm9wZXJ0eSA9IFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5hTGl0dGxlU2hvcnRlclRoYW5TdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgbXVjaFNob3J0ZXJUaGFuU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcubXVjaFNob3J0ZXJUaGFuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IHNpbWlsYXJCdXRTaG9ydGVyVGhhblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLnNpbWlsYXJCdXRTaG9ydGVyVGhhblN0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBzaW1pbGFyQnV0TG9uZ2VyVGhhblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLnNpbWlsYXJCdXRMb25nZXJUaGFuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IGFMaXR0bGVMb25nZXJUaGFuU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcuYUxpdHRsZUxvbmdlclRoYW5TdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgbXVjaExvbmdlclRoYW5TdHJpbmdQcm9wZXJ0eSA9IFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5tdWNoTG9uZ2VyVGhhblN0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBhYm91dFR3aWNlQXNMb25nQXNTdHJpbmdQcm9wZXJ0eSA9IFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5hYm91dFR3aWNlQXNMb25nQXNTdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgZmFyTG9uZ2VyVGhhblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLmZhckxvbmdlclRoYW5TdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgZXF1YWxUb1N0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLmVxdWFsVG9TdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgdHdpY2VBc0xvbmdBc1N0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLnR3aWNlQXNMb25nQXNTdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgaGFsZkFzTG9uZ0FzU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcuaGFsZkFzTG9uZ0FzU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IHBhcmFsbGVsU2lkZU9iamVjdFJlc3BvbnNlUGF0dGVyblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLnBhcmFsbGVsU2lkZU9iamVjdFJlc3BvbnNlUGF0dGVyblN0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBwYXJhbGxlbEVxdWFsU2lkZU9iamVjdFJlc3BvbnNlUGF0dGVyblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLnBhcmFsbGVsRXF1YWxTaWRlT2JqZWN0UmVzcG9uc2VQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IHNpZGVPYmplY3RSZXNwb25zZVBhdHRlcm5TdHJpbmdQcm9wZXJ0eSA9IFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5zaWRlT2JqZWN0UmVzcG9uc2VQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IGVxdWFsVG9BZGphY2VudFNpZGVzU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcuZXF1YWxUb0FkamFjZW50U2lkZXNTdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgZXF1YWxUb09uZUFkamFjZW50U2lkZVN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLmVxdWFsVG9PbmVBZGphY2VudFNpZGVTdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgZXF1YWxBZGphY2VudFNpZGVzUGF0dGVyblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLmVxdWFsQWRqYWNlbnRTaWRlc1BhdHRlcm5TdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgZXF1YWxBZGphY2VudFBhcmFsbGVsU2lkZXNQYXR0ZXJuU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcuZXF1YWxBZGphY2VudFBhcmFsbGVsU2lkZXNQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IHNob3J0ZXJUaGFuQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLnNob3J0ZXJUaGFuQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBsb25nZXJUaGFuQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLmxvbmdlclRoYW5BZGphY2VudFNpZGVzU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IG5vdEVxdWFsVG9BZGphY2VudFNpZGVzU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcubm90RXF1YWxUb0FkamFjZW50U2lkZXNTdHJpbmdQcm9wZXJ0eTtcclxuY29uc3Qgc2hvcnRlclRoYW5QYXJhbGxlbEFkamFjZW50U2lkZXNTdHJpbmdQcm9wZXJ0eSA9IFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5zaG9ydGVyVGhhblBhcmFsbGVsQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBsb25nZXJUaGFuUGFyYWxsZWxBZGphY2VudFNpZGVzU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcubG9uZ2VyVGhhblBhcmFsbGVsQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBub3RFcXVhbFRvUGFyYWxsZWxBZGphY2VudFNpZGVzU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcubm90RXF1YWxUb1BhcmFsbGVsQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBvbmVVbml0U3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcub25lVW5pdFN0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBudW1iZXJPZlVuaXRzUGF0dGVyblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLm51bWJlck9mVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IG51bWJlck9mVW5pdHNBbmRBSGFsZlBhdHRlcm5TdHJpbmdQcm9wZXJ0eSA9IFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5udW1iZXJPZlVuaXRzQW5kQUhhbGZQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IHNpZGVVbml0c09iamVjdFJlc3BvbnNlUGF0dGVyblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLnNpZGVVbml0c09iamVjdFJlc3BvbnNlUGF0dGVyblN0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBvbmVRdWFydGVyVW5pdFN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLm9uZVF1YXJ0ZXJVbml0U3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IG51bWJlckFuZE9uZVF1YXJ0ZXJVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSA9IFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5udW1iZXJBbmRPbmVRdWFydGVyVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IHRocmVlUXVhcnRlclVuaXRzU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcudGhyZWVRdWFydGVyVW5pdHNTdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgbnVtYmVyQW5kVGhyZWVRdWFydGVyVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcubnVtYmVyQW5kVGhyZWVRdWFydGVyVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IGFib3V0T25lVW5pdFN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLmFib3V0T25lVW5pdFN0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBhYm91dE51bWJlclVuaXRzUGF0dGVyblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLmFib3V0TnVtYmVyVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IGFib3V0T25lSGFsZlVuaXRzU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcuYWJvdXRPbmVIYWxmVW5pdHNTdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgYWJvdXROdW1iZXJBbmRBSGFsZlVuaXRzUGF0dGVyblN0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLmFib3V0TnVtYmVyQW5kQUhhbGZVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eTtcclxuY29uc3QgYWJvdXROdW1iZXJRdWFydGVyVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHkgPSBRdWFkcmlsYXRlcmFsU3RyaW5ncy5hMTF5LnZvaWNpbmcuYWJvdXROdW1iZXJRdWFydGVyVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IGFib3V0RnVsbE51bWJlckFuZE51bWJlclF1YXJ0ZXJVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSA9IFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5hYm91dEZ1bGxOdW1iZXJBbmROdW1iZXJRdWFydGVyVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IG9uZUhhbGZVbml0c1N0cmluZ1Byb3BlcnR5ID0gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLm9uZUhhbGZVbml0c1N0cmluZ1Byb3BlcnR5O1xyXG5cclxuLy8gQSBtYXAgdGhhdCB3aWxsIHByb3ZpZGUgY29tcGFyaXNvbiBkZXNjcmlwdGlvbnMgZm9yIHNpZGUgbGVuZ3Rocy4gUmFuZ2UgdmFsdWVzIGFyZSB0aGUgcmF0aW8gYmV0d2VlbiBsZW5ndGhzXHJcbi8vIG9mIGRpZmZlcmVudCBzaWRlcy5cclxuY29uc3QgTEVOR1RIX0NPTVBBUklTT05fREVTQ1JJUFRJT05fTUFQID0gbmV3IE1hcDxSYW5nZSwgVFJlYWRPbmx5UHJvcGVydHk8c3RyaW5nPj4oKTtcclxuTEVOR1RIX0NPTVBBUklTT05fREVTQ1JJUFRJT05fTUFQLnNldCggbmV3IFJhbmdlKCAwLCAwLjEgKSwgZmFyU2hvcnRlclRoYW5TdHJpbmdQcm9wZXJ0eSApO1xyXG5MRU5HVEhfQ09NUEFSSVNPTl9ERVNDUklQVElPTl9NQVAuc2V0KCBuZXcgUmFuZ2UoIDAuMSwgMC40ICksIG11Y2hTaG9ydGVyVGhhblN0cmluZ1Byb3BlcnR5ICk7XHJcbkxFTkdUSF9DT01QQVJJU09OX0RFU0NSSVBUSU9OX01BUC5zZXQoIG5ldyBSYW5nZSggMC40LCAwLjYgKSwgYWJvdXRIYWxmQXNMb25nQXNTdHJpbmdQcm9wZXJ0eSApO1xyXG5MRU5HVEhfQ09NUEFSSVNPTl9ERVNDUklQVElPTl9NQVAuc2V0KCBuZXcgUmFuZ2UoIDAuNiwgMC44ICksIGFMaXR0bGVTaG9ydGVyVGhhblN0cmluZ1Byb3BlcnR5ICk7XHJcbkxFTkdUSF9DT01QQVJJU09OX0RFU0NSSVBUSU9OX01BUC5zZXQoIG5ldyBSYW5nZSggMC44LCAxICksIHNpbWlsYXJCdXRTaG9ydGVyVGhhblN0cmluZ1Byb3BlcnR5ICk7XHJcbkxFTkdUSF9DT01QQVJJU09OX0RFU0NSSVBUSU9OX01BUC5zZXQoIG5ldyBSYW5nZSggMSwgMS4zICksIHNpbWlsYXJCdXRMb25nZXJUaGFuU3RyaW5nUHJvcGVydHkgKTtcclxuTEVOR1RIX0NPTVBBUklTT05fREVTQ1JJUFRJT05fTUFQLnNldCggbmV3IFJhbmdlKCAxLjMsIDEuNiApLCBhTGl0dGxlTG9uZ2VyVGhhblN0cmluZ1Byb3BlcnR5ICk7XHJcbkxFTkdUSF9DT01QQVJJU09OX0RFU0NSSVBUSU9OX01BUC5zZXQoIG5ldyBSYW5nZSggMS42LCAxLjggKSwgbXVjaExvbmdlclRoYW5TdHJpbmdQcm9wZXJ0eSApO1xyXG5MRU5HVEhfQ09NUEFSSVNPTl9ERVNDUklQVElPTl9NQVAuc2V0KCBuZXcgUmFuZ2UoIDEuOCwgMi4yICksIGFib3V0VHdpY2VBc0xvbmdBc1N0cmluZ1Byb3BlcnR5ICk7XHJcbkxFTkdUSF9DT01QQVJJU09OX0RFU0NSSVBUSU9OX01BUC5zZXQoIG5ldyBSYW5nZSggMi4yLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgKSwgZmFyTG9uZ2VyVGhhblN0cmluZ1Byb3BlcnR5ICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBRdWFkcmlsYXRlcmFsU2lkZURlc2NyaWJlciB7XHJcbiAgcHVibGljIHJlYWRvbmx5IHNpZGU6IFF1YWRyaWxhdGVyYWxTaWRlO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWw6IFF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgbW9kZWxWaWV3VHJhbnNmb3JtOiBNb2RlbFZpZXdUcmFuc2Zvcm0yO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgbWFya2Vyc1Zpc2libGVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj47XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggc2lkZTogUXVhZHJpbGF0ZXJhbFNpZGUsIHF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsOiBRdWFkcmlsYXRlcmFsU2hhcGVNb2RlbCwgbWFya2Vyc1Zpc2libGVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj4sIG1vZGVsVmlld1RyYW5zZm9ybTogTW9kZWxWaWV3VHJhbnNmb3JtMiApIHtcclxuICAgIHRoaXMuc2lkZSA9IHNpZGU7XHJcbiAgICB0aGlzLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsID0gcXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWw7XHJcbiAgICB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybSA9IG1vZGVsVmlld1RyYW5zZm9ybTtcclxuICAgIHRoaXMubWFya2Vyc1Zpc2libGVQcm9wZXJ0eSA9IG1hcmtlcnNWaXNpYmxlUHJvcGVydHk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBPYmplY3QgcmVzcG9uc2UgZm9yIHRoZSBRdWFkcmlsYXRlcmFsU2lkZSBmb3IgVm9pY2luZy4gUmV0dXJucyBzb21ldGhpbmcgbGlrZVxyXG4gICAqXHJcbiAgICogXCJlcXVhbCB0byBvcHBvc2l0ZSBzaWRlLCBlcXVhbCB0byBhZGphY2VudCBzaWRlcy5cIiBvclxyXG4gICAqIFwicGFyYWxsZWwgYW5kIGEgbGl0dGxlIGxvbmdlciB0aGFuIG9wcG9zaXRlLCBzaG9ydGVyIHRoYW4gYWRqYWNlbnQgc2lkZXNcIlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRTaWRlT2JqZWN0UmVzcG9uc2UoKTogc3RyaW5nIHtcclxuICAgIGxldCByZXNwb25zZSA9ICcnO1xyXG4gICAgY29uc3Qgb3Bwb3NpdGVTaWRlID0gdGhpcy5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbC5vcHBvc2l0ZVNpZGVNYXAuZ2V0KCB0aGlzLnNpZGUgKSE7XHJcblxyXG4gICAgY29uc3QgcGFyYWxsZWxTaWRlUGFpcnMgPSB0aGlzLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLnBhcmFsbGVsU2lkZVBhaXJzUHJvcGVydHkudmFsdWU7XHJcbiAgICBjb25zdCB0aGlzU2lkZUlzUGFyYWxsZWwgPSBfLnNvbWUoIHBhcmFsbGVsU2lkZVBhaXJzLCBzaWRlUGFpciA9PiBzaWRlUGFpci5jb21wb25lbnQxID09PSB0aGlzLnNpZGUgfHwgc2lkZVBhaXIuY29tcG9uZW50MiA9PT0gdGhpcy5zaWRlICk7XHJcblxyXG4gICAgY29uc3QgdGhpc1NpZGVFcXVhbFRvT3Bwb3NpdGVTaWRlID0gdGhpcy5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbC5pc0ludGVyTGVuZ3RoRXF1YWxUb090aGVyKCBvcHBvc2l0ZVNpZGUubGVuZ3RoUHJvcGVydHkudmFsdWUsIHRoaXMuc2lkZS5sZW5ndGhQcm9wZXJ0eS52YWx1ZSApO1xyXG5cclxuICAgIC8vIFVuaXF1ZSBzdHJpbmcgcGF0dGVybnMgdG8gc3VwcG9ydCBtb3JlIG5hdHVyYWwgZW5nbGlzaCB3aGVuIG9wcG9zaXRlIHNpZGVzIGFyZSBib3RoIHBhcmFsbGVsIEFORCBlcXVhbCBpbiBsZW5ndGguXHJcbiAgICBjb25zdCBwYXR0ZXJuU3RyaW5nUHJvcGVydHkgPSB0aGlzU2lkZUlzUGFyYWxsZWwgJiYgdGhpc1NpZGVFcXVhbFRvT3Bwb3NpdGVTaWRlID8gcGFyYWxsZWxFcXVhbFNpZGVPYmplY3RSZXNwb25zZVBhdHRlcm5TdHJpbmdQcm9wZXJ0eSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzU2lkZUlzUGFyYWxsZWwgPyBwYXJhbGxlbFNpZGVPYmplY3RSZXNwb25zZVBhdHRlcm5TdHJpbmdQcm9wZXJ0eSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWRlT2JqZWN0UmVzcG9uc2VQYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcblxyXG4gICAgLy8gSWYgdGhlIHF1YWRyaWxhdGVyYWwgaXMgYSByaG9tYnVzIG9yIGEgc3F1YXJlLCBhbHdheXMgZGVzY3JpYmUgdGhhdCB0aGUgb3Bwb3NpdGUgc2lkZSBpcyBlcXVhbCBpbiBsZW5ndGggdG8gdGhlXHJcbiAgICAvLyBvdGhlci4gVGhpcyBtYXkgbm90IGhhcHBlbiBuYXR1cmFsbHkgYnkgY29tcGFyaW5nIHNpZGUgbGVuZ3RocyBiZWNhdXNlIGEgcmhvbWJ1cyBhbmQgc3F1YXJlIG1heSBiZSBkZXRlY3RlZFxyXG4gICAgLy8gd2hlbiBzaWRlcyBhcmUgbm90IHBlcmZlY3RseSBlcXVhbCBkdWUgdG8gdGhlIGFuZ2xlIHRvbGVyYW5jZSBpbnRlcnZhbC5cclxuICAgIGNvbnN0IHNoYXBlTmFtZSA9IHRoaXMucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwuc2hhcGVOYW1lUHJvcGVydHkudmFsdWU7XHJcbiAgICBjb25zdCBvcHBvc2l0ZUNvbXBhcmlzb24gPSBzaGFwZU5hbWUgPT09IE5hbWVkUXVhZHJpbGF0ZXJhbC5TUVVBUkUgfHwgc2hhcGVOYW1lID09PSBOYW1lZFF1YWRyaWxhdGVyYWwuUkhPTUJVUyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcXVhbFRvU3RyaW5nUHJvcGVydHkgOiB0aGlzLmdldExlbmd0aENvbXBhcmlzb25EZXNjcmlwdGlvbiggb3Bwb3NpdGVTaWRlICk7XHJcblxyXG4gICAgcmVzcG9uc2UgPSBTdHJpbmdVdGlscy5maWxsSW4oIHBhdHRlcm5TdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICBvcHBvc2l0ZUNvbXBhcmlzb246IG9wcG9zaXRlQ29tcGFyaXNvbixcclxuICAgICAgYWRqYWNlbnRTaWRlRGVzY3JpcHRpb246IHRoaXMuZ2V0QWRqYWNlbnRTaWRlRGVzY3JpcHRpb24oKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGlmICdtYXJrZXJzJyBhcmUgdmlzaWJsZSBkZXNjcmliZSB0aGUgc2lkZSBsZW5ndGggdW5pdHMgYnkgYXBwZW5kaW5nIHRoYXQgaW5mb3JtYXRpb24gdG8gdGhlIG9iamVjdCByZXNwb25zZVxyXG4gICAgaWYgKCB0aGlzLm1hcmtlcnNWaXNpYmxlUHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgIGNvbnN0IHVuaXRzRGVzY3JpcHRpb24gPSB0aGlzLmdldFNpZGVVbml0c0Rlc2NyaXB0aW9uKCk7XHJcbiAgICAgIHJlc3BvbnNlID0gU3RyaW5nVXRpbHMuZmlsbEluKCBzaWRlVW5pdHNPYmplY3RSZXNwb25zZVBhdHRlcm5TdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICAgIHVuaXRzRGVzY3JpcHRpb246IHVuaXRzRGVzY3JpcHRpb24sXHJcbiAgICAgICAgb2JqZWN0UmVzcG9uc2U6IHJlc3BvbnNlXHJcbiAgICAgIH0gKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIGEgZGVzY3JpcHRpb24gb2YgdGhlIG51bWJlciBvZiBsZW5ndGggdW5pdHMgZm9yIHRoaXMgc2lkZS4gUmV0dXJucyBzb21ldGhpbmcgbGlrZVxyXG4gICAqXHJcbiAgICogXCIxIHVuaXRcIiBvclxyXG4gICAqIFwianVzdCBvdmVyIDMgdW5pdHNcIiBvclxyXG4gICAqIFwiMiBhbmQgYSBoYWxmIHVuaXRzXCIgb3JcclxuICAgKiBcIjIgYW5kIGEgcXVhcnRlciB1bml0c1wiIG9yXHJcbiAgICogXCIyIGFuZCB0aHJlZS1xdWFydGVyIHVuaXRzXCIuXHJcbiAgICovXHJcbiAgcHVibGljIGdldFNpZGVVbml0c0Rlc2NyaXB0aW9uKCk6IE51bGxhYmxlUXVhZHJpbGF0ZXJhbFN0cmluZ1R5cGUge1xyXG4gICAgY29uc3Qgc2hhcGVNb2RlbCA9IHRoaXMucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWw7XHJcbiAgICBjb25zdCBzaWRlTGVuZ3RoID0gdGhpcy5zaWRlLmxlbmd0aFByb3BlcnR5LnZhbHVlO1xyXG5cclxuICAgIGNvbnN0IG51bWJlck9mRnVsbFVuaXRzID0gTWF0aC5mbG9vciggc2lkZUxlbmd0aCAvIFF1YWRyaWxhdGVyYWxTaWRlLlNJREVfU0VHTUVOVF9MRU5HVEggKTtcclxuICAgIGNvbnN0IHJlbWFpbmRlciA9IHNpZGVMZW5ndGggJSBRdWFkcmlsYXRlcmFsU2lkZS5TSURFX1NFR01FTlRfTEVOR1RIO1xyXG5cclxuICAgIGlmICggc2hhcGVNb2RlbC5pc0ludGVyTGVuZ3RoRXF1YWxUb090aGVyKCByZW1haW5kZXIsIDAgKSApIHtcclxuICAgICAgaWYgKCBudW1iZXJPZkZ1bGxVbml0cyA9PT0gMSApIHtcclxuXHJcbiAgICAgICAgLy8gXCJvbmUgdW5pdFwiXHJcbiAgICAgICAgcmV0dXJuIG9uZVVuaXRTdHJpbmdQcm9wZXJ0eTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgLy8gXCIzIHVuaXRzXCJcclxuICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuZmlsbEluKCBudW1iZXJPZlVuaXRzUGF0dGVyblN0cmluZ1Byb3BlcnR5LCB7XHJcbiAgICAgICAgICBudW1iZXJPZlVuaXRzOiBudW1iZXJPZkZ1bGxVbml0c1xyXG4gICAgICAgIH0gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIHNoYXBlTW9kZWwuaXNJbnRlckxlbmd0aEVxdWFsVG9PdGhlciggcmVtYWluZGVyLCBRdWFkcmlsYXRlcmFsU2lkZS5TSURFX1NFR01FTlRfTEVOR1RIIC8gMiApICkge1xyXG4gICAgICBpZiAoIG51bWJlck9mRnVsbFVuaXRzID09PSAwICkge1xyXG4gICAgICAgIHJldHVybiBvbmVIYWxmVW5pdHNTdHJpbmdQcm9wZXJ0eTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgLy8gdGhyZWUgYW5kIGEgaGFsZiB1bml0c1xyXG4gICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5maWxsSW4oIG51bWJlck9mVW5pdHNBbmRBSGFsZlBhdHRlcm5TdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICAgICAgbnVtYmVyT2ZVbml0czogbnVtYmVyT2ZGdWxsVW5pdHNcclxuICAgICAgICB9ICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBzaGFwZU1vZGVsLmlzSW50ZXJMZW5ndGhFcXVhbFRvT3RoZXIoIHJlbWFpbmRlciwgUXVhZHJpbGF0ZXJhbFNpZGUuU0lERV9TRUdNRU5UX0xFTkdUSCAvIDQgKSApIHtcclxuICAgICAgaWYgKCBudW1iZXJPZkZ1bGxVbml0cyA9PT0gMCApIHtcclxuXHJcbiAgICAgICAgLy8gXCJvbmUgcXVhcnRlciB1bml0c1wiXHJcbiAgICAgICAgcmV0dXJuIG9uZVF1YXJ0ZXJVbml0U3RyaW5nUHJvcGVydHk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgIC8vIDIgYW5kIHRocmVlLXF1YXJ0ZXIgdW5pdHNcclxuICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuZmlsbEluKCBudW1iZXJBbmRPbmVRdWFydGVyVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgICAgIGZ1bGxOdW1iZXI6IG51bWJlck9mRnVsbFVuaXRzXHJcbiAgICAgICAgfSApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggc2hhcGVNb2RlbC5pc0ludGVyTGVuZ3RoRXF1YWxUb090aGVyKCByZW1haW5kZXIsIDMgKiBRdWFkcmlsYXRlcmFsU2lkZS5TSURFX1NFR01FTlRfTEVOR1RIIC8gNCApICkge1xyXG4gICAgICBpZiAoIG51bWJlck9mRnVsbFVuaXRzID09PSAwICkge1xyXG5cclxuICAgICAgICAvLyBcIm9uZSBxdWFydGVyIHVuaXRzXCJcclxuICAgICAgICByZXR1cm4gdGhyZWVRdWFydGVyVW5pdHNTdHJpbmdQcm9wZXJ0eTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgLy8gMiBhbmQgdGhyZWUtcXVhcnRlciB1bml0c1xyXG4gICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5maWxsSW4oIG51bWJlckFuZFRocmVlUXVhcnRlclVuaXRzUGF0dGVyblN0cmluZ1Byb3BlcnR5LCB7XHJcbiAgICAgICAgICBmdWxsTnVtYmVyOiBudW1iZXJPZkZ1bGxVbml0c1xyXG4gICAgICAgIH0gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcblxyXG4gICAgICBjb25zdCBudW1iZXJPZlF1YXJ0ZXJVbml0cyA9IE1hdGguY2VpbCggKCBzaWRlTGVuZ3RoIC8gUXVhZHJpbGF0ZXJhbFNpZGUuU0lERV9TRUdNRU5UX0xFTkdUSCApICogNCApO1xyXG4gICAgICBjb25zdCBudW1iZXJPZkV4dHJhQ29ybmVyVW5pdHMgPSBudW1iZXJPZlF1YXJ0ZXJVbml0cyAlIDQ7XHJcbiAgICAgIGlmICggbnVtYmVyT2ZFeHRyYUNvcm5lclVuaXRzID09PSAwICkge1xyXG4gICAgICAgIGlmICggbnVtYmVyT2ZGdWxsVW5pdHMgPT09IDAgKSB7XHJcbiAgICAgICAgICByZXR1cm4gYWJvdXRPbmVVbml0U3RyaW5nUHJvcGVydHk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgLy8gYWJvdXQgMyB1bml0cyAoanVzdCB1bmRlciwgY3VycmVudGx5KVxyXG4gICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZpbGxJbiggYWJvdXROdW1iZXJVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICAgICAgICBudW1iZXI6IG51bWJlck9mRnVsbFVuaXRzICsgMVxyXG4gICAgICAgICAgfSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggbnVtYmVyT2ZFeHRyYUNvcm5lclVuaXRzID09PSAyICkge1xyXG4gICAgICAgIGlmICggbnVtYmVyT2ZGdWxsVW5pdHMgPT09IDAgKSB7XHJcbiAgICAgICAgICAvLyBhYm91dCBvbmUtaGFsZiB1bml0c1xyXG4gICAgICAgICAgcmV0dXJuIGFib3V0T25lSGFsZlVuaXRzU3RyaW5nUHJvcGVydHk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgLy8gYWJvdXQgMSBhbmQgYSBoYWxmIHVuaXRzXHJcbiAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuZmlsbEluKCBhYm91dE51bWJlckFuZEFIYWxmVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgICAgICAgbnVtYmVyOiBudW1iZXJPZkZ1bGxVbml0c1xyXG4gICAgICAgICAgfSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgaWYgKCBudW1iZXJPZkZ1bGxVbml0cyA9PT0gMCApIHtcclxuXHJcbiAgICAgICAgICAvLyBhYm91dCB0aHJlZS1xdWFydGVyIHVuaXRzXHJcbiAgICAgICAgICAvLyBhYm91dCBvbmUtcXVhcnRlciB1bml0c1xyXG4gICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZpbGxJbiggYWJvdXROdW1iZXJRdWFydGVyVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgICAgICAgbnVtYmVyOiBudW1iZXJPZkV4dHJhQ29ybmVyVW5pdHNcclxuICAgICAgICAgIH0gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgICAgLy8gYWJvdXQgMiBhbmQgb25lIHF1YXJ0ZXIgdW5pdHNcclxuICAgICAgICAgIC8vIGFib3V0IDMgYW5kIHRocmVlLXF1YXJ0ZXIgdW5pdHNcclxuICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5maWxsSW4oIGFib3V0RnVsbE51bWJlckFuZE51bWJlclF1YXJ0ZXJVbml0c1BhdHRlcm5TdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICAgICAgICBmdWxsTnVtYmVyOiBudW1iZXJPZkZ1bGxVbml0cyxcclxuICAgICAgICAgICAgbnVtYmVyOiBudW1iZXJPZkV4dHJhQ29ybmVyVW5pdHNcclxuICAgICAgICAgIH0gKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhIGRlc2NyaXB0aW9uIG9mIHRoZSBhZGphY2VudCBzaWRlcyBhbmQgaG93IHRoaXMgc2lkZSBjb21wYXJlcyB0byB0aGVtIGluIGxlbmd0aC4gQWxzbyBpbmNsdWRlcyBpbmZvcm1hdGlvblxyXG4gICAqIGFib3V0IHRoZW0gaWYgdGhleSBhcmUgcGFyYWxsZWwuIFVzZWQgZm9yIHRoZSBPYmplY3QgcmVzcG9uc2Ugb2YgdGhpcyB2ZXJ0ZXguIFdpbGwgcmV0dXJuIHNvbWV0aGluZyBsaWtlXHJcbiAgICpcclxuICAgKiBcIm11Y2ggc21hbGxlciB0aGFuIGFkamFjZW50IGVxdWFsIHNpZGVzXCIgb3JcclxuICAgKiBcImVxdWFsIHRvIGFkamFjZW50IHNpZGVzXCIgb3JcclxuICAgKiBcIm5vdCBlcXVhbCB0byBwYXJhbGxlbCBhZGphY2VudCBzaWRlc1wiXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRBZGphY2VudFNpZGVEZXNjcmlwdGlvbigpOiBOdWxsYWJsZVF1YWRyaWxhdGVyYWxTdHJpbmdUeXBlIHtcclxuICAgIGxldCBkZXNjcmlwdGlvbjogTnVsbGFibGVRdWFkcmlsYXRlcmFsU3RyaW5nVHlwZSA9IG51bGw7XHJcblxyXG4gICAgY29uc3QgYWRqYWNlbnRTaWRlcyA9IHRoaXMucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwuYWRqYWNlbnRTaWRlTWFwLmdldCggdGhpcy5zaWRlICkhO1xyXG4gICAgY29uc3QgYWRqYWNlbnRTaWRlc0VxdWFsID0gdGhpcy5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbC5pc0ludGVyTGVuZ3RoRXF1YWxUb090aGVyKFxyXG4gICAgICBhZGphY2VudFNpZGVzWyAwIF0ubGVuZ3RoUHJvcGVydHkudmFsdWUsXHJcbiAgICAgIGFkamFjZW50U2lkZXNbIDEgXS5sZW5ndGhQcm9wZXJ0eS52YWx1ZVxyXG4gICAgKTtcclxuXHJcbiAgICBsZXQgbnVtYmVyT2ZFcXVhbEFkamFjZW50U2lkZVBhaXJzID0gMDtcclxuICAgIGNvbnN0IGFkamFjZW50U2lkZVBhaXJzID0gdGhpcy5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbC5hZGphY2VudEVxdWFsU2lkZVBhaXJzUHJvcGVydHkudmFsdWU7XHJcbiAgICBhZGphY2VudFNpZGVQYWlycy5mb3JFYWNoKCBzaWRlUGFpciA9PiB7XHJcbiAgICAgIGlmICggc2lkZVBhaXIuY29tcG9uZW50MSA9PT0gdGhpcy5zaWRlIHx8IHNpZGVQYWlyLmNvbXBvbmVudDIgPT09IHRoaXMuc2lkZSApIHtcclxuICAgICAgICBudW1iZXJPZkVxdWFsQWRqYWNlbnRTaWRlUGFpcnMrKztcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHBhcmFsbGVsU2lkZUNoZWNrZXIgPSBfLmZpbmQoIHRoaXMucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwucGFyYWxsZWxTaWRlQ2hlY2tlcnMsIGNoZWNrZXIgPT4ge1xyXG4gICAgICByZXR1cm4gY2hlY2tlci5zaWRlUGFpci5jb21wb25lbnQxID09PSBhZGphY2VudFNpZGVzWyAwIF0gfHwgY2hlY2tlci5zaWRlUGFpci5jb21wb25lbnQxID09PSBhZGphY2VudFNpZGVzWyAxIF07XHJcbiAgICB9ICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBwYXJhbGxlbFNpZGVDaGVja2VyLCAnZGlkIG5vdCBmaW5kIFBhcmFsbGVsU2lkZUNoZWNrZXInICk7XHJcbiAgICBjb25zdCBhZGphY2VudFNpZGVzUGFyYWxsZWwgPSBwYXJhbGxlbFNpZGVDaGVja2VyIS5hcmVTaWRlc1BhcmFsbGVsKCk7XHJcblxyXG4gICAgaWYgKCBudW1iZXJPZkVxdWFsQWRqYWNlbnRTaWRlUGFpcnMgPT09IDIgKSB7XHJcblxyXG4gICAgICAvLyBUaGlzIHNpZGUgYW5kIGJvdGggYWRqYWNlbnQgc2lkZXMgYXJlIGFsbCBlcXVhbFxyXG4gICAgICBpZiAoIGFkamFjZW50U2lkZXNQYXJhbGxlbCApIHtcclxuICAgICAgICBkZXNjcmlwdGlvbiA9ICdlcXVhbCB0byBwYXJhbGxlbCBhZGphY2VudCBzaWRlcyc7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgZGVzY3JpcHRpb24gPSBlcXVhbFRvQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggbnVtYmVyT2ZFcXVhbEFkamFjZW50U2lkZVBhaXJzID09PSAxICkge1xyXG5cclxuICAgICAgLy8gSnVzdCBvbmUgJ2VxdWFsJyBzaWRlLCB0aGF0IGlzIGFsbCB3ZSBuZWVkIHRvIGRlc2NyaWJlXHJcbiAgICAgIGRlc2NyaXB0aW9uID0gZXF1YWxUb09uZUFkamFjZW50U2lkZVN0cmluZ1Byb3BlcnR5O1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIGFkamFjZW50U2lkZXNFcXVhbCApIHtcclxuXHJcbiAgICAgIGNvbnN0IHBhdHRlcm5TdHJpbmdQcm9wZXJ0eSA9IGFkamFjZW50U2lkZXNQYXJhbGxlbCA/IGVxdWFsQWRqYWNlbnRQYXJhbGxlbFNpZGVzUGF0dGVyblN0cmluZ1Byb3BlcnR5IDogZXF1YWxBZGphY2VudFNpZGVzUGF0dGVyblN0cmluZ1Byb3BlcnR5O1xyXG5cclxuICAgICAgLy8gdGhlIGFkamFjZW50IHNpZGVzIGFyZSBlcXVhbCBpbiBsZW5ndGggYnV0IG5vdCBlcXVhbCB0byB0aGlzIHNpZGUsIGRlc2NyaWJlIHRoZSBsZW5ndGggb2ZcclxuICAgICAgLy8gdGhpcyBzaWRlIHJlbGF0aXZlIHRvIHRoZSBvdGhlciBzaWRlcyBidXQgd2UgY2FuIHVzZSBlaXRoZXIgc2lkZSBzaW5jZSB0aGV5IGFyZSBlcXVhbCBpbiBsZW5ndGhcclxuICAgICAgZGVzY3JpcHRpb24gPSBTdHJpbmdVdGlscy5maWxsSW4oIHBhdHRlcm5TdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICAgIGNvbXBhcmlzb246IHRoaXMuZ2V0TGVuZ3RoQ29tcGFyaXNvbkRlc2NyaXB0aW9uKCBhZGphY2VudFNpZGVzWyAwIF0gKVxyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuXHJcbiAgICAgIC8vIE5vbmUgb2YgdGhpcyBzaWRlIG9yIGFkamFjZW50IHNpZGVzIGFyZSBlcXVhbC4gRGVzY3JpYmUgaG93IHRoaXMgc2lkZSBpcyBzaG9ydGVyIHRoYW4gYm90aCwgbG9uZ2VyXHJcbiAgICAgIC8vIHRoYW4gYm90aCwgb3Igc2ltcGx5IGVxdWFsIHRvIG5laXRoZXIuXHJcbiAgICAgIGNvbnN0IHNpZGVMZW5ndGggPSB0aGlzLnNpZGUubGVuZ3RoUHJvcGVydHkudmFsdWU7XHJcbiAgICAgIGNvbnN0IGZpcnN0QWRqYWNlbnRMZW5ndGggPSBhZGphY2VudFNpZGVzWyAwIF0ubGVuZ3RoUHJvcGVydHkudmFsdWU7XHJcbiAgICAgIGNvbnN0IHNlY29uZEFkamFjZW50TGVuZ3RoID0gYWRqYWNlbnRTaWRlc1sgMSBdLmxlbmd0aFByb3BlcnR5LnZhbHVlO1xyXG4gICAgICBpZiAoIGZpcnN0QWRqYWNlbnRMZW5ndGggPiBzaWRlTGVuZ3RoICYmIHNlY29uZEFkamFjZW50TGVuZ3RoID4gc2lkZUxlbmd0aCApIHtcclxuICAgICAgICBkZXNjcmlwdGlvbiA9IGFkamFjZW50U2lkZXNQYXJhbGxlbCA/IHNob3J0ZXJUaGFuUGFyYWxsZWxBZGphY2VudFNpZGVzU3RyaW5nUHJvcGVydHkgOiBzaG9ydGVyVGhhbkFkamFjZW50U2lkZXNTdHJpbmdQcm9wZXJ0eTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggZmlyc3RBZGphY2VudExlbmd0aCA8IHNpZGVMZW5ndGggJiYgc2Vjb25kQWRqYWNlbnRMZW5ndGggPCBzaWRlTGVuZ3RoICkge1xyXG4gICAgICAgIGRlc2NyaXB0aW9uID0gYWRqYWNlbnRTaWRlc1BhcmFsbGVsID8gbG9uZ2VyVGhhblBhcmFsbGVsQWRqYWNlbnRTaWRlc1N0cmluZ1Byb3BlcnR5IDogbG9uZ2VyVGhhbkFkamFjZW50U2lkZXNTdHJpbmdQcm9wZXJ0eTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBkZXNjcmlwdGlvbiA9IGFkamFjZW50U2lkZXNQYXJhbGxlbCA/IG5vdEVxdWFsVG9QYXJhbGxlbEFkamFjZW50U2lkZXNTdHJpbmdQcm9wZXJ0eSA6IG5vdEVxdWFsVG9BZGphY2VudFNpZGVzU3RyaW5nUHJvcGVydHk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZGVzY3JpcHRpb247XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIGEgZGVzY3JpcHRpb24gb2YgY29tcGFyaXNvbiBiZXR3ZWVuIHR3byBzaWRlcywgdXNpbmcgZW50cmllcyBvZiBMRU5HVEhfQ09NUEFSSVNPTl9ERVNDUklQVElPTl9NQVAuXHJcbiAgICogRGVzY3JpcHRpb24gY29tcGFyZXMgdGhpcyBzaWRlIHRvIG90aGVyU2lkZS4gRm9yIGV4YW1wbGUsIGlmIHRoaXMgc2lkZSAoU2lkZUFCKSBpcyBsb25nZXIgdGhhbiAoc2lkZUNEKSB0aGUgb3V0cHV0XHJcbiAgICogd2lsbCBiZSBzb21ldGhpbmcgbGlrZTpcclxuICAgKiBcIlNpZGVBQiBpcyBtdWNoIGxvbmdlciB0aGFuIHNpZGVDRC5cIlxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0TGVuZ3RoQ29tcGFyaXNvbkRlc2NyaXB0aW9uKCBvdGhlclNpZGU6IFF1YWRyaWxhdGVyYWxTaWRlICk6IE51bGxhYmxlUXVhZHJpbGF0ZXJhbFN0cmluZ1R5cGUge1xyXG5cclxuICAgIGNvbnN0IHNoYXBlTW9kZWwgPSB0aGlzLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsO1xyXG4gICAgY29uc3QgbGVuZ3RoMSA9IHRoaXMuc2lkZS5sZW5ndGhQcm9wZXJ0eS52YWx1ZTtcclxuICAgIGNvbnN0IGxlbmd0aDIgPSBvdGhlclNpZGUubGVuZ3RoUHJvcGVydHkudmFsdWU7XHJcblxyXG4gICAgaWYgKCBzaGFwZU1vZGVsLmlzSW50ZXJMZW5ndGhFcXVhbFRvT3RoZXIoIGxlbmd0aDEsIGxlbmd0aDIgKSApIHtcclxuICAgICAgcmV0dXJuIGVxdWFsVG9TdHJpbmdQcm9wZXJ0eTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBzaGFwZU1vZGVsLmlzSW50ZXJMZW5ndGhFcXVhbFRvT3RoZXIoIGxlbmd0aDEsIGxlbmd0aDIgKiAyICkgKSB7XHJcbiAgICAgIHJldHVybiB0d2ljZUFzTG9uZ0FzU3RyaW5nUHJvcGVydHk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggc2hhcGVNb2RlbC5pc0ludGVyTGVuZ3RoRXF1YWxUb090aGVyKCBsZW5ndGgxLCBsZW5ndGgyIC8gMiApICkge1xyXG4gICAgICByZXR1cm4gaGFsZkFzTG9uZ0FzU3RyaW5nUHJvcGVydHk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgbGV0IGRlc2NyaXB0aW9uOiBOdWxsYWJsZVF1YWRyaWxhdGVyYWxTdHJpbmdUeXBlID0gbnVsbDtcclxuICAgICAgY29uc3QgbGVuZ3RoUmF0aW8gPSBsZW5ndGgxIC8gbGVuZ3RoMjtcclxuICAgICAgTEVOR1RIX0NPTVBBUklTT05fREVTQ1JJUFRJT05fTUFQLmZvckVhY2goICggdmFsdWUsIGtleSApID0+IHtcclxuICAgICAgICBpZiAoIGtleS5jb250YWlucyggbGVuZ3RoUmF0aW8gKSApIHtcclxuICAgICAgICAgIGRlc2NyaXB0aW9uID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCBkZXNjcmlwdGlvbiwgJ05vIGRlc2NyaXB0aW9uIGZvdW5kIGZvciBsZW5ndGggcmF0aW8nICk7XHJcbiAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbnF1YWRyaWxhdGVyYWwucmVnaXN0ZXIoICdRdWFkcmlsYXRlcmFsU2lkZURlc2NyaWJlcicsIFF1YWRyaWxhdGVyYWxTaWRlRGVzY3JpYmVyICk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxhQUFhLE1BQU0sd0JBQXdCO0FBQ2xELE9BQU9DLGlCQUFpQixNQUFNLCtCQUErQjtBQUM3RCxPQUFPQyxLQUFLLE1BQU0sNkJBQTZCO0FBRS9DLE9BQU9DLFdBQVcsTUFBTSwrQ0FBK0M7QUFDdkUsT0FBT0Msb0JBQW9CLE1BQU0sK0JBQStCO0FBQ2hFLE9BQU9DLGtCQUFrQixNQUFNLGdDQUFnQztBQUsvRDtBQUNBLE1BQU1DLDRCQUE0QixHQUFHRixvQkFBb0IsQ0FBQ0cs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