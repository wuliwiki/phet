// Copyright 2022-2023, University of Colorado Boulder

/**
 * In this design, tracks are mapped to a shape name and a sub-set of tracks will play at one time. Geometric
 * properties of the quadrilateral build-up in "layers" until the user has a square. As more geometric properties are
 * found, the sounds get more complex. Square is the most complex as it has the highest number of geometric property
 * requirements.
 *
 * See https://github.com/phetsims/quadrilateral/issues/175#issuecomment-1201643077 for more information about this
 * design.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import quadrilateral from '../../../quadrilateral.js';
import TracksSoundView from './TracksSoundView.js';
import quadTrackLowAscendingFourNotes_mp3 from '../../../../sounds/quadTrackLowAscendingFourNotes_mp3.js';
import quadTrackHighDescendingPingRepeats_mp3 from '../../../../sounds/quadTrackHighDescendingPingRepeats_mp3.js';
import quadTrackHighBellsFallAndRise_mp3 from '../../../../sounds/quadTrackHighBellsFallAndRise_mp3.js';
import quadTrackLowPunctualBoops_mp3 from '../../../../sounds/quadTrackLowPunctualBoops_mp3.js';
import quadTrackBackgroundRhythmSimple_mp3 from '../../../../sounds/quadTrackBackgroundRhythmSimple_mp3.js';
import quadTrackBackgroundRhythmInverted_mp3 from '../../../../sounds/quadTrackBackgroundRhythmInverted_mp3.js';
import quadTrackLowDistortedTonalRhythm_mp3 from '../../../../sounds/quadTrackLowDistortedTonalRhythm_mp3.js';
import quadTrackHighBellsShortLoop_mp3 from '../../../../sounds/quadTrackHighBellsShortLoop_mp3.js';
import NamedQuadrilateral from '../../model/NamedQuadrilateral.js';
import QuadrilateralQueryParameters from '../../QuadrilateralQueryParameters.js';

// All the sounds played in this sound design.
const LAYER_TRACKS = [quadTrackBackgroundRhythmSimple_mp3, quadTrackBackgroundRhythmInverted_mp3, quadTrackLowAscendingFourNotes_mp3, quadTrackLowDistortedTonalRhythm_mp3, quadTrackHighDescendingPingRepeats_mp3, quadTrackHighBellsFallAndRise_mp3, quadTrackHighBellsShortLoop_mp3, quadTrackLowPunctualBoops_mp3];

// Each NamedQuadrilateral is assigned zero or more of the above tracks to play. Values of the map are indices of the
// sound files in the above array that should play for each NamedQuadrilateral, according to the design in
// https://github.com/phetsims/quadrilateral/issues/175.
//
// Some teachers may prefer to include trapezoid shape properties for child shapes of the trapezoid. See
// https://github.com/phetsims/quadrilateral/issues/420
const NAMED_QUADRILATERAL_TO_TRACKS_MAP = QuadrilateralQueryParameters.inheritTrapezoidSound ? new Map([
// design with trapezoid sound in the relevant child shapes
[NamedQuadrilateral.CONVEX_QUADRILATERAL, [0]], [NamedQuadrilateral.CONCAVE_QUADRILATERAL, [1]], [NamedQuadrilateral.TRIANGLE, []], [NamedQuadrilateral.DART, [1, 2]], [NamedQuadrilateral.KITE, [0, 2]], [NamedQuadrilateral.TRAPEZOID, [0, 4]], [NamedQuadrilateral.ISOSCELES_TRAPEZOID, [0, 4, 3]], [NamedQuadrilateral.PARALLELOGRAM, [0, 4, 5]], [NamedQuadrilateral.RHOMBUS, [0, 2, 4, 5, 6]], [NamedQuadrilateral.RECTANGLE, [0, 3, 4, 5, 7]], [NamedQuadrilateral.SQUARE, [0, 2, 3, 4, 5, 6, 7]]]) : new Map([
// default sound design
[NamedQuadrilateral.CONVEX_QUADRILATERAL, [0]], [NamedQuadrilateral.CONCAVE_QUADRILATERAL, [1]], [NamedQuadrilateral.TRIANGLE, []], [NamedQuadrilateral.DART, [1, 2]], [NamedQuadrilateral.KITE, [0, 2]], [NamedQuadrilateral.TRAPEZOID, [0, 4]], [NamedQuadrilateral.ISOSCELES_TRAPEZOID, [0, 4, 3]], [NamedQuadrilateral.PARALLELOGRAM, [0, 5]], [NamedQuadrilateral.RHOMBUS, [0, 2, 5, 6]], [NamedQuadrilateral.RECTANGLE, [0, 5, 7]], [NamedQuadrilateral.SQUARE, [0, 2, 5, 6, 7]]]);
export default class LayersTracksSoundView extends TracksSoundView {
  constructor(shapeModel, shapeSoundEnabledProperty, resetNotInProgressProperty, soundOptionsModel) {
    super(shapeModel, shapeSoundEnabledProperty, resetNotInProgressProperty, soundOptionsModel, LAYER_TRACKS);

    // desired output levels for each sound (as requested by design, after manually editing the gain)
    // See https://github.com/phetsims/quadrilateral/issues/175#issuecomment-1339626942
    this.indexToOutputLevelMap.set(0, 0.6);
    this.indexToOutputLevelMap.set(1, 0.6);
    this.indexToOutputLevelMap.set(2, 1);
    this.indexToOutputLevelMap.set(3, 0.75);
    this.indexToOutputLevelMap.set(4, 0.55);
    this.indexToOutputLevelMap.set(5, 1);
    this.indexToOutputLevelMap.set(6, 0.45);
    this.indexToOutputLevelMap.set(7, 0.70);
    const shapeNameListener = shapeName => {
      // First set all output levels back to 0 before we start playing new sounds
      this.soundClips.forEach(soundClip => {
        soundClip.setOutputLevel(0);
      });
      const soundIndicesToPlay = NAMED_QUADRILATERAL_TO_TRACKS_MAP.get(shapeName);
      assert && assert(soundIndicesToPlay, 'NamedQuadrilateral does not have a LayersTracksSoundView design');
      soundIndicesToPlay.forEach(index => {
        this.soundClips[index].setOutputLevel(this.indexToOutputLevelMap.get(index));
      });
    };
    shapeModel.shapeNameProperty.link(shapeNameListener);
    this.disposeLayersTracksSoundView = () => shapeModel.shapeNameProperty.unlink(shapeNameListener);
  }
  dispose() {
    this.disposeLayersTracksSoundView();
    super.dispose();
  }
}
quadrilateral.register('LayersTracksSoundView', LayersTracksSoundView);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJxdWFkcmlsYXRlcmFsIiwiVHJhY2tzU291bmRWaWV3IiwicXVhZFRyYWNrTG93QXNjZW5kaW5nRm91ck5vdGVzX21wMyIsInF1YWRUcmFja0hpZ2hEZXNjZW5kaW5nUGluZ1JlcGVhdHNfbXAzIiwicXVhZFRyYWNrSGlnaEJlbGxzRmFsbEFuZFJpc2VfbXAzIiwicXVhZFRyYWNrTG93UHVuY3R1YWxCb29wc19tcDMiLCJxdWFkVHJhY2tCYWNrZ3JvdW5kUmh5dGhtU2ltcGxlX21wMyIsInF1YWRUcmFja0JhY2tncm91bmRSaHl0aG1JbnZlcnRlZF9tcDMiLCJxdWFkVHJhY2tMb3dEaXN0b3J0ZWRUb25hbFJoeXRobV9tcDMiLCJxdWFkVHJhY2tIaWdoQmVsbHNTaG9ydExvb3BfbXAzIiwiTmFtZWRRdWFkcmlsYXRlcmFsIiwiUXVhZHJpbGF0ZXJhbFF1ZXJ5UGFyYW1ldGVycyIsIkxBWUVSX1RSQUNLUyIsIk5BTUVEX1FVQURSSUxBVEVSQUxfVE9fVFJBQ0tTX01BUCIsImluaGVyaXRUcmFwZXpvaWRTb3VuZCIsIk1hcCIsIkNPTlZFWF9RVUFEUklMQVRFUkFMIiwiQ09OQ0FWRV9RVUFEUklMQVRFUkFMIiwiVFJJQU5HTEUiLCJEQVJUIiwiS0lURSIsIlRSQVBFWk9JRCIsIklTT1NDRUxFU19UUkFQRVpPSUQiLCJQQVJBTExFTE9HUkFNIiwiUkhPTUJVUyIsIlJFQ1RBTkdMRSIsIlNRVUFSRSIsIkxheWVyc1RyYWNrc1NvdW5kVmlldyIsImNvbnN0cnVjdG9yIiwic2hhcGVNb2RlbCIsInNoYXBlU291bmRFbmFibGVkUHJvcGVydHkiLCJyZXNldE5vdEluUHJvZ3Jlc3NQcm9wZXJ0eSIsInNvdW5kT3B0aW9uc01vZGVsIiwiaW5kZXhUb091dHB1dExldmVsTWFwIiwic2V0Iiwic2hhcGVOYW1lTGlzdGVuZXIiLCJzaGFwZU5hbWUiLCJzb3VuZENsaXBzIiwiZm9yRWFjaCIsInNvdW5kQ2xpcCIsInNldE91dHB1dExldmVsIiwic291bmRJbmRpY2VzVG9QbGF5IiwiZ2V0IiwiYXNzZXJ0IiwiaW5kZXgiLCJzaGFwZU5hbWVQcm9wZXJ0eSIsImxpbmsiLCJkaXNwb3NlTGF5ZXJzVHJhY2tzU291bmRWaWV3IiwidW5saW5rIiwiZGlzcG9zZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiTGF5ZXJzVHJhY2tzU291bmRWaWV3LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIyLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEluIHRoaXMgZGVzaWduLCB0cmFja3MgYXJlIG1hcHBlZCB0byBhIHNoYXBlIG5hbWUgYW5kIGEgc3ViLXNldCBvZiB0cmFja3Mgd2lsbCBwbGF5IGF0IG9uZSB0aW1lLiBHZW9tZXRyaWNcclxuICogcHJvcGVydGllcyBvZiB0aGUgcXVhZHJpbGF0ZXJhbCBidWlsZC11cCBpbiBcImxheWVyc1wiIHVudGlsIHRoZSB1c2VyIGhhcyBhIHNxdWFyZS4gQXMgbW9yZSBnZW9tZXRyaWMgcHJvcGVydGllcyBhcmVcclxuICogZm91bmQsIHRoZSBzb3VuZHMgZ2V0IG1vcmUgY29tcGxleC4gU3F1YXJlIGlzIHRoZSBtb3N0IGNvbXBsZXggYXMgaXQgaGFzIHRoZSBoaWdoZXN0IG51bWJlciBvZiBnZW9tZXRyaWMgcHJvcGVydHlcclxuICogcmVxdWlyZW1lbnRzLlxyXG4gKlxyXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3F1YWRyaWxhdGVyYWwvaXNzdWVzLzE3NSNpc3N1ZWNvbW1lbnQtMTIwMTY0MzA3NyBmb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGlzXHJcbiAqIGRlc2lnbi5cclxuICpcclxuICogQGF1dGhvciBKZXNzZSBHcmVlbmJlcmcgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IHF1YWRyaWxhdGVyYWwgZnJvbSAnLi4vLi4vLi4vcXVhZHJpbGF0ZXJhbC5qcyc7XHJcbmltcG9ydCBUcmFja3NTb3VuZFZpZXcgZnJvbSAnLi9UcmFja3NTb3VuZFZpZXcuanMnO1xyXG5pbXBvcnQgcXVhZFRyYWNrTG93QXNjZW5kaW5nRm91ck5vdGVzX21wMyBmcm9tICcuLi8uLi8uLi8uLi9zb3VuZHMvcXVhZFRyYWNrTG93QXNjZW5kaW5nRm91ck5vdGVzX21wMy5qcyc7XHJcbmltcG9ydCBxdWFkVHJhY2tIaWdoRGVzY2VuZGluZ1BpbmdSZXBlYXRzX21wMyBmcm9tICcuLi8uLi8uLi8uLi9zb3VuZHMvcXVhZFRyYWNrSGlnaERlc2NlbmRpbmdQaW5nUmVwZWF0c19tcDMuanMnO1xyXG5pbXBvcnQgcXVhZFRyYWNrSGlnaEJlbGxzRmFsbEFuZFJpc2VfbXAzIGZyb20gJy4uLy4uLy4uLy4uL3NvdW5kcy9xdWFkVHJhY2tIaWdoQmVsbHNGYWxsQW5kUmlzZV9tcDMuanMnO1xyXG5pbXBvcnQgcXVhZFRyYWNrTG93UHVuY3R1YWxCb29wc19tcDMgZnJvbSAnLi4vLi4vLi4vLi4vc291bmRzL3F1YWRUcmFja0xvd1B1bmN0dWFsQm9vcHNfbXAzLmpzJztcclxuaW1wb3J0IHF1YWRUcmFja0JhY2tncm91bmRSaHl0aG1TaW1wbGVfbXAzIGZyb20gJy4uLy4uLy4uLy4uL3NvdW5kcy9xdWFkVHJhY2tCYWNrZ3JvdW5kUmh5dGhtU2ltcGxlX21wMy5qcyc7XHJcbmltcG9ydCBxdWFkVHJhY2tCYWNrZ3JvdW5kUmh5dGhtSW52ZXJ0ZWRfbXAzIGZyb20gJy4uLy4uLy4uLy4uL3NvdW5kcy9xdWFkVHJhY2tCYWNrZ3JvdW5kUmh5dGhtSW52ZXJ0ZWRfbXAzLmpzJztcclxuaW1wb3J0IHF1YWRUcmFja0xvd0Rpc3RvcnRlZFRvbmFsUmh5dGhtX21wMyBmcm9tICcuLi8uLi8uLi8uLi9zb3VuZHMvcXVhZFRyYWNrTG93RGlzdG9ydGVkVG9uYWxSaHl0aG1fbXAzLmpzJztcclxuaW1wb3J0IHF1YWRUcmFja0hpZ2hCZWxsc1Nob3J0TG9vcF9tcDMgZnJvbSAnLi4vLi4vLi4vLi4vc291bmRzL3F1YWRUcmFja0hpZ2hCZWxsc1Nob3J0TG9vcF9tcDMuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwgZnJvbSAnLi4vLi4vbW9kZWwvUXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBOYW1lZFF1YWRyaWxhdGVyYWwgZnJvbSAnLi4vLi4vbW9kZWwvTmFtZWRRdWFkcmlsYXRlcmFsLmpzJztcclxuaW1wb3J0IFF1YWRyaWxhdGVyYWxTb3VuZE9wdGlvbnNNb2RlbCBmcm9tICcuLi8uLi9tb2RlbC9RdWFkcmlsYXRlcmFsU291bmRPcHRpb25zTW9kZWwuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbFF1ZXJ5UGFyYW1ldGVycyBmcm9tICcuLi8uLi9RdWFkcmlsYXRlcmFsUXVlcnlQYXJhbWV0ZXJzLmpzJztcclxuXHJcbi8vIEFsbCB0aGUgc291bmRzIHBsYXllZCBpbiB0aGlzIHNvdW5kIGRlc2lnbi5cclxuY29uc3QgTEFZRVJfVFJBQ0tTID0gW1xyXG4gIHF1YWRUcmFja0JhY2tncm91bmRSaHl0aG1TaW1wbGVfbXAzLFxyXG4gIHF1YWRUcmFja0JhY2tncm91bmRSaHl0aG1JbnZlcnRlZF9tcDMsXHJcbiAgcXVhZFRyYWNrTG93QXNjZW5kaW5nRm91ck5vdGVzX21wMyxcclxuICBxdWFkVHJhY2tMb3dEaXN0b3J0ZWRUb25hbFJoeXRobV9tcDMsXHJcbiAgcXVhZFRyYWNrSGlnaERlc2NlbmRpbmdQaW5nUmVwZWF0c19tcDMsXHJcbiAgcXVhZFRyYWNrSGlnaEJlbGxzRmFsbEFuZFJpc2VfbXAzLFxyXG4gIHF1YWRUcmFja0hpZ2hCZWxsc1Nob3J0TG9vcF9tcDMsXHJcbiAgcXVhZFRyYWNrTG93UHVuY3R1YWxCb29wc19tcDNcclxuXTtcclxuXHJcbi8vIEVhY2ggTmFtZWRRdWFkcmlsYXRlcmFsIGlzIGFzc2lnbmVkIHplcm8gb3IgbW9yZSBvZiB0aGUgYWJvdmUgdHJhY2tzIHRvIHBsYXkuIFZhbHVlcyBvZiB0aGUgbWFwIGFyZSBpbmRpY2VzIG9mIHRoZVxyXG4vLyBzb3VuZCBmaWxlcyBpbiB0aGUgYWJvdmUgYXJyYXkgdGhhdCBzaG91bGQgcGxheSBmb3IgZWFjaCBOYW1lZFF1YWRyaWxhdGVyYWwsIGFjY29yZGluZyB0byB0aGUgZGVzaWduIGluXHJcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9xdWFkcmlsYXRlcmFsL2lzc3Vlcy8xNzUuXHJcbi8vXHJcbi8vIFNvbWUgdGVhY2hlcnMgbWF5IHByZWZlciB0byBpbmNsdWRlIHRyYXBlem9pZCBzaGFwZSBwcm9wZXJ0aWVzIGZvciBjaGlsZCBzaGFwZXMgb2YgdGhlIHRyYXBlem9pZC4gU2VlXHJcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9xdWFkcmlsYXRlcmFsL2lzc3Vlcy80MjBcclxuY29uc3QgTkFNRURfUVVBRFJJTEFURVJBTF9UT19UUkFDS1NfTUFQID0gUXVhZHJpbGF0ZXJhbFF1ZXJ5UGFyYW1ldGVycy5pbmhlcml0VHJhcGV6b2lkU291bmQgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTWFwKCBbIC8vIGRlc2lnbiB3aXRoIHRyYXBlem9pZCBzb3VuZCBpbiB0aGUgcmVsZXZhbnQgY2hpbGQgc2hhcGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuQ09OVkVYX1FVQURSSUxBVEVSQUwsIFsgMCBdIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuQ09OQ0FWRV9RVUFEUklMQVRFUkFMLCBbIDEgXSBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgTmFtZWRRdWFkcmlsYXRlcmFsLlRSSUFOR0xFLCBbXSBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgTmFtZWRRdWFkcmlsYXRlcmFsLkRBUlQsIFsgMSwgMiBdIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuS0lURSwgWyAwLCAyIF0gXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIE5hbWVkUXVhZHJpbGF0ZXJhbC5UUkFQRVpPSUQsIFsgMCwgNCBdIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuSVNPU0NFTEVTX1RSQVBFWk9JRCwgWyAwLCA0LCAzIF0gXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIE5hbWVkUXVhZHJpbGF0ZXJhbC5QQVJBTExFTE9HUkFNLCBbIDAsIDQsIDUgXSBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgTmFtZWRRdWFkcmlsYXRlcmFsLlJIT01CVVMsIFsgMCwgMiwgNCwgNSwgNiBdIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuUkVDVEFOR0xFLCBbIDAsIDMsIDQsIDUsIDcgXSBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgTmFtZWRRdWFkcmlsYXRlcmFsLlNRVUFSRSwgWyAwLCAyLCAzLCA0LCA1LCA2LCA3IF0gXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdICkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTWFwKCBbIC8vIGRlZmF1bHQgc291bmQgZGVzaWduXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuQ09OVkVYX1FVQURSSUxBVEVSQUwsIFsgMCBdIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuQ09OQ0FWRV9RVUFEUklMQVRFUkFMLCBbIDEgXSBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgTmFtZWRRdWFkcmlsYXRlcmFsLlRSSUFOR0xFLCBbXSBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgTmFtZWRRdWFkcmlsYXRlcmFsLkRBUlQsIFsgMSwgMiBdIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuS0lURSwgWyAwLCAyIF0gXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIE5hbWVkUXVhZHJpbGF0ZXJhbC5UUkFQRVpPSUQsIFsgMCwgNCBdIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuSVNPU0NFTEVTX1RSQVBFWk9JRCwgWyAwLCA0LCAzIF0gXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIE5hbWVkUXVhZHJpbGF0ZXJhbC5QQVJBTExFTE9HUkFNLCBbIDAsIDUgXSBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgTmFtZWRRdWFkcmlsYXRlcmFsLlJIT01CVVMsIFsgMCwgMiwgNSwgNiBdIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyBOYW1lZFF1YWRyaWxhdGVyYWwuUkVDVEFOR0xFLCBbIDAsIDUsIDcgXSBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsgTmFtZWRRdWFkcmlsYXRlcmFsLlNRVUFSRSwgWyAwLCAyLCA1LCA2LCA3IF0gXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMYXllcnNUcmFja3NTb3VuZFZpZXcgZXh0ZW5kcyBUcmFja3NTb3VuZFZpZXcge1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZUxheWVyc1RyYWNrc1NvdW5kVmlldzogKCkgPT4gdm9pZDtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBzaGFwZU1vZGVsOiBRdWFkcmlsYXRlcmFsU2hhcGVNb2RlbCwgc2hhcGVTb3VuZEVuYWJsZWRQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj4sIHJlc2V0Tm90SW5Qcm9ncmVzc1Byb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPiwgc291bmRPcHRpb25zTW9kZWw6IFF1YWRyaWxhdGVyYWxTb3VuZE9wdGlvbnNNb2RlbCApIHtcclxuICAgIHN1cGVyKCBzaGFwZU1vZGVsLCBzaGFwZVNvdW5kRW5hYmxlZFByb3BlcnR5LCByZXNldE5vdEluUHJvZ3Jlc3NQcm9wZXJ0eSwgc291bmRPcHRpb25zTW9kZWwsIExBWUVSX1RSQUNLUyApO1xyXG5cclxuICAgIC8vIGRlc2lyZWQgb3V0cHV0IGxldmVscyBmb3IgZWFjaCBzb3VuZCAoYXMgcmVxdWVzdGVkIGJ5IGRlc2lnbiwgYWZ0ZXIgbWFudWFsbHkgZWRpdGluZyB0aGUgZ2FpbilcclxuICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvcXVhZHJpbGF0ZXJhbC9pc3N1ZXMvMTc1I2lzc3VlY29tbWVudC0xMzM5NjI2OTQyXHJcbiAgICB0aGlzLmluZGV4VG9PdXRwdXRMZXZlbE1hcC5zZXQoIDAsIDAuNiApO1xyXG4gICAgdGhpcy5pbmRleFRvT3V0cHV0TGV2ZWxNYXAuc2V0KCAxLCAwLjYgKTtcclxuICAgIHRoaXMuaW5kZXhUb091dHB1dExldmVsTWFwLnNldCggMiwgMSApO1xyXG4gICAgdGhpcy5pbmRleFRvT3V0cHV0TGV2ZWxNYXAuc2V0KCAzLCAwLjc1ICk7XHJcbiAgICB0aGlzLmluZGV4VG9PdXRwdXRMZXZlbE1hcC5zZXQoIDQsIDAuNTUgKTtcclxuICAgIHRoaXMuaW5kZXhUb091dHB1dExldmVsTWFwLnNldCggNSwgMSApO1xyXG4gICAgdGhpcy5pbmRleFRvT3V0cHV0TGV2ZWxNYXAuc2V0KCA2LCAwLjQ1ICk7XHJcbiAgICB0aGlzLmluZGV4VG9PdXRwdXRMZXZlbE1hcC5zZXQoIDcsIDAuNzAgKTtcclxuXHJcbiAgICBjb25zdCBzaGFwZU5hbWVMaXN0ZW5lciA9ICggc2hhcGVOYW1lOiBOYW1lZFF1YWRyaWxhdGVyYWwgKSA9PiB7XHJcblxyXG4gICAgICAvLyBGaXJzdCBzZXQgYWxsIG91dHB1dCBsZXZlbHMgYmFjayB0byAwIGJlZm9yZSB3ZSBzdGFydCBwbGF5aW5nIG5ldyBzb3VuZHNcclxuICAgICAgdGhpcy5zb3VuZENsaXBzLmZvckVhY2goIHNvdW5kQ2xpcCA9PiB7XHJcbiAgICAgICAgc291bmRDbGlwLnNldE91dHB1dExldmVsKCAwICk7XHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAgIGNvbnN0IHNvdW5kSW5kaWNlc1RvUGxheSA9IE5BTUVEX1FVQURSSUxBVEVSQUxfVE9fVFJBQ0tTX01BUC5nZXQoIHNoYXBlTmFtZSApO1xyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCBzb3VuZEluZGljZXNUb1BsYXksICdOYW1lZFF1YWRyaWxhdGVyYWwgZG9lcyBub3QgaGF2ZSBhIExheWVyc1RyYWNrc1NvdW5kVmlldyBkZXNpZ24nICk7XHJcbiAgICAgIHNvdW5kSW5kaWNlc1RvUGxheSEuZm9yRWFjaCggaW5kZXggPT4ge1xyXG4gICAgICAgIHRoaXMuc291bmRDbGlwc1sgaW5kZXggXS5zZXRPdXRwdXRMZXZlbCggdGhpcy5pbmRleFRvT3V0cHV0TGV2ZWxNYXAuZ2V0KCBpbmRleCApISApO1xyXG4gICAgICB9ICk7XHJcbiAgICB9O1xyXG4gICAgc2hhcGVNb2RlbC5zaGFwZU5hbWVQcm9wZXJ0eS5saW5rKCBzaGFwZU5hbWVMaXN0ZW5lciApO1xyXG5cclxuICAgIHRoaXMuZGlzcG9zZUxheWVyc1RyYWNrc1NvdW5kVmlldyA9ICgpID0+IHNoYXBlTW9kZWwuc2hhcGVOYW1lUHJvcGVydHkudW5saW5rKCBzaGFwZU5hbWVMaXN0ZW5lciApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VMYXllcnNUcmFja3NTb3VuZFZpZXcoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbnF1YWRyaWxhdGVyYWwucmVnaXN0ZXIoICdMYXllcnNUcmFja3NTb3VuZFZpZXcnLCBMYXllcnNUcmFja3NTb3VuZFZpZXcgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsYUFBYSxNQUFNLDJCQUEyQjtBQUNyRCxPQUFPQyxlQUFlLE1BQU0sc0JBQXNCO0FBQ2xELE9BQU9DLGtDQUFrQyxNQUFNLDBEQUEwRDtBQUN6RyxPQUFPQyxzQ0FBc0MsTUFBTSw4REFBOEQ7QUFDakgsT0FBT0MsaUNBQWlDLE1BQU0seURBQXlEO0FBQ3ZHLE9BQU9DLDZCQUE2QixNQUFNLHFEQUFxRDtBQUMvRixPQUFPQyxtQ0FBbUMsTUFBTSwyREFBMkQ7QUFDM0csT0FBT0MscUNBQXFDLE1BQU0sNkRBQTZEO0FBQy9HLE9BQU9DLG9DQUFvQyxNQUFNLDREQUE0RDtBQUM3RyxPQUFPQywrQkFBK0IsTUFBTSx1REFBdUQ7QUFHbkcsT0FBT0Msa0JB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