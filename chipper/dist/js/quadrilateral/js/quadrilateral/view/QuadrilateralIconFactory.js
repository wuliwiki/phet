// Copyright 2022-2023, University of Colorado Boulder

/**
 * Icons for the simulation.
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import { Circle, HBox, Line, Node, Path, Text } from '../../../../scenery/js/imports.js';
import Utils from '../../../../dot/js/Utils.js';
import GridIcon from '../../../../scenery-phet/js/GridIcon.js';
import quadrilateral from '../../quadrilateral.js';
import QuadrilateralConstants from '../../QuadrilateralConstants.js';
import QuadrilateralColors from '../../QuadrilateralColors.js';
import { Line as ShapeLine, Shape } from '../../../../kite/js/imports.js';
import musicSolidShape from '../../../../sherpa/js/fontawesome-5/musicSolidShape.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import Ray2 from '../../../../dot/js/Ray2.js';
import Matrix3 from '../../../../dot/js/Matrix3.js';
import { combineOptions } from '../../../../phet-core/js/optionize.js';
class QuadrilateralIconFactory {
  // layout constants for all icons
  static ICON_HEIGHT = 30;
  static ICON_LINE_WIDTH = 1.5;

  /**
   * Creates an icon for the "Corner Labels" checkbox that toggles visibility of labels on each QuadrilateralVertex.
   */
  static createCornerLabelsIcon() {
    const circle = new Circle(QuadrilateralIconFactory.ICON_HEIGHT / 2, {
      stroke: QuadrilateralColors.visibilityIconsColorProperty,
      lineWidth: QuadrilateralIconFactory.ICON_LINE_WIDTH
    });
    const label = new Text('A', {
      ...QuadrilateralConstants.SCREEN_TEXT_OPTIONS,
      center: circle.center
    });
    circle.addChild(label);
    return circle;
  }

  /**
   * Create an icon for the "Markers" checkbox that toggles visual indicators of the angle at each vertex.
   */
  static createMarkersIcon() {
    const pathOptions = {
      stroke: QuadrilateralColors.visibilityIconsColorProperty,
      lineWidth: QuadrilateralIconFactory.ICON_LINE_WIDTH
    };

    // parameters for drawing the icon
    const sidesAngle = Utils.toRadians(110); // overall angle for the icon
    const sidesLength = QuadrilateralIconFactory.ICON_HEIGHT;
    const sidesHeight = QuadrilateralIconFactory.ICON_HEIGHT * 0.25; // chosen by inspection
    const wedgeAngle = Math.PI / 6; // size of each wedge graphic
    const tickLength = sidesHeight / 2;
    const innerIconRadius = sidesLength * 0.4; // radius of the inner-most arc and for the inner curve of angle wedges
    const outerIconRadius = sidesLength * 0.8; // radius of the outer-most arc and for the outer curve of angle wedges

    assert && assert(outerIconRadius > innerIconRadius, 'Arc radii do not make sense');
    assert && assert(tickLength < sidesHeight, 'ticks will be too tall');
    assert && assert(wedgeAngle < 2 * Math.PI, 'that angle does not make sense for this icon');
    assert && assert(sidesLength > sidesHeight, 'Sides must be longer than they are tall for this icon');

    // draw the "sides"
    const sidesShape = new Shape();

    // all drawing is relative to this origin
    const origin = new Vector2(0, 0);

    // bottom right of the horizontal side
    const bottomRightPoint = new Vector2(sidesLength, sidesHeight);

    // angle used to calculate new points perpendicular to others
    const strokeLeftAngle = Math.PI / 2;

    // the top right point of the vertical side
    const leftSideTopPoint = new Vector2(Math.cos(-sidesAngle) * sidesLength, Math.sin(-sidesAngle) * sidesLength);

    // the top left point of the vertical side
    const strokedLeftSidePoint = leftSideTopPoint.plusXY(Math.cos(sidesAngle + strokeLeftAngle) * sidesHeight, -Math.sin(sidesAngle + strokeLeftAngle) * sidesHeight);

    // the hardest part...we need to find the bottom point where the two outer lines of both sides intersect - we do
    // this by creating a line/ray pair that runs along the outer lines and using Kite to find the intersection point
    const bottomRay = new Ray2(bottomRightPoint, new Vector2(-1, 0));
    const leftSideLine = new ShapeLine(strokedLeftSidePoint,
    // Line rotated back around to the origin, then with extra length to find the intersection point
    strokedLeftSidePoint.plusXY(Math.cos(sidesAngle + 2 * strokeLeftAngle) * sidesLength * 2, -Math.sin(sidesAngle + 2 * strokeLeftAngle) * sidesLength * 2));
    const intersections = leftSideLine.intersection(bottomRay);
    assert && assert(intersections.length === 1, 'Needs to be one and only one intersection point');
    const bottomSideConnectionPoint = intersections[0].point;

    // Now that we have all points, draw the sides
    sidesShape.moveToPoint(origin);
    sidesShape.lineTo(sidesLength, 0);
    sidesShape.lineTo(sidesLength, sidesHeight);
    sidesShape.lineToPoint(bottomSideConnectionPoint);

    // the outline of the vertical side
    sidesShape.lineToPoint(strokedLeftSidePoint);
    sidesShape.lineToPoint(leftSideTopPoint);

    // close back to the origin
    sidesShape.close();
    const sidesPath = new Path(sidesShape, pathOptions);

    // creates two arcs that look like the perpendicular axis angle split into three 30 degree segments
    const innerArcShape = Shape.arc(0, 0, innerIconRadius, 0, 2 * Math.PI - sidesAngle, true);
    const innerArcPath = new Path(innerArcShape, pathOptions);
    const outerArcShape = Shape.arc(0, 0, outerIconRadius, 0, 2 * Math.PI - sidesAngle, true);
    const outerArcPath = new Path(outerArcShape, pathOptions);
    const halfRadius = (outerIconRadius + innerIconRadius) / 2;
    const arcPaths = [];

    // only drawing every other wedge
    for (let i = 0; i < sidesAngle; i = i + 2 * wedgeAngle) {
      const startAngle = i;

      // only draw the final wedge within the angle range for thiss icon
      const endAngle = Math.min(startAngle + wedgeAngle, sidesAngle);
      const arcShape = Shape.arc(0, 0, halfRadius, 2 * Math.PI - startAngle, 2 * Math.PI - endAngle, true);
      arcPaths.push(new Path(arcShape, combineOptions({}, pathOptions, {
        lineWidth: outerIconRadius - innerIconRadius
      })));
    }

    // ticks (along the bottom side)
    const ticksShape = new Shape();
    for (let i = 0; i < 3; i++) {
      const tickX = 5 + i * sidesLength / 3; // offset a little from the origin
      ticksShape.moveTo(tickX, sidesHeight);
      ticksShape.lineTo(tickX, sidesHeight - tickLength);
    }
    const bottomTicksPath = new Path(ticksShape, pathOptions);

    // Effectively translates the ticksShape to the left and then rotates it clockwise (opposite direction of
    // sidesAngle) so that it lies on the left-most edge of the vertical side.
    const verticalTicksShape = ticksShape.transformed(Matrix3.rotationAround(Math.PI - sidesAngle, 0, 0).timesMatrix(Matrix3.translation(-sidesLength, 0)));
    const verticalTicksPath = new Path(verticalTicksShape, pathOptions);
    return new Node({
      children: [sidesPath, innerArcPath, outerArcPath, ...arcPaths, bottomTicksPath, verticalTicksPath],
      // drawing relative to the origin means that the icon is wider than it should be
      maxWidth: QuadrilateralIconFactory.ICON_HEIGHT
    });
  }

  /**
   * Icon for the diagonals control, a pair of crossed lines.
   */
  static createDiagonalGuidesIcon() {
    const iconHeight = QuadrilateralIconFactory.ICON_HEIGHT;
    const lineOptions = {
      stroke: QuadrilateralColors.visibilityIconsColorProperty,
      lineWidth: QuadrilateralIconFactory.ICON_LINE_WIDTH,
      lineDash: [5, 3]
    };
    const firstDiagonal = new Line(-iconHeight / 2, -iconHeight / 2, iconHeight / 2, iconHeight / 2, lineOptions);
    const secondDiagonal = new Line(iconHeight / 2, -iconHeight / 2, -iconHeight / 2, iconHeight / 2, lineOptions);
    return new Node({
      children: [firstDiagonal, secondDiagonal]
    });
  }

  /**
   * Icon for the shape music control.
   */
  static createSoundIcon() {
    return new Path(musicSolidShape, {
      maxHeight: QuadrilateralIconFactory.ICON_HEIGHT,
      fill: QuadrilateralColors.visibilityIconsColorProperty
    });
  }

  /**
   * Icon for the grid visibility control.
   */
  static createGridIcon() {
    return new GridIcon({
      size: QuadrilateralIconFactory.ICON_HEIGHT,
      stroke: QuadrilateralColors.visibilityIconsColorProperty,
      lineWidth: QuadrilateralIconFactory.ICON_LINE_WIDTH
    });
  }

  /**
   * Layout a label Text and icon Node, in that order for various UI controls. Returns a flowbox so that 'stretch'
   * can be used to align text and icons in a parent layout container.
   */
  static createLabelledIcon(iconNode, labelString) {
    const labelText = new Text(labelString, {
      font: QuadrilateralConstants.SCREEN_TEXT_FONT,
      maxWidth: 85
    });
    return new HBox({
      children: [labelText, iconNode],
      spacing: 15
    });
  }
}
quadrilateral.register('QuadrilateralIconFactory', QuadrilateralIconFactory);
export default QuadrilateralIconFactory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDaXJjbGUiLCJIQm94IiwiTGluZSIsIk5vZGUiLCJQYXRoIiwiVGV4dCIsIlV0aWxzIiwiR3JpZEljb24iLCJxdWFkcmlsYXRlcmFsIiwiUXVhZHJpbGF0ZXJhbENvbnN0YW50cyIsIlF1YWRyaWxhdGVyYWxDb2xvcnMiLCJTaGFwZUxpbmUiLCJTaGFwZSIsIm11c2ljU29saWRTaGFwZSIsIlZlY3RvcjIiLCJSYXkyIiwiTWF0cml4MyIsImNvbWJpbmVPcHRpb25zIiwiUXVhZHJpbGF0ZXJhbEljb25GYWN0b3J5IiwiSUNPTl9IRUlHSFQiLCJJQ09OX0xJTkVfV0lEVEgiLCJjcmVhdGVDb3JuZXJMYWJlbHNJY29uIiwiY2lyY2xlIiwic3Ryb2tlIiwidmlzaWJpbGl0eUljb25zQ29sb3JQcm9wZXJ0eSIsImxpbmVXaWR0aCIsImxhYmVsIiwiU0NSRUVOX1RFWFRfT1BUSU9OUyIsImNlbnRlciIsImFkZENoaWxkIiwiY3JlYXRlTWFya2Vyc0ljb24iLCJwYXRoT3B0aW9ucyIsInNpZGVzQW5nbGUiLCJ0b1JhZGlhbnMiLCJzaWRlc0xlbmd0aCIsInNpZGVzSGVpZ2h0Iiwid2VkZ2VBbmdsZSIsIk1hdGgiLCJQSSIsInRpY2tMZW5ndGgiLCJpbm5lckljb25SYWRpdXMiLCJvdXRlckljb25SYWRpdXMiLCJhc3NlcnQiLCJzaWRlc1NoYXBlIiwib3JpZ2luIiwiYm90dG9tUmlnaHRQb2ludCIsInN0cm9rZUxlZnRBbmdsZSIsImxlZnRTaWRlVG9wUG9pbnQiLCJjb3MiLCJzaW4iLCJzdHJva2VkTGVmdFNpZGVQb2ludCIsInBsdXNYWSIsImJvdHRvbVJheSIsImxlZnRTaWRlTGluZSIsImludGVyc2VjdGlvbnMiLCJpbnRlcnNlY3Rpb24iLCJsZW5ndGgiLCJib3R0b21TaWRlQ29ubmVjdGlvblBvaW50IiwicG9pbnQiLCJtb3ZlVG9Qb2ludCIsImxpbmVUbyIsImxpbmVUb1BvaW50IiwiY2xvc2UiLCJzaWRlc1BhdGgiLCJpbm5lckFyY1NoYXBlIiwiYXJjIiwiaW5uZXJBcmNQYXRoIiwib3V0ZXJBcmNTaGFwZSIsIm91dGVyQXJjUGF0aCIsImhhbGZSYWRpdXMiLCJhcmNQYXRocyIsImkiLCJzdGFydEFuZ2xlIiwiZW5kQW5nbGUiLCJtaW4iLCJhcmNTaGFwZSIsInB1c2giLCJ0aWNrc1NoYXBlIiwidGlja1giLCJtb3ZlVG8iLCJib3R0b21UaWNrc1BhdGgiLCJ2ZXJ0aWNhbFRpY2tzU2hhcGUiLCJ0cmFuc2Zvcm1lZCIsInJvdGF0aW9uQXJvdW5kIiwidGltZXNNYXRyaXgiLCJ0cmFuc2xhdGlvbiIsInZlcnRpY2FsVGlja3NQYXRoIiwiY2hpbGRyZW4iLCJtYXhXaWR0aCIsImNyZWF0ZURpYWdvbmFsR3VpZGVzSWNvbiIsImljb25IZWlnaHQiLCJsaW5lT3B0aW9ucyIsImxpbmVEYXNoIiwiZmlyc3REaWFnb25hbCIsInNlY29uZERpYWdvbmFsIiwiY3JlYXRlU291bmRJY29uIiwibWF4SGVpZ2h0IiwiZmlsbCIsImNyZWF0ZUdyaWRJY29uIiwic2l6ZSIsImNyZWF0ZUxhYmVsbGVkSWNvbiIsImljb25Ob2RlIiwibGFiZWxTdHJpbmciLCJsYWJlbFRleHQiLCJmb250IiwiU0NSRUVOX1RFWFRfRk9OVCIsInNwYWNpbmciLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlF1YWRyaWxhdGVyYWxJY29uRmFjdG9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMi0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBJY29ucyBmb3IgdGhlIHNpbXVsYXRpb24uXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IENpcmNsZSwgRmxvd0JveCwgSEJveCwgTGluZSwgTm9kZSwgUGF0aCwgUGF0aE9wdGlvbnMsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1V0aWxzLmpzJztcclxuaW1wb3J0IEdyaWRJY29uIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9HcmlkSWNvbi5qcyc7XHJcbmltcG9ydCBxdWFkcmlsYXRlcmFsIGZyb20gJy4uLy4uL3F1YWRyaWxhdGVyYWwuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbENvbnN0YW50cyBmcm9tICcuLi8uLi9RdWFkcmlsYXRlcmFsQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IFF1YWRyaWxhdGVyYWxDb2xvcnMgZnJvbSAnLi4vLi4vUXVhZHJpbGF0ZXJhbENvbG9ycy5qcyc7XHJcbmltcG9ydCB7IExpbmUgYXMgU2hhcGVMaW5lLCBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBtdXNpY1NvbGlkU2hhcGUgZnJvbSAnLi4vLi4vLi4vLi4vc2hlcnBhL2pzL2ZvbnRhd2Vzb21lLTUvbXVzaWNTb2xpZFNoYXBlLmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgUmF5MiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmF5Mi5qcyc7XHJcbmltcG9ydCBNYXRyaXgzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9NYXRyaXgzLmpzJztcclxuaW1wb3J0IHsgY29tYmluZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5cclxuY2xhc3MgUXVhZHJpbGF0ZXJhbEljb25GYWN0b3J5IHtcclxuXHJcbiAgLy8gbGF5b3V0IGNvbnN0YW50cyBmb3IgYWxsIGljb25zXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBJQ09OX0hFSUdIVCA9IDMwO1xyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgSUNPTl9MSU5FX1dJRFRIID0gMS41O1xyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIGFuIGljb24gZm9yIHRoZSBcIkNvcm5lciBMYWJlbHNcIiBjaGVja2JveCB0aGF0IHRvZ2dsZXMgdmlzaWJpbGl0eSBvZiBsYWJlbHMgb24gZWFjaCBRdWFkcmlsYXRlcmFsVmVydGV4LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgY3JlYXRlQ29ybmVyTGFiZWxzSWNvbigpOiBOb2RlIHtcclxuXHJcbiAgICBjb25zdCBjaXJjbGUgPSBuZXcgQ2lyY2xlKCBRdWFkcmlsYXRlcmFsSWNvbkZhY3RvcnkuSUNPTl9IRUlHSFQgLyAyLCB7XHJcbiAgICAgIHN0cm9rZTogUXVhZHJpbGF0ZXJhbENvbG9ycy52aXNpYmlsaXR5SWNvbnNDb2xvclByb3BlcnR5LFxyXG4gICAgICBsaW5lV2lkdGg6IFF1YWRyaWxhdGVyYWxJY29uRmFjdG9yeS5JQ09OX0xJTkVfV0lEVEhcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBsYWJlbCA9IG5ldyBUZXh0KCAnQScsIHsgLi4uUXVhZHJpbGF0ZXJhbENvbnN0YW50cy5TQ1JFRU5fVEVYVF9PUFRJT05TLCBjZW50ZXI6IGNpcmNsZS5jZW50ZXIgfSApO1xyXG4gICAgY2lyY2xlLmFkZENoaWxkKCBsYWJlbCApO1xyXG5cclxuICAgIHJldHVybiBjaXJjbGU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGUgYW4gaWNvbiBmb3IgdGhlIFwiTWFya2Vyc1wiIGNoZWNrYm94IHRoYXQgdG9nZ2xlcyB2aXN1YWwgaW5kaWNhdG9ycyBvZiB0aGUgYW5nbGUgYXQgZWFjaCB2ZXJ0ZXguXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBjcmVhdGVNYXJrZXJzSWNvbigpOiBOb2RlIHtcclxuXHJcbiAgICBjb25zdCBwYXRoT3B0aW9ucyA9IHtcclxuICAgICAgc3Ryb2tlOiBRdWFkcmlsYXRlcmFsQ29sb3JzLnZpc2liaWxpdHlJY29uc0NvbG9yUHJvcGVydHksXHJcbiAgICAgIGxpbmVXaWR0aDogUXVhZHJpbGF0ZXJhbEljb25GYWN0b3J5LklDT05fTElORV9XSURUSFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBwYXJhbWV0ZXJzIGZvciBkcmF3aW5nIHRoZSBpY29uXHJcbiAgICBjb25zdCBzaWRlc0FuZ2xlID0gVXRpbHMudG9SYWRpYW5zKCAxMTAgKTsgLy8gb3ZlcmFsbCBhbmdsZSBmb3IgdGhlIGljb25cclxuICAgIGNvbnN0IHNpZGVzTGVuZ3RoID0gUXVhZHJpbGF0ZXJhbEljb25GYWN0b3J5LklDT05fSEVJR0hUO1xyXG4gICAgY29uc3Qgc2lkZXNIZWlnaHQgPSBRdWFkcmlsYXRlcmFsSWNvbkZhY3RvcnkuSUNPTl9IRUlHSFQgKiAwLjI1OyAvLyBjaG9zZW4gYnkgaW5zcGVjdGlvblxyXG4gICAgY29uc3Qgd2VkZ2VBbmdsZSA9IE1hdGguUEkgLyA2OyAvLyBzaXplIG9mIGVhY2ggd2VkZ2UgZ3JhcGhpY1xyXG4gICAgY29uc3QgdGlja0xlbmd0aCA9IHNpZGVzSGVpZ2h0IC8gMjtcclxuICAgIGNvbnN0IGlubmVySWNvblJhZGl1cyA9IHNpZGVzTGVuZ3RoICogMC40OyAvLyByYWRpdXMgb2YgdGhlIGlubmVyLW1vc3QgYXJjIGFuZCBmb3IgdGhlIGlubmVyIGN1cnZlIG9mIGFuZ2xlIHdlZGdlc1xyXG4gICAgY29uc3Qgb3V0ZXJJY29uUmFkaXVzID0gc2lkZXNMZW5ndGggKiAwLjg7IC8vIHJhZGl1cyBvZiB0aGUgb3V0ZXItbW9zdCBhcmMgYW5kIGZvciB0aGUgb3V0ZXIgY3VydmUgb2YgYW5nbGUgd2VkZ2VzXHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3V0ZXJJY29uUmFkaXVzID4gaW5uZXJJY29uUmFkaXVzLCAnQXJjIHJhZGlpIGRvIG5vdCBtYWtlIHNlbnNlJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdGlja0xlbmd0aCA8IHNpZGVzSGVpZ2h0LCAndGlja3Mgd2lsbCBiZSB0b28gdGFsbCcgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHdlZGdlQW5nbGUgPCAyICogTWF0aC5QSSwgJ3RoYXQgYW5nbGUgZG9lcyBub3QgbWFrZSBzZW5zZSBmb3IgdGhpcyBpY29uJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggc2lkZXNMZW5ndGggPiBzaWRlc0hlaWdodCwgJ1NpZGVzIG11c3QgYmUgbG9uZ2VyIHRoYW4gdGhleSBhcmUgdGFsbCBmb3IgdGhpcyBpY29uJyApO1xyXG5cclxuICAgIC8vIGRyYXcgdGhlIFwic2lkZXNcIlxyXG4gICAgY29uc3Qgc2lkZXNTaGFwZSA9IG5ldyBTaGFwZSgpO1xyXG5cclxuICAgIC8vIGFsbCBkcmF3aW5nIGlzIHJlbGF0aXZlIHRvIHRoaXMgb3JpZ2luXHJcbiAgICBjb25zdCBvcmlnaW4gPSBuZXcgVmVjdG9yMiggMCwgMCApO1xyXG5cclxuICAgIC8vIGJvdHRvbSByaWdodCBvZiB0aGUgaG9yaXpvbnRhbCBzaWRlXHJcbiAgICBjb25zdCBib3R0b21SaWdodFBvaW50ID0gbmV3IFZlY3RvcjIoIHNpZGVzTGVuZ3RoLCBzaWRlc0hlaWdodCApO1xyXG5cclxuICAgIC8vIGFuZ2xlIHVzZWQgdG8gY2FsY3VsYXRlIG5ldyBwb2ludHMgcGVycGVuZGljdWxhciB0byBvdGhlcnNcclxuICAgIGNvbnN0IHN0cm9rZUxlZnRBbmdsZSA9IE1hdGguUEkgLyAyO1xyXG5cclxuICAgIC8vIHRoZSB0b3AgcmlnaHQgcG9pbnQgb2YgdGhlIHZlcnRpY2FsIHNpZGVcclxuICAgIGNvbnN0IGxlZnRTaWRlVG9wUG9pbnQgPSBuZXcgVmVjdG9yMiggTWF0aC5jb3MoIC1zaWRlc0FuZ2xlICkgKiBzaWRlc0xlbmd0aCwgTWF0aC5zaW4oIC1zaWRlc0FuZ2xlICkgKiBzaWRlc0xlbmd0aCApO1xyXG5cclxuICAgIC8vIHRoZSB0b3AgbGVmdCBwb2ludCBvZiB0aGUgdmVydGljYWwgc2lkZVxyXG4gICAgY29uc3Qgc3Ryb2tlZExlZnRTaWRlUG9pbnQgPSBsZWZ0U2lkZVRvcFBvaW50LnBsdXNYWSggTWF0aC5jb3MoIHNpZGVzQW5nbGUgKyBzdHJva2VMZWZ0QW5nbGUgKSAqIHNpZGVzSGVpZ2h0LCAtTWF0aC5zaW4oIHNpZGVzQW5nbGUgKyBzdHJva2VMZWZ0QW5nbGUgKSAqIHNpZGVzSGVpZ2h0ICk7XHJcblxyXG4gICAgLy8gdGhlIGhhcmRlc3QgcGFydC4uLndlIG5lZWQgdG8gZmluZCB0aGUgYm90dG9tIHBvaW50IHdoZXJlIHRoZSB0d28gb3V0ZXIgbGluZXMgb2YgYm90aCBzaWRlcyBpbnRlcnNlY3QgLSB3ZSBkb1xyXG4gICAgLy8gdGhpcyBieSBjcmVhdGluZyBhIGxpbmUvcmF5IHBhaXIgdGhhdCBydW5zIGFsb25nIHRoZSBvdXRlciBsaW5lcyBhbmQgdXNpbmcgS2l0ZSB0byBmaW5kIHRoZSBpbnRlcnNlY3Rpb24gcG9pbnRcclxuICAgIGNvbnN0IGJvdHRvbVJheSA9IG5ldyBSYXkyKCBib3R0b21SaWdodFBvaW50LCBuZXcgVmVjdG9yMiggLTEsIDAgKSApO1xyXG4gICAgY29uc3QgbGVmdFNpZGVMaW5lID0gbmV3IFNoYXBlTGluZShcclxuICAgICAgc3Ryb2tlZExlZnRTaWRlUG9pbnQsXHJcblxyXG4gICAgICAvLyBMaW5lIHJvdGF0ZWQgYmFjayBhcm91bmQgdG8gdGhlIG9yaWdpbiwgdGhlbiB3aXRoIGV4dHJhIGxlbmd0aCB0byBmaW5kIHRoZSBpbnRlcnNlY3Rpb24gcG9pbnRcclxuICAgICAgc3Ryb2tlZExlZnRTaWRlUG9pbnQucGx1c1hZKFxyXG4gICAgICAgIE1hdGguY29zKCBzaWRlc0FuZ2xlICsgMiAqIHN0cm9rZUxlZnRBbmdsZSApICogc2lkZXNMZW5ndGggKiAyLFxyXG4gICAgICAgIC1NYXRoLnNpbiggc2lkZXNBbmdsZSArIDIgKiBzdHJva2VMZWZ0QW5nbGUgKSAqIHNpZGVzTGVuZ3RoICogMiApXHJcbiAgICApO1xyXG4gICAgY29uc3QgaW50ZXJzZWN0aW9ucyA9IGxlZnRTaWRlTGluZS5pbnRlcnNlY3Rpb24oIGJvdHRvbVJheSApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggaW50ZXJzZWN0aW9ucy5sZW5ndGggPT09IDEsICdOZWVkcyB0byBiZSBvbmUgYW5kIG9ubHkgb25lIGludGVyc2VjdGlvbiBwb2ludCcgKTtcclxuICAgIGNvbnN0IGJvdHRvbVNpZGVDb25uZWN0aW9uUG9pbnQgPSBpbnRlcnNlY3Rpb25zWyAwIF0ucG9pbnQ7XHJcblxyXG4gICAgLy8gTm93IHRoYXQgd2UgaGF2ZSBhbGwgcG9pbnRzLCBkcmF3IHRoZSBzaWRlc1xyXG4gICAgc2lkZXNTaGFwZS5tb3ZlVG9Qb2ludCggb3JpZ2luICk7XHJcbiAgICBzaWRlc1NoYXBlLmxpbmVUbyggc2lkZXNMZW5ndGgsIDAgKTtcclxuICAgIHNpZGVzU2hhcGUubGluZVRvKCBzaWRlc0xlbmd0aCwgc2lkZXNIZWlnaHQgKTtcclxuICAgIHNpZGVzU2hhcGUubGluZVRvUG9pbnQoIGJvdHRvbVNpZGVDb25uZWN0aW9uUG9pbnQgKTtcclxuXHJcbiAgICAvLyB0aGUgb3V0bGluZSBvZiB0aGUgdmVydGljYWwgc2lkZVxyXG4gICAgc2lkZXNTaGFwZS5saW5lVG9Qb2ludCggc3Ryb2tlZExlZnRTaWRlUG9pbnQgKTtcclxuICAgIHNpZGVzU2hhcGUubGluZVRvUG9pbnQoIGxlZnRTaWRlVG9wUG9pbnQgKTtcclxuXHJcbiAgICAvLyBjbG9zZSBiYWNrIHRvIHRoZSBvcmlnaW5cclxuICAgIHNpZGVzU2hhcGUuY2xvc2UoKTtcclxuXHJcbiAgICBjb25zdCBzaWRlc1BhdGggPSBuZXcgUGF0aCggc2lkZXNTaGFwZSwgcGF0aE9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBjcmVhdGVzIHR3byBhcmNzIHRoYXQgbG9vayBsaWtlIHRoZSBwZXJwZW5kaWN1bGFyIGF4aXMgYW5nbGUgc3BsaXQgaW50byB0aHJlZSAzMCBkZWdyZWUgc2VnbWVudHNcclxuICAgIGNvbnN0IGlubmVyQXJjU2hhcGUgPSBTaGFwZS5hcmMoIDAsIDAsIGlubmVySWNvblJhZGl1cywgMCwgMiAqIE1hdGguUEkgLSBzaWRlc0FuZ2xlLCB0cnVlICk7XHJcbiAgICBjb25zdCBpbm5lckFyY1BhdGggPSBuZXcgUGF0aCggaW5uZXJBcmNTaGFwZSwgcGF0aE9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCBvdXRlckFyY1NoYXBlID0gU2hhcGUuYXJjKCAwLCAwLCBvdXRlckljb25SYWRpdXMsIDAsIDIgKiBNYXRoLlBJIC0gc2lkZXNBbmdsZSwgdHJ1ZSApO1xyXG4gICAgY29uc3Qgb3V0ZXJBcmNQYXRoID0gbmV3IFBhdGgoIG91dGVyQXJjU2hhcGUsIHBhdGhPcHRpb25zICk7XHJcblxyXG4gICAgY29uc3QgaGFsZlJhZGl1cyA9ICggb3V0ZXJJY29uUmFkaXVzICsgaW5uZXJJY29uUmFkaXVzICkgLyAyO1xyXG4gICAgY29uc3QgYXJjUGF0aHMgPSBbXTtcclxuXHJcbiAgICAvLyBvbmx5IGRyYXdpbmcgZXZlcnkgb3RoZXIgd2VkZ2VcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHNpZGVzQW5nbGU7IGkgPSBpICsgKCAyICogd2VkZ2VBbmdsZSApICkge1xyXG5cclxuICAgICAgY29uc3Qgc3RhcnRBbmdsZSA9IGk7XHJcblxyXG4gICAgICAvLyBvbmx5IGRyYXcgdGhlIGZpbmFsIHdlZGdlIHdpdGhpbiB0aGUgYW5nbGUgcmFuZ2UgZm9yIHRoaXNzIGljb25cclxuICAgICAgY29uc3QgZW5kQW5nbGUgPSBNYXRoLm1pbiggc3RhcnRBbmdsZSArIHdlZGdlQW5nbGUsIHNpZGVzQW5nbGUgKTtcclxuXHJcbiAgICAgIGNvbnN0IGFyY1NoYXBlID0gU2hhcGUuYXJjKCAwLCAwLCBoYWxmUmFkaXVzLCAyICogTWF0aC5QSSAtIHN0YXJ0QW5nbGUsIDIgKiBNYXRoLlBJIC0gZW5kQW5nbGUsIHRydWUgKTtcclxuICAgICAgYXJjUGF0aHMucHVzaCggbmV3IFBhdGgoIGFyY1NoYXBlLCBjb21iaW5lT3B0aW9uczxQYXRoT3B0aW9ucz4oIHt9LCBwYXRoT3B0aW9ucywgeyBsaW5lV2lkdGg6IG91dGVySWNvblJhZGl1cyAtIGlubmVySWNvblJhZGl1cyB9ICkgKSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHRpY2tzIChhbG9uZyB0aGUgYm90dG9tIHNpZGUpXHJcbiAgICBjb25zdCB0aWNrc1NoYXBlID0gbmV3IFNoYXBlKCk7XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCAzOyBpKysgKSB7XHJcbiAgICAgIGNvbnN0IHRpY2tYID0gNSArIGkgKiBzaWRlc0xlbmd0aCAvIDM7IC8vIG9mZnNldCBhIGxpdHRsZSBmcm9tIHRoZSBvcmlnaW5cclxuICAgICAgdGlja3NTaGFwZS5tb3ZlVG8oIHRpY2tYLCBzaWRlc0hlaWdodCApO1xyXG4gICAgICB0aWNrc1NoYXBlLmxpbmVUbyggdGlja1gsIHNpZGVzSGVpZ2h0IC0gdGlja0xlbmd0aCApO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYm90dG9tVGlja3NQYXRoID0gbmV3IFBhdGgoIHRpY2tzU2hhcGUsIHBhdGhPcHRpb25zICk7XHJcblxyXG4gICAgLy8gRWZmZWN0aXZlbHkgdHJhbnNsYXRlcyB0aGUgdGlja3NTaGFwZSB0byB0aGUgbGVmdCBhbmQgdGhlbiByb3RhdGVzIGl0IGNsb2Nrd2lzZSAob3Bwb3NpdGUgZGlyZWN0aW9uIG9mXHJcbiAgICAvLyBzaWRlc0FuZ2xlKSBzbyB0aGF0IGl0IGxpZXMgb24gdGhlIGxlZnQtbW9zdCBlZGdlIG9mIHRoZSB2ZXJ0aWNhbCBzaWRlLlxyXG4gICAgY29uc3QgdmVydGljYWxUaWNrc1NoYXBlID0gdGlja3NTaGFwZS50cmFuc2Zvcm1lZCggTWF0cml4My5yb3RhdGlvbkFyb3VuZCggTWF0aC5QSSAtIHNpZGVzQW5nbGUsIDAsIDAgKS50aW1lc01hdHJpeCggTWF0cml4My50cmFuc2xhdGlvbiggLXNpZGVzTGVuZ3RoLCAwICkgKSApO1xyXG4gICAgY29uc3QgdmVydGljYWxUaWNrc1BhdGggPSBuZXcgUGF0aCggdmVydGljYWxUaWNrc1NoYXBlLCBwYXRoT3B0aW9ucyApO1xyXG5cclxuICAgIHJldHVybiBuZXcgTm9kZSgge1xyXG4gICAgICBjaGlsZHJlbjogWyBzaWRlc1BhdGgsIGlubmVyQXJjUGF0aCwgb3V0ZXJBcmNQYXRoLCAuLi5hcmNQYXRocywgYm90dG9tVGlja3NQYXRoLCB2ZXJ0aWNhbFRpY2tzUGF0aCBdLFxyXG5cclxuICAgICAgLy8gZHJhd2luZyByZWxhdGl2ZSB0byB0aGUgb3JpZ2luIG1lYW5zIHRoYXQgdGhlIGljb24gaXMgd2lkZXIgdGhhbiBpdCBzaG91bGQgYmVcclxuICAgICAgbWF4V2lkdGg6IFF1YWRyaWxhdGVyYWxJY29uRmFjdG9yeS5JQ09OX0hFSUdIVFxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSWNvbiBmb3IgdGhlIGRpYWdvbmFscyBjb250cm9sLCBhIHBhaXIgb2YgY3Jvc3NlZCBsaW5lcy5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGNyZWF0ZURpYWdvbmFsR3VpZGVzSWNvbigpOiBOb2RlIHtcclxuICAgIGNvbnN0IGljb25IZWlnaHQgPSBRdWFkcmlsYXRlcmFsSWNvbkZhY3RvcnkuSUNPTl9IRUlHSFQ7XHJcbiAgICBjb25zdCBsaW5lT3B0aW9ucyA9IHsgc3Ryb2tlOiBRdWFkcmlsYXRlcmFsQ29sb3JzLnZpc2liaWxpdHlJY29uc0NvbG9yUHJvcGVydHksIGxpbmVXaWR0aDogUXVhZHJpbGF0ZXJhbEljb25GYWN0b3J5LklDT05fTElORV9XSURUSCwgbGluZURhc2g6IFsgNSwgMyBdIH07XHJcbiAgICBjb25zdCBmaXJzdERpYWdvbmFsID0gbmV3IExpbmUoIC1pY29uSGVpZ2h0IC8gMiwgLWljb25IZWlnaHQgLyAyLCBpY29uSGVpZ2h0IC8gMiwgaWNvbkhlaWdodCAvIDIsIGxpbmVPcHRpb25zICk7XHJcbiAgICBjb25zdCBzZWNvbmREaWFnb25hbCA9IG5ldyBMaW5lKCBpY29uSGVpZ2h0IC8gMiwgLWljb25IZWlnaHQgLyAyLCAtaWNvbkhlaWdodCAvIDIsIGljb25IZWlnaHQgLyAyLCBsaW5lT3B0aW9ucyApO1xyXG5cclxuICAgIHJldHVybiBuZXcgTm9kZSgge1xyXG4gICAgICBjaGlsZHJlbjogWyBmaXJzdERpYWdvbmFsLCBzZWNvbmREaWFnb25hbCBdXHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJY29uIGZvciB0aGUgc2hhcGUgbXVzaWMgY29udHJvbC5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGNyZWF0ZVNvdW5kSWNvbigpOiBOb2RlIHtcclxuICAgIHJldHVybiBuZXcgUGF0aCggbXVzaWNTb2xpZFNoYXBlLCB7XHJcbiAgICAgIG1heEhlaWdodDogUXVhZHJpbGF0ZXJhbEljb25GYWN0b3J5LklDT05fSEVJR0hULFxyXG4gICAgICBmaWxsOiBRdWFkcmlsYXRlcmFsQ29sb3JzLnZpc2liaWxpdHlJY29uc0NvbG9yUHJvcGVydHlcclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEljb24gZm9yIHRoZSBncmlkIHZpc2liaWxpdHkgY29udHJvbC5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGNyZWF0ZUdyaWRJY29uKCk6IE5vZGUge1xyXG4gICAgcmV0dXJuIG5ldyBHcmlkSWNvbigge1xyXG4gICAgICBzaXplOiBRdWFkcmlsYXRlcmFsSWNvbkZhY3RvcnkuSUNPTl9IRUlHSFQsXHJcbiAgICAgIHN0cm9rZTogUXVhZHJpbGF0ZXJhbENvbG9ycy52aXNpYmlsaXR5SWNvbnNDb2xvclByb3BlcnR5LFxyXG4gICAgICBsaW5lV2lkdGg6IFF1YWRyaWxhdGVyYWxJY29uRmFjdG9yeS5JQ09OX0xJTkVfV0lEVEhcclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExheW91dCBhIGxhYmVsIFRleHQgYW5kIGljb24gTm9kZSwgaW4gdGhhdCBvcmRlciBmb3IgdmFyaW91cyBVSSBjb250cm9scy4gUmV0dXJucyBhIGZsb3dib3ggc28gdGhhdCAnc3RyZXRjaCdcclxuICAgKiBjYW4gYmUgdXNlZCB0byBhbGlnbiB0ZXh0IGFuZCBpY29ucyBpbiBhIHBhcmVudCBsYXlvdXQgY29udGFpbmVyLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgY3JlYXRlTGFiZWxsZWRJY29uKCBpY29uTm9kZTogTm9kZSwgbGFiZWxTdHJpbmc6IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz4gKTogRmxvd0JveCB7XHJcbiAgICBjb25zdCBsYWJlbFRleHQgPSBuZXcgVGV4dCggbGFiZWxTdHJpbmcsIHtcclxuICAgICAgZm9udDogUXVhZHJpbGF0ZXJhbENvbnN0YW50cy5TQ1JFRU5fVEVYVF9GT05ULFxyXG4gICAgICBtYXhXaWR0aDogODVcclxuICAgIH0gKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IEhCb3goIHtcclxuICAgICAgY2hpbGRyZW46IFsgbGFiZWxUZXh0LCBpY29uTm9kZSBdLFxyXG4gICAgICBzcGFjaW5nOiAxNVxyXG4gICAgfSApO1xyXG4gIH1cclxufVxyXG5cclxucXVhZHJpbGF0ZXJhbC5yZWdpc3RlciggJ1F1YWRyaWxhdGVyYWxJY29uRmFjdG9yeScsIFF1YWRyaWxhdGVyYWxJY29uRmFjdG9yeSApO1xyXG5leHBvcnQgZGVmYXVsdCBRdWFkcmlsYXRlcmFsSWNvbkZhY3Rvcnk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBU0EsTUFBTSxFQUFXQyxJQUFJLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxJQUFJLEVBQWVDLElBQUksUUFBUSxtQ0FBbUM7QUFDOUcsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELE9BQU9DLGFBQWEsTUFBTSx3QkFBd0I7QUFDbEQsT0FBT0Msc0JBQXNCLE1BQU0saUNBQWlDO0FBQ3BFLE9BQU9DLG1CQUFtQixNQUFNLDhCQUE4QjtBQUM5RCxTQUFTUixJQUFJLElB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