// Copyright 2021-2023, University of Colorado Boulder

/**
 * The ScreenView for this simulation. For readability, implementation of this class is broken into blocks of code that
 *
 * - Create view subcomponents
 * - Set rendering order
 * - Set layout
 * - Set traversal order
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import ScreenView from '../../../../joist/js/ScreenView.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import QuadrilateralConstants from '../../QuadrilateralConstants.js';
import quadrilateral from '../../quadrilateral.js';
import { VBox } from '../../../../scenery/js/imports.js';
import QuadrilateralQueryParameters from '../QuadrilateralQueryParameters.js';
import QuadrilateralNode from './QuadrilateralNode.js';
import QuadrilateralSoundView from './sound/QuadrilateralSoundView.js';
import QuadrilateralStrings from '../../QuadrilateralStrings.js';
import QuadrilateralDescriber from './QuadrilateralDescriber.js';
import QuadrilateralDebuggingPanel from './QuadrilateralDebuggingPanel.js';
import QuadrilateralVisibilityControls from './QuadrilateralVisibilityControls.js';
import QuadrilateralGridNode from './QuadrilateralGridNode.js';
import QuadrilateralAlerter from './QuadrilateralAlerter.js';
import QuadrilateralMediaPipe from './prototype/QuadrilateralMediaPipe.js';
import QuadrilateralDiagonalGuidesNode from './QuadrilateralDiagonalGuidesNode.js';
import QuadrilateralShapeNameDisplay from './QuadrilateralShapeNameDisplay.js';
import MediaPipeQueryParameters from '../../../../tangible/js/mediaPipe/MediaPipeQueryParameters.js';
import QuadrilateralInteractionCueNode from './QuadrilateralInteractionCueNode.js';
import ResetShapeButton from './ResetShapeButton.js';
import ShapeSoundsCheckbox from './ShapeSoundsCheckbox.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import SmallStepsLockToggleButton from './SmallStepsLockToggleButton.js';
import QuadrilateralTangibleControls from './prototype/QuadrilateralTangibleControls.js';
import QuadrilateralModelViewTransform from './QuadrilateralModelViewTransform.js';
import QuadrilateralTangibleController from './prototype/QuadrilateralTangibleController.js';
export default class QuadrilateralScreenView extends ScreenView {
  // Prototype components are only constructed and available when running with relevant query parameters.
  quadrilateralTangibleController = null;
  quadrilateralMediaPipe = null;
  constructor(model, optionsModel, tandem) {
    super({
      // phet-io
      tandem: tandem
    });
    this.model = model;
    const visibilityModel = model.visibilityModel;

    //---------------------------------------------------------------------------------------------------------------
    // Create view subcomponents
    //---------------------------------------------------------------------------------------------------------------
    this.modelViewTransform = new QuadrilateralModelViewTransform(QuadrilateralConstants.MODEL_BOUNDS, this.layoutBounds);
    this.quadrilateralDescriber = new QuadrilateralDescriber(model.quadrilateralShapeModel, visibilityModel.shapeNameVisibleProperty, visibilityModel.markersVisibleProperty, this.modelViewTransform);
    this.quadrilateralSoundView = new QuadrilateralSoundView(model, optionsModel.soundOptionsModel);

    // miscellaneous sim and visibility control components
    const smallStepsLockToggleButton = new SmallStepsLockToggleButton(model.lockToMinorIntervalsProperty, {
      tandem: tandem.createTandem('smallStepsLockToggleButton')
    });
    const resetAllButton = new ResetAllButton({
      listener: () => {
        this.interruptSubtreeInput();
        model.reset();
      },
      tandem: tandem.createTandem('resetAllButton')
    });
    const visibilityControls = new QuadrilateralVisibilityControls(visibilityModel, {
      tandem: tandem.createTandem('visibilityControls')
    });

    // shape controls components
    const shapeNameDisplay = new QuadrilateralShapeNameDisplay(visibilityModel.shapeNameVisibleProperty, model.quadrilateralShapeModel.shapeNameProperty, this.quadrilateralDescriber, tandem.createTandem('quadrilateralShapeNameDisplay'));
    const resetShapeButton = new ResetShapeButton(model.quadrilateralShapeModel, tandem.createTandem('resetShapeButton'));
    const shapeSoundsCheckbox = new ShapeSoundsCheckbox(model.shapeSoundEnabledProperty, tandem.createTandem('shapeSoundsCheckbox'));

    // quadrilateral shape and grid components
    this.quadrilateralNode = new QuadrilateralNode(model, this.modelViewTransform, this.layoutBounds, this.quadrilateralDescriber, {
      tandem: tandem.createTandem('quadrilateralNode')
    });
    const diagonalGuidesNode = new QuadrilateralDiagonalGuidesNode(model.quadrilateralShapeModel, visibilityModel.diagonalGuidesVisibleProperty, this.modelViewTransform);
    const interactionCueNode = new QuadrilateralInteractionCueNode(model.quadrilateralShapeModel, model.tangibleConnectionModel.connectedToDeviceProperty, model.resetEmitter, this.modelViewTransform);
    const gridNode = new QuadrilateralGridNode(visibilityModel.gridVisibleProperty, this.modelViewTransform);

    // debugging components
    const debugValuesPanel = new QuadrilateralDebuggingPanel(model);
    visibilityModel.showDebugValuesProperty.link(showValues => {
      debugValuesPanel.visible = showValues;
    });

    // tangible components
    if (QuadrilateralQueryParameters.deviceConnection || MediaPipeQueryParameters.cameraInput === 'hands') {
      this.quadrilateralTangibleController = new QuadrilateralTangibleController(model);
    }

    // this parent only has children if relevant query params are provided, but is always created for easy layout
    const deviceConnectionParentNode = new VBox({
      align: 'left',
      spacing: QuadrilateralConstants.CONTROLS_SPACING
    });
    if (QuadrilateralQueryParameters.deviceConnection) {
      assert && assert(this.quadrilateralTangibleController, 'The QuadrilateralTangibleController is not available');
      deviceConnectionParentNode.children = [new QuadrilateralTangibleControls(model.tangibleConnectionModel, this.quadrilateralTangibleController, tandem.createTandem('connectionControls'))];
      deviceConnectionParentNode.top = gridNode.top;
      deviceConnectionParentNode.left = resetAllButton.left;
    }
    if (MediaPipeQueryParameters.cameraInput === 'hands') {
      assert && assert(this.quadrilateralTangibleController, 'The QuadrilateralTangibleController is not available');
      this.quadrilateralMediaPipe = new QuadrilateralMediaPipe(model, this.quadrilateralTangibleController);
    }

    // voicing components
    this.quadrilateralAlerter = new QuadrilateralAlerter(model, this, this.modelViewTransform, this.quadrilateralDescriber);

    //---------------------------------------------------------------------------------------------------------------
    // rendering order - see https://github.com/phetsims/quadrilateral/issues/178
    //---------------------------------------------------------------------------------------------------------------
    this.children = [
    // shape area
    gridNode, diagonalGuidesNode, this.quadrilateralNode, interactionCueNode, debugValuesPanel,
    // controls
    visibilityControls, smallStepsLockToggleButton, resetAllButton, shapeSoundsCheckbox, shapeNameDisplay, resetShapeButton, deviceConnectionParentNode];

    //---------------------------------------------------------------------------------------------------------------
    // Layout - all relative to the grid space of the quadrilateral because its size and position is determined by
    // the modelViewTransform
    //---------------------------------------------------------------------------------------------------------------
    resetAllButton.leftBottom = new Vector2(gridNode.right + QuadrilateralConstants.VIEW_SPACING, this.layoutBounds.maxY - QuadrilateralConstants.SCREEN_VIEW_Y_MARGIN);
    smallStepsLockToggleButton.leftBottom = resetAllButton.leftTop.minusXY(0, QuadrilateralConstants.VIEW_GROUP_SPACING);
    visibilityControls.leftCenter = gridNode.rightCenter.plusXY(QuadrilateralConstants.VIEW_SPACING, 0);
    shapeNameDisplay.centerBottom = gridNode.centerTop.minusXY(0, QuadrilateralConstants.VIEW_SPACING);
    shapeSoundsCheckbox.rightCenter = new Vector2(gridNode.right, shapeNameDisplay.centerY);

    // dynamic string layout
    resetShapeButton.boundsProperty.link(() => {
      resetShapeButton.rightCenter = shapeSoundsCheckbox.leftCenter.minusXY(
      // effectively centers this button between the other name display controls
      (shapeSoundsCheckbox.left - shapeNameDisplay.right - resetShapeButton.width) / 2, 0);
    });
    deviceConnectionParentNode.leftBottom = visibilityControls.leftTop.minusXY(0, QuadrilateralConstants.VIEW_GROUP_SPACING);
    debugValuesPanel.leftTop = gridNode.leftTop.plusXY(5, 5);

    //---------------------------------------------------------------------------------------------------------------
    // Traversal order
    //---------------------------------------------------------------------------------------------------------------
    this.pdomPlayAreaNode.pdomOrder = [this.quadrilateralNode, shapeNameDisplay, resetShapeButton, shapeSoundsCheckbox];
    this.pdomControlAreaNode.pdomOrder = [visibilityControls, smallStepsLockToggleButton, resetAllButton, deviceConnectionParentNode];
  }

  /**
   * Get the content that is spoken from the Voicing toolbar to describe this ScreenView.
   */
  getVoicingOverviewContent() {
    return QuadrilateralStrings.a11y.voicing.overviewContentStringProperty;
  }

  /**
   * Get the details content that is spoken from the Voicing toolbar to describe details about the simulation.
   */
  getVoicingDetailsContent() {
    const firstStatement = this.quadrilateralDescriber.getFirstDetailsStatement();
    const secondStatement = this.quadrilateralDescriber.getSecondDetailsStatement();
    const thirdStatement = this.quadrilateralDescriber.getThirdDetailsStatement();
    const fourthStatement = this.quadrilateralDescriber.getFourthDetailsStatement();
    const fifthStatement = this.quadrilateralDescriber.getFifthDetailsStatement();
    assert && assert(firstStatement, 'there should always be a first statement for details');
    let contentString = firstStatement;

    // Append remaining statements, if they exist with current sim state.
    // NOTE: This is bad for i18n but PhET decided that is OK for now.
    const remainingStatements = [secondStatement, thirdStatement, fourthStatement, fifthStatement];
    remainingStatements.forEach(statement => {
      if (statement) {
        // i18n not supported, but statements might be a string Property
        const valueString = typeof statement === 'string' ? statement : statement.value;
        contentString += ' ' + valueString;
      }
    });
    return contentString;
  }

  /**
   * Get the content that is spoken from the Voicing toolbar to describe this ScreenView. In this sim we use the hint
   * button to describe the parallelogram state and shape name of the quadrilateral.
   */
  getVoicingHintContent() {
    return QuadrilateralStrings.a11y.voicing.hintContentStringProperty;
  }

  /**
   * Steps the view.
   * @param dt - time step, in seconds
   */
  step(dt) {
    if (this.quadrilateralSoundView) {
      this.quadrilateralSoundView.step(dt);
    }
    this.quadrilateralMediaPipe && this.quadrilateralMediaPipe.step(dt);
    this.quadrilateralNode && this.quadrilateralNode.step(dt);
  }
}
quadrilateral.register('QuadrilateralScreenView', QuadrilateralScreenView);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTY3JlZW5WaWV3IiwiUmVzZXRBbGxCdXR0b24iLCJRdWFkcmlsYXRlcmFsQ29uc3RhbnRzIiwicXVhZHJpbGF0ZXJhbCIsIlZCb3giLCJRdWFkcmlsYXRlcmFsUXVlcnlQYXJhbWV0ZXJzIiwiUXVhZHJpbGF0ZXJhbE5vZGUiLCJRdWFkcmlsYXRlcmFsU291bmRWaWV3IiwiUXVhZHJpbGF0ZXJhbFN0cmluZ3MiLCJRdWFkcmlsYXRlcmFsRGVzY3JpYmVyIiwiUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsIiwiUXVhZHJpbGF0ZXJhbFZpc2liaWxpdHlDb250cm9scyIsIlF1YWRyaWxhdGVyYWxHcmlkTm9kZSIsIlF1YWRyaWxhdGVyYWxBbGVydGVyIiwiUXVhZHJpbGF0ZXJhbE1lZGlhUGlwZSIsIlF1YWRyaWxhdGVyYWxEaWFnb25hbEd1aWRlc05vZGUiLCJRdWFkcmlsYXRlcmFsU2hhcGVOYW1lRGlzcGxheSIsIk1lZGlhUGlwZVF1ZXJ5UGFyYW1ldGVycyIsIlF1YWRyaWxhdGVyYWxJbnRlcmFjdGlvbkN1ZU5vZGUiLCJSZXNldFNoYXBlQnV0dG9uIiwiU2hhcGVTb3VuZHNDaGVja2JveCIsIlZlY3RvcjIiLCJTbWFsbFN0ZXBzTG9ja1RvZ2dsZUJ1dHRvbiIsIlF1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xzIiwiUXVhZHJpbGF0ZXJhbE1vZGVsVmlld1RyYW5zZm9ybSIsIlF1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xsZXIiLCJRdWFkcmlsYXRlcmFsU2NyZWVuVmlldyIsInF1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xsZXIiLCJxdWFkcmlsYXRlcmFsTWVkaWFQaXBlIiwiY29uc3RydWN0b3IiLCJtb2RlbCIsIm9wdGlvbnNNb2RlbCIsInRhbmRlbSIsInZpc2liaWxpdHlNb2RlbCIsIm1vZGVsVmlld1RyYW5zZm9ybSIsIk1PREVMX0JPVU5EUyIsImxheW91dEJvdW5kcyIsInF1YWRyaWxhdGVyYWxEZXNjcmliZXIiLCJxdWFkcmlsYXRlcmFsU2hhcGVNb2RlbCIsInNoYXBlTmFtZVZpc2libGVQcm9wZXJ0eSIsIm1hcmtlcnNWaXNpYmxlUHJvcGVydHkiLCJxdWFkcmlsYXRlcmFsU291bmRWaWV3Iiwic291bmRPcHRpb25zTW9kZWwiLCJzbWFsbFN0ZXBzTG9ja1RvZ2dsZUJ1dHRvbiIsImxvY2tUb01pbm9ySW50ZXJ2YWxzUHJvcGVydHkiLCJjcmVhdGVUYW5kZW0iLCJyZXNldEFsbEJ1dHRvbiIsImxpc3RlbmVyIiwiaW50ZXJydXB0U3VidHJlZUlucHV0IiwicmVzZXQiLCJ2aXNpYmlsaXR5Q29udHJvbHMiLCJzaGFwZU5hbWVEaXNwbGF5Iiwic2hhcGVOYW1lUHJvcGVydHkiLCJyZXNldFNoYXBlQnV0dG9uIiwic2hhcGVTb3VuZHNDaGVja2JveCIsInNoYXBlU291bmRFbmFibGVkUHJvcGVydHkiLCJxdWFkcmlsYXRlcmFsTm9kZSIsImRpYWdvbmFsR3VpZGVzTm9kZSIsImRpYWdvbmFsR3VpZGVzVmlzaWJsZVByb3BlcnR5IiwiaW50ZXJhY3Rpb25DdWVOb2RlIiwidGFuZ2libGVDb25uZWN0aW9uTW9kZWwiLCJjb25uZWN0ZWRUb0RldmljZVByb3BlcnR5IiwicmVzZXRFbWl0dGVyIiwiZ3JpZE5vZGUiLCJncmlkVmlzaWJsZVByb3BlcnR5IiwiZGVidWdWYWx1ZXNQYW5lbCIsInNob3dEZWJ1Z1ZhbHVlc1Byb3BlcnR5IiwibGluayIsInNob3dWYWx1ZXMiLCJ2aXNpYmxlIiwiZGV2aWNlQ29ubmVjdGlvbiIsImNhbWVyYUlucHV0IiwiZGV2aWNlQ29ubmVjdGlvblBhcmVudE5vZGUiLCJhbGlnbiIsInNwYWNpbmciLCJDT05UUk9MU19TUEFDSU5HIiwiYXNzZXJ0IiwiY2hpbGRyZW4iLCJ0b3AiLCJsZWZ0IiwicXVhZHJpbGF0ZXJhbEFsZXJ0ZXIiLCJsZWZ0Qm90dG9tIiwicmlnaHQiLCJWSUVXX1NQQUNJTkciLCJtYXhZIiwiU0NSRUVOX1ZJRVdfWV9NQVJHSU4iLCJsZWZ0VG9wIiwibWludXNYWSIsIlZJRVdfR1JPVVBfU1BBQ0lORyIsImxlZnRDZW50ZXIiLCJyaWdodENlbnRlciIsInBsdXNYWSIsImNlbnRlckJvdHRvbSIsImNlbnRlclRvcCIsImNlbnRlclkiLCJib3VuZHNQcm9wZXJ0eSIsIndpZHRoIiwicGRvbVBsYXlBcmVhTm9kZSIsInBkb21PcmRlciIsInBkb21Db250cm9sQXJlYU5vZGUiLCJnZXRWb2ljaW5nT3ZlcnZpZXdDb250ZW50IiwiYTExeSIsInZvaWNpbmciLCJvdmVydmlld0NvbnRlbnRTdHJpbmdQcm9wZXJ0eSIsImdldFZvaWNpbmdEZXRhaWxzQ29udGVudCIsImZpcnN0U3RhdGVtZW50IiwiZ2V0Rmlyc3REZXRhaWxzU3RhdGVtZW50Iiwic2Vjb25kU3RhdGVtZW50IiwiZ2V0U2Vjb25kRGV0YWlsc1N0YXRlbWVudCIsInRoaXJkU3RhdGVtZW50IiwiZ2V0VGhpcmREZXRhaWxzU3RhdGVtZW50IiwiZm91cnRoU3RhdGVtZW50IiwiZ2V0Rm91cnRoRGV0YWlsc1N0YXRlbWVudCIsImZpZnRoU3RhdGVtZW50IiwiZ2V0RmlmdGhEZXRhaWxzU3RhdGVtZW50IiwiY29udGVudFN0cmluZyIsInJlbWFpbmluZ1N0YXRlbWVudHMiLCJmb3JFYWNoIiwic3RhdGVtZW50IiwidmFsdWVTdHJpbmciLCJ2YWx1ZSIsImdldFZvaWNpbmdIaW50Q29udGVudCIsImhpbnRDb250ZW50U3RyaW5nUHJvcGVydHkiLCJzdGVwIiwiZHQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlF1YWRyaWxhdGVyYWxTY3JlZW5WaWV3LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIxLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFRoZSBTY3JlZW5WaWV3IGZvciB0aGlzIHNpbXVsYXRpb24uIEZvciByZWFkYWJpbGl0eSwgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBjbGFzcyBpcyBicm9rZW4gaW50byBibG9ja3Mgb2YgY29kZSB0aGF0XHJcbiAqXHJcbiAqIC0gQ3JlYXRlIHZpZXcgc3ViY29tcG9uZW50c1xyXG4gKiAtIFNldCByZW5kZXJpbmcgb3JkZXJcclxuICogLSBTZXQgbGF5b3V0XHJcbiAqIC0gU2V0IHRyYXZlcnNhbCBvcmRlclxyXG4gKlxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgU2NyZWVuVmlldyBmcm9tICcuLi8uLi8uLi8uLi9qb2lzdC9qcy9TY3JlZW5WaWV3LmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgUmVzZXRBbGxCdXR0b24gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL2J1dHRvbnMvUmVzZXRBbGxCdXR0b24uanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbENvbnN0YW50cyBmcm9tICcuLi8uLi9RdWFkcmlsYXRlcmFsQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IHF1YWRyaWxhdGVyYWwgZnJvbSAnLi4vLi4vcXVhZHJpbGF0ZXJhbC5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsTW9kZWwgZnJvbSAnLi4vbW9kZWwvUXVhZHJpbGF0ZXJhbE1vZGVsLmpzJztcclxuaW1wb3J0IHsgVkJveCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsUXVlcnlQYXJhbWV0ZXJzIGZyb20gJy4uL1F1YWRyaWxhdGVyYWxRdWVyeVBhcmFtZXRlcnMuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbE5vZGUgZnJvbSAnLi9RdWFkcmlsYXRlcmFsTm9kZS5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsU291bmRWaWV3IGZyb20gJy4vc291bmQvUXVhZHJpbGF0ZXJhbFNvdW5kVmlldy5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsU3RyaW5ncyBmcm9tICcuLi8uLi9RdWFkcmlsYXRlcmFsU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsRGVzY3JpYmVyIGZyb20gJy4vUXVhZHJpbGF0ZXJhbERlc2NyaWJlci5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwgZnJvbSAnLi9RdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbFZpc2liaWxpdHlDb250cm9scyBmcm9tICcuL1F1YWRyaWxhdGVyYWxWaXNpYmlsaXR5Q29udHJvbHMuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbEdyaWROb2RlIGZyb20gJy4vUXVhZHJpbGF0ZXJhbEdyaWROb2RlLmpzJztcclxuaW1wb3J0IFF1YWRyaWxhdGVyYWxBbGVydGVyIGZyb20gJy4vUXVhZHJpbGF0ZXJhbEFsZXJ0ZXIuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbE9wdGlvbnNNb2RlbCBmcm9tICcuLi9tb2RlbC9RdWFkcmlsYXRlcmFsT3B0aW9uc01vZGVsLmpzJztcclxuaW1wb3J0IFF1YWRyaWxhdGVyYWxNZWRpYVBpcGUgZnJvbSAnLi9wcm90b3R5cGUvUXVhZHJpbGF0ZXJhbE1lZGlhUGlwZS5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsRGlhZ29uYWxHdWlkZXNOb2RlIGZyb20gJy4vUXVhZHJpbGF0ZXJhbERpYWdvbmFsR3VpZGVzTm9kZS5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsU2hhcGVOYW1lRGlzcGxheSBmcm9tICcuL1F1YWRyaWxhdGVyYWxTaGFwZU5hbWVEaXNwbGF5LmpzJztcclxuaW1wb3J0IE1lZGlhUGlwZVF1ZXJ5UGFyYW1ldGVycyBmcm9tICcuLi8uLi8uLi8uLi90YW5naWJsZS9qcy9tZWRpYVBpcGUvTWVkaWFQaXBlUXVlcnlQYXJhbWV0ZXJzLmpzJztcclxuaW1wb3J0IFF1YWRyaWxhdGVyYWxJbnRlcmFjdGlvbkN1ZU5vZGUgZnJvbSAnLi9RdWFkcmlsYXRlcmFsSW50ZXJhY3Rpb25DdWVOb2RlLmpzJztcclxuaW1wb3J0IFJlc2V0U2hhcGVCdXR0b24gZnJvbSAnLi9SZXNldFNoYXBlQnV0dG9uLmpzJztcclxuaW1wb3J0IFNoYXBlU291bmRzQ2hlY2tib3ggZnJvbSAnLi9TaGFwZVNvdW5kc0NoZWNrYm94LmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgU21hbGxTdGVwc0xvY2tUb2dnbGVCdXR0b24gZnJvbSAnLi9TbWFsbFN0ZXBzTG9ja1RvZ2dsZUJ1dHRvbi5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsVGFuZ2libGVDb250cm9scyBmcm9tICcuL3Byb3RvdHlwZS9RdWFkcmlsYXRlcmFsVGFuZ2libGVDb250cm9scy5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsTW9kZWxWaWV3VHJhbnNmb3JtIGZyb20gJy4vUXVhZHJpbGF0ZXJhbE1vZGVsVmlld1RyYW5zZm9ybS5qcyc7XHJcbmltcG9ydCBRdWFkcmlsYXRlcmFsVGFuZ2libGVDb250cm9sbGVyIGZyb20gJy4vcHJvdG90eXBlL1F1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xsZXIuanMnO1xyXG5pbXBvcnQgeyBTcGVha2FibGVSZXNvbHZlZFJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vLi4vLi4vdXR0ZXJhbmNlLXF1ZXVlL2pzL1Jlc3BvbnNlUGFja2V0LmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFF1YWRyaWxhdGVyYWxTY3JlZW5WaWV3IGV4dGVuZHMgU2NyZWVuVmlldyB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBtb2RlbDogUXVhZHJpbGF0ZXJhbE1vZGVsO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgbW9kZWxWaWV3VHJhbnNmb3JtOiBNb2RlbFZpZXdUcmFuc2Zvcm0yO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcXVhZHJpbGF0ZXJhbE5vZGU6IFF1YWRyaWxhdGVyYWxOb2RlO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcXVhZHJpbGF0ZXJhbFNvdW5kVmlldzogUXVhZHJpbGF0ZXJhbFNvdW5kVmlldztcclxuICBwcml2YXRlIHJlYWRvbmx5IHF1YWRyaWxhdGVyYWxEZXNjcmliZXI6IFF1YWRyaWxhdGVyYWxEZXNjcmliZXI7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBxdWFkcmlsYXRlcmFsQWxlcnRlcjogUXVhZHJpbGF0ZXJhbEFsZXJ0ZXI7XHJcblxyXG4gIC8vIFByb3RvdHlwZSBjb21wb25lbnRzIGFyZSBvbmx5IGNvbnN0cnVjdGVkIGFuZCBhdmFpbGFibGUgd2hlbiBydW5uaW5nIHdpdGggcmVsZXZhbnQgcXVlcnkgcGFyYW1ldGVycy5cclxuICBwcml2YXRlIHJlYWRvbmx5IHF1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xsZXI6IFF1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xsZXIgfCBudWxsID0gbnVsbDtcclxuICBwcml2YXRlIHJlYWRvbmx5IHF1YWRyaWxhdGVyYWxNZWRpYVBpcGU6IFF1YWRyaWxhdGVyYWxNZWRpYVBpcGUgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBtb2RlbDogUXVhZHJpbGF0ZXJhbE1vZGVsLCBvcHRpb25zTW9kZWw6IFF1YWRyaWxhdGVyYWxPcHRpb25zTW9kZWwsIHRhbmRlbTogVGFuZGVtICkge1xyXG4gICAgc3VwZXIoIHtcclxuXHJcbiAgICAgIC8vIHBoZXQtaW9cclxuICAgICAgdGFuZGVtOiB0YW5kZW1cclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLm1vZGVsID0gbW9kZWw7XHJcbiAgICBjb25zdCB2aXNpYmlsaXR5TW9kZWwgPSBtb2RlbC52aXNpYmlsaXR5TW9kZWw7XHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIENyZWF0ZSB2aWV3IHN1YmNvbXBvbmVudHNcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybSA9IG5ldyBRdWFkcmlsYXRlcmFsTW9kZWxWaWV3VHJhbnNmb3JtKCBRdWFkcmlsYXRlcmFsQ29uc3RhbnRzLk1PREVMX0JPVU5EUywgdGhpcy5sYXlvdXRCb3VuZHMgKTtcclxuICAgIHRoaXMucXVhZHJpbGF0ZXJhbERlc2NyaWJlciA9IG5ldyBRdWFkcmlsYXRlcmFsRGVzY3JpYmVyKFxyXG4gICAgICBtb2RlbC5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbCxcclxuICAgICAgdmlzaWJpbGl0eU1vZGVsLnNoYXBlTmFtZVZpc2libGVQcm9wZXJ0eSxcclxuICAgICAgdmlzaWJpbGl0eU1vZGVsLm1hcmtlcnNWaXNpYmxlUHJvcGVydHksXHJcbiAgICAgIHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtXHJcbiAgICApO1xyXG4gICAgdGhpcy5xdWFkcmlsYXRlcmFsU291bmRWaWV3ID0gbmV3IFF1YWRyaWxhdGVyYWxTb3VuZFZpZXcoIG1vZGVsLCBvcHRpb25zTW9kZWwuc291bmRPcHRpb25zTW9kZWwgKTtcclxuXHJcbiAgICAvLyBtaXNjZWxsYW5lb3VzIHNpbSBhbmQgdmlzaWJpbGl0eSBjb250cm9sIGNvbXBvbmVudHNcclxuICAgIGNvbnN0IHNtYWxsU3RlcHNMb2NrVG9nZ2xlQnV0dG9uID0gbmV3IFNtYWxsU3RlcHNMb2NrVG9nZ2xlQnV0dG9uKCBtb2RlbC5sb2NrVG9NaW5vckludGVydmFsc1Byb3BlcnR5LCB7XHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NtYWxsU3RlcHNMb2NrVG9nZ2xlQnV0dG9uJyApXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCByZXNldEFsbEJ1dHRvbiA9IG5ldyBSZXNldEFsbEJ1dHRvbigge1xyXG4gICAgICBsaXN0ZW5lcjogKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuaW50ZXJydXB0U3VidHJlZUlucHV0KCk7XHJcbiAgICAgICAgbW9kZWwucmVzZXQoKTtcclxuICAgICAgfSxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAncmVzZXRBbGxCdXR0b24nIClcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IHZpc2liaWxpdHlDb250cm9scyA9IG5ldyBRdWFkcmlsYXRlcmFsVmlzaWJpbGl0eUNvbnRyb2xzKFxyXG4gICAgICB2aXNpYmlsaXR5TW9kZWwsXHJcbiAgICAgIHtcclxuICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICd2aXNpYmlsaXR5Q29udHJvbHMnIClcclxuICAgICAgfSApO1xyXG5cclxuICAgIC8vIHNoYXBlIGNvbnRyb2xzIGNvbXBvbmVudHNcclxuICAgIGNvbnN0IHNoYXBlTmFtZURpc3BsYXkgPSBuZXcgUXVhZHJpbGF0ZXJhbFNoYXBlTmFtZURpc3BsYXkoXHJcbiAgICAgIHZpc2liaWxpdHlNb2RlbC5zaGFwZU5hbWVWaXNpYmxlUHJvcGVydHksXHJcbiAgICAgIG1vZGVsLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLnNoYXBlTmFtZVByb3BlcnR5LFxyXG4gICAgICB0aGlzLnF1YWRyaWxhdGVyYWxEZXNjcmliZXIsXHJcbiAgICAgIHRhbmRlbS5jcmVhdGVUYW5kZW0oICdxdWFkcmlsYXRlcmFsU2hhcGVOYW1lRGlzcGxheScgKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IHJlc2V0U2hhcGVCdXR0b24gPSBuZXcgUmVzZXRTaGFwZUJ1dHRvbihcclxuICAgICAgbW9kZWwucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwsXHJcbiAgICAgIHRhbmRlbS5jcmVhdGVUYW5kZW0oICdyZXNldFNoYXBlQnV0dG9uJyApXHJcbiAgICApO1xyXG4gICAgY29uc3Qgc2hhcGVTb3VuZHNDaGVja2JveCA9IG5ldyBTaGFwZVNvdW5kc0NoZWNrYm94KFxyXG4gICAgICBtb2RlbC5zaGFwZVNvdW5kRW5hYmxlZFByb3BlcnR5LFxyXG4gICAgICB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnc2hhcGVTb3VuZHNDaGVja2JveCcgKVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBxdWFkcmlsYXRlcmFsIHNoYXBlIGFuZCBncmlkIGNvbXBvbmVudHNcclxuICAgIHRoaXMucXVhZHJpbGF0ZXJhbE5vZGUgPSBuZXcgUXVhZHJpbGF0ZXJhbE5vZGUoXHJcbiAgICAgIG1vZGVsLFxyXG4gICAgICB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybSxcclxuICAgICAgdGhpcy5sYXlvdXRCb3VuZHMsXHJcbiAgICAgIHRoaXMucXVhZHJpbGF0ZXJhbERlc2NyaWJlciwge1xyXG4gICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3F1YWRyaWxhdGVyYWxOb2RlJyApXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBkaWFnb25hbEd1aWRlc05vZGUgPSBuZXcgUXVhZHJpbGF0ZXJhbERpYWdvbmFsR3VpZGVzTm9kZShcclxuICAgICAgbW9kZWwucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwsXHJcbiAgICAgIHZpc2liaWxpdHlNb2RlbC5kaWFnb25hbEd1aWRlc1Zpc2libGVQcm9wZXJ0eSxcclxuICAgICAgdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm1cclxuICAgICk7XHJcbiAgICBjb25zdCBpbnRlcmFjdGlvbkN1ZU5vZGUgPSBuZXcgUXVhZHJpbGF0ZXJhbEludGVyYWN0aW9uQ3VlTm9kZShcclxuICAgICAgbW9kZWwucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwsXHJcbiAgICAgIG1vZGVsLnRhbmdpYmxlQ29ubmVjdGlvbk1vZGVsLmNvbm5lY3RlZFRvRGV2aWNlUHJvcGVydHksXHJcbiAgICAgIG1vZGVsLnJlc2V0RW1pdHRlcixcclxuICAgICAgdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm1cclxuICAgICk7XHJcbiAgICBjb25zdCBncmlkTm9kZSA9IG5ldyBRdWFkcmlsYXRlcmFsR3JpZE5vZGUoIHZpc2liaWxpdHlNb2RlbC5ncmlkVmlzaWJsZVByb3BlcnR5LCB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybSApO1xyXG5cclxuICAgIC8vIGRlYnVnZ2luZyBjb21wb25lbnRzXHJcbiAgICBjb25zdCBkZWJ1Z1ZhbHVlc1BhbmVsID0gbmV3IFF1YWRyaWxhdGVyYWxEZWJ1Z2dpbmdQYW5lbCggbW9kZWwgKTtcclxuICAgIHZpc2liaWxpdHlNb2RlbC5zaG93RGVidWdWYWx1ZXNQcm9wZXJ0eS5saW5rKCBzaG93VmFsdWVzID0+IHtcclxuICAgICAgZGVidWdWYWx1ZXNQYW5lbC52aXNpYmxlID0gc2hvd1ZhbHVlcztcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB0YW5naWJsZSBjb21wb25lbnRzXHJcbiAgICBpZiAoIFF1YWRyaWxhdGVyYWxRdWVyeVBhcmFtZXRlcnMuZGV2aWNlQ29ubmVjdGlvbiB8fCBNZWRpYVBpcGVRdWVyeVBhcmFtZXRlcnMuY2FtZXJhSW5wdXQgPT09ICdoYW5kcycgKSB7XHJcbiAgICAgIHRoaXMucXVhZHJpbGF0ZXJhbFRhbmdpYmxlQ29udHJvbGxlciA9IG5ldyBRdWFkcmlsYXRlcmFsVGFuZ2libGVDb250cm9sbGVyKCBtb2RlbCApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHRoaXMgcGFyZW50IG9ubHkgaGFzIGNoaWxkcmVuIGlmIHJlbGV2YW50IHF1ZXJ5IHBhcmFtcyBhcmUgcHJvdmlkZWQsIGJ1dCBpcyBhbHdheXMgY3JlYXRlZCBmb3IgZWFzeSBsYXlvdXRcclxuICAgIGNvbnN0IGRldmljZUNvbm5lY3Rpb25QYXJlbnROb2RlID0gbmV3IFZCb3goIHtcclxuICAgICAgYWxpZ246ICdsZWZ0JyxcclxuICAgICAgc3BhY2luZzogUXVhZHJpbGF0ZXJhbENvbnN0YW50cy5DT05UUk9MU19TUEFDSU5HXHJcbiAgICB9ICk7XHJcbiAgICBpZiAoIFF1YWRyaWxhdGVyYWxRdWVyeVBhcmFtZXRlcnMuZGV2aWNlQ29ubmVjdGlvbiApIHtcclxuICAgICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5xdWFkcmlsYXRlcmFsVGFuZ2libGVDb250cm9sbGVyLCAnVGhlIFF1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xsZXIgaXMgbm90IGF2YWlsYWJsZScgKTtcclxuICAgICAgZGV2aWNlQ29ubmVjdGlvblBhcmVudE5vZGUuY2hpbGRyZW4gPSBbXHJcbiAgICAgICAgbmV3IFF1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xzKFxyXG4gICAgICAgICAgbW9kZWwudGFuZ2libGVDb25uZWN0aW9uTW9kZWwsXHJcbiAgICAgICAgICB0aGlzLnF1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xsZXIhLFxyXG4gICAgICAgICAgdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2Nvbm5lY3Rpb25Db250cm9scycgKVxyXG4gICAgICAgIClcclxuICAgICAgXTtcclxuICAgICAgZGV2aWNlQ29ubmVjdGlvblBhcmVudE5vZGUudG9wID0gZ3JpZE5vZGUudG9wO1xyXG4gICAgICBkZXZpY2VDb25uZWN0aW9uUGFyZW50Tm9kZS5sZWZ0ID0gcmVzZXRBbGxCdXR0b24ubGVmdDtcclxuICAgIH1cclxuICAgIGlmICggTWVkaWFQaXBlUXVlcnlQYXJhbWV0ZXJzLmNhbWVyYUlucHV0ID09PSAnaGFuZHMnICkge1xyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLnF1YWRyaWxhdGVyYWxUYW5naWJsZUNvbnRyb2xsZXIsICdUaGUgUXVhZHJpbGF0ZXJhbFRhbmdpYmxlQ29udHJvbGxlciBpcyBub3QgYXZhaWxhYmxlJyApO1xyXG4gICAgICB0aGlzLnF1YWRyaWxhdGVyYWxNZWRpYVBpcGUgPSBuZXcgUXVhZHJpbGF0ZXJhbE1lZGlhUGlwZSggbW9kZWwsIHRoaXMucXVhZHJpbGF0ZXJhbFRhbmdpYmxlQ29udHJvbGxlciEgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2b2ljaW5nIGNvbXBvbmVudHNcclxuICAgIHRoaXMucXVhZHJpbGF0ZXJhbEFsZXJ0ZXIgPSBuZXcgUXVhZHJpbGF0ZXJhbEFsZXJ0ZXIoIG1vZGVsLCB0aGlzLCB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybSwgdGhpcy5xdWFkcmlsYXRlcmFsRGVzY3JpYmVyICk7XHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIHJlbmRlcmluZyBvcmRlciAtIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvcXVhZHJpbGF0ZXJhbC9pc3N1ZXMvMTc4XHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgdGhpcy5jaGlsZHJlbiA9IFtcclxuXHJcbiAgICAgIC8vIHNoYXBlIGFyZWFcclxuICAgICAgZ3JpZE5vZGUsXHJcbiAgICAgIGRpYWdvbmFsR3VpZGVzTm9kZSxcclxuICAgICAgdGhpcy5xdWFkcmlsYXRlcmFsTm9kZSxcclxuICAgICAgaW50ZXJhY3Rpb25DdWVOb2RlLFxyXG4gICAgICBkZWJ1Z1ZhbHVlc1BhbmVsLFxyXG5cclxuICAgICAgLy8gY29udHJvbHNcclxuICAgICAgdmlzaWJpbGl0eUNvbnRyb2xzLFxyXG4gICAgICBzbWFsbFN0ZXBzTG9ja1RvZ2dsZUJ1dHRvbixcclxuICAgICAgcmVzZXRBbGxCdXR0b24sXHJcbiAgICAgIHNoYXBlU291bmRzQ2hlY2tib3gsXHJcbiAgICAgIHNoYXBlTmFtZURpc3BsYXksXHJcbiAgICAgIHJlc2V0U2hhcGVCdXR0b24sXHJcbiAgICAgIGRldmljZUNvbm5lY3Rpb25QYXJlbnROb2RlXHJcbiAgICBdO1xyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBMYXlvdXQgLSBhbGwgcmVsYXRpdmUgdG8gdGhlIGdyaWQgc3BhY2Ugb2YgdGhlIHF1YWRyaWxhdGVyYWwgYmVjYXVzZSBpdHMgc2l6ZSBhbmQgcG9zaXRpb24gaXMgZGV0ZXJtaW5lZCBieVxyXG4gICAgLy8gdGhlIG1vZGVsVmlld1RyYW5zZm9ybVxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIHJlc2V0QWxsQnV0dG9uLmxlZnRCb3R0b20gPSBuZXcgVmVjdG9yMihcclxuICAgICAgZ3JpZE5vZGUucmlnaHQgKyBRdWFkcmlsYXRlcmFsQ29uc3RhbnRzLlZJRVdfU1BBQ0lORyxcclxuICAgICAgdGhpcy5sYXlvdXRCb3VuZHMubWF4WSAtIFF1YWRyaWxhdGVyYWxDb25zdGFudHMuU0NSRUVOX1ZJRVdfWV9NQVJHSU5cclxuICAgICk7XHJcbiAgICBzbWFsbFN0ZXBzTG9ja1RvZ2dsZUJ1dHRvbi5sZWZ0Qm90dG9tID0gcmVzZXRBbGxCdXR0b24ubGVmdFRvcC5taW51c1hZKCAwLCBRdWFkcmlsYXRlcmFsQ29uc3RhbnRzLlZJRVdfR1JPVVBfU1BBQ0lORyApO1xyXG4gICAgdmlzaWJpbGl0eUNvbnRyb2xzLmxlZnRDZW50ZXIgPSBncmlkTm9kZS5yaWdodENlbnRlci5wbHVzWFkoIFF1YWRyaWxhdGVyYWxDb25zdGFudHMuVklFV19TUEFDSU5HLCAwICk7XHJcblxyXG4gICAgc2hhcGVOYW1lRGlzcGxheS5jZW50ZXJCb3R0b20gPSBncmlkTm9kZS5jZW50ZXJUb3AubWludXNYWSggMCwgUXVhZHJpbGF0ZXJhbENvbnN0YW50cy5WSUVXX1NQQUNJTkcgKTtcclxuICAgIHNoYXBlU291bmRzQ2hlY2tib3gucmlnaHRDZW50ZXIgPSBuZXcgVmVjdG9yMiggZ3JpZE5vZGUucmlnaHQsIHNoYXBlTmFtZURpc3BsYXkuY2VudGVyWSApO1xyXG5cclxuICAgIC8vIGR5bmFtaWMgc3RyaW5nIGxheW91dFxyXG4gICAgcmVzZXRTaGFwZUJ1dHRvbi5ib3VuZHNQcm9wZXJ0eS5saW5rKCAoKSA9PiB7XHJcbiAgICAgIHJlc2V0U2hhcGVCdXR0b24ucmlnaHRDZW50ZXIgPSBzaGFwZVNvdW5kc0NoZWNrYm94LmxlZnRDZW50ZXIubWludXNYWShcclxuICAgICAgICAvLyBlZmZlY3RpdmVseSBjZW50ZXJzIHRoaXMgYnV0dG9uIGJldHdlZW4gdGhlIG90aGVyIG5hbWUgZGlzcGxheSBjb250cm9sc1xyXG4gICAgICAgICggc2hhcGVTb3VuZHNDaGVja2JveC5sZWZ0IC0gc2hhcGVOYW1lRGlzcGxheS5yaWdodCAtIHJlc2V0U2hhcGVCdXR0b24ud2lkdGggKSAvIDIsIDBcclxuICAgICAgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBkZXZpY2VDb25uZWN0aW9uUGFyZW50Tm9kZS5sZWZ0Qm90dG9tID0gdmlzaWJpbGl0eUNvbnRyb2xzLmxlZnRUb3AubWludXNYWSggMCwgUXVhZHJpbGF0ZXJhbENvbnN0YW50cy5WSUVXX0dST1VQX1NQQUNJTkcgKTtcclxuXHJcbiAgICBkZWJ1Z1ZhbHVlc1BhbmVsLmxlZnRUb3AgPSBncmlkTm9kZS5sZWZ0VG9wLnBsdXNYWSggNSwgNSApO1xyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBUcmF2ZXJzYWwgb3JkZXJcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICB0aGlzLnBkb21QbGF5QXJlYU5vZGUucGRvbU9yZGVyID0gWyB0aGlzLnF1YWRyaWxhdGVyYWxOb2RlLCBzaGFwZU5hbWVEaXNwbGF5LCByZXNldFNoYXBlQnV0dG9uLCBzaGFwZVNvdW5kc0NoZWNrYm94IF07XHJcbiAgICB0aGlzLnBkb21Db250cm9sQXJlYU5vZGUucGRvbU9yZGVyID0gWyB2aXNpYmlsaXR5Q29udHJvbHMsIHNtYWxsU3RlcHNMb2NrVG9nZ2xlQnV0dG9uLCByZXNldEFsbEJ1dHRvbiwgZGV2aWNlQ29ubmVjdGlvblBhcmVudE5vZGUgXTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgY29udGVudCB0aGF0IGlzIHNwb2tlbiBmcm9tIHRoZSBWb2ljaW5nIHRvb2xiYXIgdG8gZGVzY3JpYmUgdGhpcyBTY3JlZW5WaWV3LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBnZXRWb2ljaW5nT3ZlcnZpZXdDb250ZW50KCk6IFNwZWFrYWJsZVJlc29sdmVkUmVzcG9uc2Uge1xyXG4gICAgcmV0dXJuIFF1YWRyaWxhdGVyYWxTdHJpbmdzLmExMXkudm9pY2luZy5vdmVydmlld0NvbnRlbnRTdHJpbmdQcm9wZXJ0eTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgZGV0YWlscyBjb250ZW50IHRoYXQgaXMgc3Bva2VuIGZyb20gdGhlIFZvaWNpbmcgdG9vbGJhciB0byBkZXNjcmliZSBkZXRhaWxzIGFib3V0IHRoZSBzaW11bGF0aW9uLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBnZXRWb2ljaW5nRGV0YWlsc0NvbnRlbnQoKTogU3BlYWthYmxlUmVzb2x2ZWRSZXNwb25zZSB7XHJcbiAgICBjb25zdCBmaXJzdFN0YXRlbWVudCA9IHRoaXMucXVhZHJpbGF0ZXJhbERlc2NyaWJlci5nZXRGaXJzdERldGFpbHNTdGF0ZW1lbnQoKTtcclxuICAgIGNvbnN0IHNlY29uZFN0YXRlbWVudCA9IHRoaXMucXVhZHJpbGF0ZXJhbERlc2NyaWJlci5nZXRTZWNvbmREZXRhaWxzU3RhdGVtZW50KCk7XHJcbiAgICBjb25zdCB0aGlyZFN0YXRlbWVudCA9IHRoaXMucXVhZHJpbGF0ZXJhbERlc2NyaWJlci5nZXRUaGlyZERldGFpbHNTdGF0ZW1lbnQoKTtcclxuICAgIGNvbnN0IGZvdXJ0aFN0YXRlbWVudCA9IHRoaXMucXVhZHJpbGF0ZXJhbERlc2NyaWJlci5nZXRGb3VydGhEZXRhaWxzU3RhdGVtZW50KCk7XHJcbiAgICBjb25zdCBmaWZ0aFN0YXRlbWVudCA9IHRoaXMucXVhZHJpbGF0ZXJhbERlc2NyaWJlci5nZXRGaWZ0aERldGFpbHNTdGF0ZW1lbnQoKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZpcnN0U3RhdGVtZW50LCAndGhlcmUgc2hvdWxkIGFsd2F5cyBiZSBhIGZpcnN0IHN0YXRlbWVudCBmb3IgZGV0YWlscycgKTtcclxuXHJcbiAgICBsZXQgY29udGVudFN0cmluZyA9IGZpcnN0U3RhdGVtZW50O1xyXG5cclxuICAgIC8vIEFwcGVuZCByZW1haW5pbmcgc3RhdGVtZW50cywgaWYgdGhleSBleGlzdCB3aXRoIGN1cnJlbnQgc2ltIHN0YXRlLlxyXG4gICAgLy8gTk9URTogVGhpcyBpcyBiYWQgZm9yIGkxOG4gYnV0IFBoRVQgZGVjaWRlZCB0aGF0IGlzIE9LIGZvciBub3cuXHJcbiAgICBjb25zdCByZW1haW5pbmdTdGF0ZW1lbnRzID0gWyBzZWNvbmRTdGF0ZW1lbnQsIHRoaXJkU3RhdGVtZW50LCBmb3VydGhTdGF0ZW1lbnQsIGZpZnRoU3RhdGVtZW50IF07XHJcbiAgICByZW1haW5pbmdTdGF0ZW1lbnRzLmZvckVhY2goIHN0YXRlbWVudCA9PiB7XHJcbiAgICAgIGlmICggc3RhdGVtZW50ICkge1xyXG5cclxuICAgICAgICAvLyBpMThuIG5vdCBzdXBwb3J0ZWQsIGJ1dCBzdGF0ZW1lbnRzIG1pZ2h0IGJlIGEgc3RyaW5nIFByb3BlcnR5XHJcbiAgICAgICAgY29uc3QgdmFsdWVTdHJpbmcgPSB0eXBlb2Ygc3RhdGVtZW50ID09PSAnc3RyaW5nJyA/IHN0YXRlbWVudCA6IHN0YXRlbWVudC52YWx1ZTtcclxuICAgICAgICBjb250ZW50U3RyaW5nICs9ICcgJyArIHZhbHVlU3RyaW5nO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgcmV0dXJuIGNvbnRlbnRTdHJpbmc7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIGNvbnRlbnQgdGhhdCBpcyBzcG9rZW4gZnJvbSB0aGUgVm9pY2luZyB0b29sYmFyIHRvIGRlc2NyaWJlIHRoaXMgU2NyZWVuVmlldy4gSW4gdGhpcyBzaW0gd2UgdXNlIHRoZSBoaW50XHJcbiAgICogYnV0dG9uIHRvIGRlc2NyaWJlIHRoZSBwYXJhbGxlbG9ncmFtIHN0YXRlIGFuZCBzaGFwZSBuYW1lIG9mIHRoZSBxdWFkcmlsYXRlcmFsLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBnZXRWb2ljaW5nSGludENvbnRlbnQoKTogU3BlYWthYmxlUmVzb2x2ZWRSZXNwb25zZSB7XHJcbiAgICByZXR1cm4gUXVhZHJpbGF0ZXJhbFN0cmluZ3MuYTExeS52b2ljaW5nLmhpbnRDb250ZW50U3RyaW5nUHJvcGVydHk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdGVwcyB0aGUgdmlldy5cclxuICAgKiBAcGFyYW0gZHQgLSB0aW1lIHN0ZXAsIGluIHNlY29uZHNcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgc3RlcCggZHQ6IG51bWJlciApOiB2b2lkIHtcclxuICAgIGlmICggdGhpcy5xdWFkcmlsYXRlcmFsU291bmRWaWV3ICkge1xyXG4gICAgICB0aGlzLnF1YWRyaWxhdGVyYWxTb3VuZFZpZXcuc3RlcCggZHQgKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnF1YWRyaWxhdGVyYWxNZWRpYVBpcGUgJiYgdGhpcy5xdWFkcmlsYXRlcmFsTWVkaWFQaXBlLnN0ZXAoIGR0ICk7XHJcblxyXG4gICAgdGhpcy5xdWFkcmlsYXRlcmFsTm9kZSAmJiB0aGlzLnF1YWRyaWxhdGVyYWxOb2RlLnN0ZXAoIGR0ICk7XHJcbiAgfVxyXG59XHJcblxyXG5xdWFkcmlsYXRlcmFsLnJlZ2lzdGVyKCAnUXVhZHJpbGF0ZXJhbFNjcmVlblZpZXcnLCBRdWFkcmlsYXRlcmFsU2NyZWVuVmlldyApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsVUFBVSxNQUFNLG9DQUFvQztBQUUzRCxPQUFPQyxjQUFjLE1BQU0sdURBQXVEO0FBRWxGLE9BQU9DLHNCQUFzQixNQUFNLGlDQUFpQztBQUNwRSxPQUFPQyxhQUFhLE1BQU0sd0JBQXdCO0FBRWxELFNBQVNDLElBQUksUUFBUSxtQ0FBbUM7QUFDeEQsT0FBT0MsNEJBQTRCLE1BQU0sb0NBQW9DO0FBQzdFLE9BQU9DLGlCQUFpQixNQUFNLHdCQUF3QjtBQUN0RCxPQUFPQyxzQkFBc0IsTUFBTSxtQ0FBbUM7QUFDdEUsT0FBT0Msb0JBQW9CLE1BQU0sK0JBQStCO0FBQ2hFLE9BQU9DLHNCQUFzQixNQUFNLDZCQUE2QjtBQUNoRSxPQUFPQywyQkFBMkIsTUFBTSxrQ0FBa0M7QUFDMUUsT0FBT0MsK0JBQStCLE1BQU0sc0NBQXNDO0FBQ2xGLE9BQU9DLHFCQUFxQixNQUFNLDRCQUE0QjtBQUM5RCxPQUFPQyxvQkFBb0IsTUFBTSwyQkFBMkI7QUFFNUQsT0FBT0Msc0JBQXNCLE1BQU0sdUNBQXVDO0FBQzFF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