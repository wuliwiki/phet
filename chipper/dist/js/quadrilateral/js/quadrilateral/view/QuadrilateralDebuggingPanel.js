// Copyright 2022-2023, University of Colorado Boulder
/* eslint-disable @typescript-eslint/dot-notation */

/**
 * A panel that displays model values for debugging. For debugging only.
 *
 * Note - to access some otherwise private class variables this uses square bracket notation.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import quadrilateral from '../../quadrilateral.js';
import { Node, Rectangle, Text, VBox } from '../../../../scenery/js/imports.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import Utils from '../../../../dot/js/Utils.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Range from '../../../../dot/js/Range.js';
import NumberControl from '../../../../scenery-phet/js/NumberControl.js';
import Multilink from '../../../../axon/js/Multilink.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import { combineOptions } from '../../../../phet-core/js/optionize.js';

// constants
const TEXT_OPTIONS = {
  fontSize: 16
};
const VALUE_PATTERN_STRING = '{{label}}: {{value}}';
const VALUE_WITH_DEGREES_PATTERN_STRING = '{{label}}: {{value}} ({{degrees}} degrees)';
const CONTENT_PADDING = 10;
const VBOX_OPTIONS = {
  align: 'left'
};
export default class QuadrilateralDebuggingPanel extends Node {
  constructor(model, providedOptions) {
    // Length readouts
    const sideABLengthText = new Text('', TEXT_OPTIONS);
    const sideBCLengthText = new Text('', TEXT_OPTIONS);
    const sideCDLengthText = new Text('', TEXT_OPTIONS);
    const sideDALengthText = new Text('', TEXT_OPTIONS);
    const lengthBox = new VBox(combineOptions({
      children: [sideABLengthText, sideBCLengthText, sideCDLengthText, sideDALengthText]
    }, VBOX_OPTIONS));

    // Angle readouts
    const cornerAAngleText = new Text('', TEXT_OPTIONS);
    const cornerBAngleText = new Text('', TEXT_OPTIONS);
    const cornerCAngleText = new Text('', TEXT_OPTIONS);
    const cornerDAngleText = new Text('', TEXT_OPTIONS);
    const angleBox = new VBox(combineOptions({
      children: [cornerAAngleText, cornerBAngleText, cornerCAngleText, cornerDAngleText]
    }, VBOX_OPTIONS));

    // parallelogram and parallel sides readout
    const isParallelogramText = new Text('', TEXT_OPTIONS);
    const sideABCDParallelText = new Text('', TEXT_OPTIONS);
    const sideBCDAParallelText = new Text('', TEXT_OPTIONS);
    const parallelogramBox = new VBox(combineOptions({
      children: [isParallelogramText, sideABCDParallelText, sideBCDAParallelText]
    }, VBOX_OPTIONS));

    // tolerance intervals readout - these will not change after startup
    const sideABCDToleranceIntervalText = new Text(QuadrilateralDebuggingPanel.fillInValuePattern('(AB, CD) parallelAngleToleranceInterval', model.quadrilateralShapeModel.parallelSideCheckers[0]['parallelAngleToleranceInterval']), TEXT_OPTIONS);
    const sideBCDAToleranceIntervalText = new Text(QuadrilateralDebuggingPanel.fillInValuePattern('(BC, DA) parallelAngleToleranceInterval', model.quadrilateralShapeModel.parallelSideCheckers[1]['parallelAngleToleranceInterval']), TEXT_OPTIONS);
    const interAngleToleranceIntervalText = new Text(QuadrilateralDebuggingPanel.fillInValuePattern('interAngleToleranceInterval', model.quadrilateralShapeModel.interAngleToleranceInterval), TEXT_OPTIONS);
    const staticAngleToleranceIntervalText = new Text(QuadrilateralDebuggingPanel.fillInValuePattern('staticAngleToleranceInterval', model.quadrilateralShapeModel.staticAngleToleranceInterval), TEXT_OPTIONS);
    const shapeLengthToleranceIntervalText = new Text(QuadrilateralDebuggingPanel.fillInValuePattern('interLengthToleranceInterval', model.quadrilateralShapeModel.interLengthToleranceInterval), TEXT_OPTIONS);
    const toleranceIntervalBox = new VBox(combineOptions({
      children: [sideABCDToleranceIntervalText, sideBCDAToleranceIntervalText, interAngleToleranceIntervalText, staticAngleToleranceIntervalText, shapeLengthToleranceIntervalText]
    }, VBOX_OPTIONS));

    // shape name readout
    const shapeNameText = new Text('', TEXT_OPTIONS);

    // decimal places readout
    const decimalPlacesProperty = new NumberProperty(3, {
      range: new Range(2, 5)
    });
    const decimalPlacesControl = new NumberControl('Decimal Places', decimalPlacesProperty, decimalPlacesProperty.range, {
      sliderOptions: {
        keyboardStep: 1,
        thumbSize: new Dimension2(10, 17)
      },
      // no tandems for debugging
      tandem: Tandem.OPT_OUT
    });
    const content = new VBox(combineOptions({
      children: [lengthBox, angleBox, parallelogramBox, toleranceIntervalBox, shapeNameText, decimalPlacesControl],
      spacing: 15
    }, VBOX_OPTIONS));
    const backgroundRectangle = new Rectangle(0, 0, 400, content.height + CONTENT_PADDING, 5, 5, {
      fill: 'white'
    });
    content.leftTop = backgroundRectangle.leftTop.plusXY(CONTENT_PADDING / 2, CONTENT_PADDING / 2);
    super({
      children: [backgroundRectangle, content],
      // panel is see-through so that the shape can move and be dragged under it
      opacity: 0.7
    });

    // mutate after defaults (mostly children for bounds) have been set
    this.mutate(providedOptions);

    // Link to the model to print the values
    // length
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.sideAB.lengthProperty, sideABLengthText, 'Side AB', decimalPlacesProperty);
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.sideBC.lengthProperty, sideBCLengthText, 'Side BC', decimalPlacesProperty);
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.sideCD.lengthProperty, sideCDLengthText, 'Side CD', decimalPlacesProperty);
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.sideDA.lengthProperty, sideDALengthText, 'Side DA', decimalPlacesProperty);

    // angle
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.vertexA.angleProperty, cornerAAngleText, 'Corner A', decimalPlacesProperty, true);
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.vertexB.angleProperty, cornerBAngleText, 'Corner B', decimalPlacesProperty, true);
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.vertexC.angleProperty, cornerCAngleText, 'Corner C', decimalPlacesProperty, true);
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.vertexD.angleProperty, cornerDAngleText, 'Corner D', decimalPlacesProperty, true);

    // parallelogram and parallel sides
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.parallelSideCheckers[0]['isParallelProperty'], sideABCDParallelText, '(AB, CD) parallel', decimalPlacesProperty);
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.parallelSideCheckers[1]['isParallelProperty'], sideBCDAParallelText, '(BC, DA) parallel', decimalPlacesProperty);

    // shape name
    QuadrilateralDebuggingPanel.addRedrawValueTextListener(model.quadrilateralShapeModel.shapeNameProperty, shapeNameText, 'shape name', decimalPlacesProperty);
  }

  /**
   * Adds listeners to the Property and decimalPlacesProperty to update debugging text when values change.
   *
   * I could not figure out the typing for the Multilink. Type for property arg is
   * type DebuggableProperty = TReadOnlyProperty<number | null> | TReadOnlyProperty<boolean> | TReadOnlyProperty<NamedQuadrilateral>;
   *
   * After 10 minutes of tinkering with types I decided it wasn't worth figuring out for this debugging code.
   *
   * @param property - the Property whose value you want to watch
   * @param text - Text instance to update
   * @param label - a label for the value we are watching
   * @param decimalPlacesProperty - controls precision of values
   * @param showDegrees - If the value would be helpful to also show in degrees for debugging, set to true
   */
  static addRedrawValueTextListener(property, text, label, decimalPlacesProperty, showDegrees = false) {
    Multilink.multilink([property, decimalPlacesProperty], (value, decimalPlaces) => {
      let formattedValue = value;

      // if a number, trim so that it is easier to read
      if (typeof value === 'number') {
        formattedValue = Utils.toFixedNumber(value, decimalPlaces);
      }
      if (showDegrees) {
        // just show two decimals instead of the number of decimals shown to avoid confusion with tolerance intervals
        // which are in radians
        const formattedDegrees = Utils.toFixedNumber(Utils.toDegrees(value), 2);
        text.string = StringUtils.fillIn(VALUE_WITH_DEGREES_PATTERN_STRING, {
          value: formattedValue,
          degrees: formattedDegrees,
          label: label
        });
      } else {
        text.string = QuadrilateralDebuggingPanel.fillInValuePattern(label, formattedValue);
      }
    });
  }

  /**
   * Uses string utils to format a label and value for the debugging panel.
   */
  static fillInValuePattern(label, value) {
    return StringUtils.fillIn(VALUE_PATTERN_STRING, {
      value: value,
      label: label
    });
  }
}
quadrilateral.register('QuadrilateralDebuggingPanel', QuadrilateralDebuggingPanel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJxdWFkcmlsYXRlcmFsIiwiTm9kZSIsIlJlY3RhbmdsZSIsIlRleHQiLCJWQm94IiwiU3RyaW5nVXRpbHMiLCJVdGlscyIsIk51bWJlclByb3BlcnR5IiwiUmFuZ2UiLCJOdW1iZXJDb250cm9sIiwiTXVsdGlsaW5rIiwiRGltZW5zaW9uMiIsIlRhbmRlbSIsImNvbWJpbmVPcHRpb25zIiwiVEVYVF9PUFRJT05TIiwiZm9udFNpemUiLCJWQUxVRV9QQVRURVJOX1NUUklORyIsIlZBTFVFX1dJVEhfREVHUkVFU19QQVRURVJOX1NUUklORyIsIkNPTlRFTlRfUEFERElORyIsIlZCT1hfT1BUSU9OUyIsImFsaWduIiwiUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsIiwiY29uc3RydWN0b3IiLCJtb2RlbCIsInByb3ZpZGVkT3B0aW9ucyIsInNpZGVBQkxlbmd0aFRleHQiLCJzaWRlQkNMZW5ndGhUZXh0Iiwic2lkZUNETGVuZ3RoVGV4dCIsInNpZGVEQUxlbmd0aFRleHQiLCJsZW5ndGhCb3giLCJjaGlsZHJlbiIsImNvcm5lckFBbmdsZVRleHQiLCJjb3JuZXJCQW5nbGVUZXh0IiwiY29ybmVyQ0FuZ2xlVGV4dCIsImNvcm5lckRBbmdsZVRleHQiLCJhbmdsZUJveCIsImlzUGFyYWxsZWxvZ3JhbVRleHQiLCJzaWRlQUJDRFBhcmFsbGVsVGV4dCIsInNpZGVCQ0RBUGFyYWxsZWxUZXh0IiwicGFyYWxsZWxvZ3JhbUJveCIsInNpZGVBQkNEVG9sZXJhbmNlSW50ZXJ2YWxUZXh0IiwiZmlsbEluVmFsdWVQYXR0ZXJuIiwicXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwiLCJwYXJhbGxlbFNpZGVDaGVja2VycyIsInNpZGVCQ0RBVG9sZXJhbmNlSW50ZXJ2YWxUZXh0IiwiaW50ZXJBbmdsZVRvbGVyYW5jZUludGVydmFsVGV4dCIsImludGVyQW5nbGVUb2xlcmFuY2VJbnRlcnZhbCIsInN0YXRpY0FuZ2xlVG9sZXJhbmNlSW50ZXJ2YWxUZXh0Iiwic3RhdGljQW5nbGVUb2xlcmFuY2VJbnRlcnZhbCIsInNoYXBlTGVuZ3RoVG9sZXJhbmNlSW50ZXJ2YWxUZXh0IiwiaW50ZXJMZW5ndGhUb2xlcmFuY2VJbnRlcnZhbCIsInRvbGVyYW5jZUludGVydmFsQm94Iiwic2hhcGVOYW1lVGV4dCIsImRlY2ltYWxQbGFjZXNQcm9wZXJ0eSIsInJhbmdlIiwiZGVjaW1hbFBsYWNlc0NvbnRyb2wiLCJzbGlkZXJPcHRpb25zIiwia2V5Ym9hcmRTdGVwIiwidGh1bWJTaXplIiwidGFuZGVtIiwiT1BUX09VVCIsImNvbnRlbnQiLCJzcGFjaW5nIiwiYmFja2dyb3VuZFJlY3RhbmdsZSIsImhlaWdodCIsImZpbGwiLCJsZWZ0VG9wIiwicGx1c1hZIiwib3BhY2l0eSIsIm11dGF0ZSIsImFkZFJlZHJhd1ZhbHVlVGV4dExpc3RlbmVyIiwic2lkZUFCIiwibGVuZ3RoUHJvcGVydHkiLCJzaWRlQkMiLCJzaWRlQ0QiLCJzaWRlREEiLCJ2ZXJ0ZXhBIiwiYW5nbGVQcm9wZXJ0eSIsInZlcnRleEIiLCJ2ZXJ0ZXhDIiwidmVydGV4RCIsInNoYXBlTmFtZVByb3BlcnR5IiwicHJvcGVydHkiLCJ0ZXh0IiwibGFiZWwiLCJzaG93RGVncmVlcyIsIm11bHRpbGluayIsInZhbHVlIiwiZGVjaW1hbFBsYWNlcyIsImZvcm1hdHRlZFZhbHVlIiwidG9GaXhlZE51bWJlciIsImZvcm1hdHRlZERlZ3JlZXMiLCJ0b0RlZ3JlZXMiLCJzdHJpbmciLCJmaWxsSW4iLCJkZWdyZWVzIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjItMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9kb3Qtbm90YXRpb24gKi9cclxuXHJcbi8qKlxyXG4gKiBBIHBhbmVsIHRoYXQgZGlzcGxheXMgbW9kZWwgdmFsdWVzIGZvciBkZWJ1Z2dpbmcuIEZvciBkZWJ1Z2dpbmcgb25seS5cclxuICpcclxuICogTm90ZSAtIHRvIGFjY2VzcyBzb21lIG90aGVyd2lzZSBwcml2YXRlIGNsYXNzIHZhcmlhYmxlcyB0aGlzIHVzZXMgc3F1YXJlIGJyYWNrZXQgbm90YXRpb24uXHJcbiAqXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBxdWFkcmlsYXRlcmFsIGZyb20gJy4uLy4uL3F1YWRyaWxhdGVyYWwuanMnO1xyXG5pbXBvcnQgUXVhZHJpbGF0ZXJhbE1vZGVsIGZyb20gJy4uL21vZGVsL1F1YWRyaWxhdGVyYWxNb2RlbC5qcyc7XHJcbmltcG9ydCB7IE5vZGUsIE5vZGVPcHRpb25zLCBSZWN0YW5nbGUsIFRleHQsIFZCb3gsIFZCb3hPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFN0cmluZ1V0aWxzIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdXRpbC9TdHJpbmdVdGlscy5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IE51bWJlckNvbnRyb2wgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL051bWJlckNvbnRyb2wuanMnO1xyXG5pbXBvcnQgTXVsdGlsaW5rIGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTXVsdGlsaW5rLmpzJztcclxuaW1wb3J0IEludGVudGlvbmFsQW55IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9JbnRlbnRpb25hbEFueS5qcyc7XHJcbmltcG9ydCBEaW1lbnNpb24yIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9EaW1lbnNpb24yLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IHsgY29tYmluZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBURVhUX09QVElPTlMgPSB7IGZvbnRTaXplOiAxNiB9O1xyXG5jb25zdCBWQUxVRV9QQVRURVJOX1NUUklORyA9ICd7e2xhYmVsfX06IHt7dmFsdWV9fSc7XHJcbmNvbnN0IFZBTFVFX1dJVEhfREVHUkVFU19QQVRURVJOX1NUUklORyA9ICd7e2xhYmVsfX06IHt7dmFsdWV9fSAoe3tkZWdyZWVzfX0gZGVncmVlcyknO1xyXG5jb25zdCBDT05URU5UX1BBRERJTkcgPSAxMDtcclxuY29uc3QgVkJPWF9PUFRJT05TOiBWQm94T3B0aW9ucyA9IHsgYWxpZ246ICdsZWZ0JyB9O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsIGV4dGVuZHMgTm9kZSB7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBtb2RlbDogUXVhZHJpbGF0ZXJhbE1vZGVsLCBwcm92aWRlZE9wdGlvbnM/OiBOb2RlT3B0aW9ucyApIHtcclxuXHJcbiAgICAvLyBMZW5ndGggcmVhZG91dHNcclxuICAgIGNvbnN0IHNpZGVBQkxlbmd0aFRleHQgPSBuZXcgVGV4dCggJycsIFRFWFRfT1BUSU9OUyApO1xyXG4gICAgY29uc3Qgc2lkZUJDTGVuZ3RoVGV4dCA9IG5ldyBUZXh0KCAnJywgVEVYVF9PUFRJT05TICk7XHJcbiAgICBjb25zdCBzaWRlQ0RMZW5ndGhUZXh0ID0gbmV3IFRleHQoICcnLCBURVhUX09QVElPTlMgKTtcclxuICAgIGNvbnN0IHNpZGVEQUxlbmd0aFRleHQgPSBuZXcgVGV4dCggJycsIFRFWFRfT1BUSU9OUyApO1xyXG4gICAgY29uc3QgbGVuZ3RoQm94ID0gbmV3IFZCb3goIGNvbWJpbmVPcHRpb25zPFZCb3hPcHRpb25zPigge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIHNpZGVBQkxlbmd0aFRleHQsXHJcbiAgICAgICAgc2lkZUJDTGVuZ3RoVGV4dCxcclxuICAgICAgICBzaWRlQ0RMZW5ndGhUZXh0LFxyXG4gICAgICAgIHNpZGVEQUxlbmd0aFRleHRcclxuICAgICAgXVxyXG4gICAgfSwgVkJPWF9PUFRJT05TICkgKTtcclxuXHJcbiAgICAvLyBBbmdsZSByZWFkb3V0c1xyXG4gICAgY29uc3QgY29ybmVyQUFuZ2xlVGV4dCA9IG5ldyBUZXh0KCAnJywgVEVYVF9PUFRJT05TICk7XHJcbiAgICBjb25zdCBjb3JuZXJCQW5nbGVUZXh0ID0gbmV3IFRleHQoICcnLCBURVhUX09QVElPTlMgKTtcclxuICAgIGNvbnN0IGNvcm5lckNBbmdsZVRleHQgPSBuZXcgVGV4dCggJycsIFRFWFRfT1BUSU9OUyApO1xyXG4gICAgY29uc3QgY29ybmVyREFuZ2xlVGV4dCA9IG5ldyBUZXh0KCAnJywgVEVYVF9PUFRJT05TICk7XHJcbiAgICBjb25zdCBhbmdsZUJveCA9IG5ldyBWQm94KCBjb21iaW5lT3B0aW9uczxWQm94T3B0aW9ucz4oIHtcclxuICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICBjb3JuZXJBQW5nbGVUZXh0LFxyXG4gICAgICAgIGNvcm5lckJBbmdsZVRleHQsXHJcbiAgICAgICAgY29ybmVyQ0FuZ2xlVGV4dCxcclxuICAgICAgICBjb3JuZXJEQW5nbGVUZXh0XHJcbiAgICAgIF1cclxuICAgIH0sIFZCT1hfT1BUSU9OUyApICk7XHJcblxyXG4gICAgLy8gcGFyYWxsZWxvZ3JhbSBhbmQgcGFyYWxsZWwgc2lkZXMgcmVhZG91dFxyXG4gICAgY29uc3QgaXNQYXJhbGxlbG9ncmFtVGV4dCA9IG5ldyBUZXh0KCAnJywgVEVYVF9PUFRJT05TICk7XHJcbiAgICBjb25zdCBzaWRlQUJDRFBhcmFsbGVsVGV4dCA9IG5ldyBUZXh0KCAnJywgVEVYVF9PUFRJT05TICk7XHJcbiAgICBjb25zdCBzaWRlQkNEQVBhcmFsbGVsVGV4dCA9IG5ldyBUZXh0KCAnJywgVEVYVF9PUFRJT05TICk7XHJcbiAgICBjb25zdCBwYXJhbGxlbG9ncmFtQm94ID0gbmV3IFZCb3goIGNvbWJpbmVPcHRpb25zPFZCb3hPcHRpb25zPigge1xyXG4gICAgICBjaGlsZHJlbjogWyBpc1BhcmFsbGVsb2dyYW1UZXh0LCBzaWRlQUJDRFBhcmFsbGVsVGV4dCwgc2lkZUJDREFQYXJhbGxlbFRleHQgXVxyXG4gICAgfSwgVkJPWF9PUFRJT05TICkgKTtcclxuXHJcbiAgICAvLyB0b2xlcmFuY2UgaW50ZXJ2YWxzIHJlYWRvdXQgLSB0aGVzZSB3aWxsIG5vdCBjaGFuZ2UgYWZ0ZXIgc3RhcnR1cFxyXG4gICAgY29uc3Qgc2lkZUFCQ0RUb2xlcmFuY2VJbnRlcnZhbFRleHQgPSBuZXcgVGV4dChcclxuICAgICAgUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsLmZpbGxJblZhbHVlUGF0dGVybiggJyhBQiwgQ0QpIHBhcmFsbGVsQW5nbGVUb2xlcmFuY2VJbnRlcnZhbCcsIG1vZGVsLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLnBhcmFsbGVsU2lkZUNoZWNrZXJzWyAwIF1bICdwYXJhbGxlbEFuZ2xlVG9sZXJhbmNlSW50ZXJ2YWwnIF0gKSxcclxuICAgICAgVEVYVF9PUFRJT05TXHJcbiAgICApO1xyXG4gICAgY29uc3Qgc2lkZUJDREFUb2xlcmFuY2VJbnRlcnZhbFRleHQgPSBuZXcgVGV4dChcclxuICAgICAgUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsLmZpbGxJblZhbHVlUGF0dGVybiggJyhCQywgREEpIHBhcmFsbGVsQW5nbGVUb2xlcmFuY2VJbnRlcnZhbCcsIG1vZGVsLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLnBhcmFsbGVsU2lkZUNoZWNrZXJzWyAxIF1bICdwYXJhbGxlbEFuZ2xlVG9sZXJhbmNlSW50ZXJ2YWwnIF0gKSxcclxuICAgICAgVEVYVF9PUFRJT05TXHJcbiAgICApO1xyXG4gICAgY29uc3QgaW50ZXJBbmdsZVRvbGVyYW5jZUludGVydmFsVGV4dCA9IG5ldyBUZXh0KFxyXG4gICAgICBRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwuZmlsbEluVmFsdWVQYXR0ZXJuKCAnaW50ZXJBbmdsZVRvbGVyYW5jZUludGVydmFsJywgbW9kZWwucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwuaW50ZXJBbmdsZVRvbGVyYW5jZUludGVydmFsICksXHJcbiAgICAgIFRFWFRfT1BUSU9OU1xyXG4gICAgKTtcclxuICAgIGNvbnN0IHN0YXRpY0FuZ2xlVG9sZXJhbmNlSW50ZXJ2YWxUZXh0ID0gbmV3IFRleHQoXHJcbiAgICAgIFF1YWRyaWxhdGVyYWxEZWJ1Z2dpbmdQYW5lbC5maWxsSW5WYWx1ZVBhdHRlcm4oICdzdGF0aWNBbmdsZVRvbGVyYW5jZUludGVydmFsJywgbW9kZWwucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwuc3RhdGljQW5nbGVUb2xlcmFuY2VJbnRlcnZhbCApLFxyXG4gICAgICBURVhUX09QVElPTlNcclxuICAgICk7XHJcbiAgICBjb25zdCBzaGFwZUxlbmd0aFRvbGVyYW5jZUludGVydmFsVGV4dCA9IG5ldyBUZXh0KFxyXG4gICAgICBRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwuZmlsbEluVmFsdWVQYXR0ZXJuKCAnaW50ZXJMZW5ndGhUb2xlcmFuY2VJbnRlcnZhbCcsIG1vZGVsLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLmludGVyTGVuZ3RoVG9sZXJhbmNlSW50ZXJ2YWwgKSxcclxuICAgICAgVEVYVF9PUFRJT05TXHJcbiAgICApO1xyXG4gICAgY29uc3QgdG9sZXJhbmNlSW50ZXJ2YWxCb3ggPSBuZXcgVkJveCggY29tYmluZU9wdGlvbnM8VkJveE9wdGlvbnM+KCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIHNpZGVBQkNEVG9sZXJhbmNlSW50ZXJ2YWxUZXh0LCBzaWRlQkNEQVRvbGVyYW5jZUludGVydmFsVGV4dCwgaW50ZXJBbmdsZVRvbGVyYW5jZUludGVydmFsVGV4dCwgc3RhdGljQW5nbGVUb2xlcmFuY2VJbnRlcnZhbFRleHQsIHNoYXBlTGVuZ3RoVG9sZXJhbmNlSW50ZXJ2YWxUZXh0IF1cclxuICAgIH0sIFZCT1hfT1BUSU9OUyApICk7XHJcblxyXG4gICAgLy8gc2hhcGUgbmFtZSByZWFkb3V0XHJcbiAgICBjb25zdCBzaGFwZU5hbWVUZXh0ID0gbmV3IFRleHQoICcnLCBURVhUX09QVElPTlMgKTtcclxuXHJcbiAgICAvLyBkZWNpbWFsIHBsYWNlcyByZWFkb3V0XHJcbiAgICBjb25zdCBkZWNpbWFsUGxhY2VzUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIDMsIHsgcmFuZ2U6IG5ldyBSYW5nZSggMiwgNSApIH0gKTtcclxuICAgIGNvbnN0IGRlY2ltYWxQbGFjZXNDb250cm9sID0gbmV3IE51bWJlckNvbnRyb2woICdEZWNpbWFsIFBsYWNlcycsIGRlY2ltYWxQbGFjZXNQcm9wZXJ0eSwgZGVjaW1hbFBsYWNlc1Byb3BlcnR5LnJhbmdlLCB7XHJcbiAgICAgIHNsaWRlck9wdGlvbnM6IHtcclxuICAgICAgICBrZXlib2FyZFN0ZXA6IDEsXHJcbiAgICAgICAgdGh1bWJTaXplOiBuZXcgRGltZW5zaW9uMiggMTAsIDE3IClcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIG5vIHRhbmRlbXMgZm9yIGRlYnVnZ2luZ1xyXG4gICAgICB0YW5kZW06IFRhbmRlbS5PUFRfT1VUXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgY29udGVudCA9IG5ldyBWQm94KCBjb21iaW5lT3B0aW9uczxWQm94T3B0aW9ucz4oIHtcclxuICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICBsZW5ndGhCb3gsXHJcbiAgICAgICAgYW5nbGVCb3gsXHJcbiAgICAgICAgcGFyYWxsZWxvZ3JhbUJveCxcclxuICAgICAgICB0b2xlcmFuY2VJbnRlcnZhbEJveCxcclxuICAgICAgICBzaGFwZU5hbWVUZXh0LFxyXG4gICAgICAgIGRlY2ltYWxQbGFjZXNDb250cm9sXHJcbiAgICAgIF0sXHJcbiAgICAgIHNwYWNpbmc6IDE1XHJcbiAgICB9LCBWQk9YX09QVElPTlMgKSApO1xyXG5cclxuICAgIGNvbnN0IGJhY2tncm91bmRSZWN0YW5nbGUgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCA0MDAsIGNvbnRlbnQuaGVpZ2h0ICsgQ09OVEVOVF9QQURESU5HLCA1LCA1LCB7XHJcbiAgICAgIGZpbGw6ICd3aGl0ZSdcclxuICAgIH0gKTtcclxuICAgIGNvbnRlbnQubGVmdFRvcCA9IGJhY2tncm91bmRSZWN0YW5nbGUubGVmdFRvcC5wbHVzWFkoIENPTlRFTlRfUEFERElORyAvIDIsIENPTlRFTlRfUEFERElORyAvIDIgKTtcclxuXHJcbiAgICBzdXBlcigge1xyXG4gICAgICBjaGlsZHJlbjogWyBiYWNrZ3JvdW5kUmVjdGFuZ2xlLCBjb250ZW50IF0sXHJcblxyXG4gICAgICAvLyBwYW5lbCBpcyBzZWUtdGhyb3VnaCBzbyB0aGF0IHRoZSBzaGFwZSBjYW4gbW92ZSBhbmQgYmUgZHJhZ2dlZCB1bmRlciBpdFxyXG4gICAgICBvcGFjaXR5OiAwLjdcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBtdXRhdGUgYWZ0ZXIgZGVmYXVsdHMgKG1vc3RseSBjaGlsZHJlbiBmb3IgYm91bmRzKSBoYXZlIGJlZW4gc2V0XHJcbiAgICB0aGlzLm11dGF0ZSggcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gTGluayB0byB0aGUgbW9kZWwgdG8gcHJpbnQgdGhlIHZhbHVlc1xyXG4gICAgLy8gbGVuZ3RoXHJcbiAgICBRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwuYWRkUmVkcmF3VmFsdWVUZXh0TGlzdGVuZXIoIG1vZGVsLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLnNpZGVBQi5sZW5ndGhQcm9wZXJ0eSwgc2lkZUFCTGVuZ3RoVGV4dCwgJ1NpZGUgQUInLCBkZWNpbWFsUGxhY2VzUHJvcGVydHkgKTtcclxuICAgIFF1YWRyaWxhdGVyYWxEZWJ1Z2dpbmdQYW5lbC5hZGRSZWRyYXdWYWx1ZVRleHRMaXN0ZW5lciggbW9kZWwucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwuc2lkZUJDLmxlbmd0aFByb3BlcnR5LCBzaWRlQkNMZW5ndGhUZXh0LCAnU2lkZSBCQycsIGRlY2ltYWxQbGFjZXNQcm9wZXJ0eSApO1xyXG4gICAgUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsLmFkZFJlZHJhd1ZhbHVlVGV4dExpc3RlbmVyKCBtb2RlbC5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbC5zaWRlQ0QubGVuZ3RoUHJvcGVydHksIHNpZGVDRExlbmd0aFRleHQsICdTaWRlIENEJywgZGVjaW1hbFBsYWNlc1Byb3BlcnR5ICk7XHJcbiAgICBRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwuYWRkUmVkcmF3VmFsdWVUZXh0TGlzdGVuZXIoIG1vZGVsLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLnNpZGVEQS5sZW5ndGhQcm9wZXJ0eSwgc2lkZURBTGVuZ3RoVGV4dCwgJ1NpZGUgREEnLCBkZWNpbWFsUGxhY2VzUHJvcGVydHkgKTtcclxuXHJcbiAgICAvLyBhbmdsZVxyXG4gICAgUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsLmFkZFJlZHJhd1ZhbHVlVGV4dExpc3RlbmVyKCBtb2RlbC5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbC52ZXJ0ZXhBLmFuZ2xlUHJvcGVydHksIGNvcm5lckFBbmdsZVRleHQsICdDb3JuZXIgQScsIGRlY2ltYWxQbGFjZXNQcm9wZXJ0eSwgdHJ1ZSApO1xyXG4gICAgUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsLmFkZFJlZHJhd1ZhbHVlVGV4dExpc3RlbmVyKCBtb2RlbC5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbC52ZXJ0ZXhCLmFuZ2xlUHJvcGVydHksIGNvcm5lckJBbmdsZVRleHQsICdDb3JuZXIgQicsIGRlY2ltYWxQbGFjZXNQcm9wZXJ0eSwgdHJ1ZSApO1xyXG4gICAgUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsLmFkZFJlZHJhd1ZhbHVlVGV4dExpc3RlbmVyKCBtb2RlbC5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbC52ZXJ0ZXhDLmFuZ2xlUHJvcGVydHksIGNvcm5lckNBbmdsZVRleHQsICdDb3JuZXIgQycsIGRlY2ltYWxQbGFjZXNQcm9wZXJ0eSwgdHJ1ZSApO1xyXG4gICAgUXVhZHJpbGF0ZXJhbERlYnVnZ2luZ1BhbmVsLmFkZFJlZHJhd1ZhbHVlVGV4dExpc3RlbmVyKCBtb2RlbC5xdWFkcmlsYXRlcmFsU2hhcGVNb2RlbC52ZXJ0ZXhELmFuZ2xlUHJvcGVydHksIGNvcm5lckRBbmdsZVRleHQsICdDb3JuZXIgRCcsIGRlY2ltYWxQbGFjZXNQcm9wZXJ0eSwgdHJ1ZSApO1xyXG5cclxuICAgIC8vIHBhcmFsbGVsb2dyYW0gYW5kIHBhcmFsbGVsIHNpZGVzXHJcbiAgICBRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwuYWRkUmVkcmF3VmFsdWVUZXh0TGlzdGVuZXIoIG1vZGVsLnF1YWRyaWxhdGVyYWxTaGFwZU1vZGVsLnBhcmFsbGVsU2lkZUNoZWNrZXJzWyAwIF1bICdpc1BhcmFsbGVsUHJvcGVydHknIF0sIHNpZGVBQkNEUGFyYWxsZWxUZXh0LCAnKEFCLCBDRCkgcGFyYWxsZWwnLCBkZWNpbWFsUGxhY2VzUHJvcGVydHkgKTtcclxuICAgIFF1YWRyaWxhdGVyYWxEZWJ1Z2dpbmdQYW5lbC5hZGRSZWRyYXdWYWx1ZVRleHRMaXN0ZW5lciggbW9kZWwucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwucGFyYWxsZWxTaWRlQ2hlY2tlcnNbIDEgXVsgJ2lzUGFyYWxsZWxQcm9wZXJ0eScgXSwgc2lkZUJDREFQYXJhbGxlbFRleHQsICcoQkMsIERBKSBwYXJhbGxlbCcsIGRlY2ltYWxQbGFjZXNQcm9wZXJ0eSApO1xyXG5cclxuICAgIC8vIHNoYXBlIG5hbWVcclxuICAgIFF1YWRyaWxhdGVyYWxEZWJ1Z2dpbmdQYW5lbC5hZGRSZWRyYXdWYWx1ZVRleHRMaXN0ZW5lciggbW9kZWwucXVhZHJpbGF0ZXJhbFNoYXBlTW9kZWwuc2hhcGVOYW1lUHJvcGVydHksIHNoYXBlTmFtZVRleHQsICdzaGFwZSBuYW1lJywgZGVjaW1hbFBsYWNlc1Byb3BlcnR5ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBZGRzIGxpc3RlbmVycyB0byB0aGUgUHJvcGVydHkgYW5kIGRlY2ltYWxQbGFjZXNQcm9wZXJ0eSB0byB1cGRhdGUgZGVidWdnaW5nIHRleHQgd2hlbiB2YWx1ZXMgY2hhbmdlLlxyXG4gICAqXHJcbiAgICogSSBjb3VsZCBub3QgZmlndXJlIG91dCB0aGUgdHlwaW5nIGZvciB0aGUgTXVsdGlsaW5rLiBUeXBlIGZvciBwcm9wZXJ0eSBhcmcgaXNcclxuICAgKiB0eXBlIERlYnVnZ2FibGVQcm9wZXJ0eSA9IFRSZWFkT25seVByb3BlcnR5PG51bWJlciB8IG51bGw+IHwgVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj4gfCBUUmVhZE9ubHlQcm9wZXJ0eTxOYW1lZFF1YWRyaWxhdGVyYWw+O1xyXG4gICAqXHJcbiAgICogQWZ0ZXIgMTAgbWludXRlcyBvZiB0aW5rZXJpbmcgd2l0aCB0eXBlcyBJIGRlY2lkZWQgaXQgd2Fzbid0IHdvcnRoIGZpZ3VyaW5nIG91dCBmb3IgdGhpcyBkZWJ1Z2dpbmcgY29kZS5cclxuICAgKlxyXG4gICAqIEBwYXJhbSBwcm9wZXJ0eSAtIHRoZSBQcm9wZXJ0eSB3aG9zZSB2YWx1ZSB5b3Ugd2FudCB0byB3YXRjaFxyXG4gICAqIEBwYXJhbSB0ZXh0IC0gVGV4dCBpbnN0YW5jZSB0byB1cGRhdGVcclxuICAgKiBAcGFyYW0gbGFiZWwgLSBhIGxhYmVsIGZvciB0aGUgdmFsdWUgd2UgYXJlIHdhdGNoaW5nXHJcbiAgICogQHBhcmFtIGRlY2ltYWxQbGFjZXNQcm9wZXJ0eSAtIGNvbnRyb2xzIHByZWNpc2lvbiBvZiB2YWx1ZXNcclxuICAgKiBAcGFyYW0gc2hvd0RlZ3JlZXMgLSBJZiB0aGUgdmFsdWUgd291bGQgYmUgaGVscGZ1bCB0byBhbHNvIHNob3cgaW4gZGVncmVlcyBmb3IgZGVidWdnaW5nLCBzZXQgdG8gdHJ1ZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIGFkZFJlZHJhd1ZhbHVlVGV4dExpc3RlbmVyKCBwcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8SW50ZW50aW9uYWxBbnk+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBUZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogc3RyaW5nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNpbWFsUGxhY2VzUHJvcGVydHk6IFByb3BlcnR5PG51bWJlcj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dEZWdyZWVzID0gZmFsc2UgKTogdm9pZCB7XHJcblxyXG4gICAgTXVsdGlsaW5rLm11bHRpbGluayggWyBwcm9wZXJ0eSwgZGVjaW1hbFBsYWNlc1Byb3BlcnR5IF0sICggdmFsdWUsIGRlY2ltYWxQbGFjZXMgKSA9PiB7XHJcblxyXG4gICAgICBsZXQgZm9ybWF0dGVkVmFsdWUgPSB2YWx1ZTtcclxuXHJcbiAgICAgIC8vIGlmIGEgbnVtYmVyLCB0cmltIHNvIHRoYXQgaXQgaXMgZWFzaWVyIHRvIHJlYWRcclxuICAgICAgaWYgKCB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICkge1xyXG4gICAgICAgIGZvcm1hdHRlZFZhbHVlID0gVXRpbHMudG9GaXhlZE51bWJlciggdmFsdWUsIGRlY2ltYWxQbGFjZXMgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCBzaG93RGVncmVlcyApIHtcclxuXHJcbiAgICAgICAgLy8ganVzdCBzaG93IHR3byBkZWNpbWFscyBpbnN0ZWFkIG9mIHRoZSBudW1iZXIgb2YgZGVjaW1hbHMgc2hvd24gdG8gYXZvaWQgY29uZnVzaW9uIHdpdGggdG9sZXJhbmNlIGludGVydmFsc1xyXG4gICAgICAgIC8vIHdoaWNoIGFyZSBpbiByYWRpYW5zXHJcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkRGVncmVlcyA9IFV0aWxzLnRvRml4ZWROdW1iZXIoIFV0aWxzLnRvRGVncmVlcyggdmFsdWUgKSwgMiApO1xyXG4gICAgICAgIHRleHQuc3RyaW5nID0gU3RyaW5nVXRpbHMuZmlsbEluKCBWQUxVRV9XSVRIX0RFR1JFRVNfUEFUVEVSTl9TVFJJTkcsIHtcclxuICAgICAgICAgIHZhbHVlOiBmb3JtYXR0ZWRWYWx1ZSxcclxuICAgICAgICAgIGRlZ3JlZXM6IGZvcm1hdHRlZERlZ3JlZXMsXHJcbiAgICAgICAgICBsYWJlbDogbGFiZWxcclxuICAgICAgICB9ICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdGV4dC5zdHJpbmcgPSBRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwuZmlsbEluVmFsdWVQYXR0ZXJuKCBsYWJlbCwgZm9ybWF0dGVkVmFsdWUgKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXNlcyBzdHJpbmcgdXRpbHMgdG8gZm9ybWF0IGEgbGFiZWwgYW5kIHZhbHVlIGZvciB0aGUgZGVidWdnaW5nIHBhbmVsLlxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIGZpbGxJblZhbHVlUGF0dGVybiggbGFiZWw6IHN0cmluZywgdmFsdWU6IG51bWJlciApOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZpbGxJbiggVkFMVUVfUEFUVEVSTl9TVFJJTkcsIHtcclxuICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICBsYWJlbDogbGFiZWxcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbnF1YWRyaWxhdGVyYWwucmVnaXN0ZXIoICdRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwnLCBRdWFkcmlsYXRlcmFsRGVidWdnaW5nUGFuZWwgKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGFBQWEsTUFBTSx3QkFBd0I7QUFFbEQsU0FBU0MsSUFBSSxFQUFlQyxTQUFTLEVBQUVDLElBQUksRUFBRUMsSUFBSSxRQUFxQixtQ0FBbUM7QUFDekcsT0FBT0MsV0FBVyxNQUFNLCtDQUErQztBQUV2RSxPQUFPQyxLQUFLLE1BQU0sNkJBQTZCO0FBRS9DLE9BQU9DLGNBQWMsTUFBTSx1Q0FBdUM7QUFDbEUsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxhQUFhLE1BQU0sOENBQThDO0FBQ3hFLE9BQU9DLFNBQVMsTUFBTSxrQ0FBa0M7QUFFeEQsT0FBT0MsVUFBVSxNQUFNLGtDQUFrQztBQUN6RCxPQUFPQyxNQUFNLE1BQU0saUNBQWlDO0FBQ3BELFNBQVNDLGNBQWMsUUFBUSx1Q0FBdUM7O0FBRXRFO0FBQ0EsTUFBTUMsWUFBWSxHQUFHO0VBQUVDLFFBQVEsRUFBRTtBQUFHLENBQUM7QUFDckMsTUFBTUMsb0JBQW9CLEdBQUcsc0JBQXNCO0FBQ25ELE1BQU1DLGlDQUFpQyxHQUFHLDRDQUE0QztBQUN0RixNQUFNQyxlQUFlLEdBQUcsRUFBRTtBQUMxQixNQUFNQyxZQUF5QixHQUFHO0VBQUVDLEtBQUssRUFBRTtBQUFPLENBQUM7QUFFbkQsZUFBZSxNQUFNQywyQkFBMkIsU0FBU3BCLElBQUksQ0FBQztFQUNyRHFCLFdBQVdBLENBQUVDLEtBQXlCLEVBQUVDLGVBQTZCLEVBQUc7SUFFN0U7SUFD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