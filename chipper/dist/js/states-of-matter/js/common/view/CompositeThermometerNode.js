// Copyright 2014-2022, University of Colorado Boulder

/**
 * This class defines a node that has a liquid thermometer and a numerical readout that can display the temperature in
 * degrees Kelvin or degrees Celsius.
 *
 * @author Siddhartha Chinthapally (Actual Concepts)
 * @author John Blanco
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import EnumerationDeprecatedProperty from '../../../../axon/js/EnumerationDeprecatedProperty.js';
import Range from '../../../../dot/js/Range.js';
import Utils from '../../../../dot/js/Utils.js';
import EnumerationDeprecated from '../../../../phet-core/js/EnumerationDeprecated.js';
import merge from '../../../../phet-core/js/merge.js';
import ComboBoxDisplay from '../../../../scenery-phet/js/ComboBoxDisplay.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import ThermometerNode from '../../../../scenery-phet/js/ThermometerNode.js';
import { Node, VBox } from '../../../../scenery/js/imports.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import statesOfMatter from '../../statesOfMatter.js';
import StatesOfMatterStrings from '../../StatesOfMatterStrings.js';
import SOMQueryParameters from '../SOMQueryParameters.js';

// strings
const celsiusUnitsString = StatesOfMatterStrings.celsiusUnits;
const kelvinUnitsString = StatesOfMatterStrings.kelvinUnits;

// helper function
const kelvinToCelsius = temperatureInKelvin => Utils.roundSymmetric(temperatureInKelvin - 273.15);

// constants
const KELVIN_TEMPERATURE_RANGE = new Range(0, 5000); // this is an upper bound based on experimenting with the sim
const CELSIUS_TEMPERATURE_RANGE = new Range(kelvinToCelsius(KELVIN_TEMPERATURE_RANGE.min), kelvinToCelsius(KELVIN_TEMPERATURE_RANGE.max));
const TEMPERATURE_READOUT_FONT = new PhetFont(11);

// local enum
const TemperatureUnits = EnumerationDeprecated.byKeys(['KELVIN', 'CELSIUS']);

// clamping the red mercury display at 1000
const MAX_TEMPERATURE_TO_CLAMP_RED_MERCURY = 1000;
class CompositeThermometerNode extends Node {
  /**
   * @param {MultipleParticleModel} multipleParticleModel - model of the simulation
   * @param {Object} [options] that can be passed on to the underlying node
   */
  constructor(multipleParticleModel, options) {
    options = merge({
      tandem: Tandem.REQUIRED
    }, options);
    super();

    // add thermometer node
    const thermometerNode = new ThermometerNode(multipleParticleModel.temperatureInKelvinProperty, 0, MAX_TEMPERATURE_TO_CLAMP_RED_MERCURY, {
      outlineStroke: 'black',
      backgroundFill: 'white',
      tickSpacing: 8,
      majorTickLength: 8,
      minorTickLength: 4,
      bulbDiameter: 23,
      glassThickness: 2.5,
      lineWidth: 1.4,
      tubeWidth: 13,
      tubeHeight: 65,
      tandem: options.tandem.createTandem('thermometerNode')
    });

    // @private
    this.temperatureUnitsProperty = new EnumerationDeprecatedProperty(TemperatureUnits, SOMQueryParameters.defaultCelsius ? TemperatureUnits.CELSIUS : TemperatureUnits.KELVIN, {
      tandem: options.tandem.createTandem('temperatureUnitsProperty')
    });

    // Property that contains the temperature in degrees Celsius
    const temperatureInCelsiusProperty = new DerivedProperty([multipleParticleModel.temperatureInKelvinProperty], temperatureInKelvin => temperatureInKelvin === null ? null : kelvinToCelsius(temperatureInKelvin));
    const comboBoxDisplayItems = [{
      choice: TemperatureUnits.KELVIN,
      tandemName: `${TemperatureUnits.KELVIN.toString().toLowerCase()}Item`,
      numberProperty: multipleParticleModel.temperatureInKelvinProperty,
      range: KELVIN_TEMPERATURE_RANGE,
      units: kelvinUnitsString
    }, {
      choice: TemperatureUnits.CELSIUS,
      tandemName: `${TemperatureUnits.CELSIUS.toString().toLowerCase()}Item`,
      numberProperty: temperatureInCelsiusProperty,
      range: CELSIUS_TEMPERATURE_RANGE,
      units: celsiusUnitsString
    }];

    // layer where the combo box list will go, added later to keep it on top of z-order
    const comboBoxListParent = new Node();

    // Create the combo box that will display the temperature in either Kelvin or Celsius.
    const temperatureComboBoxDisplay = new ComboBoxDisplay(this.temperatureUnitsProperty, comboBoxDisplayItems, comboBoxListParent, {
      xMargin: 6,
      yMargin: 4,
      cornerRadius: 5,
      buttonLineWidth: 0.4,
      align: 'right',
      numberDisplayOptions: {
        textOptions: {
          font: TEMPERATURE_READOUT_FONT
        }
      },
      tandem: options.tandem.createTandem('temperatureComboBox')
    });
    this.addChild(new VBox({
      spacing: 10,
      children: [temperatureComboBoxDisplay, thermometerNode],
      resize: false
    }));
    this.addChild(comboBoxListParent);

    // apply the options
    this.mutate(options);

    // Create a link to temperatureInKelvinProperty so it's easier to find in phet-io Studio.
    this.addLinkedElement(multipleParticleModel.temperatureInKelvinProperty, {
      tandem: options.tandem.createTandem('temperatureInKelvinProperty')
    });
  }

  // @public
  reset() {
    this.temperatureUnitsProperty.reset();
  }
}
statesOfMatter.register('CompositeThermometerNode', CompositeThermometerNode);
export default CompositeThermometerNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJFbnVtZXJhdGlvbkRlcHJlY2F0ZWRQcm9wZXJ0eSIsIlJhbmdlIiwiVXRpbHMiLCJFbnVtZXJhdGlvbkRlcHJlY2F0ZWQiLCJtZXJnZSIsIkNvbWJvQm94RGlzcGxheSIsIlBoZXRGb250IiwiVGhlcm1vbWV0ZXJOb2RlIiwiTm9kZSIsIlZCb3giLCJUYW5kZW0iLCJzdGF0ZXNPZk1hdHRlciIsIlN0YXRlc09mTWF0dGVyU3RyaW5ncyIsIlNPTVF1ZXJ5UGFyYW1ldGVycyIsImNlbHNpdXNVbml0c1N0cmluZyIsImNlbHNpdXNVbml0cyIsImtlbHZpblVuaXRzU3RyaW5nIiwia2VsdmluVW5pdHMiLCJrZWx2aW5Ub0NlbHNpdXMiLCJ0ZW1wZXJhdHVyZUluS2VsdmluIiwicm91bmRTeW1tZXRyaWMiLCJLRUxWSU5fVEVNUEVSQVRVUkVfUkFOR0UiLCJDRUxTSVVTX1RFTVBFUkFUVVJFX1JBTkdFIiwibWluIiwibWF4IiwiVEVNUEVSQVRVUkVfUkVBRE9VVF9GT05UIiwiVGVtcGVyYXR1cmVVbml0cyIsImJ5S2V5cyIsIk1BWF9URU1QRVJBVFVSRV9UT19DTEFNUF9SRURfTUVSQ1VSWSIsIkNvbXBvc2l0ZVRoZXJtb21ldGVyTm9kZSIsImNvbnN0cnVjdG9yIiwibXVsdGlwbGVQYXJ0aWNsZU1vZGVsIiwib3B0aW9ucyIsInRhbmRlbSIsIlJFUVVJUkVEIiwidGhlcm1vbWV0ZXJOb2RlIiwidGVtcGVyYXR1cmVJbktlbHZpblByb3BlcnR5Iiwib3V0bGluZVN0cm9rZSIsImJhY2tncm91bmRGaWxsIiwidGlja1NwYWNpbmciLCJtYWpvclRpY2tMZW5ndGgiLCJtaW5vclRpY2tMZW5ndGgiLCJidWxiRGlhbWV0ZXIiLCJnbGFzc1RoaWNrbmVzcyIsImxpbmVXaWR0aCIsInR1YmVXaWR0aCIsInR1YmVIZWlnaHQiLCJjcmVhdGVUYW5kZW0iLCJ0ZW1wZXJhdHVyZVVuaXRzUHJvcGVydHkiLCJkZWZhdWx0Q2Vsc2l1cyIsIkNFTFNJVVMiLCJLRUxWSU4iLCJ0ZW1wZXJhdHVyZUluQ2Vsc2l1c1Byb3BlcnR5IiwiY29tYm9Cb3hEaXNwbGF5SXRlbXMiLCJjaG9pY2UiLCJ0YW5kZW1OYW1lIiwidG9TdHJpbmciLCJ0b0xvd2VyQ2FzZSIsIm51bWJlclByb3BlcnR5IiwicmFuZ2UiLCJ1bml0cyIsImNvbWJvQm94TGlzdFBhcmVudCIsInRlbXBlcmF0dXJlQ29tYm9Cb3hEaXNwbGF5IiwieE1hcmdpbiIsInlNYXJnaW4iLCJjb3JuZXJSYWRpdXMiLCJidXR0b25MaW5lV2lkdGgiLCJhbGlnbiIsIm51bWJlckRpc3BsYXlPcHRpb25zIiwidGV4dE9wdGlvbnMiLCJmb250IiwiYWRkQ2hpbGQiLCJzcGFjaW5nIiwiY2hpbGRyZW4iLCJyZXNpemUiLCJtdXRhdGUiLCJhZGRMaW5rZWRFbGVtZW50IiwicmVzZXQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkNvbXBvc2l0ZVRoZXJtb21ldGVyTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBUaGlzIGNsYXNzIGRlZmluZXMgYSBub2RlIHRoYXQgaGFzIGEgbGlxdWlkIHRoZXJtb21ldGVyIGFuZCBhIG51bWVyaWNhbCByZWFkb3V0IHRoYXQgY2FuIGRpc3BsYXkgdGhlIHRlbXBlcmF0dXJlIGluXHJcbiAqIGRlZ3JlZXMgS2VsdmluIG9yIGRlZ3JlZXMgQ2Vsc2l1cy5cclxuICpcclxuICogQGF1dGhvciBTaWRkaGFydGhhIENoaW50aGFwYWxseSAoQWN0dWFsIENvbmNlcHRzKVxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvXHJcbiAqL1xyXG5cclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBFbnVtZXJhdGlvbkRlcHJlY2F0ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0VudW1lcmF0aW9uRGVwcmVjYXRlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IFJhbmdlIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9SYW5nZS5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgRW51bWVyYXRpb25EZXByZWNhdGVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9FbnVtZXJhdGlvbkRlcHJlY2F0ZWQuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IENvbWJvQm94RGlzcGxheSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvQ29tYm9Cb3hEaXNwbGF5LmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCBUaGVybW9tZXRlck5vZGUgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1RoZXJtb21ldGVyTm9kZS5qcyc7XHJcbmltcG9ydCB7IE5vZGUsIFZCb3ggfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgc3RhdGVzT2ZNYXR0ZXIgZnJvbSAnLi4vLi4vc3RhdGVzT2ZNYXR0ZXIuanMnO1xyXG5pbXBvcnQgU3RhdGVzT2ZNYXR0ZXJTdHJpbmdzIGZyb20gJy4uLy4uL1N0YXRlc09mTWF0dGVyU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBTT01RdWVyeVBhcmFtZXRlcnMgZnJvbSAnLi4vU09NUXVlcnlQYXJhbWV0ZXJzLmpzJztcclxuXHJcbi8vIHN0cmluZ3NcclxuY29uc3QgY2Vsc2l1c1VuaXRzU3RyaW5nID0gU3RhdGVzT2ZNYXR0ZXJTdHJpbmdzLmNlbHNpdXNVbml0cztcclxuY29uc3Qga2VsdmluVW5pdHNTdHJpbmcgPSBTdGF0ZXNPZk1hdHRlclN0cmluZ3Mua2VsdmluVW5pdHM7XHJcblxyXG4vLyBoZWxwZXIgZnVuY3Rpb25cclxuY29uc3Qga2VsdmluVG9DZWxzaXVzID0gdGVtcGVyYXR1cmVJbktlbHZpbiA9PiBVdGlscy5yb3VuZFN5bW1ldHJpYyggdGVtcGVyYXR1cmVJbktlbHZpbiAtIDI3My4xNSApO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IEtFTFZJTl9URU1QRVJBVFVSRV9SQU5HRSA9IG5ldyBSYW5nZSggMCwgNTAwMCApOyAvLyB0aGlzIGlzIGFuIHVwcGVyIGJvdW5kIGJhc2VkIG9uIGV4cGVyaW1lbnRpbmcgd2l0aCB0aGUgc2ltXHJcbmNvbnN0IENFTFNJVVNfVEVNUEVSQVRVUkVfUkFOR0UgPSBuZXcgUmFuZ2UoXHJcbiAga2VsdmluVG9DZWxzaXVzKCBLRUxWSU5fVEVNUEVSQVRVUkVfUkFOR0UubWluICksXHJcbiAga2VsdmluVG9DZWxzaXVzKCBLRUxWSU5fVEVNUEVSQVRVUkVfUkFOR0UubWF4IClcclxuKTtcclxuY29uc3QgVEVNUEVSQVRVUkVfUkVBRE9VVF9GT05UID0gbmV3IFBoZXRGb250KCAxMSApO1xyXG5cclxuLy8gbG9jYWwgZW51bVxyXG5jb25zdCBUZW1wZXJhdHVyZVVuaXRzID0gRW51bWVyYXRpb25EZXByZWNhdGVkLmJ5S2V5cyggWyAnS0VMVklOJywgJ0NFTFNJVVMnIF0gKTtcclxuXHJcbi8vIGNsYW1waW5nIHRoZSByZWQgbWVyY3VyeSBkaXNwbGF5IGF0IDEwMDBcclxuY29uc3QgTUFYX1RFTVBFUkFUVVJFX1RPX0NMQU1QX1JFRF9NRVJDVVJZID0gMTAwMDtcclxuXHJcbmNsYXNzIENvbXBvc2l0ZVRoZXJtb21ldGVyTm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge011bHRpcGxlUGFydGljbGVNb2RlbH0gbXVsdGlwbGVQYXJ0aWNsZU1vZGVsIC0gbW9kZWwgb2YgdGhlIHNpbXVsYXRpb25cclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIHRoYXQgY2FuIGJlIHBhc3NlZCBvbiB0byB0aGUgdW5kZXJseWluZyBub2RlXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG11bHRpcGxlUGFydGljbGVNb2RlbCwgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgdGFuZGVtOiBUYW5kZW0uUkVRVUlSRURcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlcigpO1xyXG5cclxuICAgIC8vIGFkZCB0aGVybW9tZXRlciBub2RlXHJcbiAgICBjb25zdCB0aGVybW9tZXRlck5vZGUgPSBuZXcgVGhlcm1vbWV0ZXJOb2RlKCBtdWx0aXBsZVBhcnRpY2xlTW9kZWwudGVtcGVyYXR1cmVJbktlbHZpblByb3BlcnR5LCAwLCBNQVhfVEVNUEVSQVRVUkVfVE9fQ0xBTVBfUkVEX01FUkNVUlksIHtcclxuICAgICAgb3V0bGluZVN0cm9rZTogJ2JsYWNrJyxcclxuICAgICAgYmFja2dyb3VuZEZpbGw6ICd3aGl0ZScsXHJcbiAgICAgIHRpY2tTcGFjaW5nOiA4LFxyXG4gICAgICBtYWpvclRpY2tMZW5ndGg6IDgsXHJcbiAgICAgIG1pbm9yVGlja0xlbmd0aDogNCxcclxuICAgICAgYnVsYkRpYW1ldGVyOiAyMyxcclxuICAgICAgZ2xhc3NUaGlja25lc3M6IDIuNSxcclxuICAgICAgbGluZVdpZHRoOiAxLjQsXHJcbiAgICAgIHR1YmVXaWR0aDogMTMsXHJcbiAgICAgIHR1YmVIZWlnaHQ6IDY1LFxyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3RoZXJtb21ldGVyTm9kZScgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEBwcml2YXRlXHJcbiAgICB0aGlzLnRlbXBlcmF0dXJlVW5pdHNQcm9wZXJ0eSA9IG5ldyBFbnVtZXJhdGlvbkRlcHJlY2F0ZWRQcm9wZXJ0eShcclxuICAgICAgVGVtcGVyYXR1cmVVbml0cyxcclxuICAgICAgU09NUXVlcnlQYXJhbWV0ZXJzLmRlZmF1bHRDZWxzaXVzID8gVGVtcGVyYXR1cmVVbml0cy5DRUxTSVVTIDogVGVtcGVyYXR1cmVVbml0cy5LRUxWSU4sXHJcbiAgICAgIHsgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICd0ZW1wZXJhdHVyZVVuaXRzUHJvcGVydHknICkgfVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBQcm9wZXJ0eSB0aGF0IGNvbnRhaW5zIHRoZSB0ZW1wZXJhdHVyZSBpbiBkZWdyZWVzIENlbHNpdXNcclxuICAgIGNvbnN0IHRlbXBlcmF0dXJlSW5DZWxzaXVzUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICBbIG11bHRpcGxlUGFydGljbGVNb2RlbC50ZW1wZXJhdHVyZUluS2VsdmluUHJvcGVydHkgXSxcclxuICAgICAgdGVtcGVyYXR1cmVJbktlbHZpbiA9PiB0ZW1wZXJhdHVyZUluS2VsdmluID09PSBudWxsID8gbnVsbCA6IGtlbHZpblRvQ2Vsc2l1cyggdGVtcGVyYXR1cmVJbktlbHZpbiApXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IGNvbWJvQm94RGlzcGxheUl0ZW1zID0gW1xyXG4gICAgICB7XHJcbiAgICAgICAgY2hvaWNlOiBUZW1wZXJhdHVyZVVuaXRzLktFTFZJTixcclxuICAgICAgICB0YW5kZW1OYW1lOiBgJHtUZW1wZXJhdHVyZVVuaXRzLktFTFZJTi50b1N0cmluZygpLnRvTG93ZXJDYXNlKCl9SXRlbWAsXHJcbiAgICAgICAgbnVtYmVyUHJvcGVydHk6IG11bHRpcGxlUGFydGljbGVNb2RlbC50ZW1wZXJhdHVyZUluS2VsdmluUHJvcGVydHksXHJcbiAgICAgICAgcmFuZ2U6IEtFTFZJTl9URU1QRVJBVFVSRV9SQU5HRSxcclxuICAgICAgICB1bml0czoga2VsdmluVW5pdHNTdHJpbmdcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGNob2ljZTogVGVtcGVyYXR1cmVVbml0cy5DRUxTSVVTLFxyXG4gICAgICAgIHRhbmRlbU5hbWU6IGAke1RlbXBlcmF0dXJlVW5pdHMuQ0VMU0lVUy50b1N0cmluZygpLnRvTG93ZXJDYXNlKCl9SXRlbWAsXHJcbiAgICAgICAgbnVtYmVyUHJvcGVydHk6IHRlbXBlcmF0dXJlSW5DZWxzaXVzUHJvcGVydHksXHJcbiAgICAgICAgcmFuZ2U6IENFTFNJVVNfVEVNUEVSQVRVUkVfUkFOR0UsXHJcbiAgICAgICAgdW5pdHM6IGNlbHNpdXNVbml0c1N0cmluZ1xyXG4gICAgICB9XHJcbiAgICBdO1xyXG5cclxuICAgIC8vIGxheWVyIHdoZXJlIHRoZSBjb21ibyBib3ggbGlzdCB3aWxsIGdvLCBhZGRlZCBsYXRlciB0byBrZWVwIGl0IG9uIHRvcCBvZiB6LW9yZGVyXHJcbiAgICBjb25zdCBjb21ib0JveExpc3RQYXJlbnQgPSBuZXcgTm9kZSgpO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgY29tYm8gYm94IHRoYXQgd2lsbCBkaXNwbGF5IHRoZSB0ZW1wZXJhdHVyZSBpbiBlaXRoZXIgS2VsdmluIG9yIENlbHNpdXMuXHJcbiAgICBjb25zdCB0ZW1wZXJhdHVyZUNvbWJvQm94RGlzcGxheSA9IG5ldyBDb21ib0JveERpc3BsYXkoIHRoaXMudGVtcGVyYXR1cmVVbml0c1Byb3BlcnR5LCBjb21ib0JveERpc3BsYXlJdGVtcywgY29tYm9Cb3hMaXN0UGFyZW50LCB7XHJcbiAgICAgIHhNYXJnaW46IDYsXHJcbiAgICAgIHlNYXJnaW46IDQsXHJcbiAgICAgIGNvcm5lclJhZGl1czogNSxcclxuICAgICAgYnV0dG9uTGluZVdpZHRoOiAwLjQsXHJcbiAgICAgIGFsaWduOiAncmlnaHQnLFxyXG4gICAgICBudW1iZXJEaXNwbGF5T3B0aW9uczoge1xyXG4gICAgICAgIHRleHRPcHRpb25zOiB7IGZvbnQ6IFRFTVBFUkFUVVJFX1JFQURPVVRfRk9OVCB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAndGVtcGVyYXR1cmVDb21ib0JveCcgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBWQm94KCB7XHJcbiAgICAgIHNwYWNpbmc6IDEwLFxyXG4gICAgICBjaGlsZHJlbjogWyB0ZW1wZXJhdHVyZUNvbWJvQm94RGlzcGxheSwgdGhlcm1vbWV0ZXJOb2RlIF0sXHJcbiAgICAgIHJlc2l6ZTogZmFsc2VcclxuICAgIH0gKSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggY29tYm9Cb3hMaXN0UGFyZW50ICk7XHJcblxyXG4gICAgLy8gYXBwbHkgdGhlIG9wdGlvbnNcclxuICAgIHRoaXMubXV0YXRlKCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGEgbGluayB0byB0ZW1wZXJhdHVyZUluS2VsdmluUHJvcGVydHkgc28gaXQncyBlYXNpZXIgdG8gZmluZCBpbiBwaGV0LWlvIFN0dWRpby5cclxuICAgIHRoaXMuYWRkTGlua2VkRWxlbWVudCggbXVsdGlwbGVQYXJ0aWNsZU1vZGVsLnRlbXBlcmF0dXJlSW5LZWx2aW5Qcm9wZXJ0eSwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3RlbXBlcmF0dXJlSW5LZWx2aW5Qcm9wZXJ0eScgKVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLy8gQHB1YmxpY1xyXG4gIHJlc2V0KCkge1xyXG4gICAgdGhpcy50ZW1wZXJhdHVyZVVuaXRzUHJvcGVydHkucmVzZXQoKTtcclxuICB9XHJcbn1cclxuXHJcbnN0YXRlc09mTWF0dGVyLnJlZ2lzdGVyKCAnQ29tcG9zaXRlVGhlcm1vbWV0ZXJOb2RlJywgQ29tcG9zaXRlVGhlcm1vbWV0ZXJOb2RlICk7XHJcbmV4cG9ydCBkZWZhdWx0IENvbXBvc2l0ZVRoZXJtb21ldGVyTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVB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