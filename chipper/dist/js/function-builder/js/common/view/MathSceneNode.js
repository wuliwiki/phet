// Copyright 2016-2023, University of Colorado Boulder

/**
 * Base class for scenes that involve math functions.
 * Adds optional drawers to the scene.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import merge from '../../../../phet-core/js/merge.js';
import functionBuilder from '../../functionBuilder.js';
import FBConstants from '../FBConstants.js';
import EquationCard from '../model/cards/EquationCard.js';
import NumberCard from '../model/cards/NumberCard.js';
import EquationCardNode from './cards/EquationCardNode.js';
import NumberCardNode from './cards/NumberCardNode.js';
import CardContainer from './containers/CardContainer.js';
import EquationDrawer from './equations/EquationDrawer.js';
import XYGraphDrawer from './graph/XYGraphDrawer.js';
import SceneNode from './SceneNode.js';
import XYTableDrawer from './table/XYTableDrawer.js';
export default class MathSceneNode extends SceneNode {
  /**
   * @param {Scene} scene - model for this scene
   * @param {Bounds2} layoutBounds - layoutBounds of the parent ScreenView
   * @param {constructor} functionNodeConstructor - constructor for FunctionNode subtype
   * @param {Object} [options]
   */
  constructor(scene, layoutBounds, functionNodeConstructor, options) {
    options = merge({
      hasTableDrawer: false,
      // show XY table drawer
      hasGraphDrawer: false,
      // show XY graph drawer
      hasEquationDrawer: false,
      // show equation drawer
      tableOptions: null,
      // {*} options for XYTableNode
      graphOptions: null,
      // {*} options for XYGraphNode
      equationOptions: null // {*} options for EquationPanel
    }, options);
    super(scene, layoutBounds, functionNodeConstructor, options);

    // @public whether the equation is displayed in slope-intercept form
    this.slopeInterceptProperty = new BooleanProperty(false);

    // XY table drawer
    if (options.hasTableDrawer) {
      // @private
      this.tableDrawer = new XYTableDrawer(scene.builder, this.inputContainers, this.outputContainers, {
        tableOptions: options.tableOptions,
        bottom: scene.builder.position.y - scene.builder.waistHeight / 2 + FBConstants.DRAWER_Y_OVERLAP
      });
      this.drawersLayer.addChild(this.tableDrawer);

      // layout
      if (options.hasGraphDrawer) {
        this.tableDrawer.right = scene.builder.centerX - 20; // offset determined empirically
      } else {
        this.tableDrawer.centerX = scene.builder.centerX;
      }
    }

    // XY graph drawer
    if (options.hasGraphDrawer) {
      // @private Graph drawer
      this.graphDrawer = new XYGraphDrawer(scene.builder, this.outputContainers, {
        graphOptions: options.graphOptions,
        bottom: scene.builder.position.y - scene.builder.waistHeight / 2 + FBConstants.DRAWER_Y_OVERLAP
      });
      this.drawersLayer.addChild(this.graphDrawer);

      // layout
      if (options.hasTableDrawer) {
        this.graphDrawer.left = scene.builder.centerX - 5; // offset determined empirically
      } else {
        this.graphDrawer.centerX = scene.builder.centerX;
      }
    }

    // Equation drawer
    if (options.hasEquationDrawer) {
      // @private
      this.equationDrawer = new EquationDrawer(scene.builder, this.slopeInterceptProperty, {
        equationOptions: options.equationOptions,
        centerX: scene.builder.centerX,
        top: scene.builder.position.y + scene.builder.waistHeight / 2 - FBConstants.DRAWER_Y_OVERLAP
      });
      this.drawersLayer.addChild(this.equationDrawer);
    }
  }

  // @public @override
  reset() {
    this.slopeInterceptProperty.reset();

    // disable scrolling animation for the table
    this.tableDrawer && (this.tableDrawer.contentsNode.animationEnabled = false);
    super.reset();
    this.tableDrawer && (this.tableDrawer.contentsNode.animationEnabled = true);

    // reset drawers with animation disabled
    const animationEnabled = false;
    this.equationDrawer && this.equationDrawer.reset(animationEnabled);
    this.tableDrawer && this.tableDrawer.reset(animationEnabled);
    this.graphDrawer && this.graphDrawer && this.graphDrawer.reset(animationEnabled);
  }

  /**
   * When the eraser button is pressed, disable scrolling animation for the table.
   *
   * @protected
   * @override
   */
  erase() {
    this.tableDrawer && (this.tableDrawer.contentsNode.animationEnabled = false);
    super.erase();
    this.tableDrawer && (this.tableDrawer.contentsNode.animationEnabled = true);
  }

  /**
   * Creates the card containers that go in the card carousels.
   *
   * @param {Scene} scene
   * @param {Object} [containerOptions] - see CardContainer options
   * @returns {CardContainer[]}
   * @protected
   * @override
   */
  createCardCarouselItems(scene, containerOptions) {
    const containers = [];

    // numbers
    scene.cardContent.forEach(value => {
      containers.push({
        createNode: tandem => new CardContainer(NumberCard, NumberCardNode, value, containerOptions)
      });
    });

    // symbol (eg 'x') is put in the carousel last
    if (scene.cardSymbol) {
      containers.push({
        createNode: tandem => new CardContainer(EquationCard, EquationCardNode, scene.cardSymbol, containerOptions)
      });
    }
    return containers;
  }
}
functionBuilder.register('MathSceneNode', MathSceneNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJtZXJnZSIsImZ1bmN0aW9uQnVpbGRlciIsIkZCQ29uc3RhbnRzIiwiRXF1YXRpb25DYXJkIiwiTnVtYmVyQ2FyZCIsIkVxdWF0aW9uQ2FyZE5vZGUiLCJOdW1iZXJDYXJkTm9kZSIsIkNhcmRDb250YWluZXIiLCJFcXVhdGlvbkRyYXdlciIsIlhZR3JhcGhEcmF3ZXIiLCJTY2VuZU5vZGUiLCJYWVRhYmxlRHJhd2VyIiwiTWF0aFNjZW5lTm9kZSIsImNvbnN0cnVjdG9yIiwic2NlbmUiLCJsYXlvdXRCb3VuZHMiLCJmdW5jdGlvbk5vZGVDb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJoYXNUYWJsZURyYXdlciIsImhhc0dyYXBoRHJhd2VyIiwiaGFzRXF1YXRpb25EcmF3ZXIiLCJ0YWJsZU9wdGlvbnMiLCJncmFwaE9wdGlvbnMiLCJlcXVhdGlvbk9wdGlvbnMiLCJzbG9wZUludGVyY2VwdFByb3BlcnR5IiwidGFibGVEcmF3ZXIiLCJidWlsZGVyIiwiaW5wdXRDb250YWluZXJzIiwib3V0cHV0Q29udGFpbmVycyIsImJvdHRvbSIsInBvc2l0aW9uIiwieSIsIndhaXN0SGVpZ2h0IiwiRFJBV0VSX1lfT1ZFUkxBUCIsImRyYXdlcnNMYXllciIsImFkZENoaWxkIiwicmlnaHQiLCJjZW50ZXJYIiwiZ3JhcGhEcmF3ZXIiLCJsZWZ0IiwiZXF1YXRpb25EcmF3ZXIiLCJ0b3AiLCJyZXNldCIsImNvbnRlbnRzTm9kZSIsImFuaW1hdGlvbkVuYWJsZWQiLCJlcmFzZSIsImNyZWF0ZUNhcmRDYXJvdXNlbEl0ZW1zIiwiY29udGFpbmVyT3B0aW9ucyIsImNvbnRhaW5lcnMiLCJjYXJkQ29udGVudCIsImZvckVhY2giLCJ2YWx1ZSIsInB1c2giLCJjcmVhdGVOb2RlIiwidGFuZGVtIiwiY2FyZFN5bWJvbCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiTWF0aFNjZW5lTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNi0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBCYXNlIGNsYXNzIGZvciBzY2VuZXMgdGhhdCBpbnZvbHZlIG1hdGggZnVuY3Rpb25zLlxyXG4gKiBBZGRzIG9wdGlvbmFsIGRyYXdlcnMgdG8gdGhlIHNjZW5lLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBCb29sZWFuUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Cb29sZWFuUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IGZ1bmN0aW9uQnVpbGRlciBmcm9tICcuLi8uLi9mdW5jdGlvbkJ1aWxkZXIuanMnO1xyXG5pbXBvcnQgRkJDb25zdGFudHMgZnJvbSAnLi4vRkJDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgRXF1YXRpb25DYXJkIGZyb20gJy4uL21vZGVsL2NhcmRzL0VxdWF0aW9uQ2FyZC5qcyc7XHJcbmltcG9ydCBOdW1iZXJDYXJkIGZyb20gJy4uL21vZGVsL2NhcmRzL051bWJlckNhcmQuanMnO1xyXG5pbXBvcnQgRXF1YXRpb25DYXJkTm9kZSBmcm9tICcuL2NhcmRzL0VxdWF0aW9uQ2FyZE5vZGUuanMnO1xyXG5pbXBvcnQgTnVtYmVyQ2FyZE5vZGUgZnJvbSAnLi9jYXJkcy9OdW1iZXJDYXJkTm9kZS5qcyc7XHJcbmltcG9ydCBDYXJkQ29udGFpbmVyIGZyb20gJy4vY29udGFpbmVycy9DYXJkQ29udGFpbmVyLmpzJztcclxuaW1wb3J0IEVxdWF0aW9uRHJhd2VyIGZyb20gJy4vZXF1YXRpb25zL0VxdWF0aW9uRHJhd2VyLmpzJztcclxuaW1wb3J0IFhZR3JhcGhEcmF3ZXIgZnJvbSAnLi9ncmFwaC9YWUdyYXBoRHJhd2VyLmpzJztcclxuaW1wb3J0IFNjZW5lTm9kZSBmcm9tICcuL1NjZW5lTm9kZS5qcyc7XHJcbmltcG9ydCBYWVRhYmxlRHJhd2VyIGZyb20gJy4vdGFibGUvWFlUYWJsZURyYXdlci5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNYXRoU2NlbmVOb2RlIGV4dGVuZHMgU2NlbmVOb2RlIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtTY2VuZX0gc2NlbmUgLSBtb2RlbCBmb3IgdGhpcyBzY2VuZVxyXG4gICAqIEBwYXJhbSB7Qm91bmRzMn0gbGF5b3V0Qm91bmRzIC0gbGF5b3V0Qm91bmRzIG9mIHRoZSBwYXJlbnQgU2NyZWVuVmlld1xyXG4gICAqIEBwYXJhbSB7Y29uc3RydWN0b3J9IGZ1bmN0aW9uTm9kZUNvbnN0cnVjdG9yIC0gY29uc3RydWN0b3IgZm9yIEZ1bmN0aW9uTm9kZSBzdWJ0eXBlXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBzY2VuZSwgbGF5b3V0Qm91bmRzLCBmdW5jdGlvbk5vZGVDb25zdHJ1Y3Rvciwgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgaGFzVGFibGVEcmF3ZXI6IGZhbHNlLCAvLyBzaG93IFhZIHRhYmxlIGRyYXdlclxyXG4gICAgICBoYXNHcmFwaERyYXdlcjogZmFsc2UsIC8vIHNob3cgWFkgZ3JhcGggZHJhd2VyXHJcbiAgICAgIGhhc0VxdWF0aW9uRHJhd2VyOiBmYWxzZSwgLy8gc2hvdyBlcXVhdGlvbiBkcmF3ZXJcclxuICAgICAgdGFibGVPcHRpb25zOiBudWxsLCAvLyB7Kn0gb3B0aW9ucyBmb3IgWFlUYWJsZU5vZGVcclxuICAgICAgZ3JhcGhPcHRpb25zOiBudWxsLCAvLyB7Kn0gb3B0aW9ucyBmb3IgWFlHcmFwaE5vZGVcclxuICAgICAgZXF1YXRpb25PcHRpb25zOiBudWxsIC8vIHsqfSBvcHRpb25zIGZvciBFcXVhdGlvblBhbmVsXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIHNjZW5lLCBsYXlvdXRCb3VuZHMsIGZ1bmN0aW9uTm9kZUNvbnN0cnVjdG9yLCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyB3aGV0aGVyIHRoZSBlcXVhdGlvbiBpcyBkaXNwbGF5ZWQgaW4gc2xvcGUtaW50ZXJjZXB0IGZvcm1cclxuICAgIHRoaXMuc2xvcGVJbnRlcmNlcHRQcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIGZhbHNlICk7XHJcblxyXG4gICAgLy8gWFkgdGFibGUgZHJhd2VyXHJcbiAgICBpZiAoIG9wdGlvbnMuaGFzVGFibGVEcmF3ZXIgKSB7XHJcblxyXG4gICAgICAvLyBAcHJpdmF0ZVxyXG4gICAgICB0aGlzLnRhYmxlRHJhd2VyID0gbmV3IFhZVGFibGVEcmF3ZXIoIHNjZW5lLmJ1aWxkZXIsIHRoaXMuaW5wdXRDb250YWluZXJzLCB0aGlzLm91dHB1dENvbnRhaW5lcnMsIHtcclxuICAgICAgICB0YWJsZU9wdGlvbnM6IG9wdGlvbnMudGFibGVPcHRpb25zLFxyXG4gICAgICAgIGJvdHRvbTogc2NlbmUuYnVpbGRlci5wb3NpdGlvbi55IC0gKCBzY2VuZS5idWlsZGVyLndhaXN0SGVpZ2h0IC8gMiApICsgRkJDb25zdGFudHMuRFJBV0VSX1lfT1ZFUkxBUFxyXG4gICAgICB9ICk7XHJcbiAgICAgIHRoaXMuZHJhd2Vyc0xheWVyLmFkZENoaWxkKCB0aGlzLnRhYmxlRHJhd2VyICk7XHJcblxyXG4gICAgICAvLyBsYXlvdXRcclxuICAgICAgaWYgKCBvcHRpb25zLmhhc0dyYXBoRHJhd2VyICkge1xyXG4gICAgICAgIHRoaXMudGFibGVEcmF3ZXIucmlnaHQgPSBzY2VuZS5idWlsZGVyLmNlbnRlclggLSAyMDsgLy8gb2Zmc2V0IGRldGVybWluZWQgZW1waXJpY2FsbHlcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB0aGlzLnRhYmxlRHJhd2VyLmNlbnRlclggPSBzY2VuZS5idWlsZGVyLmNlbnRlclg7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBYWSBncmFwaCBkcmF3ZXJcclxuICAgIGlmICggb3B0aW9ucy5oYXNHcmFwaERyYXdlciApIHtcclxuXHJcbiAgICAgIC8vIEBwcml2YXRlIEdyYXBoIGRyYXdlclxyXG4gICAgICB0aGlzLmdyYXBoRHJhd2VyID0gbmV3IFhZR3JhcGhEcmF3ZXIoIHNjZW5lLmJ1aWxkZXIsIHRoaXMub3V0cHV0Q29udGFpbmVycywge1xyXG4gICAgICAgIGdyYXBoT3B0aW9uczogb3B0aW9ucy5ncmFwaE9wdGlvbnMsXHJcbiAgICAgICAgYm90dG9tOiBzY2VuZS5idWlsZGVyLnBvc2l0aW9uLnkgLSAoIHNjZW5lLmJ1aWxkZXIud2Fpc3RIZWlnaHQgLyAyICkgKyBGQkNvbnN0YW50cy5EUkFXRVJfWV9PVkVSTEFQXHJcbiAgICAgIH0gKTtcclxuICAgICAgdGhpcy5kcmF3ZXJzTGF5ZXIuYWRkQ2hpbGQoIHRoaXMuZ3JhcGhEcmF3ZXIgKTtcclxuXHJcbiAgICAgIC8vIGxheW91dFxyXG4gICAgICBpZiAoIG9wdGlvbnMuaGFzVGFibGVEcmF3ZXIgKSB7XHJcbiAgICAgICAgdGhpcy5ncmFwaERyYXdlci5sZWZ0ID0gc2NlbmUuYnVpbGRlci5jZW50ZXJYIC0gNTsgLy8gb2Zmc2V0IGRldGVybWluZWQgZW1waXJpY2FsbHlcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB0aGlzLmdyYXBoRHJhd2VyLmNlbnRlclggPSBzY2VuZS5idWlsZGVyLmNlbnRlclg7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBFcXVhdGlvbiBkcmF3ZXJcclxuICAgIGlmICggb3B0aW9ucy5oYXNFcXVhdGlvbkRyYXdlciApIHtcclxuXHJcbiAgICAgIC8vIEBwcml2YXRlXHJcbiAgICAgIHRoaXMuZXF1YXRpb25EcmF3ZXIgPSBuZXcgRXF1YXRpb25EcmF3ZXIoIHNjZW5lLmJ1aWxkZXIsIHRoaXMuc2xvcGVJbnRlcmNlcHRQcm9wZXJ0eSwge1xyXG4gICAgICAgIGVxdWF0aW9uT3B0aW9uczogb3B0aW9ucy5lcXVhdGlvbk9wdGlvbnMsXHJcbiAgICAgICAgY2VudGVyWDogc2NlbmUuYnVpbGRlci5jZW50ZXJYLFxyXG4gICAgICAgIHRvcDogc2NlbmUuYnVpbGRlci5wb3NpdGlvbi55ICsgKCBzY2VuZS5idWlsZGVyLndhaXN0SGVpZ2h0IC8gMiApIC0gRkJDb25zdGFudHMuRFJBV0VSX1lfT1ZFUkxBUFxyXG4gICAgICB9ICk7XHJcbiAgICAgIHRoaXMuZHJhd2Vyc0xheWVyLmFkZENoaWxkKCB0aGlzLmVxdWF0aW9uRHJhd2VyICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBAcHVibGljIEBvdmVycmlkZVxyXG4gIHJlc2V0KCkge1xyXG5cclxuICAgIHRoaXMuc2xvcGVJbnRlcmNlcHRQcm9wZXJ0eS5yZXNldCgpO1xyXG5cclxuICAgIC8vIGRpc2FibGUgc2Nyb2xsaW5nIGFuaW1hdGlvbiBmb3IgdGhlIHRhYmxlXHJcbiAgICB0aGlzLnRhYmxlRHJhd2VyICYmICggdGhpcy50YWJsZURyYXdlci5jb250ZW50c05vZGUuYW5pbWF0aW9uRW5hYmxlZCA9IGZhbHNlICk7XHJcbiAgICBzdXBlci5yZXNldCgpO1xyXG4gICAgdGhpcy50YWJsZURyYXdlciAmJiAoIHRoaXMudGFibGVEcmF3ZXIuY29udGVudHNOb2RlLmFuaW1hdGlvbkVuYWJsZWQgPSB0cnVlICk7XHJcblxyXG4gICAgLy8gcmVzZXQgZHJhd2VycyB3aXRoIGFuaW1hdGlvbiBkaXNhYmxlZFxyXG4gICAgY29uc3QgYW5pbWF0aW9uRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5lcXVhdGlvbkRyYXdlciAmJiB0aGlzLmVxdWF0aW9uRHJhd2VyLnJlc2V0KCBhbmltYXRpb25FbmFibGVkICk7XHJcbiAgICB0aGlzLnRhYmxlRHJhd2VyICYmIHRoaXMudGFibGVEcmF3ZXIucmVzZXQoIGFuaW1hdGlvbkVuYWJsZWQgKTtcclxuICAgIHRoaXMuZ3JhcGhEcmF3ZXIgJiYgdGhpcy5ncmFwaERyYXdlciAmJiB0aGlzLmdyYXBoRHJhd2VyLnJlc2V0KCBhbmltYXRpb25FbmFibGVkICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXaGVuIHRoZSBlcmFzZXIgYnV0dG9uIGlzIHByZXNzZWQsIGRpc2FibGUgc2Nyb2xsaW5nIGFuaW1hdGlvbiBmb3IgdGhlIHRhYmxlLlxyXG4gICAqXHJcbiAgICogQHByb3RlY3RlZFxyXG4gICAqIEBvdmVycmlkZVxyXG4gICAqL1xyXG4gIGVyYXNlKCkge1xyXG4gICAgdGhpcy50YWJsZURyYXdlciAmJiAoIHRoaXMudGFibGVEcmF3ZXIuY29udGVudHNOb2RlLmFuaW1hdGlvbkVuYWJsZWQgPSBmYWxzZSApO1xyXG4gICAgc3VwZXIuZXJhc2UoKTtcclxuICAgIHRoaXMudGFibGVEcmF3ZXIgJiYgKCB0aGlzLnRhYmxlRHJhd2VyLmNvbnRlbnRzTm9kZS5hbmltYXRpb25FbmFibGVkID0gdHJ1ZSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyB0aGUgY2FyZCBjb250YWluZXJzIHRoYXQgZ28gaW4gdGhlIGNhcmQgY2Fyb3VzZWxzLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtTY2VuZX0gc2NlbmVcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbnRhaW5lck9wdGlvbnNdIC0gc2VlIENhcmRDb250YWluZXIgb3B0aW9uc1xyXG4gICAqIEByZXR1cm5zIHtDYXJkQ29udGFpbmVyW119XHJcbiAgICogQHByb3RlY3RlZFxyXG4gICAqIEBvdmVycmlkZVxyXG4gICAqL1xyXG4gIGNyZWF0ZUNhcmRDYXJvdXNlbEl0ZW1zKCBzY2VuZSwgY29udGFpbmVyT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBjb250YWluZXJzID0gW107XHJcblxyXG4gICAgLy8gbnVtYmVyc1xyXG4gICAgc2NlbmUuY2FyZENvbnRlbnQuZm9yRWFjaCggdmFsdWUgPT4ge1xyXG4gICAgICBjb250YWluZXJzLnB1c2goIHtcclxuICAgICAgICBjcmVhdGVOb2RlOiB0YW5kZW0gPT4gbmV3IENhcmRDb250YWluZXIoIE51bWJlckNhcmQsIE51bWJlckNhcmROb2RlLCB2YWx1ZSwgY29udGFpbmVyT3B0aW9ucyApXHJcbiAgICAgIH0gKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBzeW1ib2wgKGVnICd4JykgaXMgcHV0IGluIHRoZSBjYXJvdXNlbCBsYXN0XHJcbiAgICBpZiAoIHNjZW5lLmNhcmRTeW1ib2wgKSB7XHJcbiAgICAgIGNvbnRhaW5lcnMucHVzaCgge1xyXG4gICAgICAgIGNyZWF0ZU5vZGU6IHRhbmRlbSA9PiBuZXcgQ2FyZENvbnRhaW5lciggRXF1YXRpb25DYXJkLCBFcXVhdGlvbkNhcmROb2RlLCBzY2VuZS5jYXJkU3ltYm9sLCBjb250YWluZXJPcHRpb25zIClcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjb250YWluZXJzO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb25CdWlsZGVyLnJlZ2lzdGVyKCAnTWF0aFNjZW5lTm9kZScsIE1hdGhTY2VuZU5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLEtBQUssTUFBTSxtQ0FBbUM7QUFDckQsT0FBT0MsZUFBZSxNQUFNLDBCQUEwQjtBQUN0RCxPQUFPQyxXQUFXLE1BQU0sbUJBQW1CO0FBQzNDLE9BQU9DLFlBQVksTUFBTSxnQ0FBZ0M7QUFDekQsT0FBT0MsVUFBVSxNQUFNLDhCQUE4QjtBQUNyRCxPQUFPQyxnQkFBZ0IsTUFBTSw2QkFBNkI7QUFDMUQsT0FBT0MsY0FBYyxNQUFNLDJCQUEyQjtBQUN0RCxPQUFPQyxhQUFhLE1BQU0sK0JBQStCO0FBQ3pELE9BQU9DLGNBQWMsTUFBTSwrQkFBK0I7QUFDMUQsT0FBT0MsYUFBYSxNQUFNLDBCQUEwQjtBQUNwRCxPQUFPQyxTQUFTLE1B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