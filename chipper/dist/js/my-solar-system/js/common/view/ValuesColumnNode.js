// Copyright 2022-2023, University of Colorado Boulder

/**
 * Generates the information column for values depending on the type of Value used.
 *
 * @author AgustÃ­n Vallejo (PhET Interactive Simulations)
 */

import { AlignGroup, Circle, Color, Node, RichText, Text, VBox } from '../../../../scenery/js/imports.js';
import mySolarSystem from '../../mySolarSystem.js';
import ValuesColumnTypes from './ValuesColumnTypes.js';
import SolarSystemCommonConstants from '../../../../solar-system-common/js/SolarSystemCommonConstants.js';
import SolarSystemCommonNumberControl from '../../../../solar-system-common/js/view/SolarSystemCommonNumberControl.js';
import RangeWithValue from '../../../../dot/js/RangeWithValue.js';
import MySolarSystemStrings from '../../MySolarSystemStrings.js';
import MappedProperty from '../../../../axon/js/MappedProperty.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import InteractiveNumberDisplay from './InteractiveNumberDisplay.js';
import Utils from '../../../../dot/js/Utils.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import optionize, { combineOptions } from '../../../../phet-core/js/optionize.js';
import SolarSystemCommonStrings from '../../../../solar-system-common/js/SolarSystemCommonStrings.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
const LABEL_ALIGN_GROUP = new AlignGroup({
  matchHorizontal: false,
  matchVertical: true
});
const CONTENT_ALIGN_GROUP = new AlignGroup({
  matchHorizontal: false,
  matchVertical: true
});
export default class ValuesColumnNode extends VBox {
  constructor(model, columnType, providedOptions) {
    const options = optionize()({
      contentContainerSpacing: 3.5,
      labelSpacing: 3,
      stretch: true
    }, providedOptions);
    const labelString = columnType === ValuesColumnTypes.POSITION_X ? MySolarSystemStrings.dataPanel.XStringProperty : columnType === ValuesColumnTypes.POSITION_Y ? MySolarSystemStrings.dataPanel.YStringProperty : columnType === ValuesColumnTypes.VELOCITY_X ? MySolarSystemStrings.dataPanel.VxStringProperty : columnType === ValuesColumnTypes.VELOCITY_Y ? MySolarSystemStrings.dataPanel.VyStringProperty : '';
    const labelNode = new RichText(labelString, combineOptions({
      maxWidth: 60
    }, SolarSystemCommonConstants.TEXT_OPTIONS));

    // Create the VBox container for the contentNodes of the column.
    const contentContainer = new VBox({
      spacing: options.contentContainerSpacing,
      stretch: true
    });

    // Loop through each possible Body and create the corresponding contentNode. These Bodies are NOT necessarily the
    // active bodies, so we are responsible for updating visibility based on whether it is
    // the system.
    model.availableBodies.forEach(body => {
      // Retrieve the color from the colors palette
      const colorProperty = body.colorProperty;

      // Create the corresponding contentNode for each available body.
      const contentNode = ValuesColumnNode.createContentNode(body, columnType, model, colorProperty);

      // Add the content to the container.
      contentContainer.addChild(contentNode);

      // Observe when Bodies are added or removed from the Model, meaning the contentNode's visibility could change
      // if the body is added or removed from the system. It should only be visible if the body is in the Model.
      const onBodiesChanged = () => {
        contentNode.visible = model.bodies.includes(body);
      };
      onBodiesChanged();
      model.bodies.elementAddedEmitter.addListener(onBodiesChanged);
      model.bodies.elementRemovedEmitter.addListener(onBodiesChanged);
    });

    // Set the children of this Node to the correct rendering order.
    options.children = [LABEL_ALIGN_GROUP.createBox(labelNode), contentContainer];
    super(options);
  }
  static createContentNode(body, columnType, model, colorProperty) {
    // Flag that references the contentNode.
    let contentNode;
    const massRange = new RangeWithValue(0.1, 300, 100);
    const positionRangeX = new RangeWithValue(-8, 8, 0);
    const positionRangeY = new RangeWithValue(-4, 4, 0);
    const velocityRange = new RangeWithValue(-100, 100, 0);
    const clearPathsCallback = () => {
      model.clearPaths();
    };
    const sliderStep = SolarSystemCommonConstants.SLIDER_STEP;

    // Create the contentNode based on the columnType.
    if (columnType === ValuesColumnTypes.BODY_ICONS) {
      // Circle representation of the Body.
      const ballCircle = new Circle(10.5, {
        fill: colorProperty,
        stroke: Color.BLACK
      });

      // Labels the index of the Body
      const labelNode = new Text(body.index + 1, {
        font: new PhetFont({
          size: 18,
          weight: 600
        }),
        center: ballCircle.center,
        stroke: Color.BLACK,
        fill: Color.WHITE
      });
      contentNode = new Node({
        children: [ballCircle, labelNode]
      });
    } else if (columnType === ValuesColumnTypes.MASS_SLIDER) {
      contentNode = new SolarSystemCommonNumberControl(body.massProperty, massRange, {
        sliderOptions: {
          keyboardStep: sliderStep,
          pageKeyboardStep: sliderStep * 2,
          thumbFill: colorProperty,
          thumbFillHighlighted: new DerivedProperty([colorProperty], color => color.colorUtilsBrighter(0.7)),
          constrainValue: value => massRange.constrainValue(sliderStep * Utils.roundSymmetric(value / sliderStep))
        },
        startCallback: () => {
          body.userControlledMassProperty.value = true;
        },
        endCallback: () => {
          body.userControlledMassProperty.value = false;
        },
        arrowButtonOptions: {
          fireOnDown: true
        }
      });
    } else if (columnType === ValuesColumnTypes.MASS) {
      contentNode = new InteractiveNumberDisplay(body.massProperty, massRange, MySolarSystemStrings.units.kgStringProperty, body.userControlledMassProperty, body.colorProperty, model.isPlayingProperty, 1, {
        useExponential: true,
        hideSmallValues: true
      });
    } else if (columnType === ValuesColumnTypes.POSITION_X) {
      contentNode = new InteractiveNumberDisplay(new MappedProperty(body.positionProperty, {
        reentrant: true,
        bidirectional: true,
        map: position => position.x * SolarSystemCommonConstants.POSITION_MULTIPLIER,
        inverseMap: x => new Vector2(x / SolarSystemCommonConstants.POSITION_MULTIPLIER, body.positionProperty.value.y)
      }), positionRangeX, SolarSystemCommonStrings.units.AUStringProperty, body.userControlledPositionProperty, body.colorProperty, model.isPlayingProperty, 2, {
        onEditCallback: clearPathsCallback
      });
    } else if (columnType === ValuesColumnTypes.POSITION_Y) {
      contentNode = new InteractiveNumberDisplay(new MappedProperty(body.positionProperty, {
        reentrant: true,
        bidirectional: true,
        map: position => position.y * SolarSystemCommonConstants.POSITION_MULTIPLIER,
        inverseMap: y => new Vector2(body.positionProperty.value.x, y / SolarSystemCommonConstants.POSITION_MULTIPLIER)
      }), positionRangeY, SolarSystemCommonStrings.units.AUStringProperty, body.userControlledPositionProperty, body.colorProperty, model.isPlayingProperty, 2, {
        onEditCallback: clearPathsCallback
      });
    } else if (columnType === ValuesColumnTypes.VELOCITY_X) {
      contentNode = new InteractiveNumberDisplay(new MappedProperty(body.velocityProperty, {
        reentrant: true,
        bidirectional: true,
        map: velocity => velocity.x * SolarSystemCommonConstants.VELOCITY_MULTIPLIER,
        inverseMap: x => new Vector2(x / SolarSystemCommonConstants.VELOCITY_MULTIPLIER, body.velocityProperty.value.y)
      }), velocityRange, SolarSystemCommonStrings.units.kmsStringProperty, body.userControlledVelocityProperty, body.colorProperty, model.isPlayingProperty, 2, {
        onEditCallback: clearPathsCallback
      });
    } else if (columnType === ValuesColumnTypes.VELOCITY_Y) {
      contentNode = new InteractiveNumberDisplay(new MappedProperty(body.velocityProperty, {
        reentrant: true,
        bidirectional: true,
        map: velocity => velocity.y * SolarSystemCommonConstants.VELOCITY_MULTIPLIER,
        inverseMap: y => new Vector2(body.velocityProperty.value.x, y / SolarSystemCommonConstants.VELOCITY_MULTIPLIER)
      }), velocityRange, SolarSystemCommonStrings.units.kmsStringProperty, body.userControlledVelocityProperty, body.colorProperty, model.isPlayingProperty, 2, {
        onEditCallback: clearPathsCallback
      });
    } else {
      contentNode = new Node();
    }

    // Wrap the contentNode in a AlignBox to match the height of all ContentNodes.
    return CONTENT_ALIGN_GROUP.createBox(contentNode);
  }
}
mySolarSystem.register('ValuesColumnNode', ValuesColumnNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBbGlnbkdyb3VwIiwiQ2lyY2xlIiwiQ29sb3IiLCJOb2RlIiwiUmljaFRleHQiLCJUZXh0IiwiVkJveCIsIm15U29sYXJTeXN0ZW0iLCJWYWx1ZXNDb2x1bW5UeXBlcyIsIlNvbGFyU3lzdGVtQ29tbW9uQ29uc3RhbnRzIiwiU29sYXJTeXN0ZW1Db21tb25OdW1iZXJDb250cm9sIiwiUmFuZ2VXaXRoVmFsdWUiLCJNeVNvbGFyU3lzdGVtU3RyaW5ncyIsIk1hcHBlZFByb3BlcnR5IiwiVmVjdG9yMiIsIkludGVyYWN0aXZlTnVtYmVyRGlzcGxheSIsIlV0aWxzIiwiRGVyaXZlZFByb3BlcnR5Iiwib3B0aW9uaXplIiwiY29tYmluZU9wdGlvbnMiLCJTb2xhclN5c3RlbUNvbW1vblN0cmluZ3MiLCJQaGV0Rm9udCIsIkxBQkVMX0FMSUdOX0dST1VQIiwibWF0Y2hIb3Jpem9udGFsIiwibWF0Y2hWZXJ0aWNhbCIsIkNPTlRFTlRfQUxJR05fR1JPVVAiLCJWYWx1ZXNDb2x1bW5Ob2RlIiwiY29uc3RydWN0b3IiLCJtb2RlbCIsImNvbHVtblR5cGUiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwiY29udGVudENvbnRhaW5lclNwYWNpbmciLCJsYWJlbFNwYWNpbmciLCJzdHJldGNoIiwibGFiZWxTdHJpbmciLCJQT1NJVElPTl9YIiwiZGF0YVBhbmVsIiwiWFN0cmluZ1Byb3BlcnR5IiwiUE9TSVRJT05fWSIsIllTdHJpbmdQcm9wZXJ0eSIsIlZFTE9DSVRZX1giLCJWeFN0cmluZ1Byb3BlcnR5IiwiVkVMT0NJVFlfWSIsIlZ5U3RyaW5nUHJvcGVydHkiLCJsYWJlbE5vZGUiLCJtYXhXaWR0aCIsIlRFWFRfT1BUSU9OUyIsImNvbnRlbnRDb250YWluZXIiLCJzcGFjaW5nIiwiYXZhaWxhYmxlQm9kaWVzIiwiZm9yRWFjaCIsImJvZHkiLCJjb2xvclByb3BlcnR5IiwiY29udGVudE5vZGUiLCJjcmVhdGVDb250ZW50Tm9kZSIsImFkZENoaWxkIiwib25Cb2RpZXNDaGFuZ2VkIiwidmlzaWJsZSIsImJvZGllcyIsImluY2x1ZGVzIiwiZWxlbWVudEFkZGVkRW1pdHRlciIsImFkZExpc3RlbmVyIiwiZWxlbWVudFJlbW92ZWRFbWl0dGVyIiwiY2hpbGRyZW4iLCJjcmVhdGVCb3giLCJtYXNzUmFuZ2UiLCJwb3NpdGlvblJhbmdlWCIsInBvc2l0aW9uUmFuZ2VZIiwidmVsb2NpdHlSYW5nZSIsImNsZWFyUGF0aHNDYWxsYmFjayIsImNsZWFyUGF0aHMiLCJzbGlkZXJTdGVwIiwiU0xJREVSX1NURVAiLCJCT0RZX0lDT05TIiwiYmFsbENpcmNsZSIsImZpbGwiLCJzdHJva2UiLCJCTEFDSyIsImluZGV4IiwiZm9udCIsInNpemUiLCJ3ZWlnaHQiLCJjZW50ZXIiLCJXSElURSIsIk1BU1NfU0xJREVSIiwibWFzc1Byb3BlcnR5Iiwic2xpZGVyT3B0aW9ucyIsImtleWJvYXJkU3RlcCIsInBhZ2VLZXlib2FyZFN0ZXAiLCJ0aHVtYkZpbGwiLCJ0aHVtYkZpbGxIaWdobGlnaHRlZCIsImNvbG9yIiwiY29sb3JVdGlsc0JyaWdodGVyIiwiY29uc3RyYWluVmFsdWUiLCJ2YWx1ZSIsInJvdW5kU3ltbWV0cmljIiwic3RhcnRDYWxsYmFjayIsInVzZXJDb250cm9sbGVkTWFzc1Byb3BlcnR5IiwiZW5kQ2FsbGJhY2siLCJhcnJvd0J1dHRvbk9wdGlvbnMiLCJmaXJlT25Eb3duIiwiTUFTUyIsInVuaXRzIiwia2dTdHJpbmdQcm9wZXJ0eSIsImlzUGxheWluZ1Byb3BlcnR5IiwidXNlRXhwb25lbnRpYWwiLCJoaWRlU21hbGxWYWx1ZXMiLCJwb3NpdGlvblByb3BlcnR5IiwicmVlbnRyYW50IiwiYmlkaXJlY3Rpb25hbCIsIm1hcCIsInBvc2l0aW9uIiwieCIsIlBPU0lUSU9OX01VTFRJUExJRVIiLCJpbnZlcnNlTWFwIiwieSIsIkFVU3RyaW5nUHJvcGVydHkiLCJ1c2VyQ29udHJvbGxlZFBvc2l0aW9uUHJvcGVydHkiLCJvbkVkaXRDYWxsYmFjayIsInZlbG9jaXR5UHJvcGVydHkiLCJ2ZWxvY2l0eSIsIlZFTE9DSVRZX01VTFRJUExJRVIiLCJrbXNTdHJpbmdQcm9wZXJ0eSIsInVzZXJDb250cm9sbGVkVmVsb2NpdHlQcm9wZXJ0eSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiVmFsdWVzQ29sdW1uTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMi0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZXMgdGhlIGluZm9ybWF0aW9uIGNvbHVtbiBmb3IgdmFsdWVzIGRlcGVuZGluZyBvbiB0aGUgdHlwZSBvZiBWYWx1ZSB1c2VkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEFndXN0w61uIFZhbGxlam8gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQWxpZ25Cb3gsIEFsaWduR3JvdXAsIENpcmNsZSwgQ29sb3IsIE5vZGUsIFJpY2hUZXh0LCBUZXh0LCBUZXh0T3B0aW9ucywgVkJveCwgVkJveE9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgbXlTb2xhclN5c3RlbSBmcm9tICcuLi8uLi9teVNvbGFyU3lzdGVtLmpzJztcclxuaW1wb3J0IFZhbHVlc0NvbHVtblR5cGVzIGZyb20gJy4vVmFsdWVzQ29sdW1uVHlwZXMuanMnO1xyXG5pbXBvcnQgU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMgZnJvbSAnLi4vLi4vLi4vLi4vc29sYXItc3lzdGVtLWNvbW1vbi9qcy9Tb2xhclN5c3RlbUNvbW1vbkNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBTb2xhclN5c3RlbUNvbW1vbk51bWJlckNvbnRyb2wgZnJvbSAnLi4vLi4vLi4vLi4vc29sYXItc3lzdGVtLWNvbW1vbi9qcy92aWV3L1NvbGFyU3lzdGVtQ29tbW9uTnVtYmVyQ29udHJvbC5qcyc7XHJcbmltcG9ydCBCb2R5IGZyb20gJy4uLy4uLy4uLy4uL3NvbGFyLXN5c3RlbS1jb21tb24vanMvbW9kZWwvQm9keS5qcyc7XHJcbmltcG9ydCBSYW5nZVdpdGhWYWx1ZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2VXaXRoVmFsdWUuanMnO1xyXG5pbXBvcnQgTXlTb2xhclN5c3RlbVN0cmluZ3MgZnJvbSAnLi4vLi4vTXlTb2xhclN5c3RlbVN0cmluZ3MuanMnO1xyXG5pbXBvcnQgTWFwcGVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9NYXBwZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IEludGVyYWN0aXZlTnVtYmVyRGlzcGxheSBmcm9tICcuL0ludGVyYWN0aXZlTnVtYmVyRGlzcGxheS5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IGNvbWJpbmVPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBTdHJpY3RPbWl0IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9TdHJpY3RPbWl0LmpzJztcclxuaW1wb3J0IE15U29sYXJTeXN0ZW1Nb2RlbCBmcm9tICcuLi9tb2RlbC9NeVNvbGFyU3lzdGVtTW9kZWwuanMnO1xyXG5pbXBvcnQgU29sYXJTeXN0ZW1Db21tb25TdHJpbmdzIGZyb20gJy4uLy4uLy4uLy4uL3NvbGFyLXN5c3RlbS1jb21tb24vanMvU29sYXJTeXN0ZW1Db21tb25TdHJpbmdzLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcblxyXG5jb25zdCBMQUJFTF9BTElHTl9HUk9VUCA9IG5ldyBBbGlnbkdyb3VwKCB7IG1hdGNoSG9yaXpvbnRhbDogZmFsc2UsIG1hdGNoVmVydGljYWw6IHRydWUgfSApO1xyXG5jb25zdCBDT05URU5UX0FMSUdOX0dST1VQID0gbmV3IEFsaWduR3JvdXAoIHsgbWF0Y2hIb3Jpem9udGFsOiBmYWxzZSwgbWF0Y2hWZXJ0aWNhbDogdHJ1ZSB9ICk7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIGNvbnRlbnRDb250YWluZXJTcGFjaW5nPzogbnVtYmVyO1xyXG4gIGxhYmVsU3BhY2luZz86IG51bWJlcjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFZhbHVlc0NvbHVtbk5vZGVPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBTdHJpY3RPbWl0PFZCb3hPcHRpb25zLCAnY2hpbGRyZW4nPjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZhbHVlc0NvbHVtbk5vZGUgZXh0ZW5kcyBWQm94IHtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoIG1vZGVsOiBNeVNvbGFyU3lzdGVtTW9kZWwsIGNvbHVtblR5cGU6IFZhbHVlc0NvbHVtblR5cGVzLCBwcm92aWRlZE9wdGlvbnM/OiBWYWx1ZXNDb2x1bW5Ob2RlT3B0aW9ucyApIHtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8VmFsdWVzQ29sdW1uTm9kZU9wdGlvbnMsIFNlbGZPcHRpb25zLCBWQm94T3B0aW9ucz4oKSgge1xyXG4gICAgICBjb250ZW50Q29udGFpbmVyU3BhY2luZzogMy41LFxyXG4gICAgICBsYWJlbFNwYWNpbmc6IDMsXHJcbiAgICAgIHN0cmV0Y2g6IHRydWVcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IGxhYmVsU3RyaW5nID0gY29sdW1uVHlwZSA9PT0gVmFsdWVzQ29sdW1uVHlwZXMuUE9TSVRJT05fWCA/IE15U29sYXJTeXN0ZW1TdHJpbmdzLmRhdGFQYW5lbC5YU3RyaW5nUHJvcGVydHkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5UeXBlID09PSBWYWx1ZXNDb2x1bW5UeXBlcy5QT1NJVElPTl9ZID8gTXlTb2xhclN5c3RlbVN0cmluZ3MuZGF0YVBhbmVsLllTdHJpbmdQcm9wZXJ0eSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtblR5cGUgPT09IFZhbHVlc0NvbHVtblR5cGVzLlZFTE9DSVRZX1ggPyBNeVNvbGFyU3lzdGVtU3RyaW5ncy5kYXRhUGFuZWwuVnhTdHJpbmdQcm9wZXJ0eSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtblR5cGUgPT09IFZhbHVlc0NvbHVtblR5cGVzLlZFTE9DSVRZX1kgPyBNeVNvbGFyU3lzdGVtU3RyaW5ncy5kYXRhUGFuZWwuVnlTdHJpbmdQcm9wZXJ0eSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICcnO1xyXG5cclxuICAgIGNvbnN0IGxhYmVsTm9kZSA9IG5ldyBSaWNoVGV4dCggbGFiZWxTdHJpbmcsIGNvbWJpbmVPcHRpb25zPFRleHRPcHRpb25zPigge1xyXG4gICAgICBtYXhXaWR0aDogNjBcclxuICAgIH0sIFNvbGFyU3lzdGVtQ29tbW9uQ29uc3RhbnRzLlRFWFRfT1BUSU9OUyApICk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRoZSBWQm94IGNvbnRhaW5lciBmb3IgdGhlIGNvbnRlbnROb2RlcyBvZiB0aGUgY29sdW1uLlxyXG4gICAgY29uc3QgY29udGVudENvbnRhaW5lciA9IG5ldyBWQm94KCB7IHNwYWNpbmc6IG9wdGlvbnMuY29udGVudENvbnRhaW5lclNwYWNpbmcsIHN0cmV0Y2g6IHRydWUgfSApO1xyXG5cclxuICAgIC8vIExvb3AgdGhyb3VnaCBlYWNoIHBvc3NpYmxlIEJvZHkgYW5kIGNyZWF0ZSB0aGUgY29ycmVzcG9uZGluZyBjb250ZW50Tm9kZS4gVGhlc2UgQm9kaWVzIGFyZSBOT1QgbmVjZXNzYXJpbHkgdGhlXHJcbiAgICAvLyBhY3RpdmUgYm9kaWVzLCBzbyB3ZSBhcmUgcmVzcG9uc2libGUgZm9yIHVwZGF0aW5nIHZpc2liaWxpdHkgYmFzZWQgb24gd2hldGhlciBpdCBpc1xyXG4gICAgLy8gdGhlIHN5c3RlbS5cclxuICAgIG1vZGVsLmF2YWlsYWJsZUJvZGllcy5mb3JFYWNoKCBib2R5ID0+IHtcclxuXHJcbiAgICAgIC8vIFJldHJpZXZlIHRoZSBjb2xvciBmcm9tIHRoZSBjb2xvcnMgcGFsZXR0ZVxyXG4gICAgICBjb25zdCBjb2xvclByb3BlcnR5ID0gYm9keS5jb2xvclByb3BlcnR5O1xyXG5cclxuICAgICAgLy8gQ3JlYXRlIHRoZSBjb3JyZXNwb25kaW5nIGNvbnRlbnROb2RlIGZvciBlYWNoIGF2YWlsYWJsZSBib2R5LlxyXG4gICAgICBjb25zdCBjb250ZW50Tm9kZSA9IFZhbHVlc0NvbHVtbk5vZGUuY3JlYXRlQ29udGVudE5vZGUoIGJvZHksIGNvbHVtblR5cGUsIG1vZGVsLCBjb2xvclByb3BlcnR5ICk7XHJcblxyXG4gICAgICAvLyBBZGQgdGhlIGNvbnRlbnQgdG8gdGhlIGNvbnRhaW5lci5cclxuICAgICAgY29udGVudENvbnRhaW5lci5hZGRDaGlsZCggY29udGVudE5vZGUgKTtcclxuXHJcbiAgICAgIC8vIE9ic2VydmUgd2hlbiBCb2RpZXMgYXJlIGFkZGVkIG9yIHJlbW92ZWQgZnJvbSB0aGUgTW9kZWwsIG1lYW5pbmcgdGhlIGNvbnRlbnROb2RlJ3MgdmlzaWJpbGl0eSBjb3VsZCBjaGFuZ2VcclxuICAgICAgLy8gaWYgdGhlIGJvZHkgaXMgYWRkZWQgb3IgcmVtb3ZlZCBmcm9tIHRoZSBzeXN0ZW0uIEl0IHNob3VsZCBvbmx5IGJlIHZpc2libGUgaWYgdGhlIGJvZHkgaXMgaW4gdGhlIE1vZGVsLlxyXG4gICAgICBjb25zdCBvbkJvZGllc0NoYW5nZWQgPSAoKSA9PiB7XHJcbiAgICAgICAgY29udGVudE5vZGUudmlzaWJsZSA9IG1vZGVsLmJvZGllcy5pbmNsdWRlcyggYm9keSApO1xyXG4gICAgICB9O1xyXG4gICAgICBvbkJvZGllc0NoYW5nZWQoKTtcclxuICAgICAgbW9kZWwuYm9kaWVzLmVsZW1lbnRBZGRlZEVtaXR0ZXIuYWRkTGlzdGVuZXIoIG9uQm9kaWVzQ2hhbmdlZCApO1xyXG4gICAgICBtb2RlbC5ib2RpZXMuZWxlbWVudFJlbW92ZWRFbWl0dGVyLmFkZExpc3RlbmVyKCBvbkJvZGllc0NoYW5nZWQgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBTZXQgdGhlIGNoaWxkcmVuIG9mIHRoaXMgTm9kZSB0byB0aGUgY29ycmVjdCByZW5kZXJpbmcgb3JkZXIuXHJcbiAgICBvcHRpb25zLmNoaWxkcmVuID0gWyBMQUJFTF9BTElHTl9HUk9VUC5jcmVhdGVCb3goIGxhYmVsTm9kZSApLCBjb250ZW50Q29udGFpbmVyIF07XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIGNyZWF0ZUNvbnRlbnROb2RlKCBib2R5OiBCb2R5LCBjb2x1bW5UeXBlOiBWYWx1ZXNDb2x1bW5UeXBlcywgbW9kZWw6IE15U29sYXJTeXN0ZW1Nb2RlbCwgY29sb3JQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Q29sb3I+ICk6IEFsaWduQm94IHtcclxuXHJcbiAgICAvLyBGbGFnIHRoYXQgcmVmZXJlbmNlcyB0aGUgY29udGVudE5vZGUuXHJcbiAgICBsZXQgY29udGVudE5vZGU7XHJcblxyXG4gICAgY29uc3QgbWFzc1JhbmdlID0gbmV3IFJhbmdlV2l0aFZhbHVlKCAwLjEsIDMwMCwgMTAwICk7XHJcbiAgICBjb25zdCBwb3NpdGlvblJhbmdlWCA9IG5ldyBSYW5nZVdpdGhWYWx1ZSggLTgsIDgsIDAgKTtcclxuICAgIGNvbnN0IHBvc2l0aW9uUmFuZ2VZID0gbmV3IFJhbmdlV2l0aFZhbHVlKCAtNCwgNCwgMCApO1xyXG4gICAgY29uc3QgdmVsb2NpdHlSYW5nZSA9IG5ldyBSYW5nZVdpdGhWYWx1ZSggLTEwMCwgMTAwLCAwICk7XHJcblxyXG4gICAgY29uc3QgY2xlYXJQYXRoc0NhbGxiYWNrID0gKCkgPT4ge1xyXG4gICAgICBtb2RlbC5jbGVhclBhdGhzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHNsaWRlclN0ZXAgPSBTb2xhclN5c3RlbUNvbW1vbkNvbnN0YW50cy5TTElERVJfU1RFUDtcclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIGNvbnRlbnROb2RlIGJhc2VkIG9uIHRoZSBjb2x1bW5UeXBlLlxyXG4gICAgaWYgKCBjb2x1bW5UeXBlID09PSBWYWx1ZXNDb2x1bW5UeXBlcy5CT0RZX0lDT05TICkge1xyXG5cclxuICAgICAgLy8gQ2lyY2xlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBCb2R5LlxyXG4gICAgICBjb25zdCBiYWxsQ2lyY2xlID0gbmV3IENpcmNsZSggMTAuNSwge1xyXG4gICAgICAgIGZpbGw6IGNvbG9yUHJvcGVydHksXHJcbiAgICAgICAgc3Ryb2tlOiBDb2xvci5CTEFDS1xyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICAvLyBMYWJlbHMgdGhlIGluZGV4IG9mIHRoZSBCb2R5XHJcbiAgICAgIGNvbnN0IGxhYmVsTm9kZSA9IG5ldyBUZXh0KCBib2R5LmluZGV4ICsgMSwge1xyXG4gICAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggeyBzaXplOiAxOCwgd2VpZ2h0OiA2MDAgfSApLFxyXG4gICAgICAgIGNlbnRlcjogYmFsbENpcmNsZS5jZW50ZXIsXHJcbiAgICAgICAgc3Ryb2tlOiBDb2xvci5CTEFDSyxcclxuICAgICAgICBmaWxsOiBDb2xvci5XSElURVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICBjb250ZW50Tm9kZSA9IG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIGJhbGxDaXJjbGUsIGxhYmVsTm9kZSBdIH0gKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBjb2x1bW5UeXBlID09PSBWYWx1ZXNDb2x1bW5UeXBlcy5NQVNTX1NMSURFUiApIHtcclxuICAgICAgY29udGVudE5vZGUgPSBuZXcgU29sYXJTeXN0ZW1Db21tb25OdW1iZXJDb250cm9sKCBib2R5Lm1hc3NQcm9wZXJ0eSwgbWFzc1JhbmdlLCB7XHJcbiAgICAgICAgc2xpZGVyT3B0aW9uczoge1xyXG4gICAgICAgICAga2V5Ym9hcmRTdGVwOiBzbGlkZXJTdGVwLFxyXG4gICAgICAgICAgcGFnZUtleWJvYXJkU3RlcDogc2xpZGVyU3RlcCAqIDIsXHJcbiAgICAgICAgICB0aHVtYkZpbGw6IGNvbG9yUHJvcGVydHksXHJcbiAgICAgICAgICB0aHVtYkZpbGxIaWdobGlnaHRlZDogbmV3IERlcml2ZWRQcm9wZXJ0eSggWyBjb2xvclByb3BlcnR5IF0sIGNvbG9yID0+IGNvbG9yLmNvbG9yVXRpbHNCcmlnaHRlciggMC43ICkgKSxcclxuICAgICAgICAgIGNvbnN0cmFpblZhbHVlOiB2YWx1ZSA9PiBtYXNzUmFuZ2UuY29uc3RyYWluVmFsdWUoIHNsaWRlclN0ZXAgKiBVdGlscy5yb3VuZFN5bW1ldHJpYyggdmFsdWUgLyBzbGlkZXJTdGVwICkgKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RhcnRDYWxsYmFjazogKCkgPT4geyBib2R5LnVzZXJDb250cm9sbGVkTWFzc1Byb3BlcnR5LnZhbHVlID0gdHJ1ZTsgfSxcclxuICAgICAgICBlbmRDYWxsYmFjazogKCkgPT4geyBib2R5LnVzZXJDb250cm9sbGVkTWFzc1Byb3BlcnR5LnZhbHVlID0gZmFsc2U7IH0sXHJcbiAgICAgICAgYXJyb3dCdXR0b25PcHRpb25zOiB7XHJcbiAgICAgICAgICBmaXJlT25Eb3duOiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggY29sdW1uVHlwZSA9PT0gVmFsdWVzQ29sdW1uVHlwZXMuTUFTUyApIHtcclxuICAgICAgY29udGVudE5vZGUgPSBuZXcgSW50ZXJhY3RpdmVOdW1iZXJEaXNwbGF5KFxyXG4gICAgICAgIGJvZHkubWFzc1Byb3BlcnR5LFxyXG4gICAgICAgIG1hc3NSYW5nZSxcclxuICAgICAgICBNeVNvbGFyU3lzdGVtU3RyaW5ncy51bml0cy5rZ1N0cmluZ1Byb3BlcnR5LFxyXG4gICAgICAgIGJvZHkudXNlckNvbnRyb2xsZWRNYXNzUHJvcGVydHksXHJcbiAgICAgICAgYm9keS5jb2xvclByb3BlcnR5LCBtb2RlbC5pc1BsYXlpbmdQcm9wZXJ0eSwgMSwge1xyXG4gICAgICAgICAgdXNlRXhwb25lbnRpYWw6IHRydWUsXHJcbiAgICAgICAgICBoaWRlU21hbGxWYWx1ZXM6IHRydWVcclxuICAgICAgICB9ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggY29sdW1uVHlwZSA9PT0gVmFsdWVzQ29sdW1uVHlwZXMuUE9TSVRJT05fWCApIHtcclxuICAgICAgY29udGVudE5vZGUgPSBuZXcgSW50ZXJhY3RpdmVOdW1iZXJEaXNwbGF5KFxyXG4gICAgICAgIG5ldyBNYXBwZWRQcm9wZXJ0eSggYm9keS5wb3NpdGlvblByb3BlcnR5LCB7XHJcbiAgICAgICAgICByZWVudHJhbnQ6IHRydWUsXHJcbiAgICAgICAgICBiaWRpcmVjdGlvbmFsOiB0cnVlLFxyXG4gICAgICAgICAgbWFwOiBwb3NpdGlvbiA9PiBwb3NpdGlvbi54ICogU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMuUE9TSVRJT05fTVVMVElQTElFUixcclxuICAgICAgICAgIGludmVyc2VNYXA6ICggeDogbnVtYmVyICkgPT4gbmV3IFZlY3RvcjIoIHggLyBTb2xhclN5c3RlbUNvbW1vbkNvbnN0YW50cy5QT1NJVElPTl9NVUxUSVBMSUVSLCBib2R5LnBvc2l0aW9uUHJvcGVydHkudmFsdWUueSApXHJcbiAgICAgICAgfSApLFxyXG4gICAgICAgIHBvc2l0aW9uUmFuZ2VYLFxyXG4gICAgICAgIFNvbGFyU3lzdGVtQ29tbW9uU3RyaW5ncy51bml0cy5BVVN0cmluZ1Byb3BlcnR5LFxyXG4gICAgICAgIGJvZHkudXNlckNvbnRyb2xsZWRQb3NpdGlvblByb3BlcnR5LFxyXG4gICAgICAgIGJvZHkuY29sb3JQcm9wZXJ0eSwgbW9kZWwuaXNQbGF5aW5nUHJvcGVydHksIDIsIHtcclxuICAgICAgICAgIG9uRWRpdENhbGxiYWNrOiBjbGVhclBhdGhzQ2FsbGJhY2tcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggY29sdW1uVHlwZSA9PT0gVmFsdWVzQ29sdW1uVHlwZXMuUE9TSVRJT05fWSApIHtcclxuICAgICAgY29udGVudE5vZGUgPSBuZXcgSW50ZXJhY3RpdmVOdW1iZXJEaXNwbGF5KFxyXG4gICAgICAgIG5ldyBNYXBwZWRQcm9wZXJ0eSggYm9keS5wb3NpdGlvblByb3BlcnR5LCB7XHJcbiAgICAgICAgICByZWVudHJhbnQ6IHRydWUsXHJcbiAgICAgICAgICBiaWRpcmVjdGlvbmFsOiB0cnVlLFxyXG4gICAgICAgICAgbWFwOiBwb3NpdGlvbiA9PiBwb3NpdGlvbi55ICogU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMuUE9TSVRJT05fTVVMVElQTElFUixcclxuICAgICAgICAgIGludmVyc2VNYXA6ICggeTogbnVtYmVyICkgPT4gbmV3IFZlY3RvcjIoIGJvZHkucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZS54LCB5IC8gU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMuUE9TSVRJT05fTVVMVElQTElFUiApXHJcbiAgICAgICAgfSApLFxyXG4gICAgICAgIHBvc2l0aW9uUmFuZ2VZLFxyXG4gICAgICAgIFNvbGFyU3lzdGVtQ29tbW9uU3RyaW5ncy51bml0cy5BVVN0cmluZ1Byb3BlcnR5LFxyXG4gICAgICAgIGJvZHkudXNlckNvbnRyb2xsZWRQb3NpdGlvblByb3BlcnR5LFxyXG4gICAgICAgIGJvZHkuY29sb3JQcm9wZXJ0eSwgbW9kZWwuaXNQbGF5aW5nUHJvcGVydHksIDIsIHtcclxuICAgICAgICAgIG9uRWRpdENhbGxiYWNrOiBjbGVhclBhdGhzQ2FsbGJhY2tcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggY29sdW1uVHlwZSA9PT0gVmFsdWVzQ29sdW1uVHlwZXMuVkVMT0NJVFlfWCApIHtcclxuICAgICAgY29udGVudE5vZGUgPSBuZXcgSW50ZXJhY3RpdmVOdW1iZXJEaXNwbGF5KFxyXG4gICAgICAgIG5ldyBNYXBwZWRQcm9wZXJ0eSggYm9keS52ZWxvY2l0eVByb3BlcnR5LCB7XHJcbiAgICAgICAgICByZWVudHJhbnQ6IHRydWUsXHJcbiAgICAgICAgICBiaWRpcmVjdGlvbmFsOiB0cnVlLFxyXG4gICAgICAgICAgbWFwOiB2ZWxvY2l0eSA9PiB2ZWxvY2l0eS54ICogU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMuVkVMT0NJVFlfTVVMVElQTElFUixcclxuICAgICAgICAgIGludmVyc2VNYXA6ICggeDogbnVtYmVyICkgPT4gbmV3IFZlY3RvcjIoIHggLyBTb2xhclN5c3RlbUNvbW1vbkNvbnN0YW50cy5WRUxPQ0lUWV9NVUxUSVBMSUVSLCBib2R5LnZlbG9jaXR5UHJvcGVydHkudmFsdWUueSApXHJcbiAgICAgICAgfSApLFxyXG4gICAgICAgIHZlbG9jaXR5UmFuZ2UsXHJcbiAgICAgICAgU29sYXJTeXN0ZW1Db21tb25TdHJpbmdzLnVuaXRzLmttc1N0cmluZ1Byb3BlcnR5LFxyXG4gICAgICAgIGJvZHkudXNlckNvbnRyb2xsZWRWZWxvY2l0eVByb3BlcnR5LFxyXG4gICAgICAgIGJvZHkuY29sb3JQcm9wZXJ0eSwgbW9kZWwuaXNQbGF5aW5nUHJvcGVydHksIDIsIHtcclxuICAgICAgICAgIG9uRWRpdENhbGxiYWNrOiBjbGVhclBhdGhzQ2FsbGJhY2tcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggY29sdW1uVHlwZSA9PT0gVmFsdWVzQ29sdW1uVHlwZXMuVkVMT0NJVFlfWSApIHtcclxuICAgICAgY29udGVudE5vZGUgPSBuZXcgSW50ZXJhY3RpdmVOdW1iZXJEaXNwbGF5KFxyXG4gICAgICAgIG5ldyBNYXBwZWRQcm9wZXJ0eSggYm9keS52ZWxvY2l0eVByb3BlcnR5LCB7XHJcbiAgICAgICAgICByZWVudHJhbnQ6IHRydWUsXHJcbiAgICAgICAgICBiaWRpcmVjdGlvbmFsOiB0cnVlLFxyXG4gICAgICAgICAgbWFwOiB2ZWxvY2l0eSA9PiB2ZWxvY2l0eS55ICogU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMuVkVMT0NJVFlfTVVMVElQTElFUixcclxuICAgICAgICAgIGludmVyc2VNYXA6ICggeTogbnVtYmVyICkgPT4gbmV3IFZlY3RvcjIoIGJvZHkudmVsb2NpdHlQcm9wZXJ0eS52YWx1ZS54LCB5IC8gU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMuVkVMT0NJVFlfTVVMVElQTElFUiApXHJcbiAgICAgICAgfSApLFxyXG4gICAgICAgIHZlbG9jaXR5UmFuZ2UsXHJcbiAgICAgICAgU29sYXJTeXN0ZW1Db21tb25TdHJpbmdzLnVuaXRzLmttc1N0cmluZ1Byb3BlcnR5LFxyXG4gICAgICAgIGJvZHkudXNlckNvbnRyb2xsZWRWZWxvY2l0eVByb3BlcnR5LFxyXG4gICAgICAgIGJvZHkuY29sb3JQcm9wZXJ0eSwgbW9kZWwuaXNQbGF5aW5nUHJvcGVydHksIDIsIHtcclxuICAgICAgICAgIG9uRWRpdENhbGxiYWNrOiBjbGVhclBhdGhzQ2FsbGJhY2tcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgY29udGVudE5vZGUgPSBuZXcgTm9kZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFdyYXAgdGhlIGNvbnRlbnROb2RlIGluIGEgQWxpZ25Cb3ggdG8gbWF0Y2ggdGhlIGhlaWdodCBvZiBhbGwgQ29udGVudE5vZGVzLlxyXG4gICAgcmV0dXJuIENPTlRFTlRfQUxJR05fR1JPVVAuY3JlYXRlQm94KCBjb250ZW50Tm9kZSApO1xyXG4gIH1cclxufVxyXG5cclxubXlTb2xhclN5c3RlbS5yZWdpc3RlciggJ1ZhbHVlc0NvbHVtbk5vZGUnLCBWYWx1ZXNDb2x1bW5Ob2RlICk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFtQkEsVUFBVSxFQUFFQyxNQUFNLEVBQUVDLEtBQUssRUFBRUMsSUFBSSxFQUFFQyxRQUFRLEVBQUVDLElBQUksRUFBZUMsSUFBSSxRQUFxQixtQ0FBbUM7QUFDN0ksT0FBT0MsYUFBYSxNQUFNLHdCQUF3QjtBQUNsRCxPQUFPQyxpQkFBaUIsTUFBTSx3QkFBd0I7QUFDdEQsT0FBT0MsMEJBQTBCLE1BQU0sa0VBQWtFO0FBQ3pHLE9BQU9DLDhCQUE4QixNQUFNLDJFQUEyRTtBQUV0SCxPQUFPQyxjQUFjLE1BQU0sc0NBQXNDO0FBQ2pFLE9BQU9DLG9CQUFvQixNQUFNLCtCQUErQjtBQUNoRSxPQUFPQyxjQUFjLE1BQU0sdUNBQXVDO0FBQ2xFLE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsT0FBT0Msd0JBQXdCLE1BQU0sK0JBQStCO0FBQ3BFLE9BQU9DLEtBQUssTUFBTSw2QkFBNkI7QUFFL0MsT0FBT0MsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxTQUFTLElBQUlDLGNBQWMsUUFBUSx1Q0FBdUM7QUFHakYsT0FBT0Msd0JBQXdCLE1BQU0sZ0VBQWdFO0FBQ3JHLE9BQU9DLFFBQVEsTUFBTSx5Q0FBeUM7QUFFOUQsTUFBTUMsaUJBQWlCLEdBQUcsSUFBSXRCLFVBQVUsQ0FBRTtFQUFFdUIsZUFBZSxFQUFFLEtBQUs7RUFBRUMsYUFBYSxFQUFFO0FBQUssQ0FBRSxDQUFDO0FBQzNGLE1BQU1DLG1CQUFtQixHQUFHLElBQUl6QixVQUFVLENBQUU7RUFBRXVCLGVBQWUsRUFBRSxLQUFLO0VBQUVDLGFBQWEsRUFBRTtBQUFLLENBQUUsQ0FBQztBQVM3RixlQUFlLE1BQU1FLGdCQUFnQixTQUFTcEIsSUFBSSxDQUFDO0VBQzFD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