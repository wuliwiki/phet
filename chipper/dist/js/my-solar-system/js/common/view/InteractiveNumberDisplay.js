// Copyright 2022-2023, University of Colorado Boulder
/**
 * NumberDisplay used in the panel to control Masses, Position and Velocity
 *
 * @author AgustÃ­n Vallejo (PhET Interactive Simulations)
 */

import mySolarSystem from '../../mySolarSystem.js';
import SolarSystemCommonConstants from '../../../../solar-system-common/js/SolarSystemCommonConstants.js';
import MySolarSystemStrings from '../../MySolarSystemStrings.js';
import NumberDisplay from '../../../../scenery-phet/js/NumberDisplay.js';
import optionize from '../../../../phet-core/js/optionize.js';
import KeypadDialog from '../../../../scenery-phet/js/keypad/KeypadDialog.js';
import { Color, FireListener, InteractiveHighlighting, PressListener } from '../../../../scenery/js/imports.js';
import PatternStringProperty from '../../../../axon/js/PatternStringProperty.js';
import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Utils from '../../../../dot/js/Utils.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import Tandem from '../../../../tandem/js/Tandem.js';
export default class InteractiveNumberDisplay extends InteractiveHighlighting(NumberDisplay) {
  constructor(property, range, units, userControlledProperty, bodyColorProperty, isPlayingProperty, decimalPlaces, providedOptions) {
    const isKeypadActiveProperty = new BooleanProperty(false);

    // Keypad dialog
    const keypadDialog = new KeypadDialog({
      useRichTextRange: true,
      keypadOptions: {
        accumulatorOptions: {
          // Max is 300, but we need 4 digits to support numbers like 123.4
          maxDigits: 5,
          maxDigitsRightOfMantissa: 2
        }
      }
    });
    const hoverListener = new PressListener({
      tandem: Tandem.OPT_OUT,
      attach: false // Don't be greedy with the pointer, it would prevent the fire listener from activating
    });

    const options = optionize()({
      cursor: 'pointer',
      hideSmallValues: false,
      onEditCallback: _.noop,
      numberFormatter: n => {
        if (providedOptions?.hideSmallValues && Math.abs(n) <= 0.1) {
          return `${MathSymbols.LESS_THAN_OR_EQUAL} 0.1`;
        } else {
          return Utils.toFixed(n, decimalPlaces);
        }
      },
      useExponential: false,
      textOptions: {
        font: SolarSystemCommonConstants.PANEL_FONT
      },
      backgroundFill: new DerivedProperty([userControlledProperty, isKeypadActiveProperty, hoverListener.looksOverProperty, bodyColorProperty], (isUserControlled, isKeypadActive, looksOver, backgroundColor) => {
        return isUserControlled || isKeypadActive || looksOver ? backgroundColor.colorUtilsBrighter(0.7) : Color.WHITE;
      }),
      backgroundStroke: Color.BLACK,
      // a11y
      // innerContent to support dynamic changes
      innerContent: new DerivedProperty([property, units], (value, units) => {
        return `${Utils.toFixed(value, 2)} ${units}`;
      }),
      tagName: 'button',
      containerTagName: 'div'
    }, providedOptions);
    super(property, range, options);
    this.localBoundsProperty.link(localBounds => {
      this.touchArea = localBounds.dilatedXY(5, 3.5);
    });
    this.isKeypadActiveProperty = isKeypadActiveProperty;
    this.addInputListener(hoverListener);
    const patternStringProperty = new PatternStringProperty(MySolarSystemStrings.pattern.rangeStringProperty, {
      min: range.min,
      max: range.max
    });
    this.addInputListener(new FireListener({
      fire: () => {
        if (!userControlledProperty.value) {
          isKeypadActiveProperty.value = true;
          const wasPlaying = isPlayingProperty.value;
          isPlayingProperty.value = false;
          let changed = false;
          keypadDialog.beginEdit(value => {
            changed = true;
            property.value = value;
            userControlledProperty.value = true;
            options.onEditCallback();
          }, range, patternStringProperty, () => {
            isKeypadActiveProperty.value = false;
            userControlledProperty.value = false;
            if (!changed) {
              isPlayingProperty.value = wasPlaying;
            }
          });
        }
      },
      fireOnDown: true
    }));
  }
}
mySolarSystem.register('InteractiveNumberDisplay', InteractiveNumberDisplay);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJteVNvbGFyU3lzdGVtIiwiU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMiLCJNeVNvbGFyU3lzdGVtU3RyaW5ncyIsIk51bWJlckRpc3BsYXkiLCJvcHRpb25pemUiLCJLZXlwYWREaWFsb2ciLCJDb2xvciIsIkZpcmVMaXN0ZW5lciIsIkludGVyYWN0aXZlSGlnaGxpZ2h0aW5nIiwiUHJlc3NMaXN0ZW5lciIsIlBhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsIkJvb2xlYW5Qcm9wZXJ0eSIsIkRlcml2ZWRQcm9wZXJ0eSIsIlV0aWxzIiwiTWF0aFN5bWJvbHMiLCJUYW5kZW0iLCJJbnRlcmFjdGl2ZU51bWJlckRpc3BsYXkiLCJjb25zdHJ1Y3RvciIsInByb3BlcnR5IiwicmFuZ2UiLCJ1bml0cyIsInVzZXJDb250cm9sbGVkUHJvcGVydHkiLCJib2R5Q29sb3JQcm9wZXJ0eSIsImlzUGxheWluZ1Byb3BlcnR5IiwiZGVjaW1hbFBsYWNlcyIsInByb3ZpZGVkT3B0aW9ucyIsImlzS2V5cGFkQWN0aXZlUHJvcGVydHkiLCJrZXlwYWREaWFsb2ciLCJ1c2VSaWNoVGV4dFJhbmdlIiwia2V5cGFkT3B0aW9ucyIsImFjY3VtdWxhdG9yT3B0aW9ucyIsIm1heERpZ2l0cyIsIm1heERpZ2l0c1JpZ2h0T2ZNYW50aXNzYSIsImhvdmVyTGlzdGVuZXIiLCJ0YW5kZW0iLCJPUFRfT1VUIiwiYXR0YWNoIiwib3B0aW9ucyIsImN1cnNvciIsImhpZGVTbWFsbFZhbHVlcyIsIm9uRWRpdENhbGxiYWNrIiwiXyIsIm5vb3AiLCJudW1iZXJGb3JtYXR0ZXIiLCJuIiwiTWF0aCIsImFicyIsIkxFU1NfVEhBTl9PUl9FUVVBTCIsInRvRml4ZWQiLCJ1c2VFeHBvbmVudGlhbCIsInRleHRPcHRpb25zIiwiZm9udCIsIlBBTkVMX0ZPTlQiLCJiYWNrZ3JvdW5kRmlsbCIsImxvb2tzT3ZlclByb3BlcnR5IiwiaXNVc2VyQ29udHJvbGxlZCIsImlzS2V5cGFkQWN0aXZlIiwibG9va3NPdmVyIiwiYmFja2dyb3VuZENvbG9yIiwiY29sb3JVdGlsc0JyaWdodGVyIiwiV0hJVEUiLCJiYWNrZ3JvdW5kU3Ryb2tlIiwiQkxBQ0siLCJpbm5lckNvbnRlbnQiLCJ2YWx1ZSIsInRhZ05hbWUiLCJjb250YWluZXJUYWdOYW1lIiwibG9jYWxCb3VuZHNQcm9wZXJ0eSIsImxpbmsiLCJsb2NhbEJvdW5kcyIsInRvdWNoQXJlYSIsImRpbGF0ZWRYWSIsImFkZElucHV0TGlzdGVuZXIiLCJwYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJwYXR0ZXJuIiwicmFuZ2VTdHJpbmdQcm9wZXJ0eSIsIm1pbiIsIm1heCIsImZpcmUiLCJ3YXNQbGF5aW5nIiwiY2hhbmdlZCIsImJlZ2luRWRpdCIsImZpcmVPbkRvd24iLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkludGVyYWN0aXZlTnVtYmVyRGlzcGxheS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMi0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuLyoqXHJcbiAqIE51bWJlckRpc3BsYXkgdXNlZCBpbiB0aGUgcGFuZWwgdG8gY29udHJvbCBNYXNzZXMsIFBvc2l0aW9uIGFuZCBWZWxvY2l0eVxyXG4gKlxyXG4gKiBAYXV0aG9yIEFndXN0w61uIFZhbGxlam8gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IG15U29sYXJTeXN0ZW0gZnJvbSAnLi4vLi4vbXlTb2xhclN5c3RlbS5qcyc7XHJcbmltcG9ydCBTb2xhclN5c3RlbUNvbW1vbkNvbnN0YW50cyBmcm9tICcuLi8uLi8uLi8uLi9zb2xhci1zeXN0ZW0tY29tbW9uL2pzL1NvbGFyU3lzdGVtQ29tbW9uQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IE15U29sYXJTeXN0ZW1TdHJpbmdzIGZyb20gJy4uLy4uL015U29sYXJTeXN0ZW1TdHJpbmdzLmpzJztcclxuaW1wb3J0IE51bWJlckRpc3BsYXksIHsgTnVtYmVyRGlzcGxheU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvTnVtYmVyRGlzcGxheS5qcyc7XHJcbmltcG9ydCBUUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUmFuZ2VXaXRoVmFsdWUgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1JhbmdlV2l0aFZhbHVlLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgS2V5cGFkRGlhbG9nIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9rZXlwYWQvS2V5cGFkRGlhbG9nLmpzJztcclxuaW1wb3J0IHsgQ29sb3IsIEZpcmVMaXN0ZW5lciwgSW50ZXJhY3RpdmVIaWdobGlnaHRpbmcsIFByZXNzTGlzdGVuZXIgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgUGF0dGVyblN0cmluZ1Byb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUGF0dGVyblN0cmluZ1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IEJvb2xlYW5Qcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Jvb2xlYW5Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1V0aWxzLmpzJztcclxuaW1wb3J0IE1hdGhTeW1ib2xzIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9NYXRoU3ltYm9scy5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIHVzZUV4cG9uZW50aWFsPzogYm9vbGVhbjtcclxuICBoaWRlU21hbGxWYWx1ZXM/OiBib29sZWFuO1xyXG4gIG9uRWRpdENhbGxiYWNrPzogKCkgPT4gdm9pZDtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIEludGVyYWN0aXZlTnVtYmVyRGlzcGxheU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIE51bWJlckRpc3BsYXlPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW50ZXJhY3RpdmVOdW1iZXJEaXNwbGF5IGV4dGVuZHMgSW50ZXJhY3RpdmVIaWdobGlnaHRpbmcoIE51bWJlckRpc3BsYXkgKSB7XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBpc0tleXBhZEFjdGl2ZVByb3BlcnR5OiBUUHJvcGVydHk8Ym9vbGVhbj47XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihcclxuICAgIHByb3BlcnR5OiBUUHJvcGVydHk8bnVtYmVyPixcclxuICAgIHJhbmdlOiBSYW5nZVdpdGhWYWx1ZSxcclxuICAgIHVuaXRzOiBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+LFxyXG4gICAgdXNlckNvbnRyb2xsZWRQcm9wZXJ0eTogVFByb3BlcnR5PGJvb2xlYW4+LFxyXG4gICAgYm9keUNvbG9yUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PENvbG9yPixcclxuICAgIGlzUGxheWluZ1Byb3BlcnR5OiBUUHJvcGVydHk8Ym9vbGVhbj4sXHJcbiAgICBkZWNpbWFsUGxhY2VzOiBudW1iZXIsXHJcbiAgICBwcm92aWRlZE9wdGlvbnM/OiBJbnRlcmFjdGl2ZU51bWJlckRpc3BsYXlPcHRpb25zXHJcbiAgKSB7XHJcblxyXG4gICAgY29uc3QgaXNLZXlwYWRBY3RpdmVQcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIGZhbHNlICk7XHJcblxyXG4gICAgLy8gS2V5cGFkIGRpYWxvZ1xyXG4gICAgY29uc3Qga2V5cGFkRGlhbG9nID0gbmV3IEtleXBhZERpYWxvZygge1xyXG4gICAgICB1c2VSaWNoVGV4dFJhbmdlOiB0cnVlLFxyXG4gICAgICBrZXlwYWRPcHRpb25zOiB7XHJcbiAgICAgICAgYWNjdW11bGF0b3JPcHRpb25zOiB7XHJcblxyXG4gICAgICAgICAgLy8gTWF4IGlzIDMwMCwgYnV0IHdlIG5lZWQgNCBkaWdpdHMgdG8gc3VwcG9ydCBudW1iZXJzIGxpa2UgMTIzLjRcclxuICAgICAgICAgIG1heERpZ2l0czogNSxcclxuICAgICAgICAgIG1heERpZ2l0c1JpZ2h0T2ZNYW50aXNzYTogMlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGhvdmVyTGlzdGVuZXIgPSBuZXcgUHJlc3NMaXN0ZW5lcigge1xyXG4gICAgICB0YW5kZW06IFRhbmRlbS5PUFRfT1VULFxyXG4gICAgICBhdHRhY2g6IGZhbHNlIC8vIERvbid0IGJlIGdyZWVkeSB3aXRoIHRoZSBwb2ludGVyLCBpdCB3b3VsZCBwcmV2ZW50IHRoZSBmaXJlIGxpc3RlbmVyIGZyb20gYWN0aXZhdGluZ1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8SW50ZXJhY3RpdmVOdW1iZXJEaXNwbGF5T3B0aW9ucywgU2VsZk9wdGlvbnMsIE51bWJlckRpc3BsYXlPcHRpb25zPigpKCB7XHJcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG4gICAgICBoaWRlU21hbGxWYWx1ZXM6IGZhbHNlLFxyXG4gICAgICBvbkVkaXRDYWxsYmFjazogXy5ub29wLFxyXG4gICAgICBudW1iZXJGb3JtYXR0ZXI6ICggbjogbnVtYmVyICkgPT4ge1xyXG4gICAgICAgIGlmICggcHJvdmlkZWRPcHRpb25zPy5oaWRlU21hbGxWYWx1ZXMgJiYgTWF0aC5hYnMoIG4gKSA8PSAwLjEgKSB7XHJcbiAgICAgICAgICByZXR1cm4gYCR7TWF0aFN5bWJvbHMuTEVTU19USEFOX09SX0VRVUFMfSAwLjFgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBVdGlscy50b0ZpeGVkKCBuLCBkZWNpbWFsUGxhY2VzICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB1c2VFeHBvbmVudGlhbDogZmFsc2UsXHJcbiAgICAgIHRleHRPcHRpb25zOiB7XHJcbiAgICAgICAgZm9udDogU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMuUEFORUxfRk9OVFxyXG4gICAgICB9LFxyXG4gICAgICBiYWNrZ3JvdW5kRmlsbDogbmV3IERlcml2ZWRQcm9wZXJ0eSggW1xyXG4gICAgICAgIHVzZXJDb250cm9sbGVkUHJvcGVydHksXHJcbiAgICAgICAgaXNLZXlwYWRBY3RpdmVQcm9wZXJ0eSxcclxuICAgICAgICBob3Zlckxpc3RlbmVyLmxvb2tzT3ZlclByb3BlcnR5LFxyXG4gICAgICAgIGJvZHlDb2xvclByb3BlcnR5XHJcbiAgICAgIF0sICggaXNVc2VyQ29udHJvbGxlZCwgaXNLZXlwYWRBY3RpdmUsIGxvb2tzT3ZlciwgYmFja2dyb3VuZENvbG9yICkgPT4ge1xyXG4gICAgICAgIHJldHVybiBpc1VzZXJDb250cm9sbGVkIHx8IGlzS2V5cGFkQWN0aXZlIHx8IGxvb2tzT3ZlciA/IGJhY2tncm91bmRDb2xvci5jb2xvclV0aWxzQnJpZ2h0ZXIoIDAuNyApIDogQ29sb3IuV0hJVEU7XHJcbiAgICAgIH0gKSxcclxuICAgICAgYmFja2dyb3VuZFN0cm9rZTogQ29sb3IuQkxBQ0ssXHJcblxyXG4gICAgICAvLyBhMTF5XHJcbiAgICAgIC8vIGlubmVyQ29udGVudCB0byBzdXBwb3J0IGR5bmFtaWMgY2hhbmdlc1xyXG4gICAgICBpbm5lckNvbnRlbnQ6IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgcHJvcGVydHksIHVuaXRzIF0sICggdmFsdWUsIHVuaXRzICkgPT4ge1xyXG4gICAgICAgIHJldHVybiBgJHtVdGlscy50b0ZpeGVkKCB2YWx1ZSwgMiApfSAke3VuaXRzfWA7XHJcbiAgICAgIH0gKSxcclxuICAgICAgdGFnTmFtZTogJ2J1dHRvbicsXHJcbiAgICAgIGNvbnRhaW5lclRhZ05hbWU6ICdkaXYnXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggcHJvcGVydHksIHJhbmdlLCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5sb2NhbEJvdW5kc1Byb3BlcnR5LmxpbmsoIGxvY2FsQm91bmRzID0+IHtcclxuICAgICAgdGhpcy50b3VjaEFyZWEgPSBsb2NhbEJvdW5kcy5kaWxhdGVkWFkoIDUsIDMuNSApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuaXNLZXlwYWRBY3RpdmVQcm9wZXJ0eSA9IGlzS2V5cGFkQWN0aXZlUHJvcGVydHk7XHJcblxyXG4gICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCBob3Zlckxpc3RlbmVyICk7XHJcbiAgICBjb25zdCBwYXR0ZXJuU3RyaW5nUHJvcGVydHkgPSBuZXcgUGF0dGVyblN0cmluZ1Byb3BlcnR5KCBNeVNvbGFyU3lzdGVtU3RyaW5ncy5wYXR0ZXJuLnJhbmdlU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgbWluOiByYW5nZS5taW4sXHJcbiAgICAgIG1heDogcmFuZ2UubWF4XHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZElucHV0TGlzdGVuZXIoIG5ldyBGaXJlTGlzdGVuZXIoIHtcclxuICAgICAgZmlyZTogKCkgPT4ge1xyXG4gICAgICAgIGlmICggIXVzZXJDb250cm9sbGVkUHJvcGVydHkudmFsdWUgKSB7XHJcbiAgICAgICAgICBpc0tleXBhZEFjdGl2ZVByb3BlcnR5LnZhbHVlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICBjb25zdCB3YXNQbGF5aW5nID0gaXNQbGF5aW5nUHJvcGVydHkudmFsdWU7XHJcbiAgICAgICAgICBpc1BsYXlpbmdQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgIGxldCBjaGFuZ2VkID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAga2V5cGFkRGlhbG9nLmJlZ2luRWRpdCggdmFsdWUgPT4ge1xyXG4gICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIHByb3BlcnR5LnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgdXNlckNvbnRyb2xsZWRQcm9wZXJ0eS52YWx1ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgb3B0aW9ucy5vbkVkaXRDYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9LCByYW5nZSxcclxuICAgICAgICAgICAgcGF0dGVyblN0cmluZ1Byb3BlcnR5LCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgaXNLZXlwYWRBY3RpdmVQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIHVzZXJDb250cm9sbGVkUHJvcGVydHkudmFsdWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICBpZiAoICFjaGFuZ2VkICkge1xyXG4gICAgICAgICAgICAgICAgaXNQbGF5aW5nUHJvcGVydHkudmFsdWUgPSB3YXNQbGF5aW5nO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgZmlyZU9uRG93bjogdHJ1ZVxyXG4gICAgfSApICk7XHJcbiAgfVxyXG59XHJcblxyXG5teVNvbGFyU3lzdGVtLnJlZ2lzdGVyKCAnSW50ZXJhY3RpdmVOdW1iZXJEaXNwbGF5JywgSW50ZXJhY3RpdmVOdW1iZXJEaXNwbGF5ICk7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsYUFBYSxNQUFNLHdCQUF3QjtBQUNsRCxPQUFPQywwQkFBMEIsTUFBTSxrRUFBa0U7QUFDekcsT0FBT0Msb0JBQW9CLE1BQU0sK0JBQStCO0FBQ2hFLE9BQU9DLGFBQWEsTUFB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