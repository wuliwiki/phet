// Copyright 2020-2022, University of Colorado Boulder

/**
 * QUnit tests for RAPModel
 *
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

import Tandem from '../../../../tandem/js/Tandem.js';
import RAPModel from '../model/RAPModel.js';
import RAPRatioTuple from '../model/RAPRatioTuple.js';
import RatioTerm from '../model/RatioTerm.js';
import rapConstants from '../rapConstants.js';
import getKeyboardInputSnappingMapper from './getKeyboardInputSnappingMapper.js';
QUnit.module('getKeyboardInputSnappingMapperTests');

// Copied from keyboard step calculation in RAPScreenView.js
const keyboardStep = 1 / 2 / 10;
QUnit.test('keyboard input to model always can get in proportion: 2/7 moving down', assert => {
  const model = new RAPModel(Tandem.OPT_OUT);
  const ratioTupleProperty = model.ratio.tupleProperty;
  const getIdealValue = () => model.getIdealValueForTerm(RatioTerm.ANTECEDENT);
  const snapConserveFunction = getKeyboardInputSnappingMapper(getIdealValue, keyboardStep, keyboardStep * rapConstants.SHIFT_KEY_MULTIPLIER);
  model.targetRatioProperty.value = 2 / 7;
  ratioTupleProperty.value = new RAPRatioTuple(0.14, 0.4);
  let newValue = null;
  newValue = snapConserveFunction(0.13, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.13, 'one step down');
  newValue = snapConserveFunction(0.12, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.12, 'another step down');
  newValue = snapConserveFunction(0.11, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  const idealRatio = model.targetRatioProperty.value * ratioTupleProperty.value.consequent;
  assert.ok(ratioTupleProperty.value.antecedent === idealRatio, 'another step down should snap to in proportion');
  newValue = snapConserveFunction(ratioTupleProperty.value.antecedent - 0.01, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.10, 'another step down should snap to in proportion');
  newValue = snapConserveFunction(0.09, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.09, 'another step down should snap to in proportion');
});
QUnit.test('keyboard always can get in proportion: 2/7 moving up', assert => {
  const model = new RAPModel(Tandem.OPT_OUT);
  const ratioTupleProperty = model.ratio.tupleProperty;
  const getIdealValue = () => model.getIdealValueForTerm(RatioTerm.ANTECEDENT);
  const snapConserveFunction = getKeyboardInputSnappingMapper(getIdealValue, keyboardStep, keyboardStep * rapConstants.SHIFT_KEY_MULTIPLIER);
  model.targetRatioProperty.value = 2 / 7;
  ratioTupleProperty.value = new RAPRatioTuple(0.09, 0.4);
  let newValue = null;
  newValue = snapConserveFunction(0.1, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.1, 'step up');
  newValue = snapConserveFunction(0.11, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.11, 'step up');
  newValue = snapConserveFunction(0.12, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  const idealAntecedent = model.targetRatioProperty.value * ratioTupleProperty.value.consequent;
  assert.ok(ratioTupleProperty.value.antecedent === idealAntecedent, 'step up through ideal');
  newValue = snapConserveFunction(ratioTupleProperty.value.antecedent + 0.01, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.13, 'step up');
});
QUnit.test('test case of 3/4 "ish"', assert => {
  // Buggy case from https://github.com/phetsims/ratio-and-proportion/issues/354

  const model = new RAPModel(Tandem.OPT_OUT);
  const ratioTupleProperty = model.ratio.tupleProperty;
  const getIdealValue = () => model.getIdealValueForTerm(RatioTerm.ANTECEDENT);
  const snapConserveFunction = getKeyboardInputSnappingMapper(getIdealValue, keyboardStep, keyboardStep * rapConstants.SHIFT_KEY_MULTIPLIER);
  model.targetRatioProperty.value = 3 / 4;
  ratioTupleProperty.value = new RAPRatioTuple(0.29, 0.41150407096456454);
  let newValue = null;
  newValue = snapConserveFunction(0.3, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.3, 'step up');
  newValue = snapConserveFunction(0.31, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  const idealAntecedent = model.targetRatioProperty.value * ratioTupleProperty.value.consequent;
  assert.ok(ratioTupleProperty.value.antecedent === idealAntecedent, 'step up into in-proportion');
  newValue = snapConserveFunction(ratioTupleProperty.value.antecedent + 0.01, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.32, 'utilize remainder');
  newValue = snapConserveFunction(0.31, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.31, 'step down');
  assert.ok(model.inProportionProperty.value, 'should be in proportion or this test is bogus');
  newValue = snapConserveFunction(0.30, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.30, 'step down through ideal because we are in proportion already');
});
QUnit.test('test case of 1/2 "ish"', assert => {
  // Buggy case from https://github.com/phetsims/ratio-and-proportion/issues/354#issuecomment-796067400

  const model = new RAPModel(Tandem.OPT_OUT);
  const ratioTupleProperty = model.ratio.tupleProperty;
  const getIdealValue = () => model.getIdealValueForTerm(RatioTerm.ANTECEDENT);
  const snapConserveFunction = getKeyboardInputSnappingMapper(getIdealValue, keyboardStep, keyboardStep * rapConstants.SHIFT_KEY_MULTIPLIER);
  model.targetRatioProperty.value = 1 / 3;
  ratioTupleProperty.value = new RAPRatioTuple(0.23, 0.6162765341338137);
  let newValue = null;
  newValue = snapConserveFunction(0.22, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.22, 'normal shift step down');
  newValue = snapConserveFunction(0.21, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.21, 'normal shift step down 2');
  newValue = snapConserveFunction(0.20, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  const idealAntecedent = model.targetRatioProperty.value * ratioTupleProperty.value.consequent;
  assert.ok(ratioTupleProperty.value.antecedent === idealAntecedent, 'utilize remainder');
  newValue = snapConserveFunction(ratioTupleProperty.value.antecedent - 0.01, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.19, 'step down');
  newValue = snapConserveFunction(0.2, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.2, 'step up');
  newValue = snapConserveFunction(0.21, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  const idealAntecedent2 = model.targetRatioProperty.value * ratioTupleProperty.value.consequent;
  assert.ok(ratioTupleProperty.value.antecedent === idealAntecedent2, 'step up into ideal');
  newValue = snapConserveFunction(ratioTupleProperty.value.antecedent + 0.01, ratioTupleProperty.value.antecedent, true, model.inProportionProperty.value);
  ratioTupleProperty.value = ratioTupleProperty.value.withAntecedent(newValue);
  assert.ok(ratioTupleProperty.value.antecedent === 0.22, 'step up from ideal past next even step');
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUYW5kZW0iLCJSQVBNb2RlbCIsIlJBUFJhdGlvVHVwbGUiLCJSYXRpb1Rlcm0iLCJyYXBDb25zdGFudHMiLCJnZXRLZXlib2FyZElucHV0U25hcHBpbmdNYXBwZXIiLCJRVW5pdCIsIm1vZHVsZSIsImtleWJvYXJkU3RlcCIsInRlc3QiLCJhc3NlcnQiLCJtb2RlbCIsIk9QVF9PVVQiLCJyYXRpb1R1cGxlUHJvcGVydHkiLCJyYXRpbyIsInR1cGxlUHJvcGVydHkiLCJnZXRJZGVhbFZhbHVlIiwiZ2V0SWRlYWxWYWx1ZUZvclRlcm0iLCJBTlRFQ0VERU5UIiwic25hcENvbnNlcnZlRnVuY3Rpb24iLCJTSElGVF9LRVlfTVVMVElQTElFUiIsInRhcmdldFJhdGlvUHJvcGVydHkiLCJ2YWx1ZSIsIm5ld1ZhbHVlIiwiYW50ZWNlZGVudCIsImluUHJvcG9ydGlvblByb3BlcnR5Iiwid2l0aEFudGVjZWRlbnQiLCJvayIsImlkZWFsUmF0aW8iLCJjb25zZXF1ZW50IiwiaWRlYWxBbnRlY2VkZW50IiwiaWRlYWxBbnRlY2VkZW50MiJdLCJzb3VyY2VzIjpbImdldEtleWJvYXJkSW5wdXRTbmFwcGluZ01hcHBlclRlc3RzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIwLTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFFVbml0IHRlc3RzIGZvciBSQVBNb2RlbFxyXG4gKlxyXG4gKiBAYXV0aG9yIE1pY2hhZWwgS2F1em1hbm4gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IFJBUE1vZGVsIGZyb20gJy4uL21vZGVsL1JBUE1vZGVsLmpzJztcclxuaW1wb3J0IFJBUFJhdGlvVHVwbGUgZnJvbSAnLi4vbW9kZWwvUkFQUmF0aW9UdXBsZS5qcyc7XHJcbmltcG9ydCBSYXRpb1Rlcm0gZnJvbSAnLi4vbW9kZWwvUmF0aW9UZXJtLmpzJztcclxuaW1wb3J0IHJhcENvbnN0YW50cyBmcm9tICcuLi9yYXBDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgZ2V0S2V5Ym9hcmRJbnB1dFNuYXBwaW5nTWFwcGVyIGZyb20gJy4vZ2V0S2V5Ym9hcmRJbnB1dFNuYXBwaW5nTWFwcGVyLmpzJztcclxuXHJcblFVbml0Lm1vZHVsZSggJ2dldEtleWJvYXJkSW5wdXRTbmFwcGluZ01hcHBlclRlc3RzJyApO1xyXG5cclxuLy8gQ29waWVkIGZyb20ga2V5Ym9hcmQgc3RlcCBjYWxjdWxhdGlvbiBpbiBSQVBTY3JlZW5WaWV3LmpzXHJcbmNvbnN0IGtleWJvYXJkU3RlcCA9IDEgLyAyIC8gMTA7XHJcblxyXG5RVW5pdC50ZXN0KCAna2V5Ym9hcmQgaW5wdXQgdG8gbW9kZWwgYWx3YXlzIGNhbiBnZXQgaW4gcHJvcG9ydGlvbjogMi83IG1vdmluZyBkb3duJywgYXNzZXJ0ID0+IHtcclxuXHJcbiAgY29uc3QgbW9kZWwgPSBuZXcgUkFQTW9kZWwoIFRhbmRlbS5PUFRfT1VUICk7XHJcbiAgY29uc3QgcmF0aW9UdXBsZVByb3BlcnR5ID0gbW9kZWwucmF0aW8udHVwbGVQcm9wZXJ0eTtcclxuICBjb25zdCBnZXRJZGVhbFZhbHVlID0gKCkgPT4gbW9kZWwuZ2V0SWRlYWxWYWx1ZUZvclRlcm0oIFJhdGlvVGVybS5BTlRFQ0VERU5UICk7XHJcbiAgY29uc3Qgc25hcENvbnNlcnZlRnVuY3Rpb24gPSBnZXRLZXlib2FyZElucHV0U25hcHBpbmdNYXBwZXIoIGdldElkZWFsVmFsdWUsIGtleWJvYXJkU3RlcCwga2V5Ym9hcmRTdGVwICogcmFwQ29uc3RhbnRzLlNISUZUX0tFWV9NVUxUSVBMSUVSICk7XHJcbiAgbW9kZWwudGFyZ2V0UmF0aW9Qcm9wZXJ0eS52YWx1ZSA9IDIgLyA3O1xyXG4gIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZSA9IG5ldyBSQVBSYXRpb1R1cGxlKCAwLjE0LCAwLjQgKTtcclxuXHJcbiAgbGV0IG5ld1ZhbHVlID0gbnVsbDtcclxuXHJcbiAgbmV3VmFsdWUgPSBzbmFwQ29uc2VydmVGdW5jdGlvbiggMC4xMywgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQsIHRydWUsIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlICk7XHJcbiAgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlID0gcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLndpdGhBbnRlY2VkZW50KCBuZXdWYWx1ZSApO1xyXG4gIGFzc2VydC5vayggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgPT09IDAuMTMsICdvbmUgc3RlcCBkb3duJyApO1xyXG5cclxuICBuZXdWYWx1ZSA9IHNuYXBDb25zZXJ2ZUZ1bmN0aW9uKCAwLjEyLCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCwgdHJ1ZSwgbW9kZWwuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUgPSByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUud2l0aEFudGVjZWRlbnQoIG5ld1ZhbHVlICk7XHJcbiAgYXNzZXJ0Lm9rKCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCA9PT0gMC4xMiwgJ2Fub3RoZXIgc3RlcCBkb3duJyApO1xyXG5cclxuICBuZXdWYWx1ZSA9IHNuYXBDb25zZXJ2ZUZ1bmN0aW9uKCAwLjExLCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCwgdHJ1ZSwgbW9kZWwuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUgPSByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUud2l0aEFudGVjZWRlbnQoIG5ld1ZhbHVlICk7XHJcbiAgY29uc3QgaWRlYWxSYXRpbyA9IG1vZGVsLnRhcmdldFJhdGlvUHJvcGVydHkudmFsdWUgKiByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuY29uc2VxdWVudDtcclxuICBhc3NlcnQub2soIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50ID09PSBpZGVhbFJhdGlvLCAnYW5vdGhlciBzdGVwIGRvd24gc2hvdWxkIHNuYXAgdG8gaW4gcHJvcG9ydGlvbicgKTtcclxuXHJcbiAgbmV3VmFsdWUgPSBzbmFwQ29uc2VydmVGdW5jdGlvbiggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgLSAwLjAxLCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCwgdHJ1ZSwgbW9kZWwuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUgPSByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUud2l0aEFudGVjZWRlbnQoIG5ld1ZhbHVlICk7XHJcbiAgYXNzZXJ0Lm9rKCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCA9PT0gMC4xMCwgJ2Fub3RoZXIgc3RlcCBkb3duIHNob3VsZCBzbmFwIHRvIGluIHByb3BvcnRpb24nICk7XHJcblxyXG4gIG5ld1ZhbHVlID0gc25hcENvbnNlcnZlRnVuY3Rpb24oIDAuMDksIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50LCB0cnVlLCBtb2RlbC5pblByb3BvcnRpb25Qcm9wZXJ0eS52YWx1ZSApO1xyXG4gIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZSA9IHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS53aXRoQW50ZWNlZGVudCggbmV3VmFsdWUgKTtcclxuICBhc3NlcnQub2soIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50ID09PSAwLjA5LCAnYW5vdGhlciBzdGVwIGRvd24gc2hvdWxkIHNuYXAgdG8gaW4gcHJvcG9ydGlvbicgKTtcclxufSApO1xyXG5cclxuUVVuaXQudGVzdCggJ2tleWJvYXJkIGFsd2F5cyBjYW4gZ2V0IGluIHByb3BvcnRpb246IDIvNyBtb3ZpbmcgdXAnLCBhc3NlcnQgPT4ge1xyXG5cclxuICBjb25zdCBtb2RlbCA9IG5ldyBSQVBNb2RlbCggVGFuZGVtLk9QVF9PVVQgKTtcclxuICBjb25zdCByYXRpb1R1cGxlUHJvcGVydHkgPSBtb2RlbC5yYXRpby50dXBsZVByb3BlcnR5O1xyXG5cclxuICBjb25zdCBnZXRJZGVhbFZhbHVlID0gKCkgPT4gbW9kZWwuZ2V0SWRlYWxWYWx1ZUZvclRlcm0oIFJhdGlvVGVybS5BTlRFQ0VERU5UICk7XHJcbiAgY29uc3Qgc25hcENvbnNlcnZlRnVuY3Rpb24gPSBnZXRLZXlib2FyZElucHV0U25hcHBpbmdNYXBwZXIoIGdldElkZWFsVmFsdWUsIGtleWJvYXJkU3RlcCwga2V5Ym9hcmRTdGVwICogcmFwQ29uc3RhbnRzLlNISUZUX0tFWV9NVUxUSVBMSUVSICk7XHJcbiAgbW9kZWwudGFyZ2V0UmF0aW9Qcm9wZXJ0eS52YWx1ZSA9IDIgLyA3O1xyXG4gIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZSA9IG5ldyBSQVBSYXRpb1R1cGxlKCAwLjA5LCAwLjQgKTtcclxuXHJcbiAgbGV0IG5ld1ZhbHVlID0gbnVsbDtcclxuXHJcbiAgbmV3VmFsdWUgPSBzbmFwQ29uc2VydmVGdW5jdGlvbiggMC4xLCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCwgdHJ1ZSwgbW9kZWwuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUgPSByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUud2l0aEFudGVjZWRlbnQoIG5ld1ZhbHVlICk7XHJcbiAgYXNzZXJ0Lm9rKCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCA9PT0gMC4xLCAnc3RlcCB1cCcgKTtcclxuXHJcbiAgbmV3VmFsdWUgPSBzbmFwQ29uc2VydmVGdW5jdGlvbiggMC4xMSwgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQsIHRydWUsIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlICk7XHJcbiAgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlID0gcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLndpdGhBbnRlY2VkZW50KCBuZXdWYWx1ZSApO1xyXG4gIGFzc2VydC5vayggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgPT09IDAuMTEsICdzdGVwIHVwJyApO1xyXG5cclxuICBuZXdWYWx1ZSA9IHNuYXBDb25zZXJ2ZUZ1bmN0aW9uKCAwLjEyLCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCwgdHJ1ZSwgbW9kZWwuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUgPSByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUud2l0aEFudGVjZWRlbnQoIG5ld1ZhbHVlICk7XHJcbiAgY29uc3QgaWRlYWxBbnRlY2VkZW50ID0gbW9kZWwudGFyZ2V0UmF0aW9Qcm9wZXJ0eS52YWx1ZSAqIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5jb25zZXF1ZW50O1xyXG4gIGFzc2VydC5vayggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgPT09IGlkZWFsQW50ZWNlZGVudCwgJ3N0ZXAgdXAgdGhyb3VnaCBpZGVhbCcgKTtcclxuXHJcbiAgbmV3VmFsdWUgPSBzbmFwQ29uc2VydmVGdW5jdGlvbiggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgKyAwLjAxLCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCwgdHJ1ZSwgbW9kZWwuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUgPSByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUud2l0aEFudGVjZWRlbnQoIG5ld1ZhbHVlICk7XHJcbiAgYXNzZXJ0Lm9rKCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCA9PT0gMC4xMywgJ3N0ZXAgdXAnICk7XHJcbn0gKTtcclxuXHJcblFVbml0LnRlc3QoICd0ZXN0IGNhc2Ugb2YgMy80IFwiaXNoXCInLCBhc3NlcnQgPT4ge1xyXG4gIC8vIEJ1Z2d5IGNhc2UgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvcmF0aW8tYW5kLXByb3BvcnRpb24vaXNzdWVzLzM1NFxyXG5cclxuICBjb25zdCBtb2RlbCA9IG5ldyBSQVBNb2RlbCggVGFuZGVtLk9QVF9PVVQgKTtcclxuICBjb25zdCByYXRpb1R1cGxlUHJvcGVydHkgPSBtb2RlbC5yYXRpby50dXBsZVByb3BlcnR5O1xyXG5cclxuICBjb25zdCBnZXRJZGVhbFZhbHVlID0gKCkgPT4gbW9kZWwuZ2V0SWRlYWxWYWx1ZUZvclRlcm0oIFJhdGlvVGVybS5BTlRFQ0VERU5UICk7XHJcbiAgY29uc3Qgc25hcENvbnNlcnZlRnVuY3Rpb24gPSBnZXRLZXlib2FyZElucHV0U25hcHBpbmdNYXBwZXIoIGdldElkZWFsVmFsdWUsIGtleWJvYXJkU3RlcCwga2V5Ym9hcmRTdGVwICogcmFwQ29uc3RhbnRzLlNISUZUX0tFWV9NVUxUSVBMSUVSICk7XHJcbiAgbW9kZWwudGFyZ2V0UmF0aW9Qcm9wZXJ0eS52YWx1ZSA9IDMgLyA0O1xyXG4gIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZSA9IG5ldyBSQVBSYXRpb1R1cGxlKCAwLjI5LCAwLjQxMTUwNDA3MDk2NDU2NDU0ICk7XHJcblxyXG4gIGxldCBuZXdWYWx1ZSA9IG51bGw7XHJcblxyXG4gIG5ld1ZhbHVlID0gc25hcENvbnNlcnZlRnVuY3Rpb24oIDAuMywgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQsIHRydWUsIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlICk7XHJcbiAgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlID0gcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLndpdGhBbnRlY2VkZW50KCBuZXdWYWx1ZSApO1xyXG4gIGFzc2VydC5vayggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgPT09IDAuMywgJ3N0ZXAgdXAnICk7XHJcblxyXG4gIG5ld1ZhbHVlID0gc25hcENvbnNlcnZlRnVuY3Rpb24oIDAuMzEsIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50LCB0cnVlLCBtb2RlbC5pblByb3BvcnRpb25Qcm9wZXJ0eS52YWx1ZSApO1xyXG4gIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZSA9IHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS53aXRoQW50ZWNlZGVudCggbmV3VmFsdWUgKTtcclxuICBjb25zdCBpZGVhbEFudGVjZWRlbnQgPSBtb2RlbC50YXJnZXRSYXRpb1Byb3BlcnR5LnZhbHVlICogcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmNvbnNlcXVlbnQ7XHJcbiAgYXNzZXJ0Lm9rKCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCA9PT0gaWRlYWxBbnRlY2VkZW50LCAnc3RlcCB1cCBpbnRvIGluLXByb3BvcnRpb24nICk7XHJcblxyXG4gIG5ld1ZhbHVlID0gc25hcENvbnNlcnZlRnVuY3Rpb24oIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50ICsgMC4wMSwgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQsIHRydWUsIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlICk7XHJcbiAgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlID0gcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLndpdGhBbnRlY2VkZW50KCBuZXdWYWx1ZSApO1xyXG4gIGFzc2VydC5vayggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgPT09IDAuMzIsICd1dGlsaXplIHJlbWFpbmRlcicgKTtcclxuXHJcbiAgbmV3VmFsdWUgPSBzbmFwQ29uc2VydmVGdW5jdGlvbiggMC4zMSwgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQsIHRydWUsIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlICk7XHJcblxyXG4gIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZSA9IHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS53aXRoQW50ZWNlZGVudCggbmV3VmFsdWUgKTtcclxuICBhc3NlcnQub2soIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50ID09PSAwLjMxLCAnc3RlcCBkb3duJyApO1xyXG5cclxuICBhc3NlcnQub2soIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlLCAnc2hvdWxkIGJlIGluIHByb3BvcnRpb24gb3IgdGhpcyB0ZXN0IGlzIGJvZ3VzJyApO1xyXG5cclxuICBuZXdWYWx1ZSA9IHNuYXBDb25zZXJ2ZUZ1bmN0aW9uKCAwLjMwLCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCwgdHJ1ZSwgbW9kZWwuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUgPSByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUud2l0aEFudGVjZWRlbnQoIG5ld1ZhbHVlICk7XHJcbiAgYXNzZXJ0Lm9rKCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCA9PT0gMC4zMCwgJ3N0ZXAgZG93biB0aHJvdWdoIGlkZWFsIGJlY2F1c2Ugd2UgYXJlIGluIHByb3BvcnRpb24gYWxyZWFkeScgKTtcclxuXHJcbn0gKTtcclxuXHJcblxyXG5RVW5pdC50ZXN0KCAndGVzdCBjYXNlIG9mIDEvMiBcImlzaFwiJywgYXNzZXJ0ID0+IHtcclxuICAvLyBCdWdneSBjYXNlIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3JhdGlvLWFuZC1wcm9wb3J0aW9uL2lzc3Vlcy8zNTQjaXNzdWVjb21tZW50LTc5NjA2NzQwMFxyXG5cclxuICBjb25zdCBtb2RlbCA9IG5ldyBSQVBNb2RlbCggVGFuZGVtLk9QVF9PVVQgKTtcclxuICBjb25zdCByYXRpb1R1cGxlUHJvcGVydHkgPSBtb2RlbC5yYXRpby50dXBsZVByb3BlcnR5O1xyXG5cclxuICBjb25zdCBnZXRJZGVhbFZhbHVlID0gKCkgPT4gbW9kZWwuZ2V0SWRlYWxWYWx1ZUZvclRlcm0oIFJhdGlvVGVybS5BTlRFQ0VERU5UICk7XHJcbiAgY29uc3Qgc25hcENvbnNlcnZlRnVuY3Rpb24gPSBnZXRLZXlib2FyZElucHV0U25hcHBpbmdNYXBwZXIoIGdldElkZWFsVmFsdWUsIGtleWJvYXJkU3RlcCwga2V5Ym9hcmRTdGVwICogcmFwQ29uc3RhbnRzLlNISUZUX0tFWV9NVUxUSVBMSUVSICk7XHJcbiAgbW9kZWwudGFyZ2V0UmF0aW9Qcm9wZXJ0eS52YWx1ZSA9IDEgLyAzO1xyXG4gIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZSA9IG5ldyBSQVBSYXRpb1R1cGxlKCAwLjIzLCAwLjYxNjI3NjUzNDEzMzgxMzcgKTtcclxuXHJcbiAgbGV0IG5ld1ZhbHVlID0gbnVsbDtcclxuXHJcbiAgbmV3VmFsdWUgPSBzbmFwQ29uc2VydmVGdW5jdGlvbiggMC4yMiwgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQsIHRydWUsIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlICk7XHJcbiAgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlID0gcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLndpdGhBbnRlY2VkZW50KCBuZXdWYWx1ZSApO1xyXG4gIGFzc2VydC5vayggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgPT09IDAuMjIsICdub3JtYWwgc2hpZnQgc3RlcCBkb3duJyApO1xyXG5cclxuICBuZXdWYWx1ZSA9IHNuYXBDb25zZXJ2ZUZ1bmN0aW9uKCAwLjIxLCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCwgdHJ1ZSwgbW9kZWwuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUgPSByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUud2l0aEFudGVjZWRlbnQoIG5ld1ZhbHVlICk7XHJcbiAgYXNzZXJ0Lm9rKCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCA9PT0gMC4yMSwgJ25vcm1hbCBzaGlmdCBzdGVwIGRvd24gMicgKTtcclxuXHJcbiAgbmV3VmFsdWUgPSBzbmFwQ29uc2VydmVGdW5jdGlvbiggMC4yMCwgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQsIHRydWUsIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlICk7XHJcbiAgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlID0gcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLndpdGhBbnRlY2VkZW50KCBuZXdWYWx1ZSApO1xyXG4gIGNvbnN0IGlkZWFsQW50ZWNlZGVudCA9IG1vZGVsLnRhcmdldFJhdGlvUHJvcGVydHkudmFsdWUgKiByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuY29uc2VxdWVudDtcclxuICBhc3NlcnQub2soIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50ID09PSBpZGVhbEFudGVjZWRlbnQsICd1dGlsaXplIHJlbWFpbmRlcicgKTtcclxuXHJcbiAgbmV3VmFsdWUgPSBzbmFwQ29uc2VydmVGdW5jdGlvbiggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgLSAwLjAxLCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCwgdHJ1ZSwgbW9kZWwuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKTtcclxuICByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUgPSByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUud2l0aEFudGVjZWRlbnQoIG5ld1ZhbHVlICk7XHJcbiAgYXNzZXJ0Lm9rKCByYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuYW50ZWNlZGVudCA9PT0gMC4xOSwgJ3N0ZXAgZG93bicgKTtcclxuXHJcblxyXG4gIG5ld1ZhbHVlID0gc25hcENvbnNlcnZlRnVuY3Rpb24oIDAuMiwgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQsIHRydWUsIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlICk7XHJcbiAgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlID0gcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLndpdGhBbnRlY2VkZW50KCBuZXdWYWx1ZSApO1xyXG4gIGFzc2VydC5vayggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgPT09IDAuMiwgJ3N0ZXAgdXAnICk7XHJcblxyXG4gIG5ld1ZhbHVlID0gc25hcENvbnNlcnZlRnVuY3Rpb24oIDAuMjEsIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50LCB0cnVlLCBtb2RlbC5pblByb3BvcnRpb25Qcm9wZXJ0eS52YWx1ZSApO1xyXG4gIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZSA9IHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS53aXRoQW50ZWNlZGVudCggbmV3VmFsdWUgKTtcclxuICBjb25zdCBpZGVhbEFudGVjZWRlbnQyID0gbW9kZWwudGFyZ2V0UmF0aW9Qcm9wZXJ0eS52YWx1ZSAqIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5jb25zZXF1ZW50O1xyXG4gIGFzc2VydC5vayggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgPT09IGlkZWFsQW50ZWNlZGVudDIsICdzdGVwIHVwIGludG8gaWRlYWwnICk7XHJcblxyXG4gIG5ld1ZhbHVlID0gc25hcENvbnNlcnZlRnVuY3Rpb24oIHJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50ICsgMC4wMSwgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQsIHRydWUsIG1vZGVsLmluUHJvcG9ydGlvblByb3BlcnR5LnZhbHVlICk7XHJcbiAgcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlID0gcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLndpdGhBbnRlY2VkZW50KCBuZXdWYWx1ZSApO1xyXG4gIGFzc2VydC5vayggcmF0aW9UdXBsZVByb3BlcnR5LnZhbHVlLmFudGVjZWRlbnQgPT09IDAuMjIsICdzdGVwIHVwIGZyb20gaWRlYWwgcGFzdCBuZXh0IGV2ZW4gc3RlcCcgKTtcclxufSApO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsTUFBTSxNQUFNLGlDQUFpQztBQUNwRCxPQUFPQyxRQUFRLE1BQU0sc0JBQXNCO0FBQzNDLE9BQU9DLGFBQWEsTUFBTSwyQkFBMkI7QUFDckQsT0FBT0MsU0FBUyxNQUFNLHVCQUF1QjtBQUM3QyxPQUFPQyxZQUFZLE1BQU0sb0JBQW9CO0FBQzdDLE9BQU9DLDhCQUE4QixNQUFNLHFDQUFxQztBQUVoRkMsS0FBSyxDQUFDQyxNQUFNLENBQUUscUNBQXNDLENBQUM7O0FBRXJEO0FBQ0EsTUFBTUMsWUFBWSxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRTtBQUUvQkYsS0FBSyxDQUFDRyxJQUFJLENBQUUsdUVBQXVFLEVBQUVDLE1BQU0sSUFBSTtFQUU3RixNQUFNQyxLQUFLLEdBQUcsSUFBSVYsUUFBUSxDQUFFRCxNQUFNLENBQUNZLE9BQVEsQ0FBQztFQUM1QyxNQUFNQyxrQkFBa0IsR0FBR0YsS0FBSyxDQUFDRyxLQUFLLENBQUNDLGFBQWE7RUFDcEQsTUFBTUMsYUFBYSxHQUFHQSxDQUFBLEtBQU1MLEtBQUssQ0FBQ00sb0JBQW9CLENBQUVkLFNBQVMsQ0FBQ2UsVUFBVyxDQUFDO0VBQzlFLE1BQU1DLG9CQUFvQixHQUFHZCw4QkFBOEIsQ0FBRVcsYUFBYSxFQUFFUixZQUFZLEVBQUVBLFlBQVksR0FBR0osWUFBWSxDQUFDZ0Isb0JBQXFCLENBQUM7RUFDNUlULEtBQUssQ0FBQ1UsbUJBQW1CLENBQUNDLEtBQUssR0FBRyxDQUFDLEdBQUcsQ0FBQztFQUN2Q1Qsa0JBQWtCLENBQUNTLEtB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