// Copyright 2020-2022, University of Colorado Boulder

/**
 * A short sound to indicate when a movable component has reached the boundary of its movable bounds. This sound supports
 * playing a boundary sound based on horizontal motion, as well as vertical motion, but treats each as separate values,
 * and not as a Bounds2. This is to support some interactions (alternative input through keyboard) that only support vertical
 * movement (and thus only vertical boundary sounds). While terms are named and grokked in x/y directions, this could be
 * used generally when you need a boundary sound to occur always on one axis, and optionally on another.
 *
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

import SoundClip from '../../../../../tambo/js/sound-generators/SoundClip.js';
import generalBoundaryBoop_mp3 from '../../../../../tambo/sounds/generalBoundaryBoop_mp3.js';
import ratioAndProportion from '../../../ratioAndProportion.js';
class BoundarySoundClip extends SoundClip {
  // keep track of if the sound has been played yet this interaction to see if it should be played at the end of
  // the interaction.
  /**
   * @param verticalRange - the total range that the vertical position can take
   * @param [options]
   */
  constructor(verticalRange, options) {
    super(generalBoundaryBoop_mp3, options);
    this.verticalRange = verticalRange;
    this.lastYPosition = null;
    this.lastXPosition = null;
    this.playedThisInteraction = false;
  }

  /**
   * Call this when an interaction occurs that could potentially cause a boundary sound to play. Horizontal parameters
   * are optional to support some vertical-only component interactions.
   * @param verticalPosition
   * @param [horizontalPosition]
   * @param [horizontalRange] - the horizontal range can change based on view scaling
   */
  onInteract(verticalPosition, horizontalPosition, horizontalRange) {
    if (this.lastYPosition !== verticalPosition && (verticalPosition === this.verticalRange.min || verticalPosition === this.verticalRange.max)) {
      this.play();
    }
    this.lastYPosition = verticalPosition;
    if (horizontalPosition && horizontalRange) {
      if (this.lastXPosition !== horizontalPosition && (horizontalPosition === horizontalRange.min || horizontalPosition === horizontalRange.max)) {
        this.play();
      }
      this.lastXPosition = horizontalPosition;
    }
  }
  onStartInteraction() {
    this.playedThisInteraction = false;
  }

  /**
   * Play a boundary sound on end interaction. This will not play again if the sound already played during this interaction.
   * This case is to support keyboard interaction in which you are at the max, try to increase the value, but don't
   * change the value. This will still result in this sound feedback for the boundary sound.
   */
  onEndInteraction(verticalPosition) {
    if (!this.playedThisInteraction && (verticalPosition === this.verticalRange.min || verticalPosition === this.verticalRange.max)) {
      this.play();
    }
  }
  play() {
    this.playedThisInteraction = true;
    super.play();
  }
  reset() {
    this.stop(0);
    this.playedThisInteraction = false;
    this.lastYPosition = null;
    this.lastXPosition = null;
  }
}
ratioAndProportion.register('BoundarySoundClip', BoundarySoundClip);
export default BoundarySoundClip;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTb3VuZENsaXAiLCJnZW5lcmFsQm91bmRhcnlCb29wX21wMyIsInJhdGlvQW5kUHJvcG9ydGlvbiIsIkJvdW5kYXJ5U291bmRDbGlwIiwiY29uc3RydWN0b3IiLCJ2ZXJ0aWNhbFJhbmdlIiwib3B0aW9ucyIsImxhc3RZUG9zaXRpb24iLCJsYXN0WFBvc2l0aW9uIiwicGxheWVkVGhpc0ludGVyYWN0aW9uIiwib25JbnRlcmFjdCIsInZlcnRpY2FsUG9zaXRpb24iLCJob3Jpem9udGFsUG9zaXRpb24iLCJob3Jpem9udGFsUmFuZ2UiLCJtaW4iLCJtYXgiLCJwbGF5Iiwib25TdGFydEludGVyYWN0aW9uIiwib25FbmRJbnRlcmFjdGlvbiIsInJlc2V0Iiwic3RvcCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQm91bmRhcnlTb3VuZENsaXAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjAtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQSBzaG9ydCBzb3VuZCB0byBpbmRpY2F0ZSB3aGVuIGEgbW92YWJsZSBjb21wb25lbnQgaGFzIHJlYWNoZWQgdGhlIGJvdW5kYXJ5IG9mIGl0cyBtb3ZhYmxlIGJvdW5kcy4gVGhpcyBzb3VuZCBzdXBwb3J0c1xyXG4gKiBwbGF5aW5nIGEgYm91bmRhcnkgc291bmQgYmFzZWQgb24gaG9yaXpvbnRhbCBtb3Rpb24sIGFzIHdlbGwgYXMgdmVydGljYWwgbW90aW9uLCBidXQgdHJlYXRzIGVhY2ggYXMgc2VwYXJhdGUgdmFsdWVzLFxyXG4gKiBhbmQgbm90IGFzIGEgQm91bmRzMi4gVGhpcyBpcyB0byBzdXBwb3J0IHNvbWUgaW50ZXJhY3Rpb25zIChhbHRlcm5hdGl2ZSBpbnB1dCB0aHJvdWdoIGtleWJvYXJkKSB0aGF0IG9ubHkgc3VwcG9ydCB2ZXJ0aWNhbFxyXG4gKiBtb3ZlbWVudCAoYW5kIHRodXMgb25seSB2ZXJ0aWNhbCBib3VuZGFyeSBzb3VuZHMpLiBXaGlsZSB0ZXJtcyBhcmUgbmFtZWQgYW5kIGdyb2trZWQgaW4geC95IGRpcmVjdGlvbnMsIHRoaXMgY291bGQgYmVcclxuICogdXNlZCBnZW5lcmFsbHkgd2hlbiB5b3UgbmVlZCBhIGJvdW5kYXJ5IHNvdW5kIHRvIG9jY3VyIGFsd2F5cyBvbiBvbmUgYXhpcywgYW5kIG9wdGlvbmFsbHkgb24gYW5vdGhlci5cclxuICpcclxuICogQGF1dGhvciBNaWNoYWVsIEthdXptYW5uIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBTb3VuZENsaXAsIHsgU291bmRDbGlwT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3RhbWJvL2pzL3NvdW5kLWdlbmVyYXRvcnMvU291bmRDbGlwLmpzJztcclxuaW1wb3J0IGdlbmVyYWxCb3VuZGFyeUJvb3BfbXAzIGZyb20gJy4uLy4uLy4uLy4uLy4uL3RhbWJvL3NvdW5kcy9nZW5lcmFsQm91bmRhcnlCb29wX21wMy5qcyc7XHJcbmltcG9ydCByYXRpb0FuZFByb3BvcnRpb24gZnJvbSAnLi4vLi4vLi4vcmF0aW9BbmRQcm9wb3J0aW9uLmpzJztcclxuaW1wb3J0IFJhbmdlIGZyb20gJy4uLy4uLy4uLy4uLy4uL2RvdC9qcy9SYW5nZS5qcyc7XHJcblxyXG5jbGFzcyBCb3VuZGFyeVNvdW5kQ2xpcCBleHRlbmRzIFNvdW5kQ2xpcCB7XHJcblxyXG4gIHByaXZhdGUgdmVydGljYWxSYW5nZTogUmFuZ2U7XHJcbiAgcHJpdmF0ZSBsYXN0WVBvc2l0aW9uOiBudW1iZXIgfCBudWxsO1xyXG4gIHByaXZhdGUgbGFzdFhQb3NpdGlvbjogbnVtYmVyIHwgbnVsbDtcclxuXHJcbiAgLy8ga2VlcCB0cmFjayBvZiBpZiB0aGUgc291bmQgaGFzIGJlZW4gcGxheWVkIHlldCB0aGlzIGludGVyYWN0aW9uIHRvIHNlZSBpZiBpdCBzaG91bGQgYmUgcGxheWVkIGF0IHRoZSBlbmQgb2ZcclxuICAvLyB0aGUgaW50ZXJhY3Rpb24uXHJcbiAgcHJpdmF0ZSBwbGF5ZWRUaGlzSW50ZXJhY3Rpb246IGJvb2xlYW47XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB2ZXJ0aWNhbFJhbmdlIC0gdGhlIHRvdGFsIHJhbmdlIHRoYXQgdGhlIHZlcnRpY2FsIHBvc2l0aW9uIGNhbiB0YWtlXHJcbiAgICogQHBhcmFtIFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggdmVydGljYWxSYW5nZTogUmFuZ2UsIG9wdGlvbnM/OiBTb3VuZENsaXBPcHRpb25zICkge1xyXG4gICAgc3VwZXIoIGdlbmVyYWxCb3VuZGFyeUJvb3BfbXAzLCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy52ZXJ0aWNhbFJhbmdlID0gdmVydGljYWxSYW5nZTtcclxuICAgIHRoaXMubGFzdFlQb3NpdGlvbiA9IG51bGw7XHJcbiAgICB0aGlzLmxhc3RYUG9zaXRpb24gPSBudWxsO1xyXG4gICAgdGhpcy5wbGF5ZWRUaGlzSW50ZXJhY3Rpb24gPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGwgdGhpcyB3aGVuIGFuIGludGVyYWN0aW9uIG9jY3VycyB0aGF0IGNvdWxkIHBvdGVudGlhbGx5IGNhdXNlIGEgYm91bmRhcnkgc291bmQgdG8gcGxheS4gSG9yaXpvbnRhbCBwYXJhbWV0ZXJzXHJcbiAgICogYXJlIG9wdGlvbmFsIHRvIHN1cHBvcnQgc29tZSB2ZXJ0aWNhbC1vbmx5IGNvbXBvbmVudCBpbnRlcmFjdGlvbnMuXHJcbiAgICogQHBhcmFtIHZlcnRpY2FsUG9zaXRpb25cclxuICAgKiBAcGFyYW0gW2hvcml6b250YWxQb3NpdGlvbl1cclxuICAgKiBAcGFyYW0gW2hvcml6b250YWxSYW5nZV0gLSB0aGUgaG9yaXpvbnRhbCByYW5nZSBjYW4gY2hhbmdlIGJhc2VkIG9uIHZpZXcgc2NhbGluZ1xyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkludGVyYWN0KCB2ZXJ0aWNhbFBvc2l0aW9uOiBudW1iZXIsIGhvcml6b250YWxQb3NpdGlvbj86IG51bWJlciwgaG9yaXpvbnRhbFJhbmdlPzogUmFuZ2UgKTogdm9pZCB7XHJcblxyXG4gICAgaWYgKCB0aGlzLmxhc3RZUG9zaXRpb24gIT09IHZlcnRpY2FsUG9zaXRpb24gJiZcclxuICAgICAgICAgKCB2ZXJ0aWNhbFBvc2l0aW9uID09PSB0aGlzLnZlcnRpY2FsUmFuZ2UubWluIHx8IHZlcnRpY2FsUG9zaXRpb24gPT09IHRoaXMudmVydGljYWxSYW5nZS5tYXggKSApIHtcclxuICAgICAgdGhpcy5wbGF5KCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmxhc3RZUG9zaXRpb24gPSB2ZXJ0aWNhbFBvc2l0aW9uO1xyXG5cclxuICAgIGlmICggaG9yaXpvbnRhbFBvc2l0aW9uICYmIGhvcml6b250YWxSYW5nZSApIHtcclxuXHJcbiAgICAgIGlmICggdGhpcy5sYXN0WFBvc2l0aW9uICE9PSBob3Jpem9udGFsUG9zaXRpb24gJiZcclxuICAgICAgICAgICAoIGhvcml6b250YWxQb3NpdGlvbiA9PT0gaG9yaXpvbnRhbFJhbmdlLm1pbiB8fCBob3Jpem9udGFsUG9zaXRpb24gPT09IGhvcml6b250YWxSYW5nZS5tYXggKSApIHtcclxuICAgICAgICB0aGlzLnBsYXkoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5sYXN0WFBvc2l0aW9uID0gaG9yaXpvbnRhbFBvc2l0aW9uO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG9uU3RhcnRJbnRlcmFjdGlvbigpOiB2b2lkIHtcclxuICAgIHRoaXMucGxheWVkVGhpc0ludGVyYWN0aW9uID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQbGF5IGEgYm91bmRhcnkgc291bmQgb24gZW5kIGludGVyYWN0aW9uLiBUaGlzIHdpbGwgbm90IHBsYXkgYWdhaW4gaWYgdGhlIHNvdW5kIGFscmVhZHkgcGxheWVkIGR1cmluZyB0aGlzIGludGVyYWN0aW9uLlxyXG4gICAqIFRoaXMgY2FzZSBpcyB0byBzdXBwb3J0IGtleWJvYXJkIGludGVyYWN0aW9uIGluIHdoaWNoIHlvdSBhcmUgYXQgdGhlIG1heCwgdHJ5IHRvIGluY3JlYXNlIHRoZSB2YWx1ZSwgYnV0IGRvbid0XHJcbiAgICogY2hhbmdlIHRoZSB2YWx1ZS4gVGhpcyB3aWxsIHN0aWxsIHJlc3VsdCBpbiB0aGlzIHNvdW5kIGZlZWRiYWNrIGZvciB0aGUgYm91bmRhcnkgc291bmQuXHJcbiAgICovXHJcbiAgcHVibGljIG9uRW5kSW50ZXJhY3Rpb24oIHZlcnRpY2FsUG9zaXRpb246IG51bWJlciApOiB2b2lkIHtcclxuICAgIGlmICggIXRoaXMucGxheWVkVGhpc0ludGVyYWN0aW9uICYmXHJcbiAgICAgICAgICggdmVydGljYWxQb3NpdGlvbiA9PT0gdGhpcy52ZXJ0aWNhbFJhbmdlLm1pbiB8fCB2ZXJ0aWNhbFBvc2l0aW9uID09PSB0aGlzLnZlcnRpY2FsUmFuZ2UubWF4ICkgKSB7XHJcbiAgICAgIHRoaXMucGxheSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIHBsYXkoKTogdm9pZCB7XHJcbiAgICB0aGlzLnBsYXllZFRoaXNJbnRlcmFjdGlvbiA9IHRydWU7XHJcbiAgICBzdXBlci5wbGF5KCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcmVzZXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLnN0b3AoIDAgKTtcclxuICAgIHRoaXMucGxheWVkVGhpc0ludGVyYWN0aW9uID0gZmFsc2U7XHJcbiAgICB0aGlzLmxhc3RZUG9zaXRpb24gPSBudWxsO1xyXG4gICAgdGhpcy5sYXN0WFBvc2l0aW9uID0gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbnJhdGlvQW5kUHJvcG9ydGlvbi5yZWdpc3RlciggJ0JvdW5kYXJ5U291bmRDbGlwJywgQm91bmRhcnlTb3VuZENsaXAgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEJvdW5kYXJ5U291bmRDbGlwOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFD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