// Copyright 2020-2023, University of Colorado Boulder

/**
 * A combo box that displays the possible ranges for the tick marks and labels. The design requirements for this
 * component state that when disabled, that the elements aren't shown (as they are a distraction to the pedagogy).
 * Instead, they are replaced with a solid horizontal line. To accomplish this, two ComboBoxes are created and then
 * swapped out. This ended up being easier and simpler than trying to add the ability to swap-out Nodes (and their PDOM
 * content) dynamically to a single ComboBox instance.
 *
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { HBox, HSeparator, Node, RichText } from '../../../../scenery/js/imports.js';
import ComboBox from '../../../../sun/js/ComboBox.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import ActivationUtterance from '../../../../utterance-queue/js/ActivationUtterance.js';
import TickMarkView from '../../common/view/TickMarkView.js';
import ratioAndProportion from '../../ratioAndProportion.js';
import RatioAndProportionStrings from '../../RatioAndProportionStrings.js';
import optionize from '../../../../phet-core/js/optionize.js';
const TICK_MARK_RANGE_FONT = new PhetFont(16);
const RANGE_TEXT_OPTIONS = {
  font: TICK_MARK_RANGE_FONT,
  maxWidth: 90
};
class TickMarkRangeComboBoxNode extends HBox {
  constructor(tickMarkRangeProperty, comboBoxParent, tickMarkViewProperty, providedOptions) {
    const options = optionize()({
      spacing: 10
    }, providedOptions);
    super(options);
    this.tickMarkRangeMap = {
      10: RatioAndProportionStrings.zeroToTenStringProperty,
      20: RatioAndProportionStrings.zeroToTwentyStringProperty,
      30: RatioAndProportionStrings.zeroToThirtyStringProperty
    };
    this.tickMarkRangeProperty = tickMarkRangeProperty;
    const items = [{
      value: 10,
      createNode: () => new RichText(this.tickMarkRangeMap[10], RANGE_TEXT_OPTIONS),
      a11yName: RatioAndProportionStrings.zeroToTenStringProperty
    }, {
      value: 20,
      createNode: () => new RichText(this.tickMarkRangeMap[20], RANGE_TEXT_OPTIONS),
      a11yName: RatioAndProportionStrings.zeroToTwentyStringProperty
    }, {
      value: 30,
      createNode: () => new RichText(this.tickMarkRangeMap[30], RANGE_TEXT_OPTIONS),
      a11yName: RatioAndProportionStrings.zeroToThirtyStringProperty
    }];
    const widestItem = Math.max(...items.map(item => {
      const node = item.createNode(Tandem.OPT_OUT);
      const width = node.width;
      node.dispose();
      return width;
    }));
    const labelNode = new RichText(RatioAndProportionStrings.rangeStringProperty, RANGE_TEXT_OPTIONS);
    const comboBoxOptions = {
      helpText: RatioAndProportionStrings.a11y.create.tickMarkRangeHelpTextStringProperty,
      accessibleName: RatioAndProportionStrings.rangeStringProperty,
      maxWidth: 250,
      // empirically determined

      comboBoxVoicingNameResponsePattern: RatioAndProportionStrings.a11y.create.rangeLabelPatternStringProperty,
      comboBoxVoicingContextResponse: () => this.getContextResponse(),
      comboBoxVoicingHintResponse: RatioAndProportionStrings.a11y.create.tickMarkRangeHelpTextStringProperty,
      // phet-io
      tandem: Tandem.OPT_OUT
    };
    this.enabledComboBox = new ComboBox(tickMarkRangeProperty, items, comboBoxParent, comboBoxOptions);
    const value = true;

    // NOTE: The values are [ 10, true ]... so it's typed interestingly.
    this.disabledComboBox = new ComboBox(new BooleanProperty(value), [{
      value: value,
      createNode: () => new HSeparator({
        preferredWidth: widestItem,
        centerY: -5
      }),
      a11yName: RatioAndProportionStrings.a11y.tickMark.tickMarksHiddenStringProperty
    }, items[0] // add this one to get the proper height of the text.
    ], new Node(), comboBoxOptions);

    // always disabled
    this.disabledComboBox.enabledProperty.value = false;

    // when not displaying the tick marks, show the "blank" line instead of the RichText.
    tickMarkViewProperty.link(tickMarkView => {
      this.children = tickMarkView === TickMarkView.NONE ? [labelNode, this.disabledComboBox] : [labelNode, this.enabledComboBox];
    });
    const tickMarkRangeChangedUtterance = new ActivationUtterance();
    tickMarkRangeProperty.lazyLink(() => {
      tickMarkRangeChangedUtterance.alert = this.getContextResponse();
      this.alertDescriptionUtterance(tickMarkRangeChangedUtterance);
    });
  }
  getContextResponse() {
    // TODO: PatternStringProperty when time, https://github.com/phetsims/ratio-and-proportion/issues/499
    return StringUtils.fillIn(RatioAndProportionStrings.a11y.create.tickMarkRangeContextResponseStringProperty, {
      range: this.tickMarkRangeMap[this.tickMarkRangeProperty.value]
    });
  }
  hideListBox() {
    this.enabledComboBox.hideListBox();
    this.disabledComboBox.hideListBox();
  }
}
ratioAndProportion.register('TickMarkRangeComboBoxNode', TickMarkRangeComboBoxNode);
export default TickMarkRangeComboBoxNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJTdHJpbmdVdGlscyIsIlBoZXRGb250IiwiSEJveCIsIkhTZXBhcmF0b3IiLCJOb2RlIiwiUmljaFRleHQiLCJDb21ib0JveCIsIlRhbmRlbSIsIkFjdGl2YXRpb25VdHRlcmFuY2UiLCJUaWNrTWFya1ZpZXciLCJyYXRpb0FuZFByb3BvcnRpb24iLCJSYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzIiwib3B0aW9uaXplIiwiVElDS19NQVJLX1JBTkdFX0ZPTlQiLCJSQU5HRV9URVhUX09QVElPTlMiLCJmb250IiwibWF4V2lkdGgiLCJUaWNrTWFya1JhbmdlQ29tYm9Cb3hOb2RlIiwiY29uc3RydWN0b3IiLCJ0aWNrTWFya1JhbmdlUHJvcGVydHkiLCJjb21ib0JveFBhcmVudCIsInRpY2tNYXJrVmlld1Byb3BlcnR5IiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInNwYWNpbmciLCJ0aWNrTWFya1JhbmdlTWFwIiwiemVyb1RvVGVuU3RyaW5nUHJvcGVydHkiLCJ6ZXJvVG9Ud2VudHlTdHJpbmdQcm9wZXJ0eSIsInplcm9Ub1RoaXJ0eVN0cmluZ1Byb3BlcnR5IiwiaXRlbXMiLCJ2YWx1ZSIsImNyZWF0ZU5vZGUiLCJhMTF5TmFtZSIsIndpZGVzdEl0ZW0iLCJNYXRoIiwibWF4IiwibWFwIiwiaXRlbSIsIm5vZGUiLCJPUFRfT1VUIiwid2lkdGgiLCJkaXNwb3NlIiwibGFiZWxOb2RlIiwicmFuZ2VTdHJpbmdQcm9wZXJ0eSIsImNvbWJvQm94T3B0aW9ucyIsImhlbHBUZXh0IiwiYTExeSIsImNyZWF0ZSIsInRpY2tNYXJrUmFuZ2VIZWxwVGV4dFN0cmluZ1Byb3BlcnR5IiwiYWNjZXNzaWJsZU5hbWUiLCJjb21ib0JveFZvaWNpbmdOYW1lUmVzcG9uc2VQYXR0ZXJuIiwicmFuZ2VMYWJlbFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSIsImNvbWJvQm94Vm9pY2luZ0NvbnRleHRSZXNwb25zZSIsImdldENvbnRleHRSZXNwb25zZSIsImNvbWJvQm94Vm9pY2luZ0hpbnRSZXNwb25zZSIsInRhbmRlbSIsImVuYWJsZWRDb21ib0JveCIsImRpc2FibGVkQ29tYm9Cb3giLCJwcmVmZXJyZWRXaWR0aCIsImNlbnRlclkiLCJ0aWNrTWFyayIsInRpY2tNYXJrc0hpZGRlblN0cmluZ1Byb3BlcnR5IiwiZW5hYmxlZFByb3BlcnR5IiwibGluayIsInRpY2tNYXJrVmlldyIsImNoaWxkcmVuIiwiTk9ORSIsInRpY2tNYXJrUmFuZ2VDaGFuZ2VkVXR0ZXJhbmNlIiwibGF6eUxpbmsiLCJhbGVydCIsImFsZXJ0RGVzY3JpcHRpb25VdHRlcmFuY2UiLCJmaWxsSW4iLCJ0aWNrTWFya1JhbmdlQ29udGV4dFJlc3BvbnNlU3RyaW5nUHJvcGVydHkiLCJyYW5nZSIsImhpZGVMaXN0Qm94IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJUaWNrTWFya1JhbmdlQ29tYm9Cb3hOb2RlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIwLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEEgY29tYm8gYm94IHRoYXQgZGlzcGxheXMgdGhlIHBvc3NpYmxlIHJhbmdlcyBmb3IgdGhlIHRpY2sgbWFya3MgYW5kIGxhYmVscy4gVGhlIGRlc2lnbiByZXF1aXJlbWVudHMgZm9yIHRoaXNcclxuICogY29tcG9uZW50IHN0YXRlIHRoYXQgd2hlbiBkaXNhYmxlZCwgdGhhdCB0aGUgZWxlbWVudHMgYXJlbid0IHNob3duIChhcyB0aGV5IGFyZSBhIGRpc3RyYWN0aW9uIHRvIHRoZSBwZWRhZ29neSkuXHJcbiAqIEluc3RlYWQsIHRoZXkgYXJlIHJlcGxhY2VkIHdpdGggYSBzb2xpZCBob3Jpem9udGFsIGxpbmUuIFRvIGFjY29tcGxpc2ggdGhpcywgdHdvIENvbWJvQm94ZXMgYXJlIGNyZWF0ZWQgYW5kIHRoZW5cclxuICogc3dhcHBlZCBvdXQuIFRoaXMgZW5kZWQgdXAgYmVpbmcgZWFzaWVyIGFuZCBzaW1wbGVyIHRoYW4gdHJ5aW5nIHRvIGFkZCB0aGUgYWJpbGl0eSB0byBzd2FwLW91dCBOb2RlcyAoYW5kIHRoZWlyIFBET01cclxuICogY29udGVudCkgZHluYW1pY2FsbHkgdG8gYSBzaW5nbGUgQ29tYm9Cb3ggaW5zdGFuY2UuXHJcbiAqXHJcbiAqIEBhdXRob3IgTWljaGFlbCBLYXV6bWFubiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IFN0cmluZ1V0aWxzIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdXRpbC9TdHJpbmdVdGlscy5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBIQm94LCBIQm94T3B0aW9ucywgSFNlcGFyYXRvciwgTm9kZSwgUmljaFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgQ29tYm9Cb3gsIHsgQ29tYm9Cb3hJdGVtLCBDb21ib0JveE9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvQ29tYm9Cb3guanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgQWN0aXZhdGlvblV0dGVyYW5jZSBmcm9tICcuLi8uLi8uLi8uLi91dHRlcmFuY2UtcXVldWUvanMvQWN0aXZhdGlvblV0dGVyYW5jZS5qcyc7XHJcbmltcG9ydCBUaWNrTWFya1ZpZXcgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvVGlja01hcmtWaWV3LmpzJztcclxuaW1wb3J0IHJhdGlvQW5kUHJvcG9ydGlvbiBmcm9tICcuLi8uLi9yYXRpb0FuZFByb3BvcnRpb24uanMnO1xyXG5pbXBvcnQgUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncyBmcm9tICcuLi8uLi9SYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzLmpzJztcclxuaW1wb3J0IEVudW1lcmF0aW9uUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9FbnVtZXJhdGlvblByb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5cclxuY29uc3QgVElDS19NQVJLX1JBTkdFX0ZPTlQgPSBuZXcgUGhldEZvbnQoIDE2ICk7XHJcbmNvbnN0IFJBTkdFX1RFWFRfT1BUSU9OUyA9IHsgZm9udDogVElDS19NQVJLX1JBTkdFX0ZPTlQsIG1heFdpZHRoOiA5MCB9O1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcblxyXG5jbGFzcyBUaWNrTWFya1JhbmdlQ29tYm9Cb3hOb2RlIGV4dGVuZHMgSEJveCB7XHJcblxyXG4gIHByaXZhdGUgZW5hYmxlZENvbWJvQm94OiBDb21ib0JveDxudW1iZXI+O1xyXG4gIHByaXZhdGUgZGlzYWJsZWRDb21ib0JveDogQ29tYm9Cb3g8dHJ1ZSB8IG51bWJlcj47XHJcbiAgcHJpdmF0ZSB0aWNrTWFya1JhbmdlTWFwOiBSZWNvcmQ8bnVtYmVyLCBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+PjtcclxuICBwcml2YXRlIHRpY2tNYXJrUmFuZ2VQcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyPjtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCB0aWNrTWFya1JhbmdlUHJvcGVydHk6IFByb3BlcnR5PG51bWJlcj4sIGNvbWJvQm94UGFyZW50OiBOb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGlja01hcmtWaWV3UHJvcGVydHk6IEVudW1lcmF0aW9uUHJvcGVydHk8VGlja01hcmtWaWV3PiwgcHJvdmlkZWRPcHRpb25zPzogSEJveE9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxIQm94T3B0aW9ucywgU2VsZk9wdGlvbnMsIEhCb3hPcHRpb25zPigpKCB7XHJcbiAgICAgIHNwYWNpbmc6IDEwXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMudGlja01hcmtSYW5nZU1hcCA9IHtcclxuICAgICAgMTA6IFJhdGlvQW5kUHJvcG9ydGlvblN0cmluZ3MuemVyb1RvVGVuU3RyaW5nUHJvcGVydHksXHJcbiAgICAgIDIwOiBSYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzLnplcm9Ub1R3ZW50eVN0cmluZ1Byb3BlcnR5LFxyXG4gICAgICAzMDogUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy56ZXJvVG9UaGlydHlTdHJpbmdQcm9wZXJ0eVxyXG4gICAgfTtcclxuICAgIHRoaXMudGlja01hcmtSYW5nZVByb3BlcnR5ID0gdGlja01hcmtSYW5nZVByb3BlcnR5O1xyXG5cclxuICAgIGNvbnN0IGl0ZW1zOiBDb21ib0JveEl0ZW08bnVtYmVyPltdID0gW1xyXG4gICAgICB7IHZhbHVlOiAxMCwgY3JlYXRlTm9kZTogKCkgPT4gbmV3IFJpY2hUZXh0KCB0aGlzLnRpY2tNYXJrUmFuZ2VNYXBbIDEwIF0sIFJBTkdFX1RFWFRfT1BUSU9OUyApLCBhMTF5TmFtZTogUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy56ZXJvVG9UZW5TdHJpbmdQcm9wZXJ0eSB9LFxyXG4gICAgICB7IHZhbHVlOiAyMCwgY3JlYXRlTm9kZTogKCkgPT4gbmV3IFJpY2hUZXh0KCB0aGlzLnRpY2tNYXJrUmFuZ2VNYXBbIDIwIF0sIFJBTkdFX1RFWFRfT1BUSU9OUyApLCBhMTF5TmFtZTogUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy56ZXJvVG9Ud2VudHlTdHJpbmdQcm9wZXJ0eSB9LFxyXG4gICAgICB7IHZhbHVlOiAzMCwgY3JlYXRlTm9kZTogKCkgPT4gbmV3IFJpY2hUZXh0KCB0aGlzLnRpY2tNYXJrUmFuZ2VNYXBbIDMwIF0sIFJBTkdFX1RFWFRfT1BUSU9OUyApLCBhMTF5TmFtZTogUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy56ZXJvVG9UaGlydHlTdHJpbmdQcm9wZXJ0eSB9XHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IHdpZGVzdEl0ZW0gPSBNYXRoLm1heCggLi4uaXRlbXMubWFwKCBpdGVtID0+IHtcclxuICAgICAgY29uc3Qgbm9kZSA9IGl0ZW0uY3JlYXRlTm9kZSggVGFuZGVtLk9QVF9PVVQgKTtcclxuICAgICAgY29uc3Qgd2lkdGggPSBub2RlLndpZHRoO1xyXG4gICAgICBub2RlLmRpc3Bvc2UoKTtcclxuICAgICAgcmV0dXJuIHdpZHRoO1xyXG4gICAgfSApICk7XHJcblxyXG4gICAgY29uc3QgbGFiZWxOb2RlID0gbmV3IFJpY2hUZXh0KCBSYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzLnJhbmdlU3RyaW5nUHJvcGVydHksIFJBTkdFX1RFWFRfT1BUSU9OUyApO1xyXG5cclxuICAgIGNvbnN0IGNvbWJvQm94T3B0aW9uczogQ29tYm9Cb3hPcHRpb25zID0ge1xyXG4gICAgICBoZWxwVGV4dDogUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy5hMTF5LmNyZWF0ZS50aWNrTWFya1JhbmdlSGVscFRleHRTdHJpbmdQcm9wZXJ0eSxcclxuICAgICAgYWNjZXNzaWJsZU5hbWU6IFJhdGlvQW5kUHJvcG9ydGlvblN0cmluZ3MucmFuZ2VTdHJpbmdQcm9wZXJ0eSxcclxuICAgICAgbWF4V2lkdGg6IDI1MCwgLy8gZW1waXJpY2FsbHkgZGV0ZXJtaW5lZFxyXG5cclxuICAgICAgY29tYm9Cb3hWb2ljaW5nTmFtZVJlc3BvbnNlUGF0dGVybjogUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy5hMTF5LmNyZWF0ZS5yYW5nZUxhYmVsUGF0dGVyblN0cmluZ1Byb3BlcnR5LFxyXG4gICAgICBjb21ib0JveFZvaWNpbmdDb250ZXh0UmVzcG9uc2U6ICgpID0+IHRoaXMuZ2V0Q29udGV4dFJlc3BvbnNlKCksXHJcbiAgICAgIGNvbWJvQm94Vm9pY2luZ0hpbnRSZXNwb25zZTogUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy5hMTF5LmNyZWF0ZS50aWNrTWFya1JhbmdlSGVscFRleHRTdHJpbmdQcm9wZXJ0eSxcclxuXHJcbiAgICAgIC8vIHBoZXQtaW9cclxuICAgICAgdGFuZGVtOiBUYW5kZW0uT1BUX09VVFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmVuYWJsZWRDb21ib0JveCA9IG5ldyBDb21ib0JveCggdGlja01hcmtSYW5nZVByb3BlcnR5LCBpdGVtcywgY29tYm9Cb3hQYXJlbnQsIGNvbWJvQm94T3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IHZhbHVlID0gdHJ1ZTtcclxuXHJcbiAgICAvLyBOT1RFOiBUaGUgdmFsdWVzIGFyZSBbIDEwLCB0cnVlIF0uLi4gc28gaXQncyB0eXBlZCBpbnRlcmVzdGluZ2x5LlxyXG4gICAgdGhpcy5kaXNhYmxlZENvbWJvQm94ID0gbmV3IENvbWJvQm94PHRydWUgfCBudW1iZXI+KCBuZXcgQm9vbGVhblByb3BlcnR5KCB2YWx1ZSApIGFzIFByb3BlcnR5PHRydWUgfCBudW1iZXI+LCBbXHJcbiAgICAgIHtcclxuICAgICAgICB2YWx1ZTogdmFsdWUsXHJcbiAgICAgICAgY3JlYXRlTm9kZTogKCkgPT4gbmV3IEhTZXBhcmF0b3IoIHsgcHJlZmVycmVkV2lkdGg6IHdpZGVzdEl0ZW0sIGNlbnRlclk6IC01IH0gKSxcclxuICAgICAgICBhMTF5TmFtZTogUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy5hMTF5LnRpY2tNYXJrLnRpY2tNYXJrc0hpZGRlblN0cmluZ1Byb3BlcnR5XHJcbiAgICAgIH0sXHJcbiAgICAgIGl0ZW1zWyAwIF0gLy8gYWRkIHRoaXMgb25lIHRvIGdldCB0aGUgcHJvcGVyIGhlaWdodCBvZiB0aGUgdGV4dC5cclxuICAgIF0sIG5ldyBOb2RlKCksIGNvbWJvQm94T3B0aW9ucyApO1xyXG5cclxuICAgIC8vIGFsd2F5cyBkaXNhYmxlZFxyXG4gICAgdGhpcy5kaXNhYmxlZENvbWJvQm94LmVuYWJsZWRQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG5cclxuICAgIC8vIHdoZW4gbm90IGRpc3BsYXlpbmcgdGhlIHRpY2sgbWFya3MsIHNob3cgdGhlIFwiYmxhbmtcIiBsaW5lIGluc3RlYWQgb2YgdGhlIFJpY2hUZXh0LlxyXG4gICAgdGlja01hcmtWaWV3UHJvcGVydHkubGluayggdGlja01hcmtWaWV3ID0+IHtcclxuICAgICAgdGhpcy5jaGlsZHJlbiA9IHRpY2tNYXJrVmlldyA9PT0gVGlja01hcmtWaWV3Lk5PTkUgPyBbIGxhYmVsTm9kZSwgdGhpcy5kaXNhYmxlZENvbWJvQm94IF0gOiBbIGxhYmVsTm9kZSwgdGhpcy5lbmFibGVkQ29tYm9Cb3ggXTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCB0aWNrTWFya1JhbmdlQ2hhbmdlZFV0dGVyYW5jZSA9IG5ldyBBY3RpdmF0aW9uVXR0ZXJhbmNlKCk7XHJcblxyXG4gICAgdGlja01hcmtSYW5nZVByb3BlcnR5LmxhenlMaW5rKCAoKSA9PiB7XHJcbiAgICAgIHRpY2tNYXJrUmFuZ2VDaGFuZ2VkVXR0ZXJhbmNlLmFsZXJ0ID0gdGhpcy5nZXRDb250ZXh0UmVzcG9uc2UoKTtcclxuICAgICAgdGhpcy5hbGVydERlc2NyaXB0aW9uVXR0ZXJhbmNlKCB0aWNrTWFya1JhbmdlQ2hhbmdlZFV0dGVyYW5jZSApO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRDb250ZXh0UmVzcG9uc2UoKTogc3RyaW5nIHtcclxuICAgIC8vIFRPRE86IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSB3aGVuIHRpbWUsIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9yYXRpby1hbmQtcHJvcG9ydGlvbi9pc3N1ZXMvNDk5XHJcbiAgICByZXR1cm4gU3RyaW5nVXRpbHMuZmlsbEluKCBSYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzLmExMXkuY3JlYXRlLnRpY2tNYXJrUmFuZ2VDb250ZXh0UmVzcG9uc2VTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICByYW5nZTogdGhpcy50aWNrTWFya1JhbmdlTWFwWyB0aGlzLnRpY2tNYXJrUmFuZ2VQcm9wZXJ0eS52YWx1ZSBdXHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaGlkZUxpc3RCb3goKTogdm9pZCB7XHJcbiAgICB0aGlzLmVuYWJsZWRDb21ib0JveC5oaWRlTGlzdEJveCgpO1xyXG4gICAgdGhpcy5kaXNhYmxlZENvbWJvQm94LmhpZGVMaXN0Qm94KCk7XHJcbiAgfVxyXG59XHJcblxyXG5yYXRpb0FuZFByb3BvcnRpb24ucmVnaXN0ZXIoICdUaWNrTWFya1JhbmdlQ29tYm9Cb3hOb2RlJywgVGlja01hcmtSYW5nZUNvbWJvQm94Tm9kZSApO1xyXG5leHBvcnQgZGVmYXVsdCBUaWNrTWFya1JhbmdlQ29tYm9Cb3hOb2RlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsV0FBVyxNQUFNLCtDQUErQztBQUN2RSxPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELFNBQVNDLElBQUksRUFBZUMsVUFBVSxFQUFFQyxJQUFJLEVBQUVDLFFBQVEsUUFBUSxtQ0FBbUM7QUFDakcsT0FBT0MsUUFBUSxNQUF5QyxnQ0FBZ0M7QUFDeEYsT0FBT0MsTUFBTSxNQUFNLGlDQUFpQztBQUNwRCxPQUFPQyxtQkFBbUIsTUFBTSx1REFBdUQ7QUFDdkYsT0FBT0MsWUFBWSxNQUFNLG1DQUFtQztBQUM1RCxPQUFPQyxrQkFBa0IsTUFBTSw2QkFBNkI7QUFDNUQsT0FBT0MseUJBQXlCLE1BQU0sb0NBQW9DO0FBSTFFLE9BQU9DLFNBQVMsTUFBNEIsdUNBQXVDO0FBRW5GLE1BQU1DLG9CQUFvQixHQUFHLElBQUlaLFFBQVEsQ0FBRSxFQUFHLENBQUM7QUFDL0MsTUFBTWEsa0JBQWtCLEdBQUc7RUFBRUMsSUFBSSxFQUFFRixvQkFBb0I7RUFBRUcsUUFBUSxFQUFFO0FBQUcsQ0FBQztBQUl2RSxNQUFNQyx5QkFBeUIsU0FBU2YsSUFBSSxDQUFDO0VBT3BDZ0IsV0FBV0EsQ0FBRUMscUJBQXVDLEVBQUVDLGNBQW9CLEVBQzdEQyxvQkFBdUQsRUFBRUMsZUFBNkIsRUFBRztJQUUzRyxNQUFNQyxPQUFPLEdBQUdYLFNBQVMsQ0FBd0MsQ0FBQyxDQUFFO01BQ2xFWSxPQUFPLEVBQUU7SUFDWCxDQUFDLEVBQUVGLGVBQWdCLENBQUM7SUFFcEIsS0FBSyxDQUFFQyxPQUFRLENBQUM7SUFFaEIsSUFBSSxDQUFDRSxnQkFBZ0IsR0FBRztNQUN0QixFQUFFLEVBQUVkLHlCQUF5QixDQUFDZSx1QkFBdUI7TUFDckQsRUFBRSxFQUFFZix5QkFBeUIsQ0FBQ2dCLDBCQUEwQjtNQUN4RCxFQUFFLEVBQUVoQix5QkFBeUIsQ0FBQ2lCO0lBQ2hDLENBQUM7SUFDRCxJQUFJLENBQUNULHFCQUFxQixHQUFHQSxxQkFBcUI7SUFFbEQsTUFBTVUsS0FBNkIsR0FBRyxDQUNwQztNQUFFQyxLQUFLLEVBQUUsRUFBRTtNQUFFQyxVQUFVLEVBQUVBLENBQUEsS0FBTSxJQUFJMUIsUUFBUSxDQUFFLElBQUksQ0FBQ29CLGdCQUFnQixDQUFFLEVBQUUsQ0FBRSxFQUFFWCxrQkFBbUIsQ0FBQztNQUFFa0IsUUFBUSxFQUFFckIseUJBQXlCLENBQUNlO0lBQXdCLENBQUMsRUFDN0o7TUFBRUksS0FBSyxFQUFFLEVBQUU7TUFBRUMsVUFBVSxFQUFFQSxDQUFBLEtBQU0sSUFBSTFCLFFBQVEsQ0FBRSxJQUFJLENBQUNvQixnQkFBZ0IsQ0FBRSxFQUFFLENBQUUsRUFBRVgsa0JBQW1CLENBQUM7TUFBRWtCLFFBQVEsRUFBRXJCLHlCQUF5QixDQUFDZ0I7SUFBMkIsQ0FBQyxFQUNoSztNQUFFRyxLQUFLLEVBQUUsRUFBRTtNQUFFQyxVQUFVLEVBQUVBLENBQUEsS0FBTSxJQUFJMUIsUUFBUSxDQUFFLElBQUksQ0FBQ29CLGdCQUFnQixDQUFFLEVBQUUsQ0FBRSxFQUFFWCxrQkFBbUIsQ0FBQztNQUFFa0IsUUFBUSxFQUFFckIseUJBQXlCLENBQUNpQjtJQUEyQixDQUFDLENBQ2pLO0lBRUQsTUFBTUssVUFBVSxHQUFHQyxJQUFJLENBQUNDLEdBQUcsQ0FBRSxHQUFHTixLQUFLLENBQUNPLEdBQUcsQ0FBRUMsSUFBSSxJQUFJO01BQ2pELE1BQU1DLElBQUksR0FBR0QsSUFBSSxDQUFDTixVQUFVLENBQUV4QixNQUFNLENBQUNnQyxPQUFRLENBQUM7TUFDOUMsTUFBTUMsS0FBSyxHQUFHRixJQUFJLENBQUNFLEtBQUs7TUFDeEJGLElBQUksQ0FBQ0csT0FBTyxDQUFDLENBQUM7TUFDZCxPQUFPRCxLQUFLO0lBQ2QsQ0FBRSxDQUFFLENBQUM7SUFFTCxNQUFNRSxTQUFTLEdBQUcsSUFBSXJDLFFBQVEsQ0FBRU0seUJBQXlCLENBQUNnQyxtQkFBbUIsRUFBRTdCLGtCQUFtQixDQUFDO0lBRW5HLE1BQU04QixlQUFnQyxHQUFHO01BQ3ZDQyxRQUFRLEVBQUVsQyx5QkFBeUIsQ0FBQ21DLElBQUksQ0FBQ0MsTUFBTSxDQUFDQyxtQ0FBbUM7TUFDbkZDLGNBQWMsRUFBRXRDLHlCQUF5QixDQUFDZ0MsbUJBQW1CO01BQzdEM0IsUUFBUSxFQUFFLEdBQUc7TUFBRTs7TUFFZmtDLGtDQUFrQyxFQUFFdkMseUJBQXlCLENBQUNtQyxJQUFJLENBQUNDLE1BQU0sQ0FBQ0ksK0JBQStCO01BQ3pHQyw4QkFBOEIsRUFBRUEsQ0FBQSxLQUFNLElBQUksQ0FBQ0Msa0JBQWtCLENBQUMsQ0FBQztNQUMvREMsMkJBQTJCLEVBQUUzQyx5QkFBeUIsQ0FBQ21DLElBQUksQ0FBQ0MsTUFBTSxDQUFDQyxtQ0FBbUM7TUFFdEc7TUFDQU8sTUFBTSxFQUFFaEQsTUFBTSxDQUFDZ0M7SUFDakIsQ0FBQztJQUVELElBQUksQ0FBQ2lCLGVBQWUsR0FBRyxJQUFJbEQsUUFBUSxDQUFFYSxxQkFBcUIsRUFBRVUsS0FBSyxFQUFFVCxjQUFjLEVBQUV3QixlQUFnQixDQUFDO0lBRXBHLE1BQU1kLEtBQUssR0FBRyxJQUFJOztJQUVsQjtJQUNBLElBQUksQ0FBQzJCLGdCQUFnQixHQUFHLElBQUluRCxRQUFRLENBQWlCLElBQUlQLGVBQWUsQ0FBRStCLEtBQU0sQ0FBQyxFQUE2QixDQUM1RztNQUNFQSxLQUFLLEVBQUVBLEtBQUs7TUFDWkMsVUFBVSxFQUFFQSxDQUFBLEtBQU0sSUFBSTVCLFVBQVUsQ0FBRTtRQUFFdUQsY0FBYyxFQUFFekIsVUFBVTtRQUFFMEIsT0FBTyxFQUFFLENBQUM7TUFBRSxDQUFFLENBQUM7TUFDL0UzQixRQUFRLEVBQUVyQix5QkFBeUIsQ0FBQ21DLElBQUksQ0FBQ2MsUUFBUSxDQUFDQztJQUNwRCxDQUFDLEVBQ0RoQyxLQUFLLENBQUUsQ0FBQyxDQUFFLENBQUM7SUFBQSxDQUNaLEVBQUUsSUFBSXpCLElBQUksQ0FBQyxDQUFDLEVBQUV3QyxlQUFnQixDQUFDOztJQUVoQztJQUNBLElBQUksQ0FBQ2EsZ0JBQWdCLENBQUNLLGVBQWUsQ0FBQ2hDLEtBQUssR0FBRyxLQUFLOztJQUVuRDtJQUNBVCxvQkFBb0IsQ0FBQzBDLElBQUksQ0FBRUMsWUFBWSxJQUFJO01BQ3pDLElBQUksQ0FBQ0MsUUFBUSxHQUFHRCxZQUFZLEtBQUt2RCxZQUFZLENBQUN5RCxJQUFJLEdBQUcsQ0FBRXhCLFNBQVMsRUFBRSxJQUFJLENBQUNlLGdCQUFnQixDQUFFLEdBQUcsQ0FBRWYsU0FBUyxFQUFFLElBQUksQ0FBQ2MsZUFBZSxDQUFFO0lBQ2pJLENBQUUsQ0FBQztJQUVILE1BQU1XLDZCQUE2QixHQUFHLElBQUkzRCxtQkFBbUIsQ0FBQyxDQUFDO0lBRS9EVyxxQkFBcUIsQ0FBQ2lELFFBQVEsQ0FBRSxNQUFNO01BQ3BDRCw2QkFBNkIsQ0FBQ0UsS0FBSyxHQUFHLElBQUksQ0FBQ2hCLGtCQUFrQixDQUFDLENBQUM7TUFDL0QsSUFBSSxDQUFDaUIseUJBQXlCLENBQUVILDZCQUE4QixDQUFDO0lBQ2pFLENBQUUsQ0FBQztFQUNMO0VBRVFkLGtCQUFrQkEsQ0FBQSxFQUFXO0lBQ25DO0lBQ0EsT0FBT3JELFdBQVcsQ0FBQ3VFLE1BQU0sQ0FBRTVELHlCQUF5QixDQUFDbUMsSUFBSSxDQUFDQyxNQUFNLENBQUN5QiwwQ0FBMEMsRUFBRTtNQUMzR0MsS0FBSyxFQUFFLElBQUksQ0FBQ2hELGdCQUFnQixDQUFFLElBQUksQ0FBQ04scUJBQXFCLENBQUNXLEtBQUs7SUFDaEUsQ0FBRSxDQUFDO0VBQ0w7RUFFTzRDLFdBQVdBLENBQUEsRUFBUztJQUN6QixJQUFJLENBQUNsQixlQUFlLENBQUNrQixXQUFXLENBQUMsQ0FBQztJQUNsQyxJQUFJLENBQUNqQixnQkFBZ0IsQ0FBQ2lCLFdBQVcsQ0FBQyxDQUFDO0VBQ3JDO0FBQ0Y7QUFFQWhFLGtCQUFrQixDQUFDaUUsUUFBUSxDQUFFLDJCQUEyQixFQUFFMUQseUJBQTBCLENBQUM7QUFDckYsZUFBZUEseUJBQXlCIn0=