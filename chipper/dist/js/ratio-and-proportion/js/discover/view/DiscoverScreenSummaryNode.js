// Copyright 2020-2022, University of Colorado Boulder

/**
 * Node that holds the PDOM content for the screen summary in Ratio and Proportion. It also creates content for the voicing
 * overview buttons as appropriate.
 *
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import { Node } from '../../../../scenery/js/imports.js';
import ratioAndProportion from '../../ratioAndProportion.js';
import RatioAndProportionStrings from '../../RatioAndProportionStrings.js';
import BackgroundColorHandler from '../../common/view/BackgroundColorHandler.js';
import Multilink from '../../../../axon/js/Multilink.js';
class DiscoverScreenSummaryNode extends Node {
  constructor(ratioFitnessProperty, ratioTupleProperty, targetRatioProperty, tickMarkViewProperty, ratioDescriber, inProportionProperty, handPositionsDescriber, ratioToChallengeInfoMap) {
    const stateOfSimNode = new Node({
      tagName: 'p'
    });
    const leftHandBullet = new Node({
      tagName: 'li'
    });
    const rightHandBullet = new Node({
      tagName: 'li'
    });
    const descriptionBullets = new Node({
      tagName: 'ul',
      children: [leftHandBullet, rightHandBullet]
    });
    super({
      children: [new Node({
        tagName: 'p',
        innerContent: RatioAndProportionStrings.a11y.discover.screenSummary.paragraph1StringProperty
      }), new Node({
        tagName: 'p',
        innerContent: RatioAndProportionStrings.a11y.discover.screenSummary.paragraph2StringProperty
      }), new Node({
        tagName: 'p',
        innerContent: RatioAndProportionStrings.a11y.discover.screenSummary.paragraph3StringProperty
      }), stateOfSimNode, descriptionBullets, new Node({
        tagName: 'p',
        innerContent: RatioAndProportionStrings.a11y.discover.screenSummary.interactionHintStringProperty
      })]
    });
    this.handPositionsDescriber = handPositionsDescriber;
    this.ratioDescriber = ratioDescriber;
    this.targetRatioProperty = targetRatioProperty;
    this.tickMarkViewProperty = tickMarkViewProperty;
    this.ratioTupleProperty = ratioTupleProperty;
    this.ratioFitnessProperty = ratioFitnessProperty;
    this.inProportionProperty = inProportionProperty;
    this.ratioToChallengeInfoMap = ratioToChallengeInfoMap;

    // This derivedProperty is already dependent on all other dependencies for getStateOfSimString
    Multilink.multilink([targetRatioProperty, tickMarkViewProperty, ratioTupleProperty, ratioFitnessProperty, inProportionProperty], (targetRatio, tickMarkView) => {
      stateOfSimNode.innerContent = this.getStateOfSim();
      leftHandBullet.innerContent = this.getLeftHandState();
      rightHandBullet.innerContent = this.getRightHandState();
    });
  }
  getStateOfSim() {
    // TODO: PatternStringProperty when time, https://github.com/phetsims/ratio-and-proportion/issues/499
    return StringUtils.fillIn(RatioAndProportionStrings.a11y.screenSummaryQualitativeStateOfSimStringProperty, {
      color: BackgroundColorHandler.getCurrentColorRegion(this.ratioFitnessProperty.value, this.inProportionProperty.value),
      ratioFitness: this.ratioDescriber.getRatioFitness(false),
      currentChallenge: this.ratioToChallengeInfoMap.get(this.targetRatioProperty.value).lowercaseStringProperty,
      distance: this.handPositionsDescriber.getDistanceRegion(true)
    });
  }
  getLeftHandState() {
    // TODO: PatternStringProperty when time, https://github.com/phetsims/ratio-and-proportion/issues/499
    return StringUtils.fillIn(RatioAndProportionStrings.a11y.leftHandBulletStringProperty, {
      position: this.handPositionsDescriber.getHandPositionDescription(this.ratioTupleProperty.value.antecedent, this.tickMarkViewProperty.value)
    });
  }
  getRightHandState() {
    // TODO: PatternStringProperty when time, https://github.com/phetsims/ratio-and-proportion/issues/499
    return StringUtils.fillIn(RatioAndProportionStrings.a11y.rightHandBulletStringProperty, {
      position: this.handPositionsDescriber.getHandPositionDescription(this.ratioTupleProperty.value.consequent, this.tickMarkViewProperty.value)
    });
  }
  getDetailsButtonState() {
    // TODO: PatternStringProperty when time, https://github.com/phetsims/ratio-and-proportion/issues/499
    return StringUtils.fillIn(RatioAndProportionStrings.a11y.detailsButtonPatternStringProperty, {
      stateOfSim: this.getStateOfSim(),
      leftHand: this.getLeftHandState(),
      rightHand: this.getRightHandState()
    });
  }
}
ratioAndProportion.register('DiscoverScreenSummaryNode', DiscoverScreenSummaryNode);
export default DiscoverScreenSummaryNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTdHJpbmdVdGlscyIsIk5vZGUiLCJyYXRpb0FuZFByb3BvcnRpb24iLCJSYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzIiwiQmFja2dyb3VuZENvbG9ySGFuZGxlciIsIk11bHRpbGluayIsIkRpc2NvdmVyU2NyZWVuU3VtbWFyeU5vZGUiLCJjb25zdHJ1Y3RvciIsInJhdGlvRml0bmVzc1Byb3BlcnR5IiwicmF0aW9UdXBsZVByb3BlcnR5IiwidGFyZ2V0UmF0aW9Qcm9wZXJ0eSIsInRpY2tNYXJrVmlld1Byb3BlcnR5IiwicmF0aW9EZXNjcmliZXIiLCJpblByb3BvcnRpb25Qcm9wZXJ0eSIsImhhbmRQb3NpdGlvbnNEZXNjcmliZXIiLCJyYXRpb1RvQ2hhbGxlbmdlSW5mb01hcCIsInN0YXRlT2ZTaW1Ob2RlIiwidGFnTmFtZSIsImxlZnRIYW5kQnVsbGV0IiwicmlnaHRIYW5kQnVsbGV0IiwiZGVzY3JpcHRpb25CdWxsZXRzIiwiY2hpbGRyZW4iLCJpbm5lckNvbnRlbnQiLCJhMTF5IiwiZGlzY292ZXIiLCJzY3JlZW5TdW1tYXJ5IiwicGFyYWdyYXBoMVN0cmluZ1Byb3BlcnR5IiwicGFyYWdyYXBoMlN0cmluZ1Byb3BlcnR5IiwicGFyYWdyYXBoM1N0cmluZ1Byb3BlcnR5IiwiaW50ZXJhY3Rpb25IaW50U3RyaW5nUHJvcGVydHkiLCJtdWx0aWxpbmsiLCJ0YXJnZXRSYXRpbyIsInRpY2tNYXJrVmlldyIsImdldFN0YXRlT2ZTaW0iLCJnZXRMZWZ0SGFuZFN0YXRlIiwiZ2V0UmlnaHRIYW5kU3RhdGUiLCJmaWxsSW4iLCJzY3JlZW5TdW1tYXJ5UXVhbGl0YXRpdmVTdGF0ZU9mU2ltU3RyaW5nUHJvcGVydHkiLCJjb2xvciIsImdldEN1cnJlbnRDb2xvclJlZ2lvbiIsInZhbHVlIiwicmF0aW9GaXRuZXNzIiwiZ2V0UmF0aW9GaXRuZXNzIiwiY3VycmVudENoYWxsZW5nZSIsImdldCIsImxvd2VyY2FzZVN0cmluZ1Byb3BlcnR5IiwiZGlzdGFuY2UiLCJnZXREaXN0YW5jZVJlZ2lvbiIsImxlZnRIYW5kQnVsbGV0U3RyaW5nUHJvcGVydHkiLCJwb3NpdGlvbiIsImdldEhhbmRQb3NpdGlvbkRlc2NyaXB0aW9uIiwiYW50ZWNlZGVudCIsInJpZ2h0SGFuZEJ1bGxldFN0cmluZ1Byb3BlcnR5IiwiY29uc2VxdWVudCIsImdldERldGFpbHNCdXR0b25TdGF0ZSIsImRldGFpbHNCdXR0b25QYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJzdGF0ZU9mU2ltIiwibGVmdEhhbmQiLCJyaWdodEhhbmQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkRpc2NvdmVyU2NyZWVuU3VtbWFyeU5vZGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjAtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogTm9kZSB0aGF0IGhvbGRzIHRoZSBQRE9NIGNvbnRlbnQgZm9yIHRoZSBzY3JlZW4gc3VtbWFyeSBpbiBSYXRpbyBhbmQgUHJvcG9ydGlvbi4gSXQgYWxzbyBjcmVhdGVzIGNvbnRlbnQgZm9yIHRoZSB2b2ljaW5nXHJcbiAqIG92ZXJ2aWV3IGJ1dHRvbnMgYXMgYXBwcm9wcmlhdGUuXHJcbiAqXHJcbiAqIEBhdXRob3IgTWljaGFlbCBLYXV6bWFubiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBTdHJpbmdVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3V0aWwvU3RyaW5nVXRpbHMuanMnO1xyXG5pbXBvcnQgeyBOb2RlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IHJhdGlvQW5kUHJvcG9ydGlvbiBmcm9tICcuLi8uLi9yYXRpb0FuZFByb3BvcnRpb24uanMnO1xyXG5pbXBvcnQgUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncyBmcm9tICcuLi8uLi9SYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzLmpzJztcclxuaW1wb3J0IFJBUFJhdGlvVHVwbGUgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL1JBUFJhdGlvVHVwbGUuanMnO1xyXG5pbXBvcnQgSGFuZFBvc2l0aW9uc0Rlc2NyaWJlciBmcm9tICcuLi8uLi9jb21tb24vdmlldy9kZXNjcmliZXJzL0hhbmRQb3NpdGlvbnNEZXNjcmliZXIuanMnO1xyXG5pbXBvcnQgVGlja01hcmtWaWV3IGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L1RpY2tNYXJrVmlldy5qcyc7XHJcbmltcG9ydCBCYWNrZ3JvdW5kQ29sb3JIYW5kbGVyIGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L0JhY2tncm91bmRDb2xvckhhbmRsZXIuanMnO1xyXG5pbXBvcnQgUmF0aW9EZXNjcmliZXIgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvZGVzY3JpYmVycy9SYXRpb0Rlc2NyaWJlci5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IEVudW1lcmF0aW9uUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9FbnVtZXJhdGlvblByb3BlcnR5LmpzJztcclxuaW1wb3J0IE11bHRpbGluayBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL011bHRpbGluay5qcyc7XHJcbmltcG9ydCB7IFJhdGlvVG9DaGFsbGVuZ2VJbmZvTWFwIH0gZnJvbSAnLi9DaGFsbGVuZ2VSYXRpb0NvbWJvQm94Tm9kZS5qcyc7XHJcblxyXG5jbGFzcyBEaXNjb3ZlclNjcmVlblN1bW1hcnlOb2RlIGV4dGVuZHMgTm9kZSB7XHJcbiAgcHJpdmF0ZSByYXRpb0Rlc2NyaWJlcjogUmF0aW9EZXNjcmliZXI7XHJcbiAgcHJpdmF0ZSBoYW5kUG9zaXRpb25zRGVzY3JpYmVyOiBIYW5kUG9zaXRpb25zRGVzY3JpYmVyO1xyXG4gIHByaXZhdGUgcmF0aW9GaXRuZXNzUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47XHJcbiAgcHJpdmF0ZSByYXRpb1R1cGxlUHJvcGVydHk6IFByb3BlcnR5PFJBUFJhdGlvVHVwbGU+O1xyXG4gIHByaXZhdGUgdGFyZ2V0UmF0aW9Qcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyPjtcclxuICBwcml2YXRlIHRpY2tNYXJrVmlld1Byb3BlcnR5OiBFbnVtZXJhdGlvblByb3BlcnR5PFRpY2tNYXJrVmlldz47XHJcbiAgcHJpdmF0ZSBpblByb3BvcnRpb25Qcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj47XHJcbiAgcHJpdmF0ZSByYXRpb1RvQ2hhbGxlbmdlSW5mb01hcDogUmF0aW9Ub0NoYWxsZW5nZUluZm9NYXA7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcmF0aW9GaXRuZXNzUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj4sIHJhdGlvVHVwbGVQcm9wZXJ0eTogUHJvcGVydHk8UkFQUmF0aW9UdXBsZT4sXHJcbiAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRSYXRpb1Byb3BlcnR5OiBQcm9wZXJ0eTxudW1iZXI+LCB0aWNrTWFya1ZpZXdQcm9wZXJ0eTogRW51bWVyYXRpb25Qcm9wZXJ0eTxUaWNrTWFya1ZpZXc+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgcmF0aW9EZXNjcmliZXI6IFJhdGlvRGVzY3JpYmVyLCBpblByb3BvcnRpb25Qcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj4sIGhhbmRQb3NpdGlvbnNEZXNjcmliZXI6IEhhbmRQb3NpdGlvbnNEZXNjcmliZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICByYXRpb1RvQ2hhbGxlbmdlSW5mb01hcDogUmF0aW9Ub0NoYWxsZW5nZUluZm9NYXAgKSB7XHJcblxyXG4gICAgY29uc3Qgc3RhdGVPZlNpbU5vZGUgPSBuZXcgTm9kZSgge1xyXG4gICAgICB0YWdOYW1lOiAncCdcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBsZWZ0SGFuZEJ1bGxldCA9IG5ldyBOb2RlKCB7IHRhZ05hbWU6ICdsaScgfSApO1xyXG4gICAgY29uc3QgcmlnaHRIYW5kQnVsbGV0ID0gbmV3IE5vZGUoIHsgdGFnTmFtZTogJ2xpJyB9ICk7XHJcbiAgICBjb25zdCBkZXNjcmlwdGlvbkJ1bGxldHMgPSBuZXcgTm9kZSgge1xyXG4gICAgICB0YWdOYW1lOiAndWwnLFxyXG4gICAgICBjaGlsZHJlbjogWyBsZWZ0SGFuZEJ1bGxldCwgcmlnaHRIYW5kQnVsbGV0IF1cclxuICAgIH0gKTtcclxuXHJcbiAgICBzdXBlcigge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIG5ldyBOb2RlKCB7XHJcbiAgICAgICAgICB0YWdOYW1lOiAncCcsXHJcbiAgICAgICAgICBpbm5lckNvbnRlbnQ6IFJhdGlvQW5kUHJvcG9ydGlvblN0cmluZ3MuYTExeS5kaXNjb3Zlci5zY3JlZW5TdW1tYXJ5LnBhcmFncmFwaDFTdHJpbmdQcm9wZXJ0eVxyXG4gICAgICAgIH0gKSxcclxuICAgICAgICBuZXcgTm9kZSgge1xyXG4gICAgICAgICAgdGFnTmFtZTogJ3AnLFxyXG4gICAgICAgICAgaW5uZXJDb250ZW50OiBSYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzLmExMXkuZGlzY292ZXIuc2NyZWVuU3VtbWFyeS5wYXJhZ3JhcGgyU3RyaW5nUHJvcGVydHlcclxuICAgICAgICB9ICksXHJcbiAgICAgICAgbmV3IE5vZGUoIHtcclxuICAgICAgICAgIHRhZ05hbWU6ICdwJyxcclxuICAgICAgICAgIGlubmVyQ29udGVudDogUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy5hMTF5LmRpc2NvdmVyLnNjcmVlblN1bW1hcnkucGFyYWdyYXBoM1N0cmluZ1Byb3BlcnR5XHJcbiAgICAgICAgfSApLFxyXG4gICAgICAgIHN0YXRlT2ZTaW1Ob2RlLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uQnVsbGV0cyxcclxuICAgICAgICBuZXcgTm9kZSgge1xyXG4gICAgICAgICAgdGFnTmFtZTogJ3AnLFxyXG4gICAgICAgICAgaW5uZXJDb250ZW50OiBSYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzLmExMXkuZGlzY292ZXIuc2NyZWVuU3VtbWFyeS5pbnRlcmFjdGlvbkhpbnRTdHJpbmdQcm9wZXJ0eVxyXG4gICAgICAgIH0gKVxyXG4gICAgICBdXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5oYW5kUG9zaXRpb25zRGVzY3JpYmVyID0gaGFuZFBvc2l0aW9uc0Rlc2NyaWJlcjtcclxuICAgIHRoaXMucmF0aW9EZXNjcmliZXIgPSByYXRpb0Rlc2NyaWJlcjtcclxuICAgIHRoaXMudGFyZ2V0UmF0aW9Qcm9wZXJ0eSA9IHRhcmdldFJhdGlvUHJvcGVydHk7XHJcbiAgICB0aGlzLnRpY2tNYXJrVmlld1Byb3BlcnR5ID0gdGlja01hcmtWaWV3UHJvcGVydHk7XHJcbiAgICB0aGlzLnJhdGlvVHVwbGVQcm9wZXJ0eSA9IHJhdGlvVHVwbGVQcm9wZXJ0eTtcclxuICAgIHRoaXMucmF0aW9GaXRuZXNzUHJvcGVydHkgPSByYXRpb0ZpdG5lc3NQcm9wZXJ0eTtcclxuICAgIHRoaXMuaW5Qcm9wb3J0aW9uUHJvcGVydHkgPSBpblByb3BvcnRpb25Qcm9wZXJ0eTtcclxuICAgIHRoaXMucmF0aW9Ub0NoYWxsZW5nZUluZm9NYXAgPSByYXRpb1RvQ2hhbGxlbmdlSW5mb01hcDtcclxuXHJcbiAgICAvLyBUaGlzIGRlcml2ZWRQcm9wZXJ0eSBpcyBhbHJlYWR5IGRlcGVuZGVudCBvbiBhbGwgb3RoZXIgZGVwZW5kZW5jaWVzIGZvciBnZXRTdGF0ZU9mU2ltU3RyaW5nXHJcbiAgICBNdWx0aWxpbmsubXVsdGlsaW5rKCBbXHJcbiAgICAgIHRhcmdldFJhdGlvUHJvcGVydHksXHJcbiAgICAgIHRpY2tNYXJrVmlld1Byb3BlcnR5LFxyXG4gICAgICByYXRpb1R1cGxlUHJvcGVydHksXHJcbiAgICAgIHJhdGlvRml0bmVzc1Byb3BlcnR5LFxyXG4gICAgICBpblByb3BvcnRpb25Qcm9wZXJ0eVxyXG4gICAgXSwgKCB0YXJnZXRSYXRpbywgdGlja01hcmtWaWV3ICkgPT4ge1xyXG5cclxuICAgICAgc3RhdGVPZlNpbU5vZGUuaW5uZXJDb250ZW50ID0gdGhpcy5nZXRTdGF0ZU9mU2ltKCk7XHJcbiAgICAgIGxlZnRIYW5kQnVsbGV0LmlubmVyQ29udGVudCA9IHRoaXMuZ2V0TGVmdEhhbmRTdGF0ZSgpO1xyXG4gICAgICByaWdodEhhbmRCdWxsZXQuaW5uZXJDb250ZW50ID0gdGhpcy5nZXRSaWdodEhhbmRTdGF0ZSgpO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRTdGF0ZU9mU2ltKCk6IHN0cmluZyB7XHJcbiAgICAvLyBUT0RPOiBQYXR0ZXJuU3RyaW5nUHJvcGVydHkgd2hlbiB0aW1lLCBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvcmF0aW8tYW5kLXByb3BvcnRpb24vaXNzdWVzLzQ5OVxyXG4gICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZpbGxJbiggUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy5hMTF5LnNjcmVlblN1bW1hcnlRdWFsaXRhdGl2ZVN0YXRlT2ZTaW1TdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICBjb2xvcjogQmFja2dyb3VuZENvbG9ySGFuZGxlci5nZXRDdXJyZW50Q29sb3JSZWdpb24oIHRoaXMucmF0aW9GaXRuZXNzUHJvcGVydHkudmFsdWUsIHRoaXMuaW5Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgKSxcclxuICAgICAgcmF0aW9GaXRuZXNzOiB0aGlzLnJhdGlvRGVzY3JpYmVyLmdldFJhdGlvRml0bmVzcyggZmFsc2UgKSxcclxuICAgICAgY3VycmVudENoYWxsZW5nZTogdGhpcy5yYXRpb1RvQ2hhbGxlbmdlSW5mb01hcC5nZXQoIHRoaXMudGFyZ2V0UmF0aW9Qcm9wZXJ0eS52YWx1ZSApIS5sb3dlcmNhc2VTdHJpbmdQcm9wZXJ0eSxcclxuICAgICAgZGlzdGFuY2U6IHRoaXMuaGFuZFBvc2l0aW9uc0Rlc2NyaWJlci5nZXREaXN0YW5jZVJlZ2lvbiggdHJ1ZSApXHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldExlZnRIYW5kU3RhdGUoKTogc3RyaW5nIHtcclxuICAgIC8vIFRPRE86IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSB3aGVuIHRpbWUsIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9yYXRpby1hbmQtcHJvcG9ydGlvbi9pc3N1ZXMvNDk5XHJcbiAgICByZXR1cm4gU3RyaW5nVXRpbHMuZmlsbEluKCBSYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzLmExMXkubGVmdEhhbmRCdWxsZXRTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICBwb3NpdGlvbjogdGhpcy5oYW5kUG9zaXRpb25zRGVzY3JpYmVyLmdldEhhbmRQb3NpdGlvbkRlc2NyaXB0aW9uKCB0aGlzLnJhdGlvVHVwbGVQcm9wZXJ0eS52YWx1ZS5hbnRlY2VkZW50LCB0aGlzLnRpY2tNYXJrVmlld1Byb3BlcnR5LnZhbHVlIClcclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0UmlnaHRIYW5kU3RhdGUoKTogc3RyaW5nIHtcclxuICAgIC8vIFRPRE86IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSB3aGVuIHRpbWUsIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9yYXRpby1hbmQtcHJvcG9ydGlvbi9pc3N1ZXMvNDk5XHJcbiAgICByZXR1cm4gU3RyaW5nVXRpbHMuZmlsbEluKCBSYXRpb0FuZFByb3BvcnRpb25TdHJpbmdzLmExMXkucmlnaHRIYW5kQnVsbGV0U3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgcG9zaXRpb246IHRoaXMuaGFuZFBvc2l0aW9uc0Rlc2NyaWJlci5nZXRIYW5kUG9zaXRpb25EZXNjcmlwdGlvbiggdGhpcy5yYXRpb1R1cGxlUHJvcGVydHkudmFsdWUuY29uc2VxdWVudCwgdGhpcy50aWNrTWFya1ZpZXdQcm9wZXJ0eS52YWx1ZSApXHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0RGV0YWlsc0J1dHRvblN0YXRlKCk6IHN0cmluZyB7XHJcbiAgICAvLyBUT0RPOiBQYXR0ZXJuU3RyaW5nUHJvcGVydHkgd2hlbiB0aW1lLCBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvcmF0aW8tYW5kLXByb3BvcnRpb24vaXNzdWVzLzQ5OVxyXG4gICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZpbGxJbiggUmF0aW9BbmRQcm9wb3J0aW9uU3RyaW5ncy5hMTF5LmRldGFpbHNCdXR0b25QYXR0ZXJuU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgc3RhdGVPZlNpbTogdGhpcy5nZXRTdGF0ZU9mU2ltKCksXHJcbiAgICAgIGxlZnRIYW5kOiB0aGlzLmdldExlZnRIYW5kU3RhdGUoKSxcclxuICAgICAgcmlnaHRIYW5kOiB0aGlzLmdldFJpZ2h0SGFuZFN0YXRlKClcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbnJhdGlvQW5kUHJvcG9ydGlvbi5yZWdpc3RlciggJ0Rpc2NvdmVyU2NyZWVuU3VtbWFyeU5vZGUnLCBEaXNjb3ZlclNjcmVlblN1bW1hcnlOb2RlICk7XHJcbmV4cG9ydCBkZWZhdWx0IERpc2NvdmVyU2NyZWVuU3VtbWFyeU5vZGU7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0EsT0FBT0EsV0FBVyxNQUFNLCtDQUErQztBQUN2RSxTQUFTQyxJQUFJLFFBQVEsbUNBQW1DO0FBQ3hELE9BQU9DLGtCQUFrQixNQUFNLDZCQUE2QjtBQUM1RCxPQUFPQyx5QkFBeUIsTUFBTSxvQ0FBb0M7QUFJMUUsT0FBT0Msc0JBQXNCLE1BQU0sNkNBQTZDO0FBSWhGLE9BQU9DLFNBQVMsTUFBTSxrQ0FBa0M7QUFHeEQsTUFBTUMseUJBQXlCLFNBQVNMLElBQUksQ0FBQztFQVVwQ00sV0FBV0EsQ0FBRUMsb0JBQStDLEVBQUVD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