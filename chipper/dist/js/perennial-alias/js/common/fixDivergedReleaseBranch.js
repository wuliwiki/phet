// Copyright 2023, University of Colorado Boulder

/**
 * Does some branch changes so that a releaseBranch's dependency SHA matches a named branch
 *
 * For example, gravity-and-orbits 1.6 has a dependencies.json that says joist is at X. If there is a joist branch
 * named 'gravity-and-orbits-1.6', it SHOULD point at X. If it doesn't, we'll change it to point at X. If we change it,
 * we also want to not have the old SHAs garbage collected, so we create 'gravity-and-orbits-1.6-old' to point to it.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

const execute = require('./execute');
const getBranchDependencies = require('./getBranchDependencies');
const getBranches = require('./getBranches');
const gitCheckout = require('./gitCheckout');
const gitCreateBranch = require('./gitCreateBranch');
const gitPush = require('./gitPush');
const gitRevParse = require('./gitRevParse');
const winston = require('winston');
const buildLocal = require('./buildLocal');
const Octokit = require('@octokit/rest'); // eslint-disable-line require-statement-match

/**
 * Does some branch changes so that a releaseBranch's dependency SHA matches a named branch
 * @public
 *
 * @param {string} repo - The simulation's repository
 * @param {string} branch - The branch name
 * @param {string} commonRepo
 * @returns {Promise}
 */
module.exports = async function (repo, branch, commonRepo) {
  const commonBranch = `${repo}-${branch}`;
  const commonOldBranch = `${commonBranch}-old`;
  const commonRepoBranches = await getBranches(commonRepo);
  if (!commonRepoBranches.includes(commonBranch)) {
    throw new Error(`Branch ${commonBranch} does not exist in ${commonRepo}`);
  }
  if (commonRepoBranches.includes(commonOldBranch)) {
    throw new Error(`Branch ${commonOldBranch} already exists in ${commonRepo}. This happened twice, please manually fix`);
  }
  const dependencies = await getBranchDependencies(repo, branch);
  const sha = dependencies[commonRepo].sha;
  if (!sha) {
    throw new Error('We do not have a working SHA');
  }
  const octokit = new Octokit({
    auth: buildLocal.developerGithubAccessToken
  });
  const canForcePush = (await octokit.request(`GET /repos/phetsims/${commonRepo}/branches/${commonBranch}/protection`, {
    owner: 'phetsims',
    repo: commonRepo,
    branch: commonBranch,
    headers: {
      'X-GitHub-Api-Version': '2022-11-28'
    }
  })).data.allow_force_pushes.enabled;
  const protectionSettings = {
    owner: 'phetsims',
    repo: commonRepo,
    branch: commonBranch,
    required_status_checks: null,
    enforce_admins: null,
    required_pull_request_reviews: null,
    restrictions: null,
    allow_force_pushes: false,
    allow_deletions: false,
    headers: {
      'X-GitHub-Api-Version': '2022-11-28'
    }
  };
  if (!canForcePush) {
    winston.info('Disabling force push prevention');
    protectionSettings.allow_force_pushes = true;
    await octokit.request(`PUT /repos/phetsims/${commonRepo}/branches/${commonBranch}/protection`, protectionSettings);
  }

  // Set up 'old' branch, in order to save history
  await gitCheckout(commonRepo, commonBranch);
  winston.info(`Creating ${commonOldBranch} in ${commonRepo} with ${await gitRevParse(commonRepo, 'HEAD')}`);
  await gitCreateBranch(commonRepo, commonOldBranch);
  await gitPush(commonRepo, commonOldBranch);

  // Fix the branch with the proper name
  await gitCheckout(commonRepo, commonBranch);
  winston.info(`Moving ${commonBranch} in ${commonRepo} to ${sha}`);
  await execute('git', ['reset', '--hard', sha], `../${commonRepo}`);
  await execute('git', ['push', '-f', '-u', 'origin', commonBranch], `../${commonRepo}`);
  if (!canForcePush) {
    winston.info('Enabling force push prevention');
    protectionSettings.allow_force_pushes = false;
    await octokit.request(`PUT /repos/phetsims/${commonRepo}/branches/${commonBranch}/protection`, protectionSettings);
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleGVjdXRlIiwicmVxdWlyZSIsImdldEJyYW5jaERlcGVuZGVuY2llcyIsImdldEJyYW5jaGVzIiwiZ2l0Q2hlY2tvdXQiLCJnaXRDcmVhdGVCcmFuY2giLCJnaXRQdXNoIiwiZ2l0UmV2UGFyc2UiLCJ3aW5zdG9uIiwiYnVpbGRMb2NhbCIsIk9jdG9raXQiLCJtb2R1bGUiLCJleHBvcnRzIiwicmVwbyIsImJyYW5jaCIsImNvbW1vblJlcG8iLCJjb21tb25CcmFuY2giLCJjb21tb25PbGRCcmFuY2giLCJjb21tb25SZXBvQnJhbmNoZXMiLCJpbmNsdWRlcyIsIkVycm9yIiwiZGVwZW5kZW5jaWVzIiwic2hhIiwib2N0b2tpdCIsImF1dGgiLCJkZXZlbG9wZXJHaXRodWJBY2Nlc3NUb2tlbiIsImNhbkZvcmNlUHVzaCIsInJlcXVlc3QiLCJvd25lciIsImhlYWRlcnMiLCJkYXRhIiwiYWxsb3dfZm9yY2VfcHVzaGVzIiwiZW5hYmxlZCIsInByb3RlY3Rpb25TZXR0aW5ncyIsInJlcXVpcmVkX3N0YXR1c19jaGVja3MiLCJlbmZvcmNlX2FkbWlucyIsInJlcXVpcmVkX3B1bGxfcmVxdWVzdF9yZXZpZXdzIiwicmVzdHJpY3Rpb25zIiwiYWxsb3dfZGVsZXRpb25zIiwiaW5mbyJdLCJzb3VyY2VzIjpbImZpeERpdmVyZ2VkUmVsZWFzZUJyYW5jaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogRG9lcyBzb21lIGJyYW5jaCBjaGFuZ2VzIHNvIHRoYXQgYSByZWxlYXNlQnJhbmNoJ3MgZGVwZW5kZW5jeSBTSEEgbWF0Y2hlcyBhIG5hbWVkIGJyYW5jaFxyXG4gKlxyXG4gKiBGb3IgZXhhbXBsZSwgZ3Jhdml0eS1hbmQtb3JiaXRzIDEuNiBoYXMgYSBkZXBlbmRlbmNpZXMuanNvbiB0aGF0IHNheXMgam9pc3QgaXMgYXQgWC4gSWYgdGhlcmUgaXMgYSBqb2lzdCBicmFuY2hcclxuICogbmFtZWQgJ2dyYXZpdHktYW5kLW9yYml0cy0xLjYnLCBpdCBTSE9VTEQgcG9pbnQgYXQgWC4gSWYgaXQgZG9lc24ndCwgd2UnbGwgY2hhbmdlIGl0IHRvIHBvaW50IGF0IFguIElmIHdlIGNoYW5nZSBpdCxcclxuICogd2UgYWxzbyB3YW50IHRvIG5vdCBoYXZlIHRoZSBvbGQgU0hBcyBnYXJiYWdlIGNvbGxlY3RlZCwgc28gd2UgY3JlYXRlICdncmF2aXR5LWFuZC1vcmJpdHMtMS42LW9sZCcgdG8gcG9pbnQgdG8gaXQuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5jb25zdCBleGVjdXRlID0gcmVxdWlyZSggJy4vZXhlY3V0ZScgKTtcclxuY29uc3QgZ2V0QnJhbmNoRGVwZW5kZW5jaWVzID0gcmVxdWlyZSggJy4vZ2V0QnJhbmNoRGVwZW5kZW5jaWVzJyApO1xyXG5jb25zdCBnZXRCcmFuY2hlcyA9IHJlcXVpcmUoICcuL2dldEJyYW5jaGVzJyApO1xyXG5jb25zdCBnaXRDaGVja291dCA9IHJlcXVpcmUoICcuL2dpdENoZWNrb3V0JyApO1xyXG5jb25zdCBnaXRDcmVhdGVCcmFuY2ggPSByZXF1aXJlKCAnLi9naXRDcmVhdGVCcmFuY2gnICk7XHJcbmNvbnN0IGdpdFB1c2ggPSByZXF1aXJlKCAnLi9naXRQdXNoJyApO1xyXG5jb25zdCBnaXRSZXZQYXJzZSA9IHJlcXVpcmUoICcuL2dpdFJldlBhcnNlJyApO1xyXG5jb25zdCB3aW5zdG9uID0gcmVxdWlyZSggJ3dpbnN0b24nICk7XHJcbmNvbnN0IGJ1aWxkTG9jYWwgPSByZXF1aXJlKCAnLi9idWlsZExvY2FsJyApO1xyXG5jb25zdCBPY3Rva2l0ID0gcmVxdWlyZSggJ0BvY3Rva2l0L3Jlc3QnICk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcmVxdWlyZS1zdGF0ZW1lbnQtbWF0Y2hcclxuXHJcbi8qKlxyXG4gKiBEb2VzIHNvbWUgYnJhbmNoIGNoYW5nZXMgc28gdGhhdCBhIHJlbGVhc2VCcmFuY2gncyBkZXBlbmRlbmN5IFNIQSBtYXRjaGVzIGEgbmFtZWQgYnJhbmNoXHJcbiAqIEBwdWJsaWNcclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IHJlcG8gLSBUaGUgc2ltdWxhdGlvbidzIHJlcG9zaXRvcnlcclxuICogQHBhcmFtIHtzdHJpbmd9IGJyYW5jaCAtIFRoZSBicmFuY2ggbmFtZVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tbW9uUmVwb1xyXG4gKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICovXHJcbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgZnVuY3Rpb24oIHJlcG8sIGJyYW5jaCwgY29tbW9uUmVwbyApIHtcclxuXHJcbiAgY29uc3QgY29tbW9uQnJhbmNoID0gYCR7cmVwb30tJHticmFuY2h9YDtcclxuICBjb25zdCBjb21tb25PbGRCcmFuY2ggPSBgJHtjb21tb25CcmFuY2h9LW9sZGA7XHJcblxyXG4gIGNvbnN0IGNvbW1vblJlcG9CcmFuY2hlcyA9IGF3YWl0IGdldEJyYW5jaGVzKCBjb21tb25SZXBvICk7XHJcblxyXG4gIGlmICggIWNvbW1vblJlcG9CcmFuY2hlcy5pbmNsdWRlcyggY29tbW9uQnJhbmNoICkgKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoIGBCcmFuY2ggJHtjb21tb25CcmFuY2h9IGRvZXMgbm90IGV4aXN0IGluICR7Y29tbW9uUmVwb31gICk7XHJcbiAgfVxyXG4gIGlmICggY29tbW9uUmVwb0JyYW5jaGVzLmluY2x1ZGVzKCBjb21tb25PbGRCcmFuY2ggKSApIHtcclxuICAgIHRocm93IG5ldyBFcnJvciggYEJyYW5jaCAke2NvbW1vbk9sZEJyYW5jaH0gYWxyZWFkeSBleGlzdHMgaW4gJHtjb21tb25SZXBvfS4gVGhpcyBoYXBwZW5lZCB0d2ljZSwgcGxlYXNlIG1hbnVhbGx5IGZpeGAgKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGRlcGVuZGVuY2llcyA9IGF3YWl0IGdldEJyYW5jaERlcGVuZGVuY2llcyggcmVwbywgYnJhbmNoICk7XHJcbiAgY29uc3Qgc2hhID0gZGVwZW5kZW5jaWVzWyBjb21tb25SZXBvIF0uc2hhO1xyXG4gIGlmICggIXNoYSApIHtcclxuICAgIHRocm93IG5ldyBFcnJvciggJ1dlIGRvIG5vdCBoYXZlIGEgd29ya2luZyBTSEEnICk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBvY3Rva2l0ID0gbmV3IE9jdG9raXQoIHtcclxuICAgIGF1dGg6IGJ1aWxkTG9jYWwuZGV2ZWxvcGVyR2l0aHViQWNjZXNzVG9rZW5cclxuICB9ICk7XHJcblxyXG4gIGNvbnN0IGNhbkZvcmNlUHVzaCA9ICggYXdhaXQgb2N0b2tpdC5yZXF1ZXN0KCBgR0VUIC9yZXBvcy9waGV0c2ltcy8ke2NvbW1vblJlcG99L2JyYW5jaGVzLyR7Y29tbW9uQnJhbmNofS9wcm90ZWN0aW9uYCwge1xyXG4gICAgb3duZXI6ICdwaGV0c2ltcycsXHJcbiAgICByZXBvOiBjb21tb25SZXBvLFxyXG4gICAgYnJhbmNoOiBjb21tb25CcmFuY2gsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICdYLUdpdEh1Yi1BcGktVmVyc2lvbic6ICcyMDIyLTExLTI4J1xyXG4gICAgfVxyXG4gIH0gKSApLmRhdGEuYWxsb3dfZm9yY2VfcHVzaGVzLmVuYWJsZWQ7XHJcblxyXG4gIGNvbnN0IHByb3RlY3Rpb25TZXR0aW5ncyA9IHtcclxuICAgIG93bmVyOiAncGhldHNpbXMnLFxyXG4gICAgcmVwbzogY29tbW9uUmVwbyxcclxuICAgIGJyYW5jaDogY29tbW9uQnJhbmNoLFxyXG4gICAgcmVxdWlyZWRfc3RhdHVzX2NoZWNrczogbnVsbCxcclxuICAgIGVuZm9yY2VfYWRtaW5zOiBudWxsLFxyXG4gICAgcmVxdWlyZWRfcHVsbF9yZXF1ZXN0X3Jldmlld3M6IG51bGwsXHJcbiAgICByZXN0cmljdGlvbnM6IG51bGwsXHJcbiAgICBhbGxvd19mb3JjZV9wdXNoZXM6IGZhbHNlLFxyXG4gICAgYWxsb3dfZGVsZXRpb25zOiBmYWxzZSxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgJ1gtR2l0SHViLUFwaS1WZXJzaW9uJzogJzIwMjItMTEtMjgnXHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgaWYgKCAhY2FuRm9yY2VQdXNoICkge1xyXG4gICAgd2luc3Rvbi5pbmZvKCAnRGlzYWJsaW5nIGZvcmNlIHB1c2ggcHJldmVudGlvbicgKTtcclxuICAgIHByb3RlY3Rpb25TZXR0aW5ncy5hbGxvd19mb3JjZV9wdXNoZXMgPSB0cnVlO1xyXG4gICAgYXdhaXQgb2N0b2tpdC5yZXF1ZXN0KCBgUFVUIC9yZXBvcy9waGV0c2ltcy8ke2NvbW1vblJlcG99L2JyYW5jaGVzLyR7Y29tbW9uQnJhbmNofS9wcm90ZWN0aW9uYCwgcHJvdGVjdGlvblNldHRpbmdzICk7XHJcbiAgfVxyXG5cclxuICAvLyBTZXQgdXAgJ29sZCcgYnJhbmNoLCBpbiBvcmRlciB0byBzYXZlIGhpc3RvcnlcclxuICBhd2FpdCBnaXRDaGVja291dCggY29tbW9uUmVwbywgY29tbW9uQnJhbmNoICk7XHJcbiAgd2luc3Rvbi5pbmZvKCBgQ3JlYXRpbmcgJHtjb21tb25PbGRCcmFuY2h9IGluICR7Y29tbW9uUmVwb30gd2l0aCAke2F3YWl0IGdpdFJldlBhcnNlKCBjb21tb25SZXBvLCAnSEVBRCcgKX1gICk7XHJcbiAgYXdhaXQgZ2l0Q3JlYXRlQnJhbmNoKCBjb21tb25SZXBvLCBjb21tb25PbGRCcmFuY2ggKTtcclxuICBhd2FpdCBnaXRQdXNoKCBjb21tb25SZXBvLCBjb21tb25PbGRCcmFuY2ggKTtcclxuXHJcbiAgLy8gRml4IHRoZSBicmFuY2ggd2l0aCB0aGUgcHJvcGVyIG5hbWVcclxuICBhd2FpdCBnaXRDaGVja291dCggY29tbW9uUmVwbywgY29tbW9uQnJhbmNoICk7XHJcbiAgd2luc3Rvbi5pbmZvKCBgTW92aW5nICR7Y29tbW9uQnJhbmNofSBpbiAke2NvbW1vblJlcG99IHRvICR7c2hhfWAgKTtcclxuICBhd2FpdCBleGVjdXRlKCAnZ2l0JywgWyAncmVzZXQnLCAnLS1oYXJkJywgc2hhIF0sIGAuLi8ke2NvbW1vblJlcG99YCApO1xyXG4gIGF3YWl0IGV4ZWN1dGUoICdnaXQnLCBbICdwdXNoJywgJy1mJywgJy11JywgJ29yaWdpbicsIGNvbW1vbkJyYW5jaCBdLCBgLi4vJHtjb21tb25SZXBvfWAgKTtcclxuXHJcbiAgaWYgKCAhY2FuRm9yY2VQdXNoICkge1xyXG4gICAgd2luc3Rvbi5pbmZvKCAnRW5hYmxpbmcgZm9yY2UgcHVzaCBwcmV2ZW50aW9uJyApO1xyXG4gICAgcHJvdGVjdGlvblNldHRpbmdzLmFsbG93X2ZvcmNlX3B1c2hlcyA9IGZhbHNlO1xyXG4gICAgYXdhaXQgb2N0b2tpdC5yZXF1ZXN0KCBgUFVUIC9yZXBvcy9waGV0c2ltcy8ke2NvbW1vblJlcG99L2JyYW5jaGVzLyR7Y29tbW9uQnJhbmNofS9wcm90ZWN0aW9uYCwgcHJvdGVjdGlvblNldHRpbmdzICk7XHJcbiAgfVxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBRSxXQUFZLENBQUM7QUFDdEMsTUFBTUMscUJBQXFCLEdBQUdELE9BQU8sQ0FBRSx5QkFBMEIsQ0FBQztBQUNsRSxNQUFNRSxXQUFXLEdBQUdGLE9BQU8sQ0FBRSxlQUFnQixDQUFDO0FBQzlDLE1BQU1HLFdBQVcsR0FBR0gsT0FBTyxDQUFFLGVBQWdCLENBQUM7QUFDOUMsTUFBTUksZUFBZSxHQUFHSixPQUFPLENBQUUsbUJBQW9CLENBQUM7QUFDdEQsTUFBTUssT0FBTyxHQUFHTCxPQUFPLENBQUUsV0FBWSxDQUFDO0FBQ3RDLE1BQU1NLFdBQVcsR0FBR04sT0FBTyxDQUFFLGVBQWdCLENBQUM7QUFDOUMsTUFBTU8sT0FBTyxHQUFHUCxPQUFPLENBQUUsU0FBVSxDQUFDO0FBQ3BDLE1BQU1RLFVBQVUsR0FBR1IsT0FBTyxD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