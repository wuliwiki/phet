// Copyright 2017, University of Colorado Boulder

/**
 * For `grunt create-release`, see Gruntfile for details
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

const SimVersion = require('../common/SimVersion');
const build = require('../common/build');
const copyFile = require('../common/copyFile');
const getBranch = require('../common/getBranch');
const gitAdd = require('../common/gitAdd');
const gitCheckout = require('../common/gitCheckout');
const gitCommit = require('../common/gitCommit');
const gitCreateBranch = require('../common/gitCreateBranch');
const gitIsClean = require('../common/gitIsClean');
const gitPush = require('../common/gitPush');
const hasRemoteBranch = require('../common/hasRemoteBranch');
const npmUpdate = require('../common/npmUpdate');
const setRepoVersion = require('../common/setRepoVersion');
const setRepoSupportedBrands = require('../common/setRepoSupportedBrands');
const updateHTMLVersion = require('../common/updateHTMLVersion');
const assert = require('assert');
const grunt = require('grunt');
const winston = require('winston');

/**
 * For `grunt create-release`, see Gruntfile for details
 * @public
 *
 * @param {string} repo - The repository name
 * @param {string} branch - The branch to create (should be {{MAJOR}}.{{MINOR}})
 * @param {string[]} brands - the supported brands in the release
 * @param {string} [message] - Optional message to append to the brands/version-increment commit.
 * @returns {Promise}
 */
module.exports = async function createRelease(repo, branch, brands, message) {
  const major = Number(branch.split('.')[0]);
  const minor = Number(branch.split('.')[1]);
  assert(major > 0, 'Major version for a branch should be greater than zero');
  assert(minor >= 0, 'Minor version for a branch should be greater than (or equal) to zero');
  assert(Array.isArray(brands), 'supported brands required');
  assert(brands.length >= 1, 'must have a supported brand');
  const currentBranch = await getBranch(repo);
  if (currentBranch !== 'master') {
    grunt.fail.fatal(`Should be on master to create a release branch, not: ${currentBranch ? currentBranch : '(detached head)'}`);
  }
  const hasBranchAlready = await hasRemoteBranch(repo, branch);
  if (hasBranchAlready) {
    grunt.fail.fatal('Branch already exists, aborting');
  }
  const newVersion = new SimVersion(major, minor, 0, {
    testType: 'rc',
    testNumber: 0
  });
  const isClean = await gitIsClean(repo);
  if (!isClean) {
    throw new Error(`Unclean status in ${repo}, cannot create release branch`);
  }
  winston.info('Setting the release branch version to rc.0 so it will auto-increment to rc.1 for the first RC deployment');

  // Create the branch, update the version info
  await gitCreateBranch(repo, branch);
  await setRepoSupportedBrands(repo, brands);
  await setRepoVersion(repo, newVersion, message);
  await gitPush(repo, branch);

  // Update dependencies.json for the release branch
  await npmUpdate(repo);
  await npmUpdate('chipper');
  await npmUpdate('perennial-alias');
  const brand = brands[0];
  await build(repo, {
    brands: [brand]
  });
  await copyFile(`../${repo}/build/${brand}/dependencies.json`, `../${repo}/dependencies.json`);
  await gitAdd(repo, 'dependencies.json');
  await gitCommit(repo, `updated dependencies.json for version ${newVersion.toString()}`);
  await gitPush(repo, branch);

  // Update the version info in master
  await gitCheckout(repo, 'master');
  await setRepoVersion(repo, new SimVersion(major, minor + 1, 0, {
    testType: 'dev',
    testNumber: 0
  }), message);
  await updateHTMLVersion(repo);
  await gitPush(repo, 'master');

  // Go back to the branch (as they may want to do a deploy)
  await gitCheckout(repo, branch);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaW1WZXJzaW9uIiwicmVxdWlyZSIsImJ1aWxkIiwiY29weUZpbGUiLCJnZXRCcmFuY2giLCJnaXRBZGQiLCJnaXRDaGVja291dCIsImdpdENvbW1pdCIsImdpdENyZWF0ZUJyYW5jaCIsImdpdElzQ2xlYW4iLCJnaXRQdXNoIiwiaGFzUmVtb3RlQnJhbmNoIiwibnBtVXBkYXRlIiwic2V0UmVwb1ZlcnNpb24iLCJzZXRSZXBvU3VwcG9ydGVkQnJhbmRzIiwidXBkYXRlSFRNTFZlcnNpb24iLCJhc3NlcnQiLCJncnVudCIsIndpbnN0b24iLCJtb2R1bGUiLCJleHBvcnRzIiwiY3JlYXRlUmVsZWFzZSIsInJlcG8iLCJicmFuY2giLCJicmFuZHMiLCJtZXNzYWdlIiwibWFqb3IiLCJOdW1iZXIiLCJzcGxpdCIsIm1pbm9yIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwiY3VycmVudEJyYW5jaCIsImZhaWwiLCJmYXRhbCIsImhhc0JyYW5jaEFscmVhZHkiLCJuZXdWZXJzaW9uIiwidGVzdFR5cGUiLCJ0ZXN0TnVtYmVyIiwiaXNDbGVhbiIsIkVycm9yIiwiaW5mbyIsImJyYW5kIiwidG9TdHJpbmciXSwic291cmNlcyI6WyJjcmVhdGVSZWxlYXNlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE3LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBGb3IgYGdydW50IGNyZWF0ZS1yZWxlYXNlYCwgc2VlIEdydW50ZmlsZSBmb3IgZGV0YWlsc1xyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuY29uc3QgU2ltVmVyc2lvbiA9IHJlcXVpcmUoICcuLi9jb21tb24vU2ltVmVyc2lvbicgKTtcclxuY29uc3QgYnVpbGQgPSByZXF1aXJlKCAnLi4vY29tbW9uL2J1aWxkJyApO1xyXG5jb25zdCBjb3B5RmlsZSA9IHJlcXVpcmUoICcuLi9jb21tb24vY29weUZpbGUnICk7XHJcbmNvbnN0IGdldEJyYW5jaCA9IHJlcXVpcmUoICcuLi9jb21tb24vZ2V0QnJhbmNoJyApO1xyXG5jb25zdCBnaXRBZGQgPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdEFkZCcgKTtcclxuY29uc3QgZ2l0Q2hlY2tvdXQgPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdENoZWNrb3V0JyApO1xyXG5jb25zdCBnaXRDb21taXQgPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdENvbW1pdCcgKTtcclxuY29uc3QgZ2l0Q3JlYXRlQnJhbmNoID0gcmVxdWlyZSggJy4uL2NvbW1vbi9naXRDcmVhdGVCcmFuY2gnICk7XHJcbmNvbnN0IGdpdElzQ2xlYW4gPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdElzQ2xlYW4nICk7XHJcbmNvbnN0IGdpdFB1c2ggPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdFB1c2gnICk7XHJcbmNvbnN0IGhhc1JlbW90ZUJyYW5jaCA9IHJlcXVpcmUoICcuLi9jb21tb24vaGFzUmVtb3RlQnJhbmNoJyApO1xyXG5jb25zdCBucG1VcGRhdGUgPSByZXF1aXJlKCAnLi4vY29tbW9uL25wbVVwZGF0ZScgKTtcclxuY29uc3Qgc2V0UmVwb1ZlcnNpb24gPSByZXF1aXJlKCAnLi4vY29tbW9uL3NldFJlcG9WZXJzaW9uJyApO1xyXG5jb25zdCBzZXRSZXBvU3VwcG9ydGVkQnJhbmRzID0gcmVxdWlyZSggJy4uL2NvbW1vbi9zZXRSZXBvU3VwcG9ydGVkQnJhbmRzJyApO1xyXG5jb25zdCB1cGRhdGVIVE1MVmVyc2lvbiA9IHJlcXVpcmUoICcuLi9jb21tb24vdXBkYXRlSFRNTFZlcnNpb24nICk7XHJcbmNvbnN0IGFzc2VydCA9IHJlcXVpcmUoICdhc3NlcnQnICk7XHJcbmNvbnN0IGdydW50ID0gcmVxdWlyZSggJ2dydW50JyApO1xyXG5jb25zdCB3aW5zdG9uID0gcmVxdWlyZSggJ3dpbnN0b24nICk7XHJcblxyXG4vKipcclxuICogRm9yIGBncnVudCBjcmVhdGUtcmVsZWFzZWAsIHNlZSBHcnVudGZpbGUgZm9yIGRldGFpbHNcclxuICogQHB1YmxpY1xyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVwbyAtIFRoZSByZXBvc2l0b3J5IG5hbWVcclxuICogQHBhcmFtIHtzdHJpbmd9IGJyYW5jaCAtIFRoZSBicmFuY2ggdG8gY3JlYXRlIChzaG91bGQgYmUge3tNQUpPUn19Lnt7TUlOT1J9fSlcclxuICogQHBhcmFtIHtzdHJpbmdbXX0gYnJhbmRzIC0gdGhlIHN1cHBvcnRlZCBicmFuZHMgaW4gdGhlIHJlbGVhc2VcclxuICogQHBhcmFtIHtzdHJpbmd9IFttZXNzYWdlXSAtIE9wdGlvbmFsIG1lc3NhZ2UgdG8gYXBwZW5kIHRvIHRoZSBicmFuZHMvdmVyc2lvbi1pbmNyZW1lbnQgY29tbWl0LlxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICovXHJcbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgZnVuY3Rpb24gY3JlYXRlUmVsZWFzZSggcmVwbywgYnJhbmNoLCBicmFuZHMsIG1lc3NhZ2UgKSB7XHJcbiAgY29uc3QgbWFqb3IgPSBOdW1iZXIoIGJyYW5jaC5zcGxpdCggJy4nIClbIDAgXSApO1xyXG4gIGNvbnN0IG1pbm9yID0gTnVtYmVyKCBicmFuY2guc3BsaXQoICcuJyApWyAxIF0gKTtcclxuICBhc3NlcnQoIG1ham9yID4gMCwgJ01ham9yIHZlcnNpb24gZm9yIGEgYnJhbmNoIHNob3VsZCBiZSBncmVhdGVyIHRoYW4gemVybycgKTtcclxuICBhc3NlcnQoIG1pbm9yID49IDAsICdNaW5vciB2ZXJzaW9uIGZvciBhIGJyYW5jaCBzaG91bGQgYmUgZ3JlYXRlciB0aGFuIChvciBlcXVhbCkgdG8gemVybycgKTtcclxuXHJcbiAgYXNzZXJ0KCBBcnJheS5pc0FycmF5KCBicmFuZHMgKSwgJ3N1cHBvcnRlZCBicmFuZHMgcmVxdWlyZWQnICk7XHJcbiAgYXNzZXJ0KCBicmFuZHMubGVuZ3RoID49IDEsICdtdXN0IGhhdmUgYSBzdXBwb3J0ZWQgYnJhbmQnICk7XHJcblxyXG4gIGNvbnN0IGN1cnJlbnRCcmFuY2ggPSBhd2FpdCBnZXRCcmFuY2goIHJlcG8gKTtcclxuICBpZiAoIGN1cnJlbnRCcmFuY2ggIT09ICdtYXN0ZXInICkge1xyXG4gICAgZ3J1bnQuZmFpbC5mYXRhbCggYFNob3VsZCBiZSBvbiBtYXN0ZXIgdG8gY3JlYXRlIGEgcmVsZWFzZSBicmFuY2gsIG5vdDogJHtjdXJyZW50QnJhbmNoID8gY3VycmVudEJyYW5jaCA6ICcoZGV0YWNoZWQgaGVhZCknfWAgKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGhhc0JyYW5jaEFscmVhZHkgPSBhd2FpdCBoYXNSZW1vdGVCcmFuY2goIHJlcG8sIGJyYW5jaCApO1xyXG4gIGlmICggaGFzQnJhbmNoQWxyZWFkeSApIHtcclxuICAgIGdydW50LmZhaWwuZmF0YWwoICdCcmFuY2ggYWxyZWFkeSBleGlzdHMsIGFib3J0aW5nJyApO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgbmV3VmVyc2lvbiA9IG5ldyBTaW1WZXJzaW9uKCBtYWpvciwgbWlub3IsIDAsIHtcclxuICAgIHRlc3RUeXBlOiAncmMnLFxyXG4gICAgdGVzdE51bWJlcjogMFxyXG4gIH0gKTtcclxuXHJcbiAgY29uc3QgaXNDbGVhbiA9IGF3YWl0IGdpdElzQ2xlYW4oIHJlcG8gKTtcclxuICBpZiAoICFpc0NsZWFuICkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCBgVW5jbGVhbiBzdGF0dXMgaW4gJHtyZXBvfSwgY2Fubm90IGNyZWF0ZSByZWxlYXNlIGJyYW5jaGAgKTtcclxuICB9XHJcblxyXG4gIHdpbnN0b24uaW5mbyggJ1NldHRpbmcgdGhlIHJlbGVhc2UgYnJhbmNoIHZlcnNpb24gdG8gcmMuMCBzbyBpdCB3aWxsIGF1dG8taW5jcmVtZW50IHRvIHJjLjEgZm9yIHRoZSBmaXJzdCBSQyBkZXBsb3ltZW50JyApO1xyXG5cclxuICAvLyBDcmVhdGUgdGhlIGJyYW5jaCwgdXBkYXRlIHRoZSB2ZXJzaW9uIGluZm9cclxuICBhd2FpdCBnaXRDcmVhdGVCcmFuY2goIHJlcG8sIGJyYW5jaCApO1xyXG4gIGF3YWl0IHNldFJlcG9TdXBwb3J0ZWRCcmFuZHMoIHJlcG8sIGJyYW5kcyApO1xyXG4gIGF3YWl0IHNldFJlcG9WZXJzaW9uKCByZXBvLCBuZXdWZXJzaW9uLCBtZXNzYWdlICk7XHJcbiAgYXdhaXQgZ2l0UHVzaCggcmVwbywgYnJhbmNoICk7XHJcblxyXG4gIC8vIFVwZGF0ZSBkZXBlbmRlbmNpZXMuanNvbiBmb3IgdGhlIHJlbGVhc2UgYnJhbmNoXHJcbiAgYXdhaXQgbnBtVXBkYXRlKCByZXBvICk7XHJcbiAgYXdhaXQgbnBtVXBkYXRlKCAnY2hpcHBlcicgKTtcclxuICBhd2FpdCBucG1VcGRhdGUoICdwZXJlbm5pYWwtYWxpYXMnICk7XHJcblxyXG4gIGNvbnN0IGJyYW5kID0gYnJhbmRzWyAwIF07XHJcbiAgYXdhaXQgYnVpbGQoIHJlcG8sIHtcclxuICAgIGJyYW5kczogWyBicmFuZCBdXHJcbiAgfSApO1xyXG4gIGF3YWl0IGNvcHlGaWxlKCBgLi4vJHtyZXBvfS9idWlsZC8ke2JyYW5kfS9kZXBlbmRlbmNpZXMuanNvbmAsIGAuLi8ke3JlcG99L2RlcGVuZGVuY2llcy5qc29uYCApO1xyXG4gIGF3YWl0IGdpdEFkZCggcmVwbywgJ2RlcGVuZGVuY2llcy5qc29uJyApO1xyXG4gIGF3YWl0IGdpdENvbW1pdCggcmVwbywgYHVwZGF0ZWQgZGVwZW5kZW5jaWVzLmpzb24gZm9yIHZlcnNpb24gJHtuZXdWZXJzaW9uLnRvU3RyaW5nKCl9YCApO1xyXG4gIGF3YWl0IGdpdFB1c2goIHJlcG8sIGJyYW5jaCApO1xyXG5cclxuICAvLyBVcGRhdGUgdGhlIHZlcnNpb24gaW5mbyBpbiBtYXN0ZXJcclxuICBhd2FpdCBnaXRDaGVja291dCggcmVwbywgJ21hc3RlcicgKTtcclxuICBhd2FpdCBzZXRSZXBvVmVyc2lvbiggcmVwbywgbmV3IFNpbVZlcnNpb24oIG1ham9yLCBtaW5vciArIDEsIDAsIHtcclxuICAgIHRlc3RUeXBlOiAnZGV2JyxcclxuICAgIHRlc3ROdW1iZXI6IDBcclxuICB9ICksIG1lc3NhZ2UgKTtcclxuICBhd2FpdCB1cGRhdGVIVE1MVmVyc2lvbiggcmVwbyApO1xyXG4gIGF3YWl0IGdpdFB1c2goIHJlcG8sICdtYXN0ZXInICk7XHJcblxyXG4gIC8vIEdvIGJhY2sgdG8gdGhlIGJyYW5jaCAoYXMgdGhleSBtYXkgd2FudCB0byBkbyBhIGRlcGxveSlcclxuICBhd2FpdCBnaXRDaGVja291dCggcmVwbywgYnJhbmNoICk7XHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNQSxVQUFVLEdBQUdDLE9BQU8sQ0FBRSxzQkFBdUIsQ0FBQztBQUNwRCxNQUFNQyxLQUFLLEdBQUdELE9BQU8sQ0FBRSxpQkFBa0IsQ0FBQztBQUMxQyxNQUFNRSxRQUFRLEdBQUdGLE9BQU8sQ0FBRSxvQkFBcUIsQ0FBQztBQUNoRCxNQUFNRyxTQUFTLEdBQUdILE9BQU8sQ0FBRSxxQkFBc0IsQ0FBQztBQUNsRCxNQUFNSSxNQUFNLEdBQUdKLE9BQU8sQ0FBRSxrQkFBbUIsQ0FBQztBQUM1QyxNQUFNSyxXQUFXLEdBQUdMLE9BQU8sQ0FBRSx1QkFBd0IsQ0FBQztBQUN0RCxNQUFNTSxTQUFTLEdBQUdOLE9BQU8sQ0FBRSxxQkFBc0IsQ0FBQztBQUNsRCxNQUFNTyxlQUFlLEdBQUdQLE9BQU8sQ0FBRSwyQkFBNEIsQ0FBQztBQUM5RCxNQUFNUSxVQUFVLEdBQUdSLE9BQU8sQ0FBRSxzQkFBdUIsQ0FBQztBQUNwRCxNQUFNUyxPQUFPLEdBQUdULE9BQU8sQ0FBRSxtQkFBb0IsQ0FBQztBQUM5QyxNQUFNVSxlQUFlLEdBQUdWLE9BQU8sQ0FBRSwyQkFBNEIsQ0FBQztBQUM5RCxNQUFNVyxTQUFTLEdBQUdYLE9BQU8sQ0FBRSxxQkFBc0IsQ0FBQztBQUNsRCxNQUFNWSxjQUFjLEdBQUdaLE9BQU8sQ0FBRSwwQkFBMkIsQ0FBQztBQUM1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