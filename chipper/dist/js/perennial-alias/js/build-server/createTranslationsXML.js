// Copyright 2017-2018, University of Colorado Boulder

const constants = require('./constants');
const fs = require('graceful-fs'); // eslint-disable-line require-statement-match
const winston = require('winston');
const writeFile = require('../common/writeFile');
const parseScreenNames = require('./parseScreenNames');

/**
 * Create a [sim name].xml file in the live sim directory in htdocs. This file tells the website which
 * translations exist for a given sim. It is used by the "synchronize" method in Project.java in the website code.
 * @param simName
 * @param version
 */
module.exports = async function (simName, version) {
  const rootdir = `../babel/${simName}`;
  const englishStringsFile = `${simName}-strings_en.json`;
  const stringFiles = [{
    name: englishStringsFile,
    locale: constants.ENGLISH_LOCALE
  }];

  // pull all the string filenames and locales from babel and store in stringFiles array
  try {
    const files = fs.readdirSync(rootdir);
    for (let i = 0; i < files.length; i++) {
      const filename = files[i];
      const firstUnderscoreIndex = filename.indexOf('_');
      const periodIndex = filename.indexOf('.');
      const locale = filename.substring(firstUnderscoreIndex + 1, periodIndex);
      // Don't process English twice!
      if (locale !== constants.ENGLISH_LOCALE) {
        stringFiles.push({
          name: filename,
          locale: locale
        });
      }
    }
  } catch (e) {
    winston.log('warn', 'no directory for the given sim exists in babel');
  }

  // try opening the english strings file so we can read the english strings
  let englishStrings;
  try {
    englishStrings = JSON.parse(fs.readFileSync(`../${simName}/${englishStringsFile}`, {
      encoding: 'utf-8'
    }));
  } catch (e) {
    throw new Error('English strings file not found');
  }
  const simTitleKey = `${simName}.title`; // all sims must have a key of this form
  if (!englishStrings[simTitleKey]) {
    throw new Error('No key for sim title');
  }

  // create xml, making a simulation tag for each language
  let finalXML = `<?xml version="1.0" encoding="utf-8" ?>\n<project name="${simName}">\n<simulations>`;
  const screenNames = await parseScreenNames.parseScreenNames(simName, stringFiles.map(f => f.locale));
  for (let j = 0; j < stringFiles.length; j++) {
    const stringFile = stringFiles[j];
    const languageJSON = stringFile.locale === constants.ENGLISH_LOCALE ? englishStrings : JSON.parse(fs.readFileSync(`../babel/${simName}/${stringFile.name}`, {
      encoding: 'utf-8'
    }));
    const simHTML = `${constants.HTML_SIMS_DIRECTORY + simName}/${version}/${simName}_${stringFile.locale}.html`;
    if (fs.existsSync(simHTML)) {
      const localizedSimTitle = languageJSON[simTitleKey] ? languageJSON[simTitleKey].value : englishStrings[simTitleKey].value;
      finalXML = finalXML.concat(`<simulation name="${simName}" locale="${stringFile.locale}">\n` + `<title><![CDATA[${localizedSimTitle}]]></title>\n`);
      if (screenNames && screenNames[stringFile.locale]) {
        finalXML = finalXML.concat('<screens>\n');
        screenNames[stringFile.locale].forEach((screenName, index) => {
          finalXML = finalXML.concat(`<screenName position="${index + 1}"><![CDATA[${screenName}]]></screenName>\n`);
        });
        finalXML = finalXML.concat('</screens>\n');
      }
      finalXML = finalXML.concat('</simulation>\n');
    }
  }
  finalXML = finalXML.concat('</simulations>\n</project>');
  const xmlFilepath = `${constants.HTML_SIMS_DIRECTORY + simName}/${version}/${simName}.xml`;
  try {
    await writeFile(xmlFilepath, finalXML);
  } catch (err) {
    console.error('Error writing xml file', err);
    throw err;
  }
  winston.log('info', 'wrote XML file');
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb25zdGFudHMiLCJyZXF1aXJlIiwiZnMiLCJ3aW5zdG9uIiwid3JpdGVGaWxlIiwicGFyc2VTY3JlZW5OYW1lcyIsIm1vZHVsZSIsImV4cG9ydHMiLCJzaW1OYW1lIiwidmVyc2lvbiIsInJvb3RkaXIiLCJlbmdsaXNoU3RyaW5nc0ZpbGUiLCJzdHJpbmdGaWxlcyIsIm5hbWUiLCJsb2NhbGUiLCJFTkdMSVNIX0xPQ0FMRSIsImZpbGVzIiwicmVhZGRpclN5bmMiLCJpIiwibGVuZ3RoIiwiZmlsZW5hbWUiLCJmaXJzdFVuZGVyc2NvcmVJbmRleCIsImluZGV4T2YiLCJwZXJpb2RJbmRleCIsInN1YnN0cmluZyIsInB1c2giLCJlIiwibG9nIiwiZW5nbGlzaFN0cmluZ3MiLCJKU09OIiwicGFyc2UiLCJyZWFkRmlsZVN5bmMiLCJlbmNvZGluZyIsIkVycm9yIiwic2ltVGl0bGVLZXkiLCJmaW5hbFhNTCIsInNjcmVlbk5hbWVzIiwibWFwIiwiZiIsImoiLCJzdHJpbmdGaWxlIiwibGFuZ3VhZ2VKU09OIiwic2ltSFRNTCIsIkhUTUxfU0lNU19ESVJFQ1RPUlkiLCJleGlzdHNTeW5jIiwibG9jYWxpemVkU2ltVGl0bGUiLCJ2YWx1ZSIsImNvbmNhdCIsImZvckVhY2giLCJzY3JlZW5OYW1lIiwiaW5kZXgiLCJ4bWxGaWxlcGF0aCIsImVyciIsImNvbnNvbGUiLCJlcnJvciJdLCJzb3VyY2VzIjpbImNyZWF0ZVRyYW5zbGF0aW9uc1hNTC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNy0yMDE4LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcblxyXG5jb25zdCBjb25zdGFudHMgPSByZXF1aXJlKCAnLi9jb25zdGFudHMnICk7XHJcbmNvbnN0IGZzID0gcmVxdWlyZSggJ2dyYWNlZnVsLWZzJyApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHJlcXVpcmUtc3RhdGVtZW50LW1hdGNoXHJcbmNvbnN0IHdpbnN0b24gPSByZXF1aXJlKCAnd2luc3RvbicgKTtcclxuY29uc3Qgd3JpdGVGaWxlID0gcmVxdWlyZSggJy4uL2NvbW1vbi93cml0ZUZpbGUnICk7XHJcbmNvbnN0IHBhcnNlU2NyZWVuTmFtZXMgPSByZXF1aXJlKCAnLi9wYXJzZVNjcmVlbk5hbWVzJyApO1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhIFtzaW0gbmFtZV0ueG1sIGZpbGUgaW4gdGhlIGxpdmUgc2ltIGRpcmVjdG9yeSBpbiBodGRvY3MuIFRoaXMgZmlsZSB0ZWxscyB0aGUgd2Vic2l0ZSB3aGljaFxyXG4gKiB0cmFuc2xhdGlvbnMgZXhpc3QgZm9yIGEgZ2l2ZW4gc2ltLiBJdCBpcyB1c2VkIGJ5IHRoZSBcInN5bmNocm9uaXplXCIgbWV0aG9kIGluIFByb2plY3QuamF2YSBpbiB0aGUgd2Vic2l0ZSBjb2RlLlxyXG4gKiBAcGFyYW0gc2ltTmFtZVxyXG4gKiBAcGFyYW0gdmVyc2lvblxyXG4gKi9cclxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyBmdW5jdGlvbiggc2ltTmFtZSwgdmVyc2lvbiApIHtcclxuICBjb25zdCByb290ZGlyID0gYC4uL2JhYmVsLyR7c2ltTmFtZX1gO1xyXG4gIGNvbnN0IGVuZ2xpc2hTdHJpbmdzRmlsZSA9IGAke3NpbU5hbWV9LXN0cmluZ3NfZW4uanNvbmA7XHJcbiAgY29uc3Qgc3RyaW5nRmlsZXMgPSBbIHsgbmFtZTogZW5nbGlzaFN0cmluZ3NGaWxlLCBsb2NhbGU6IGNvbnN0YW50cy5FTkdMSVNIX0xPQ0FMRSB9IF07XHJcblxyXG4gIC8vIHB1bGwgYWxsIHRoZSBzdHJpbmcgZmlsZW5hbWVzIGFuZCBsb2NhbGVzIGZyb20gYmFiZWwgYW5kIHN0b3JlIGluIHN0cmluZ0ZpbGVzIGFycmF5XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMoIHJvb3RkaXIgKTtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBjb25zdCBmaWxlbmFtZSA9IGZpbGVzWyBpIF07XHJcbiAgICAgIGNvbnN0IGZpcnN0VW5kZXJzY29yZUluZGV4ID0gZmlsZW5hbWUuaW5kZXhPZiggJ18nICk7XHJcbiAgICAgIGNvbnN0IHBlcmlvZEluZGV4ID0gZmlsZW5hbWUuaW5kZXhPZiggJy4nICk7XHJcbiAgICAgIGNvbnN0IGxvY2FsZSA9IGZpbGVuYW1lLnN1YnN0cmluZyggZmlyc3RVbmRlcnNjb3JlSW5kZXggKyAxLCBwZXJpb2RJbmRleCApO1xyXG4gICAgICAvLyBEb24ndCBwcm9jZXNzIEVuZ2xpc2ggdHdpY2UhXHJcbiAgICAgIGlmICggbG9jYWxlICE9PSBjb25zdGFudHMuRU5HTElTSF9MT0NBTEUgKSB7XHJcbiAgICAgICAgc3RyaW5nRmlsZXMucHVzaCggeyBuYW1lOiBmaWxlbmFtZSwgbG9jYWxlOiBsb2NhbGUgfSApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNhdGNoKCBlICkge1xyXG4gICAgd2luc3Rvbi5sb2coICd3YXJuJywgJ25vIGRpcmVjdG9yeSBmb3IgdGhlIGdpdmVuIHNpbSBleGlzdHMgaW4gYmFiZWwnICk7XHJcbiAgfVxyXG5cclxuICAvLyB0cnkgb3BlbmluZyB0aGUgZW5nbGlzaCBzdHJpbmdzIGZpbGUgc28gd2UgY2FuIHJlYWQgdGhlIGVuZ2xpc2ggc3RyaW5nc1xyXG4gIGxldCBlbmdsaXNoU3RyaW5ncztcclxuICB0cnkge1xyXG4gICAgZW5nbGlzaFN0cmluZ3MgPSBKU09OLnBhcnNlKCBmcy5yZWFkRmlsZVN5bmMoIGAuLi8ke3NpbU5hbWV9LyR7ZW5nbGlzaFN0cmluZ3NGaWxlfWAsIHsgZW5jb2Rpbmc6ICd1dGYtOCcgfSApICk7XHJcbiAgfVxyXG4gIGNhdGNoKCBlICkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCAnRW5nbGlzaCBzdHJpbmdzIGZpbGUgbm90IGZvdW5kJyApO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2ltVGl0bGVLZXkgPSBgJHtzaW1OYW1lfS50aXRsZWA7IC8vIGFsbCBzaW1zIG11c3QgaGF2ZSBhIGtleSBvZiB0aGlzIGZvcm1cclxuICBpZiAoICFlbmdsaXNoU3RyaW5nc1sgc2ltVGl0bGVLZXkgXSApIHtcclxuICAgIHRocm93IG5ldyBFcnJvciggJ05vIGtleSBmb3Igc2ltIHRpdGxlJyApO1xyXG4gIH1cclxuXHJcbiAgLy8gY3JlYXRlIHhtbCwgbWFraW5nIGEgc2ltdWxhdGlvbiB0YWcgZm9yIGVhY2ggbGFuZ3VhZ2VcclxuICBsZXQgZmluYWxYTUwgPSBgPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwidXRmLThcIiA/Plxcbjxwcm9qZWN0IG5hbWU9XCIke3NpbU5hbWV9XCI+XFxuPHNpbXVsYXRpb25zPmA7XHJcblxyXG4gIGNvbnN0IHNjcmVlbk5hbWVzID0gYXdhaXQgcGFyc2VTY3JlZW5OYW1lcy5wYXJzZVNjcmVlbk5hbWVzKCBzaW1OYW1lLCBzdHJpbmdGaWxlcy5tYXAoIGYgPT4gZi5sb2NhbGUgKSApO1xyXG5cclxuICBmb3IgKCBsZXQgaiA9IDA7IGogPCBzdHJpbmdGaWxlcy5sZW5ndGg7IGorKyApIHtcclxuICAgIGNvbnN0IHN0cmluZ0ZpbGUgPSBzdHJpbmdGaWxlc1sgaiBdO1xyXG4gICAgY29uc3QgbGFuZ3VhZ2VKU09OID0gKCBzdHJpbmdGaWxlLmxvY2FsZSA9PT0gY29uc3RhbnRzLkVOR0xJU0hfTE9DQUxFICkgPyBlbmdsaXNoU3RyaW5ncyA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKCBmcy5yZWFkRmlsZVN5bmMoIGAuLi9iYWJlbC8ke3NpbU5hbWV9LyR7c3RyaW5nRmlsZS5uYW1lfWAsIHsgZW5jb2Rpbmc6ICd1dGYtOCcgfSApICk7XHJcblxyXG4gICAgY29uc3Qgc2ltSFRNTCA9IGAke2NvbnN0YW50cy5IVE1MX1NJTVNfRElSRUNUT1JZICsgc2ltTmFtZX0vJHt2ZXJzaW9ufS8ke3NpbU5hbWV9XyR7c3RyaW5nRmlsZS5sb2NhbGV9Lmh0bWxgO1xyXG5cclxuICAgIGlmICggZnMuZXhpc3RzU3luYyggc2ltSFRNTCApICkge1xyXG4gICAgICBjb25zdCBsb2NhbGl6ZWRTaW1UaXRsZSA9ICggbGFuZ3VhZ2VKU09OWyBzaW1UaXRsZUtleSBdICkgPyBsYW5ndWFnZUpTT05bIHNpbVRpdGxlS2V5IF0udmFsdWUgOiBlbmdsaXNoU3RyaW5nc1sgc2ltVGl0bGVLZXkgXS52YWx1ZTtcclxuICAgICAgZmluYWxYTUwgPSBmaW5hbFhNTC5jb25jYXQoIGA8c2ltdWxhdGlvbiBuYW1lPVwiJHtzaW1OYW1lfVwiIGxvY2FsZT1cIiR7c3RyaW5nRmlsZS5sb2NhbGV9XCI+XFxuYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPHRpdGxlPjwhW0NEQVRBWyR7bG9jYWxpemVkU2ltVGl0bGV9XV0+PC90aXRsZT5cXG5gICk7XHJcbiAgICAgIGlmICggc2NyZWVuTmFtZXMgJiYgc2NyZWVuTmFtZXNbIHN0cmluZ0ZpbGUubG9jYWxlIF0gKSB7XHJcbiAgICAgICAgZmluYWxYTUwgPSBmaW5hbFhNTC5jb25jYXQoICc8c2NyZWVucz5cXG4nICk7XHJcbiAgICAgICAgc2NyZWVuTmFtZXNbIHN0cmluZ0ZpbGUubG9jYWxlIF0uZm9yRWFjaCggKCBzY3JlZW5OYW1lLCBpbmRleCApID0+IHtcclxuICAgICAgICAgIGZpbmFsWE1MID0gZmluYWxYTUwuY29uY2F0KCBgPHNjcmVlbk5hbWUgcG9zaXRpb249XCIke2luZGV4ICsgMX1cIj48IVtDREFUQVske3NjcmVlbk5hbWV9XV0+PC9zY3JlZW5OYW1lPlxcbmAgKTtcclxuICAgICAgICB9ICk7XHJcbiAgICAgICAgZmluYWxYTUwgPSBmaW5hbFhNTC5jb25jYXQoICc8L3NjcmVlbnM+XFxuJyApO1xyXG4gICAgICB9XHJcbiAgICAgIGZpbmFsWE1MID0gZmluYWxYTUwuY29uY2F0KCAnPC9zaW11bGF0aW9uPlxcbicgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZpbmFsWE1MID0gZmluYWxYTUwuY29uY2F0KCAnPC9zaW11bGF0aW9ucz5cXG48L3Byb2plY3Q+JyApO1xyXG5cclxuICBjb25zdCB4bWxGaWxlcGF0aCA9IGAke2NvbnN0YW50cy5IVE1MX1NJTVNfRElSRUNUT1JZICsgc2ltTmFtZX0vJHt2ZXJzaW9ufS8ke3NpbU5hbWV9LnhtbGA7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IHdyaXRlRmlsZSggeG1sRmlsZXBhdGgsIGZpbmFsWE1MICk7XHJcbiAgfVxyXG4gIGNhdGNoKCBlcnIgKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCAnRXJyb3Igd3JpdGluZyB4bWwgZmlsZScsIGVyciApO1xyXG4gICAgdGhyb3cgZXJyO1xyXG4gIH1cclxuICB3aW5zdG9uLmxvZyggJ2luZm8nLCAnd3JvdGUgWE1MIGZpbGUnICk7XHJcbn07Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFHQSxNQUFNQSxTQUFTLEdBQUdDLE9BQU8sQ0FBRSxhQUFjLENBQUM7QUFDMUMsTUFBTUMsRUFBRSxHQUFHRCxPQUFPLENBQUUsYUFBYyxDQUFDLENBQUMsQ0FBQztBQUNyQyxNQUFNRSxPQUFPLEdBQUdGLE9BQU8sQ0FBRSxTQUFVLENBQUM7QUFDcEMsTUFBTUcsU0FBUyxHQUFHSCxPQUFPLENBQUUscUJBQXNCLENBQUM7QUFDbEQsTUFBTUksZ0JBQWdCLEdBQUdKLE9BQU8sQ0FBRSxvQkFBcUIsQ0FBQzs7QUFFeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0FLLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHLGdCQUFnQkMsT0FBTyxFQUFFQyxPQUFPLEVBQUc7RUFDbEQsTUFBTUMsT0FBTyxHQUFJLFlBQVdGLE9BQVEsRUFBQztFQUNyQyxNQUFNRyxrQkFBa0IsR0FBSSxHQUFFSCxPQUFRLGtCQUFpQjtFQUN2RCxNQUFNSSxXQUFXLEdBQUcsQ0FBRTtJQUFFQyxJQUFJLEVBQUVGLGtCQUFrQjtJQUFFRyxNQUFNLEVBQUVkLFNBQVMsQ0FBQ2U7RUFBZSxDQUFDLENBQUU7O0VBRXRGO0VBQ0EsSUFBSTtJQUNGLE1BQU1DLEtBQUss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