// Copyright 2017-2023, University of Colorado Boulder

/**
 * Collection of utility constants and functions for managing keyboard input. Constants are values of Event.code, as
 * well as helper functions and collections.
 *
 * @author Jesse Greenberg
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

import validate from '../../../axon/js/validate.js';
import { scenery } from '../imports.js';
const KEY_RIGHT_ARROW = 'ArrowRight';
const KEY_LEFT_ARROW = 'ArrowLeft';
const KEY_UP_ARROW = 'ArrowUp';
const KEY_DOWN_ARROW = 'ArrowDown';
const KEY_SHIFT_RIGHT = 'ShiftRight';
const KEY_SHIFT_LEFT = 'ShiftLeft';
const KEY_CONTROL_LEFT = 'ControlLeft';
const KEY_CONTROL_RIGHT = 'ControlRight';
const KEY_ALT_LEFT = 'AltLeft';
const KEY_ALT_RIGHT = 'AltRight';
const KEY_W = 'KeyW';
const KEY_A = 'KeyA';
const KEY_S = 'KeyS';
const KEY_D = 'KeyD';
const KEY_0 = 'Digit0';
const KEY_1 = 'Digit1';
const KEY_2 = 'Digit2';
const KEY_3 = 'Digit3';
const KEY_4 = 'Digit4';
const KEY_5 = 'Digit5';
const KEY_6 = 'Digit6';
const KEY_7 = 'Digit7';
const KEY_8 = 'Digit8';
const KEY_9 = 'Digit9';

// These are `KeyboardEvent.key` values! The difference is necessary because KeyboardEvent.code distinguishes between
// left and right, but we often need to watch for both at the same time.
const KEY_ALT = 'Alt';
const KEY_SHIFT = 'Shift';
const KEY_CONTROL = 'Control';
const ARROW_KEYS = [KEY_RIGHT_ARROW, KEY_LEFT_ARROW, KEY_UP_ARROW, KEY_DOWN_ARROW];
const WASD_KEYS = [KEY_W, KEY_S, KEY_A, KEY_D];
const NUMBER_KEYS = [KEY_0, KEY_1, KEY_2, KEY_3, KEY_4, KEY_5, KEY_6, KEY_7, KEY_8, KEY_9];
const SHIFT_KEYS = [KEY_SHIFT_LEFT, KEY_SHIFT_RIGHT];
const CONTROL_KEYS = [KEY_CONTROL_LEFT, KEY_CONTROL_RIGHT];
const ALT_KEYS = [KEY_ALT_LEFT, KEY_ALT_RIGHT];

// These are KeyboardEvent.key values, excluding left/right KeyboardEvent.codes
const MODIFIER_KEYS = [KEY_ALT, KEY_CONTROL, KEY_SHIFT];
const DOM_EVENT_VALIDATOR = {
  valueType: Event
};
const ALL_KEY_CODES = [];

/**
 * @extends {Object}
 * @type {{KEY_A: string, KEY_C: string, KEY_DOWN_ARROW: string, KEY_DELETE: string, KEY_B: string, KEY_E: string, KEY_D: string, KEY_G: string, KEY_F: string, KEY_I: string, KEY_H: string, KEY_K: string, KEY_RIGHT_ARROW: string, KEY_J: string, isArrowKey(Event): boolean, KEY_M: string, KEY_L: string, KEY_O: string, KEY_N: string, KEY_Q: string, KEY_P: string, KEY_S: string, KEY_BACKSPACE: string, KEY_R: string, KEY_U: string, KEY_MINUS: string, KEY_T: string, isMovementKey(Event): boolean, KEY_W: string, KEY_V: string, CONTROL_KEYS: (string)[], KEY_Y: string, KEY_X: string, getNumberFromCode(Event): (number|null), isAltKey(KeyboardEvent): *, KEY_Z: string, ARROW_KEYS: (string)[], KEY_SHIFT_LEFT: string, KEY_HOME: string, KEY_ESCAPE: string, isShiftKey(KeyboardEvent): *, KEY_ALT_LEFT: string, KEY_LEFT_ARROW: string, KEY_TAB: string, isAnyKeyEvent(x:Event, y:Array<string>): boolean, getEventCode(Event): (string|null), KEY_EQUALS: string, KEY_PAGE_UP: string, KEY_ALT_RIGHT: string, isWASDKey(Event): boolean, ALT_KEYS: (string)[], KEY_PAGE_DOWN: string, isNumberKey(Event): boolean, SHIFT_KEYS: (string)[], KEY_PLUS: string, WASD_KEYS: (string)[], isControlKey(KeyboardEvent): *, KEY_SHIFT_RIGHT: string, isRangeKey(Event): boolean, KEY_CONTROL_RIGHT: string, KEY_ENTER: string, isKeyEvent(Event, string): boolean, KEY_UP_ARROW: string, KEY_1: string, KEY_0: string, KEY_CONTROL_LEFT: string, KEY_3: string, KEY_2: string, KEY_5: string, KEY_4: string, KEY_7: string, KEY_6: string, KEY_9: string, MOVEMENT_KEYS: (string)[], KEY_8: string, KEY_SPACE: string, KEY_END: string}}
 */
const KeyboardUtils = {
  KEY_SPACE: 'Space',
  KEY_ENTER: 'Enter',
  KEY_TAB: 'Tab',
  KEY_RIGHT_ARROW: KEY_RIGHT_ARROW,
  KEY_LEFT_ARROW: KEY_LEFT_ARROW,
  KEY_UP_ARROW: KEY_UP_ARROW,
  KEY_DOWN_ARROW: KEY_DOWN_ARROW,
  KEY_SHIFT_LEFT: KEY_SHIFT_LEFT,
  KEY_SHIFT_RIGHT: KEY_SHIFT_RIGHT,
  KEY_ALT_LEFT: KEY_ALT_LEFT,
  KEY_ALT_RIGHT: KEY_ALT_RIGHT,
  KEY_CONTROL_LEFT: KEY_CONTROL_LEFT,
  KEY_CONTROL_RIGHT: KEY_CONTROL_RIGHT,
  KEY_SHIFT: KEY_SHIFT,
  KEY_ALT: KEY_ALT,
  KEY_CONTROL: KEY_CONTROL,
  KEY_ESCAPE: 'Escape',
  KEY_DELETE: 'Delete',
  KEY_BACKSPACE: 'Backspace',
  KEY_PAGE_UP: 'PageUp',
  KEY_PAGE_DOWN: 'PageDown',
  KEY_END: 'End',
  KEY_HOME: 'Home',
  KEY_0: KEY_0,
  KEY_1: KEY_1,
  KEY_2: KEY_2,
  KEY_3: KEY_3,
  KEY_4: KEY_4,
  KEY_5: KEY_5,
  KEY_6: KEY_6,
  KEY_7: KEY_7,
  KEY_8: KEY_8,
  KEY_9: KEY_9,
  KEY_NUMPAD_0: 'Numpad0',
  KEY_NUMPAD_1: 'Numpad1',
  KEY_NUMPAD_2: 'Numpad2',
  KEY_NUMPAD_3: 'Numpad3',
  KEY_NUMPAD_4: 'Numpad4',
  KEY_NUMPAD_5: 'Numpad5',
  KEY_NUMPAD_6: 'Numpad6',
  KEY_NUMPAD_7: 'Numpad7',
  KEY_NUMPAD_8: 'Numpad8',
  KEY_NUMPAD_9: 'Numpad9',
  KEY_NUMPAD_DECIMAL: 'NumpadDecimal',
  KEY_NUMPAD_PLUS: 'NumpadAdd',
  KEY_NUMPAD_MINUS: 'NumpadSubtract',
  KEY_A: 'KeyA',
  KEY_B: 'KeyB',
  KEY_C: 'KeyC',
  KEY_D: 'KeyD',
  KEY_E: 'KeyE',
  KEY_F: 'KeyF',
  KEY_G: 'KeyG',
  KEY_H: 'KeyH',
  KEY_I: 'KeyI',
  KEY_J: 'KeyJ',
  KEY_K: 'KeyK',
  KEY_L: 'KeyL',
  KEY_M: 'KeyM',
  KEY_N: 'KeyN',
  KEY_O: 'KeyO',
  KEY_P: 'KeyP',
  KEY_Q: 'KeyQ',
  KEY_R: 'KeyR',
  KEY_S: 'KeyS',
  KEY_T: 'KeyT',
  KEY_U: 'KeyU',
  KEY_V: 'KeyV',
  KEY_W: 'KeyW',
  KEY_X: 'KeyX',
  KEY_Y: 'KeyY',
  KEY_Z: 'KeyZ',
  // "Equals" and "Plus" share the same event.code, check for distinction with shift modifier key
  KEY_EQUALS: 'Equal',
  KEY_PLUS: 'Equal',
  KEY_MINUS: 'Minus',
  KEY_PERIOD: 'Period',
  ARROW_KEYS: ARROW_KEYS,
  WASD_KEYS: WASD_KEYS,
  MOVEMENT_KEYS: ARROW_KEYS.concat(WASD_KEYS),
  SHIFT_KEYS: SHIFT_KEYS,
  CONTROL_KEYS: CONTROL_KEYS,
  ALT_KEYS: ALT_KEYS,
  // Maps a KeyboardEvent.key to the left/right pair of KeyboardEvent.code for modifier keys
  MODIFIER_KEY_TO_CODE_MAP: new Map([[KEY_ALT, ALT_KEYS], [KEY_SHIFT, SHIFT_KEYS], [KEY_CONTROL, CONTROL_KEYS]]),
  /**
   * Returns whether the key corresponds to pressing an arrow key
   */
  isArrowKey(domEvent) {
    return KeyboardUtils.isAnyKeyEvent(domEvent, ARROW_KEYS);
  },
  /**
   * Returns true if key is one of keys used for range inputs
   */
  isRangeKey(domEvent) {
    return KeyboardUtils.isArrowKey(domEvent) || KeyboardUtils.isAnyKeyEvent(domEvent, [KeyboardUtils.KEY_PAGE_UP, KeyboardUtils.KEY_PAGE_DOWN, KeyboardUtils.KEY_HOME, KeyboardUtils.KEY_END]);
  },
  /**
   * Returns whether or not the key corresponds to pressing a number key
   */
  isNumberKey(domEvent) {
    return KeyboardUtils.isAnyKeyEvent(domEvent, NUMBER_KEYS);
  },
  /**
   * For number keys, return the number of the key, or null if not a number
   */
  getNumberFromCode(domEvent) {
    if (KeyboardUtils.isNumberKey(domEvent) && domEvent instanceof KeyboardEvent) {
      return Number(domEvent.code.replace('Digit', ''));
    }
    return null;
  },
  /**
   * Event.code distinguishes between left and right shift keys. If all you care about is the presence
   * of a shift key you can use this.
   */
  isShiftKey(domEvent) {
    return KeyboardUtils.isAnyKeyEvent(domEvent, SHIFT_KEYS);
  },
  /**
   * Event.code distinguishes between left and right alt keys. If all you care about is the presence
   * of the alt key you can use this.
   */
  isAltKey(domEvent) {
    return KeyboardUtils.isAnyKeyEvent(domEvent, ALT_KEYS);
  },
  /**
   * Event.code distinguishes between left and right control keys. If all you care about is the presence
   * of a control key you can use this.
   */
  isControlKey(domEvent) {
    return KeyboardUtils.isAnyKeyEvent(domEvent, CONTROL_KEYS);
  },
  /**
   * Returns whether or not the key corresponds to one of the WASD movement keys.
   */
  isWASDKey(domEvent) {
    return KeyboardUtils.isAnyKeyEvent(domEvent, WASD_KEYS);
  },
  /**
   * Returns true if the key indicates a 'movement' key in keyboard dragging
   */
  isMovementKey(domEvent) {
    return KeyboardUtils.isAnyKeyEvent(domEvent, KeyboardUtils.MOVEMENT_KEYS);
  },
  /**
   * If the domEvent corresponds to any of the provided keys in the list.
   */
  isAnyKeyEvent(domEvent, keyboardUtilsKeys) {
    validate(domEvent, DOM_EVENT_VALIDATOR);
    const code = KeyboardUtils.getEventCode(domEvent);
    return code ? keyboardUtilsKeys.includes(code) : false;
  },
  /**
   * Whether the event was of the provided KeyboardUtils string.
   */
  isKeyEvent(domEvent, keyboardUtilsKey) {
    return KeyboardUtils.getEventCode(domEvent) === keyboardUtilsKey;
  },
  /**
   * Returns a string with the event.code that can be used to determine the keyboard keys of a KeyboardEvent object.
   * Otherwise, returns null if there is no code on the event. An example usage might look like
   *
   *  const key = KeyboardUtils.getEventCode( domEvent );
   *  if ( key === KeyboardUtils.KEY_A ) {
   *    // You pressed the A key!
   *  }
   *
   * @returns - null if there is no `code` property on the provided Event.
   */
  getEventCode(domEvent) {
    let eventCode = null;
    if (domEvent instanceof KeyboardEvent && domEvent.code) {
      eventCode = domEvent.code;

      // For Numpad keys, the DomEvent.code does not match the equivalent "normal" keyboard key, but the DomEvent.key
      // will match the code of the "normal" key. In those cases (home/page up/page down/end) use the key as the code.
      if (eventCode.startsWith('Numpad') && ALL_KEY_CODES.includes(domEvent.key)) {
        eventCode = domEvent.key;
      }
    }
    return eventCode;
  },
  /**
   * Returns true when if the provided string is a KeyboardEvent.key for a modifier key. Note that is KeyboardEvent.key
   * **NOT** KeyboardEvent.code. KeyboardEvent.code does not distinguish between left and right modifier keys so we
   * have some special behavior when we detect a modifier key (left or right) is pressed.
   * @param key
   */
  isModifierKey(key) {
    return MODIFIER_KEYS.includes(key);
  },
  /**
   * Returns true if the provided KeyboardEvent.code/KeyboardEvent.key is equivalent to the provided KeyboardEvent.code.
   * Specifically comparing modifier keys. If both are `code`, returns true when they are equal. If first value is
   * a `key` for alt/control/shift modifier key, then it returns true when the code is one of the matching
   * left/right `codes` for that `key`. For example
   *
   * `keyOrCode` = 'Shift', `code` = 'ShiftLeft -> true
   * `keyOrCode = 'Alt', `code` = 'AltRight' -> true
   * `keyOrCode = 'Control`, `code` = 'KeyR' -> false
   *
   * @param keyOrCode - KeyboardEvent.key OR KeyboardEvent.code
   * @param code - KeyboardEvent.code
   */
  areKeysEquivalent(keyOrCode, code) {
    const equivalentModifierKeys = KeyboardUtils.MODIFIER_KEY_TO_CODE_MAP.get(keyOrCode);
    if (equivalentModifierKeys) {
      return equivalentModifierKeys.includes(code);
    } else {
      return keyOrCode === code;
    }
  },
  ALL_KEYS: ALL_KEY_CODES
};
for (const keyKey in KeyboardUtils) {
  // @ts-expect-error No functions or key-groups allowed
  if (KeyboardUtils.hasOwnProperty(keyKey) && typeof KeyboardUtils[keyKey] === 'string') {
    // @ts-expect-error
    ALL_KEY_CODES.push(KeyboardUtils[keyKey]);
  }
}
scenery.register('KeyboardUtils', KeyboardUtils);
export default KeyboardUtils;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ2YWxpZGF0ZSIsInNjZW5lcnkiLCJLRVlfUklHSFRfQVJST1ciLCJLRVlfTEVGVF9BUlJPVyIsIktFWV9VUF9BUlJPVyIsIktFWV9ET1dOX0FSUk9XIiwiS0VZX1NISUZUX1JJR0hUIiwiS0VZX1NISUZUX0xFRlQiLCJLRVlfQ09OVFJPTF9MRUZUIiwiS0VZX0NPTlRST0xfUklHSFQiLCJLRVlfQUxUX0xFRlQiLCJLRVlfQUxUX1JJR0hUIiwiS0VZX1ciLCJLRVlfQSIsIktFWV9TIiwiS0VZX0QiLCJLRVlfMCIsIktFWV8xIiwiS0VZXzIiLCJLRVlfMyIsIktFWV80IiwiS0VZXzUiLCJLRVlfNiIsIktFWV83IiwiS0VZXzgiLCJLRVlfOSIsIktFWV9BTFQiLCJLRVlfU0hJRlQiLCJLRVlfQ09OVFJPTCIsIkFSUk9XX0tFWVMiLCJXQVNEX0tFWVMiLCJOVU1CRVJfS0VZUyIsIlNISUZUX0tFWVMiLCJDT05UUk9MX0tFWVMiLCJBTFRfS0VZUyIsIk1PRElGSUVSX0tFWVMiLCJET01fRVZFTlRfVkFMSURBVE9SIiwidmFsdWVUeXBlIiwiRXZlbnQiLCJBTExfS0VZX0NPREVTIiwiS2V5Ym9hcmRVdGlscyIsIktFWV9TUEFDRSIsIktFWV9FTlRFUiIsIktFWV9UQUIiLCJLRVlfRVNDQVBFIiwiS0VZX0RFTEVURSIsIktFWV9CQUNLU1BBQ0UiLCJLRVlfUEFHRV9VUCIsIktFWV9QQUdFX0RPV04iLCJLRVlfRU5EIiwiS0VZX0hPTUUiLCJLRVlfTlVNUEFEXzAiLCJLRVlfTlVNUEFEXzEiLCJLRVlfTlVNUEFEXzIiLCJLRVlfTlVNUEFEXzMiLCJLRVlfTlVNUEFEXzQiLCJLRVlfTlVNUEFEXzUiLCJLRVlfTlVNUEFEXzYiLCJLRVlfTlVNUEFEXzciLCJLRVlfTlVNUEFEXzgiLCJLRVlfTlVNUEFEXzkiLCJLRVlfTlVNUEFEX0RFQ0lNQUwiLCJLRVlfTlVNUEFEX1BMVVMiLCJLRVlfTlVNUEFEX01JTlVTIiwiS0VZX0IiLCJLRVlfQyIsIktFWV9FIiwiS0VZX0YiLCJLRVlfRyIsIktFWV9IIiwiS0VZX0kiLCJLRVlfSiIsIktFWV9LIiwiS0VZX0wiLCJLRVlfTSIsIktFWV9OIiwiS0VZX08iLCJLRVlfUCIsIktFWV9RIiwiS0VZX1IiLCJLRVlfVCIsIktFWV9VIiwiS0VZX1YiLCJLRVlfWCIsIktFWV9ZIiwiS0VZX1oiLCJLRVlfRVFVQUxTIiwiS0VZX1BMVVMiLCJLRVlfTUlOVVMiLCJLRVlfUEVSSU9EIiwiTU9WRU1FTlRfS0VZUyIsImNvbmNhdCIsIk1PRElGSUVSX0tFWV9UT19DT0RFX01BUCIsIk1hcCIsImlzQXJyb3dLZXkiLCJkb21FdmVudCIsImlzQW55S2V5RXZlbnQiLCJpc1JhbmdlS2V5IiwiaXNOdW1iZXJLZXkiLCJnZXROdW1iZXJGcm9tQ29kZSIsIktleWJvYXJkRXZlbnQiLCJOdW1iZXIiLCJjb2RlIiwicmVwbGFjZSIsImlzU2hpZnRLZXkiLCJpc0FsdEtleSIsImlzQ29udHJvbEtleSIsImlzV0FTREtleSIsImlzTW92ZW1lbnRLZXkiLCJrZXlib2FyZFV0aWxzS2V5cyIsImdldEV2ZW50Q29kZSIsImluY2x1ZGVzIiwiaXNLZXlFdmVudCIsImtleWJvYXJkVXRpbHNLZXkiLCJldmVudENvZGUiLCJzdGFydHNXaXRoIiwia2V5IiwiaXNNb2RpZmllcktleSIsImFyZUtleXNFcXVpdmFsZW50Iiwia2V5T3JDb2RlIiwiZXF1aXZhbGVudE1vZGlmaWVyS2V5cyIsImdldCIsIkFMTF9LRVlTIiwia2V5S2V5IiwiaGFzT3duUHJvcGVydHkiLCJwdXNoIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJLZXlib2FyZFV0aWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE3LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIENvbGxlY3Rpb24gb2YgdXRpbGl0eSBjb25zdGFudHMgYW5kIGZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcga2V5Ym9hcmQgaW5wdXQuIENvbnN0YW50cyBhcmUgdmFsdWVzIG9mIEV2ZW50LmNvZGUsIGFzXHJcbiAqIHdlbGwgYXMgaGVscGVyIGZ1bmN0aW9ucyBhbmQgY29sbGVjdGlvbnMuXHJcbiAqXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnXHJcbiAqIEBhdXRob3IgTWljaGFlbCBLYXV6bWFubiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy92YWxpZGF0ZS5qcyc7XHJcbmltcG9ydCB7IHNjZW5lcnkgfSBmcm9tICcuLi9pbXBvcnRzLmpzJztcclxuXHJcbmNvbnN0IEtFWV9SSUdIVF9BUlJPVyA9ICdBcnJvd1JpZ2h0JztcclxuY29uc3QgS0VZX0xFRlRfQVJST1cgPSAnQXJyb3dMZWZ0JztcclxuY29uc3QgS0VZX1VQX0FSUk9XID0gJ0Fycm93VXAnO1xyXG5jb25zdCBLRVlfRE9XTl9BUlJPVyA9ICdBcnJvd0Rvd24nO1xyXG5jb25zdCBLRVlfU0hJRlRfUklHSFQgPSAnU2hpZnRSaWdodCc7XHJcbmNvbnN0IEtFWV9TSElGVF9MRUZUID0gJ1NoaWZ0TGVmdCc7XHJcbmNvbnN0IEtFWV9DT05UUk9MX0xFRlQgPSAnQ29udHJvbExlZnQnO1xyXG5jb25zdCBLRVlfQ09OVFJPTF9SSUdIVCA9ICdDb250cm9sUmlnaHQnO1xyXG5jb25zdCBLRVlfQUxUX0xFRlQgPSAnQWx0TGVmdCc7XHJcbmNvbnN0IEtFWV9BTFRfUklHSFQgPSAnQWx0UmlnaHQnO1xyXG5jb25zdCBLRVlfVyA9ICdLZXlXJztcclxuY29uc3QgS0VZX0EgPSAnS2V5QSc7XHJcbmNvbnN0IEtFWV9TID0gJ0tleVMnO1xyXG5jb25zdCBLRVlfRCA9ICdLZXlEJztcclxuY29uc3QgS0VZXzAgPSAnRGlnaXQwJztcclxuY29uc3QgS0VZXzEgPSAnRGlnaXQxJztcclxuY29uc3QgS0VZXzIgPSAnRGlnaXQyJztcclxuY29uc3QgS0VZXzMgPSAnRGlnaXQzJztcclxuY29uc3QgS0VZXzQgPSAnRGlnaXQ0JztcclxuY29uc3QgS0VZXzUgPSAnRGlnaXQ1JztcclxuY29uc3QgS0VZXzYgPSAnRGlnaXQ2JztcclxuY29uc3QgS0VZXzcgPSAnRGlnaXQ3JztcclxuY29uc3QgS0VZXzggPSAnRGlnaXQ4JztcclxuY29uc3QgS0VZXzkgPSAnRGlnaXQ5JztcclxuXHJcbi8vIFRoZXNlIGFyZSBgS2V5Ym9hcmRFdmVudC5rZXlgIHZhbHVlcyEgVGhlIGRpZmZlcmVuY2UgaXMgbmVjZXNzYXJ5IGJlY2F1c2UgS2V5Ym9hcmRFdmVudC5jb2RlIGRpc3Rpbmd1aXNoZXMgYmV0d2VlblxyXG4vLyBsZWZ0IGFuZCByaWdodCwgYnV0IHdlIG9mdGVuIG5lZWQgdG8gd2F0Y2ggZm9yIGJvdGggYXQgdGhlIHNhbWUgdGltZS5cclxuY29uc3QgS0VZX0FMVCA9ICdBbHQnO1xyXG5jb25zdCBLRVlfU0hJRlQgPSAnU2hpZnQnO1xyXG5jb25zdCBLRVlfQ09OVFJPTCA9ICdDb250cm9sJztcclxuXHJcbmNvbnN0IEFSUk9XX0tFWVMgPSBbIEtFWV9SSUdIVF9BUlJPVywgS0VZX0xFRlRfQVJST1csIEtFWV9VUF9BUlJPVywgS0VZX0RPV05fQVJST1cgXTtcclxuY29uc3QgV0FTRF9LRVlTID0gWyBLRVlfVywgS0VZX1MsIEtFWV9BLCBLRVlfRCBdO1xyXG5jb25zdCBOVU1CRVJfS0VZUyA9IFsgS0VZXzAsIEtFWV8xLCBLRVlfMiwgS0VZXzMsIEtFWV80LCBLRVlfNSwgS0VZXzYsIEtFWV83LCBLRVlfOCwgS0VZXzkgXTtcclxuY29uc3QgU0hJRlRfS0VZUyA9IFsgS0VZX1NISUZUX0xFRlQsIEtFWV9TSElGVF9SSUdIVCBdO1xyXG5jb25zdCBDT05UUk9MX0tFWVMgPSBbIEtFWV9DT05UUk9MX0xFRlQsIEtFWV9DT05UUk9MX1JJR0hUIF07XHJcbmNvbnN0IEFMVF9LRVlTID0gWyBLRVlfQUxUX0xFRlQsIEtFWV9BTFRfUklHSFQgXTtcclxuXHJcbi8vIFRoZXNlIGFyZSBLZXlib2FyZEV2ZW50LmtleSB2YWx1ZXMsIGV4Y2x1ZGluZyBsZWZ0L3JpZ2h0IEtleWJvYXJkRXZlbnQuY29kZXNcclxuY29uc3QgTU9ESUZJRVJfS0VZUyA9IFsgS0VZX0FMVCwgS0VZX0NPTlRST0wsIEtFWV9TSElGVCBdO1xyXG5cclxuY29uc3QgRE9NX0VWRU5UX1ZBTElEQVRPUiA9IHsgdmFsdWVUeXBlOiBFdmVudCB9O1xyXG5jb25zdCBBTExfS0VZX0NPREVTOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuLyoqXHJcbiAqIEBleHRlbmRzIHtPYmplY3R9XHJcbiAqIEB0eXBlIHt7S0VZX0E6IHN0cmluZywgS0VZX0M6IHN0cmluZywgS0VZX0RPV05fQVJST1c6IHN0cmluZywgS0VZX0RFTEVURTogc3RyaW5nLCBLRVlfQjogc3RyaW5nLCBLRVlfRTogc3RyaW5nLCBLRVlfRDogc3RyaW5nLCBLRVlfRzogc3RyaW5nLCBLRVlfRjogc3RyaW5nLCBLRVlfSTogc3RyaW5nLCBLRVlfSDogc3RyaW5nLCBLRVlfSzogc3RyaW5nLCBLRVlfUklHSFRfQVJST1c6IHN0cmluZywgS0VZX0o6IHN0cmluZywgaXNBcnJvd0tleShFdmVudCk6IGJvb2xlYW4sIEtFWV9NOiBzdHJpbmcsIEtFWV9MOiBzdHJpbmcsIEtFWV9POiBzdHJpbmcsIEtFWV9OOiBzdHJpbmcsIEtFWV9ROiBzdHJpbmcsIEtFWV9QOiBzdHJpbmcsIEtFWV9TOiBzdHJpbmcsIEtFWV9CQUNLU1BBQ0U6IHN0cmluZywgS0VZX1I6IHN0cmluZywgS0VZX1U6IHN0cmluZywgS0VZX01JTlVTOiBzdHJpbmcsIEtFWV9UOiBzdHJpbmcsIGlzTW92ZW1lbnRLZXkoRXZlbnQpOiBib29sZWFuLCBLRVlfVzogc3RyaW5nLCBLRVlfVjogc3RyaW5nLCBDT05UUk9MX0tFWVM6IChzdHJpbmcpW10sIEtFWV9ZOiBzdHJpbmcsIEtFWV9YOiBzdHJpbmcsIGdldE51bWJlckZyb21Db2RlKEV2ZW50KTogKG51bWJlcnxudWxsKSwgaXNBbHRLZXkoS2V5Ym9hcmRFdmVudCk6ICosIEtFWV9aOiBzdHJpbmcsIEFSUk9XX0tFWVM6IChzdHJpbmcpW10sIEtFWV9TSElGVF9MRUZUOiBzdHJpbmcsIEtFWV9IT01FOiBzdHJpbmcsIEtFWV9FU0NBUEU6IHN0cmluZywgaXNTaGlmdEtleShLZXlib2FyZEV2ZW50KTogKiwgS0VZX0FMVF9MRUZUOiBzdHJpbmcsIEtFWV9MRUZUX0FSUk9XOiBzdHJpbmcsIEtFWV9UQUI6IHN0cmluZywgaXNBbnlLZXlFdmVudCh4OkV2ZW50LCB5OkFycmF5PHN0cmluZz4pOiBib29sZWFuLCBnZXRFdmVudENvZGUoRXZlbnQpOiAoc3RyaW5nfG51bGwpLCBLRVlfRVFVQUxTOiBzdHJpbmcsIEtFWV9QQUdFX1VQOiBzdHJpbmcsIEtFWV9BTFRfUklHSFQ6IHN0cmluZywgaXNXQVNES2V5KEV2ZW50KTogYm9vbGVhbiwgQUxUX0tFWVM6IChzdHJpbmcpW10sIEtFWV9QQUdFX0RPV046IHN0cmluZywgaXNOdW1iZXJLZXkoRXZlbnQpOiBib29sZWFuLCBTSElGVF9LRVlTOiAoc3RyaW5nKVtdLCBLRVlfUExVUzogc3RyaW5nLCBXQVNEX0tFWVM6IChzdHJpbmcpW10sIGlzQ29udHJvbEtleShLZXlib2FyZEV2ZW50KTogKiwgS0VZX1NISUZUX1JJR0hUOiBzdHJpbmcsIGlzUmFuZ2VLZXkoRXZlbnQpOiBib29sZWFuLCBLRVlfQ09OVFJPTF9SSUdIVDogc3RyaW5nLCBLRVlfRU5URVI6IHN0cmluZywgaXNLZXlFdmVudChFdmVudCwgc3RyaW5nKTogYm9vbGVhbiwgS0VZX1VQX0FSUk9XOiBzdHJpbmcsIEtFWV8xOiBzdHJpbmcsIEtFWV8wOiBzdHJpbmcsIEtFWV9DT05UUk9MX0xFRlQ6IHN0cmluZywgS0VZXzM6IHN0cmluZywgS0VZXzI6IHN0cmluZywgS0VZXzU6IHN0cmluZywgS0VZXzQ6IHN0cmluZywgS0VZXzc6IHN0cmluZywgS0VZXzY6IHN0cmluZywgS0VZXzk6IHN0cmluZywgTU9WRU1FTlRfS0VZUzogKHN0cmluZylbXSwgS0VZXzg6IHN0cmluZywgS0VZX1NQQUNFOiBzdHJpbmcsIEtFWV9FTkQ6IHN0cmluZ319XHJcbiAqL1xyXG5jb25zdCBLZXlib2FyZFV0aWxzID0ge1xyXG4gIEtFWV9TUEFDRTogJ1NwYWNlJyxcclxuICBLRVlfRU5URVI6ICdFbnRlcicsXHJcbiAgS0VZX1RBQjogJ1RhYicsXHJcbiAgS0VZX1JJR0hUX0FSUk9XOiBLRVlfUklHSFRfQVJST1csXHJcbiAgS0VZX0xFRlRfQVJST1c6IEtFWV9MRUZUX0FSUk9XLFxyXG4gIEtFWV9VUF9BUlJPVzogS0VZX1VQX0FSUk9XLFxyXG4gIEtFWV9ET1dOX0FSUk9XOiBLRVlfRE9XTl9BUlJPVyxcclxuICBLRVlfU0hJRlRfTEVGVDogS0VZX1NISUZUX0xFRlQsXHJcbiAgS0VZX1NISUZUX1JJR0hUOiBLRVlfU0hJRlRfUklHSFQsXHJcbiAgS0VZX0FMVF9MRUZUOiBLRVlfQUxUX0xFRlQsXHJcbiAgS0VZX0FMVF9SSUdIVDogS0VZX0FMVF9SSUdIVCxcclxuICBLRVlfQ09OVFJPTF9MRUZUOiBLRVlfQ09OVFJPTF9MRUZULFxyXG4gIEtFWV9DT05UUk9MX1JJR0hUOiBLRVlfQ09OVFJPTF9SSUdIVCxcclxuICBLRVlfU0hJRlQ6IEtFWV9TSElGVCxcclxuICBLRVlfQUxUOiBLRVlfQUxULFxyXG4gIEtFWV9DT05UUk9MOiBLRVlfQ09OVFJPTCxcclxuICBLRVlfRVNDQVBFOiAnRXNjYXBlJyxcclxuICBLRVlfREVMRVRFOiAnRGVsZXRlJyxcclxuICBLRVlfQkFDS1NQQUNFOiAnQmFja3NwYWNlJyxcclxuICBLRVlfUEFHRV9VUDogJ1BhZ2VVcCcsXHJcbiAgS0VZX1BBR0VfRE9XTjogJ1BhZ2VEb3duJyxcclxuICBLRVlfRU5EOiAnRW5kJyxcclxuICBLRVlfSE9NRTogJ0hvbWUnLFxyXG4gIEtFWV8wOiBLRVlfMCxcclxuICBLRVlfMTogS0VZXzEsXHJcbiAgS0VZXzI6IEtFWV8yLFxyXG4gIEtFWV8zOiBLRVlfMyxcclxuICBLRVlfNDogS0VZXzQsXHJcbiAgS0VZXzU6IEtFWV81LFxyXG4gIEtFWV82OiBLRVlfNixcclxuICBLRVlfNzogS0VZXzcsXHJcbiAgS0VZXzg6IEtFWV84LFxyXG4gIEtFWV85OiBLRVlfOSxcclxuICBLRVlfTlVNUEFEXzA6ICdOdW1wYWQwJyxcclxuICBLRVlfTlVNUEFEXzE6ICdOdW1wYWQxJyxcclxuICBLRVlfTlVNUEFEXzI6ICdOdW1wYWQyJyxcclxuICBLRVlfTlVNUEFEXzM6ICdOdW1wYWQzJyxcclxuICBLRVlfTlVNUEFEXzQ6ICdOdW1wYWQ0JyxcclxuICBLRVlfTlVNUEFEXzU6ICdOdW1wYWQ1JyxcclxuICBLRVlfTlVNUEFEXzY6ICdOdW1wYWQ2JyxcclxuICBLRVlfTlVNUEFEXzc6ICdOdW1wYWQ3JyxcclxuICBLRVlfTlVNUEFEXzg6ICdOdW1wYWQ4JyxcclxuICBLRVlfTlVNUEFEXzk6ICdOdW1wYWQ5JyxcclxuICBLRVlfTlVNUEFEX0RFQ0lNQUw6ICdOdW1wYWREZWNpbWFsJyxcclxuICBLRVlfTlVNUEFEX1BMVVM6ICdOdW1wYWRBZGQnLFxyXG4gIEtFWV9OVU1QQURfTUlOVVM6ICdOdW1wYWRTdWJ0cmFjdCcsXHJcbiAgS0VZX0E6ICdLZXlBJyxcclxuICBLRVlfQjogJ0tleUInLFxyXG4gIEtFWV9DOiAnS2V5QycsXHJcbiAgS0VZX0Q6ICdLZXlEJyxcclxuICBLRVlfRTogJ0tleUUnLFxyXG4gIEtFWV9GOiAnS2V5RicsXHJcbiAgS0VZX0c6ICdLZXlHJyxcclxuICBLRVlfSDogJ0tleUgnLFxyXG4gIEtFWV9JOiAnS2V5SScsXHJcbiAgS0VZX0o6ICdLZXlKJyxcclxuICBLRVlfSzogJ0tleUsnLFxyXG4gIEtFWV9MOiAnS2V5TCcsXHJcbiAgS0VZX006ICdLZXlNJyxcclxuICBLRVlfTjogJ0tleU4nLFxyXG4gIEtFWV9POiAnS2V5TycsXHJcbiAgS0VZX1A6ICdLZXlQJyxcclxuICBLRVlfUTogJ0tleVEnLFxyXG4gIEtFWV9SOiAnS2V5UicsXHJcbiAgS0VZX1M6ICdLZXlTJyxcclxuICBLRVlfVDogJ0tleVQnLFxyXG4gIEtFWV9VOiAnS2V5VScsXHJcbiAgS0VZX1Y6ICdLZXlWJyxcclxuICBLRVlfVzogJ0tleVcnLFxyXG4gIEtFWV9YOiAnS2V5WCcsXHJcbiAgS0VZX1k6ICdLZXlZJyxcclxuICBLRVlfWjogJ0tleVonLFxyXG5cclxuICAvLyBcIkVxdWFsc1wiIGFuZCBcIlBsdXNcIiBzaGFyZSB0aGUgc2FtZSBldmVudC5jb2RlLCBjaGVjayBmb3IgZGlzdGluY3Rpb24gd2l0aCBzaGlmdCBtb2RpZmllciBrZXlcclxuICBLRVlfRVFVQUxTOiAnRXF1YWwnLFxyXG4gIEtFWV9QTFVTOiAnRXF1YWwnLFxyXG4gIEtFWV9NSU5VUzogJ01pbnVzJyxcclxuICBLRVlfUEVSSU9EOiAnUGVyaW9kJyxcclxuXHJcbiAgQVJST1dfS0VZUzogQVJST1dfS0VZUyxcclxuICBXQVNEX0tFWVM6IFdBU0RfS0VZUyxcclxuICBNT1ZFTUVOVF9LRVlTOiBBUlJPV19LRVlTLmNvbmNhdCggV0FTRF9LRVlTICksXHJcbiAgU0hJRlRfS0VZUzogU0hJRlRfS0VZUyxcclxuICBDT05UUk9MX0tFWVM6IENPTlRST0xfS0VZUyxcclxuICBBTFRfS0VZUzogQUxUX0tFWVMsXHJcblxyXG4gIC8vIE1hcHMgYSBLZXlib2FyZEV2ZW50LmtleSB0byB0aGUgbGVmdC9yaWdodCBwYWlyIG9mIEtleWJvYXJkRXZlbnQuY29kZSBmb3IgbW9kaWZpZXIga2V5c1xyXG4gIE1PRElGSUVSX0tFWV9UT19DT0RFX01BUDogbmV3IE1hcCggW1xyXG4gICAgWyBLRVlfQUxULCBBTFRfS0VZUyBdLFxyXG4gICAgWyBLRVlfU0hJRlQsIFNISUZUX0tFWVMgXSxcclxuICAgIFsgS0VZX0NPTlRST0wsIENPTlRST0xfS0VZUyBdXHJcbiAgXSApLFxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBrZXkgY29ycmVzcG9uZHMgdG8gcHJlc3NpbmcgYW4gYXJyb3cga2V5XHJcbiAgICovXHJcbiAgaXNBcnJvd0tleSggZG9tRXZlbnQ6IEV2ZW50IHwgbnVsbCApOiBib29sZWFuIHtcclxuICAgIHJldHVybiBLZXlib2FyZFV0aWxzLmlzQW55S2V5RXZlbnQoIGRvbUV2ZW50LCBBUlJPV19LRVlTICk7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0cnVlIGlmIGtleSBpcyBvbmUgb2Yga2V5cyB1c2VkIGZvciByYW5nZSBpbnB1dHNcclxuICAgKi9cclxuICBpc1JhbmdlS2V5KCBkb21FdmVudDogRXZlbnQgfCBudWxsICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIEtleWJvYXJkVXRpbHMuaXNBcnJvd0tleSggZG9tRXZlbnQgKSB8fFxyXG4gICAgICAgICAgIEtleWJvYXJkVXRpbHMuaXNBbnlLZXlFdmVudCggZG9tRXZlbnQsIFtcclxuICAgICAgICAgICAgIEtleWJvYXJkVXRpbHMuS0VZX1BBR0VfVVAsXHJcbiAgICAgICAgICAgICBLZXlib2FyZFV0aWxzLktFWV9QQUdFX0RPV04sXHJcbiAgICAgICAgICAgICBLZXlib2FyZFV0aWxzLktFWV9IT01FLFxyXG4gICAgICAgICAgICAgS2V5Ym9hcmRVdGlscy5LRVlfRU5EXHJcbiAgICAgICAgICAgXSApO1xyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgd2hldGhlciBvciBub3QgdGhlIGtleSBjb3JyZXNwb25kcyB0byBwcmVzc2luZyBhIG51bWJlciBrZXlcclxuICAgKi9cclxuICBpc051bWJlcktleSggZG9tRXZlbnQ6IEV2ZW50IHwgbnVsbCApOiBib29sZWFuIHtcclxuICAgIHJldHVybiBLZXlib2FyZFV0aWxzLmlzQW55S2V5RXZlbnQoIGRvbUV2ZW50LCBOVU1CRVJfS0VZUyApO1xyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIEZvciBudW1iZXIga2V5cywgcmV0dXJuIHRoZSBudW1iZXIgb2YgdGhlIGtleSwgb3IgbnVsbCBpZiBub3QgYSBudW1iZXJcclxuICAgKi9cclxuICBnZXROdW1iZXJGcm9tQ29kZSggZG9tRXZlbnQ6IEV2ZW50IHwgbnVsbCApOiBudWxsIHwgbnVtYmVyIHtcclxuICAgIGlmICggS2V5Ym9hcmRVdGlscy5pc051bWJlcktleSggZG9tRXZlbnQgKSAmJiBkb21FdmVudCBpbnN0YW5jZW9mIEtleWJvYXJkRXZlbnQgKSB7XHJcbiAgICAgIHJldHVybiBOdW1iZXIoIGRvbUV2ZW50LmNvZGUucmVwbGFjZSggJ0RpZ2l0JywgJycgKSApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogRXZlbnQuY29kZSBkaXN0aW5ndWlzaGVzIGJldHdlZW4gbGVmdCBhbmQgcmlnaHQgc2hpZnQga2V5cy4gSWYgYWxsIHlvdSBjYXJlIGFib3V0IGlzIHRoZSBwcmVzZW5jZVxyXG4gICAqIG9mIGEgc2hpZnQga2V5IHlvdSBjYW4gdXNlIHRoaXMuXHJcbiAgICovXHJcbiAgaXNTaGlmdEtleSggZG9tRXZlbnQ6IEV2ZW50IHwgbnVsbCApOiBib29sZWFuIHtcclxuICAgIHJldHVybiBLZXlib2FyZFV0aWxzLmlzQW55S2V5RXZlbnQoIGRvbUV2ZW50LCBTSElGVF9LRVlTICk7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogRXZlbnQuY29kZSBkaXN0aW5ndWlzaGVzIGJldHdlZW4gbGVmdCBhbmQgcmlnaHQgYWx0IGtleXMuIElmIGFsbCB5b3UgY2FyZSBhYm91dCBpcyB0aGUgcHJlc2VuY2VcclxuICAgKiBvZiB0aGUgYWx0IGtleSB5b3UgY2FuIHVzZSB0aGlzLlxyXG4gICAqL1xyXG4gIGlzQWx0S2V5KCBkb21FdmVudDogRXZlbnQgfCBudWxsICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIEtleWJvYXJkVXRpbHMuaXNBbnlLZXlFdmVudCggZG9tRXZlbnQsIEFMVF9LRVlTICk7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogRXZlbnQuY29kZSBkaXN0aW5ndWlzaGVzIGJldHdlZW4gbGVmdCBhbmQgcmlnaHQgY29udHJvbCBrZXlzLiBJZiBhbGwgeW91IGNhcmUgYWJvdXQgaXMgdGhlIHByZXNlbmNlXHJcbiAgICogb2YgYSBjb250cm9sIGtleSB5b3UgY2FuIHVzZSB0aGlzLlxyXG4gICAqL1xyXG4gIGlzQ29udHJvbEtleSggZG9tRXZlbnQ6IEV2ZW50IHwgbnVsbCApOiBib29sZWFuIHtcclxuICAgIHJldHVybiBLZXlib2FyZFV0aWxzLmlzQW55S2V5RXZlbnQoIGRvbUV2ZW50LCBDT05UUk9MX0tFWVMgKTtcclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBrZXkgY29ycmVzcG9uZHMgdG8gb25lIG9mIHRoZSBXQVNEIG1vdmVtZW50IGtleXMuXHJcbiAgICovXHJcbiAgaXNXQVNES2V5KCBkb21FdmVudDogRXZlbnQgfCBudWxsICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIEtleWJvYXJkVXRpbHMuaXNBbnlLZXlFdmVudCggZG9tRXZlbnQsIFdBU0RfS0VZUyApO1xyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUga2V5IGluZGljYXRlcyBhICdtb3ZlbWVudCcga2V5IGluIGtleWJvYXJkIGRyYWdnaW5nXHJcbiAgICovXHJcbiAgaXNNb3ZlbWVudEtleSggZG9tRXZlbnQ6IEV2ZW50IHwgbnVsbCApOiBib29sZWFuIHtcclxuICAgIHJldHVybiBLZXlib2FyZFV0aWxzLmlzQW55S2V5RXZlbnQoIGRvbUV2ZW50LCBLZXlib2FyZFV0aWxzLk1PVkVNRU5UX0tFWVMgKTtcclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiBJZiB0aGUgZG9tRXZlbnQgY29ycmVzcG9uZHMgdG8gYW55IG9mIHRoZSBwcm92aWRlZCBrZXlzIGluIHRoZSBsaXN0LlxyXG4gICAqL1xyXG4gIGlzQW55S2V5RXZlbnQoIGRvbUV2ZW50OiBFdmVudCB8IG51bGwsIGtleWJvYXJkVXRpbHNLZXlzOiBzdHJpbmdbXSApOiBib29sZWFuIHtcclxuICAgIHZhbGlkYXRlKCBkb21FdmVudCwgRE9NX0VWRU5UX1ZBTElEQVRPUiApO1xyXG4gICAgY29uc3QgY29kZSA9IEtleWJvYXJkVXRpbHMuZ2V0RXZlbnRDb2RlKCBkb21FdmVudCApO1xyXG4gICAgcmV0dXJuIGNvZGUgPyBrZXlib2FyZFV0aWxzS2V5cy5pbmNsdWRlcyggY29kZSApIDogZmFsc2U7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogV2hldGhlciB0aGUgZXZlbnQgd2FzIG9mIHRoZSBwcm92aWRlZCBLZXlib2FyZFV0aWxzIHN0cmluZy5cclxuICAgKi9cclxuICBpc0tleUV2ZW50KCBkb21FdmVudDogRXZlbnQgfCBudWxsLCBrZXlib2FyZFV0aWxzS2V5OiBzdHJpbmcgKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gS2V5Ym9hcmRVdGlscy5nZXRFdmVudENvZGUoIGRvbUV2ZW50ICkgPT09IGtleWJvYXJkVXRpbHNLZXk7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhIHN0cmluZyB3aXRoIHRoZSBldmVudC5jb2RlIHRoYXQgY2FuIGJlIHVzZWQgdG8gZGV0ZXJtaW5lIHRoZSBrZXlib2FyZCBrZXlzIG9mIGEgS2V5Ym9hcmRFdmVudCBvYmplY3QuXHJcbiAgICogT3RoZXJ3aXNlLCByZXR1cm5zIG51bGwgaWYgdGhlcmUgaXMgbm8gY29kZSBvbiB0aGUgZXZlbnQuIEFuIGV4YW1wbGUgdXNhZ2UgbWlnaHQgbG9vayBsaWtlXHJcbiAgICpcclxuICAgKiAgY29uc3Qga2V5ID0gS2V5Ym9hcmRVdGlscy5nZXRFdmVudENvZGUoIGRvbUV2ZW50ICk7XHJcbiAgICogIGlmICgga2V5ID09PSBLZXlib2FyZFV0aWxzLktFWV9BICkge1xyXG4gICAqICAgIC8vIFlvdSBwcmVzc2VkIHRoZSBBIGtleSFcclxuICAgKiAgfVxyXG4gICAqXHJcbiAgICogQHJldHVybnMgLSBudWxsIGlmIHRoZXJlIGlzIG5vIGBjb2RlYCBwcm9wZXJ0eSBvbiB0aGUgcHJvdmlkZWQgRXZlbnQuXHJcbiAgICovXHJcbiAgZ2V0RXZlbnRDb2RlKCBkb21FdmVudDogRXZlbnQgfCBudWxsICk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgbGV0IGV2ZW50Q29kZSA9IG51bGw7XHJcbiAgICBpZiAoIGRvbUV2ZW50IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCAmJiBkb21FdmVudC5jb2RlICkge1xyXG4gICAgICBldmVudENvZGUgPSBkb21FdmVudC5jb2RlO1xyXG5cclxuICAgICAgLy8gRm9yIE51bXBhZCBrZXlzLCB0aGUgRG9tRXZlbnQuY29kZSBkb2VzIG5vdCBtYXRjaCB0aGUgZXF1aXZhbGVudCBcIm5vcm1hbFwiIGtleWJvYXJkIGtleSwgYnV0IHRoZSBEb21FdmVudC5rZXlcclxuICAgICAgLy8gd2lsbCBtYXRjaCB0aGUgY29kZSBvZiB0aGUgXCJub3JtYWxcIiBrZXkuIEluIHRob3NlIGNhc2VzIChob21lL3BhZ2UgdXAvcGFnZSBkb3duL2VuZCkgdXNlIHRoZSBrZXkgYXMgdGhlIGNvZGUuXHJcbiAgICAgIGlmICggZXZlbnRDb2RlLnN0YXJ0c1dpdGgoICdOdW1wYWQnICkgJiYgQUxMX0tFWV9DT0RFUy5pbmNsdWRlcyggZG9tRXZlbnQua2V5ICkgKSB7XHJcbiAgICAgICAgZXZlbnRDb2RlID0gZG9tRXZlbnQua2V5O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGV2ZW50Q29kZTtcclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRydWUgd2hlbiBpZiB0aGUgcHJvdmlkZWQgc3RyaW5nIGlzIGEgS2V5Ym9hcmRFdmVudC5rZXkgZm9yIGEgbW9kaWZpZXIga2V5LiBOb3RlIHRoYXQgaXMgS2V5Ym9hcmRFdmVudC5rZXlcclxuICAgKiAqKk5PVCoqIEtleWJvYXJkRXZlbnQuY29kZS4gS2V5Ym9hcmRFdmVudC5jb2RlIGRvZXMgbm90IGRpc3Rpbmd1aXNoIGJldHdlZW4gbGVmdCBhbmQgcmlnaHQgbW9kaWZpZXIga2V5cyBzbyB3ZVxyXG4gICAqIGhhdmUgc29tZSBzcGVjaWFsIGJlaGF2aW9yIHdoZW4gd2UgZGV0ZWN0IGEgbW9kaWZpZXIga2V5IChsZWZ0IG9yIHJpZ2h0KSBpcyBwcmVzc2VkLlxyXG4gICAqIEBwYXJhbSBrZXlcclxuICAgKi9cclxuICBpc01vZGlmaWVyS2V5KCBrZXk6IHN0cmluZyApOiBib29sZWFuIHtcclxuICAgIHJldHVybiBNT0RJRklFUl9LRVlTLmluY2x1ZGVzKCBrZXkgKTtcclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIEtleWJvYXJkRXZlbnQuY29kZS9LZXlib2FyZEV2ZW50LmtleSBpcyBlcXVpdmFsZW50IHRvIHRoZSBwcm92aWRlZCBLZXlib2FyZEV2ZW50LmNvZGUuXHJcbiAgICogU3BlY2lmaWNhbGx5IGNvbXBhcmluZyBtb2RpZmllciBrZXlzLiBJZiBib3RoIGFyZSBgY29kZWAsIHJldHVybnMgdHJ1ZSB3aGVuIHRoZXkgYXJlIGVxdWFsLiBJZiBmaXJzdCB2YWx1ZSBpc1xyXG4gICAqIGEgYGtleWAgZm9yIGFsdC9jb250cm9sL3NoaWZ0IG1vZGlmaWVyIGtleSwgdGhlbiBpdCByZXR1cm5zIHRydWUgd2hlbiB0aGUgY29kZSBpcyBvbmUgb2YgdGhlIG1hdGNoaW5nXHJcbiAgICogbGVmdC9yaWdodCBgY29kZXNgIGZvciB0aGF0IGBrZXlgLiBGb3IgZXhhbXBsZVxyXG4gICAqXHJcbiAgICogYGtleU9yQ29kZWAgPSAnU2hpZnQnLCBgY29kZWAgPSAnU2hpZnRMZWZ0IC0+IHRydWVcclxuICAgKiBga2V5T3JDb2RlID0gJ0FsdCcsIGBjb2RlYCA9ICdBbHRSaWdodCcgLT4gdHJ1ZVxyXG4gICAqIGBrZXlPckNvZGUgPSAnQ29udHJvbGAsIGBjb2RlYCA9ICdLZXlSJyAtPiBmYWxzZVxyXG4gICAqXHJcbiAgICogQHBhcmFtIGtleU9yQ29kZSAtIEtleWJvYXJkRXZlbnQua2V5IE9SIEtleWJvYXJkRXZlbnQuY29kZVxyXG4gICAqIEBwYXJhbSBjb2RlIC0gS2V5Ym9hcmRFdmVudC5jb2RlXHJcbiAgICovXHJcbiAgYXJlS2V5c0VxdWl2YWxlbnQoIGtleU9yQ29kZTogc3RyaW5nLCBjb2RlOiBzdHJpbmcgKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBlcXVpdmFsZW50TW9kaWZpZXJLZXlzID0gS2V5Ym9hcmRVdGlscy5NT0RJRklFUl9LRVlfVE9fQ09ERV9NQVAuZ2V0KCBrZXlPckNvZGUgKTtcclxuICAgIGlmICggZXF1aXZhbGVudE1vZGlmaWVyS2V5cyApIHtcclxuICAgICAgcmV0dXJuIGVxdWl2YWxlbnRNb2RpZmllcktleXMuaW5jbHVkZXMoIGNvZGUgKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICByZXR1cm4ga2V5T3JDb2RlID09PSBjb2RlO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIEFMTF9LRVlTOiBBTExfS0VZX0NPREVTXHJcbn07XHJcblxyXG5mb3IgKCBjb25zdCBrZXlLZXkgaW4gS2V5Ym9hcmRVdGlscyApIHtcclxuXHJcbiAgLy8gQHRzLWV4cGVjdC1lcnJvciBObyBmdW5jdGlvbnMgb3Iga2V5LWdyb3VwcyBhbGxvd2VkXHJcbiAgaWYgKCBLZXlib2FyZFV0aWxzLmhhc093blByb3BlcnR5KCBrZXlLZXkgKSAmJiB0eXBlb2YgS2V5Ym9hcmRVdGlsc1sga2V5S2V5IF0gPT09ICdzdHJpbmcnICkge1xyXG5cclxuICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcclxuICAgIEFMTF9LRVlfQ09ERVMucHVzaCggS2V5Ym9hcmRVdGlsc1sga2V5S2V5IF0gYXMgc3RyaW5nICk7XHJcbiAgfVxyXG59XHJcblxyXG5zY2VuZXJ5LnJlZ2lzdGVyKCAnS2V5Ym9hcmRVdGlscycsIEtleWJvYXJkVXRpbHMgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEtleWJvYXJkVXRpbHM7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxRQUFRLE1BQU0sOEJBQThCO0FBQ25ELFNBQVNDLE9BQU8sUUFBUSxlQUFlO0FBRXZDLE1BQU1DLGVBQWUsR0FBRyxZQUFZO0FBQ3BDLE1BQU1DLGNBQWMsR0FBRyxXQUFXO0FBQ2xDLE1BQU1DLFlBQVksR0FBRyxTQUFTO0FBQzlCLE1BQU1DLGNBQWMsR0FBRyxXQUFXO0FBQ2xDLE1BQU1DLGVBQWUsR0FBRyxZQUFZO0FBQ3BDLE1BQU1DLGNBQWMsR0FBRyxXQUFXO0FBQ2xDLE1BQU1DLGdCQUFnQixHQUFHLGFBQWE7QUFDdEMsTUFBTUMsaUJBQWlCLEdBQUcsY0FBYztBQUN4QyxNQUFNQyxZQUFZLEdBQUcsU0FBUztBQUM5QixNQUFNQyxhQUFhLEdBQUcsVUFBVTtBQUNoQyxNQUFNQyxLQUFLLEdBQUcsTUFBTTtBQUNwQixNQUFNQyxLQUFLLEdBQUcsTUFBTTtBQUNwQixNQUFNQyxLQUFLLEdBQUcsTUFBTTtBQUNwQixNQUFNQyxLQUFLLEdBQUcsTUFBTTtBQUNwQixNQUFNQyxLQUFLLEdBQUcsUUFBUTtBQUN0QixNQUFNQyxLQUFLLEdBQUcsUUFBUTtBQUN0QixNQUFNQyxLQUFLLEdBQUcsUUFBUTtBQUN0QixNQUFNQyxLQUFLLEdBQUcsUUFBUTtBQUN0QixNQUFNQyxLQUFLLEdBQUcsUUFBUTtBQUN0QixNQUFNQyxLQUFLLEdBQUcsUUFBUTtBQUN0QixNQUFNQyxLQUFLLEdBQUcsUUFBUTtBQUN0QixNQUFNQyxLQUFLLEdBQUcsUUFBUTtBQUN0QixNQUFNQyxLQUFLLEdBQUcsUUFBUTtBQUN0QixNQUFNQyxLQUFLLEdBQUcsUUFBUTs7QUFFdEI7QUFDQTtBQUNBLE1BQU1DLE9BQU8sR0FBRyxLQUFLO0FBQ3JCLE1BQU1DLFNBQVMsR0FBRyxPQUFPO0FBQ3pCLE1BQU1DLFdBQVcsR0FBRyxTQUFTO0FBRTdCLE1BQU1DLFVBQVUsR0FBRyxDQUFFM0IsZUFBZSxFQUFFQyxjQUFjLEVBQUVDLFlBQVksRUFBRUMsY0FBYyxDQUFFO0FBQ3BGLE1BQU15QixTQUFTLEdBQUcsQ0FBRWxCLEtBQUssRUFBRUUsS0FBSyxFQUFFRCxLQUFLLEVBQUVFLEtBQUssQ0FBRTtBQUNoRCxNQUFNZ0IsV0FBVyxHQUFHLENBQUVmLEtBQUssRUFBRUMsS0FBSyxFQUFFQyxLQUFLLEVBQUVDLEtBQUssRUFBRUMsS0FBSyxFQUFFQyxLQUFLLEVBQUVDLEtBQUssRUFBRUMsS0FBSyxFQUFFQyxLQUFLLEVBQUVDLEtBQUssQ0FBRTtBQUM1RixNQUFNTyxVQUFVLEdBQUcsQ0FBRXpCLGNBQWMsRUFBRUQsZUFBZSxDQUFFO0FBQ3RELE1BQU0yQixZQUFZLEdBQUcsQ0FBRXpCLGdCQUFnQixFQUFFQyxpQkFBaUIsQ0FBRTtBQUM1RCxNQUFNeUIsUUFBUSxHQUFHLENBQUV4QixZQUFZLEVBQUVDLGFBQWEsQ0FBRTs7QUFFaEQ7QUFDQSxNQUFNd0IsYUFBYSxHQUFHLENBQUVULE9BQU8sRUFBRUUsV0FBVyxFQUFFRCxTQUFTLENBQUU7QUFFekQsTUFBTVMsbUJBQW1CLEdBQUc7RUFBRUMsU0FBUyxFQUFFQztBQUFNLENBQUM7QUFDaEQsTUFBTUMsYUFBdUIsR0FBRyxFQUFFOztBQUVsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU1DLGFBQWEsR0FBRztFQUNwQkMsU0FBUyxFQUFFLE9BQU87RUFDbEJDLFNBQVMsRUFBRSxPQUFPO0VBQ2xCQyxPQUFPLEVBQUUsS0FBSztFQUNkekMsZUFBZSxFQUFFQSxlQUFlO0VBQ2hDQyxjQUFjLEVBQUVBLGNBQWM7RUFDOUJDLFlBQVksRUFBRUEsWUFBWTtFQUMxQkMsY0FBYyxFQUFFQSxjQUFjO0VBQzlCRSxjQUFjLEVBQUVBLGNBQWM7RUFDOUJELGVBQWUsRUFBRUEsZUFBZTtFQUNoQ0ksWUFBWSxFQUFFQSxZQUFZO0VBQzFCQyxhQUFhLEVBQUVBLGFBQWE7RUFDNUJILGdCQUFnQixFQUFFQSxnQkFBZ0I7RUFDbENDLGlCQUFpQixFQUFFQSxpQkFBaUI7RUFDcENrQixTQUFTLEVBQUVBLFNBQVM7RUFDcEJELE9BQU8sRUFBRUEsT0FBTztFQUNoQkUsV0FBVyxFQUFFQSxXQUFXO0VBQ3hCZ0IsVUFBVSxFQUFFLFFBQVE7RUFDcEJDLFVBQVUsRUFBRSxRQUFRO0VBQ3BCQyxhQUFhLEVBQUUsV0FBVztFQUMxQkMsV0FBVyxFQUFFLFFBQVE7RUFDckJDLGFBQWEsRUFBRSxVQUFVO0VBQ3pCQyxPQUFPLEVBQUUsS0FBSztFQUNkQyxRQUFRLEVBQUUsTUFBTTtFQUNoQmxDLEtBQUssRUFBRUEsS0FBSztFQUNaQyxLQUFLLEVBQUVBLEtBQUs7RUFDWkMsS0FBSyxFQUFFQSxLQUFLO0VBQ1pDLEtBQUssRUFBRUEsS0FBSztFQUNaQyxLQUFLLEVBQUVBLEtBQUs7RUFDWkMsS0FBSyxFQUFFQSxLQUFLO0VBQ1pDLEtBQUssRUFBRUEsS0FBSztFQUNaQyxLQUFLLEVBQUVBLEtBQUs7RUFDWkMsS0FBSyxFQUFFQSxLQUFLO0VBQ1pDLEtBQUssRUFBRUEsS0FBSztFQUNaMEIsWUFBWSxFQUFFLFNBQVM7RUFDdkJDLFlBQVksRUFBRSxTQUFTO0VBQ3ZCQyxZQUFZLEVBQUUsU0FBUztFQUN2QkMsWUFBWSxFQUFFLFNBQVM7RUFDdkJDLFlBQVksRUFBRSxTQUFTO0VBQ3ZCQyxZQUFZLEVBQUUsU0FBUztFQUN2QkMsWUFBWSxFQUFFLFNBQVM7RUFDdkJDLFlBQVksRUFBRSxTQUFTO0VBQ3ZCQyxZQUFZLEVBQUUsU0FBUztFQUN2QkMsWUFBWSxFQUFFLFNBQVM7RUFDdkJDLGtCQUFrQixFQUFFLGVBQWU7RUFDbkNDLGVBQWUsRUFBRSxXQUFXO0VBQzVCQyxnQkFBZ0IsRUFBRSxnQkFBZ0I7RUFDbENsRCxLQUFLLEVBQUUsTUFBTTtFQUNibUQsS0FBSyxFQUFFLE1BQU07RUFDYkMsS0FBSyxFQUFFLE1BQU07RUFDYmxELEtBQUssRUFBRSxNQUFNO0VBQ2JtRCxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiQyxLQUFLLEVBQUUsTUFBTTtFQUNiakUsS0FBSyxFQUFFLE1BQU07RUFDYmtFLEtBQUssRUFBRSxNQUFNO0VBQ2JDLEtBQUssRUFBRSxNQUFNO0VBQ2JDLEtBQUssRUFBRSxNQUFNO0VBQ2J0RSxLQUFLLEVBQUUsTUFBTTtFQUNidUUsS0FBSyxFQUFFLE1BQU07RUFDYkMsS0FBSyxFQUFFLE1BQU07RUFDYkMsS0FBSyxFQUFFLE1BQU07RUFFYjtFQUNBQyxVQUFVLEVBQUUsT0FBTztFQUNuQkMsUUFBUSxFQUFFLE9BQU87RUFDakJDLFNBQVMsRUFBRSxPQUFPO0VBQ2xCQyxVQUFVLEVBQUUsUUFBUTtFQUVwQjVELFVBQVUsRUFBRUEsVUFBVTtFQUN0QkMsU0FBUyxFQUFFQSxTQUFTO0VBQ3BCNEQsYUFBYSxFQUFFN0QsVUFBVSxDQUFDOEQsTUFBTSxDQUFFN0QsU0FBVSxDQUFDO0VBQzdDRSxVQUFVLEVBQUVBLFVBQVU7RUFDdEJDLFlBQVksRUFBRUEsWUFBWTtFQUMxQkMsUUFBUSxFQUFFQSxRQUFRO0VBRWxCO0VBQ0EwRCx3QkFBd0IsRUFBRSxJQUFJQyxHQUFHLENBQUUsQ0FDakMsQ0FBRW5FLE9BQU8sRUFBRVEsUUFBUSxDQUFFLEVBQ3JCLENBQUVQLFNBQVMsRUFBRUssVUFBVSxDQUFFLEVBQ3pCLENBQUVKLFdBQVcsRUFBRUssWUFBWSxDQUFFLENBQzdCLENBQUM7RUFHSDtBQUNGO0FBQ0E7RUFDRTZELFVBQVVBLENBQUVDLFFBQXNCLEVBQVk7SUFDNUMsT0FBT3ZELGFBQWEsQ0FBQ3dELGFBQWEsQ0FBRUQsUUFBUSxFQUFFbEUsVUFBVyxDQUFDO0VBQzVELENBQUM7RUFFRDtBQUNGO0FBQ0E7RUFDRW9FLFVBQVVBLENBQUVGLFFBQXNCLEVBQVk7SUFDNUMsT0FBT3ZELGFBQWEsQ0FBQ3NELFVBQVUsQ0FBRUMsUUFBUyxDQUFDLElBQ3BDdkQsYUFBYSxDQUFDd0QsYUFBYSxDQUFFRCxRQUFRLEVBQUUsQ0FDckN2RCxhQUFhLENBQUNPLFdBQVcsRUFDekJQLGFBQWEsQ0FBQ1EsYUFBYSxFQUMzQlIsYUFBYSxDQUFDVSxRQUFRLEVBQ3RCVixhQUFhLENBQUNTLE9BQU8sQ0FDckIsQ0FBQztFQUNaLENBQUM7RUFFRDtBQUNGO0FBQ0E7RUFDRWlELFdBQVdBLENBQUVILFFBQXNCLEVBQVk7SUFDN0MsT0FBT3ZELGFBQWEsQ0FBQ3dELGFBQWEsQ0FBRUQsUUFBUSxFQUFFaEUsV0FBWSxDQUFDO0VBQzdELENBQUM7RUFFRDtBQUNGO0FBQ0E7RUFDRW9FLGlCQUFpQkEsQ0FBRUosUUFBc0IsRUFBa0I7SUFDekQsSUFBS3ZELGFBQWEsQ0FBQzBELFdBQVcsQ0FBRUgsUUFBUyxDQUFDLElBQUlBLFFBQVEsWUFBWUssYUFBYSxFQUFHO01BQ2hGLE9BQU9DLE1BQU0sQ0FBRU4sUUFBUSxDQUFDTyxJQUFJLENBQUNDLE9BQU8sQ0FBRSxPQUFPLEVBQUUsRUFBRyxDQUFFLENBQUM7SUFDdkQ7SUFDQSxPQUFPLElBQUk7RUFDYixDQUFDO0VBRUQ7QUFDRjtBQUNBO0FBQ0E7RUFDRUMsVUFBVUEsQ0FBRVQsUUFBc0IsRUFBWTtJQUM1QyxPQUFPdkQsYUFBYSxDQUFDd0QsYUFBYSxDQUFFRCxRQUFRLEVBQUUvRCxVQUFXLENBQUM7RUFDNUQsQ0FBQztFQUVEO0FBQ0Y7QUFDQTtBQUNBO0VBQ0V5RSxRQUFRQSxDQUFFVixRQUFzQixFQUFZO0lBQzFDLE9BQU92RCxhQUFhLENBQUN3RCxhQUFhLENBQUVELFFBQVEsRUFBRTdELFFBQVMsQ0FBQztFQUMxRCxDQUFDO0VBRUQ7QUFDRjtBQUNBO0FBQ0E7RUFDRXdFLFlBQVlBLENBQUVYLFFBQXNCLEVBQVk7SUFDOUMsT0FBT3ZELGFBQWEsQ0FBQ3dELGFBQWEsQ0FBRUQsUUFBUSxFQUFFOUQsWUFBYSxDQUFDO0VBQzlELENBQUM7RUFFRDtBQUNGO0FBQ0E7RUFDRTBFLFNBQVNBLENBQUVaLFFBQXNCLEVBQVk7SUFDM0MsT0FBT3ZELGFBQWEsQ0FBQ3dELGFBQWEsQ0FBRUQsUUFBUSxFQUFFakUsU0FBVSxDQUFDO0VBQzNELENBQUM7RUFFRDtBQUNGO0FBQ0E7RUFDRThFLGFBQWFBLENBQUViLFFBQXNCLEVBQVk7SUFDL0MsT0FBT3ZELGFBQWEsQ0FBQ3dELGFBQWEsQ0FBRUQsUUFBUSxFQUFFdkQsYUFBYSxDQUFDa0QsYUFBYyxDQUFDO0VBQzdFLENBQUM7RUFFRDtBQUNGO0FBQ0E7RUFDRU0sYUFBYUEsQ0FBRUQsUUFBc0IsRUFBRWMsaUJBQTJCLEVBQVk7SUFDNUU3RyxRQUFRLENBQUUrRixRQUFRLEVBQUUzRCxtQkFBb0IsQ0FBQztJQUN6QyxNQUFNa0UsSUFBSSxHQUFHOUQsYUFBYSxDQUFDc0UsWUFBWSxDQUFFZixRQUFTLENBQUM7SUFDbkQsT0FBT08sSUFBSSxHQUFHTyxpQkFBaUIsQ0FBQ0UsUUFBUSxDQUFFVCxJQUFLLENBQUMsR0FBRyxLQUFLO0VBQzFELENBQUM7RUFFRDtBQUNGO0FBQ0E7RUFDRVUsVUFBVUEsQ0FBRWpCLFFBQXNCLEVBQUVrQixnQkFBd0IsRUFBWTtJQUN0RSxPQUFPekUsYUFBYSxDQUFDc0UsWUFBWSxDQUFFZixRQUFTLENBQUMsS0FBS2tCLGdCQUFnQjtFQUNwRSxDQUFDO0VBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFSCxZQUFZQSxDQUFFZixRQUFzQixFQUFrQjtJQUNwRCxJQUFJbUIsU0FBUyxHQUFHLElBQUk7SUFDcEIsSUFBS25CLFFBQVEsWUFBWUssYUFBYSxJQUFJTCxRQUFRLENBQUNPLElBQUksRUFBRztNQUN4RFksU0FBUyxHQUFHbkIsUUFBUSxDQUFDTyxJQUFJOztNQUV6QjtNQUNBO01BQ0EsSUFBS1ksU0FBUyxDQUFDQyxVQUFVLENBQUUsUUFBUyxDQUFDLElBQUk1RSxhQUFhLENBQUN3RSxRQUFRLENBQUVoQixRQUFRLENBQUNxQixHQUFJLENBQUMsRUFBRztRQUNoRkYsU0FBUyxHQUFHbkIsUUFBUSxDQUFDcUIsR0FBRztNQUMxQjtJQUNGO0lBRUEsT0FBT0YsU0FBUztFQUNsQixDQUFDO0VBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0VHLGFBQWFBLENBQUVELEdBQVcsRUFBWTtJQUNwQyxPQUFPakYsYUFBYSxDQUFDNEUsUUFBUSxDQUFFSyxHQUFJLENBQUM7RUFDdEMsQ0FBQztFQUVEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0VFLGlCQUFpQkEsQ0FBRUMsU0FBaUIsRUFBRWpCLElBQVksRUFBWTtJQUM1RCxNQUFNa0Isc0JBQXNCLEdBQUdoRixhQUFhLENBQUNvRCx3QkFBd0IsQ0FBQzZCLEdBQUcsQ0FBRUYsU0FBVSxDQUFDO0lBQ3RGLElBQUtDLHNCQUFzQixFQUFHO01BQzVCLE9BQU9BLHNCQUFzQixDQUFDVCxRQUFRLENBQUVULElBQUssQ0FBQztJQUNoRCxDQUFDLE1BQ0k7TUFDSCxPQUFPaUIsU0FBUyxLQUFLakIsSUFBSTtJQUMzQjtFQUNGLENBQUM7RUFFRG9CLFFBQVEsRUFBRW5GO0FBQ1osQ0FBQztBQUVELEtBQU0sTUFBTW9GLE1BQU0sSUFBSW5GLGFBQWEsRUFBRztFQUVwQztFQUNBLElBQUtBLGFBQWEsQ0FBQ29GLGNBQWMsQ0FBRUQsTUFBTyxDQUFDLElBQUksT0FBT25GLGFBQWEsQ0FBRW1GLE1BQU0sQ0FBRSxLQUFLLFFBQVEsRUFBRztJQUUzRjtJQUNBcEYsYUFBYSxDQUFDc0YsSUFBSSxDQUFFckYsYUFBYSxDQUFFbUYsTUFBTSxDQUFhLENBQUM7RUFDekQ7QUFDRjtBQUVBMUgsT0FBTyxDQUFDNkgsUUFBUSxDQUFFLGVBQWUsRUFBRXRGLGFBQWMsQ0FBQztBQUVsRCxlQUFlQSxhQUFhIn0=