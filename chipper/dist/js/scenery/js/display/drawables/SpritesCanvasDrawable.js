// Copyright 2019-2022, University of Colorado Boulder

/**
 * Canvas drawable for Sprites nodes.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Poolable from '../../../../phet-core/js/Poolable.js';
import { CanvasSelfDrawable, Imageable, Node, scenery, SpriteInstanceTransformType } from '../../imports.js';
class SpritesCanvasDrawable extends CanvasSelfDrawable {
  /**
   * Paints this drawable to a Canvas (the wrapper contains both a Canvas reference and its drawing context).
   * @public
   *
   * Assumes that the Canvas's context is already in the proper local coordinate frame for the node, and that any
   * other required effects (opacity, clipping, etc.) have already been prepared.
   *
   * This is part of the CanvasSelfDrawable API required to be implemented for subtypes.
   *
   * @param {CanvasContextWrapper} wrapper - Contains the Canvas and its drawing context
   * @param {Node} node - Our node that is being drawn
   * @param {Matrix3} matrix - The transformation matrix applied for this node's coordinate system.
   */
  paintCanvas(wrapper, node, matrix) {
    assert && assert(node instanceof Node);
    const baseMipmapScale = Imageable.getApproximateMatrixScale(matrix) * (window.devicePixelRatio || 1);
    const numInstances = node._spriteInstances.length;
    for (let i = 0; i < numInstances; i++) {
      const spriteInstance = node._spriteInstances[i];
      const spriteImage = spriteInstance.sprite.imageProperty.value;
      const hasOpacity = spriteInstance.alpha !== 1 || spriteImage.imageOpacity !== 1;
      const hasMipmaps = spriteImage._mipmap && spriteImage.hasMipmaps();

      // If it includes opacity, we'll do a context save/restore
      if (hasOpacity) {
        wrapper.context.save();
        wrapper.context.globalAlpha *= spriteInstance.alpha * spriteImage.imageOpacity;
      }

      // If it's a translation only, we can add the offsets to the drawImage call directly (higher performance)
      if (spriteInstance.transformType === SpriteInstanceTransformType.TRANSLATION && matrix.isTranslation()) {
        if (hasMipmaps) {
          const level = spriteImage.getMipmapLevelFromScale(baseMipmapScale, Imageable.CANVAS_MIPMAP_BIAS_ADJUSTMENT);
          const canvas = spriteImage.getMipmapCanvas(level);
          const multiplier = Math.pow(2, level);
          wrapper.context.drawImage(canvas, spriteInstance.matrix.m02() - spriteImage.offset.x, spriteInstance.matrix.m12() - spriteImage.offset.y, canvas.width * multiplier, canvas.height * multiplier);
        } else {
          wrapper.context.drawImage(spriteImage.image, spriteInstance.matrix.m02() - spriteImage.offset.x, spriteInstance.matrix.m12() - spriteImage.offset.y);
        }
      } else {
        wrapper.context.save();
        spriteInstance.matrix.canvasAppendTransform(wrapper.context);
        if (hasMipmaps) {
          const level = spriteImage.getMipmapLevelFromScale(baseMipmapScale * Imageable.getApproximateMatrixScale(spriteInstance.matrix), Imageable.CANVAS_MIPMAP_BIAS_ADJUSTMENT);
          const canvas = spriteImage.getMipmapCanvas(level);
          const multiplier = Math.pow(2, level);
          wrapper.context.drawImage(canvas, -spriteImage.offset.x, -spriteImage.offset.y, canvas.width * multiplier, canvas.height * multiplier);
        } else {
          wrapper.context.drawImage(spriteImage.image, -spriteImage.offset.x, -spriteImage.offset.y);
        }
        wrapper.context.restore();
      }
      if (hasOpacity) {
        wrapper.context.restore();
      }
    }
  }
}
scenery.register('SpritesCanvasDrawable', SpritesCanvasDrawable);
Poolable.mixInto(SpritesCanvasDrawable);
export default SpritesCanvasDrawable;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQb29sYWJsZSIsIkNhbnZhc1NlbGZEcmF3YWJsZSIsIkltYWdlYWJsZSIsIk5vZGUiLCJzY2VuZXJ5IiwiU3ByaXRlSW5zdGFuY2VUcmFuc2Zvcm1UeXBlIiwiU3ByaXRlc0NhbnZhc0RyYXdhYmxlIiwicGFpbnRDYW52YXMiLCJ3cmFwcGVyIiwibm9kZSIsIm1hdHJpeCIsImFzc2VydCIsImJhc2VNaXBtYXBTY2FsZSIsImdldEFwcHJveGltYXRlTWF0cml4U2NhbGUiLCJ3aW5kb3ciLCJkZXZpY2VQaXhlbFJhdGlvIiwibnVtSW5zdGFuY2VzIiwiX3Nwcml0ZUluc3RhbmNlcyIsImxlbmd0aCIsImkiLCJzcHJpdGVJbnN0YW5jZSIsInNwcml0ZUltYWdlIiwic3ByaXRlIiwiaW1hZ2VQcm9wZXJ0eSIsInZhbHVlIiwiaGFzT3BhY2l0eSIsImFscGhhIiwiaW1hZ2VPcGFjaXR5IiwiaGFzTWlwbWFwcyIsIl9taXBtYXAiLCJjb250ZXh0Iiwic2F2ZSIsImdsb2JhbEFscGhhIiwidHJhbnNmb3JtVHlwZSIsIlRSQU5TTEFUSU9OIiwiaXNUcmFuc2xhdGlvbiIsImxldmVsIiwiZ2V0TWlwbWFwTGV2ZWxGcm9tU2NhbGUiLCJDQU5WQVNfTUlQTUFQX0JJQVNfQURKVVNUTUVOVCIsImNhbnZhcyIsImdldE1pcG1hcENhbnZhcyIsIm11bHRpcGxpZXIiLCJNYXRoIiwicG93IiwiZHJhd0ltYWdlIiwibTAyIiwib2Zmc2V0IiwieCIsIm0xMiIsInkiLCJ3aWR0aCIsImhlaWdodCIsImltYWdlIiwiY2FudmFzQXBwZW5kVHJhbnNmb3JtIiwicmVzdG9yZSIsInJlZ2lzdGVyIiwibWl4SW50byJdLCJzb3VyY2VzIjpbIlNwcml0ZXNDYW52YXNEcmF3YWJsZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBDYW52YXMgZHJhd2FibGUgZm9yIFNwcml0ZXMgbm9kZXMuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgUG9vbGFibGUgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL1Bvb2xhYmxlLmpzJztcclxuaW1wb3J0IHsgQ2FudmFzU2VsZkRyYXdhYmxlLCBJbWFnZWFibGUsIE5vZGUsIHNjZW5lcnksIFNwcml0ZUluc3RhbmNlVHJhbnNmb3JtVHlwZSB9IGZyb20gJy4uLy4uL2ltcG9ydHMuanMnO1xyXG5cclxuY2xhc3MgU3ByaXRlc0NhbnZhc0RyYXdhYmxlIGV4dGVuZHMgQ2FudmFzU2VsZkRyYXdhYmxlIHtcclxuICAvKipcclxuICAgKiBQYWludHMgdGhpcyBkcmF3YWJsZSB0byBhIENhbnZhcyAodGhlIHdyYXBwZXIgY29udGFpbnMgYm90aCBhIENhbnZhcyByZWZlcmVuY2UgYW5kIGl0cyBkcmF3aW5nIGNvbnRleHQpLlxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEFzc3VtZXMgdGhhdCB0aGUgQ2FudmFzJ3MgY29udGV4dCBpcyBhbHJlYWR5IGluIHRoZSBwcm9wZXIgbG9jYWwgY29vcmRpbmF0ZSBmcmFtZSBmb3IgdGhlIG5vZGUsIGFuZCB0aGF0IGFueVxyXG4gICAqIG90aGVyIHJlcXVpcmVkIGVmZmVjdHMgKG9wYWNpdHksIGNsaXBwaW5nLCBldGMuKSBoYXZlIGFscmVhZHkgYmVlbiBwcmVwYXJlZC5cclxuICAgKlxyXG4gICAqIFRoaXMgaXMgcGFydCBvZiB0aGUgQ2FudmFzU2VsZkRyYXdhYmxlIEFQSSByZXF1aXJlZCB0byBiZSBpbXBsZW1lbnRlZCBmb3Igc3VidHlwZXMuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge0NhbnZhc0NvbnRleHRXcmFwcGVyfSB3cmFwcGVyIC0gQ29udGFpbnMgdGhlIENhbnZhcyBhbmQgaXRzIGRyYXdpbmcgY29udGV4dFxyXG4gICAqIEBwYXJhbSB7Tm9kZX0gbm9kZSAtIE91ciBub2RlIHRoYXQgaXMgYmVpbmcgZHJhd25cclxuICAgKiBAcGFyYW0ge01hdHJpeDN9IG1hdHJpeCAtIFRoZSB0cmFuc2Zvcm1hdGlvbiBtYXRyaXggYXBwbGllZCBmb3IgdGhpcyBub2RlJ3MgY29vcmRpbmF0ZSBzeXN0ZW0uXHJcbiAgICovXHJcbiAgcGFpbnRDYW52YXMoIHdyYXBwZXIsIG5vZGUsIG1hdHJpeCApIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG5vZGUgaW5zdGFuY2VvZiBOb2RlICk7XHJcblxyXG4gICAgY29uc3QgYmFzZU1pcG1hcFNjYWxlID0gSW1hZ2VhYmxlLmdldEFwcHJveGltYXRlTWF0cml4U2NhbGUoIG1hdHJpeCApICogKCB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxICk7XHJcblxyXG4gICAgY29uc3QgbnVtSW5zdGFuY2VzID0gbm9kZS5fc3ByaXRlSW5zdGFuY2VzLmxlbmd0aDtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IG51bUluc3RhbmNlczsgaSsrICkge1xyXG4gICAgICBjb25zdCBzcHJpdGVJbnN0YW5jZSA9IG5vZGUuX3Nwcml0ZUluc3RhbmNlc1sgaSBdO1xyXG4gICAgICBjb25zdCBzcHJpdGVJbWFnZSA9IHNwcml0ZUluc3RhbmNlLnNwcml0ZS5pbWFnZVByb3BlcnR5LnZhbHVlO1xyXG4gICAgICBjb25zdCBoYXNPcGFjaXR5ID0gc3ByaXRlSW5zdGFuY2UuYWxwaGEgIT09IDEgfHwgc3ByaXRlSW1hZ2UuaW1hZ2VPcGFjaXR5ICE9PSAxO1xyXG4gICAgICBjb25zdCBoYXNNaXBtYXBzID0gc3ByaXRlSW1hZ2UuX21pcG1hcCAmJiBzcHJpdGVJbWFnZS5oYXNNaXBtYXBzKCk7XHJcblxyXG4gICAgICAvLyBJZiBpdCBpbmNsdWRlcyBvcGFjaXR5LCB3ZSdsbCBkbyBhIGNvbnRleHQgc2F2ZS9yZXN0b3JlXHJcbiAgICAgIGlmICggaGFzT3BhY2l0eSApIHtcclxuICAgICAgICB3cmFwcGVyLmNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgIHdyYXBwZXIuY29udGV4dC5nbG9iYWxBbHBoYSAqPSBzcHJpdGVJbnN0YW5jZS5hbHBoYSAqIHNwcml0ZUltYWdlLmltYWdlT3BhY2l0eTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gSWYgaXQncyBhIHRyYW5zbGF0aW9uIG9ubHksIHdlIGNhbiBhZGQgdGhlIG9mZnNldHMgdG8gdGhlIGRyYXdJbWFnZSBjYWxsIGRpcmVjdGx5IChoaWdoZXIgcGVyZm9ybWFuY2UpXHJcbiAgICAgIGlmICggc3ByaXRlSW5zdGFuY2UudHJhbnNmb3JtVHlwZSA9PT0gU3ByaXRlSW5zdGFuY2VUcmFuc2Zvcm1UeXBlLlRSQU5TTEFUSU9OICYmIG1hdHJpeC5pc1RyYW5zbGF0aW9uKCkgKSB7XHJcbiAgICAgICAgaWYgKCBoYXNNaXBtYXBzICkge1xyXG4gICAgICAgICAgY29uc3QgbGV2ZWwgPSBzcHJpdGVJbWFnZS5nZXRNaXBtYXBMZXZlbEZyb21TY2FsZSggYmFzZU1pcG1hcFNjYWxlLCBJbWFnZWFibGUuQ0FOVkFTX01JUE1BUF9CSUFTX0FESlVTVE1FTlQgKTtcclxuICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IHNwcml0ZUltYWdlLmdldE1pcG1hcENhbnZhcyggbGV2ZWwgKTtcclxuICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBNYXRoLnBvdyggMiwgbGV2ZWwgKTtcclxuICAgICAgICAgIHdyYXBwZXIuY29udGV4dC5kcmF3SW1hZ2UoXHJcbiAgICAgICAgICAgIGNhbnZhcyxcclxuICAgICAgICAgICAgc3ByaXRlSW5zdGFuY2UubWF0cml4Lm0wMigpIC0gc3ByaXRlSW1hZ2Uub2Zmc2V0LngsXHJcbiAgICAgICAgICAgIHNwcml0ZUluc3RhbmNlLm1hdHJpeC5tMTIoKSAtIHNwcml0ZUltYWdlLm9mZnNldC55LFxyXG4gICAgICAgICAgICBjYW52YXMud2lkdGggKiBtdWx0aXBsaWVyLFxyXG4gICAgICAgICAgICBjYW52YXMuaGVpZ2h0ICogbXVsdGlwbGllclxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICB3cmFwcGVyLmNvbnRleHQuZHJhd0ltYWdlKFxyXG4gICAgICAgICAgICBzcHJpdGVJbWFnZS5pbWFnZSxcclxuICAgICAgICAgICAgc3ByaXRlSW5zdGFuY2UubWF0cml4Lm0wMigpIC0gc3ByaXRlSW1hZ2Uub2Zmc2V0LngsXHJcbiAgICAgICAgICAgIHNwcml0ZUluc3RhbmNlLm1hdHJpeC5tMTIoKSAtIHNwcml0ZUltYWdlLm9mZnNldC55XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB3cmFwcGVyLmNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgIHNwcml0ZUluc3RhbmNlLm1hdHJpeC5jYW52YXNBcHBlbmRUcmFuc2Zvcm0oIHdyYXBwZXIuY29udGV4dCApO1xyXG5cclxuICAgICAgICBpZiAoIGhhc01pcG1hcHMgKSB7XHJcbiAgICAgICAgICBjb25zdCBsZXZlbCA9IHNwcml0ZUltYWdlLmdldE1pcG1hcExldmVsRnJvbVNjYWxlKCBiYXNlTWlwbWFwU2NhbGUgKiBJbWFnZWFibGUuZ2V0QXBwcm94aW1hdGVNYXRyaXhTY2FsZSggc3ByaXRlSW5zdGFuY2UubWF0cml4ICksIEltYWdlYWJsZS5DQU5WQVNfTUlQTUFQX0JJQVNfQURKVVNUTUVOVCApO1xyXG4gICAgICAgICAgY29uc3QgY2FudmFzID0gc3ByaXRlSW1hZ2UuZ2V0TWlwbWFwQ2FudmFzKCBsZXZlbCApO1xyXG4gICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IE1hdGgucG93KCAyLCBsZXZlbCApO1xyXG4gICAgICAgICAgd3JhcHBlci5jb250ZXh0LmRyYXdJbWFnZShcclxuICAgICAgICAgICAgY2FudmFzLFxyXG4gICAgICAgICAgICAtc3ByaXRlSW1hZ2Uub2Zmc2V0LngsXHJcbiAgICAgICAgICAgIC1zcHJpdGVJbWFnZS5vZmZzZXQueSxcclxuICAgICAgICAgICAgY2FudmFzLndpZHRoICogbXVsdGlwbGllcixcclxuICAgICAgICAgICAgY2FudmFzLmhlaWdodCAqIG11bHRpcGxpZXJcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgd3JhcHBlci5jb250ZXh0LmRyYXdJbWFnZShcclxuICAgICAgICAgICAgc3ByaXRlSW1hZ2UuaW1hZ2UsXHJcbiAgICAgICAgICAgIC1zcHJpdGVJbWFnZS5vZmZzZXQueCxcclxuICAgICAgICAgICAgLXNwcml0ZUltYWdlLm9mZnNldC55XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgd3JhcHBlci5jb250ZXh0LnJlc3RvcmUoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCBoYXNPcGFjaXR5ICkge1xyXG4gICAgICAgIHdyYXBwZXIuY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbnNjZW5lcnkucmVnaXN0ZXIoICdTcHJpdGVzQ2FudmFzRHJhd2FibGUnLCBTcHJpdGVzQ2FudmFzRHJhd2FibGUgKTtcclxuXHJcblBvb2xhYmxlLm1peEludG8oIFNwcml0ZXNDYW52YXNEcmF3YWJsZSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgU3ByaXRlc0NhbnZhc0RyYXdhYmxlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxRQUFRLE1BQU0sc0NBQXNDO0FBQzNELFNBQVNDLGtCQUFrQixFQUFFQyxTQUFTLEVBQUVDLElBQUksRUFBRUMsT0FBTyxFQUFFQywyQkFBMkIsUUFBUSxrQkFBa0I7QUFFNUcsTUFBTUMscUJBQXFCLFNBQVNMLGtCQUFrQixDQUFDO0VBQ3JEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0VNLFdBQVdB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