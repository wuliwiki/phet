// Copyright 2021-2023, University of Colorado Boulder

/**
 * A vertical/horizontal flow-based layout container.
 *
 * See https://phetsims.github.io/scenery/doc/layout#FlowBox for details
 *
 * FlowBox-only options:
 *   - resize (see https://phetsims.github.io/scenery/doc/layout#FlowBox-resize)
 *   - orientation (see https://phetsims.github.io/scenery/doc/layout#FlowBox-orientation)
 *   - spacing (see https://phetsims.github.io/scenery/doc/layout#FlowBox-spacing)
 *   - lineSpacing (see https://phetsims.github.io/scenery/doc/layout#FlowBox-lineSpacing)
 *   - justify (see https://phetsims.github.io/scenery/doc/layout#FlowBox-justify)
 *   - justifyLines (see https://phetsims.github.io/scenery/doc/layout#FlowBox-justifyLines)
 *   - wrap (see https://phetsims.github.io/scenery/doc/layout#FlowBox-wrap)
 *   - layoutOrigin (see https://phetsims.github.io/scenery/doc/layout#layoutOrigin)
 *
 * FlowBox and layoutOptions options (can be set either in the FlowBox itself, or within its child nodes' layoutOptions):
 *   - align (see https://phetsims.github.io/scenery/doc/layout#FlowBox-align)
 *   - stretch (see https://phetsims.github.io/scenery/doc/layout#FlowBox-stretch)
 *   - grow (see https://phetsims.github.io/scenery/doc/layout#FlowBox-grow)
 *   - margin (see https://phetsims.github.io/scenery/doc/layout#FlowBox-margins)
 *   - xMargin (see https://phetsims.github.io/scenery/doc/layout#FlowBox-margins)
 *   - yMargin (see https://phetsims.github.io/scenery/doc/layout#FlowBox-margins)
 *   - leftMargin (see https://phetsims.github.io/scenery/doc/layout#FlowBox-margins)
 *   - rightMargin (see https://phetsims.github.io/scenery/doc/layout#FlowBox-margins)
 *   - topMargin (see https://phetsims.github.io/scenery/doc/layout#FlowBox-margins)
 *   - bottomMargin (see https://phetsims.github.io/scenery/doc/layout#FlowBox-margins)
 *   - minContentWidth (see https://phetsims.github.io/scenery/doc/layout#FlowBox-minContent)
 *   - minContentHeight (see https://phetsims.github.io/scenery/doc/layout#FlowBox-minContent)
 *   - maxContentWidth (see https://phetsims.github.io/scenery/doc/layout#FlowBox-maxContent)
 *   - maxContentHeight (see https://phetsims.github.io/scenery/doc/layout#FlowBox-maxContent)
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import optionize from '../../../../phet-core/js/optionize.js';
import Orientation from '../../../../phet-core/js/Orientation.js';
import { FLOW_CONSTRAINT_OPTION_KEYS, FlowCell, FlowConstraint, LAYOUT_NODE_OPTION_KEYS, LayoutAlign, LayoutNode, MarginLayoutCell, Node, REQUIRES_BOUNDS_OPTION_KEYS, scenery, SceneryConstants, SIZABLE_OPTION_KEYS } from '../../imports.js';

// FlowBox-specific options that can be passed in the constructor or mutate() call.
const FLOWBOX_OPTION_KEYS = [...LAYOUT_NODE_OPTION_KEYS, ...FLOW_CONSTRAINT_OPTION_KEYS.filter(key => key !== 'excludeInvisible')];
const DEFAULT_OPTIONS = {
  orientation: 'horizontal',
  spacing: 0,
  align: 'center',
  stretch: false
};
export default class FlowBox extends LayoutNode {
  // Track the connection between Nodes and cells
  _cellMap = new Map();

  // Listeners that we'll need to remove

  constructor(providedOptions) {
    const options = optionize()({
      // Allow dynamic layout by default, see https://github.com/phetsims/joist/issues/608
      excludeInvisibleChildrenFromBounds: true,
      resize: true,
      // For LayoutBox compatibility
      disabledOpacity: SceneryConstants.DISABLED_OPACITY
    }, providedOptions);
    super();
    this._constraint = new FlowConstraint(this, {
      preferredWidthProperty: this.localPreferredWidthProperty,
      preferredHeightProperty: this.localPreferredHeightProperty,
      minimumWidthProperty: this.localMinimumWidthProperty,
      minimumHeightProperty: this.localMinimumHeightProperty,
      layoutOriginProperty: this.layoutOriginProperty,
      orientation: DEFAULT_OPTIONS.orientation,
      spacing: DEFAULT_OPTIONS.spacing,
      align: DEFAULT_OPTIONS.align,
      stretch: DEFAULT_OPTIONS.stretch,
      excludeInvisible: false // Should be handled by the options mutate below
    });

    this.onChildInserted = this.onFlowBoxChildInserted.bind(this);
    this.onChildRemoved = this.onFlowBoxChildRemoved.bind(this);
    this.onChildrenReordered = this.onFlowBoxChildrenReordered.bind(this);
    this.onChildrenChanged = this.onFlowBoxChildrenChanged.bind(this);
    this.childInsertedEmitter.addListener(this.onChildInserted);
    this.childRemovedEmitter.addListener(this.onChildRemoved);
    this.childrenReorderedEmitter.addListener(this.onChildrenReordered);
    this.childrenChangedEmitter.addListener(this.onChildrenChanged);
    const nonBoundsOptions = _.omit(options, REQUIRES_BOUNDS_OPTION_KEYS);
    const boundsOptions = _.pick(options, REQUIRES_BOUNDS_OPTION_KEYS);

    // Before we do layout, do non-bounds-related changes (in case we have resize:false), and prevent layout for
    // performance gains.
    this._constraint.lock();
    this.mutate(nonBoundsOptions);
    this._constraint.unlock();

    // Update the layout (so that it is done once if we have resize:false)
    this._constraint.updateLayout();

    // After we have our localBounds complete, now we can mutate things that rely on it.
    this.mutate(boundsOptions);
    this.linkLayoutBounds();
  }

  /**
   * Called when a child is inserted.
   */
  onFlowBoxChildInserted(node, index) {
    const cell = new FlowCell(this._constraint, node, this._constraint.createLayoutProxy(node));
    this._cellMap.set(node, cell);
    this._constraint.insertCell(index, cell);
  }

  /**
   * Called when a child is removed.
   */
  onFlowBoxChildRemoved(node) {
    const cell = this._cellMap.get(node);
    assert && assert(cell);
    this._cellMap.delete(node);
    this._constraint.removeCell(cell);
    cell.dispose();
  }

  /**
   * Called when children are rearranged
   */
  onFlowBoxChildrenReordered(minChangeIndex, maxChangeIndex) {
    this._constraint.reorderCells(this._children.slice(minChangeIndex, maxChangeIndex + 1).map(node => this._cellMap.get(node)), minChangeIndex, maxChangeIndex);
  }

  /**
   * Called on change of children (child added, removed, order changed, etc.)
   */
  onFlowBoxChildrenChanged() {
    this._constraint.updateLayoutAutomatically();
  }
  getCell(node) {
    const result = this._cellMap.get(node);
    assert && assert(result);
    return result;
  }
  get orientation() {
    return this._constraint.orientation;
  }
  set orientation(value) {
    this._constraint.orientation = value;
  }
  get spacing() {
    return this._constraint.spacing;
  }
  set spacing(value) {
    this._constraint.spacing = value;
  }
  get lineSpacing() {
    return this._constraint.lineSpacing;
  }
  set lineSpacing(value) {
    this._constraint.lineSpacing = value;
  }
  get justify() {
    return this._constraint.justify;
  }
  set justify(value) {
    this._constraint.justify = value;
  }
  get justifyLines() {
    return this._constraint.justifyLines;
  }
  set justifyLines(value) {
    this._constraint.justifyLines = value;
  }
  get wrap() {
    return this._constraint.wrap;
  }
  set wrap(value) {
    this._constraint.wrap = value;
  }
  get align() {
    assert && assert(typeof this._constraint.align === 'string');
    return this._constraint.align;
  }
  set align(value) {
    this._constraint.align = value;
  }
  get stretch() {
    assert && assert(typeof this._constraint.stretch === 'boolean');
    return this._constraint.stretch;
  }
  set stretch(value) {
    this._constraint.stretch = value;
  }
  get grow() {
    return this._constraint.grow;
  }
  set grow(value) {
    this._constraint.grow = value;
  }
  get margin() {
    return this._constraint.margin;
  }
  set margin(value) {
    this._constraint.margin = value;
  }
  get xMargin() {
    return this._constraint.xMargin;
  }
  set xMargin(value) {
    this._constraint.xMargin = value;
  }
  get yMargin() {
    return this._constraint.yMargin;
  }
  set yMargin(value) {
    this._constraint.yMargin = value;
  }
  get leftMargin() {
    return this._constraint.leftMargin;
  }
  set leftMargin(value) {
    this._constraint.leftMargin = value;
  }
  get rightMargin() {
    return this._constraint.rightMargin;
  }
  set rightMargin(value) {
    this._constraint.rightMargin = value;
  }
  get topMargin() {
    return this._constraint.topMargin;
  }
  set topMargin(value) {
    this._constraint.topMargin = value;
  }
  get bottomMargin() {
    return this._constraint.bottomMargin;
  }
  set bottomMargin(value) {
    this._constraint.bottomMargin = value;
  }
  get minContentWidth() {
    return this._constraint.minContentWidth;
  }
  set minContentWidth(value) {
    this._constraint.minContentWidth = value;
  }
  get minContentHeight() {
    return this._constraint.minContentHeight;
  }
  set minContentHeight(value) {
    this._constraint.minContentHeight = value;
  }
  get maxContentWidth() {
    return this._constraint.maxContentWidth;
  }
  set maxContentWidth(value) {
    this._constraint.maxContentWidth = value;
  }
  get maxContentHeight() {
    return this._constraint.maxContentHeight;
  }
  set maxContentHeight(value) {
    this._constraint.maxContentHeight = value;
  }

  /**
   * Releases references
   */
  dispose() {
    // Lock our layout forever
    this._constraint.lock();
    this.childInsertedEmitter.removeListener(this.onChildInserted);
    this.childRemovedEmitter.removeListener(this.onChildRemoved);
    this.childrenReorderedEmitter.removeListener(this.onChildrenReordered);
    this.childrenChangedEmitter.removeListener(this.onChildrenChanged);

    // Dispose our cells here. We won't be getting the children-removed listeners fired (we removed them above)
    for (const cell of this._cellMap.values()) {
      cell.dispose();
    }
    super.dispose();
  }

  // LayoutBox Compatibility (see the ES5 setters/getters, or the options doc)
  setOrientation(orientation) {
    this.orientation = orientation;
    return this;
  }
  getOrientation() {
    return this.orientation;
  }
  setSpacing(spacing) {
    this.spacing = spacing;
    return this;
  }
  getSpacing() {
    return this.spacing;
  }
  setAlign(align) {
    this.align = align;
    return this;
  }
  getAlign() {
    return this.align;
  }
  setResize(resize) {
    this.resize = resize;
    return this;
  }
  isResize() {
    return this.resize;
  }
  getHelperNode() {
    const marginsNode = MarginLayoutCell.createHelperNode(this.constraint.displayedCells, this.constraint.layoutBoundsProperty.value, cell => {
      let str = '';
      const internalOrientation = Orientation.fromLayoutOrientation(cell.orientation);
      str += `align: ${LayoutAlign.internalToAlign(internalOrientation, cell.effectiveAlign)}\n`;
      str += `stretch: ${cell.effectiveStretch}\n`;
      str += `grow: ${cell.effectiveGrow}\n`;
      return str;
    });
    return marginsNode;
  }
  mutate(options) {
    return super.mutate(options);
  }
  static DEFAULT_FLOW_BOX_OPTIONS = DEFAULT_OPTIONS;
}

/**
 * {Array.<string>} - String keys for all of the allowed options that will be set by node.mutate( options ), in the
 * order they will be evaluated in.
 *
 * NOTE: See Node's _mutatorKeys documentation for more information on how this operates, and potential special
 *       cases that may apply.
 */
FlowBox.prototype._mutatorKeys = [...SIZABLE_OPTION_KEYS, ...FLOWBOX_OPTION_KEYS, ...Node.prototype._mutatorKeys];
scenery.register('FlowBox', FlowBox);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25pemUiLCJPcmllbnRhdGlvbiIsIkZMT1dfQ09OU1RSQUlOVF9PUFRJT05fS0VZUyIsIkZsb3dDZWxsIiwiRmxvd0NvbnN0cmFpbnQiLCJMQVlPVVRfTk9ERV9PUFRJT05fS0VZUyIsIkxheW91dEFsaWduIiwiTGF5b3V0Tm9kZSIsIk1hcmdpbkxheW91dENlbGwiLCJOb2RlIiwiUkVRVUlSRVNfQk9VTkRTX09QVElPTl9LRVlTIiwic2NlbmVyeSIsIlNjZW5lcnlDb25zdGFudHMiLCJTSVpBQkxFX09QVElPTl9LRVlTIiwiRkxPV0JPWF9PUFRJT05fS0VZUyIsImZpbHRlciIsImtleSIsIkRFRkFVTFRfT1BUSU9OUyIsIm9yaWVudGF0aW9uIiwic3BhY2luZyIsImFsaWduIiwic3RyZXRjaCIsIkZsb3dCb3giLCJfY2VsbE1hcCIsIk1hcCIsImNvbnN0cnVjdG9yIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsImV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHMiLCJyZXNpemUiLCJkaXNhYmxlZE9wYWNpdHkiLCJESVNBQkxFRF9PUEFDSVRZIiwiX2NvbnN0cmFpbnQiLCJwcmVmZXJyZWRXaWR0aFByb3BlcnR5IiwibG9jYWxQcmVmZXJyZWRXaWR0aFByb3BlcnR5IiwicHJlZmVycmVkSGVpZ2h0UHJvcGVydHkiLCJsb2NhbFByZWZlcnJlZEhlaWdodFByb3BlcnR5IiwibWluaW11bVdpZHRoUHJvcGVydHkiLCJsb2NhbE1pbmltdW1XaWR0aFByb3BlcnR5IiwibWluaW11bUhlaWdodFByb3BlcnR5IiwibG9jYWxNaW5pbXVtSGVpZ2h0UHJvcGVydHkiLCJsYXlvdXRPcmlnaW5Qcm9wZXJ0eSIsImV4Y2x1ZGVJbnZpc2libGUiLCJvbkNoaWxkSW5zZXJ0ZWQiLCJvbkZsb3dCb3hDaGlsZEluc2VydGVkIiwiYmluZCIsIm9uQ2hpbGRSZW1vdmVkIiwib25GbG93Qm94Q2hpbGRSZW1vdmVkIiwib25DaGlsZHJlblJlb3JkZXJlZCIsIm9uRmxvd0JveENoaWxkcmVuUmVvcmRlcmVkIiwib25DaGlsZHJlbkNoYW5nZWQiLCJvbkZsb3dCb3hDaGlsZHJlbkNoYW5nZWQiLCJjaGlsZEluc2VydGVkRW1pdHRlciIsImFkZExpc3RlbmVyIiwiY2hpbGRSZW1vdmVkRW1pdHRlciIsImNoaWxkcmVuUmVvcmRlcmVkRW1pdHRlciIsImNoaWxkcmVuQ2hhbmdlZEVtaXR0ZXIiLCJub25Cb3VuZHNPcHRpb25zIiwiXyIsIm9taXQiLCJib3VuZHNPcHRpb25zIiwicGljayIsImxvY2siLCJtdXRhdGUiLCJ1bmxvY2siLCJ1cGRhdGVMYXlvdXQiLCJsaW5rTGF5b3V0Qm91bmRzIiwibm9kZSIsImluZGV4IiwiY2VsbCIsImNyZWF0ZUxheW91dFByb3h5Iiwic2V0IiwiaW5zZXJ0Q2VsbCIsImdldCIsImFzc2VydCIsImRlbGV0ZSIsInJlbW92ZUNlbGwiLCJkaXNwb3NlIiwibWluQ2hhbmdlSW5kZXgiLCJtYXhDaGFuZ2VJbmRleCIsInJlb3JkZXJDZWxscyIsIl9jaGlsZHJlbiIsInNsaWNlIiwibWFwIiwidXBkYXRlTGF5b3V0QXV0b21hdGljYWxseSIsImdldENlbGwiLCJyZXN1bHQiLCJ2YWx1ZSIsImxpbmVTcGFjaW5nIiwianVzdGlmeSIsImp1c3RpZnlMaW5lcyIsIndyYXAiLCJncm93IiwibWFyZ2luIiwieE1hcmdpbiIsInlNYXJnaW4iLCJsZWZ0TWFyZ2luIiwicmlnaHRNYXJnaW4iLCJ0b3BNYXJnaW4iLCJib3R0b21NYXJnaW4iLCJtaW5Db250ZW50V2lkdGgiLCJtaW5Db250ZW50SGVpZ2h0IiwibWF4Q29udGVudFdpZHRoIiwibWF4Q29udGVudEhlaWdodCIsInJlbW92ZUxpc3RlbmVyIiwidmFsdWVzIiwic2V0T3JpZW50YXRpb24iLCJnZXRPcmllbnRhdGlvbiIsInNldFNwYWNpbmciLCJnZXRTcGFjaW5nIiwic2V0QWxpZ24iLCJnZXRBbGlnbiIsInNldFJlc2l6ZSIsImlzUmVzaXplIiwiZ2V0SGVscGVyTm9kZSIsIm1hcmdpbnNOb2RlIiwiY3JlYXRlSGVscGVyTm9kZSIsImNvbnN0cmFpbnQiLCJkaXNwbGF5ZWRDZWxscyIsImxheW91dEJvdW5kc1Byb3BlcnR5Iiwic3RyIiwiaW50ZXJuYWxPcmllbnRhdGlvbiIsImZyb21MYXlvdXRPcmllbnRhdGlvbiIsImludGVybmFsVG9BbGlnbiIsImVmZmVjdGl2ZUFsaWduIiwiZWZmZWN0aXZlU3RyZXRjaCIsImVmZmVjdGl2ZUdyb3ciLCJERUZBVUxUX0ZMT1dfQk9YX09QVElPTlMiLCJwcm90b3R5cGUiLCJfbXV0YXRvcktleXMiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkZsb3dCb3gudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjEtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQSB2ZXJ0aWNhbC9ob3Jpem9udGFsIGZsb3ctYmFzZWQgbGF5b3V0IGNvbnRhaW5lci5cclxuICpcclxuICogU2VlIGh0dHBzOi8vcGhldHNpbXMuZ2l0aHViLmlvL3NjZW5lcnkvZG9jL2xheW91dCNGbG93Qm94IGZvciBkZXRhaWxzXHJcbiAqXHJcbiAqIEZsb3dCb3gtb25seSBvcHRpb25zOlxyXG4gKiAgIC0gcmVzaXplIChzZWUgaHR0cHM6Ly9waGV0c2ltcy5naXRodWIuaW8vc2NlbmVyeS9kb2MvbGF5b3V0I0Zsb3dCb3gtcmVzaXplKVxyXG4gKiAgIC0gb3JpZW50YXRpb24gKHNlZSBodHRwczovL3BoZXRzaW1zLmdpdGh1Yi5pby9zY2VuZXJ5L2RvYy9sYXlvdXQjRmxvd0JveC1vcmllbnRhdGlvbilcclxuICogICAtIHNwYWNpbmcgKHNlZSBodHRwczovL3BoZXRzaW1zLmdpdGh1Yi5pby9zY2VuZXJ5L2RvYy9sYXlvdXQjRmxvd0JveC1zcGFjaW5nKVxyXG4gKiAgIC0gbGluZVNwYWNpbmcgKHNlZSBodHRwczovL3BoZXRzaW1zLmdpdGh1Yi5pby9zY2VuZXJ5L2RvYy9sYXlvdXQjRmxvd0JveC1saW5lU3BhY2luZylcclxuICogICAtIGp1c3RpZnkgKHNlZSBodHRwczovL3BoZXRzaW1zLmdpdGh1Yi5pby9zY2VuZXJ5L2RvYy9sYXlvdXQjRmxvd0JveC1qdXN0aWZ5KVxyXG4gKiAgIC0ganVzdGlmeUxpbmVzIChzZWUgaHR0cHM6Ly9waGV0c2ltcy5naXRodWIuaW8vc2NlbmVyeS9kb2MvbGF5b3V0I0Zsb3dCb3gtanVzdGlmeUxpbmVzKVxyXG4gKiAgIC0gd3JhcCAoc2VlIGh0dHBzOi8vcGhldHNpbXMuZ2l0aHViLmlvL3NjZW5lcnkvZG9jL2xheW91dCNGbG93Qm94LXdyYXApXHJcbiAqICAgLSBsYXlvdXRPcmlnaW4gKHNlZSBodHRwczovL3BoZXRzaW1zLmdpdGh1Yi5pby9zY2VuZXJ5L2RvYy9sYXlvdXQjbGF5b3V0T3JpZ2luKVxyXG4gKlxyXG4gKiBGbG93Qm94IGFuZCBsYXlvdXRPcHRpb25zIG9wdGlvbnMgKGNhbiBiZSBzZXQgZWl0aGVyIGluIHRoZSBGbG93Qm94IGl0c2VsZiwgb3Igd2l0aGluIGl0cyBjaGlsZCBub2RlcycgbGF5b3V0T3B0aW9ucyk6XHJcbiAqICAgLSBhbGlnbiAoc2VlIGh0dHBzOi8vcGhldHNpbXMuZ2l0aHViLmlvL3NjZW5lcnkvZG9jL2xheW91dCNGbG93Qm94LWFsaWduKVxyXG4gKiAgIC0gc3RyZXRjaCAoc2VlIGh0dHBzOi8vcGhldHNpbXMuZ2l0aHViLmlvL3NjZW5lcnkvZG9jL2xheW91dCNGbG93Qm94LXN0cmV0Y2gpXHJcbiAqICAgLSBncm93IChzZWUgaHR0cHM6Ly9waGV0c2ltcy5naXRodWIuaW8vc2NlbmVyeS9kb2MvbGF5b3V0I0Zsb3dCb3gtZ3JvdylcclxuICogICAtIG1hcmdpbiAoc2VlIGh0dHBzOi8vcGhldHNpbXMuZ2l0aHViLmlvL3NjZW5lcnkvZG9jL2xheW91dCNGbG93Qm94LW1hcmdpbnMpXHJcbiAqICAgLSB4TWFyZ2luIChzZWUgaHR0cHM6Ly9waGV0c2ltcy5naXRodWIuaW8vc2NlbmVyeS9kb2MvbGF5b3V0I0Zsb3dCb3gtbWFyZ2lucylcclxuICogICAtIHlNYXJnaW4gKHNlZSBodHRwczovL3BoZXRzaW1zLmdpdGh1Yi5pby9zY2VuZXJ5L2RvYy9sYXlvdXQjRmxvd0JveC1tYXJnaW5zKVxyXG4gKiAgIC0gbGVmdE1hcmdpbiAoc2VlIGh0dHBzOi8vcGhldHNpbXMuZ2l0aHViLmlvL3NjZW5lcnkvZG9jL2xheW91dCNGbG93Qm94LW1hcmdpbnMpXHJcbiAqICAgLSByaWdodE1hcmdpbiAoc2VlIGh0dHBzOi8vcGhldHNpbXMuZ2l0aHViLmlvL3NjZW5lcnkvZG9jL2xheW91dCNGbG93Qm94LW1hcmdpbnMpXHJcbiAqICAgLSB0b3BNYXJnaW4gKHNlZSBodHRwczovL3BoZXRzaW1zLmdpdGh1Yi5pby9zY2VuZXJ5L2RvYy9sYXlvdXQjRmxvd0JveC1tYXJnaW5zKVxyXG4gKiAgIC0gYm90dG9tTWFyZ2luIChzZWUgaHR0cHM6Ly9waGV0c2ltcy5naXRodWIuaW8vc2NlbmVyeS9kb2MvbGF5b3V0I0Zsb3dCb3gtbWFyZ2lucylcclxuICogICAtIG1pbkNvbnRlbnRXaWR0aCAoc2VlIGh0dHBzOi8vcGhldHNpbXMuZ2l0aHViLmlvL3NjZW5lcnkvZG9jL2xheW91dCNGbG93Qm94LW1pbkNvbnRlbnQpXHJcbiAqICAgLSBtaW5Db250ZW50SGVpZ2h0IChzZWUgaHR0cHM6Ly9waGV0c2ltcy5naXRodWIuaW8vc2NlbmVyeS9kb2MvbGF5b3V0I0Zsb3dCb3gtbWluQ29udGVudClcclxuICogICAtIG1heENvbnRlbnRXaWR0aCAoc2VlIGh0dHBzOi8vcGhldHNpbXMuZ2l0aHViLmlvL3NjZW5lcnkvZG9jL2xheW91dCNGbG93Qm94LW1heENvbnRlbnQpXHJcbiAqICAgLSBtYXhDb250ZW50SGVpZ2h0IChzZWUgaHR0cHM6Ly9waGV0c2ltcy5naXRodWIuaW8vc2NlbmVyeS9kb2MvbGF5b3V0I0Zsb3dCb3gtbWF4Q29udGVudClcclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBPcmllbnRhdGlvbiBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvT3JpZW50YXRpb24uanMnO1xyXG5pbXBvcnQgU3RyaWN0T21pdCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvU3RyaWN0T21pdC5qcyc7XHJcbmltcG9ydCB7IEZMT1dfQ09OU1RSQUlOVF9PUFRJT05fS0VZUywgRmxvd0NlbGwsIEZsb3dDb25zdHJhaW50LCBGbG93Q29uc3RyYWludE9wdGlvbnMsIEhvcml6b250YWxMYXlvdXRBbGlnbiwgSG9yaXpvbnRhbExheW91dEp1c3RpZmljYXRpb24sIExBWU9VVF9OT0RFX09QVElPTl9LRVlTLCBMYXlvdXRBbGlnbiwgTGF5b3V0Tm9kZSwgTGF5b3V0Tm9kZU9wdGlvbnMsIExheW91dE9yaWVudGF0aW9uLCBNYXJnaW5MYXlvdXRDZWxsLCBOb2RlLCBSRVFVSVJFU19CT1VORFNfT1BUSU9OX0tFWVMsIHNjZW5lcnksIFNjZW5lcnlDb25zdGFudHMsIFNJWkFCTEVfT1BUSU9OX0tFWVMsIFZlcnRpY2FsTGF5b3V0QWxpZ24sIFZlcnRpY2FsTGF5b3V0SnVzdGlmaWNhdGlvbiB9IGZyb20gJy4uLy4uL2ltcG9ydHMuanMnO1xyXG5cclxuLy8gRmxvd0JveC1zcGVjaWZpYyBvcHRpb25zIHRoYXQgY2FuIGJlIHBhc3NlZCBpbiB0aGUgY29uc3RydWN0b3Igb3IgbXV0YXRlKCkgY2FsbC5cclxuY29uc3QgRkxPV0JPWF9PUFRJT05fS0VZUyA9IFtcclxuICAuLi5MQVlPVVRfTk9ERV9PUFRJT05fS0VZUyxcclxuICAuLi5GTE9XX0NPTlNUUkFJTlRfT1BUSU9OX0tFWVMuZmlsdGVyKCBrZXkgPT4ga2V5ICE9PSAnZXhjbHVkZUludmlzaWJsZScgKVxyXG5dO1xyXG5cclxuY29uc3QgREVGQVVMVF9PUFRJT05TID0ge1xyXG4gIG9yaWVudGF0aW9uOiAnaG9yaXpvbnRhbCcsXHJcbiAgc3BhY2luZzogMCxcclxuICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgc3RyZXRjaDogZmFsc2VcclxufSBhcyBjb25zdDtcclxuXHJcbnR5cGUgRXhjbHVkZUZsb3dDb25zdHJhaW50T3B0aW9ucyA9ICdleGNsdWRlSW52aXNpYmxlJyB8ICdwcmVmZXJyZWRXaWR0aFByb3BlcnR5JyB8ICdwcmVmZXJyZWRIZWlnaHRQcm9wZXJ0eScgfCAnbWluaW11bVdpZHRoUHJvcGVydHknIHwgJ21pbmltdW1IZWlnaHRQcm9wZXJ0eScgfCAnbGF5b3V0T3JpZ2luUHJvcGVydHknO1xyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIC8vIENvbnRyb2xzIHdoZXRoZXIgdGhlIEZsb3dCb3ggd2lsbCByZS10cmlnZ2VyIGxheW91dCBhdXRvbWF0aWNhbGx5IGFmdGVyIHRoZSBcImZpcnN0XCIgbGF5b3V0IGR1cmluZyBjb25zdHJ1Y3Rpb24uXHJcbiAgLy8gVGhlIEZsb3dCb3ggd2lsbCBsYXlvdXQgb25jZSBhZnRlciBwcm9jZXNzaW5nIHRoZSBvcHRpb25zIG9iamVjdCwgYnV0IGlmIHJlc2l6ZTpmYWxzZSwgdGhlbiBhZnRlciB0aGF0IG1hbnVhbFxyXG4gIC8vIGxheW91dCBjYWxscyB3aWxsIG5lZWQgdG8gYmUgZG9uZSAod2l0aCB1cGRhdGVMYXlvdXQoKSlcclxuICByZXNpemU/OiBib29sZWFuO1xyXG59ICYgU3RyaWN0T21pdDxGbG93Q29uc3RyYWludE9wdGlvbnMsIEV4Y2x1ZGVGbG93Q29uc3RyYWludE9wdGlvbnM+O1xyXG5cclxuZXhwb3J0IHR5cGUgRmxvd0JveE9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIExheW91dE5vZGVPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmxvd0JveCBleHRlbmRzIExheW91dE5vZGU8Rmxvd0NvbnN0cmFpbnQ+IHtcclxuXHJcbiAgLy8gVHJhY2sgdGhlIGNvbm5lY3Rpb24gYmV0d2VlbiBOb2RlcyBhbmQgY2VsbHNcclxuICBwcml2YXRlIHJlYWRvbmx5IF9jZWxsTWFwOiBNYXA8Tm9kZSwgRmxvd0NlbGw+ID0gbmV3IE1hcDxOb2RlLCBGbG93Q2VsbD4oKTtcclxuXHJcbiAgLy8gTGlzdGVuZXJzIHRoYXQgd2UnbGwgbmVlZCB0byByZW1vdmVcclxuICBwcml2YXRlIHJlYWRvbmx5IG9uQ2hpbGRJbnNlcnRlZDogKCBub2RlOiBOb2RlLCBpbmRleDogbnVtYmVyICkgPT4gdm9pZDtcclxuICBwcml2YXRlIHJlYWRvbmx5IG9uQ2hpbGRSZW1vdmVkOiAoIG5vZGU6IE5vZGUgKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgb25DaGlsZHJlblJlb3JkZXJlZDogKCBtaW5DaGFuZ2VJbmRleDogbnVtYmVyLCBtYXhDaGFuZ2VJbmRleDogbnVtYmVyICkgPT4gdm9pZDtcclxuICBwcml2YXRlIHJlYWRvbmx5IG9uQ2hpbGRyZW5DaGFuZ2VkOiAoKSA9PiB2b2lkO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3ZpZGVkT3B0aW9ucz86IEZsb3dCb3hPcHRpb25zICkge1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxGbG93Qm94T3B0aW9ucywgU3RyaWN0T21pdDxTZWxmT3B0aW9ucywgRXhjbHVkZTxrZXlvZiBGbG93Q29uc3RyYWludE9wdGlvbnMsIEV4Y2x1ZGVGbG93Q29uc3RyYWludE9wdGlvbnM+PiwgTGF5b3V0Tm9kZU9wdGlvbnM+KCkoIHtcclxuICAgICAgLy8gQWxsb3cgZHluYW1pYyBsYXlvdXQgYnkgZGVmYXVsdCwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9qb2lzdC9pc3N1ZXMvNjA4XHJcbiAgICAgIGV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHM6IHRydWUsXHJcbiAgICAgIHJlc2l6ZTogdHJ1ZSxcclxuXHJcbiAgICAgIC8vIEZvciBMYXlvdXRCb3ggY29tcGF0aWJpbGl0eVxyXG4gICAgICBkaXNhYmxlZE9wYWNpdHk6IFNjZW5lcnlDb25zdGFudHMuRElTQUJMRURfT1BBQ0lUWVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICB0aGlzLl9jb25zdHJhaW50ID0gbmV3IEZsb3dDb25zdHJhaW50KCB0aGlzLCB7XHJcbiAgICAgIHByZWZlcnJlZFdpZHRoUHJvcGVydHk6IHRoaXMubG9jYWxQcmVmZXJyZWRXaWR0aFByb3BlcnR5LFxyXG4gICAgICBwcmVmZXJyZWRIZWlnaHRQcm9wZXJ0eTogdGhpcy5sb2NhbFByZWZlcnJlZEhlaWdodFByb3BlcnR5LFxyXG4gICAgICBtaW5pbXVtV2lkdGhQcm9wZXJ0eTogdGhpcy5sb2NhbE1pbmltdW1XaWR0aFByb3BlcnR5LFxyXG4gICAgICBtaW5pbXVtSGVpZ2h0UHJvcGVydHk6IHRoaXMubG9jYWxNaW5pbXVtSGVpZ2h0UHJvcGVydHksXHJcbiAgICAgIGxheW91dE9yaWdpblByb3BlcnR5OiB0aGlzLmxheW91dE9yaWdpblByb3BlcnR5LFxyXG5cclxuICAgICAgb3JpZW50YXRpb246IERFRkFVTFRfT1BUSU9OUy5vcmllbnRhdGlvbixcclxuICAgICAgc3BhY2luZzogREVGQVVMVF9PUFRJT05TLnNwYWNpbmcsXHJcbiAgICAgIGFsaWduOiBERUZBVUxUX09QVElPTlMuYWxpZ24sXHJcbiAgICAgIHN0cmV0Y2g6IERFRkFVTFRfT1BUSU9OUy5zdHJldGNoLFxyXG4gICAgICBleGNsdWRlSW52aXNpYmxlOiBmYWxzZSAvLyBTaG91bGQgYmUgaGFuZGxlZCBieSB0aGUgb3B0aW9ucyBtdXRhdGUgYmVsb3dcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLm9uQ2hpbGRJbnNlcnRlZCA9IHRoaXMub25GbG93Qm94Q2hpbGRJbnNlcnRlZC5iaW5kKCB0aGlzICk7XHJcbiAgICB0aGlzLm9uQ2hpbGRSZW1vdmVkID0gdGhpcy5vbkZsb3dCb3hDaGlsZFJlbW92ZWQuYmluZCggdGhpcyApO1xyXG4gICAgdGhpcy5vbkNoaWxkcmVuUmVvcmRlcmVkID0gdGhpcy5vbkZsb3dCb3hDaGlsZHJlblJlb3JkZXJlZC5iaW5kKCB0aGlzICk7XHJcbiAgICB0aGlzLm9uQ2hpbGRyZW5DaGFuZ2VkID0gdGhpcy5vbkZsb3dCb3hDaGlsZHJlbkNoYW5nZWQuYmluZCggdGhpcyApO1xyXG5cclxuICAgIHRoaXMuY2hpbGRJbnNlcnRlZEVtaXR0ZXIuYWRkTGlzdGVuZXIoIHRoaXMub25DaGlsZEluc2VydGVkICk7XHJcbiAgICB0aGlzLmNoaWxkUmVtb3ZlZEVtaXR0ZXIuYWRkTGlzdGVuZXIoIHRoaXMub25DaGlsZFJlbW92ZWQgKTtcclxuICAgIHRoaXMuY2hpbGRyZW5SZW9yZGVyZWRFbWl0dGVyLmFkZExpc3RlbmVyKCB0aGlzLm9uQ2hpbGRyZW5SZW9yZGVyZWQgKTtcclxuICAgIHRoaXMuY2hpbGRyZW5DaGFuZ2VkRW1pdHRlci5hZGRMaXN0ZW5lciggdGhpcy5vbkNoaWxkcmVuQ2hhbmdlZCApO1xyXG5cclxuICAgIGNvbnN0IG5vbkJvdW5kc09wdGlvbnMgPSBfLm9taXQoIG9wdGlvbnMsIFJFUVVJUkVTX0JPVU5EU19PUFRJT05fS0VZUyApIGFzIExheW91dE5vZGVPcHRpb25zO1xyXG4gICAgY29uc3QgYm91bmRzT3B0aW9ucyA9IF8ucGljayggb3B0aW9ucywgUkVRVUlSRVNfQk9VTkRTX09QVElPTl9LRVlTICkgYXMgTGF5b3V0Tm9kZU9wdGlvbnM7XHJcblxyXG4gICAgLy8gQmVmb3JlIHdlIGRvIGxheW91dCwgZG8gbm9uLWJvdW5kcy1yZWxhdGVkIGNoYW5nZXMgKGluIGNhc2Ugd2UgaGF2ZSByZXNpemU6ZmFsc2UpLCBhbmQgcHJldmVudCBsYXlvdXQgZm9yXHJcbiAgICAvLyBwZXJmb3JtYW5jZSBnYWlucy5cclxuICAgIHRoaXMuX2NvbnN0cmFpbnQubG9jaygpO1xyXG4gICAgdGhpcy5tdXRhdGUoIG5vbkJvdW5kc09wdGlvbnMgKTtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQudW5sb2NrKCk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHRoZSBsYXlvdXQgKHNvIHRoYXQgaXQgaXMgZG9uZSBvbmNlIGlmIHdlIGhhdmUgcmVzaXplOmZhbHNlKVxyXG4gICAgdGhpcy5fY29uc3RyYWludC51cGRhdGVMYXlvdXQoKTtcclxuXHJcbiAgICAvLyBBZnRlciB3ZSBoYXZlIG91ciBsb2NhbEJvdW5kcyBjb21wbGV0ZSwgbm93IHdlIGNhbiBtdXRhdGUgdGhpbmdzIHRoYXQgcmVseSBvbiBpdC5cclxuICAgIHRoaXMubXV0YXRlKCBib3VuZHNPcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5saW5rTGF5b3V0Qm91bmRzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxsZWQgd2hlbiBhIGNoaWxkIGlzIGluc2VydGVkLlxyXG4gICAqL1xyXG4gIHByb3RlY3RlZCBvbkZsb3dCb3hDaGlsZEluc2VydGVkKCBub2RlOiBOb2RlLCBpbmRleDogbnVtYmVyICk6IHZvaWQge1xyXG4gICAgY29uc3QgY2VsbCA9IG5ldyBGbG93Q2VsbCggdGhpcy5fY29uc3RyYWludCwgbm9kZSwgdGhpcy5fY29uc3RyYWludC5jcmVhdGVMYXlvdXRQcm94eSggbm9kZSApICk7XHJcbiAgICB0aGlzLl9jZWxsTWFwLnNldCggbm9kZSwgY2VsbCApO1xyXG5cclxuICAgIHRoaXMuX2NvbnN0cmFpbnQuaW5zZXJ0Q2VsbCggaW5kZXgsIGNlbGwgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGxlZCB3aGVuIGEgY2hpbGQgaXMgcmVtb3ZlZC5cclxuICAgKi9cclxuICBwcml2YXRlIG9uRmxvd0JveENoaWxkUmVtb3ZlZCggbm9kZTogTm9kZSApOiB2b2lkIHtcclxuXHJcbiAgICBjb25zdCBjZWxsID0gdGhpcy5fY2VsbE1hcC5nZXQoIG5vZGUgKSE7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBjZWxsICk7XHJcblxyXG4gICAgdGhpcy5fY2VsbE1hcC5kZWxldGUoIG5vZGUgKTtcclxuXHJcbiAgICB0aGlzLl9jb25zdHJhaW50LnJlbW92ZUNlbGwoIGNlbGwgKTtcclxuXHJcbiAgICBjZWxsLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGxlZCB3aGVuIGNoaWxkcmVuIGFyZSByZWFycmFuZ2VkXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBvbkZsb3dCb3hDaGlsZHJlblJlb3JkZXJlZCggbWluQ2hhbmdlSW5kZXg6IG51bWJlciwgbWF4Q2hhbmdlSW5kZXg6IG51bWJlciApOiB2b2lkIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQucmVvcmRlckNlbGxzKFxyXG4gICAgICB0aGlzLl9jaGlsZHJlbi5zbGljZSggbWluQ2hhbmdlSW5kZXgsIG1heENoYW5nZUluZGV4ICsgMSApLm1hcCggbm9kZSA9PiB0aGlzLl9jZWxsTWFwLmdldCggbm9kZSApISApLFxyXG4gICAgICBtaW5DaGFuZ2VJbmRleCxcclxuICAgICAgbWF4Q2hhbmdlSW5kZXhcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxsZWQgb24gY2hhbmdlIG9mIGNoaWxkcmVuIChjaGlsZCBhZGRlZCwgcmVtb3ZlZCwgb3JkZXIgY2hhbmdlZCwgZXRjLilcclxuICAgKi9cclxuICBwcml2YXRlIG9uRmxvd0JveENoaWxkcmVuQ2hhbmdlZCgpOiB2b2lkIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQudXBkYXRlTGF5b3V0QXV0b21hdGljYWxseSgpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldENlbGwoIG5vZGU6IE5vZGUgKTogRmxvd0NlbGwge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5fY2VsbE1hcC5nZXQoIG5vZGUgKSE7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCByZXN1bHQgKTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBvcmllbnRhdGlvbigpOiBMYXlvdXRPcmllbnRhdGlvbiB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludC5vcmllbnRhdGlvbjtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgb3JpZW50YXRpb24oIHZhbHVlOiBMYXlvdXRPcmllbnRhdGlvbiApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQub3JpZW50YXRpb24gPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgc3BhY2luZygpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuX2NvbnN0cmFpbnQuc3BhY2luZztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgc3BhY2luZyggdmFsdWU6IG51bWJlciApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQuc3BhY2luZyA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBsaW5lU3BhY2luZygpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuX2NvbnN0cmFpbnQubGluZVNwYWNpbmc7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0IGxpbmVTcGFjaW5nKCB2YWx1ZTogbnVtYmVyICkge1xyXG4gICAgdGhpcy5fY29uc3RyYWludC5saW5lU3BhY2luZyA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBqdXN0aWZ5KCk6IEhvcml6b250YWxMYXlvdXRKdXN0aWZpY2F0aW9uIHwgVmVydGljYWxMYXlvdXRKdXN0aWZpY2F0aW9uIHtcclxuICAgIHJldHVybiB0aGlzLl9jb25zdHJhaW50Lmp1c3RpZnk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0IGp1c3RpZnkoIHZhbHVlOiBIb3Jpem9udGFsTGF5b3V0SnVzdGlmaWNhdGlvbiB8IFZlcnRpY2FsTGF5b3V0SnVzdGlmaWNhdGlvbiApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQuanVzdGlmeSA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBqdXN0aWZ5TGluZXMoKTogSG9yaXpvbnRhbExheW91dEp1c3RpZmljYXRpb24gfCBWZXJ0aWNhbExheW91dEp1c3RpZmljYXRpb24gfCBudWxsIHtcclxuICAgIHJldHVybiB0aGlzLl9jb25zdHJhaW50Lmp1c3RpZnlMaW5lcztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQganVzdGlmeUxpbmVzKCB2YWx1ZTogSG9yaXpvbnRhbExheW91dEp1c3RpZmljYXRpb24gfCBWZXJ0aWNhbExheW91dEp1c3RpZmljYXRpb24gfCBudWxsICkge1xyXG4gICAgdGhpcy5fY29uc3RyYWludC5qdXN0aWZ5TGluZXMgPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgd3JhcCgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLl9jb25zdHJhaW50LndyYXA7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0IHdyYXAoIHZhbHVlOiBib29sZWFuICkge1xyXG4gICAgdGhpcy5fY29uc3RyYWludC53cmFwID0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGFsaWduKCk6IEhvcml6b250YWxMYXlvdXRBbGlnbiB8IFZlcnRpY2FsTGF5b3V0QWxpZ24ge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdHlwZW9mIHRoaXMuX2NvbnN0cmFpbnQuYWxpZ24gPT09ICdzdHJpbmcnICk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NvbnN0cmFpbnQuYWxpZ24hO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldCBhbGlnbiggdmFsdWU6IEhvcml6b250YWxMYXlvdXRBbGlnbiB8IFZlcnRpY2FsTGF5b3V0QWxpZ24gKSB7XHJcbiAgICB0aGlzLl9jb25zdHJhaW50LmFsaWduID0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHN0cmV0Y2goKTogYm9vbGVhbiB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2YgdGhpcy5fY29uc3RyYWludC5zdHJldGNoID09PSAnYm9vbGVhbicgKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludC5zdHJldGNoITtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgc3RyZXRjaCggdmFsdWU6IGJvb2xlYW4gKSB7XHJcbiAgICB0aGlzLl9jb25zdHJhaW50LnN0cmV0Y2ggPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgZ3JvdygpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuX2NvbnN0cmFpbnQuZ3JvdyE7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0IGdyb3coIHZhbHVlOiBudW1iZXIgKSB7XHJcbiAgICB0aGlzLl9jb25zdHJhaW50Lmdyb3cgPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgbWFyZ2luKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludC5tYXJnaW4hO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldCBtYXJnaW4oIHZhbHVlOiBudW1iZXIgKSB7XHJcbiAgICB0aGlzLl9jb25zdHJhaW50Lm1hcmdpbiA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCB4TWFyZ2luKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludC54TWFyZ2luITtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgeE1hcmdpbiggdmFsdWU6IG51bWJlciApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQueE1hcmdpbiA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCB5TWFyZ2luKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludC55TWFyZ2luITtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgeU1hcmdpbiggdmFsdWU6IG51bWJlciApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQueU1hcmdpbiA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBsZWZ0TWFyZ2luKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludC5sZWZ0TWFyZ2luITtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgbGVmdE1hcmdpbiggdmFsdWU6IG51bWJlciApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQubGVmdE1hcmdpbiA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCByaWdodE1hcmdpbigpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuX2NvbnN0cmFpbnQucmlnaHRNYXJnaW4hO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldCByaWdodE1hcmdpbiggdmFsdWU6IG51bWJlciApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQucmlnaHRNYXJnaW4gPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgdG9wTWFyZ2luKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludC50b3BNYXJnaW4hO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldCB0b3BNYXJnaW4oIHZhbHVlOiBudW1iZXIgKSB7XHJcbiAgICB0aGlzLl9jb25zdHJhaW50LnRvcE1hcmdpbiA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBib3R0b21NYXJnaW4oKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLl9jb25zdHJhaW50LmJvdHRvbU1hcmdpbiE7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0IGJvdHRvbU1hcmdpbiggdmFsdWU6IG51bWJlciApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQuYm90dG9tTWFyZ2luID0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IG1pbkNvbnRlbnRXaWR0aCgpOiBudW1iZXIgfCBudWxsIHtcclxuICAgIHJldHVybiB0aGlzLl9jb25zdHJhaW50Lm1pbkNvbnRlbnRXaWR0aDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgbWluQ29udGVudFdpZHRoKCB2YWx1ZTogbnVtYmVyIHwgbnVsbCApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQubWluQ29udGVudFdpZHRoID0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IG1pbkNvbnRlbnRIZWlnaHQoKTogbnVtYmVyIHwgbnVsbCB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludC5taW5Db250ZW50SGVpZ2h0O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldCBtaW5Db250ZW50SGVpZ2h0KCB2YWx1ZTogbnVtYmVyIHwgbnVsbCApIHtcclxuICAgIHRoaXMuX2NvbnN0cmFpbnQubWluQ29udGVudEhlaWdodCA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBtYXhDb250ZW50V2lkdGgoKTogbnVtYmVyIHwgbnVsbCB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29uc3RyYWludC5tYXhDb250ZW50V2lkdGg7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0IG1heENvbnRlbnRXaWR0aCggdmFsdWU6IG51bWJlciB8IG51bGwgKSB7XHJcbiAgICB0aGlzLl9jb25zdHJhaW50Lm1heENvbnRlbnRXaWR0aCA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBtYXhDb250ZW50SGVpZ2h0KCk6IG51bWJlciB8IG51bGwge1xyXG4gICAgcmV0dXJuIHRoaXMuX2NvbnN0cmFpbnQubWF4Q29udGVudEhlaWdodDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgbWF4Q29udGVudEhlaWdodCggdmFsdWU6IG51bWJlciB8IG51bGwgKSB7XHJcbiAgICB0aGlzLl9jb25zdHJhaW50Lm1heENvbnRlbnRIZWlnaHQgPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbGVhc2VzIHJlZmVyZW5jZXNcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuXHJcbiAgICAvLyBMb2NrIG91ciBsYXlvdXQgZm9yZXZlclxyXG4gICAgdGhpcy5fY29uc3RyYWludC5sb2NrKCk7XHJcblxyXG4gICAgdGhpcy5jaGlsZEluc2VydGVkRW1pdHRlci5yZW1vdmVMaXN0ZW5lciggdGhpcy5vbkNoaWxkSW5zZXJ0ZWQgKTtcclxuICAgIHRoaXMuY2hpbGRSZW1vdmVkRW1pdHRlci5yZW1vdmVMaXN0ZW5lciggdGhpcy5vbkNoaWxkUmVtb3ZlZCApO1xyXG4gICAgdGhpcy5jaGlsZHJlblJlb3JkZXJlZEVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoIHRoaXMub25DaGlsZHJlblJlb3JkZXJlZCApO1xyXG4gICAgdGhpcy5jaGlsZHJlbkNoYW5nZWRFbWl0dGVyLnJlbW92ZUxpc3RlbmVyKCB0aGlzLm9uQ2hpbGRyZW5DaGFuZ2VkICk7XHJcblxyXG4gICAgLy8gRGlzcG9zZSBvdXIgY2VsbHMgaGVyZS4gV2Ugd29uJ3QgYmUgZ2V0dGluZyB0aGUgY2hpbGRyZW4tcmVtb3ZlZCBsaXN0ZW5lcnMgZmlyZWQgKHdlIHJlbW92ZWQgdGhlbSBhYm92ZSlcclxuICAgIGZvciAoIGNvbnN0IGNlbGwgb2YgdGhpcy5fY2VsbE1hcC52YWx1ZXMoKSApIHtcclxuICAgICAgY2VsbC5kaXNwb3NlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgLy8gTGF5b3V0Qm94IENvbXBhdGliaWxpdHkgKHNlZSB0aGUgRVM1IHNldHRlcnMvZ2V0dGVycywgb3IgdGhlIG9wdGlvbnMgZG9jKVxyXG4gIHB1YmxpYyBzZXRPcmllbnRhdGlvbiggb3JpZW50YXRpb246IExheW91dE9yaWVudGF0aW9uICk6IHRoaXMge1xyXG4gICAgdGhpcy5vcmllbnRhdGlvbiA9IG9yaWVudGF0aW9uO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0T3JpZW50YXRpb24oKTogTGF5b3V0T3JpZW50YXRpb24geyByZXR1cm4gdGhpcy5vcmllbnRhdGlvbjsgfVxyXG5cclxuICBwdWJsaWMgc2V0U3BhY2luZyggc3BhY2luZzogbnVtYmVyICk6IHRoaXMge1xyXG4gICAgdGhpcy5zcGFjaW5nID0gc3BhY2luZztcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldFNwYWNpbmcoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMuc3BhY2luZzsgfVxyXG5cclxuICBwdWJsaWMgc2V0QWxpZ24oIGFsaWduOiBIb3Jpem9udGFsTGF5b3V0QWxpZ24gfCBWZXJ0aWNhbExheW91dEFsaWduICk6IHRoaXMge1xyXG4gICAgdGhpcy5hbGlnbiA9IGFsaWduO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0QWxpZ24oKTogSG9yaXpvbnRhbExheW91dEFsaWduIHwgVmVydGljYWxMYXlvdXRBbGlnbiB7IHJldHVybiB0aGlzLmFsaWduOyB9XHJcblxyXG4gIHB1YmxpYyBzZXRSZXNpemUoIHJlc2l6ZTogYm9vbGVhbiApOiB0aGlzIHtcclxuICAgIHRoaXMucmVzaXplID0gcmVzaXplO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaXNSZXNpemUoKTogYm9vbGVhbiB7IHJldHVybiB0aGlzLnJlc2l6ZTsgfVxyXG5cclxuICBwdWJsaWMgZ2V0SGVscGVyTm9kZSgpOiBOb2RlIHtcclxuICAgIGNvbnN0IG1hcmdpbnNOb2RlID0gTWFyZ2luTGF5b3V0Q2VsbC5jcmVhdGVIZWxwZXJOb2RlKCB0aGlzLmNvbnN0cmFpbnQuZGlzcGxheWVkQ2VsbHMsIHRoaXMuY29uc3RyYWludC5sYXlvdXRCb3VuZHNQcm9wZXJ0eS52YWx1ZSwgY2VsbCA9PiB7XHJcbiAgICAgIGxldCBzdHIgPSAnJztcclxuXHJcbiAgICAgIGNvbnN0IGludGVybmFsT3JpZW50YXRpb24gPSBPcmllbnRhdGlvbi5mcm9tTGF5b3V0T3JpZW50YXRpb24oIGNlbGwub3JpZW50YXRpb24gKTtcclxuXHJcbiAgICAgIHN0ciArPSBgYWxpZ246ICR7TGF5b3V0QWxpZ24uaW50ZXJuYWxUb0FsaWduKCBpbnRlcm5hbE9yaWVudGF0aW9uLCBjZWxsLmVmZmVjdGl2ZUFsaWduICl9XFxuYDtcclxuICAgICAgc3RyICs9IGBzdHJldGNoOiAke2NlbGwuZWZmZWN0aXZlU3RyZXRjaH1cXG5gO1xyXG4gICAgICBzdHIgKz0gYGdyb3c6ICR7Y2VsbC5lZmZlY3RpdmVHcm93fVxcbmA7XHJcblxyXG4gICAgICByZXR1cm4gc3RyO1xyXG4gICAgfSApO1xyXG5cclxuICAgIHJldHVybiBtYXJnaW5zTm9kZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBtdXRhdGUoIG9wdGlvbnM/OiBGbG93Qm94T3B0aW9ucyApOiB0aGlzIHtcclxuICAgIHJldHVybiBzdXBlci5tdXRhdGUoIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgREVGQVVMVF9GTE9XX0JPWF9PUFRJT05TID0gREVGQVVMVF9PUFRJT05TO1xyXG59XHJcblxyXG4vKipcclxuICoge0FycmF5LjxzdHJpbmc+fSAtIFN0cmluZyBrZXlzIGZvciBhbGwgb2YgdGhlIGFsbG93ZWQgb3B0aW9ucyB0aGF0IHdpbGwgYmUgc2V0IGJ5IG5vZGUubXV0YXRlKCBvcHRpb25zICksIGluIHRoZVxyXG4gKiBvcmRlciB0aGV5IHdpbGwgYmUgZXZhbHVhdGVkIGluLlxyXG4gKlxyXG4gKiBOT1RFOiBTZWUgTm9kZSdzIF9tdXRhdG9yS2V5cyBkb2N1bWVudGF0aW9uIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGhvdyB0aGlzIG9wZXJhdGVzLCBhbmQgcG90ZW50aWFsIHNwZWNpYWxcclxuICogICAgICAgY2FzZXMgdGhhdCBtYXkgYXBwbHkuXHJcbiAqL1xyXG5GbG93Qm94LnByb3RvdHlwZS5fbXV0YXRvcktleXMgPSBbIC4uLlNJWkFCTEVfT1BUSU9OX0tFWVMsIC4uLkZMT1dCT1hfT1BUSU9OX0tFWVMsIC4uLk5vZGUucHJvdG90eXBlLl9tdXRhdG9yS2V5cyBdO1xyXG5cclxuc2NlbmVyeS5yZWdpc3RlciggJ0Zs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