// Copyright 2019-2022, University of Colorado Boulder

/**
 * Represents an image with a specific center "offset". Considered immutable (with an immutable image, the Canvas if
 * provided should not change).
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Matrix3 from '../../../dot/js/Matrix3.js';
import Vector2 from '../../../dot/js/Vector2.js';
import { Shape } from '../../../kite/js/imports.js';
import { Imageable, scenery } from '../imports.js';
import mutate from '../../../phet-core/js/mutate.js';
import optionize from '../../../phet-core/js/optionize.js';
let globalIdCounter = 1;
const scratchVector = new Vector2(0, 0);
export default class SpriteImage extends Imageable(Object) {
  // lazily-constructed

  /**
   * @param image
   * @param offset - A 2d offset from the upper-left of the image which is considered the "center".
   * @param [providedOptions]
   */
  constructor(image, offset, providedOptions) {
    assert && assert(image instanceof HTMLImageElement || image instanceof HTMLCanvasElement); // eslint-disable-line no-simple-type-checking-assertions

    const options = optionize()({
      hitTestPixels: false,
      pickable: true,
      image: image
    }, providedOptions);
    super();
    this.id = globalIdCounter++;
    this.offset = offset;
    this.pickable = options.pickable;
    this.shape = null;
    this.imageData = null;

    // Initialize Imageable items (including the image itself)
    this.setImage(image);
    mutate(this, Object.keys(Imageable.DEFAULT_OPTIONS), options);
  }
  get width() {
    return this.imageWidth;
  }
  get height() {
    return this.imageHeight;
  }

  /**
   * Returns a Shape that represents the hit-testable area of this SpriteImage.
   */
  getShape() {
    if (!this.pickable) {
      return new Shape();
    }
    if (!this.shape) {
      if (this.hitTestPixels) {
        this.ensureImageData();
        if (this.imageData) {
          this.shape = Imageable.hitTestDataToShape(this.imageData, this.width, this.height);
        } else {
          // Empty, if we haven't been able to load image data (even if we have a width/height)
          return new Shape();
        }
      } else if (this.width && this.height) {
        this.shape = Shape.rect(0, 0, this.width, this.height);
      } else {
        // If we have no width/height
        return new Shape();
      }

      // Apply our offset
      this.shape = this.shape.transformed(Matrix3.translation(-this.offset.x, -this.offset.y));
    }
    return this.shape;
  }

  /**
   * Ensures we have a computed imageData (computes it lazily if necessary).
   */
  ensureImageData() {
    if (!this.imageData && this.width && this.height) {
      this.imageData = Imageable.getHitTestData(this.image, this.width, this.height);
    }
  }

  /**
   * Returns whether a given point is considered "inside" the SpriteImage.
   */
  containsPoint(point) {
    if (!this.pickable) {
      return false;
    }
    const width = this.width;
    const height = this.height;

    // If our image isn't really loaded yet, bail out
    if (!width && !height) {
      return false;
    }
    const position = scratchVector.set(point).add(this.offset);

    // Initial position check (are we within the rectangle)
    if (position.x < 0 || position.y < 0 || position.x > width || position.y > height) {
      return false;
    }
    if (!this.hitTestPixels) {
      return true;
    } else {
      // Lazy-load image data
      this.ensureImageData();

      // And test if it's available
      if (this.imageData) {
        return Imageable.testHitTestData(this.imageData, width, height, position);
      } else {
        return false;
      }
    }
  }
}
scenery.register('SpriteImage', SpriteImage);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNYXRyaXgzIiwiVmVjdG9yMiIsIlNoYXBlIiwiSW1hZ2VhYmxlIiwic2NlbmVyeSIsIm11dGF0ZSIsIm9wdGlvbml6ZSIsImdsb2JhbElkQ291bnRlciIsInNjcmF0Y2hWZWN0b3IiLCJTcHJpdGVJbWFnZSIsIk9iamVjdCIsImNvbnN0cnVjdG9yIiwiaW1hZ2UiLCJvZmZzZXQiLCJwcm92aWRlZE9wdGlvbnMiLCJhc3NlcnQiLCJIVE1MSW1hZ2VFbGVtZW50IiwiSFRNTENhbnZhc0VsZW1lbnQiLCJvcHRpb25zIiwiaGl0VGVzdFBpeGVscyIsInBpY2thYmxlIiwiaWQiLCJzaGFwZSIsImltYWdlRGF0YSIsInNldEltYWdlIiwia2V5cyIsIkRFRkFVTFRfT1BUSU9OUyIsIndpZHRoIiwiaW1hZ2VXaWR0aCIsImhlaWdodCIsImltYWdlSGVpZ2h0IiwiZ2V0U2hhcGUiLCJlbnN1cmVJbWFnZURhdGEiLCJoaXRUZXN0RGF0YVRvU2hhcGUiLCJyZWN0IiwidHJhbnNmb3JtZWQiLCJ0cmFuc2xhdGlvbiIsIngiLCJ5IiwiZ2V0SGl0VGVzdERhdGEiLCJjb250YWluc1BvaW50IiwicG9pbnQiLCJwb3NpdGlvbiIsInNldCIsImFkZCIsInRlc3RIaXRUZXN0RGF0YSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiU3ByaXRlSW1hZ2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTktMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhbiBpbWFnZSB3aXRoIGEgc3BlY2lmaWMgY2VudGVyIFwib2Zmc2V0XCIuIENvbnNpZGVyZWQgaW1tdXRhYmxlICh3aXRoIGFuIGltbXV0YWJsZSBpbWFnZSwgdGhlIENhbnZhcyBpZlxyXG4gKiBwcm92aWRlZCBzaG91bGQgbm90IGNoYW5nZSkuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgTWF0cml4MyBmcm9tICcuLi8uLi8uLi9kb3QvanMvTWF0cml4My5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgeyBJbWFnZWFibGUsIEltYWdlYWJsZUltYWdlLCBJbWFnZWFibGVPcHRpb25zLCBzY2VuZXJ5IH0gZnJvbSAnLi4vaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBtdXRhdGUgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL211dGF0ZS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcblxyXG5sZXQgZ2xvYmFsSWRDb3VudGVyID0gMTtcclxuY29uc3Qgc2NyYXRjaFZlY3RvciA9IG5ldyBWZWN0b3IyKCAwLCAwICk7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIGhpdFRlc3RQaXhlbHM/OiBib29sZWFuO1xyXG4gIHBpY2thYmxlPzogYm9vbGVhbjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFNwcml0ZUltYWdlT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgSW1hZ2VhYmxlT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNwcml0ZUltYWdlIGV4dGVuZHMgSW1hZ2VhYmxlKCBPYmplY3QgKSB7XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBpZDogbnVtYmVyO1xyXG4gIHB1YmxpYyByZWFkb25seSBvZmZzZXQ6IFZlY3RvcjI7XHJcbiAgcHVibGljIHJlYWRvbmx5IHBpY2thYmxlOiBib29sZWFuO1xyXG4gIHByaXZhdGUgc2hhcGU6IFNoYXBlIHwgbnVsbDsgLy8gbGF6aWx5LWNvbnN0cnVjdGVkXHJcbiAgcHJpdmF0ZSBpbWFnZURhdGE6IEltYWdlRGF0YSB8IG51bGw7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBpbWFnZVxyXG4gICAqIEBwYXJhbSBvZmZzZXQgLSBBIDJkIG9mZnNldCBmcm9tIHRoZSB1cHBlci1sZWZ0IG9mIHRoZSBpbWFnZSB3aGljaCBpcyBjb25zaWRlcmVkIHRoZSBcImNlbnRlclwiLlxyXG4gICAqIEBwYXJhbSBbcHJvdmlkZWRPcHRpb25zXVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggaW1hZ2U6IEltYWdlYWJsZUltYWdlLCBvZmZzZXQ6IFZlY3RvcjIsIHByb3ZpZGVkT3B0aW9ucz86IFNwcml0ZUltYWdlT3B0aW9ucyApIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGltYWdlIGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCB8fCBpbWFnZSBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50ICk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2ltcGxlLXR5cGUtY2hlY2tpbmctYXNzZXJ0aW9uc1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8U3ByaXRlSW1hZ2VPcHRpb25zLCBTZWxmT3B0aW9ucywgSW1hZ2VhYmxlT3B0aW9ucz4oKSgge1xyXG4gICAgICBoaXRUZXN0UGl4ZWxzOiBmYWxzZSxcclxuICAgICAgcGlja2FibGU6IHRydWUsXHJcbiAgICAgIGltYWdlOiBpbWFnZVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICB0aGlzLmlkID0gZ2xvYmFsSWRDb3VudGVyKys7XHJcbiAgICB0aGlzLm9mZnNldCA9IG9mZnNldDtcclxuICAgIHRoaXMucGlja2FibGUgPSBvcHRpb25zLnBpY2thYmxlO1xyXG4gICAgdGhpcy5zaGFwZSA9IG51bGw7XHJcbiAgICB0aGlzLmltYWdlRGF0YSA9IG51bGw7XHJcblxyXG4gICAgLy8gSW5pdGlhbGl6ZSBJbWFnZWFibGUgaXRlbXMgKGluY2x1ZGluZyB0aGUgaW1hZ2UgaXRzZWxmKVxyXG4gICAgdGhpcy5zZXRJbWFnZSggaW1hZ2UgKTtcclxuXHJcbiAgICBtdXRhdGUoIHRoaXMsIE9iamVjdC5rZXlzKCBJbWFnZWFibGUuREVGQVVMVF9PUFRJT05TICksIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgd2lkdGgoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmltYWdlV2lkdGg7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGhlaWdodCgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuaW1hZ2VIZWlnaHQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIGEgU2hhcGUgdGhhdCByZXByZXNlbnRzIHRoZSBoaXQtdGVzdGFibGUgYXJlYSBvZiB0aGlzIFNwcml0ZUltYWdlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRTaGFwZSgpOiBTaGFwZSB7XHJcbiAgICBpZiAoICF0aGlzLnBpY2thYmxlICkge1xyXG4gICAgICByZXR1cm4gbmV3IFNoYXBlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCAhdGhpcy5zaGFwZSApIHtcclxuICAgICAgaWYgKCB0aGlzLmhpdFRlc3RQaXhlbHMgKSB7XHJcbiAgICAgICAgdGhpcy5lbnN1cmVJbWFnZURhdGEoKTtcclxuICAgICAgICBpZiAoIHRoaXMuaW1hZ2VEYXRhICkge1xyXG4gICAgICAgICAgdGhpcy5zaGFwZSA9IEltYWdlYWJsZS5oaXRUZXN0RGF0YVRvU2hhcGUoIHRoaXMuaW1hZ2VEYXRhLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIC8vIEVtcHR5LCBpZiB3ZSBoYXZlbid0IGJlZW4gYWJsZSB0byBsb2FkIGltYWdlIGRhdGEgKGV2ZW4gaWYgd2UgaGF2ZSBhIHdpZHRoL2hlaWdodClcclxuICAgICAgICAgIHJldHVybiBuZXcgU2hhcGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIHRoaXMud2lkdGggJiYgdGhpcy5oZWlnaHQgKSB7XHJcbiAgICAgICAgdGhpcy5zaGFwZSA9IFNoYXBlLnJlY3QoIDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0ICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBubyB3aWR0aC9oZWlnaHRcclxuICAgICAgICByZXR1cm4gbmV3IFNoYXBlKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEFwcGx5IG91ciBvZmZzZXRcclxuICAgICAgdGhpcy5zaGFwZSA9IHRoaXMuc2hhcGUudHJhbnNmb3JtZWQoIE1hdHJpeDMudHJhbnNsYXRpb24oIC10aGlzLm9mZnNldC54LCAtdGhpcy5vZmZzZXQueSApICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuc2hhcGU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFbnN1cmVzIHdlIGhhdmUgYSBjb21wdXRlZCBpbWFnZURhdGEgKGNvbXB1dGVzIGl0IGxhemlseSBpZiBuZWNlc3NhcnkpLlxyXG4gICAqL1xyXG4gIHByaXZhdGUgZW5zdXJlSW1hZ2VEYXRhKCk6IHZvaWQge1xyXG4gICAgaWYgKCAhdGhpcy5pbWFnZURhdGEgJiYgdGhpcy53aWR0aCAmJiB0aGlzLmhlaWdodCApIHtcclxuICAgICAgdGhpcy5pbWFnZURhdGEgPSBJbWFnZWFibGUuZ2V0SGl0VGVzdERhdGEoIHRoaXMuaW1hZ2UsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0ICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHdoZXRoZXIgYSBnaXZlbiBwb2ludCBpcyBjb25zaWRlcmVkIFwiaW5zaWRlXCIgdGhlIFNwcml0ZUltYWdlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb250YWluc1BvaW50KCBwb2ludDogVmVjdG9yMiApOiBib29sZWFuIHtcclxuXHJcbiAgICBpZiAoICF0aGlzLnBpY2thYmxlICkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgd2lkdGggPSB0aGlzLndpZHRoO1xyXG4gICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XHJcblxyXG4gICAgLy8gSWYgb3VyIGltYWdlIGlzbid0IHJlYWxseSBsb2FkZWQgeWV0LCBiYWlsIG91dFxyXG4gICAgaWYgKCAhd2lkdGggJiYgIWhlaWdodCApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHBvc2l0aW9uID0gc2NyYXRjaFZlY3Rvci5zZXQoIHBvaW50ICkuYWRkKCB0aGlzLm9mZnNldCApO1xyXG5cclxuICAgIC8vIEluaXRpYWwgcG9zaXRpb24gY2hlY2sgKGFyZSB3ZSB3aXRoaW4gdGhlIHJlY3RhbmdsZSlcclxuICAgIGlmICggcG9zaXRpb24ueCA8IDAgfHwgcG9zaXRpb24ueSA8IDAgfHwgcG9zaXRpb24ueCA+IHdpZHRoIHx8IHBvc2l0aW9uLnkgPiBoZWlnaHQgKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoICF0aGlzLmhpdFRlc3RQaXhlbHMgKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIC8vIExhenktbG9hZCBpbWFnZSBkYXRhXHJcbiAgICAgIHRoaXMuZW5zdXJlSW1hZ2VEYXRhKCk7XHJcblxyXG4gICAgICAvLyBBbmQgdGVzdCBpZiBpdCdzIGF2YWlsYWJsZVxyXG4gICAgICBpZiAoIHRoaXMuaW1hZ2VEYXRhICkge1xyXG4gICAgICAgIHJldHVybiBJbWFnZWFibGUudGVzdEhpdFRlc3REYXRhKCB0aGlzLmltYWdlRGF0YSwgd2lkdGgsIGhlaWdodCwgcG9zaXRpb24gKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbnNjZW5lcnkucmVnaXN0ZXIoICdTcHJpdGVJbWFnZScsIFNwcml0ZUltYWdlICk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLE9BQU8sTUFBTSw0QkFBNEI7QUFDaEQsT0FBT0MsT0FBTyxNQUFNLDRCQUE0QjtBQUNoRCxTQUFTQyxLQUFLLFFBQVEsNkJBQTZCO0FBQ25ELFNBQVNDLFNBQVMsRUFBb0NDLE9BQU8sUUFBUSxlQUFlO0FBQ3BGLE9BQU9DLE1BQU0sTUFBTSxpQ0FBaUM7QUFDcEQsT0FBT0MsU0FBUyxNQUFNLG9DQUFvQztBQUUxRCxJQUFJQyxlQUFlLEdBQUcsQ0FBQztBQUN2QixNQUFNQyxhQUFhLEdBQUcsSUFBSVAsT0FBTyxDQUFFLENBQUMsRUFBRSxDQUFFLENBQUM7QUFTekMsZUFBZSxNQUFNUSxXQUFXLFNBQVNOLFNBQVMsQ0FBRU8sTUFBTyxDQUFDLENBQUM7RUFLOUI7O0VBRzdCO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7RUFDU0MsV0FBV0EsQ0FBRUMsS0FBcUIsRUFBRUMsTUFBZSxFQUFFQyxlQUFvQyxFQUFHO0lBQ2pHQyxNQUFNLElBQUlBLE1BQU0sQ0FBRUgsS0FBSyxZQUFZSSxnQkFBZ0IsSUFBSUosS0FBSyxZQUFZSyxpQkFBa0IsQ0FBQyxDQUFDLENBQUM7O0lBRTdGLE1BQU1DLE9BQU8sR0FBR1osU0FBUyxDQUFvRCxDQUFDLENBQUU7TUFDOUVhLGFBQWEsRUFBRSxLQUFLO01BQ3BCQyxRQUFRLEVBQUUsSUFBSTtNQUNkUixLQUFLLEVBQUVBO0lBQ1QsQ0FBQyxFQUFFRSxlQUFnQixDQUFDO0lBRXBCLEtBQUssQ0FBQyxDQUFDO0lBRVAsSUFBSSxDQUFDTyxFQUFFLEdBQUdkLGVBQWUsRUFBRTtJQUMzQixJQUFJLENBQUNNLE1BQU0sR0FBR0EsTUFBTTtJQUNwQixJQUFJLENBQUNPLFFBQVEsR0FBR0YsT0FBTyxDQUFDRSxRQUFRO0lB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