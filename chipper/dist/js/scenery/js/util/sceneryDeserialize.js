// Copyright 2022, University of Colorado Boulder

/**
 * Deserializes a generalized object
 * @deprecated
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Property from '../../../axon/js/Property.js';
import Bounds2 from '../../../dot/js/Bounds2.js';
import Matrix3 from '../../../dot/js/Matrix3.js';
import Vector2 from '../../../dot/js/Vector2.js';
import { Shape } from '../../../kite/js/imports.js';
import { Circle, Color, DOM, Image, Line, LinearGradient, Node, Path, Pattern, RadialGradient, Rectangle, scenery, Text } from '../imports.js';
const sceneryDeserialize = value => {
  const nodeTypes = ['Node', 'Path', 'Circle', 'Line', 'Rectangle', 'Text', 'Image', 'CanvasNode', 'WebGLNode', 'DOM'];
  if (value.type === 'Vector2') {
    return new Vector2(value.x, value.y);
  }
  if (value.type === 'Matrix3') {
    return new Matrix3().rowMajor(value.m00, value.m01, value.m02, value.m10, value.m11, value.m12, value.m20, value.m21, value.m22);
  } else if (value.type === 'Bounds2') {
    return new Bounds2(value.minX, value.minY, value.maxX, value.maxY);
  } else if (value.type === 'Shape') {
    return new Shape(value.path);
  } else if (value.type === 'Array') {
    return value.value.map(sceneryDeserialize);
  } else if (value.type === 'Color') {
    return new Color(value.red, value.green, value.blue, value.alpha);
  } else if (value.type === 'Property') {
    return new Property(sceneryDeserialize(value.value));
  } else if (value.type === 'Pattern' || value.type === 'LinearGradient' || value.type === 'RadialGradient') {
    let paint;
    if (value.type === 'Pattern') {
      const img = new window.Image();
      img.src = value.url;
      paint = new Pattern(img);
    }
    // Gradients
    else {
      const start = sceneryDeserialize(value.start);
      const end = sceneryDeserialize(value.end);
      if (value.type === 'LinearGradient') {
        paint = new LinearGradient(start.x, start.y, end.x, end.y);
      } else if (value.type === 'RadialGradient') {
        paint = new RadialGradient(start.x, start.y, value.startRadius, end.x, end.y, value.endRadius);
      }
      value.stops.forEach(stop => {
        paint.addColorStop(stop.ratio, sceneryDeserialize(stop.stop));
      });
    }
    if (value.transformMatrix) {
      paint.setTransformMatrix(sceneryDeserialize(value.transformMatrix));
    }
    return paint;
  } else if (_.includes(nodeTypes, value.type)) {
    let node;
    const setup = value.setup;
    if (value.type === 'Node') {
      node = new Node();
    } else if (value.type === 'Path') {
      node = new Path(sceneryDeserialize(setup.path));
    } else if (value.type === 'Circle') {
      node = new Circle({});
    } else if (value.type === 'Line') {
      node = new Line({});
    } else if (value.type === 'Rectangle') {
      node = new Rectangle({});
    } else if (value.type === 'Text') {
      node = new Text('');
    } else if (value.type === 'Image') {
      if (setup.imageType === 'image' || setup.imageType === 'canvas') {
        node = new Image(setup.src);
        if (setup.generateMipmaps) {
          node.mipmap = true;
        }
      } else if (setup.imageType === 'mipmapData') {
        const mipmapData = setup.mipmapData.map(level => {
          const result = {
            width: level.width,
            height: level.height,
            url: level.url
          };
          result.img = new window.Image();
          result.img.src = level.url;
          result.canvas = document.createElement('canvas');
          result.canvas.width = level.width;
          result.canvas.height = level.height;
          const context = result.canvas.getContext('2d');
          // delayed loading like in mipmap plugin
          result.updateCanvas = function () {
            if (result.img.complete && (typeof result.img.naturalWidth === 'undefined' || result.img.naturalWidth > 0)) {
              context.drawImage(result.img, 0, 0);
              delete result.updateCanvas;
            }
          };
          return result;
        });
        node = new Image(mipmapData);
      }
      node.initialWidth = setup.width;
      node.initialHeight = setup.height;
    } else if (value.type === 'CanvasNode' || value.type === 'WebGLNode') {
      // TODO: Record Canvas/WebGL calls? (conditionals would be harder!)
      node = new Node({
        children: [new Image(setup.url, {
          translation: sceneryDeserialize(setup.offset),
          scale: 1 / setup.scale
        })]
      });
    } else if (value.type === 'DOM') {
      const div = document.createElement('div');
      div.innerHTML = value.element;
      const element = div.childNodes[0];
      div.removeChild(element);
      if (value.dataURL) {
        const img = new window.Image();
        img.onload = () => {
          const context = element.getContext('2d');
          context.drawImage(img, 0, 0);
        };
        img.src = value.dataURL;
      }
      node = new DOM(element);
    }
    if (setup.clipArea) {
      node.clipArea = sceneryDeserialize(setup.clipArea);
    }
    if (setup.mouseArea) {
      node.mouseArea = sceneryDeserialize(setup.mouseArea);
    }
    if (setup.touchArea) {
      node.touchArea = sceneryDeserialize(setup.touchArea);
    }
    if (setup.matrix) {
      node.matrix = sceneryDeserialize(setup.matrix);
    }
    if (setup.localBounds) {
      node.localBounds = sceneryDeserialize(setup.localBounds);
    }

    // Paintable, if they exist
    if (setup.fill) {
      node.fill = sceneryDeserialize(setup.fill);
    }
    if (setup.stroke) {
      node.stroke = sceneryDeserialize(setup.stroke);
    }
    if (setup.lineDash) {
      node.lineDash = sceneryDeserialize(setup.lineDash);
    }
    node.mutate(value.options);
    node._serialization = value;
    return node;
  } else if (value.type === 'Subtree') {
    const nodeMap = {};
    const nodes = value.nodes.map(sceneryDeserialize);

    // Index them
    nodes.forEach(node => {
      nodeMap[node._serialization.id] = node;
    });

    // Connect children
    nodes.forEach(node => {
      node._serialization.setup.children.forEach(childId => {
        node.addChild(nodeMap[childId]);
      });
    });

    // The root should be the first one
    return nodeMap[value.rootNodeId];
  } else if (value.type === 'value') {
    return value.value;
  } else {
    return null;
  }
};
scenery.register('sceneryDeserialize', sceneryDeserialize);
export default sceneryDeserialize;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIkJvdW5kczIiLCJNYXRyaXgzIiwiVmVjdG9yMiIsIlNoYXBlIiwiQ2lyY2xlIiwiQ29sb3IiLCJET00iLCJJbWFnZSIsIkxpbmUiLCJMaW5lYXJHcmFkaWVudCIsIk5vZGUiLCJQYXRoIiwiUGF0dGVybiIsIlJhZGlhbEdyYWRpZW50IiwiUmVjdGFuZ2xlIiwic2NlbmVyeSIsIlRleHQiLCJzY2VuZXJ5RGVzZXJpYWxpemUiLCJ2YWx1ZSIsIm5vZGVUeXBlcyIsInR5cGUiLCJ4IiwieSIsInJvd01ham9yIiwibTAwIiwibTAxIiwibTAyIiwibTEwIiwibTExIiwibTEyIiwibTIwIiwibTIxIiwibTIyIiwibWluWCIsIm1pblkiLCJtYXhYIiwibWF4WSIsInBhdGgiLCJtYXAiLCJyZWQiLCJncmVlbiIsImJsdWUiLCJhbHBoYSIsInBhaW50IiwiaW1nIiwid2luZG93Iiwic3JjIiwidXJsIiwic3RhcnQiLCJlbmQiLCJzdGFydFJhZGl1cyIsImVuZFJhZGl1cyIsInN0b3BzIiwiZm9yRWFjaCIsInN0b3AiLCJhZGRDb2xvclN0b3AiLCJyYXRpbyIsInRyYW5zZm9ybU1hdHJpeCIsInNldFRyYW5zZm9ybU1hdHJpeCIsIl8iLCJpbmNsdWRlcyIsIm5vZGUiLCJzZXR1cCIsImltYWdlVHlwZSIsImdlbmVyYXRlTWlwbWFwcyIsIm1pcG1hcCIsIm1pcG1hcERhdGEiLCJsZXZlbCIsInJlc3VsdCIsIndpZHRoIiwiaGVpZ2h0IiwiY2FudmFzIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY29udGV4dCIsImdldENvbnRleHQiLCJ1cGRhdGVDYW52YXMiLCJjb21wbGV0ZSIsIm5hdHVyYWxXaWR0aCIsImRyYXdJbWFnZSIsImluaXRpYWxXaWR0aCIsImluaXRpYWxIZWlnaHQiLCJjaGlsZHJlbiIsInRyYW5zbGF0aW9uIiwib2Zmc2V0Iiwic2NhbGUiLCJkaXYiLCJpbm5lckhUTUwiLCJlbGVtZW50IiwiY2hpbGROb2RlcyIsInJlbW92ZUNoaWxkIiwiZGF0YVVSTCIsIm9ubG9hZCIsImNsaXBBcmVhIiwibW91c2VBcmVhIiwidG91Y2hBcmVhIiwibWF0cml4IiwibG9jYWxCb3VuZHMiLCJmaWxsIiwic3Ryb2tlIiwibGluZURhc2giLCJtdXRhdGUiLCJvcHRpb25zIiwiX3NlcmlhbGl6YXRpb24iLCJub2RlTWFwIiwibm9kZXMiLCJpZCIsImNoaWxkSWQiLCJhZGRDaGlsZCIsInJvb3ROb2RlSWQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbInNjZW5lcnlEZXNlcmlhbGl6ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogRGVzZXJpYWxpemVzIGEgZ2VuZXJhbGl6ZWQgb2JqZWN0XHJcbiAqIEBkZXByZWNhdGVkXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBCb3VuZHMyIGZyb20gJy4uLy4uLy4uL2RvdC9qcy9Cb3VuZHMyLmpzJztcclxuaW1wb3J0IE1hdHJpeDMgZnJvbSAnLi4vLi4vLi4vZG90L2pzL01hdHJpeDMuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEludGVudGlvbmFsQW55IGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9JbnRlbnRpb25hbEFueS5qcyc7XHJcbmltcG9ydCB7IENpcmNsZSwgQ29sb3IsIERPTSwgR3JhZGllbnQsIEltYWdlLCBMaW5lLCBMaW5lYXJHcmFkaWVudCwgTWlwbWFwLCBOb2RlLCBQYWludCwgUGF0aCwgUGF0dGVybiwgUmFkaWFsR3JhZGllbnQsIFJlY3RhbmdsZSwgc2NlbmVyeSwgVGV4dCB9IGZyb20gJy4uL2ltcG9ydHMuanMnO1xyXG5cclxuY29uc3Qgc2NlbmVyeURlc2VyaWFsaXplID0gKCB2YWx1ZTogeyB0eXBlOiBzdHJpbmc7IFsga2V5OiBzdHJpbmcgXTogSW50ZW50aW9uYWxBbnkgfSApOiBJbnRlbnRpb25hbEFueSA9PiB7XHJcbiAgY29uc3Qgbm9kZVR5cGVzID0gW1xyXG4gICAgJ05vZGUnLCAnUGF0aCcsICdDaXJjbGUnLCAnTGluZScsICdSZWN0YW5nbGUnLCAnVGV4dCcsICdJbWFnZScsICdDYW52YXNOb2RlJywgJ1dlYkdMTm9kZScsICdET00nXHJcbiAgXTtcclxuXHJcbiAgaWYgKCB2YWx1ZS50eXBlID09PSAnVmVjdG9yMicgKSB7XHJcbiAgICByZXR1cm4gbmV3IFZlY3RvcjIoIHZhbHVlLngsIHZhbHVlLnkgKTtcclxuICB9XHJcbiAgaWYgKCB2YWx1ZS50eXBlID09PSAnTWF0cml4MycgKSB7XHJcbiAgICByZXR1cm4gbmV3IE1hdHJpeDMoKS5yb3dNYWpvcihcclxuICAgICAgdmFsdWUubTAwLCB2YWx1ZS5tMDEsIHZhbHVlLm0wMixcclxuICAgICAgdmFsdWUubTEwLCB2YWx1ZS5tMTEsIHZhbHVlLm0xMixcclxuICAgICAgdmFsdWUubTIwLCB2YWx1ZS5tMjEsIHZhbHVlLm0yMlxyXG4gICAgKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdCb3VuZHMyJyApIHtcclxuICAgIHJldHVybiBuZXcgQm91bmRzMiggdmFsdWUubWluWCwgdmFsdWUubWluWSwgdmFsdWUubWF4WCwgdmFsdWUubWF4WSApO1xyXG4gIH1cclxuICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ1NoYXBlJyApIHtcclxuICAgIHJldHVybiBuZXcgU2hhcGUoIHZhbHVlLnBhdGggKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdBcnJheScgKSB7XHJcbiAgICByZXR1cm4gdmFsdWUudmFsdWUubWFwKCBzY2VuZXJ5RGVzZXJpYWxpemUgKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdDb2xvcicgKSB7XHJcbiAgICByZXR1cm4gbmV3IENvbG9yKCB2YWx1ZS5yZWQsIHZhbHVlLmdyZWVuLCB2YWx1ZS5ibHVlLCB2YWx1ZS5hbHBoYSApO1xyXG4gIH1cclxuICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ1Byb3BlcnR5JyApIHtcclxuICAgIHJldHVybiBuZXcgUHJvcGVydHkoIHNjZW5lcnlEZXNlcmlhbGl6ZSggdmFsdWUudmFsdWUgKSApO1xyXG4gIH1cclxuICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ1BhdHRlcm4nIHx8IHZhbHVlLnR5cGUgPT09ICdMaW5lYXJHcmFkaWVudCcgfHwgdmFsdWUudHlwZSA9PT0gJ1JhZGlhbEdyYWRpZW50JyApIHtcclxuICAgIGxldCBwYWludCE6IFBhaW50O1xyXG5cclxuICAgIGlmICggdmFsdWUudHlwZSA9PT0gJ1BhdHRlcm4nICkge1xyXG4gICAgICBjb25zdCBpbWcgPSBuZXcgd2luZG93LkltYWdlKCk7XHJcbiAgICAgIGltZy5zcmMgPSB2YWx1ZS51cmw7XHJcbiAgICAgIHBhaW50ID0gbmV3IFBhdHRlcm4oIGltZyApO1xyXG4gICAgfVxyXG4gICAgLy8gR3JhZGllbnRzXHJcbiAgICBlbHNlIHtcclxuICAgICAgY29uc3Qgc3RhcnQgPSBzY2VuZXJ5RGVzZXJpYWxpemUoIHZhbHVlLnN0YXJ0ICk7XHJcbiAgICAgIGNvbnN0IGVuZCA9IHNjZW5lcnlEZXNlcmlhbGl6ZSggdmFsdWUuZW5kICk7XHJcbiAgICAgIGlmICggdmFsdWUudHlwZSA9PT0gJ0xpbmVhckdyYWRpZW50JyApIHtcclxuICAgICAgICBwYWludCA9IG5ldyBMaW5lYXJHcmFkaWVudCggc3RhcnQueCwgc3RhcnQueSwgZW5kLngsIGVuZC55ICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdSYWRpYWxHcmFkaWVudCcgKSB7XHJcbiAgICAgICAgcGFpbnQgPSBuZXcgUmFkaWFsR3JhZGllbnQoIHN0YXJ0LngsIHN0YXJ0LnksIHZhbHVlLnN0YXJ0UmFkaXVzLCBlbmQueCwgZW5kLnksIHZhbHVlLmVuZFJhZGl1cyApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YWx1ZS5zdG9wcy5mb3JFYWNoKCAoIHN0b3A6IEludGVudGlvbmFsQW55ICkgPT4ge1xyXG4gICAgICAgICggcGFpbnQgYXMgR3JhZGllbnQgKS5hZGRDb2xvclN0b3AoIHN0b3AucmF0aW8sIHNjZW5lcnlEZXNlcmlhbGl6ZSggc3RvcC5zdG9wICkgKTtcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggdmFsdWUudHJhbnNmb3JtTWF0cml4ICkge1xyXG4gICAgICBwYWludC5zZXRUcmFuc2Zvcm1NYXRyaXgoIHNjZW5lcnlEZXNlcmlhbGl6ZSggdmFsdWUudHJhbnNmb3JtTWF0cml4ICkgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcGFpbnQ7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKCBfLmluY2x1ZGVzKCBub2RlVHlwZXMsIHZhbHVlLnR5cGUgKSApIHtcclxuICAgIGxldCBub2RlOiBJbnRlbnRpb25hbEFueTtcclxuXHJcbiAgICBjb25zdCBzZXR1cCA9IHZhbHVlLnNldHVwO1xyXG5cclxuICAgIGlmICggdmFsdWUudHlwZSA9PT0gJ05vZGUnICkge1xyXG4gICAgICBub2RlID0gbmV3IE5vZGUoKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCB2YWx1ZS50eXBlID09PSAnUGF0aCcgKSB7XHJcbiAgICAgIG5vZGUgPSBuZXcgUGF0aCggc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC5wYXRoICkgKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCB2YWx1ZS50eXBlID09PSAnQ2lyY2xlJyApIHtcclxuICAgICAgbm9kZSA9IG5ldyBDaXJjbGUoIHt9ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ0xpbmUnICkge1xyXG4gICAgICBub2RlID0gbmV3IExpbmUoIHt9ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ1JlY3RhbmdsZScgKSB7XHJcbiAgICAgIG5vZGUgPSBuZXcgUmVjdGFuZ2xlKCB7fSApO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdUZXh0JyApIHtcclxuICAgICAgbm9kZSA9IG5ldyBUZXh0KCAnJyApO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdJbWFnZScgKSB7XHJcbiAgICAgIGlmICggc2V0dXAuaW1hZ2VUeXBlID09PSAnaW1hZ2UnIHx8IHNldHVwLmltYWdlVHlwZSA9PT0gJ2NhbnZhcycgKSB7XHJcbiAgICAgICAgbm9kZSA9IG5ldyBJbWFnZSggc2V0dXAuc3JjICk7XHJcbiAgICAgICAgaWYgKCBzZXR1cC5nZW5lcmF0ZU1pcG1hcHMgKSB7XHJcbiAgICAgICAgICBub2RlLm1pcG1hcCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCBzZXR1cC5pbWFnZVR5cGUgPT09ICdtaXBtYXBEYXRhJyApIHtcclxuICAgICAgICBjb25zdCBtaXBtYXBEYXRhID0gc2V0dXAubWlwbWFwRGF0YS5tYXAoICggbGV2ZWw6IE1pcG1hcFswXSApID0+IHtcclxuICAgICAgICAgIGNvbnN0IHJlc3VsdDogSW50ZW50aW9uYWxBbnkgPSB7XHJcbiAgICAgICAgICAgIHdpZHRoOiBsZXZlbC53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiBsZXZlbC5oZWlnaHQsXHJcbiAgICAgICAgICAgIHVybDogbGV2ZWwudXJsXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgcmVzdWx0LmltZyA9IG5ldyB3aW5kb3cuSW1hZ2UoKTtcclxuICAgICAgICAgIHJlc3VsdC5pbWcuc3JjID0gbGV2ZWwudXJsO1xyXG4gICAgICAgICAgcmVzdWx0LmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdjYW52YXMnICk7XHJcbiAgICAgICAgICByZXN1bHQuY2FudmFzLndpZHRoID0gbGV2ZWwud2lkdGg7XHJcbiAgICAgICAgICByZXN1bHQuY2FudmFzLmhlaWdodCA9IGxldmVsLmhlaWdodDtcclxuICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSByZXN1bHQuY2FudmFzLmdldENvbnRleHQoICcyZCcgKTtcclxuICAgICAgICAgIC8vIGRlbGF5ZWQgbG9hZGluZyBsaWtlIGluIG1pcG1hcCBwbHVnaW5cclxuICAgICAgICAgIHJlc3VsdC51cGRhdGVDYW52YXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCByZXN1bHQuaW1nLmNvbXBsZXRlICYmICggdHlwZW9mIHJlc3VsdC5pbWcubmF0dXJhbFdpZHRoID09PSAndW5kZWZpbmVkJyB8fCByZXN1bHQuaW1nLm5hdHVyYWxXaWR0aCA+IDAgKSApIHtcclxuICAgICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZSggcmVzdWx0LmltZywgMCwgMCApO1xyXG4gICAgICAgICAgICAgIGRlbGV0ZSByZXN1bHQudXBkYXRlQ2FudmFzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9ICk7XHJcbiAgICAgICAgbm9kZSA9IG5ldyBJbWFnZSggbWlwbWFwRGF0YSApO1xyXG4gICAgICB9XHJcbiAgICAgICggbm9kZSEgKS5pbml0aWFsV2lkdGggPSBzZXR1cC53aWR0aDtcclxuICAgICAgKCBub2RlISApLmluaXRpYWxIZWlnaHQgPSBzZXR1cC5oZWlnaHQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ0NhbnZhc05vZGUnIHx8IHZhbHVlLnR5cGUgPT09ICdXZWJHTE5vZGUnICkge1xyXG4gICAgICAvLyBUT0RPOiBSZWNvcmQgQ2FudmFzL1dlYkdMIGNhbGxzPyAoY29uZGl0aW9uYWxzIHdvdWxkIGJlIGhhcmRlciEpXHJcbiAgICAgIG5vZGUgPSBuZXcgTm9kZSgge1xyXG4gICAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgICBuZXcgSW1hZ2UoIHNldHVwLnVybCwge1xyXG4gICAgICAgICAgICB0cmFuc2xhdGlvbjogc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC5vZmZzZXQgKSxcclxuICAgICAgICAgICAgc2NhbGU6IDEgLyBzZXR1cC5zY2FsZVxyXG4gICAgICAgICAgfSApXHJcbiAgICAgICAgXVxyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ0RPTScgKSB7XHJcbiAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7XHJcbiAgICAgIGRpdi5pbm5lckhUTUwgPSB2YWx1ZS5lbGVtZW50O1xyXG4gICAgICBjb25zdCBlbGVtZW50ID0gZGl2LmNoaWxkTm9kZXNbIDAgXTtcclxuICAgICAgZGl2LnJlbW92ZUNoaWxkKCBlbGVtZW50ICk7XHJcblxyXG4gICAgICBpZiAoIHZhbHVlLmRhdGFVUkwgKSB7XHJcbiAgICAgICAgY29uc3QgaW1nID0gbmV3IHdpbmRvdy5JbWFnZSgpO1xyXG4gICAgICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjb250ZXh0ID0gKCBlbGVtZW50IGFzIEhUTUxDYW52YXNFbGVtZW50ICkuZ2V0Q29udGV4dCggJzJkJyApITtcclxuICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKCBpbWcsIDAsIDAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGltZy5zcmMgPSB2YWx1ZS5kYXRhVVJMO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBub2RlID0gbmV3IERPTSggZWxlbWVudCBhcyBIVE1MRWxlbWVudCApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggc2V0dXAuY2xpcEFyZWEgKSB7XHJcbiAgICAgICggbm9kZSEgKS5jbGlwQXJlYSA9IHNjZW5lcnlEZXNlcmlhbGl6ZSggc2V0dXAuY2xpcEFyZWEgKTtcclxuICAgIH1cclxuICAgIGlmICggc2V0dXAubW91c2VBcmVhICkge1xyXG4gICAgICAoIG5vZGUhICkubW91c2VBcmVhID0gc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC5tb3VzZUFyZWEgKTtcclxuICAgIH1cclxuICAgIGlmICggc2V0dXAudG91Y2hBcmVhICkge1xyXG4gICAgICAoIG5vZGUhICkudG91Y2hBcmVhID0gc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC50b3VjaEFyZWEgKTtcclxuICAgIH1cclxuICAgIGlmICggc2V0dXAubWF0cml4ICkge1xyXG4gICAgICAoIG5vZGUhICkubWF0cml4ID0gc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC5tYXRyaXggKTtcclxuICAgIH1cclxuICAgIGlmICggc2V0dXAubG9jYWxCb3VuZHMgKSB7XHJcbiAgICAgICggbm9kZSEgKS5sb2NhbEJvdW5kcyA9IHNjZW5lcnlEZXNlcmlhbGl6ZSggc2V0dXAubG9jYWxCb3VuZHMgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBQYWludGFibGUsIGlmIHRoZXkgZXhpc3RcclxuICAgIGlmICggc2V0dXAuZmlsbCApIHtcclxuICAgICAgKCBub2RlIGFzIFBhdGggfCBUZXh0ICkuZmlsbCA9IHNjZW5lcnlEZXNlcmlhbGl6ZSggc2V0dXAuZmlsbCApO1xyXG4gICAgfVxyXG4gICAgaWYgKCBzZXR1cC5zdHJva2UgKSB7XHJcbiAgICAgICggbm9kZSBhcyBQYXRoIHwgVGV4dCApLnN0cm9rZSA9IHNjZW5lcnlEZXNlcmlhbGl6ZSggc2V0dXAuc3Ryb2tlICk7XHJcbiAgICB9XHJcbiAgICBpZiAoIHNldHVwLmxpbmVEYXNoICkge1xyXG4gICAgICAoIG5vZGUgYXMgUGF0aCB8IFRleHQgKS5saW5lRGFzaCA9IHNjZW5lcnlEZXNlcmlhbGl6ZSggc2V0dXAubGluZURhc2ggKTtcclxuICAgIH1cclxuXHJcbiAgICAoIG5vZGUhICkubXV0YXRlKCB2YWx1ZS5vcHRpb25zICk7XHJcblxyXG4gICAgKCBub2RlISApLl9zZXJpYWxpemF0aW9uID0gdmFsdWU7XHJcblxyXG4gICAgcmV0dXJuIG5vZGU7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKCB2YWx1ZS50eXBlID09PSAnU3VidHJlZScgKSB7XHJcbiAgICBjb25zdCBub2RlTWFwOiBSZWNvcmQ8c3RyaW5nLCBOb2RlPiA9IHt9O1xyXG4gICAgY29uc3Qgbm9kZXMgPSB2YWx1ZS5ub2Rlcy5tYXAoIHNjZW5lcnlEZXNlcmlhbGl6ZSApO1xyXG5cclxuICAgIC8vIEluZGV4IHRoZW1cclxuICAgIG5vZGVzLmZvckVhY2goICggbm9kZTogTm9kZSApID0+IHtcclxuICAgICAgbm9kZU1hcFsgbm9kZS5fc2VyaWFsaXphdGlvbi5pZCBdID0gbm9kZTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBDb25uZWN0IGNoaWxkcmVuXHJcbiAgICBub2Rlcy5mb3JFYWNoKCAoIG5vZGU6IE5vZGUgKSA9PiB7XHJcbiAgICAgIG5vZGUuX3NlcmlhbGl6YXRpb24uc2V0dXAuY2hpbGRyZW4uZm9yRWFjaCggKCBjaGlsZElkOiBzdHJpbmcgKSA9PiB7XHJcbiAgICAgICAgbm9kZS5hZGRDaGlsZCggbm9kZU1hcFsgY2hpbGRJZCBdICk7XHJcbiAgICAgIH0gKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBUaGUgcm9vdCBzaG91bGQgYmUgdGhlIGZpcnN0IG9uZVxyXG4gICAgcmV0dXJuIG5vZGVNYXBbIHZhbHVlLnJvb3ROb2RlSWQgXTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICd2YWx1ZScgKSB7XHJcbiAgICByZXR1cm4gdmFsdWUudmFsdWU7XHJcbiAgfVxyXG4gIGVsc2Uge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59O1xyXG5cclxuc2NlbmVyeS5yZWdpc3RlciggJ3NjZW5lcnlEZXNlcmlhbGl6ZScsIHNjZW5lcnlEZXNlcmlhbGl6ZSApO1xyXG5leHBvcnQgZGVmYXVsdCBzY2VuZXJ5RGVzZXJpYWxpemU7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFFBQVEsTUFBTSw4QkFBOEI7QUFDbkQsT0FBT0MsT0FBTyxNQUFNLDRCQUE0QjtBQUNoRCxPQUFPQyxPQUFPLE1BQU0sNEJBQTRCO0FBQ2hELE9BQU9DLE9BQU8sTUFBTSw0QkFBNEI7QUFDaEQsU0FBU0MsS0FBSyxRQUFRLDZCQUE2QjtBQUVuRCxTQUFTQyxNQUFNLEVBQUVDLEtBQUssRUFBRUMsR0FBRyxFQUFZQyxLQUFLLEVBQUVDLElBQUksRUFBRUMsY0FBYyxFQUFVQyxJQUFJLEVBQVNDLElBQUksRUFBRUMsT0FBTyxFQUFFQyxjQUFjLEVBQUVDLFNBQVMsRUFBRUMsT0FBTyxFQUFFQyxJQUFJLFFBQVEsZUFBZTtBQUV2SyxNQUFNQyxrQkFBa0IsR0FBS0MsS0FBd0QsSUFBc0I7RUFDekcsTUFBTUMsU0FBUyxHQUFHLENBQ2hCLE1BQU0sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLEtBQUssQ0FDakc7RUFFRCxJQUFLRCxLQUFLLENBQUNFLElBQUksS0FBSyxTQUFTLEVBQUc7SUFDOUIsT0FBTyxJQUFJbEIsT0FBTyxDQUFFZ0IsS0FBSyxDQUFDRyxDQUFDLEVBQUVILEtBQUssQ0FBQ0ksQ0FBRSxDQUFDO0VBQ3hDO0VBQ0EsSUFBS0osS0FBSyxDQUFDRSxJQUFJLEtBQUssU0FBUyxFQUFHO0lBQzlCLE9BQU8sSUFBSW5CLE9BQU8sQ0FBQyxDQUFDLENBQUNzQixRQUFRLENBQzNCTCxLQUFLLENBQUNNLEdBQUcsRUFBRU4sS0FBSyxDQUFDTyxHQUFHLEVBQUVQLEtBQUssQ0FBQ1Es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