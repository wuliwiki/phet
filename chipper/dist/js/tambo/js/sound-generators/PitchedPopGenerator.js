// Copyright 2018-2022, University of Colorado Boulder

/**
 * sound generator that produces a popping sound with controllable pitch
 *
 * @author John Blanco (PhET Interactive Simulations)
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

import Range from '../../../dot/js/Range.js';
import optionize from '../../../phet-core/js/optionize.js';
import tambo from '../tambo.js';
import SoundGenerator from './SoundGenerator.js';
// constants
const DEFAULT_NUM_POP_GENERATORS = 8;
const ENVELOPE_TIME_CONSTANT = 0.005; // in seconds
const DEFAULT_POP_DURATION = 0.02; // in seconds

class PitchedPopGenerator extends SoundGenerator {
  // range of pitches to be produced

  // Sound sources, which consist of an oscillator and a gain node.

  // next sound source to use to play a sound

  constructor(providedOptions) {
    const options = optionize()({
      pitchRange: new Range(220, 660),
      numPopGenerators: DEFAULT_NUM_POP_GENERATORS
    }, providedOptions);
    super(options);
    this.pitchRange = options.pitchRange;

    // A dynamics compressor node used to limit max output amplitude, otherwise distortion tends to occur when lots of
    // pops are played at once.
    const dynamicsCompressorNode = this.audioContext.createDynamicsCompressor();

    // The following parameter values for the dynamics compressor were empirically determined through informed
    // experimentation.
    const now = this.audioContext.currentTime;
    dynamicsCompressorNode.threshold.setValueAtTime(-3, now);
    dynamicsCompressorNode.knee.setValueAtTime(0, now); // hard knee
    dynamicsCompressorNode.ratio.setValueAtTime(12, now);
    dynamicsCompressorNode.attack.setValueAtTime(0, now);
    dynamicsCompressorNode.release.setValueAtTime(0.25, now);
    dynamicsCompressorNode.connect(this.soundSourceDestination);

    // Create the sound sources - several are created so that pops can be played in rapid succession if desired.
    this.soundSources = [];
    _.times(options.numPopGenerators, () => {
      const oscillator = this.audioContext.createOscillator();
      const now = this.audioContext.currentTime;
      oscillator.type = 'sine';
      oscillator.frequency.setValueAtTime(options.pitchRange.min, now);
      oscillator.start(0);
      const gainNode = this.audioContext.createGain();
      gainNode.gain.setValueAtTime(0, now);
      oscillator.connect(gainNode);
      gainNode.connect(dynamicsCompressorNode);
      this.soundSources.push({
        oscillator: oscillator,
        gainNode: gainNode
      });
    });
    this.nextSoundSourceIndex = 0;
  }

  /**
   * Play the pop sound.
   * relativePitch - a value from 0 to 1 indicating the proportionate frequency to play within the pitch range
   [duration] - the duration of the pop sound to be played, in seconds
   */
  playPop(relativePitch, duration = DEFAULT_POP_DURATION) {
    assert && assert(relativePitch >= 0 && relativePitch <= 1, 'relative pitch value out of range');
    if (!this.fullyEnabled) {
      // ignore the request
      return;
    }

    // determine the frequency value of the pop
    const minFrequency = this.pitchRange.min;
    const maxFrequency = this.pitchRange.max;
    const frequency = minFrequency + relativePitch * (maxFrequency - minFrequency);

    // get a sound source from the pool, then index to the next one (see above for type info on sound sources)
    const soundSource = this.soundSources[this.nextSoundSourceIndex];
    this.nextSoundSourceIndex = (this.nextSoundSourceIndex + 1) % this.soundSources.length;

    // play the pop sound
    const now = this.audioContext.currentTime;
    soundSource.gainNode.gain.cancelScheduledValues(now);
    soundSource.oscillator.frequency.setValueAtTime(frequency / 2, now);
    soundSource.gainNode.gain.setValueAtTime(0, now);
    soundSource.oscillator.frequency.linearRampToValueAtTime(frequency * 2, now + duration);
    soundSource.gainNode.gain.setTargetAtTime(1, now, ENVELOPE_TIME_CONSTANT);
    soundSource.gainNode.gain.setTargetAtTime(0, now + duration, ENVELOPE_TIME_CONSTANT);
  }
}
tambo.register('PitchedPopGenerator', PitchedPopGenerator);
export default PitchedPopGenerator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSYW5nZSIsIm9wdGlvbml6ZSIsInRhbWJvIiwiU291bmRHZW5lcmF0b3IiLCJERUZBVUxUX05VTV9QT1BfR0VORVJBVE9SUyIsIkVOVkVMT1BFX1RJTUVfQ09OU1RBTlQiLCJERUZBVUxUX1BPUF9EVVJBVElPTiIsIlBpdGNoZWRQb3BHZW5lcmF0b3IiLCJjb25zdHJ1Y3RvciIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJwaXRjaFJhbmdlIiwibnVtUG9wR2VuZXJhdG9ycyIsImR5bmFtaWNzQ29tcHJlc3Nvck5vZGUiLCJhdWRpb0NvbnRleHQiLCJjcmVhdGVEeW5hbWljc0NvbXByZXNzb3IiLCJub3ciLCJjdXJyZW50VGltZSIsInRocmVzaG9sZCIsInNldFZhbHVlQXRUaW1lIiwia25lZSIsInJhdGlvIiwiYXR0YWNrIiwicmVsZWFzZSIsImNvbm5lY3QiLCJzb3VuZFNvdXJjZURlc3RpbmF0aW9uIiwic291bmRTb3VyY2VzIiwiXyIsInRpbWVzIiwib3NjaWxsYXRvciIsImNyZWF0ZU9zY2lsbGF0b3IiLCJ0eXBlIiwiZnJlcXVlbmN5IiwibWluIiwic3RhcnQiLCJnYWluTm9kZSIsImNyZWF0ZUdhaW4iLCJnYWluIiwicHVzaCIsIm5leHRTb3VuZFNvdXJjZUluZGV4IiwicGxheVBvcCIsInJlbGF0aXZlUGl0Y2giLCJkdXJhdGlvbiIsImFzc2VydCIsImZ1bGx5RW5hYmxlZCIsIm1pbkZyZXF1ZW5jeSIsIm1heEZyZXF1ZW5jeSIsIm1heCIsInNvdW5kU291cmNlIiwibGVuZ3RoIiwiY2FuY2VsU2NoZWR1bGVkVmFsdWVzIiwibGluZWFyUmFtcFRvVmFsdWVBdFRpbWUiLCJzZXRUYXJnZXRBdFRpbWUiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlBpdGNoZWRQb3BHZW5lcmF0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTgtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogc291bmQgZ2VuZXJhdG9yIHRoYXQgcHJvZHVjZXMgYSBwb3BwaW5nIHNvdW5kIHdpdGggY29udHJvbGxhYmxlIHBpdGNoXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY28gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgTWljaGFlbCBLYXV6bWFubiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IHRhbWJvIGZyb20gJy4uL3RhbWJvLmpzJztcclxuaW1wb3J0IFNvdW5kR2VuZXJhdG9yLCB7IFNvdW5kR2VuZXJhdG9yT3B0aW9ucyB9IGZyb20gJy4vU291bmRHZW5lcmF0b3IuanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuXHJcbiAgLy8gdGhlIHJhbmdlIG9mIHBpdGNoZXMgdGhhdCB3aWxsIGJlIHByb2R1Y2VkLCBpbiBIelxyXG4gIHBpdGNoUmFuZ2U/OiBSYW5nZTtcclxuXHJcbiAgLy8gdGhlIG51bWJlciBvZiBwb3AgZ2VuZXJhdG9ycyB0byBjcmVhdGUgYW5kIHBvb2wsIHVzZSBtb3JlIGlmIGdlbmVyYXRpbmcgbG90cyBvZiBwb3BzIGNsb3NlIHRvZ2V0aGVyLCBsZXNzIGlmIG5vdFxyXG4gIG51bVBvcEdlbmVyYXRvcnM/OiBudW1iZXI7XHJcbn07XHJcbmV4cG9ydCB0eXBlIFBpdGNoZWRQb3BHZW5lcmF0b3JPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBTb3VuZEdlbmVyYXRvck9wdGlvbnM7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgREVGQVVMVF9OVU1fUE9QX0dFTkVSQVRPUlMgPSA4O1xyXG5jb25zdCBFTlZFTE9QRV9USU1FX0NPTlNUQU5UID0gMC4wMDU7IC8vIGluIHNlY29uZHNcclxuY29uc3QgREVGQVVMVF9QT1BfRFVSQVRJT04gPSAwLjAyOyAvLyBpbiBzZWNvbmRzXHJcblxyXG5jbGFzcyBQaXRjaGVkUG9wR2VuZXJhdG9yIGV4dGVuZHMgU291bmRHZW5lcmF0b3Ige1xyXG5cclxuICAvLyByYW5nZSBvZiBwaXRjaGVzIHRvIGJlIHByb2R1Y2VkXHJcbiAgcHJpdmF0ZSByZWFkb25seSBwaXRjaFJhbmdlOiBSYW5nZTtcclxuXHJcbiAgLy8gU291bmQgc291cmNlcywgd2hpY2ggY29uc2lzdCBvZiBhbiBvc2NpbGxhdG9yIGFuZCBhIGdhaW4gbm9kZS5cclxuICBwcml2YXRlIHJlYWRvbmx5IHNvdW5kU291cmNlczogeyBvc2NpbGxhdG9yOiBPc2NpbGxhdG9yTm9kZTsgZ2Fpbk5vZGU6IEdhaW5Ob2RlIH1bXTtcclxuXHJcbiAgLy8gbmV4dCBzb3VuZCBzb3VyY2UgdG8gdXNlIHRvIHBsYXkgYSBzb3VuZFxyXG4gIHByaXZhdGUgbmV4dFNvdW5kU291cmNlSW5kZXg6IG51bWJlcjtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBwcm92aWRlZE9wdGlvbnM/OiBQaXRjaGVkUG9wR2VuZXJhdG9yT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFBpdGNoZWRQb3BHZW5lcmF0b3JPcHRpb25zLCBTZWxmT3B0aW9ucywgU291bmRHZW5lcmF0b3JPcHRpb25zPigpKCB7XHJcbiAgICAgIHBpdGNoUmFuZ2U6IG5ldyBSYW5nZSggMjIwLCA2NjAgKSxcclxuICAgICAgbnVtUG9wR2VuZXJhdG9yczogREVGQVVMVF9OVU1fUE9QX0dFTkVSQVRPUlNcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5waXRjaFJhbmdlID0gb3B0aW9ucy5waXRjaFJhbmdlO1xyXG5cclxuICAgIC8vIEEgZHluYW1pY3MgY29tcHJlc3NvciBub2RlIHVzZWQgdG8gbGltaXQgbWF4IG91dHB1dCBhbXBsaXR1ZGUsIG90aGVyd2lzZSBkaXN0b3J0aW9uIHRlbmRzIHRvIG9jY3VyIHdoZW4gbG90cyBvZlxyXG4gICAgLy8gcG9wcyBhcmUgcGxheWVkIGF0IG9uY2UuXHJcbiAgICBjb25zdCBkeW5hbWljc0NvbXByZXNzb3JOb2RlID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlRHluYW1pY3NDb21wcmVzc29yKCk7XHJcblxyXG4gICAgLy8gVGhlIGZvbGxvd2luZyBwYXJhbWV0ZXIgdmFsdWVzIGZvciB0aGUgZHluYW1pY3MgY29tcHJlc3NvciB3ZXJlIGVtcGlyaWNhbGx5IGRldGVybWluZWQgdGhyb3VnaCBpbmZvcm1lZFxyXG4gICAgLy8gZXhwZXJpbWVudGF0aW9uLlxyXG4gICAgY29uc3Qgbm93ID0gdGhpcy5hdWRpb0NvbnRleHQuY3VycmVudFRpbWU7XHJcbiAgICBkeW5hbWljc0NvbXByZXNzb3JOb2RlLnRocmVzaG9sZC5zZXRWYWx1ZUF0VGltZSggLTMsIG5vdyApO1xyXG4gICAgZHluYW1pY3NDb21wcmVzc29yTm9kZS5rbmVlLnNldFZhbHVlQXRUaW1lKCAwLCBub3cgKTsgLy8gaGFyZCBrbmVlXHJcbiAgICBkeW5hbWljc0NvbXByZXNzb3JOb2RlLnJhdGlvLnNldFZhbHVlQXRUaW1lKCAxMiwgbm93ICk7XHJcbiAgICBkeW5hbWljc0NvbXByZXNzb3JOb2RlLmF0dGFjay5zZXRWYWx1ZUF0VGltZSggMCwgbm93ICk7XHJcbiAgICBkeW5hbWljc0NvbXByZXNzb3JOb2RlLnJlbGVhc2Uuc2V0VmFsdWVBdFRpbWUoIDAuMjUsIG5vdyApO1xyXG4gICAgZHluYW1pY3NDb21wcmVzc29yTm9kZS5jb25uZWN0KCB0aGlzLnNvdW5kU291cmNlRGVzdGluYXRpb24gKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIHNvdW5kIHNvdXJjZXMgLSBzZXZlcmFsIGFyZSBjcmVhdGVkIHNvIHRoYXQgcG9wcyBjYW4gYmUgcGxheWVkIGluIHJhcGlkIHN1Y2Nlc3Npb24gaWYgZGVzaXJlZC5cclxuICAgIHRoaXMuc291bmRTb3VyY2VzID0gW107XHJcbiAgICBfLnRpbWVzKCBvcHRpb25zLm51bVBvcEdlbmVyYXRvcnMsICgpID0+IHtcclxuXHJcbiAgICAgIGNvbnN0IG9zY2lsbGF0b3IgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVPc2NpbGxhdG9yKCk7XHJcbiAgICAgIGNvbnN0IG5vdyA9IHRoaXMuYXVkaW9Db250ZXh0LmN1cnJlbnRUaW1lO1xyXG4gICAgICBvc2NpbGxhdG9yLnR5cGUgPSAnc2luZSc7XHJcbiAgICAgIG9zY2lsbGF0b3IuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKCBvcHRpb25zLnBpdGNoUmFuZ2UubWluLCBub3cgKTtcclxuICAgICAgb3NjaWxsYXRvci5zdGFydCggMCApO1xyXG5cclxuICAgICAgY29uc3QgZ2Fpbk5vZGUgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVHYWluKCk7XHJcbiAgICAgIGdhaW5Ob2RlLmdhaW4uc2V0VmFsdWVBdFRpbWUoIDAsIG5vdyApO1xyXG4gICAgICBvc2NpbGxhdG9yLmNvbm5lY3QoIGdhaW5Ob2RlICk7XHJcbiAgICAgIGdhaW5Ob2RlLmNvbm5lY3QoIGR5bmFtaWNzQ29tcHJlc3Nvck5vZGUgKTtcclxuXHJcbiAgICAgIHRoaXMuc291bmRTb3VyY2VzLnB1c2goIHtcclxuICAgICAgICBvc2NpbGxhdG9yOiBvc2NpbGxhdG9yLFxyXG4gICAgICAgIGdhaW5Ob2RlOiBnYWluTm9kZVxyXG4gICAgICB9ICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5uZXh0U291bmRTb3VyY2VJbmRleCA9IDA7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQbGF5IHRoZSBwb3Agc291bmQuXHJcbiAgICogcmVsYXRpdmVQaXRjaCAtIGEgdmFsdWUgZnJvbSAwIHRvIDEgaW5kaWNhdGluZyB0aGUgcHJvcG9ydGlvbmF0ZSBmcmVxdWVuY3kgdG8gcGxheSB3aXRoaW4gdGhlIHBpdGNoIHJhbmdlXHJcbiAgIFtkdXJhdGlvbl0gLSB0aGUgZHVyYXRpb24gb2YgdGhlIHBvcCBzb3VuZCB0byBiZSBwbGF5ZWQsIGluIHNlY29uZHNcclxuICAgKi9cclxuICBwdWJsaWMgcGxheVBvcCggcmVsYXRpdmVQaXRjaDogbnVtYmVyLCBkdXJhdGlvbiA9IERFRkFVTFRfUE9QX0RVUkFUSU9OICk6IHZvaWQge1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHJlbGF0aXZlUGl0Y2ggPj0gMCAmJiByZWxhdGl2ZVBpdGNoIDw9IDEsICdyZWxhdGl2ZSBwaXRjaCB2YWx1ZSBvdXQgb2YgcmFuZ2UnICk7XHJcblxyXG4gICAgaWYgKCAhdGhpcy5mdWxseUVuYWJsZWQgKSB7XHJcblxyXG4gICAgICAvLyBpZ25vcmUgdGhlIHJlcXVlc3RcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGRldGVybWluZSB0aGUgZnJlcXVlbmN5IHZhbHVlIG9mIHRoZSBwb3BcclxuICAgIGNvbnN0IG1pbkZyZXF1ZW5jeSA9IHRoaXMucGl0Y2hSYW5nZS5taW47XHJcbiAgICBjb25zdCBtYXhGcmVxdWVuY3kgPSB0aGlzLnBpdGNoUmFuZ2UubWF4O1xyXG4gICAgY29uc3QgZnJlcXVlbmN5ID0gbWluRnJlcXVlbmN5ICsgcmVsYXRpdmVQaXRjaCAqICggbWF4RnJlcXVlbmN5IC0gbWluRnJlcXVlbmN5ICk7XHJcblxyXG4gICAgLy8gZ2V0IGEgc291bmQgc291cmNlIGZyb20gdGhlIHBvb2wsIHRoZW4gaW5kZXggdG8gdGhlIG5leHQgb25lIChzZWUgYWJvdmUgZm9yIHR5cGUgaW5mbyBvbiBzb3VuZCBzb3VyY2VzKVxyXG4gICAgY29uc3Qgc291bmRTb3VyY2UgPSB0aGlzLnNvdW5kU291cmNlc1sgdGhpcy5uZXh0U291bmRTb3VyY2VJbmRleCBdO1xyXG4gICAgdGhpcy5uZXh0U291bmRTb3VyY2VJbmRleCA9ICggdGhpcy5uZXh0U291bmRTb3VyY2VJbmRleCArIDEgKSAlIHRoaXMuc291bmRTb3VyY2VzLmxlbmd0aDtcclxuXHJcbiAgICAvLyBwbGF5IHRoZSBwb3Agc291bmRcclxuICAgIGNvbnN0IG5vdyA9IHRoaXMuYXVkaW9Db250ZXh0LmN1cnJlbnRUaW1lO1xyXG4gICAgc291bmRTb3VyY2UuZ2Fpbk5vZGUuZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMoIG5vdyApO1xyXG4gICAgc291bmRTb3VyY2Uub3NjaWxsYXRvci5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoIGZyZXF1ZW5jeSAvIDIsIG5vdyApO1xyXG4gICAgc291bmRTb3VyY2UuZ2Fpbk5vZGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSggMCwgbm93ICk7XHJcbiAgICBzb3VuZFNvdXJjZS5vc2NpbGxhdG9yLmZyZXF1ZW5jeS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSggZnJlcXVlbmN5ICogMiwgbm93ICsgZHVyYXRpb24gKTtcclxuICAgIHNvdW5kU291cmNlLmdhaW5Ob2RlLmdhaW4uc2V0VGFyZ2V0QXRUaW1lKCAxLCBub3csIEVOVkVMT1BFX1RJTUVfQ09OU1RBTlQgKTtcclxuICAgIHNvdW5kU291cmNlLmdhaW5Ob2RlLmdhaW4uc2V0VGFyZ2V0QXRUaW1lKCAwLCBub3cgKyBkdXJhdGlvbiwgRU5WRUxPUEVfVElNRV9DT05TVEFOVCApO1xyXG4gIH1cclxufVxyXG5cclxudGFtYm8ucmVnaXN0ZXIoICdQaXRjaGVkUG9wR2VuZXJhdG9yJywgUGl0Y2hlZFBvcEdlbmVyYXRvciApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgUGl0Y2hlZFBvcEdlbmVyYXRvcjsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxLQUFLLE1BQU0sMEJBQTBCO0FBQzVDLE9BQU9DLFNBQVMsTUFBTSxvQ0FBb0M7QUFDMUQsT0FBT0MsS0FBSyxNQUFNLGFBQWE7QUFDL0IsT0FBT0MsY0FBYyxNQUFpQyxxQkFBcUI7QUFZM0U7QUFDQSxNQUFNQywwQkFBMEIsR0FBRyxD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