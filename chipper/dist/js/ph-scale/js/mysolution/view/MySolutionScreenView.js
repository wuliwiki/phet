// Copyright 2013-2023, University of Colorado Boulder

/**
 * View for the 'My Solution' screen.
 *
 * NOTE:
 * This view currently consists of a subset of the nodes in the 'Micro' screen.
 * But some of the common nodes are configured differently, and the screen has different layering and layout requirements.
 * So I choose to duplicate some code rather than attempt a refactor that would result in an implementation that
 * was more difficult to understand and maintain.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import ScreenView from '../../../../joist/js/ScreenView.js';
import { optionize3 } from '../../../../phet-core/js/optionize.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import { Node } from '../../../../scenery/js/imports.js';
import PHScaleConstants from '../../common/PHScaleConstants.js';
import BeakerControlPanel from '../../common/view/BeakerControlPanel.js';
import BeakerNode from '../../common/view/BeakerNode.js';
import GraphNode from '../../common/view/graph/GraphNode.js';
import ParticleCountsNode from '../../common/view/ParticleCountsNode.js';
import PHScaleViewProperties from '../../common/view/PHScaleViewProperties.js';
import RatioNode from '../../common/view/RatioNode.js';
import SolutionNode from '../../common/view/SolutionNode.js';
import VolumeIndicatorNode from '../../common/view/VolumeIndicatorNode.js';
import phScale from '../../phScale.js';
import MySolutionPHAccordionBox from './MySolutionPHAccordionBox.js';
export default class MySolutionScreenView extends ScreenView {
  constructor(model, modelViewTransform, provideOptions) {
    const options = optionize3()({}, PHScaleConstants.SCREEN_VIEW_OPTIONS, provideOptions);
    super(options);

    // view-specific properties
    const viewProperties = new PHScaleViewProperties(options.tandem.createTandem('viewProperties'));

    // beaker
    const beakerNode = new BeakerNode(model.beaker, modelViewTransform, {
      tandem: options.tandem.createTandem('beakerNode')
    });

    // solution in the beaker
    const solutionNode = new SolutionNode(model.solution.totalVolumeProperty, model.solution.colorProperty, model.beaker, modelViewTransform);

    // volume indicator along the right edge of the beaker
    const volumeIndicatorNode = new VolumeIndicatorNode(model.solution.totalVolumeProperty, model.beaker, modelViewTransform, {
      tandem: options.tandem.createTandem('volumeIndicatorNode')
    });

    // 'H3O+/OH- ratio' representation
    const ratioNode = new RatioNode(model.beaker, model.solution.pHProperty, model.solution.totalVolumeProperty, modelViewTransform, {
      visibleProperty: viewProperties.ratioVisibleProperty,
      tandem: options.tandem.createTandem('ratioNode')
    });

    // 'Particle Counts' representation
    const particleCountsNode = new ParticleCountsNode(model.solution.derivedProperties, {
      visibleProperty: viewProperties.particleCountsVisibleProperty,
      tandem: options.tandem.createTandem('particleCountsNode')
    });

    // beaker controls
    const beakerControlPanel = new BeakerControlPanel(viewProperties.ratioVisibleProperty, viewProperties.particleCountsVisibleProperty, {
      maxWidth: 0.85 * beakerNode.width,
      tandem: options.tandem.createTandem('beakerControlPanel')
    });

    // graph
    const graphNode = new GraphNode(model.solution.totalVolumeProperty, model.solution.derivedProperties, {
      pHProperty: model.solution.pHProperty,
      logScaleHeight: 565,
      tandem: options.tandem.createTandem('graphNode')
    });

    // pH meter
    const pHAccordionBoxTop = 15;
    const pHAccordionBox = new MySolutionPHAccordionBox(model.solution.pHProperty, modelViewTransform.modelToViewY(model.beaker.position.y) - pHAccordionBoxTop, {
      tandem: options.tandem.createTandem('pHAccordionBox')
    });
    const resetAllButton = new ResetAllButton({
      scale: 1.32,
      listener: () => {
        this.interruptSubtreeInput();
        model.reset();
        viewProperties.reset();
        graphNode.reset();
        pHAccordionBox.reset();
      },
      tandem: options.tandem.createTandem('resetAllButton')
    });

    // Parent for all nodes added to this screen
    const screenViewRootNode = new Node({
      children: [solutionNode, pHAccordionBox, ratioNode, beakerNode, particleCountsNode, volumeIndicatorNode, beakerControlPanel, graphNode, resetAllButton]
    });
    this.addChild(screenViewRootNode);

    // Layout of nodes that don't have a position specified in the model
    pHAccordionBox.left = beakerNode.left;
    pHAccordionBox.top = pHAccordionBoxTop;
    particleCountsNode.centerX = beakerNode.centerX;
    particleCountsNode.bottom = beakerNode.bottom - 25;
    beakerControlPanel.boundsProperty.link(bounds => {
      beakerControlPanel.centerX = beakerNode.centerX;
      beakerControlPanel.top = beakerNode.bottom + 10;
    });
    graphNode.right = beakerNode.left - 70;
    graphNode.top = pHAccordionBox.top;
    resetAllButton.right = this.layoutBounds.right - 40;
    resetAllButton.bottom = this.layoutBounds.bottom - 20;

    // keyboard traversal order, see https://github.com/phetsims/ph-scale/issues/249
    screenViewRootNode.pdomOrder = [pHAccordionBox, beakerControlPanel, graphNode, resetAllButton];
  }
}
phScale.register('MySolutionScreenView', MySolutionScreenView);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTY3JlZW5WaWV3Iiwib3B0aW9uaXplMyIsIlJlc2V0QWxsQnV0dG9uIiwiTm9kZSIsIlBIU2NhbGVDb25zdGFudHMiLCJCZWFrZXJDb250cm9sUGFuZWwiLCJCZWFrZXJOb2RlIiwiR3JhcGhOb2RlIiwiUGFydGljbGVDb3VudHNOb2RlIiwiUEhTY2FsZVZpZXdQcm9wZXJ0aWVzIiwiUmF0aW9Ob2RlIiwiU29sdXRpb25Ob2RlIiwiVm9sdW1lSW5kaWNhdG9yTm9kZSIsInBoU2NhbGUiLCJNeVNvbHV0aW9uUEhBY2NvcmRpb25Cb3giLCJNeVNvbHV0aW9uU2NyZWVuVmlldyIsImNvbnN0cnVjdG9yIiwibW9kZWwiLCJtb2RlbFZpZXdUcmFuc2Zvcm0iLCJwcm92aWRlT3B0aW9ucyIsIm9wdGlvbnMiLCJTQ1JFRU5fVklFV19PUFRJT05TIiwidmlld1Byb3BlcnRpZXMiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJiZWFrZXJOb2RlIiwiYmVha2VyIiwic29sdXRpb25Ob2RlIiwic29sdXRpb24iLCJ0b3RhbFZvbHVtZVByb3BlcnR5IiwiY29sb3JQcm9wZXJ0eSIsInZvbHVtZUluZGljYXRvck5vZGUiLCJyYXRpb05vZGUiLCJwSFByb3BlcnR5IiwidmlzaWJsZVByb3BlcnR5IiwicmF0aW9WaXNpYmxlUHJvcGVydHkiLCJwYXJ0aWNsZUNvdW50c05vZGUiLCJkZXJpdmVkUHJvcGVydGllcyIsInBhcnRpY2xlQ291bnRzVmlzaWJsZVByb3BlcnR5IiwiYmVha2VyQ29udHJvbFBhbmVsIiwibWF4V2lkdGgiLCJ3aWR0aCIsImdyYXBoTm9kZSIsImxvZ1NjYWxlSGVpZ2h0IiwicEhBY2NvcmRpb25Cb3hUb3AiLCJwSEFjY29yZGlvbkJveCIsIm1vZGVsVG9WaWV3WSIsInBvc2l0aW9uIiwieSIsInJlc2V0QWxsQnV0dG9uIiwic2NhbGUiLCJsaXN0ZW5lciIsImludGVycnVwdFN1YnRyZWVJbnB1dCIsInJlc2V0Iiwic2NyZWVuVmlld1Jvb3ROb2RlIiwiY2hpbGRyZW4iLCJhZGRDaGlsZCIsImxlZnQiLCJ0b3AiLCJjZW50ZXJYIiwiYm90dG9tIiwiYm91bmRzUHJvcGVydHkiLCJsaW5rIiwiYm91bmRzIiwicmlnaHQiLCJsYXlvdXRCb3VuZHMiLCJwZG9tT3JkZXIiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIk15U29sdXRpb25TY3JlZW5WaWV3LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDEzLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFZpZXcgZm9yIHRoZSAnTXkgU29sdXRpb24nIHNjcmVlbi5cclxuICpcclxuICogTk9URTpcclxuICogVGhpcyB2aWV3IGN1cnJlbnRseSBjb25zaXN0cyBvZiBhIHN1YnNldCBvZiB0aGUgbm9kZXMgaW4gdGhlICdNaWNybycgc2NyZWVuLlxyXG4gKiBCdXQgc29tZSBvZiB0aGUgY29tbW9uIG5vZGVzIGFyZSBjb25maWd1cmVkIGRpZmZlcmVudGx5LCBhbmQgdGhlIHNjcmVlbiBoYXMgZGlmZmVyZW50IGxheWVyaW5nIGFuZCBsYXlvdXQgcmVxdWlyZW1lbnRzLlxyXG4gKiBTbyBJIGNob29zZSB0byBkdXBsaWNhdGUgc29tZSBjb2RlIHJhdGhlciB0aGFuIGF0dGVtcHQgYSByZWZhY3RvciB0aGF0IHdvdWxkIHJlc3VsdCBpbiBhbiBpbXBsZW1lbnRhdGlvbiB0aGF0XHJcbiAqIHdhcyBtb3JlIGRpZmZpY3VsdCB0byB1bmRlcnN0YW5kIGFuZCBtYWludGFpbi5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgeyBTY3JlZW5PcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vam9pc3QvanMvU2NyZWVuLmpzJztcclxuaW1wb3J0IFNjcmVlblZpZXcgZnJvbSAnLi4vLi4vLi4vLi4vam9pc3QvanMvU2NyZWVuVmlldy5qcyc7XHJcbmltcG9ydCB7IEVtcHR5U2VsZk9wdGlvbnMsIG9wdGlvbml6ZTMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFN0cmljdE9taXQgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1N0cmljdE9taXQuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgTW9kZWxWaWV3VHJhbnNmb3JtMiBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3ZpZXcvTW9kZWxWaWV3VHJhbnNmb3JtMi5qcyc7XHJcbmltcG9ydCBSZXNldEFsbEJ1dHRvbiBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvYnV0dG9ucy9SZXNldEFsbEJ1dHRvbi5qcyc7XHJcbmltcG9ydCB7IE5vZGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgUEhTY2FsZUNvbnN0YW50cyBmcm9tICcuLi8uLi9jb21tb24vUEhTY2FsZUNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBCZWFrZXJDb250cm9sUGFuZWwgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvQmVha2VyQ29udHJvbFBhbmVsLmpzJztcclxuaW1wb3J0IEJlYWtlck5vZGUgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvQmVha2VyTm9kZS5qcyc7XHJcbmltcG9ydCBHcmFwaE5vZGUgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvZ3JhcGgvR3JhcGhOb2RlLmpzJztcclxuaW1wb3J0IFBhcnRpY2xlQ291bnRzTm9kZSBmcm9tICcuLi8uLi9jb21tb24vdmlldy9QYXJ0aWNsZUNvdW50c05vZGUuanMnO1xyXG5pbXBvcnQgUEhTY2FsZVZpZXdQcm9wZXJ0aWVzIGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L1BIU2NhbGVWaWV3UHJvcGVydGllcy5qcyc7XHJcbmltcG9ydCBSYXRpb05vZGUgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvUmF0aW9Ob2RlLmpzJztcclxuaW1wb3J0IFNvbHV0aW9uTm9kZSBmcm9tICcuLi8uLi9jb21tb24vdmlldy9Tb2x1dGlvbk5vZGUuanMnO1xyXG5pbXBvcnQgVm9sdW1lSW5kaWNhdG9yTm9kZSBmcm9tICcuLi8uLi9jb21tb24vdmlldy9Wb2x1bWVJbmRpY2F0b3JOb2RlLmpzJztcclxuaW1wb3J0IHBoU2NhbGUgZnJvbSAnLi4vLi4vcGhTY2FsZS5qcyc7XHJcbmltcG9ydCBNeVNvbHV0aW9uTW9kZWwgZnJvbSAnLi4vbW9kZWwvTXlTb2x1dGlvbk1vZGVsLmpzJztcclxuaW1wb3J0IE15U29sdXRpb25QSEFjY29yZGlvbkJveCBmcm9tICcuL015U29sdXRpb25QSEFjY29yZGlvbkJveC5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0gRW1wdHlTZWxmT3B0aW9ucztcclxuXHJcbnR5cGUgTXlTb2x1dGlvblNjcmVlblZpZXdPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBQaWNrUmVxdWlyZWQ8U2NyZWVuT3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTXlTb2x1dGlvblNjcmVlblZpZXcgZXh0ZW5kcyBTY3JlZW5WaWV3IHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBtb2RlbDogTXlTb2x1dGlvbk1vZGVsLCBtb2RlbFZpZXdUcmFuc2Zvcm06IE1vZGVsVmlld1RyYW5zZm9ybTIsIHByb3ZpZGVPcHRpb25zOiBNeVNvbHV0aW9uU2NyZWVuVmlld09wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTM8TXlTb2x1dGlvblNjcmVlblZpZXdPcHRpb25zLCBTZWxmT3B0aW9ucywgU3RyaWN0T21pdDxTY3JlZW5PcHRpb25zLCAndGFuZGVtJz4+KCkoIHt9LFxyXG4gICAgICBQSFNjYWxlQ29uc3RhbnRzLlNDUkVFTl9WSUVXX09QVElPTlMsIHByb3ZpZGVPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyB2aWV3LXNwZWNpZmljIHByb3BlcnRpZXNcclxuICAgIGNvbnN0IHZpZXdQcm9wZXJ0aWVzID0gbmV3IFBIU2NhbGVWaWV3UHJvcGVydGllcyggb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAndmlld1Byb3BlcnRpZXMnICkgKTtcclxuXHJcbiAgICAvLyBiZWFrZXJcclxuICAgIGNvbnN0IGJlYWtlck5vZGUgPSBuZXcgQmVha2VyTm9kZSggbW9kZWwuYmVha2VyLCBtb2RlbFZpZXdUcmFuc2Zvcm0sIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdiZWFrZXJOb2RlJyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gc29sdXRpb24gaW4gdGhlIGJlYWtlclxyXG4gICAgY29uc3Qgc29sdXRpb25Ob2RlID0gbmV3IFNvbHV0aW9uTm9kZSggbW9kZWwuc29sdXRpb24udG90YWxWb2x1bWVQcm9wZXJ0eSwgbW9kZWwuc29sdXRpb24uY29sb3JQcm9wZXJ0eSxcclxuICAgICAgbW9kZWwuYmVha2VyLCBtb2RlbFZpZXdUcmFuc2Zvcm0gKTtcclxuXHJcbiAgICAvLyB2b2x1bWUgaW5kaWNhdG9yIGFsb25nIHRoZSByaWdodCBlZGdlIG9mIHRoZSBiZWFrZXJcclxuICAgIGNvbnN0IHZvbHVtZUluZGljYXRvck5vZGUgPSBuZXcgVm9sdW1lSW5kaWNhdG9yTm9kZSggbW9kZWwuc29sdXRpb24udG90YWxWb2x1bWVQcm9wZXJ0eSwgbW9kZWwuYmVha2VyLCBtb2RlbFZpZXdUcmFuc2Zvcm0sIHtcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICd2b2x1bWVJbmRpY2F0b3JOb2RlJyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gJ0gzTysvT0gtIHJhdGlvJyByZXByZXNlbnRhdGlvblxyXG4gICAgY29uc3QgcmF0aW9Ob2RlID0gbmV3IFJhdGlvTm9kZSggbW9kZWwuYmVha2VyLCBtb2RlbC5zb2x1dGlvbi5wSFByb3BlcnR5LCBtb2RlbC5zb2x1dGlvbi50b3RhbFZvbHVtZVByb3BlcnR5LCBtb2RlbFZpZXdUcmFuc2Zvcm0sIHtcclxuICAgICAgdmlzaWJsZVByb3BlcnR5OiB2aWV3UHJvcGVydGllcy5yYXRpb1Zpc2libGVQcm9wZXJ0eSxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdyYXRpb05vZGUnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyAnUGFydGljbGUgQ291bnRzJyByZXByZXNlbnRhdGlvblxyXG4gICAgY29uc3QgcGFydGljbGVDb3VudHNOb2RlID0gbmV3IFBhcnRpY2xlQ291bnRzTm9kZSggbW9kZWwuc29sdXRpb24uZGVyaXZlZFByb3BlcnRpZXMsIHtcclxuICAgICAgdmlzaWJsZVByb3BlcnR5OiB2aWV3UHJvcGVydGllcy5wYXJ0aWNsZUNvdW50c1Zpc2libGVQcm9wZXJ0eSxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdwYXJ0aWNsZUNvdW50c05vZGUnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBiZWFrZXIgY29udHJvbHNcclxuICAgIGNvbnN0IGJlYWtlckNvbnRyb2xQYW5lbCA9IG5ldyBCZWFrZXJDb250cm9sUGFuZWwoXHJcbiAgICAgIHZpZXdQcm9wZXJ0aWVzLnJhdGlvVmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICB2aWV3UHJvcGVydGllcy5wYXJ0aWNsZUNvdW50c1Zpc2libGVQcm9wZXJ0eSwge1xyXG4gICAgICAgIG1heFdpZHRoOiAwLjg1ICogYmVha2VyTm9kZS53aWR0aCxcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2JlYWtlckNvbnRyb2xQYW5lbCcgKVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgLy8gZ3JhcGhcclxuICAgIGNvbnN0IGdyYXBoTm9kZSA9IG5ldyBHcmFwaE5vZGUoIG1vZGVsLnNvbHV0aW9uLnRvdGFsVm9sdW1lUHJvcGVydHksIG1vZGVsLnNvbHV0aW9uLmRlcml2ZWRQcm9wZXJ0aWVzLCB7XHJcbiAgICAgIHBIUHJvcGVydHk6IG1vZGVsLnNvbHV0aW9uLnBIUHJvcGVydHksXHJcbiAgICAgIGxvZ1NjYWxlSGVpZ2h0OiA1NjUsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZ3JhcGhOb2RlJyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gcEggbWV0ZXJcclxuICAgIGNvbnN0IHBIQWNjb3JkaW9uQm94VG9wID0gMTU7XHJcbiAgICBjb25zdCBwSEFjY29yZGlvbkJveCA9IG5ldyBNeVNvbHV0aW9uUEhBY2NvcmRpb25Cb3goIG1vZGVsLnNvbHV0aW9uLnBIUHJvcGVydHksXHJcbiAgICAgIG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIG1vZGVsLmJlYWtlci5wb3NpdGlvbi55ICkgLSBwSEFjY29yZGlvbkJveFRvcCwge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncEhBY2NvcmRpb25Cb3gnIClcclxuICAgICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHJlc2V0QWxsQnV0dG9uID0gbmV3IFJlc2V0QWxsQnV0dG9uKCB7XHJcbiAgICAgIHNjYWxlOiAxLjMyLFxyXG4gICAgICBsaXN0ZW5lcjogKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuaW50ZXJydXB0U3VidHJlZUlucHV0KCk7XHJcbiAgICAgICAgbW9kZWwucmVzZXQoKTtcclxuICAgICAgICB2aWV3UHJvcGVydGllcy5yZXNldCgpO1xyXG4gICAgICAgIGdyYXBoTm9kZS5yZXNldCgpO1xyXG4gICAgICAgIHBIQWNjb3JkaW9uQm94LnJlc2V0KCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncmVzZXRBbGxCdXR0b24nIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBQYXJlbnQgZm9yIGFsbCBub2RlcyBhZGRlZCB0byB0aGlzIHNjcmVlblxyXG4gICAgY29uc3Qgc2NyZWVuVmlld1Jvb3ROb2RlID0gbmV3IE5vZGUoIHtcclxuICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICBzb2x1dGlvbk5vZGUsXHJcbiAgICAgICAgcEhBY2NvcmRpb25Cb3gsXHJcbiAgICAgICAgcmF0aW9Ob2RlLFxyXG4gICAgICAgIGJlYWtlck5vZGUsXHJcbiAgICAgICAgcGFydGljbGVDb3VudHNOb2RlLFxyXG4gICAgICAgIHZvbHVtZUluZGljYXRvck5vZGUsXHJcbiAgICAgICAgYmVha2VyQ29udHJvbFBhbmVsLFxyXG4gICAgICAgIGdyYXBoTm9kZSxcclxuICAgICAgICByZXNldEFsbEJ1dHRvblxyXG4gICAgICBdXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBzY3JlZW5WaWV3Um9vdE5vZGUgKTtcclxuXHJcbiAgICAvLyBMYXlvdXQgb2Ygbm9kZXMgdGhhdCBkb24ndCBoYXZlIGEgcG9zaXRpb24gc3BlY2lmaWVkIGluIHRoZSBtb2RlbFxyXG4gICAgcEhBY2NvcmRpb25Cb3gubGVmdCA9IGJlYWtlck5vZGUubGVmdDtcclxuICAgIHBIQWNjb3JkaW9uQm94LnRvcCA9IHBIQWNjb3JkaW9uQm94VG9wO1xyXG4gICAgcGFydGljbGVDb3VudHNOb2RlLmNlbnRlclggPSBiZWFrZXJOb2RlLmNlbnRlclg7XHJcbiAgICBwYXJ0aWNsZUNvdW50c05vZGUuYm90dG9tID0gYmVha2VyTm9kZS5ib3R0b20gLSAyNTtcclxuXHJcbiAgICBiZWFrZXJDb250cm9sUGFuZWwuYm91bmRzUHJvcGVydHkubGluayggYm91bmRzID0+IHtcclxuICAgICAgYmVha2VyQ29udHJvbFBhbmVsLmNlbnRlclggPSBiZWFrZXJOb2RlLmNlbnRlclg7XHJcbiAgICAgIGJlYWtlckNvbnRyb2xQYW5lbC50b3AgPSBiZWFrZXJOb2RlLmJvdHRvbSArIDEwO1xyXG4gICAgfSApO1xyXG5cclxuICAgIGdyYXBoTm9kZS5yaWdodCA9IGJlYWtlck5vZGUubGVmdCAtIDcwO1xyXG4gICAgZ3JhcGhOb2RlLnRvcCA9IHBIQWNjb3JkaW9uQm94LnRvcDtcclxuICAgIHJlc2V0QWxsQnV0dG9uLnJpZ2h0ID0gdGhpcy5sYXlvdXRCb3VuZHMucmlnaHQgLSA0MDtcclxuICAgIHJlc2V0QWxsQnV0dG9uLmJvdHRvbSA9IHRoaXMubGF5b3V0Qm91bmRzLmJvdHRvbSAtIDIwO1xyXG5cclxuICAgIC8vIGtleWJvYXJkIHRyYXZlcnNhbCBvcmRlciwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9waC1zY2FsZS9pc3N1ZXMvMjQ5XHJcbiAgICBzY3JlZW5WaWV3Um9vdE5vZGUucGRvbU9yZGVyID0gW1xyXG4gICAgICBwSEFjY29yZGlvbkJveCxcclxuICAgICAgYmVha2VyQ29udHJvbFBhbmVsLFxyXG4gICAgICBncmFwaE5vZGUsXHJcbiAgICAgIHJlc2V0QWxsQnV0dG9uXHJcbiAgICBdO1xyXG4gIH1cclxufVxyXG5cclxucGhTY2FsZS5yZWdpc3RlciggJ015U29sdXRpb25TY3JlZW5WaWV3JywgTXlTb2x1dGlvblNjcmVlblZpZXcgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0EsT0FBT0EsVUFBVSxNQUFNLG9DQUFvQztBQUMzRCxTQUEyQkMsVUFBVSxRQUFRLHVDQUF1QztBQUlwRixPQUFPQyxjQUFjLE1BQU0sdURBQXVEO0FBQ2xGLFNBQVNDLElBQUksUUFBUSxtQ0FBbUM7QUFDeEQsT0FBT0MsZ0JBQWdCLE1BQU0sa0NBQWtDO0FBQy9ELE9BQU9DLGtCQUFrQixNQUFNLHlDQUF5QztBQUN4RSxPQUFPQyxVQUFVLE1BQU0saUNBQWlDO0FBQ3hELE9BQU9DLFNBQVMsTUFBTSxzQ0FBc0M7QUFD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