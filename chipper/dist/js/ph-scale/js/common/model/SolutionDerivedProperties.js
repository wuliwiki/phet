// Copyright 2021-2023, University of Colorado Boulder

/**
 * SolutionDerivedProperties models the Properties of a solution that are derived from pH and volume, including
 * concentration (mol/L), quantity (mol), and numbers of particles. This class is separated from the solution
 * model so that it can be used in different solution models via composition.
 *
 * This sim has different solution models because:
 * - Different screens have different needs, and there is no solution base class that is appropriate for all screens.
 *   Macro and Micro screens have a solute, with pH and total volume being DerivedProperties. My Solution
 *   screen has no solute, and pH and totalVolume are not derived.
 * - For PhET-iO, these Properties should appear only in the screens for which they are relevant; that is, the
 *   Micro and My Solution screens.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import NullableIO from '../../../../tandem/js/types/NullableIO.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import PHModel from './PHModel.js';
import phScale from '../../phScale.js';
export default class SolutionDerivedProperties {
  // The concentration (mol/L) of H2O, H3O+, and OH- in the solution

  // The quantity (mol) of H2O, H3O+, and OH- in the solution

  // The number of H2O, H3O+, and OH- particles in the solution

  constructor(pHProperty, totalVolumeProperty, providedOptions) {
    const options = providedOptions;
    this.concentrationH2OProperty = new DerivedProperty([totalVolumeProperty], totalVolume => PHModel.volumeToConcentrationH20(totalVolume), {
      tandem: options.tandem.createTandem('concentrationH2OProperty'),
      phetioValueType: NullableIO(NumberIO),
      units: 'mol/L',
      phetioDocumentation: 'concentration of H<sub>2</sub>O in the solution',
      phetioHighFrequency: true
    });
    this.concentrationH3OProperty = new DerivedProperty([pHProperty], pH => PHModel.pHToConcentrationH3O(pH), {
      tandem: options.tandem.createTandem('concentrationH3OProperty'),
      phetioValueType: NullableIO(NumberIO),
      units: 'mol/L',
      phetioDocumentation: 'concentration of H<sub>3</sub>O<sup>+</sup> in the solution',
      phetioHighFrequency: true
    });
    this.concentrationOHProperty = new DerivedProperty([pHProperty], pH => PHModel.pHToConcentrationOH(pH), {
      tandem: options.tandem.createTandem('concentrationOHProperty'),
      phetioValueType: NullableIO(NumberIO),
      units: 'mol/L',
      phetioDocumentation: 'concentration of OH<sup>-</sup> in the solution',
      phetioHighFrequency: true
    });
    this.quantityH2OProperty = new DerivedProperty([this.concentrationH2OProperty, totalVolumeProperty], (concentrationH2O, totalVolume) => PHModel.computeMoles(concentrationH2O, totalVolume), {
      tandem: options.tandem.createTandem('quantityH2OProperty'),
      phetioValueType: NumberIO,
      units: 'mol',
      phetioDocumentation: 'quantity of H<sub>2</sub>O in the solution',
      phetioHighFrequency: true
    });
    this.quantityH3OProperty = new DerivedProperty([this.concentrationH3OProperty, totalVolumeProperty], (concentrationH3O, totalVolume) => PHModel.computeMoles(concentrationH3O, totalVolume), {
      tandem: options.tandem.createTandem('quantityH3OProperty'),
      phetioValueType: NumberIO,
      units: 'mol',
      phetioDocumentation: 'quantity of H<sub>3</sub>O<sup>+</sup> in the solution',
      phetioHighFrequency: true
    });
    this.quantityOHProperty = new DerivedProperty([this.concentrationOHProperty, totalVolumeProperty], (concentrationOH, totalVolume) => PHModel.computeMoles(concentrationOH, totalVolume), {
      tandem: options.tandem.createTandem('quantityOHProperty'),
      phetioValueType: NumberIO,
      units: 'mol',
      phetioDocumentation: 'quantity of OH<sup>-</sup> in the solution',
      phetioHighFrequency: true
    });
    this.particleCountH2OProperty = new DerivedProperty([this.concentrationH2OProperty, totalVolumeProperty], (concentrationH2O, totalVolume) => PHModel.computeParticleCount(concentrationH2O, totalVolume), {
      tandem: options.tandem.createTandem('particleCountH2OProperty'),
      phetioValueType: NumberIO,
      phetioDocumentation: 'number of H<sub>2</sub>O molecules in the solution',
      phetioHighFrequency: true
    });
    this.particleCountH3OProperty = new DerivedProperty([this.concentrationH3OProperty, totalVolumeProperty], (concentrationH3O, totalVolume) => PHModel.computeParticleCount(concentrationH3O, totalVolume), {
      tandem: options.tandem.createTandem('particleCountH3OProperty'),
      phetioValueType: NumberIO,
      phetioDocumentation: 'number of H<sub>3</sub>O<sup>+</sup> ions in the solution',
      phetioHighFrequency: true
    });
    this.particleCountOHProperty = new DerivedProperty([this.concentrationOHProperty, totalVolumeProperty], (concentrationOH, totalVolume) => PHModel.computeParticleCount(concentrationOH, totalVolume), {
      tandem: options.tandem.createTandem('particleCountOHProperty'),
      phetioValueType: NumberIO,
      phetioDocumentation: 'number of OH<sup>-</sup> ions in the solution',
      phetioHighFrequency: true
    });
  }
}
phScale.register('SolutionDerivedProperties', SolutionDerivedProperties);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJOdWxsYWJsZUlPIiwiTnVtYmVySU8iLCJQSE1vZGVsIiwicGhTY2FsZSIsIlNvbHV0aW9uRGVyaXZlZFByb3BlcnRpZXMiLCJjb25zdHJ1Y3RvciIsInBIUHJvcGVydHkiLCJ0b3RhbFZvbHVtZVByb3BlcnR5IiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsImNvbmNlbnRyYXRpb25IMk9Qcm9wZXJ0eSIsInRvdGFsVm9sdW1lIiwidm9sdW1lVG9Db25jZW50cmF0aW9uSDIwIiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwicGhldGlvVmFsdWVUeXBlIiwidW5pdHMiLCJwaGV0aW9Eb2N1bWVudGF0aW9uIiwicGhldGlvSGlnaEZyZXF1ZW5jeSIsImNvbmNlbnRyYXRpb25IM09Qcm9wZXJ0eSIsInBIIiwicEhUb0NvbmNlbnRyYXRpb25IM08iLCJjb25jZW50cmF0aW9uT0hQcm9wZXJ0eSIsInBIVG9Db25jZW50cmF0aW9uT0giLCJxdWFudGl0eUgyT1Byb3BlcnR5IiwiY29uY2VudHJhdGlvbkgyTyIsImNvbXB1dGVNb2xlcyIsInF1YW50aXR5SDNPUHJvcGVydHkiLCJjb25jZW50cmF0aW9uSDNPIiwicXVhbnRpdHlPSFByb3BlcnR5IiwiY29uY2VudHJhdGlvbk9IIiwicGFydGljbGVDb3VudEgyT1Byb3BlcnR5IiwiY29tcHV0ZVBhcnRpY2xlQ291bnQiLCJwYXJ0aWNsZUNvdW50SDNPUHJvcGVydHkiLCJwYXJ0aWNsZUNvdW50T0hQcm9wZXJ0eSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiU29sdXRpb25EZXJpdmVkUHJvcGVydGllcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBTb2x1dGlvbkRlcml2ZWRQcm9wZXJ0aWVzIG1vZGVscyB0aGUgUHJvcGVydGllcyBvZiBhIHNvbHV0aW9uIHRoYXQgYXJlIGRlcml2ZWQgZnJvbSBwSCBhbmQgdm9sdW1lLCBpbmNsdWRpbmdcclxuICogY29uY2VudHJhdGlvbiAobW9sL0wpLCBxdWFudGl0eSAobW9sKSwgYW5kIG51bWJlcnMgb2YgcGFydGljbGVzLiBUaGlzIGNsYXNzIGlzIHNlcGFyYXRlZCBmcm9tIHRoZSBzb2x1dGlvblxyXG4gKiBtb2RlbCBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGluIGRpZmZlcmVudCBzb2x1dGlvbiBtb2RlbHMgdmlhIGNvbXBvc2l0aW9uLlxyXG4gKlxyXG4gKiBUaGlzIHNpbSBoYXMgZGlmZmVyZW50IHNvbHV0aW9uIG1vZGVscyBiZWNhdXNlOlxyXG4gKiAtIERpZmZlcmVudCBzY3JlZW5zIGhhdmUgZGlmZmVyZW50IG5lZWRzLCBhbmQgdGhlcmUgaXMgbm8gc29sdXRpb24gYmFzZSBjbGFzcyB0aGF0IGlzIGFwcHJvcHJpYXRlIGZvciBhbGwgc2NyZWVucy5cclxuICogICBNYWNybyBhbmQgTWljcm8gc2NyZWVucyBoYXZlIGEgc29sdXRlLCB3aXRoIHBIIGFuZCB0b3RhbCB2b2x1bWUgYmVpbmcgRGVyaXZlZFByb3BlcnRpZXMuIE15IFNvbHV0aW9uXHJcbiAqICAgc2NyZWVuIGhhcyBubyBzb2x1dGUsIGFuZCBwSCBhbmQgdG90YWxWb2x1bWUgYXJlIG5vdCBkZXJpdmVkLlxyXG4gKiAtIEZvciBQaEVULWlPLCB0aGVzZSBQcm9wZXJ0aWVzIHNob3VsZCBhcHBlYXIgb25seSBpbiB0aGUgc2NyZWVucyBmb3Igd2hpY2ggdGhleSBhcmUgcmVsZXZhbnQ7IHRoYXQgaXMsIHRoZVxyXG4gKiAgIE1pY3JvIGFuZCBNeSBTb2x1dGlvbiBzY3JlZW5zLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFBpY2tSZXF1aXJlZCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja1JlcXVpcmVkLmpzJztcclxuaW1wb3J0IHsgUGhldGlvT2JqZWN0T3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9QaGV0aW9PYmplY3QuanMnO1xyXG5pbXBvcnQgTnVsbGFibGVJTyBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvTnVsbGFibGVJTy5qcyc7XHJcbmltcG9ydCBOdW1iZXJJTyBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvTnVtYmVySU8uanMnO1xyXG5pbXBvcnQgUEhNb2RlbCBmcm9tICcuL1BITW9kZWwuanMnO1xyXG5pbXBvcnQgcGhTY2FsZSBmcm9tICcuLi8uLi9waFNjYWxlLmpzJztcclxuaW1wb3J0IHsgQ29uY2VudHJhdGlvblZhbHVlLCBQSFZhbHVlIH0gZnJvbSAnLi9QSE1vZGVsLmpzJztcclxuaW1wb3J0IExpbmthYmxlUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0xpbmthYmxlUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0gRW1wdHlTZWxmT3B0aW9ucztcclxuXHJcbnR5cGUgU29sdXRpb25EZXJpdmVkUHJvcGVydGllc09wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBpY2tSZXF1aXJlZDxQaGV0aW9PYmplY3RPcHRpb25zLCAndGFuZGVtJz47XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTb2x1dGlvbkRlcml2ZWRQcm9wZXJ0aWVzIHtcclxuXHJcbiAgLy8gVGhlIGNvbmNlbnRyYXRpb24gKG1vbC9MKSBvZiBIMk8sIEgzTyssIGFuZCBPSC0gaW4gdGhlIHNvbHV0aW9uXHJcbiAgcHVibGljIHJlYWRvbmx5IGNvbmNlbnRyYXRpb25IMk9Qcm9wZXJ0eTogTGlua2FibGVSZWFkT25seVByb3BlcnR5PENvbmNlbnRyYXRpb25WYWx1ZT47XHJcbiAgcHVibGljIHJlYWRvbmx5IGNvbmNlbnRyYXRpb25IM09Qcm9wZXJ0eTogTGlua2FibGVSZWFkT25seVByb3BlcnR5PENvbmNlbnRyYXRpb25WYWx1ZT47XHJcbiAgcHVibGljIHJlYWRvbmx5IGNvbmNlbnRyYXRpb25PSFByb3BlcnR5OiBMaW5rYWJsZVJlYWRPbmx5UHJvcGVydHk8Q29uY2VudHJhdGlvblZhbHVlPjtcclxuXHJcbiAgLy8gVGhlIHF1YW50aXR5IChtb2wpIG9mIEgyTywgSDNPKywgYW5kIE9ILSBpbiB0aGUgc29sdXRpb25cclxuICBwdWJsaWMgcmVhZG9ubHkgcXVhbnRpdHlIMk9Qcm9wZXJ0eTogTGlua2FibGVSZWFkT25seVByb3BlcnR5PG51bWJlcj47XHJcbiAgcHVibGljIHJlYWRvbmx5IHF1YW50aXR5SDNPUHJvcGVydHk6IExpbmthYmxlUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+O1xyXG4gIHB1YmxpYyByZWFkb25seSBxdWFudGl0eU9IUHJvcGVydHk6IExpbmthYmxlUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+O1xyXG5cclxuICAvLyBUaGUgbnVtYmVyIG9mIEgyTywgSDNPKywgYW5kIE9ILSBwYXJ0aWNsZXMgaW4gdGhlIHNvbHV0aW9uXHJcbiAgcHVibGljIHJlYWRvbmx5IHBhcnRpY2xlQ291bnRIMk9Qcm9wZXJ0eTogTGlua2FibGVSZWFkT25seVByb3BlcnR5PG51bWJlcj47XHJcbiAgcHVibGljIHJlYWRvbmx5IHBhcnRpY2xlQ291bnRIM09Qcm9wZXJ0eTogTGlua2FibGVSZWFkT25seVByb3BlcnR5PG51bWJlcj47XHJcbiAgcHVibGljIHJlYWRvbmx5IHBhcnRpY2xlQ291bnRPSFByb3BlcnR5OiBMaW5rYWJsZVJlYWRPbmx5UHJvcGVydHk8bnVtYmVyPjtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBwSFByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxQSFZhbHVlPixcclxuICAgICAgICAgICAgICAgICAgICAgIHRvdGFsVm9sdW1lUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM6IFNvbHV0aW9uRGVyaXZlZFByb3BlcnRpZXNPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBwcm92aWRlZE9wdGlvbnM7XHJcblxyXG4gICAgdGhpcy5jb25jZW50cmF0aW9uSDJPUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICBbIHRvdGFsVm9sdW1lUHJvcGVydHkgXSxcclxuICAgICAgdG90YWxWb2x1bWUgPT4gUEhNb2RlbC52b2x1bWVUb0NvbmNlbnRyYXRpb25IMjAoIHRvdGFsVm9sdW1lICksIHtcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2NvbmNlbnRyYXRpb25IMk9Qcm9wZXJ0eScgKSxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bGxhYmxlSU8oIE51bWJlcklPICksXHJcbiAgICAgICAgdW5pdHM6ICdtb2wvTCcsXHJcbiAgICAgICAgcGhldGlvRG9jdW1lbnRhdGlvbjogJ2NvbmNlbnRyYXRpb24gb2YgSDxzdWI+Mjwvc3ViPk8gaW4gdGhlIHNvbHV0aW9uJyxcclxuICAgICAgICBwaGV0aW9IaWdoRnJlcXVlbmN5OiB0cnVlXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmNvbmNlbnRyYXRpb25IM09Qcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgcEhQcm9wZXJ0eSBdLFxyXG4gICAgICBwSCA9PiBQSE1vZGVsLnBIVG9Db25jZW50cmF0aW9uSDNPKCBwSCApLCB7XHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdjb25jZW50cmF0aW9uSDNPUHJvcGVydHknICksXHJcbiAgICAgICAgcGhldGlvVmFsdWVUeXBlOiBOdWxsYWJsZUlPKCBOdW1iZXJJTyApLFxyXG4gICAgICAgIHVuaXRzOiAnbW9sL0wnLFxyXG4gICAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdjb25jZW50cmF0aW9uIG9mIEg8c3ViPjM8L3N1Yj5PPHN1cD4rPC9zdXA+IGluIHRoZSBzb2x1dGlvbicsXHJcbiAgICAgICAgcGhldGlvSGlnaEZyZXF1ZW5jeTogdHJ1ZVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5jb25jZW50cmF0aW9uT0hQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgcEhQcm9wZXJ0eSBdLFxyXG4gICAgICBwSCA9PiBQSE1vZGVsLnBIVG9Db25jZW50cmF0aW9uT0goIHBIICksIHtcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2NvbmNlbnRyYXRpb25PSFByb3BlcnR5JyApLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVsbGFibGVJTyggTnVtYmVySU8gKSxcclxuICAgICAgICB1bml0czogJ21vbC9MJyxcclxuICAgICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnY29uY2VudHJhdGlvbiBvZiBPSDxzdXA+LTwvc3VwPiBpbiB0aGUgc29sdXRpb24nLFxyXG4gICAgICAgIHBoZXRpb0hpZ2hGcmVxdWVuY3k6IHRydWVcclxuICAgICAgfSApO1xyXG5cclxuICAgIHRoaXMucXVhbnRpdHlIMk9Qcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5jb25jZW50cmF0aW9uSDJPUHJvcGVydHksIHRvdGFsVm9sdW1lUHJvcGVydHkgXSxcclxuICAgICAgKCBjb25jZW50cmF0aW9uSDJPLCB0b3RhbFZvbHVtZSApID0+IFBITW9kZWwuY29tcHV0ZU1vbGVzKCBjb25jZW50cmF0aW9uSDJPLCB0b3RhbFZvbHVtZSApLCB7XHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdxdWFudGl0eUgyT1Byb3BlcnR5JyApLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVtYmVySU8sXHJcbiAgICAgICAgdW5pdHM6ICdtb2wnLFxyXG4gICAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdxdWFudGl0eSBvZiBIPHN1Yj4yPC9zdWI+TyBpbiB0aGUgc29sdXRpb24nLFxyXG4gICAgICAgIHBoZXRpb0hpZ2hGcmVxdWVuY3k6IHRydWVcclxuICAgICAgfSApO1xyXG5cclxuICAgIHRoaXMucXVhbnRpdHlIM09Qcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5jb25jZW50cmF0aW9uSDNPUHJvcGVydHksIHRvdGFsVm9sdW1lUHJvcGVydHkgXSxcclxuICAgICAgKCBjb25jZW50cmF0aW9uSDNPLCB0b3RhbFZvbHVtZSApID0+IFBITW9kZWwuY29tcHV0ZU1vbGVzKCBjb25jZW50cmF0aW9uSDNPLCB0b3RhbFZvbHVtZSApLCB7XHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdxdWFudGl0eUgzT1Byb3BlcnR5JyApLFxyXG4gICAgICAgIHBoZXRpb1ZhbHVlVHlwZTogTnVtYmVySU8sXHJcbiAgICAgICAgdW5pdHM6ICdtb2wnLFxyXG4gICAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdxdWFudGl0eSBvZiBIPHN1Yj4zPC9zdWI+TzxzdXA+Kzwvc3VwPiBpbiB0aGUgc29sdXRpb24nLFxyXG4gICAgICAgIHBoZXRpb0hpZ2hGcmVxdWVuY3k6IHRydWVcclxuICAgICAgfSApO1xyXG5cclxuICAgIHRoaXMucXVhbnRpdHlPSFByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyB0aGlzLmNvbmNlbnRyYXRpb25PSFByb3BlcnR5LCB0b3RhbFZvbHVtZVByb3BlcnR5IF0sXHJcbiAgICAgICggY29uY2VudHJhdGlvbk9ILCB0b3RhbFZvbHVtZSApID0+IFBITW9kZWwuY29tcHV0ZU1vbGVzKCBjb25jZW50cmF0aW9uT0gsIHRvdGFsVm9sdW1lICksIHtcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3F1YW50aXR5T0hQcm9wZXJ0eScgKSxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bWJlcklPLFxyXG4gICAgICAgIHVuaXRzOiAnbW9sJyxcclxuICAgICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAncXVhbnRpdHkgb2YgT0g8c3VwPi08L3N1cD4gaW4gdGhlIHNvbHV0aW9uJyxcclxuICAgICAgICBwaGV0aW9IaWdoRnJlcXVlbmN5OiB0cnVlXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLnBhcnRpY2xlQ291bnRIMk9Qcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5jb25jZW50cmF0aW9uSDJPUHJvcGVydHksIHRvdGFsVm9sdW1lUHJvcGVydHkgXSxcclxuICAgICAgKCBjb25jZW50cmF0aW9uSDJPLCB0b3RhbFZvbHVtZSApID0+IFBITW9kZWwuY29tcHV0ZVBhcnRpY2xlQ291bnQoIGNvbmNlbnRyYXRpb25IMk8sIHRvdGFsVm9sdW1lICksIHtcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3BhcnRpY2xlQ291bnRIMk9Qcm9wZXJ0eScgKSxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bWJlcklPLFxyXG4gICAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdudW1iZXIgb2YgSDxzdWI+Mjwvc3ViPk8gbW9sZWN1bGVzIGluIHRoZSBzb2x1dGlvbicsXHJcbiAgICAgICAgcGhldGlvSGlnaEZyZXF1ZW5jeTogdHJ1ZVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5wYXJ0aWNsZUNvdW50SDNPUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICBbIHRoaXMuY29uY2VudHJhdGlvbkgzT1Byb3BlcnR5LCB0b3RhbFZvbHVtZVByb3BlcnR5IF0sXHJcbiAgICAgICggY29uY2VudHJhdGlvbkgzTywgdG90YWxWb2x1bWUgKSA9PiBQSE1vZGVsLmNvbXB1dGVQYXJ0aWNsZUNvdW50KCBjb25jZW50cmF0aW9uSDNPLCB0b3RhbFZvbHVtZSApLCB7XHJcbiAgICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdwYXJ0aWNsZUNvdW50SDNPUHJvcGVydHknICksXHJcbiAgICAgICAgcGhldGlvVmFsdWVUeXBlOiBOdW1iZXJJTyxcclxuICAgICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnbnVtYmVyIG9mIEg8c3ViPjM8L3N1Yj5PPHN1cD4rPC9zdXA+IGlvbnMgaW4gdGhlIHNvbHV0aW9uJyxcclxuICAgICAgICBwaGV0aW9IaWdoRnJlcXVlbmN5OiB0cnVlXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLnBhcnRpY2xlQ291bnRPSFByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyB0aGlzLmNvbmNlbnRyYXRpb25PSFByb3BlcnR5LCB0b3RhbFZvbHVtZVByb3BlcnR5IF0sXHJcbiAgICAgICggY29uY2VudHJhdGlvbk9ILCB0b3RhbFZvbHVtZSApID0+IFBITW9kZWwuY29tcHV0ZVBhcnRpY2xlQ291bnQoIGNvbmNlbnRyYXRpb25PSCwgdG90YWxWb2x1bWUgKSwge1xyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAncGFydGljbGVDb3VudE9IUHJvcGVydHknICksXHJcbiAgICAgICAgcGhldGlvVmFsdWVUeXBlOiBOdW1iZXJJTyxcclxuICAgICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnbnVtYmVyIG9mIE9IPHN1cD4tPC9zdXA+IGlvbnMgaW4gdGhlIHNvbHV0aW9uJyxcclxuICAgICAgICBwaGV0aW9IaWdoRnJlcXVlbmN5OiB0cnVlXHJcbiAgICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbnBoU2NhbGUucmVnaXN0ZXIoICdTb2x1dGlvbkRlcml2ZWRQcm9wZXJ0aWVzJywgU29sdXRpb25EZXJpdmVkUHJvcGVydGllcyApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBS3BFLE9BQU9DLFVBQVUsTUFBTSwyQ0FBMkM7QUFDbEUsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxPQUFPQyxPQUFPLE1BQU0sY0FBYztBQUNsQyxPQUFPQyxPQUFPLE1BQU0sa0JBQWtCO0FBUXRDLGVBQWUsTUFBTUMseUJBQXlCLENBQUM7RUFFN0M7O0VBS0E7O0VBS0E7O0VBS09DLFdBQVdBLENBQUVDLFVBQXNDLEVBQ3RDQyxtQkFBOEMsRUFDOUNDLGVBQWlELEVBQUc7SUFFdEUsTUFBTUMsT0FBTyxHQUFHRCxlQUFlO0lBRS9CLElBQUksQ0FBQ0Usd0JBQXdCLEdBQUcsSUFBSVgsZUFBZSxDQUNqRCxDQUFFUSxtQkFBbUIsQ0FBRSxFQUN2QkksV0FBVyxJQUFJVCxPQUFPLENBQUNVLHdCQUF3QixDQUFFRCxXQUFZLENBQUMsRUFBRTtNQUM5REUsTUFBTSxFQUFFSixPQUFPLENBQUNJLE1BQU0sQ0FBQ0MsWUFBWSxDQUFFLDBCQUEyQixDQUFDO01BQ2pFQyxlQUFlLEVBQUVmLFVBQVUsQ0FBRUMsUUFBUyxDQUFDO01BQ3ZDZSxLQUFLLEVBQUUsT0FBTztNQUNkQyxtQkFBbUIsRUFBRSxpREFBaUQ7TUFDdEVDLG1CQUFtQixFQUFFO0lBQ3ZCLENBQUUsQ0FBQztJQUVMLElBQUksQ0FBQ0Msd0JBQXdCLEdBQUcs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