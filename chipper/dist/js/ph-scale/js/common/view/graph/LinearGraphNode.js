// Copyright 2014-2022, University of Colorado Boulder

/**
 * Graph with a linear scale, for displaying concentration (mol/L) and quantity (moles).
 * Some of the code related to indicators (initialization and updateIndicators) is similar
 * to LogarithmicGraph. But it was difficult to identify a natural pattern for factoring
 * this out, so I chose to leave it as is. See issue #16.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../../axon/js/DerivedProperty.js';
import Multilink from '../../../../../axon/js/Multilink.js';
import NumberProperty from '../../../../../axon/js/NumberProperty.js';
import Utils from '../../../../../dot/js/Utils.js';
import { Shape } from '../../../../../kite/js/imports.js';
import optionize from '../../../../../phet-core/js/optionize.js';
import PhetFont from '../../../../../scenery-phet/js/PhetFont.js';
import ScientificNotationNode from '../../../../../scenery-phet/js/ScientificNotationNode.js';
import { Line, Node, Path, Text } from '../../../../../scenery/js/imports.js';
import phScale from '../../../phScale.js';
import PhScaleStrings from '../../../PhScaleStrings.js';
import PHScaleConstants from '../../PHScaleConstants.js';
import GraphIndicatorNode from './GraphIndicatorNode.js';
import GraphUnits from './GraphUnits.js';
import LinearZoomButtonGroup from './LinearZoomButtonGroup.js';

// constants
const MANTISSA_RANGE = PHScaleConstants.LINEAR_MANTISSA_RANGE;
export default class LinearGraphNode extends Node {
  constructor(derivedProperties, graphUnitsProperty, providedOptions) {
    const options = optionize()({
      // SelfOptions
      scaleHeight: 100,
      minScaleWidth: 100,
      scaleFill: 'rgb( 230, 230, 230 )',
      scaleStroke: 'black',
      scaleLineWidth: 2,
      scaleYMargin: 30,
      arrowHeight: 75,
      majorTickFont: new PhetFont(18),
      majorTickStroke: 'black',
      majorTickLength: 10,
      majorTickLineWidth: 1,
      majorTickXSpacing: 5,
      // NodeOptions
      visiblePropertyOptions: {
        phetioReadOnly: true
      }
    }, providedOptions);
    super();
    this.exponentProperty = new NumberProperty(PHScaleConstants.LINEAR_EXPONENT_RANGE.max, {
      numberType: 'Integer',
      tandem: options.tandem.createTandem('exponentProperty'),
      range: PHScaleConstants.LINEAR_EXPONENT_RANGE,
      phetioReadOnly: true,
      phetioDocumentation: 'exponent on the linear scale'
    });
    const scaleWidth = options.minScaleWidth;
    const scaleHeight = options.scaleHeight;
    const arrowWidth = 1.5 * scaleWidth;
    const arrowHeight = options.arrowHeight;
    const arrowHeadHeight = 0.85 * arrowHeight;
    const arrowGap = -10; // this controls the vertical gap between the arrow and the scale

    // arrow above scale, starting from arrow tip and moving clockwise
    const arrowNode = new Path(new Shape().moveTo(0, 0).lineTo(arrowWidth / 2, arrowHeadHeight).lineTo(scaleWidth / 2, arrowHeadHeight).lineTo(scaleWidth / 2, arrowHeight).cubicCurveTo(-scaleWidth / 4, 0.75 * arrowHeight, scaleWidth / 4, 1.25 * arrowHeight, -scaleWidth / 2, arrowHeight).lineTo(-scaleWidth / 2, arrowHeadHeight).lineTo(-arrowWidth / 2, arrowHeadHeight).close(), {
      fill: options.scaleFill,
      stroke: options.scaleStroke,
      lineWidth: options.scaleLineWidth,
      top: arrowGap
    });
    this.addChild(arrowNode);

    // scale below the arrow
    const scaleNode = new Path(new Shape().moveTo(-scaleWidth / 2, arrowHeight).cubicCurveTo(scaleWidth / 4, 1.25 * arrowHeight, -scaleWidth / 4, 0.75 * arrowHeight, scaleWidth / 2, arrowHeight).lineTo(scaleWidth / 2, scaleHeight).lineTo(-scaleWidth / 2, scaleHeight).close(), {
      fill: options.scaleFill,
      stroke: options.scaleStroke,
      lineWidth: options.scaleLineWidth
    });
    this.addChild(scaleNode);

    // 'off scale' label, positioned inside arrow
    const offScaleText = new Text(PhScaleStrings.offScaleStringProperty, {
      font: new PhetFont(18),
      fill: 'black',
      maxWidth: 0.5 * arrowWidth
    });
    this.addChild(offScaleText);
    offScaleText.centerX = arrowNode.centerX;
    offScaleText.y = arrowNode.top + 0.85 * arrowHeadHeight;

    // Create the tick marks. Correct labels will be assigned later.
    const tickLabels = [];
    const numberOfTicks = MANTISSA_RANGE.getLength() + 1;
    const ySpacing = (scaleHeight - arrowHeight - 2 * options.scaleYMargin) / (numberOfTicks - 1); // vertical space between ticks
    let tickLabel;
    let tickLineLeft;
    let tickLineRight;
    for (let i = 0; i < numberOfTicks; i++) {
      // major lines and label
      tickLineLeft = new Line(0, 0, options.majorTickLength, 0, {
        stroke: options.majorTickStroke,
        lineWidth: options.majorTickLineWidth
      });
      tickLineRight = new Line(0, 0, options.majorTickLength, 0, {
        stroke: options.majorTickStroke,
        lineWidth: options.majorTickLineWidth
      });
      tickLabel = new TickLabelNode(i, options.majorTickFont);

      // rendering order
      this.addChild(tickLineLeft);
      this.addChild(tickLineRight);
      this.addChild(tickLabel);

      // layout
      tickLineLeft.left = scaleNode.left;
      tickLineLeft.centerY = scaleNode.bottom - options.scaleYMargin - i * ySpacing;
      tickLineRight.right = scaleNode.right;
      tickLineRight.centerY = tickLineLeft.centerY;
      tickLabel.centerX = scaleNode.centerX;
      tickLabel.centerY = tickLineLeft.centerY;

      // save label so we can update it layer
      tickLabels.push(tickLabel);
    }

    // Values displayed on the indicators
    const valueH2OProperty = new DerivedProperty([derivedProperties.concentrationH2OProperty, derivedProperties.quantityH2OProperty, graphUnitsProperty], (concentration, quantity, graphUnits) => graphUnits === GraphUnits.MOLES_PER_LITER ? concentration : quantity);
    const valueH3OProperty = new DerivedProperty([derivedProperties.concentrationH3OProperty, derivedProperties.quantityH3OProperty, graphUnitsProperty], (concentration, quantity, graphUnits) => graphUnits === GraphUnits.MOLES_PER_LITER ? concentration : quantity);
    const valueOHProperty = new DerivedProperty([derivedProperties.concentrationOHProperty, derivedProperties.quantityOHProperty, graphUnitsProperty], (concentration, quantity, graphUnits) => graphUnits === GraphUnits.MOLES_PER_LITER ? concentration : quantity);

    // indicators
    const indicatorH2ONode = GraphIndicatorNode.createH2OIndicator(valueH2OProperty, {
      x: scaleNode.right - options.majorTickLength,
      tandem: options.tandem.createTandem('indicatorH2ONode')
    });
    const indicatorH3ONode = GraphIndicatorNode.createH3OIndicator(valueH3OProperty, {
      x: scaleNode.left + options.majorTickLength,
      tandem: options.tandem.createTandem('indicatorH3ONode')
    });
    const indicatorOHNode = GraphIndicatorNode.createOHIndicator(valueOHProperty, {
      x: scaleNode.right - options.majorTickLength,
      tandem: options.tandem.createTandem('indicatorOHNode')
    });
    this.addChild(indicatorH2ONode);
    this.addChild(indicatorH3ONode);
    this.addChild(indicatorOHNode);

    /*
     * Given a value, compute it's y position relative to the top of the scale.
     * @param value - in model coordinates
     * @param offScaleYOffset - optional y-offset added to the position if the value is off the scale
     * @returns y position in view coordinates
     */
    const valueToY = (value, offScaleYOffset = 0) => {
      const topTickValue = MANTISSA_RANGE.max * Math.pow(10, this.exponentProperty.value);
      value = value || 0;
      if (value > topTickValue) {
        // values out of range are placed in the arrow
        return arrowNode.top + 0.8 * arrowHeadHeight + (offScaleYOffset || 0);
      } else {
        return Utils.linear(0, topTickValue, tickLabels[0].centerY, tickLabels[tickLabels.length - 1].centerY, value);
      }
    };

    // updates the tick labels to match the exponent
    const updateTickLabels = exponent => {
      for (let i = 0; i < tickLabels.length; i++) {
        tickLabels[i].value = i * Math.pow(10, exponent);
        tickLabels[i].centerX = scaleNode.centerX;
      }
    };

    // When the exponent changes, relabel the tick marks
    this.exponentProperty.link(exponent => updateTickLabels(exponent));

    // zoom buttons
    const zoomButtonGroup = new LinearZoomButtonGroup(this.exponentProperty, {
      centerX: scaleNode.centerX,
      top: scaleNode.bottom + 44,
      tandem: options.tandem.createTandem('zoomButtonGroup')
    });
    this.addChild(zoomButtonGroup);

    // Move the indicators
    Multilink.multilink([valueH2OProperty, graphUnitsProperty, this.exponentProperty], (valueH2O, graphUnits, exponent) => {
      // offset the H2O indicator when off scale, so it doesn't butt up again OH indicator
      indicatorH2ONode.y = valueToY(valueH2O, -4);
    });
    Multilink.multilink([valueH3OProperty, graphUnitsProperty, this.exponentProperty], (valueH3O, graphUnits, exponent) => {
      indicatorH3ONode.y = valueToY(valueH3O);
    });
    Multilink.multilink([valueOHProperty, graphUnitsProperty, this.exponentProperty], (valueOH, graphUnits, exponent) => {
      indicatorOHNode.y = valueToY(valueOH);
    });
    this.mutate(options);
  }
  reset() {
    this.exponentProperty.reset();
  }
}

/**
 * TickLabelNode is the label on a tick mark.
 */
class TickLabelNode extends ScientificNotationNode {
  // ScientificNotationNode has a read-only valueProperty. Since we need to modify the labels as we zoom in/out on
  // the graph, keep track of the associated Property, so that we can modify it.

  constructor(value, font) {
    const numberProperty = new NumberProperty(value);
    super(numberProperty, {
      font: font,
      fill: 'black',
      mantissaDecimalPlaces: 0,
      showIntegersAsMantissaOnly: true
    });
    this.numberProperty = numberProperty;
  }
  set value(value) {
    this.numberProperty.value = value;
  }
}
phScale.register('LinearGraphNode', LinearGraphNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJNdWx0aWxpbmsiLCJOdW1iZXJQcm9wZXJ0eSIsIlV0aWxzIiwiU2hhcGUiLCJvcHRpb25pemUiLCJQaGV0Rm9udCIsIlNjaWVudGlmaWNOb3RhdGlvbk5vZGUiLCJMaW5lIiwiTm9kZSIsIlBhdGgiLCJUZXh0IiwicGhTY2FsZSIsIlBoU2NhbGVTdHJpbmdzIiwiUEhTY2FsZUNvbnN0YW50cyIsIkdyYXBoSW5kaWNhdG9yTm9kZSIsIkdyYXBoVW5pdHMiLCJMaW5lYXJab29tQnV0dG9uR3JvdXAiLCJNQU5USVNTQV9SQU5HRSIsIkxJTkVBUl9NQU5USVNTQV9SQU5HRSIsIkxpbmVhckdyYXBoTm9kZSIsImNvbnN0cnVjdG9yIiwiZGVyaXZlZFByb3BlcnRpZXMiLCJncmFwaFVuaXRzUHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwic2NhbGVIZWlnaHQiLCJtaW5TY2FsZVdpZHRoIiwic2NhbGVGaWxsIiwic2NhbGVTdHJva2UiLCJzY2FsZUxpbmVXaWR0aCIsInNjYWxlWU1hcmdpbiIsImFycm93SGVpZ2h0IiwibWFqb3JUaWNrRm9udCIsIm1ham9yVGlja1N0cm9rZSIsIm1ham9yVGlja0xlbmd0aCIsIm1ham9yVGlja0xpbmVXaWR0aCIsIm1ham9yVGlja1hTcGFjaW5nIiwidmlzaWJsZVByb3BlcnR5T3B0aW9ucyIsInBoZXRpb1JlYWRPbmx5IiwiZXhwb25lbnRQcm9wZXJ0eSIsIkxJTkVBUl9FWFBPTkVOVF9SQU5HRSIsIm1heCIsIm51bWJlclR5cGUiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJyYW5nZSIsInBoZXRpb0RvY3VtZW50YXRpb24iLCJzY2FsZVdpZHRoIiwiYXJyb3dXaWR0aCIsImFycm93SGVhZEhlaWdodCIsImFycm93R2FwIiwiYXJyb3dOb2RlIiwibW92ZVRvIiwibGluZVRvIiwiY3ViaWNDdXJ2ZVRvIiwiY2xvc2UiLCJmaWxsIiwic3Ryb2tlIiwibGluZVdpZHRoIiwidG9wIiwiYWRkQ2hpbGQiLCJzY2FsZU5vZGUiLCJvZmZTY2FsZVRleHQiLCJvZmZTY2FsZVN0cmluZ1Byb3BlcnR5IiwiZm9udCIsIm1heFdpZHRoIiwiY2VudGVyWCIsInkiLCJ0aWNrTGFiZWxzIiwibnVtYmVyT2ZUaWNrcyIsImdldExlbmd0aCIsInlTcGFjaW5nIiwidGlja0xhYmVsIiwidGlja0xpbmVMZWZ0IiwidGlja0xpbmVSaWdodCIsImkiLCJUaWNrTGFiZWxOb2RlIiwibGVmdCIsImNlbnRlclkiLCJib3R0b20iLCJyaWdodCIsInB1c2giLCJ2YWx1ZUgyT1Byb3BlcnR5IiwiY29uY2VudHJhdGlvbkgyT1Byb3BlcnR5IiwicXVhbnRpdHlIMk9Qcm9wZXJ0eSIsImNvbmNlbnRyYXRpb24iLCJxdWFudGl0eSIsImdyYXBoVW5pdHMiLCJNT0xFU19QRVJfTElURVIiLCJ2YWx1ZUgzT1Byb3BlcnR5IiwiY29uY2VudHJhdGlvbkgzT1Byb3BlcnR5IiwicXVhbnRpdHlIM09Qcm9wZXJ0eSIsInZhbHVlT0hQcm9wZXJ0eSIsImNvbmNlbnRyYXRpb25PSFByb3BlcnR5IiwicXVhbnRpdHlPSFByb3BlcnR5IiwiaW5kaWNhdG9ySDJPTm9kZSIsImNyZWF0ZUgyT0luZGljYXRvciIsIngiLCJpbmRpY2F0b3JIM09Ob2RlIiwiY3JlYXRlSDNPSW5kaWNhdG9yIiwiaW5kaWNhdG9yT0hOb2RlIiwiY3JlYXRlT0hJbmRpY2F0b3IiLCJ2YWx1ZVRvWSIsInZhbHVlIiwib2ZmU2NhbGVZT2Zmc2V0IiwidG9wVGlja1ZhbHVlIiwiTWF0aCIsInBvdyIsImxpbmVhciIsImxlbmd0aCIsInVwZGF0ZVRpY2tMYWJlbHMiLCJleHBvbmVudCIsImxpbmsiLCJ6b29tQnV0dG9uR3JvdXAiLCJtdWx0aWxpbmsiLCJ2YWx1ZUgyTyIsInZhbHVlSDNPIiwidmFsdWVPSCIsIm11dGF0ZSIsInJlc2V0IiwibnVtYmVyUHJvcGVydHkiLCJtYW50aXNzYURlY2ltYWxQbGFjZXMiLCJzaG93SW50ZWdlcnNBc01hbnRpc3NhT25seSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiTGluZWFyR3JhcGhOb2RlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEdyYXBoIHdpdGggYSBsaW5lYXIgc2NhbGUsIGZvciBkaXNwbGF5aW5nIGNvbmNlbnRyYXRpb24gKG1vbC9MKSBhbmQgcXVhbnRpdHkgKG1vbGVzKS5cclxuICogU29tZSBvZiB0aGUgY29kZSByZWxhdGVkIHRvIGluZGljYXRvcnMgKGluaXRpYWxpemF0aW9uIGFuZCB1cGRhdGVJbmRpY2F0b3JzKSBpcyBzaW1pbGFyXHJcbiAqIHRvIExvZ2FyaXRobWljR3JhcGguIEJ1dCBpdCB3YXMgZGlmZmljdWx0IHRvIGlkZW50aWZ5IGEgbmF0dXJhbCBwYXR0ZXJuIGZvciBmYWN0b3JpbmdcclxuICogdGhpcyBvdXQsIHNvIEkgY2hvc2UgdG8gbGVhdmUgaXQgYXMgaXMuIFNlZSBpc3N1ZSAjMTYuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBFbnVtZXJhdGlvblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uLy4uL2F4b24vanMvRW51bWVyYXRpb25Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBNdWx0aWxpbmsgZnJvbSAnLi4vLi4vLi4vLi4vLi4vYXhvbi9qcy9NdWx0aWxpbmsuanMnO1xyXG5pbXBvcnQgTnVtYmVyUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vLi4vYXhvbi9qcy9OdW1iZXJQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBQaWNrUmVxdWlyZWQgZnJvbSAnLi4vLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1BpY2tSZXF1aXJlZC5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgU2NpZW50aWZpY05vdGF0aW9uTm9kZSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvU2NpZW50aWZpY05vdGF0aW9uTm9kZS5qcyc7XHJcbmltcG9ydCB7IEZvbnQsIExpbmUsIE5vZGUsIE5vZGVPcHRpb25zLCBOb2RlVHJhbnNsYXRpb25PcHRpb25zLCBQYXRoLCBUQ29sb3IsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgcGhTY2FsZSBmcm9tICcuLi8uLi8uLi9waFNjYWxlLmpzJztcclxuaW1wb3J0IFBoU2NhbGVTdHJpbmdzIGZyb20gJy4uLy4uLy4uL1BoU2NhbGVTdHJpbmdzLmpzJztcclxuaW1wb3J0IFNvbHV0aW9uRGVyaXZlZFByb3BlcnRpZXMgZnJvbSAnLi4vLi4vbW9kZWwvU29sdXRpb25EZXJpdmVkUHJvcGVydGllcy5qcyc7XHJcbmltcG9ydCBQSFNjYWxlQ29uc3RhbnRzIGZyb20gJy4uLy4uL1BIU2NhbGVDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgR3JhcGhJbmRpY2F0b3JOb2RlIGZyb20gJy4vR3JhcGhJbmRpY2F0b3JOb2RlLmpzJztcclxuaW1wb3J0IEdyYXBoVW5pdHMgZnJvbSAnLi9HcmFwaFVuaXRzLmpzJztcclxuaW1wb3J0IExpbmVhclpvb21CdXR0b25Hcm91cCBmcm9tICcuL0xpbmVhclpvb21CdXR0b25Hcm91cC5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgTUFOVElTU0FfUkFOR0UgPSBQSFNjYWxlQ29uc3RhbnRzLkxJTkVBUl9NQU5USVNTQV9SQU5HRTtcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcblxyXG4gIC8vIHNjYWxlXHJcbiAgc2NhbGVIZWlnaHQ/OiBudW1iZXI7XHJcbiAgbWluU2NhbGVXaWR0aD86IG51bWJlcjtcclxuICBzY2FsZUZpbGw/OiBUQ29sb3I7XHJcbiAgc2NhbGVTdHJva2U/OiBUQ29sb3I7XHJcbiAgc2NhbGVMaW5lV2lkdGg/OiBudW1iZXI7XHJcbiAgc2NhbGVZTWFyZ2luPzogbnVtYmVyO1xyXG5cclxuICAvLyBhcnJvdyBhdCB0b3Agb2Ygc2NhbGVcclxuICBhcnJvd0hlaWdodD86IG51bWJlcjtcclxuXHJcbiAgLy8gbWFqb3IgdGlja3NcclxuICBtYWpvclRpY2tGb250PzogRm9udDtcclxuICBtYWpvclRpY2tTdHJva2U/OiBUQ29sb3I7XHJcbiAgbWFqb3JUaWNrTGVuZ3RoPzogbnVtYmVyO1xyXG4gIG1ham9yVGlja0xpbmVXaWR0aD86IG51bWJlcjtcclxuICBtYWpvclRpY2tYU3BhY2luZz86IG51bWJlcjtcclxufTtcclxuXHJcbnR5cGUgTGluZWFyR3JhcGhOb2RlT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgTm9kZVRyYW5zbGF0aW9uT3B0aW9ucyAmIFBpY2tSZXF1aXJlZDxOb2RlT3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGluZWFyR3JhcGhOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZXhwb25lbnRQcm9wZXJ0eTogTnVtYmVyUHJvcGVydHk7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggZGVyaXZlZFByb3BlcnRpZXM6IFNvbHV0aW9uRGVyaXZlZFByb3BlcnRpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICBncmFwaFVuaXRzUHJvcGVydHk6IEVudW1lcmF0aW9uUHJvcGVydHk8R3JhcGhVbml0cz4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM6IExpbmVhckdyYXBoTm9kZU9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxMaW5lYXJHcmFwaE5vZGVPcHRpb25zLCBTZWxmT3B0aW9ucywgTm9kZU9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIFNlbGZPcHRpb25zXHJcbiAgICAgIHNjYWxlSGVpZ2h0OiAxMDAsXHJcbiAgICAgIG1pblNjYWxlV2lkdGg6IDEwMCxcclxuICAgICAgc2NhbGVGaWxsOiAncmdiKCAyMzAsIDIzMCwgMjMwICknLFxyXG4gICAgICBzY2FsZVN0cm9rZTogJ2JsYWNrJyxcclxuICAgICAgc2NhbGVMaW5lV2lkdGg6IDIsXHJcbiAgICAgIHNjYWxlWU1hcmdpbjogMzAsXHJcbiAgICAgIGFycm93SGVpZ2h0OiA3NSxcclxuICAgICAgbWFqb3JUaWNrRm9udDogbmV3IFBoZXRGb250KCAxOCApLFxyXG4gICAgICBtYWpvclRpY2tTdHJva2U6ICdibGFjaycsXHJcbiAgICAgIG1ham9yVGlja0xlbmd0aDogMTAsXHJcbiAgICAgIG1ham9yVGlja0xpbmVXaWR0aDogMSxcclxuICAgICAgbWFqb3JUaWNrWFNwYWNpbmc6IDUsXHJcblxyXG4gICAgICAvLyBOb2RlT3B0aW9uc1xyXG4gICAgICB2aXNpYmxlUHJvcGVydHlPcHRpb25zOiB7XHJcbiAgICAgICAgcGhldGlvUmVhZE9ubHk6IHRydWVcclxuICAgICAgfVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICB0aGlzLmV4cG9uZW50UHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIFBIU2NhbGVDb25zdGFudHMuTElORUFSX0VYUE9ORU5UX1JBTkdFLm1heCwge1xyXG4gICAgICBudW1iZXJUeXBlOiAnSW50ZWdlcicsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZXhwb25lbnRQcm9wZXJ0eScgKSxcclxuICAgICAgcmFuZ2U6IFBIU2NhbGVDb25zdGFudHMuTElORUFSX0VYUE9ORU5UX1JBTkdFLFxyXG4gICAgICBwaGV0aW9SZWFkT25seTogdHJ1ZSxcclxuICAgICAgcGhldGlvRG9jdW1lbnRhdGlvbjogJ2V4cG9uZW50IG9uIHRoZSBsaW5lYXIgc2NhbGUnXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3Qgc2NhbGVXaWR0aCA9IG9wdGlvbnMubWluU2NhbGVXaWR0aDtcclxuICAgIGNvbnN0IHNjYWxlSGVpZ2h0ID0gb3B0aW9ucy5zY2FsZUhlaWdodDtcclxuICAgIGNvbnN0IGFycm93V2lkdGggPSAxLjUgKiBzY2FsZVdpZHRoO1xyXG4gICAgY29uc3QgYXJyb3dIZWlnaHQgPSBvcHRpb25zLmFycm93SGVpZ2h0O1xyXG4gICAgY29uc3QgYXJyb3dIZWFkSGVpZ2h0ID0gMC44NSAqIGFycm93SGVpZ2h0O1xyXG4gICAgY29uc3QgYXJyb3dHYXAgPSAtMTA7IC8vIHRoaXMgY29udHJvbHMgdGhlIHZlcnRpY2FsIGdhcCBiZXR3ZWVuIHRoZSBhcnJvdyBhbmQgdGhlIHNjYWxlXHJcblxyXG4gICAgLy8gYXJyb3cgYWJvdmUgc2NhbGUsIHN0YXJ0aW5nIGZyb20gYXJyb3cgdGlwIGFuZCBtb3ZpbmcgY2xvY2t3aXNlXHJcbiAgICBjb25zdCBhcnJvd05vZGUgPSBuZXcgUGF0aCggbmV3IFNoYXBlKClcclxuICAgICAgICAubW92ZVRvKCAwLCAwIClcclxuICAgICAgICAubGluZVRvKCBhcnJvd1dpZHRoIC8gMiwgYXJyb3dIZWFkSGVpZ2h0IClcclxuICAgICAgICAubGluZVRvKCBzY2FsZVdpZHRoIC8gMiwgYXJyb3dIZWFkSGVpZ2h0IClcclxuICAgICAgICAubGluZVRvKCBzY2FsZVdpZHRoIC8gMiwgYXJyb3dIZWlnaHQgKVxyXG4gICAgICAgIC5jdWJpY0N1cnZlVG8oIC1zY2FsZVdpZHRoIC8gNCwgMC43NSAqIGFycm93SGVpZ2h0LCBzY2FsZVdpZHRoIC8gNCwgMS4yNSAqIGFycm93SGVpZ2h0LCAtc2NhbGVXaWR0aCAvIDIsIGFycm93SGVpZ2h0IClcclxuICAgICAgICAubGluZVRvKCAtc2NhbGVXaWR0aCAvIDIsIGFycm93SGVhZEhlaWdodCApXHJcbiAgICAgICAgLmxpbmVUbyggLWFycm93V2lkdGggLyAyLCBhcnJvd0hlYWRIZWlnaHQgKVxyXG4gICAgICAgIC5jbG9zZSgpLFxyXG4gICAgICB7IGZpbGw6IG9wdGlvbnMuc2NhbGVGaWxsLCBzdHJva2U6IG9wdGlvbnMuc2NhbGVTdHJva2UsIGxpbmVXaWR0aDogb3B0aW9ucy5zY2FsZUxpbmVXaWR0aCwgdG9wOiBhcnJvd0dhcCB9XHJcbiAgICApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggYXJyb3dOb2RlICk7XHJcblxyXG4gICAgLy8gc2NhbGUgYmVsb3cgdGhlIGFycm93XHJcbiAgICBjb25zdCBzY2FsZU5vZGUgPSBuZXcgUGF0aCggbmV3IFNoYXBlKClcclxuICAgICAgICAubW92ZVRvKCAtc2NhbGVXaWR0aCAvIDIsIGFycm93SGVpZ2h0IClcclxuICAgICAgICAuY3ViaWNDdXJ2ZVRvKCBzY2FsZVdpZHRoIC8gNCwgMS4yNSAqIGFycm93SGVpZ2h0LCAtc2NhbGVXaWR0aCAvIDQsIDAuNzUgKiBhcnJvd0hlaWdodCwgc2NhbGVXaWR0aCAvIDIsIGFycm93SGVpZ2h0IClcclxuICAgICAgICAubGluZVRvKCBzY2FsZVdpZHRoIC8gMiwgc2NhbGVIZWlnaHQgKVxyXG4gICAgICAgIC5saW5lVG8oIC1zY2FsZVdpZHRoIC8gMiwgc2NhbGVIZWlnaHQgKVxyXG4gICAgICAgIC5jbG9zZSgpLFxyXG4gICAgICB7IGZpbGw6IG9wdGlvbnMuc2NhbGVGaWxsLCBzdHJva2U6IG9wdGlvbnMuc2NhbGVTdHJva2UsIGxpbmVXaWR0aDogb3B0aW9ucy5zY2FsZUxpbmVXaWR0aCB9XHJcbiAgICApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggc2NhbGVOb2RlICk7XHJcblxyXG4gICAgLy8gJ29mZiBzY2FsZScgbGFiZWwsIHBvc2l0aW9uZWQgaW5zaWRlIGFycm93XHJcbiAgICBjb25zdCBvZmZTY2FsZVRleHQgPSBuZXcgVGV4dCggUGhTY2FsZVN0cmluZ3Mub2ZmU2NhbGVTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIDE4ICksXHJcbiAgICAgIGZpbGw6ICdibGFjaycsXHJcbiAgICAgIG1heFdpZHRoOiAwLjUgKiBhcnJvd1dpZHRoXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBvZmZTY2FsZVRleHQgKTtcclxuICAgIG9mZlNjYWxlVGV4dC5jZW50ZXJYID0gYXJyb3dOb2RlLmNlbnRlclg7XHJcbiAgICBvZmZTY2FsZVRleHQueSA9IGFycm93Tm9kZS50b3AgKyAoIDAuODUgKiBhcnJvd0hlYWRIZWlnaHQgKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIHRpY2sgbWFya3MuIENvcnJlY3QgbGFiZWxzIHdpbGwgYmUgYXNzaWduZWQgbGF0ZXIuXHJcbiAgICBjb25zdCB0aWNrTGFiZWxzOiBUaWNrTGFiZWxOb2RlW10gPSBbXTtcclxuICAgIGNvbnN0IG51bWJlck9mVGlja3MgPSBNQU5USVNTQV9SQU5HRS5nZXRMZW5ndGgoKSArIDE7XHJcbiAgICBjb25zdCB5U3BhY2luZyA9ICggc2NhbGVIZWlnaHQgLSBhcnJvd0hlaWdodCAtICggMiAqIG9wdGlvbnMuc2NhbGVZTWFyZ2luICkgKSAvICggbnVtYmVyT2ZUaWNrcyAtIDEgKTsgLy8gdmVydGljYWwgc3BhY2UgYmV0d2VlbiB0aWNrc1xyXG4gICAgbGV0IHRpY2tMYWJlbDtcclxuICAgIGxldCB0aWNrTGluZUxlZnQ7XHJcbiAgICBsZXQgdGlja0xpbmVSaWdodDtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IG51bWJlck9mVGlja3M7IGkrKyApIHtcclxuXHJcbiAgICAgIC8vIG1ham9yIGxpbmVzIGFuZCBsYWJlbFxyXG4gICAgICB0aWNrTGluZUxlZnQgPSBuZXcgTGluZSggMCwgMCwgb3B0aW9ucy5tYWpvclRpY2tMZW5ndGgsIDAsIHtcclxuICAgICAgICBzdHJva2U6IG9wdGlvbnMubWFqb3JUaWNrU3Ryb2tlLFxyXG4gICAgICAgIGxpbmVXaWR0aDogb3B0aW9ucy5tYWpvclRpY2tMaW5lV2lkdGhcclxuICAgICAgfSApO1xyXG4gICAgICB0aWNrTGluZVJpZ2h0ID0gbmV3IExpbmUoIDAsIDAsIG9wdGlvbnMubWFqb3JUaWNrTGVuZ3RoLCAwLCB7XHJcbiAgICAgICAgc3Ryb2tlOiBvcHRpb25zLm1ham9yVGlja1N0cm9rZSxcclxuICAgICAgICBsaW5lV2lkdGg6IG9wdGlvbnMubWFqb3JUaWNrTGluZVdpZHRoXHJcbiAgICAgIH0gKTtcclxuICAgICAgdGlja0xhYmVsID0gbmV3IFRpY2tMYWJlbE5vZGUoIGksIG9wdGlvbnMubWFqb3JUaWNrRm9udCApO1xyXG5cclxuICAgICAgLy8gcmVuZGVyaW5nIG9yZGVyXHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIHRpY2tMaW5lTGVmdCApO1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCB0aWNrTGluZVJpZ2h0ICk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIHRpY2tMYWJlbCApO1xyXG5cclxuICAgICAgLy8gbGF5b3V0XHJcbiAgICAgIHRpY2tMaW5lTGVmdC5sZWZ0ID0gc2NhbGVOb2RlLmxlZnQ7XHJcbiAgICAgIHRpY2tMaW5lTGVmdC5jZW50ZXJZID0gc2NhbGVOb2RlLmJvdHRvbSAtIG9wdGlvbnMuc2NhbGVZTWFyZ2luIC0gKCBpICogeVNwYWNpbmcgKTtcclxuICAgICAgdGlja0xpbmVSaWdodC5yaWdodCA9IHNjYWxlTm9kZS5yaWdodDtcclxuICAgICAgdGlja0xpbmVSaWdodC5jZW50ZXJZID0gdGlja0xpbmVMZWZ0LmNlbnRlclk7XHJcbiAgICAgIHRpY2tMYWJlbC5jZW50ZXJYID0gc2NhbGVOb2RlLmNlbnRlclg7XHJcbiAgICAgIHRpY2tMYWJlbC5jZW50ZXJZID0gdGlja0xpbmVMZWZ0LmNlbnRlclk7XHJcblxyXG4gICAgICAvLyBzYXZlIGxhYmVsIHNvIHdlIGNhbiB1cGRhdGUgaXQgbGF5ZXJcclxuICAgICAgdGlja0xhYmVscy5wdXNoKCB0aWNrTGFiZWwgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWx1ZXMgZGlzcGxheWVkIG9uIHRoZSBpbmRpY2F0b3JzXHJcbiAgICBjb25zdCB2YWx1ZUgyT1Byb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyBkZXJpdmVkUHJvcGVydGllcy5jb25jZW50cmF0aW9uSDJPUHJvcGVydHksIGRlcml2ZWRQcm9wZXJ0aWVzLnF1YW50aXR5SDJPUHJvcGVydHksIGdyYXBoVW5pdHNQcm9wZXJ0eSBdLFxyXG4gICAgICAoIGNvbmNlbnRyYXRpb24sIHF1YW50aXR5LCBncmFwaFVuaXRzICkgPT5cclxuICAgICAgICAoIGdyYXBoVW5pdHMgPT09IEdyYXBoVW5pdHMuTU9MRVNfUEVSX0xJVEVSICkgPyBjb25jZW50cmF0aW9uIDogcXVhbnRpdHlcclxuICAgICk7XHJcbiAgICBjb25zdCB2YWx1ZUgzT1Byb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyBkZXJpdmVkUHJvcGVydGllcy5jb25jZW50cmF0aW9uSDNPUHJvcGVydHksIGRlcml2ZWRQcm9wZXJ0aWVzLnF1YW50aXR5SDNPUHJvcGVydHksIGdyYXBoVW5pdHNQcm9wZXJ0eSBdLFxyXG4gICAgICAoIGNvbmNlbnRyYXRpb24sIHF1YW50aXR5LCBncmFwaFVuaXRzICkgPT5cclxuICAgICAgICAoIGdyYXBoVW5pdHMgPT09IEdyYXBoVW5pdHMuTU9MRVNfUEVSX0xJVEVSICkgPyBjb25jZW50cmF0aW9uIDogcXVhbnRpdHlcclxuICAgICk7XHJcbiAgICBjb25zdCB2YWx1ZU9IUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICBbIGRlcml2ZWRQcm9wZXJ0aWVzLmNvbmNlbnRyYXRpb25PSFByb3BlcnR5LCBkZXJpdmVkUHJvcGVydGllcy5xdWFudGl0eU9IUHJvcGVydHksIGdyYXBoVW5pdHNQcm9wZXJ0eSBdLFxyXG4gICAgICAoIGNvbmNlbnRyYXRpb24sIHF1YW50aXR5LCBncmFwaFVuaXRzICkgPT5cclxuICAgICAgICAoIGdyYXBoVW5pdHMgPT09IEdyYXBoVW5pdHMuTU9MRVNfUEVSX0xJVEVSICkgPyBjb25jZW50cmF0aW9uIDogcXVhbnRpdHlcclxuICAgICk7XHJcblxyXG4gICAgLy8gaW5kaWNhdG9yc1xyXG4gICAgY29uc3QgaW5kaWNhdG9ySDJPTm9kZSA9IEdyYXBoSW5kaWNhdG9yTm9kZS5jcmVhdGVIMk9JbmRpY2F0b3IoIHZhbHVlSDJPUHJvcGVydHksIHtcclxuICAgICAgeDogc2NhbGVOb2RlLnJpZ2h0IC0gb3B0aW9ucy5tYWpvclRpY2tMZW5ndGgsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnaW5kaWNhdG9ySDJPTm9kZScgKVxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgaW5kaWNhdG9ySDNPTm9kZSA9IEdyYXBoSW5kaWNhdG9yTm9kZS5jcmVhdGVIM09JbmRpY2F0b3IoIHZhbHVlSDNPUHJvcGVydHksIHtcclxuICAgICAgeDogc2NhbGVOb2RlLmxlZnQgKyBvcHRpb25zLm1ham9yVGlja0xlbmd0aCxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdpbmRpY2F0b3JIM09Ob2RlJyApXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBpbmRpY2F0b3JPSE5vZGUgPSBHcmFwaEluZGljYXRvck5vZGUuY3JlYXRlT0hJbmRpY2F0b3IoIHZhbHVlT0hQcm9wZXJ0eSwge1xyXG4gICAgICB4OiBzY2FsZU5vZGUucmlnaHQgLSBvcHRpb25zLm1ham9yVGlja0xlbmd0aCxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdpbmRpY2F0b3JPSE5vZGUnIClcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGluZGljYXRvckgyT05vZGUgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGluZGljYXRvckgzT05vZGUgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGluZGljYXRvck9ITm9kZSApO1xyXG5cclxuICAgIC8qXHJcbiAgICAgKiBHaXZlbiBhIHZhbHVlLCBjb21wdXRlIGl0J3MgeSBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGUgdG9wIG9mIHRoZSBzY2FsZS5cclxuICAgICAqIEBwYXJhbSB2YWx1ZSAtIGluIG1vZGVsIGNvb3JkaW5hdGVzXHJcbiAgICAgKiBAcGFyYW0gb2ZmU2NhbGVZT2Zmc2V0IC0gb3B0aW9uYWwgeS1vZmZzZXQgYWRkZWQgdG8gdGhlIHBvc2l0aW9uIGlmIHRoZSB2YWx1ZSBpcyBvZmYgdGhlIHNjYWxlXHJcbiAgICAgKiBAcmV0dXJucyB5IHBvc2l0aW9uIGluIHZpZXcgY29vcmRpbmF0ZXNcclxuICAgICAqL1xyXG4gICAgY29uc3QgdmFsdWVUb1kgPSAoIHZhbHVlOiBudW1iZXIgfCBudWxsLCBvZmZTY2FsZVlPZmZzZXQgPSAwICkgPT4ge1xyXG4gICAgICBjb25zdCB0b3BUaWNrVmFsdWUgPSBNQU5USVNTQV9SQU5HRS5tYXggKiBNYXRoLnBvdyggMTAsIHRoaXMuZXhwb25lbnRQcm9wZXJ0eS52YWx1ZSApO1xyXG4gICAgICB2YWx1ZSA9IHZhbHVlIHx8IDA7XHJcbiAgICAgIGlmICggdmFsdWUgPiB0b3BUaWNrVmFsdWUgKSB7XHJcbiAgICAgICAgLy8gdmFsdWVzIG91dCBvZiByYW5nZSBhcmUgcGxhY2VkIGluIHRoZSBhcnJvd1xyXG4gICAgICAgIHJldHVybiBhcnJvd05vZGUudG9wICsgKCAwLjggKiBhcnJvd0hlYWRIZWlnaHQgKSArICggb2ZmU2NhbGVZT2Zmc2V0IHx8IDAgKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gVXRpbHMubGluZWFyKCAwLCB0b3BUaWNrVmFsdWUsIHRpY2tMYWJlbHNbIDAgXS5jZW50ZXJZLCB0aWNrTGFiZWxzWyB0aWNrTGFiZWxzLmxlbmd0aCAtIDEgXS5jZW50ZXJZLCB2YWx1ZSApO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIHVwZGF0ZXMgdGhlIHRpY2sgbGFiZWxzIHRvIG1hdGNoIHRoZSBleHBvbmVudFxyXG4gICAgY29uc3QgdXBkYXRlVGlja0xhYmVscyA9ICggZXhwb25lbnQ6IG51bWJlciApID0+IHtcclxuICAgICAgZm9yICggbGV0IGkgPSAwOyBpIDwgdGlja0xhYmVscy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICB0aWNrTGFiZWxzWyBpIF0udmFsdWUgPSAoIGkgKiBNYXRoLnBvdyggMTAsIGV4cG9uZW50ICkgKTtcclxuICAgICAgICB0aWNrTGFiZWxzWyBpIF0uY2VudGVyWCA9IHNjYWxlTm9kZS5jZW50ZXJYO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFdoZW4gdGhlIGV4cG9uZW50IGNoYW5nZXMsIHJlbGFiZWwgdGhlIHRpY2sgbWFya3NcclxuICAgIHRoaXMuZXhwb25lbnRQcm9wZXJ0eS5saW5rKCBleHBvbmVudCA9PiB1cGRhdGVUaWNrTGFiZWxzKCBleHBvbmVudCApICk7XHJcblxyXG4gICAgLy8gem9vbSBidXR0b25zXHJcbiAgICBjb25zdCB6b29tQnV0dG9uR3JvdXAgPSBuZXcgTGluZWFyWm9vbUJ1dHRvbkdyb3VwKCB0aGlzLmV4cG9uZW50UHJvcGVydHksIHtcclxuICAgICAgY2VudGVyWDogc2NhbGVOb2RlLmNlbnRlclgsXHJcbiAgICAgIHRvcDogc2NhbGVOb2RlLmJvdHRvbSArIDQ0LFxyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3pvb21CdXR0b25Hcm91cCcgKVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggem9vbUJ1dHRvbkdyb3VwICk7XHJcblxyXG4gICAgLy8gTW92ZSB0aGUgaW5kaWNhdG9yc1xyXG4gICAgTXVsdGlsaW5rLm11bHRpbGluayggWyB2YWx1ZUgyT1Byb3BlcnR5LCBncmFwaFVuaXRzUHJvcGVydHksIHRoaXMuZXhwb25lbnRQcm9wZXJ0eSBdLFxyXG4gICAgICAoIHZhbHVlSDJPLCBncmFwaFVuaXRzLCBleHBvbmVudCApID0+IHtcclxuICAgICAgICAvLyBvZmZzZXQgdGhlIEgyTyBpbmRpY2F0b3Igd2hlbiBvZmYgc2NhbGUsIHNvIGl0IGRvZXNuJ3QgYnV0dCB1cCBhZ2FpbiBPSCBpbmRpY2F0b3JcclxuICAgICAgICBpbmRpY2F0b3JIMk9Ob2RlLnkgPSB2YWx1ZVRvWSggdmFsdWVIMk8sIC00ICk7XHJcbiAgICAgIH0gKTtcclxuICAgIE11bHRpbGluay5tdWx0aWxpbmsoIFsgdmFsdWVIM09Qcm9wZXJ0eSwgZ3JhcGhVbml0c1Byb3BlcnR5LCB0aGlzLmV4cG9uZW50UHJvcGVydHkgXSxcclxuICAgICAgKCB2YWx1ZUgzTywgZ3JhcGhVbml0cywgZXhwb25lbnQgKSA9PiB7XHJcbiAgICAgICAgaW5kaWNhdG9ySDNPTm9kZS55ID0gdmFsdWVUb1koIHZhbHVlSDNPICk7XHJcbiAgICAgIH0gKTtcclxuICAgIE11bHRpbGluay5tdWx0aWxpbmsoIFsgdmFsdWVPSFByb3BlcnR5LCBncmFwaFVuaXRzUHJvcGVydHksIHRoaXMuZXhwb25lbnRQcm9wZXJ0eSBdLFxyXG4gICAgICAoIHZhbHVlT0gsIGdyYXBoVW5pdHMsIGV4cG9uZW50ICkgPT4ge1xyXG4gICAgICAgIGluZGljYXRvck9ITm9kZS55ID0gdmFsdWVUb1koIHZhbHVlT0ggKTtcclxuICAgICAgfSApO1xyXG5cclxuICAgIHRoaXMubXV0YXRlKCBvcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcmVzZXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmV4cG9uZW50UHJvcGVydHkucmVzZXQoKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaWNrTGFiZWxOb2RlIGlzIHRoZSBsYWJlbCBvbiBhIHRpY2sgbWFyay5cclxuICovXHJcbmNsYXNzIFRpY2tMYWJlbE5vZGUgZXh0ZW5kcyBTY2llbnRpZmljTm90YXRpb25Ob2RlIHtcclxuXHJcbiAgLy8gU2NpZW50aWZpY05vdGF0aW9uTm9kZSBoYXMgYSByZWFkLW9ubHkgdmFsdWVQcm9wZXJ0eS4gU2luY2Ugd2UgbmVlZCB0byBtb2RpZnkgdGhlIGxhYmVscyBhcyB3ZSB6b29tIGluL291dCBvblxyXG4gIC8vIHRoZSBncmFwaCwga2VlcCB0cmFjayBvZiB0aGUgYXNzb2NpYXRlZCBQcm9wZXJ0eSwgc28gdGhhdCB3ZSBjYW4gbW9kaWZ5IGl0LlxyXG4gIHByaXZhdGUgcmVhZG9ubHkgbnVtYmVyUHJvcGVydHk6IE51bWJlclByb3BlcnR5O1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHZhbHVlOiBudW1iZXIsIGZvbnQ6IEZvbnQgKSB7XHJcblxyXG4gICAgY29uc3QgbnVtYmVyUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIHZhbHVlICk7XHJcblxyXG4gICAgc3VwZXIoIG51bWJlclByb3BlcnR5LCB7XHJcbiAgICAgIGZvbnQ6IGZvbnQsXHJcbiAgICAgIGZpbGw6ICdibGFjaycsXHJcbiAgICAgIG1hbnRpc3NhRGVjaW1hbFBsYWNlczogMCxcclxuICAgICAgc2hvd0ludGVnZXJzQXNNYW50aXNzYU9ubHk6IHRydWVcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLm51bWJlclByb3BlcnR5ID0gbnVtYmVyUHJvcGVydHk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0IHZhbHVlKCB2YWx1ZTogbnVtYmVyICkge1xyXG4gICAgdGhpcy5udW1iZXJQcm9wZXJ0eS52YWx1ZSA9IHZhbHVlO1xyXG4gIH1cclxufVxyXG5cclxucGhTY2FsZS5yZWdpc3RlciggJ0xpbmVhckdyYXBoTm9kZScsIExpbmVhckdyYXBoTm9kZSApOyJdLCJtYXBw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