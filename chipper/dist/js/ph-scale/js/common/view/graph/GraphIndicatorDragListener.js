// Copyright 2014-2022, University of Colorado Boulder

/**
 * Drag handler for the interactive graph indicators.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Utils from '../../../../../dot/js/Utils.js';
import ScientificNotationNode from '../../../../../scenery-phet/js/ScientificNotationNode.js';
import { DragListener } from '../../../../../scenery/js/imports.js';
import phScale from '../../../phScale.js';
import PHScaleConstants from '../../PHScaleConstants.js';
import GraphUnits from './GraphUnits.js';
export default class GraphIndicatorDragListener extends DragListener {
  /**
   * @param targetNode
   * @param pHProperty - pH of the solution
   * @param totalVolumeProperty - volume of the solution
   * @param graphUnitsProperty
   * @param yToValue - converts a y view coordinate to a model value
   * @param concentrationToPH - converts concentration to pH
   * @param molesToPH - converts moles + volume to pH
   * @param startCallback - called when drag starts
   * @param tandem
   */
  constructor(targetNode, pHProperty, totalVolumeProperty, graphUnitsProperty, yToValue, concentrationToPH, molesToPH, startCallback, tandem) {
    let clickYOffset; // y-offset between initial click and indicator's origin

    super({
      allowTouchSnag: true,
      // Record the offset between the pointer and the indicator's origin.
      start: event => {
        startCallback();
        clickYOffset = targetNode.globalToParentPoint(event.pointer.point).y - targetNode.y;
      },
      // When the indicator is dragged, create a custom solute that corresponds to the new pH.
      drag: event => {
        // Adjust the y-coordinate for the offset between the pointer and the indicator's origin
        const yView = targetNode.globalToParentPoint(event.pointer.point).y - clickYOffset;
        GraphIndicatorDragListener.doDrag(yView, targetNode, pHProperty, totalVolumeProperty.value, graphUnitsProperty.value, yToValue, concentrationToPH, molesToPH);
      },
      // phet-io
      tandem: tandem
    });
  }

  /**
   * When the indicator is dragged, create a custom solute that corresponds to the new pH.
   * This is used by both GraphIndicatorDragListener and GraphIndicatorKeyboardDragListener.
   */
  static doDrag(yView, targetNode, pHProperty, totalVolume, graphUnits, yToValue, concentrationToPH, molesToPH) {
    // If the solution volume is zero (empty beaker), then we have no solution, and therefore no pH, so do nothing.
    if (totalVolume !== 0) {
      // Convert the y-coordinate to a model value.
      const value = yToValue(yView);
      assert && assert(value > 0);

      // Round the model value to the first 2 non-zero decimal places. This prevents continuous dragging from
      // creating values that have too much precision, which can result in pH = 7.00 with unequal amounts of
      // H3O+ and OH-. See https://github.com/phetsims/ph-scale/issues/225.
      const scientificNotation = ScientificNotationNode.toScientificNotation(value, {
        mantissaDecimalPlaces: PHScaleConstants.LOGARITHMIC_MANTISSA_DECIMAL_PLACES
      });
      const exponent = +scientificNotation.exponent - PHScaleConstants.LOGARITHMIC_MANTISSA_DECIMAL_PLACES;
      const interval = Math.pow(10, exponent);
      let adjustedValue = Utils.roundToInterval(value, interval);

      // Workaround for https://github.com/phetsims/ph-scale/issues/225.
      // For one value (9.9e-8), the precision of what we're displaying results in a situation where we have
      // different concentrations of H3O+ and OH-, but are displaying a neutral pH of 7.00.  So we decided
      // that it was preferable to avoid that value, and snap to the concentration (1.0e-7) that results in
      // a neutral solution.
      const isConcentration = graphUnits === GraphUnits.MOLES_PER_LITER;
      if (isConcentration && adjustedValue === 9.9e-8) {
        adjustedValue = 1.0e-7;
      }

      // Map the model value to pH, depending on which units we're using.
      let pH = isConcentration ? concentrationToPH(adjustedValue) : molesToPH(adjustedValue, totalVolume);

      // Constrain the pH to the valid range
      assert && assert(pH !== null, 'pH is not expected to be null here, because we checked that totalVolume !== 0 above');
      pH = Utils.clamp(pH, PHScaleConstants.PH_RANGE.min, PHScaleConstants.PH_RANGE.max);
      phet.log && phet.log(`value=${value} adjustedValue=${adjustedValue} pH=${pH}`);

      // Set the solution's pH
      pHProperty.value = pH;
    }
  }
}
phScale.register('GraphIndicatorDragListener', GraphIndicatorDragListener);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIlNjaWVudGlmaWNOb3RhdGlvbk5vZGUiLCJEcmFnTGlzdGVuZXIiLCJwaFNjYWxlIiwiUEhTY2FsZUNvbnN0YW50cyIsIkdyYXBoVW5pdHMiLCJHcmFwaEluZGljYXRvckRyYWdMaXN0ZW5lciIsImNvbnN0cnVjdG9yIiwidGFyZ2V0Tm9kZSIsInBIUHJvcGVydHkiLCJ0b3RhbFZvbHVtZVByb3BlcnR5IiwiZ3JhcGhVbml0c1Byb3BlcnR5IiwieVRvVmFsdWUiLCJjb25jZW50cmF0aW9uVG9QSCIsIm1vbGVzVG9QSCIsInN0YXJ0Q2FsbGJhY2siLCJ0YW5kZW0iLCJjbGlja1lPZmZzZXQiLCJhbGxvd1RvdWNoU25hZyIsInN0YXJ0IiwiZXZlbnQiLCJnbG9iYWxUb1BhcmVudFBvaW50IiwicG9pbnRlciIsInBvaW50IiwieSIsImRyYWciLCJ5VmlldyIsImRvRHJhZyIsInZhbHVlIiwidG90YWxWb2x1bWUiLCJncmFwaFVuaXRzIiwiYXNzZXJ0Iiwic2NpZW50aWZpY05vdGF0aW9uIiwidG9TY2llbnRpZmljTm90YXRpb24iLCJtYW50aXNzYURlY2ltYWxQbGFjZXMiLCJMT0dBUklUSE1JQ19NQU5USVNTQV9ERUNJTUFMX1BMQUNFUyIsImV4cG9uZW50IiwiaW50ZXJ2YWwiLCJNYXRoIiwicG93IiwiYWRqdXN0ZWRWYWx1ZSIsInJvdW5kVG9JbnRlcnZhbCIsImlzQ29uY2VudHJhdGlvbiIsIk1PTEVTX1BFUl9MSVRFUiIsInBIIiwiY2xhbXAiLCJQSF9SQU5HRSIsIm1pbiIsIm1heCIsInBoZXQiLCJsb2ciLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkdyYXBoSW5kaWNhdG9yRHJhZ0xpc3RlbmVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERyYWcgaGFuZGxlciBmb3IgdGhlIGludGVyYWN0aXZlIGdyYXBoIGluZGljYXRvcnMuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqL1xyXG5cclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uLy4uLy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCBTY2llbnRpZmljTm90YXRpb25Ob2RlIGZyb20gJy4uLy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9TY2llbnRpZmljTm90YXRpb25Ob2RlLmpzJztcclxuaW1wb3J0IHsgRHJhZ0xpc3RlbmVyLCBOb2RlIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IHBoU2NhbGUgZnJvbSAnLi4vLi4vLi4vcGhTY2FsZS5qcyc7XHJcbmltcG9ydCBQSFNjYWxlQ29uc3RhbnRzIGZyb20gJy4uLy4uL1BIU2NhbGVDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgR3JhcGhVbml0cyBmcm9tICcuL0dyYXBoVW5pdHMuanMnO1xyXG5pbXBvcnQgeyBDb25jZW50cmF0aW9uVmFsdWUsIFBIVmFsdWUgfSBmcm9tICcuLi8uLi9tb2RlbC9QSE1vZGVsLmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBFbnVtZXJhdGlvblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uLy4uL2F4b24vanMvRW51bWVyYXRpb25Qcm9wZXJ0eS5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHcmFwaEluZGljYXRvckRyYWdMaXN0ZW5lciBleHRlbmRzIERyYWdMaXN0ZW5lciB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB0YXJnZXROb2RlXHJcbiAgICogQHBhcmFtIHBIUHJvcGVydHkgLSBwSCBvZiB0aGUgc29sdXRpb25cclxuICAgKiBAcGFyYW0gdG90YWxWb2x1bWVQcm9wZXJ0eSAtIHZvbHVtZSBvZiB0aGUgc29sdXRpb25cclxuICAgKiBAcGFyYW0gZ3JhcGhVbml0c1Byb3BlcnR5XHJcbiAgICogQHBhcmFtIHlUb1ZhbHVlIC0gY29udmVydHMgYSB5IHZpZXcgY29vcmRpbmF0ZSB0byBhIG1vZGVsIHZhbHVlXHJcbiAgICogQHBhcmFtIGNvbmNlbnRyYXRpb25Ub1BIIC0gY29udmVydHMgY29uY2VudHJhdGlvbiB0byBwSFxyXG4gICAqIEBwYXJhbSBtb2xlc1RvUEggLSBjb252ZXJ0cyBtb2xlcyArIHZvbHVtZSB0byBwSFxyXG4gICAqIEBwYXJhbSBzdGFydENhbGxiYWNrIC0gY2FsbGVkIHdoZW4gZHJhZyBzdGFydHNcclxuICAgKiBAcGFyYW0gdGFuZGVtXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCB0YXJnZXROb2RlOiBOb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcEhQcm9wZXJ0eTogUHJvcGVydHk8bnVtYmVyPixcclxuICAgICAgICAgICAgICAgICAgICAgIHRvdGFsVm9sdW1lUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBncmFwaFVuaXRzUHJvcGVydHk6IEVudW1lcmF0aW9uUHJvcGVydHk8R3JhcGhVbml0cz4sXHJcbiAgICAgICAgICAgICAgICAgICAgICB5VG9WYWx1ZTogKCB5OiBudW1iZXIgKSA9PiBudW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb25jZW50cmF0aW9uVG9QSDogKCBjb25jZW50cmF0aW9uOiBDb25jZW50cmF0aW9uVmFsdWUgKSA9PiBQSFZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgbW9sZXNUb1BIOiAoIG1vbGVzOiBudW1iZXIsIHZvbHVtZTogbnVtYmVyICkgPT4gUEhWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0Q2FsbGJhY2s6ICgpID0+IHZvaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICB0YW5kZW06IFRhbmRlbSApIHtcclxuXHJcbiAgICBsZXQgY2xpY2tZT2Zmc2V0OiBudW1iZXI7IC8vIHktb2Zmc2V0IGJldHdlZW4gaW5pdGlhbCBjbGljayBhbmQgaW5kaWNhdG9yJ3Mgb3JpZ2luXHJcblxyXG4gICAgc3VwZXIoIHtcclxuXHJcbiAgICAgIGFsbG93VG91Y2hTbmFnOiB0cnVlLFxyXG5cclxuICAgICAgLy8gUmVjb3JkIHRoZSBvZmZzZXQgYmV0d2VlbiB0aGUgcG9pbnRlciBhbmQgdGhlIGluZGljYXRvcidzIG9yaWdpbi5cclxuICAgICAgc3RhcnQ6IGV2ZW50ID0+IHtcclxuICAgICAgICBzdGFydENhbGxiYWNrKCk7XHJcbiAgICAgICAgY2xpY2tZT2Zmc2V0ID0gdGFyZ2V0Tm9kZS5nbG9iYWxUb1BhcmVudFBvaW50KCBldmVudC5wb2ludGVyLnBvaW50ICkueSAtIHRhcmdldE5vZGUueTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIFdoZW4gdGhlIGluZGljYXRvciBpcyBkcmFnZ2VkLCBjcmVhdGUgYSBjdXN0b20gc29sdXRlIHRoYXQgY29ycmVzcG9uZHMgdG8gdGhlIG5ldyBwSC5cclxuICAgICAgZHJhZzogZXZlbnQgPT4ge1xyXG5cclxuICAgICAgICAvLyBBZGp1c3QgdGhlIHktY29vcmRpbmF0ZSBmb3IgdGhlIG9mZnNldCBiZXR3ZWVuIHRoZSBwb2ludGVyIGFuZCB0aGUgaW5kaWNhdG9yJ3Mgb3JpZ2luXHJcbiAgICAgICAgY29uc3QgeVZpZXcgPSB0YXJnZXROb2RlLmdsb2JhbFRvUGFyZW50UG9pbnQoIGV2ZW50LnBvaW50ZXIucG9pbnQgKS55IC0gY2xpY2tZT2Zmc2V0O1xyXG5cclxuICAgICAgICBHcmFwaEluZGljYXRvckRyYWdMaXN0ZW5lci5kb0RyYWcoIHlWaWV3LCB0YXJnZXROb2RlLCBwSFByb3BlcnR5LCB0b3RhbFZvbHVtZVByb3BlcnR5LnZhbHVlLFxyXG4gICAgICAgICAgZ3JhcGhVbml0c1Byb3BlcnR5LnZhbHVlLCB5VG9WYWx1ZSwgY29uY2VudHJhdGlvblRvUEgsIG1vbGVzVG9QSCApO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gcGhldC1pb1xyXG4gICAgICB0YW5kZW06IHRhbmRlbVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogV2hlbiB0aGUgaW5kaWNhdG9yIGlzIGRyYWdnZWQsIGNyZWF0ZSBhIGN1c3RvbSBzb2x1dGUgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgbmV3IHBILlxyXG4gICAqIFRoaXMgaXMgdXNlZCBieSBib3RoIEdyYXBoSW5kaWNhdG9yRHJhZ0xpc3RlbmVyIGFuZCBHcmFwaEluZGljYXRvcktleWJvYXJkRHJhZ0xpc3RlbmVyLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZG9EcmFnKCB5VmlldzogbnVtYmVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROb2RlOiBOb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwSFByb3BlcnR5OiBQcm9wZXJ0eTxudW1iZXI+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFZvbHVtZTogbnVtYmVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBncmFwaFVuaXRzOiBHcmFwaFVuaXRzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5VG9WYWx1ZTogKCB5OiBudW1iZXIgKSA9PiBudW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmNlbnRyYXRpb25Ub1BIOiAoIGNvbmNlbnRyYXRpb246IENvbmNlbnRyYXRpb25WYWx1ZSApID0+IFBIVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vbGVzVG9QSDogKCBtb2xlczogbnVtYmVyLCB2b2x1bWU6IG51bWJlciApID0+IFBIVmFsdWUgKTogdm9pZCB7XHJcblxyXG4gICAgLy8gSWYgdGhlIHNvbHV0aW9uIHZvbHVtZSBpcyB6ZXJvIChlbXB0eSBiZWFrZXIpLCB0aGVuIHdlIGhhdmUgbm8gc29sdXRpb24sIGFuZCB0aGVyZWZvcmUgbm8gcEgsIHNvIGRvIG5vdGhpbmcuXHJcbiAgICBpZiAoIHRvdGFsVm9sdW1lICE9PSAwICkge1xyXG5cclxuICAgICAgLy8gQ29udmVydCB0aGUgeS1jb29yZGluYXRlIHRvIGEgbW9kZWwgdmFsdWUuXHJcbiAgICAgIGNvbnN0IHZhbHVlID0geVRvVmFsdWUoIHlWaWV3ICk7XHJcbiAgICAgIGFzc2VydCAmJiBhc3NlcnQoIHZhbHVlID4gMCApO1xyXG5cclxuICAgICAgLy8gUm91bmQgdGhlIG1vZGVsIHZhbHVlIHRvIHRoZSBmaXJzdCAyIG5vbi16ZXJvIGRlY2ltYWwgcGxhY2VzLiBUaGlzIHByZXZlbnRzIGNvbnRpbnVvdXMgZHJhZ2dpbmcgZnJvbVxyXG4gICAgICAvLyBjcmVhdGluZyB2YWx1ZXMgdGhhdCBoYXZlIHRvbyBtdWNoIHByZWNpc2lvbiwgd2hpY2ggY2FuIHJlc3VsdCBpbiBwSCA9IDcuMDAgd2l0aCB1bmVxdWFsIGFtb3VudHMgb2ZcclxuICAgICAgLy8gSDNPKyBhbmQgT0gtLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3BoLXNjYWxlL2lzc3Vlcy8yMjUuXHJcbiAgICAgIGNvbnN0IHNjaWVudGlmaWNOb3RhdGlvbiA9IFNjaWVudGlmaWNOb3RhdGlvbk5vZGUudG9TY2llbnRpZmljTm90YXRpb24oIHZhbHVlLCB7XHJcbiAgICAgICAgbWFudGlzc2FEZWNpbWFsUGxhY2VzOiBQSFNjYWxlQ29uc3RhbnRzLkxPR0FSSVRITUlDX01BTlRJU1NBX0RFQ0lNQUxfUExBQ0VTXHJcbiAgICAgIH0gKTtcclxuICAgICAgY29uc3QgZXhwb25lbnQgPSArc2NpZW50aWZpY05vdGF0aW9uLmV4cG9uZW50IC0gUEhTY2FsZUNvbnN0YW50cy5MT0dBUklUSE1JQ19NQU5USVNTQV9ERUNJTUFMX1BMQUNFUztcclxuICAgICAgY29uc3QgaW50ZXJ2YWwgPSBNYXRoLnBvdyggMTAsIGV4cG9uZW50ICk7XHJcbiAgICAgIGxldCBhZGp1c3RlZFZhbHVlID0gVXRpbHMucm91bmRUb0ludGVydmFsKCB2YWx1ZSwgaW50ZXJ2YWwgKTtcclxuXHJcbiAgICAgIC8vIFdvcmthcm91bmQgZm9yIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9waC1zY2FsZS9pc3N1ZXMvMjI1LlxyXG4gICAgICAvLyBGb3Igb25lIHZhbHVlICg5LjllLTgpLCB0aGUgcHJlY2lzaW9uIG9mIHdoYXQgd2UncmUgZGlzcGxheWluZyByZXN1bHRzIGluIGEgc2l0dWF0aW9uIHdoZXJlIHdlIGhhdmVcclxuICAgICAgLy8gZGlmZmVyZW50IGNvbmNlbnRyYXRpb25zIG9mIEgzTysgYW5kIE9ILSwgYnV0IGFyZSBkaXNwbGF5aW5nIGEgbmV1dHJhbCBwSCBvZiA3LjAwLiAgU28gd2UgZGVjaWRlZFxyXG4gICAgICAvLyB0aGF0IGl0IHdhcyBwcmVmZXJhYmxlIHRvIGF2b2lkIHRoYXQgdmFsdWUsIGFuZCBzbmFwIHRvIHRoZSBjb25jZW50cmF0aW9uICgxLjBlLTcpIHRoYXQgcmVzdWx0cyBpblxyXG4gICAgICAvLyBhIG5ldXRyYWwgc29sdXRpb24uXHJcbiAgICAgIGNvbnN0IGlzQ29uY2VudHJhdGlvbiA9ICggZ3JhcGhVbml0cyA9PT0gR3JhcGhVbml0cy5NT0xFU19QRVJfTElURVIgKTtcclxuICAgICAgaWYgKCBpc0NvbmNlbnRyYXRpb24gJiYgYWRqdXN0ZWRWYWx1ZSA9PT0gOS45ZS04ICkge1xyXG4gICAgICAgIGFkanVzdGVkVmFsdWUgPSAxLjBlLTc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIE1hcCB0aGUgbW9kZWwgdmFsdWUgdG8gcEgsIGRlcGVuZGluZyBvbiB3aGljaCB1bml0cyB3ZSdyZSB1c2luZy5cclxuICAgICAgbGV0IHBIID0gaXNDb25jZW50cmF0aW9uID8gY29uY2VudHJhdGlvblRvUEgoIGFkanVzdGVkVmFsdWUgKSA6IG1vbGVzVG9QSCggYWRqdXN0ZWRWYWx1ZSwgdG90YWxWb2x1bWUgKTtcclxuXHJcbiAgICAgIC8vIENvbnN0cmFpbiB0aGUgcEggdG8gdGhlIHZhbGlkIHJhbmdlXHJcbiAgICAgIGFzc2VydCAmJiBhc3NlcnQoIHBIICE9PSBudWxsLCAncEggaXMgbm90IGV4cGVjdGVkIHRvIGJlIG51bGwgaGVyZSwgYmVjYXVzZSB3ZSBjaGVja2VkIHRoYXQgdG90YWxWb2x1bWUgIT09IDAgYWJvdmUnICk7XHJcbiAgICAgIHBIID0gVXRpbHMuY2xhbXAoIHBIISwgUEhTY2FsZUNvbnN0YW50cy5QSF9SQU5HRS5taW4sIFBIU2NhbGVDb25zdGFudHMuUEhfUkFOR0UubWF4ICk7XHJcblxyXG4gICAgICBwaGV0LmxvZyAmJiBwaGV0LmxvZyggYHZhbHVlPSR7dmFsdWV9IGFkanVzdGVkVmFsdWU9JHthZGp1c3RlZFZhbHVlfSBwSD0ke3BIfWAgKTtcclxuXHJcbiAgICAgIC8vIFNldCB0aGUgc29sdXRpb24ncyBwSFxyXG4gICAgICBwSFByb3BlcnR5LnZhbHVlID0gcEg7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5waFNjYWxlLnJlZ2lzdGVyKCAnR3JhcGhJbmRpY2F0b3JEcmFnTGlzdGVuZXInLCBHcmFwaEluZGljYXRvckRyYWdMaXN0ZW5lciApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxLQUFLLE1BQU0sZ0NBQWdDO0FBQ2xELE9BQU9DLHNCQUFzQixNQUFNLDBEQUEwRDtBQUM3RixTQUFTQyxZQUFZLFFBQWMsc0NBQXNDO0FBRXpFLE9BQU9DLE9BQU8sTUFBTSxxQkFBcUI7QUFDekMsT0FBT0MsZ0JBQWdCLE1BQU0sMkJBQTJCO0FBQ3hELE9BQU9DLFVBQVUsTUFBTSxpQkFBaUI7QUFNeEMsZUFBZSxNQUFNQywwQkFBMEIsU0FBU0osWUFBWSxDQUFD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