// Copyright 2013-2022, University of Colorado Boulder

/**
 * Displays a volume value, with an left-pointing arrow to the left of the value.
 * The origin is at the tip of the arrowhead.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
import Utils from '../../../../dot/js/Utils.js';
import { Shape } from '../../../../kite/js/imports.js';
import optionize from '../../../../phet-core/js/optionize.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, Path, Text } from '../../../../scenery/js/imports.js';
import phScale from '../../phScale.js';
import PhScaleStrings from '../../PhScaleStrings.js';
import PHScaleConstants from '../PHScaleConstants.js';

// constants
const ARROW_SIZE = new Dimension2(21, 28);
const VALUE_FONT = new PhetFont({
  size: 24,
  weight: 'bold'
});
export default class VolumeIndicatorNode extends Node {
  constructor(totalVolumeProperty, beaker, modelViewTransform, providedOptions) {
    const options = optionize()({
      // NodeOptions
      phetioDocumentation: 'indicates the volume of the solution in the beaker'
    }, providedOptions);

    // arrow head that points to the left
    const arrowHeadShape = new Shape().moveTo(0, 0).lineTo(ARROW_SIZE.width, ARROW_SIZE.height / 2).lineTo(ARROW_SIZE.width, -ARROW_SIZE.height / 2).close();
    const arrowHead = new Path(arrowHeadShape, {
      fill: 'black'
    });
    const valueStringProperty = new DerivedProperty([PhScaleStrings.pattern['0value']['1unitsStringProperty'], totalVolumeProperty, PhScaleStrings.units.litersStringProperty], (pattern, totalVolume, litersString) => StringUtils.format(pattern, Utils.toFixed(totalVolume, PHScaleConstants.VOLUME_DECIMAL_PLACES), litersString));

    // volume value
    const valueText = new Text(valueStringProperty, {
      font: VALUE_FONT,
      left: arrowHead.right + 3,
      maxWidth: 75
    });
    options.children = [valueText, arrowHead];
    super(options);

    // x position
    this.left = modelViewTransform.modelToViewX(beaker.right) + 3;
    valueText.boundsProperty.link(bounds => {
      valueText.centerY = arrowHead.centerY;
    });

    // update position of the indicator
    totalVolumeProperty.link(totalVolume => {
      const solutionHeight = Utils.linear(0, beaker.volume, 0, beaker.size.height, totalVolume);
      this.y = modelViewTransform.modelToViewY(beaker.position.y - solutionHeight);
    });
  }
}
phScale.register('VolumeIndicatorNode', VolumeIndicatorNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJEaW1lbnNpb24yIiwiVXRpbHMiLCJTaGFwZSIsIm9wdGlvbml6ZSIsIlN0cmluZ1V0aWxzIiwiUGhldEZvbnQiLCJOb2RlIiwiUGF0aCIsIlRleHQiLCJwaFNjYWxlIiwiUGhTY2FsZVN0cmluZ3MiLCJQSFNjYWxlQ29uc3RhbnRzIiwiQVJST1dfU0laRSIsIlZBTFVFX0ZPTlQiLCJzaXplIiwid2VpZ2h0IiwiVm9sdW1lSW5kaWNhdG9yTm9kZSIsImNvbnN0cnVjdG9yIiwidG90YWxWb2x1bWVQcm9wZXJ0eSIsImJlYWtlciIsIm1vZGVsVmlld1RyYW5zZm9ybSIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJwaGV0aW9Eb2N1bWVudGF0aW9uIiwiYXJyb3dIZWFkU2hhcGUiLCJtb3ZlVG8iLCJsaW5lVG8iLCJ3aWR0aCIsImhlaWdodCIsImNsb3NlIiwiYXJyb3dIZWFkIiwiZmlsbCIsInZhbHVlU3RyaW5nUHJvcGVydHkiLCJwYXR0ZXJuIiwidW5pdHMiLCJsaXRlcnNTdHJpbmdQcm9wZXJ0eSIsInRvdGFsVm9sdW1lIiwibGl0ZXJzU3RyaW5nIiwiZm9ybWF0IiwidG9GaXhlZCIsIlZPTFVNRV9ERUNJTUFMX1BMQUNFUyIsInZhbHVlVGV4dCIsImZvbnQiLCJsZWZ0IiwicmlnaHQiLCJtYXhXaWR0aCIsImNoaWxkcmVuIiwibW9kZWxUb1ZpZXdYIiwiYm91bmRzUHJvcGVydHkiLCJsaW5rIiwiYm91bmRzIiwiY2VudGVyWSIsInNvbHV0aW9uSGVpZ2h0IiwibGluZWFyIiwidm9sdW1lIiwieSIsIm1vZGVsVG9WaWV3WSIsInBvc2l0aW9uIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJWb2x1bWVJbmRpY2F0b3JOb2RlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDEzLTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERpc3BsYXlzIGEgdm9sdW1lIHZhbHVlLCB3aXRoIGFuIGxlZnQtcG9pbnRpbmcgYXJyb3cgdG8gdGhlIGxlZnQgb2YgdGhlIHZhbHVlLlxyXG4gKiBUaGUgb3JpZ2luIGlzIGF0IHRoZSB0aXAgb2YgdGhlIGFycm93aGVhZC5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRGltZW5zaW9uMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvRGltZW5zaW9uMi5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgU3RyaW5nVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy91dGlsL1N0cmluZ1V0aWxzLmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgTm9kZSwgTm9kZU9wdGlvbnMsIFBhdGgsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgcGhTY2FsZSBmcm9tICcuLi8uLi9waFNjYWxlLmpzJztcclxuaW1wb3J0IFBoU2NhbGVTdHJpbmdzIGZyb20gJy4uLy4uL1BoU2NhbGVTdHJpbmdzLmpzJztcclxuaW1wb3J0IEJlYWtlciBmcm9tICcuLi9tb2RlbC9CZWFrZXIuanMnO1xyXG5pbXBvcnQgUEhTY2FsZUNvbnN0YW50cyBmcm9tICcuLi9QSFNjYWxlQ29uc3RhbnRzLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBBUlJPV19TSVpFID0gbmV3IERpbWVuc2lvbjIoIDIxLCAyOCApO1xyXG5jb25zdCBWQUxVRV9GT05UID0gbmV3IFBoZXRGb250KCB7IHNpemU6IDI0LCB3ZWlnaHQ6ICdib2xkJyB9ICk7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0gRW1wdHlTZWxmT3B0aW9ucztcclxuXHJcbnR5cGUgVm9sdW1lSW5kaWNhdG9yTm9kZU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBpY2tSZXF1aXJlZDxOb2RlT3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVm9sdW1lSW5kaWNhdG9yTm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHRvdGFsVm9sdW1lUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBiZWFrZXI6IEJlYWtlcixcclxuICAgICAgICAgICAgICAgICAgICAgIG1vZGVsVmlld1RyYW5zZm9ybTogTW9kZWxWaWV3VHJhbnNmb3JtMixcclxuICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVkT3B0aW9uczogVm9sdW1lSW5kaWNhdG9yTm9kZU9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxWb2x1bWVJbmRpY2F0b3JOb2RlT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBOb2RlT3B0aW9uc1xyXG4gICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnaW5kaWNhdGVzIHRoZSB2b2x1bWUgb2YgdGhlIHNvbHV0aW9uIGluIHRoZSBiZWFrZXInXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBhcnJvdyBoZWFkIHRoYXQgcG9pbnRzIHRvIHRoZSBsZWZ0XHJcbiAgICBjb25zdCBhcnJvd0hlYWRTaGFwZSA9IG5ldyBTaGFwZSgpXHJcbiAgICAgIC5tb3ZlVG8oIDAsIDAgKVxyXG4gICAgICAubGluZVRvKCBBUlJPV19TSVpFLndpZHRoLCBBUlJPV19TSVpFLmhlaWdodCAvIDIgKVxyXG4gICAgICAubGluZVRvKCBBUlJPV19TSVpFLndpZHRoLCAtQVJST1dfU0laRS5oZWlnaHQgLyAyIClcclxuICAgICAgLmNsb3NlKCk7XHJcbiAgICBjb25zdCBhcnJvd0hlYWQgPSBuZXcgUGF0aCggYXJyb3dIZWFkU2hhcGUsIHsgZmlsbDogJ2JsYWNrJyB9ICk7XHJcblxyXG4gICAgY29uc3QgdmFsdWVTdHJpbmdQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgUGhTY2FsZVN0cmluZ3MucGF0dGVyblsgJzB2YWx1ZScgXVsgJzF1bml0c1N0cmluZ1Byb3BlcnR5JyBdLCB0b3RhbFZvbHVtZVByb3BlcnR5LCBQaFNjYWxlU3RyaW5ncy51bml0cy5saXRlcnNTdHJpbmdQcm9wZXJ0eSBdLFxyXG4gICAgICAoIHBhdHRlcm4sIHRvdGFsVm9sdW1lLCBsaXRlcnNTdHJpbmcgKSA9PlxyXG4gICAgICAgIFN0cmluZ1V0aWxzLmZvcm1hdCggcGF0dGVybiwgVXRpbHMudG9GaXhlZCggdG90YWxWb2x1bWUsIFBIU2NhbGVDb25zdGFudHMuVk9MVU1FX0RFQ0lNQUxfUExBQ0VTICksIGxpdGVyc1N0cmluZyApXHJcbiAgICApO1xyXG5cclxuICAgIC8vIHZvbHVtZSB2YWx1ZVxyXG4gICAgY29uc3QgdmFsdWVUZXh0ID0gbmV3IFRleHQoIHZhbHVlU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgZm9udDogVkFMVUVfRk9OVCxcclxuICAgICAgbGVmdDogYXJyb3dIZWFkLnJpZ2h0ICsgMyxcclxuICAgICAgbWF4V2lkdGg6IDc1XHJcbiAgICB9ICk7XHJcblxyXG4gICAgb3B0aW9ucy5jaGlsZHJlbiA9IFsgdmFsdWVUZXh0LCBhcnJvd0hlYWQgXTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIHggcG9zaXRpb25cclxuICAgIHRoaXMubGVmdCA9IG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1goIGJlYWtlci5yaWdodCApICsgMztcclxuXHJcbiAgICB2YWx1ZVRleHQuYm91bmRzUHJvcGVydHkubGluayggYm91bmRzID0+IHtcclxuICAgICAgdmFsdWVUZXh0LmNlbnRlclkgPSBhcnJvd0hlYWQuY2VudGVyWTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB1cGRhdGUgcG9zaXRpb24gb2YgdGhlIGluZGljYXRvclxyXG4gICAgdG90YWxWb2x1bWVQcm9wZXJ0eS5saW5rKCB0b3RhbFZvbHVtZSA9PiB7XHJcbiAgICAgIGNvbnN0IHNvbHV0aW9uSGVpZ2h0ID0gVXRpbHMubGluZWFyKCAwLCBiZWFrZXIudm9sdW1lLCAwLCBiZWFrZXIuc2l6ZS5oZWlnaHQsIHRvdGFsVm9sdW1lICk7XHJcbiAgICAgIHRoaXMueSA9IG1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIGJlYWtlci5wb3NpdGlvbi55IC0gc29sdXRpb25IZWlnaHQgKTtcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbnBoU2NhbGUucmVnaXN0ZXIoICdWb2x1bWVJbmRpY2F0b3JOb2RlJywgVm9sdW1lSW5kaWNhdG9yTm9kZSApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFFcEUsT0FBT0MsVUFBVSxNQUFNLGtDQUFrQztBQUN6RCxPQUFPQyxLQUFLLE1BQU0sNkJBQTZCO0FBQy9DLFNBQVNDLEtBQUssUUFBUSxnQ0FBZ0M7QUFDdEQsT0FBT0MsU0FBUyxNQUE0Qix1Q0FBdUM7QUFFbkYsT0FBT0MsV0FBVyxNQUFNLCtDQUErQztBQUV2RSxPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELFNBQVNDLElBQUksRUFBZUMsSUFBSSxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQ2pGLE9BQU9DLE9BQU8sTUFBTSxrQkFBa0I7QUFDdEMsT0FBT0MsY0FBYyxNQUFNLHlCQUF5QjtBQUVwRCxPQUFPQyxnQkFBZ0IsTUFBTSx3QkFBd0I7O0FBRXJEO0FBQ0EsTUFBTUMsVUFBVSxHQUFHLElBQUlaLFVBQVUsQ0FBRSxFQUFFLEVBQUUsRUFBRyxDQUFDO0FBQzNDLE1BQU1hLFVBQVUsR0FBRyxJQUFJUixRQUFRLENBQUU7RUFBRVMsSUFBSSxFQUFFLEVBQUU7RUFBRUMsTUFBTSxFQUFFO0FBQU8sQ0FBRSxDQUFDO0FBTS9ELGVBQWUsTUFBTUMsbUJBQW1CLFNBQVNWLElBQUksQ0FBQztFQUU3Q1csV0FBV0EsQ0FBRUMsbUJBQThDLEVBQzlDQyxNQUFjLEVBQ2RDLGtCQUF1QyxFQUN2Q0MsZUFBMkMsRUFBRztJQUVoRSxNQUFNQyxPQUFPLEdBQUduQixTQUFTLENBQXVELENBQUMsQ0FBRTtNQUVqRjtNQUNBb0IsbUJBQW1CLEVBQUU7SUFDdkIsQ0FBQyxFQUFFRixlQUFnQixDQUFDOztJQUVwQjtJQUNBLE1BQU1HLGNBQWMsR0FBRyxJQUFJdEIsS0FBSyxDQUFDLENBQUMsQ0FDL0J1QixNQUFNLENBQUUsQ0FBQyxFQUFFLENBQUUsQ0FBQyxDQUNkQyxNQUFNLENBQUVkLFVBQVUsQ0FBQ2UsS0FBSyxFQUFFZixVQUFVLENBQUNnQixNQUFNLEdBQUcsQ0FBRSxDQUFDLENBQ2pERixNQUFNLENBQUVkLFVBQVUsQ0FBQ2UsS0FBSyxFQUFFLENBQUNmLFVBQVUsQ0FBQ2dCLE1BQU0sR0FBRyxDQUFFLENBQUMsQ0FDbERDLEtBQUssQ0FBQyxDQUFDO0lBQ1YsTUFBTUMsU0FBUyxHQUFHLElBQUl2QixJQUFJLENBQUVpQixjQUFjLEVBQUU7TUFBRU8sSUFBSSxFQUFFO0lBQVEsQ0FBRSxDQUFDO0lBRS9ELE1BQU1DLG1CQUFtQixHQUFHLElBQUlqQyxlQUFlLENBQzdDLENBQUVXLGNBQWMsQ0FBQ3VCLE9BQU8sQ0FBRSxRQUFRLENBQUUsQ0FBRSxzQkFBc0IsQ0FBRSxFQUFFZixtQkFBbUIsRUFBRVIsY0FBYyxDQUFDd0IsS0FBSyxDQUFDQyxvQkFBb0IsQ0FBRSxFQUNoSSxDQUFFRixPQUFPLEVBQUVHLFdBQVcsRUFBRUMsWUFBWSxLQUNsQ2pDLFdBQVcsQ0FBQ2tDLE1BQU0sQ0FBRUwsT0FBTyxFQUFFaEMsS0FBSyxDQUFDc0MsT0FBTyxDQUFFSCxXQUFXLEVBQUV6QixnQkFBZ0IsQ0FBQzZCLHFCQUFzQixDQUFDLEVBQUVILFlBQWEsQ0FDcEgsQ0FBQzs7SUFFRDtJQUNBLE1BQU1JLFNBQVMsR0FBRyxJQUFJakMsSUFBSSxDQUFFd0IsbUJBQW1CLEVBQUU7TUFDL0NVLElBQUksRUFBRTdCLFVBQVU7TUFDaEI4QixJQUFJLEVBQUViLFNBQVMsQ0FBQ2MsS0FBSyxHQUFHLENBQUM7TUFDekJDLFFBQVEsRUFBRTtJQUNaLENBQUUsQ0FBQztJQUVIdkIsT0FBTyxDQUFDd0IsUUFBUSxHQUFHLENBQUVMLFNBQVMsRUFBRVgsU0FBUyxDQUFFO0lBRTNDLEtBQUssQ0FBRVIsT0FBUSxDQUFDOztJQUVoQjtJQUNBLElBQUksQ0FBQ3FCLElBQUksR0FBR3ZCLGtCQUFrQixDQUFDMkIsWUFBWSxDQUFFNUIsTUFBTSxDQUFDeUIsS0FBTSxDQUFDLEdBQUcsQ0FBQztJQUUvREgsU0FBUyxDQUFDTyxjQUFjLENBQUNDLElBQUksQ0FBRUMsTUFBTSxJQUFJO01BQ3ZDVCxTQUFTLENBQUNVLE9BQU8sR0FBR3JCLFNBQVMsQ0FBQ3FCLE9BQU87SUFDdkMsQ0FBRSxDQUFDOztJQUVIO0lBQ0FqQyxtQkFBbUIsQ0FBQytCLElBQUksQ0FBRWIsV0FBVyxJQUFJO01BQ3ZDLE1BQU1nQixjQUFjLEdBQUduRCxLQUFLLENBQUNvRCxNQUFNLENBQUUsQ0FBQyxFQUFFbEMsTUFBTSxDQUFDbUMsTUFBTSxFQUFFLENBQUMsRUFBRW5DLE1BQU0sQ0FBQ0wsSUFBSSxDQUFDYyxNQUFNLEVBQUVRLFdBQVksQ0FBQztNQUMzRixJQUFJLENBQUNtQixDQUFDLEdBQUduQyxrQkFBa0IsQ0FBQ29DLFlBQVksQ0FBRXJDLE1BQU0sQ0FBQ3NDLFFBQVEsQ0FBQ0YsQ0FBQyxHQUFHSCxjQUFlLENBQUM7SUFDaEYsQ0FBRSxDQUFDO0VBQ0w7QUFDRjtBQUVBM0MsT0FBTyxDQUFDaUQsUUFBUSxDQUFFLHFCQUFxQixFQUFFMUMsbUJBQW9CLENBQUMifQ==