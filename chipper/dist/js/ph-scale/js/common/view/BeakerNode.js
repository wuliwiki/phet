// Copyright 2013-2022, University of Colorado Boulder

/**
 * Visual representation of a beaker that is filled to the top with a solution.
 * Origin is at the bottom center.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Utils from '../../../../dot/js/Utils.js';
import { Shape } from '../../../../kite/js/imports.js';
import optionize from '../../../../phet-core/js/optionize.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, Path, Text } from '../../../../scenery/js/imports.js';
import phScale from '../../phScale.js';
import PhScaleStrings from '../../PhScaleStrings.js';
// constants
const RIM_OFFSET = 20;
const MINOR_TICK_SPACING = 0.1; // L
const MINOR_TICKS_PER_MAJOR_TICK = 5;
const MAJOR_TICK_LENGTH = 30;
const MINOR_TICK_LENGTH = 15;
const TICK_LABEL_X_SPACING = 8;
const MAJOR_TICK_LABELS = ['\u00bd', '1']; // 1/2, 1
const MAJOR_TICK_FONT = new PhetFont(24);
export default class BeakerNode extends Node {
  constructor(beaker, modelViewTransform, providedOptions) {
    const options = optionize()({
      // BeakerNode should not be hideable, but its subcomponents are.
      // See https://github.com/phetsims/ph-scale/issues/108
      visiblePropertyOptions: {
        phetioReadOnly: true
      }
    }, providedOptions);
    super(options);

    // outline of the beaker, starting from upper left
    const beakerWidth = modelViewTransform.modelToViewDeltaX(beaker.size.width);
    const beakerHeight = modelViewTransform.modelToViewDeltaY(beaker.size.height);
    const outlineShape = new Shape().moveTo(-(beakerWidth / 2) - RIM_OFFSET, -beakerHeight - RIM_OFFSET).lineTo(-(beakerWidth / 2), -beakerHeight).lineTo(-(beakerWidth / 2), 0).lineTo(beakerWidth / 2, 0).lineTo(beakerWidth / 2, -beakerHeight).lineTo(beakerWidth / 2 + RIM_OFFSET, -beakerHeight - RIM_OFFSET);
    this.addChild(new Path(outlineShape, {
      stroke: 'black',
      lineWidth: 3,
      lineCap: 'round',
      lineJoin: 'round'
    }));

    // horizontal tick marks on left and right edges, labels on right ticks, from bottom up
    const tickMarksTandem = options.tandem.createTandem('tickMarks');
    const tickMarks = new Node({
      tandem: tickMarksTandem
    });
    this.addChild(tickMarks);

    // tickLabels are a child of tickMarks so that hiding tickMarks also hides labels
    const tickLabels = new Node({
      tandem: tickMarksTandem.createTandem('tickLabels')
    });
    tickMarks.addChild(tickLabels);
    const numberOfTicks = Utils.roundSymmetric(beaker.volume / MINOR_TICK_SPACING);
    const deltaY = beakerHeight / numberOfTicks;
    const beakerLeft = -beakerWidth / 2;
    const beakerRight = beakerWidth / 2;
    for (let i = 1; i <= numberOfTicks; i++) {
      const isMajorTick = i % MINOR_TICKS_PER_MAJOR_TICK === 0;
      const tickLength = isMajorTick ? MAJOR_TICK_LENGTH : MINOR_TICK_LENGTH;
      const y = -(i * deltaY);

      // left tick
      tickMarks.addChild(new Path(new Shape().moveTo(beakerLeft, y).lineTo(beakerLeft + tickLength, y), {
        stroke: 'black',
        lineWidth: 2,
        lineCap: 'butt',
        lineJoin: 'bevel'
      }));

      // right tick
      tickMarks.addChild(new Path(new Shape().moveTo(beakerRight, y).lineTo(beakerRight - tickLength, y), {
        stroke: 'black',
        lineWidth: 2,
        lineCap: 'butt',
        lineJoin: 'bevel'
      }));

      // label on right 'major' tick
      if (isMajorTick) {
        const labelIndex = i / MINOR_TICKS_PER_MAJOR_TICK - 1;
        if (labelIndex < MAJOR_TICK_LABELS.length) {
          const labelStringProperty = new DerivedProperty([PhScaleStrings.pattern['0value']['1unitsStringProperty'], PhScaleStrings.units.litersStringProperty], (pattern, litersString) => StringUtils.format(pattern, MAJOR_TICK_LABELS[labelIndex], litersString));
          const labelText = new Text(labelStringProperty, {
            font: MAJOR_TICK_FONT,
            fill: 'black',
            right: beakerRight - tickLength - TICK_LABEL_X_SPACING,
            centerY: y,
            maxWidth: 80 // determined empirically
          });

          tickLabels.addChild(labelText);
          const labelY = y; // closure
          labelText.boundsProperty.link(bounds => {
            labelText.right = beakerRight - tickLength - TICK_LABEL_X_SPACING;
            labelText.centerY = labelY;
          });
        }
      }
    }
    this.translation = modelViewTransform.modelToViewPosition(beaker.position);
  }
}
phScale.register('BeakerNode', BeakerNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJVdGlscyIsIlNoYXBlIiwib3B0aW9uaXplIiwiU3RyaW5nVXRpbHMiLCJQaGV0Rm9udCIsIk5vZGUiLCJQYXRoIiwiVGV4dCIsInBoU2NhbGUiLCJQaFNjYWxlU3RyaW5ncyIsIlJJTV9PRkZTRVQiLCJNSU5PUl9USUNLX1NQQUNJTkciLCJNSU5PUl9USUNLU19QRVJfTUFKT1JfVElDSyIsIk1BSk9SX1RJQ0tfTEVOR1RIIiwiTUlOT1JfVElDS19MRU5HVEgiLCJUSUNLX0xBQkVMX1hfU1BBQ0lORyIsIk1BSk9SX1RJQ0tfTEFCRUxTIiwiTUFKT1JfVElDS19GT05UIiwiQmVha2VyTm9kZSIsImNvbnN0cnVjdG9yIiwiYmVha2VyIiwibW9kZWxWaWV3VHJhbnNmb3JtIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInZpc2libGVQcm9wZXJ0eU9wdGlvbnMiLCJwaGV0aW9SZWFkT25seSIsImJlYWtlcldpZHRoIiwibW9kZWxUb1ZpZXdEZWx0YVgiLCJzaXplIiwid2lkdGgiLCJiZWFrZXJIZWlnaHQiLCJtb2RlbFRvVmlld0RlbHRhWSIsImhlaWdodCIsIm91dGxpbmVTaGFwZSIsIm1vdmVUbyIsImxpbmVUbyIsImFkZENoaWxkIiwic3Ryb2tlIiwibGluZVdpZHRoIiwibGluZUNhcCIsImxpbmVKb2luIiwidGlja01hcmtzVGFuZGVtIiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwidGlja01hcmtzIiwidGlja0xhYmVscyIsIm51bWJlck9mVGlja3MiLCJyb3VuZFN5bW1ldHJpYyIsInZvbHVtZSIsImRlbHRhWSIsImJlYWtlckxlZnQiLCJiZWFrZXJSaWdodCIsImkiLCJpc01ham9yVGljayIsInRpY2tMZW5ndGgiLCJ5IiwibGFiZWxJbmRleCIsImxlbmd0aCIsImxhYmVsU3RyaW5nUHJvcGVydHkiLCJwYXR0ZXJuIiwidW5pdHMiLCJsaXRlcnNTdHJpbmdQcm9wZXJ0eSIsImxpdGVyc1N0cmluZyIsImZvcm1hdCIsImxhYmVsVGV4dCIsImZvbnQiLCJmaWxsIiwicmlnaHQiLCJjZW50ZXJZIiwibWF4V2lkdGgiLCJsYWJlbFkiLCJib3VuZHNQcm9wZXJ0eSIsImxpbmsiLCJib3VuZHMiLCJ0cmFuc2xhdGlvbiIsIm1vZGVsVG9WaWV3UG9zaXRpb24iLCJwb3NpdGlvbiIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQmVha2VyTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBWaXN1YWwgcmVwcmVzZW50YXRpb24gb2YgYSBiZWFrZXIgdGhhdCBpcyBmaWxsZWQgdG8gdGhlIHRvcCB3aXRoIGEgc29sdXRpb24uXHJcbiAqIE9yaWdpbiBpcyBhdCB0aGUgYm90dG9tIGNlbnRlci5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBFbXB0eVNlbGZPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBQaWNrUmVxdWlyZWQgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1BpY2tSZXF1aXJlZC5qcyc7XHJcbmltcG9ydCBTdHJpbmdVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3V0aWwvU3RyaW5nVXRpbHMuanMnO1xyXG5pbXBvcnQgTW9kZWxWaWV3VHJhbnNmb3JtMiBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3ZpZXcvTW9kZWxWaWV3VHJhbnNmb3JtMi5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBOb2RlLCBOb2RlT3B0aW9ucywgUGF0aCwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBwaFNjYWxlIGZyb20gJy4uLy4uL3BoU2NhbGUuanMnO1xyXG5pbXBvcnQgUGhTY2FsZVN0cmluZ3MgZnJvbSAnLi4vLi4vUGhTY2FsZVN0cmluZ3MuanMnO1xyXG5pbXBvcnQgQmVha2VyIGZyb20gJy4uL21vZGVsL0JlYWtlci5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgUklNX09GRlNFVCA9IDIwO1xyXG5jb25zdCBNSU5PUl9USUNLX1NQQUNJTkcgPSAwLjE7IC8vIExcclxuY29uc3QgTUlOT1JfVElDS1NfUEVSX01BSk9SX1RJQ0sgPSA1O1xyXG5jb25zdCBNQUpPUl9USUNLX0xFTkdUSCA9IDMwO1xyXG5jb25zdCBNSU5PUl9USUNLX0xFTkdUSCA9IDE1O1xyXG5jb25zdCBUSUNLX0xBQkVMX1hfU1BBQ0lORyA9IDg7XHJcbmNvbnN0IE1BSk9SX1RJQ0tfTEFCRUxTID0gWyAnXFx1MDBiZCcsICcxJyBdOyAvLyAxLzIsIDFcclxuY29uc3QgTUFKT1JfVElDS19GT05UID0gbmV3IFBoZXRGb250KCAyNCApO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcblxyXG50eXBlIEJlYWtlck5vZGVPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBQaWNrUmVxdWlyZWQ8Tm9kZU9wdGlvbnMsICd0YW5kZW0nPjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJlYWtlck5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBiZWFrZXI6IEJlYWtlciwgbW9kZWxWaWV3VHJhbnNmb3JtOiBNb2RlbFZpZXdUcmFuc2Zvcm0yLCBwcm92aWRlZE9wdGlvbnM6IEJlYWtlck5vZGVPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8QmVha2VyTm9kZU9wdGlvbnMsIFNlbGZPcHRpb25zLCBOb2RlT3B0aW9ucz4oKSgge1xyXG5cclxuICAgICAgLy8gQmVha2VyTm9kZSBzaG91bGQgbm90IGJlIGhpZGVhYmxlLCBidXQgaXRzIHN1YmNvbXBvbmVudHMgYXJlLlxyXG4gICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3BoLXNjYWxlL2lzc3Vlcy8xMDhcclxuICAgICAgdmlzaWJsZVByb3BlcnR5T3B0aW9uczoge1xyXG4gICAgICAgIHBoZXRpb1JlYWRPbmx5OiB0cnVlXHJcbiAgICAgIH1cclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gb3V0bGluZSBvZiB0aGUgYmVha2VyLCBzdGFydGluZyBmcm9tIHVwcGVyIGxlZnRcclxuICAgIGNvbnN0IGJlYWtlcldpZHRoID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3RGVsdGFYKCBiZWFrZXIuc2l6ZS53aWR0aCApO1xyXG4gICAgY29uc3QgYmVha2VySGVpZ2h0ID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3RGVsdGFZKCBiZWFrZXIuc2l6ZS5oZWlnaHQgKTtcclxuICAgIGNvbnN0IG91dGxpbmVTaGFwZSA9IG5ldyBTaGFwZSgpXHJcbiAgICAgIC5tb3ZlVG8oIC0oIGJlYWtlcldpZHRoIC8gMiApIC0gUklNX09GRlNFVCwgLWJlYWtlckhlaWdodCAtIFJJTV9PRkZTRVQgKVxyXG4gICAgICAubGluZVRvKCAtKCBiZWFrZXJXaWR0aCAvIDIgKSwgLWJlYWtlckhlaWdodCApXHJcbiAgICAgIC5saW5lVG8oIC0oIGJlYWtlcldpZHRoIC8gMiApLCAwIClcclxuICAgICAgLmxpbmVUbyggYmVha2VyV2lkdGggLyAyLCAwIClcclxuICAgICAgLmxpbmVUbyggYmVha2VyV2lkdGggLyAyLCAtYmVha2VySGVpZ2h0IClcclxuICAgICAgLmxpbmVUbyggKCBiZWFrZXJXaWR0aCAvIDIgKSArIFJJTV9PRkZTRVQsIC1iZWFrZXJIZWlnaHQgLSBSSU1fT0ZGU0VUICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBuZXcgUGF0aCggb3V0bGluZVNoYXBlLCB7XHJcbiAgICAgIHN0cm9rZTogJ2JsYWNrJyxcclxuICAgICAgbGluZVdpZHRoOiAzLFxyXG4gICAgICBsaW5lQ2FwOiAncm91bmQnLFxyXG4gICAgICBsaW5lSm9pbjogJ3JvdW5kJ1xyXG4gICAgfSApICk7XHJcblxyXG4gICAgLy8gaG9yaXpvbnRhbCB0aWNrIG1hcmtzIG9uIGxlZnQgYW5kIHJpZ2h0IGVkZ2VzLCBsYWJlbHMgb24gcmlnaHQgdGlja3MsIGZyb20gYm90dG9tIHVwXHJcbiAgICBjb25zdCB0aWNrTWFya3NUYW5kZW0gPSBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICd0aWNrTWFya3MnICk7XHJcbiAgICBjb25zdCB0aWNrTWFya3MgPSBuZXcgTm9kZSgge1xyXG4gICAgICB0YW5kZW06IHRpY2tNYXJrc1RhbmRlbVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGlja01hcmtzICk7XHJcblxyXG4gICAgLy8gdGlja0xhYmVscyBhcmUgYSBjaGlsZCBvZiB0aWNrTWFya3Mgc28gdGhhdCBoaWRpbmcgdGlja01hcmtzIGFsc28gaGlkZXMgbGFiZWxzXHJcbiAgICBjb25zdCB0aWNrTGFiZWxzID0gbmV3IE5vZGUoIHtcclxuICAgICAgdGFuZGVtOiB0aWNrTWFya3NUYW5kZW0uY3JlYXRlVGFuZGVtKCAndGlja0xhYmVscycgKVxyXG4gICAgfSApO1xyXG4gICAgdGlja01hcmtzLmFkZENoaWxkKCB0aWNrTGFiZWxzICk7XHJcblxyXG4gICAgY29uc3QgbnVtYmVyT2ZUaWNrcyA9IFV0aWxzLnJvdW5kU3ltbWV0cmljKCBiZWFrZXIudm9sdW1lIC8gTUlOT1JfVElDS19TUEFDSU5HICk7XHJcbiAgICBjb25zdCBkZWx0YVkgPSBiZWFrZXJIZWlnaHQgLyBudW1iZXJPZlRpY2tzO1xyXG4gICAgY29uc3QgYmVha2VyTGVmdCA9IC1iZWFrZXJXaWR0aCAvIDI7XHJcbiAgICBjb25zdCBiZWFrZXJSaWdodCA9IGJlYWtlcldpZHRoIC8gMjtcclxuICAgIGZvciAoIGxldCBpID0gMTsgaSA8PSBudW1iZXJPZlRpY2tzOyBpKysgKSB7XHJcblxyXG4gICAgICBjb25zdCBpc01ham9yVGljayA9ICggaSAlIE1JTk9SX1RJQ0tTX1BFUl9NQUpPUl9USUNLID09PSAwICk7XHJcbiAgICAgIGNvbnN0IHRpY2tMZW5ndGggPSAoIGlzTWFqb3JUaWNrID8gTUFKT1JfVElDS19MRU5HVEggOiBNSU5PUl9USUNLX0xFTkdUSCApO1xyXG4gICAgICBjb25zdCB5ID0gLSggaSAqIGRlbHRhWSApO1xyXG5cclxuICAgICAgLy8gbGVmdCB0aWNrXHJcbiAgICAgIHRpY2tNYXJrcy5hZGRDaGlsZCggbmV3IFBhdGgoXHJcbiAgICAgICAgbmV3IFNoYXBlKCkubW92ZVRvKCBiZWFrZXJMZWZ0LCB5ICkubGluZVRvKCBiZWFrZXJMZWZ0ICsgdGlja0xlbmd0aCwgeSApLFxyXG4gICAgICAgIHsgc3Ryb2tlOiAnYmxhY2snLCBsaW5lV2lkdGg6IDIsIGxpbmVDYXA6ICdidXR0JywgbGluZUpvaW46ICdiZXZlbCcgfSApICk7XHJcblxyXG4gICAgICAvLyByaWdodCB0aWNrXHJcbiAgICAgIHRpY2tNYXJrcy5hZGRDaGlsZCggbmV3IFBhdGgoXHJcbiAgICAgICAgbmV3IFNoYXBlKCkubW92ZVRvKCBiZWFrZXJSaWdodCwgeSApLmxpbmVUbyggYmVha2VyUmlnaHQgLSB0aWNrTGVuZ3RoLCB5ICksXHJcbiAgICAgICAgeyBzdHJva2U6ICdibGFjaycsIGxpbmVXaWR0aDogMiwgbGluZUNhcDogJ2J1dHQnLCBsaW5lSm9pbjogJ2JldmVsJyB9ICkgKTtcclxuXHJcbiAgICAgIC8vIGxhYmVsIG9uIHJpZ2h0ICdtYWpvcicgdGlja1xyXG4gICAgICBpZiAoIGlzTWFqb3JUaWNrICkge1xyXG4gICAgICAgIGNvbnN0IGxhYmVsSW5kZXggPSAoIGkgLyBNSU5PUl9USUNLU19QRVJfTUFKT1JfVElDSyApIC0gMTtcclxuICAgICAgICBpZiAoIGxhYmVsSW5kZXggPCBNQUpPUl9USUNLX0xBQkVMUy5sZW5ndGggKSB7XHJcblxyXG4gICAgICAgICAgY29uc3QgbGFiZWxTdHJpbmdQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgICAgICAgIFsgUGhTY2FsZVN0cmluZ3MucGF0dGVyblsgJzB2YWx1ZScgXVsgJzF1bml0c1N0cmluZ1Byb3BlcnR5JyBdLCBQaFNjYWxlU3RyaW5ncy51bml0cy5saXRlcnNTdHJpbmdQcm9wZXJ0eSBdLFxyXG4gICAgICAgICAgICAoIHBhdHRlcm4sIGxpdGVyc1N0cmluZyApID0+IFN0cmluZ1V0aWxzLmZvcm1hdCggcGF0dGVybiwgTUFKT1JfVElDS19MQUJFTFNbIGxhYmVsSW5kZXggXSwgbGl0ZXJzU3RyaW5nIClcclxuICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgY29uc3QgbGFiZWxUZXh0ID0gbmV3IFRleHQoIGxhYmVsU3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgICAgICAgZm9udDogTUFKT1JfVElDS19GT05ULFxyXG4gICAgICAgICAgICBmaWxsOiAnYmxhY2snLFxyXG4gICAgICAgICAgICByaWdodDogYmVha2VyUmlnaHQgLSB0aWNrTGVuZ3RoIC0gVElDS19MQUJFTF9YX1NQQUNJTkcsXHJcbiAgICAgICAgICAgIGNlbnRlclk6IHksXHJcbiAgICAgICAgICAgIG1heFdpZHRoOiA4MCAvLyBkZXRlcm1pbmVkIGVtcGlyaWNhbGx5XHJcbiAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgdGlja0xhYmVscy5hZGRDaGlsZCggbGFiZWxUZXh0ICk7XHJcblxyXG4gICAgICAgICAgY29uc3QgbGFiZWxZID0geTsgLy8gY2xvc3VyZVxyXG4gICAgICAgICAgbGFiZWxUZXh0LmJvdW5kc1Byb3BlcnR5LmxpbmsoIGJvdW5kcyA9PiB7XHJcbiAgICAgICAgICAgIGxhYmVsVGV4dC5yaWdodCA9IGJlYWtlclJpZ2h0IC0gdGlja0xlbmd0aCAtIFRJQ0tfTEFCRUxfWF9TUEFDSU5HO1xyXG4gICAgICAgICAgICBsYWJlbFRleHQuY2VudGVyWSA9IGxhYmVsWTtcclxuICAgICAgICAgIH0gKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnRyYW5zbGF0aW9uID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3UG9zaXRpb24oIGJlYWtlci5wb3NpdGlvbiApO1xyXG4gIH1cclxufVxyXG5cclxucGhTY2FsZS5yZWdpc3RlciggJ0JlYWtlck5vZGUnLCBCZWFrZXJOb2RlICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxLQUFLLE1BQU0sNkJBQTZCO0FBQy9DLFNBQVNDLEtBQUssUUFBUSxnQ0FBZ0M7QUFDdEQsT0FBT0MsU0FBUyxNQUE0Qix1Q0FBdUM7QUFFbkYsT0FBT0MsV0FBVyxNQUFNLCtDQUErQztBQUV2RSxPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELFNBQVNDLElBQUksRUFBZUMsSUFBSSxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQ2pGLE9BQU9DLE9BQU8sTUFBTSxrQkFBa0I7QUFDdEMsT0FBT0MsY0FBYyxNQUFNLHlCQUF5QjtBQUdwRDtBQUNBLE1BQU1DLFVBQVUsR0FBRyxFQUFFO0FBQ3JCLE1BQU1DLGtCQUFrQixHQUFHLEdBQUcsQ0FBQyxDQUFDO0FBQ2hDLE1BQU1DLDBCQUEw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