// Copyright 2013-2023, University of Colorado Boulder

/**
 * Arrow that displays a numerical value inside the arrow (if there is room) or above the arrow.
 * Used for force arrows in Forces and Motion: Basics
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import Utils from '../../../../dot/js/Utils.js';
import merge from '../../../../phet-core/js/merge.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import ArrowShape from '../../../../scenery-phet/js/ArrowShape.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, Path, Text } from '../../../../scenery/js/imports.js';
import forcesAndMotionBasics from '../../forcesAndMotionBasics.js';
import ForcesAndMotionBasicsStrings from '../../ForcesAndMotionBasicsStrings.js';
const pattern0ValueUnitsNString = ForcesAndMotionBasicsStrings.pattern['0valueUnitsN'];

// constants
const ARROW_HEAD_WIDTH = 50;
const ARROW_HEAD_HEIGHT = 25;
class ReadoutArrow extends Node {
  /**
   * @param label the text to show for the arrow
   * @param fill the color of the arrow
   * @param tailX {number} the position of the tail in X
   * @param tailY {number} the position of the tail in Y
   * @param valueProperty {Property.<Number>} the property for the value to display
   * @param showValuesProperty {Property.<Boolean>} whether or not to display the values
   * @param {Tandem} tandem
   * @param {Object} [options] 'labelPosition' where the label text should be {side|top}
   */
  constructor(label, fill, tailX, tailY, valueProperty, showValuesProperty, tandem, options) {
    //Call the super class.  Render in svg to make the text crisper on retina display.
    super({
      tandem: tandem,
      pickable: false
    });

    //Store fields
    options = merge({
      labelPosition: 'top',
      arrowScale: 1
    }, options);
    this.options = options; // @private
    this.showValuesProperty = showValuesProperty;
    this.tailX = tailX;
    this.tailY = tailY;

    //Create and add the children
    this.arrowNode = new Path(null, merge({
      fill: fill,
      stroke: '#000000',
      lineWidth: 1,
      tandem: tandem.createTandem('arrowNode')
    }, options));
    const fontOptions = {
      font: new PhetFont({
        size: 16,
        weight: 'bold'
      }),
      maxWidth: 112
    };
    this.valueNode = new Text('110N', merge({
      tandem: tandem.createTandem('valueText')
    }, fontOptions));
    this.labelNode = new Text(label, merge({
      tandem: tandem.createTandem('labelText')
    }, fontOptions));
    this.addChild(this.arrowNode);
    this.addChild(this.valueNode);
    this.addChild(this.labelNode);

    //Update when the value changes
    valueProperty.link(value => {
      this.value = value;
      const roundedValue = Utils.toFixed(Math.abs(value), 0);
      this.valueNode.string = StringUtils.format(pattern0ValueUnitsNString, roundedValue);
      this.update();
    });

    // @public {boolean} - if the arrow overlaps another, we change the layout of the arrow labels so none of the
    // text overlaps eachother
    this.overlapsOther = false;

    //Update when the numeric readout visibility is toggled
    showValuesProperty.link(this.update.bind(this));
  }

  // @public - Sets the arrow dash, which changes when the simulation starts playing
  setArrowDash(lineDash) {
    this.arrowNode.lineDash = lineDash;
  }

  //On the motion screens, when the 'Friction' label overlaps the force vector it should be displaced vertically
  set labelPosition(position) {
    if (this.options.labelPosition !== position) {
      this.options.labelPosition = position;
      this.update();
    }
  }

  //Get the label position
  get labelPosition() {
    return this.options.labelPosition;
  }

  // @public - Update the arrow graphics and text labels
  update() {
    const value = this.value * this.options.arrowScale;

    //Don't show it if it is too small
    const hidden = Math.abs(value) < 1E-6;
    this.hidden = hidden;
    this.arrowNode.visible = !hidden;
    this.valueNode.visible = !hidden && this.showValuesProperty.value;
    this.labelNode.visible = !hidden;

    //Only change the node if visible, for performance
    if (!hidden) {
      const tailX = this.tailX;
      const tailY = this.tailY;
      const tailWidth = ARROW_HEAD_HEIGHT;
      const headWidth = ARROW_HEAD_WIDTH;

      //For short arrows, the head height should be half of the arrow length.  See https://github.com/phetsims/scenery-phet/issues/30
      const headHeight = Math.min(Math.abs(value) / 2, 40);
      this.arrowNode.shape = new ArrowShape(tailX, tailY, tailX + value, tailY, {
        tailWidth: tailWidth,
        headWidth: headWidth,
        headHeight: headHeight
      });

      //Position the value and label if the label position is on the side
      if (this.options.labelPosition === 'side') {
        if (value > 0) {
          this.labelNode.left = this.arrowNode.right + 5;
        } else {
          this.labelNode.right = this.arrowNode.left - 5;
        }
        this.labelNode.centerY = this.arrowNode.centerY;
        this.valueNode.center = this.arrowNode.center;

        // if the arrow node is still small or overlaps another arrow, the value readout will be below the arrow label
        if (this.valueNode.width + 5 > this.arrowNode.width || this.overlapsOther) {
          this.valueNode.top = this.labelNode.bottom;
          this.valueNode.centerX = this.labelNode.centerX;
        }
      } else {
        this.valueNode.center = this.arrowNode.center;

        //Position the value and label if the label position is on the bottom
        if (this.options.labelPosition === 'bottom') {
          this.labelNode.centerX = this.arrowNode.centerX;
          this.labelNode.top = isFinite(this.arrowNode.centerY) ? this.arrowNode.centerY + this.labelNode.height + 5 : 0;

          // if the arrow overlaps another or is small, we align the value readout horizontally
          // with the arrow label.
          if (this.valueNode.width + 5 > this.arrowNode.width || this.overlapsOther) {
            this.valueNode.leftCenter = this.labelNode.rightCenter.plusXY(5, 0);
          } else {
            this.valueNode.center = this.arrowNode.center;
          }
        }

        //Position the value and label if the label position is on the top
        else {
          this.labelNode.centerX = this.tailX;
          this.labelNode.bottom = isFinite(this.arrowNode.centerY) ? this.arrowNode.centerY - this.labelNode.height * 3 / 2 : 0;
          if (this.valueNode.width + 5 > this.arrowNode.width) {
            const spacingOffset = 5;
            if (value > 0) {
              this.valueNode.left = this.arrowNode.right + spacingOffset;
            } else {
              this.valueNode.right = this.arrowNode.left - spacingOffset;
            }
          }
        }
      }
    }
  }
}

// statics
ReadoutArrow.ARROW_HEAD_WIDTH = ARROW_HEAD_WIDTH;
ReadoutArrow.ARROW_HEAD_HEIGHT = ARROW_HEAD_HEIGHT;
forcesAndMotionBasics.register('ReadoutArrow', ReadoutArrow);
export default ReadoutArrow;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIm1lcmdlIiwiU3RyaW5nVXRpbHMiLCJBcnJvd1NoYXBlIiwiUGhldEZvbnQiLCJOb2RlIiwiUGF0aCIsIlRleHQiLCJmb3JjZXNBbmRNb3Rpb25CYXNpY3MiLCJGb3JjZXNBbmRNb3Rpb25CYXNpY3NTdHJpbmdzIiwicGF0dGVybjBWYWx1ZVVuaXRzTlN0cmluZyIsInBhdHRlcm4iLCJBUlJPV19IRUFEX1dJRFRIIiwiQVJST1dfSEVBRF9IRUlHSFQiLCJSZWFkb3V0QXJyb3ciLCJjb25zdHJ1Y3RvciIsImxhYmVsIiwiZmlsbCIsInRhaWxYIiwidGFpbFkiLCJ2YWx1ZVByb3BlcnR5Iiwic2hvd1ZhbHVlc1Byb3BlcnR5IiwidGFuZGVtIiwib3B0aW9ucyIsInBpY2thYmxlIiwibGFiZWxQb3NpdGlvbiIsImFycm93U2NhbGUiLCJhcnJvd05vZGUiLCJzdHJva2UiLCJsaW5lV2lkdGgiLCJjcmVhdGVUYW5kZW0iLCJmb250T3B0aW9ucyIsImZvbnQiLCJzaXplIiwid2VpZ2h0IiwibWF4V2lkdGgiLCJ2YWx1ZU5vZGUiLCJsYWJlbE5vZGUiLCJhZGRDaGlsZCIsImxpbmsiLCJ2YWx1ZSIsInJvdW5kZWRWYWx1ZSIsInRvRml4ZWQiLCJNYXRoIiwiYWJzIiwic3RyaW5nIiwiZm9ybWF0IiwidXBkYXRlIiwib3ZlcmxhcHNPdGhlciIsImJpbmQiLCJzZXRBcnJvd0Rhc2giLCJsaW5lRGFzaCIsInBvc2l0aW9uIiwiaGlkZGVuIiwidmlzaWJsZSIsInRhaWxXaWR0aCIsImhlYWRXaWR0aCIsImhlYWRIZWlnaHQiLCJtaW4iLCJzaGFwZSIsImxlZnQiLCJyaWdodCIsImNlbnRlclkiLCJjZW50ZXIiLCJ3aWR0aCIsInRvcCIsImJvdHRvbSIsImNlbnRlclgiLCJpc0Zpbml0ZSIsImhlaWdodCIsImxlZnRDZW50ZXIiLCJyaWdodENlbnRlciIsInBsdXNYWSIsInNwYWNpbmdPZmZzZXQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlJlYWRvdXRBcnJvdy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBcnJvdyB0aGF0IGRpc3BsYXlzIGEgbnVtZXJpY2FsIHZhbHVlIGluc2lkZSB0aGUgYXJyb3cgKGlmIHRoZXJlIGlzIHJvb20pIG9yIGFib3ZlIHRoZSBhcnJvdy5cclxuICogVXNlZCBmb3IgZm9yY2UgYXJyb3dzIGluIEZvcmNlcyBhbmQgTW90aW9uOiBCYXNpY3NcclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1V0aWxzLmpzJztcclxuaW1wb3J0IG1lcmdlIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9tZXJnZS5qcyc7XHJcbmltcG9ydCBTdHJpbmdVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3V0aWwvU3RyaW5nVXRpbHMuanMnO1xyXG5pbXBvcnQgQXJyb3dTaGFwZSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvQXJyb3dTaGFwZS5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBOb2RlLCBQYXRoLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IGZvcmNlc0FuZE1vdGlvbkJhc2ljcyBmcm9tICcuLi8uLi9mb3JjZXNBbmRNb3Rpb25CYXNpY3MuanMnO1xyXG5pbXBvcnQgRm9yY2VzQW5kTW90aW9uQmFzaWNzU3RyaW5ncyBmcm9tICcuLi8uLi9Gb3JjZXNBbmRNb3Rpb25CYXNpY3NTdHJpbmdzLmpzJztcclxuXHJcbmNvbnN0IHBhdHRlcm4wVmFsdWVVbml0c05TdHJpbmcgPSBGb3JjZXNBbmRNb3Rpb25CYXNpY3NTdHJpbmdzLnBhdHRlcm5bICcwdmFsdWVVbml0c04nIF07XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgQVJST1dfSEVBRF9XSURUSCA9IDUwO1xyXG5jb25zdCBBUlJPV19IRUFEX0hFSUdIVCA9IDI1O1xyXG5cclxuY2xhc3MgUmVhZG91dEFycm93IGV4dGVuZHMgTm9kZSB7XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIGxhYmVsIHRoZSB0ZXh0IHRvIHNob3cgZm9yIHRoZSBhcnJvd1xyXG4gICAqIEBwYXJhbSBmaWxsIHRoZSBjb2xvciBvZiB0aGUgYXJyb3dcclxuICAgKiBAcGFyYW0gdGFpbFgge251bWJlcn0gdGhlIHBvc2l0aW9uIG9mIHRoZSB0YWlsIGluIFhcclxuICAgKiBAcGFyYW0gdGFpbFkge251bWJlcn0gdGhlIHBvc2l0aW9uIG9mIHRoZSB0YWlsIGluIFlcclxuICAgKiBAcGFyYW0gdmFsdWVQcm9wZXJ0eSB7UHJvcGVydHkuPE51bWJlcj59IHRoZSBwcm9wZXJ0eSBmb3IgdGhlIHZhbHVlIHRvIGRpc3BsYXlcclxuICAgKiBAcGFyYW0gc2hvd1ZhbHVlc1Byb3BlcnR5IHtQcm9wZXJ0eS48Qm9vbGVhbj59IHdoZXRoZXIgb3Igbm90IHRvIGRpc3BsYXkgdGhlIHZhbHVlc1xyXG4gICAqIEBwYXJhbSB7VGFuZGVtfSB0YW5kZW1cclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdICdsYWJlbFBvc2l0aW9uJyB3aGVyZSB0aGUgbGFiZWwgdGV4dCBzaG91bGQgYmUge3NpZGV8dG9wfVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBsYWJlbCwgZmlsbCwgdGFpbFgsIHRhaWxZLCB2YWx1ZVByb3BlcnR5LCBzaG93VmFsdWVzUHJvcGVydHksIHRhbmRlbSwgb3B0aW9ucyApIHtcclxuXHJcbiAgICAvL0NhbGwgdGhlIHN1cGVyIGNsYXNzLiAgUmVuZGVyIGluIHN2ZyB0byBtYWtlIHRoZSB0ZXh0IGNyaXNwZXIgb24gcmV0aW5hIGRpc3BsYXkuXHJcbiAgICBzdXBlcigge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbSxcclxuICAgICAgcGlja2FibGU6IGZhbHNlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy9TdG9yZSBmaWVsZHNcclxuICAgIG9wdGlvbnMgPSBtZXJnZSggeyBsYWJlbFBvc2l0aW9uOiAndG9wJywgYXJyb3dTY2FsZTogMSB9LCBvcHRpb25zICk7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOyAvLyBAcHJpdmF0ZVxyXG4gICAgdGhpcy5zaG93VmFsdWVzUHJvcGVydHkgPSBzaG93VmFsdWVzUHJvcGVydHk7XHJcbiAgICB0aGlzLnRhaWxYID0gdGFpbFg7XHJcbiAgICB0aGlzLnRhaWxZID0gdGFpbFk7XHJcblxyXG4gICAgLy9DcmVhdGUgYW5kIGFkZCB0aGUgY2hpbGRyZW5cclxuICAgIHRoaXMuYXJyb3dOb2RlID0gbmV3IFBhdGgoIG51bGwsIG1lcmdlKCB7XHJcbiAgICAgIGZpbGw6IGZpbGwsXHJcbiAgICAgIHN0cm9rZTogJyMwMDAwMDAnLFxyXG4gICAgICBsaW5lV2lkdGg6IDEsXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2Fycm93Tm9kZScgKVxyXG4gICAgfSwgb3B0aW9ucyApICk7XHJcbiAgICBjb25zdCBmb250T3B0aW9ucyA9IHsgZm9udDogbmV3IFBoZXRGb250KCB7IHNpemU6IDE2LCB3ZWlnaHQ6ICdib2xkJyB9ICksIG1heFdpZHRoOiAxMTIgfTtcclxuICAgIHRoaXMudmFsdWVOb2RlID0gbmV3IFRleHQoICcxMTBOJywgbWVyZ2UoIHsgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAndmFsdWVUZXh0JyApIH0sIGZvbnRPcHRpb25zICkgKTtcclxuICAgIHRoaXMubGFiZWxOb2RlID0gbmV3IFRleHQoIGxhYmVsLCBtZXJnZSggeyB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdsYWJlbFRleHQnICkgfSwgZm9udE9wdGlvbnMgKSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5hcnJvd05vZGUgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMudmFsdWVOb2RlICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLmxhYmVsTm9kZSApO1xyXG5cclxuICAgIC8vVXBkYXRlIHdoZW4gdGhlIHZhbHVlIGNoYW5nZXNcclxuICAgIHZhbHVlUHJvcGVydHkubGluayggdmFsdWUgPT4ge1xyXG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICAgIGNvbnN0IHJvdW5kZWRWYWx1ZSA9IFV0aWxzLnRvRml4ZWQoIE1hdGguYWJzKCB2YWx1ZSApLCAwICk7XHJcbiAgICAgIHRoaXMudmFsdWVOb2RlLnN0cmluZyA9IFN0cmluZ1V0aWxzLmZvcm1hdCggcGF0dGVybjBWYWx1ZVVuaXRzTlN0cmluZywgcm91bmRlZFZhbHVlICk7XHJcbiAgICAgIHRoaXMudXBkYXRlKCk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyB7Ym9vbGVhbn0gLSBpZiB0aGUgYXJyb3cgb3ZlcmxhcHMgYW5vdGhlciwgd2UgY2hhbmdlIHRoZSBsYXlvdXQgb2YgdGhlIGFycm93IGxhYmVscyBzbyBub25lIG9mIHRoZVxyXG4gICAgLy8gdGV4dCBvdmVybGFwcyBlYWNob3RoZXJcclxuICAgIHRoaXMub3ZlcmxhcHNPdGhlciA9IGZhbHNlO1xyXG5cclxuICAgIC8vVXBkYXRlIHdoZW4gdGhlIG51bWVyaWMgcmVhZG91dCB2aXNpYmlsaXR5IGlzIHRvZ2dsZWRcclxuICAgIHNob3dWYWx1ZXNQcm9wZXJ0eS5saW5rKCB0aGlzLnVwZGF0ZS5iaW5kKCB0aGlzICkgKTtcclxuICB9XHJcblxyXG4gIC8vIEBwdWJsaWMgLSBTZXRzIHRoZSBhcnJvdyBkYXNoLCB3aGljaCBjaGFuZ2VzIHdoZW4gdGhlIHNpbXVsYXRpb24gc3RhcnRzIHBsYXlpbmdcclxuICBzZXRBcnJvd0Rhc2goIGxpbmVEYXNoICkgeyB0aGlzLmFycm93Tm9kZS5saW5lRGFzaCA9IGxpbmVEYXNoOyB9XHJcblxyXG4gIC8vT24gdGhlIG1vdGlvbiBzY3JlZW5zLCB3aGVuIHRoZSAnRnJpY3Rpb24nIGxhYmVsIG92ZXJsYXBzIHRoZSBmb3JjZSB2ZWN0b3IgaXQgc2hvdWxkIGJlIGRpc3BsYWNlZCB2ZXJ0aWNhbGx5XHJcbiAgc2V0IGxhYmVsUG9zaXRpb24oIHBvc2l0aW9uICkge1xyXG4gICAgaWYgKCB0aGlzLm9wdGlvbnMubGFiZWxQb3NpdGlvbiAhPT0gcG9zaXRpb24gKSB7XHJcbiAgICAgIHRoaXMub3B0aW9ucy5sYWJlbFBvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICAgIHRoaXMudXBkYXRlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvL0dldCB0aGUgbGFiZWwgcG9zaXRpb25cclxuICBnZXQgbGFiZWxQb3NpdGlvbigpIHsgcmV0dXJuIHRoaXMub3B0aW9ucy5sYWJlbFBvc2l0aW9uOyB9XHJcblxyXG4gIC8vIEBwdWJsaWMgLSBVcGRhdGUgdGhlIGFycm93IGdyYXBoaWNzIGFuZCB0ZXh0IGxhYmVsc1xyXG4gIHVwZGF0ZSgpIHtcclxuICAgIGNvbnN0IHZhbHVlID0gdGhpcy52YWx1ZSAqIHRoaXMub3B0aW9ucy5hcnJvd1NjYWxlO1xyXG5cclxuICAgIC8vRG9uJ3Qgc2hvdyBpdCBpZiBpdCBpcyB0b28gc21hbGxcclxuICAgIGNvbnN0IGhpZGRlbiA9IE1hdGguYWJzKCB2YWx1ZSApIDwgMUUtNjtcclxuICAgIHRoaXMuaGlkZGVuID0gaGlkZGVuO1xyXG4gICAgdGhpcy5hcnJvd05vZGUudmlzaWJsZSA9ICFoaWRkZW47XHJcbiAgICB0aGlzLnZhbHVlTm9kZS52aXNpYmxlID0gIWhpZGRlbiAmJiB0aGlzLnNob3dWYWx1ZXNQcm9wZXJ0eS52YWx1ZTtcclxuICAgIHRoaXMubGFiZWxOb2RlLnZpc2libGUgPSAhaGlkZGVuO1xyXG5cclxuICAgIC8vT25seSBjaGFuZ2UgdGhlIG5vZGUgaWYgdmlzaWJsZSwgZm9yIHBlcmZvcm1hbmNlXHJcbiAgICBpZiAoICFoaWRkZW4gKSB7XHJcbiAgICAgIGNvbnN0IHRhaWxYID0gdGhpcy50YWlsWDtcclxuICAgICAgY29uc3QgdGFpbFkgPSB0aGlzLnRhaWxZO1xyXG4gICAgICBjb25zdCB0YWlsV2lkdGggPSBBUlJPV19IRUFEX0hFSUdIVDtcclxuICAgICAgY29uc3QgaGVhZFdpZHRoID0gQVJST1dfSEVBRF9XSURUSDtcclxuXHJcbiAgICAgIC8vRm9yIHNob3J0IGFycm93cywgdGhlIGhlYWQgaGVpZ2h0IHNob3VsZCBiZSBoYWxmIG9mIHRoZSBhcnJvdyBsZW5ndGguICBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3NjZW5lcnktcGhldC9pc3N1ZXMvMzBcclxuICAgICAgY29uc3QgaGVhZEhlaWdodCA9IE1hdGgubWluKCBNYXRoLmFicyggdmFsdWUgKSAvIDIsIDQwICk7XHJcbiAgICAgIHRoaXMuYXJyb3dOb2RlLnNoYXBlID0gbmV3IEFycm93U2hhcGUoIHRhaWxYLCB0YWlsWSwgdGFpbFggKyB2YWx1ZSwgdGFpbFksXHJcbiAgICAgICAgeyB0YWlsV2lkdGg6IHRhaWxXaWR0aCwgaGVhZFdpZHRoOiBoZWFkV2lkdGgsIGhlYWRIZWlnaHQ6IGhlYWRIZWlnaHQgfSApO1xyXG5cclxuICAgICAgLy9Qb3NpdGlvbiB0aGUgdmFsdWUgYW5kIGxhYmVsIGlmIHRoZSBsYWJlbCBwb3NpdGlvbiBpcyBvbiB0aGUgc2lkZVxyXG4gICAgICBpZiAoIHRoaXMub3B0aW9ucy5sYWJlbFBvc2l0aW9uID09PSAnc2lkZScgKSB7XHJcbiAgICAgICAgaWYgKCB2YWx1ZSA+IDAgKSB7XHJcbiAgICAgICAgICB0aGlzLmxhYmVsTm9kZS5sZWZ0ID0gdGhpcy5hcnJvd05vZGUucmlnaHQgKyA1O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIHRoaXMubGFiZWxOb2RlLnJpZ2h0ID0gdGhpcy5hcnJvd05vZGUubGVmdCAtIDU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGFiZWxOb2RlLmNlbnRlclkgPSB0aGlzLmFycm93Tm9kZS5jZW50ZXJZO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlTm9kZS5jZW50ZXIgPSB0aGlzLmFycm93Tm9kZS5jZW50ZXI7XHJcblxyXG4gICAgICAgIC8vIGlmIHRoZSBhcnJvdyBub2RlIGlzIHN0aWxsIHNtYWxsIG9yIG92ZXJsYXBzIGFub3RoZXIgYXJyb3csIHRoZSB2YWx1ZSByZWFkb3V0IHdpbGwgYmUgYmVsb3cgdGhlIGFycm93IGxhYmVsXHJcbiAgICAgICAgaWYgKCB0aGlzLnZhbHVlTm9kZS53aWR0aCArIDUgPiB0aGlzLmFycm93Tm9kZS53aWR0aCB8fCB0aGlzLm92ZXJsYXBzT3RoZXIgKSB7XHJcbiAgICAgICAgICB0aGlzLnZhbHVlTm9kZS50b3AgPSB0aGlzLmxhYmVsTm9kZS5ib3R0b207XHJcbiAgICAgICAgICB0aGlzLnZhbHVlTm9kZS5jZW50ZXJYID0gdGhpcy5sYWJlbE5vZGUuY2VudGVyWDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdGhpcy52YWx1ZU5vZGUuY2VudGVyID0gdGhpcy5hcnJvd05vZGUuY2VudGVyO1xyXG5cclxuICAgICAgICAvL1Bvc2l0aW9uIHRoZSB2YWx1ZSBhbmQgbGFiZWwgaWYgdGhlIGxhYmVsIHBvc2l0aW9uIGlzIG9uIHRoZSBib3R0b21cclxuICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5sYWJlbFBvc2l0aW9uID09PSAnYm90dG9tJyApIHtcclxuICAgICAgICAgIHRoaXMubGFiZWxOb2RlLmNlbnRlclggPSB0aGlzLmFycm93Tm9kZS5jZW50ZXJYO1xyXG4gICAgICAgICAgdGhpcy5sYWJlbE5vZGUudG9wID0gaXNGaW5pdGUoIHRoaXMuYXJyb3dOb2RlLmNlbnRlclkgKSA/IHRoaXMuYXJyb3dOb2RlLmNlbnRlclkgKyB0aGlzLmxhYmVsTm9kZS5oZWlnaHQgKyA1IDogMDtcclxuXHJcbiAgICAgICAgICAvLyBpZiB0aGUgYXJyb3cgb3ZlcmxhcHMgYW5vdGhlciBvciBpcyBzbWFsbCwgd2UgYWxpZ24gdGhlIHZhbHVlIHJlYWRvdXQgaG9yaXpvbnRhbGx5XHJcbiAgICAgICAgICAvLyB3aXRoIHRoZSBhcnJvdyBsYWJlbC5cclxuICAgICAgICAgIGlmICggdGhpcy52YWx1ZU5vZGUud2lkdGggKyA1ID4gdGhpcy5hcnJvd05vZGUud2lkdGggfHwgdGhpcy5vdmVybGFwc090aGVyICkge1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlTm9kZS5sZWZ0Q2VudGVyID0gdGhpcy5sYWJlbE5vZGUucmlnaHRDZW50ZXIucGx1c1hZKCA1LCAwICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZU5vZGUuY2VudGVyID0gdGhpcy5hcnJvd05vZGUuY2VudGVyO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9Qb3NpdGlvbiB0aGUgdmFsdWUgYW5kIGxhYmVsIGlmIHRoZSBsYWJlbCBwb3NpdGlvbiBpcyBvbiB0aGUgdG9wXHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmxhYmVsTm9kZS5jZW50ZXJYID0gdGhpcy50YWlsWDtcclxuICAgICAgICAgIHRoaXMubGFiZWxOb2RlLmJvdHRvbSA9IGlzRmluaXRlKCB0aGlzLmFycm93Tm9kZS5jZW50ZXJZICkgPyB0aGlzLmFycm93Tm9kZS5jZW50ZXJZIC0gdGhpcy5sYWJlbE5vZGUuaGVpZ2h0ICogMyAvIDIgOiAwO1xyXG5cclxuICAgICAgICAgIGlmICggdGhpcy52YWx1ZU5vZGUud2lkdGggKyA1ID4gdGhpcy5hcnJvd05vZGUud2lkdGggKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNwYWNpbmdPZmZzZXQgPSA1O1xyXG4gICAgICAgICAgICBpZiAoIHZhbHVlID4gMCApIHtcclxuICAgICAgICAgICAgICB0aGlzLnZhbHVlTm9kZS5sZWZ0ID0gdGhpcy5hcnJvd05vZGUucmlnaHQgKyBzcGFjaW5nT2Zmc2V0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgIHRoaXMudmFsdWVOb2RlLnJpZ2h0ID0gdGhpcy5hcnJvd05vZGUubGVmdCAtIHNwYWNpbmdPZmZzZXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcblxyXG5cclxuLy8gc3RhdGljc1xyXG5SZWFkb3V0QXJyb3cuQVJST1dfSEVBRF9XSURUSCA9IEFSUk9XX0hFQURfV0lEVEg7XHJcblJlYWRvdXRBcnJvdy5BUlJPV19IRUFEX0hFSUdIVCA9IEFSUk9XX0hFQURfSEVJR0hUO1xyXG5cclxuZm9yY2VzQW5kTW90aW9uQmFzaWNzLnJlZ2lzdGVyKCAnUmVhZG91dEFycm93JywgUmVhZG91dEFycm93ICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBSZWFkb3V0QXJyb3c7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsS0FBSyxNQUFNLG1DQUFtQztBQUNyRCxPQUFPQyxXQUFXLE1BQU0sK0NBQStDO0FBQ3ZFLE9BQU9DLFVBQVUsTUFBTSwyQ0FBMkM7QUFDbEUsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxJQUFJLEVBQUVDLElBQUksRUFBRUMsSUFBSSxRQUFRLG1DQUFtQztBQUNwRSxPQUFPQyxxQkFBcUIsTUFBTSxnQ0FBZ0M7QUFDbEUsT0FBT0MsNEJBQTRCLE1BQU0sdUNBQXVDO0FBRWhGLE1BQU1DLHlCQUF5QixHQUFHRCw0QkFBNEIsQ0FBQ0UsT0FBTyxDQUFFLGNBQWMsQ0FBRTs7QUFFeEY7QUFDQSxNQUFNQyxnQkFBZ0IsR0FBRyxFQUFFO0FBQzNCLE1BQU1D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