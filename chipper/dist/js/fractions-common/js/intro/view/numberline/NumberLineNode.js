// Copyright 2018-2022, University of Colorado Boulder

/**
 * Displays a number line.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Multilink from '../../../../../axon/js/Multilink.js';
import NumberProperty from '../../../../../axon/js/NumberProperty.js';
import Bounds2 from '../../../../../dot/js/Bounds2.js';
import Utils from '../../../../../dot/js/Utils.js';
import { Shape } from '../../../../../kite/js/imports.js';
import merge from '../../../../../phet-core/js/merge.js';
import ArrowNode from '../../../../../scenery-phet/js/ArrowNode.js';
import PhetFont from '../../../../../scenery-phet/js/PhetFont.js';
import { Circle, DragListener, Line, Node, Path, Text } from '../../../../../scenery/js/imports.js';
import FractionsCommonColors from '../../../common/view/FractionsCommonColors.js';
import fractionsCommon from '../../../fractionsCommon.js';
import NumberLineOrientation from '../NumberLineOrientation.js';
class NumberLineNode extends Node {
  /**
   * @param {NumberProperty} numeratorProperty
   * @param {NumberProperty} denominatorProperty
   * @param {NumberProperty} containerCountProperty
   * @param {Object} [options]
   */
  constructor(numeratorProperty, denominatorProperty, containerCountProperty, options) {
    assert && assert(numeratorProperty.range);
    assert && assert(denominatorProperty.range);
    assert && assert(containerCountProperty.range);
    options = merge({
      // {NumberLineOrientation}
      orientation: NumberLineOrientation.HORIZONTAL,
      // {boolean} - If true, an arrow will be shown next to the current value.
      showArrow: false,
      // {boolean} - If true, dragging will be able to modify the numerator.
      interactive: false,
      // {Property.<number>}
      multiplierProperty: new NumberProperty(1),
      // {number} - How many view units should a single unit (0 to 1) take up?
      unitSize: 130,
      // {number}
      majorTickLength: 80,
      minorTickLength: 40,
      evenMajorLineWidth: 3,
      oddMajorLineWidth: 3,
      minorTickLineWidth: 2,
      axisLineWidth: 3,
      markerRadius: 12,
      markerLineWidth: 3,
      arrowLength: 22,
      highlightLineWidth: 8,
      highlightExtension: 8,
      // {ColorDef}
      markerFill: FractionsCommonColors.introCircleFillProperty,
      arrowFill: FractionsCommonColors.introCircleFillProperty,
      // NOTE: Should we add an isUserControlledProperty so we can properly handle lock-out with other
      // controls? AP noted that multitouch handling was not a priority based on current deadlines.

      // {PhetFont}
      tickLabelFont: new PhetFont(40)
    }, options);
    super();

    // @private {Property.<number>}
    this.numeratorProperty = numeratorProperty;
    this.denominatorProperty = denominatorProperty;
    this.containerCountProperty = containerCountProperty;
    this.multiplierProperty = options.multiplierProperty;
    const majorTickNodes = _.range(0, containerCountProperty.range.max + 1).map(n => {
      return new Node({
        x: n * options.unitSize,
        children: [new Line(0, -options.majorTickLength / 2, 0, options.majorTickLength / 2, {
          stroke: 'black',
          lineWidth: n % 2 === 0 ? options.evenMajorLineWidth : options.oddMajorLineWidth
        }), new Text(n, {
          rotation: options.orientation === NumberLineOrientation.HORIZONTAL ? 0 : Math.PI / 2,
          centerX: 0,
          top: options.majorTickLength / 2 + 4,
          font: options.tickLabelFont
        })]
      });
    });
    const axisNode = new Line({
      stroke: 'black',
      lineWidth: options.axisLineWidth
    });
    const minorTicksNode = new Path(null, {
      stroke: 'black'
    });
    const multipliedTicksNode = new Path(null, {
      stroke: 'black'
    });
    const markerNode = new Circle(options.markerRadius, {
      fill: options.markerFill,
      stroke: 'black',
      lineWidth: options.markerLineWidth
    });
    const arrowNode = new ArrowNode(0, -options.arrowLength, 0, 0, {
      fill: options.arrowFill,
      stroke: 'black',
      headWidth: 9,
      tailWidth: 4
    });
    if (options.showArrow) {
      markerNode.addChild(arrowNode);
    }
    const highlightNode = new Line({
      stroke: FractionsCommonColors.introNumberLineHighlightProperty,
      lineWidth: options.highlightLineWidth
    });
    const hitTargetNode = new Node({
      cursor: 'pointer'
    });
    if (options.interactive) {
      const setApproximateValue = n => {
        const idealNumerator = Utils.roundSymmetric(n * denominatorProperty.value);
        const restrictedNumerator = Math.min(idealNumerator, denominatorProperty.value * containerCountProperty.value);
        numeratorProperty.value = numeratorProperty.range.constrainValue(restrictedNumerator);
      };

      // @private {DragListener}
      this.dragListener = new DragListener({
        applyOffset: false,
        start(event, listener) {
          setApproximateValue(listener.parentPoint.x / options.unitSize);
        },
        drag(event, listener) {
          setApproximateValue(listener.parentPoint.x / options.unitSize);
        }
      });
      hitTargetNode.addInputListener(this.dragListener);
    }

    // @private {function}
    this.containerCountListener = containerCount => {
      const width = containerCount * options.unitSize;
      majorTickNodes.forEach((node, index) => {
        node.visible = index <= containerCount;
      });
      axisNode.x2 = width;
      const hitBounds = new Bounds2(0, -options.majorTickLength / 2, width, options.majorTickLength / 2);
      hitTargetNode.mouseArea = hitBounds.dilated(5);
      hitTargetNode.touchArea = hitBounds.dilated(10);
    };
    this.containerCountProperty.link(this.containerCountListener);

    // @private {Multilink}
    this.minorTickMultilink = Multilink.multilink([denominatorProperty, containerCountProperty], (denominator, containerCount) => {
      const shape = new Shape();
      for (let i = 0; i <= containerCount * denominator; i++) {
        // Don't draw over major ticks
        if (i % denominator === 0) {
          continue;
        }
        const x = i * options.unitSize / denominator;
        shape.moveTo(x, -options.minorTickLength / 2).lineTo(x, 0);
      }
      minorTicksNode.shape = shape;
    });

    // @private {Multilink}
    this.multipliedTickMultilink = Multilink.multilink([denominatorProperty, containerCountProperty, options.multiplierProperty], (denominator, containerCount, multiplier) => {
      const shape = new Shape();
      const effectiveDenominator = denominator * multiplier;
      for (let i = 0; i <= containerCount * effectiveDenominator; i++) {
        // Don't draw over major ticks
        if (i % effectiveDenominator === 0) {
          continue;
        }
        const x = i * options.unitSize / effectiveDenominator;
        shape.moveTo(x, 0).lineTo(x, options.minorTickLength / 2);
      }
      multipliedTicksNode.shape = shape;
    });

    // @private {Multilink}
    this.markerMultilink = Multilink.multilink([numeratorProperty, denominatorProperty], (numerator, denominator) => {
      const x = options.unitSize * numerator / denominator;
      const useMajorTick = numerator % denominator === 0;
      const tickY = (useMajorTick ? options.majorTickLength : options.minorTickLength) / 2;
      markerNode.x = x;
      arrowNode.y = -tickY - 4;
      highlightNode.x1 = x;
      highlightNode.x2 = x;
      highlightNode.y1 = -tickY - options.highlightExtension;
      highlightNode.y2 = tickY + options.highlightExtension;
    });
    this.children = [highlightNode, axisNode, minorTicksNode, multipliedTicksNode, ...majorTickNodes, markerNode, hitTargetNode];

    // @public {Vector2} - The local-bounds position of the true "left" for layout purposes (so we can ignore the
    // arrow when aligning)
    this.localLayoutPoint = majorTickNodes[0].leftTop;
    if (options.orientation === NumberLineOrientation.VERTICAL) {
      this.rotation = -Math.PI / 2;
      this.y = containerCountProperty.range.max * options.unitSize / 2;
    } else {
      this.x = -containerCountProperty.range.max * options.unitSize / 2;
    }
    this.mutate(options);
  }

  /**
   * Releases references.
   * @public
   * @override
   */
  dispose() {
    this.containerCountProperty.unlink(this.containerCountListener);
    this.minorTickMultilink.dispose();
    this.multipliedTickMultilink.dispose();
    this.markerMultilink.dispose();
    this.dragListener && this.dragListener.dispose();
    super.dispose();
  }
}
fractionsCommon.register('NumberLineNode', NumberLineNode);
export default NumberLineNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aWxpbmsiLCJOdW1iZXJQcm9wZXJ0eSIsIkJvdW5kczIiLCJVdGlscyIsIlNoYXBlIiwibWVyZ2UiLCJBcnJvd05vZGUiLCJQaGV0Rm9udCIsIkNpcmNsZSIsIkRyYWdMaXN0ZW5lciIsIkxpbmUiLCJOb2RlIiwiUGF0aCIsIlRleHQiLCJGcmFjdGlvbnNDb21tb25Db2xvcnMiLCJmcmFjdGlvbnNDb21tb24iLCJOdW1iZXJMaW5lT3JpZW50YXRpb24iLCJOdW1iZXJMaW5lTm9kZSIsImNvbnN0cnVjdG9yIiwibnVtZXJhdG9yUHJvcGVydHkiLCJkZW5vbWluYXRvclByb3BlcnR5IiwiY29udGFpbmVyQ291bnRQcm9wZXJ0eSIsIm9wdGlvbnMiLCJhc3NlcnQiLCJyYW5nZSIsIm9yaWVudGF0aW9uIiwiSE9SSVpPTlRBTCIsInNob3dBcnJvdyIsImludGVyYWN0aXZlIiwibXVsdGlwbGllclByb3BlcnR5IiwidW5pdFNpemUiLCJtYWpvclRpY2tMZW5ndGgiLCJtaW5vclRpY2tMZW5ndGgiLCJldmVuTWFqb3JMaW5lV2lkdGgiLCJvZGRNYWpvckxpbmVXaWR0aCIsIm1pbm9yVGlja0xpbmVXaWR0aCIsImF4aXNMaW5lV2lkdGgiLCJtYXJrZXJSYWRpdXMiLCJtYXJrZXJMaW5lV2lkdGgiLCJhcnJvd0xlbmd0aCIsImhpZ2hsaWdodExpbmVXaWR0aCIsImhpZ2hsaWdodEV4dGVuc2lvbiIsIm1hcmtlckZpbGwiLCJpbnRyb0NpcmNsZUZpbGxQcm9wZXJ0eSIsImFycm93RmlsbCIsInRpY2tMYWJlbEZvbnQiLCJtYWpvclRpY2tOb2RlcyIsIl8iLCJtYXgiLCJtYXAiLCJuIiwieCIsImNoaWxkcmVuIiwic3Ryb2tlIiwibGluZVdpZHRoIiwicm90YXRpb24iLCJNYXRoIiwiUEkiLCJjZW50ZXJYIiwidG9wIiwiZm9udCIsImF4aXNOb2RlIiwibWlub3JUaWNrc05vZGUiLCJtdWx0aXBsaWVkVGlja3NOb2RlIiwibWFya2VyTm9kZSIsImZpbGwiLCJhcnJvd05vZGUiLCJoZWFkV2lkdGgiLCJ0YWlsV2lkdGgiLCJhZGRDaGlsZCIsImhpZ2hsaWdodE5vZGUiLCJpbnRyb051bWJlckxpbmVIaWdobGlnaHRQcm9wZXJ0eSIsImhpdFRhcmdldE5vZGUiLCJjdXJzb3IiLCJzZXRBcHByb3hpbWF0ZVZhbHVlIiwiaWRlYWxOdW1lcmF0b3IiLCJyb3VuZFN5bW1ldHJpYyIsInZhbHVlIiwicmVzdHJpY3RlZE51bWVyYXRvciIsIm1pbiIsImNvbnN0cmFpblZhbHVlIiwiZHJhZ0xpc3RlbmVyIiwiYXBwbHlPZmZzZXQiLCJzdGFydCIsImV2ZW50IiwibGlzdGVuZXIiLCJwYXJlbnRQb2ludCIsImRyYWciLCJhZGRJbnB1dExpc3RlbmVyIiwiY29udGFpbmVyQ291bnRMaXN0ZW5lciIsImNvbnRhaW5lckNvdW50Iiwid2lkdGgiLCJmb3JFYWNoIiwibm9kZSIsImluZGV4IiwidmlzaWJsZSIsIngyIiwiaGl0Qm91bmRzIiwibW91c2VBcmVhIiwiZGlsYXRlZCIsInRvdWNoQXJlYSIsImxpbmsiLCJtaW5vclRpY2tNdWx0aWxpbmsiLCJtdWx0aWxpbmsiLCJkZW5vbWluYXRvciIsInNoYXBlIiwiaSIsIm1vdmVUbyIsImxpbmVUbyIsIm11bHRpcGxpZWRUaWNrTXVsdGlsaW5rIiwibXVsdGlwbGllciIsImVmZmVjdGl2ZURlbm9taW5hdG9yIiwibWFya2VyTXVsdGlsaW5rIiwibnVtZXJhdG9yIiwidXNlTWFqb3JUaWNrIiwidGlja1kiLCJ5IiwieDEiLCJ5MSIsInkyIiwibG9jYWxMYXlvdXRQb2ludCIsImxlZnRUb3AiLCJWRVJUSUNBTCIsIm11dGF0ZSIsImRpc3Bvc2UiLCJ1bmxpbmsiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIk51bWJlckxpbmVOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERpc3BsYXlzIGEgbnVtYmVyIGxpbmUuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgTXVsdGlsaW5rIGZyb20gJy4uLy4uLy4uLy4uLy4uL2F4b24vanMvTXVsdGlsaW5rLmpzJztcclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgQm91bmRzMiBmcm9tICcuLi8uLi8uLi8uLi8uLi9kb3QvanMvQm91bmRzMi5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgQXJyb3dOb2RlIGZyb20gJy4uLy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9BcnJvd05vZGUuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgQ2lyY2xlLCBEcmFnTGlzdGVuZXIsIExpbmUsIE5vZGUsIFBhdGgsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgRnJhY3Rpb25zQ29tbW9uQ29sb3JzIGZyb20gJy4uLy4uLy4uL2NvbW1vbi92aWV3L0ZyYWN0aW9uc0NvbW1vbkNvbG9ycy5qcyc7XHJcbmltcG9ydCBmcmFjdGlvbnNDb21tb24gZnJvbSAnLi4vLi4vLi4vZnJhY3Rpb25zQ29tbW9uLmpzJztcclxuaW1wb3J0IE51bWJlckxpbmVPcmllbnRhdGlvbiBmcm9tICcuLi9OdW1iZXJMaW5lT3JpZW50YXRpb24uanMnO1xyXG5cclxuY2xhc3MgTnVtYmVyTGluZU5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuICAvKipcclxuICAgKiBAcGFyYW0ge051bWJlclByb3BlcnR5fSBudW1lcmF0b3JQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSB7TnVtYmVyUHJvcGVydHl9IGRlbm9taW5hdG9yUHJvcGVydHlcclxuICAgKiBAcGFyYW0ge051bWJlclByb3BlcnR5fSBjb250YWluZXJDb3VudFByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBudW1lcmF0b3JQcm9wZXJ0eSwgZGVub21pbmF0b3JQcm9wZXJ0eSwgY29udGFpbmVyQ291bnRQcm9wZXJ0eSwgb3B0aW9ucyApIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG51bWVyYXRvclByb3BlcnR5LnJhbmdlICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBkZW5vbWluYXRvclByb3BlcnR5LnJhbmdlICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBjb250YWluZXJDb3VudFByb3BlcnR5LnJhbmdlICk7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcbiAgICAgIC8vIHtOdW1iZXJMaW5lT3JpZW50YXRpb259XHJcbiAgICAgIG9yaWVudGF0aW9uOiBOdW1iZXJMaW5lT3JpZW50YXRpb24uSE9SSVpPTlRBTCxcclxuXHJcbiAgICAgIC8vIHtib29sZWFufSAtIElmIHRydWUsIGFuIGFycm93IHdpbGwgYmUgc2hvd24gbmV4dCB0byB0aGUgY3VycmVudCB2YWx1ZS5cclxuICAgICAgc2hvd0Fycm93OiBmYWxzZSxcclxuXHJcbiAgICAgIC8vIHtib29sZWFufSAtIElmIHRydWUsIGRyYWdnaW5nIHdpbGwgYmUgYWJsZSB0byBtb2RpZnkgdGhlIG51bWVyYXRvci5cclxuICAgICAgaW50ZXJhY3RpdmU6IGZhbHNlLFxyXG5cclxuICAgICAgLy8ge1Byb3BlcnR5LjxudW1iZXI+fVxyXG4gICAgICBtdWx0aXBsaWVyUHJvcGVydHk6IG5ldyBOdW1iZXJQcm9wZXJ0eSggMSApLFxyXG5cclxuICAgICAgLy8ge251bWJlcn0gLSBIb3cgbWFueSB2aWV3IHVuaXRzIHNob3VsZCBhIHNpbmdsZSB1bml0ICgwIHRvIDEpIHRha2UgdXA/XHJcbiAgICAgIHVuaXRTaXplOiAxMzAsXHJcblxyXG4gICAgICAvLyB7bnVtYmVyfVxyXG4gICAgICBtYWpvclRpY2tMZW5ndGg6IDgwLFxyXG4gICAgICBtaW5vclRpY2tMZW5ndGg6IDQwLFxyXG4gICAgICBldmVuTWFqb3JMaW5lV2lkdGg6IDMsXHJcbiAgICAgIG9kZE1ham9yTGluZVdpZHRoOiAzLFxyXG4gICAgICBtaW5vclRpY2tMaW5lV2lkdGg6IDIsXHJcbiAgICAgIGF4aXNMaW5lV2lkdGg6IDMsXHJcbiAgICAgIG1hcmtlclJhZGl1czogMTIsXHJcbiAgICAgIG1hcmtlckxpbmVXaWR0aDogMyxcclxuICAgICAgYXJyb3dMZW5ndGg6IDIyLFxyXG4gICAgICBoaWdobGlnaHRMaW5lV2lkdGg6IDgsXHJcbiAgICAgIGhpZ2hsaWdodEV4dGVuc2lvbjogOCxcclxuXHJcbiAgICAgIC8vIHtDb2xvckRlZn1cclxuICAgICAgbWFya2VyRmlsbDogRnJhY3Rpb25zQ29tbW9uQ29sb3JzLmludHJvQ2lyY2xlRmlsbFByb3BlcnR5LFxyXG4gICAgICBhcnJvd0ZpbGw6IEZyYWN0aW9uc0NvbW1vbkNvbG9ycy5pbnRyb0NpcmNsZUZpbGxQcm9wZXJ0eSxcclxuXHJcbiAgICAgIC8vIE5PVEU6IFNob3VsZCB3ZSBhZGQgYW4gaXNVc2VyQ29udHJvbGxlZFByb3BlcnR5IHNvIHdlIGNhbiBwcm9wZXJseSBoYW5kbGUgbG9jay1vdXQgd2l0aCBvdGhlclxyXG4gICAgICAvLyBjb250cm9scz8gQVAgbm90ZWQgdGhhdCBtdWx0aXRvdWNoIGhhbmRsaW5nIHdhcyBub3QgYSBwcmlvcml0eSBiYXNlZCBvbiBjdXJyZW50IGRlYWRsaW5lcy5cclxuXHJcbiAgICAgIC8vIHtQaGV0Rm9udH1cclxuICAgICAgdGlja0xhYmVsRm9udDogbmV3IFBoZXRGb250KCA0MCApXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSB7UHJvcGVydHkuPG51bWJlcj59XHJcbiAgICB0aGlzLm51bWVyYXRvclByb3BlcnR5ID0gbnVtZXJhdG9yUHJvcGVydHk7XHJcbiAgICB0aGlzLmRlbm9taW5hdG9yUHJvcGVydHkgPSBkZW5vbWluYXRvclByb3BlcnR5O1xyXG4gICAgdGhpcy5jb250YWluZXJDb3VudFByb3BlcnR5ID0gY29udGFpbmVyQ291bnRQcm9wZXJ0eTtcclxuICAgIHRoaXMubXVsdGlwbGllclByb3BlcnR5ID0gb3B0aW9ucy5tdWx0aXBsaWVyUHJvcGVydHk7XHJcblxyXG4gICAgY29uc3QgbWFqb3JUaWNrTm9kZXMgPSBfLnJhbmdlKCAwLCBjb250YWluZXJDb3VudFByb3BlcnR5LnJhbmdlLm1heCArIDEgKS5tYXAoIG4gPT4ge1xyXG4gICAgICByZXR1cm4gbmV3IE5vZGUoIHtcclxuICAgICAgICB4OiBuICogb3B0aW9ucy51bml0U2l6ZSxcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgbmV3IExpbmUoIDAsIC1vcHRpb25zLm1ham9yVGlja0xlbmd0aCAvIDIsIDAsIG9wdGlvbnMubWFqb3JUaWNrTGVuZ3RoIC8gMiwge1xyXG4gICAgICAgICAgICBzdHJva2U6ICdibGFjaycsXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogbiAlIDIgPT09IDAgPyBvcHRpb25zLmV2ZW5NYWpvckxpbmVXaWR0aCA6IG9wdGlvbnMub2RkTWFqb3JMaW5lV2lkdGhcclxuICAgICAgICAgIH0gKSxcclxuICAgICAgICAgIG5ldyBUZXh0KCBuLCB7XHJcbiAgICAgICAgICAgIHJvdGF0aW9uOiBvcHRpb25zLm9yaWVudGF0aW9uID09PSBOdW1iZXJMaW5lT3JpZW50YXRpb24uSE9SSVpPTlRBTCA/IDAgOiBNYXRoLlBJIC8gMixcclxuICAgICAgICAgICAgY2VudGVyWDogMCxcclxuICAgICAgICAgICAgdG9wOiBvcHRpb25zLm1ham9yVGlja0xlbmd0aCAvIDIgKyA0LFxyXG4gICAgICAgICAgICBmb250OiBvcHRpb25zLnRpY2tMYWJlbEZvbnRcclxuICAgICAgICAgIH0gKVxyXG4gICAgICAgIF1cclxuICAgICAgfSApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGF4aXNOb2RlID0gbmV3IExpbmUoIHtcclxuICAgICAgc3Ryb2tlOiAnYmxhY2snLFxyXG4gICAgICBsaW5lV2lkdGg6IG9wdGlvbnMuYXhpc0xpbmVXaWR0aFxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IG1pbm9yVGlja3NOb2RlID0gbmV3IFBhdGgoIG51bGwsIHtcclxuICAgICAgc3Ryb2tlOiAnYmxhY2snXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgbXVsdGlwbGllZFRpY2tzTm9kZSA9IG5ldyBQYXRoKCBudWxsLCB7XHJcbiAgICAgIHN0cm9rZTogJ2JsYWNrJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IG1hcmtlck5vZGUgPSBuZXcgQ2lyY2xlKCBvcHRpb25zLm1hcmtlclJhZGl1cywge1xyXG4gICAgICBmaWxsOiBvcHRpb25zLm1hcmtlckZpbGwsXHJcbiAgICAgIHN0cm9rZTogJ2JsYWNrJyxcclxuICAgICAgbGluZVdpZHRoOiBvcHRpb25zLm1hcmtlckxpbmVXaWR0aFxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGFycm93Tm9kZSA9IG5ldyBBcnJvd05vZGUoIDAsIC1vcHRpb25zLmFycm93TGVuZ3RoLCAwLCAwLCB7XHJcbiAgICAgIGZpbGw6IG9wdGlvbnMuYXJyb3dGaWxsLFxyXG4gICAgICBzdHJva2U6ICdibGFjaycsXHJcbiAgICAgIGhlYWRXaWR0aDogOSxcclxuICAgICAgdGFpbFdpZHRoOiA0XHJcbiAgICB9ICk7XHJcbiAgICBpZiAoIG9wdGlvbnMuc2hvd0Fycm93ICkge1xyXG4gICAgICBtYXJrZXJOb2RlLmFkZENoaWxkKCBhcnJvd05vZGUgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBoaWdobGlnaHROb2RlID0gbmV3IExpbmUoIHtcclxuICAgICAgc3Ryb2tlOiBGcmFjdGlvbnNDb21tb25Db2xvcnMuaW50cm9OdW1iZXJMaW5lSGlnaGxpZ2h0UHJvcGVydHksXHJcbiAgICAgIGxpbmVXaWR0aDogb3B0aW9ucy5oaWdobGlnaHRMaW5lV2lkdGhcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBoaXRUYXJnZXROb2RlID0gbmV3IE5vZGUoIHtcclxuICAgICAgY3Vyc29yOiAncG9pbnRlcidcclxuICAgIH0gKTtcclxuICAgIGlmICggb3B0aW9ucy5pbnRlcmFjdGl2ZSApIHtcclxuICAgICAgY29uc3Qgc2V0QXBwcm94aW1hdGVWYWx1ZSA9IG4gPT4ge1xyXG4gICAgICAgIGNvbnN0IGlkZWFsTnVtZXJhdG9yID0gVXRpbHMucm91bmRTeW1tZXRyaWMoIG4gKiBkZW5vbWluYXRvclByb3BlcnR5LnZhbHVlICk7XHJcbiAgICAgICAgY29uc3QgcmVzdHJpY3RlZE51bWVyYXRvciA9IE1hdGgubWluKCBpZGVhbE51bWVyYXRvciwgZGVub21pbmF0b3JQcm9wZXJ0eS52YWx1ZSAqIGNvbnRhaW5lckNvdW50UHJvcGVydHkudmFsdWUgKTtcclxuICAgICAgICBudW1lcmF0b3JQcm9wZXJ0eS52YWx1ZSA9IG51bWVyYXRvclByb3BlcnR5LnJhbmdlLmNvbnN0cmFpblZhbHVlKCByZXN0cmljdGVkTnVtZXJhdG9yICk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBAcHJpdmF0ZSB7RHJhZ0xpc3RlbmVyfVxyXG4gICAgICB0aGlzLmRyYWdMaXN0ZW5lciA9IG5ldyBEcmFnTGlzdGVuZXIoIHtcclxuICAgICAgICBhcHBseU9mZnNldDogZmFsc2UsXHJcbiAgICAgICAgc3RhcnQoIGV2ZW50LCBsaXN0ZW5lciApIHtcclxuICAgICAgICAgIHNldEFwcHJveGltYXRlVmFsdWUoIGxpc3RlbmVyLnBhcmVudFBvaW50LnggLyBvcHRpb25zLnVuaXRTaXplICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBkcmFnKCBldmVudCwgbGlzdGVuZXIgKSB7XHJcbiAgICAgICAgICBzZXRBcHByb3hpbWF0ZVZhbHVlKCBsaXN0ZW5lci5wYXJlbnRQb2ludC54IC8gb3B0aW9ucy51bml0U2l6ZSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG4gICAgICBoaXRUYXJnZXROb2RlLmFkZElucHV0TGlzdGVuZXIoIHRoaXMuZHJhZ0xpc3RlbmVyICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQHByaXZhdGUge2Z1bmN0aW9ufVxyXG4gICAgdGhpcy5jb250YWluZXJDb3VudExpc3RlbmVyID0gY29udGFpbmVyQ291bnQgPT4ge1xyXG4gICAgICBjb25zdCB3aWR0aCA9IGNvbnRhaW5lckNvdW50ICogb3B0aW9ucy51bml0U2l6ZTtcclxuICAgICAgbWFqb3JUaWNrTm9kZXMuZm9yRWFjaCggKCBub2RlLCBpbmRleCApID0+IHtcclxuICAgICAgICBub2RlLnZpc2libGUgPSBpbmRleCA8PSBjb250YWluZXJDb3VudDtcclxuICAgICAgfSApO1xyXG4gICAgICBheGlzTm9kZS54MiA9IHdpZHRoO1xyXG5cclxuICAgICAgY29uc3QgaGl0Qm91bmRzID0gbmV3IEJvdW5kczIoIDAsIC1vcHRpb25zLm1ham9yVGlja0xlbmd0aCAvIDIsIHdpZHRoLCBvcHRpb25zLm1ham9yVGlja0xlbmd0aCAvIDIgKTtcclxuICAgICAgaGl0VGFyZ2V0Tm9kZS5tb3VzZUFyZWEgPSBoaXRCb3VuZHMuZGlsYXRlZCggNSApO1xyXG4gICAgICBoaXRUYXJnZXROb2RlLnRvdWNoQXJlYSA9IGhpdEJvdW5kcy5kaWxhdGVkKCAxMCApO1xyXG4gICAgfTtcclxuICAgIHRoaXMuY29udGFpbmVyQ291bnRQcm9wZXJ0eS5saW5rKCB0aGlzLmNvbnRhaW5lckNvdW50TGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSB7TXVsdGlsaW5rfVxyXG4gICAgdGhpcy5taW5vclRpY2tNdWx0aWxpbmsgPSBNdWx0aWxpbmsubXVsdGlsaW5rKCBbXHJcbiAgICAgIGRlbm9taW5hdG9yUHJvcGVydHksXHJcbiAgICAgIGNvbnRhaW5lckNvdW50UHJvcGVydHlcclxuICAgIF0sICggZGVub21pbmF0b3IsIGNvbnRhaW5lckNvdW50ICkgPT4ge1xyXG4gICAgICBjb25zdCBzaGFwZSA9IG5ldyBTaGFwZSgpO1xyXG5cclxuICAgICAgZm9yICggbGV0IGkgPSAwOyBpIDw9IGNvbnRhaW5lckNvdW50ICogZGVub21pbmF0b3I7IGkrKyApIHtcclxuICAgICAgICAvLyBEb24ndCBkcmF3IG92ZXIgbWFqb3IgdGlja3NcclxuICAgICAgICBpZiAoIGkgJSBkZW5vbWluYXRvciA9PT0gMCApIHtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgeCA9IGkgKiBvcHRpb25zLnVuaXRTaXplIC8gZGVub21pbmF0b3I7XHJcbiAgICAgICAgc2hhcGUubW92ZVRvKCB4LCAtb3B0aW9ucy5taW5vclRpY2tMZW5ndGggLyAyICkubGluZVRvKCB4LCAwICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIG1pbm9yVGlja3NOb2RlLnNoYXBlID0gc2hhcGU7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge011bHRpbGlua31cclxuICAgIHRoaXMubXVsdGlwbGllZFRpY2tNdWx0aWxpbmsgPSBNdWx0aWxpbmsubXVsdGlsaW5rKCBbXHJcbiAgICAgIGRlbm9taW5hdG9yUHJvcGVydHksXHJcbiAgICAgIGNvbnRhaW5lckNvdW50UHJvcGVydHksXHJcbiAgICAgIG9wdGlvbnMubXVsdGlwbGllclByb3BlcnR5XHJcbiAgICBdLCAoIGRlbm9taW5hdG9yLCBjb250YWluZXJDb3VudCwgbXVsdGlwbGllciApID0+IHtcclxuICAgICAgY29uc3Qgc2hhcGUgPSBuZXcgU2hhcGUoKTtcclxuICAgICAgY29uc3QgZWZmZWN0aXZlRGVub21pbmF0b3IgPSBkZW5vbWluYXRvciAqIG11bHRpcGxpZXI7XHJcblxyXG4gICAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPD0gY29udGFpbmVyQ291bnQgKiBlZmZlY3RpdmVEZW5vbWluYXRvcjsgaSsrICkge1xyXG4gICAgICAgIC8vIERvbid0IGRyYXcgb3ZlciBtYWpvciB0aWNrc1xyXG4gICAgICAgIGlmICggaSAlIGVmZmVjdGl2ZURlbm9taW5hdG9yID09PSAwICkge1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB4ID0gaSAqIG9wdGlvbnMudW5pdFNpemUgLyBlZmZlY3RpdmVEZW5vbWluYXRvcjtcclxuICAgICAgICBzaGFwZS5tb3ZlVG8oIHgsIDAgKS5saW5lVG8oIHgsIG9wdGlvbnMubWlub3JUaWNrTGVuZ3RoIC8gMiApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBtdWx0aXBsaWVkVGlja3NOb2RlLnNoYXBlID0gc2hhcGU7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge011bHRpbGlua31cclxuICAgIHRoaXMubWFya2VyTXVsdGlsaW5rID0gTXVsdGlsaW5rLm11bHRpbGluayggW1xyXG4gICAgICBudW1lcmF0b3JQcm9wZXJ0eSxcclxuICAgICAgZGVub21pbmF0b3JQcm9wZXJ0eVxyXG4gICAgXSwgKCBudW1lcmF0b3IsIGRlbm9taW5hdG9yICkgPT4ge1xyXG4gICAgICBjb25zdCB4ID0gb3B0aW9ucy51bml0U2l6ZSAqIG51bWVyYXRvciAvIGRlbm9taW5hdG9yO1xyXG4gICAgICBjb25zdCB1c2VNYWpvclRpY2sgPSBudW1lcmF0b3IgJSBkZW5vbWluYXRvciA9PT0gMDtcclxuICAgICAgY29uc3QgdGlja1kgPSAoIHVzZU1ham9yVGljayA/IG9wdGlvbnMubWFqb3JUaWNrTGVuZ3RoIDogb3B0aW9ucy5taW5vclRpY2tMZW5ndGggKSAvIDI7XHJcbiAgICAgIG1hcmtlck5vZGUueCA9IHg7XHJcbiAgICAgIGFycm93Tm9kZS55ID0gLXRpY2tZIC0gNDtcclxuICAgICAgaGlnaGxpZ2h0Tm9kZS54MSA9IHg7XHJcbiAgICAgIGhpZ2hsaWdodE5vZGUueDIgPSB4O1xyXG4gICAgICBoaWdobGlnaHROb2RlLnkxID0gLXRpY2tZIC0gb3B0aW9ucy5oaWdobGlnaHRFeHRlbnNpb247XHJcbiAgICAgIGhpZ2hsaWdodE5vZGUueTIgPSB0aWNrWSArIG9wdGlvbnMuaGlnaGxpZ2h0RXh0ZW5zaW9uO1xyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuY2hpbGRyZW4gPSBbXHJcbiAgICAgIGhpZ2hsaWdodE5vZGUsXHJcbiAgICAgIGF4aXNOb2RlLFxyXG4gICAgICBtaW5vclRpY2tzTm9kZSxcclxuICAgICAgbXVsdGlwbGllZFRpY2tzTm9kZSxcclxuICAgICAgLi4ubWFqb3JUaWNrTm9kZXMsXHJcbiAgICAgIG1hcmtlck5vZGUsXHJcbiAgICAgIGhpdFRhcmdldE5vZGVcclxuICAgIF07XHJcblxyXG4gICAgLy8gQHB1YmxpYyB7VmVjdG9yMn0gLSBUaGUgbG9jYWwtYm91bmRzIHBvc2l0aW9uIG9mIHRoZSB0cnVlIFwibGVmdFwiIGZvciBsYXlvdXQgcHVycG9zZXMgKHNvIHdlIGNhbiBpZ25vcmUgdGhlXHJcbiAgICAvLyBhcnJvdyB3aGVuIGFsaWduaW5nKVxyXG4gICAgdGhpcy5sb2NhbExheW91dFBvaW50ID0gbWFqb3JUaWNrTm9kZXNbIDAgXS5sZWZ0VG9wO1xyXG5cclxuICAgIGlmICggb3B0aW9ucy5vcmllbnRhdGlvbiA9PT0gTnVtYmVyTGluZU9yaWVudGF0aW9uLlZFUlRJQ0FMICkge1xyXG4gICAgICB0aGlzLnJvdGF0aW9uID0gLU1hdGguUEkgLyAyO1xyXG4gICAgICB0aGlzLnkgPSBjb250YWluZXJDb3VudFByb3BlcnR5LnJhbmdlLm1heCAqIG9wdGlvbnMudW5pdFNpemUgLyAyO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRoaXMueCA9IC1jb250YWluZXJDb3VudFByb3BlcnR5LnJhbmdlLm1heCAqIG9wdGlvbnMudW5pdFNpemUgLyAyO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMubXV0YXRlKCBvcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWxlYXNlcyByZWZlcmVuY2VzLlxyXG4gICAqIEBwdWJsaWNcclxuICAgKiBAb3ZlcnJpZGVcclxuICAgKi9cclxuICBkaXNwb3NlKCkge1xyXG4gICAgdGhpcy5jb250YWluZXJDb3VudFByb3BlcnR5LnVubGluayggdGhpcy5jb250YWluZXJDb3VudExpc3RlbmVyICk7XHJcbiAgICB0aGlzLm1pbm9yVGlja011bHRpbGluay5kaXNwb3NlKCk7XHJcbiAgICB0aGlzLm11bHRpcGxpZWRUaWNrTXVsdGlsaW5rLmRpc3Bvc2UoKTtcclxuICAgIHRoaXMubWFya2VyTXVsdGlsaW5rLmRpc3Bvc2UoKTtcclxuICAgIHRoaXMuZHJhZ0xpc3RlbmVyICYmIHRoaXMuZHJhZ0xpc3RlbmVyLmRpc3Bvc2UoKTtcclxuXHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5mcmFjdGlvbnNDb21tb24ucmVnaXN0ZXIoICdOdW1iZXJMaW5lTm9kZScsIE51bWJlckxpbmVOb2RlICk7XHJcbmV4cG9ydCBkZWZhdWx0IE51bWJlckxpbmVOb2RlO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsU0FBUyxNQUFNLHFDQUFxQztBQUMzRCxPQUFPQyxjQUFjLE1BQU0sMENBQTBDO0FBQ3JFLE9BQU9DLE9BQU8sTUFBTSxrQ0FBa0M7QUFDdEQsT0FBT0MsS0FBSyxNQUFNLGdDQUFnQztBQUNsRCxTQUFTQyxLQUFLLFFBQVEsbUNBQW1DO0FBQ3pELE9BQU9DLEtBQUssTUFBTSxzQ0FBc0M7QUFD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