// Copyright 2018-2020, University of Colorado Boulder

/**
 * View for a ShapeStack.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Property from '../../../../axon/js/Property.js';
import arrayRemove from '../../../../phet-core/js/arrayRemove.js';
import merge from '../../../../phet-core/js/merge.js';
import FractionsCommonConstants from '../../common/FractionsCommonConstants.js';
import fractionsCommon from '../../fractionsCommon.js';
import ShapePiece from '../model/ShapePiece.js';
import ShapeStack from '../model/ShapeStack.js';
import ShapeLayerNode from './ShapeLayerNode.js';
import ShapePieceNode from './ShapePieceNode.js';
import StackNode from './StackNode.js';
class ShapeStackNode extends StackNode {
  /**
   * @param {ShapeStack} shapeStack
   * @param {Object} [options]
   */
  constructor(shapeStack, options) {
    assert && assert(shapeStack instanceof ShapeStack);
    options = merge({
      // {number} - Stacks should be a bit smaller than in-play objects in general
      scale: FractionsCommonConstants.SHAPE_BUILD_SCALE
    }, options);
    super(shapeStack);

    // @public {ShapeStack}
    this.shapeStack = shapeStack;

    // @private {Array.<ShapePieceNode>}
    this.shapePieceNodes = [];

    // @private {Node}
    this.shapeLayerNode = new ShapeLayerNode(shapeStack.representation, new Property(shapeStack.fraction.denominator));
    this.addChild(this.shapeLayerNode);

    // @private {function}
    this.shapePieceAddedListener = this.addShapePiece.bind(this);
    this.shapePieceRemovedListener = this.removeShapePiece.bind(this);
    this.stack.shapePieces.addItemAddedListener(this.shapePieceAddedListener);
    this.stack.shapePieces.addItemRemovedListener(this.shapePieceRemovedListener);
    this.stack.shapePieces.forEach(this.shapePieceAddedListener);

    // Inform about our available layout bounds
    const bounds = this.localBounds.copy();
    const shapePiece = new ShapePiece(this.shapeStack.fraction, this.shapeStack.representation, this.shapeStack.color);
    const shapePieceNode = new ShapePieceNode(shapePiece);
    for (let i = 0; i < this.shapeStack.layoutQuantity; i++) {
      shapePieceNode.matrix = ShapeStack.getShapeMatrix(shapePiece.fraction, shapePiece.representation, i);
      bounds.includeBounds(shapePieceNode.bounds);
    }
    shapePieceNode.dispose();
    this.layoutBounds = bounds;
    this.mutate(options);
  }

  /**
   * Adds a ShapePiece's view
   * @private
   *
   * @param {ShapePiece} shapePiece
   */
  addShapePiece(shapePiece) {
    assert && assert(shapePiece.fraction.equals(this.shapeStack.fraction));
    assert && assert(shapePiece.representation === this.shapeStack.representation);
    const shapePieceNode = new ShapePieceNode(shapePiece, {
      matrix: ShapeStack.getShapeMatrix(shapePiece.fraction, shapePiece.representation, this.shapePieceNodes.length)
    });
    this.shapePieceNodes.push(shapePieceNode);
    this.addChild(shapePieceNode);
  }

  /**
   * Removes a ShapePiece's view
   * @private
   *
   * @param {ShapePiece} shapePiece
   */
  removeShapePiece(shapePiece) {
    const shapePieceNode = _.find(this.shapePieceNodes, shapePieceNode => {
      return shapePieceNode.shapePiece === shapePiece;
    });
    assert && assert(shapePieceNode);
    arrayRemove(this.shapePieceNodes, shapePieceNode);
    this.removeChild(shapePieceNode);
    shapePieceNode.dispose();
  }

  /**
   * Releases references.
   * @public
   * @override
   */
  dispose() {
    this.shapePieceNodes.forEach(shapePieceNode => shapePieceNode.dispose());
    this.stack.shapePieces.removeItemAddedListener(this.shapePieceAddedListener);
    this.stack.shapePieces.removeItemRemovedListener(this.shapePieceRemovedListener);
    this.shapeLayerNode.dispose();
    super.dispose();
  }
}
fractionsCommon.register('ShapeStackNode', ShapeStackNode);
export default ShapeStackNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsImFycmF5UmVtb3ZlIiwibWVyZ2UiLCJGcmFjdGlvbnNDb21tb25Db25zdGFudHMiLCJmcmFjdGlvbnNDb21tb24iLCJTaGFwZVBpZWNlIiwiU2hhcGVTdGFjayIsIlNoYXBlTGF5ZXJOb2RlIiwiU2hhcGVQaWVjZU5vZGUiLCJTdGFja05vZGUiLCJTaGFwZVN0YWNrTm9kZSIsImNvbnN0cnVjdG9yIiwic2hhcGVTdGFjayIsIm9wdGlvbnMiLCJhc3NlcnQiLCJzY2FsZSIsIlNIQVBFX0JVSUxEX1NDQUxFIiwic2hhcGVQaWVjZU5vZGVzIiwic2hhcGVMYXllck5vZGUiLCJyZXByZXNlbnRhdGlvbiIsImZyYWN0aW9uIiwiZGVub21pbmF0b3IiLCJhZGRDaGlsZCIsInNoYXBlUGllY2VBZGRlZExpc3RlbmVyIiwiYWRkU2hhcGVQaWVjZSIsImJpbmQiLCJzaGFwZVBpZWNlUmVtb3ZlZExpc3RlbmVyIiwicmVtb3ZlU2hhcGVQaWVjZSIsInN0YWNrIiwic2hhcGVQaWVjZXMiLCJhZGRJdGVtQWRkZWRMaXN0ZW5lciIsImFkZEl0ZW1SZW1vdmVkTGlzdGVuZXIiLCJmb3JFYWNoIiwiYm91bmRzIiwibG9jYWxCb3VuZHMiLCJjb3B5Iiwic2hhcGVQaWVjZSIsImNvbG9yIiwic2hhcGVQaWVjZU5vZGUiLCJpIiwibGF5b3V0UXVhbnRpdHkiLCJtYXRyaXgiLCJnZXRTaGFwZU1hdHJpeCIsImluY2x1ZGVCb3VuZHMiLCJkaXNwb3NlIiwibGF5b3V0Qm91bmRzIiwibXV0YXRlIiwiZXF1YWxzIiwibGVuZ3RoIiwicHVzaCIsIl8iLCJmaW5kIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmVJdGVtQWRkZWRMaXN0ZW5lciIsInJlbW92ZUl0ZW1SZW1vdmVkTGlzdGVuZXIiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlNoYXBlU3RhY2tOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjAsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFZpZXcgZm9yIGEgU2hhcGVTdGFjay5cclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IGFycmF5UmVtb3ZlIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9hcnJheVJlbW92ZS5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgRnJhY3Rpb25zQ29tbW9uQ29uc3RhbnRzIGZyb20gJy4uLy4uL2NvbW1vbi9GcmFjdGlvbnNDb21tb25Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgZnJhY3Rpb25zQ29tbW9uIGZyb20gJy4uLy4uL2ZyYWN0aW9uc0NvbW1vbi5qcyc7XHJcbmltcG9ydCBTaGFwZVBpZWNlIGZyb20gJy4uL21vZGVsL1NoYXBlUGllY2UuanMnO1xyXG5pbXBvcnQgU2hhcGVTdGFjayBmcm9tICcuLi9tb2RlbC9TaGFwZVN0YWNrLmpzJztcclxuaW1wb3J0IFNoYXBlTGF5ZXJOb2RlIGZyb20gJy4vU2hhcGVMYXllck5vZGUuanMnO1xyXG5pbXBvcnQgU2hhcGVQaWVjZU5vZGUgZnJvbSAnLi9TaGFwZVBpZWNlTm9kZS5qcyc7XHJcbmltcG9ydCBTdGFja05vZGUgZnJvbSAnLi9TdGFja05vZGUuanMnO1xyXG5cclxuY2xhc3MgU2hhcGVTdGFja05vZGUgZXh0ZW5kcyBTdGFja05vZGUge1xyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7U2hhcGVTdGFja30gc2hhcGVTdGFja1xyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvciggc2hhcGVTdGFjaywgb3B0aW9ucyApIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHNoYXBlU3RhY2sgaW5zdGFuY2VvZiBTaGFwZVN0YWNrICk7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcbiAgICAgIC8vIHtudW1iZXJ9IC0gU3RhY2tzIHNob3VsZCBiZSBhIGJpdCBzbWFsbGVyIHRoYW4gaW4tcGxheSBvYmplY3RzIGluIGdlbmVyYWxcclxuICAgICAgc2NhbGU6IEZyYWN0aW9uc0NvbW1vbkNvbnN0YW50cy5TSEFQRV9CVUlMRF9TQ0FMRVxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBzaGFwZVN0YWNrICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyB7U2hhcGVTdGFja31cclxuICAgIHRoaXMuc2hhcGVTdGFjayA9IHNoYXBlU3RhY2s7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge0FycmF5LjxTaGFwZVBpZWNlTm9kZT59XHJcbiAgICB0aGlzLnNoYXBlUGllY2VOb2RlcyA9IFtdO1xyXG5cclxuICAgIC8vIEBwcml2YXRlIHtOb2RlfVxyXG4gICAgdGhpcy5zaGFwZUxheWVyTm9kZSA9IG5ldyBTaGFwZUxheWVyTm9kZSggc2hhcGVTdGFjay5yZXByZXNlbnRhdGlvbiwgbmV3IFByb3BlcnR5KCBzaGFwZVN0YWNrLmZyYWN0aW9uLmRlbm9taW5hdG9yICkgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMuc2hhcGVMYXllck5vZGUgKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSB7ZnVuY3Rpb259XHJcbiAgICB0aGlzLnNoYXBlUGllY2VBZGRlZExpc3RlbmVyID0gdGhpcy5hZGRTaGFwZVBpZWNlLmJpbmQoIHRoaXMgKTtcclxuICAgIHRoaXMuc2hhcGVQaWVjZVJlbW92ZWRMaXN0ZW5lciA9IHRoaXMucmVtb3ZlU2hhcGVQaWVjZS5iaW5kKCB0aGlzICk7XHJcblxyXG4gICAgdGhpcy5zdGFjay5zaGFwZVBpZWNlcy5hZGRJdGVtQWRkZWRMaXN0ZW5lciggdGhpcy5zaGFwZVBpZWNlQWRkZWRMaXN0ZW5lciApO1xyXG4gICAgdGhpcy5zdGFjay5zaGFwZVBpZWNlcy5hZGRJdGVtUmVtb3ZlZExpc3RlbmVyKCB0aGlzLnNoYXBlUGllY2VSZW1vdmVkTGlzdGVuZXIgKTtcclxuICAgIHRoaXMuc3RhY2suc2hhcGVQaWVjZXMuZm9yRWFjaCggdGhpcy5zaGFwZVBpZWNlQWRkZWRMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIEluZm9ybSBhYm91dCBvdXIgYXZhaWxhYmxlIGxheW91dCBib3VuZHNcclxuICAgIGNvbnN0IGJvdW5kcyA9IHRoaXMubG9jYWxCb3VuZHMuY29weSgpO1xyXG4gICAgY29uc3Qgc2hhcGVQaWVjZSA9IG5ldyBTaGFwZVBpZWNlKCB0aGlzLnNoYXBlU3RhY2suZnJhY3Rpb24sIHRoaXMuc2hhcGVTdGFjay5yZXByZXNlbnRhdGlvbiwgdGhpcy5zaGFwZVN0YWNrLmNvbG9yICk7XHJcbiAgICBjb25zdCBzaGFwZVBpZWNlTm9kZSA9IG5ldyBTaGFwZVBpZWNlTm9kZSggc2hhcGVQaWVjZSApO1xyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgdGhpcy5zaGFwZVN0YWNrLmxheW91dFF1YW50aXR5OyBpKysgKSB7XHJcbiAgICAgIHNoYXBlUGllY2VOb2RlLm1hdHJpeCA9IFNoYXBlU3RhY2suZ2V0U2hhcGVNYXRyaXgoIHNoYXBlUGllY2UuZnJhY3Rpb24sIHNoYXBlUGllY2UucmVwcmVzZW50YXRpb24sIGkgKTtcclxuICAgICAgYm91bmRzLmluY2x1ZGVCb3VuZHMoIHNoYXBlUGllY2VOb2RlLmJvdW5kcyApO1xyXG4gICAgfVxyXG4gICAgc2hhcGVQaWVjZU5vZGUuZGlzcG9zZSgpO1xyXG4gICAgdGhpcy5sYXlvdXRCb3VuZHMgPSBib3VuZHM7XHJcblxyXG4gICAgdGhpcy5tdXRhdGUoIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgYSBTaGFwZVBpZWNlJ3Mgdmlld1xyXG4gICAqIEBwcml2YXRlXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge1NoYXBlUGllY2V9IHNoYXBlUGllY2VcclxuICAgKi9cclxuICBhZGRTaGFwZVBpZWNlKCBzaGFwZVBpZWNlICkge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggc2hhcGVQaWVjZS5mcmFjdGlvbi5lcXVhbHMoIHRoaXMuc2hhcGVTdGFjay5mcmFjdGlvbiApICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBzaGFwZVBpZWNlLnJlcHJlc2VudGF0aW9uID09PSB0aGlzLnNoYXBlU3RhY2sucmVwcmVzZW50YXRpb24gKTtcclxuXHJcbiAgICBjb25zdCBzaGFwZVBpZWNlTm9kZSA9IG5ldyBTaGFwZVBpZWNlTm9kZSggc2hhcGVQaWVjZSwge1xyXG4gICAgICBtYXRyaXg6IFNoYXBlU3RhY2suZ2V0U2hhcGVNYXRyaXgoIHNoYXBlUGllY2UuZnJhY3Rpb24sIHNoYXBlUGllY2UucmVwcmVzZW50YXRpb24sIHRoaXMuc2hhcGVQaWVjZU5vZGVzLmxlbmd0aCApXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLnNoYXBlUGllY2VOb2Rlcy5wdXNoKCBzaGFwZVBpZWNlTm9kZSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggc2hhcGVQaWVjZU5vZGUgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbW92ZXMgYSBTaGFwZVBpZWNlJ3Mgdmlld1xyXG4gICAqIEBwcml2YXRlXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge1NoYXBlUGllY2V9IHNoYXBlUGllY2VcclxuICAgKi9cclxuICByZW1vdmVTaGFwZVBpZWNlKCBzaGFwZVBpZWNlICkge1xyXG4gICAgY29uc3Qgc2hhcGVQaWVjZU5vZGUgPSBfLmZpbmQoIHRoaXMuc2hhcGVQaWVjZU5vZGVzLCBzaGFwZVBpZWNlTm9kZSA9PiB7XHJcbiAgICAgIHJldHVybiBzaGFwZVBpZWNlTm9kZS5zaGFwZVBpZWNlID09PSBzaGFwZVBpZWNlO1xyXG4gICAgfSApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggc2hhcGVQaWVjZU5vZGUgKTtcclxuXHJcbiAgICBhcnJheVJlbW92ZSggdGhpcy5zaGFwZVBpZWNlTm9kZXMsIHNoYXBlUGllY2VOb2RlICk7XHJcbiAgICB0aGlzLnJlbW92ZUNoaWxkKCBzaGFwZVBpZWNlTm9kZSApO1xyXG4gICAgc2hhcGVQaWVjZU5vZGUuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVsZWFzZXMgcmVmZXJlbmNlcy5cclxuICAgKiBAcHVibGljXHJcbiAgICogQG92ZXJyaWRlXHJcbiAgICovXHJcbiAgZGlzcG9zZSgpIHtcclxuICAgIHRoaXMuc2hhcGVQaWVjZU5vZGVzLmZvckVhY2goIHNoYXBlUGllY2VOb2RlID0+IHNoYXBlUGllY2VOb2RlLmRpc3Bvc2UoKSApO1xyXG4gICAgdGhpcy5zdGFjay5zaGFwZVBpZWNlcy5yZW1vdmVJdGVtQWRkZWRMaXN0ZW5lciggdGhpcy5zaGFwZVBpZWNlQWRkZWRMaXN0ZW5lciApO1xyXG4gICAgdGhpcy5zdGFjay5zaGFwZVBpZWNlcy5yZW1vdmVJdGVtUmVtb3ZlZExpc3RlbmVyKCB0aGlzLnNoYXBlUGllY2VSZW1vdmVkTGlzdGVuZXIgKTtcclxuICAgIHRoaXMuc2hhcGVMYXllck5vZGUuZGlzcG9zZSgpO1xyXG5cclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbmZyYWN0aW9uc0NvbW1vbi5yZWdpc3RlciggJ1NoYXBlU3RhY2tOb2RlJywgU2hhcGVTdGFja05vZGUgKTtcclxuZXhwb3J0IGRlZmF1bHQgU2hhcGVTdGFja05vZGU7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFFBQVEsTUFBTSxpQ0FBaUM7QUFDdEQsT0FBT0MsV0FBVyxNQUFNLHlDQUF5QztBQUNqRSxPQUFPQyxLQUFLLE1BQU0sbUNBQW1DO0FBQ3JELE9BQU9DLHdCQUF3QixNQUFNLDBDQUEwQztBQUMvRSxPQUFPQyxlQUFlLE1BQU0sMEJBQTBCO0FBQ3RELE9BQU9DLFVBQVUsTUFBTSx3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