// Copyright 2018-2022, University of Colorado Boulder

/**
 * Displays a background and foreground strokes for a given representation and denominator, and provides a layer
 * in-between where shapes can be placed.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Utils from '../../../../dot/js/Utils.js';
import { Shape } from '../../../../kite/js/imports.js';
import { Circle, Node, Path, Rectangle } from '../../../../scenery/js/imports.js';
import FractionsCommonConstants from '../../common/FractionsCommonConstants.js';
import FractionsCommonColors from '../../common/view/FractionsCommonColors.js';
import fractionsCommon from '../../fractionsCommon.js';
import BuildingRepresentation from '../model/BuildingRepresentation.js';
import ShapePiece from '../model/ShapePiece.js';

// constants
const CIRCLE_RADIUS = FractionsCommonConstants.SHAPE_SIZE / 2;
class ShapeLayerNode extends Node {
  /**
   * @param {BuildingRepresentation} representation
   * @param {Property.<number>} denominatorProperty
   */
  constructor(representation, denominatorProperty) {
    super();

    // @private {BuildingRepresentation}
    this.representation = representation;

    // @private {Property.<number>}
    this.denominatorProperty = denominatorProperty;

    // @private {Node}
    this.shapePieceLayer = new Node({
      pickable: false
    });

    // @private {Path}
    this.separatorPath = new Path(null, {
      stroke: FractionsCommonColors.shapeContainerPartitionProperty,
      lineDash: [5, 5],
      pickable: false
    });
    this.separatorOffsetPath = new Path(null, {
      stroke: FractionsCommonColors.shapeContainerPartitionOffsetProperty,
      lineDash: [5, 5],
      lineDashOffset: 5,
      pickable: false
    });

    // @private {function}
    this.separatorListener = this.updateSeparator.bind(this);
    this.denominatorProperty.link(this.separatorListener);

    // Background
    if (representation === BuildingRepresentation.PIE) {
      this.addChild(new Circle(CIRCLE_RADIUS, {
        fill: FractionsCommonColors.shapeContainerFillProperty
      }));
      this.addChild(this.shapePieceLayer);
      this.addChild(this.separatorPath);
      this.addChild(this.separatorOffsetPath);
      this.addChild(new Circle(CIRCLE_RADIUS, {
        stroke: FractionsCommonColors.shapeContainerStrokeProperty,
        pickable: false
      }));
    } else if (representation === BuildingRepresentation.BAR) {
      this.addChild(Rectangle.bounds(ShapePiece.VERTICAL_BAR_BOUNDS, {
        fill: FractionsCommonColors.shapeContainerFillProperty
      }));
      this.addChild(this.shapePieceLayer);
      this.addChild(this.separatorPath);
      this.addChild(this.separatorOffsetPath);
      this.addChild(Rectangle.bounds(ShapePiece.VERTICAL_BAR_BOUNDS, {
        stroke: FractionsCommonColors.shapeContainerStrokeProperty,
        pickable: false
      }));
    } else {
      throw new Error(`Unsupported representation for ShapeLayerNode: ${representation}`);
    }

    // Use our current bounds as our permanent bounds (for layout), since no content should be able to be outside this
    // (any pieces will be inside the container).
    this.localBounds = this.localBounds; // eslint-disable-line no-self-assign
  }

  /**
   * Updates the shape of the separators above the shape piece layer.
   * @private
   *
   * @param {number} denominator
   */
  updateSeparator(denominator) {
    if (this.representation === BuildingRepresentation.PIE) {
      if (denominator > 1) {
        const separatorShape = new Shape();
        for (let i = 0; i < denominator; i++) {
          const angle = -i * 2 * Math.PI / denominator;
          // Offset for crashes, see https://github.com/phetsims/fractions-common/issues/2 and
          // https://github.com/phetsims/scenery/issues/750
          separatorShape.moveTo(1e-5 * Math.cos(angle), 1e-5 * Math.sin(angle)).lineTo(CIRCLE_RADIUS * Math.cos(angle), CIRCLE_RADIUS * Math.sin(angle));
        }
        this.separatorPath.shape = separatorShape;
        this.separatorOffsetPath.shape = separatorShape;
      } else {
        this.separatorPath.shape = null;
        this.separatorOffsetPath.shape = null;
      }
    } else {
      const separatorShape = new Shape();
      for (let i = 1; i < denominator; i++) {
        const x = Utils.linear(0, 1, ShapePiece.VERTICAL_BAR_BOUNDS.minX, ShapePiece.VERTICAL_BAR_BOUNDS.maxX, i / denominator);
        separatorShape.moveTo(x, ShapePiece.VERTICAL_BAR_BOUNDS.minY).lineTo(x, ShapePiece.VERTICAL_BAR_BOUNDS.maxY);
      }
      this.separatorPath.shape = separatorShape;
      this.separatorOffsetPath.shape = separatorShape;
    }
  }

  /**
   * Releases references.
   * @public
   * @override
   */
  dispose() {
    this.denominatorProperty.unlink(this.separatorListener);
    super.dispose();
  }
}
fractionsCommon.register('ShapeLayerNode', ShapeLayerNode);
export default ShapeLayerNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIlNoYXBlIiwiQ2lyY2xlIiwiTm9kZSIsIlBhdGgiLCJSZWN0YW5nbGUiLCJGcmFjdGlvbnNDb21tb25Db25zdGFudHMiLCJGcmFjdGlvbnNDb21tb25Db2xvcnMiLCJmcmFjdGlvbnNDb21tb24iLCJCdWlsZGluZ1JlcHJlc2VudGF0aW9uIiwiU2hhcGVQaWVjZSIsIkNJUkNMRV9SQURJVVMiLCJTSEFQRV9TSVpFIiwiU2hhcGVMYXllck5vZGUiLCJjb25zdHJ1Y3RvciIsInJlcHJlc2VudGF0aW9uIiwiZGVub21pbmF0b3JQcm9wZXJ0eSIsInNoYXBlUGllY2VMYXllciIsInBpY2thYmxlIiwic2VwYXJhdG9yUGF0aCIsInN0cm9rZSIsInNoYXBlQ29udGFpbmVyUGFydGl0aW9uUHJvcGVydHkiLCJsaW5lRGFzaCIsInNlcGFyYXRvck9mZnNldFBhdGgiLCJzaGFwZUNvbnRhaW5lclBhcnRpdGlvbk9mZnNldFByb3BlcnR5IiwibGluZURhc2hPZmZzZXQiLCJzZXBhcmF0b3JMaXN0ZW5lciIsInVwZGF0ZVNlcGFyYXRvciIsImJpbmQiLCJsaW5rIiwiUElFIiwiYWRkQ2hpbGQiLCJmaWxsIiwic2hhcGVDb250YWluZXJGaWxsUHJvcGVydHkiLCJzaGFwZUNvbnRhaW5lclN0cm9rZVByb3BlcnR5IiwiQkFSIiwiYm91bmRzIiwiVkVSVElDQUxfQkFSX0JPVU5EUyIsIkVycm9yIiwibG9jYWxCb3VuZHMiLCJkZW5vbWluYXRvciIsInNlcGFyYXRvclNoYXBlIiwiaSIsImFuZ2xlIiwiTWF0aCIsIlBJIiwibW92ZVRvIiwiY29zIiwic2luIiwibGluZVRvIiwic2hhcGUiLCJ4IiwibGluZWFyIiwibWluWCIsIm1heFgiLCJtaW5ZIiwibWF4WSIsImRpc3Bvc2UiLCJ1bmxpbmsiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlNoYXBlTGF5ZXJOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIERpc3BsYXlzIGEgYmFja2dyb3VuZCBhbmQgZm9yZWdyb3VuZCBzdHJva2VzIGZvciBhIGdpdmVuIHJlcHJlc2VudGF0aW9uIGFuZCBkZW5vbWluYXRvciwgYW5kIHByb3ZpZGVzIGEgbGF5ZXJcclxuICogaW4tYmV0d2VlbiB3aGVyZSBzaGFwZXMgY2FuIGJlIHBsYWNlZC5cclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCB7IENpcmNsZSwgTm9kZSwgUGF0aCwgUmVjdGFuZ2xlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEZyYWN0aW9uc0NvbW1vbkNvbnN0YW50cyBmcm9tICcuLi8uLi9jb21tb24vRnJhY3Rpb25zQ29tbW9uQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IEZyYWN0aW9uc0NvbW1vbkNvbG9ycyBmcm9tICcuLi8uLi9jb21tb24vdmlldy9GcmFjdGlvbnNDb21tb25Db2xvcnMuanMnO1xyXG5pbXBvcnQgZnJhY3Rpb25zQ29tbW9uIGZyb20gJy4uLy4uL2ZyYWN0aW9uc0NvbW1vbi5qcyc7XHJcbmltcG9ydCBCdWlsZGluZ1JlcHJlc2VudGF0aW9uIGZyb20gJy4uL21vZGVsL0J1aWxkaW5nUmVwcmVzZW50YXRpb24uanMnO1xyXG5pbXBvcnQgU2hhcGVQaWVjZSBmcm9tICcuLi9tb2RlbC9TaGFwZVBpZWNlLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBDSVJDTEVfUkFESVVTID0gRnJhY3Rpb25zQ29tbW9uQ29uc3RhbnRzLlNIQVBFX1NJWkUgLyAyO1xyXG5cclxuY2xhc3MgU2hhcGVMYXllck5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuICAvKipcclxuICAgKiBAcGFyYW0ge0J1aWxkaW5nUmVwcmVzZW50YXRpb259IHJlcHJlc2VudGF0aW9uXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48bnVtYmVyPn0gZGVub21pbmF0b3JQcm9wZXJ0eVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCByZXByZXNlbnRhdGlvbiwgZGVub21pbmF0b3JQcm9wZXJ0eSApIHtcclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge0J1aWxkaW5nUmVwcmVzZW50YXRpb259XHJcbiAgICB0aGlzLnJlcHJlc2VudGF0aW9uID0gcmVwcmVzZW50YXRpb247XHJcblxyXG4gICAgLy8gQHByaXZhdGUge1Byb3BlcnR5LjxudW1iZXI+fVxyXG4gICAgdGhpcy5kZW5vbWluYXRvclByb3BlcnR5ID0gZGVub21pbmF0b3JQcm9wZXJ0eTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSB7Tm9kZX1cclxuICAgIHRoaXMuc2hhcGVQaWVjZUxheWVyID0gbmV3IE5vZGUoIHtcclxuICAgICAgcGlja2FibGU6IGZhbHNlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge1BhdGh9XHJcbiAgICB0aGlzLnNlcGFyYXRvclBhdGggPSBuZXcgUGF0aCggbnVsbCwge1xyXG4gICAgICBzdHJva2U6IEZyYWN0aW9uc0NvbW1vbkNvbG9ycy5zaGFwZUNvbnRhaW5lclBhcnRpdGlvblByb3BlcnR5LFxyXG4gICAgICBsaW5lRGFzaDogWyA1LCA1IF0sXHJcbiAgICAgIHBpY2thYmxlOiBmYWxzZVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5zZXBhcmF0b3JPZmZzZXRQYXRoID0gbmV3IFBhdGgoIG51bGwsIHtcclxuICAgICAgc3Ryb2tlOiBGcmFjdGlvbnNDb21tb25Db2xvcnMuc2hhcGVDb250YWluZXJQYXJ0aXRpb25PZmZzZXRQcm9wZXJ0eSxcclxuICAgICAgbGluZURhc2g6IFsgNSwgNSBdLFxyXG4gICAgICBsaW5lRGFzaE9mZnNldDogNSxcclxuICAgICAgcGlja2FibGU6IGZhbHNlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge2Z1bmN0aW9ufVxyXG4gICAgdGhpcy5zZXBhcmF0b3JMaXN0ZW5lciA9IHRoaXMudXBkYXRlU2VwYXJhdG9yLmJpbmQoIHRoaXMgKTtcclxuXHJcbiAgICB0aGlzLmRlbm9taW5hdG9yUHJvcGVydHkubGluayggdGhpcy5zZXBhcmF0b3JMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIEJhY2tncm91bmRcclxuICAgIGlmICggcmVwcmVzZW50YXRpb24gPT09IEJ1aWxkaW5nUmVwcmVzZW50YXRpb24uUElFICkge1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCBuZXcgQ2lyY2xlKCBDSVJDTEVfUkFESVVTLCB7XHJcbiAgICAgICAgZmlsbDogRnJhY3Rpb25zQ29tbW9uQ29sb3JzLnNoYXBlQ29udGFpbmVyRmlsbFByb3BlcnR5XHJcbiAgICAgIH0gKSApO1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCB0aGlzLnNoYXBlUGllY2VMYXllciApO1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCB0aGlzLnNlcGFyYXRvclBhdGggKTtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggdGhpcy5zZXBhcmF0b3JPZmZzZXRQYXRoICk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBDaXJjbGUoIENJUkNMRV9SQURJVVMsIHtcclxuICAgICAgICBzdHJva2U6IEZyYWN0aW9uc0NvbW1vbkNvbG9ycy5zaGFwZUNvbnRhaW5lclN0cm9rZVByb3BlcnR5LFxyXG4gICAgICAgIHBpY2thYmxlOiBmYWxzZVxyXG4gICAgICB9ICkgKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCByZXByZXNlbnRhdGlvbiA9PT0gQnVpbGRpbmdSZXByZXNlbnRhdGlvbi5CQVIgKSB7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIFJlY3RhbmdsZS5ib3VuZHMoIFNoYXBlUGllY2UuVkVSVElDQUxfQkFSX0JPVU5EUywge1xyXG4gICAgICAgIGZpbGw6IEZyYWN0aW9uc0NvbW1vbkNvbG9ycy5zaGFwZUNvbnRhaW5lckZpbGxQcm9wZXJ0eVxyXG4gICAgICB9ICkgKTtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggdGhpcy5zaGFwZVBpZWNlTGF5ZXIgKTtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggdGhpcy5zZXBhcmF0b3JQYXRoICk7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMuc2VwYXJhdG9yT2Zmc2V0UGF0aCApO1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCBSZWN0YW5nbGUuYm91bmRzKCBTaGFwZVBpZWNlLlZFUlRJQ0FMX0JBUl9CT1VORFMsIHtcclxuICAgICAgICBzdHJva2U6IEZyYWN0aW9uc0NvbW1vbkNvbG9ycy5zaGFwZUNvbnRhaW5lclN0cm9rZVByb3BlcnR5LFxyXG4gICAgICAgIHBpY2thYmxlOiBmYWxzZVxyXG4gICAgICB9ICkgKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoIGBVbnN1cHBvcnRlZCByZXByZXNlbnRhdGlvbiBmb3IgU2hhcGVMYXllck5vZGU6ICR7cmVwcmVzZW50YXRpb259YCApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVzZSBvdXIgY3VycmVudCBib3VuZHMgYXMgb3VyIHBlcm1hbmVudCBib3VuZHMgKGZvciBsYXlvdXQpLCBzaW5jZSBubyBjb250ZW50IHNob3VsZCBiZSBhYmxlIHRvIGJlIG91dHNpZGUgdGhpc1xyXG4gICAgLy8gKGFueSBwaWVjZXMgd2lsbCBiZSBpbnNpZGUgdGhlIGNvbnRhaW5lcikuXHJcbiAgICB0aGlzLmxvY2FsQm91bmRzID0gdGhpcy5sb2NhbEJvdW5kczsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zZWxmLWFzc2lnblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlcyB0aGUgc2hhcGUgb2YgdGhlIHNlcGFyYXRvcnMgYWJvdmUgdGhlIHNoYXBlIHBpZWNlIGxheWVyLlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge251bWJlcn0gZGVub21pbmF0b3JcclxuICAgKi9cclxuICB1cGRhdGVTZXBhcmF0b3IoIGRlbm9taW5hdG9yICkge1xyXG4gICAgaWYgKCB0aGlzLnJlcHJlc2VudGF0aW9uID09PSBCdWlsZGluZ1JlcHJlc2VudGF0aW9uLlBJRSApIHtcclxuICAgICAgaWYgKCBkZW5vbWluYXRvciA+IDEgKSB7XHJcbiAgICAgICAgY29uc3Qgc2VwYXJhdG9yU2hhcGUgPSBuZXcgU2hhcGUoKTtcclxuICAgICAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBkZW5vbWluYXRvcjsgaSsrICkge1xyXG4gICAgICAgICAgY29uc3QgYW5nbGUgPSAtaSAqIDIgKiBNYXRoLlBJIC8gZGVub21pbmF0b3I7XHJcbiAgICAgICAgICAvLyBPZmZzZXQgZm9yIGNyYXNoZXMsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvZnJhY3Rpb25zLWNvbW1vbi9pc3N1ZXMvMiBhbmRcclxuICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zY2VuZXJ5L2lzc3Vlcy83NTBcclxuICAgICAgICAgIHNlcGFyYXRvclNoYXBlLm1vdmVUbyhcclxuICAgICAgICAgICAgMWUtNSAqIE1hdGguY29zKCBhbmdsZSApLFxyXG4gICAgICAgICAgICAxZS01ICogTWF0aC5zaW4oIGFuZ2xlIClcclxuICAgICAgICAgICkubGluZVRvKFxyXG4gICAgICAgICAgICBDSVJDTEVfUkFESVVTICogTWF0aC5jb3MoIGFuZ2xlICksXHJcbiAgICAgICAgICAgIENJUkNMRV9SQURJVVMgKiBNYXRoLnNpbiggYW5nbGUgKVxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXBhcmF0b3JQYXRoLnNoYXBlID0gc2VwYXJhdG9yU2hhcGU7XHJcbiAgICAgICAgdGhpcy5zZXBhcmF0b3JPZmZzZXRQYXRoLnNoYXBlID0gc2VwYXJhdG9yU2hhcGU7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdGhpcy5zZXBhcmF0b3JQYXRoLnNoYXBlID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNlcGFyYXRvck9mZnNldFBhdGguc2hhcGUgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgY29uc3Qgc2VwYXJhdG9yU2hhcGUgPSBuZXcgU2hhcGUoKTtcclxuICAgICAgZm9yICggbGV0IGkgPSAxOyBpIDwgZGVub21pbmF0b3I7IGkrKyApIHtcclxuICAgICAgICBjb25zdCB4ID0gVXRpbHMubGluZWFyKCAwLCAxLCBTaGFwZVBpZWNlLlZFUlRJQ0FMX0JBUl9CT1VORFMubWluWCwgU2hhcGVQaWVjZS5WRVJUSUNBTF9CQVJfQk9VTkRTLm1heFgsIGkgLyBkZW5vbWluYXRvciApO1xyXG4gICAgICAgIHNlcGFyYXRvclNoYXBlLm1vdmVUbyggeCwgU2hhcGVQaWVjZS5WRVJUSUNBTF9CQVJfQk9VTkRTLm1pblkgKS5saW5lVG8oIHgsIFNoYXBlUGllY2UuVkVSVElDQUxfQkFSX0JPVU5EUy5tYXhZICk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5zZXBhcmF0b3JQYXRoLnNoYXBlID0gc2VwYXJhdG9yU2hhcGU7XHJcbiAgICAgIHRoaXMuc2VwYXJhdG9yT2Zmc2V0UGF0aC5zaGFwZSA9IHNlcGFyYXRvclNoYXBlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVsZWFzZXMgcmVmZXJlbmNlcy5cclxuICAgKiBAcHVibGljXHJcbiAgICogQG92ZXJyaWRlXHJcbiAgICovXHJcbiAgZGlzcG9zZSgpIHtcclxuICAgIHRoaXMuZGVub21pbmF0b3JQcm9wZXJ0eS51bmxpbmsoIHRoaXMuc2VwYXJhdG9yTGlzdGVuZXIgKTtcclxuXHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5mcmFjdGlvbnNDb21tb24ucmVnaXN0ZXIoICdTaGFwZUxheWVyTm9kZScsIFNoYXBlTGF5ZXJOb2RlICk7XHJcbmV4cG9ydCBkZWZhdWx0IFNoYXBlTGF5ZXJOb2RlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsU0FBU0MsS0FBSyxRQUFRLGdDQUFnQztBQUN0RCxTQUFTQyxNQUFNLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxTQUFTLFFBQVEsbUNBQW1DO0FBQ2pGLE9BQU9DLHdCQUF3QixNQUFNLDBDQUEwQztBQUMvRSxPQUFPQyxxQkFBcUIsTUFBTSw0Q0FBNEM7QUFDOUUsT0FBT0MsZUFBZSxNQUFNLDBCQUEwQjtBQUN0RCxPQUFPQyxzQkFBc0IsTUFBTSxvQ0FBb0M7QUFDdkUsT0FBT0MsVUFBVSxNQUFNLHdCQUF3Qjs7QUFFL0M7QUFDQSxNQUFNQyxhQUFhLEdBQUdMLHdCQUF3QixDQUFDTSxVQUFVLEdBQUcsQ0FBQztBQUU3RCxNQUFNQyxjQUFjLFNBQVNWLElBQUksQ0FBQztFQUNoQztBQUNGO0FBQ0E7QUFDQTtFQUNFVyxXQUFXQSxDQUFFQyxjQUFjLEVBQUVDLG1CQUFtQixFQUFHO0lBQ2pELEtBQUssQ0FBQyxDQUFDOztJQUVQO0lBQ0EsSUFBSSxDQUFDRCxjQUFjLEdBQUdBLGNBQWM7O0lBRXBDO0lBQ0EsSUFBSSxDQUFDQyxtQkFBbUIsR0FBR0EsbUJBQW1COztJQUU5QztJQUNBLElBQUksQ0FBQ0MsZUFBZSxHQUFHLElBQUlkLElBQUksQ0FBRTtNQUMvQmUsUUFBUSxFQUFFO0lBQ1osQ0FBRSxDQUFDOztJQUVIO0lBQ0EsSUFBSSxDQUFDQyxhQUFhLEdBQUcsSUFBSWYsSUFBSSxDQUFFLElBQUksRUFBRTtNQUNuQ2dCLE1BQU0sRUFBRWIscUJBQXFCLENBQUNjLCtCQUErQjtNQUM3REMsUUFBUSxFQUFFLENBQUUsQ0FBQyxFQUFF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