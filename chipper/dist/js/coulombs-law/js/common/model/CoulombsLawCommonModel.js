// Copyright 2017-2022, University of Colorado Boulder

/**
 * Base model for all Coulombs Law sim screens. Allows for distinct instantiation details for both atomic and macro scales.
 * Inherits from the base ISLCModel that is responsible for all force calculation between the model's charge objects.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 * @author Michael Barlow (PhET Interactive Simulations)
 */

import EnumerationDeprecatedProperty from '../../../../axon/js/EnumerationDeprecatedProperty.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import Vector2Property from '../../../../dot/js/Vector2Property.js';
import ISLCConstants from '../../../../inverse-square-law-common/js/ISLCConstants.js';
import ForceValuesDisplayEnum from '../../../../inverse-square-law-common/js/model/ForceValuesDisplayEnum.js';
import ISLCModel from '../../../../inverse-square-law-common/js/model/ISLCModel.js';
import merge from '../../../../phet-core/js/merge.js';
import coulombsLaw from '../../coulombsLaw.js';
class CoulombsLawCommonModel extends ISLCModel {
  /**
   * @param {Charge} charge1 - The left charge
   * @param {Charge} charge2 - The right charge
   * @param {Range} positionRange
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(charge1, charge2, positionRange, tandem, options) {
    options = merge({
      snapObjectsToNearest: 0.1,
      displayScientificNotation: true,
      initialRulerPosition: new Vector2(0, -1.1E-2)
    }, options);
    super(ISLCConstants.k, charge1, charge2, positionRange, tandem, options);

    // @public - the position of the ruler in the model
    this.rulerPositionProperty = new Vector2Property(options.initialRulerPosition, {
      tandem: tandem.createTandem('rulerPositionProperty')
    });

    // @public
    this.forceValuesDisplayProperty = new EnumerationDeprecatedProperty(ForceValuesDisplayEnum, ForceValuesDisplayEnum.DECIMAL, {
      tandem: tandem.createTandem('forceValuesDisplayProperty'),
      phetioDocumentation: 'This determines the display type for the force values: in decimal or scientific ' + 'notation, and also hidden.'
    });

    // ISLC code listens substantially to showForceValuesProperty, so keep that in sync as the display type changes.
    this.forceValuesDisplayProperty.lazyLink(newValue => {
      this.showForceValuesProperty.value = newValue === ForceValuesDisplayEnum.DECIMAL || newValue === ForceValuesDisplayEnum.SCIENTIFIC;
    });
  }

  /**
   * @protected
   * @override
   * @returns {number}
   */
  getMinForce() {
    return -this.getMaxForce();
  }

  /**
   * @public
   * @override
   * @returns {number}
   */
  getMaxForce() {
    // TODO: should this call snapToGrid?
    // inherited object node accepts the entire force range. (NOTE: necessary to calculate here as Coulomb's Law allows
    // negative forces while Gravity Force Lab does not.)
    return this.calculateForce(this.object1.valueRange.max, this.object1.valueRange.max, this.getMinDistance(this.object1.valueProperty.get())); // This assumes constant radius for Coulombs law
  }

  /**
   * Resets the model.
   * @public
   */
  reset() {
    // As of writing this, all (both) subtypes have a rulerPositionProperty, so it is easy enough to just reset this here.
    this.rulerPositionProperty.reset();
    this.forceValuesDisplayProperty.reset();
    super.reset();
  }
}
coulombsLaw.register('CoulombsLawCommonModel', CoulombsLawCommonModel);
export default CoulombsLawCommonModel;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFbnVtZXJhdGlvbkRlcHJlY2F0ZWRQcm9wZXJ0eSIsIlZlY3RvcjIiLCJWZWN0b3IyUHJvcGVydHkiLCJJU0xDQ29uc3RhbnRzIiwiRm9yY2VWYWx1ZXNEaXNwbGF5RW51bSIsIklTTENNb2RlbCIsIm1lcmdlIiwiY291bG9tYnNMYXciLCJDb3Vsb21ic0xhd0NvbW1vbk1vZGVsIiwiY29uc3RydWN0b3IiLCJjaGFyZ2UxIiwiY2hhcmdlMiIsInBvc2l0aW9uUmFuZ2UiLCJ0YW5kZW0iLCJvcHRpb25zIiwic25hcE9iamVjdHNUb05lYXJlc3QiLCJkaXNwbGF5U2NpZW50aWZpY05vdGF0aW9uIiwiaW5pdGlhbFJ1bGVyUG9zaXRpb24iLCJrIiwicnVsZXJQb3NpdGlvblByb3BlcnR5IiwiY3JlYXRlVGFuZGVtIiwiZm9yY2VWYWx1ZXNEaXNwbGF5UHJvcGVydHkiLCJERUNJTUFMIiwicGhldGlvRG9jdW1lbnRhdGlvbiIsImxhenlMaW5rIiwibmV3VmFsdWUiLCJzaG93Rm9yY2VWYWx1ZXNQcm9wZXJ0eSIsInZhbHVlIiwiU0NJRU5USUZJQyIsImdldE1pbkZvcmNlIiwiZ2V0TWF4Rm9yY2UiLCJjYWxjdWxhdGVGb3JjZSIsIm9iamVjdDEiLCJ2YWx1ZVJhbmdlIiwibWF4IiwiZ2V0TWluRGlzdGFuY2UiLCJ2YWx1ZVByb3BlcnR5IiwiZ2V0IiwicmVzZXQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkNvdWxvbWJzTGF3Q29tbW9uTW9kZWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTctMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQmFzZSBtb2RlbCBmb3IgYWxsIENvdWxvbWJzIExhdyBzaW0gc2NyZWVucy4gQWxsb3dzIGZvciBkaXN0aW5jdCBpbnN0YW50aWF0aW9uIGRldGFpbHMgZm9yIGJvdGggYXRvbWljIGFuZCBtYWNybyBzY2FsZXMuXHJcbiAqIEluaGVyaXRzIGZyb20gdGhlIGJhc2UgSVNMQ01vZGVsIHRoYXQgaXMgcmVzcG9uc2libGUgZm9yIGFsbCBmb3JjZSBjYWxjdWxhdGlvbiBiZXR3ZWVuIHRoZSBtb2RlbCdzIGNoYXJnZSBvYmplY3RzLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBNaWNoYWVsIEJhcmxvdyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgRW51bWVyYXRpb25EZXByZWNhdGVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9FbnVtZXJhdGlvbkRlcHJlY2F0ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IFZlY3RvcjJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMlByb3BlcnR5LmpzJztcclxuaW1wb3J0IElTTENDb25zdGFudHMgZnJvbSAnLi4vLi4vLi4vLi4vaW52ZXJzZS1zcXVhcmUtbGF3LWNvbW1vbi9qcy9JU0xDQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IEZvcmNlVmFsdWVzRGlzcGxheUVudW0gZnJvbSAnLi4vLi4vLi4vLi4vaW52ZXJzZS1zcXVhcmUtbGF3LWNvbW1vbi9qcy9tb2RlbC9Gb3JjZVZhbHVlc0Rpc3BsYXlFbnVtLmpzJztcclxuaW1wb3J0IElTTENNb2RlbCBmcm9tICcuLi8uLi8uLi8uLi9pbnZlcnNlLXNxdWFyZS1sYXctY29tbW9uL2pzL21vZGVsL0lTTENNb2RlbC5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgY291bG9tYnNMYXcgZnJvbSAnLi4vLi4vY291bG9tYnNMYXcuanMnO1xyXG5cclxuY2xhc3MgQ291bG9tYnNMYXdDb21tb25Nb2RlbCBleHRlbmRzIElTTENNb2RlbCB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7Q2hhcmdlfSBjaGFyZ2UxIC0gVGhlIGxlZnQgY2hhcmdlXHJcbiAgICogQHBhcmFtIHtDaGFyZ2V9IGNoYXJnZTIgLSBUaGUgcmlnaHQgY2hhcmdlXHJcbiAgICogQHBhcmFtIHtSYW5nZX0gcG9zaXRpb25SYW5nZVxyXG4gICAqIEBwYXJhbSB7VGFuZGVtfSB0YW5kZW1cclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIGNoYXJnZTEsIGNoYXJnZTIsIHBvc2l0aW9uUmFuZ2UsIHRhbmRlbSwgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgc25hcE9iamVjdHNUb05lYXJlc3Q6IDAuMSxcclxuICAgICAgZGlzcGxheVNjaWVudGlmaWNOb3RhdGlvbjogdHJ1ZSxcclxuICAgICAgaW5pdGlhbFJ1bGVyUG9zaXRpb246IG5ldyBWZWN0b3IyKCAwLCAtMS4xRS0yIClcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggSVNMQ0NvbnN0YW50cy5rLCBjaGFyZ2UxLCBjaGFyZ2UyLCBwb3NpdGlvblJhbmdlLCB0YW5kZW0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIC0gdGhlIHBvc2l0aW9uIG9mIHRoZSBydWxlciBpbiB0aGUgbW9kZWxcclxuICAgIHRoaXMucnVsZXJQb3NpdGlvblByb3BlcnR5ID0gbmV3IFZlY3RvcjJQcm9wZXJ0eSggb3B0aW9ucy5pbml0aWFsUnVsZXJQb3NpdGlvbiwge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdydWxlclBvc2l0aW9uUHJvcGVydHknIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBAcHVibGljXHJcbiAgICB0aGlzLmZvcmNlVmFsdWVzRGlzcGxheVByb3BlcnR5ID0gbmV3IEVudW1lcmF0aW9uRGVwcmVjYXRlZFByb3BlcnR5KCBGb3JjZVZhbHVlc0Rpc3BsYXlFbnVtLCBGb3JjZVZhbHVlc0Rpc3BsYXlFbnVtLkRFQ0lNQUwsIHtcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnZm9yY2VWYWx1ZXNEaXNwbGF5UHJvcGVydHknICksXHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdUaGlzIGRldGVybWluZXMgdGhlIGRpc3BsYXkgdHlwZSBmb3IgdGhlIGZvcmNlIHZhbHVlczogaW4gZGVjaW1hbCBvciBzY2llbnRpZmljICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAnbm90YXRpb24sIGFuZCBhbHNvIGhpZGRlbi4nXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gSVNMQyBjb2RlIGxpc3RlbnMgc3Vic3RhbnRpYWxseSB0byBzaG93Rm9yY2VWYWx1ZXNQcm9wZXJ0eSwgc28ga2VlcCB0aGF0IGluIHN5bmMgYXMgdGhlIGRpc3BsYXkgdHlwZSBjaGFuZ2VzLlxyXG4gICAgdGhpcy5mb3JjZVZhbHVlc0Rpc3BsYXlQcm9wZXJ0eS5sYXp5TGluayggbmV3VmFsdWUgPT4ge1xyXG4gICAgICB0aGlzLnNob3dGb3JjZVZhbHVlc1Byb3BlcnR5LnZhbHVlID0gbmV3VmFsdWUgPT09IEZvcmNlVmFsdWVzRGlzcGxheUVudW0uREVDSU1BTCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPT09IEZvcmNlVmFsdWVzRGlzcGxheUVudW0uU0NJRU5USUZJQztcclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwcm90ZWN0ZWRcclxuICAgKiBAb3ZlcnJpZGVcclxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG4gICAqL1xyXG4gIGdldE1pbkZvcmNlKCkge1xyXG4gICAgcmV0dXJuIC10aGlzLmdldE1heEZvcmNlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHVibGljXHJcbiAgICogQG92ZXJyaWRlXHJcbiAgICogQHJldHVybnMge251bWJlcn1cclxuICAgKi9cclxuICBnZXRNYXhGb3JjZSgpIHtcclxuXHJcbiAgICAvLyBUT0RPOiBzaG91bGQgdGhpcyBjYWxsIHNuYXBUb0dyaWQ/XHJcbiAgICAvLyBpbmhlcml0ZWQgb2JqZWN0IG5vZGUgYWNjZXB0cyB0aGUgZW50aXJlIGZvcmNlIHJhbmdlLiAoTk9URTogbmVjZXNzYXJ5IHRvIGNhbGN1bGF0ZSBoZXJlIGFzIENvdWxvbWIncyBMYXcgYWxsb3dzXHJcbiAgICAvLyBuZWdhdGl2ZSBmb3JjZXMgd2hpbGUgR3Jhdml0eSBGb3JjZSBMYWIgZG9lcyBub3QuKVxyXG4gICAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlRm9yY2UoIHRoaXMub2JqZWN0MS52YWx1ZVJhbmdlLm1heCwgdGhpcy5vYmplY3QxLnZhbHVlUmFuZ2UubWF4LFxyXG4gICAgICB0aGlzLmdldE1pbkRpc3RhbmNlKCB0aGlzLm9iamVjdDEudmFsdWVQcm9wZXJ0eS5nZXQoKSApICk7IC8vIFRoaXMgYXNzdW1lcyBjb25zdGFudCByYWRpdXMgZm9yIENvdWxvbWJzIGxhd1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzZXRzIHRoZSBtb2RlbC5cclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgcmVzZXQoKSB7XHJcblxyXG4gICAgLy8gQXMgb2Ygd3JpdGluZyB0aGlzLCBhbGwgKGJvdGgpIHN1YnR5cGVzIGhhdmUgYSBydWxlclBvc2l0aW9uUHJvcGVydHksIHNvIGl0IGlzIGVhc3kgZW5vdWdoIHRvIGp1c3QgcmVzZXQgdGhpcyBoZXJlLlxyXG4gICAgdGhpcy5ydWxlclBvc2l0aW9uUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMuZm9yY2VWYWx1ZXNEaXNwbGF5UHJvcGVydHkucmVzZXQoKTtcclxuICAgIHN1cGVyLnJlc2V0KCk7XHJcbiAgfVxyXG59XHJcblxyXG5jb3Vsb21ic0xhdy5yZWdpc3RlciggJ0NvdWxvbWJzTGF3Q29tbW9uTW9kZWwnLCBDb3Vsb21ic0xhd0NvbW1vbk1vZGVsICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb3Vsb21ic0xhd0NvbW1vbk1vZGVsOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsNkJBQTZCLE1BQU0sc0RBQXNEO0FBQ2hHLE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsT0FBT0MsZUFBZSxNQUFNLHVDQUF1QztBQUNuRSxPQUFPQyxhQUFhLE1BQU0sMkRBQTJEO0FBQ3JGLE9BQU9DLHNCQUFzQixNQUFNLDBFQUEwRTtBQUM3RyxPQUFPQyxTQUFTLE1BQU0sNkRBQTZEO0FBQ25GLE9BQU9DLEtBQUssTUFBTSxtQ0FBbUM7QUFDckQsT0FBT0MsV0FBVyxNQUFNLHNCQUFzQjtBQUU5QyxNQUFNQyxzQkFBc0IsU0FBU0gsU0FBUyxDQUFDO0VBRTdDO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0VJLFdBQVdBLENBQUVDLE9BQU8sRUFBRUMsT0FBTyxFQUFFQyxhQUFhLEVBQUVDLE1BQU0sRUFBRUMsT0FBTyxFQUFHO0lBRTlEQSxPQUFPLEdBQUdSLEtBQUssQ0FBRTtNQUNmUyxvQkFBb0IsRUFBRSxHQUFHO01BQ3pCQyx5QkFBeUIsRUFBRSxJQUFJO01BQy9CQyxvQkFBb0IsRUFBRSxJQUFJaEIsT0FBTyxDQUFFLENBQUMsRUFBRSxDQUFDLE1BQU87SUFDaEQsQ0FBQyxFQUFFYSxPQUFRLENBQUM7SUFFWixLQUFLLENBQUVYLGFBQWEsQ0FBQ2UsQ0FBQyxFQUFFUixPQUFPLEVBQUVDLE9BQU8sRUFBRUMsYUFBYSxFQUFFQyxNQUFNLEVBQUVDLE9BQVEsQ0FBQzs7SUFFMUU7SUFDQSxJQUFJLENBQUNLLHFCQUFxQixHQUFHLElBQUlqQixlQUFlLENBQUVZLE9BQU8sQ0FBQ0csb0JBQW9CLEVBQUU7TUFDOUVKLE1BQU0sRUFBRUEsTUFBTSxDQUFDTyxZQUFZLENBQUUsdUJBQXdCO0lBQ3ZELENBQUUsQ0FBQzs7SUFFSDtJQUNBLElBQUksQ0FBQ0MsMEJBQTBCLEdBQUcsSUFBSXJCLDZCQUE2QixDQUFFSSxzQkFBc0IsRUFBRUEsc0JBQXNCLENBQUNrQixPQUFPLEVBQUU7TUFDM0hULE1BQU0sRUFBRUEsTUFBTSxDQUFDTyxZQUFZLENBQUUsNEJBQTZCLENBQUM7TUFDM0RHLG1CQUFtQixFQUFFLGtGQUFrRixHQUNsRjtJQUN2QixDQUFFLENBQUM7O0lBRUg7SUFDQSxJQUFJLENBQUNGLDBCQUEwQixDQUFDRyxRQUFRLENBQUVDLFFBQVEsSUFBSTtNQUNwRCxJQUFJLENBQUNDLHVCQUF1QixDQUFDQyxLQUFLLEdBQUdGLFFBQVEsS0FBS3JCLHNCQUFzQixDQUFDa0IsT0FBTyxJQUMzQ0csUUFBUSxLQUFLckIsc0JBQXNCLENBQUN3QixVQUFVO0lBQ3JGLENBQUUsQ0FBQztFQUNMOztFQUVBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7RUFDRUMsV0FBV0EsQ0FBQSxFQUFHO0lBQ1osT0FBTyxDQUFDLElBQUksQ0FBQ0MsV0FBVyxDQUFDLENBQUM7RUFDNUI7O0VBRUE7QUFDRjtBQUNBO0FBQ0E7QUFDQTtFQUNFQSxXQUFXQSxDQUFBLEVBQUc7SUFFWjtJQUNBO0lBQ0E7SUFDQSxPQUFPLElBQUksQ0FBQ0MsY0FBYyxDQUFFLElBQUksQ0FBQ0MsT0FBTyxDQUFDQyxVQUFVLENBQUNDLEdBQUcsRUFBRSxJQUFJLENBQUNGLE9BQU8sQ0FBQ0MsVUFBVSxDQUFDQyxHQUFHLEVBQ2xGLElBQUksQ0FBQ0MsY0FBYyxDQUFFLElBQUksQ0FBQ0gsT0FBTyxDQUFDSSxhQUFhLENBQUNDLEdBQUcsQ0FBQyxDQUFFLENBQUUsQ0FBQyxDQUFDLENBQUM7RUFDL0Q7O0VBRUE7QUFDRjtBQUNBO0FBQ0E7RUFDRUMsS0FBS0EsQ0FBQSxFQUFHO0lBRU47SUFDQSxJQUFJLENBQUNuQixxQkFBcUIsQ0FBQ21CLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLElBQUksQ0FBQ2pCLDBCQUEwQixDQUFDaUIsS0FBSyxDQUFDLENBQUM7SUFDdkMsS0FBSyxDQUFDQSxLQUFLLENBQUMsQ0FBQztFQUNmO0FBQ0Y7QUFFQS9CLFdBQVcsQ0FBQ2dDLFFBQVEsQ0FBRSx3QkFBd0IsRUFBRS9CLHNCQUF1QixDQUFDO0FBRXhFLGVBQWVBLHNCQUFzQiJ9