// Copyright 2013-2023, University of Colorado Boulder

/**
 * Barometer Node with a gauge and needle to display the pressure.
 * Also has a text box to display the pressure value.
 *
 * @author Vasily Shakhov (Mlearner)
 * @author Siddhartha Chinthapally (ActualConcepts)
 * @author Sam Reid (PhET Interactive Simulations)
 */

import Multilink from '../../../../axon/js/Multilink.js';
import Property from '../../../../axon/js/Property.js';
import Bounds2 from '../../../../dot/js/Bounds2.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
import Range from '../../../../dot/js/Range.js';
import { Shape } from '../../../../kite/js/imports.js';
import merge from '../../../../phet-core/js/merge.js';
import GaugeNode from '../../../../scenery-phet/js/GaugeNode.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { DragListener, LinearGradient, Node, Path, Rectangle, Text } from '../../../../scenery/js/imports.js';
import Panel from '../../../../sun/js/Panel.js';
import fluidPressureAndFlow from '../../fluidPressureAndFlow.js';
import FluidPressureAndFlowStrings from '../../FluidPressureAndFlowStrings.js';
import Constants from '../Constants.js';
const pressureStringProperty = FluidPressureAndFlowStrings.pressureStringProperty;
class BarometerNode extends Node {
  /**
   * @param {ModelViewTransform2} modelViewTransform , Transform between model and view coordinate frames
   * @param {Sensor} barometer - the barometer model
   * @param {Property.<String>} measureUnitsProperty -- english/metric
   * @param {Property[]} linkedProperties - the set of properties which affect the barometer value
   * @param {function} getPressureAt - function to be called to get pressure at the given coords
   * @param {function} getPressureString - function to be called to get the pressure display string at the given coords
   * @param {Bounds2} containerBounds - bounds of container for all barometers, needed to snap barometer to initial position when it in container
   * @param {Bounds2} dragBounds - bounds that define where the barometer may be dragged
   * @param {Object} [options] that can be passed on to the underlying node
   *
   * Note the params passed for the functions:
   *  getPressureAt (x, y) where x, y are model values.
   *  getPressureString (pressure, units, x, y) where pressure in Pascals, x, y are model values
   */
  constructor(modelViewTransform, barometer, measureUnitsProperty, linkedProperties, getPressureAt, getPressureString, containerBounds, dragBounds, options) {
    options = merge({
      pressureReadOffset: 53,
      //distance between center and reading tip of the barometer in view co-ordinates
      scale: 1,
      minPressure: Constants.MIN_PRESSURE,
      maxPressure: Constants.MAX_PRESSURE,
      initialPosition: null // TODO figure out a better way to reset the barometer to have the position of the icon
    }, options);
    super({
      cursor: 'pointer'
    });

    // Show the circular part of the gauge and the needle
    const gaugeNode = new GaugeNode(barometer.valueProperty, pressureStringProperty, new Range(options.minPressure, options.maxPressure), {
      radius: 67,
      scale: 0.4
    });
    this.addChild(gaugeNode);
    const underGaugeRectangleWidth = 18;
    const underGaugeRectangleHeight = 15;
    const underGaugeRectangle = new Rectangle(gaugeNode.centerX - underGaugeRectangleWidth / 2, gaugeNode.bottom - 3, underGaugeRectangleWidth, underGaugeRectangleHeight, 1, 1, {
      fill: new LinearGradient(gaugeNode.centerX - underGaugeRectangleWidth / 2, 0, gaugeNode.centerX + underGaugeRectangleWidth / 2, 0).addColorStop(0, '#656570').addColorStop(0.2, '#bdc3cf').addColorStop(0.5, '#dee6f5').addColorStop(0.8, '#bdc3cf').addColorStop(1, '#656570'),
      top: gaugeNode.bottom - 2
    });
    this.addChild(underGaugeRectangle);

    //pressure text, y position empirically determined
    const READOUT_SIZE = new Dimension2(containerBounds.width * 0.8, 18);
    const text = new Text('', {
      font: new PhetFont(12),
      fontWeight: 'bold',
      maxWidth: READOUT_SIZE.width * 0.95
    });
    const readoutPanel = new Panel(text, {
      minWidth: READOUT_SIZE.width,
      maxWidth: READOUT_SIZE.width,
      minHeight: READOUT_SIZE.height,
      maxHeight: READOUT_SIZE.height,
      resize: false,
      cornerRadius: 5,
      lineWidth: 1,
      align: 'center',
      fill: 'white',
      xMargin: 0
    });
    const bottomTriangleShapeWidth = 6;
    const bottomTriangleShapeHeight = 12;
    readoutPanel.centerX = gaugeNode.centerX;
    readoutPanel.bottom = gaugeNode.bottom + 5;
    const bottomTriangleShape = new Shape().moveTo(gaugeNode.centerX - bottomTriangleShapeWidth / 2, underGaugeRectangle.rectY + underGaugeRectangleHeight).lineTo(gaugeNode.centerX, bottomTriangleShapeHeight + underGaugeRectangle.rectY + underGaugeRectangleHeight).lineTo(gaugeNode.centerX + bottomTriangleShapeWidth / 2, underGaugeRectangle.rectY + underGaugeRectangleHeight);
    this.addChild(new Path(bottomTriangleShape, {
      fill: new LinearGradient(gaugeNode.centerX - bottomTriangleShapeWidth / 2, 0, gaugeNode.centerX + bottomTriangleShapeWidth / 2, 0).addColorStop(0, '#656570').addColorStop(0.5, '#dee6f5').addColorStop(1, '#656570'),
      top: underGaugeRectangle.bottom - 1
    }));
    this.addChild(readoutPanel);
    this.mutate(options);
    const barometerDragBounds = modelViewTransform.viewToModelBounds(new Bounds2(this.width / 2, this.height / 2, dragBounds.width - this.width / 2, dragBounds.height - this.height / 2));
    barometer.positionProperty.link(position => {
      this.centerX = modelViewTransform.modelToViewX(position.x);
      this.centerY = modelViewTransform.modelToViewY(position.y);
    });

    // @public
    // Add an input listener so the BarometerNode can be dragged
    // Constrain the position so it cannot be dragged offscreen
    // TODO: moving up y, by 1.2
    this.dragListener = new DragListener({
      dragBoundsProperty: new Property(barometerDragBounds),
      positionProperty: barometer.positionProperty,
      transform: modelViewTransform,
      useParentOffset: true,
      start: () => {
        this.moveToFront();
      },
      end: () => {
        if (containerBounds.intersectsBounds(this.visibleBounds)) {
          if (options.initialPosition) {
            barometer.positionProperty.value = options.initialPosition;
            this.visible = false; // TODO does this want to be in all cases, not just for toolbox?
          } else {
            barometer.positionProperty.reset();
          }
          this.moveToBack();
        }
      }
    });
    !options.isIcon && this.addInputListener(this.dragListener);

    // Update the value in the barometer value model by reading from the model.
    Multilink.multilink([barometer.positionProperty].concat(linkedProperties), position => {
      if (barometer.positionProperty.value === barometer.positionProperty.initialValue) {
        barometer.valueProperty.value = null; // when the barometer is in the sensor panel making sure it shows no value for accessibility
      } else {
        barometer.valueProperty.value = getPressureAt(position.x, position.y + modelViewTransform.viewToModelDeltaY(this.bottom - this.centerY));
      }
    });

    // update barometer value when weights are added to chamber pool
    barometer.updateEmitter.addListener(() => {
      if (barometer.positionProperty.value === barometer.positionProperty.initialValue) {
        barometer.valueProperty.value = null; // when the barometer is in the sensor panel making sure it shows no value for accessibility
      } else {
        barometer.valueProperty.value = getPressureAt(barometer.positionProperty.value.x, barometer.positionProperty.value.y + modelViewTransform.viewToModelDeltaY(this.bottom - this.centerY));
      }
    });

    // Update the text when the value, units or position changes.
    // If the barometer reading is 0 and it is touching the sensor panel, then only the position changes.
    // In order to trigger the text display change, need to listen to position property here as well.
    Multilink.multilink([barometer.valueProperty, measureUnitsProperty, barometer.positionProperty], (barometerValue, units, position) => {
      if (position === barometer.positionProperty.initialValue || barometerValue === null) {
        text.string = MathSymbols.NO_VALUE; // showing no value when barometer is in the sensor panel
        text.centerX = READOUT_SIZE.width / 2;
      } else {
        text.string = getPressureString(barometerValue, units);
        text.centerX = READOUT_SIZE.width / 2;
        text.centerY = READOUT_SIZE.height * 0.7;
      }
    });
    this.touchArea = this.localBounds.dilatedXY(0, 0); //TODO why?
  }
}

fluidPressureAndFlow.register('BarometerNode', BarometerNode);
export default BarometerNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aWxpbmsiLCJQcm9wZXJ0eSIsIkJvdW5kczIiLCJEaW1lbnNpb24yIiwiUmFuZ2UiLCJTaGFwZSIsIm1lcmdlIiwiR2F1Z2VOb2RlIiwiTWF0aFN5bWJvbHMiLCJQaGV0Rm9udCIsIkRyYWdMaXN0ZW5lciIsIkxpbmVhckdyYWRpZW50IiwiTm9kZSIsIlBhdGgiLCJSZWN0YW5nbGUiLCJUZXh0IiwiUGFuZWwiLCJmbHVpZFByZXNzdXJlQW5kRmxvdyIsIkZsdWlkUHJlc3N1cmVBbmRGbG93U3RyaW5ncyIsIkNvbnN0YW50cyIsInByZXNzdXJlU3RyaW5nUHJvcGVydHkiLCJCYXJvbWV0ZXJOb2RlIiwiY29uc3RydWN0b3IiLCJtb2RlbFZpZXdUcmFuc2Zvcm0iLCJiYXJvbWV0ZXIiLCJtZWFzdXJlVW5pdHNQcm9wZXJ0eSIsImxpbmtlZFByb3BlcnRpZXMiLCJnZXRQcmVzc3VyZUF0IiwiZ2V0UHJlc3N1cmVTdHJpbmciLCJjb250YWluZXJCb3VuZHMiLCJkcmFnQm91bmRzIiwib3B0aW9ucyIsInByZXNzdXJlUmVhZE9mZnNldCIsInNjYWxlIiwibWluUHJlc3N1cmUiLCJNSU5fUFJFU1NVUkUiLCJtYXhQcmVzc3VyZSIsIk1BWF9QUkVTU1VSRSIsImluaXRpYWxQb3NpdGlvbiIsImN1cnNvciIsImdhdWdlTm9kZSIsInZhbHVlUHJvcGVydHkiLCJyYWRpdXMiLCJhZGRDaGlsZCIsInVuZGVyR2F1Z2VSZWN0YW5nbGVXaWR0aCIsInVuZGVyR2F1Z2VSZWN0YW5nbGVIZWlnaHQiLCJ1bmRlckdhdWdlUmVjdGFuZ2xlIiwiY2VudGVyWCIsImJvdHRvbSIsImZpbGwiLCJhZGRDb2xvclN0b3AiLCJ0b3AiLCJSRUFET1VUX1NJWkUiLCJ3aWR0aCIsInRleHQiLCJmb250IiwiZm9udFdlaWdodCIsIm1heFdpZHRoIiwicmVhZG91dFBhbmVsIiwibWluV2lkdGgiLCJtaW5IZWlnaHQiLCJoZWlnaHQiLCJtYXhIZWlnaHQiLCJyZXNpemUiLCJjb3JuZXJSYWRpdXMiLCJsaW5lV2lkdGgiLCJhbGlnbiIsInhNYXJnaW4iLCJib3R0b21UcmlhbmdsZVNoYXBlV2lkdGgiLCJib3R0b21UcmlhbmdsZVNoYXBlSGVpZ2h0IiwiYm90dG9tVHJpYW5nbGVTaGFwZSIsIm1vdmVUbyIsInJlY3RZIiwibGluZVRvIiwibXV0YXRlIiwiYmFyb21ldGVyRHJhZ0JvdW5kcyIsInZpZXdUb01vZGVsQm91bmRzIiwicG9zaXRpb25Qcm9wZXJ0eSIsImxpbmsiLCJwb3NpdGlvbiIsIm1vZGVsVG9WaWV3WCIsIngiLCJjZW50ZXJZIiwibW9kZWxUb1ZpZXdZIiwieSIsImRyYWdMaXN0ZW5lciIsImRyYWdCb3VuZHNQcm9wZXJ0eSIsInRyYW5zZm9ybSIsInVzZVBhcmVudE9mZnNldCIsInN0YXJ0IiwibW92ZVRvRnJvbnQiLCJlbmQiLCJpbnRlcnNlY3RzQm91bmRzIiwidmlzaWJsZUJvdW5kcyIsInZhbHVlIiwidmlzaWJsZSIsInJlc2V0IiwibW92ZVRvQmFjayIsImlzSWNvbiIsImFkZElucHV0TGlzdGVuZXIiLCJtdWx0aWxpbmsiLCJjb25jYXQiLCJpbml0aWFsVmFsdWUiLCJ2aWV3VG9Nb2RlbERlbHRhWSIsInVwZGF0ZUVtaXR0ZXIiLCJhZGRMaXN0ZW5lciIsImJhcm9tZXRlclZhbHVlIiwidW5pdHMiLCJzdHJpbmciLCJOT19WQUxVRSIsInRvdWNoQXJlYSIsImxvY2FsQm91bmRzIiwiZGlsYXRlZFhZIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJCYXJvbWV0ZXJOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDEzLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEJhcm9tZXRlciBOb2RlIHdpdGggYSBnYXVnZSBhbmQgbmVlZGxlIHRvIGRpc3BsYXkgdGhlIHByZXNzdXJlLlxyXG4gKiBBbHNvIGhhcyBhIHRleHQgYm94IHRvIGRpc3BsYXkgdGhlIHByZXNzdXJlIHZhbHVlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIFZhc2lseSBTaGFraG92IChNbGVhcm5lcilcclxuICogQGF1dGhvciBTaWRkaGFydGhhIENoaW50aGFwYWxseSAoQWN0dWFsQ29uY2VwdHMpXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IE11bHRpbGluayBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL011bHRpbGluay5qcyc7XHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgRGltZW5zaW9uMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvRGltZW5zaW9uMi5qcyc7XHJcbmltcG9ydCBSYW5nZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2UuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgR2F1Z2VOb2RlIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9HYXVnZU5vZGUuanMnO1xyXG5pbXBvcnQgTWF0aFN5bWJvbHMgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL01hdGhTeW1ib2xzLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IERyYWdMaXN0ZW5lciwgTGluZWFyR3JhZGllbnQsIE5vZGUsIFBhdGgsIFJlY3RhbmdsZSwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBQYW5lbCBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvUGFuZWwuanMnO1xyXG5pbXBvcnQgZmx1aWRQcmVzc3VyZUFuZEZsb3cgZnJvbSAnLi4vLi4vZmx1aWRQcmVzc3VyZUFuZEZsb3cuanMnO1xyXG5pbXBvcnQgRmx1aWRQcmVzc3VyZUFuZEZsb3dTdHJpbmdzIGZyb20gJy4uLy4uL0ZsdWlkUHJlc3N1cmVBbmRGbG93U3RyaW5ncy5qcyc7XHJcbmltcG9ydCBDb25zdGFudHMgZnJvbSAnLi4vQ29uc3RhbnRzLmpzJztcclxuXHJcbmNvbnN0IHByZXNzdXJlU3RyaW5nUHJvcGVydHkgPSBGbHVpZFByZXNzdXJlQW5kRmxvd1N0cmluZ3MucHJlc3N1cmVTdHJpbmdQcm9wZXJ0eTtcclxuXHJcbmNsYXNzIEJhcm9tZXRlck5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtNb2RlbFZpZXdUcmFuc2Zvcm0yfSBtb2RlbFZpZXdUcmFuc2Zvcm0gLCBUcmFuc2Zvcm0gYmV0d2VlbiBtb2RlbCBhbmQgdmlldyBjb29yZGluYXRlIGZyYW1lc1xyXG4gICAqIEBwYXJhbSB7U2Vuc29yfSBiYXJvbWV0ZXIgLSB0aGUgYmFyb21ldGVyIG1vZGVsXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48U3RyaW5nPn0gbWVhc3VyZVVuaXRzUHJvcGVydHkgLS0gZW5nbGlzaC9tZXRyaWNcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5W119IGxpbmtlZFByb3BlcnRpZXMgLSB0aGUgc2V0IG9mIHByb3BlcnRpZXMgd2hpY2ggYWZmZWN0IHRoZSBiYXJvbWV0ZXIgdmFsdWVcclxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBnZXRQcmVzc3VyZUF0IC0gZnVuY3Rpb24gdG8gYmUgY2FsbGVkIHRvIGdldCBwcmVzc3VyZSBhdCB0aGUgZ2l2ZW4gY29vcmRzXHJcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gZ2V0UHJlc3N1cmVTdHJpbmcgLSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgdG8gZ2V0IHRoZSBwcmVzc3VyZSBkaXNwbGF5IHN0cmluZyBhdCB0aGUgZ2l2ZW4gY29vcmRzXHJcbiAgICogQHBhcmFtIHtCb3VuZHMyfSBjb250YWluZXJCb3VuZHMgLSBib3VuZHMgb2YgY29udGFpbmVyIGZvciBhbGwgYmFyb21ldGVycywgbmVlZGVkIHRvIHNuYXAgYmFyb21ldGVyIHRvIGluaXRpYWwgcG9zaXRpb24gd2hlbiBpdCBpbiBjb250YWluZXJcclxuICAgKiBAcGFyYW0ge0JvdW5kczJ9IGRyYWdCb3VuZHMgLSBib3VuZHMgdGhhdCBkZWZpbmUgd2hlcmUgdGhlIGJhcm9tZXRlciBtYXkgYmUgZHJhZ2dlZFxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gdGhhdCBjYW4gYmUgcGFzc2VkIG9uIHRvIHRoZSB1bmRlcmx5aW5nIG5vZGVcclxuICAgKlxyXG4gICAqIE5vdGUgdGhlIHBhcmFtcyBwYXNzZWQgZm9yIHRoZSBmdW5jdGlvbnM6XHJcbiAgICogIGdldFByZXNzdXJlQXQgKHgsIHkpIHdoZXJlIHgsIHkgYXJlIG1vZGVsIHZhbHVlcy5cclxuICAgKiAgZ2V0UHJlc3N1cmVTdHJpbmcgKHByZXNzdXJlLCB1bml0cywgeCwgeSkgd2hlcmUgcHJlc3N1cmUgaW4gUGFzY2FscywgeCwgeSBhcmUgbW9kZWwgdmFsdWVzXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG1vZGVsVmlld1RyYW5zZm9ybSwgYmFyb21ldGVyLCBtZWFzdXJlVW5pdHNQcm9wZXJ0eSwgbGlua2VkUHJvcGVydGllcywgZ2V0UHJlc3N1cmVBdCxcclxuICAgICAgICAgICAgICAgZ2V0UHJlc3N1cmVTdHJpbmcsIGNvbnRhaW5lckJvdW5kcywgZHJhZ0JvdW5kcywgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgcHJlc3N1cmVSZWFkT2Zmc2V0OiA1MywgLy9kaXN0YW5jZSBiZXR3ZWVuIGNlbnRlciBhbmQgcmVhZGluZyB0aXAgb2YgdGhlIGJhcm9tZXRlciBpbiB2aWV3IGNvLW9yZGluYXRlc1xyXG4gICAgICBzY2FsZTogMSxcclxuICAgICAgbWluUHJlc3N1cmU6IENvbnN0YW50cy5NSU5fUFJFU1NVUkUsXHJcbiAgICAgIG1heFByZXNzdXJlOiBDb25zdGFudHMuTUFYX1BSRVNTVVJFLFxyXG4gICAgICBpbml0aWFsUG9zaXRpb246IG51bGwgLy8gVE9ETyBmaWd1cmUgb3V0IGEgYmV0dGVyIHdheSB0byByZXNldCB0aGUgYmFyb21ldGVyIHRvIGhhdmUgdGhlIHBvc2l0aW9uIG9mIHRoZSBpY29uXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIHsgY3Vyc29yOiAncG9pbnRlcicgfSApO1xyXG5cclxuICAgIC8vIFNob3cgdGhlIGNpcmN1bGFyIHBhcnQgb2YgdGhlIGdhdWdlIGFuZCB0aGUgbmVlZGxlXHJcbiAgICBjb25zdCBnYXVnZU5vZGUgPSBuZXcgR2F1Z2VOb2RlKCBiYXJvbWV0ZXIudmFsdWVQcm9wZXJ0eSwgcHJlc3N1cmVTdHJpbmdQcm9wZXJ0eSxcclxuICAgICAgbmV3IFJhbmdlKCBvcHRpb25zLm1pblByZXNzdXJlLCBvcHRpb25zLm1heFByZXNzdXJlICksIHsgcmFkaXVzOiA2Nywgc2NhbGU6IDAuNCB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBnYXVnZU5vZGUgKTtcclxuXHJcbiAgICBjb25zdCB1bmRlckdhdWdlUmVjdGFuZ2xlV2lkdGggPSAxODtcclxuICAgIGNvbnN0IHVuZGVyR2F1Z2VSZWN0YW5nbGVIZWlnaHQgPSAxNTtcclxuICAgIGNvbnN0IHVuZGVyR2F1Z2VSZWN0YW5nbGUgPSBuZXcgUmVjdGFuZ2xlKCBnYXVnZU5vZGUuY2VudGVyWCAtIHVuZGVyR2F1Z2VSZWN0YW5nbGVXaWR0aCAvIDIsIGdhdWdlTm9kZS5ib3R0b20gLSAzLFxyXG4gICAgICB1bmRlckdhdWdlUmVjdGFuZ2xlV2lkdGgsIHVuZGVyR2F1Z2VSZWN0YW5nbGVIZWlnaHQsIDEsIDEsIHtcclxuICAgICAgICBmaWxsOiBuZXcgTGluZWFyR3JhZGllbnQoIGdhdWdlTm9kZS5jZW50ZXJYIC0gdW5kZXJHYXVnZVJlY3RhbmdsZVdpZHRoIC8gMiwgMCxcclxuICAgICAgICAgIGdhdWdlTm9kZS5jZW50ZXJYICsgdW5kZXJHYXVnZVJlY3RhbmdsZVdpZHRoIC8gMiwgMCApXHJcbiAgICAgICAgICAuYWRkQ29sb3JTdG9wKCAwLCAnIzY1NjU3MCcgKVxyXG4gICAgICAgICAgLmFkZENvbG9yU3RvcCggMC4yLCAnI2JkYzNjZicgKVxyXG4gICAgICAgICAgLmFkZENvbG9yU3RvcCggMC41LCAnI2RlZTZmNScgKVxyXG4gICAgICAgICAgLmFkZENvbG9yU3RvcCggMC44LCAnI2JkYzNjZicgKVxyXG4gICAgICAgICAgLmFkZENvbG9yU3RvcCggMSwgJyM2NTY1NzAnICksXHJcbiAgICAgICAgdG9wOiBnYXVnZU5vZGUuYm90dG9tIC0gMlxyXG4gICAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB1bmRlckdhdWdlUmVjdGFuZ2xlICk7XHJcblxyXG4gICAgLy9wcmVzc3VyZSB0ZXh0LCB5IHBvc2l0aW9uIGVtcGlyaWNhbGx5IGRldGVybWluZWRcclxuICAgIGNvbnN0IFJFQURPVVRfU0laRSA9IG5ldyBEaW1lbnNpb24yKCBjb250YWluZXJCb3VuZHMud2lkdGggKiAwLjgsIDE4ICk7XHJcbiAgICBjb25zdCB0ZXh0ID0gbmV3IFRleHQoICcnLCB7XHJcbiAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggMTIgKSxcclxuICAgICAgZm9udFdlaWdodDogJ2JvbGQnLFxyXG4gICAgICBtYXhXaWR0aDogUkVBRE9VVF9TSVpFLndpZHRoICogMC45NVxyXG4gICAgfSApO1xyXG4gICAgY29uc3QgcmVhZG91dFBhbmVsID0gbmV3IFBhbmVsKCB0ZXh0LCB7XHJcbiAgICAgIG1pbldpZHRoOiBSRUFET1VUX1NJWkUud2lkdGgsXHJcbiAgICAgIG1heFdpZHRoOiBSRUFET1VUX1NJWkUud2lkdGgsXHJcbiAgICAgIG1pbkhlaWdodDogUkVBRE9VVF9TSVpFLmhlaWdodCxcclxuICAgICAgbWF4SGVpZ2h0OiBSRUFET1VUX1NJWkUuaGVpZ2h0LFxyXG4gICAgICByZXNpemU6IGZhbHNlLFxyXG4gICAgICBjb3JuZXJSYWRpdXM6IDUsXHJcbiAgICAgIGxpbmVXaWR0aDogMSxcclxuICAgICAgYWxpZ246ICdjZW50ZXInLFxyXG4gICAgICBmaWxsOiAnd2hpdGUnLFxyXG4gICAgICB4TWFyZ2luOiAwXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgYm90dG9tVHJpYW5nbGVTaGFwZVdpZHRoID0gNjtcclxuICAgIGNvbnN0IGJvdHRvbVRyaWFuZ2xlU2hhcGVIZWlnaHQgPSAxMjtcclxuICAgIHJlYWRvdXRQYW5lbC5jZW50ZXJYID0gZ2F1Z2VOb2RlLmNlbnRlclg7XHJcbiAgICByZWFkb3V0UGFuZWwuYm90dG9tID0gZ2F1Z2VOb2RlLmJvdHRvbSArIDU7XHJcblxyXG4gICAgY29uc3QgYm90dG9tVHJpYW5nbGVTaGFwZSA9IG5ldyBTaGFwZSgpXHJcbiAgICAgIC5tb3ZlVG8oIGdhdWdlTm9kZS5jZW50ZXJYIC0gYm90dG9tVHJpYW5nbGVTaGFwZVdpZHRoIC8gMiwgdW5kZXJHYXVnZVJlY3RhbmdsZS5yZWN0WSArIHVuZGVyR2F1Z2VSZWN0YW5nbGVIZWlnaHQgKVxyXG4gICAgICAubGluZVRvKCBnYXVnZU5vZGUuY2VudGVyWCwgYm90dG9tVHJpYW5nbGVTaGFwZUhlaWdodCArIHVuZGVyR2F1Z2VSZWN0YW5nbGUucmVjdFkgKyB1bmRlckdhdWdlUmVjdGFuZ2xlSGVpZ2h0IClcclxuICAgICAgLmxpbmVUbyggZ2F1Z2VOb2RlLmNlbnRlclggKyBib3R0b21UcmlhbmdsZVNoYXBlV2lkdGggLyAyLFxyXG4gICAgICAgIHVuZGVyR2F1Z2VSZWN0YW5nbGUucmVjdFkgKyB1bmRlckdhdWdlUmVjdGFuZ2xlSGVpZ2h0ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBuZXcgUGF0aCggYm90dG9tVHJpYW5nbGVTaGFwZSwge1xyXG4gICAgICBmaWxsOiBuZXcgTGluZWFyR3JhZGllbnQoIGdhdWdlTm9kZS5jZW50ZXJYIC0gYm90dG9tVHJpYW5nbGVTaGFwZVdpZHRoIC8gMiwgMCxcclxuICAgICAgICBnYXVnZU5vZGUuY2VudGVyWCArIGJvdHRvbVRyaWFuZ2xlU2hhcGVXaWR0aCAvIDIsIDAgKVxyXG4gICAgICAgIC5hZGRDb2xvclN0b3AoIDAsICcjNjU2NTcwJyApXHJcbiAgICAgICAgLmFkZENvbG9yU3RvcCggMC41LCAnI2RlZTZmNScgKVxyXG4gICAgICAgIC5hZGRDb2xvclN0b3AoIDEsICcjNjU2NTcwJyApLFxyXG4gICAgICB0b3A6IHVuZGVyR2F1Z2VSZWN0YW5nbGUuYm90dG9tIC0gMVxyXG4gICAgfSApICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCByZWFkb3V0UGFuZWwgKTtcclxuICAgIHRoaXMubXV0YXRlKCBvcHRpb25zICk7XHJcblxyXG4gICAgY29uc3QgYmFyb21ldGVyRHJhZ0JvdW5kcyA9IG1vZGVsVmlld1RyYW5zZm9ybS52aWV3VG9Nb2RlbEJvdW5kcyggbmV3IEJvdW5kczIoXHJcbiAgICAgIHRoaXMud2lkdGggLyAyLFxyXG4gICAgICB0aGlzLmhlaWdodCAvIDIsXHJcbiAgICAgIGRyYWdCb3VuZHMud2lkdGggLSB0aGlzLndpZHRoIC8gMixcclxuICAgICAgZHJhZ0JvdW5kcy5oZWlnaHQgLSB0aGlzLmhlaWdodCAvIDIgKSApO1xyXG5cclxuICAgIGJhcm9tZXRlci5wb3NpdGlvblByb3BlcnR5LmxpbmsoIHBvc2l0aW9uID0+IHtcclxuICAgICAgdGhpcy5jZW50ZXJYID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WCggcG9zaXRpb24ueCApO1xyXG4gICAgICB0aGlzLmNlbnRlclkgPSBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdZKCBwb3NpdGlvbi55ICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHB1YmxpY1xyXG4gICAgLy8gQWRkIGFuIGlucHV0IGxpc3RlbmVyIHNvIHRoZSBCYXJvbWV0ZXJOb2RlIGNhbiBiZSBkcmFnZ2VkXHJcbiAgICAvLyBDb25zdHJhaW4gdGhlIHBvc2l0aW9uIHNvIGl0IGNhbm5vdCBiZSBkcmFnZ2VkIG9mZnNjcmVlblxyXG4gICAgLy8gVE9ETzogbW92aW5nIHVwIHksIGJ5IDEuMlxyXG4gICAgdGhpcy5kcmFnTGlzdGVuZXIgPSBuZXcgRHJhZ0xpc3RlbmVyKCB7XHJcbiAgICAgIGRyYWdCb3VuZHNQcm9wZXJ0eTogbmV3IFByb3BlcnR5KCBiYXJvbWV0ZXJEcmFnQm91bmRzICksXHJcbiAgICAgIHBvc2l0aW9uUHJvcGVydHk6IGJhcm9tZXRlci5wb3NpdGlvblByb3BlcnR5LFxyXG4gICAgICB0cmFuc2Zvcm06IG1vZGVsVmlld1RyYW5zZm9ybSxcclxuICAgICAgdXNlUGFyZW50T2Zmc2V0OiB0cnVlLFxyXG5cclxuICAgICAgc3RhcnQ6ICgpID0+IHtcclxuICAgICAgICB0aGlzLm1vdmVUb0Zyb250KCk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBlbmQ6ICgpID0+IHtcclxuICAgICAgICBpZiAoIGNvbnRhaW5lckJvdW5kcy5pbnRlcnNlY3RzQm91bmRzKCB0aGlzLnZpc2libGVCb3VuZHMgKSApIHtcclxuXHJcbiAgICAgICAgICBpZiAoIG9wdGlvbnMuaW5pdGlhbFBvc2l0aW9uICkge1xyXG4gICAgICAgICAgICBiYXJvbWV0ZXIucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZSA9IG9wdGlvbnMuaW5pdGlhbFBvc2l0aW9uO1xyXG4gICAgICAgICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTsgLy8gVE9ETyBkb2VzIHRoaXMgd2FudCB0byBiZSBpbiBhbGwgY2FzZXMsIG5vdCBqdXN0IGZvciB0b29sYm94P1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGJhcm9tZXRlci5wb3NpdGlvblByb3BlcnR5LnJlc2V0KCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgdGhpcy5tb3ZlVG9CYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcbiAgICAhb3B0aW9ucy5pc0ljb24gJiYgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCB0aGlzLmRyYWdMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgdmFsdWUgaW4gdGhlIGJhcm9tZXRlciB2YWx1ZSBtb2RlbCBieSByZWFkaW5nIGZyb20gdGhlIG1vZGVsLlxyXG4gICAgTXVsdGlsaW5rLm11bHRpbGluayggWyBiYXJvbWV0ZXIucG9zaXRpb25Qcm9wZXJ0eSBdLmNvbmNhdCggbGlua2VkUHJvcGVydGllcyApLCBwb3NpdGlvbiA9PiB7XHJcbiAgICAgIGlmICggYmFyb21ldGVyLnBvc2l0aW9uUHJvcGVydHkudmFsdWUgPT09IGJhcm9tZXRlci5wb3NpdGlvblByb3BlcnR5LmluaXRpYWxWYWx1ZSApIHtcclxuICAgICAgICBiYXJvbWV0ZXIudmFsdWVQcm9wZXJ0eS52YWx1ZSA9IG51bGw7IC8vIHdoZW4gdGhlIGJhcm9tZXRlciBpcyBpbiB0aGUgc2Vuc29yIHBhbmVsIG1ha2luZyBzdXJlIGl0IHNob3dzIG5vIHZhbHVlIGZvciBhY2Nlc3NpYmlsaXR5XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgYmFyb21ldGVyLnZhbHVlUHJvcGVydHkudmFsdWUgPSBnZXRQcmVzc3VyZUF0KCBwb3NpdGlvbi54LFxyXG4gICAgICAgICAgcG9zaXRpb24ueSArIG1vZGVsVmlld1RyYW5zZm9ybS52aWV3VG9Nb2RlbERlbHRhWSggdGhpcy5ib3R0b20gLSB0aGlzLmNlbnRlclkgKSApO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gdXBkYXRlIGJhcm9tZXRlciB2YWx1ZSB3aGVuIHdlaWdodHMgYXJlIGFkZGVkIHRvIGNoYW1iZXIgcG9vbFxyXG4gICAgYmFyb21ldGVyLnVwZGF0ZUVtaXR0ZXIuYWRkTGlzdGVuZXIoICgpID0+IHtcclxuICAgICAgaWYgKCBiYXJvbWV0ZXIucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZSA9PT0gYmFyb21ldGVyLnBvc2l0aW9uUHJvcGVydHkuaW5pdGlhbFZhbHVlICkge1xyXG4gICAgICAgIGJhcm9tZXRlci52YWx1ZVByb3BlcnR5LnZhbHVlID0gbnVsbDsgLy8gd2hlbiB0aGUgYmFyb21ldGVyIGlzIGluIHRoZSBzZW5zb3IgcGFuZWwgbWFraW5nIHN1cmUgaXQgc2hvd3Mgbm8gdmFsdWUgZm9yIGFjY2Vzc2liaWxpdHlcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBiYXJvbWV0ZXIudmFsdWVQcm9wZXJ0eS52YWx1ZSA9IGdldFByZXNzdXJlQXQoIGJhcm9tZXRlci5wb3NpdGlvblByb3BlcnR5LnZhbHVlLngsXHJcbiAgICAgICAgICBiYXJvbWV0ZXIucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZS55ICsgbW9kZWxWaWV3VHJhbnNmb3JtLnZpZXdUb01vZGVsRGVsdGFZKCB0aGlzLmJvdHRvbSAtIHRoaXMuY2VudGVyWSApICk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIHRleHQgd2hlbiB0aGUgdmFsdWUsIHVuaXRzIG9yIHBvc2l0aW9uIGNoYW5nZXMuXHJcbiAgICAvLyBJZiB0aGUgYmFyb21ldGVyIHJlYWRpbmcgaXMgMCBhbmQgaXQgaXMgdG91Y2hpbmcgdGhlIHNlbnNvciBwYW5lbCwgdGhlbiBvbmx5IHRoZSBwb3NpdGlvbiBjaGFuZ2VzLlxyXG4gICAgLy8gSW4gb3JkZXIgdG8gdHJpZ2dlciB0aGUgdGV4dCBkaXNwbGF5IGNoYW5nZSwgbmVlZCB0byBsaXN0ZW4gdG8gcG9zaXRpb24gcHJvcGVydHkgaGVyZSBhcyB3ZWxsLlxyXG4gICAgTXVsdGlsaW5rLm11bHRpbGluayggWyBiYXJvbWV0ZXIudmFsdWVQcm9wZXJ0eSwgbWVhc3VyZVVuaXRzUHJvcGVydHksIGJhcm9tZXRlci5wb3NpdGlvblByb3BlcnR5IF0sXHJcbiAgICAgICggYmFyb21ldGVyVmFsdWUsIHVuaXRzLCBwb3NpdGlvbiApID0+IHtcclxuICAgICAgICBpZiAoIHBvc2l0aW9uID09PSBiYXJvbWV0ZXIucG9zaXRpb25Qcm9wZXJ0eS5pbml0aWFsVmFsdWUgfHwgYmFyb21ldGVyVmFsdWUgPT09IG51bGwgKSB7XHJcbiAgICAgICAgICB0ZXh0LnN0cmluZyA9IE1hdGhTeW1ib2xzLk5PX1ZBTFVFOyAvLyBzaG93aW5nIG5vIHZhbHVlIHdoZW4gYmFyb21ldGVyIGlzIGluIHRoZSBzZW5zb3IgcGFuZWxcclxuICAgICAgICAgIHRleHQuY2VudGVyWCA9IFJFQURPVVRfU0laRS53aWR0aCAvIDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgdGV4dC5zdHJpbmcgPSBnZXRQcmVzc3VyZVN0cmluZyggYmFyb21ldGVyVmFsdWUsIHVuaXRzICk7XHJcbiAgICAgICAgICB0ZXh0LmNlbnRlclggPSBSRUFET1VUX1NJWkUud2lkdGggLyAyO1xyXG4gICAgICAgICAgdGV4dC5jZW50ZXJZID0gUkVBRE9VVF9TSVpFLmhlaWdodCAqIDAuNztcclxuICAgICAgICB9XHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLnRvdWNoQXJlYSA9IHRoaXMubG9jYWxCb3VuZHMuZGlsYXRlZFhZKCAwLCAwICk7IC8vVE9ETyB3aHk/XHJcbiAgfVxyXG59XHJcblxyXG5mbHVpZFByZXNzdXJlQW5kRmxvdy5yZWdpc3RlciggJ0Jhcm9tZXRlck5vZGUnLCBCYXJvbWV0ZXJOb2RlICk7XHJcbmV4cG9ydCBkZWZhdWx0IEJhcm9tZXRlck5vZGU7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFNBQVMsTUFBTSxrQ0FBa0M7QUFDeEQsT0FBT0MsUUFBUSxNQUFNLGlDQUFpQztBQUN0RCxPQUFPQyxPQUFPLE1BQU0sK0JBQStCO0FBQ25ELE9BQU9DLFVBQVUsTUFBTSxrQ0FBa0M7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