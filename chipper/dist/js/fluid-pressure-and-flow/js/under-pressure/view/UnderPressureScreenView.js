// Copyright 2013-2022, University of Colorado Boulder

/**
 *  Main view for the under-pressure screen. The view contains 4 scenes: square pool, chamber pool, trapezoid and a
 *  mystery pool. There is a scene selector to switch between the views. There are panels to control the fluid density
 *  and gravity and tools to measure pressure and length. Supports viewing values in english, metric or atmosphere units.
 *
 * @author Vasily Shakhov (Mlearner)
 * @author Siddhartha Chinthapally (Actual Concepts).
 */

import Vector2 from '../../../../dot/js/Vector2.js';
import ScreenView from '../../../../joist/js/ScreenView.js';
import ModelViewTransform2 from '../../../../phetcommon/js/view/ModelViewTransform2.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import { Node, Rectangle } from '../../../../scenery/js/imports.js';
import Constants from '../../common/Constants.js';
import BarometerNode from '../../common/view/BarometerNode.js';
import ControlSlider from '../../common/view/ControlSlider.js';
import UnitsControlPanel from '../../common/view/UnitsControlPanel.js';
import fluidPressureAndFlow from '../../fluidPressureAndFlow.js';
import FluidPressureAndFlowStrings from '../../FluidPressureAndFlowStrings.js';
import BackgroundNode from './BackgroundNode.js';
import ChamberPoolView from './ChamberPoolView.js';
import ControlPanel from './ControlPanel.js';
import MysteryPoolView from './MysteryPoolView.js';
import SceneChoiceNode from './SceneChoiceNode.js';
import SquarePoolView from './SquarePoolView.js';
import TrapezoidPoolView from './TrapezoidPoolView.js';
import UnderPressureRuler from './UnderPressureRuler.js';
const earthString = FluidPressureAndFlowStrings.earth;
const fluidDensityString = FluidPressureAndFlowStrings.fluidDensity;
const gasolineString = FluidPressureAndFlowStrings.gasoline;
const gravityString = FluidPressureAndFlowStrings.gravity;
const honeyString = FluidPressureAndFlowStrings.honey;
const jupiterString = FluidPressureAndFlowStrings.jupiter;
const marsString = FluidPressureAndFlowStrings.mars;
const waterString = FluidPressureAndFlowStrings.water;

// constants
const INSET = 15;
const CONTROL_PANEL_WIDTH = 140; // empirically determined to look good and leave some space for translation
const CONTROL_PANEL_CORNER_RADIUS = 7;
const CONTROL_PANEL_X_MARGIN = 7;
class UnderPressureScreenView extends ScreenView {
  /**
   * @param {UnderPressureModel} underPressureModel
   */
  constructor(underPressureModel) {
    super(Constants.SCREEN_VIEW_OPTIONS);
    const modelViewTransform = ModelViewTransform2.createSinglePointScaleInvertedYMapping(Vector2.ZERO, new Vector2(0, 245), 70); //1m = 70px, (0,0) - top left corner

    //sky, earth and controls
    this.addChild(new BackgroundNode(underPressureModel, modelViewTransform));

    // add reset button
    const resetAllButton = new ResetAllButton({
      listener: () => {
        underPressureModel.reset();
        this.reset();
      },
      radius: 18,
      right: this.layoutBounds.right - INSET,
      bottom: this.layoutBounds.bottom - 5
    });
    this.addChild(resetAllButton);

    //control panel
    const controlPanel = new ControlPanel(underPressureModel, {
      right: resetAllButton.right,
      top: 5,
      cornerRadius: CONTROL_PANEL_CORNER_RADIUS,
      xMargin: CONTROL_PANEL_X_MARGIN,
      minWidth: CONTROL_PANEL_WIDTH,
      maxWidth: CONTROL_PANEL_WIDTH
    });
    this.addChild(controlPanel);

    // all the movable tools are added to this layer
    const toolsLayer = new Node();
    this.addChild(toolsLayer);

    // units panel
    const unitsControlPanel = new UnitsControlPanel(underPressureModel.measureUnitsProperty, {
      right: resetAllButton.right,
      top: controlPanel.bottom + 6,
      cornerRadius: CONTROL_PANEL_CORNER_RADIUS,
      xMargin: CONTROL_PANEL_X_MARGIN,
      minWidth: CONTROL_PANEL_WIDTH,
      maxWidth: CONTROL_PANEL_WIDTH
    });
    this.addChild(unitsControlPanel);

    // gravity slider
    const gravitySlider = new ControlSlider(underPressureModel.measureUnitsProperty, underPressureModel.gravityProperty, underPressureModel.getGravityString.bind(underPressureModel), underPressureModel.gravityRange, underPressureModel.gravityControlExpandedProperty, {
      right: resetAllButton.right,
      bottom: resetAllButton.top - 5,
      title: gravityString,
      decimals: 1,
      labelMaxWidth: 30,
      ticks: [{
        title: earthString,
        value: Constants.EARTH_GRAVITY
      }, {
        title: marsString,
        value: underPressureModel.gravityRange.min
      }, {
        title: jupiterString,
        value: underPressureModel.gravityRange.max
      }]
    });
    this.addChild(gravitySlider);

    // fluid density slider
    const fluidDensitySlider = new ControlSlider(underPressureModel.measureUnitsProperty, underPressureModel.fluidDensityProperty, underPressureModel.getFluidDensityString.bind(underPressureModel), underPressureModel.fluidDensityRange, underPressureModel.fluidDensityControlExpandedProperty, {
      right: resetAllButton.right,
      bottom: gravitySlider.top - 5,
      title: fluidDensityString,
      ticks: [{
        title: waterString,
        value: Constants.WATER_DENSITY
      }, {
        title: gasolineString,
        value: underPressureModel.fluidDensityRange.min
      }, {
        title: honeyString,
        value: underPressureModel.fluidDensityRange.max
      }]
    });
    this.addChild(fluidDensitySlider);

    // add the sensors panel
    const sensorPanel = new Rectangle(0, 0, 100, 130, 10, 10, {
      stroke: 'gray',
      lineWidth: 1,
      fill: '#f2fa6a',
      cornerRadius: CONTROL_PANEL_CORNER_RADIUS,
      right: controlPanel.left - 20,
      top: controlPanel.top
    });
    this.addChild(sensorPanel);
    this.resetActions = [];

    // add barometers within the sensor panel bounds
    _.each(underPressureModel.barometers, barometer => {
      const barometerLinkedProperties = [underPressureModel.currentSceneProperty, underPressureModel.gravityProperty, underPressureModel.fluidDensityProperty, underPressureModel.isAtmosphereProperty, underPressureModel.currentVolumeProperty];
      const barometerNode = new BarometerNode(modelViewTransform, barometer, underPressureModel.measureUnitsProperty, barometerLinkedProperties, underPressureModel.getPressureAtCoords.bind(underPressureModel), underPressureModel.getPressureString.bind(underPressureModel), sensorPanel.visibleBounds, this.layoutBounds, {
        scale: 1.5,
        pressureReadOffset: 51,
        // empirically determined distance between center and reading tip of the barometer
        minPressure: Constants.MIN_PRESSURE
      });
      toolsLayer.addChild(barometerNode);
    });
    const scenes = {};

    // adding square pool view
    const squarePoolView = new SquarePoolView(underPressureModel.sceneModels.square, modelViewTransform, this.layoutBounds);
    squarePoolView.visible = false;
    scenes.square = squarePoolView;
    this.addChild(squarePoolView);

    // adding trapezoid pool view
    const trapezoidPoolView = new TrapezoidPoolView(underPressureModel.sceneModels.trapezoid, modelViewTransform, this.layoutBounds);
    trapezoidPoolView.visible = false;
    scenes.trapezoid = trapezoidPoolView;
    this.addChild(trapezoidPoolView);

    // adding chamber pool view
    const chamberPoolView = new ChamberPoolView(underPressureModel.sceneModels.chamber, modelViewTransform, this.layoutBounds);
    chamberPoolView.visible = false;
    scenes.chamber = chamberPoolView;
    this.addChild(chamberPoolView);

    // adding mystery pool view
    const mysteryPoolView = new MysteryPoolView(underPressureModel.sceneModels.mystery, modelViewTransform, this.layoutBounds, unitsControlPanel.bottom, unitsControlPanel.left, fluidDensitySlider.top, fluidDensitySlider.left, unitsControlPanel.width);
    mysteryPoolView.visible = false;
    scenes.mystery = mysteryPoolView;
    this.addChild(mysteryPoolView);
    underPressureModel.mysteryChoiceProperty.link(choice => {
      if (underPressureModel.currentSceneProperty.value === 'mystery') {
        if (choice === 'gravity') {
          gravitySlider.disable();
          fluidDensitySlider.enable();
        } else {
          gravitySlider.enable();
          fluidDensitySlider.disable();
        }
      }
    });
    underPressureModel.currentSceneProperty.link(currentScene => {
      if (currentScene === 'mystery') {
        if (underPressureModel.mysteryChoiceProperty.value === 'gravity') {
          gravitySlider.disable();
        } else {
          fluidDensitySlider.disable();
        }
      } else {
        gravitySlider.enable();
        fluidDensitySlider.enable();
      }
    });
    this.addChild(new SceneChoiceNode(underPressureModel, {
      x: 10,
      y: 260
    }));

    //resize mystery control panel
    //mysteryPoolView.mysteryPoolControls.choicePanel.resizeWidth( controlPanel.width );
    //mysteryPoolView.mysteryPoolControls.choicePanel.right = gravitySlider.right;

    underPressureModel.currentSceneProperty.link((currentScene, previousScene) => {
      scenes[currentScene].visible = true;
      if (previousScene) {
        scenes[previousScene].visible = false;
      }
    });
    toolsLayer.addChild(new UnderPressureRuler(underPressureModel, modelViewTransform, this.layoutBounds));
    toolsLayer.moveToFront();
  }

  /**
   * @public
   */
  reset() {
    for (let i = 0; i < this.resetActions.length; i++) {
      this.resetActions[i]();
    }
  }
}
fluidPressureAndFlow.register('UnderPressureScreenView', UnderPressureScreenView);
export default UnderPressureScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWZWN0b3IyIiwiU2NyZWVuVmlldyIsIk1vZGVsVmlld1RyYW5zZm9ybTIiLCJSZXNldEFsbEJ1dHRvbiIsIk5vZGUiLCJSZWN0YW5nbGUiLCJDb25zdGFudHMiLCJCYXJvbWV0ZXJOb2RlIiwiQ29udHJvbFNsaWRlciIsIlVuaXRzQ29udHJvbFBhbmVsIiwiZmx1aWRQcmVzc3VyZUFuZEZsb3ciLCJGbHVpZFByZXNzdXJlQW5kRmxvd1N0cmluZ3MiLCJCYWNrZ3JvdW5kTm9kZSIsIkNoYW1iZXJQb29sVmlldyIsIkNvbnRyb2xQYW5lbCIsIk15c3RlcnlQb29sVmlldyIsIlNjZW5lQ2hvaWNlTm9kZSIsIlNxdWFyZVBvb2xWaWV3IiwiVHJhcGV6b2lkUG9vbFZpZXciLCJVbmRlclByZXNzdXJlUnVsZXIiLCJlYXJ0aFN0cmluZyIsImVhcnRoIiwiZmx1aWREZW5zaXR5U3RyaW5nIiwiZmx1aWREZW5zaXR5IiwiZ2Fzb2xpbmVTdHJpbmciLCJnYXNvbGluZSIsImdyYXZpdHlTdHJpbmciLCJncmF2aXR5IiwiaG9uZXlTdHJpbmciLCJob25leSIsImp1cGl0ZXJTdHJpbmciLCJqdXBpdGVyIiwibWFyc1N0cmluZyIsIm1hcnMiLCJ3YXRlclN0cmluZyIsIndhdGVyIiwiSU5TRVQiLCJDT05UUk9MX1BBTkVMX1dJRFRIIiwiQ09OVFJPTF9QQU5FTF9DT1JORVJfUkFESVVTIiwiQ09OVFJPTF9QQU5FTF9YX01BUkdJTiIsIlVuZGVyUHJlc3N1cmVTY3JlZW5WaWV3IiwiY29uc3RydWN0b3IiLCJ1bmRlclByZXNzdXJlTW9kZWwiLCJTQ1JFRU5fVklFV19PUFRJT05TIiwibW9kZWxWaWV3VHJhbnNmb3JtIiwiY3JlYXRlU2luZ2xlUG9pbnRTY2FsZUludmVydGVkWU1hcHBpbmciLCJaRVJPIiwiYWRkQ2hpbGQiLCJyZXNldEFsbEJ1dHRvbiIsImxpc3RlbmVyIiwicmVzZXQiLCJyYWRpdXMiLCJyaWdodCIsImxheW91dEJvdW5kcyIsImJvdHRvbSIsImNvbnRyb2xQYW5lbCIsInRvcCIsImNvcm5lclJhZGl1cyIsInhNYXJnaW4iLCJtaW5XaWR0aCIsIm1heFdpZHRoIiwidG9vbHNMYXllciIsInVuaXRzQ29udHJvbFBhbmVsIiwibWVhc3VyZVVuaXRzUHJvcGVydHkiLCJncmF2aXR5U2xpZGVyIiwiZ3Jhdml0eVByb3BlcnR5IiwiZ2V0R3Jhdml0eVN0cmluZyIsImJpbmQiLCJncmF2aXR5UmFuZ2UiLCJncmF2aXR5Q29udHJvbEV4cGFuZGVkUHJvcGVydHkiLCJ0aXRsZSIsImRlY2ltYWxzIiwibGFiZWxNYXhXaWR0aCIsInRpY2tzIiwidmFsdWUiLCJFQVJUSF9HUkFWSVRZIiwibWluIiwibWF4IiwiZmx1aWREZW5zaXR5U2xpZGVyIiwiZmx1aWREZW5zaXR5UHJvcGVydHkiLCJnZXRGbHVpZERlbnNpdHlTdHJpbmciLCJmbHVpZERlbnNpdHlSYW5nZSIsImZsdWlkRGVuc2l0eUNvbnRyb2xFeHBhbmRlZFByb3BlcnR5IiwiV0FURVJfREVOU0lUWSIsInNlbnNvclBhbmVsIiwic3Ryb2tlIiwibGluZVdpZHRoIiwiZmlsbCIsImxlZnQiLCJyZXNldEFjdGlvbnMiLCJfIiwiZWFjaCIsImJhcm9tZXRlcnMiLCJiYXJvbWV0ZXIiLCJiYXJvbWV0ZXJMaW5rZWRQcm9wZXJ0aWVzIiwiY3VycmVudFNjZW5lUHJvcGVydHkiLCJpc0F0bW9zcGhlcmVQcm9wZXJ0eSIsImN1cnJlbnRWb2x1bWVQcm9wZXJ0eSIsImJhcm9tZXRlck5vZGUiLCJnZXRQcmVzc3VyZUF0Q29vcmRzIiwiZ2V0UHJlc3N1cmVTdHJpbmciLCJ2aXNpYmxlQm91bmRzIiwic2NhbGUiLCJwcmVzc3VyZVJlYWRPZmZzZXQiLCJtaW5QcmVzc3VyZSIsIk1JTl9QUkVTU1VSRSIsInNjZW5lcyIsInNxdWFyZVBvb2xWaWV3Iiwic2NlbmVNb2RlbHMiLCJzcXVhcmUiLCJ2aXNpYmxlIiwidHJhcGV6b2lkUG9vbFZpZXciLCJ0cmFwZXpvaWQiLCJjaGFtYmVyUG9vbFZpZXciLCJjaGFtYmVyIiwibXlzdGVyeVBvb2xWaWV3IiwibXlzdGVyeSIsIndpZHRoIiwibXlzdGVyeUNob2ljZVByb3BlcnR5IiwibGluayIsImNob2ljZSIsImRpc2FibGUiLCJlbmFibGUiLCJjdXJyZW50U2NlbmUiLCJ4IiwieSIsInByZXZpb3VzU2NlbmUiLCJtb3ZlVG9Gcm9udCIsImkiLCJsZW5ndGgiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlVuZGVyUHJlc3N1cmVTY3JlZW5WaWV3LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDEzLTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqICBNYWluIHZpZXcgZm9yIHRoZSB1bmRlci1wcmVzc3VyZSBzY3JlZW4uIFRoZSB2aWV3IGNvbnRhaW5zIDQgc2NlbmVzOiBzcXVhcmUgcG9vbCwgY2hhbWJlciBwb29sLCB0cmFwZXpvaWQgYW5kIGFcclxuICogIG15c3RlcnkgcG9vbC4gVGhlcmUgaXMgYSBzY2VuZSBzZWxlY3RvciB0byBzd2l0Y2ggYmV0d2VlbiB0aGUgdmlld3MuIFRoZXJlIGFyZSBwYW5lbHMgdG8gY29udHJvbCB0aGUgZmx1aWQgZGVuc2l0eVxyXG4gKiAgYW5kIGdyYXZpdHkgYW5kIHRvb2xzIHRvIG1lYXN1cmUgcHJlc3N1cmUgYW5kIGxlbmd0aC4gU3VwcG9ydHMgdmlld2luZyB2YWx1ZXMgaW4gZW5nbGlzaCwgbWV0cmljIG9yIGF0bW9zcGhlcmUgdW5pdHMuXHJcbiAqXHJcbiAqIEBhdXRob3IgVmFzaWx5IFNoYWtob3YgKE1sZWFybmVyKVxyXG4gKiBAYXV0aG9yIFNpZGRoYXJ0aGEgQ2hpbnRoYXBhbGx5IChBY3R1YWwgQ29uY2VwdHMpLlxyXG4gKi9cclxuXHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IFNjcmVlblZpZXcgZnJvbSAnLi4vLi4vLi4vLi4vam9pc3QvanMvU2NyZWVuVmlldy5qcyc7XHJcbmltcG9ydCBNb2RlbFZpZXdUcmFuc2Zvcm0yIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdmlldy9Nb2RlbFZpZXdUcmFuc2Zvcm0yLmpzJztcclxuaW1wb3J0IFJlc2V0QWxsQnV0dG9uIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9idXR0b25zL1Jlc2V0QWxsQnV0dG9uLmpzJztcclxuaW1wb3J0IHsgTm9kZSwgUmVjdGFuZ2xlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IENvbnN0YW50cyBmcm9tICcuLi8uLi9jb21tb24vQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IEJhcm9tZXRlck5vZGUgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvQmFyb21ldGVyTm9kZS5qcyc7XHJcbmltcG9ydCBDb250cm9sU2xpZGVyIGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L0NvbnRyb2xTbGlkZXIuanMnO1xyXG5pbXBvcnQgVW5pdHNDb250cm9sUGFuZWwgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvVW5pdHNDb250cm9sUGFuZWwuanMnO1xyXG5pbXBvcnQgZmx1aWRQcmVzc3VyZUFuZEZsb3cgZnJvbSAnLi4vLi4vZmx1aWRQcmVzc3VyZUFuZEZsb3cuanMnO1xyXG5pbXBvcnQgRmx1aWRQcmVzc3VyZUFuZEZsb3dTdHJpbmdzIGZyb20gJy4uLy4uL0ZsdWlkUHJlc3N1cmVBbmRGbG93U3RyaW5ncy5qcyc7XHJcbmltcG9ydCBCYWNrZ3JvdW5kTm9kZSBmcm9tICcuL0JhY2tncm91bmROb2RlLmpzJztcclxuaW1wb3J0IENoYW1iZXJQb29sVmlldyBmcm9tICcuL0NoYW1iZXJQb29sVmlldy5qcyc7XHJcbmltcG9ydCBDb250cm9sUGFuZWwgZnJvbSAnLi9Db250cm9sUGFuZWwuanMnO1xyXG5pbXBvcnQgTXlzdGVyeVBvb2xWaWV3IGZyb20gJy4vTXlzdGVyeVBvb2xWaWV3LmpzJztcclxuaW1wb3J0IFNjZW5lQ2hvaWNlTm9kZSBmcm9tICcuL1NjZW5lQ2hvaWNlTm9kZS5qcyc7XHJcbmltcG9ydCBTcXVhcmVQb29sVmlldyBmcm9tICcuL1NxdWFyZVBvb2xWaWV3LmpzJztcclxuaW1wb3J0IFRyYXBlem9pZFBvb2xWaWV3IGZyb20gJy4vVHJhcGV6b2lkUG9vbFZpZXcuanMnO1xyXG5pbXBvcnQgVW5kZXJQcmVzc3VyZVJ1bGVyIGZyb20gJy4vVW5kZXJQcmVzc3VyZVJ1bGVyLmpzJztcclxuXHJcbmNvbnN0IGVhcnRoU3RyaW5nID0gRmx1aWRQcmVzc3VyZUFuZEZsb3dTdHJpbmdzLmVhcnRoO1xyXG5jb25zdCBmbHVpZERlbnNpdHlTdHJpbmcgPSBGbHVpZFByZXNzdXJlQW5kRmxvd1N0cmluZ3MuZmx1aWREZW5zaXR5O1xyXG5jb25zdCBnYXNvbGluZVN0cmluZyA9IEZsdWlkUHJlc3N1cmVBbmRGbG93U3RyaW5ncy5nYXNvbGluZTtcclxuY29uc3QgZ3Jhdml0eVN0cmluZyA9IEZsdWlkUHJlc3N1cmVBbmRGbG93U3RyaW5ncy5ncmF2aXR5O1xyXG5jb25zdCBob25leVN0cmluZyA9IEZsdWlkUHJlc3N1cmVBbmRGbG93U3RyaW5ncy5ob25leTtcclxuY29uc3QganVwaXRlclN0cmluZyA9IEZsdWlkUHJlc3N1cmVBbmRGbG93U3RyaW5ncy5qdXBpdGVyO1xyXG5jb25zdCBtYXJzU3RyaW5nID0gRmx1aWRQcmVzc3VyZUFuZEZsb3dTdHJpbmdzLm1hcnM7XHJcbmNvbnN0IHdhdGVyU3RyaW5nID0gRmx1aWRQcmVzc3VyZUFuZEZsb3dTdHJpbmdzLndhdGVyO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IElOU0VUID0gMTU7XHJcbmNvbnN0IENPTlRST0xfUEFORUxfV0lEVEggPSAxNDA7IC8vIGVtcGlyaWNhbGx5IGRldGVybWluZWQgdG8gbG9vayBnb29kIGFuZCBsZWF2ZSBzb21lIHNwYWNlIGZvciB0cmFuc2xhdGlvblxyXG5jb25zdCBDT05UUk9MX1BBTkVMX0NPUk5FUl9SQURJVVMgPSA3O1xyXG5jb25zdCBDT05UUk9MX1BBTkVMX1hfTUFSR0lOID0gNztcclxuXHJcbmNsYXNzIFVuZGVyUHJlc3N1cmVTY3JlZW5WaWV3IGV4dGVuZHMgU2NyZWVuVmlldyB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7VW5kZXJQcmVzc3VyZU1vZGVsfSB1bmRlclByZXNzdXJlTW9kZWxcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggdW5kZXJQcmVzc3VyZU1vZGVsICkge1xyXG5cclxuICAgIHN1cGVyKCBDb25zdGFudHMuU0NSRUVOX1ZJRVdfT1BUSU9OUyApO1xyXG5cclxuICAgIGNvbnN0IG1vZGVsVmlld1RyYW5zZm9ybSA9IE1vZGVsVmlld1RyYW5zZm9ybTIuY3JlYXRlU2luZ2xlUG9pbnRTY2FsZUludmVydGVkWU1hcHBpbmcoXHJcbiAgICAgIFZlY3RvcjIuWkVSTyxcclxuICAgICAgbmV3IFZlY3RvcjIoIDAsIDI0NSApLFxyXG4gICAgICA3MCApOyAgLy8xbSA9IDcwcHgsICgwLDApIC0gdG9wIGxlZnQgY29ybmVyXHJcblxyXG4gICAgLy9za3ksIGVhcnRoIGFuZCBjb250cm9sc1xyXG4gICAgdGhpcy5hZGRDaGlsZCggbmV3IEJhY2tncm91bmROb2RlKCB1bmRlclByZXNzdXJlTW9kZWwsIG1vZGVsVmlld1RyYW5zZm9ybSApICk7XHJcblxyXG4gICAgLy8gYWRkIHJlc2V0IGJ1dHRvblxyXG4gICAgY29uc3QgcmVzZXRBbGxCdXR0b24gPSBuZXcgUmVzZXRBbGxCdXR0b24oIHtcclxuICAgICAgbGlzdGVuZXI6ICgpID0+IHtcclxuICAgICAgICB1bmRlclByZXNzdXJlTW9kZWwucmVzZXQoKTtcclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHJhZGl1czogMTgsXHJcbiAgICAgIHJpZ2h0OiB0aGlzLmxheW91dEJvdW5kcy5yaWdodCAtIElOU0VULFxyXG4gICAgICBib3R0b206IHRoaXMubGF5b3V0Qm91bmRzLmJvdHRvbSAtIDVcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHJlc2V0QWxsQnV0dG9uICk7XHJcblxyXG4gICAgLy9jb250cm9sIHBhbmVsXHJcbiAgICBjb25zdCBjb250cm9sUGFuZWwgPSBuZXcgQ29udHJvbFBhbmVsKCB1bmRlclByZXNzdXJlTW9kZWwsIHtcclxuICAgICAgcmlnaHQ6IHJlc2V0QWxsQnV0dG9uLnJpZ2h0LFxyXG4gICAgICB0b3A6IDUsXHJcbiAgICAgIGNvcm5lclJhZGl1czogQ09OVFJPTF9QQU5FTF9DT1JORVJfUkFESVVTLFxyXG4gICAgICB4TWFyZ2luOiBDT05UUk9MX1BBTkVMX1hfTUFSR0lOLFxyXG4gICAgICBtaW5XaWR0aDogQ09OVFJPTF9QQU5FTF9XSURUSCxcclxuICAgICAgbWF4V2lkdGg6IENPTlRST0xfUEFORUxfV0lEVEhcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGNvbnRyb2xQYW5lbCApO1xyXG5cclxuICAgIC8vIGFsbCB0aGUgbW92YWJsZSB0b29scyBhcmUgYWRkZWQgdG8gdGhpcyBsYXllclxyXG4gICAgY29uc3QgdG9vbHNMYXllciA9IG5ldyBOb2RlKCk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0b29sc0xheWVyICk7XHJcblxyXG4gICAgLy8gdW5pdHMgcGFuZWxcclxuICAgIGNvbnN0IHVuaXRzQ29udHJvbFBhbmVsID0gbmV3IFVuaXRzQ29udHJvbFBhbmVsKCB1bmRlclByZXNzdXJlTW9kZWwubWVhc3VyZVVuaXRzUHJvcGVydHksIHtcclxuICAgICAgcmlnaHQ6IHJlc2V0QWxsQnV0dG9uLnJpZ2h0LFxyXG4gICAgICB0b3A6IGNvbnRyb2xQYW5lbC5ib3R0b20gKyA2LFxyXG4gICAgICBjb3JuZXJSYWRpdXM6IENPTlRST0xfUEFORUxfQ09STkVSX1JBRElVUyxcclxuICAgICAgeE1hcmdpbjogQ09OVFJPTF9QQU5FTF9YX01BUkdJTixcclxuICAgICAgbWluV2lkdGg6IENPTlRST0xfUEFORUxfV0lEVEgsXHJcbiAgICAgIG1heFdpZHRoOiBDT05UUk9MX1BBTkVMX1dJRFRIXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB1bml0c0NvbnRyb2xQYW5lbCApO1xyXG5cclxuICAgIC8vIGdyYXZpdHkgc2xpZGVyXHJcbiAgICBjb25zdCBncmF2aXR5U2xpZGVyID0gbmV3IENvbnRyb2xTbGlkZXIoXHJcbiAgICAgIHVuZGVyUHJlc3N1cmVNb2RlbC5tZWFzdXJlVW5pdHNQcm9wZXJ0eSxcclxuICAgICAgdW5kZXJQcmVzc3VyZU1vZGVsLmdyYXZpdHlQcm9wZXJ0eSxcclxuICAgICAgdW5kZXJQcmVzc3VyZU1vZGVsLmdldEdyYXZpdHlTdHJpbmcuYmluZCggdW5kZXJQcmVzc3VyZU1vZGVsICksXHJcbiAgICAgIHVuZGVyUHJlc3N1cmVNb2RlbC5ncmF2aXR5UmFuZ2UsXHJcbiAgICAgIHVuZGVyUHJlc3N1cmVNb2RlbC5ncmF2aXR5Q29udHJvbEV4cGFuZGVkUHJvcGVydHksIHtcclxuICAgICAgICByaWdodDogcmVzZXRBbGxCdXR0b24ucmlnaHQsXHJcbiAgICAgICAgYm90dG9tOiByZXNldEFsbEJ1dHRvbi50b3AgLSA1LFxyXG4gICAgICAgIHRpdGxlOiBncmF2aXR5U3RyaW5nLFxyXG4gICAgICAgIGRlY2ltYWxzOiAxLFxyXG4gICAgICAgIGxhYmVsTWF4V2lkdGg6IDMwLFxyXG4gICAgICAgIHRpY2tzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHRpdGxlOiBlYXJ0aFN0cmluZyxcclxuICAgICAgICAgICAgdmFsdWU6IENvbnN0YW50cy5FQVJUSF9HUkFWSVRZXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB0aXRsZTogbWFyc1N0cmluZyxcclxuICAgICAgICAgICAgdmFsdWU6IHVuZGVyUHJlc3N1cmVNb2RlbC5ncmF2aXR5UmFuZ2UubWluXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB0aXRsZToganVwaXRlclN0cmluZyxcclxuICAgICAgICAgICAgdmFsdWU6IHVuZGVyUHJlc3N1cmVNb2RlbC5ncmF2aXR5UmFuZ2UubWF4XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggZ3Jhdml0eVNsaWRlciApO1xyXG5cclxuICAgIC8vIGZsdWlkIGRlbnNpdHkgc2xpZGVyXHJcbiAgICBjb25zdCBmbHVpZERlbnNpdHlTbGlkZXIgPSBuZXcgQ29udHJvbFNsaWRlcihcclxuICAgICAgdW5kZXJQcmVzc3VyZU1vZGVsLm1lYXN1cmVVbml0c1Byb3BlcnR5LFxyXG4gICAgICB1bmRlclByZXNzdXJlTW9kZWwuZmx1aWREZW5zaXR5UHJvcGVydHksXHJcbiAgICAgIHVuZGVyUHJlc3N1cmVNb2RlbC5nZXRGbHVpZERlbnNpdHlTdHJpbmcuYmluZCggdW5kZXJQcmVzc3VyZU1vZGVsICksXHJcbiAgICAgIHVuZGVyUHJlc3N1cmVNb2RlbC5mbHVpZERlbnNpdHlSYW5nZSxcclxuICAgICAgdW5kZXJQcmVzc3VyZU1vZGVsLmZsdWlkRGVuc2l0eUNvbnRyb2xFeHBhbmRlZFByb3BlcnR5LCB7XHJcbiAgICAgICAgcmlnaHQ6IHJlc2V0QWxsQnV0dG9uLnJpZ2h0LFxyXG4gICAgICAgIGJvdHRvbTogZ3Jhdml0eVNsaWRlci50b3AgLSA1LFxyXG5cclxuICAgICAgICB0aXRsZTogZmx1aWREZW5zaXR5U3RyaW5nLFxyXG4gICAgICAgIHRpY2tzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHRpdGxlOiB3YXRlclN0cmluZyxcclxuICAgICAgICAgICAgdmFsdWU6IENvbnN0YW50cy5XQVRFUl9ERU5TSVRZXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB0aXRsZTogZ2Fzb2xpbmVTdHJpbmcsXHJcbiAgICAgICAgICAgIHZhbHVlOiB1bmRlclByZXNzdXJlTW9kZWwuZmx1aWREZW5zaXR5UmFuZ2UubWluXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB0aXRsZTogaG9uZXlTdHJpbmcsXHJcbiAgICAgICAgICAgIHZhbHVlOiB1bmRlclByZXNzdXJlTW9kZWwuZmx1aWREZW5zaXR5UmFuZ2UubWF4XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBmbHVpZERlbnNpdHlTbGlkZXIgKTtcclxuXHJcbiAgICAvLyBhZGQgdGhlIHNlbnNvcnMgcGFuZWxcclxuICAgIGNvbnN0IHNlbnNvclBhbmVsID0gbmV3IFJlY3RhbmdsZSggMCwgMCwgMTAwLCAxMzAsIDEwLCAxMCwge1xyXG4gICAgICBzdHJva2U6ICdncmF5JyxcclxuICAgICAgbGluZVdpZHRoOiAxLFxyXG4gICAgICBmaWxsOiAnI2YyZmE2YScsXHJcbiAgICAgIGNvcm5lclJhZGl1czogQ09OVFJPTF9QQU5FTF9DT1JORVJfUkFESVVTLFxyXG4gICAgICByaWdodDogY29udHJvbFBhbmVsLmxlZnQgLSAyMCxcclxuICAgICAgdG9wOiBjb250cm9sUGFuZWwudG9wXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBzZW5zb3JQYW5lbCApO1xyXG5cclxuICAgIHRoaXMucmVzZXRBY3Rpb25zID0gW107XHJcblxyXG4gICAgLy8gYWRkIGJhcm9tZXRlcnMgd2l0aGluIHRoZSBzZW5zb3IgcGFuZWwgYm91bmRzXHJcbiAgICBfLmVhY2goIHVuZGVyUHJlc3N1cmVNb2RlbC5iYXJvbWV0ZXJzLCBiYXJvbWV0ZXIgPT4ge1xyXG4gICAgICBjb25zdCBiYXJvbWV0ZXJMaW5rZWRQcm9wZXJ0aWVzID0gW1xyXG4gICAgICAgIHVuZGVyUHJlc3N1cmVNb2RlbC5jdXJyZW50U2NlbmVQcm9wZXJ0eSxcclxuICAgICAgICB1bmRlclByZXNzdXJlTW9kZWwuZ3Jhdml0eVByb3BlcnR5LFxyXG4gICAgICAgIHVuZGVyUHJlc3N1cmVNb2RlbC5mbHVpZERlbnNpdHlQcm9wZXJ0eSxcclxuICAgICAgICB1bmRlclByZXNzdXJlTW9kZWwuaXNBdG1vc3BoZXJlUHJvcGVydHksXHJcbiAgICAgICAgdW5kZXJQcmVzc3VyZU1vZGVsLmN1cnJlbnRWb2x1bWVQcm9wZXJ0eVxyXG4gICAgICBdO1xyXG4gICAgICBjb25zdCBiYXJvbWV0ZXJOb2RlID0gbmV3IEJhcm9tZXRlck5vZGUoXHJcbiAgICAgICAgbW9kZWxWaWV3VHJhbnNmb3JtLFxyXG4gICAgICAgIGJhcm9tZXRlcixcclxuICAgICAgICB1bmRlclByZXNzdXJlTW9kZWwubWVhc3VyZVVuaXRzUHJvcGVydHksXHJcbiAgICAgICAgYmFyb21ldGVyTGlua2VkUHJvcGVydGllcyxcclxuICAgICAgICB1bmRlclByZXNzdXJlTW9kZWwuZ2V0UHJlc3N1cmVBdENvb3Jkcy5iaW5kKCB1bmRlclByZXNzdXJlTW9kZWwgKSxcclxuICAgICAgICB1bmRlclByZXNzdXJlTW9kZWwuZ2V0UHJlc3N1cmVTdHJpbmcuYmluZCggdW5kZXJQcmVzc3VyZU1vZGVsICksXHJcbiAgICAgICAgc2Vuc29yUGFuZWwudmlzaWJsZUJvdW5kcyxcclxuICAgICAgICB0aGlzLmxheW91dEJvdW5kcyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzY2FsZTogMS41LFxyXG4gICAgICAgICAgcHJlc3N1cmVSZWFkT2Zmc2V0OiA1MSwgLy8gZW1waXJpY2FsbHkgZGV0ZXJtaW5lZCBkaXN0YW5jZSBiZXR3ZWVuIGNlbnRlciBhbmQgcmVhZGluZyB0aXAgb2YgdGhlIGJhcm9tZXRlclxyXG4gICAgICAgICAgbWluUHJlc3N1cmU6IENvbnN0YW50cy5NSU5fUFJFU1NVUkVcclxuICAgICAgICB9ICk7XHJcbiAgICAgIHRvb2xzTGF5ZXIuYWRkQ2hpbGQoIGJhcm9tZXRlck5vZGUgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBzY2VuZXMgPSB7fTtcclxuXHJcbiAgICAvLyBhZGRpbmcgc3F1YXJlIHBvb2wgdmlld1xyXG4gICAgY29uc3Qgc3F1YXJlUG9vbFZpZXcgPSBuZXcgU3F1YXJlUG9vbFZpZXcoIHVuZGVyUHJlc3N1cmVNb2RlbC5zY2VuZU1vZGVscy5zcXVhcmUsIG1vZGVsVmlld1RyYW5zZm9ybSxcclxuICAgICAgdGhpcy5sYXlvdXRCb3VuZHMgKTtcclxuICAgIHNxdWFyZVBvb2xWaWV3LnZpc2libGUgPSBmYWxzZTtcclxuICAgIHNjZW5lcy5zcXVhcmUgPSBzcXVhcmVQb29sVmlldztcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHNxdWFyZVBvb2xWaWV3ICk7XHJcblxyXG4gICAgLy8gYWRkaW5nIHRyYXBlem9pZCBwb29sIHZpZXdcclxuICAgIGNvbnN0IHRyYXBlem9pZFBvb2xWaWV3ID0gbmV3IFRyYXBlem9pZFBvb2xWaWV3KCB1bmRlclByZXNzdXJlTW9kZWwuc2NlbmVNb2RlbHMudHJhcGV6b2lkLCBtb2RlbFZpZXdUcmFuc2Zvcm0sXHJcbiAgICAgIHRoaXMubGF5b3V0Qm91bmRzICk7XHJcbiAgICB0cmFwZXpvaWRQb29sVmlldy52aXNpYmxlID0gZmFsc2U7XHJcbiAgICBzY2VuZXMudHJhcGV6b2lkID0gdHJhcGV6b2lkUG9vbFZpZXc7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0cmFwZXpvaWRQb29sVmlldyApO1xyXG5cclxuICAgIC8vIGFkZGluZyBjaGFtYmVyIHBvb2wgdmlld1xyXG4gICAgY29uc3QgY2hhbWJlclBvb2xWaWV3ID0gbmV3IENoYW1iZXJQb29sVmlldyggdW5kZXJQcmVzc3VyZU1vZGVsLnNjZW5lTW9kZWxzLmNoYW1iZXIsIG1vZGVsVmlld1RyYW5zZm9ybSxcclxuICAgICAgdGhpcy5sYXlvdXRCb3VuZHMgKTtcclxuICAgIGNoYW1iZXJQb29sVmlldy52aXNpYmxlID0gZmFsc2U7XHJcbiAgICBzY2VuZXMuY2hhbWJlciA9IGNoYW1iZXJQb29sVmlldztcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGNoYW1iZXJQb29sVmlldyApO1xyXG5cclxuICAgIC8vIGFkZGluZyBteXN0ZXJ5IHBvb2wgdmlld1xyXG4gICAgY29uc3QgbXlzdGVyeVBvb2xWaWV3ID0gbmV3IE15c3RlcnlQb29sVmlldyggdW5kZXJQcmVzc3VyZU1vZGVsLnNjZW5lTW9kZWxzLm15c3RlcnksIG1vZGVsVmlld1RyYW5zZm9ybSxcclxuICAgICAgdGhpcy5sYXlvdXRCb3VuZHMsIHVuaXRzQ29udHJvbFBhbmVsLmJvdHRvbSwgdW5pdHNDb250cm9sUGFuZWwubGVmdCwgZmx1aWREZW5zaXR5U2xpZGVyLnRvcCxcclxuICAgICAgZmx1aWREZW5zaXR5U2xpZGVyLmxlZnQsIHVuaXRzQ29udHJvbFBhbmVsLndpZHRoICk7XHJcbiAgICBteXN0ZXJ5UG9vbFZpZXcudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgc2NlbmVzLm15c3RlcnkgPSBteXN0ZXJ5UG9vbFZpZXc7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBteXN0ZXJ5UG9vbFZpZXcgKTtcclxuXHJcbiAgICB1bmRlclByZXNzdXJlTW9kZWwubXlzdGVyeUNob2ljZVByb3BlcnR5LmxpbmsoIGNob2ljZSA9PiB7XHJcbiAgICAgIGlmICggdW5kZXJQcmVzc3VyZU1vZGVsLmN1cnJlbnRTY2VuZVByb3BlcnR5LnZhbHVlID09PSAnbXlzdGVyeScgKSB7XHJcbiAgICAgICAgaWYgKCBjaG9pY2UgPT09ICdncmF2aXR5JyApIHtcclxuICAgICAgICAgIGdyYXZpdHlTbGlkZXIuZGlzYWJsZSgpO1xyXG4gICAgICAgICAgZmx1aWREZW5zaXR5U2xpZGVyLmVuYWJsZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIGdyYXZpdHlTbGlkZXIuZW5hYmxlKCk7XHJcbiAgICAgICAgICBmbHVpZERlbnNpdHlTbGlkZXIuZGlzYWJsZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIHVuZGVyUHJlc3N1cmVNb2RlbC5jdXJyZW50U2NlbmVQcm9wZXJ0eS5saW5rKCBjdXJyZW50U2NlbmUgPT4ge1xyXG4gICAgICBpZiAoIGN1cnJlbnRTY2VuZSA9PT0gJ215c3RlcnknICkge1xyXG4gICAgICAgIGlmICggdW5kZXJQcmVzc3VyZU1vZGVsLm15c3RlcnlDaG9pY2VQcm9wZXJ0eS52YWx1ZSA9PT0gJ2dyYXZpdHknICkge1xyXG4gICAgICAgICAgZ3Jhdml0eVNsaWRlci5kaXNhYmxlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgZmx1aWREZW5zaXR5U2xpZGVyLmRpc2FibGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgZ3Jhdml0eVNsaWRlci5lbmFibGUoKTtcclxuICAgICAgICBmbHVpZERlbnNpdHlTbGlkZXIuZW5hYmxlKCk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKCBuZXcgU2NlbmVDaG9pY2VOb2RlKCB1bmRlclByZXNzdXJlTW9kZWwsIHsgeDogMTAsIHk6IDI2MCB9ICkgKTtcclxuXHJcbiAgICAvL3Jlc2l6ZSBteXN0ZXJ5IGNvbnRyb2wgcGFuZWxcclxuICAgIC8vbXlzdGVyeVBvb2xWaWV3Lm15c3RlcnlQb29sQ29udHJvbHMuY2hvaWNlUGFuZWwucmVzaXplV2lkdGgoIGNvbnRyb2xQYW5lbC53aWR0aCApO1xyXG4gICAgLy9teXN0ZXJ5UG9vbFZpZXcubXlzdGVyeVBvb2xDb250cm9scy5jaG9pY2VQYW5lbC5yaWdodCA9IGdyYXZpdHlTbGlkZXIucmlnaHQ7XHJcblxyXG4gICAgdW5kZXJQcmVzc3VyZU1vZGVsLmN1cnJlbnRTY2VuZVByb3BlcnR5LmxpbmsoICggY3VycmVudFNjZW5lLCBwcmV2aW91c1NjZW5lICkgPT4ge1xyXG4gICAgICBzY2VuZXNbIGN1cnJlbnRTY2VuZSBdLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICBpZiAoIHByZXZpb3VzU2NlbmUgKSB7XHJcbiAgICAgICAgc2NlbmVzWyBwcmV2aW91c1NjZW5lIF0udmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgdG9vbHNMYXllci5hZGRDaGlsZCggbmV3IFVuZGVyUHJlc3N1cmVSdWxlciggdW5kZXJQcmVzc3VyZU1vZGVsLCBtb2RlbFZpZXdUcmFuc2Zvcm0sIHRoaXMubGF5b3V0Qm91bmRzICkgKTtcclxuICAgIHRvb2xzTGF5ZXIubW92ZVRvRnJvbnQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICByZXNldCgpIHtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHRoaXMucmVzZXRBY3Rpb25zLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICB0aGlzLnJlc2V0QWN0aW9uc1sgaSBdKCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5mbHVpZFByZXNzdXJlQW5kRmxvdy5yZWdpc3RlciggJ1VuZGVyUHJlc3N1cmVTY3JlZW5WaWV3JywgVW5kZXJQcmVzc3VyZVNjcmVlblZpZXcgKTtcclxuZXhwb3J0IGRlZmF1bHQgVW5kZXJQcmVzc3VyZVNjcmVlblZpZXc7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsT0FBT0MsVUFBVSxNQUFNLG9DQUFvQztBQUMzRCxPQUFPQyxtQkFBbUIsTUFBTSx1REFBdUQ7QUFDdkYsT0FBT0MsY0FBYyxNQUFNLHVEQUF1RDtBQUNsRixTQUFTQyxJQUFJLEVBQUVDLFNBQVMsUUFBUSxtQ0FBbUM7QUFDbkUsT0FBT0MsU0FBUyxNQUFNLDJCQUEyQjtBQUNqRCxPQUFPQyxhQUFhLE1BQU0sb0NBQW9DO0FBQzlELE9BQU9DLGFBQWEsTUFBTSxvQ0FBb0M7QUFDOUQsT0FBT0MsaUJBQWlCLE1BQU0sd0NBQXdDO0FBQ3RFLE9BQU9DLG9CQUFvQixNQUFNLCtCQUErQjtBQUNoRSxPQUFPQywyQkFBMkIsTUFBTSxzQ0FBc0M7QUFD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