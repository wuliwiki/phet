// Copyright 2014-2022, University of Colorado Boulder

/**
 * View for the pipe consisting of the right and left pipe heads and a flexible middle pipe created using splines.
 *
 * @author Siddhartha Chinthapally (Actual Concepts).
 */

import Bounds2 from '../../../../dot/js/Bounds2.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import { Shape } from '../../../../kite/js/imports.js';
import { Image, Node, Path } from '../../../../scenery/js/imports.js';
import pipeLeftBack_png from '../../../images/pipeLeftBack_png.js';
import pipeLeftFront_png from '../../../images/pipeLeftFront_png.js';
import pipeRight_png from '../../../images/pipeRight_png.js';
import pipeSegment_png from '../../../images/pipeSegment_png.js';
import fluidPressureAndFlow from '../../fluidPressureAndFlow.js';
import ParticleCanvasNode from './ParticleCanvasNode.js';

// constants
const LINE_COLOR = '#613705';
const PIPE_INITIAL_SCALE = 0.36;

// For stretching the pipes off the screen to the left and the right, see #225
const PIPE_SEGMENT_X_SCALE = 100;
class PipeNode extends Node {
  /**
   * @param {FlowModel} flowModel of the simulation.
   * @param {Pipe} pipe model for this pipe node
   * @param {ModelViewTransform2} modelViewTransform to convert between model and view co-ordinate frames
   * @param {Bounds2} layoutBounds of the simulation
   */
  constructor(flowModel, modelViewTransform, layoutBounds) {
    super();
    this.flowModel = flowModel;
    this.modelViewTransform = modelViewTransform;
    this.layoutBounds = layoutBounds;
    this.leftPipeYOffset = 30; // left pipe top offset w.r.t the left top control point
    this.rightPipeYOffset = 30; // right pipe top offset w.r.t the right top control point
    this.rightPipeLeftOffset = 75;
    const leftPipeX = -49;

    //left side pipe image.
    const leftPipeHead = new Image(pipeLeftFront_png);
    const leftPipeSegment = new Image(pipeSegment_png, {
      right: leftPipeHead.left + 30,
      scale: new Vector2(PIPE_SEGMENT_X_SCALE, 1)
    });
    this.leftPipeNode = new Node({
      children: [leftPipeHead, leftPipeSegment],
      x: leftPipeX,
      y: flowModel.pipe.leftPipeYPositionProperty.value,
      scale: flowModel.pipe.leftPipeScaleProperty.value
    });
    this.leftPipeBackNode = new Image(pipeLeftBack_png, {
      x: leftPipeX,
      y: flowModel.pipe.leftPipeYPositionProperty.value,
      scale: flowModel.pipe.leftPipeScaleProperty.value
    });

    // shape for the pipelines
    this.pipeFlowLine = new Path(null, {
      stroke: LINE_COLOR,
      lineWidth: 6
    });

    // Shape for fluid. Although this is identical in "shape" to pipeFlowLine, a separate node is used to layer
    // the particles between fluid and the pipelines so that they appear on top of fluid and don't protrude over the pipe.
    // See https://github.com/phetsims/fluid-pressure-and-flow/issues/183
    this.pipeFluidNode = new Path(null, {
      stroke: LINE_COLOR,
      lineWidth: 0,
      fill: flowModel.fluidColorModel.colorProperty.value
    });

    // Skip bounds computation to improve performance, see energy-skate-park-basics#245
    // Qualitative tests did not show a significant improvement
    const emptyBounds = new Bounds2(0, 0, 0, 0);
    this.pipeFluidNode.computeShapeBounds = () => {
      return emptyBounds;
    };

    // right side pipe image.
    const rightPipeHead = new Image(pipeRight_png);
    const rightPipeMiddle = new Image(pipeSegment_png, {
      left: rightPipeHead.right - 50,
      scale: new Vector2(PIPE_SEGMENT_X_SCALE, 1)
    });
    this.rightPipeNode = new Node({
      children: [rightPipeHead, rightPipeMiddle],
      x: layoutBounds.maxX - this.rightPipeLeftOffset,
      y: flowModel.pipe.rightPipeYPositionProperty.value,
      scale: flowModel.pipe.rightPipeScaleProperty.value
    });

    // order of different layers within pipe Node -- leftPipeBackNode, pipeFluidNode, preParticleLayer, pipeFlowLine,
    // leftPipeNode and rightPipeNode
    this.addChild(this.leftPipeBackNode);
    this.addChild(this.pipeFluidNode);
    this.preParticleLayer = new Node();
    this.addChild(this.preParticleLayer);
    this.particlesLayer = new ParticleCanvasNode(flowModel.flowParticles, flowModel.gridParticles, modelViewTransform, {
      canvasBounds: new Bounds2(20, 80, 800, 600)
    });
    this.addChild(this.particlesLayer);
    this.addChild(this.pipeFlowLine);
    this.addChild(this.rightPipeNode);
    this.addChild(this.leftPipeNode);

    // link the left/right pipe scale properties to the left/right pipe nodes
    flowModel.pipe.leftPipeScaleProperty.link(scale => {
      this.leftPipeNode.setScaleMagnitude(PIPE_INITIAL_SCALE, scale);
      this.leftPipeBackNode.setScaleMagnitude(PIPE_INITIAL_SCALE, scale);
    });
    flowModel.pipe.rightPipeScaleProperty.link(scale => {
      this.rightPipeNode.setScaleMagnitude(PIPE_INITIAL_SCALE, scale);
    });

    // link the left/right pipe position properties to the left/right pipe nodes
    flowModel.pipe.leftPipeYPositionProperty.linkAttribute(this.leftPipeNode, 'y');
    flowModel.pipe.leftPipeYPositionProperty.linkAttribute(this.leftPipeBackNode, 'y');
    flowModel.pipe.rightPipeYPositionProperty.linkAttribute(this.rightPipeNode, 'y');
    flowModel.fluidColorModel.colorProperty.linkAttribute(this.pipeFluidNode, 'fill');

    // init the flexible middle pipe flow line shape
    this.updatePipeFlowLineShape();
  }

  /**
   * update the pipe flow line shape (the flexible middle pipe)
   * @private
   */
  updatePipeFlowLineShape() {
    // getting cross sections
    const splineCrossSections = this.flowModel.pipe.getSplineCrossSections();
    const xPointsBottom = new Array(splineCrossSections.length);
    const yPointsBottom = new Array(splineCrossSections.length);
    const xPointsTop = new Array(splineCrossSections.length);
    const yPointsTop = new Array(splineCrossSections.length);
    const minXOfPipeFlowLineShape = -6.7; // model value
    const maxXOfPipeFlowLineShape = 6.7;
    let startIndex = 0;
    let endIndex = 0;

    //  points for lineTo
    for (let i = 0; i < splineCrossSections.length; i++) {
      xPointsBottom[i] = splineCrossSections[i].x;
      yPointsBottom[i] = splineCrossSections[i].yBottom;
      xPointsTop[i] = splineCrossSections[i].x;
      yPointsTop[i] = splineCrossSections[i].yTop;
      if (splineCrossSections[i].x <= minXOfPipeFlowLineShape) {
        startIndex = i;
      }
      if (splineCrossSections[i].x <= maxXOfPipeFlowLineShape) {
        endIndex = i;
      }
    }
    const flowLineShape = new Shape().moveTo(this.modelViewTransform.modelToViewX(xPointsBottom[startIndex + 1]), this.modelViewTransform.modelToViewY(yPointsBottom[startIndex + 1]));

    // Spline points beyond the last pipe cross section are not needed.
    for (let i = startIndex + 2; i <= endIndex; i++) {
      flowLineShape.lineTo(this.modelViewTransform.modelToViewX(xPointsBottom[i]), this.modelViewTransform.modelToViewY(yPointsBottom[i]));
    }

    // Spline points beyond the last pipe cross section are not needed.
    for (let i = endIndex; i > startIndex; i--) {
      flowLineShape.lineTo(this.modelViewTransform.modelToViewX(xPointsTop[i]), this.modelViewTransform.modelToViewY(yPointsTop[i]));
    }
    this.pipeFlowLine.shape = flowLineShape;
    this.pipeFluidNode.shape = flowLineShape;
  }

  /**
   * @public
   */
  reset() {
    // mark pipe as dirty for getting new spline cross sections
    this.flowModel.pipe.dirty = true;
    this.updatePipeFlowLineShape();
    this.flowModel.fluxMeter.updateEmitter.emit();
  }
}
fluidPressureAndFlow.register('PipeNode', PipeNode);
export default PipeNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb3VuZHMyIiwiVmVjdG9yMiIsIlNoYXBlIiwiSW1hZ2UiLCJOb2RlIiwiUGF0aCIsInBpcGVMZWZ0QmFja19wbmciLCJwaXBlTGVmdEZyb250X3BuZyIsInBpcGVSaWdodF9wbmciLCJwaXBlU2VnbWVudF9wbmciLCJmbHVpZFByZXNzdXJlQW5kRmxvdyIsIlBhcnRpY2xlQ2FudmFzTm9kZSIsIkxJTkVfQ09MT1IiLCJQSVBFX0lOSVRJQUxfU0NBTEUiLCJQSVBFX1NFR01FTlRfWF9TQ0FMRSIsIlBpcGVOb2RlIiwiY29uc3RydWN0b3IiLCJmbG93TW9kZWwiLCJtb2RlbFZpZXdUcmFuc2Zvcm0iLCJsYXlvdXRCb3VuZHMiLCJsZWZ0UGlwZVlPZmZzZXQiLCJyaWdodFBpcGVZT2Zmc2V0IiwicmlnaHRQaXBlTGVmdE9mZnNldCIsImxlZnRQaXBlWCIsImxlZnRQaXBlSGVhZCIsImxlZnRQaXBlU2VnbWVudCIsInJpZ2h0IiwibGVmdCIsInNjYWxlIiwibGVmdFBpcGVOb2RlIiwiY2hpbGRyZW4iLCJ4IiwieSIsInBpcGUiLCJsZWZ0UGlwZVlQb3NpdGlvblByb3BlcnR5IiwidmFsdWUiLCJsZWZ0UGlwZVNjYWxlUHJvcGVydHkiLCJsZWZ0UGlwZUJhY2tOb2RlIiwicGlwZUZsb3dMaW5lIiwic3Ryb2tlIiwibGluZVdpZHRoIiwicGlwZUZsdWlkTm9kZSIsImZpbGwiLCJmbHVpZENvbG9yTW9kZWwiLCJjb2xvclByb3BlcnR5IiwiZW1wdHlCb3VuZHMiLCJjb21wdXRlU2hhcGVCb3VuZHMiLCJyaWdodFBpcGVIZWFkIiwicmlnaHRQaXBlTWlkZGxlIiwicmlnaHRQaXBlTm9kZSIsIm1heFgiLCJyaWdodFBpcGVZUG9zaXRpb25Qcm9wZXJ0eSIsInJpZ2h0UGlwZVNjYWxlUHJvcGVydHkiLCJhZGRDaGlsZCIsInByZVBhcnRpY2xlTGF5ZXIiLCJwYXJ0aWNsZXNMYXllciIsImZsb3dQYXJ0aWNsZXMiLCJncmlkUGFydGljbGVzIiwiY2FudmFzQm91bmRzIiwibGluayIsInNldFNjYWxlTWFnbml0dWRlIiwibGlua0F0dHJpYnV0ZSIsInVwZGF0ZVBpcGVGbG93TGluZVNoYXBlIiwic3BsaW5lQ3Jvc3NTZWN0aW9ucyIsImdldFNwbGluZUNyb3NzU2VjdGlvbnMiLCJ4UG9pbnRzQm90dG9tIiwiQXJyYXkiLCJsZW5ndGgiLCJ5UG9pbnRzQm90dG9tIiwieFBvaW50c1RvcCIsInlQb2ludHNUb3AiLCJtaW5YT2ZQaXBlRmxvd0xpbmVTaGFwZSIsIm1heFhPZlBpcGVGbG93TGluZVNoYXBlIiwic3RhcnRJbmRleCIsImVuZEluZGV4IiwiaSIsInlCb3R0b20iLCJ5VG9wIiwiZmxvd0xpbmVTaGFwZSIsIm1vdmVUbyIsIm1vZGVsVG9WaWV3WCIsIm1vZGVsVG9WaWV3WSIsImxpbmVUbyIsInNoYXBlIiwicmVzZXQiLCJkaXJ0eSIsImZsdXhNZXRlciIsInVwZGF0ZUVtaXR0ZXIiLCJlbWl0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJQaXBlTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBWaWV3IGZvciB0aGUgcGlwZSBjb25zaXN0aW5nIG9mIHRoZSByaWdodCBhbmQgbGVmdCBwaXBlIGhlYWRzIGFuZCBhIGZsZXhpYmxlIG1pZGRsZSBwaXBlIGNyZWF0ZWQgdXNpbmcgc3BsaW5lcy5cclxuICpcclxuICogQGF1dGhvciBTaWRkaGFydGhhIENoaW50aGFwYWxseSAoQWN0dWFsIENvbmNlcHRzKS5cclxuICovXHJcblxyXG5pbXBvcnQgQm91bmRzMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvQm91bmRzMi5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgeyBJbWFnZSwgTm9kZSwgUGF0aCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBwaXBlTGVmdEJhY2tfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9waXBlTGVmdEJhY2tfcG5nLmpzJztcclxuaW1wb3J0IHBpcGVMZWZ0RnJvbnRfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9waXBlTGVmdEZyb250X3BuZy5qcyc7XHJcbmltcG9ydCBwaXBlUmlnaHRfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9waXBlUmlnaHRfcG5nLmpzJztcclxuaW1wb3J0IHBpcGVTZWdtZW50X3BuZyBmcm9tICcuLi8uLi8uLi9pbWFnZXMvcGlwZVNlZ21lbnRfcG5nLmpzJztcclxuaW1wb3J0IGZsdWlkUHJlc3N1cmVBbmRGbG93IGZyb20gJy4uLy4uL2ZsdWlkUHJlc3N1cmVBbmRGbG93LmpzJztcclxuaW1wb3J0IFBhcnRpY2xlQ2FudmFzTm9kZSBmcm9tICcuL1BhcnRpY2xlQ2FudmFzTm9kZS5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgTElORV9DT0xPUiA9ICcjNjEzNzA1JztcclxuY29uc3QgUElQRV9JTklUSUFMX1NDQUxFID0gMC4zNjtcclxuXHJcbi8vIEZvciBzdHJldGNoaW5nIHRoZSBwaXBlcyBvZmYgdGhlIHNjcmVlbiB0byB0aGUgbGVmdCBhbmQgdGhlIHJpZ2h0LCBzZWUgIzIyNVxyXG5jb25zdCBQSVBFX1NFR01FTlRfWF9TQ0FMRSA9IDEwMDtcclxuXHJcbmNsYXNzIFBpcGVOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7Rmxvd01vZGVsfSBmbG93TW9kZWwgb2YgdGhlIHNpbXVsYXRpb24uXHJcbiAgICogQHBhcmFtIHtQaXBlfSBwaXBlIG1vZGVsIGZvciB0aGlzIHBpcGUgbm9kZVxyXG4gICAqIEBwYXJhbSB7TW9kZWxWaWV3VHJhbnNmb3JtMn0gbW9kZWxWaWV3VHJhbnNmb3JtIHRvIGNvbnZlcnQgYmV0d2VlbiBtb2RlbCBhbmQgdmlldyBjby1vcmRpbmF0ZSBmcmFtZXNcclxuICAgKiBAcGFyYW0ge0JvdW5kczJ9IGxheW91dEJvdW5kcyBvZiB0aGUgc2ltdWxhdGlvblxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBmbG93TW9kZWwsIG1vZGVsVmlld1RyYW5zZm9ybSwgbGF5b3V0Qm91bmRzICkge1xyXG5cclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgdGhpcy5mbG93TW9kZWwgPSBmbG93TW9kZWw7XHJcbiAgICB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybSA9IG1vZGVsVmlld1RyYW5zZm9ybTtcclxuICAgIHRoaXMubGF5b3V0Qm91bmRzID0gbGF5b3V0Qm91bmRzO1xyXG5cclxuICAgIHRoaXMubGVmdFBpcGVZT2Zmc2V0ID0gMzA7IC8vIGxlZnQgcGlwZSB0b3Agb2Zmc2V0IHcuci50IHRoZSBsZWZ0IHRvcCBjb250cm9sIHBvaW50XHJcbiAgICB0aGlzLnJpZ2h0UGlwZVlPZmZzZXQgPSAzMDsgLy8gcmlnaHQgcGlwZSB0b3Agb2Zmc2V0IHcuci50IHRoZSByaWdodCB0b3AgY29udHJvbCBwb2ludFxyXG4gICAgdGhpcy5yaWdodFBpcGVMZWZ0T2Zmc2V0ID0gNzU7XHJcbiAgICBjb25zdCBsZWZ0UGlwZVggPSAtNDk7XHJcblxyXG4gICAgLy9sZWZ0IHNpZGUgcGlwZSBpbWFnZS5cclxuICAgIGNvbnN0IGxlZnRQaXBlSGVhZCA9IG5ldyBJbWFnZSggcGlwZUxlZnRGcm9udF9wbmcgKTtcclxuXHJcbiAgICBjb25zdCBsZWZ0UGlwZVNlZ21lbnQgPSBuZXcgSW1hZ2UoIHBpcGVTZWdtZW50X3BuZyxcclxuICAgICAge1xyXG4gICAgICAgIHJpZ2h0OiBsZWZ0UGlwZUhlYWQubGVmdCArIDMwLFxyXG4gICAgICAgIHNjYWxlOiBuZXcgVmVjdG9yMiggUElQRV9TRUdNRU5UX1hfU0NBTEUsIDEgKVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5sZWZ0UGlwZU5vZGUgPSBuZXcgTm9kZSgge1xyXG4gICAgICBjaGlsZHJlbjogWyBsZWZ0UGlwZUhlYWQsIGxlZnRQaXBlU2VnbWVudCBdLFxyXG4gICAgICB4OiBsZWZ0UGlwZVgsXHJcbiAgICAgIHk6IGZsb3dNb2RlbC5waXBlLmxlZnRQaXBlWVBvc2l0aW9uUHJvcGVydHkudmFsdWUsXHJcbiAgICAgIHNjYWxlOiBmbG93TW9kZWwucGlwZS5sZWZ0UGlwZVNjYWxlUHJvcGVydHkudmFsdWVcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLmxlZnRQaXBlQmFja05vZGUgPSBuZXcgSW1hZ2UoIHBpcGVMZWZ0QmFja19wbmcsIHtcclxuICAgICAgeDogbGVmdFBpcGVYLFxyXG4gICAgICB5OiBmbG93TW9kZWwucGlwZS5sZWZ0UGlwZVlQb3NpdGlvblByb3BlcnR5LnZhbHVlLFxyXG4gICAgICBzY2FsZTogZmxvd01vZGVsLnBpcGUubGVmdFBpcGVTY2FsZVByb3BlcnR5LnZhbHVlXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gc2hhcGUgZm9yIHRoZSBwaXBlbGluZXNcclxuICAgIHRoaXMucGlwZUZsb3dMaW5lID0gbmV3IFBhdGgoIG51bGwsIHsgc3Ryb2tlOiBMSU5FX0NPTE9SLCBsaW5lV2lkdGg6IDYgfSApO1xyXG5cclxuICAgIC8vIFNoYXBlIGZvciBmbHVpZC4gQWx0aG91Z2ggdGhpcyBpcyBpZGVudGljYWwgaW4gXCJzaGFwZVwiIHRvIHBpcGVGbG93TGluZSwgYSBzZXBhcmF0ZSBub2RlIGlzIHVzZWQgdG8gbGF5ZXJcclxuICAgIC8vIHRoZSBwYXJ0aWNsZXMgYmV0d2VlbiBmbHVpZCBhbmQgdGhlIHBpcGVsaW5lcyBzbyB0aGF0IHRoZXkgYXBwZWFyIG9uIHRvcCBvZiBmbHVpZCBhbmQgZG9uJ3QgcHJvdHJ1ZGUgb3ZlciB0aGUgcGlwZS5cclxuICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvZmx1aWQtcHJlc3N1cmUtYW5kLWZsb3cvaXNzdWVzLzE4M1xyXG4gICAgdGhpcy5waXBlRmx1aWROb2RlID0gbmV3IFBhdGgoIG51bGwsIHtcclxuICAgICAgc3Ryb2tlOiBMSU5FX0NPTE9SLFxyXG4gICAgICBsaW5lV2lkdGg6IDAsXHJcbiAgICAgIGZpbGw6IGZsb3dNb2RlbC5mbHVpZENvbG9yTW9kZWwuY29sb3JQcm9wZXJ0eS52YWx1ZVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFNraXAgYm91bmRzIGNvbXB1dGF0aW9uIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UsIHNlZSBlbmVyZ3ktc2thdGUtcGFyay1iYXNpY3MjMjQ1XHJcbiAgICAvLyBRdWFsaXRhdGl2ZSB0ZXN0cyBkaWQgbm90IHNob3cgYSBzaWduaWZpY2FudCBpbXByb3ZlbWVudFxyXG4gICAgY29uc3QgZW1wdHlCb3VuZHMgPSBuZXcgQm91bmRzMiggMCwgMCwgMCwgMCApO1xyXG4gICAgdGhpcy5waXBlRmx1aWROb2RlLmNvbXB1dGVTaGFwZUJvdW5kcyA9ICgpID0+IHtcclxuICAgICAgcmV0dXJuIGVtcHR5Qm91bmRzO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyByaWdodCBzaWRlIHBpcGUgaW1hZ2UuXHJcbiAgICBjb25zdCByaWdodFBpcGVIZWFkID0gbmV3IEltYWdlKCBwaXBlUmlnaHRfcG5nICk7XHJcbiAgICBjb25zdCByaWdodFBpcGVNaWRkbGUgPSBuZXcgSW1hZ2UoIHBpcGVTZWdtZW50X3BuZyxcclxuICAgICAgeyBsZWZ0OiByaWdodFBpcGVIZWFkLnJpZ2h0IC0gNTAsIHNjYWxlOiBuZXcgVmVjdG9yMiggUElQRV9TRUdNRU5UX1hfU0NBTEUsIDEgKSB9ICk7XHJcblxyXG4gICAgdGhpcy5yaWdodFBpcGVOb2RlID0gbmV3IE5vZGUoIHtcclxuICAgICAgY2hpbGRyZW46IFsgcmlnaHRQaXBlSGVhZCwgcmlnaHRQaXBlTWlkZGxlIF0sXHJcbiAgICAgIHg6IGxheW91dEJvdW5kcy5tYXhYIC0gdGhpcy5yaWdodFBpcGVMZWZ0T2Zmc2V0LFxyXG4gICAgICB5OiBmbG93TW9kZWwucGlwZS5yaWdodFBpcGVZUG9zaXRpb25Qcm9wZXJ0eS52YWx1ZSxcclxuICAgICAgc2NhbGU6IGZsb3dNb2RlbC5waXBlLnJpZ2h0UGlwZVNjYWxlUHJvcGVydHkudmFsdWVcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBvcmRlciBvZiBkaWZmZXJlbnQgbGF5ZXJzIHdpdGhpbiBwaXBlIE5vZGUgLS0gbGVmdFBpcGVCYWNrTm9kZSwgcGlwZUZsdWlkTm9kZSwgcHJlUGFydGljbGVMYXllciwgcGlwZUZsb3dMaW5lLFxyXG4gICAgLy8gbGVmdFBpcGVOb2RlIGFuZCByaWdodFBpcGVOb2RlXHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLmxlZnRQaXBlQmFja05vZGUgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMucGlwZUZsdWlkTm9kZSApO1xyXG5cclxuICAgIHRoaXMucHJlUGFydGljbGVMYXllciA9IG5ldyBOb2RlKCk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLnByZVBhcnRpY2xlTGF5ZXIgKTtcclxuXHJcbiAgICB0aGlzLnBhcnRpY2xlc0xheWVyID0gbmV3IFBhcnRpY2xlQ2FudmFzTm9kZSggZmxvd01vZGVsLmZsb3dQYXJ0aWNsZXMsIGZsb3dNb2RlbC5ncmlkUGFydGljbGVzLCBtb2RlbFZpZXdUcmFuc2Zvcm0sXHJcbiAgICAgIHtcclxuICAgICAgICBjYW52YXNCb3VuZHM6IG5ldyBCb3VuZHMyKCAyMCwgODAsIDgwMCwgNjAwIClcclxuICAgICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5wYXJ0aWNsZXNMYXllciApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5waXBlRmxvd0xpbmUgKTtcclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLnJpZ2h0UGlwZU5vZGUgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMubGVmdFBpcGVOb2RlICk7XHJcblxyXG4gICAgLy8gbGluayB0aGUgbGVmdC9yaWdodCBwaXBlIHNjYWxlIHByb3BlcnRpZXMgdG8gdGhlIGxlZnQvcmlnaHQgcGlwZSBub2Rlc1xyXG4gICAgZmxvd01vZGVsLnBpcGUubGVmdFBpcGVTY2FsZVByb3BlcnR5LmxpbmsoIHNjYWxlID0+IHtcclxuICAgICAgdGhpcy5sZWZ0UGlwZU5vZGUuc2V0U2NhbGVNYWduaXR1ZGUoIFBJUEVfSU5JVElBTF9TQ0FMRSwgc2NhbGUgKTtcclxuICAgICAgdGhpcy5sZWZ0UGlwZUJhY2tOb2RlLnNldFNjYWxlTWFnbml0dWRlKCBQSVBFX0lOSVRJQUxfU0NBTEUsIHNjYWxlICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgZmxvd01vZGVsLnBpcGUucmlnaHRQaXBlU2NhbGVQcm9wZXJ0eS5saW5rKCBzY2FsZSA9PiB7XHJcbiAgICAgIHRoaXMucmlnaHRQaXBlTm9kZS5zZXRTY2FsZU1hZ25pdHVkZSggUElQRV9JTklUSUFMX1NDQUxFLCBzY2FsZSApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGxpbmsgdGhlIGxlZnQvcmlnaHQgcGlwZSBwb3NpdGlvbiBwcm9wZXJ0aWVzIHRvIHRoZSBsZWZ0L3JpZ2h0IHBpcGUgbm9kZXNcclxuICAgIGZsb3dNb2RlbC5waXBlLmxlZnRQaXBlWVBvc2l0aW9uUHJvcGVydHkubGlua0F0dHJpYnV0ZSggdGhpcy5sZWZ0UGlwZU5vZGUsICd5JyApO1xyXG4gICAgZmxvd01vZGVsLnBpcGUubGVmdFBpcGVZUG9zaXRpb25Qcm9wZXJ0eS5saW5rQXR0cmlidXRlKCB0aGlzLmxlZnRQaXBlQmFja05vZGUsICd5JyApO1xyXG4gICAgZmxvd01vZGVsLnBpcGUucmlnaHRQaXBlWVBvc2l0aW9uUHJvcGVydHkubGlua0F0dHJpYnV0ZSggdGhpcy5yaWdodFBpcGVOb2RlLCAneScgKTtcclxuXHJcbiAgICBmbG93TW9kZWwuZmx1aWRDb2xvck1vZGVsLmNvbG9yUHJvcGVydHkubGlua0F0dHJpYnV0ZSggdGhpcy5waXBlRmx1aWROb2RlLCAnZmlsbCcgKTtcclxuXHJcbiAgICAvLyBpbml0IHRoZSBmbGV4aWJsZSBtaWRkbGUgcGlwZSBmbG93IGxpbmUgc2hhcGVcclxuICAgIHRoaXMudXBkYXRlUGlwZUZsb3dMaW5lU2hhcGUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHVwZGF0ZSB0aGUgcGlwZSBmbG93IGxpbmUgc2hhcGUgKHRoZSBmbGV4aWJsZSBtaWRkbGUgcGlwZSlcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIHVwZGF0ZVBpcGVGbG93TGluZVNoYXBlKCkge1xyXG5cclxuICAgIC8vIGdldHRpbmcgY3Jvc3Mgc2VjdGlvbnNcclxuICAgIGNvbnN0IHNwbGluZUNyb3NzU2VjdGlvbnMgPSB0aGlzLmZsb3dNb2RlbC5waXBlLmdldFNwbGluZUNyb3NzU2VjdGlvbnMoKTtcclxuXHJcbiAgICBjb25zdCB4UG9pbnRzQm90dG9tID0gbmV3IEFycmF5KCBzcGxpbmVDcm9zc1NlY3Rpb25zLmxlbmd0aCApO1xyXG4gICAgY29uc3QgeVBvaW50c0JvdHRvbSA9IG5ldyBBcnJheSggc3BsaW5lQ3Jvc3NTZWN0aW9ucy5sZW5ndGggKTtcclxuICAgIGNvbnN0IHhQb2ludHNUb3AgPSBuZXcgQXJyYXkoIHNwbGluZUNyb3NzU2VjdGlvbnMubGVuZ3RoICk7XHJcbiAgICBjb25zdCB5UG9pbnRzVG9wID0gbmV3IEFycmF5KCBzcGxpbmVDcm9zc1NlY3Rpb25zLmxlbmd0aCApO1xyXG5cclxuICAgIGNvbnN0IG1pblhPZlBpcGVGbG93TGluZVNoYXBlID0gLTYuNzsgLy8gbW9kZWwgdmFsdWVcclxuICAgIGNvbnN0IG1heFhPZlBpcGVGbG93TGluZVNoYXBlID0gNi43O1xyXG5cclxuICAgIGxldCBzdGFydEluZGV4ID0gMDtcclxuICAgIGxldCBlbmRJbmRleCA9IDA7XHJcblxyXG4gICAgLy8gIHBvaW50cyBmb3IgbGluZVRvXHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBzcGxpbmVDcm9zc1NlY3Rpb25zLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICB4UG9pbnRzQm90dG9tWyBpIF0gPSBzcGxpbmVDcm9zc1NlY3Rpb25zWyBpIF0ueDtcclxuICAgICAgeVBvaW50c0JvdHRvbVsgaSBdID0gc3BsaW5lQ3Jvc3NTZWN0aW9uc1sgaSBdLnlCb3R0b207XHJcbiAgICAgIHhQb2ludHNUb3BbIGkgXSA9IHNwbGluZUNyb3NzU2VjdGlvbnNbIGkgXS54O1xyXG4gICAgICB5UG9pbnRzVG9wWyBpIF0gPSBzcGxpbmVDcm9zc1NlY3Rpb25zWyBpIF0ueVRvcDtcclxuICAgICAgaWYgKCBzcGxpbmVDcm9zc1NlY3Rpb25zWyBpIF0ueCA8PSBtaW5YT2ZQaXBlRmxvd0xpbmVTaGFwZSApIHtcclxuICAgICAgICBzdGFydEluZGV4ID0gaTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIHNwbGluZUNyb3NzU2VjdGlvbnNbIGkgXS54IDw9IG1heFhPZlBpcGVGbG93TGluZVNoYXBlICkge1xyXG4gICAgICAgIGVuZEluZGV4ID0gaTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZsb3dMaW5lU2hhcGUgPSBuZXcgU2hhcGUoKS5tb3ZlVG8oIHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WCggeFBvaW50c0JvdHRvbVsgc3RhcnRJbmRleCArIDEgXSApLFxyXG4gICAgICB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIHlQb2ludHNCb3R0b21bIHN0YXJ0SW5kZXggKyAxIF0gKSApO1xyXG5cclxuICAgIC8vIFNwbGluZSBwb2ludHMgYmV5b25kIHRoZSBsYXN0IHBpcGUgY3Jvc3Mgc2VjdGlvbiBhcmUgbm90IG5lZWRlZC5cclxuICAgIGZvciAoIGxldCBpID0gc3RhcnRJbmRleCArIDI7IGkgPD0gZW5kSW5kZXg7IGkrKyApIHtcclxuICAgICAgZmxvd0xpbmVTaGFwZS5saW5lVG8oIHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WCggeFBvaW50c0JvdHRvbVsgaSBdICksXHJcbiAgICAgICAgdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdZKCB5UG9pbnRzQm90dG9tWyBpIF0gKSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNwbGluZSBwb2ludHMgYmV5b25kIHRoZSBsYXN0IHBpcGUgY3Jvc3Mgc2VjdGlvbiBhcmUgbm90IG5lZWRlZC5cclxuICAgIGZvciAoIGxldCBpID0gZW5kSW5kZXg7IGkgPiBzdGFydEluZGV4OyBpLS0gKSB7XHJcbiAgICAgIGZsb3dMaW5lU2hhcGUubGluZVRvKCB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1goIHhQb2ludHNUb3BbIGkgXSApLFxyXG4gICAgICAgIHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WSggeVBvaW50c1RvcFsgaSBdICkgKTtcclxuICAgIH1cclxuICAgIHRoaXMucGlwZUZsb3dMaW5lLnNoYXBlID0gZmxvd0xpbmVTaGFwZTtcclxuICAgIHRoaXMucGlwZUZsdWlkTm9kZS5zaGFwZSA9IGZsb3dMaW5lU2hhcGU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgcmVzZXQoKSB7XHJcbiAgICAvLyBtYXJrIHBpcGUgYXMgZGlydHkgZm9yIGdldHRpbmcgbmV3IHNwbGluZSBjcm9zcyBzZWN0aW9uc1xyXG4gICAgdGhpcy5mbG93TW9kZWwucGlwZS5kaXJ0eSA9IHRydWU7XHJcbiAgICB0aGlzLnVwZGF0ZVBpcGVGbG93TGluZVNoYXBlKCk7XHJcbiAgICB0aGlzLmZsb3dNb2RlbC5mbHV4TWV0ZXIudXBkYXRlRW1pdHRlci5lbWl0KCk7XHJcbiAgfVxyXG59XHJcblxyXG5mbHVpZFByZXNzdXJlQW5kRmxvdy5yZWdpc3RlciggJ1BpcGVOb2RlJywgUGlwZU5vZGUgKTtcclxuZXhwb3J0IGRlZmF1bHQgUGlwZU5vZGU7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLE9BQU8sTUFBTSwrQkFBK0I7QUFD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