// Copyright 2014-2022, University of Colorado Boulder

/**
 * Factory for creating reaction equations.
 *
 * @author Andrey Zelenkov (Mlearner)
 * @author Chris Malley (PixelZoom, Inc.)
 */

import { Shape } from '../../../../kite/js/imports.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { AlignBox, AlignGroup, HBox, HStrut, Path, RichText, VBox, VStrut } from '../../../../scenery/js/imports.js';
import acidBaseSolutions from '../../acidBaseSolutions.js';
import createParticleNode from './createParticleNode.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';

// constants
const EQUATION_SCALE = 1.5; // applied to all equations, see issue #88
const VBOX_SPACING = 2;

// constants related to text
const FONT_SIZE = 13;
const FONT = new PhetFont(FONT_SIZE);
const RICH_TEXT_OPTIONS = {
  font: FONT
};
const SUBSCRIPT_HEIGHT = FONT_SIZE / 12; // VStrut with this height is added to any equation term that doesn't have a subscript

// constants related to arrows, issue #95
const ARROWS_VERTICAL_SPACE = 3; // vertical space between reversible arrows
const ARROWS_LENGTH = 25;
const ARROWS_HEAD_RADIUS = 0.72 * ARROWS_LENGTH;
const ARROWS_HEAD_ANGLE_DELTA = 0.2 * Math.PI;

// To make all equations have the same effective dimensions for layout
const ALIGN_GROUP = new AlignGroup();
const ReactionEquationFactory = {
  // 2 H2O <-> H3O+ + OH-
  createWaterEquation(solutionTypeProperty) {
    return createEquation(solutionTypeProperty, 'water', [create2H2O(), createReversibleArrow(), createH3O(), createPlus(), createOH()]);
  },
  // HA + H2O -> A- + H3O+
  createStrongAcidEquation(solutionTypeProperty) {
    return createAcidEquation(solutionTypeProperty, false /* isWeak */);
  },

  // HA + H2O <-> A- + H3O+
  createWeakAcidEquation(solutionTypeProperty) {
    return createAcidEquation(solutionTypeProperty, true /* isWeak */);
  },

  // MOH -> M+ + OH-
  createStrongBaseEquation(solutionTypeProperty) {
    return createEquation(solutionTypeProperty, 'strongBase', [createMOH(), createIrreversibleArrow(), createM(), createPlus(), createOH()]);
  },
  // B + H2O <-> BH+ + OH-
  createWeakBaseEquation(solutionTypeProperty) {
    return createEquation(solutionTypeProperty, 'weakBase', [createB(), createPlus(), createH2O(), createReversibleArrow(), createBH(), createPlus(), createOH()]);
  }
};

// Equations for all acids are similar: HA + H2O ? A- + H3O+
function createAcidEquation(solutionTypeProperty, isWeak) {
  return createEquation(solutionTypeProperty, isWeak ? 'weakAcid' : 'strongAcid', [createHA(), createPlus(), createH2O(), isWeak ? createReversibleArrow() : createIrreversibleArrow(), createA(), createPlus(), createH3O()]);
}

// Creates an equation by horizontally laying out a set of elements (children).
function createEquation(solutionTypeProperty, soluteType, children) {
  return new AlignBox(new HBox({
    children: children,
    scale: EQUATION_SCALE,
    spacing: 4,
    align: 'bottom',
    visibleProperty: new DerivedProperty([solutionTypeProperty], value => value === soluteType)
  }), {
    group: ALIGN_GROUP,
    xAlign: 'center',
    yAlign: 'bottom'
  });
}

// A- node
function createA() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [createParticleNode('A'), new RichText(`<i>A</i><sup>${MathSymbols.MINUS}</sup>`, RICH_TEXT_OPTIONS), new VStrut(SUBSCRIPT_HEIGHT)]
  });
}

// B node
function createB() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [createParticleNode('B'), new RichText('<i>B</i>', RICH_TEXT_OPTIONS), new VStrut(SUBSCRIPT_HEIGHT)]
  });
}

// BH+ node
function createBH() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [createParticleNode('BH'), new HBox({
      spacing: 1,
      // this functions like kerning
      align: 'bottom',
      children: [new RichText('<i>B</i>', RICH_TEXT_OPTIONS), new RichText(`H<sup>${MathSymbols.PLUS}</sup>`, RICH_TEXT_OPTIONS)]
    }), new VStrut(SUBSCRIPT_HEIGHT)]
  });
}

// H2O node
function createH2O() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [createParticleNode('H2O'), new RichText('H<sub>2</sub>O', RICH_TEXT_OPTIONS)]
  });
}

// 2H2O node
function create2H2O() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [new HBox({
      spacing: 4,
      children: [createParticleNode('H2O'), createParticleNode('H2O')]
    }), new HBox({
      spacing: 3,
      // this functions like kerning
      align: 'top',
      children: [new RichText('2', RICH_TEXT_OPTIONS), new RichText('H<sub>2</sub>O', RICH_TEXT_OPTIONS)]
    })]
  });
}

// H3O+ node
function createH3O() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [
    // Add a strut as a bit of a hack to make the big atom in H3O appear aligned with the text.
    new HBox({
      spacing: 0,
      children: [createParticleNode('H3O'), new HStrut(7)]
    }), new RichText('H<sub>3</sub>O<sup>+</sup>', RICH_TEXT_OPTIONS)]
  });
}

// HA node
function createHA() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [createParticleNode('HA'), new RichText('H<i>A</i>', RICH_TEXT_OPTIONS), new VStrut(SUBSCRIPT_HEIGHT)]
  });
}

// M+ node
function createM() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [createParticleNode('M'), new HBox({
      spacing: 1,
      // this functions like kerning
      align: 'origin',
      children: [new RichText('<i>M</i>', RICH_TEXT_OPTIONS), new RichText(`<sup>${MathSymbols.PLUS}</sup>`, RICH_TEXT_OPTIONS)]
    }), new VStrut(SUBSCRIPT_HEIGHT)]
  });
}

// MOH node
function createMOH() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [createParticleNode('MOH'), new HBox({
      spacing: 1,
      // this functions like kerning
      align: 'origin',
      children: [new RichText('<i>M</i>', RICH_TEXT_OPTIONS), new RichText('OH', RICH_TEXT_OPTIONS)]
    }), new VStrut(SUBSCRIPT_HEIGHT)]
  });
}

// OH- node
function createOH() {
  return new VBox({
    spacing: VBOX_SPACING,
    children: [createParticleNode('OH'), new RichText(`OH<sup>${MathSymbols.MINUS}</sup>`, RICH_TEXT_OPTIONS), new VStrut(SUBSCRIPT_HEIGHT)]
  });
}

// plus sign node
function createPlus() {
  return new VBox({
    children: [new RichText(MathSymbols.PLUS, RICH_TEXT_OPTIONS), new VStrut(SUBSCRIPT_HEIGHT + VBOX_SPACING)]
  });
}

// double arrow to indicate reversible reaction
function createReversibleArrow() {
  const shape = new Shape()
  // top arrow, points right
  .moveTo(0, -ARROWS_VERTICAL_SPACE / 2).lineTo(ARROWS_LENGTH, -ARROWS_VERTICAL_SPACE / 2).lineTo(ARROWS_LENGTH, -ARROWS_VERTICAL_SPACE / 2 + 0.00001) // see issue #104
  .arc(ARROWS_LENGTH, -ARROWS_HEAD_RADIUS - ARROWS_VERTICAL_SPACE / 2, ARROWS_HEAD_RADIUS, 0.5 * Math.PI, 0.5 * Math.PI + ARROWS_HEAD_ANGLE_DELTA)
  // bottom arrow, points left
  .moveTo(ARROWS_LENGTH, ARROWS_VERTICAL_SPACE / 2).lineTo(0, ARROWS_VERTICAL_SPACE / 2).lineTo(0, ARROWS_VERTICAL_SPACE / 2 + 0.00001) // see issue #104
  .arc(0, ARROWS_HEAD_RADIUS + ARROWS_VERTICAL_SPACE / 2, ARROWS_HEAD_RADIUS, -0.5 * Math.PI, -0.5 * Math.PI + ARROWS_HEAD_ANGLE_DELTA);
  return new VBox({
    spacing: VBOX_SPACING,
    children: [new Path(shape, {
      stroke: 'black'
    }), new VStrut(SUBSCRIPT_HEIGHT + FONT_SIZE / 6)]
  });
}

// single arrow to indicate irreversible reaction, points right
function createIrreversibleArrow() {
  const shape = new Shape().moveTo(0, 0).lineTo(ARROWS_LENGTH, 0).lineTo(ARROWS_LENGTH, 0.00001) // see issue #104
  .arc(ARROWS_LENGTH, -ARROWS_HEAD_RADIUS, ARROWS_HEAD_RADIUS, 0.5 * Math.PI, 0.5 * Math.PI + ARROWS_HEAD_ANGLE_DELTA).moveTo(25, 0).arc(ARROWS_LENGTH, ARROWS_HEAD_RADIUS, ARROWS_HEAD_RADIUS, -0.5 * Math.PI, -0.5 * Math.PI - ARROWS_HEAD_ANGLE_DELTA, true);
  return new VBox({
    spacing: VBOX_SPACING,
    children: [new Path(shape, {
      stroke: 'black'
    }), new VStrut(SUBSCRIPT_HEIGHT + FONT_SIZE / 4)]
  });
}
acidBaseSolutions.register('ReactionEquationFactory', ReactionEquationFactory);
export default ReactionEquationFactory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaGFwZSIsIk1hdGhTeW1ib2xzIiwiUGhldEZvbnQiLCJBbGlnbkJveCIsIkFsaWduR3JvdXAiLCJIQm94IiwiSFN0cnV0IiwiUGF0aCIsIlJpY2hUZXh0IiwiVkJveCIsIlZTdHJ1dCIsImFjaWRCYXNlU29sdXRpb25zIiwiY3JlYXRlUGFydGljbGVOb2RlIiwiRGVyaXZlZFByb3BlcnR5IiwiRVFVQVRJT05fU0NBTEUiLCJWQk9YX1NQQUNJTkciLCJGT05UX1NJWkUiLCJGT05UIiwiUklDSF9URVhUX09QVElPTlMiLCJmb250IiwiU1VCU0NSSVBUX0hFSUdIVCIsIkFSUk9XU19WRVJUSUNBTF9TUEFDRSIsIkFSUk9XU19MRU5HVEgiLCJBUlJPV1NfSEVBRF9SQURJVVMiLCJBUlJPV1NfSEVBRF9BTkdMRV9ERUxUQSIsIk1hdGgiLCJQSSIsIkFMSUdOX0dST1VQIiwiUmVhY3Rpb25FcXVhdGlvbkZhY3RvcnkiLCJjcmVhdGVXYXRlckVxdWF0aW9uIiwic29sdXRpb25UeXBlUHJvcGVydHkiLCJjcmVhdGVFcXVhdGlvbiIsImNyZWF0ZTJIMk8iLCJjcmVhdGVSZXZlcnNpYmxlQXJyb3ciLCJjcmVhdGVIM08iLCJjcmVhdGVQbHVzIiwiY3JlYXRlT0giLCJjcmVhdGVTdHJvbmdBY2lkRXF1YXRpb24iLCJjcmVhdGVBY2lkRXF1YXRpb24iLCJjcmVhdGVXZWFrQWNpZEVxdWF0aW9uIiwiY3JlYXRlU3Ryb25nQmFzZUVxdWF0aW9uIiwiY3JlYXRlTU9IIiwiY3JlYXRlSXJyZXZlcnNpYmxlQXJyb3ciLCJjcmVhdGVNIiwiY3JlYXRlV2Vha0Jhc2VFcXVhdGlvbiIsImNyZWF0ZUIiLCJjcmVhdGVIMk8iLCJjcmVhdGVCSCIsImlzV2VhayIsImNyZWF0ZUhBIiwiY3JlYXRlQSIsInNvbHV0ZVR5cGUiLCJjaGlsZHJlbiIsInNjYWxlIiwic3BhY2luZyIsImFsaWduIiwidmlzaWJsZVByb3BlcnR5IiwidmFsdWUiLCJncm91cCIsInhBbGlnbiIsInlBbGlnbiIsIk1JTlVTIiwiUExVUyIsInNoYXBlIiwibW92ZVRvIiwibGluZVRvIiwiYXJjIiwic3Ryb2tlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJSZWFjdGlvbkVxdWF0aW9uRmFjdG9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBGYWN0b3J5IGZvciBjcmVhdGluZyByZWFjdGlvbiBlcXVhdGlvbnMuXHJcbiAqXHJcbiAqIEBhdXRob3IgQW5kcmV5IFplbGVua292IChNbGVhcm5lcilcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IE1hdGhTeW1ib2xzIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9NYXRoU3ltYm9scy5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgeyBBbGlnbkJveCwgQWxpZ25Hcm91cCwgSEJveCwgSFN0cnV0LCBOb2RlLCBQYXRoLCBSaWNoVGV4dCwgVkJveCwgVlN0cnV0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IGFjaWRCYXNlU29sdXRpb25zIGZyb20gJy4uLy4uL2FjaWRCYXNlU29sdXRpb25zLmpzJztcclxuaW1wb3J0IGNyZWF0ZVBhcnRpY2xlTm9kZSBmcm9tICcuL2NyZWF0ZVBhcnRpY2xlTm9kZS5qcyc7XHJcbmltcG9ydCB7IFNvbHV0aW9uVHlwZSB9IGZyb20gJy4uL21vZGVsL1NvbHV0aW9uVHlwZS5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IEVRVUFUSU9OX1NDQUxFID0gMS41OyAvLyBhcHBsaWVkIHRvIGFsbCBlcXVhdGlvbnMsIHNlZSBpc3N1ZSAjODhcclxuY29uc3QgVkJPWF9TUEFDSU5HID0gMjtcclxuXHJcbi8vIGNvbnN0YW50cyByZWxhdGVkIHRvIHRleHRcclxuY29uc3QgRk9OVF9TSVpFID0gMTM7XHJcbmNvbnN0IEZPTlQgPSBuZXcgUGhldEZvbnQoIEZPTlRfU0laRSApO1xyXG5jb25zdCBSSUNIX1RFWFRfT1BUSU9OUyA9IHsgZm9udDogRk9OVCB9O1xyXG5jb25zdCBTVUJTQ1JJUFRfSEVJR0hUID0gRk9OVF9TSVpFIC8gMTI7IC8vIFZTdHJ1dCB3aXRoIHRoaXMgaGVpZ2h0IGlzIGFkZGVkIHRvIGFueSBlcXVhdGlvbiB0ZXJtIHRoYXQgZG9lc24ndCBoYXZlIGEgc3Vic2NyaXB0XHJcblxyXG4vLyBjb25zdGFudHMgcmVsYXRlZCB0byBhcnJvd3MsIGlzc3VlICM5NVxyXG5jb25zdCBBUlJPV1NfVkVSVElDQUxfU1BBQ0UgPSAzOyAvLyB2ZXJ0aWNhbCBzcGFjZSBiZXR3ZWVuIHJldmVyc2libGUgYXJyb3dzXHJcbmNvbnN0IEFSUk9XU19MRU5HVEggPSAyNTtcclxuY29uc3QgQVJST1dTX0hFQURfUkFESVVTID0gMC43MiAqIEFSUk9XU19MRU5HVEg7XHJcbmNvbnN0IEFSUk9XU19IRUFEX0FOR0xFX0RFTFRBID0gMC4yICogTWF0aC5QSTtcclxuXHJcbi8vIFRvIG1ha2UgYWxsIGVxdWF0aW9ucyBoYXZlIHRoZSBzYW1lIGVmZmVjdGl2ZSBkaW1lbnNpb25zIGZvciBsYXlvdXRcclxuY29uc3QgQUxJR05fR1JPVVAgPSBuZXcgQWxpZ25Hcm91cCgpO1xyXG5cclxuY29uc3QgUmVhY3Rpb25FcXVhdGlvbkZhY3RvcnkgPSB7XHJcblxyXG4gIC8vIDIgSDJPIDwtPiBIM08rICsgT0gtXHJcbiAgY3JlYXRlV2F0ZXJFcXVhdGlvbiggc29sdXRpb25UeXBlUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFNvbHV0aW9uVHlwZT4gKTogTm9kZSB7XHJcbiAgICByZXR1cm4gY3JlYXRlRXF1YXRpb24oIHNvbHV0aW9uVHlwZVByb3BlcnR5LCAnd2F0ZXInLCBbXHJcbiAgICAgIGNyZWF0ZTJIMk8oKSxcclxuICAgICAgY3JlYXRlUmV2ZXJzaWJsZUFycm93KCksXHJcbiAgICAgIGNyZWF0ZUgzTygpLFxyXG4gICAgICBjcmVhdGVQbHVzKCksXHJcbiAgICAgIGNyZWF0ZU9IKClcclxuICAgIF0gKTtcclxuICB9LFxyXG5cclxuICAvLyBIQSArIEgyTyAtPiBBLSArIEgzTytcclxuICBjcmVhdGVTdHJvbmdBY2lkRXF1YXRpb24oIHNvbHV0aW9uVHlwZVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxTb2x1dGlvblR5cGU+ICk6IE5vZGUge1xyXG4gICAgcmV0dXJuIGNyZWF0ZUFjaWRFcXVhdGlvbiggc29sdXRpb25UeXBlUHJvcGVydHksIGZhbHNlIC8qIGlzV2VhayAqLyApO1xyXG4gIH0sXHJcblxyXG4gIC8vIEhBICsgSDJPIDwtPiBBLSArIEgzTytcclxuICBjcmVhdGVXZWFrQWNpZEVxdWF0aW9uKCBzb2x1dGlvblR5cGVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8U29sdXRpb25UeXBlPiApOiBOb2RlIHtcclxuICAgIHJldHVybiBjcmVhdGVBY2lkRXF1YXRpb24oIHNvbHV0aW9uVHlwZVByb3BlcnR5LCB0cnVlIC8qIGlzV2VhayAqLyApO1xyXG4gIH0sXHJcblxyXG4gIC8vIE1PSCAtPiBNKyArIE9ILVxyXG4gIGNyZWF0ZVN0cm9uZ0Jhc2VFcXVhdGlvbiggc29sdXRpb25UeXBlUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFNvbHV0aW9uVHlwZT4gKTogTm9kZSB7XHJcbiAgICByZXR1cm4gY3JlYXRlRXF1YXRpb24oIHNvbHV0aW9uVHlwZVByb3BlcnR5LCAnc3Ryb25nQmFzZScsIFtcclxuICAgICAgY3JlYXRlTU9IKCksXHJcbiAgICAgIGNyZWF0ZUlycmV2ZXJzaWJsZUFycm93KCksXHJcbiAgICAgIGNyZWF0ZU0oKSxcclxuICAgICAgY3JlYXRlUGx1cygpLFxyXG4gICAgICBjcmVhdGVPSCgpXHJcbiAgICBdICk7XHJcbiAgfSxcclxuXHJcbiAgLy8gQiArIEgyTyA8LT4gQkgrICsgT0gtXHJcbiAgY3JlYXRlV2Vha0Jhc2VFcXVhdGlvbiggc29sdXRpb25UeXBlUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFNvbHV0aW9uVHlwZT4gKTogTm9kZSB7XHJcbiAgICByZXR1cm4gY3JlYXRlRXF1YXRpb24oIHNvbHV0aW9uVHlwZVByb3BlcnR5LCAnd2Vha0Jhc2UnLCBbXHJcbiAgICAgIGNyZWF0ZUIoKSxcclxuICAgICAgY3JlYXRlUGx1cygpLFxyXG4gICAgICBjcmVhdGVIMk8oKSxcclxuICAgICAgY3JlYXRlUmV2ZXJzaWJsZUFycm93KCksXHJcbiAgICAgIGNyZWF0ZUJIKCksXHJcbiAgICAgIGNyZWF0ZVBsdXMoKSxcclxuICAgICAgY3JlYXRlT0goKVxyXG4gICAgXSApO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEVxdWF0aW9ucyBmb3IgYWxsIGFjaWRzIGFyZSBzaW1pbGFyOiBIQSArIEgyTyA/IEEtICsgSDNPK1xyXG5mdW5jdGlvbiBjcmVhdGVBY2lkRXF1YXRpb24oIHNvbHV0aW9uVHlwZVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxTb2x1dGlvblR5cGU+LCBpc1dlYWs6IGJvb2xlYW4gKTogTm9kZSB7XHJcbiAgcmV0dXJuIGNyZWF0ZUVxdWF0aW9uKCBzb2x1dGlvblR5cGVQcm9wZXJ0eSwgKCBpc1dlYWsgPyAnd2Vha0FjaWQnIDogJ3N0cm9uZ0FjaWQnICksIFtcclxuICAgIGNyZWF0ZUhBKCksXHJcbiAgICBjcmVhdGVQbHVzKCksXHJcbiAgICBjcmVhdGVIMk8oKSxcclxuICAgICggaXNXZWFrID8gY3JlYXRlUmV2ZXJzaWJsZUFycm93KCkgOiBjcmVhdGVJcnJldmVyc2libGVBcnJvdygpICksXHJcbiAgICBjcmVhdGVBKCksXHJcbiAgICBjcmVhdGVQbHVzKCksXHJcbiAgICBjcmVhdGVIM08oKVxyXG4gIF0gKTtcclxufVxyXG5cclxuLy8gQ3JlYXRlcyBhbiBlcXVhdGlvbiBieSBob3Jpem9udGFsbHkgbGF5aW5nIG91dCBhIHNldCBvZiBlbGVtZW50cyAoY2hpbGRyZW4pLlxyXG5mdW5jdGlvbiBjcmVhdGVFcXVhdGlvbiggc29sdXRpb25UeXBlUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFNvbHV0aW9uVHlwZT4sIHNvbHV0ZVR5cGU6IFNvbHV0aW9uVHlwZSwgY2hpbGRyZW46IE5vZGVbXSApOiBOb2RlIHtcclxuICByZXR1cm4gbmV3IEFsaWduQm94KCBuZXcgSEJveCgge1xyXG4gICAgY2hpbGRyZW46IGNoaWxkcmVuLFxyXG4gICAgc2NhbGU6IEVRVUFUSU9OX1NDQUxFLFxyXG4gICAgc3BhY2luZzogNCxcclxuICAgIGFsaWduOiAnYm90dG9tJyxcclxuICAgIHZpc2libGVQcm9wZXJ0eTogbmV3IERlcml2ZWRQcm9wZXJ0eSggWyBzb2x1dGlvblR5cGVQcm9wZXJ0eSBdLCB2YWx1ZSA9PiB2YWx1ZSA9PT0gc29sdXRlVHlwZSApXHJcbiAgfSApLCB7XHJcbiAgICBncm91cDogQUxJR05fR1JPVVAsXHJcbiAgICB4QWxpZ246ICdjZW50ZXInLFxyXG4gICAgeUFsaWduOiAnYm90dG9tJ1xyXG4gIH0gKTtcclxufVxyXG5cclxuLy8gQS0gbm9kZVxyXG5mdW5jdGlvbiBjcmVhdGVBKCk6IE5vZGUge1xyXG4gIHJldHVybiBuZXcgVkJveCgge1xyXG4gICAgc3BhY2luZzogVkJPWF9TUEFDSU5HLFxyXG4gICAgY2hpbGRyZW46IFtcclxuICAgICAgY3JlYXRlUGFydGljbGVOb2RlKCAnQScgKSxcclxuICAgICAgbmV3IFJpY2hUZXh0KCBgPGk+QTwvaT48c3VwPiR7TWF0aFN5bWJvbHMuTUlOVVN9PC9zdXA+YCwgUklDSF9URVhUX09QVElPTlMgKSxcclxuICAgICAgbmV3IFZTdHJ1dCggU1VCU0NSSVBUX0hFSUdIVCApXHJcbiAgICBdXHJcbiAgfSApO1xyXG59XHJcblxyXG4vLyBCIG5vZGVcclxuZnVuY3Rpb24gY3JlYXRlQigpOiBOb2RlIHtcclxuICByZXR1cm4gbmV3IFZCb3goIHtcclxuICAgIHNwYWNpbmc6IFZCT1hfU1BBQ0lORyxcclxuICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgIGNyZWF0ZVBhcnRpY2xlTm9kZSggJ0InICksXHJcbiAgICAgIG5ldyBSaWNoVGV4dCggJzxpPkI8L2k+JywgUklDSF9URVhUX09QVElPTlMgKSxcclxuICAgICAgbmV3IFZTdHJ1dCggU1VCU0NSSVBUX0hFSUdIVCApXHJcbiAgICBdXHJcbiAgfSApO1xyXG59XHJcblxyXG4vLyBCSCsgbm9kZVxyXG5mdW5jdGlvbiBjcmVhdGVCSCgpOiBOb2RlIHtcclxuICByZXR1cm4gbmV3IFZCb3goIHtcclxuICAgIHNwYWNpbmc6IFZCT1hfU1BBQ0lORyxcclxuICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgIGNyZWF0ZVBhcnRpY2xlTm9kZSggJ0JIJyApLFxyXG4gICAgICBuZXcgSEJveCgge1xyXG4gICAgICAgIHNwYWNpbmc6IDEsIC8vIHRoaXMgZnVuY3Rpb25zIGxpa2Uga2VybmluZ1xyXG4gICAgICAgIGFsaWduOiAnYm90dG9tJyxcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgbmV3IFJpY2hUZXh0KCAnPGk+QjwvaT4nLCBSSUNIX1RFWFRfT1BUSU9OUyApLFxyXG4gICAgICAgICAgbmV3IFJpY2hUZXh0KCBgSDxzdXA+JHtNYXRoU3ltYm9scy5QTFVTfTwvc3VwPmAsIFJJQ0hfVEVYVF9PUFRJT05TICkgXVxyXG4gICAgICB9ICksXHJcbiAgICAgIG5ldyBWU3RydXQoIFNVQlNDUklQVF9IRUlHSFQgKVxyXG4gICAgXVxyXG4gIH0gKTtcclxufVxyXG5cclxuLy8gSDJPIG5vZGVcclxuZnVuY3Rpb24gY3JlYXRlSDJPKCk6IE5vZGUge1xyXG4gIHJldHVybiBuZXcgVkJveCgge1xyXG4gICAgc3BhY2luZzogVkJPWF9TUEFDSU5HLFxyXG4gICAgY2hpbGRyZW46IFtcclxuICAgICAgY3JlYXRlUGFydGljbGVOb2RlKCAnSDJPJyApLFxyXG4gICAgICBuZXcgUmljaFRleHQoICdIPHN1Yj4yPC9zdWI+TycsIFJJQ0hfVEVYVF9PUFRJT05TIClcclxuICAgIF1cclxuICB9ICk7XHJcbn1cclxuXHJcbi8vIDJIMk8gbm9kZVxyXG5mdW5jdGlvbiBjcmVhdGUySDJPKCk6IE5vZGUge1xyXG4gIHJldHVybiBuZXcgVkJveCgge1xyXG4gICAgc3BhY2luZzogVkJPWF9TUEFDSU5HLFxyXG4gICAgY2hpbGRyZW46IFtcclxuICAgICAgbmV3IEhCb3goIHtcclxuICAgICAgICBzcGFjaW5nOiA0LFxyXG4gICAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgICBjcmVhdGVQYXJ0aWNsZU5vZGUoICdIMk8nICksXHJcbiAgICAgICAgICBjcmVhdGVQYXJ0aWNsZU5vZGUoICdIMk8nIClcclxuICAgICAgICBdXHJcbiAgICAgIH0gKSxcclxuICAgICAgbmV3IEhCb3goIHtcclxuICAgICAgICBzcGFjaW5nOiAzLCAvLyB0aGlzIGZ1bmN0aW9ucyBsaWtlIGtlcm5pbmdcclxuICAgICAgICBhbGlnbjogJ3RvcCcsXHJcbiAgICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICAgIG5ldyBSaWNoVGV4dCggJzInLCBSSUNIX1RFWFRfT1BUSU9OUyApLFxyXG4gICAgICAgICAgbmV3IFJpY2hUZXh0KCAnSDxzdWI+Mjwvc3ViPk8nLCBSSUNIX1RFWFRfT1BUSU9OUyApXHJcbiAgICAgICAgXVxyXG4gICAgICB9IClcclxuICAgIF1cclxuICB9ICk7XHJcbn1cclxuXHJcbi8vIEgzTysgbm9kZVxyXG5mdW5jdGlvbiBjcmVhdGVIM08oKTogTm9kZSB7XHJcbiAgcmV0dXJuIG5ldyBWQm94KCB7XHJcbiAgICBzcGFjaW5nOiBWQk9YX1NQQUNJTkcsXHJcbiAgICBjaGlsZHJlbjogW1xyXG5cclxuICAgICAgLy8gQWRkIGEgc3RydXQgYXMgYSBiaXQgb2YgYSBoYWNrIHRvIG1ha2UgdGhlIGJpZyBhdG9tIGluIEgzTyBhcHBlYXIgYWxpZ25lZCB3aXRoIHRoZSB0ZXh0LlxyXG4gICAgICBuZXcgSEJveCgge1xyXG4gICAgICAgIHNwYWNpbmc6IDAsXHJcbiAgICAgICAgY2hpbGRyZW46IFsgY3JlYXRlUGFydGljbGVOb2RlKCAnSDNPJyApLCBuZXcgSFN0cnV0KCA3ICkgXVxyXG4gICAgICB9ICksXHJcbiAgICAgIG5ldyBSaWNoVGV4dCggJ0g8c3ViPjM8L3N1Yj5PPHN1cD4rPC9zdXA+JywgUklDSF9URVhUX09QVElPTlMgKVxyXG4gICAgXVxyXG4gIH0gKTtcclxufVxyXG5cclxuLy8gSEEgbm9kZVxyXG5mdW5jdGlvbiBjcmVhdGVIQSgpOiBOb2RlIHtcclxuICByZXR1cm4gbmV3IFZCb3goIHtcclxuICAgIHNwYWNpbmc6IFZCT1hfU1BBQ0lORyxcclxuICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgIGNyZWF0ZVBhcnRpY2xlTm9kZSggJ0hBJyApLFxyXG4gICAgICBuZXcgUmljaFRleHQoICdIPGk+QTwvaT4nLCBSSUNIX1RFWFRfT1BUSU9OUyApLFxyXG4gICAgICBuZXcgVlN0cnV0KCBTVUJTQ1JJUFRfSEVJR0hUIClcclxuICAgIF1cclxuICB9ICk7XHJcbn1cclxuXHJcbi8vIE0rIG5vZGVcclxuZnVuY3Rpb24gY3JlYXRlTSgpOiBOb2RlIHtcclxuICByZXR1cm4gbmV3IFZCb3goIHtcclxuICAgIHNwYWNpbmc6IFZCT1hfU1BBQ0lORyxcclxuICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgIGNyZWF0ZVBhcnRpY2xlTm9kZSggJ00nICksXHJcbiAgICAgIG5ldyBIQm94KCB7XHJcbiAgICAgICAgc3BhY2luZzogMSwgLy8gdGhpcyBmdW5jdGlvbnMgbGlrZSBrZXJuaW5nXHJcbiAgICAgICAgYWxpZ246ICdvcmlnaW4nLFxyXG4gICAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgICBuZXcgUmljaFRleHQoICc8aT5NPC9pPicsIFJJQ0hfVEVYVF9PUFRJT05TICksXHJcbiAgICAgICAgICBuZXcgUmljaFRleHQoIGA8c3VwPiR7TWF0aFN5bWJvbHMuUExVU308L3N1cD5gLCBSSUNIX1RFWFRfT1BUSU9OUyApXHJcbiAgICAgICAgXVxyXG4gICAgICB9ICksXHJcbiAgICAgIG5ldyBWU3RydXQoIFNVQlNDUklQVF9IRUlHSFQgKVxyXG4gICAgXVxyXG4gIH0gKTtcclxufVxyXG5cclxuLy8gTU9IIG5vZGVcclxuZnVuY3Rpb24gY3JlYXRlTU9IKCk6IE5vZGUge1xyXG4gIHJldHVybiBuZXcgVkJveCgge1xyXG4gICAgc3BhY2luZzogVkJPWF9TUEFDSU5HLFxyXG4gICAgY2hpbGRyZW46IFtcclxuICAgICAgY3JlYXRlUGFydGljbGVOb2RlKCAnTU9IJyApLFxyXG4gICAgICBuZXcgSEJveCgge1xyXG4gICAgICAgIHNwYWNpbmc6IDEsIC8vIHRoaXMgZnVuY3Rpb25zIGxpa2Uga2VybmluZ1xyXG4gICAgICAgIGFsaWduOiAnb3JpZ2luJyxcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgbmV3IFJpY2hUZXh0KCAnPGk+TTwvaT4nLCBSSUNIX1RFWFRfT1BUSU9OUyApLFxyXG4gICAgICAgICAgbmV3IFJpY2hUZXh0KCAnT0gnLCBSSUNIX1RFWFRfT1BUSU9OUyApXHJcbiAgICAgICAgXVxyXG4gICAgICB9ICksXHJcbiAgICAgIG5ldyBWU3RydXQoIFNVQlNDUklQVF9IRUlHSFQgKVxyXG4gICAgXVxyXG4gIH0gKTtcclxufVxyXG5cclxuLy8gT0gtIG5vZGVcclxuZnVuY3Rpb24gY3JlYXRlT0goKTogTm9kZSB7XHJcbiAgcmV0dXJuIG5ldyBWQm94KCB7XHJcbiAgICBzcGFjaW5nOiBWQk9YX1NQQUNJTkcsXHJcbiAgICBjaGlsZHJlbjogW1xyXG4gICAgICBjcmVhdGVQYXJ0aWNsZU5vZGUoICdPSCcgKSxcclxuICAgICAgbmV3IFJpY2hUZXh0KCBgT0g8c3VwPiR7TWF0aFN5bWJvbHMuTUlOVVN9PC9zdXA+YCwgUklDSF9URVhUX09QVElPTlMgKSxcclxuICAgICAgbmV3IFZTdHJ1dCggU1VCU0NSSVBUX0hFSUdIVCApXHJcbiAgICBdXHJcbiAgfSApO1xyXG59XHJcblxyXG4vLyBwbHVzIHNpZ24gbm9kZVxyXG5mdW5jdGlvbiBjcmVhdGVQbHVzKCk6IE5vZGUge1xyXG4gIHJldHVybiBuZXcgVkJveCgge1xyXG4gICAgY2hpbGRyZW46IFtcclxuICAgICAgbmV3IFJpY2hUZXh0KCBNYXRoU3ltYm9scy5QTFVTLCBSSUNIX1RFWFRfT1BUSU9OUyApLFxyXG4gICAgICBuZXcgVlN0cnV0KCBTVUJTQ1JJUFRfSEVJR0hUICsgVkJPWF9TUEFDSU5HIClcclxuICAgIF1cclxuICB9ICk7XHJcbn1cclxuXHJcbi8vIGRvdWJsZSBhcnJvdyB0byBpbmRpY2F0ZSByZXZlcnNpYmxlIHJlYWN0aW9uXHJcbmZ1bmN0aW9uIGNyZWF0ZVJldmVyc2libGVBcnJvdygpOiBOb2RlIHtcclxuICBjb25zdCBzaGFwZSA9IG5ldyBTaGFwZSgpXHJcbiAgICAvLyB0b3AgYXJyb3csIHBvaW50cyByaWdodFxyXG4gICAgLm1vdmVUbyggMCwgLUFSUk9XU19WRVJUSUNBTF9TUEFDRSAvIDIgKVxyXG4gICAgLmxpbmVUbyggQVJST1dTX0xFTkdUSCwgLUFSUk9XU19WRVJUSUNBTF9TUEFDRSAvIDIgKVxyXG4gICAgLmxpbmVUbyggQVJST1dTX0xFTkdUSCwgLUFSUk9XU19WRVJUSUNBTF9TUEFDRSAvIDIgKyAwLjAwMDAxICkgLy8gc2VlIGlzc3VlICMxMDRcclxuICAgIC5hcmMoIEFSUk9XU19MRU5HVEgsIC1BUlJPV1NfSEVBRF9SQURJVVMgLSAoIEFSUk9XU19WRVJUSUNBTF9TUEFDRSAvIDIgKSwgQVJST1dTX0hFQURfUkFESVVTLCAwLjUgKiBNYXRoLlBJLCAwLjUgKiBNYXRoLlBJICsgQVJST1dTX0hFQURfQU5HTEVfREVMVEEgKVxyXG4gICAgLy8gYm90dG9tIGFycm93LCBwb2ludHMgbGVmdFxyXG4gICAgLm1vdmVUbyggQVJST1dTX0xFTkdUSCwgQVJST1dTX1ZFUlRJQ0FMX1NQQUNFIC8gMiApXHJcbiAgICAubGluZVRvKCAwLCBBUlJPV1NfVkVSVElDQUxfU1BBQ0UgLyAyIClcclxuICAgIC5saW5lVG8oIDAsIEFSUk9XU19WRVJUSUNBTF9TUEFDRSAvIDIgKyAwLjAwMDAxICkgLy8gc2VlIGlzc3VlICMxMDRcclxuICAgIC5hcmMoIDAsIEFSUk9XU19IRUFEX1JBRElVUyArICggQVJST1dTX1ZFUlRJQ0FMX1NQQUNFIC8gMiApLCBBUlJPV1NfSEVBRF9SQURJVVMsIC0wLjUgKiBNYXRoLlBJLCAtMC41ICogTWF0aC5QSSArIEFSUk9XU19IRUFEX0FOR0xFX0RFTFRBICk7XHJcbiAgcmV0dXJuIG5ldyBWQm94KCB7XHJcbiAgICBzcGFjaW5nOiBWQk9YX1NQQUNJTkcsXHJcbiAgICBjaGlsZHJlbjogW1xyXG4gICAgICBuZXcgUGF0aCggc2hhcGUsIHsgc3Ryb2tlOiAnYmxhY2snIH0gKSxcclxuICAgICAgbmV3IFZTdHJ1dCggU1VCU0NSSVBUX0hFSUdIVCArIEZPTlRfU0laRSAvIDYgKVxyXG4gICAgXVxyXG4gIH0gKTtcclxuXHJcbn1cclxuXHJcbi8vIHNpbmdsZSBhcnJvdyB0byBpbmRpY2F0ZSBpcnJldmVyc2libGUgcmVhY3Rpb24sIHBvaW50cyByaWdodFxyXG5mdW5jdGlvbiBjcmVhdGVJcnJldmVyc2libGVBcnJvdygpOiBOb2RlIHtcclxuXHJcbiAgY29uc3Qgc2hhcGUgPSBuZXcgU2hhcGUoKVxyXG4gICAgLm1vdmVUbyggMCwgMCApXHJcbiAgICAubGluZVRvKCBBUlJPV1NfTEVOR1RILCAwIClcclxuICAgIC5saW5lVG8oIEFSUk9XU19MRU5HVEgsIDAuMDAwMDEgKSAvLyBzZWUgaXNzdWUgIzEwNFxyXG4gICAgLmFyYyggQVJST1dTX0xFTkdUSCwgLUFSUk9XU19IRUFEX1JBRElVUywgQVJST1dTX0hFQURfUkFESVVTLCAwLjUgKiBNYXRoLlBJLCAwLjUgKiBNYXRoLlBJICsgQVJST1dTX0hFQURfQU5HTEVfREVMVEEgKVxyXG4gICAgLm1vdmVUbyggMjUsIDAgKVxyXG4gICAgLmFyYyggQVJST1dTX0xFTkdUSCwgQVJST1dTX0hFQURfUkFESVVTLCBBUlJPV1NfSEVBRF9SQURJVVMsIC0wLjUgKiBNYXRoLlBJLCAtMC41ICogTWF0aC5QSSAtIEFSUk9XU19IRUFEX0FOR0xFX0RFTFRBLCB0cnVlICk7XHJcblxyXG4gIHJldHVybiBuZXcgVkJveCgge1xyXG4gICAgc3BhY2luZzogVkJPWF9TUEFDSU5HLFxyXG4gICAgY2hpbGRyZW46IFtcclxuICAgICAgbmV3IFBhdGgoIHNoYXBlLCB7IHN0cm9rZTogJ2JsYWNrJyB9ICksXHJcbiAgICAgIG5ldyBWU3RydXQoIFNVQlNDUklQVF9IRUlHSFQgKyBGT05UX1NJWkUgLyA0IClcclxuICAgIF1cclxuICB9ICk7XHJcbn1cclxuXHJcbmFjaWRCYXNlU29sdXRpb25zLnJlZ2lzdGVyKCAnUmVhY3Rpb25FcXVhdGlvbkZhY3RvcnknLCBSZWFjdGlvbkVxdWF0aW9uRmFjdG9yeSApO1xyXG5leHBvcnQgZGVmYXVsdCBSZWFjdGlvbkVxdWF0aW9uRmFjdG9yeTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQSxTQUFTQSxLQUFLLFFBQVEsZ0NBQWdDO0FBQ3RELE9BQU9DLFdBQVcsTUFBTSw0Q0FBNEM7QUFDcEUsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxRQUFRLEVBQUVDLFVBQVUsRUFBRUMsSUFBSSxFQUFFQyxNQUFNLEVBQVFDLElBQUksRUFBRUMsUUFBUSxFQUFFQyxJQUFJLEVBQUVDLE1BQU0sUUFBUSxtQ0FBbUM7QUFDMUgsT0FBT0MsaUJBQWlC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