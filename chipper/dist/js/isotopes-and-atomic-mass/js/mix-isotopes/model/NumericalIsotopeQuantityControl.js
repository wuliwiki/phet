// Copyright 2015-2020, University of Colorado Boulder

/**
 * This class is the model representation of a numerical controller that allows the user to add or remove isotopes from
 * the test chamber. It is admittedly a little odd to have a class like this that is really more of a view sort of thing,
 * but it was needed in order to be consistent with the buckets, which are the other UI device that the user has for
 * moving isotopes into and out of the test chamber. The buckets must have a presence in the model so that the isotopes
 * that are outside of the chamber have somewhere to go, so this class allows buckets and other controls to be handled
 * consistently between the model and view.
 *
 * @author James Smith
 * @author Jesse Greenberg
 */

import Property from '../../../../axon/js/Property.js';
import isotopesAndAtomicMass from '../../isotopesAndAtomicMass.js';
import MovableAtom from './MovableAtom.js';

// constants
const CAPACITY = 100;
class NumericalIsotopeQuantityControl {
  /**
   * @param {MixIsotopesModel} model
   * @param {NumberAtom} isotopeConfig
   * @param {Vector2} position
   * @param {string} caption
   */
  constructor(model, isotopeConfig, position, caption) {
    this.quantityProperty = new Property(model.testChamber.getIsotopeCount(isotopeConfig)); // @public
    this.model = model; // @private
    this.isotopeConfig = isotopeConfig; // @public
    this.centerPosition = position; // @public
    this.caption = caption; // @public
  }

  /**
   * Set the quantity of the isotope associated with this control to the specified value.
   *
   * @param {number} targetQuantity
   *
   * @public
   */
  setIsotopeQuantity(targetQuantity) {
    assert && assert(targetQuantity <= CAPACITY);
    const changeAmount = targetQuantity - this.model.testChamber.getIsotopeCount(this.isotopeConfig);
    if (changeAmount > 0) {
      for (let i = 0; i < changeAmount; i++) {
        const newIsotope = new MovableAtom(this.isotopeConfig.protonCountProperty.get(), this.isotopeConfig.neutronCountProperty.get(), this.model.testChamber.generateRandomPosition());
        newIsotope.color = this.model.getColorForIsotope(this.isotopeConfig);
        newIsotope.massNumber = this.isotopeConfig.massNumberProperty.get();
        newIsotope.protonCount = this.isotopeConfig.protonCountProperty.get();
        newIsotope.radiusProperty.set(4);
        newIsotope.showLabel = false;
        this.model.testChamber.addIsotopeToChamber(newIsotope, true);
        this.model.isotopesList.add(newIsotope);
      }
    } else if (changeAmount < 0) {
      for (let j = 0; j < -changeAmount; j++) {
        const isotope = this.model.testChamber.removeIsotopeMatchingConfig(this.isotopeConfig);
        if (isotope !== null) {
          this.model.isotopesList.remove(isotope);
        }
      }
    }
  }

  // @public
  getBaseColor() {
    return this.model.getColorForIsotope(this.isotopeConfig);
  }

  // @public
  getQuantity() {
    // Verify that the internal property matches that of the test chamber.
    assert && assert(this.quantityProperty === this.model.testChamber.getIsotopeCount(this.isotopeConfig));
    // Return the value.
    return this.quantityProperty;
  }
}
isotopesAndAtomicMass.register('NumericalIsotopeQuantityControl', NumericalIsotopeQuantityControl);
export default NumericalIsotopeQuantityControl;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsImlzb3RvcGVzQW5kQXRvbWljTWFzcyIsIk1vdmFibGVBdG9tIiwiQ0FQQUNJVFkiLCJOdW1lcmljYWxJc290b3BlUXVhbnRpdHlDb250cm9sIiwiY29uc3RydWN0b3IiLCJtb2RlbCIsImlzb3RvcGVDb25maWciLCJwb3NpdGlvbiIsImNhcHRpb24iLCJxdWFudGl0eVByb3BlcnR5IiwidGVzdENoYW1iZXIiLCJnZXRJc290b3BlQ291bnQiLCJjZW50ZXJQb3NpdGlvbiIsInNldElzb3RvcGVRdWFudGl0eSIsInRhcmdldFF1YW50aXR5IiwiYXNzZXJ0IiwiY2hhbmdlQW1vdW50IiwiaSIsIm5ld0lzb3RvcGUiLCJwcm90b25Db3VudFByb3BlcnR5IiwiZ2V0IiwibmV1dHJvbkNvdW50UHJvcGVydHkiLCJnZW5lcmF0ZVJhbmRvbVBvc2l0aW9uIiwiY29sb3IiLCJnZXRDb2xvckZvcklzb3RvcGUiLCJtYXNzTnVtYmVyIiwibWFzc051bWJlclByb3BlcnR5IiwicHJvdG9uQ291bnQiLCJyYWRpdXNQcm9wZXJ0eSIsInNldCIsInNob3dMYWJlbCIsImFkZElzb3RvcGVUb0NoYW1iZXIiLCJpc290b3Blc0xpc3QiLCJhZGQiLCJqIiwiaXNvdG9wZSIsInJlbW92ZUlzb3RvcGVNYXRjaGluZ0NvbmZpZyIsInJlbW92ZSIsImdldEJhc2VDb2xvciIsImdldFF1YW50aXR5IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJOdW1lcmljYWxJc290b3BlUXVhbnRpdHlDb250cm9sLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE1LTIwMjAsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFRoaXMgY2xhc3MgaXMgdGhlIG1vZGVsIHJlcHJlc2VudGF0aW9uIG9mIGEgbnVtZXJpY2FsIGNvbnRyb2xsZXIgdGhhdCBhbGxvd3MgdGhlIHVzZXIgdG8gYWRkIG9yIHJlbW92ZSBpc290b3BlcyBmcm9tXHJcbiAqIHRoZSB0ZXN0IGNoYW1iZXIuIEl0IGlzIGFkbWl0dGVkbHkgYSBsaXR0bGUgb2RkIHRvIGhhdmUgYSBjbGFzcyBsaWtlIHRoaXMgdGhhdCBpcyByZWFsbHkgbW9yZSBvZiBhIHZpZXcgc29ydCBvZiB0aGluZyxcclxuICogYnV0IGl0IHdhcyBuZWVkZWQgaW4gb3JkZXIgdG8gYmUgY29uc2lzdGVudCB3aXRoIHRoZSBidWNrZXRzLCB3aGljaCBhcmUgdGhlIG90aGVyIFVJIGRldmljZSB0aGF0IHRoZSB1c2VyIGhhcyBmb3JcclxuICogbW92aW5nIGlzb3RvcGVzIGludG8gYW5kIG91dCBvZiB0aGUgdGVzdCBjaGFtYmVyLiBUaGUgYnVja2V0cyBtdXN0IGhhdmUgYSBwcmVzZW5jZSBpbiB0aGUgbW9kZWwgc28gdGhhdCB0aGUgaXNvdG9wZXNcclxuICogdGhhdCBhcmUgb3V0c2lkZSBvZiB0aGUgY2hhbWJlciBoYXZlIHNvbWV3aGVyZSB0byBnbywgc28gdGhpcyBjbGFzcyBhbGxvd3MgYnVja2V0cyBhbmQgb3RoZXIgY29udHJvbHMgdG8gYmUgaGFuZGxlZFxyXG4gKiBjb25zaXN0ZW50bHkgYmV0d2VlbiB0aGUgbW9kZWwgYW5kIHZpZXcuXHJcbiAqXHJcbiAqIEBhdXRob3IgSmFtZXMgU21pdGhcclxuICogQGF1dGhvciBKZXNzZSBHcmVlbmJlcmdcclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBpc290b3Blc0FuZEF0b21pY01hc3MgZnJvbSAnLi4vLi4vaXNvdG9wZXNBbmRBdG9taWNNYXNzLmpzJztcclxuaW1wb3J0IE1vdmFibGVBdG9tIGZyb20gJy4vTW92YWJsZUF0b20uanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IENBUEFDSVRZID0gMTAwO1xyXG5cclxuY2xhc3MgTnVtZXJpY2FsSXNvdG9wZVF1YW50aXR5Q29udHJvbCB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7TWl4SXNvdG9wZXNNb2RlbH0gbW9kZWxcclxuICAgKiBAcGFyYW0ge051bWJlckF0b219IGlzb3RvcGVDb25maWdcclxuICAgKiBAcGFyYW0ge1ZlY3RvcjJ9IHBvc2l0aW9uXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGNhcHRpb25cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbW9kZWwsIGlzb3RvcGVDb25maWcsIHBvc2l0aW9uLCBjYXB0aW9uICkge1xyXG5cclxuICAgIHRoaXMucXVhbnRpdHlQcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eSggbW9kZWwudGVzdENoYW1iZXIuZ2V0SXNvdG9wZUNvdW50KCBpc290b3BlQ29uZmlnICkgKTsgLy8gQHB1YmxpY1xyXG4gICAgdGhpcy5tb2RlbCA9IG1vZGVsOyAvLyBAcHJpdmF0ZVxyXG4gICAgdGhpcy5pc290b3BlQ29uZmlnID0gaXNvdG9wZUNvbmZpZzsgLy8gQHB1YmxpY1xyXG4gICAgdGhpcy5jZW50ZXJQb3NpdGlvbiA9IHBvc2l0aW9uOyAvLyBAcHVibGljXHJcbiAgICB0aGlzLmNhcHRpb24gPSBjYXB0aW9uOyAvLyBAcHVibGljXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgdGhlIHF1YW50aXR5IG9mIHRoZSBpc290b3BlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGNvbnRyb2wgdG8gdGhlIHNwZWNpZmllZCB2YWx1ZS5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB0YXJnZXRRdWFudGl0eVxyXG4gICAqXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIHNldElzb3RvcGVRdWFudGl0eSggdGFyZ2V0UXVhbnRpdHkgKSB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0YXJnZXRRdWFudGl0eSA8PSBDQVBBQ0lUWSApO1xyXG4gICAgY29uc3QgY2hhbmdlQW1vdW50ID0gdGFyZ2V0UXVhbnRpdHkgLSB0aGlzLm1vZGVsLnRlc3RDaGFtYmVyLmdldElzb3RvcGVDb3VudCggdGhpcy5pc290b3BlQ29uZmlnICk7XHJcblxyXG4gICAgaWYgKCBjaGFuZ2VBbW91bnQgPiAwICkge1xyXG4gICAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBjaGFuZ2VBbW91bnQ7IGkrKyApIHtcclxuICAgICAgICBjb25zdCBuZXdJc290b3BlID0gbmV3IE1vdmFibGVBdG9tKCB0aGlzLmlzb3RvcGVDb25maWcucHJvdG9uQ291bnRQcm9wZXJ0eS5nZXQoKSxcclxuICAgICAgICAgIHRoaXMuaXNvdG9wZUNvbmZpZy5uZXV0cm9uQ291bnRQcm9wZXJ0eS5nZXQoKSxcclxuICAgICAgICAgIHRoaXMubW9kZWwudGVzdENoYW1iZXIuZ2VuZXJhdGVSYW5kb21Qb3NpdGlvbigpICk7XHJcbiAgICAgICAgbmV3SXNvdG9wZS5jb2xvciA9IHRoaXMubW9kZWwuZ2V0Q29sb3JGb3JJc290b3BlKCB0aGlzLmlzb3RvcGVDb25maWcgKTtcclxuICAgICAgICBuZXdJc290b3BlLm1hc3NOdW1iZXIgPSB0aGlzLmlzb3RvcGVDb25maWcubWFzc051bWJlclByb3BlcnR5LmdldCgpO1xyXG4gICAgICAgIG5ld0lzb3RvcGUucHJvdG9uQ291bnQgPSB0aGlzLmlzb3RvcGVDb25maWcucHJvdG9uQ291bnRQcm9wZXJ0eS5nZXQoKTtcclxuICAgICAgICBuZXdJc290b3BlLnJhZGl1c1Byb3BlcnR5LnNldCggNCApO1xyXG4gICAgICAgIG5ld0lzb3RvcGUuc2hvd0xhYmVsID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5tb2RlbC50ZXN0Q2hhbWJlci5hZGRJc290b3BlVG9DaGFtYmVyKCBuZXdJc290b3BlLCB0cnVlICk7XHJcbiAgICAgICAgdGhpcy5tb2RlbC5pc290b3Blc0xpc3QuYWRkKCBuZXdJc290b3BlICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBjaGFuZ2VBbW91bnQgPCAwICkge1xyXG4gICAgICBmb3IgKCBsZXQgaiA9IDA7IGogPCAtY2hhbmdlQW1vdW50OyBqKysgKSB7XHJcbiAgICAgICAgY29uc3QgaXNvdG9wZSA9IHRoaXMubW9kZWwudGVzdENoYW1iZXIucmVtb3ZlSXNvdG9wZU1hdGNoaW5nQ29uZmlnKCB0aGlzLmlzb3RvcGVDb25maWcgKTtcclxuICAgICAgICBpZiAoIGlzb3RvcGUgIT09IG51bGwgKSB7XHJcbiAgICAgICAgICB0aGlzLm1vZGVsLmlzb3RvcGVzTGlzdC5yZW1vdmUoIGlzb3RvcGUgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEBwdWJsaWNcclxuICBnZXRCYXNlQ29sb3IoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5tb2RlbC5nZXRDb2xvckZvcklzb3RvcGUoIHRoaXMuaXNvdG9wZUNvbmZpZyApO1xyXG4gIH1cclxuXHJcbiAgLy8gQHB1YmxpY1xyXG4gIGdldFF1YW50aXR5KCkge1xyXG4gICAgLy8gVmVyaWZ5IHRoYXQgdGhlIGludGVybmFsIHByb3BlcnR5IG1hdGNoZXMgdGhhdCBvZiB0aGUgdGVzdCBjaGFtYmVyLlxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5xdWFudGl0eVByb3BlcnR5ID09PSB0aGlzLm1vZGVsLnRlc3RDaGFtYmVyLmdldElzb3RvcGVDb3VudCggdGhpcy5pc290b3BlQ29uZmlnICkgKTtcclxuICAgIC8vIFJldHVybiB0aGUgdmFsdWUuXHJcbiAgICByZXR1cm4gdGhpcy5xdWFudGl0eVByb3BlcnR5O1xyXG4gIH1cclxufVxyXG5cclxuaXNvdG9wZXNBbmRBdG9taWNNYXNzLnJlZ2lzdGVyKCAnTnVtZXJpY2FsSXNvdG9wZVF1YW50aXR5Q29udHJvbCcsIE51bWVyaWNhbElzb3RvcGVRdWFudGl0eUNvbnRyb2wgKTtcclxuZXhwb3J0IGRlZmF1bHQgTnVtZXJpY2FsSXNvdG9wZVF1YW50aXR5Q29udHJvbDtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9B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