// Copyright 2021, University of Colorado Boulder

/**
 * Arbitrary-precision LU Decomposition using decimal.js and copy-pasted from LUDecomposition.
 * This is a copy-paste implementation so that the performance characteristics of LUDecomposition are not disturbed.
 * This file should be maintained with LUDecomposition.js
 *
 * This module requires the presence of the preload Decimal.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 * @author Sam Reid (PhET Interactive Simulations)
 */

import dot from './dot.js';
class LUDecompositionDecimal {
  /**
   * @param matrix
   * @param {constructor} Decimal - from decimal library
   */
  constructor(matrix, Decimal) {
    let i;
    let j;
    let k;
    this.matrix = matrix;

    // TODO: size!
    this.LU = [];
    matrix.entries.forEach(entry => {
      this.LU.push(new Decimal(entry));
    });
    const LU = this.LU;
    this.m = matrix.getRowDimension();
    const m = this.m;
    this.n = matrix.getColumnDimension();
    const n = this.n;
    this.piv = new Uint32Array(m);
    for (i = 0; i < m; i++) {
      this.piv[i] = i;
    }
    this.pivsign = 1;
    const LUcolj = new Array(m);

    // Outer loop.

    for (j = 0; j < n; j++) {
      // Make a copy of the j-th column to localize references.
      for (i = 0; i < m; i++) {
        LUcolj[i] = new Decimal(LU[matrix.index(i, j)]);
      }

      // Apply previous transformations.

      for (i = 0; i < m; i++) {
        // Most of the time is spent in the following dot product.
        const kmax = Math.min(i, j);
        let s = new Decimal(0);
        for (k = 0; k < kmax; k++) {
          const ik = matrix.index(i, k);
          const a = new Decimal(LU[ik]);
          const b = LUcolj[k];
          s = s.plus(a.times(b));
        }
        LUcolj[i] = LUcolj[i].minus(s);
        LU[matrix.index(i, j)] = LUcolj[i];
      }

      // Find pivot and exchange if necessary.

      let p = j;
      for (i = j + 1; i < m; i++) {
        if (LUcolj[i].abs() > LUcolj[p].abs()) {
          p = i;
        }
      }
      if (p !== j) {
        for (k = 0; k < n; k++) {
          const pk = matrix.index(p, k);
          const jk = matrix.index(j, k);
          const t = LU[pk];
          LU[pk] = LU[jk];
          LU[jk] = t;
        }
        k = this.piv[p];
        this.piv[p] = this.piv[j];
        this.piv[j] = k;
        this.pivsign = -this.pivsign;
      }

      // Compute multipliers.

      if (j < m && !LU[this.matrix.index(j, j)].isZero()) {
        for (i = j + 1; i < m; i++) {
          LU[matrix.index(i, j)] = LU[matrix.index(i, j)].dividedBy(LU[matrix.index(j, j)]);
        }
      }
    }
  }

  /**
   * @public
   *
   * @returns {boolean}
   */
  isNonsingular() {
    for (let j = 0; j < this.n; j++) {
      const index = this.matrix.index(j, j);
      if (this.LU[index].isZero()) {
        return false;
      }
    }
    return true;
  }

  /**
   * @public
   *
   * @param {Matrix} matrix
   * @param {constructor} Decimal - from decimal library
   * @returns {Matrix}
   */
  solve(matrix, Decimal) {
    let i;
    let j;
    let k;
    if (matrix.getRowDimension() !== this.m) {
      throw new Error('Matrix row dimensions must agree.');
    }
    if (!this.isNonsingular()) {
      throw new Error('Matrix is singular.');
    }

    // Copy right hand side with pivoting
    const nx = matrix.getColumnDimension();
    const Xmat = matrix.getArrayRowMatrix(this.piv, 0, nx - 1);
    const entries = [];
    Xmat.entries.forEach(e => entries.push(new Decimal(e)));

    // Solve L*Y = B(piv,:)
    for (k = 0; k < this.n; k++) {
      for (i = k + 1; i < this.n; i++) {
        for (j = 0; j < nx; j++) {
          entries[Xmat.index(i, j)] = entries[Xmat.index(i, j)].minus(entries[Xmat.index(k, j)].times(this.LU[this.matrix.index(i, k)]));
        }
      }
    }

    // Solve U*X = Y;
    for (k = this.n - 1; k >= 0; k--) {
      for (j = 0; j < nx; j++) {
        entries[Xmat.index(k, j)] = entries[Xmat.index(k, j)].dividedBy(this.LU[this.matrix.index(k, k)]);
      }
      for (i = 0; i < k; i++) {
        for (j = 0; j < nx; j++) {
          entries[Xmat.index(i, j)] = entries[Xmat.index(i, j)].minus(entries[Xmat.index(k, j)].times(this.LU[this.matrix.index(i, k)]));
        }
      }
    }
    Xmat.entries = entries.map(e => e.toNumber());
    return Xmat;
  }
}
dot.register('LUDecompositionDecimal', LUDecompositionDecimal);
export default LUDecompositionDecimal;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkb3QiLCJMVURlY29tcG9zaXRpb25EZWNpbWFsIiwiY29uc3RydWN0b3IiLCJtYXRyaXgiLCJEZWNpbWFsIiwiaSIsImoiLCJrIiwiTFUiLCJlbnRyaWVzIiwiZm9yRWFjaCIsImVudHJ5IiwicHVzaCIsIm0iLCJnZXRSb3dEaW1lbnNpb24iLCJuIiwiZ2V0Q29sdW1uRGltZW5zaW9uIiwicGl2IiwiVWludDMyQXJyYXkiLCJwaXZzaWduIiwiTFVjb2xqIiwiQXJyYXkiLCJpbmRleCIsImttYXgiLCJNYXRoIiwibWluIiwicyIsImlrIiwiYSIsImIiLCJwbHVzIiwidGltZXMiLCJtaW51cyIsInAiLCJhYnMiLCJwayIsImprIiwidCIsImlzWmVybyIsImRpdmlkZWRCeSIsImlzTm9uc2luZ3VsYXIiLCJzb2x2ZSIsIkVycm9yIiwibngiLCJYbWF0IiwiZ2V0QXJyYXlSb3dNYXRyaXgiLCJlIiwibWFwIiwidG9OdW1iZXIiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkxVRGVjb21wb3NpdGlvbkRlY2ltYWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjEsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEFyYml0cmFyeS1wcmVjaXNpb24gTFUgRGVjb21wb3NpdGlvbiB1c2luZyBkZWNpbWFsLmpzIGFuZCBjb3B5LXBhc3RlZCBmcm9tIExVRGVjb21wb3NpdGlvbi5cclxuICogVGhpcyBpcyBhIGNvcHktcGFzdGUgaW1wbGVtZW50YXRpb24gc28gdGhhdCB0aGUgcGVyZm9ybWFuY2UgY2hhcmFjdGVyaXN0aWNzIG9mIExVRGVjb21wb3NpdGlvbiBhcmUgbm90IGRpc3R1cmJlZC5cclxuICogVGhpcyBmaWxlIHNob3VsZCBiZSBtYWludGFpbmVkIHdpdGggTFVEZWNvbXBvc2l0aW9uLmpzXHJcbiAqXHJcbiAqIFRoaXMgbW9kdWxlIHJlcXVpcmVzIHRoZSBwcmVzZW5jZSBvZiB0aGUgcHJlbG9hZCBEZWNpbWFsLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IGRvdCBmcm9tICcuL2RvdC5qcyc7XHJcblxyXG5jbGFzcyBMVURlY29tcG9zaXRpb25EZWNpbWFsIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIG1hdHJpeFxyXG4gICAqIEBwYXJhbSB7Y29uc3RydWN0b3J9IERlY2ltYWwgLSBmcm9tIGRlY2ltYWwgbGlicmFyeVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBtYXRyaXgsIERlY2ltYWwgKSB7XHJcbiAgICBsZXQgaTtcclxuICAgIGxldCBqO1xyXG4gICAgbGV0IGs7XHJcblxyXG4gICAgdGhpcy5tYXRyaXggPSBtYXRyaXg7XHJcblxyXG4gICAgLy8gVE9ETzogc2l6ZSFcclxuICAgIHRoaXMuTFUgPSBbXTtcclxuICAgIG1hdHJpeC5lbnRyaWVzLmZvckVhY2goIGVudHJ5ID0+IHtcclxuICAgICAgdGhpcy5MVS5wdXNoKCBuZXcgRGVjaW1hbCggZW50cnkgKSApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IExVID0gdGhpcy5MVTtcclxuICAgIHRoaXMubSA9IG1hdHJpeC5nZXRSb3dEaW1lbnNpb24oKTtcclxuICAgIGNvbnN0IG0gPSB0aGlzLm07XHJcbiAgICB0aGlzLm4gPSBtYXRyaXguZ2V0Q29sdW1uRGltZW5zaW9uKCk7XHJcbiAgICBjb25zdCBuID0gdGhpcy5uO1xyXG4gICAgdGhpcy5waXYgPSBuZXcgVWludDMyQXJyYXkoIG0gKTtcclxuICAgIGZvciAoIGkgPSAwOyBpIDwgbTsgaSsrICkge1xyXG4gICAgICB0aGlzLnBpdlsgaSBdID0gaTtcclxuICAgIH1cclxuICAgIHRoaXMucGl2c2lnbiA9IDE7XHJcbiAgICBjb25zdCBMVWNvbGogPSBuZXcgQXJyYXkoIG0gKTtcclxuXHJcbiAgICAvLyBPdXRlciBsb29wLlxyXG5cclxuICAgIGZvciAoIGogPSAwOyBqIDwgbjsgaisrICkge1xyXG5cclxuICAgICAgLy8gTWFrZSBhIGNvcHkgb2YgdGhlIGotdGggY29sdW1uIHRvIGxvY2FsaXplIHJlZmVyZW5jZXMuXHJcbiAgICAgIGZvciAoIGkgPSAwOyBpIDwgbTsgaSsrICkge1xyXG4gICAgICAgIExVY29salsgaSBdID0gbmV3IERlY2ltYWwoIExVWyBtYXRyaXguaW5kZXgoIGksIGogKSBdICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEFwcGx5IHByZXZpb3VzIHRyYW5zZm9ybWF0aW9ucy5cclxuXHJcbiAgICAgIGZvciAoIGkgPSAwOyBpIDwgbTsgaSsrICkge1xyXG4gICAgICAgIC8vIE1vc3Qgb2YgdGhlIHRpbWUgaXMgc3BlbnQgaW4gdGhlIGZvbGxvd2luZyBkb3QgcHJvZHVjdC5cclxuICAgICAgICBjb25zdCBrbWF4ID0gTWF0aC5taW4oIGksIGogKTtcclxuICAgICAgICBsZXQgcyA9IG5ldyBEZWNpbWFsKCAwICk7XHJcbiAgICAgICAgZm9yICggayA9IDA7IGsgPCBrbWF4OyBrKysgKSB7XHJcbiAgICAgICAgICBjb25zdCBpayA9IG1hdHJpeC5pbmRleCggaSwgayApO1xyXG4gICAgICAgICAgY29uc3QgYSA9IG5ldyBEZWNpbWFsKCBMVVsgaWsgXSApO1xyXG4gICAgICAgICAgY29uc3QgYiA9IExVY29salsgayBdO1xyXG4gICAgICAgICAgcyA9IHMucGx1cyggYS50aW1lcyggYiApICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBMVWNvbGpbIGkgXSA9IExVY29salsgaSBdLm1pbnVzKCBzICk7XHJcbiAgICAgICAgTFVbIG1hdHJpeC5pbmRleCggaSwgaiApIF0gPSBMVWNvbGpbIGkgXTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRmluZCBwaXZvdCBhbmQgZXhjaGFuZ2UgaWYgbmVjZXNzYXJ5LlxyXG5cclxuICAgICAgbGV0IHAgPSBqO1xyXG4gICAgICBmb3IgKCBpID0gaiArIDE7IGkgPCBtOyBpKysgKSB7XHJcbiAgICAgICAgaWYgKCBMVWNvbGpbIGkgXS5hYnMoKSA+IExVY29salsgcCBdLmFicygpICkge1xyXG4gICAgICAgICAgcCA9IGk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmICggcCAhPT0gaiApIHtcclxuICAgICAgICBmb3IgKCBrID0gMDsgayA8IG47IGsrKyApIHtcclxuICAgICAgICAgIGNvbnN0IHBrID0gbWF0cml4LmluZGV4KCBwLCBrICk7XHJcbiAgICAgICAgICBjb25zdCBqayA9IG1hdHJpeC5pbmRleCggaiwgayApO1xyXG4gICAgICAgICAgY29uc3QgdCA9IExVWyBwayBdO1xyXG4gICAgICAgICAgTFVbIHBrIF0gPSBMVVsgamsgXTtcclxuICAgICAgICAgIExVWyBqayBdID0gdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgayA9IHRoaXMucGl2WyBwIF07XHJcbiAgICAgICAgdGhpcy5waXZbIHAgXSA9IHRoaXMucGl2WyBqIF07XHJcbiAgICAgICAgdGhpcy5waXZbIGogXSA9IGs7XHJcbiAgICAgICAgdGhpcy5waXZzaWduID0gLXRoaXMucGl2c2lnbjtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ29tcHV0ZSBtdWx0aXBsaWVycy5cclxuXHJcbiAgICAgIGlmICggaiA8IG0gJiYgIUxVWyB0aGlzLm1hdHJpeC5pbmRleCggaiwgaiApIF0uaXNaZXJvKCkgKSB7XHJcbiAgICAgICAgZm9yICggaSA9IGogKyAxOyBpIDwgbTsgaSsrICkge1xyXG4gICAgICAgICAgTFVbIG1hdHJpeC5pbmRleCggaSwgaiApIF0gPSBMVVsgbWF0cml4LmluZGV4KCBpLCBqICkgXS5kaXZpZGVkQnkoIExVWyBtYXRyaXguaW5kZXgoIGosIGogKSBdICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgKi9cclxuICBpc05vbnNpbmd1bGFyKCkge1xyXG4gICAgZm9yICggbGV0IGogPSAwOyBqIDwgdGhpcy5uOyBqKysgKSB7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5tYXRyaXguaW5kZXgoIGosIGogKTtcclxuICAgICAgaWYgKCB0aGlzLkxVWyBpbmRleCBdLmlzWmVybygpICkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge01hdHJpeH0gbWF0cml4XHJcbiAgICogQHBhcmFtIHtjb25zdHJ1Y3Rvcn0gRGVjaW1hbCAtIGZyb20gZGVjaW1hbCBsaWJyYXJ5XHJcbiAgICogQHJldHVybnMge01hdHJpeH1cclxuICAgKi9cclxuICBzb2x2ZSggbWF0cml4LCBEZWNpbWFsICkge1xyXG4gICAgbGV0IGk7XHJcbiAgICBsZXQgajtcclxuICAgIGxldCBrO1xyXG4gICAgaWYgKCBtYXRyaXguZ2V0Um93RGltZW5zaW9uKCkgIT09IHRoaXMubSApIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCAnTWF0cml4IHJvdyBkaW1lbnNpb25zIG11c3QgYWdyZWUuJyApO1xyXG4gICAgfVxyXG4gICAgaWYgKCAhdGhpcy5pc05vbnNpbmd1bGFyKCkgKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvciggJ01hdHJpeCBpcyBzaW5ndWxhci4nICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ29weSByaWdodCBoYW5kIHNpZGUgd2l0aCBwaXZvdGluZ1xyXG4gICAgY29uc3QgbnggPSBtYXRyaXguZ2V0Q29sdW1uRGltZW5zaW9uKCk7XHJcbiAgICBjb25zdCBYbWF0ID0gbWF0cml4LmdldEFycmF5Um93TWF0cml4KCB0aGlzLnBpdiwgMCwgbnggLSAxICk7XHJcbiAgICBjb25zdCBlbnRyaWVzID0gW107XHJcbiAgICBYbWF0LmVudHJpZXMuZm9yRWFjaCggZSA9PiBlbnRyaWVzLnB1c2goIG5ldyBEZWNpbWFsKCBlICkgKSApO1xyXG5cclxuICAgIC8vIFNvbHZlIEwqWSA9IEIocGl2LDopXHJcbiAgICBmb3IgKCBrID0gMDsgayA8IHRoaXMubjsgaysrICkge1xyXG4gICAgICBmb3IgKCBpID0gayArIDE7IGkgPCB0aGlzLm47IGkrKyApIHtcclxuICAgICAgICBmb3IgKCBqID0gMDsgaiA8IG54OyBqKysgKSB7XHJcbiAgICAgICAgICBlbnRyaWVzWyBYbWF0LmluZGV4KCBpLCBqICkgXSA9IGVudHJpZXNbIFhtYXQuaW5kZXgoIGksIGogKSBdLm1pbnVzKCBlbnRyaWVzWyBYbWF0LmluZGV4KCBrLCBqICkgXS50aW1lcyggdGhpcy5MVVsgdGhpcy5tYXRyaXguaW5kZXgoIGksIGsgKSBdICkgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBTb2x2ZSBVKlggPSBZO1xyXG4gICAgZm9yICggayA9IHRoaXMubiAtIDE7IGsgPj0gMDsgay0tICkge1xyXG4gICAgICBmb3IgKCBqID0gMDsgaiA8IG54OyBqKysgKSB7XHJcbiAgICAgICAgZW50cmllc1sgWG1hdC5pbmRleCggaywgaiApIF0gPSBlbnRyaWVzWyBYbWF0LmluZGV4KCBrLCBqICkgXS5kaXZpZGVkQnkoIHRoaXMuTFVbIHRoaXMubWF0cml4LmluZGV4KCBrLCBrICkgXSApO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoIGkgPSAwOyBpIDwgazsgaSsrICkge1xyXG4gICAgICAgIGZvciAoIGogPSAwOyBqIDwgbng7IGorKyApIHtcclxuICAgICAgICAgIGVudHJpZXNbIFhtYXQuaW5kZXgoIGksIGogKSBdID0gZW50cmllc1sgWG1hdC5pbmRleCggaSwgaiApIF0ubWludXMoIGVudHJpZXNbIFhtYXQuaW5kZXgoIGssIGogKSBdLnRpbWVzKCB0aGlzLkxVWyB0aGlzLm1hdHJpeC5pbmRleCggaSwgayApIF0gKSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIFhtYXQuZW50cmllcyA9IGVudHJpZXMubWFwKCBlID0+IGUudG9OdW1iZXIoKSApO1xyXG4gICAgcmV0dXJuIFhtYXQ7XHJcbiAgfVxyXG59XHJcblxyXG5kb3QucmVnaXN0ZXIoICdMVURlY29tcG9zaXRpb25EZWNpbWFsJywgTFVEZWNvbXBvc2l0aW9uRGVjaW1hbCApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTFVEZWNvbXBvc2l0aW9uRGVjaW1hbDsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLEdBQUcsTUFBTSxVQUFVO0FBRTFCLE1BQU1DLHNCQUFzQixDQUFDO0VBRTNCO0FBQ0Y7QUFDQTtBQUNBO0VBQ0VDLFdBQVdBLENBQUVDLE1BQU0sRUFBRUMsT0FBTyxFQUFHO0lBQzdCLElBQUlDLENBQUM7SUFDTCxJQUFJQyxDQUFDO0lBQ0wsSUFBSUMsQ0FBQztJQUVMLElBQUksQ0FBQ0osTUFBTSxHQUFHQSxNQUFNOztJQUVwQjtJQUNBLElBQUksQ0FBQ0ssRUFBRSxHQUFHLEVBQUU7SUFDWkwsTUFBTSxDQUFDTSxPQUFPLENBQUNDLE9BQU8sQ0FBRUMsS0FBSyxJQUFJO01BQy9CLElBQUksQ0FBQ0gsRUFBRSxDQUFDSSxJQUFJLENBQUUsSUFBSVIsT0FBTyxDQUFFTyxLQUFNLENBQUUsQ0FBQztJQUN0QyxDQUFFLENBQUM7SUFFSCxNQUFNSCxFQUFFLEdBQUcsSUFBSSxDQUFDQSxFQUFFO0lBQ2xCLElBQUksQ0FBQ0ssQ0FBQyxHQUFHVixNQUFNLENBQUNXLGVBQWUsQ0FBQyxDQUFDO0lBQ2pDLE1BQU1ELENBQUMsR0FBRyxJQUFJLENBQUNBLENBQUM7SUFDaEIsSUFBSSxDQUFDRSxDQUFDLEdBQUdaLE1BQU0sQ0FBQ2Esa0JBQWtCLENBQUMsQ0FBQztJQUNwQyxNQUFNRCxDQUFDLEdBQUcsSUFBSSxDQUFDQSxDQUFDO0lBQ2hCLElBQUksQ0FBQ0UsR0FBRyxHQUFHLElBQUlDLFdBQVcsQ0FBRUwsQ0FBRSxDQUFDO0lBQy9CLEtBQU1SLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR1EsQ0FBQyxFQUFFUixDQUFDLEVBQUUsRUFBRztNQUN4QixJQUFJLENBQUNZLEdBQUcsQ0FBRVosQ0FBQyxDQUFFLEdBQUdBLENBQUM7SUFDbkI7SUFDQSxJQUFJLENBQUNjLE9BQU8sR0FBRyxDQUFDO0lBQ2hCLE1BQU1DLE1BQU0sR0FBRyxJQUFJQyxLQUFLLENBQUVSLENBQUUsQ0FBQzs7SUFFN0I7O0lBRUEsS0FBTVAsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHUyxDQUFDLEVBQUVULENBQUMsRUFBRSxFQUFHO01BRXhCO01BQ0EsS0FBTUQsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHUSxDQUFDLEVBQUVSLENBQUMsRUFBRSxFQUFHO1FBQ3hCZSxNQUFNLENBQUVmLENBQUMsQ0FBRSxHQUFHLElBQUlELE9BQU8sQ0FBRUksRUFBRSxDQUFFTCxNQUFNLENBQUNtQixLQUFLLENBQUVqQixDQUFDLEVBQUVDLENBQUUsQ0FBQyxDQUFHLENBQUM7TUFDekQ7O01BRUE7O01BRUEsS0FBTUQsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHUSxDQUFDLEVBQUVSLENBQUMsRUFBRSxFQUFHO1FBQ3hCO1FBQ0EsTUFBTWtCLElBQUksR0FBR0MsSUFBSSxDQUFDQyxHQUFHLENBQUVwQixDQUFDLEVBQUVDLENBQUUsQ0FBQztRQUM3QixJQUFJb0IsQ0FBQyxHQUFHLElBQUl0QixPQUFPLENBQUUsQ0FBRSxDQUFDO1FBQ3hCLEtBQU1HLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR2dCLElBQUksRUFBRWhCLENBQUMsRUFBRSxFQUFHO1VBQzNCLE1BQU1vQixFQUFFLEdBQUd4QixNQUFNLENBQUNtQixLQUFLLENBQUVqQixDQUFDLEVBQUVFLENBQUUsQ0FBQztVQUMvQixNQUFNcUIsQ0FBQyxHQUFHLElBQUl4QixPQUFPLENBQUVJLEVBQUUsQ0FBRW1CLEVBQUUsQ0FBRyxDQUFDO1VBQ2pDLE1BQU1FLENBQUMsR0FBR1QsTUFBTSxDQUFFYixDQUFDLENBQUU7VUFDckJtQixDQUFDLEdBQUdBLENBQUMsQ0FBQ0ksSUFBSSxDQUFFRixDQUFDLENBQUNHLEtBQUssQ0FBRUYsQ0FBRSxDQUFFLENBQUM7UUFDNUI7UUFFQVQsTUFBTSxDQUFFZixDQUFDLENBQUUsR0FBR2UsTUFBTSxDQUFFZixDQUFDLENBQUUsQ0FBQzJCLEtBQUssQ0FBRU4sQ0FBRSxDQUFDO1FBQ3BDbEIsRUFBRSxDQUFFTCxNQUFNLENBQUNtQixLQUFLLENBQUVqQixDQUFDLEVBQUVDLENBQUUsQ0FBQyxDQUFFLEdBQUdjLE1BQU0sQ0FBRWYsQ0FBQyxDQUFFO01BQzFDOztNQUVBOztNQUVBLElBQUk0QixDQUFDLEdBQUczQixDQUFDO01BQ1QsS0FBTUQsQ0FBQyxHQUFHQyxDQUFDLEdBQUcsQ0FBQyxFQUFFRCxDQUFDLEdBQUdRLENBQUMsRUFBRVIsQ0FBQyxFQUFFLEVBQUc7UUFDNUIsSUFBS2UsTUFBTSxDQUFFZixDQUFDLENBQUUsQ0FBQzZCLEdBQUcsQ0FBQyxDQUFDLEdBQUdkLE1BQU0sQ0FBRWEsQ0FBQyxDQUFFLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEVBQUc7VUFDM0NELENBQUMsR0FBRzVCLENBQUM7UUFDUDtNQUNGO01BQ0EsSUFBSzRCLENBQUMsS0FBSzNCLENBQUMsRUFBRztRQUNiLEtBQU1DLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR1EsQ0FBQyxFQUFFUixDQUFDLEVBQUUsRUFBRztVQUN4QixNQUFNNEIsRUFBRSxHQUFHaEMsTUFBTSxDQUFDbUIsS0FBSyxDQUFFVyxDQUFDLEVBQUUxQixDQUFFLENBQUM7VUFDL0IsTUFBTTZCLEVBQUUsR0FBR2pDLE1BQU0sQ0FBQ21CLEtBQUssQ0FBRWhCLENBQUMsRUFBRUMsQ0FBRSxDQUFDO1VBQy9CLE1BQU04QixDQUFDLEdBQUc3QixFQUFFLENBQUUyQixFQUFFLENBQUU7VUFDbEIzQixFQUFFLENBQUUyQixFQUFFLENBQUUsR0FBRzNCLEVBQUUsQ0FBRTRCLEVBQUUsQ0FBRTtVQUNuQjVCLEVBQUUsQ0FBRTRCLEVBQUUsQ0FBRSxHQUFHQyxDQUFDO1FBQ2Q7UUFDQTlCLENBQUMsR0FBRyxJQUFJLENBQUNVLEdBQUcsQ0FBRWdCLENBQUMsQ0FBRTtRQUNqQixJQUFJLENBQUNoQixHQUFHLENBQUVnQixDQUFDLENBQUUsR0FBRyxJQUFJLENBQUNoQixHQUFHLENBQUVYLENBQUMsQ0FBRTtRQUM3QixJQUFJLENBQUNXLEdBQUcsQ0FBRVgsQ0FBQyxDQUFFLEdBQUdDLENBQUM7UUFDakIsSUFBSSxDQUFDWSxPQUFPLEdBQUcsQ0FBQyxJQUFJLENBQUNBLE9BQU87TUFDOUI7O01BRUE7O01BRUEsSUFBS2IsQ0FBQyxHQUFHTyxDQUFDLElBQUksQ0FBQ0wsRUFBRSxDQUFFLElBQUksQ0FBQ0wsTUFBTSxDQUFDbUIsS0FBSyxDQUFFaEIsQ0FBQyxFQUFFQSxDQUFFLENBQUMsQ0FBRSxDQUFDZ0MsTUFBTSxDQUFDLENBQUMsRUFBRztRQUN4RCxLQUFNakMsQ0FBQyxHQUFHQyxDQUFDLEdBQUcsQ0FBQyxFQUFFRCxDQUFDLEdBQUdRLENBQUMsRUFBRVIsQ0FBQyxFQUFFLEVBQUc7VUFDNUJHLEVBQUUsQ0FBRUwsTUFBTSxDQUFDbUIsS0FBSyxDQUFFakIsQ0FBQyxFQUFFQyxDQUFFLENBQUMsQ0FBRSxHQUFHRSxFQUFFLENBQUVMLE1BQU0sQ0FBQ21CLEtBQUssQ0FBRWpCLENBQUMsRUFBRUMsQ0FBRSxDQUFDLENBQUUsQ0FBQ2lDLFNBQVMsQ0FBRS9CLEVBQUUsQ0FBRUwsTUFBTSxDQUFDbUIsS0FBSyxDQUFFaEIsQ0FBQyxFQUFFQSxDQUFFLENBQUMsQ0FBRyxDQUFDO1FBQ2pHO01BQ0Y7SUFDRjtFQUNGOztFQUVBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7RUFDRWtDLGFBQWFBLENBQUEsRUFBRztJQUNkLEtBQU0sSUFBSWxDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBRyxJQUFJLENBQUNTLENBQUMsRUFBRVQsQ0FBQyxFQUFFLEVBQUc7TUFDakMsTUFBTWdCLEtBQUssR0FBRyxJQUFJLENBQUNuQixNQUFNLENBQUNtQixLQUFLLENBQUVoQixDQUFDLEVBQUVBLENBQUUsQ0FBQztNQUN2QyxJQUFLLElBQUksQ0FBQ0UsRUFBRSxDQUFFYyxLQUFLLENBQUUsQ0FBQ2dCLE1BQU0sQ0FBQyxDQUFDLEVBQUc7UUFDL0IsT0FBTyxLQUFLO01BQ2Q7SUFDRjtJQUNBLE9BQU8sSUFBSTtFQUNiOztFQUVBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0VHLEtBQUtBLENBQUV0QyxNQUFNLEVBQUVDLE9BQU8sRUFBRztJQUN2QixJQUFJQyxDQUFDO0lBQ0wsSUFBSUMsQ0FBQztJQUNMLElBQUlDLENBQUM7SUFDTCxJQUFLSixNQUFNLENBQUNXLGVBQWUsQ0FBQyxDQUFDLEtBQUssSUFBSSxDQUFDRCxDQUFDLEVBQUc7TUFDekMsTUFBTSxJQUFJNkIsS0FBSyxDQUFFLG1DQUFvQyxDQUFDO0lBQ3hEO0lBQ0EsSUFBSyxDQUFDLElBQUksQ0FBQ0YsYUFBYSxDQUFDLENBQUMsRUFBRztNQUMzQixNQUFNLElBQUlFLEtBQUssQ0FBRSxxQkFBc0IsQ0FBQztJQUMxQzs7SUFFQTtJQUNBLE1BQU1DLEVBQUUsR0FBR3hDLE1BQU0sQ0FBQ2Esa0JBQWtCLENBQUMsQ0FBQztJQUN0QyxNQUFNNEIsSUFBSSxHQUFHekMsTUFBTSxDQUFDMEMsaUJBQWlCLENBQUUsSUFBSSxDQUFDNUIsR0FBRyxFQUFFLENBQUMsRUFBRTBCLEVBQUUsR0FBRyxDQUFFLENBQUM7SUFDNUQsTUFBTWxDLE9BQU8sR0FBRyxFQUFFO0lBQ2xCbUMsSUFBSSxDQUFDbkMsT0FBTyxDQUFDQyxPQUFPLENBQUVvQyxDQUFDLElBQUlyQyxPQUFPLENBQUNHLElBQUksQ0FBRSxJQUFJUixPQUFPLENBQUUwQyxDQUFFLENBQUUsQ0FBRSxDQUFDOztJQUU3RDtJQUNBLEtBQU12QyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUcsSUFBSSxDQUFDUSxDQUFDLEVBQUVSLENBQUMsRUFBRSxFQUFHO01BQzdCLEtBQU1GLENBQUMsR0FBR0UsQ0FBQyxHQUFHLENBQUMsRUFBRUYsQ0FBQyxHQUFHLElBQUksQ0FBQ1UsQ0FBQyxFQUFFVixDQUFDLEVBQUUsRUFBRztRQUNqQyxLQUFNQyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUdxQyxFQUFFLEVBQUVyQyxDQUFDLEVBQUUsRUFBRztVQUN6QkcsT0FBTyxDQUFFbUMsSUFBSSxDQUFDdEIsS0FBSyxDQUFFakIsQ0FBQyxFQUFFQyxDQUFFLENBQUMsQ0FBRSxHQUFHRyxPQUFPLENBQUVtQyxJQUFJLENBQUN0QixLQUFLLENBQUVqQixDQUFDLEVBQUVDLENBQUUsQ0FBQyxDQUFFLENBQUMwQixLQUFLLENBQUV2QixPQUFPLENBQUVtQyxJQUFJLENBQUN0QixLQUFLLENBQUVmLENBQUMsRUFBRUQsQ0FBRSxDQUFDLENBQUUsQ0FBQ3lCLEtBQUssQ0FBRSxJQUFJLENBQUN2QixFQUFFLENBQUUsSUFBSSxDQUFDTCxNQUFNLENBQUNtQixLQUFLLENBQUVqQixDQUFDLEVBQUVFLENBQUUsQ0FBQyxDQUFHLENBQUUsQ0FBQztRQUNwSjtNQUNGO0lBQ0Y7O0lBRUE7SUFDQSxLQUFNQSxDQUFDLEdBQUcsSUFBSSxDQUFDUSxDQUFDLEdBQUcsQ0FBQyxFQUFFUixDQUFDLElBQUksQ0FBQyxFQUFFQSxDQUFDLEVBQUUsRUFBRztNQUNsQyxLQUFNRCxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUdxQyxFQUFFLEVBQUVyQyxDQUFDLEVBQUUsRUFBRztRQUN6QkcsT0FBTyxDQUFFbUMsSUFBSSxDQUFDdEIsS0FBSyxDQUFFZixDQUFDLEVBQUVELENBQUUsQ0FBQyxDQUFFLEdBQUdHLE9BQU8sQ0FBRW1DLElBQUksQ0FBQ3RCLEtBQUssQ0FBRWYsQ0FBQyxFQUFFRCxDQUFFLENBQUMsQ0FBRSxDQUFDaUMsU0FBUyxDQUFFLElBQUksQ0FBQy9CLEVBQUUsQ0FBRSxJQUFJLENBQUNMLE1BQU0sQ0FBQ21CLEtBQUssQ0FBRWYsQ0FBQyxFQUFFQSxDQUFFLENBQUMsQ0FBRyxDQUFDO01BQ2pIO01BQ0EsS0FBTUYsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHRSxDQUFDLEVBQUVGLENBQUMsRUFBRSxFQUFHO1FBQ3hCLEtBQU1DLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR3FDLEVBQUUsRUFBRXJDLENBQUMsRUFBRSxFQUFHO1VBQ3pCRyxPQUFPLENBQUVtQyxJQUFJLENBQUN0QixLQUFLLENBQUVqQixDQUFDLEVBQUVDLENBQUUsQ0FBQyxDQUFFLEdBQUdHLE9BQU8sQ0FBRW1DLElBQUksQ0FBQ3RCLEtBQUssQ0FBRWpCLENBQUMsRUFBRUMsQ0FBRSxDQUFDLENBQUUsQ0FBQzBCLEtBQUssQ0FBRXZCLE9BQU8sQ0FBRW1DLElBQUksQ0FBQ3RCLEtBQUssQ0FBRWYsQ0FBQyxFQUFFRCxDQUFFLENBQUMsQ0FBRSxDQUFDeUIsS0FBSyxDQUFFLElBQUksQ0FBQ3ZCLEVBQUUsQ0FBRSxJQUFJLENBQUNMLE1BQU0sQ0FBQ21CLEtBQUssQ0FBRWpCLENBQUMsRUFBRUUsQ0FBRSxDQUFDLENBQUcsQ0FBRSxDQUFDO1FBQ3BKO01BQ0Y7SUFDRjtJQUVBcUMsSUFBSSxDQUFDbkMsT0FBTyxHQUFHQSxPQUFPLENBQUNzQyxHQUFHLENBQUVELENBQUMsSUFBSUEsQ0FBQyxDQUFDRSxRQUFRLENBQUMsQ0FBRSxDQUFDO0lBQy9DLE9BQU9KLElBQUk7RUFDYjtBQUNGO0FBRUE1QyxHQUFHLENBQUNpRCxRQUFRLENBQUUsd0JBQXdCLEVBQUVoRCxzQkFBdUIsQ0FBQztBQUVoRSxlQUFlQSxzQkFBc0IifQ==