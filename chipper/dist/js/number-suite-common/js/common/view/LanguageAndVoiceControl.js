// Copyright 2023, University of Colorado Boulder

/**
 * LanguageAndVoiceControl contains two carousels: one for selecting a language, and one for selecting a voice. For use
 * in the Preferences dialog.
 *
 * @author Chris Klusendorf (PhET Interactive Simulations)
 */

import numberSuiteCommon from '../../numberSuiteCommon.js';
import { Color, HBox, ManualConstraint, Node, RichText, Text, VBox } from '../../../../scenery/js/imports.js';
import optionize, { combineOptions } from '../../../../phet-core/js/optionize.js';
import Carousel from '../../../../sun/js/Carousel.js';
import CarouselItemNode from './CarouselItemNode.js';
import NumberSuiteCommonStrings from '../../NumberSuiteCommonStrings.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import Multilink from '../../../../axon/js/Multilink.js';
import PageControl from '../../../../sun/js/PageControl.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
const LABEL_TEXT_OPTIONS = {
  fontWeight: 'bold',
  fontSize: 16
};
const CAROUSEL_OPTIONS = {
  itemsPerPage: 10,
  spacing: 6,
  margin: 5,
  orientation: 'vertical'
};
const LABEL_Y_SPACING = 10;
export default class LanguageAndVoiceControl extends HBox {
  constructor(localeProperty, voiceProperty, utteranceQueue, providedOptions) {
    const options = optionize()({
      // HBoxOptions
      excludeInvisibleChildrenFromBounds: false,
      align: 'top',
      justify: 'left',
      spacing: 10
    }, providedOptions);

    // Carousel for choosing a language.
    const languageCarouselItems = localeProperty.validValues.map(locale => {
      return {
        locale: locale,
        createNode: () => new CarouselItemNode(localeProperty, locale, StringUtils.localeToLocalizedName(locale), `${locale}`, () => {
          localeProperty.value = locale;

          // Cancel any speech being read out that came from changing the locale, see https://github.com/phetsims/number-suite-common/issues/56#issuecomment-1480063879
          utteranceQueue.cancelSpeechDataSpeaking();

          // Read the test string in the first available voice for the new language, see https://github.com/phetsims/number-suite-common/issues/56
          utteranceQueue.speakTestVoice(voiceProperty.value, locale);
        })
      };
    });
    const languageCarousel = new Carousel(languageCarouselItems, CAROUSEL_OPTIONS);

    // Scroll the carousel so that the initial selection is shown. See https://github.com/phetsims/number-suite-common/issues/38
    const selectedNode = _.find(languageCarouselItems, item => item.locale === localeProperty.value);
    assert && assert(selectedNode);
    languageCarousel.scrollToItem(selectedNode);

    // Record the width of the language carousel for use to ensure the voice column matches. Width of the carousel
    // is dependent and controlled by the size of its content (see CarouselItemNode), use that width to ensure consistent
    // layout and content.
    const languageCarouselWidth = languageCarousel.width;
    const textOptions = combineOptions({
      maxWidth: languageCarouselWidth
    }, LABEL_TEXT_OPTIONS);
    const languageCarouselLabel = new Text(NumberSuiteCommonStrings.languageTitleStringProperty, textOptions);

    // Carousel for choosing a voice. Recreated when the language changes.
    let voiceCarousel = new Node();
    const voiceCarouselLabel = new Text(NumberSuiteCommonStrings.voiceStringProperty, textOptions);
    const noVoiceDescriptionNode = new NoVoiceDescriptionNode(languageCarouselWidth, languageCarousel.height);
    const pageControl = new PageControl(languageCarousel.pageNumberProperty, languageCarousel.numberOfPagesProperty, {
      orientation: 'vertical',
      pageFill: Color.WHITE,
      pageStroke: Color.BLACK,
      currentPageStroke: Color.BLACK,
      interactive: true,
      dotTouchAreaDilation: 5,
      dotMouseAreaDilation: 5,
      // Hide pageControl if there's only one page.
      visibleProperty: new DerivedProperty([languageCarousel.numberOfPagesProperty], numberOfPages => numberOfPages > 1)
    });
    const voiceControlVBox = new VBox({
      children: [voiceCarouselLabel, voiceCarousel],
      spacing: LABEL_Y_SPACING,
      align: 'left',
      layoutOptions: {
        minContentWidth: languageCarouselWidth
      }
    });
    const languageControlVBox = new VBox({
      children: [languageCarouselLabel, languageCarousel],
      spacing: LABEL_Y_SPACING,
      align: 'left'
    });
    options.children = [
    // Add an extra Node layer so we can move the pageControl with a ManualConstraint below and not create an infinite
    // loop with the alignment layout of this HBox.
    new Node({
      children: [pageControl]
    }), languageControlVBox, voiceControlVBox];
    super(options);

    // Keep the pageControl vertically centered next to the languageCarousel.
    ManualConstraint.create(this, [languageCarousel, pageControl], (languageCarouselProxy, pageControlProxy) => {
      pageControlProxy.centerY = languageCarouselProxy.centerY;
    });

    // Rebuild the voiceCarousel with the available voices when the locale changes or when voices become available
    Multilink.multilink([localeProperty, utteranceQueue.announcer.voicesProperty], (locale, voices) => {
      if (voices.length) {
        utteranceQueue.announcer.setFirstAvailableVoiceForLocale(locale, voiceProperty);
        const availableVoicesForLocale = utteranceQueue.announcer.getPrioritizedVoicesForLocale(locale);
        if (availableVoicesForLocale.length) {
          const voiceCarouselItems = availableVoicesForLocale.map(voice => {
            return {
              voice: voice,
              createNode: () => new CarouselItemNode(voiceProperty, voice, voice.name, voice.lang, () => {
                voiceProperty.value = voice;
                utteranceQueue.speakTestVoice(voice, locale);
              })
            };
          });
          voiceCarousel.dispose();
          voiceCarousel = new Carousel(voiceCarouselItems, CAROUSEL_OPTIONS);

          // Set the children so the new carousel is visible.
          voiceControlVBox.children = [voiceCarouselLabel, voiceCarousel];
        } else {
          // No available voices, so set the children so the noVoicesFoundDescriptionNode is visible instead of the voices.
          voiceControlVBox.children = [voiceCarouselLabel, noVoiceDescriptionNode];
        }
      }
    });
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
}

/**
 * Text for informing the user that there is no available voice for their selected language. The text wraps at the
 * provided width.
 */
class NoVoiceDescriptionNode extends VBox {
  constructor(maxWidth, maxHeight) {
    const richTextOptions = {
      font: new PhetFont(16),
      lineWrap: maxWidth
    };
    const noVoiceFoundDescriptionRichText = new RichText(NumberSuiteCommonStrings.noVoiceFoundDescriptionStringProperty, richTextOptions);
    const yourDeviceMaySupportDescriptionRichText = new RichText(NumberSuiteCommonStrings.yourDeviceMaySupportDescriptionStringProperty, richTextOptions);
    super({
      children: [noVoiceFoundDescriptionRichText, yourDeviceMaySupportDescriptionRichText],
      spacing: 20,
      align: 'left',
      maxHeight: maxHeight
    });
  }
}
numberSuiteCommon.register('LanguageAndVoiceControl', LanguageAndVoiceControl);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJudW1iZXJTdWl0ZUNvbW1vbiIsIkNvbG9yIiwiSEJveCIsIk1hbnVhbENvbnN0cmFpbnQiLCJOb2RlIiwiUmljaFRleHQiLCJUZXh0IiwiVkJveCIsIm9wdGlvbml6ZSIsImNvbWJpbmVPcHRpb25zIiwiQ2Fyb3VzZWwiLCJDYXJvdXNlbEl0ZW1Ob2RlIiwiTnVtYmVyU3VpdGVDb21tb25TdHJpbmdzIiwiUGhldEZvbnQiLCJTdHJpbmdVdGlscyIsIk11bHRpbGluayIsIlBhZ2VDb250cm9sIiwiRGVyaXZlZFByb3BlcnR5IiwiTEFCRUxfVEVYVF9PUFRJT05TIiwiZm9udFdlaWdodCIsImZvbnRTaXplIiwiQ0FST1VTRUxfT1BUSU9OUyIsIml0ZW1zUGVyUGFnZSIsInNwYWNpbmciLCJtYXJnaW4iLCJvcmllbnRhdGlvbiIsIkxBQkVMX1lfU1BBQ0lORyIsIkxhbmd1YWdlQW5kVm9pY2VDb250cm9sIiwiY29uc3RydWN0b3IiLCJsb2NhbGVQcm9wZXJ0eSIsInZvaWNlUHJvcGVydHkiLCJ1dHRlcmFuY2VRdWV1ZSIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJleGNsdWRlSW52aXNpYmxlQ2hpbGRyZW5Gcm9tQm91bmRzIiwiYWxpZ24iLCJqdXN0aWZ5IiwibGFuZ3VhZ2VDYXJvdXNlbEl0ZW1zIiwidmFsaWRWYWx1ZXMiLCJtYXAiLCJsb2NhbGUiLCJjcmVhdGVOb2RlIiwibG9jYWxlVG9Mb2NhbGl6ZWROYW1lIiwidmFsdWUiLCJjYW5jZWxTcGVlY2hEYXRhU3BlYWtpbmciLCJzcGVha1Rlc3RWb2ljZSIsImxhbmd1YWdlQ2Fyb3VzZWwiLCJzZWxlY3RlZE5vZGUiLCJfIiwiZmluZCIsIml0ZW0iLCJhc3NlcnQiLCJzY3JvbGxUb0l0ZW0iLCJsYW5ndWFnZUNhcm91c2VsV2lkdGgiLCJ3aWR0aCIsInRleHRPcHRpb25zIiwibWF4V2lkdGgiLCJsYW5ndWFnZUNhcm91c2VsTGFiZWwiLCJsYW5ndWFnZVRpdGxlU3RyaW5nUHJvcGVydHkiLCJ2b2ljZUNhcm91c2VsIiwidm9pY2VDYXJvdXNlbExhYmVsIiwidm9pY2VTdHJpbmdQcm9wZXJ0eSIsIm5vVm9pY2VEZXNjcmlwdGlvbk5vZGUiLCJOb1ZvaWNlRGVzY3JpcHRpb25Ob2RlIiwiaGVpZ2h0IiwicGFnZUNvbnRyb2wiLCJwYWdlTnVtYmVyUHJvcGVydHkiLCJudW1iZXJPZlBhZ2VzUHJvcGVydHkiLCJwYWdlRmlsbCIsIldISVRFIiwicGFnZVN0cm9rZSIsIkJMQUNLIiwiY3VycmVudFBhZ2VTdHJva2UiLCJpbnRlcmFjdGl2ZSIsImRvdFRvdWNoQXJlYURpbGF0aW9uIiwiZG90TW91c2VBcmVhRGlsYXRpb24iLCJ2aXNpYmxlUHJvcGVydHkiLCJudW1iZXJPZlBhZ2VzIiwidm9pY2VDb250cm9sVkJveCIsImNoaWxkcmVuIiwibGF5b3V0T3B0aW9ucyIsIm1pbkNvbnRlbnRXaWR0aCIsImxhbmd1YWdlQ29udHJvbFZCb3giLCJjcmVhdGUiLCJsYW5ndWFnZUNhcm91c2VsUHJveHkiLCJwYWdlQ29udHJvbFByb3h5IiwiY2VudGVyWSIsIm11bHRpbGluayIsImFubm91bmNlciIsInZvaWNlc1Byb3BlcnR5Iiwidm9pY2VzIiwibGVuZ3RoIiwic2V0Rmlyc3RBdmFpbGFibGVWb2ljZUZvckxvY2FsZSIsImF2YWlsYWJsZVZvaWNlc0ZvckxvY2FsZSIsImdldFByaW9yaXRpemVkVm9pY2VzRm9yTG9jYWxlIiwidm9pY2VDYXJvdXNlbEl0ZW1zIiwidm9pY2UiLCJuYW1lIiwibGFuZyIsImRpc3Bvc2UiLCJtYXhIZWlnaHQiLCJyaWNoVGV4dE9wdGlvbnMiLCJmb250IiwibGluZVdyYXAiLCJub1ZvaWNlRm91bmREZXNjcmlwdGlvblJpY2hUZXh0Iiwibm9Wb2ljZUZvdW5kRGVzY3JpcHRpb25TdHJpbmdQcm9wZXJ0eSIsInlvdXJEZXZpY2VNYXlTdXBwb3J0RGVzY3JpcHRpb25SaWNoVGV4dCIsInlvdXJEZXZpY2VNYXlTdXBwb3J0RGVzY3JpcHRpb25TdHJpbmdQcm9wZXJ0eSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiTGFuZ3VhZ2VBbmRWb2ljZUNvbnRyb2wudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIExhbmd1YWdlQW5kVm9pY2VDb250cm9sIGNvbnRhaW5zIHR3byBjYXJvdXNlbHM6IG9uZSBmb3Igc2VsZWN0aW5nIGEgbGFuZ3VhZ2UsIGFuZCBvbmUgZm9yIHNlbGVjdGluZyBhIHZvaWNlLiBGb3IgdXNlXHJcbiAqIGluIHRoZSBQcmVmZXJlbmNlcyBkaWFsb2cuXHJcbiAqXHJcbiAqIEBhdXRob3IgQ2hyaXMgS2x1c2VuZG9yZiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgbnVtYmVyU3VpdGVDb21tb24gZnJvbSAnLi4vLi4vbnVtYmVyU3VpdGVDb21tb24uanMnO1xyXG5pbXBvcnQgeyBDb2xvciwgSEJveCwgSEJveE9wdGlvbnMsIE1hbnVhbENvbnN0cmFpbnQsIE5vZGUsIFJpY2hUZXh0LCBSaWNoVGV4dE9wdGlvbnMsIFRleHQsIFRleHRPcHRpb25zLCBWQm94IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBjb21iaW5lT3B0aW9ucywgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgeyBMb2NhbGUgfSBmcm9tICcuLi8uLi8uLi8uLi9qb2lzdC9qcy9pMThuL2xvY2FsZVByb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgU3RyaWN0T21pdCBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvU3RyaWN0T21pdC5qcyc7XHJcbmltcG9ydCBDYXJvdXNlbCwgeyBDYXJvdXNlbEl0ZW0sIENhcm91c2VsT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9DYXJvdXNlbC5qcyc7XHJcbmltcG9ydCBUUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgQ2Fyb3VzZWxJdGVtTm9kZSBmcm9tICcuL0Nhcm91c2VsSXRlbU5vZGUuanMnO1xyXG5pbXBvcnQgTnVtYmVyU3VpdGVDb21tb25TdHJpbmdzIGZyb20gJy4uLy4uL051bWJlclN1aXRlQ29tbW9uU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBQaGV0Rm9udCBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldEZvbnQuanMnO1xyXG5pbXBvcnQgU3RyaW5nVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy91dGlsL1N0cmluZ1V0aWxzLmpzJztcclxuaW1wb3J0IE51bWJlclN1aXRlQ29tbW9uVXR0ZXJhbmNlUXVldWUgZnJvbSAnLi9OdW1iZXJTdWl0ZUNvbW1vblV0dGVyYW5jZVF1ZXVlLmpzJztcclxuaW1wb3J0IE11bHRpbGluayBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL011bHRpbGluay5qcyc7XHJcbmltcG9ydCBQYWdlQ29udHJvbCBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvUGFnZUNvbnRyb2wuanMnO1xyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuXHJcbmNvbnN0IExBQkVMX1RFWFRfT1BUSU9OUyA9IHtcclxuICBmb250V2VpZ2h0OiAnYm9sZCcsXHJcbiAgZm9udFNpemU6IDE2XHJcbn07XHJcbmNvbnN0IENBUk9VU0VMX09QVElPTlM6IENhcm91c2VsT3B0aW9ucyA9IHtcclxuICBpdGVtc1BlclBhZ2U6IDEwLFxyXG4gIHNwYWNpbmc6IDYsXHJcbiAgbWFyZ2luOiA1LFxyXG4gIG9yaWVudGF0aW9uOiAndmVydGljYWwnXHJcbn07XHJcbmNvbnN0IExBQkVMX1lfU1BBQ0lORyA9IDEwO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcbnR5cGUgTGFuZ3VhZ2VBbmRWb2ljZUNvbnRyb2xPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBTdHJpY3RPbWl0PEhCb3hPcHRpb25zLCAnY2hpbGRyZW4nPjtcclxuXHJcbnR5cGUgTGFuZ3VhZ2VDYXJvdXNlbEl0ZW0gPSB7IGxvY2FsZTogTG9jYWxlIH0gJiBDYXJvdXNlbEl0ZW07XHJcbnR5cGUgVm9pY2VDYXJvdXNlbEl0ZW0gPSB7IHZvaWNlOiBTcGVlY2hTeW50aGVzaXNWb2ljZSB9ICYgQ2Fyb3VzZWxJdGVtO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGFuZ3VhZ2VBbmRWb2ljZUNvbnRyb2wgZXh0ZW5kcyBIQm94IHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBsb2NhbGVQcm9wZXJ0eTogUHJvcGVydHk8TG9jYWxlPixcclxuICAgICAgICAgICAgICAgICAgICAgIHZvaWNlUHJvcGVydHk6IFRQcm9wZXJ0eTxTcGVlY2hTeW50aGVzaXNWb2ljZSB8IG51bGw+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgdXR0ZXJhbmNlUXVldWU6IE51bWJlclN1aXRlQ29tbW9uVXR0ZXJhbmNlUXVldWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM/OiBMYW5ndWFnZUFuZFZvaWNlQ29udHJvbE9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxMYW5ndWFnZUFuZFZvaWNlQ29udHJvbE9wdGlvbnMsIFNlbGZPcHRpb25zLCBIQm94T3B0aW9ucz4oKSgge1xyXG5cclxuICAgICAgLy8gSEJveE9wdGlvbnNcclxuICAgICAgZXhjbHVkZUludmlzaWJsZUNoaWxkcmVuRnJvbUJvdW5kczogZmFsc2UsXHJcbiAgICAgIGFsaWduOiAndG9wJyxcclxuICAgICAganVzdGlmeTogJ2xlZnQnLFxyXG4gICAgICBzcGFjaW5nOiAxMFxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gQ2Fyb3VzZWwgZm9yIGNob29zaW5nIGEgbGFuZ3VhZ2UuXHJcbiAgICBjb25zdCBsYW5ndWFnZUNhcm91c2VsSXRlbXM6IExhbmd1YWdlQ2Fyb3VzZWxJdGVtW10gPSBsb2NhbGVQcm9wZXJ0eS52YWxpZFZhbHVlcyEubWFwKFxyXG4gICAgICBsb2NhbGUgPT4ge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBsb2NhbGU6IGxvY2FsZSxcclxuICAgICAgICAgIGNyZWF0ZU5vZGU6ICgpID0+IG5ldyBDYXJvdXNlbEl0ZW1Ob2RlKFxyXG4gICAgICAgICAgICBsb2NhbGVQcm9wZXJ0eSxcclxuICAgICAgICAgICAgbG9jYWxlLFxyXG4gICAgICAgICAgICBTdHJpbmdVdGlscy5sb2NhbGVUb0xvY2FsaXplZE5hbWUoIGxvY2FsZSApLFxyXG4gICAgICAgICAgICBgJHtsb2NhbGV9YCwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGxvY2FsZVByb3BlcnR5LnZhbHVlID0gbG9jYWxlO1xyXG5cclxuICAgICAgICAgICAgICAvLyBDYW5jZWwgYW55IHNwZWVjaCBiZWluZyByZWFkIG91dCB0aGF0IGNhbWUgZnJvbSBjaGFuZ2luZyB0aGUgbG9jYWxlLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL251bWJlci1zdWl0ZS1jb21tb24vaXNzdWVzLzU2I2lzc3VlY29tbWVudC0xNDgwMDYzODc5XHJcbiAgICAgICAgICAgICAgdXR0ZXJhbmNlUXVldWUuY2FuY2VsU3BlZWNoRGF0YVNwZWFraW5nKCk7XHJcblxyXG4gICAgICAgICAgICAgIC8vIFJlYWQgdGhlIHRlc3Qgc3RyaW5nIGluIHRoZSBmaXJzdCBhdmFpbGFibGUgdm9pY2UgZm9yIHRoZSBuZXcgbGFuZ3VhZ2UsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvbnVtYmVyLXN1aXRlLWNvbW1vbi9pc3N1ZXMvNTZcclxuICAgICAgICAgICAgICB1dHRlcmFuY2VRdWV1ZS5zcGVha1Rlc3RWb2ljZSggdm9pY2VQcm9wZXJ0eS52YWx1ZSwgbG9jYWxlICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIClcclxuICAgICAgICB9O1xyXG4gICAgICB9ICk7XHJcbiAgICBjb25zdCBsYW5ndWFnZUNhcm91c2VsID0gbmV3IENhcm91c2VsKCBsYW5ndWFnZUNhcm91c2VsSXRlbXMsIENBUk9VU0VMX09QVElPTlMgKTtcclxuXHJcbiAgICAvLyBTY3JvbGwgdGhlIGNhcm91c2VsIHNvIHRoYXQgdGhlIGluaXRpYWwgc2VsZWN0aW9uIGlzIHNob3duLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL251bWJlci1zdWl0ZS1jb21tb24vaXNzdWVzLzM4XHJcbiAgICBjb25zdCBzZWxlY3RlZE5vZGUgPSBfLmZpbmQoIGxhbmd1YWdlQ2Fyb3VzZWxJdGVtcywgaXRlbSA9PiBpdGVtLmxvY2FsZSA9PT0gbG9jYWxlUHJvcGVydHkudmFsdWUgKSE7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBzZWxlY3RlZE5vZGUgKTtcclxuICAgIGxhbmd1YWdlQ2Fyb3VzZWwuc2Nyb2xsVG9JdGVtKCBzZWxlY3RlZE5vZGUgKTtcclxuXHJcbiAgICAvLyBSZWNvcmQgdGhlIHdpZHRoIG9mIHRoZSBsYW5ndWFnZSBjYXJvdXNlbCBmb3IgdXNlIHRvIGVuc3VyZSB0aGUgdm9pY2UgY29sdW1uIG1hdGNoZXMuIFdpZHRoIG9mIHRoZSBjYXJvdXNlbFxyXG4gICAgLy8gaXMgZGVwZW5kZW50IGFuZCBjb250cm9sbGVkIGJ5IHRoZSBzaXplIG9mIGl0cyBjb250ZW50IChzZWUgQ2Fyb3VzZWxJdGVtTm9kZSksIHVzZSB0aGF0IHdpZHRoIHRvIGVuc3VyZSBjb25zaXN0ZW50XHJcbiAgICAvLyBsYXlvdXQgYW5kIGNvbnRlbnQuXHJcbiAgICBjb25zdCBsYW5ndWFnZUNhcm91c2VsV2lkdGggPSBsYW5ndWFnZUNhcm91c2VsLndpZHRoO1xyXG5cclxuICAgIGNvbnN0IHRleHRPcHRpb25zID0gY29tYmluZU9wdGlvbnM8VGV4dE9wdGlvbnM+KCB7IG1heFdpZHRoOiBsYW5ndWFnZUNhcm91c2VsV2lkdGggfSwgTEFCRUxfVEVYVF9PUFRJT05TICk7XHJcblxyXG4gICAgY29uc3QgbGFuZ3VhZ2VDYXJvdXNlbExhYmVsID0gbmV3IFRleHQoIE51bWJlclN1aXRlQ29tbW9uU3RyaW5ncy5sYW5ndWFnZVRpdGxlU3RyaW5nUHJvcGVydHksIHRleHRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gQ2Fyb3VzZWwgZm9yIGNob29zaW5nIGEgdm9pY2UuIFJlY3JlYXRlZCB3aGVuIHRoZSBsYW5ndWFnZSBjaGFuZ2VzLlxyXG4gICAgbGV0IHZvaWNlQ2Fyb3VzZWw6IE5vZGUgfCBDYXJvdXNlbCA9IG5ldyBOb2RlKCk7XHJcbiAgICBjb25zdCB2b2ljZUNhcm91c2VsTGFiZWwgPSBuZXcgVGV4dCggTnVtYmVyU3VpdGVDb21tb25TdHJpbmdzLnZvaWNlU3RyaW5nUHJvcGVydHksIHRleHRPcHRpb25zICk7XHJcbiAgICBjb25zdCBub1ZvaWNlRGVzY3JpcHRpb25Ob2RlID0gbmV3IE5vVm9pY2VEZXNjcmlwdGlvbk5vZGUoIGxhbmd1YWdlQ2Fyb3VzZWxXaWR0aCwgbGFuZ3VhZ2VDYXJvdXNlbC5oZWlnaHQgKTtcclxuXHJcbiAgICBjb25zdCBwYWdlQ29udHJvbCA9IG5ldyBQYWdlQ29udHJvbCggbGFuZ3VhZ2VDYXJvdXNlbC5wYWdlTnVtYmVyUHJvcGVydHksIGxhbmd1YWdlQ2Fyb3VzZWwubnVtYmVyT2ZQYWdlc1Byb3BlcnR5LCB7XHJcbiAgICAgIG9yaWVudGF0aW9uOiAndmVydGljYWwnLFxyXG4gICAgICBwYWdlRmlsbDogQ29sb3IuV0hJVEUsXHJcbiAgICAgIHBhZ2VTdHJva2U6IENvbG9yLkJMQUNLLFxyXG4gICAgICBjdXJyZW50UGFnZVN0cm9rZTogQ29sb3IuQkxBQ0ssXHJcbiAgICAgIGludGVyYWN0aXZlOiB0cnVlLFxyXG4gICAgICBkb3RUb3VjaEFyZWFEaWxhdGlvbjogNSxcclxuICAgICAgZG90TW91c2VBcmVhRGlsYXRpb246IDUsXHJcblxyXG4gICAgICAvLyBIaWRlIHBhZ2VDb250cm9sIGlmIHRoZXJlJ3Mgb25seSBvbmUgcGFnZS5cclxuICAgICAgdmlzaWJsZVByb3BlcnR5OiBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIGxhbmd1YWdlQ2Fyb3VzZWwubnVtYmVyT2ZQYWdlc1Byb3BlcnR5IF0sIG51bWJlck9mUGFnZXMgPT4gbnVtYmVyT2ZQYWdlcyA+IDEgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHZvaWNlQ29udHJvbFZCb3ggPSBuZXcgVkJveCgge1xyXG4gICAgICBjaGlsZHJlbjogWyB2b2ljZUNhcm91c2VsTGFiZWwsIHZvaWNlQ2Fyb3VzZWwgXSxcclxuICAgICAgc3BhY2luZzogTEFCRUxfWV9TUEFDSU5HLFxyXG4gICAgICBhbGlnbjogJ2xlZnQnLFxyXG4gICAgICBsYXlvdXRPcHRpb25zOiB7XHJcbiAgICAgICAgbWluQ29udGVudFdpZHRoOiBsYW5ndWFnZUNhcm91c2VsV2lkdGhcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGxhbmd1YWdlQ29udHJvbFZCb3ggPSBuZXcgVkJveCgge1xyXG4gICAgICBjaGlsZHJlbjogWyBsYW5ndWFnZUNhcm91c2VsTGFiZWwsIGxhbmd1YWdlQ2Fyb3VzZWwgXSxcclxuICAgICAgc3BhY2luZzogTEFCRUxfWV9TUEFDSU5HLFxyXG4gICAgICBhbGlnbjogJ2xlZnQnXHJcbiAgICB9ICk7XHJcblxyXG4gICAgb3B0aW9ucy5jaGlsZHJlbiA9IFtcclxuXHJcbiAgICAgIC8vIEFkZCBhbiBleHRyYSBOb2RlIGxheWVyIHNvIHdlIGNhbiBtb3ZlIHRoZSBwYWdlQ29udHJvbCB3aXRoIGEgTWFudWFsQ29uc3RyYWludCBiZWxvdyBhbmQgbm90IGNyZWF0ZSBhbiBpbmZpbml0ZVxyXG4gICAgICAvLyBsb29wIHdpdGggdGhlIGFsaWdubWVudCBsYXlvdXQgb2YgdGhpcyBIQm94LlxyXG4gICAgICBuZXcgTm9kZSggeyBjaGlsZHJlbjogWyBwYWdlQ29udHJvbCBdIH0gKSxcclxuXHJcbiAgICAgIGxhbmd1YWdlQ29udHJvbFZCb3gsXHJcbiAgICAgIHZvaWNlQ29udHJvbFZCb3hcclxuICAgIF07XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBLZWVwIHRoZSBwYWdlQ29udHJvbCB2ZXJ0aWNhbGx5IGNlbnRlcmVkIG5leHQgdG8gdGhlIGxhbmd1YWdlQ2Fyb3VzZWwuXHJcbiAgICBNYW51YWxDb25zdHJhaW50LmNyZWF0ZSggdGhpcywgWyBsYW5ndWFnZUNhcm91c2VsLCBwYWdlQ29udHJvbCBdLCAoIGxhbmd1YWdlQ2Fyb3VzZWxQcm94eSwgcGFnZUNvbnRyb2xQcm94eSApID0+IHtcclxuICAgICAgcGFnZUNvbnRyb2xQcm94eS5jZW50ZXJZID0gbGFuZ3VhZ2VDYXJvdXNlbFByb3h5LmNlbnRlclk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gUmVidWlsZCB0aGUgdm9pY2VDYXJvdXNlbCB3aXRoIHRoZSBhdmFpbGFibGUgdm9pY2VzIHdoZW4gdGhlIGxvY2FsZSBjaGFuZ2VzIG9yIHdoZW4gdm9pY2VzIGJlY29tZSBhdmFpbGFibGVcclxuICAgIE11bHRpbGluay5tdWx0aWxpbmsoXHJcbiAgICAgIFsgbG9jYWxlUHJvcGVydHksIHV0dGVyYW5jZVF1ZXVlLmFubm91bmNlci52b2ljZXNQcm9wZXJ0eSBdLFxyXG4gICAgICAoIGxvY2FsZSwgdm9pY2VzICkgPT4ge1xyXG4gICAgICAgIGlmICggdm9pY2VzLmxlbmd0aCApIHtcclxuICAgICAgICAgIHV0dGVyYW5jZVF1ZXVlLmFubm91bmNlci5zZXRGaXJzdEF2YWlsYWJsZVZvaWNlRm9yTG9jYWxlKCBsb2NhbGUsIHZvaWNlUHJvcGVydHkgKTtcclxuXHJcbiAgICAgICAgICBjb25zdCBhdmFpbGFibGVWb2ljZXNGb3JMb2NhbGUgPSB1dHRlcmFuY2VRdWV1ZS5hbm5vdW5jZXIuZ2V0UHJpb3JpdGl6ZWRWb2ljZXNGb3JMb2NhbGUoIGxvY2FsZSApO1xyXG5cclxuICAgICAgICAgIGlmICggYXZhaWxhYmxlVm9pY2VzRm9yTG9jYWxlLmxlbmd0aCApIHtcclxuICAgICAgICAgICAgY29uc3Qgdm9pY2VDYXJvdXNlbEl0ZW1zOiBWb2ljZUNhcm91c2VsSXRlbVtdID0gYXZhaWxhYmxlVm9pY2VzRm9yTG9jYWxlLm1hcChcclxuICAgICAgICAgICAgICB2b2ljZSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICB2b2ljZTogdm9pY2UsXHJcbiAgICAgICAgICAgICAgICAgIGNyZWF0ZU5vZGU6ICgpID0+IG5ldyBDYXJvdXNlbEl0ZW1Ob2RlKFxyXG4gICAgICAgICAgICAgICAgICAgIHZvaWNlUHJvcGVydHksXHJcbiAgICAgICAgICAgICAgICAgICAgdm9pY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgdm9pY2UubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB2b2ljZS5sYW5nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB2b2ljZVByb3BlcnR5LnZhbHVlID0gdm9pY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICB1dHRlcmFuY2VRdWV1ZS5zcGVha1Rlc3RWb2ljZSggdm9pY2UsIGxvY2FsZSApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICB2b2ljZUNhcm91c2VsLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgdm9pY2VDYXJvdXNlbCA9IG5ldyBDYXJvdXNlbCggdm9pY2VDYXJvdXNlbEl0ZW1zLCBDQVJPVVNFTF9PUFRJT05TICk7XHJcblxyXG4gICAgICAgICAgICAvLyBTZXQgdGhlIGNoaWxkcmVuIHNvIHRoZSBuZXcgY2Fyb3VzZWwgaXMgdmlzaWJsZS5cclxuICAgICAgICAgICAgdm9pY2VDb250cm9sVkJveC5jaGlsZHJlbiA9IFsgdm9pY2VDYXJvdXNlbExhYmVsLCB2b2ljZUNhcm91c2VsIF07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgIC8vIE5vIGF2YWlsYWJsZSB2b2ljZXMsIHNvIHNldCB0aGUgY2hpbGRyZW4gc28gdGhlIG5vVm9pY2VzRm91bmREZXNjcmlwdGlvbk5vZGUgaXMgdmlzaWJsZSBpbnN0ZWFkIG9mIHRoZSB2b2ljZXMuXHJcbiAgICAgICAgICAgIHZvaWNlQ29udHJvbFZCb3guY2hpbGRyZW4gPSBbIHZvaWNlQ2Fyb3VzZWxMYWJlbCwgbm9Wb2ljZURlc2NyaXB0aW9uTm9kZSBdO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBmYWxzZSwgJ2Rpc3Bvc2UgaXMgbm90IHN1cHBvcnRlZCwgZXhpc3RzIGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIHNpbScgKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUZXh0IGZvciBpbmZvcm1pbmcgdGhlIHVzZXIgdGhhdCB0aGVyZSBpcyBubyBhdmFpbGFibGUgdm9pY2UgZm9yIHRoZWlyIHNlbGVjdGVkIGxhbmd1YWdlLiBUaGUgdGV4dCB3cmFwcyBhdCB0aGVcclxuICogcHJvdmlkZWQgd2lkdGguXHJcbiAqL1xyXG5jbGFzcyBOb1ZvaWNlRGVzY3JpcHRpb25Ob2RlIGV4dGVuZHMgVkJveCB7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggbWF4V2lkdGg6IG51bWJlciwgbWF4SGVpZ2h0OiBudW1iZXIgKSB7XHJcblxyXG4gICAgY29uc3QgcmljaFRleHRPcHRpb25zOiBSaWNoVGV4dE9wdGlvbnMgPSB7XHJcbiAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggMTYgKSxcclxuICAgICAgbGluZVdyYXA6IG1heFdpZHRoXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG5vVm9pY2VGb3VuZERlc2NyaXB0aW9uUmljaFRleHQgPSBuZXcgUmljaFRleHQoXHJcbiAgICAgIE51bWJlclN1aXRlQ29tbW9uU3RyaW5ncy5ub1ZvaWNlRm91bmREZXNjcmlwdGlvblN0cmluZ1Byb3BlcnR5LCByaWNoVGV4dE9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCB5b3VyRGV2aWNlTWF5U3VwcG9ydERlc2NyaXB0aW9uUmljaFRleHQgPSBuZXcgUmljaFRleHQoXHJcbiAgICAgIE51bWJlclN1aXRlQ29tbW9uU3RyaW5ncy55b3VyRGV2aWNlTWF5U3VwcG9ydERlc2NyaXB0aW9uU3RyaW5nUHJvcGVydHksIHJpY2hUZXh0T3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIG5vVm9pY2VGb3VuZERlc2NyaXB0aW9uUmljaFRleHQsIHlvdXJEZXZpY2VNYXlTdXBwb3J0RGVzY3JpcHRpb25SaWNoVGV4dCBdLFxyXG4gICAgICBzcGFjaW5nOiAyMCxcclxuICAgICAgYWxpZ246ICdsZWZ0JyxcclxuICAgICAgbWF4SGVpZ2h0OiBtYXhIZWlnaHRcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbm51bWJlclN1aXRlQ29tbW9uLnJlZ2lzdGVyKCAnTGFuZ3VhZ2VBbmRWb2ljZUNvbnRyb2wnLCBMYW5ndWFnZUFuZFZvaWNlQ29udHJvbCApO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxpQkFBaUIsTUFBTSw0QkFBNEI7QUFDMUQsU0FBU0MsS0FBSyxFQUFFQyxJQUFJLEVBQWVDLGdCQUFnQixFQUFFQyxJQUFJLEVB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