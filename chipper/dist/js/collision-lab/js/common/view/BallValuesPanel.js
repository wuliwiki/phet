// Copyright 2019-2022, University of Colorado Boulder

/**
 * BallValuesPanel is the Panel at the bottom of all screens which displays and allows the user to modify the values
 * of all Balls that are currently in the system.
 *
 * For each Ball in the BallSystem, it displays it's values, which are:
 *    - Masses (kg).
 *    - The x and y component of the Ball's position (m).
 *    - The x and y component of the Ball's velocity (m/s).
 *    - The x and y component of the Ball's linear momentum (kg m/s).
 *
 * If the "More Data" checkbox is not checked, the Panel only displays:
 *   - Masses of the Balls (kg).
 *   - Sliders to change the masses.
 *
 * The Panel is built into columns using BallValuesPanelColumnNode. If the dimension of the PlayArea is 1D, the
 * y-component of the vectored BallValues described above are not included. Otherwise, each column of components are
 * grouped together and a title-label is placed above the group (like "Position (m)").
 *
 * This panel exists for the entire sim and is never disposed.
 *
 * @author Brandon Li
 */

import merge from '../../../../phet-core/js/merge.js';
import AssertUtils from '../../../../phetcommon/js/AssertUtils.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import { AlignGroup, HBox, Node, Text, VBox } from '../../../../scenery/js/imports.js';
import Panel from '../../../../sun/js/Panel.js';
import collisionLab from '../../collisionLab.js';
import CollisionLabStrings from '../../CollisionLabStrings.js';
import CollisionLabConstants from '../CollisionLabConstants.js';
import BallSystem from '../model/BallSystem.js';
import PlayArea from '../model/PlayArea.js';
import BallValuesPanelColumnNode from './BallValuesPanelColumnNode.js';
import BallValuesPanelColumnTypes from './BallValuesPanelColumnTypes.js';
import KeypadDialog from '../../../../scenery-phet/js/keypad/KeypadDialog.js';

// AlignGroup for each group of x (and y) component columns that display the components of vector values of Balls. This
// is to match the width of column groups across screens, regardless of whether or not the y-component column is
// included. See https://github.com/phetsims/collision-lab/issues/83#issuecomment-639105292.
const COMPONENT_COLUMN_GROUP_ALIGN_GROUP = new AlignGroup({
  matchHorizontal: true,
  matchVertical: false
});

// AlignGroup for the title-labels that are placed above each group (like "Position (m)"). This is made to match the
// vertical height of each title-label across screens, regardless of their scaling.
const TITLE_ALIGN_GROUP = new AlignGroup({
  matchHorizontal: false,
  matchVertical: true
});
class BallValuesPanel extends Panel {
  /**
   * @param {BallSystem} ballSystem - the system of Balls.
   * @param {Property.<boolean>} moreDataVisibleProperty - indicates if the "More Data" checkbox is checked.
   * @param {number} dimension - the dimension of the PlayArea.
   * @param {KeypadDialog} keypadDialog - KeypadDialog instance for the screen.
   * @param {Object} [options]
   */
  constructor(ballSystem, moreDataVisibleProperty, dimension, keypadDialog, options) {
    assert && assert(ballSystem instanceof BallSystem, `invalid ballSystem: ${ballSystem}`);
    assert && AssertUtils.assertPropertyOf(moreDataVisibleProperty, 'boolean');
    assert && assert(PlayArea.Dimension.includes(dimension), `invalid dimension: ${dimension}`);
    assert && assert(keypadDialog instanceof KeypadDialog, `invalid keypadDialog: ${keypadDialog}`);
    options = merge({}, CollisionLabConstants.PANEL_OPTIONS, {
      ballIconColumnSpacing: 12,
      // {number} - x-spacing between the ball-icons and the first column.
      componentColumnsSpacing: 12,
      // {number} - x-spacing between the x and y components of NumberDisplay columns.
      columnGroupSpacing: 21,
      // {number} - x-spacing between each group of columns.
      titleLabelSpacing: 0.5,
      // {number} - y-margin between the column groups and the title-labels above them.

      massTitleMaxWidth: 67,
      // {number} - maxWidth for the 'Mass (kg)' title label, for i18n.
      componentGroupTitleMaxWidth: 140,
      // {number} - maxWidth for the title labels of component groups, for i18n.

      // {Font} - applied to all of the title-label Text instances
      titleFont: CollisionLabConstants.PANEL_TITLE_FONT
    }, options);

    //----------------------------------------------------------------------------------------

    // Create each BallValuesPanelColumnNode for each BallValuesPanelColumnTypes that are common to both 1D and 2D.
    const ballIconsColumnNode = new BallValuesPanelColumnNode(ballSystem, BallValuesPanelColumnTypes.BALL_ICONS, keypadDialog);
    const xPositionColumnNode = new BallValuesPanelColumnNode(ballSystem, BallValuesPanelColumnTypes.X_POSITION, keypadDialog);
    const xVelocityColumnNode = new BallValuesPanelColumnNode(ballSystem, BallValuesPanelColumnTypes.X_VELOCITY, keypadDialog);
    const xMomentumColumnNode = new BallValuesPanelColumnNode(ballSystem, BallValuesPanelColumnTypes.X_MOMENTUM, keypadDialog);
    const massColumnNode = new BallValuesPanelColumnNode(ballSystem, BallValuesPanelColumnTypes.MASS, keypadDialog);
    const massSlidersColumnNode = new BallValuesPanelColumnNode(ballSystem, BallValuesPanelColumnTypes.MASS_SLIDERS, keypadDialog);

    // Wrap the component-specific column groups into a HBox. The y-component columns will be added for 2D.
    const positionColumnGroup = new HBox({
      children: [xPositionColumnNode],
      spacing: options.componentColumnsSpacing
    });
    const velocityColumnGroup = new HBox({
      children: [xVelocityColumnNode],
      spacing: options.componentColumnsSpacing
    });
    const momentumColumnGroup = new HBox({
      children: [xMomentumColumnNode],
      spacing: options.componentColumnsSpacing
    });

    // For 2D screens, add the y-component columns to their correlating group.
    if (dimension === PlayArea.Dimension.TWO) {
      const yPositionColumnNode = new BallValuesPanelColumnNode(ballSystem, BallValuesPanelColumnTypes.Y_POSITION, keypadDialog);
      const yVelocityColumnNode = new BallValuesPanelColumnNode(ballSystem, BallValuesPanelColumnTypes.Y_VELOCITY, keypadDialog);
      const yMomentumColumnNode = new BallValuesPanelColumnNode(ballSystem, BallValuesPanelColumnTypes.Y_MOMENTUM, keypadDialog);
      positionColumnGroup.addChild(yPositionColumnNode);
      velocityColumnGroup.addChild(yVelocityColumnNode);
      momentumColumnGroup.addChild(yMomentumColumnNode);
    }

    //----------------------------------------------------------------------------------------

    // Convenience function to create the title-label that appears above each column group.
    const createTitleLabel = (label, units, maxWidth = options.componentGroupTitleMaxWidth) => {
      const titleString = StringUtils.fillIn(CollisionLabStrings.pattern.labelParenthesesUnits, {
        label: label,
        units: units
      });

      // Wrap the text in an AlignGroup to match height.
      return TITLE_ALIGN_GROUP.createBox(new Text(titleString, {
        font: options.titleFont,
        maxWidth: maxWidth
      }));
    };

    // Create the Title Labels for each section of the BallValuesPanel.
    const massTitleNode = createTitleLabel(CollisionLabStrings.mass, CollisionLabStrings.units.kilograms, options.massTitleMaxWidth);
    const momentumTitleNode = createTitleLabel(CollisionLabStrings.momentum, CollisionLabStrings.units.kilogramMetersPerSecond);
    const positionTitleNode = createTitleLabel(CollisionLabStrings.position, CollisionLabStrings.units.meters);
    const velocityTitleNode = createTitleLabel(CollisionLabStrings.velocity, CollisionLabStrings.units.metersPerSecond);

    //----------------------------------------------------------------------------------------

    // Convenience function to create each section of the Panel, which includes the column group and a title above it.
    const createSectionNode = (titleNode, columnGroup, isComponentColumnGroup = true) => {
      return new VBox({
        children: [titleNode,
        // If the group is a grouping of component columns, wrap the column group in a align group to match width.
        isComponentColumnGroup ? COMPONENT_COLUMN_GROUP_ALIGN_GROUP.createBox(columnGroup) : columnGroup],
        spacing: options.titleLabelSpacing
      });
    };

    // Horizontally group the column groups with their respective title-labels.
    const massSectionNode = createSectionNode(massTitleNode, massColumnNode, false);
    const positionSectionNode = createSectionNode(positionTitleNode, positionColumnGroup);
    const velocitySectionNode = createSectionNode(velocityTitleNode, velocityColumnGroup);
    const momentumSectionNode = createSectionNode(momentumTitleNode, momentumColumnGroup);

    //----------------------------------------------------------------------------------------

    // The content of the entire Panel when "More Data" is checked.
    const moreDataBox = new HBox({
      children: [new Node({
        children: [massSectionNode]
      }), positionSectionNode, velocitySectionNode, momentumSectionNode],
      spacing: options.columnGroupSpacing,
      align: 'bottom'
    });

    // The content of the entire Panel when "More Data" is not checked.
    const lessDataBox = new HBox({
      children: [new Node({
        children: [massSectionNode]
      }), massSlidersColumnNode],
      spacing: options.columnGroupSpacing,
      align: 'bottom'
    });

    // Observe when the moreDataVisibleProperty changes and update the visibility of the content of the Panel.
    // Link is not removed since BallValuesPanels are never disposed.
    moreDataVisibleProperty.link(moreDataVisible => {
      moreDataBox.visible = moreDataVisible;
      lessDataBox.visible = !moreDataVisible;
    });
    super(new HBox({
      spacing: options.ballIconColumnSpacing,
      children: [ballIconsColumnNode, moreDataBox, lessDataBox],
      align: 'bottom'
    }), options);
  }
}
collisionLab.register('BallValuesPanel', BallValuesPanel);
export default BallValuesPanel;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtZXJnZSIsIkFzc2VydFV0aWxzIiwiU3RyaW5nVXRpbHMiLCJBbGlnbkdyb3VwIiwiSEJveCIsIk5vZGUiLCJUZXh0IiwiVkJveCIsIlBhbmVsIiwiY29sbGlzaW9uTGFiIiwiQ29sbGlzaW9uTGFiU3RyaW5ncyIsIkNvbGxpc2lvbkxhYkNvbnN0YW50cyIsIkJhbGxTeXN0ZW0iLCJQbGF5QXJlYSIsIkJhbGxWYWx1ZXNQYW5lbENvbHVtbk5vZGUiLCJCYWxsVmFsdWVzUGFuZWxDb2x1bW5UeXBlcyIsIktleXBhZERpYWxvZyIsIkNPTVBPTkVOVF9DT0xVTU5fR1JPVVBfQUxJR05fR1JPVVAiLCJtYXRjaEhvcml6b250YWwiLCJtYXRjaFZlcnRpY2FsIiwiVElUTEVfQUxJR05fR1JPVVAiLCJCYWxsVmFsdWVzUGFuZWwiLCJjb25zdHJ1Y3RvciIsImJhbGxTeXN0ZW0iLCJtb3JlRGF0YVZpc2libGVQcm9wZXJ0eSIsImRpbWVuc2lvbiIsImtleXBhZERpYWxvZyIsIm9wdGlvbnMiLCJhc3NlcnQiLCJhc3NlcnRQcm9wZXJ0eU9mIiwiRGltZW5zaW9uIiwiaW5jbHVkZXMiLCJQQU5FTF9PUFRJT05TIiwiYmFsbEljb25Db2x1bW5TcGFjaW5nIiwiY29tcG9uZW50Q29sdW1uc1NwYWNpbmciLCJjb2x1bW5Hcm91cFNwYWNpbmciLCJ0aXRsZUxhYmVsU3BhY2luZyIsIm1hc3NUaXRsZU1heFdpZHRoIiwiY29tcG9uZW50R3JvdXBUaXRsZU1heFdpZHRoIiwidGl0bGVGb250IiwiUEFORUxfVElUTEVfRk9OVCIsImJhbGxJY29uc0NvbHVtbk5vZGUiLCJCQUxMX0lDT05TIiwieFBvc2l0aW9uQ29sdW1uTm9kZSIsIlhfUE9TSVRJT04iLCJ4VmVsb2NpdHlDb2x1bW5Ob2RlIiwiWF9WRUxPQ0lUWSIsInhNb21lbnR1bUNvbHVtbk5vZGUiLCJYX01PTUVOVFVNIiwibWFzc0NvbHVtbk5vZGUiLCJNQVNTIiwibWFzc1NsaWRlcnNDb2x1bW5Ob2RlIiwiTUFTU19TTElERVJTIiwicG9zaXRpb25Db2x1bW5Hcm91cCIsImNoaWxkcmVuIiwic3BhY2luZyIsInZlbG9jaXR5Q29sdW1uR3JvdXAiLCJtb21lbnR1bUNvbHVtbkdyb3VwIiwiVFdPIiwieVBvc2l0aW9uQ29sdW1uTm9kZSIsIllfUE9TSVRJT04iLCJ5VmVsb2NpdHlDb2x1bW5Ob2RlIiwiWV9WRUxPQ0lUWSIsInlNb21lbnR1bUNvbHVtbk5vZGUiLCJZX01PTUVOVFVNIiwiYWRkQ2hpbGQiLCJjcmVhdGVUaXRsZUxhYmVsIiwibGFiZWwiLCJ1bml0cyIsIm1heFdpZHRoIiwidGl0bGVTdHJpbmciLCJmaWxsSW4iLCJwYXR0ZXJuIiwibGFiZWxQYXJlbnRoZXNlc1VuaXRzIiwiY3JlYXRlQm94IiwiZm9udCIsIm1hc3NUaXRsZU5vZGUiLCJtYXNzIiwia2lsb2dyYW1zIiwibW9tZW50dW1UaXRsZU5vZGUiLCJtb21lbnR1bSIsImtpbG9ncmFtTWV0ZXJzUGVyU2Vjb25kIiwicG9zaXRpb25UaXRsZU5vZGUiLCJwb3NpdGlvbiIsIm1ldGVycyIsInZlbG9jaXR5VGl0bGVOb2RlIiwidmVsb2NpdHkiLCJtZXRlcnNQZXJTZWNvbmQiLCJjcmVhdGVTZWN0aW9uTm9kZSIsInRpdGxlTm9kZSIsImNvbHVtbkdyb3VwIiwiaXNDb21wb25lbnRDb2x1bW5Hcm91cCIsIm1hc3NTZWN0aW9uTm9kZSIsInBvc2l0aW9uU2VjdGlvbk5vZGUiLCJ2ZWxvY2l0eVNlY3Rpb25Ob2RlIiwibW9tZW50dW1TZWN0aW9uTm9kZSIsIm1vcmVEYXRhQm94IiwiYWxpZ24iLCJsZXNzRGF0YUJveCIsImxpbmsiLCJtb3JlRGF0YVZpc2libGUiLCJ2aXNpYmxlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJCYWxsVmFsdWVzUGFuZWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTktMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQmFsbFZhbHVlc1BhbmVsIGlzIHRoZSBQYW5lbCBhdCB0aGUgYm90dG9tIG9mIGFsbCBzY3JlZW5zIHdoaWNoIGRpc3BsYXlzIGFuZCBhbGxvd3MgdGhlIHVzZXIgdG8gbW9kaWZ5IHRoZSB2YWx1ZXNcclxuICogb2YgYWxsIEJhbGxzIHRoYXQgYXJlIGN1cnJlbnRseSBpbiB0aGUgc3lzdGVtLlxyXG4gKlxyXG4gKiBGb3IgZWFjaCBCYWxsIGluIHRoZSBCYWxsU3lzdGVtLCBpdCBkaXNwbGF5cyBpdCdzIHZhbHVlcywgd2hpY2ggYXJlOlxyXG4gKiAgICAtIE1hc3NlcyAoa2cpLlxyXG4gKiAgICAtIFRoZSB4IGFuZCB5IGNvbXBvbmVudCBvZiB0aGUgQmFsbCdzIHBvc2l0aW9uIChtKS5cclxuICogICAgLSBUaGUgeCBhbmQgeSBjb21wb25lbnQgb2YgdGhlIEJhbGwncyB2ZWxvY2l0eSAobS9zKS5cclxuICogICAgLSBUaGUgeCBhbmQgeSBjb21wb25lbnQgb2YgdGhlIEJhbGwncyBsaW5lYXIgbW9tZW50dW0gKGtnIG0vcykuXHJcbiAqXHJcbiAqIElmIHRoZSBcIk1vcmUgRGF0YVwiIGNoZWNrYm94IGlzIG5vdCBjaGVja2VkLCB0aGUgUGFuZWwgb25seSBkaXNwbGF5czpcclxuICogICAtIE1hc3NlcyBvZiB0aGUgQmFsbHMgKGtnKS5cclxuICogICAtIFNsaWRlcnMgdG8gY2hhbmdlIHRoZSBtYXNzZXMuXHJcbiAqXHJcbiAqIFRoZSBQYW5lbCBpcyBidWlsdCBpbnRvIGNvbHVtbnMgdXNpbmcgQmFsbFZhbHVlc1BhbmVsQ29sdW1uTm9kZS4gSWYgdGhlIGRpbWVuc2lvbiBvZiB0aGUgUGxheUFyZWEgaXMgMUQsIHRoZVxyXG4gKiB5LWNvbXBvbmVudCBvZiB0aGUgdmVjdG9yZWQgQmFsbFZhbHVlcyBkZXNjcmliZWQgYWJvdmUgYXJlIG5vdCBpbmNsdWRlZC4gT3RoZXJ3aXNlLCBlYWNoIGNvbHVtbiBvZiBjb21wb25lbnRzIGFyZVxyXG4gKiBncm91cGVkIHRvZ2V0aGVyIGFuZCBhIHRpdGxlLWxhYmVsIGlzIHBsYWNlZCBhYm92ZSB0aGUgZ3JvdXAgKGxpa2UgXCJQb3NpdGlvbiAobSlcIikuXHJcbiAqXHJcbiAqIFRoaXMgcGFuZWwgZXhpc3RzIGZvciB0aGUgZW50aXJlIHNpbSBhbmQgaXMgbmV2ZXIgZGlzcG9zZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgQnJhbmRvbiBMaVxyXG4gKi9cclxuXHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgQXNzZXJ0VXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy9Bc3NlcnRVdGlscy5qcyc7XHJcbmltcG9ydCBTdHJpbmdVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9waGV0Y29tbW9uL2pzL3V0aWwvU3RyaW5nVXRpbHMuanMnO1xyXG5pbXBvcnQgeyBBbGlnbkdyb3VwLCBIQm94LCBOb2RlLCBUZXh0LCBWQm94IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFBhbmVsIGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9QYW5lbC5qcyc7XHJcbmltcG9ydCBjb2xsaXNpb25MYWIgZnJvbSAnLi4vLi4vY29sbGlzaW9uTGFiLmpzJztcclxuaW1wb3J0IENvbGxpc2lvbkxhYlN0cmluZ3MgZnJvbSAnLi4vLi4vQ29sbGlzaW9uTGFiU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBDb2xsaXNpb25MYWJDb25zdGFudHMgZnJvbSAnLi4vQ29sbGlzaW9uTGFiQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IEJhbGxTeXN0ZW0gZnJvbSAnLi4vbW9kZWwvQmFsbFN5c3RlbS5qcyc7XHJcbmltcG9ydCBQbGF5QXJlYSBmcm9tICcuLi9tb2RlbC9QbGF5QXJlYS5qcyc7XHJcbmltcG9ydCBCYWxsVmFsdWVzUGFuZWxDb2x1bW5Ob2RlIGZyb20gJy4vQmFsbFZhbHVlc1BhbmVsQ29sdW1uTm9kZS5qcyc7XHJcbmltcG9ydCBCYWxsVmFsdWVzUGFuZWxDb2x1bW5UeXBlcyBmcm9tICcuL0JhbGxWYWx1ZXNQYW5lbENvbHVtblR5cGVzLmpzJztcclxuaW1wb3J0IEtleXBhZERpYWxvZyBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMva2V5cGFkL0tleXBhZERpYWxvZy5qcyc7XHJcblxyXG4vLyBBbGlnbkdyb3VwIGZvciBlYWNoIGdyb3VwIG9mIHggKGFuZCB5KSBjb21wb25lbnQgY29sdW1ucyB0aGF0IGRpc3BsYXkgdGhlIGNvbXBvbmVudHMgb2YgdmVjdG9yIHZhbHVlcyBvZiBCYWxscy4gVGhpc1xyXG4vLyBpcyB0byBtYXRjaCB0aGUgd2lkdGggb2YgY29sdW1uIGdyb3VwcyBhY3Jvc3Mgc2NyZWVucywgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIG9yIG5vdCB0aGUgeS1jb21wb25lbnQgY29sdW1uIGlzXHJcbi8vIGluY2x1ZGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2NvbGxpc2lvbi1sYWIvaXNzdWVzLzgzI2lzc3VlY29tbWVudC02MzkxMDUyOTIuXHJcbmNvbnN0IENPTVBPTkVOVF9DT0xVTU5fR1JPVVBfQUxJR05fR1JPVVAgPSBuZXcgQWxpZ25Hcm91cCggeyBtYXRjaEhvcml6b250YWw6IHRydWUsIG1hdGNoVmVydGljYWw6IGZhbHNlIH0gKTtcclxuXHJcbi8vIEFsaWduR3JvdXAgZm9yIHRoZSB0aXRsZS1sYWJlbHMgdGhhdCBhcmUgcGxhY2VkIGFib3ZlIGVhY2ggZ3JvdXAgKGxpa2UgXCJQb3NpdGlvbiAobSlcIikuIFRoaXMgaXMgbWFkZSB0byBtYXRjaCB0aGVcclxuLy8gdmVydGljYWwgaGVpZ2h0IG9mIGVhY2ggdGl0bGUtbGFiZWwgYWNyb3NzIHNjcmVlbnMsIHJlZ2FyZGxlc3Mgb2YgdGhlaXIgc2NhbGluZy5cclxuY29uc3QgVElUTEVfQUxJR05fR1JPVVAgPSBuZXcgQWxpZ25Hcm91cCggeyBtYXRjaEhvcml6b250YWw6IGZhbHNlLCBtYXRjaFZlcnRpY2FsOiB0cnVlIH0gKTtcclxuXHJcblxyXG5jbGFzcyBCYWxsVmFsdWVzUGFuZWwgZXh0ZW5kcyBQYW5lbCB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7QmFsbFN5c3RlbX0gYmFsbFN5c3RlbSAtIHRoZSBzeXN0ZW0gb2YgQmFsbHMuXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48Ym9vbGVhbj59IG1vcmVEYXRhVmlzaWJsZVByb3BlcnR5IC0gaW5kaWNhdGVzIGlmIHRoZSBcIk1vcmUgRGF0YVwiIGNoZWNrYm94IGlzIGNoZWNrZWQuXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGRpbWVuc2lvbiAtIHRoZSBkaW1lbnNpb24gb2YgdGhlIFBsYXlBcmVhLlxyXG4gICAqIEBwYXJhbSB7S2V5cGFkRGlhbG9nfSBrZXlwYWREaWFsb2cgLSBLZXlwYWREaWFsb2cgaW5zdGFuY2UgZm9yIHRoZSBzY3JlZW4uXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBiYWxsU3lzdGVtLCBtb3JlRGF0YVZpc2libGVQcm9wZXJ0eSwgZGltZW5zaW9uLCBrZXlwYWREaWFsb2csIG9wdGlvbnMgKSB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBiYWxsU3lzdGVtIGluc3RhbmNlb2YgQmFsbFN5c3RlbSwgYGludmFsaWQgYmFsbFN5c3RlbTogJHtiYWxsU3lzdGVtfWAgKTtcclxuICAgIGFzc2VydCAmJiBBc3NlcnRVdGlscy5hc3NlcnRQcm9wZXJ0eU9mKCBtb3JlRGF0YVZpc2libGVQcm9wZXJ0eSwgJ2Jvb2xlYW4nICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBQbGF5QXJlYS5EaW1lbnNpb24uaW5jbHVkZXMoIGRpbWVuc2lvbiApLCBgaW52YWxpZCBkaW1lbnNpb246ICR7ZGltZW5zaW9ufWAgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGtleXBhZERpYWxvZyBpbnN0YW5jZW9mIEtleXBhZERpYWxvZywgYGludmFsaWQga2V5cGFkRGlhbG9nOiAke2tleXBhZERpYWxvZ31gICk7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7fSwgQ29sbGlzaW9uTGFiQ29uc3RhbnRzLlBBTkVMX09QVElPTlMsIHtcclxuXHJcbiAgICAgIGJhbGxJY29uQ29sdW1uU3BhY2luZzogMTIsICAgLy8ge251bWJlcn0gLSB4LXNwYWNpbmcgYmV0d2VlbiB0aGUgYmFsbC1pY29ucyBhbmQgdGhlIGZpcnN0IGNvbHVtbi5cclxuICAgICAgY29tcG9uZW50Q29sdW1uc1NwYWNpbmc6IDEyLCAvLyB7bnVtYmVyfSAtIHgtc3BhY2luZyBiZXR3ZWVuIHRoZSB4IGFuZCB5IGNvbXBvbmVudHMgb2YgTnVtYmVyRGlzcGxheSBjb2x1bW5zLlxyXG4gICAgICBjb2x1bW5Hcm91cFNwYWNpbmc6IDIxLCAgICAgIC8vIHtudW1iZXJ9IC0geC1zcGFjaW5nIGJldHdlZW4gZWFjaCBncm91cCBvZiBjb2x1bW5zLlxyXG4gICAgICB0aXRsZUxhYmVsU3BhY2luZzogMC41LCAgICAgIC8vIHtudW1iZXJ9IC0geS1tYXJnaW4gYmV0d2VlbiB0aGUgY29sdW1uIGdyb3VwcyBhbmQgdGhlIHRpdGxlLWxhYmVscyBhYm92ZSB0aGVtLlxyXG5cclxuICAgICAgbWFzc1RpdGxlTWF4V2lkdGg6IDY3LCAgICAgICAgICAgIC8vIHtudW1iZXJ9IC0gbWF4V2lkdGggZm9yIHRoZSAnTWFzcyAoa2cpJyB0aXRsZSBsYWJlbCwgZm9yIGkxOG4uXHJcbiAgICAgIGNvbXBvbmVudEdyb3VwVGl0bGVNYXhXaWR0aDogMTQwLCAvLyB7bnVtYmVyfSAtIG1heFdpZHRoIGZvciB0aGUgdGl0bGUgbGFiZWxzIG9mIGNvbXBvbmVudCBncm91cHMsIGZvciBpMThuLlxyXG5cclxuICAgICAgLy8ge0ZvbnR9IC0gYXBwbGllZCB0byBhbGwgb2YgdGhlIHRpdGxlLWxhYmVsIFRleHQgaW5zdGFuY2VzXHJcbiAgICAgIHRpdGxlRm9udDogQ29sbGlzaW9uTGFiQ29uc3RhbnRzLlBBTkVMX1RJVExFX0ZPTlRcclxuXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgLy8gQ3JlYXRlIGVhY2ggQmFsbFZhbHVlc1BhbmVsQ29sdW1uTm9kZSBmb3IgZWFjaCBCYWxsVmFsdWVzUGFuZWxDb2x1bW5UeXBlcyB0aGF0IGFyZSBjb21tb24gdG8gYm90aCAxRCBhbmQgMkQuXHJcbiAgICBjb25zdCBiYWxsSWNvbnNDb2x1bW5Ob2RlID0gbmV3IEJhbGxWYWx1ZXNQYW5lbENvbHVtbk5vZGUoIGJhbGxTeXN0ZW0sIEJhbGxWYWx1ZXNQYW5lbENvbHVtblR5cGVzLkJBTExfSUNPTlMsIGtleXBhZERpYWxvZyApO1xyXG4gICAgY29uc3QgeFBvc2l0aW9uQ29sdW1uTm9kZSA9IG5ldyBCYWxsVmFsdWVzUGFuZWxDb2x1bW5Ob2RlKCBiYWxsU3lzdGVtLCBCYWxsVmFsdWVzUGFuZWxDb2x1bW5UeXBlcy5YX1BPU0lUSU9OLCBrZXlwYWREaWFsb2cgKTtcclxuICAgIGNvbnN0IHhWZWxvY2l0eUNvbHVtbk5vZGUgPSBuZXcgQmFsbFZhbHVlc1BhbmVsQ29sdW1uTm9kZSggYmFsbFN5c3RlbSwgQmFsbFZhbHVlc1BhbmVsQ29sdW1uVHlwZXMuWF9WRUxPQ0lUWSwga2V5cGFkRGlhbG9nICk7XHJcbiAgICBjb25zdCB4TW9tZW50dW1Db2x1bW5Ob2RlID0gbmV3IEJhbGxWYWx1ZXNQYW5lbENvbHVtbk5vZGUoIGJhbGxTeXN0ZW0sIEJhbGxWYWx1ZXNQYW5lbENvbHVtblR5cGVzLlhfTU9NRU5UVU0sIGtleXBhZERpYWxvZyApO1xyXG4gICAgY29uc3QgbWFzc0NvbHVtbk5vZGUgPSBuZXcgQmFsbFZhbHVlc1BhbmVsQ29sdW1uTm9kZSggYmFsbFN5c3RlbSwgQmFsbFZhbHVlc1BhbmVsQ29sdW1uVHlwZXMuTUFTUywga2V5cGFkRGlhbG9nICk7XHJcbiAgICBjb25zdCBtYXNzU2xpZGVyc0NvbHVtbk5vZGUgPSBuZXcgQmFsbFZhbHVlc1BhbmVsQ29sdW1uTm9kZSggYmFsbFN5c3RlbSwgQmFsbFZhbHVlc1BhbmVsQ29sdW1uVHlwZXMuTUFTU19TTElERVJTLCBrZXlwYWREaWFsb2cgKTtcclxuXHJcbiAgICAvLyBXcmFwIHRoZSBjb21wb25lbnQtc3BlY2lmaWMgY29sdW1uIGdyb3VwcyBpbnRvIGEgSEJveC4gVGhlIHktY29tcG9uZW50IGNvbHVtbnMgd2lsbCBiZSBhZGRlZCBmb3IgMkQuXHJcbiAgICBjb25zdCBwb3NpdGlvbkNvbHVtbkdyb3VwID0gbmV3IEhCb3goIHsgY2hpbGRyZW46IFsgeFBvc2l0aW9uQ29sdW1uTm9kZSBdLCBzcGFjaW5nOiBvcHRpb25zLmNvbXBvbmVudENvbHVtbnNTcGFjaW5nIH0gKTtcclxuICAgIGNvbnN0IHZlbG9jaXR5Q29sdW1uR3JvdXAgPSBuZXcgSEJveCggeyBjaGlsZHJlbjogWyB4VmVsb2NpdHlDb2x1bW5Ob2RlIF0sIHNwYWNpbmc6IG9wdGlvbnMuY29tcG9uZW50Q29sdW1uc1NwYWNpbmcgfSApO1xyXG4gICAgY29uc3QgbW9tZW50dW1Db2x1bW5Hcm91cCA9IG5ldyBIQm94KCB7IGNoaWxkcmVuOiBbIHhNb21lbnR1bUNvbHVtbk5vZGUgXSwgc3BhY2luZzogb3B0aW9ucy5jb21wb25lbnRDb2x1bW5zU3BhY2luZyB9ICk7XHJcblxyXG4gICAgLy8gRm9yIDJEIHNjcmVlbnMsIGFkZCB0aGUgeS1jb21wb25lbnQgY29sdW1ucyB0byB0aGVpciBjb3JyZWxhdGluZyBncm91cC5cclxuICAgIGlmICggZGltZW5zaW9uID09PSBQbGF5QXJlYS5EaW1lbnNpb24uVFdPICkge1xyXG4gICAgICBjb25zdCB5UG9zaXRpb25Db2x1bW5Ob2RlID0gbmV3IEJhbGxWYWx1ZXNQYW5lbENvbHVtbk5vZGUoIGJhbGxTeXN0ZW0sIEJhbGxWYWx1ZXNQYW5lbENvbHVtblR5cGVzLllfUE9TSVRJT04sIGtleXBhZERpYWxvZyApO1xyXG4gICAgICBjb25zdCB5VmVsb2NpdHlDb2x1bW5Ob2RlID0gbmV3IEJhbGxWYWx1ZXNQYW5lbENvbHVtbk5vZGUoIGJhbGxTeXN0ZW0sIEJhbGxWYWx1ZXNQYW5lbENvbHVtblR5cGVzLllfVkVMT0NJVFksIGtleXBhZERpYWxvZyApO1xyXG4gICAgICBjb25zdCB5TW9tZW50dW1Db2x1bW5Ob2RlID0gbmV3IEJhbGxWYWx1ZXNQYW5lbENvbHVtbk5vZGUoIGJhbGxTeXN0ZW0sIEJhbGxWYWx1ZXNQYW5lbENvbHVtblR5cGVzLllfTU9NRU5UVU0sIGtleXBhZERpYWxvZyApO1xyXG5cclxuICAgICAgcG9zaXRpb25Db2x1bW5Hcm91cC5hZGRDaGlsZCggeVBvc2l0aW9uQ29sdW1uTm9kZSApO1xyXG4gICAgICB2ZWxvY2l0eUNvbHVtbkdyb3VwLmFkZENoaWxkKCB5VmVsb2NpdHlDb2x1bW5Ob2RlICk7XHJcbiAgICAgIG1vbWVudHVtQ29sdW1uR3JvdXAuYWRkQ2hpbGQoIHlNb21lbnR1bUNvbHVtbk5vZGUgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAvLyBDb252ZW5pZW5jZSBmdW5jdGlvbiB0byBjcmVhdGUgdGhlIHRpdGxlLWxhYmVsIHRoYXQgYXBwZWFycyBhYm92ZSBlYWNoIGNvbHVtbiBncm91cC5cclxuICAgIGNvbnN0IGNyZWF0ZVRpdGxlTGFiZWwgPSAoIGxhYmVsLCB1bml0cywgbWF4V2lkdGggPSBvcHRpb25zLmNvbXBvbmVudEdyb3VwVGl0bGVNYXhXaWR0aCApID0+IHtcclxuICAgICAgY29uc3QgdGl0bGVTdHJpbmcgPSBTdHJpbmdVdGlscy5maWxsSW4oIENvbGxpc2lvbkxhYlN0cmluZ3MucGF0dGVybi5sYWJlbFBhcmVudGhlc2VzVW5pdHMsIHtcclxuICAgICAgICBsYWJlbDogbGFiZWwsXHJcbiAgICAgICAgdW5pdHM6IHVuaXRzXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAgIC8vIFdyYXAgdGhlIHRleHQgaW4gYW4gQWxpZ25Hcm91cCB0byBtYXRjaCBoZWlnaHQuXHJcbiAgICAgIHJldHVybiBUSVRMRV9BTElHTl9HUk9VUC5jcmVhdGVCb3goIG5ldyBUZXh0KCB0aXRsZVN0cmluZywge1xyXG4gICAgICAgIGZvbnQ6IG9wdGlvbnMudGl0bGVGb250LFxyXG4gICAgICAgIG1heFdpZHRoOiBtYXhXaWR0aFxyXG4gICAgICB9ICkgKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRoZSBUaXRsZSBMYWJlbHMgZm9yIGVhY2ggc2VjdGlvbiBvZiB0aGUgQmFsbFZhbHVlc1BhbmVsLlxyXG4gICAgY29uc3QgbWFzc1RpdGxlTm9kZSA9IGNyZWF0ZVRpdGxlTGFiZWwoIENvbGxpc2lvbkxhYlN0cmluZ3MubWFzcywgQ29sbGlzaW9uTGFiU3RyaW5ncy51bml0cy5raWxvZ3JhbXMsIG9wdGlvbnMubWFzc1RpdGxlTWF4V2lkdGggKTtcclxuICAgIGNvbnN0IG1vbWVudHVtVGl0bGVOb2RlID0gY3JlYXRlVGl0bGVMYWJlbCggQ29sbGlzaW9uTGFiU3RyaW5ncy5tb21lbnR1bSwgQ29sbGlzaW9uTGFiU3RyaW5ncy51bml0cy5raWxvZ3JhbU1ldGVyc1BlclNlY29uZCApO1xyXG4gICAgY29uc3QgcG9zaXRpb25UaXRsZU5vZGUgPSBjcmVhdGVUaXRsZUxhYmVsKCBDb2xsaXNpb25MYWJTdHJpbmdzLnBvc2l0aW9uLCBDb2xsaXNpb25MYWJTdHJpbmdzLnVuaXRzLm1ldGVycyApO1xyXG4gICAgY29uc3QgdmVsb2NpdHlUaXRsZU5vZGUgPSBjcmVhdGVUaXRsZUxhYmVsKCBDb2xsaXNpb25MYWJTdHJpbmdzLnZlbG9jaXR5LCBDb2xsaXNpb25MYWJTdHJpbmdzLnVuaXRzLm1ldGVyc1BlclNlY29uZCApO1xyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIC8vIENvbnZlbmllbmNlIGZ1bmN0aW9uIHRvIGNyZWF0ZSBlYWNoIHNlY3Rpb24gb2YgdGhlIFBhbmVsLCB3aGljaCBpbmNsdWRlcyB0aGUgY29sdW1uIGdyb3VwIGFuZCBhIHRpdGxlIGFib3ZlIGl0LlxyXG4gICAgY29uc3QgY3JlYXRlU2VjdGlvbk5vZGUgPSAoIHRpdGxlTm9kZSwgY29sdW1uR3JvdXAsIGlzQ29tcG9uZW50Q29sdW1uR3JvdXAgPSB0cnVlICkgPT4ge1xyXG4gICAgICByZXR1cm4gbmV3IFZCb3goIHtcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgdGl0bGVOb2RlLFxyXG5cclxuICAgICAgICAgIC8vIElmIHRoZSBncm91cCBpcyBhIGdyb3VwaW5nIG9mIGNvbXBvbmVudCBjb2x1bW5zLCB3cmFwIHRoZSBjb2x1bW4gZ3JvdXAgaW4gYSBhbGlnbiBncm91cCB0byBtYXRjaCB3aWR0aC5cclxuICAgICAgICAgIGlzQ29tcG9uZW50Q29sdW1uR3JvdXAgPyBDT01QT05FTlRfQ09MVU1OX0dST1VQX0FMSUdOX0dST1VQLmNyZWF0ZUJveCggY29sdW1uR3JvdXAgKSA6IGNvbHVtbkdyb3VwXHJcbiAgICAgICAgXSxcclxuICAgICAgICBzcGFjaW5nOiBvcHRpb25zLnRpdGxlTGFiZWxTcGFjaW5nXHJcbiAgICAgIH0gKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gSG9yaXpvbnRhbGx5IGdyb3VwIHRoZSBjb2x1bW4gZ3JvdXBzIHdpdGggdGhlaXIgcmVzcGVjdGl2ZSB0aXRsZS1sYWJlbHMuXHJcbiAgICBjb25zdCBtYXNzU2VjdGlvbk5vZGUgPSBjcmVhdGVTZWN0aW9uTm9kZSggbWFzc1RpdGxlTm9kZSwgbWFzc0NvbHVtbk5vZGUsIGZhbHNlICk7XHJcbiAgICBjb25zdCBwb3NpdGlvblNlY3Rpb25Ob2RlID0gY3JlYXRlU2VjdGlvbk5vZGUoIHBvc2l0aW9uVGl0bGVOb2RlLCBwb3NpdGlvbkNvbHVtbkdyb3VwICk7XHJcbiAgICBjb25zdCB2ZWxvY2l0eVNlY3Rpb25Ob2RlID0gY3JlYXRlU2VjdGlvbk5vZGUoIHZlbG9jaXR5VGl0bGVOb2RlLCB2ZWxvY2l0eUNvbHVtbkdyb3VwICk7XHJcbiAgICBjb25zdCBtb21lbnR1bVNlY3Rpb25Ob2RlID0gY3JlYXRlU2VjdGlvbk5vZGUoIG1vbWVudHVtVGl0bGVOb2RlLCBtb21lbnR1bUNvbHVtbkdyb3VwICk7XHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgLy8gVGhlIGNvbnRlbnQgb2YgdGhlIGVudGlyZSBQYW5lbCB3aGVuIFwiTW9yZSBEYXRhXCIgaXMgY2hlY2tlZC5cclxuICAgIGNvbnN0IG1vcmVEYXRhQm94ID0gbmV3IEhCb3goIHtcclxuICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICBuZXcgTm9kZSggeyBjaGlsZHJlbjogWyBtYXNzU2VjdGlvbk5vZGUgXSB9ICksXHJcbiAgICAgICAgcG9zaXRpb25TZWN0aW9uTm9kZSxcclxuICAgICAgICB2ZWxvY2l0eVNlY3Rpb25Ob2RlLFxyXG4gICAgICAgIG1vbWVudHVtU2VjdGlvbk5vZGVcclxuICAgICAgXSxcclxuICAgICAgc3BhY2luZzogb3B0aW9ucy5jb2x1bW5Hcm91cFNwYWNpbmcsXHJcbiAgICAgIGFsaWduOiAnYm90dG9tJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFRoZSBjb250ZW50IG9mIHRoZSBlbnRpcmUgUGFuZWwgd2hlbiBcIk1vcmUgRGF0YVwiIGlzIG5vdCBjaGVja2VkLlxyXG4gICAgY29uc3QgbGVzc0RhdGFCb3ggPSBuZXcgSEJveCgge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIG1hc3NTZWN0aW9uTm9kZSBdIH0gKSxcclxuICAgICAgICBtYXNzU2xpZGVyc0NvbHVtbk5vZGVcclxuICAgICAgXSxcclxuICAgICAgc3BhY2luZzogb3B0aW9ucy5jb2x1bW5Hcm91cFNwYWNpbmcsXHJcbiAgICAgIGFsaWduOiAnYm90dG9tJ1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIE9ic2VydmUgd2hlbiB0aGUgbW9yZURhdGFWaXNpYmxlUHJvcGVydHkgY2hhbmdlcyBhbmQgdXBkYXRlIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBjb250ZW50IG9mIHRoZSBQYW5lbC5cclxuICAgIC8vIExpbmsgaXMgbm90IHJlbW92ZWQgc2luY2UgQmFsbFZhbHVlc1BhbmVscyBhcmUgbmV2ZXIgZGlzcG9zZWQuXHJcbiAgICBtb3JlRGF0YVZpc2libGVQcm9wZXJ0eS5saW5rKCBtb3JlRGF0YVZpc2libGUgPT4ge1xyXG4gICAgICBtb3JlRGF0YUJveC52aXNpYmxlID0gbW9yZURhdGFWaXNpYmxlO1xyXG4gICAgICBsZXNzRGF0YUJveC52aXNpYmxlID0gIW1vcmVEYXRhVmlzaWJsZTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBzdXBlciggbmV3IEhCb3goIHtcclxuICAgICAgc3BhY2luZzogb3B0aW9ucy5iYWxsSWNvbkNvbHVtblNwYWNpbmcsXHJcbiAgICAgIGNoaWxkcmVuOiBbIGJhbGxJY29uc0NvbHVtbk5vZGUsIG1vcmVEYXRhQm94LCBsZXNzRGF0YUJveCBdLFxyXG4gICAgICBhbGlnbjogJ2JvdHRvbSdcclxuICAgIH0gKSwgb3B0aW9ucyApO1xyXG4gIH1cclxufVxyXG5cclxuY29sbGlzaW9uTGFiLnJlZ2lzdGVyKCAnQmFsbFZhbHVlc1BhbmVsJywgQmFsbFZhbHVlc1BhbmVsICk7XHJcbmV4cG9ydCBkZWZhdWx0IEJhbGxWYWx1ZXNQYW5lbDsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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