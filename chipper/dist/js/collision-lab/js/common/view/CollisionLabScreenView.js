// Copyright 2019-2022, University of Colorado Boulder

/**
 * Root class (to be subclassed) for the top-level view of every screen in the 'Collision Lab' simulation.
 *
 * Displays these components:
 *   Balls
 *   PlayArea, Scale Bar, Kinetic Energy NumberDisplay
 *   PlayAreaTopRightControls
 *   Return Balls Button
 *   Restart button and Elapsed Time NumberDisplay
 *   BallValuesPanel
 *   Momenta Diagram
 *   Control Panel
 *   Time controls (play/pause, step buttons)
 *   Reset All Button
 *
 * @author Brandon Li
 * @author Martin Veillette
 */

import Vector2 from '../../../../dot/js/Vector2.js';
import ScreenView from '../../../../joist/js/ScreenView.js';
import merge from '../../../../phet-core/js/merge.js';
import Orientation from '../../../../phet-core/js/Orientation.js';
import ModelViewTransform2 from '../../../../phetcommon/js/view/ModelViewTransform2.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import collisionLab from '../../collisionLab.js';
import CollisionLabColors from '../CollisionLabColors.js';
import CollisionLabConstants from '../CollisionLabConstants.js';
import CollisionLabModel from '../model/CollisionLabModel.js';
import PlayArea from '../model/PlayArea.js';
import BallValuesPanel from './BallValuesPanel.js';
import CollisionLabTimeControlNode from './CollisionLabTimeControlNode.js';
import CollisionLabViewProperties from './CollisionLabViewProperties.js';
import ElapsedTimeNumberDisplay from './ElapsedTimeNumberDisplay.js';
import KeypadDialog from '../../../../scenery-phet/js/keypad/KeypadDialog.js';
import KineticEnergyNumberDisplay from './KineticEnergyNumberDisplay.js';
import MomentaDiagramAccordionBox from './MomentaDiagramAccordionBox.js';
import MoreDataCheckbox from './MoreDataCheckbox.js';
import PlayAreaNode from './PlayAreaNode.js';
import PlayAreaScaleBarNode from './PlayAreaScaleBarNode.js';
import PlayAreaTopRightControls from './PlayAreaTopRightControls.js';
import RestartButton from './RestartButton.js';
import ReturnBallsButton from './ReturnBallsButton.js';
import { ManualConstraint } from '../../../../scenery/js/imports.js';

// constants
const MODEL_TO_VIEW_SCALE = 152; // Meter to view coordinates scale factor.
const PLAY_AREA_LEFT = 55;
const BALL_VALUES_PANEL_TOP = 410;

// @abstract
class CollisionLabScreenView extends ScreenView {
  /**
   * @param {CollisionLabModel} model
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(model, tandem, options) {
    assert && assert(model instanceof CollisionLabModel, `invalid model: ${model}`);
    assert && assert(tandem instanceof Tandem, `invalid tandem: ${tandem}`);
    options = merge({
      // {number} - the top of the PlayArea, in view coordinates.
      playAreaTop: CollisionLabConstants.SCREEN_VIEW_Y_MARGIN,
      // {boolean} - indicates if the PlayAreaTopRightControls is included.
      includePlayAreaTopRightControls: true,
      // {boolean}
      includeStepBack: true,
      // {Object} - options to passed to the PlayAreaTopRightControls, if it is included.
      playAreaTopRightControlsOptions: null
    }, options);
    super(options);

    //----------------------------------------------------------------------------------------

    // Create the ModelViewTransform for the view hierarchy, which maps the coordinates of the PlayArea (meters) to view
    // coordinates. Uses an inverted mapping so that +y is downwards in the view coordinate frame.
    const modelViewTransform = ModelViewTransform2.createSinglePointScaleInvertedYMapping(new Vector2(model.playArea.left, model.playArea.top), new Vector2(PLAY_AREA_LEFT, options.playAreaTop), MODEL_TO_VIEW_SCALE);

    // Create the view-specific properties for the screen.
    const viewProperties = new CollisionLabViewProperties();

    // Convenience reference to the view-bounds of the PlayArea. Used for layout.
    const playAreaViewBounds = modelViewTransform.modelToViewBounds(model.playArea.bounds);

    //----------------------------------------------------------------------------------------

    // PlayArea
    const playAreaNode = new PlayAreaNode(model.playArea, model.playArea.gridVisibleProperty, modelViewTransform);

    // @private {BallSystem}
    this.ballSystemNode = this.createBallSystemNode(model, viewProperties, modelViewTransform);

    // Scale Bar
    const scaleBar = new PlayAreaScaleBarNode(0.5, modelViewTransform, {
      scaleBarOrientation: model.playArea.dimension === PlayArea.Dimension.ONE ? Orientation.HORIZONTAL : Orientation.VERTICAL
    });
    ManualConstraint.create(this, [scaleBar], scaleBarProxy => {
      if (model.playArea.dimension === PlayArea.Dimension.ONE) {
        scaleBarProxy.leftBottom = playAreaViewBounds.leftTop.minusXY(0, 5);
      } else {
        scaleBarProxy.rightTop = playAreaViewBounds.leftTop.minusXY(5, 0);
      }
    });

    // Kinetic Energy NumberDisplay
    const kineticEnergyNumberDisplay = new KineticEnergyNumberDisplay(model.ballSystem.totalKineticEnergyProperty, {
      visibleProperty: viewProperties.kineticEnergyVisibleProperty,
      left: playAreaViewBounds.left + 5,
      bottom: playAreaViewBounds.bottom - 3
    });

    // Return Balls Button
    const returnBallsButton = new ReturnBallsButton(model.ballSystem.ballsNotInsidePlayAreaProperty, {
      center: playAreaViewBounds.center,
      listener: model.returnBalls.bind(model)
    });

    //----------------------------------------------------------------------------------------

    // Elapsed Time NumberDisplay
    const elapsedTimeNumberDisplay = new ElapsedTimeNumberDisplay(model.elapsedTimeProperty, {
      left: playAreaViewBounds.left,
      top: playAreaViewBounds.bottom + 10
    });

    // Time controls (play/pause, step buttons)
    const timeControlNode = new CollisionLabTimeControlNode(model.isPlayingProperty, model.timeSpeedProperty, model.elapsedTimeProperty, model.ballSystem.ballSystemUserControlledProperty, model.playArea.elasticityPercentProperty, {
      playPauseStepButtonOptions: {
        stepBackwardButtonOptions: {
          listener: model.stepBackwards.bind(model)
        },
        stepForwardButtonOptions: {
          listener: model.stepForwards.bind(model)
        },
        includeStepBackwardButton: options.includeStepBack
      }
    });
    timeControlNode.setPlayPauseButtonCenter(playAreaViewBounds.centerBottom.plusXY(0, timeControlNode.height / 2 + 10));

    // Restart Button
    const restartButton = new RestartButton({
      listener: () => {
        this.interruptSubtreeInput();
        model.restart();
      },
      right: playAreaViewBounds.right,
      top: elapsedTimeNumberDisplay.top
    });

    //----------------------------------------------------------------------------------------

    // KeypadDialog
    const keypadDialog = new KeypadDialog({
      layoutStrategy: (keypadDialog, simBounds, screenBounds, scale) => {
        keypadDialog.leftBottom = this.ballValuesPanel.rightBottom.plusXY(10, 0);
      },
      keypadOptions: {
        accumulatorOptions: {
          // {number} - maximum number of digits that can be entered on the keypad.
          maxDigits: 8,
          // {number} - maximum number of decimal places that can be entered on the keypad.
          maxDigitsRightOfMantissa: CollisionLabConstants.DISPLAY_DECIMAL_PLACES
        }
      },
      enterButtonOptions: {
        baseColor: CollisionLabColors.KEYPAD_ENTER_BUTTON
      },
      fill: CollisionLabColors.PANEL_FILL,
      stroke: CollisionLabColors.PANEL_STROKE
    });

    // @protected - BallValuesPanel, exposed to sub-classes for layout.
    this.ballValuesPanel = new BallValuesPanel(model.ballSystem, viewProperties.moreDataVisibleProperty, model.playArea.dimension, keypadDialog, {
      top: BALL_VALUES_PANEL_TOP,
      left: playAreaViewBounds.left
    });

    // More Data Checkbox
    const moreDataCheckbox = new MoreDataCheckbox(viewProperties.moreDataVisibleProperty, {
      bottom: this.ballValuesPanel.top - 4,
      left: playAreaViewBounds.left
    });

    // ControlPanel
    const controlPanel = this.createControlPanel(viewProperties, model, {
      right: this.layoutBounds.maxX - CollisionLabConstants.SCREEN_VIEW_X_MARGIN,
      top: CollisionLabConstants.SCREEN_VIEW_Y_MARGIN
    });

    // Momenta Diagram
    const momentaDiagram = new MomentaDiagramAccordionBox(model.momentaDiagram, model.ballSystem.balls, {
      dimension: model.playArea.dimension,
      centerX: controlPanel.centerX,
      top: controlPanel.bottom + 8
    });

    // Reset All Button
    const resetAllButton = new ResetAllButton({
      listener: () => {
        this.interruptSubtreeInput();
        model.reset();
        viewProperties.reset();
        this.ballSystemNode.reset();
      },
      right: this.layoutBounds.maxX - CollisionLabConstants.SCREEN_VIEW_X_MARGIN,
      bottom: this.layoutBounds.maxY - CollisionLabConstants.SCREEN_VIEW_Y_MARGIN
    });

    //----------------------------------------------------------------------------------------

    // Set the children in the correct rendering order.
    this.children = [this.ballValuesPanel, moreDataCheckbox, playAreaNode, scaleBar, elapsedTimeNumberDisplay, timeControlNode, restartButton, resetAllButton, controlPanel, momentaDiagram, kineticEnergyNumberDisplay, this.ballSystemNode, returnBallsButton];

    //----------------------------------------------------------------------------------------

    // Add the PlayAreaTopRightControls if it is included.
    if (options.includePlayAreaTopRightControls) {
      const playAreaControlSet = new PlayAreaTopRightControls(model.ballSystem.numberOfBallsProperty, model.ballSystem.numberOfBallsRange, model.playArea.gridVisibleProperty, merge({
        left: playAreaViewBounds.right + 8,
        top: playAreaViewBounds.top + 2
      }, options.playAreaTopRightControlsOptions));
      this.addChild(playAreaControlSet);
      playAreaControlSet.moveToBack();
    }
  }

  /**
   * @abstract
   * Creates the ControlPanel for the screen. Called in the constructor of the CollisionLabScreenView. This is an
   * abstract method because some screens use sub-types of CollisionLabControlPanel and have different APIs, but all
   * screens have a CollisionLabControlPanel.
   *
   * @protected
   * @param {CollisionLabViewProperties} viewProperties
   * @param {CollisionLabModel} model
   * @param {Object} [options]
   * @returns {CollisionLabControlPanel}
   */
  createControlPanel(viewProperties, model, options) {
    assert && assert(false, 'abstract method must be overridden');
  }

  /**
   * @abstract
   * Creates the ControlPanel for the screen. Called in the constructor of the CollisionLabScreenView. This is an
   * abstract method because some screens use sub-types of BallSystemNode, but all screens have a BallSystemNode.
   *
   * @protected
   * @param {CollisionLabModel} model
   * @param {CollisionLabViewProperties} viewProperties
   * @param {ModelViewTransform2} modelViewTransform
   * @returns {BallSystemNode}
   */
  createBallSystemNode(model, viewProperties, modelViewTransform) {
    assert && assert(false, 'abstract method must be overridden');
  }
}
collisionLab.register('CollisionLabScreenView', CollisionLabScreenView);
export default CollisionLabScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWZWN0b3IyIiwiU2NyZWVuVmlldyIsIm1lcmdlIiwiT3JpZW50YXRpb24iLCJNb2RlbFZpZXdUcmFuc2Zvcm0yIiwiUmVzZXRBbGxCdXR0b24iLCJUYW5kZW0iLCJjb2xsaXNpb25MYWIiLCJDb2xsaXNpb25MYWJDb2xvcnMiLCJDb2xsaXNpb25MYWJDb25zdGFudHMiLCJDb2xsaXNpb25MYWJNb2RlbCIsIlBsYXlBcmVhIiwiQmFsbFZhbHVlc1BhbmVsIiwiQ29sbGlzaW9uTGFiVGltZUNvbnRyb2xOb2RlIiwiQ29sbGlzaW9uTGFiVmlld1Byb3BlcnRpZXMiLCJFbGFwc2VkVGltZU51bWJlckRpc3BsYXkiLCJLZXlwYWREaWFsb2ciLCJLaW5ldGljRW5lcmd5TnVtYmVyRGlzcGxheSIsIk1vbWVudGFEaWFncmFtQWNjb3JkaW9uQm94IiwiTW9yZURhdGFDaGVja2JveCIsIlBsYXlBcmVhTm9kZSIsIlBsYXlBcmVhU2NhbGVCYXJOb2RlIiwiUGxheUFyZWFUb3BSaWdodENvbnRyb2xzIiwiUmVzdGFydEJ1dHRvbiIsIlJldHVybkJhbGxzQnV0dG9uIiwiTWFudWFsQ29uc3RyYWludCIsIk1PREVMX1RPX1ZJRVdfU0NBTEUiLCJQTEFZX0FSRUFfTEVGVCIsIkJBTExfVkFMVUVTX1BBTkVMX1RPUCIsIkNvbGxpc2lvbkxhYlNjcmVlblZpZXciLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwidGFuZGVtIiwib3B0aW9ucyIsImFzc2VydCIsInBsYXlBcmVhVG9wIiwiU0NSRUVOX1ZJRVdfWV9NQVJHSU4iLCJpbmNsdWRlUGxheUFyZWFUb3BSaWdodENvbnRyb2xzIiwiaW5jbHVkZVN0ZXBCYWNrIiwicGxheUFyZWFUb3BSaWdodENvbnRyb2xzT3B0aW9ucyIsIm1vZGVsVmlld1RyYW5zZm9ybSIsImNyZWF0ZVNpbmdsZVBvaW50U2NhbGVJbnZlcnRlZFlNYXBwaW5nIiwicGxheUFyZWEiLCJsZWZ0IiwidG9wIiwidmlld1Byb3BlcnRpZXMiLCJwbGF5QXJlYVZpZXdCb3VuZHMiLCJtb2RlbFRvVmlld0JvdW5kcyIsImJvdW5kcyIsInBsYXlBcmVhTm9kZSIsImdyaWRWaXNpYmxlUHJvcGVydHkiLCJiYWxsU3lzdGVtTm9kZSIsImNyZWF0ZUJhbGxTeXN0ZW1Ob2RlIiwic2NhbGVCYXIiLCJzY2FsZUJhck9yaWVudGF0aW9uIiwiZGltZW5zaW9uIiwiRGltZW5zaW9uIiwiT05FIiwiSE9SSVpPTlRBTCIsIlZFUlRJQ0FMIiwiY3JlYXRlIiwic2NhbGVCYXJQcm94eSIsImxlZnRCb3R0b20iLCJsZWZ0VG9wIiwibWludXNYWSIsInJpZ2h0VG9wIiwia2luZXRpY0VuZXJneU51bWJlckRpc3BsYXkiLCJiYWxsU3lzdGVtIiwidG90YWxLaW5ldGljRW5lcmd5UHJvcGVydHkiLCJ2aXNpYmxlUHJvcGVydHkiLCJraW5ldGljRW5lcmd5VmlzaWJsZVByb3BlcnR5IiwiYm90dG9tIiwicmV0dXJuQmFsbHNCdXR0b24iLCJiYWxsc05vdEluc2lkZVBsYXlBcmVhUHJvcGVydHkiLCJjZW50ZXIiLCJsaXN0ZW5lciIsInJldHVybkJhbGxzIiwiYmluZCIsImVsYXBzZWRUaW1lTnVtYmVyRGlzcGxheSIsImVsYXBzZWRUaW1lUHJvcGVydHkiLCJ0aW1lQ29udHJvbE5vZGUiLCJpc1BsYXlpbmdQcm9wZXJ0eSIsInRpbWVTcGVlZFByb3BlcnR5IiwiYmFsbFN5c3RlbVVzZXJDb250cm9sbGVkUHJvcGVydHkiLCJlbGFzdGljaXR5UGVyY2VudFByb3BlcnR5IiwicGxheVBhdXNlU3RlcEJ1dHRvbk9wdGlvbnMiLCJzdGVwQmFja3dhcmRCdXR0b25PcHRpb25zIiwic3RlcEJhY2t3YXJkcyIsInN0ZXBGb3J3YXJkQnV0dG9uT3B0aW9ucyIsInN0ZXBGb3J3YXJkcyIsImluY2x1ZGVTdGVwQmFja3dhcmRCdXR0b24iLCJzZXRQbGF5UGF1c2VCdXR0b25DZW50ZXIiLCJjZW50ZXJCb3R0b20iLCJwbHVzWFkiLCJoZWlnaHQiLCJyZXN0YXJ0QnV0dG9uIiwiaW50ZXJydXB0U3VidHJlZUlucHV0IiwicmVzdGFydCIsInJpZ2h0Iiwia2V5cGFkRGlhbG9nIiwibGF5b3V0U3RyYXRlZ3kiLCJzaW1Cb3VuZHMiLCJzY3JlZW5Cb3VuZHMiLCJzY2FsZSIsImJhbGxWYWx1ZXNQYW5lbCIsInJpZ2h0Qm90dG9tIiwia2V5cGFkT3B0aW9ucyIsImFjY3VtdWxhdG9yT3B0aW9ucyIsIm1heERpZ2l0cyIsIm1heERpZ2l0c1JpZ2h0T2ZNYW50aXNzYSIsIkRJU1BMQVlfREVDSU1BTF9QTEFDRVMiLCJlbnRlckJ1dHRvbk9wdGlvbnMiLCJiYXNlQ29sb3IiLCJLRVlQQURfRU5URVJfQlVUVE9OIiwiZmlsbCIsIlBBTkVMX0ZJTEwiLCJzdHJva2UiLCJQQU5FTF9TVFJPS0UiLCJtb3JlRGF0YVZpc2libGVQcm9wZXJ0eSIsIm1vcmVEYXRhQ2hlY2tib3giLCJjb250cm9sUGFuZWwiLCJjcmVhdGVDb250cm9sUGFuZWwiLCJsYXlvdXRCb3VuZHMiLCJtYXhYIiwiU0NSRUVOX1ZJRVdfWF9NQVJHSU4iLCJtb21lbnRhRGlhZ3JhbSIsImJhbGxzIiwiY2VudGVyWCIsInJlc2V0QWxsQnV0dG9uIiwicmVzZXQiLCJtYXhZIiwiY2hpbGRyZW4iLCJwbGF5QXJlYUNvbnRyb2xTZXQiLCJudW1iZXJPZkJhbGxzUHJvcGVydHkiLCJudW1iZXJPZkJhbGxzUmFuZ2UiLCJhZGRDaGlsZCIsIm1vdmVUb0JhY2siLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkNvbGxpc2lvbkxhYlNjcmVlblZpZXcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTktMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogUm9vdCBjbGFzcyAodG8gYmUgc3ViY2xhc3NlZCkgZm9yIHRoZSB0b3AtbGV2ZWwgdmlldyBvZiBldmVyeSBzY3JlZW4gaW4gdGhlICdDb2xsaXNpb24gTGFiJyBzaW11bGF0aW9uLlxyXG4gKlxyXG4gKiBEaXNwbGF5cyB0aGVzZSBjb21wb25lbnRzOlxyXG4gKiAgIEJhbGxzXHJcbiAqICAgUGxheUFyZWEsIFNjYWxlIEJhciwgS2luZXRpYyBFbmVyZ3kgTnVtYmVyRGlzcGxheVxyXG4gKiAgIFBsYXlBcmVhVG9wUmlnaHRDb250cm9sc1xyXG4gKiAgIFJldHVybiBCYWxscyBCdXR0b25cclxuICogICBSZXN0YXJ0IGJ1dHRvbiBhbmQgRWxhcHNlZCBUaW1lIE51bWJlckRpc3BsYXlcclxuICogICBCYWxsVmFsdWVzUGFuZWxcclxuICogICBNb21lbnRhIERpYWdyYW1cclxuICogICBDb250cm9sIFBhbmVsXHJcbiAqICAgVGltZSBjb250cm9scyAocGxheS9wYXVzZSwgc3RlcCBidXR0b25zKVxyXG4gKiAgIFJlc2V0IEFsbCBCdXR0b25cclxuICpcclxuICogQGF1dGhvciBCcmFuZG9uIExpXHJcbiAqIEBhdXRob3IgTWFydGluIFZlaWxsZXR0ZVxyXG4gKi9cclxuXHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IFNjcmVlblZpZXcgZnJvbSAnLi4vLi4vLi4vLi4vam9pc3QvanMvU2NyZWVuVmlldy5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgT3JpZW50YXRpb24gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL09yaWVudGF0aW9uLmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgUmVzZXRBbGxCdXR0b24gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL2J1dHRvbnMvUmVzZXRBbGxCdXR0b24uanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgY29sbGlzaW9uTGFiIGZyb20gJy4uLy4uL2NvbGxpc2lvbkxhYi5qcyc7XHJcbmltcG9ydCBDb2xsaXNpb25MYWJDb2xvcnMgZnJvbSAnLi4vQ29sbGlzaW9uTGFiQ29sb3JzLmpzJztcclxuaW1wb3J0IENvbGxpc2lvbkxhYkNvbnN0YW50cyBmcm9tICcuLi9Db2xsaXNpb25MYWJDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgQ29sbGlzaW9uTGFiTW9kZWwgZnJvbSAnLi4vbW9kZWwvQ29sbGlzaW9uTGFiTW9kZWwuanMnO1xyXG5pbXBvcnQgUGxheUFyZWEgZnJvbSAnLi4vbW9kZWwvUGxheUFyZWEuanMnO1xyXG5pbXBvcnQgQmFsbFZhbHVlc1BhbmVsIGZyb20gJy4vQmFsbFZhbHVlc1BhbmVsLmpzJztcclxuaW1wb3J0IENvbGxpc2lvbkxhYlRpbWVDb250cm9sTm9kZSBmcm9tICcuL0NvbGxpc2lvbkxhYlRpbWVDb250cm9sTm9kZS5qcyc7XHJcbmltcG9ydCBDb2xsaXNpb25MYWJWaWV3UHJvcGVydGllcyBmcm9tICcuL0NvbGxpc2lvbkxhYlZpZXdQcm9wZXJ0aWVzLmpzJztcclxuaW1wb3J0IEVsYXBzZWRUaW1lTnVtYmVyRGlzcGxheSBmcm9tICcuL0VsYXBzZWRUaW1lTnVtYmVyRGlzcGxheS5qcyc7XHJcbmltcG9ydCBLZXlwYWREaWFsb2cgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL2tleXBhZC9LZXlwYWREaWFsb2cuanMnO1xyXG5pbXBvcnQgS2luZXRpY0VuZXJneU51bWJlckRpc3BsYXkgZnJvbSAnLi9LaW5ldGljRW5lcmd5TnVtYmVyRGlzcGxheS5qcyc7XHJcbmltcG9ydCBNb21lbnRhRGlhZ3JhbUFjY29yZGlvbkJveCBmcm9tICcuL01vbWVudGFEaWFncmFtQWNjb3JkaW9uQm94LmpzJztcclxuaW1wb3J0IE1vcmVEYXRhQ2hlY2tib3ggZnJvbSAnLi9Nb3JlRGF0YUNoZWNrYm94LmpzJztcclxuaW1wb3J0IFBsYXlBcmVhTm9kZSBmcm9tICcuL1BsYXlBcmVhTm9kZS5qcyc7XHJcbmltcG9ydCBQbGF5QXJlYVNjYWxlQmFyTm9kZSBmcm9tICcuL1BsYXlBcmVhU2NhbGVCYXJOb2RlLmpzJztcclxuaW1wb3J0IFBsYXlBcmVhVG9wUmlnaHRDb250cm9scyBmcm9tICcuL1BsYXlBcmVhVG9wUmlnaHRDb250cm9scy5qcyc7XHJcbmltcG9ydCBSZXN0YXJ0QnV0dG9uIGZyb20gJy4vUmVzdGFydEJ1dHRvbi5qcyc7XHJcbmltcG9ydCBSZXR1cm5CYWxsc0J1dHRvbiBmcm9tICcuL1JldHVybkJhbGxzQnV0dG9uLmpzJztcclxuaW1wb3J0IHsgTWFudWFsQ29uc3RyYWludCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgTU9ERUxfVE9fVklFV19TQ0FMRSA9IDE1MjsgLy8gTWV0ZXIgdG8gdmlldyBjb29yZGluYXRlcyBzY2FsZSBmYWN0b3IuXHJcbmNvbnN0IFBMQVlfQVJFQV9MRUZUID0gNTU7XHJcbmNvbnN0IEJBTExfVkFMVUVTX1BBTkVMX1RPUCA9IDQxMDtcclxuXHJcbi8vIEBhYnN0cmFjdFxyXG5jbGFzcyBDb2xsaXNpb25MYWJTY3JlZW5WaWV3IGV4dGVuZHMgU2NyZWVuVmlldyB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7Q29sbGlzaW9uTGFiTW9kZWx9IG1vZGVsXHJcbiAgICogQHBhcmFtIHtUYW5kZW19IHRhbmRlbVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbW9kZWwsIHRhbmRlbSwgb3B0aW9ucyApIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG1vZGVsIGluc3RhbmNlb2YgQ29sbGlzaW9uTGFiTW9kZWwsIGBpbnZhbGlkIG1vZGVsOiAke21vZGVsfWAgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRhbmRlbSBpbnN0YW5jZW9mIFRhbmRlbSwgYGludmFsaWQgdGFuZGVtOiAke3RhbmRlbX1gICk7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcblxyXG4gICAgICAvLyB7bnVtYmVyfSAtIHRoZSB0b3Agb2YgdGhlIFBsYXlBcmVhLCBpbiB2aWV3IGNvb3JkaW5hdGVzLlxyXG4gICAgICBwbGF5QXJlYVRvcDogQ29sbGlzaW9uTGFiQ29uc3RhbnRzLlNDUkVFTl9WSUVXX1lfTUFSR0lOLFxyXG5cclxuICAgICAgLy8ge2Jvb2xlYW59IC0gaW5kaWNhdGVzIGlmIHRoZSBQbGF5QXJlYVRvcFJpZ2h0Q29udHJvbHMgaXMgaW5jbHVkZWQuXHJcbiAgICAgIGluY2x1ZGVQbGF5QXJlYVRvcFJpZ2h0Q29udHJvbHM6IHRydWUsXHJcblxyXG4gICAgICAvLyB7Ym9vbGVhbn1cclxuICAgICAgaW5jbHVkZVN0ZXBCYWNrOiB0cnVlLFxyXG5cclxuICAgICAgLy8ge09iamVjdH0gLSBvcHRpb25zIHRvIHBhc3NlZCB0byB0aGUgUGxheUFyZWFUb3BSaWdodENvbnRyb2xzLCBpZiBpdCBpcyBpbmNsdWRlZC5cclxuICAgICAgcGxheUFyZWFUb3BSaWdodENvbnRyb2xzT3B0aW9uczogbnVsbFxyXG5cclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgTW9kZWxWaWV3VHJhbnNmb3JtIGZvciB0aGUgdmlldyBoaWVyYXJjaHksIHdoaWNoIG1hcHMgdGhlIGNvb3JkaW5hdGVzIG9mIHRoZSBQbGF5QXJlYSAobWV0ZXJzKSB0byB2aWV3XHJcbiAgICAvLyBjb29yZGluYXRlcy4gVXNlcyBhbiBpbnZlcnRlZCBtYXBwaW5nIHNvIHRoYXQgK3kgaXMgZG93bndhcmRzIGluIHRoZSB2aWV3IGNvb3JkaW5hdGUgZnJhbWUuXHJcbiAgICBjb25zdCBtb2RlbFZpZXdUcmFuc2Zvcm0gPSBNb2RlbFZpZXdUcmFuc2Zvcm0yLmNyZWF0ZVNpbmdsZVBvaW50U2NhbGVJbnZlcnRlZFlNYXBwaW5nKFxyXG4gICAgICBuZXcgVmVjdG9yMiggbW9kZWwucGxheUFyZWEubGVmdCwgbW9kZWwucGxheUFyZWEudG9wICksXHJcbiAgICAgIG5ldyBWZWN0b3IyKCBQTEFZX0FSRUFfTEVGVCwgb3B0aW9ucy5wbGF5QXJlYVRvcCApLFxyXG4gICAgICBNT0RFTF9UT19WSUVXX1NDQUxFXHJcbiAgICApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgdmlldy1zcGVjaWZpYyBwcm9wZXJ0aWVzIGZvciB0aGUgc2NyZWVuLlxyXG4gICAgY29uc3Qgdmlld1Byb3BlcnRpZXMgPSBuZXcgQ29sbGlzaW9uTGFiVmlld1Byb3BlcnRpZXMoKTtcclxuXHJcbiAgICAvLyBDb252ZW5pZW5jZSByZWZlcmVuY2UgdG8gdGhlIHZpZXctYm91bmRzIG9mIHRoZSBQbGF5QXJlYS4gVXNlZCBmb3IgbGF5b3V0LlxyXG4gICAgY29uc3QgcGxheUFyZWFWaWV3Qm91bmRzID0gbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3Qm91bmRzKCBtb2RlbC5wbGF5QXJlYS5ib3VuZHMgKTtcclxuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAvLyBQbGF5QXJlYVxyXG4gICAgY29uc3QgcGxheUFyZWFOb2RlID0gbmV3IFBsYXlBcmVhTm9kZSggbW9kZWwucGxheUFyZWEsIG1vZGVsLnBsYXlBcmVhLmdyaWRWaXNpYmxlUHJvcGVydHksIG1vZGVsVmlld1RyYW5zZm9ybSApO1xyXG5cclxuICAgIC8vIEBwcml2YXRlIHtCYWxsU3lzdGVtfVxyXG4gICAgdGhpcy5iYWxsU3lzdGVtTm9kZSA9IHRoaXMuY3JlYXRlQmFsbFN5c3RlbU5vZGUoIG1vZGVsLCB2aWV3UHJvcGVydGllcywgbW9kZWxWaWV3VHJhbnNmb3JtICk7XHJcblxyXG4gICAgLy8gU2NhbGUgQmFyXHJcbiAgICBjb25zdCBzY2FsZUJhciA9IG5ldyBQbGF5QXJlYVNjYWxlQmFyTm9kZSggMC41LCBtb2RlbFZpZXdUcmFuc2Zvcm0sIHtcclxuICAgICAgc2NhbGVCYXJPcmllbnRhdGlvbjogbW9kZWwucGxheUFyZWEuZGltZW5zaW9uID09PSBQbGF5QXJlYS5EaW1lbnNpb24uT05FID8gT3JpZW50YXRpb24uSE9SSVpPTlRBTCA6IE9yaWVudGF0aW9uLlZFUlRJQ0FMXHJcbiAgICB9ICk7XHJcbiAgICBNYW51YWxDb25zdHJhaW50LmNyZWF0ZSggdGhpcywgWyBzY2FsZUJhciBdLCBzY2FsZUJhclByb3h5ID0+IHtcclxuICAgICAgaWYgKCBtb2RlbC5wbGF5QXJlYS5kaW1lbnNpb24gPT09IFBsYXlBcmVhLkRpbWVuc2lvbi5PTkUgKSB7XHJcbiAgICAgICAgc2NhbGVCYXJQcm94eS5sZWZ0Qm90dG9tID0gcGxheUFyZWFWaWV3Qm91bmRzLmxlZnRUb3AubWludXNYWSggMCwgNSApO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHNjYWxlQmFyUHJveHkucmlnaHRUb3AgPSBwbGF5QXJlYVZpZXdCb3VuZHMubGVmdFRvcC5taW51c1hZKCA1LCAwICk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBLaW5ldGljIEVuZXJneSBOdW1iZXJEaXNwbGF5XHJcbiAgICBjb25zdCBraW5ldGljRW5lcmd5TnVtYmVyRGlzcGxheSA9IG5ldyBLaW5ldGljRW5lcmd5TnVtYmVyRGlzcGxheShcclxuICAgICAgbW9kZWwuYmFsbFN5c3RlbS50b3RhbEtpbmV0aWNFbmVyZ3lQcm9wZXJ0eSwge1xyXG4gICAgICAgIHZpc2libGVQcm9wZXJ0eTogdmlld1Byb3BlcnRpZXMua2luZXRpY0VuZXJneVZpc2libGVQcm9wZXJ0eSxcclxuICAgICAgICBsZWZ0OiBwbGF5QXJlYVZpZXdCb3VuZHMubGVmdCArIDUsXHJcbiAgICAgICAgYm90dG9tOiBwbGF5QXJlYVZpZXdCb3VuZHMuYm90dG9tIC0gM1xyXG4gICAgICB9ICk7XHJcblxyXG4gICAgLy8gUmV0dXJuIEJhbGxzIEJ1dHRvblxyXG4gICAgY29uc3QgcmV0dXJuQmFsbHNCdXR0b24gPSBuZXcgUmV0dXJuQmFsbHNCdXR0b24oIG1vZGVsLmJhbGxTeXN0ZW0uYmFsbHNOb3RJbnNpZGVQbGF5QXJlYVByb3BlcnR5LCB7XHJcbiAgICAgIGNlbnRlcjogcGxheUFyZWFWaWV3Qm91bmRzLmNlbnRlcixcclxuICAgICAgbGlzdGVuZXI6IG1vZGVsLnJldHVybkJhbGxzLmJpbmQoIG1vZGVsIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAvLyBFbGFwc2VkIFRpbWUgTnVtYmVyRGlzcGxheVxyXG4gICAgY29uc3QgZWxhcHNlZFRpbWVOdW1iZXJEaXNwbGF5ID0gbmV3IEVsYXBzZWRUaW1lTnVtYmVyRGlzcGxheSggbW9kZWwuZWxhcHNlZFRpbWVQcm9wZXJ0eSwge1xyXG4gICAgICBsZWZ0OiBwbGF5QXJlYVZpZXdCb3VuZHMubGVmdCxcclxuICAgICAgdG9wOiBwbGF5QXJlYVZpZXdCb3VuZHMuYm90dG9tICsgMTBcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBUaW1lIGNvbnRyb2xzIChwbGF5L3BhdXNlLCBzdGVwIGJ1dHRvbnMpXHJcbiAgICBjb25zdCB0aW1lQ29udHJvbE5vZGUgPSBuZXcgQ29sbGlzaW9uTGFiVGltZUNvbnRyb2xOb2RlKFxyXG4gICAgICBtb2RlbC5pc1BsYXlpbmdQcm9wZXJ0eSxcclxuICAgICAgbW9kZWwudGltZVNwZWVkUHJvcGVydHksXHJcbiAgICAgIG1vZGVsLmVsYXBzZWRUaW1lUHJvcGVydHksXHJcbiAgICAgIG1vZGVsLmJhbGxTeXN0ZW0uYmFsbFN5c3RlbVVzZXJDb250cm9sbGVkUHJvcGVydHksXHJcbiAgICAgIG1vZGVsLnBsYXlBcmVhLmVsYXN0aWNpdHlQZXJjZW50UHJvcGVydHksIHtcclxuICAgICAgICBwbGF5UGF1c2VTdGVwQnV0dG9uT3B0aW9uczoge1xyXG4gICAgICAgICAgc3RlcEJhY2t3YXJkQnV0dG9uT3B0aW9uczogeyBsaXN0ZW5lcjogbW9kZWwuc3RlcEJhY2t3YXJkcy5iaW5kKCBtb2RlbCApIH0sXHJcbiAgICAgICAgICBzdGVwRm9yd2FyZEJ1dHRvbk9wdGlvbnM6IHsgbGlzdGVuZXI6IG1vZGVsLnN0ZXBGb3J3YXJkcy5iaW5kKCBtb2RlbCApIH0sXHJcbiAgICAgICAgICBpbmNsdWRlU3RlcEJhY2t3YXJkQnV0dG9uOiBvcHRpb25zLmluY2x1ZGVTdGVwQmFja1xyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG4gICAgdGltZUNvbnRyb2xOb2RlLnNldFBsYXlQYXVzZUJ1dHRvbkNlbnRlciggcGxheUFyZWFWaWV3Qm91bmRzLmNlbnRlckJvdHRvbS5wbHVzWFkoIDAsIHRpbWVDb250cm9sTm9kZS5oZWlnaHQgLyAyICsgMTAgKSApO1xyXG5cclxuICAgIC8vIFJlc3RhcnQgQnV0dG9uXHJcbiAgICBjb25zdCByZXN0YXJ0QnV0dG9uID0gbmV3IFJlc3RhcnRCdXR0b24oIHtcclxuICAgICAgbGlzdGVuZXI6ICgpID0+IHtcclxuICAgICAgICB0aGlzLmludGVycnVwdFN1YnRyZWVJbnB1dCgpO1xyXG4gICAgICAgIG1vZGVsLnJlc3RhcnQoKTtcclxuICAgICAgfSxcclxuICAgICAgcmlnaHQ6IHBsYXlBcmVhVmlld0JvdW5kcy5yaWdodCxcclxuICAgICAgdG9wOiBlbGFwc2VkVGltZU51bWJlckRpc3BsYXkudG9wXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgLy8gS2V5cGFkRGlhbG9nXHJcbiAgICBjb25zdCBrZXlwYWREaWFsb2cgPSBuZXcgS2V5cGFkRGlhbG9nKCB7XHJcbiAgICAgIGxheW91dFN0cmF0ZWd5OiAoIGtleXBhZERpYWxvZywgc2ltQm91bmRzLCBzY3JlZW5Cb3VuZHMsIHNjYWxlICkgPT4ge1xyXG4gICAgICAgIGtleXBhZERpYWxvZy5sZWZ0Qm90dG9tID0gdGhpcy5iYWxsVmFsdWVzUGFuZWwucmlnaHRCb3R0b20ucGx1c1hZKCAxMCwgMCApO1xyXG4gICAgICB9LFxyXG4gICAgICBrZXlwYWRPcHRpb25zOiB7XHJcbiAgICAgICAgYWNjdW11bGF0b3JPcHRpb25zOiB7XHJcblxyXG4gICAgICAgICAgLy8ge251bWJlcn0gLSBtYXhpbXVtIG51bWJlciBvZiBkaWdpdHMgdGhhdCBjYW4gYmUgZW50ZXJlZCBvbiB0aGUga2V5cGFkLlxyXG4gICAgICAgICAgbWF4RGlnaXRzOiA4LFxyXG5cclxuICAgICAgICAgIC8vIHtudW1iZXJ9IC0gbWF4aW11bSBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMgdGhhdCBjYW4gYmUgZW50ZXJlZCBvbiB0aGUga2V5cGFkLlxyXG4gICAgICAgICAgbWF4RGlnaXRzUmlnaHRPZk1hbnRpc3NhOiBDb2xsaXNpb25MYWJDb25zdGFudHMuRElTUExBWV9ERUNJTUFMX1BMQUNFU1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgZW50ZXJCdXR0b25PcHRpb25zOiB7XHJcbiAgICAgICAgYmFzZUNvbG9yOiBDb2xsaXNpb25MYWJDb2xvcnMuS0VZUEFEX0VOVEVSX0JVVFRPTlxyXG4gICAgICB9LFxyXG4gICAgICBmaWxsOiBDb2xsaXNpb25MYWJDb2xvcnMuUEFORUxfRklMTCxcclxuICAgICAgc3Ryb2tlOiBDb2xsaXNpb25MYWJDb2xvcnMuUEFORUxfU1RST0tFXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHByb3RlY3RlZCAtIEJhbGxWYWx1ZXNQYW5lbCwgZXhwb3NlZCB0byBzdWItY2xhc3NlcyBmb3IgbGF5b3V0LlxyXG4gICAgdGhpcy5iYWxsVmFsdWVzUGFuZWwgPSBuZXcgQmFsbFZhbHVlc1BhbmVsKFxyXG4gICAgICBtb2RlbC5iYWxsU3lzdGVtLFxyXG4gICAgICB2aWV3UHJvcGVydGllcy5tb3JlRGF0YVZpc2libGVQcm9wZXJ0eSxcclxuICAgICAgbW9kZWwucGxheUFyZWEuZGltZW5zaW9uLFxyXG4gICAgICBrZXlwYWREaWFsb2csIHtcclxuICAgICAgICB0b3A6IEJBTExfVkFMVUVTX1BBTkVMX1RPUCxcclxuICAgICAgICBsZWZ0OiBwbGF5QXJlYVZpZXdCb3VuZHMubGVmdFxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgLy8gTW9yZSBEYXRhIENoZWNrYm94XHJcbiAgICBjb25zdCBtb3JlRGF0YUNoZWNrYm94ID0gbmV3IE1vcmVEYXRhQ2hlY2tib3goIHZpZXdQcm9wZXJ0aWVzLm1vcmVEYXRhVmlzaWJsZVByb3BlcnR5LCB7XHJcbiAgICAgIGJvdHRvbTogdGhpcy5iYWxsVmFsdWVzUGFuZWwudG9wIC0gNCxcclxuICAgICAgbGVmdDogcGxheUFyZWFWaWV3Qm91bmRzLmxlZnRcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBDb250cm9sUGFuZWxcclxuICAgIGNvbnN0IGNvbnRyb2xQYW5lbCA9IHRoaXMuY3JlYXRlQ29udHJvbFBhbmVsKCB2aWV3UHJvcGVydGllcywgbW9kZWwsIHtcclxuICAgICAgcmlnaHQ6IHRoaXMubGF5b3V0Qm91bmRzLm1heFggLSBDb2xsaXNpb25MYWJDb25zdGFudHMuU0NSRUVOX1ZJRVdfWF9NQVJHSU4sXHJcbiAgICAgIHRvcDogQ29sbGlzaW9uTGFiQ29uc3RhbnRzLlNDUkVFTl9WSUVXX1lfTUFSR0lOXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gTW9tZW50YSBEaWFncmFtXHJcbiAgICBjb25zdCBtb21lbnRhRGlhZ3JhbSA9IG5ldyBNb21lbnRhRGlhZ3JhbUFjY29yZGlvbkJveCggbW9kZWwubW9tZW50YURpYWdyYW0sIG1vZGVsLmJhbGxTeXN0ZW0uYmFsbHMsIHtcclxuICAgICAgZGltZW5zaW9uOiBtb2RlbC5wbGF5QXJlYS5kaW1lbnNpb24sXHJcbiAgICAgIGNlbnRlclg6IGNvbnRyb2xQYW5lbC5jZW50ZXJYLFxyXG4gICAgICB0b3A6IGNvbnRyb2xQYW5lbC5ib3R0b20gKyA4XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gUmVzZXQgQWxsIEJ1dHRvblxyXG4gICAgY29uc3QgcmVzZXRBbGxCdXR0b24gPSBuZXcgUmVzZXRBbGxCdXR0b24oIHtcclxuICAgICAgbGlzdGVuZXI6ICgpID0+IHtcclxuICAgICAgICB0aGlzLmludGVycnVwdFN1YnRyZWVJbnB1dCgpO1xyXG4gICAgICAgIG1vZGVsLnJlc2V0KCk7XHJcbiAgICAgICAgdmlld1Byb3BlcnRpZXMucmVzZXQoKTtcclxuICAgICAgICB0aGlzLmJhbGxTeXN0ZW1Ob2RlLnJlc2V0KCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHJpZ2h0OiB0aGlzLmxheW91dEJvdW5kcy5tYXhYIC0gQ29sbGlzaW9uTGFiQ29uc3RhbnRzLlNDUkVFTl9WSUVXX1hfTUFSR0lOLFxyXG4gICAgICBib3R0b206IHRoaXMubGF5b3V0Qm91bmRzLm1heFkgLSBDb2xsaXNpb25MYWJDb25zdGFudHMuU0NSRUVOX1ZJRVdfWV9NQVJHSU5cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAvLyBTZXQgdGhlIGNoaWxkcmVuIGluIHRoZSBjb3JyZWN0IHJlbmRlcmluZyBvcmRlci5cclxuICAgIHRoaXMuY2hpbGRyZW4gPSBbXHJcbiAgICAgIHRoaXMuYmFsbFZhbHVlc1BhbmVsLFxyXG4gICAgICBtb3JlRGF0YUNoZWNrYm94LFxyXG4gICAgICBwbGF5QXJlYU5vZGUsXHJcbiAgICAgIHNjYWxlQmFyLFxyXG4gICAgICBlbGFwc2VkVGltZU51bWJlckRpc3BsYXksXHJcbiAgICAgIHRpbWVDb250cm9sTm9kZSxcclxuICAgICAgcmVzdGFydEJ1dHRvbixcclxuICAgICAgcmVzZXRBbGxCdXR0b24sXHJcbiAgICAgIGNvbnRyb2xQYW5lbCxcclxuICAgICAgbW9tZW50YURpYWdyYW0sXHJcbiAgICAgIGtpbmV0aWNFbmVyZ3lOdW1iZXJEaXNwbGF5LFxyXG4gICAgICB0aGlzLmJhbGxTeXN0ZW1Ob2RlLFxyXG4gICAgICByZXR1cm5CYWxsc0J1dHRvblxyXG4gICAgXTtcclxuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAvLyBBZGQgdGhlIFBsYXlBcmVhVG9wUmlnaHRDb250cm9scyBpZiBpdCBpcyBpbmNsdWRlZC5cclxuICAgIGlmICggb3B0aW9ucy5pbmNsdWRlUGxheUFyZWFUb3BSaWdodENvbnRyb2xzICkge1xyXG4gICAgICBjb25zdCBwbGF5QXJlYUNvbnRyb2xTZXQgPSBuZXcgUGxheUFyZWFUb3BSaWdodENvbnRyb2xzKFxyXG4gICAgICAgIG1vZGVsLmJhbGxTeXN0ZW0ubnVtYmVyT2ZCYWxsc1Byb3BlcnR5LFxyXG4gICAgICAgIG1vZGVsLmJhbGxTeXN0ZW0ubnVtYmVyT2ZCYWxsc1JhbmdlLFxyXG4gICAgICAgIG1vZGVsLnBsYXlBcmVhLmdyaWRWaXNpYmxlUHJvcGVydHksIG1lcmdlKCB7XHJcbiAgICAgICAgICBsZWZ0OiBwbGF5QXJlYVZpZXdCb3VuZHMucmlnaHQgKyA4LFxyXG4gICAgICAgICAgdG9wOiBwbGF5QXJlYVZpZXdCb3VuZHMudG9wICsgMlxyXG4gICAgICAgIH0sIG9wdGlvbnMucGxheUFyZWFUb3BSaWdodENvbnRyb2xzT3B0aW9ucyApICk7XHJcblxyXG4gICAgICB0aGlzLmFkZENoaWxkKCBwbGF5QXJlYUNvbnRyb2xTZXQgKTtcclxuICAgICAgcGxheUFyZWFDb250cm9sU2V0Lm1vdmVUb0JhY2soKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBhYnN0cmFjdFxyXG4gICAqIENyZWF0ZXMgdGhlIENvbnRyb2xQYW5lbCBmb3IgdGhlIHNjcmVlbi4gQ2FsbGVkIGluIHRoZSBjb25zdHJ1Y3RvciBvZiB0aGUgQ29sbGlzaW9uTGFiU2NyZWVuVmlldy4gVGhpcyBpcyBhblxyXG4gICAqIGFic3RyYWN0IG1ldGhvZCBiZWNhdXNlIHNvbWUgc2NyZWVucyB1c2Ugc3ViLXR5cGVzIG9mIENvbGxpc2lvbkxhYkNvbnRyb2xQYW5lbCBhbmQgaGF2ZSBkaWZmZXJlbnQgQVBJcywgYnV0IGFsbFxyXG4gICAqIHNjcmVlbnMgaGF2ZSBhIENvbGxpc2lvbkxhYkNvbnRyb2xQYW5lbC5cclxuICAgKlxyXG4gICAqIEBwcm90ZWN0ZWRcclxuICAgKiBAcGFyYW0ge0NvbGxpc2lvbkxhYlZpZXdQcm9wZXJ0aWVzfSB2aWV3UHJvcGVydGllc1xyXG4gICAqIEBwYXJhbSB7Q29sbGlzaW9uTGFiTW9kZWx9IG1vZGVsXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqIEByZXR1cm5zIHtDb2xsaXNpb25MYWJDb250cm9sUGFuZWx9XHJcbiAgICovXHJcbiAgY3JlYXRlQ29udHJvbFBhbmVsKCB2aWV3UHJvcGVydGllcywgbW9kZWwsIG9wdGlvbnMgKSB7IGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnYWJzdHJhY3QgbWV0aG9kIG11c3QgYmUgb3ZlcnJpZGRlbicgKTsgfVxyXG5cclxuICAvKipcclxuICAgKiBAYWJzdHJhY3RcclxuICAgKiBDcmVhdGVzIHRoZSBDb250cm9sUGFuZWwgZm9yIHRoZSBzY3JlZW4uIENhbGxlZCBpbiB0aGUgY29uc3RydWN0b3Igb2YgdGhlIENvbGxpc2lvbkxhYlNjcmVlblZpZXcuIFRoaXMgaXMgYW5cclxuICAgKiBhYnN0cmFjdCBtZXRob2QgYmVjYXVzZSBzb21lIHNjcmVlbnMgdXNlIHN1Yi10eXBlcyBvZiBCYWxsU3lzdGVtTm9kZSwgYnV0IGFsbCBzY3JlZW5zIGhhdmUgYSBCYWxsU3lzdGVtTm9kZS5cclxuICAgKlxyXG4gICAqIEBwcm90ZWN0ZWRcclxuICAgKiBAcGFyYW0ge0NvbGxpc2lvbkxhYk1vZGVsfSBtb2RlbFxyXG4gICAqIEBwYXJhbSB7Q29sbGlzaW9uTGFiVmlld1Byb3BlcnRpZXN9IHZpZXdQcm9wZXJ0aWVzXHJcbiAgICogQHBhcmFtIHtNb2RlbFZpZXdUcmFuc2Zvcm0yfSBtb2RlbFZpZXdUcmFuc2Zvcm1cclxuICAgKiBAcmV0dXJucyB7QmFsbFN5c3RlbU5vZGV9XHJcbiAgICovXHJcbiAgY3JlYXRlQmFsbFN5c3RlbU5vZGUoIG1vZGVsLCB2aWV3UHJvcGVydGllcywgbW9kZWxWaWV3VHJhbnNmb3JtICkgeyBhc3NlcnQgJiYgYXNzZXJ0KCBmYWxzZSwgJ2Fic3RyYWN0IG1ldGhvZCBtdXN0IGJlIG92ZXJyaWRkZW4nICk7IH1cclxufVxyXG5cclxuY29sbGlzaW9uTGFiLnJlZ2lzdGVyKCAnQ29sbGlzaW9uTGFiU2NyZWVuVmlldycsIENvbGxpc2lvbkxhYlNjcmVlblZpZXcgKTtcclxuZXhwb3J0IGRlZmF1bHQgQ29sbGlzaW9uTGFiU2NyZWVuVmlldzsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxPQUFPLE1BQU0sK0JBQStCO0FBQ25ELE9BQU9DLFVBQVUsTUFBTSxvQ0FBb0M7QUFDM0QsT0FBT0MsS0FBSyxNQUFNLG1DQUFtQztBQUNyRCxPQUFPQyxXQUFXLE1BQU0seUNBQXlDO0FBQ2pFLE9BQU9DLG1CQUFtQixN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