// Copyright 2022-2023, University of Colorado Boulder

/**
 * ScreenView for the 'Nuclide Chart Intro' screen.
 *
 * @author Luisa Vargas
 */

import buildANucleus from '../../buildANucleus.js';
import optionize from '../../../../phet-core/js/optionize.js';
import BANScreenView from '../../common/view/BANScreenView.js';
import Multilink from '../../../../axon/js/Multilink.js';
import PeriodicTableAndIsotopeSymbol from './PeriodicTableAndIsotopeSymbol.js';
import BuildANucleusStrings from '../../BuildANucleusStrings.js';
import { Color, Line, Node, Rectangle, RichText, Text } from '../../../../scenery/js/imports.js';
import BANConstants from '../../common/BANConstants.js';
import ArrowNode from '../../../../scenery-phet/js/ArrowNode.js';
import BANColors from '../../common/BANColors.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import NucleonShellView from './NucleonShellView.js';
import ParticleType from '../../common/view/ParticleType.js';
import AtomNode from '../../../../shred/js/view/AtomNode.js';
import ModelViewTransform2 from '../../../../phetcommon/js/view/ModelViewTransform2.js';
import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import StringProperty from '../../../../axon/js/StringProperty.js';
import ParticleView from '../../../../shred/js/view/ParticleView.js';
import NuclideChartAccordionBox from './NuclideChartAccordionBox.js';
import RectangularRadioButtonGroup from '../../../../sun/js/buttons/RectangularRadioButtonGroup.js';

// types

class ChartIntroScreenView extends BANScreenView {
  constructor(model, providedOptions) {
    const options = optionize()({
      // centers particle atoms on energy levels
      particleViewPositionVector: new Vector2(135, 245 - BANConstants.PARTICLE_RADIUS) // top left corner of proton energy levels
    }, providedOptions);
    super(model, new Vector2(BANConstants.SCREEN_VIEW_ATOM_CENTER_X, 87), options);
    this.model = model;
    this.energyLevelLayer = new Node();
    const miniAtomMVT = ModelViewTransform2.createSinglePointScaleMapping(Vector2.ZERO, this.particleAtomNode.emptyAtomCircle.center, 1);
    const miniAtomNode = new AtomNode(model.miniParticleAtom, miniAtomMVT, {
      showCenterX: false,
      showElementNameProperty: new BooleanProperty(false),
      showNeutralOrIonProperty: new BooleanProperty(false),
      showStableOrUnstableProperty: new BooleanProperty(false),
      electronShellDepictionProperty: new StringProperty('cloud')
    });
    miniAtomNode.center = this.particleAtomNode.emptyAtomCircle.center;
    this.addChild(miniAtomNode);

    // update nucleons in mini-particle as the particleAtom's nucleon count properties change
    const nucleonCountListener = (nucleonCount, particleType) => {
      const currentMiniAtomNucleonCount = particleType === ParticleType.PROTON ? model.miniParticleAtom.protonCountProperty.value : model.miniParticleAtom.neutronCountProperty.value;

      // difference between particleAtom's nucleon count and miniAtom's nucleon count
      const nucleonDelta = currentMiniAtomNucleonCount - nucleonCount;

      // add nucleons to miniAtom
      if (nucleonDelta < 0) {
        _.times(nucleonDelta * -1, () => {
          const miniParticle = model.createMiniParticleModel(particleType);
          this.particleViewMap[miniParticle.id] = new ParticleView(miniParticle, miniAtomMVT);
          this.particleAtomNode.addParticleView(miniParticle);
        });
      }

      // remove nucleons from miniAtom
      else if (nucleonDelta > 0) {
        _.times(nucleonDelta, () => {
          const particle = model.miniParticleAtom.extractParticle(particleType.name.toLowerCase());
          const particleView = this.findParticleView(particle);
          delete this.particleViewMap[particleView.particle.id];
          particleView.dispose();
          particle.dispose();
          model.miniParticleAtom.reconfigureNucleus();
        });
      }
    };
    model.particleAtom.protonCountProperty.link(protonCount => nucleonCountListener(protonCount, ParticleType.PROTON));
    model.particleAtom.neutronCountProperty.link(neutronCount => nucleonCountListener(neutronCount, ParticleType.NEUTRON));
    const particleAtomNodeCenter = this.particleAtomNode.center;
    this.particleAtomNode.scale(0.75);
    this.particleAtomNode.center = particleAtomNodeCenter;

    // create and add the periodic table and symbol
    this.periodicTableAndIsotopeSymbol = new PeriodicTableAndIsotopeSymbol(model.particleAtom);
    this.periodicTableAndIsotopeSymbol.top = this.nucleonCountPanel.top;
    this.periodicTableAndIsotopeSymbol.right = this.resetAllButton.right;
    this.addChild(this.periodicTableAndIsotopeSymbol);
    this.elementName.centerX = this.doubleArrowButtons.centerX;
    this.elementName.top = this.nucleonCountPanel.top;
    this.nucleonCountPanel.left = this.layoutBounds.left + 20;

    // Hook up update listeners.
    Multilink.multilink([model.particleAtom.protonCountProperty, model.particleAtom.neutronCountProperty, model.doesNuclideExistBooleanProperty], (protonCount, neutronCount, doesNuclideExist) => BANScreenView.updateElementName(this.elementName, protonCount, neutronCount, doesNuclideExist, this.doubleArrowButtons.centerX));

    // create and add the 'Nuclear Shell Model' title
    const nuclearShellModelText = new RichText(BuildANucleusStrings.nuclearShellModel, {
      font: BANConstants.REGULAR_FONT
    });
    nuclearShellModelText.centerX = this.doubleArrowButtons.centerX;
    nuclearShellModelText.centerY = this.periodicTableAndIsotopeSymbol.bottom + 20;

    // create the 'highlight' text behind 'Nuclear Shell Model' text
    const nuclearShellModelTextHighlight = new Rectangle(nuclearShellModelText.bounds.dilateXY(15, 5), {
      fill: BANColors.shellModelTextHighlightColorProperty,
      cornerRadius: 10
    });
    nuclearShellModelTextHighlight.centerX = nuclearShellModelText.centerX;
    nuclearShellModelTextHighlight.centerY = nuclearShellModelText.centerY;

    // place highlight behind the text
    this.addChild(nuclearShellModelTextHighlight);
    this.addChild(nuclearShellModelText);

    // create and add the 'Energy' label
    const energyText = new RichText(BuildANucleusStrings.energy, {
      font: BANConstants.REGULAR_FONT
    });
    energyText.rotate(-Math.PI / 2);
    energyText.left = this.nucleonCountPanel.left;
    energyText.centerY = this.layoutBounds.centerY + 20;
    this.addChild(energyText);

    // create and add the 'Energy' arrow
    const energyTextDistanceFromArrow = 10;
    const arrow = new ArrowNode(energyText.right + energyTextDistanceFromArrow, this.protonArrowButtons.top - 30, energyText.right + energyTextDistanceFromArrow, this.periodicTableAndIsotopeSymbol.bottom + 15, {
      tailWidth: 2
    });
    this.addChild(arrow);

    // add energy level node
    this.protonEnergyLevelNode = new NucleonShellView(ParticleType.PROTON, model.particleAtom.protonShellPositions, model.particleAtom.protonCountProperty, options.particleViewPositionVector);
    this.addChild(this.protonEnergyLevelNode);
    this.neutronEnergyLevelNode = new NucleonShellView(ParticleType.NEUTRON, model.particleAtom.neutronShellPositions, model.particleAtom.neutronCountProperty, options.particleViewPositionVector, {
      xOffset: BANConstants.X_DISTANCE_BETWEEN_ENERGY_LEVELS
    });
    this.addChild(this.neutronEnergyLevelNode);

    // create and add dashed 'zoom' lines
    // TODO: position based on the small atom
    const dashedLineOptions = {
      stroke: Color.BLACK,
      lineDash: [6, 3]
    };
    const leftDashedLine = new Line(this.protonEnergyLevelNode.left, arrow.top, this.doubleArrowButtons.left, this.periodicTableAndIsotopeSymbol.centerY, dashedLineOptions);
    this.addChild(leftDashedLine);
    const rightDashedLine = new Line(this.neutronEnergyLevelNode.right, arrow.top, this.doubleArrowButtons.right, this.periodicTableAndIsotopeSymbol.centerY, dashedLineOptions);
    this.addChild(rightDashedLine);

    // TODO: use align group to match width's of accordion box and periodic table
    const nuclideChartAccordionBox = new NuclideChartAccordionBox(this.model.particleAtom.protonCountProperty, this.model.particleAtom.neutronCountProperty, this.periodicTableAndIsotopeSymbol.width, this.model.selectedNuclideChartProperty);
    nuclideChartAccordionBox.top = this.periodicTableAndIsotopeSymbol.bottom + 5;
    nuclideChartAccordionBox.left = this.periodicTableAndIsotopeSymbol.left;
    this.addChild(nuclideChartAccordionBox);
    const partialChartRadioButton = new RectangularRadioButtonGroup(this.model.selectedNuclideChartProperty, [{
      value: 'partial',
      createNode: () => new Text('partial')
    }, {
      value: 'zoom',
      createNode: () => new Text('zoom')
    }], {
      leftTop: nuclideChartAccordionBox.leftBottom,
      orientation: 'horizontal'
    });
    this.addChild(partialChartRadioButton);

    // add the particleViewLayerNode after everything else so particles are in the top layer
    this.addChild(this.particleAtomNode);
    this.addChild(this.energyLevelLayer);

    // only show the emptyAtomCircle when there are zero nucleons
    Multilink.multilink([this.model.particleAtom.protonCountProperty, this.model.particleAtom.neutronCountProperty], (protonCount, neutronCount) => {
      this.particleAtomNode.emptyAtomCircle.visible = protonCount + neutronCount === 0;
    });
  }

  /**
   * Returns whether the nucleon is within a rectangular capture radius defined by the left edge of the proton arrow
   * buttons, the right edge of the neutron arrow buttons, below the periodic table, and above the arrow buttons.
   */
  isNucleonInCaptureArea(nucleon, atom) {
    const nucleonViewPosition = nucleon.positionProperty.value.plus(new Vector2(135, 193 - BANConstants.PARTICLE_RADIUS) // top left corner of proton energy levels
    );

    return this.protonEnergyLevelNode.boundsProperty.value.dilated(BANConstants.PARTICLE_RADIUS * 2).containsPoint(nucleonViewPosition) || this.neutronEnergyLevelNode.boundsProperty.value.dilated(BANConstants.PARTICLE_RADIUS * 2).containsPoint(nucleonViewPosition);
  }
  addParticleView(particle) {
    this.energyLevelLayer.addChild(this.findParticleView(particle));
  }
}
buildANucleus.register('ChartIntroScreenView', ChartIntroScreenView);
export default ChartIntroScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJidWlsZEFOdWNsZXVzIiwib3B0aW9uaXplIiwiQkFOU2NyZWVuVmlldyIsIk11bHRpbGluayIsIlBlcmlvZGljVGFibGVBbmRJc290b3BlU3ltYm9sIiwiQnVpbGRBTnVjbGV1c1N0cmluZ3MiLCJDb2xvciIsIkxpbmUiLCJOb2RlIiwiUmVjdGFuZ2xlIiwiUmljaFRleHQiLCJUZXh0IiwiQkFOQ29uc3RhbnRzIiwiQXJyb3dOb2RlIiwiQkFOQ29sb3JzIiwiVmVjdG9yMiIsIk51Y2xlb25TaGVsbFZpZXciLCJQYXJ0aWNsZVR5cGUiLCJBdG9tTm9kZSIsIk1vZGVsVmlld1RyYW5zZm9ybTIiLCJCb29sZWFuUHJvcGVydHkiLCJTdHJpbmdQcm9wZXJ0eSIsIlBhcnRpY2xlVmlldyIsIk51Y2xpZGVDaGFydEFjY29yZGlvbkJveCIsIlJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cCIsIkNoYXJ0SW50cm9TY3JlZW5WaWV3IiwiY29uc3RydWN0b3IiLCJtb2RlbCIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJwYXJ0aWNsZVZpZXdQb3NpdGlvblZlY3RvciIsIlBBUlRJQ0xFX1JBRElVUyIsIlNDUkVFTl9WSUVXX0FUT01fQ0VOVEVSX1giLCJlbmVyZ3lMZXZlbExheWVyIiwibWluaUF0b21NVlQiLCJjcmVhdGVTaW5nbGVQb2ludFNjYWxlTWFwcGluZyIsIlpFUk8iLCJwYXJ0aWNsZUF0b21Ob2RlIiwiZW1wdHlBdG9tQ2lyY2xlIiwiY2VudGVyIiwibWluaUF0b21Ob2RlIiwibWluaVBhcnRpY2xlQXRvbSIsInNob3dDZW50ZXJYIiwic2hvd0VsZW1lbnROYW1lUHJvcGVydHkiLCJzaG93TmV1dHJhbE9ySW9uUHJvcGVydHkiLCJzaG93U3RhYmxlT3JVbnN0YWJsZVByb3BlcnR5IiwiZWxlY3Ryb25TaGVsbERlcGljdGlvblByb3BlcnR5IiwiYWRkQ2hpbGQiLCJudWNsZW9uQ291bnRMaXN0ZW5lciIsIm51Y2xlb25Db3VudCIsInBhcnRpY2xlVHlwZSIsImN1cnJlbnRNaW5pQXRvbU51Y2xlb25Db3VudCIsIlBST1RPTiIsInByb3RvbkNvdW50UHJvcGVydHkiLCJ2YWx1ZSIsIm5ldXRyb25Db3VudFByb3BlcnR5IiwibnVjbGVvbkRlbHRhIiwiXyIsInRpbWVzIiwibWluaVBhcnRpY2xlIiwiY3JlYXRlTWluaVBhcnRpY2xlTW9kZWwiLCJwYXJ0aWNsZVZpZXdNYXAiLCJpZCIsImFkZFBhcnRpY2xlVmlldyIsInBhcnRpY2xlIiwiZXh0cmFjdFBhcnRpY2xlIiwibmFtZSIsInRvTG93ZXJDYXNlIiwicGFydGljbGVWaWV3IiwiZmluZFBhcnRpY2xlVmlldyIsImRpc3Bvc2UiLCJyZWNvbmZpZ3VyZU51Y2xldXMiLCJwYXJ0aWNsZUF0b20iLCJsaW5rIiwicHJvdG9uQ291bnQiLCJuZXV0cm9uQ291bnQiLCJORVVUUk9OIiwicGFydGljbGVBdG9tTm9kZUNlbnRlciIsInNjYWxlIiwicGVyaW9kaWNUYWJsZUFuZElzb3RvcGVTeW1ib2wiLCJ0b3AiLCJudWNsZW9uQ291bnRQYW5lbCIsInJpZ2h0IiwicmVzZXRBbGxCdXR0b24iLCJlbGVtZW50TmFtZSIsImNlbnRlclgiLCJkb3VibGVBcnJvd0J1dHRvbnMiLCJsZWZ0IiwibGF5b3V0Qm91bmRzIiwibXVsdGlsaW5rIiwiZG9lc051Y2xpZGVFeGlzdEJvb2xlYW5Qcm9wZXJ0eSIsImRvZXNOdWNsaWRlRXhpc3QiLCJ1cGRhdGVFbGVtZW50TmFtZSIsIm51Y2xlYXJTaGVsbE1vZGVsVGV4dCIsIm51Y2xlYXJTaGVsbE1vZGVsIiwiZm9udCIsIlJFR1VMQVJfRk9OVCIsImNlbnRlclkiLCJib3R0b20iLCJudWNsZWFyU2hlbGxNb2RlbFRleHRIaWdobGlnaHQiLCJib3VuZHMiLCJkaWxhdGVYWSIsImZpbGwiLCJzaGVsbE1vZGVsVGV4dEhpZ2hsaWdodENvbG9yUHJvcGVydHkiLCJjb3JuZXJSYWRpdXMiLCJlbmVyZ3lUZXh0IiwiZW5lcmd5Iiwicm90YXRlIiwiTWF0aCIsIlBJIiwiZW5lcmd5VGV4dERpc3RhbmNlRnJvbUFycm93IiwiYXJyb3ciLCJwcm90b25BcnJvd0J1dHRvbnMiLCJ0YWlsV2lkdGgiLCJwcm90b25FbmVyZ3lMZXZlbE5vZGUiLCJwcm90b25TaGVsbFBvc2l0aW9ucyIsIm5ldXRyb25FbmVyZ3lMZXZlbE5vZGUiLCJuZXV0cm9uU2hlbGxQb3NpdGlvbnMiLCJ4T2Zmc2V0IiwiWF9ESVNUQU5DRV9CRVRXRUVOX0VORVJHWV9MRVZFTFMiLCJkYXNoZWRMaW5lT3B0aW9ucyIsInN0cm9rZSIsIkJMQUNLIiwibGluZURhc2giLCJsZWZ0RGFzaGVkTGluZSIsInJpZ2h0RGFzaGVkTGluZSIsIm51Y2xpZGVDaGFydEFjY29yZGlvbkJveCIsIndpZHRoIiwic2VsZWN0ZWROdWNsaWRlQ2hhcnRQcm9wZXJ0eSIsInBhcnRpYWxDaGFydFJhZGlvQnV0dG9uIiwiY3JlYXRlTm9kZSIsImxlZnRUb3AiLCJsZWZ0Qm90dG9tIiwib3JpZW50YXRpb24iLCJ2aXNpYmxlIiwiaXNOdWNsZW9uSW5DYXB0dXJlQXJlYSIsIm51Y2xlb24iLCJhdG9tIiwibnVjbGVvblZpZXdQb3NpdGlvbiIsInBvc2l0aW9uUHJvcGVydHkiLCJwbHVzIiwiYm91bmRzUHJvcGVydHkiLCJkaWxhdGVkIiwiY29udGFpbnNQb2ludCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQ2hhcnRJbnRyb1NjcmVlblZpZXcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjItMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogU2NyZWVuVmlldyBmb3IgdGhlICdOdWNsaWRlIENoYXJ0IEludHJvJyBzY3JlZW4uXHJcbiAqXHJcbiAqIEBhdXRob3IgTHVpc2EgVmFyZ2FzXHJcbiAqL1xyXG5cclxuaW1wb3J0IGJ1aWxkQU51Y2xldXMgZnJvbSAnLi4vLi4vYnVpbGRBTnVjbGV1cy5qcyc7XHJcbmltcG9ydCBDaGFydEludHJvTW9kZWwsIHsgU2VsZWN0ZWRDaGFydFR5cGUgfSBmcm9tICcuLi9tb2RlbC9DaGFydEludHJvTW9kZWwuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IEJBTlNjcmVlblZpZXcsIHsgQkFOU2NyZWVuVmlld09wdGlvbnMgfSBmcm9tICcuLi8uLi9jb21tb24vdmlldy9CQU5TY3JlZW5WaWV3LmpzJztcclxuaW1wb3J0IFBhcnRpY2xlIGZyb20gJy4uLy4uLy4uLy4uL3NocmVkL2pzL21vZGVsL1BhcnRpY2xlLmpzJztcclxuaW1wb3J0IFBhcnRpY2xlQXRvbSBmcm9tICcuLi8uLi8uLi8uLi9zaHJlZC9qcy9tb2RlbC9QYXJ0aWNsZUF0b20uanMnO1xyXG5pbXBvcnQgTXVsdGlsaW5rIGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTXVsdGlsaW5rLmpzJztcclxuaW1wb3J0IFBlcmlvZGljVGFibGVBbmRJc290b3BlU3ltYm9sIGZyb20gJy4vUGVyaW9kaWNUYWJsZUFuZElzb3RvcGVTeW1ib2wuanMnO1xyXG5pbXBvcnQgQnVpbGRBTnVjbGV1c1N0cmluZ3MgZnJvbSAnLi4vLi4vQnVpbGRBTnVjbGV1c1N0cmluZ3MuanMnO1xyXG5pbXBvcnQgeyBDb2xvciwgTGluZSwgTm9kZSwgUmVjdGFuZ2xlLCBSaWNoVGV4dCwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBCQU5Db25zdGFudHMgZnJvbSAnLi4vLi4vY29tbW9uL0JBTkNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBBcnJvd05vZGUgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL0Fycm93Tm9kZS5qcyc7XHJcbmltcG9ydCBCQU5Db2xvcnMgZnJvbSAnLi4vLi4vY29tbW9uL0JBTkNvbG9ycy5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IE51Y2xlb25TaGVsbFZpZXcgZnJvbSAnLi9OdWNsZW9uU2hlbGxWaWV3LmpzJztcclxuaW1wb3J0IFBhcnRpY2xlVHlwZSBmcm9tICcuLi8uLi9jb21tb24vdmlldy9QYXJ0aWNsZVR5cGUuanMnO1xyXG5pbXBvcnQgQXRvbU5vZGUgZnJvbSAnLi4vLi4vLi4vLi4vc2hyZWQvanMvdmlldy9BdG9tTm9kZS5qcyc7XHJcbmltcG9ydCBNb2RlbFZpZXdUcmFuc2Zvcm0yIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdmlldy9Nb2RlbFZpZXdUcmFuc2Zvcm0yLmpzJztcclxuaW1wb3J0IEJvb2xlYW5Qcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Jvb2xlYW5Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBTdHJpbmdQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1N0cmluZ1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFBhcnRpY2xlVmlldyBmcm9tICcuLi8uLi8uLi8uLi9zaHJlZC9qcy92aWV3L1BhcnRpY2xlVmlldy5qcyc7XHJcbmltcG9ydCBOdWNsaWRlQ2hhcnRBY2NvcmRpb25Cb3ggZnJvbSAnLi9OdWNsaWRlQ2hhcnRBY2NvcmRpb25Cb3guanMnO1xyXG5pbXBvcnQgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwIGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9idXR0b25zL1JlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cC5qcyc7XHJcblxyXG4vLyB0eXBlc1xyXG5leHBvcnQgdHlwZSBOdWNsaWRlQ2hhcnRJbnRyb1NjcmVlblZpZXdPcHRpb25zID0gQkFOU2NyZWVuVmlld09wdGlvbnM7XHJcblxyXG5jbGFzcyBDaGFydEludHJvU2NyZWVuVmlldyBleHRlbmRzIEJBTlNjcmVlblZpZXc8Q2hhcnRJbnRyb01vZGVsPiB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgcGVyaW9kaWNUYWJsZUFuZElzb3RvcGVTeW1ib2w6IFBlcmlvZGljVGFibGVBbmRJc290b3BlU3ltYm9sO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcHJvdG9uRW5lcmd5TGV2ZWxOb2RlOiBOdWNsZW9uU2hlbGxWaWV3O1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgbmV1dHJvbkVuZXJneUxldmVsTm9kZTogTnVjbGVvblNoZWxsVmlldztcclxuICBwcml2YXRlIHJlYWRvbmx5IGVuZXJneUxldmVsTGF5ZXI6IE5vZGU7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggbW9kZWw6IENoYXJ0SW50cm9Nb2RlbCwgcHJvdmlkZWRPcHRpb25zPzogTnVjbGlkZUNoYXJ0SW50cm9TY3JlZW5WaWV3T3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPE51Y2xpZGVDaGFydEludHJvU2NyZWVuVmlld09wdGlvbnMsIEVtcHR5U2VsZk9wdGlvbnMsIEJBTlNjcmVlblZpZXdPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBjZW50ZXJzIHBhcnRpY2xlIGF0b21zIG9uIGVuZXJneSBsZXZlbHNcclxuICAgICAgcGFydGljbGVWaWV3UG9zaXRpb25WZWN0b3I6IG5ldyBWZWN0b3IyKCAxMzUsIDI0NSAtIEJBTkNvbnN0YW50cy5QQVJUSUNMRV9SQURJVVMgKSAvLyB0b3AgbGVmdCBjb3JuZXIgb2YgcHJvdG9uIGVuZXJneSBsZXZlbHNcclxuXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggbW9kZWwsIG5ldyBWZWN0b3IyKCBCQU5Db25zdGFudHMuU0NSRUVOX1ZJRVdfQVRPTV9DRU5URVJfWCwgODcgKSwgb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcclxuICAgIHRoaXMuZW5lcmd5TGV2ZWxMYXllciA9IG5ldyBOb2RlKCk7XHJcblxyXG4gICAgY29uc3QgbWluaUF0b21NVlQgPSBNb2RlbFZpZXdUcmFuc2Zvcm0yLmNyZWF0ZVNpbmdsZVBvaW50U2NhbGVNYXBwaW5nKCBWZWN0b3IyLlpFUk8sIHRoaXMucGFydGljbGVBdG9tTm9kZS5lbXB0eUF0b21DaXJjbGUuY2VudGVyLCAxICk7XHJcbiAgICBjb25zdCBtaW5pQXRvbU5vZGUgPSBuZXcgQXRvbU5vZGUoIG1vZGVsLm1pbmlQYXJ0aWNsZUF0b20sIG1pbmlBdG9tTVZULCB7XHJcbiAgICAgIHNob3dDZW50ZXJYOiBmYWxzZSxcclxuICAgICAgc2hvd0VsZW1lbnROYW1lUHJvcGVydHk6IG5ldyBCb29sZWFuUHJvcGVydHkoIGZhbHNlICksXHJcbiAgICAgIHNob3dOZXV0cmFsT3JJb25Qcm9wZXJ0eTogbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UgKSxcclxuICAgICAgc2hvd1N0YWJsZU9yVW5zdGFibGVQcm9wZXJ0eTogbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UgKSxcclxuICAgICAgZWxlY3Ryb25TaGVsbERlcGljdGlvblByb3BlcnR5OiBuZXcgU3RyaW5nUHJvcGVydHkoICdjbG91ZCcgKVxyXG4gICAgfSApO1xyXG4gICAgbWluaUF0b21Ob2RlLmNlbnRlciA9IHRoaXMucGFydGljbGVBdG9tTm9kZS5lbXB0eUF0b21DaXJjbGUuY2VudGVyO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggbWluaUF0b21Ob2RlICk7XHJcblxyXG4gICAgLy8gdXBkYXRlIG51Y2xlb25zIGluIG1pbmktcGFydGljbGUgYXMgdGhlIHBhcnRpY2xlQXRvbSdzIG51Y2xlb24gY291bnQgcHJvcGVydGllcyBjaGFuZ2VcclxuICAgIGNvbnN0IG51Y2xlb25Db3VudExpc3RlbmVyID0gKCBudWNsZW9uQ291bnQ6IG51bWJlciwgcGFydGljbGVUeXBlOiBQYXJ0aWNsZVR5cGUgKSA9PiB7XHJcbiAgICAgIGNvbnN0IGN1cnJlbnRNaW5pQXRvbU51Y2xlb25Db3VudCA9IHBhcnRpY2xlVHlwZSA9PT0gUGFydGljbGVUeXBlLlBST1RPTiA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLm1pbmlQYXJ0aWNsZUF0b20ucHJvdG9uQ291bnRQcm9wZXJ0eS52YWx1ZSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLm1pbmlQYXJ0aWNsZUF0b20ubmV1dHJvbkNvdW50UHJvcGVydHkudmFsdWU7XHJcblxyXG4gICAgICAvLyBkaWZmZXJlbmNlIGJldHdlZW4gcGFydGljbGVBdG9tJ3MgbnVjbGVvbiBjb3VudCBhbmQgbWluaUF0b20ncyBudWNsZW9uIGNvdW50XHJcbiAgICAgIGNvbnN0IG51Y2xlb25EZWx0YSA9IGN1cnJlbnRNaW5pQXRvbU51Y2xlb25Db3VudCAtIG51Y2xlb25Db3VudDtcclxuXHJcbiAgICAgIC8vIGFkZCBudWNsZW9ucyB0byBtaW5pQXRvbVxyXG4gICAgICBpZiAoIG51Y2xlb25EZWx0YSA8IDAgKSB7XHJcbiAgICAgICAgXy50aW1lcyggbnVjbGVvbkRlbHRhICogLTEsICgpID0+IHtcclxuICAgICAgICAgIGNvbnN0IG1pbmlQYXJ0aWNsZSA9IG1vZGVsLmNyZWF0ZU1pbmlQYXJ0aWNsZU1vZGVsKCBwYXJ0aWNsZVR5cGUgKTtcclxuICAgICAgICAgIHRoaXMucGFydGljbGVWaWV3TWFwWyBtaW5pUGFydGljbGUuaWQgXSA9IG5ldyBQYXJ0aWNsZVZpZXcoIG1pbmlQYXJ0aWNsZSwgbWluaUF0b21NVlQgKTtcclxuICAgICAgICAgIHRoaXMucGFydGljbGVBdG9tTm9kZS5hZGRQYXJ0aWNsZVZpZXcoIG1pbmlQYXJ0aWNsZSApO1xyXG4gICAgICAgIH0gKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gcmVtb3ZlIG51Y2xlb25zIGZyb20gbWluaUF0b21cclxuICAgICAgZWxzZSBpZiAoIG51Y2xlb25EZWx0YSA+IDAgKSB7XHJcbiAgICAgICAgXy50aW1lcyggbnVjbGVvbkRlbHRhLCAoKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBwYXJ0aWNsZSA9IG1vZGVsLm1pbmlQYXJ0aWNsZUF0b20uZXh0cmFjdFBhcnRpY2xlKCBwYXJ0aWNsZVR5cGUubmFtZS50b0xvd2VyQ2FzZSgpICk7XHJcbiAgICAgICAgICBjb25zdCBwYXJ0aWNsZVZpZXcgPSB0aGlzLmZpbmRQYXJ0aWNsZVZpZXcoIHBhcnRpY2xlICk7XHJcbiAgICAgICAgICBkZWxldGUgdGhpcy5wYXJ0aWNsZVZpZXdNYXBbIHBhcnRpY2xlVmlldy5wYXJ0aWNsZS5pZCBdO1xyXG5cclxuICAgICAgICAgIHBhcnRpY2xlVmlldy5kaXNwb3NlKCk7XHJcbiAgICAgICAgICBwYXJ0aWNsZS5kaXNwb3NlKCk7XHJcbiAgICAgICAgICBtb2RlbC5taW5pUGFydGljbGVBdG9tLnJlY29uZmlndXJlTnVjbGV1cygpO1xyXG4gICAgICAgIH0gKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIG1vZGVsLnBhcnRpY2xlQXRvbS5wcm90b25Db3VudFByb3BlcnR5LmxpbmsoIHByb3RvbkNvdW50ID0+IG51Y2xlb25Db3VudExpc3RlbmVyKCBwcm90b25Db3VudCwgUGFydGljbGVUeXBlLlBST1RPTiApICk7XHJcbiAgICBtb2RlbC5wYXJ0aWNsZUF0b20ubmV1dHJvbkNvdW50UHJvcGVydHkubGluayggbmV1dHJvbkNvdW50ID0+IG51Y2xlb25Db3VudExpc3RlbmVyKCBuZXV0cm9uQ291bnQsIFBhcnRpY2xlVHlwZS5ORVVUUk9OICkgKTtcclxuICAgIGNvbnN0IHBhcnRpY2xlQXRvbU5vZGVDZW50ZXIgPSB0aGlzLnBhcnRpY2xlQXRvbU5vZGUuY2VudGVyO1xyXG4gICAgdGhpcy5wYXJ0aWNsZUF0b21Ob2RlLnNjYWxlKCAwLjc1ICk7XHJcbiAgICB0aGlzLnBhcnRpY2xlQXRvbU5vZGUuY2VudGVyID0gcGFydGljbGVBdG9tTm9kZUNlbnRlcjtcclxuXHJcbiAgICAvLyBjcmVhdGUgYW5kIGFkZCB0aGUgcGVyaW9kaWMgdGFibGUgYW5kIHN5bWJvbFxyXG4gICAgdGhpcy5wZXJpb2RpY1RhYmxlQW5kSXNvdG9wZVN5bWJvbCA9IG5ldyBQZXJpb2RpY1RhYmxlQW5kSXNvdG9wZVN5bWJvbCggbW9kZWwucGFydGljbGVBdG9tICk7XHJcbiAgICB0aGlzLnBlcmlvZGljVGFibGVBbmRJc290b3BlU3ltYm9sLnRvcCA9IHRoaXMubnVjbGVvbkNvdW50UGFuZWwudG9wO1xyXG4gICAgdGhpcy5wZXJpb2RpY1RhYmxlQW5kSXNvdG9wZVN5bWJvbC5yaWdodCA9IHRoaXMucmVzZXRBbGxCdXR0b24ucmlnaHQ7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLnBlcmlvZGljVGFibGVBbmRJc290b3BlU3ltYm9sICk7XHJcblxyXG4gICAgdGhpcy5lbGVtZW50TmFtZS5jZW50ZXJYID0gdGhpcy5kb3VibGVBcnJvd0J1dHRvbnMuY2VudGVyWDtcclxuICAgIHRoaXMuZWxlbWVudE5hbWUudG9wID0gdGhpcy5udWNsZW9uQ291bnRQYW5lbC50b3A7XHJcblxyXG4gICAgdGhpcy5udWNsZW9uQ291bnRQYW5lbC5sZWZ0ID0gdGhpcy5sYXlvdXRCb3VuZHMubGVmdCArIDIwO1xyXG5cclxuICAgIC8vIEhvb2sgdXAgdXBkYXRlIGxpc3RlbmVycy5cclxuICAgIE11bHRpbGluay5tdWx0aWxpbmsoIFsgbW9kZWwucGFydGljbGVBdG9tLnByb3RvbkNvdW50UHJvcGVydHksIG1vZGVsLnBhcnRpY2xlQXRvbS5uZXV0cm9uQ291bnRQcm9wZXJ0eSwgbW9kZWwuZG9lc051Y2xpZGVFeGlzdEJvb2xlYW5Qcm9wZXJ0eSBdLFxyXG4gICAgICAoIHByb3RvbkNvdW50OiBudW1iZXIsIG5ldXRyb25Db3VudDogbnVtYmVyLCBkb2VzTnVjbGlkZUV4aXN0OiBib29sZWFuICkgPT5cclxuICAgICAgICBCQU5TY3JlZW5WaWV3LnVwZGF0ZUVsZW1lbnROYW1lKCB0aGlzLmVsZW1lbnROYW1lLCBwcm90b25Db3VudCwgbmV1dHJvbkNvdW50LCBkb2VzTnVjbGlkZUV4aXN0LFxyXG4gICAgICAgICAgdGhpcy5kb3VibGVBcnJvd0J1dHRvbnMuY2VudGVyWCApXHJcbiAgICApO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBhbmQgYWRkIHRoZSAnTnVjbGVhciBTaGVsbCBNb2RlbCcgdGl0bGVcclxuICAgIGNvbnN0IG51Y2xlYXJTaGVsbE1vZGVsVGV4dCA9IG5ldyBSaWNoVGV4dCggQnVpbGRBTnVjbGV1c1N0cmluZ3MubnVjbGVhclNoZWxsTW9kZWwsIHsgZm9udDogQkFOQ29uc3RhbnRzLlJFR1VMQVJfRk9OVCB9ICk7XHJcbiAgICBudWNsZWFyU2hlbGxNb2RlbFRleHQuY2VudGVyWCA9IHRoaXMuZG91YmxlQXJyb3dCdXR0b25zLmNlbnRlclg7XHJcbiAgICBudWNsZWFyU2hlbGxNb2RlbFRleHQuY2VudGVyWSA9IHRoaXMucGVyaW9kaWNUYWJsZUFuZElzb3RvcGVTeW1ib2wuYm90dG9tICsgMjA7XHJcblxyXG4gICAgLy8gY3JlYXRlIHRoZSAnaGlnaGxpZ2h0JyB0ZXh0IGJlaGluZCAnTnVjbGVhciBTaGVsbCBNb2RlbCcgdGV4dFxyXG4gICAgY29uc3QgbnVjbGVhclNoZWxsTW9kZWxUZXh0SGlnaGxpZ2h0ID0gbmV3IFJlY3RhbmdsZSggbnVjbGVhclNoZWxsTW9kZWxUZXh0LmJvdW5kcy5kaWxhdGVYWSggMTUsIDUgKSwge1xyXG4gICAgICBmaWxsOiBCQU5Db2xvcnMuc2hlbGxNb2RlbFRleHRIaWdobGlnaHRDb2xvclByb3BlcnR5LFxyXG4gICAgICBjb3JuZXJSYWRpdXM6IDEwXHJcbiAgICB9ICk7XHJcbiAgICBudWNsZWFyU2hlbGxNb2RlbFRleHRIaWdobGlnaHQuY2VudGVyWCA9IG51Y2xlYXJTaGVsbE1vZGVsVGV4dC5jZW50ZXJYO1xyXG4gICAgbnVjbGVhclNoZWxsTW9kZWxUZXh0SGlnaGxpZ2h0LmNlbnRlclkgPSBudWNsZWFyU2hlbGxNb2RlbFRleHQuY2VudGVyWTtcclxuXHJcbiAgICAvLyBwbGFjZSBoaWdobGlnaHQgYmVoaW5kIHRoZSB0ZXh0XHJcbiAgICB0aGlzLmFkZENoaWxkKCBudWNsZWFyU2hlbGxNb2RlbFRleHRIaWdobGlnaHQgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIG51Y2xlYXJTaGVsbE1vZGVsVGV4dCApO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBhbmQgYWRkIHRoZSAnRW5lcmd5JyBsYWJlbFxyXG4gICAgY29uc3QgZW5lcmd5VGV4dCA9IG5ldyBSaWNoVGV4dCggQnVpbGRBTnVjbGV1c1N0cmluZ3MuZW5lcmd5LCB7IGZvbnQ6IEJBTkNvbnN0YW50cy5SRUdVTEFSX0ZPTlQgfSApO1xyXG4gICAgZW5lcmd5VGV4dC5yb3RhdGUoIC1NYXRoLlBJIC8gMiApO1xyXG4gICAgZW5lcmd5VGV4dC5sZWZ0ID0gdGhpcy5udWNsZW9uQ291bnRQYW5lbC5sZWZ0O1xyXG4gICAgZW5lcmd5VGV4dC5jZW50ZXJZID0gdGhpcy5sYXlvdXRCb3VuZHMuY2VudGVyWSArIDIwO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggZW5lcmd5VGV4dCApO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBhbmQgYWRkIHRoZSAnRW5lcmd5JyBhcnJvd1xyXG4gICAgY29uc3QgZW5lcmd5VGV4dERpc3RhbmNlRnJvbUFycm93ID0gMTA7XHJcbiAgICBjb25zdCBhcnJvdyA9IG5ldyBBcnJvd05vZGUoIGVuZXJneVRleHQucmlnaHQgKyBlbmVyZ3lUZXh0RGlzdGFuY2VGcm9tQXJyb3csIHRoaXMucHJvdG9uQXJyb3dCdXR0b25zLnRvcCAtIDMwLFxyXG4gICAgICBlbmVyZ3lUZXh0LnJpZ2h0ICsgZW5lcmd5VGV4dERpc3RhbmNlRnJvbUFycm93LCB0aGlzLnBlcmlvZGljVGFibGVBbmRJc290b3BlU3ltYm9sLmJvdHRvbSArIDE1LCB7IHRhaWxXaWR0aDogMiB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBhcnJvdyApO1xyXG5cclxuICAgIC8vIGFkZCBlbmVyZ3kgbGV2ZWwgbm9kZVxyXG4gICAgdGhpcy5wcm90b25FbmVyZ3lMZXZlbE5vZGUgPSBuZXcgTnVjbGVvblNoZWxsVmlldyggUGFydGljbGVUeXBlLlBST1RPTiwgbW9kZWwucGFydGljbGVBdG9tLnByb3RvblNoZWxsUG9zaXRpb25zLFxyXG4gICAgICBtb2RlbC5wYXJ0aWNsZUF0b20ucHJvdG9uQ291bnRQcm9wZXJ0eSwgb3B0aW9ucy5wYXJ0aWNsZVZpZXdQb3NpdGlvblZlY3RvciApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5wcm90b25FbmVyZ3lMZXZlbE5vZGUgKTtcclxuICAgIHRoaXMubmV1dHJvbkVuZXJneUxldmVsTm9kZSA9IG5ldyBOdWNsZW9uU2hlbGxWaWV3KCBQYXJ0aWNsZVR5cGUuTkVVVFJPTiwgbW9kZWwucGFydGljbGVBdG9tLm5ldXRyb25TaGVsbFBvc2l0aW9ucyxcclxuICAgICAgbW9kZWwucGFydGljbGVBdG9tLm5ldXRyb25Db3VudFByb3BlcnR5LCBvcHRpb25zLnBhcnRpY2xlVmlld1Bvc2l0aW9uVmVjdG9yLCB7XHJcbiAgICAgIHhPZmZzZXQ6IEJBTkNvbnN0YW50cy5YX0RJU1RBTkNFX0JFVFdFRU5fRU5FUkdZX0xFVkVMU1xyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5uZXV0cm9uRW5lcmd5TGV2ZWxOb2RlICk7XHJcblxyXG4gICAgLy8gY3JlYXRlIGFuZCBhZGQgZGFzaGVkICd6b29tJyBsaW5lc1xyXG4gICAgLy8gVE9ETzogcG9zaXRpb24gYmFzZWQgb24gdGhlIHNtYWxsIGF0b21cclxuICAgIGNvbnN0IGRhc2hlZExpbmVPcHRpb25zID0geyBzdHJva2U6IENvbG9yLkJMQUNLLCBsaW5lRGFzaDogWyA2LCAzIF0gfTtcclxuICAgIGNvbnN0IGxlZnREYXNoZWRMaW5lID0gbmV3IExpbmUoIHRoaXMucHJvdG9uRW5lcmd5TGV2ZWxOb2RlLmxlZnQsIGFycm93LnRvcCwgdGhpcy5kb3VibGVBcnJvd0J1dHRvbnMubGVmdCxcclxuICAgICAgdGhpcy5wZXJpb2RpY1RhYmxlQW5kSXNvdG9wZVN5bWJvbC5jZW50ZXJZLCBkYXNoZWRMaW5lT3B0aW9ucyApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggbGVmdERhc2hlZExpbmUgKTtcclxuICAgIGNvbnN0IHJpZ2h0RGFzaGVkTGluZSA9IG5ldyBMaW5lKCB0aGlzLm5ldXRyb25FbmVyZ3lMZXZlbE5vZGUucmlnaHQsIGFycm93LnRvcCwgdGhpcy5kb3VibGVBcnJvd0J1dHRvbnMucmlnaHQsXHJcbiAgICAgIHRoaXMucGVyaW9kaWNUYWJsZUFuZElzb3RvcGVTeW1ib2wuY2VudGVyWSwgZGFzaGVkTGluZU9wdGlvbnMgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHJpZ2h0RGFzaGVkTGluZSApO1xyXG5cclxuICAgIC8vIFRPRE86IHVzZSBhbGlnbiBncm91cCB0byBtYXRjaCB3aWR0aCdzIG9mIGFjY29yZGlvbiBib3ggYW5kIHBlcmlvZGljIHRhYmxlXHJcbiAgICBjb25zdCBudWNsaWRlQ2hhcnRBY2NvcmRpb25Cb3ggPSBuZXcgTnVjbGlkZUNoYXJ0QWNjb3JkaW9uQm94KCB0aGlzLm1vZGVsLnBhcnRpY2xlQXRvbS5wcm90b25Db3VudFByb3BlcnR5LFxyXG4gICAgICB0aGlzLm1vZGVsLnBhcnRpY2xlQXRvbS5uZXV0cm9uQ291bnRQcm9wZXJ0eSwgdGhpcy5wZXJpb2RpY1RhYmxlQW5kSXNvdG9wZVN5bWJvbC53aWR0aCxcclxuICAgICAgdGhpcy5tb2RlbC5zZWxlY3RlZE51Y2xpZGVDaGFydFByb3BlcnR5ICk7XHJcbiAgICBudWNsaWRlQ2hhcnRBY2NvcmRpb25Cb3gudG9wID0gdGhpcy5wZXJpb2RpY1RhYmxlQW5kSXNvdG9wZVN5bWJvbC5ib3R0b20gKyA1O1xyXG4gICAgbnVjbGlkZUNoYXJ0QWNjb3JkaW9uQm94LmxlZnQgPSB0aGlzLnBlcmlvZGljVGFibGVBbmRJc290b3BlU3ltYm9sLmxlZnQ7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBudWNsaWRlQ2hhcnRBY2NvcmRpb25Cb3ggKTtcclxuXHJcbiAgICBjb25zdCBwYXJ0aWFsQ2hhcnRSYWRpb0J1dHRvbiA9IG5ldyBSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXA8U2VsZWN0ZWRDaGFydFR5cGU+KCB0aGlzLm1vZGVsLnNlbGVjdGVkTnVjbGlkZUNoYXJ0UHJvcGVydHksXHJcbiAgICAgIFsgeyB2YWx1ZTogJ3BhcnRpYWwnLCBjcmVhdGVOb2RlOiAoKSA9PiBuZXcgVGV4dCggJ3BhcnRpYWwnICkgfSwgeyB2YWx1ZTogJ3pvb20nLCBjcmVhdGVOb2RlOiAoKSA9PiBuZXcgVGV4dCggJ3pvb20nICkgfSBdLFxyXG4gICAgICB7IGxlZnRUb3A6IG51Y2xpZGVDaGFydEFjY29yZGlvbkJveC5sZWZ0Qm90dG9tLCBvcmllbnRhdGlvbjogJ2hvcml6b250YWwnIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHBhcnRpYWxDaGFydFJhZGlvQnV0dG9uICk7XHJcblxyXG4gICAgLy8gYWRkIHRoZSBwYXJ0aWNsZVZpZXdMYXllck5vZGUgYWZ0ZXIgZXZlcnl0aGluZyBlbHNlIHNvIHBhcnRpY2xlcyBhcmUgaW4gdGhlIHRvcCBsYXllclxyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5wYXJ0aWNsZUF0b21Ob2RlICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLmVuZXJneUxldmVsTGF5ZXIgKTtcclxuXHJcbiAgICAvLyBvbmx5IHNob3cgdGhlIGVtcHR5QXRvbUNpcmNsZSB3aGVuIHRoZXJlIGFyZSB6ZXJvIG51Y2xlb25zXHJcbiAgICBNdWx0aWxpbmsubXVsdGlsaW5rKCBbIHRoaXMubW9kZWwucGFydGljbGVBdG9tLnByb3RvbkNvdW50UHJvcGVydHksIHRoaXMubW9kZWwucGFydGljbGVBdG9tLm5ldXRyb25Db3VudFByb3BlcnR5IF0sXHJcbiAgICAgICggcHJvdG9uQ291bnQ6IG51bWJlciwgbmV1dHJvbkNvdW50OiBudW1iZXIgKSA9PiB7XHJcbiAgICAgICAgdGhpcy5wYXJ0aWNsZUF0b21Ob2RlLmVtcHR5QXRvbUNpcmNsZS52aXNpYmxlID0gKCBwcm90b25Db3VudCArIG5ldXRyb25Db3VudCApID09PSAwO1xyXG4gICAgICB9ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIG51Y2xlb24gaXMgd2l0aGluIGEgcmVjdGFuZ3VsYXIgY2FwdHVyZSByYWRpdXMgZGVmaW5lZCBieSB0aGUgbGVmdCBlZGdlIG9mIHRoZSBwcm90b24gYXJyb3dcclxuICAgKiBidXR0b25zLCB0aGUgcmlnaHQgZWRnZSBvZiB0aGUgbmV1dHJvbiBhcnJvdyBidXR0b25zLCBiZWxvdyB0aGUgcGVyaW9kaWMgdGFibGUsIGFuZCBhYm92ZSB0aGUgYXJyb3cgYnV0dG9ucy5cclxuICAgKi9cclxuICBwcm90ZWN0ZWQgb3ZlcnJpZGUgaXNOdWNsZW9uSW5DYXB0dXJlQXJlYSggbnVjbGVvbjogUGFydGljbGUsIGF0b206IFBhcnRpY2xlQXRvbSApOiBib29sZWFuIHtcclxuICAgIGNvbnN0IG51Y2xlb25WaWV3UG9zaXRpb24gPSBudWNsZW9uLnBvc2l0aW9uUHJvcGVydHkudmFsdWUucGx1cyhcclxuICAgICAgbmV3IFZlY3RvcjIoIDEzNSwgMTkzIC0gQkFOQ29uc3RhbnRzLlBBUlRJQ0xFX1JBRElVUyApIC8vIHRvcCBsZWZ0IGNvcm5lciBvZiBwcm90b24gZW5lcmd5IGxldmVsc1xyXG4gICAgKTtcclxuICAgIHJldHVybiB0aGlzLnByb3RvbkVuZXJneUxldmVsTm9kZS5ib3VuZHNQcm9wZXJ0eS52YWx1ZS5kaWxhdGVkKCBCQU5Db25zdGFudHMuUEFSVElDTEVfUkFESVVTICogMiApLmNvbnRhaW5zUG9pbnQoIG51Y2xlb25WaWV3UG9zaXRpb24gKSB8fFxyXG4gICAgICAgICAgIHRoaXMubmV1dHJvbkVuZXJneUxldmVsTm9kZS5ib3VuZHNQcm9wZXJ0eS52YWx1ZS5kaWxhdGVkKCBCQU5Db25zdGFudHMuUEFSVElDTEVfUkFESVVTICogMiApLmNvbnRhaW5zUG9pbnQoIG51Y2xlb25WaWV3UG9zaXRpb24gKTtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBvdmVycmlkZSBhZGRQYXJ0aWNsZVZpZXcoIHBhcnRpY2xlOiBQYXJ0aWNsZSApOiB2b2lkIHtcclxuICAgIHRoaXMuZW5lcmd5TGV2ZWxMYXllci5hZGRDaGlsZCggdGhpcy5maW5kUGFydGljbGVWaWV3KCBwYXJ0aWNsZSApICk7XHJcbiAgfVxyXG59XHJcblxyXG5idWlsZEFOdWNsZXVzLnJlZ2lzdGVyKCAnQ2hhcnRJbnRyb1NjcmVlblZpZXcnLCBDaGFydEludHJvU2NyZWVuVmlldyApO1xyXG5leHBvcnQgZGVmYXVsdCBDaGFydEludHJvU2NyZWVuVmlldzsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsYUFBYSxNQUFNLHdCQUF3QjtBQUVsRCxPQUFPQyxTQUFTLE1BQTRCLHVDQUF1QztBQUNuRixPQUFPQyxhQUFhLE1BQWdDLG9DQUFvQztBQUd4RixPQUFPQyxTQUFTLE1BQU0sa0NBQWtDO0FBQ3hELE9BQU9DLDZCQUE2QixNQUFNLG9DQUFvQztBQUM5RSxPQUFPQyxvQkFBb0IsTUFBTSwrQkFBK0I7QUFDaEUsU0FBU0MsS0FBSyxFQUFFQyxJQUFJLEVBQUVDLElBQUksRUFBRUMsU0FBUyxFQUFFQyxRQUFRLEVBQUVDLElBQUksUUFBUSxtQ0FBbUM7QUFDaEcsT0FBT0MsWUFBWSxNQUFNLDhCQUE4QjtBQUN2RCxPQUFPQyxTQUFTLE1BQU0sMENBQTBDO0FBQ2hFLE9BQU9DLFNBQVMsTUFBTSwyQkFBMkI7QUFDakQsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxnQkFBZ0IsTUFBTSx1QkFBdUI7QUFDcEQsT0FBT0MsWUFBWSxNQUFNLG1DQUFtQztBQUM1RCxPQUFPQyxRQUFRLE1BQU0sdUNBQXVDO0FBQzVELE9BQU9DLG1CQUFtQixNQUFNLHVEQUF1RDtBQUN2RixPQUFPQyxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLGNBQWMsTUFBTSx1Q0FBdUM7QUFDbEUsT0FBT0MsWUFBWSxNQUFNLDJDQUEyQztBQUNwRSxPQUFPQyx3QkFBd0IsTUFBTSwrQkFBK0I7QUFDcEUsT0FBT0MsMkJBQTJCLE1B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