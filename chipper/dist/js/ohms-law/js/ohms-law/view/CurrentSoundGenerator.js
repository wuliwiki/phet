// Copyright 2019-2022, University of Colorado Boulder

/**
 * A sound generator used to indicate the amount of current flowing in the Ohm's Law simulation.  This monitors the
 * current property, plays a loop for a while when the current changes, alters the nature of the loop as the amount of
 * current changes, and fades the sound in and out once the current stabilizes at a new level.
 *
 * @author John Blanco
 */

import merge from '../../../../phet-core/js/merge.js';
import SoundClip from '../../../../tambo/js/sound-generators/SoundClip.js';
import currentV3Loop_mp3 from '../../../sounds/currentV3Loop_mp3.js';
import ohmsLaw from '../../ohmsLaw.js';
import OhmsLawConstants from '../OhmsLawConstants.js';

// constants
const PRE_FADE_TIME = 0.1; // in seconds
const FADE_OUT_TIME_CONSTANT = 3; // in seconds, larger values indicate faster fade out, see usage for details
const FADE_COMPLETE_OUTPUT_LEVEL = 0.001; // level at which fade out is considered complete and level is set to zero

class CurrentSoundGenerator extends SoundClip {
  /**
   * {NumberProperty} currentProperty
   * @constructor
   */
  constructor(currentProperty, options) {
    options = merge({
      initialOutputLevel: 1
    }, options);
    options.loop = true; // must be a loop to work properly

    super(currentV3Loop_mp3, options);

    // @private {number} - max output level, used for fading
    this.maxOutputLevel = options.initialOutputLevel;

    // countdown timer used to play the current sound for a while, then stop
    this.fadeCountdownTimer = Number.NEGATIVE_INFINITY;

    // function to turn loop on/off and update playback rate
    const updateSoundGeneration = current => {
      // any change turns on the playback
      if (!this.isPlaying) {
        this.play();
      }
      this.fadeCountdownTimer = PRE_FADE_TIME;

      // calculate the normalized current value using a logarithmic formula to better handle the large range
      const normalizedCurrent = Math.log(current / 1000 / OhmsLawConstants.CURRENT_RANGE.min) / Math.log(OhmsLawConstants.CURRENT_RANGE.max / OhmsLawConstants.CURRENT_RANGE.min);

      // Calculate the playback rate based on the normalized current.  The formula came from the design document, and
      // ranges from 0.5 to 2.0 times the default playback rate.
      const playbackRate = 0.5 + 1.5 * Math.pow(normalizedCurrent, 2);

      // set the playback rate for all loops
      this.setPlaybackRate(playbackRate);
    };

    // start the loop playing when the current changes
    currentProperty.lazyLink(updateSoundGeneration);
    this.disposeCurrentSoundGenerator = () => {
      currentProperty.unlink(updateSoundGeneration);
    };
  }

  /**
   * @param {number} dt
   * @public
   */
  step(dt) {
    if (this.fadeCountdownTimer > Number.NEGATIVE_INFINITY) {
      // decrement the fade countdown timer
      this.fadeCountdownTimer -= dt;

      // if the countdown timer is greater than the pre-fade time, stay at max output level
      if (this.fadeCountdownTimer > 0) {
        // not fading out yet, keep the level at the max
        this.setOutputLevel(this.maxOutputLevel);
      } else if (this.fadeCountdownTimer > Number.NEGATIVE_INFINITY) {
        // fading out, calculate the level using the exponential decay formula
        const level = this.maxOutputLevel * Math.pow(Math.E, FADE_OUT_TIME_CONSTANT * this.fadeCountdownTimer);
        if (level > FADE_COMPLETE_OUTPUT_LEVEL) {
          this.setOutputLevel(level);
        } else {
          // fade out complete
          this.setOutputLevel(0);
          this.fadeCountdownTimer = Number.NEGATIVE_INFINITY;
        }
      }
    }
  }

  /**
   * @public
   */
  reset() {
    if (this.isPlaying) {
      this.stop();
    }
    this.fadeCountdownTimer = Number.NEGATIVE_INFINITY;
  }

  /**
   * @public
   */
  dispose() {
    this.disposeCurrentSoundGenerator();
  }
}
ohmsLaw.register('CurrentSoundGenerator', CurrentSoundGenerator);
export default CurrentSoundGenerator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtZXJnZSIsIlNvdW5kQ2xpcCIsImN1cnJlbnRWM0xvb3BfbXAzIiwib2htc0xhdyIsIk9obXNMYXdDb25zdGFudHMiLCJQUkVfRkFERV9USU1FIiwiRkFERV9PVVRfVElNRV9DT05TVEFOVCIsIkZBREVfQ09NUExFVEVfT1VUUFVUX0xFVkVMIiwiQ3VycmVudFNvdW5kR2VuZXJhdG9yIiwiY29uc3RydWN0b3IiLCJjdXJyZW50UHJvcGVydHkiLCJvcHRpb25zIiwiaW5pdGlhbE91dHB1dExldmVsIiwibG9vcCIsIm1heE91dHB1dExldmVsIiwiZmFkZUNvdW50ZG93blRpbWVyIiwiTnVtYmVyIiwiTkVHQVRJVkVfSU5GSU5JVFkiLCJ1cGRhdGVTb3VuZEdlbmVyYXRpb24iLCJjdXJyZW50IiwiaXNQbGF5aW5nIiwicGxheSIsIm5vcm1hbGl6ZWRDdXJyZW50IiwiTWF0aCIsImxvZyIsIkNVUlJFTlRfUkFOR0UiLCJtaW4iLCJtYXgiLCJwbGF5YmFja1JhdGUiLCJwb3ciLCJzZXRQbGF5YmFja1JhdGUiLCJsYXp5TGluayIsImRpc3Bvc2VDdXJyZW50U291bmRHZW5lcmF0b3IiLCJ1bmxpbmsiLCJzdGVwIiwiZHQiLCJzZXRPdXRwdXRMZXZlbCIsImxldmVsIiwiRSIsInJlc2V0Iiwic3RvcCIsImRpc3Bvc2UiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkN1cnJlbnRTb3VuZEdlbmVyYXRvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBIHNvdW5kIGdlbmVyYXRvciB1c2VkIHRvIGluZGljYXRlIHRoZSBhbW91bnQgb2YgY3VycmVudCBmbG93aW5nIGluIHRoZSBPaG0ncyBMYXcgc2ltdWxhdGlvbi4gIFRoaXMgbW9uaXRvcnMgdGhlXHJcbiAqIGN1cnJlbnQgcHJvcGVydHksIHBsYXlzIGEgbG9vcCBmb3IgYSB3aGlsZSB3aGVuIHRoZSBjdXJyZW50IGNoYW5nZXMsIGFsdGVycyB0aGUgbmF0dXJlIG9mIHRoZSBsb29wIGFzIHRoZSBhbW91bnQgb2ZcclxuICogY3VycmVudCBjaGFuZ2VzLCBhbmQgZmFkZXMgdGhlIHNvdW5kIGluIGFuZCBvdXQgb25jZSB0aGUgY3VycmVudCBzdGFiaWxpemVzIGF0IGEgbmV3IGxldmVsLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvXHJcbiAqL1xyXG5cclxuaW1wb3J0IG1lcmdlIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9tZXJnZS5qcyc7XHJcbmltcG9ydCBTb3VuZENsaXAgZnJvbSAnLi4vLi4vLi4vLi4vdGFtYm8vanMvc291bmQtZ2VuZXJhdG9ycy9Tb3VuZENsaXAuanMnO1xyXG5pbXBvcnQgY3VycmVudFYzTG9vcF9tcDMgZnJvbSAnLi4vLi4vLi4vc291bmRzL2N1cnJlbnRWM0xvb3BfbXAzLmpzJztcclxuaW1wb3J0IG9obXNMYXcgZnJvbSAnLi4vLi4vb2htc0xhdy5qcyc7XHJcbmltcG9ydCBPaG1zTGF3Q29uc3RhbnRzIGZyb20gJy4uL09obXNMYXdDb25zdGFudHMuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IFBSRV9GQURFX1RJTUUgPSAwLjE7IC8vIGluIHNlY29uZHNcclxuY29uc3QgRkFERV9PVVRfVElNRV9DT05TVEFOVCA9IDM7IC8vIGluIHNlY29uZHMsIGxhcmdlciB2YWx1ZXMgaW5kaWNhdGUgZmFzdGVyIGZhZGUgb3V0LCBzZWUgdXNhZ2UgZm9yIGRldGFpbHNcclxuY29uc3QgRkFERV9DT01QTEVURV9PVVRQVVRfTEVWRUwgPSAwLjAwMTsgLy8gbGV2ZWwgYXQgd2hpY2ggZmFkZSBvdXQgaXMgY29uc2lkZXJlZCBjb21wbGV0ZSBhbmQgbGV2ZWwgaXMgc2V0IHRvIHplcm9cclxuXHJcbmNsYXNzIEN1cnJlbnRTb3VuZEdlbmVyYXRvciBleHRlbmRzIFNvdW5kQ2xpcCB7XHJcblxyXG4gIC8qKlxyXG4gICAqIHtOdW1iZXJQcm9wZXJ0eX0gY3VycmVudFByb3BlcnR5XHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIGN1cnJlbnRQcm9wZXJ0eSwgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgaW5pdGlhbE91dHB1dExldmVsOiAxXHJcbiAgICB9LCBvcHRpb25zICk7XHJcbiAgICBvcHRpb25zLmxvb3AgPSB0cnVlOyAvLyBtdXN0IGJlIGEgbG9vcCB0byB3b3JrIHByb3Blcmx5XHJcblxyXG4gICAgc3VwZXIoIGN1cnJlbnRWM0xvb3BfbXAzLCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge251bWJlcn0gLSBtYXggb3V0cHV0IGxldmVsLCB1c2VkIGZvciBmYWRpbmdcclxuICAgIHRoaXMubWF4T3V0cHV0TGV2ZWwgPSBvcHRpb25zLmluaXRpYWxPdXRwdXRMZXZlbDtcclxuXHJcbiAgICAvLyBjb3VudGRvd24gdGltZXIgdXNlZCB0byBwbGF5IHRoZSBjdXJyZW50IHNvdW5kIGZvciBhIHdoaWxlLCB0aGVuIHN0b3BcclxuICAgIHRoaXMuZmFkZUNvdW50ZG93blRpbWVyID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZO1xyXG5cclxuICAgIC8vIGZ1bmN0aW9uIHRvIHR1cm4gbG9vcCBvbi9vZmYgYW5kIHVwZGF0ZSBwbGF5YmFjayByYXRlXHJcbiAgICBjb25zdCB1cGRhdGVTb3VuZEdlbmVyYXRpb24gPSBjdXJyZW50ID0+IHtcclxuXHJcbiAgICAgIC8vIGFueSBjaGFuZ2UgdHVybnMgb24gdGhlIHBsYXliYWNrXHJcbiAgICAgIGlmICggIXRoaXMuaXNQbGF5aW5nICkge1xyXG4gICAgICAgIHRoaXMucGxheSgpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZmFkZUNvdW50ZG93blRpbWVyID0gUFJFX0ZBREVfVElNRTtcclxuXHJcbiAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgbm9ybWFsaXplZCBjdXJyZW50IHZhbHVlIHVzaW5nIGEgbG9nYXJpdGhtaWMgZm9ybXVsYSB0byBiZXR0ZXIgaGFuZGxlIHRoZSBsYXJnZSByYW5nZVxyXG4gICAgICBjb25zdCBub3JtYWxpemVkQ3VycmVudCA9IE1hdGgubG9nKCAoIGN1cnJlbnQgLyAxMDAwICkgLyBPaG1zTGF3Q29uc3RhbnRzLkNVUlJFTlRfUkFOR0UubWluICkgL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubG9nKCBPaG1zTGF3Q29uc3RhbnRzLkNVUlJFTlRfUkFOR0UubWF4IC8gT2htc0xhd0NvbnN0YW50cy5DVVJSRU5UX1JBTkdFLm1pbiApO1xyXG5cclxuICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBwbGF5YmFjayByYXRlIGJhc2VkIG9uIHRoZSBub3JtYWxpemVkIGN1cnJlbnQuICBUaGUgZm9ybXVsYSBjYW1lIGZyb20gdGhlIGRlc2lnbiBkb2N1bWVudCwgYW5kXHJcbiAgICAgIC8vIHJhbmdlcyBmcm9tIDAuNSB0byAyLjAgdGltZXMgdGhlIGRlZmF1bHQgcGxheWJhY2sgcmF0ZS5cclxuICAgICAgY29uc3QgcGxheWJhY2tSYXRlID0gMC41ICsgMS41ICogTWF0aC5wb3coIG5vcm1hbGl6ZWRDdXJyZW50LCAyICk7XHJcblxyXG4gICAgICAvLyBzZXQgdGhlIHBsYXliYWNrIHJhdGUgZm9yIGFsbCBsb29wc1xyXG4gICAgICB0aGlzLnNldFBsYXliYWNrUmF0ZSggcGxheWJhY2tSYXRlICk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIHN0YXJ0IHRoZSBsb29wIHBsYXlpbmcgd2hlbiB0aGUgY3VycmVudCBjaGFuZ2VzXHJcbiAgICBjdXJyZW50UHJvcGVydHkubGF6eUxpbmsoIHVwZGF0ZVNvdW5kR2VuZXJhdGlvbiApO1xyXG5cclxuICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRTb3VuZEdlbmVyYXRvciA9ICgpID0+IHsgY3VycmVudFByb3BlcnR5LnVubGluayggdXBkYXRlU291bmRHZW5lcmF0aW9uICk7IH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge251bWJlcn0gZHRcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgc3RlcCggZHQgKSB7XHJcbiAgICBpZiAoIHRoaXMuZmFkZUNvdW50ZG93blRpbWVyID4gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZICkge1xyXG5cclxuICAgICAgLy8gZGVjcmVtZW50IHRoZSBmYWRlIGNvdW50ZG93biB0aW1lclxyXG4gICAgICB0aGlzLmZhZGVDb3VudGRvd25UaW1lciAtPSBkdDtcclxuXHJcbiAgICAgIC8vIGlmIHRoZSBjb3VudGRvd24gdGltZXIgaXMgZ3JlYXRlciB0aGFuIHRoZSBwcmUtZmFkZSB0aW1lLCBzdGF5IGF0IG1heCBvdXRwdXQgbGV2ZWxcclxuICAgICAgaWYgKCB0aGlzLmZhZGVDb3VudGRvd25UaW1lciA+IDAgKSB7XHJcblxyXG4gICAgICAgIC8vIG5vdCBmYWRpbmcgb3V0IHlldCwga2VlcCB0aGUgbGV2ZWwgYXQgdGhlIG1heFxyXG4gICAgICAgIHRoaXMuc2V0T3V0cHV0TGV2ZWwoIHRoaXMubWF4T3V0cHV0TGV2ZWwgKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggdGhpcy5mYWRlQ291bnRkb3duVGltZXIgPiBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkgKSB7XHJcblxyXG4gICAgICAgIC8vIGZhZGluZyBvdXQsIGNhbGN1bGF0ZSB0aGUgbGV2ZWwgdXNpbmcgdGhlIGV4cG9uZW50aWFsIGRlY2F5IGZvcm11bGFcclxuICAgICAgICBjb25zdCBsZXZlbCA9IHRoaXMubWF4T3V0cHV0TGV2ZWwgKiBNYXRoLnBvdyggTWF0aC5FLCBGQURFX09VVF9USU1FX0NPTlNUQU5UICogdGhpcy5mYWRlQ291bnRkb3duVGltZXIgKTtcclxuICAgICAgICBpZiAoIGxldmVsID4gRkFERV9DT01QTEVURV9PVVRQVVRfTEVWRUwgKSB7XHJcbiAgICAgICAgICB0aGlzLnNldE91dHB1dExldmVsKCBsZXZlbCApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgICAvLyBmYWRlIG91dCBjb21wbGV0ZVxyXG4gICAgICAgICAgdGhpcy5zZXRPdXRwdXRMZXZlbCggMCApO1xyXG4gICAgICAgICAgdGhpcy5mYWRlQ291bnRkb3duVGltZXIgPSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgcmVzZXQoKSB7XHJcbiAgICBpZiAoIHRoaXMuaXNQbGF5aW5nICkge1xyXG4gICAgICB0aGlzLnN0b3AoKTtcclxuICAgIH1cclxuICAgIHRoaXMuZmFkZUNvdW50ZG93blRpbWVyID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIGRpc3Bvc2UoKSB7XHJcbiAgICB0aGlzLmRpc3Bvc2VDdXJyZW50U291bmRHZW5lcmF0b3IoKTtcclxuICB9XHJcblxyXG59XHJcblxyXG5vaG1zTGF3LnJlZ2lzdGVyKCAnQ3VycmVudFNvdW5kR2VuZXJhdG9yJywgQ3VycmVudFNvdW5kR2VuZXJhdG9yICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDdXJyZW50U291bmRHZW5lcmF0b3I7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxLQUFLLE1BQU0sbUNBQW1DO0FBQ3JELE9BQU9DLFNBQVMsTUFBTSxvREFBb0Q7QUFDMUUsT0FBT0MsaUJBQWlCLE1BQU0sc0NBQXNDO0FBQ3BFLE9BQU9DLE9BQU8sTUFBTSxrQkFBa0I7QUFDdEMsT0FBT0MsZ0JBQWdCLE1BQU0sd0JBQXdCOztBQUVyRDtBQUNBLE1BQU1DLGFBQWEsR0FBRyxHQUFHLENBQUMsQ0FBQztBQUMzQixNQUFNQyxzQkFBc0IsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNsQyxNQUFNQywwQkFBMEIsR0FBRyxLQUFLLENBQUMsQ0FBQzs7QUFFMUMsTUFBTUMscUJBQXFCLFNBQVNQLFNBQVMsQ0FBQztFQUU1QztBQUNGO0FBQ0E7QUFDQTtFQUNFUSxXQUFXQSxDQUFFQyxlQUFlLEVBQUVDLE9BQU8sRUFBRztJQUV0Q0EsT0FBTyxHQUFHWCxLQUFLLENBQUU7TUFDZlksa0JBQWtCLEVBQUU7SUFDdEIsQ0FBQyxFQUFFRCxPQUFRLENBQUM7SUFDWkEsT0FBTyxDQUFDRSxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUM7O0lBRXJCLEtBQUssQ0FBRVgsaUJBQWlCLEVBQUVTLE9BQVEsQ0FBQzs7SUFFbkM7SUFDQSxJQUFJLENBQUNHLGNBQWMsR0FBR0gsT0FBTyxDQUFDQyxrQkFBa0I7O0lBRWhEO0lBQ0EsSUFBSSxDQUFDRyxrQkFBa0IsR0FBR0MsTUFBTSxDQUFDQyxpQkFBaUI7O0lBRWxEO0lBQ0EsTUFBTUMscUJBQXFCLEdBQUdDLE9BQU8sSUFBSTtNQUV2QztNQUNBLElBQUssQ0FBQyxJQUFJLENBQUNDLFNBQVMsRUFBRztRQUNyQixJQUFJLENBQUNDLElBQUksQ0FBQyxDQUFDO01BQ2I7TUFDQSxJQUFJLENBQUNOLGtCQUFrQixHQUFHVixhQUFhOztNQUV2QztNQUNBLE1BQU1pQixpQkFBaUIsR0FBR0MsSUFBSSxDQUFDQyxHQUFHLENBQUlMLE9BQU8sR0FBRyxJQUFJLEdBQUtmLGdCQUFnQixDQUFDcUIsYUFBYSxDQUFDQyxHQUFJLENBQUMsR0FDbkVILElBQUksQ0FBQ0MsR0FBRyxDQUFFcEIsZ0JBQWdCLENBQUNxQixhQUFhLENBQUNFLEdBQUcsR0FBR3ZCLGdCQUFnQixDQUFDcUIsYUFBYSxDQUFDQyxHQUFJLENBQUM7O01BRTdHO01BQ0E7TUFDQSxNQUFNRSxZQUFZLEdBQUcsR0FBRyxHQUFHLEdBQUcsR0FBR0wsSUFBSSxDQUFDTSxHQUFHLENBQUVQLGlCQUFpQixFQUFFLENBQUUsQ0FBQzs7TUFFakU7TUFDQSxJQUFJLENBQUNRLGVBQWUsQ0FBRUYsWUFBYSxDQUFDO0lBQ3RDLENBQUM7O0lBRUQ7SUFDQWxCLGVBQWUsQ0FBQ3FCLFFBQVEsQ0FBRWIscUJBQXNCLENBQUM7SUFFakQsSUFBSSxDQUFDYyw0QkFBNEIsR0FBRyxNQUFNO01BQUV0QixlQUFlLENBQUN1QixNQUFNLENBQUVmLHFCQUFzQixDQUFDO0lBQUUsQ0FBQztFQUNoRzs7RUFFQTtBQUNGO0FBQ0E7QUFDQTtFQUNFZ0IsSUFBSUEsQ0FBRUMsRUFBRSxFQUFHO0lBQ1QsSUFBSyxJQUFJLENBQUNwQixrQkFBa0IsR0FBR0MsTUFBTSxDQUFDQyxpQkFBaUIsRUFBRztNQUV4RDtNQUNBLElBQUksQ0FBQ0Ysa0JBQWtCLElBQUlvQixFQUFFOztNQUU3QjtNQUNBLElBQUssSUFBSSxDQUFDcEIsa0JBQWtCLEdBQUcsQ0FBQyxFQUFHO1FBRWpDO1FBQ0EsSUFBSSxDQUFDcUIsY0FBYyxDQUFFLElBQUksQ0FBQ3RCLGNBQWUsQ0FBQztNQUM1QyxDQUFDLE1BQ0ksSUFBSyxJQUFJLENBQUNDLGtCQUFrQixHQUFHQyxNQUFNLENBQUNDLGlCQUFpQixFQUFHO1FBRTdEO1FBQ0EsTUFBTW9CLEtBQUssR0FBRyxJQUFJLENBQUN2QixjQUFjLEdBQUdTLElBQUksQ0FBQ00sR0FBRyxDQUFFTixJQUFJLENBQUNlLENBQUMsRUFBRWhDLHNCQUFzQixHQUFHLElBQUksQ0FBQ1Msa0JBQW1CLENBQUM7UUFDeEcsSUFBS3NCLEtBQUssR0FBRzlCLDBCQUEwQixFQUFHO1VBQ3hDLElBQUksQ0FBQzZCLGNBQWMsQ0FBRUMsS0FBTSxDQUFDO1FBQzlCLENBQUMsTUFDSTtVQUVIO1VBQ0EsSUFBSSxDQUFDRCxjQUFjLENBQUUsQ0FBRSxDQUFDO1VBQ3hCLElBQUksQ0FBQ3JCLGtCQUFrQixHQUFHQyxNQUFNLENBQUNDLGlCQUFpQjtRQUNwRDtNQUNGO0lBQ0Y7RUFDRjs7RUFFQTtBQUNGO0FBQ0E7RUFDRXNCLEtBQUtBLENBQUEsRUFBRztJQUNOLElBQUssSUFBSSxDQUFDbkIsU0FBUyxFQUFHO01BQ3BCLElBQUksQ0FBQ29CLElBQUksQ0FBQyxDQUFDO0lBQ2I7SUFDQSxJQUFJLENBQUN6QixrQkFBa0IsR0FBR0MsTUFBTSxDQUFDQyxpQkFBaUI7RUFDcEQ7O0VBRUE7QUFDRjtBQUNBO0VBQ0V3QixPQUFPQSxDQUFBLEVBQUc7SUFDUixJQUFJLENBQUNULDRCQUE0QixDQUFDLENBQUM7RUFDckM7QUFFRjtBQUVBN0IsT0FBTyxDQUFDdUMsUUFBUSxDQUFFLHVCQUF1QixFQUFFbEMscUJBQXNCLENBQUM7QUFFbEUsZUFBZUEscUJBQXFCIn0=