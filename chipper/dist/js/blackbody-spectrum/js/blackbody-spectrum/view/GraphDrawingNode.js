// Copyright 2014-2022, University of Colorado Boulder

/**
 * Graph Node responsible for positioning all of the graph elements
 * Handles or controls the majority of the over-arching graph logic
 *
 * @author Martin Veillette (Berea College)
 * @author Saurabh Totey
 * @author Arnab Purkayastha
 */

import Dimension2 from '../../../../dot/js/Dimension2.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import { Shape } from '../../../../kite/js/imports.js';
import merge from '../../../../phet-core/js/merge.js';
import MagnifyingGlassZoomButtonGroup from '../../../../scenery-phet/js/MagnifyingGlassZoomButtonGroup.js';
import PhetColorScheme from '../../../../scenery-phet/js/PhetColorScheme.js';
import WavelengthSpectrumNode from '../../../../scenery-phet/js/WavelengthSpectrumNode.js';
import { Node, Path } from '../../../../scenery/js/imports.js';
import ColorConstants from '../../../../sun/js/ColorConstants.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import BlackbodyConstants from '../../BlackbodyConstants.js';
import blackbodySpectrum from '../../blackbodySpectrum.js';
import GraphValuesPointNode from './GraphValuesPointNode.js';
import ZoomableAxesView from './ZoomableAxesView.js';

// constants
const GRAPH_NUMBER_POINTS = 300; // number of points blackbody curve is evaluated at
const ZOOM_BUTTON_ICON_RADIUS = 8; // size of zoom buttons
const ZOOM_BUTTON_SPACING = 10; // spacing between + and - zoom buttons
const ZOOM_BUTTON_AXES_MARGIN = 35; // spacing between zoom buttons and axes
const DEFAULT_LINE_WIDTH = 5; // regular line width for graph paths
const OVERLAID_LINE_WIDTH = 3; // line width when saved graphs are initially created

class GraphDrawingNode extends Node {
  /**
   * The node that handles keeping all of the graph elements together and working
   * @param {BlackbodySpectrumModel} model - model for the entire screen
   * @param {Object} [options]
   */
  constructor(model, options) {
    options = merge({
      savedGraphPathColor: 'gray',
      intensityPathFillColor: 'rgba(100,100,100,0.75)',
      graphPathOptions: {
        stroke: PhetColorScheme.RED_COLORBLIND,
        lineWidth: DEFAULT_LINE_WIDTH,
        lineJoin: 'round',
        lineCap: 'round'
      },
      tandem: Tandem.REQUIRED
    }, options);
    super();

    // @private
    this.model = model;

    // @private The axes with the ticks and EM spectrum labels
    this.axes = new ZoomableAxesView(model, {
      tandem: options.tandem.createTandem('axesView')
    });

    // @private Intermediary nodes containing elements within axes to allow for easier clipping
    this.innerGraphUnderAxes = new Node();
    this.innerGraphOverAxes = new Node();
    this.innerGraphUnderAxes.clipArea = this.axes.clipShape;
    this.innerGraphOverAxes.clipArea = this.axes.clipShape;

    // @private Paths for the main and saved graphs
    this.mainGraph = new Path(null, options.graphPathOptions);
    this.primarySavedGraph = new Path(null, merge(options.graphPathOptions, {
      stroke: options.savedGraphPathColor
    }));
    this.secondarySavedGraph = new Path(null, merge(options.graphPathOptions, {
      stroke: options.savedGraphPathColor,
      lineDash: [5, 5],
      lineCap: 'butt'
    }));

    // @private Path for intensity, area under the curve
    this.intensityPath = new Path(null, {
      fill: options.intensityPathFillColor
    });
    model.intensityVisibleProperty.link(intensityVisible => {
      this.intensityPath.visible = intensityVisible;
    });

    // @private The point node that can be dragged to find out graph values
    this.draggablePointNode = new GraphValuesPointNode(model.mainBody, this.axes, {
      tandem: options.tandem.createTandem('graphValuesPointNode')
    });
    model.graphValuesVisibleProperty.link(graphValuesVisible => {
      // Node will move back to top of graph on visibility change
      this.draggablePointNode.wavelengthProperty.value = this.model.mainBody.peakWavelength;
      this.draggablePointNode.visible = graphValuesVisible;
    });

    // Node for that displays the rainbow for the visible portion of the electromagnetic spectrum
    const infraredPosition = this.axes.wavelengthToViewX(BlackbodyConstants.visibleWavelength);
    const ultravioletPosition = this.axes.wavelengthToViewX(BlackbodyConstants.ultravioletWavelength);
    const spectrumWidth = infraredPosition - ultravioletPosition;

    // @private Color spectrum for visible light
    this.wavelengthSpectrumNode = new WavelengthSpectrumNode({
      size: new Dimension2(spectrumWidth, this.axes.verticalAxisLength),
      opacity: 0.9,
      tandem: options.tandem.createTandem('wavelengthSpectrumNode')
    });
    this.innerGraphUnderAxes.addChild(this.wavelengthSpectrumNode);
    this.innerGraphUnderAxes.addChild(this.intensityPath);
    this.innerGraphOverAxes.addChild(this.mainGraph);
    this.innerGraphOverAxes.addChild(this.primarySavedGraph);
    this.innerGraphOverAxes.addChild(this.secondarySavedGraph);

    // @private {MagnifyingGlassZoomButtonGroup} - horizontal zoom buttons
    const horizontalZoomButtonGroup = new MagnifyingGlassZoomButtonGroup(this.axes.horizontalZoomProperty, {
      applyZoomIn: zoom => zoom / this.axes.horizontalZoomScale,
      applyZoomOut: zoom => zoom * this.axes.horizontalZoomScale,
      spacing: ZOOM_BUTTON_SPACING,
      buttonOptions: {
        baseColor: ColorConstants.LIGHT_BLUE,
        touchAreaXDilation: 5,
        touchAreaYDilation: 5
      },
      magnifyingGlassNodeOptions: {
        glassRadius: ZOOM_BUTTON_ICON_RADIUS
      },
      tandem: options.tandem.createTandem('horizontalZoomButtonGroup')
    });

    // @private {MagnifyingGlassZoomButtonGroup} - vertical zoom buttons
    const verticalZoomButtonGroup = new MagnifyingGlassZoomButtonGroup(this.axes.verticalZoomProperty, {
      applyZoomIn: zoom => zoom / this.axes.verticalZoomScale,
      applyZoomOut: zoom => zoom * this.axes.verticalZoomScale,
      spacing: ZOOM_BUTTON_SPACING,
      buttonOptions: {
        baseColor: ColorConstants.LIGHT_BLUE,
        touchAreaXDilation: 5,
        touchAreaYDilation: 5
      },
      magnifyingGlassNodeOptions: {
        glassRadius: ZOOM_BUTTON_ICON_RADIUS
      },
      // phet-io
      tandem: options.tandem.createTandem('verticalZoomButtonGroup')
    });

    // Links different parts of GraphDrawingNode to update whenever specified tracked Properties change
    const updateMainGraphAndLayout = () => {
      this.update();
      this.moveMainGraphToFront();
    };
    const updateSavedGraphAndLayout = () => {
      this.updateSavedGraphPaths();
      this.moveSavedGraphToFront();
    };
    const updateAllGraphs = () => {
      this.update();
      this.updateSavedGraphPaths();
    };
    model.mainBody.temperatureProperty.link(updateMainGraphAndLayout);
    model.savedBodyOne.temperatureProperty.link(updateSavedGraphAndLayout);
    model.savedBodyTwo.temperatureProperty.link(updateSavedGraphAndLayout);
    this.axes.horizontalZoomProperty.link(updateAllGraphs);
    this.axes.verticalZoomProperty.link(updateAllGraphs);

    // Sets layout of graph node elements to be all ultimately relative to the axes
    const axesPath = this.axes.axesPath;
    horizontalZoomButtonGroup.centerX = axesPath.right + ZOOM_BUTTON_ICON_RADIUS;
    horizontalZoomButtonGroup.top = axesPath.bottom + ZOOM_BUTTON_AXES_MARGIN;
    verticalZoomButtonGroup.centerX = axesPath.left - ZOOM_BUTTON_ICON_RADIUS * 2;
    verticalZoomButtonGroup.bottom = axesPath.top - ZOOM_BUTTON_AXES_MARGIN;
    this.wavelengthSpectrumNode.centerY = axesPath.centerY;
    this.wavelengthSpectrumNode.left = ultravioletPosition;

    // Adds children in rendering order
    this.addChild(this.innerGraphUnderAxes);
    this.addChild(this.axes);
    this.addChild(horizontalZoomButtonGroup);
    this.addChild(verticalZoomButtonGroup);
    this.addChild(this.innerGraphOverAxes);
    this.addChild(this.draggablePointNode);
  }

  /**
   * Reset Properties associated with this Node
   * @public
   */
  reset() {
    this.axes.reset();
    this.draggablePointNode.reset();
  }

  /**
   * Gets the shape of a given BlackbodyBodyModel
   * @param {BlackbodyBodyModel} body
   * @returns {Shape}
   * @private
   */
  shapeOfBody(body) {
    const graphShape = new Shape();
    const deltaWavelength = this.model.wavelengthMax / (GRAPH_NUMBER_POINTS - 1);
    const pointsXOffset = this.axes.horizontalAxisLength / (GRAPH_NUMBER_POINTS - 1);
    const yCutoff = this.axes.verticalAxisLength + this.mainGraph.lineWidth;
    const peakWavelength = body.peakWavelength;
    let findingPeak = true;
    graphShape.moveTo(0, 0);
    for (let i = 1; i < GRAPH_NUMBER_POINTS; i++) {
      if (deltaWavelength * i > peakWavelength && findingPeak) {
        // Force peak wavelength point to be added
        const yMax = this.axes.spectralPowerDensityToViewY(body.getSpectralPowerDensityAt(peakWavelength));
        graphShape.lineTo(this.axes.wavelengthToViewX(peakWavelength), yMax < -yCutoff ? -yCutoff : yMax);
        findingPeak = false;
      }
      const y = this.axes.spectralPowerDensityToViewY(body.getSpectralPowerDensityAt(deltaWavelength * i));
      graphShape.lineTo(pointsXOffset * i, y < -yCutoff ? -yCutoff : y);
    }
    return graphShape;
  }

  /**
   * Updates the saved and main graph paths as well as their corresponding text boxes or intensity paths
   * @private
   */
  updateGraphPaths() {
    // Updates the main graph
    const updatedGraphShape = this.shapeOfBody(this.model.mainBody);
    this.mainGraph.shape = updatedGraphShape;

    // Easiest way to implement intensity shape is to copy graph shape and bring down to x-axis
    this.intensityPath.shape = updatedGraphShape.copy();
    const newPoint = new Vector2(this.axes.horizontalAxisLength, 0);
    if (this.intensityPath.shape.getLastPoint().minus(newPoint).magnitude > 0) {
      this.intensityPath.shape.lineToPoint(newPoint);
    }
  }

  /**
   * Move the main graph to the front of the scene
   * @private
   */
  moveMainGraphToFront() {
    this.mainGraph.moveToFront();
    this.draggablePointNode.moveToFront();

    // Reset saved graphs back to default width
    this.primarySavedGraph.lineWidth = DEFAULT_LINE_WIDTH;
    this.secondarySavedGraph.lineWidth = DEFAULT_LINE_WIDTH;
  }

  /**
   * Updates the saved graph paths
   * @private
   */
  updateSavedGraphPaths() {
    // Updates the saved graph(s)
    this.primarySavedGraph.shape = null;
    this.secondarySavedGraph.shape = null;
    if (this.model.savedBodyOne.temperatureProperty.value !== null) {
      this.primarySavedGraph.shape = this.shapeOfBody(this.model.savedBodyOne);
      if (this.model.savedBodyTwo.temperatureProperty.value !== null) {
        this.secondarySavedGraph.shape = this.shapeOfBody(this.model.savedBodyTwo);
      }
    }
  }

  /**
   * Move the latest saved graph to the front of the scene
   * @private
   */
  moveSavedGraphToFront() {
    this.primarySavedGraph.moveToFront();

    // Also set newly created graph to smaller size to be visible in front of main graph
    this.primarySavedGraph.lineWidth = OVERLAID_LINE_WIDTH;
  }

  /**
   * A method that updates the visible spectrum rainbow node to be in the correct position relative to the axes
   * @private
   */
  updateVisibleSpectrumNode() {
    const infraredPosition = this.axes.wavelengthToViewX(BlackbodyConstants.visibleWavelength);
    const ultravioletPosition = this.axes.wavelengthToViewX(BlackbodyConstants.ultravioletWavelength);
    const spectrumWidth = infraredPosition - ultravioletPosition;
    this.wavelengthSpectrumNode.left = ultravioletPosition;
    this.wavelengthSpectrumNode.scale(new Vector2(spectrumWidth / this.wavelengthSpectrumNode.width, 1));
  }

  /**
   * Updates everything in the graph drawing node
   * @private
   */
  update() {
    this.updateGraphPaths();
    this.draggablePointNode.update();
    this.axes.update();
    this.updateVisibleSpectrumNode();
  }
}
blackbodySpectrum.register('GraphDrawingNode', GraphDrawingNode);
export default GraphDrawingNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEaW1lbnNpb24yIiwiVmVjdG9yMiIsIlNoYXBlIiwibWVyZ2UiLCJNYWduaWZ5aW5nR2xhc3Nab29tQnV0dG9uR3JvdXAiLCJQaGV0Q29sb3JTY2hlbWUiLCJXYXZlbGVuZ3RoU3BlY3RydW1Ob2RlIiwiTm9kZSIsIlBhdGgiLCJDb2xvckNvbnN0YW50cyIsIlRhbmRlbSIsIkJsYWNrYm9keUNvbnN0YW50cyIsImJsYWNrYm9keVNwZWN0cnVtIiwiR3JhcGhWYWx1ZXNQb2ludE5vZGUiLCJab29tYWJsZUF4ZXNWaWV3IiwiR1JBUEhfTlVNQkVSX1BPSU5UUyIsIlpPT01fQlVUVE9OX0lDT05fUkFESVVTIiwiWk9PTV9CVVRUT05fU1BBQ0lORyIsIlpPT01fQlVUVE9OX0FYRVNfTUFSR0lOIiwiREVGQVVMVF9MSU5FX1dJRFRIIiwiT1ZFUkxBSURfTElORV9XSURUSCIsIkdyYXBoRHJhd2luZ05vZGUiLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwib3B0aW9ucyIsInNhdmVkR3JhcGhQYXRoQ29sb3IiLCJpbnRlbnNpdHlQYXRoRmlsbENvbG9yIiwiZ3JhcGhQYXRoT3B0aW9ucyIsInN0cm9rZSIsIlJFRF9DT0xPUkJMSU5EIiwibGluZVdpZHRoIiwibGluZUpvaW4iLCJsaW5lQ2FwIiwidGFuZGVtIiwiUkVRVUlSRUQiLCJheGVzIiwiY3JlYXRlVGFuZGVtIiwiaW5uZXJHcmFwaFVuZGVyQXhlcyIsImlubmVyR3JhcGhPdmVyQXhlcyIsImNsaXBBcmVhIiwiY2xpcFNoYXBlIiwibWFpbkdyYXBoIiwicHJpbWFyeVNhdmVkR3JhcGgiLCJzZWNvbmRhcnlTYXZlZEdyYXBoIiwibGluZURhc2giLCJpbnRlbnNpdHlQYXRoIiwiZmlsbCIsImludGVuc2l0eVZpc2libGVQcm9wZXJ0eSIsImxpbmsiLCJpbnRlbnNpdHlWaXNpYmxlIiwidmlzaWJsZSIsImRyYWdnYWJsZVBvaW50Tm9kZSIsIm1haW5Cb2R5IiwiZ3JhcGhWYWx1ZXNWaXNpYmxlUHJvcGVydHkiLCJncmFwaFZhbHVlc1Zpc2libGUiLCJ3YXZlbGVuZ3RoUHJvcGVydHkiLCJ2YWx1ZSIsInBlYWtXYXZlbGVuZ3RoIiwiaW5mcmFyZWRQb3NpdGlvbiIsIndhdmVsZW5ndGhUb1ZpZXdYIiwidmlzaWJsZVdhdmVsZW5ndGgiLCJ1bHRyYXZpb2xldFBvc2l0aW9uIiwidWx0cmF2aW9sZXRXYXZlbGVuZ3RoIiwic3BlY3RydW1XaWR0aCIsIndhdmVsZW5ndGhTcGVjdHJ1bU5vZGUiLCJzaXplIiwidmVydGljYWxBeGlzTGVuZ3RoIiwib3BhY2l0eSIsImFkZENoaWxkIiwiaG9yaXpvbnRhbFpvb21CdXR0b25Hcm91cCIsImhvcml6b250YWxab29tUHJvcGVydHkiLCJhcHBseVpvb21JbiIsInpvb20iLCJob3Jpem9udGFsWm9vbVNjYWxlIiwiYXBwbHlab29tT3V0Iiwic3BhY2luZyIsImJ1dHRvbk9wdGlvbnMiLCJiYXNlQ29sb3IiLCJMSUdIVF9CTFVFIiwidG91Y2hBcmVhWERpbGF0aW9uIiwidG91Y2hBcmVhWURpbGF0aW9uIiwibWFnbmlmeWluZ0dsYXNzTm9kZU9wdGlvbnMiLCJnbGFzc1JhZGl1cyIsInZlcnRpY2FsWm9vbUJ1dHRvbkdyb3VwIiwidmVydGljYWxab29tUHJvcGVydHkiLCJ2ZXJ0aWNhbFpvb21TY2FsZSIsInVwZGF0ZU1haW5HcmFwaEFuZExheW91dCIsInVwZGF0ZSIsIm1vdmVNYWluR3JhcGhUb0Zyb250IiwidXBkYXRlU2F2ZWRHcmFwaEFuZExheW91dCIsInVwZGF0ZVNhdmVkR3JhcGhQYXRocyIsIm1vdmVTYXZlZEdyYXBoVG9Gcm9udCIsInVwZGF0ZUFsbEdyYXBocyIsInRlbXBlcmF0dXJlUHJvcGVydHkiLCJzYXZlZEJvZHlPbmUiLCJzYXZlZEJvZHlUd28iLCJheGVzUGF0aCIsImNlbnRlclgiLCJyaWdodCIsInRvcCIsImJvdHRvbSIsImxlZnQiLCJjZW50ZXJZIiwicmVzZXQiLCJzaGFwZU9mQm9keSIsImJvZHkiLCJncmFwaFNoYXBlIiwiZGVsdGFXYXZlbGVuZ3RoIiwid2F2ZWxlbmd0aE1heCIsInBvaW50c1hPZmZzZXQiLCJob3Jpem9udGFsQXhpc0xlbmd0aCIsInlDdXRvZmYiLCJmaW5kaW5nUGVhayIsIm1vdmVUbyIsImkiLCJ5TWF4Iiwic3BlY3RyYWxQb3dlckRlbnNpdHlUb1ZpZXdZIiwiZ2V0U3BlY3RyYWxQb3dlckRlbnNpdHlBdCIsImxpbmVUbyIsInkiLCJ1cGRhdGVHcmFwaFBhdGhzIiwidXBkYXRlZEdyYXBoU2hhcGUiLCJzaGFwZSIsImNvcHkiLCJuZXdQb2ludCIsImdldExhc3RQb2ludCIsIm1pbnVzIiwibWFnbml0dWRlIiwibGluZVRvUG9pbnQiLCJtb3ZlVG9Gcm9udCIsInVwZGF0ZVZpc2libGVTcGVjdHJ1bU5vZGUiLCJzY2FsZSIsIndpZHRoIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJHcmFwaERyYXdpbmdOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEdyYXBoIE5vZGUgcmVzcG9uc2libGUgZm9yIHBvc2l0aW9uaW5nIGFsbCBvZiB0aGUgZ3JhcGggZWxlbWVudHNcclxuICogSGFuZGxlcyBvciBjb250cm9scyB0aGUgbWFqb3JpdHkgb2YgdGhlIG92ZXItYXJjaGluZyBncmFwaCBsb2dpY1xyXG4gKlxyXG4gKiBAYXV0aG9yIE1hcnRpbiBWZWlsbGV0dGUgKEJlcmVhIENvbGxlZ2UpXHJcbiAqIEBhdXRob3IgU2F1cmFiaCBUb3RleVxyXG4gKiBAYXV0aG9yIEFybmFiIFB1cmtheWFzdGhhXHJcbiAqL1xyXG5cclxuaW1wb3J0IERpbWVuc2lvbjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0RpbWVuc2lvbjIuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IG1lcmdlIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9tZXJnZS5qcyc7XHJcbmltcG9ydCBNYWduaWZ5aW5nR2xhc3Nab29tQnV0dG9uR3JvdXAgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL01hZ25pZnlpbmdHbGFzc1pvb21CdXR0b25Hcm91cC5qcyc7XHJcbmltcG9ydCBQaGV0Q29sb3JTY2hlbWUgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRDb2xvclNjaGVtZS5qcyc7XHJcbmltcG9ydCBXYXZlbGVuZ3RoU3BlY3RydW1Ob2RlIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9XYXZlbGVuZ3RoU3BlY3RydW1Ob2RlLmpzJztcclxuaW1wb3J0IHsgTm9kZSwgUGF0aCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBDb2xvckNvbnN0YW50cyBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvQ29sb3JDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgQmxhY2tib2R5Q29uc3RhbnRzIGZyb20gJy4uLy4uL0JsYWNrYm9keUNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBibGFja2JvZHlTcGVjdHJ1bSBmcm9tICcuLi8uLi9ibGFja2JvZHlTcGVjdHJ1bS5qcyc7XHJcbmltcG9ydCBHcmFwaFZhbHVlc1BvaW50Tm9kZSBmcm9tICcuL0dyYXBoVmFsdWVzUG9pbnROb2RlLmpzJztcclxuaW1wb3J0IFpvb21hYmxlQXhlc1ZpZXcgZnJvbSAnLi9ab29tYWJsZUF4ZXNWaWV3LmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBHUkFQSF9OVU1CRVJfUE9JTlRTID0gMzAwOyAvLyBudW1iZXIgb2YgcG9pbnRzIGJsYWNrYm9keSBjdXJ2ZSBpcyBldmFsdWF0ZWQgYXRcclxuY29uc3QgWk9PTV9CVVRUT05fSUNPTl9SQURJVVMgPSA4OyAvLyBzaXplIG9mIHpvb20gYnV0dG9uc1xyXG5jb25zdCBaT09NX0JVVFRPTl9TUEFDSU5HID0gMTA7IC8vIHNwYWNpbmcgYmV0d2VlbiArIGFuZCAtIHpvb20gYnV0dG9uc1xyXG5jb25zdCBaT09NX0JVVFRPTl9BWEVTX01BUkdJTiA9IDM1OyAvLyBzcGFjaW5nIGJldHdlZW4gem9vbSBidXR0b25zIGFuZCBheGVzXHJcbmNvbnN0IERFRkFVTFRfTElORV9XSURUSCA9IDU7IC8vIHJlZ3VsYXIgbGluZSB3aWR0aCBmb3IgZ3JhcGggcGF0aHNcclxuY29uc3QgT1ZFUkxBSURfTElORV9XSURUSCA9IDM7IC8vIGxpbmUgd2lkdGggd2hlbiBzYXZlZCBncmFwaHMgYXJlIGluaXRpYWxseSBjcmVhdGVkXHJcblxyXG5jbGFzcyBHcmFwaERyYXdpbmdOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoZSBub2RlIHRoYXQgaGFuZGxlcyBrZWVwaW5nIGFsbCBvZiB0aGUgZ3JhcGggZWxlbWVudHMgdG9nZXRoZXIgYW5kIHdvcmtpbmdcclxuICAgKiBAcGFyYW0ge0JsYWNrYm9keVNwZWN0cnVtTW9kZWx9IG1vZGVsIC0gbW9kZWwgZm9yIHRoZSBlbnRpcmUgc2NyZWVuXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBtb2RlbCwgb3B0aW9ucyApIHtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgc2F2ZWRHcmFwaFBhdGhDb2xvcjogJ2dyYXknLFxyXG4gICAgICBpbnRlbnNpdHlQYXRoRmlsbENvbG9yOiAncmdiYSgxMDAsMTAwLDEwMCwwLjc1KScsXHJcbiAgICAgIGdyYXBoUGF0aE9wdGlvbnM6IHtcclxuICAgICAgICBzdHJva2U6IFBoZXRDb2xvclNjaGVtZS5SRURfQ09MT1JCTElORCxcclxuICAgICAgICBsaW5lV2lkdGg6IERFRkFVTFRfTElORV9XSURUSCxcclxuICAgICAgICBsaW5lSm9pbjogJ3JvdW5kJyxcclxuICAgICAgICBsaW5lQ2FwOiAncm91bmQnXHJcbiAgICAgIH0sXHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVEXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZVxyXG4gICAgdGhpcy5tb2RlbCA9IG1vZGVsO1xyXG5cclxuICAgIC8vIEBwcml2YXRlIFRoZSBheGVzIHdpdGggdGhlIHRpY2tzIGFuZCBFTSBzcGVjdHJ1bSBsYWJlbHNcclxuICAgIHRoaXMuYXhlcyA9IG5ldyBab29tYWJsZUF4ZXNWaWV3KCBtb2RlbCwgeyB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2F4ZXNWaWV3JyApIH0gKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSBJbnRlcm1lZGlhcnkgbm9kZXMgY29udGFpbmluZyBlbGVtZW50cyB3aXRoaW4gYXhlcyB0byBhbGxvdyBmb3IgZWFzaWVyIGNsaXBwaW5nXHJcbiAgICB0aGlzLmlubmVyR3JhcGhVbmRlckF4ZXMgPSBuZXcgTm9kZSgpO1xyXG4gICAgdGhpcy5pbm5lckdyYXBoT3ZlckF4ZXMgPSBuZXcgTm9kZSgpO1xyXG4gICAgdGhpcy5pbm5lckdyYXBoVW5kZXJBeGVzLmNsaXBBcmVhID0gdGhpcy5heGVzLmNsaXBTaGFwZTtcclxuICAgIHRoaXMuaW5uZXJHcmFwaE92ZXJBeGVzLmNsaXBBcmVhID0gdGhpcy5heGVzLmNsaXBTaGFwZTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSBQYXRocyBmb3IgdGhlIG1haW4gYW5kIHNhdmVkIGdyYXBoc1xyXG4gICAgdGhpcy5tYWluR3JhcGggPSBuZXcgUGF0aCggbnVsbCwgb3B0aW9ucy5ncmFwaFBhdGhPcHRpb25zICk7XHJcbiAgICB0aGlzLnByaW1hcnlTYXZlZEdyYXBoID0gbmV3IFBhdGgoIG51bGwsIG1lcmdlKCBvcHRpb25zLmdyYXBoUGF0aE9wdGlvbnMsIHtcclxuICAgICAgc3Ryb2tlOiBvcHRpb25zLnNhdmVkR3JhcGhQYXRoQ29sb3JcclxuICAgIH0gKSApO1xyXG4gICAgdGhpcy5zZWNvbmRhcnlTYXZlZEdyYXBoID0gbmV3IFBhdGgoIG51bGwsIG1lcmdlKCBvcHRpb25zLmdyYXBoUGF0aE9wdGlvbnMsIHtcclxuICAgICAgc3Ryb2tlOiBvcHRpb25zLnNhdmVkR3JhcGhQYXRoQ29sb3IsXHJcbiAgICAgIGxpbmVEYXNoOiBbIDUsIDUgXSxcclxuICAgICAgbGluZUNhcDogJ2J1dHQnXHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSBQYXRoIGZvciBpbnRlbnNpdHksIGFyZWEgdW5kZXIgdGhlIGN1cnZlXHJcbiAgICB0aGlzLmludGVuc2l0eVBhdGggPSBuZXcgUGF0aCggbnVsbCwgeyBmaWxsOiBvcHRpb25zLmludGVuc2l0eVBhdGhGaWxsQ29sb3IgfSApO1xyXG4gICAgbW9kZWwuaW50ZW5zaXR5VmlzaWJsZVByb3BlcnR5LmxpbmsoIGludGVuc2l0eVZpc2libGUgPT4ge1xyXG4gICAgICB0aGlzLmludGVuc2l0eVBhdGgudmlzaWJsZSA9IGludGVuc2l0eVZpc2libGU7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUgVGhlIHBvaW50IG5vZGUgdGhhdCBjYW4gYmUgZHJhZ2dlZCB0byBmaW5kIG91dCBncmFwaCB2YWx1ZXNcclxuICAgIHRoaXMuZHJhZ2dhYmxlUG9pbnROb2RlID0gbmV3IEdyYXBoVmFsdWVzUG9pbnROb2RlKCBtb2RlbC5tYWluQm9keSwgdGhpcy5heGVzLCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZ3JhcGhWYWx1ZXNQb2ludE5vZGUnIClcclxuICAgIH0gKTtcclxuICAgIG1vZGVsLmdyYXBoVmFsdWVzVmlzaWJsZVByb3BlcnR5LmxpbmsoIGdyYXBoVmFsdWVzVmlzaWJsZSA9PiB7XHJcblxyXG4gICAgICAvLyBOb2RlIHdpbGwgbW92ZSBiYWNrIHRvIHRvcCBvZiBncmFwaCBvbiB2aXNpYmlsaXR5IGNoYW5nZVxyXG4gICAgICB0aGlzLmRyYWdnYWJsZVBvaW50Tm9kZS53YXZlbGVuZ3RoUHJvcGVydHkudmFsdWUgPSB0aGlzLm1vZGVsLm1haW5Cb2R5LnBlYWtXYXZlbGVuZ3RoO1xyXG4gICAgICB0aGlzLmRyYWdnYWJsZVBvaW50Tm9kZS52aXNpYmxlID0gZ3JhcGhWYWx1ZXNWaXNpYmxlO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIE5vZGUgZm9yIHRoYXQgZGlzcGxheXMgdGhlIHJhaW5ib3cgZm9yIHRoZSB2aXNpYmxlIHBvcnRpb24gb2YgdGhlIGVsZWN0cm9tYWduZXRpYyBzcGVjdHJ1bVxyXG4gICAgY29uc3QgaW5mcmFyZWRQb3NpdGlvbiA9IHRoaXMuYXhlcy53YXZlbGVuZ3RoVG9WaWV3WCggQmxhY2tib2R5Q29uc3RhbnRzLnZpc2libGVXYXZlbGVuZ3RoICk7XHJcbiAgICBjb25zdCB1bHRyYXZpb2xldFBvc2l0aW9uID0gdGhpcy5heGVzLndhdmVsZW5ndGhUb1ZpZXdYKCBCbGFja2JvZHlDb25zdGFudHMudWx0cmF2aW9sZXRXYXZlbGVuZ3RoICk7XHJcbiAgICBjb25zdCBzcGVjdHJ1bVdpZHRoID0gaW5mcmFyZWRQb3NpdGlvbiAtIHVsdHJhdmlvbGV0UG9zaXRpb247XHJcblxyXG4gICAgLy8gQHByaXZhdGUgQ29sb3Igc3BlY3RydW0gZm9yIHZpc2libGUgbGlnaHRcclxuICAgIHRoaXMud2F2ZWxlbmd0aFNwZWN0cnVtTm9kZSA9IG5ldyBXYXZlbGVuZ3RoU3BlY3RydW1Ob2RlKCB7XHJcbiAgICAgIHNpemU6IG5ldyBEaW1lbnNpb24yKCBzcGVjdHJ1bVdpZHRoLCB0aGlzLmF4ZXMudmVydGljYWxBeGlzTGVuZ3RoICksXHJcbiAgICAgIG9wYWNpdHk6IDAuOSxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICd3YXZlbGVuZ3RoU3BlY3RydW1Ob2RlJyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5pbm5lckdyYXBoVW5kZXJBeGVzLmFkZENoaWxkKCB0aGlzLndhdmVsZW5ndGhTcGVjdHJ1bU5vZGUgKTtcclxuICAgIHRoaXMuaW5uZXJHcmFwaFVuZGVyQXhlcy5hZGRDaGlsZCggdGhpcy5pbnRlbnNpdHlQYXRoICk7XHJcbiAgICB0aGlzLmlubmVyR3JhcGhPdmVyQXhlcy5hZGRDaGlsZCggdGhpcy5tYWluR3JhcGggKTtcclxuICAgIHRoaXMuaW5uZXJHcmFwaE92ZXJBeGVzLmFkZENoaWxkKCB0aGlzLnByaW1hcnlTYXZlZEdyYXBoICk7XHJcbiAgICB0aGlzLmlubmVyR3JhcGhPdmVyQXhlcy5hZGRDaGlsZCggdGhpcy5zZWNvbmRhcnlTYXZlZEdyYXBoICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGUge01hZ25pZnlpbmdHbGFzc1pvb21CdXR0b25Hcm91cH0gLSBob3Jpem9udGFsIHpvb20gYnV0dG9uc1xyXG4gICAgY29uc3QgaG9yaXpvbnRhbFpvb21CdXR0b25Hcm91cCA9IG5ldyBNYWduaWZ5aW5nR2xhc3Nab29tQnV0dG9uR3JvdXAoIHRoaXMuYXhlcy5ob3Jpem9udGFsWm9vbVByb3BlcnR5LCB7XHJcbiAgICAgIGFwcGx5Wm9vbUluOiB6b29tID0+IHpvb20gLyB0aGlzLmF4ZXMuaG9yaXpvbnRhbFpvb21TY2FsZSxcclxuICAgICAgYXBwbHlab29tT3V0OiB6b29tID0+IHpvb20gKiB0aGlzLmF4ZXMuaG9yaXpvbnRhbFpvb21TY2FsZSxcclxuICAgICAgc3BhY2luZzogWk9PTV9CVVRUT05fU1BBQ0lORyxcclxuICAgICAgYnV0dG9uT3B0aW9uczoge1xyXG4gICAgICAgIGJhc2VDb2xvcjogQ29sb3JDb25zdGFudHMuTElHSFRfQkxVRSxcclxuICAgICAgICB0b3VjaEFyZWFYRGlsYXRpb246IDUsXHJcbiAgICAgICAgdG91Y2hBcmVhWURpbGF0aW9uOiA1XHJcbiAgICAgIH0sXHJcbiAgICAgIG1hZ25pZnlpbmdHbGFzc05vZGVPcHRpb25zOiB7XHJcbiAgICAgICAgZ2xhc3NSYWRpdXM6IFpPT01fQlVUVE9OX0lDT05fUkFESVVTXHJcbiAgICAgIH0sXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnaG9yaXpvbnRhbFpvb21CdXR0b25Hcm91cCcgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEBwcml2YXRlIHtNYWduaWZ5aW5nR2xhc3Nab29tQnV0dG9uR3JvdXB9IC0gdmVydGljYWwgem9vbSBidXR0b25zXHJcbiAgICBjb25zdCB2ZXJ0aWNhbFpvb21CdXR0b25Hcm91cCA9IG5ldyBNYWduaWZ5aW5nR2xhc3Nab29tQnV0dG9uR3JvdXAoIHRoaXMuYXhlcy52ZXJ0aWNhbFpvb21Qcm9wZXJ0eSwge1xyXG4gICAgICBhcHBseVpvb21Jbjogem9vbSA9PiB6b29tIC8gdGhpcy5heGVzLnZlcnRpY2FsWm9vbVNjYWxlLFxyXG4gICAgICBhcHBseVpvb21PdXQ6IHpvb20gPT4gem9vbSAqIHRoaXMuYXhlcy52ZXJ0aWNhbFpvb21TY2FsZSxcclxuICAgICAgc3BhY2luZzogWk9PTV9CVVRUT05fU1BBQ0lORyxcclxuICAgICAgYnV0dG9uT3B0aW9uczoge1xyXG4gICAgICAgIGJhc2VDb2xvcjogQ29sb3JDb25zdGFudHMuTElHSFRfQkxVRSxcclxuICAgICAgICB0b3VjaEFyZWFYRGlsYXRpb246IDUsXHJcbiAgICAgICAgdG91Y2hBcmVhWURpbGF0aW9uOiA1XHJcbiAgICAgIH0sXHJcbiAgICAgIG1hZ25pZnlpbmdHbGFzc05vZGVPcHRpb25zOiB7XHJcbiAgICAgICAgZ2xhc3NSYWRpdXM6IFpPT01fQlVUVE9OX0lDT05fUkFESVVTXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBwaGV0LWlvXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAndmVydGljYWxab29tQnV0dG9uR3JvdXAnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBMaW5rcyBkaWZmZXJlbnQgcGFydHMgb2YgR3JhcGhEcmF3aW5nTm9kZSB0byB1cGRhdGUgd2hlbmV2ZXIgc3BlY2lmaWVkIHRyYWNrZWQgUHJvcGVydGllcyBjaGFuZ2VcclxuICAgIGNvbnN0IHVwZGF0ZU1haW5HcmFwaEFuZExheW91dCA9ICgpID0+IHtcclxuICAgICAgdGhpcy51cGRhdGUoKTtcclxuICAgICAgdGhpcy5tb3ZlTWFpbkdyYXBoVG9Gcm9udCgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHVwZGF0ZVNhdmVkR3JhcGhBbmRMYXlvdXQgPSAoKSA9PiB7XHJcbiAgICAgIHRoaXMudXBkYXRlU2F2ZWRHcmFwaFBhdGhzKCk7XHJcbiAgICAgIHRoaXMubW92ZVNhdmVkR3JhcGhUb0Zyb250KCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgdXBkYXRlQWxsR3JhcGhzID0gKCkgPT4ge1xyXG4gICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgICB0aGlzLnVwZGF0ZVNhdmVkR3JhcGhQYXRocygpO1xyXG4gICAgfTtcclxuICAgIG1vZGVsLm1haW5Cb2R5LnRlbXBlcmF0dXJlUHJvcGVydHkubGluayggdXBkYXRlTWFpbkdyYXBoQW5kTGF5b3V0ICk7XHJcbiAgICBtb2RlbC5zYXZlZEJvZHlPbmUudGVtcGVyYXR1cmVQcm9wZXJ0eS5saW5rKCB1cGRhdGVTYXZlZEdyYXBoQW5kTGF5b3V0ICk7XHJcbiAgICBtb2RlbC5zYXZlZEJvZHlUd28udGVtcGVyYXR1cmVQcm9wZXJ0eS5saW5rKCB1cGRhdGVTYXZlZEdyYXBoQW5kTGF5b3V0ICk7XHJcbiAgICB0aGlzLmF4ZXMuaG9yaXpvbnRhbFpvb21Qcm9wZXJ0eS5saW5rKCB1cGRhdGVBbGxHcmFwaHMgKTtcclxuICAgIHRoaXMuYXhlcy52ZXJ0aWNhbFpvb21Qcm9wZXJ0eS5saW5rKCB1cGRhdGVBbGxHcmFwaHMgKTtcclxuXHJcbiAgICAvLyBTZXRzIGxheW91dCBvZiBncmFwaCBub2RlIGVsZW1lbnRzIHRvIGJlIGFsbCB1bHRpbWF0ZWx5IHJlbGF0aXZlIHRvIHRoZSBheGVzXHJcbiAgICBjb25zdCBheGVzUGF0aCA9IHRoaXMuYXhlcy5heGVzUGF0aDtcclxuICAgIGhvcml6b250YWxab29tQnV0dG9uR3JvdXAuY2VudGVyWCA9IGF4ZXNQYXRoLnJpZ2h0ICsgWk9PTV9CVVRUT05fSUNPTl9SQURJVVM7XHJcbiAgICBob3Jpem9udGFsWm9vbUJ1dHRvbkdyb3VwLnRvcCA9IGF4ZXNQYXRoLmJvdHRvbSArIFpPT01fQlVUVE9OX0FYRVNfTUFSR0lOO1xyXG4gICAgdmVydGljYWxab29tQnV0dG9uR3JvdXAuY2VudGVyWCA9IGF4ZXNQYXRoLmxlZnQgLSBaT09NX0JVVFRPTl9JQ09OX1JBRElVUyAqIDI7XHJcbiAgICB2ZXJ0aWNhbFpvb21CdXR0b25Hcm91cC5ib3R0b20gPSBheGVzUGF0aC50b3AgLSBaT09NX0JVVFRPTl9BWEVTX01BUkdJTjtcclxuICAgIHRoaXMud2F2ZWxlbmd0aFNwZWN0cnVtTm9kZS5jZW50ZXJZID0gYXhlc1BhdGguY2VudGVyWTtcclxuICAgIHRoaXMud2F2ZWxlbmd0aFNwZWN0cnVtTm9kZS5sZWZ0ID0gdWx0cmF2aW9sZXRQb3NpdGlvbjtcclxuXHJcbiAgICAvLyBBZGRzIGNoaWxkcmVuIGluIHJlbmRlcmluZyBvcmRlclxyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5pbm5lckdyYXBoVW5kZXJBeGVzICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLmF4ZXMgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGhvcml6b250YWxab29tQnV0dG9uR3JvdXAgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHZlcnRpY2FsWm9vbUJ1dHRvbkdyb3VwICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLmlubmVyR3JhcGhPdmVyQXhlcyApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5kcmFnZ2FibGVQb2ludE5vZGUgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc2V0IFByb3BlcnRpZXMgYXNzb2NpYXRlZCB3aXRoIHRoaXMgTm9kZVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICByZXNldCgpIHtcclxuICAgIHRoaXMuYXhlcy5yZXNldCgpO1xyXG4gICAgdGhpcy5kcmFnZ2FibGVQb2ludE5vZGUucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldHMgdGhlIHNoYXBlIG9mIGEgZ2l2ZW4gQmxhY2tib2R5Qm9keU1vZGVsXHJcbiAgICogQHBhcmFtIHtCbGFja2JvZHlCb2R5TW9kZWx9IGJvZHlcclxuICAgKiBAcmV0dXJucyB7U2hhcGV9XHJcbiAgICogQHByaXZhdGVcclxuICAgKi9cclxuICBzaGFwZU9mQm9keSggYm9keSApIHtcclxuICAgIGNvbnN0IGdyYXBoU2hhcGUgPSBuZXcgU2hhcGUoKTtcclxuICAgIGNvbnN0IGRlbHRhV2F2ZWxlbmd0aCA9IHRoaXMubW9kZWwud2F2ZWxlbmd0aE1heCAvICggR1JBUEhfTlVNQkVSX1BPSU5UUyAtIDEgKTtcclxuICAgIGNvbnN0IHBvaW50c1hPZmZzZXQgPSB0aGlzLmF4ZXMuaG9yaXpvbnRhbEF4aXNMZW5ndGggLyAoIEdSQVBIX05VTUJFUl9QT0lOVFMgLSAxICk7XHJcbiAgICBjb25zdCB5Q3V0b2ZmID0gdGhpcy5heGVzLnZlcnRpY2FsQXhpc0xlbmd0aCArIHRoaXMubWFpbkdyYXBoLmxpbmVXaWR0aDtcclxuICAgIGNvbnN0IHBlYWtXYXZlbGVuZ3RoID0gYm9keS5wZWFrV2F2ZWxlbmd0aDtcclxuICAgIGxldCBmaW5kaW5nUGVhayA9IHRydWU7XHJcbiAgICBncmFwaFNoYXBlLm1vdmVUbyggMCwgMCApO1xyXG4gICAgZm9yICggbGV0IGkgPSAxOyBpIDwgR1JBUEhfTlVNQkVSX1BPSU5UUzsgaSsrICkge1xyXG4gICAgICBpZiAoIGRlbHRhV2F2ZWxlbmd0aCAqIGkgPiBwZWFrV2F2ZWxlbmd0aCAmJiBmaW5kaW5nUGVhayApIHtcclxuXHJcbiAgICAgICAgLy8gRm9yY2UgcGVhayB3YXZlbGVuZ3RoIHBvaW50IHRvIGJlIGFkZGVkXHJcbiAgICAgICAgY29uc3QgeU1heCA9IHRoaXMuYXhlcy5zcGVjdHJhbFBvd2VyRGVuc2l0eVRvVmlld1koIGJvZHkuZ2V0U3BlY3RyYWxQb3dlckRlbnNpdHlBdCggcGVha1dhdmVsZW5ndGggKSApO1xyXG4gICAgICAgIGdyYXBoU2hhcGUubGluZVRvKCB0aGlzLmF4ZXMud2F2ZWxlbmd0aFRvVmlld1goIHBlYWtXYXZlbGVuZ3RoICksIHlNYXggPCAteUN1dG9mZiA/IC15Q3V0b2ZmIDogeU1heCApO1xyXG4gICAgICAgIGZpbmRpbmdQZWFrID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgeSA9IHRoaXMuYXhlcy5zcGVjdHJhbFBvd2VyRGVuc2l0eVRvVmlld1koIGJvZHkuZ2V0U3BlY3RyYWxQb3dlckRlbnNpdHlBdCggZGVsdGFXYXZlbGVuZ3RoICogaSApICk7XHJcbiAgICAgIGdyYXBoU2hhcGUubGluZVRvKCBwb2ludHNYT2Zmc2V0ICogaSwgeSA8IC15Q3V0b2ZmID8gLXlDdXRvZmYgOiB5ICk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZ3JhcGhTaGFwZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZXMgdGhlIHNhdmVkIGFuZCBtYWluIGdyYXBoIHBhdGhzIGFzIHdlbGwgYXMgdGhlaXIgY29ycmVzcG9uZGluZyB0ZXh0IGJveGVzIG9yIGludGVuc2l0eSBwYXRoc1xyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgdXBkYXRlR3JhcGhQYXRocygpIHtcclxuICAgIC8vIFVwZGF0ZXMgdGhlIG1haW4gZ3JhcGhcclxuICAgIGNvbnN0IHVwZGF0ZWRHcmFwaFNoYXBlID0gdGhpcy5zaGFwZU9mQm9keSggdGhpcy5tb2RlbC5tYWluQm9keSApO1xyXG4gICAgdGhpcy5tYWluR3JhcGguc2hhcGUgPSB1cGRhdGVkR3JhcGhTaGFwZTtcclxuXHJcbiAgICAvLyBFYXNpZXN0IHdheSB0byBpbXBsZW1lbnQgaW50ZW5zaXR5IHNoYXBlIGlzIHRvIGNvcHkgZ3JhcGggc2hhcGUgYW5kIGJyaW5nIGRvd24gdG8geC1heGlzXHJcbiAgICB0aGlzLmludGVuc2l0eVBhdGguc2hhcGUgPSB1cGRhdGVkR3JhcGhTaGFwZS5jb3B5KCk7XHJcbiAgICBjb25zdCBuZXdQb2ludCA9IG5ldyBWZWN0b3IyKCB0aGlzLmF4ZXMuaG9yaXpvbnRhbEF4aXNMZW5ndGgsIDAgKTtcclxuICAgIGlmICggdGhpcy5pbnRlbnNpdHlQYXRoLnNoYXBlLmdldExhc3RQb2ludCgpLm1pbnVzKCBuZXdQb2ludCApLm1hZ25pdHVkZSA+IDAgKSB7XHJcbiAgICAgIHRoaXMuaW50ZW5zaXR5UGF0aC5zaGFwZS5saW5lVG9Qb2ludCggbmV3UG9pbnQgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE1vdmUgdGhlIG1haW4gZ3JhcGggdG8gdGhlIGZyb250IG9mIHRoZSBzY2VuZVxyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgbW92ZU1haW5HcmFwaFRvRnJvbnQoKSB7XHJcbiAgICB0aGlzLm1haW5HcmFwaC5tb3ZlVG9Gcm9udCgpO1xyXG4gICAgdGhpcy5kcmFnZ2FibGVQb2ludE5vZGUubW92ZVRvRnJvbnQoKTtcclxuXHJcbiAgICAvLyBSZXNldCBzYXZlZCBncmFwaHMgYmFjayB0byBkZWZhdWx0IHdpZHRoXHJcbiAgICB0aGlzLnByaW1hcnlTYXZlZEdyYXBoLmxpbmVXaWR0aCA9IERFRkFVTFRfTElORV9XSURUSDtcclxuICAgIHRoaXMuc2Vjb25kYXJ5U2F2ZWRHcmFwaC5saW5lV2lkdGggPSBERUZBVUxUX0xJTkVfV0lEVEg7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGVzIHRoZSBzYXZlZCBncmFwaCBwYXRoc1xyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgdXBkYXRlU2F2ZWRHcmFwaFBhdGhzKCkge1xyXG4gICAgLy8gVXBkYXRlcyB0aGUgc2F2ZWQgZ3JhcGgocylcclxuICAgIHRoaXMucHJpbWFyeVNhdmVkR3JhcGguc2hhcGUgPSBudWxsO1xyXG4gICAgdGhpcy5zZWNvbmRhcnlTYXZlZEdyYXBoLnNoYXBlID0gbnVsbDtcclxuICAgIGlmICggdGhpcy5tb2RlbC5zYXZlZEJvZHlPbmUudGVtcGVyYXR1cmVQcm9wZXJ0eS52YWx1ZSAhPT0gbnVsbCApIHtcclxuICAgICAgdGhpcy5wcmltYXJ5U2F2ZWRHcmFwaC5zaGFwZSA9IHRoaXMuc2hhcGVPZkJvZHkoIHRoaXMubW9kZWwuc2F2ZWRCb2R5T25lICk7XHJcbiAgICAgIGlmICggdGhpcy5tb2RlbC5zYXZlZEJvZHlUd28udGVtcGVyYXR1cmVQcm9wZXJ0eS52YWx1ZSAhPT0gbnVsbCApIHtcclxuICAgICAgICB0aGlzLnNlY29uZGFyeVNhdmVkR3JhcGguc2hhcGUgPSB0aGlzLnNoYXBlT2ZCb2R5KCB0aGlzLm1vZGVsLnNhdmVkQm9keVR3byApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNb3ZlIHRoZSBsYXRlc3Qgc2F2ZWQgZ3JhcGggdG8gdGhlIGZyb250IG9mIHRoZSBzY2VuZVxyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgbW92ZVNhdmVkR3JhcGhUb0Zyb250KCkge1xyXG4gICAgdGhpcy5wcmltYXJ5U2F2ZWRHcmFwaC5tb3ZlVG9Gcm9udCgpO1xyXG5cclxuICAgIC8vIEFsc28gc2V0IG5ld2x5IGNyZWF0ZWQgZ3JhcGggdG8gc21hbGxlciBzaXplIHRvIGJlIHZpc2libGUgaW4gZnJvbnQgb2YgbWFpbiBncmFwaFxyXG4gICAgdGhpcy5wcmltYXJ5U2F2ZWRHcmFwaC5saW5lV2lkdGggPSBPVkVSTEFJRF9MSU5FX1dJRFRIO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQSBtZXRob2QgdGhhdCB1cGRhdGVzIHRoZSB2aXNpYmxlIHNwZWN0cnVtIHJhaW5ib3cgbm9kZSB0byBiZSBpbiB0aGUgY29ycmVjdCBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGUgYXhlc1xyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgdXBkYXRlVmlzaWJsZVNwZWN0cnVtTm9kZSgpIHtcclxuICAgIGNvbnN0IGluZnJhcmVkUG9zaXRpb24gPSB0aGlzLmF4ZXMud2F2ZWxlbmd0aFRvVmlld1goIEJsYWNrYm9keUNvbnN0YW50cy52aXNpYmxlV2F2ZWxlbmd0aCApO1xyXG4gICAgY29uc3QgdWx0cmF2aW9sZXRQb3NpdGlvbiA9IHRoaXMuYXhlcy53YXZlbGVuZ3RoVG9WaWV3WCggQmxhY2tib2R5Q29uc3RhbnRzLnVsdHJhdmlvbGV0V2F2ZWxlbmd0aCApO1xyXG4gICAgY29uc3Qgc3BlY3RydW1XaWR0aCA9IGluZnJhcmVkUG9zaXRpb24gLSB1bHRyYXZpb2xldFBvc2l0aW9uO1xyXG4gICAgdGhpcy53YXZlbGVuZ3RoU3BlY3RydW1Ob2RlLmxlZnQgPSB1bHRyYXZpb2xldFBvc2l0aW9uO1xyXG4gICAgdGhpcy53YXZlbGVuZ3RoU3BlY3RydW1Ob2RlLnNjYWxlKCBuZXcgVmVjdG9yMiggc3BlY3RydW1XaWR0aCAvIHRoaXMud2F2ZWxlbmd0aFNwZWN0cnVtTm9kZS53aWR0aCwgMSApICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGVzIGV2ZXJ5dGhpbmcgaW4gdGhlIGdyYXBoIGRyYXdpbmcgbm9kZVxyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgdXBkYXRlKCkge1xyXG4gICAgdGhpcy51cGRhdGVHcmFwaFBhdGhzKCk7XHJcbiAgICB0aGlzLmRyYWdnYWJsZVBvaW50Tm9kZS51cGRhdGUoKTtcclxuICAgIHRoaXMuYXhlcy51cGRhdGUoKTtcclxuICAgIHRoaXMudXBkYXRlVmlzaWJsZVNwZWN0cnVtTm9kZSgpO1xyXG4gIH1cclxufVxyXG5cclxuYmxhY2tib2R5U3BlY3RydW0ucmVnaXN0ZXIoICdHcmFwaERyYXdpbmdOb2RlJywgR3JhcGhEcmF3aW5nTm9kZSApO1xyXG5l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