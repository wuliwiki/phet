// Copyright 2023, University of Colorado Boulder

/**
 * Box that shows the length of distances available in the sim:
 *  - d1 and d2: Focal strings' lengths from the sun and secondary focus to the planet
 *  - R: Distance from the sun to the planet (circular orbit)
 *  - a: Semi-major axis of the ellipse
 *
 * @author AgustÃ­n Vallejo
 */

import { HBox, Path, RichText, VBox } from '../../../../scenery/js/imports.js';
import LineArrowNode from '../../../../scenery-phet/js/LineArrowNode.js';
import SolarSystemCommonConstants from '../../../../solar-system-common/js/SolarSystemCommonConstants.js';
import { combineOptions } from '../../../../phet-core/js/optionize.js';
import KeplersLawsStrings from '../../../../keplers-laws/js/KeplersLawsStrings.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import { Shape } from '../../../../kite/js/imports.js';
import keplersLaws from '../../keplersLaws.js';
import Multilink from '../../../../axon/js/Multilink.js';
export const DISTANCE_LABEL_OPTIONS = combineOptions({}, SolarSystemCommonConstants.TEXT_OPTIONS, {
  scale: 1.5,
  stroke: '#ccb285',
  fill: '#ccb285'
});
export const AXIS_LABEL_OPTIONS = combineOptions({}, SolarSystemCommonConstants.TEXT_OPTIONS, {
  scale: 1.5,
  stroke: 'orange',
  fill: 'orange'
});
export const STRING_ARROW_OPTIONS = {
  stroke: '#ccb285',
  headHeight: 10,
  headWidth: 10,
  headLineWidth: 3,
  tailLineWidth: 3,
  tailLineDash: [10, 2],
  lineWidth: 3 // See note below
};

export const MAJOR_AXIS_ARROW_OPTIONS = {
  stroke: 'orange',
  fill: 'orange',
  headHeight: 10,
  headWidth: 10,
  headLineWidth: 3,
  tailLineWidth: 3,
  lineWidth: 3 // See note below
};

// Note: lineWidth is not supported by LineArrowNode but it is supported by Path.
// This is a workaround to use the same arrow options in the butts to make it
// Look like a DimensionalArrowNode (which is not yet implemented in common code)

export default class DistancesDisplayNode extends VBox {
  constructor(model, modelViewTransformProperty) {
    super({
      spacing: 10,
      visibleProperty: DerivedProperty.and([model.stringsVisibleProperty, model.engine.allowedOrbitProperty])
    });
    this.modelViewTransformProperty = modelViewTransformProperty;
    this.orbit = model.engine;
    const stringLabelNode1 = new RichText('', DISTANCE_LABEL_OPTIONS);
    const stringLabelNode2 = new RichText('', DISTANCE_LABEL_OPTIONS);
    const d1lineArrowNode = new LineArrowNode(0, 0, 0, 1, STRING_ARROW_OPTIONS);
    const d2lineArrowNode = new LineArrowNode(0, 0, 0, 1, STRING_ARROW_OPTIONS);
    d1lineArrowNode.addChild(new Path(new Shape().moveTo(0, -5).lineTo(0, 5), STRING_ARROW_OPTIONS));
    d2lineArrowNode.addChild(new Path(new Shape().moveTo(0, -5).lineTo(0, 5), STRING_ARROW_OPTIONS));
    const aLineArrowNode1 = new LineArrowNode(0, 0, 0, 1, MAJOR_AXIS_ARROW_OPTIONS);
    const aLineArrowNode2 = new LineArrowNode(0, 0, 0, 1, MAJOR_AXIS_ARROW_OPTIONS);
    aLineArrowNode1.addChild(new Path(new Shape().moveTo(0, -5).lineTo(0, 5), MAJOR_AXIS_ARROW_OPTIONS));
    aLineArrowNode2.addChild(new Path(new Shape().moveTo(0, -5).lineTo(0, 5), MAJOR_AXIS_ARROW_OPTIONS));
    const focalStringsBox = new HBox({
      children: [new VBox({
        children: [stringLabelNode1, d1lineArrowNode]
      }), new VBox({
        children: [stringLabelNode2, d2lineArrowNode]
      })]
    });
    const majorAxisBox = new HBox({
      children: [new VBox({
        children: [aLineArrowNode1, new RichText(KeplersLawsStrings.symbols.semiMajorAxisStringProperty, AXIS_LABEL_OPTIONS)]
      }), new VBox({
        children: [aLineArrowNode2, new RichText(KeplersLawsStrings.symbols.semiMajorAxisStringProperty, AXIS_LABEL_OPTIONS)]
      })]
    });
    this.children = [focalStringsBox, majorAxisBox];
    const updateDistances = () => {
      const scale = this.modelViewTransformProperty.value.modelToViewDeltaX(1);
      const aLength = this.orbit.a * scale;
      const d1Length = this.orbit.d1 * scale;
      const d2Length = this.orbit.d2 * scale;
      const rString = KeplersLawsStrings.symbols.radiusStringProperty.value;
      const d1String = KeplersLawsStrings.symbols.distance1StringProperty.value;
      const d2String = KeplersLawsStrings.symbols.distance2StringProperty.value;
      stringLabelNode1.setString(this.orbit.isCircularProperty.value ? rString : d1String);
      stringLabelNode2.setString(this.orbit.isCircularProperty.value ? rString : d2String);
      stringLabelNode1.x = -d2Length / 2;
      stringLabelNode2.x = d1Length / 2;
      const dx = 3; // reducing the arrow length a bit to get the proper measurable length in screen

      d1lineArrowNode.setTailAndTip(0, 0, d1Length - dx, 0);
      d2lineArrowNode.setTailAndTip(0, 0, -d2Length + dx, 0);
      aLineArrowNode1.setTailAndTip(0, 0, aLength - dx, 0);
      aLineArrowNode2.setTailAndTip(0, 0, -aLength + dx, 0);
    };
    Multilink.multilink([KeplersLawsStrings.symbols.radiusStringProperty, KeplersLawsStrings.symbols.distance1StringProperty, KeplersLawsStrings.symbols.distance2StringProperty], updateDistances);
    this.orbit.changedEmitter.addListener(updateDistances);
  }
}
keplersLaws.register('DistancesDisplayNode', DistancesDisplayNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJIQm94IiwiUGF0aCIsIlJpY2hUZXh0IiwiVkJveCIsIkxpbmVBcnJvd05vZGUiLCJTb2xhclN5c3RlbUNvbW1vbkNvbnN0YW50cyIsImNvbWJpbmVPcHRpb25zIiwiS2VwbGVyc0xhd3NTdHJpbmdzIiwiRGVyaXZlZFByb3BlcnR5IiwiU2hhcGUiLCJrZXBsZXJzTGF3cyIsIk11bHRpbGluayIsIkRJU1RBTkNFX0xBQkVMX09QVElPTlMiLCJURVhUX09QVElPTlMiLCJzY2FsZSIsInN0cm9rZSIsImZpbGwiLCJBWElTX0xBQkVMX09QVElPTlMiLCJTVFJJTkdfQVJST1dfT1BUSU9OUyIsImhlYWRIZWlnaHQiLCJoZWFkV2lkdGgiLCJoZWFkTGluZVdpZHRoIiwidGFpbExpbmVXaWR0aCIsInRhaWxMaW5lRGFzaCIsImxpbmVXaWR0aCIsIk1BSk9SX0FYSVNfQVJST1dfT1BUSU9OUyIsIkRpc3RhbmNlc0Rpc3BsYXlOb2RlIiwiY29uc3RydWN0b3IiLCJtb2RlbCIsIm1vZGVsVmlld1RyYW5zZm9ybVByb3BlcnR5Iiwic3BhY2luZyIsInZpc2libGVQcm9wZXJ0eSIsImFuZCIsInN0cmluZ3NWaXNpYmxlUHJvcGVydHkiLCJlbmdpbmUiLCJhbGxvd2VkT3JiaXRQcm9wZXJ0eSIsIm9yYml0Iiwic3RyaW5nTGFiZWxOb2RlMSIsInN0cmluZ0xhYmVsTm9kZTIiLCJkMWxpbmVBcnJvd05vZGUiLCJkMmxpbmVBcnJvd05vZGUiLCJhZGRDaGlsZCIsIm1vdmVUbyIsImxpbmVUbyIsImFMaW5lQXJyb3dOb2RlMSIsImFMaW5lQXJyb3dOb2RlMiIsImZvY2FsU3RyaW5nc0JveCIsImNoaWxkcmVuIiwibWFqb3JBeGlzQm94Iiwic3ltYm9scyIsInNlbWlNYWpvckF4aXNTdHJpbmdQcm9wZXJ0eSIsInVwZGF0ZURpc3RhbmNlcyIsInZhbHVlIiwibW9kZWxUb1ZpZXdEZWx0YVgiLCJhTGVuZ3RoIiwiYSIsImQxTGVuZ3RoIiwiZDEiLCJkMkxlbmd0aCIsImQyIiwiclN0cmluZyIsInJhZGl1c1N0cmluZ1Byb3BlcnR5IiwiZDFTdHJpbmciLCJkaXN0YW5jZTFTdHJpbmdQcm9wZXJ0eSIsImQyU3RyaW5nIiwiZGlzdGFuY2UyU3RyaW5nUHJvcGVydHkiLCJzZXRTdHJpbmciLCJpc0NpcmN1bGFyUHJvcGVydHkiLCJ4IiwiZHgiLCJzZXRUYWlsQW5kVGlwIiwibXVsdGlsaW5rIiwiY2hhbmdlZEVtaXR0ZXIiLCJhZGRMaXN0ZW5lciIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRGlzdGFuY2VzRGlzcGxheU5vZGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEJveCB0aGF0IHNob3dzIHRoZSBsZW5ndGggb2YgZGlzdGFuY2VzIGF2YWlsYWJsZSBpbiB0aGUgc2ltOlxyXG4gKiAgLSBkMSBhbmQgZDI6IEZvY2FsIHN0cmluZ3MnIGxlbmd0aHMgZnJvbSB0aGUgc3VuIGFuZCBzZWNvbmRhcnkgZm9jdXMgdG8gdGhlIHBsYW5ldFxyXG4gKiAgLSBSOiBEaXN0YW5jZSBmcm9tIHRoZSBzdW4gdG8gdGhlIHBsYW5ldCAoY2lyY3VsYXIgb3JiaXQpXHJcbiAqICAtIGE6IFNlbWktbWFqb3IgYXhpcyBvZiB0aGUgZWxsaXBzZVxyXG4gKlxyXG4gKiBAYXV0aG9yIEFndXN0w61uIFZhbGxlam9cclxuICovXHJcblxyXG5pbXBvcnQgeyBIQm94LCBQYXRoLCBSaWNoVGV4dCwgVGV4dE9wdGlvbnMsIFZCb3ggfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgS2VwbGVyc0xhd3NNb2RlbCBmcm9tICcuLi9tb2RlbC9LZXBsZXJzTGF3c01vZGVsLmpzJztcclxuaW1wb3J0IEVsbGlwdGljYWxPcmJpdEVuZ2luZSBmcm9tICcuLi9tb2RlbC9FbGxpcHRpY2FsT3JiaXRFbmdpbmUuanMnO1xyXG5pbXBvcnQgTGluZUFycm93Tm9kZSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvTGluZUFycm93Tm9kZS5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMgZnJvbSAnLi4vLi4vLi4vLi4vc29sYXItc3lzdGVtLWNvbW1vbi9qcy9Tb2xhclN5c3RlbUNvbW1vbkNvbnN0YW50cy5qcyc7XHJcbmltcG9ydCB7IGNvbWJpbmVPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBLZXBsZXJzTGF3c1N0cmluZ3MgZnJvbSAnLi4vLi4vLi4vLi4va2VwbGVycy1sYXdzL2pzL0tlcGxlcnNMYXdzU3RyaW5ncy5qcyc7XHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBrZXBsZXJzTGF3cyBmcm9tICcuLi8uLi9rZXBsZXJzTGF3cy5qcyc7XHJcbmltcG9ydCBNdWx0aWxpbmsgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9NdWx0aWxpbmsuanMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IERJU1RBTkNFX0xBQkVMX09QVElPTlMgPSBjb21iaW5lT3B0aW9uczxUZXh0T3B0aW9ucz4oIHt9LCBTb2xhclN5c3RlbUNvbW1vbkNvbnN0YW50cy5URVhUX09QVElPTlMsIHtcclxuICBzY2FsZTogMS41LFxyXG4gIHN0cm9rZTogJyNjY2IyODUnLFxyXG4gIGZpbGw6ICcjY2NiMjg1J1xyXG59ICk7XHJcblxyXG5leHBvcnQgY29uc3QgQVhJU19MQUJFTF9PUFRJT05TID0gY29tYmluZU9wdGlvbnM8VGV4dE9wdGlvbnM+KCB7fSwgU29sYXJTeXN0ZW1Db21tb25Db25zdGFudHMuVEVYVF9PUFRJT05TLCB7XHJcbiAgc2NhbGU6IDEuNSxcclxuICBzdHJva2U6ICdvcmFuZ2UnLFxyXG4gIGZpbGw6ICdvcmFuZ2UnXHJcbn0gKTtcclxuXHJcbmV4cG9ydCBjb25zdCBTVFJJTkdfQVJST1dfT1BUSU9OUyA9IHtcclxuICBzdHJva2U6ICcjY2NiMjg1JyxcclxuICBoZWFkSGVpZ2h0OiAxMCxcclxuICBoZWFkV2lkdGg6IDEwLFxyXG4gIGhlYWRMaW5lV2lkdGg6IDMsXHJcbiAgdGFpbExpbmVXaWR0aDogMyxcclxuICB0YWlsTGluZURhc2g6IFsgMTAsIDIgXSxcclxuICBsaW5lV2lkdGg6IDMgLy8gU2VlIG5vdGUgYmVsb3dcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBNQUpPUl9BWElTX0FSUk9XX09QVElPTlMgPSB7XHJcbiAgc3Ryb2tlOiAnb3JhbmdlJyxcclxuICBmaWxsOiAnb3JhbmdlJyxcclxuICBoZWFkSGVpZ2h0OiAxMCxcclxuICBoZWFkV2lkdGg6IDEwLFxyXG4gIGhlYWRMaW5lV2lkdGg6IDMsXHJcbiAgdGFpbExpbmVXaWR0aDogMyxcclxuICBsaW5lV2lkdGg6IDMgLy8gU2VlIG5vdGUgYmVsb3dcclxufTtcclxuXHJcbi8vIE5vdGU6IGxpbmVXaWR0aCBpcyBub3Qgc3VwcG9ydGVkIGJ5IExpbmVBcnJvd05vZGUgYnV0IGl0IGlzIHN1cHBvcnRlZCBieSBQYXRoLlxyXG4vLyBUaGlzIGlzIGEgd29ya2Fyb3VuZCB0byB1c2UgdGhlIHNhbWUgYXJyb3cgb3B0aW9ucyBpbiB0aGUgYnV0dHMgdG8gbWFrZSBpdFxyXG4vLyBMb29rIGxpa2UgYSBEaW1lbnNpb25hbEFycm93Tm9kZSAod2hpY2ggaXMgbm90IHlldCBpbXBsZW1lbnRlZCBpbiBjb21tb24gY29kZSlcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERpc3RhbmNlc0Rpc3BsYXlOb2RlIGV4dGVuZHMgVkJveCB7XHJcbiAgcHVibGljIG9yYml0OiBFbGxpcHRpY2FsT3JiaXRFbmdpbmU7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihcclxuICAgIG1vZGVsOiBLZXBsZXJzTGF3c01vZGVsLFxyXG4gICAgcHVibGljIG1vZGVsVmlld1RyYW5zZm9ybVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxNb2RlbFZpZXdUcmFuc2Zvcm0yPlxyXG4gICkge1xyXG4gICAgc3VwZXIoIHtcclxuICAgICAgc3BhY2luZzogMTAsXHJcbiAgICAgIHZpc2libGVQcm9wZXJ0eTogRGVyaXZlZFByb3BlcnR5LmFuZCggWyBtb2RlbC5zdHJpbmdzVmlzaWJsZVByb3BlcnR5LCBtb2RlbC5lbmdpbmUuYWxsb3dlZE9yYml0UHJvcGVydHkgXSApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5vcmJpdCA9IG1vZGVsLmVuZ2luZTtcclxuXHJcbiAgICBjb25zdCBzdHJpbmdMYWJlbE5vZGUxID0gbmV3IFJpY2hUZXh0KCAnJywgRElTVEFOQ0VfTEFCRUxfT1BUSU9OUyApO1xyXG4gICAgY29uc3Qgc3RyaW5nTGFiZWxOb2RlMiA9IG5ldyBSaWNoVGV4dCggJycsIERJU1RBTkNFX0xBQkVMX09QVElPTlMgKTtcclxuXHJcbiAgICBjb25zdCBkMWxpbmVBcnJvd05vZGUgPSBuZXcgTGluZUFycm93Tm9kZSggMCwgMCwgMCwgMSwgU1RSSU5HX0FSUk9XX09QVElPTlMgKTtcclxuICAgIGNvbnN0IGQybGluZUFycm93Tm9kZSA9IG5ldyBMaW5lQXJyb3dOb2RlKCAwLCAwLCAwLCAxLCBTVFJJTkdfQVJST1dfT1BUSU9OUyApO1xyXG4gICAgZDFsaW5lQXJyb3dOb2RlLmFkZENoaWxkKCBuZXcgUGF0aCggbmV3IFNoYXBlKCkubW92ZVRvKCAwLCAtNSApLmxpbmVUbyggMCwgNSApLCBTVFJJTkdfQVJST1dfT1BUSU9OUyApICk7XHJcbiAgICBkMmxpbmVBcnJvd05vZGUuYWRkQ2hpbGQoIG5ldyBQYXRoKCBuZXcgU2hhcGUoKS5tb3ZlVG8oIDAsIC01ICkubGluZVRvKCAwLCA1ICksIFNUUklOR19BUlJPV19PUFRJT05TICkgKTtcclxuXHJcbiAgICBjb25zdCBhTGluZUFycm93Tm9kZTEgPSBuZXcgTGluZUFycm93Tm9kZSggMCwgMCwgMCwgMSwgTUFKT1JfQVhJU19BUlJPV19PUFRJT05TICk7XHJcbiAgICBjb25zdCBhTGluZUFycm93Tm9kZTIgPSBuZXcgTGluZUFycm93Tm9kZSggMCwgMCwgMCwgMSwgTUFKT1JfQVhJU19BUlJPV19PUFRJT05TICk7XHJcbiAgICBhTGluZUFycm93Tm9kZTEuYWRkQ2hpbGQoIG5ldyBQYXRoKCBuZXcgU2hhcGUoKS5tb3ZlVG8oIDAsIC01ICkubGluZVRvKCAwLCA1ICksIE1BSk9SX0FYSVNfQVJST1dfT1BUSU9OUyApICk7XHJcbiAgICBhTGluZUFycm93Tm9kZTIuYWRkQ2hpbGQoIG5ldyBQYXRoKCBuZXcgU2hhcGUoKS5tb3ZlVG8oIDAsIC01ICkubGluZVRvKCAwLCA1ICksIE1BSk9SX0FYSVNfQVJST1dfT1BUSU9OUyApICk7XHJcblxyXG5cclxuICAgIGNvbnN0IGZvY2FsU3RyaW5nc0JveCA9IG5ldyBIQm94KCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgbmV3IFZCb3goIHtcclxuICAgICAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgICAgIHN0cmluZ0xhYmVsTm9kZTEsXHJcbiAgICAgICAgICAgIGQxbGluZUFycm93Tm9kZVxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH0gKSxcclxuICAgICAgICBuZXcgVkJveCgge1xyXG4gICAgICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICAgICAgc3RyaW5nTGFiZWxOb2RlMixcclxuICAgICAgICAgICAgZDJsaW5lQXJyb3dOb2RlXHJcbiAgICAgICAgICBdXHJcbiAgICAgICAgfSApXHJcbiAgICAgIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBtYWpvckF4aXNCb3ggPSBuZXcgSEJveCgge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIG5ldyBWQm94KCB7XHJcbiAgICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgICBhTGluZUFycm93Tm9kZTEsXHJcbiAgICAgICAgICAgIG5ldyBSaWNoVGV4dCggS2VwbGVyc0xhd3NTdHJpbmdzLnN5bWJvbHMuc2VtaU1ham9yQXhpc1N0cmluZ1Byb3BlcnR5LCBBWElTX0xBQkVMX09QVElPTlMgKVxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH0gKSxcclxuICAgICAgICBuZXcgVkJveCgge1xyXG4gICAgICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICAgICAgYUxpbmVBcnJvd05vZGUyLFxyXG4gICAgICAgICAgICBuZXcgUmljaFRleHQoIEtlcGxlcnNMYXdzU3RyaW5ncy5zeW1ib2xzLnNlbWlNYWpvckF4aXNTdHJpbmdQcm9wZXJ0eSwgQVhJU19MQUJFTF9PUFRJT05TIClcclxuICAgICAgICAgIF1cclxuICAgICAgICB9IClcclxuICAgICAgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuY2hpbGRyZW4gPSBbXHJcbiAgICAgIGZvY2FsU3RyaW5nc0JveCxcclxuICAgICAgbWFqb3JBeGlzQm94XHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IHVwZGF0ZURpc3RhbmNlcyA9ICgpID0+IHtcclxuICAgICAgY29uc3Qgc2NhbGUgPSB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybVByb3BlcnR5LnZhbHVlLm1vZGVsVG9WaWV3RGVsdGFYKCAxICk7XHJcbiAgICAgIGNvbnN0IGFMZW5ndGggPSB0aGlzLm9yYml0LmEgKiBzY2FsZTtcclxuICAgICAgY29uc3QgZDFMZW5ndGggPSB0aGlzLm9yYml0LmQxICogc2NhbGU7XHJcbiAgICAgIGNvbnN0IGQyTGVuZ3RoID0gdGhpcy5vcmJpdC5kMiAqIHNjYWxlO1xyXG5cclxuICAgICAgY29uc3QgclN0cmluZyA9IEtlcGxlcnNMYXdzU3RyaW5ncy5zeW1ib2xzLnJhZGl1c1N0cmluZ1Byb3BlcnR5LnZhbHVlO1xyXG4gICAgICBjb25zdCBkMVN0cmluZyA9IEtlcGxlcnNMYXdzU3RyaW5ncy5zeW1ib2xzLmRpc3RhbmNlMVN0cmluZ1Byb3BlcnR5LnZhbHVlO1xyXG4gICAgICBjb25zdCBkMlN0cmluZyA9IEtlcGxlcnNMYXdzU3RyaW5ncy5zeW1ib2xzLmRpc3RhbmNlMlN0cmluZ1Byb3BlcnR5LnZhbHVlO1xyXG5cclxuICAgICAgc3RyaW5nTGFiZWxOb2RlMS5zZXRTdHJpbmcoIHRoaXMub3JiaXQuaXNDaXJjdWxhclByb3BlcnR5LnZhbHVlID8gclN0cmluZyA6IGQxU3RyaW5nICk7XHJcbiAgICAgIHN0cmluZ0xhYmVsTm9kZTIuc2V0U3RyaW5nKCB0aGlzLm9yYml0LmlzQ2lyY3VsYXJQcm9wZXJ0eS52YWx1ZSA/IHJTdHJpbmcgOiBkMlN0cmluZyApO1xyXG5cclxuICAgICAgc3RyaW5nTGFiZWxOb2RlMS54ID0gLWQyTGVuZ3RoIC8gMjtcclxuICAgICAgc3RyaW5nTGFiZWxOb2RlMi54ID0gZDFMZW5ndGggLyAyO1xyXG5cclxuICAgICAgY29uc3QgZHggPSAzOyAvLyByZWR1Y2luZyB0aGUgYXJyb3cgbGVuZ3RoIGEgYml0IHRvIGdldCB0aGUgcHJvcGVyIG1lYXN1cmFibGUgbGVuZ3RoIGluIHNjcmVlblxyXG5cclxuICAgICAgZDFsaW5lQXJyb3dOb2RlLnNldFRhaWxBbmRUaXAoIDAsIDAsIGQxTGVuZ3RoIC0gZHgsIDAgKTtcclxuICAgICAgZDJsaW5lQXJyb3dOb2RlLnNldFRhaWxBbmRUaXAoIDAsIDAsIC1kMkxlbmd0aCArIGR4LCAwICk7XHJcblxyXG4gICAgICBhTGluZUFycm93Tm9kZTEuc2V0VGFpbEFuZFRpcCggMCwgMCwgYUxlbmd0aCAtIGR4LCAwICk7XHJcbiAgICAgIGFMaW5lQXJyb3dOb2RlMi5zZXRUYWlsQW5kVGlwKCAwLCAwLCAtYUxlbmd0aCArIGR4LCAwICk7XHJcbiAgICB9O1xyXG5cclxuICAgIE11bHRpbGluay5tdWx0aWxpbmsoIFtcclxuICAgICAgS2VwbGVyc0xhd3NTdHJpbmdzLnN5bWJvbHMucmFkaXVzU3RyaW5nUHJvcGVydHksXHJcbiAgICAgIEtlcGxlcnNMYXdzU3RyaW5ncy5zeW1ib2xzLmRpc3RhbmNlMVN0cmluZ1Byb3BlcnR5LFxyXG4gICAgICBLZXBsZXJzTGF3c1N0cmluZ3Muc3ltYm9scy5kaXN0YW5jZTJTdHJpbmdQcm9wZXJ0eVxyXG4gICAgXSwgdXBkYXRlRGlzdGFuY2VzICk7XHJcblxyXG4gICAgdGhpcy5vcmJpdC5jaGFuZ2VkRW1pdHRlci5hZGRMaXN0ZW5lciggdXBkYXRlRGlzdGFuY2VzICk7XHJcbiAgfVxyXG59XHJcblxyXG5rZXBsZXJzTGF3cy5yZWdpc3RlciggJ0Rpc3RhbmNlc0Rpc3BsYXlOb2RlJywgRGlzdGFuY2VzRGlzcGxheU5vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBU0EsSUFBSSxFQUFFQyxJQUFJLEVBQUVDLFFBQVEsRUFBZUMsSUFBSSxRQUFRLG1DQUFtQztBQUczRixPQUFPQyxhQUFhLE1BQU0sOENBQThDO0FBR3hFLE9BQU9DLDBCQUEwQixNQUFNLGtFQUFrRTtBQUN6RyxTQUFTQyxjQUFjLFFBQVEsdUNBQXVDO0FBQ3RFLE9BQU9DLGtCQUFrQixNQUFNLG1EQUFtRDtBQUNsRixPQUFPQyxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLFNBQVNDLEtBQUssUUFBUSxnQ0FBZ0M7QUFDdEQsT0FBT0MsV0FBVyxNQUFNLHNCQUFzQjtBQUM5QyxPQUFPQyxTQUFTLE1BQU0sa0NBQWtDO0FBRXhELE9BQU8sTUFBTUMsc0JBQXNCLEdBQUdOLGNBQWMsQ0FBZSxDQUFDLENBQUMsRUFBRUQsMEJBQTBCLENBQUNRLFlBQVksRUFBRTtFQUM5R0Ms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