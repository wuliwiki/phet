// Copyright 2018-2022, University of Colorado Boulder
// @ts-nocheck
/**
 * Shows the semi-transparent graph over the lattice area (when selected).
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import Bounds2 from '../../../../dot/js/Bounds2.js';
import Utils from '../../../../dot/js/Utils.js';
import { Shape } from '../../../../kite/js/imports.js';
import { Line, Node, Path } from '../../../../scenery/js/imports.js';
import waveInterference from '../../waveInterference.js';
import WaveInterferenceConstants from '../WaveInterferenceConstants.js';
import WaveInterferenceUtils from '../WaveInterferenceUtils.js';
import DashedLineNode from './DashedLineNode.js';
import SceneToggleNode from './SceneToggleNode.js';
import WaveInterferenceText from './WaveInterferenceText.js';

// constants
const TEXT_MARGIN_X = 8;
const TEXT_MARGIN_Y = 6;
const getWaterSideShape = WaveInterferenceUtils.getWaterSideShape;

// Curve radius for the roundings on corners and tabs
const RADIUS = 5;
const GRID_LINE_OPTIONS = {
  stroke: 'gray',
  lineWidth: 1,
  lineDash: [4, 4]
};
class WaveAreaGraphNode extends Node {
  constructor(model, waveAreaBounds, options) {
    super();
    const graphWidth = WaveInterferenceConstants.WAVE_AREA_WIDTH;

    // Manually tuned so the graph is the appropriate height.  Note if you adjust graphHeight, you will
    // need to adjust the value of dy (argument to getWaterSideShape) accordingly.
    const graphHeight = WaveInterferenceConstants.WAVE_AREA_WIDTH * 0.3833333333333333;

    // Horizontal Axis Label, which updates when the scene changes.  Uses visibility instead of setChildren so that
    // the bottom tab will fit the largest label.
    const horizontalAxisLabel = new SceneToggleNode(model, scene => new WaveInterferenceText(scene.graphHorizontalAxisLabel));

    // Scene-specific title of the chart.
    const titleNode = new SceneToggleNode(model, scene => new WaveInterferenceText(scene.graphTitle));
    const HORIZONTAL_LABEL_VERTICAL_MARGIN = 2;
    const sampleText = new WaveInterferenceText('1');
    const horizontalLineY = graphHeight - sampleText.height - HORIZONTAL_LABEL_VERTICAL_MARGIN * 2;

    // Create tick labels and grid lines
    const horizontalAxisTickLabels = [];
    const verticalGridLines = [];
    for (let i = 0; i <= 10; i++) {
      const x = Utils.linear(0, 10, 0, graphWidth, i);

      // Find the position of the tick mark in the units of the scene
      const horizontalAxisTickLabel = new SceneToggleNode(model, scene => new WaveInterferenceText(Utils.toFixed(scene.waveAreaWidth * x / graphWidth, 0), {
        centerX: x,
        top: horizontalLineY + HORIZONTAL_LABEL_VERTICAL_MARGIN
      }));
      horizontalAxisTickLabels.push(horizontalAxisTickLabel);
      verticalGridLines.push(new Line(x, horizontalLineY, x, 0, GRID_LINE_OPTIONS));
    }
    const topTabBounds = new Bounds2(graphWidth / 2 - titleNode.width / 2 - TEXT_MARGIN_X, -TEXT_MARGIN_Y - titleNode.height, graphWidth / 2 + titleNode.width / 2 + TEXT_MARGIN_X, 0);
    const bottomTabBounds = new Bounds2(graphWidth / 2 - horizontalAxisLabel.width / 2 - TEXT_MARGIN_X, graphHeight, graphWidth / 2 + horizontalAxisLabel.width / 2 + TEXT_MARGIN_X, graphHeight + TEXT_MARGIN_Y + horizontalAxisLabel.height);
    const lastTickLabel = horizontalAxisTickLabels[horizontalAxisTickLabels.length - 1];
    const tickBubbleXMargin = 2;
    const verticalAxisLabel = new SceneToggleNode(model, scene => new WaveInterferenceText(scene.graphVerticalAxisLabel), {
      rotation: 3 * Math.PI / 2,
      right: -TEXT_MARGIN_Y,
      centerY: graphHeight / 2
    });

    // Nicknames to simplify the rounded corners in the chart
    const UP = 3 * Math.PI / 2;
    const DOWN = Math.PI / 2;
    const RIGHT = 0;
    const LEFT = Math.PI;
    const CLOCKWISE = false;
    const ANTICLOCKWISE = true;
    const outline = new Shape().moveTo(RADIUS, 0) // start at the top left

    // Top tab with title
    .lineTo(topTabBounds.minX - RADIUS, topTabBounds.maxY).arc(topTabBounds.minX - RADIUS, topTabBounds.maxY - RADIUS, RADIUS, DOWN, RIGHT, ANTICLOCKWISE).lineTo(topTabBounds.minX, topTabBounds.minY + RADIUS).arc(topTabBounds.minX + RADIUS, topTabBounds.minY + RADIUS, RADIUS, LEFT, UP, CLOCKWISE).lineTo(topTabBounds.maxX - RADIUS, topTabBounds.minY).arc(topTabBounds.maxX - RADIUS, topTabBounds.minY + RADIUS, RADIUS, UP, RIGHT, CLOCKWISE).lineTo(topTabBounds.maxX, topTabBounds.maxY - RADIUS).arc(topTabBounds.maxX + RADIUS, topTabBounds.maxY - RADIUS, RADIUS, LEFT, DOWN, ANTICLOCKWISE)

    // Right edge, and bubble out around the last horizontal axis tick label
    .lineTo(lastTickLabel.right + tickBubbleXMargin - RADIUS, 0).arc(lastTickLabel.right + tickBubbleXMargin - RADIUS, RADIUS, RADIUS, UP, RIGHT, CLOCKWISE).lineTo(lastTickLabel.right + tickBubbleXMargin, graphHeight - RADIUS).arc(lastTickLabel.right + tickBubbleXMargin - RADIUS, graphHeight - RADIUS, RADIUS, RIGHT, DOWN, CLOCKWISE)

    // Bottom tab with horizontal axis label
    .lineTo(bottomTabBounds.maxX + RADIUS, bottomTabBounds.minY).arc(bottomTabBounds.maxX + RADIUS, bottomTabBounds.minY + RADIUS, RADIUS, UP, LEFT, ANTICLOCKWISE).lineTo(bottomTabBounds.maxX, bottomTabBounds.maxY - RADIUS).arc(bottomTabBounds.maxX - RADIUS, bottomTabBounds.maxY - RADIUS, RADIUS, RIGHT, DOWN, CLOCKWISE).lineTo(bottomTabBounds.minX + RADIUS, bottomTabBounds.maxY).arc(bottomTabBounds.minX + RADIUS, bottomTabBounds.maxY - RADIUS, RADIUS, DOWN, LEFT, CLOCKWISE).lineTo(bottomTabBounds.minX, bottomTabBounds.minY + RADIUS).arc(bottomTabBounds.minX - RADIUS, bottomTabBounds.minY + RADIUS, RADIUS, RIGHT, UP, ANTICLOCKWISE)

    // Left edge, and bubble out around the first horizontal axis tick label
    .lineTo(verticalAxisLabel.left - TEXT_MARGIN_Y + RADIUS, graphHeight).arc(verticalAxisLabel.left - TEXT_MARGIN_Y + RADIUS, graphHeight - RADIUS, RADIUS, DOWN, LEFT, CLOCKWISE).lineTo(verticalAxisLabel.left - TEXT_MARGIN_Y, RADIUS).arc(verticalAxisLabel.left - TEXT_MARGIN_Y + RADIUS, RADIUS, RADIUS, LEFT, UP, CLOCKWISE).close();
    const outlinePath = new Path(outline, {
      lineWidth: 1,
      stroke: 'black',
      fill: 'rgba(230,230,230,0.6)'
    });
    this.addChild(outlinePath);
    horizontalAxisTickLabels.forEach(label => this.addChild(label));
    verticalGridLines.forEach(label => this.addChild(label));
    titleNode.centerX = graphWidth / 2;
    titleNode.bottom = 0;
    this.addChild(titleNode);
    horizontalAxisLabel.centerX = graphWidth / 2;
    horizontalAxisLabel.bottom = outlinePath.bottom - TEXT_MARGIN_Y;
    this.addChild(horizontalAxisLabel);
    const horizontalAxisLine = new Line(0, horizontalLineY, graphWidth, horizontalLineY, {
      stroke: 'darkGray'
    });
    this.addChild(horizontalAxisLine);

    // The part that displays the values (doesn't include axis labels)
    const plotHeight = horizontalLineY;
    this.addChild(new DashedLineNode({
      centerY: plotHeight / 2
    }));

    // Display a minor grid line in the center of the lower and upper halves of the chart.
    [1 / 4, 3 / 4].forEach(horizontalGridLineFraction => {
      this.addChild(new Line(0, horizontalGridLineFraction * plotHeight, graphWidth, horizontalGridLineFraction * plotHeight, GRID_LINE_OPTIONS));
    });
    this.addChild(verticalAxisLabel);

    // The path that shows the curve in the chart.
    const pathClipArea = Shape.rect(0, 0, graphWidth, horizontalLineY);
    const path = new Path(new Shape(), {
      stroke: 'black',
      lineWidth: 2,
      lineJoin: WaveInterferenceConstants.CHART_LINE_JOIN,
      // Prevents artifacts at the wave source

      // prevent the shape from going outside of the chart area
      clipArea: pathClipArea,
      // prevent bounds computations during main loop
      boundsMethod: 'none',
      localBounds: pathClipArea.bounds
    });
    this.addChild(path);

    // For debugging, show the peaks
    const derivativePath = new Path(new Shape(), {
      stroke: 'red',
      lineWidth: 2,
      lineJoin: WaveInterferenceConstants.CHART_LINE_JOIN,
      // Prevents artifacts at the wave source

      // prevent the shape from going outside of the chart area
      clipArea: pathClipArea,
      // prevent bounds computations during main loop
      boundsMethod: 'none',
      localBounds: pathClipArea.bounds
    });
    this.addChild(derivativePath);

    // Created once and reused to avoid allocations
    const sampleArray = [];

    // Manually tuned to center the line in the graph, dy must be synchronized with graphHeight
    const dx = -options.x;
    const dy = -options.centerY / 2 + 7.5;
    const updateShape = () => {
      const shape = getWaterSideShape(sampleArray, model.sceneProperty.value.lattice, waveAreaBounds, dx, dy);
      path.setShape(shape);
    };
    model.scenes.forEach(scene => scene.lattice.changedEmitter.addListener(updateShape));

    // Update the curve when the scene is changed
    model.sceneProperty.link(updateShape);
    this.mutate(options);
  }
}
waveInterference.register('WaveAreaGraphNode', WaveAreaGraphNode);
export default WaveAreaGraphNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb3VuZHMyIiwiVXRpbHMiLCJTaGFwZSIsIkxpbmUiLCJOb2RlIiwiUGF0aCIsIndhdmVJbnRlcmZlcmVuY2UiLCJXYXZlSW50ZXJmZXJlbmNlQ29uc3RhbnRzIiwiV2F2ZUludGVyZmVyZW5jZVV0aWxzIiwiRGFzaGVkTGluZU5vZGUiLCJTY2VuZVRvZ2dsZU5vZGUiLCJXYXZlSW50ZXJmZXJlbmNlVGV4dCIsIlRFWFRfTUFSR0lOX1giLCJURVhUX01BUkdJTl9ZIiwiZ2V0V2F0ZXJTaWRlU2hhcGUiLCJSQURJVVMiLCJHUklEX0xJTkVfT1BUSU9OUyIsInN0cm9rZSIsImxpbmVXaWR0aCIsImxpbmVEYXNoIiwiV2F2ZUFyZWFHcmFwaE5vZGUiLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwid2F2ZUFyZWFCb3VuZHMiLCJvcHRpb25zIiwiZ3JhcGhXaWR0aCIsIldBVkVfQVJFQV9XSURUSCIsImdyYXBoSGVpZ2h0IiwiaG9yaXpvbnRhbEF4aXNMYWJlbCIsInNjZW5lIiwiZ3JhcGhIb3Jpem9udGFsQXhpc0xhYmVsIiwidGl0bGVOb2RlIiwiZ3JhcGhUaXRsZSIsIkhPUklaT05UQUxfTEFCRUxfVkVSVElDQUxfTUFSR0lOIiwic2FtcGxlVGV4dCIsImhvcml6b250YWxMaW5lWSIsImhlaWdodCIsImhvcml6b250YWxBeGlzVGlja0xhYmVscyIsInZlcnRpY2FsR3JpZExpbmVzIiwiaSIsIngiLCJsaW5lYXIiLCJob3Jpem9udGFsQXhpc1RpY2tMYWJlbCIsInRvRml4ZWQiLCJ3YXZlQXJlYVdpZHRoIiwiY2VudGVyWCIsInRvcCIsInB1c2giLCJ0b3BUYWJCb3VuZHMiLCJ3aWR0aCIsImJvdHRvbVRhYkJvdW5kcyIsImxhc3RUaWNrTGFiZWwiLCJsZW5ndGgiLCJ0aWNrQnViYmxlWE1hcmdpbiIsInZlcnRpY2FsQXhpc0xhYmVsIiwiZ3JhcGhWZXJ0aWNhbEF4aXNMYWJlbCIsInJvdGF0aW9uIiwiTWF0aCIsIlBJIiwicmlnaHQiLCJjZW50ZXJZIiwiVVAiLCJET1dOIiwiUklHSFQiLCJMRUZUIiwiQ0xPQ0tXSVNFIiwiQU5USUNMT0NLV0lTRSIsIm91dGxpbmUiLCJtb3ZlVG8iLCJsaW5lVG8iLCJtaW5YIiwibWF4WSIsImFyYyIsIm1pblkiLCJtYXhYIiwibGVmdCIsImNsb3NlIiwib3V0bGluZVBhdGgiLCJmaWxsIiwiYWRkQ2hpbGQiLCJmb3JFYWNoIiwibGFiZWwiLCJib3R0b20iLCJob3Jpem9udGFsQXhpc0xpbmUiLCJwbG90SGVpZ2h0IiwiaG9yaXpvbnRhbEdyaWRMaW5lRnJhY3Rpb24iLCJwYXRoQ2xpcEFyZWEiLCJyZWN0IiwicGF0aCIsImxpbmVKb2luIiwiQ0hBUlRfTElORV9KT0lOIiwiY2xpcEFyZWEiLCJib3VuZHNNZXRob2QiLCJsb2NhbEJvdW5kcyIsImJvdW5kcyIsImRlcml2YXRpdmVQYXRoIiwic2FtcGxlQXJyYXkiLCJkeCIsImR5IiwidXBkYXRlU2hhcGUiLCJzaGFwZSIsInNjZW5lUHJvcGVydHkiLCJ2YWx1ZSIsImxhdHRpY2UiLCJzZXRTaGFwZSIsInNjZW5lcyIsImNoYW5nZWRFbWl0dGVyIiwiYWRkTGlzdGVuZXIiLCJsaW5rIiwibXV0YXRlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJXYXZlQXJlYUdyYXBoTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuLy8gQHRzLW5vY2hlY2tcclxuLyoqXHJcbiAqIFNob3dzIHRoZSBzZW1pLXRyYW5zcGFyZW50IGdyYXBoIG92ZXIgdGhlIGxhdHRpY2UgYXJlYSAod2hlbiBzZWxlY3RlZCkuXHJcbiAqXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1V0aWxzLmpzJztcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgeyBMaW5lLCBOb2RlLCBQYXRoIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IHdhdmVJbnRlcmZlcmVuY2UgZnJvbSAnLi4vLi4vd2F2ZUludGVyZmVyZW5jZS5qcyc7XHJcbmltcG9ydCBXYXZlSW50ZXJmZXJlbmNlQ29uc3RhbnRzIGZyb20gJy4uL1dhdmVJbnRlcmZlcmVuY2VDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgV2F2ZUludGVyZmVyZW5jZVV0aWxzIGZyb20gJy4uL1dhdmVJbnRlcmZlcmVuY2VVdGlscy5qcyc7XHJcbmltcG9ydCBEYXNoZWRMaW5lTm9kZSBmcm9tICcuL0Rhc2hlZExpbmVOb2RlLmpzJztcclxuaW1wb3J0IFNjZW5lVG9nZ2xlTm9kZSBmcm9tICcuL1NjZW5lVG9nZ2xlTm9kZS5qcyc7XHJcbmltcG9ydCBXYXZlSW50ZXJmZXJlbmNlVGV4dCBmcm9tICcuL1dhdmVJbnRlcmZlcmVuY2VUZXh0LmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBURVhUX01BUkdJTl9YID0gODtcclxuY29uc3QgVEVYVF9NQVJHSU5fWSA9IDY7XHJcbmNvbnN0IGdldFdhdGVyU2lkZVNoYXBlID0gV2F2ZUludGVyZmVyZW5jZVV0aWxzLmdldFdhdGVyU2lkZVNoYXBlO1xyXG5cclxuLy8gQ3VydmUgcmFkaXVzIGZvciB0aGUgcm91bmRpbmdzIG9uIGNvcm5lcnMgYW5kIHRhYnNcclxuY29uc3QgUkFESVVTID0gNTtcclxuXHJcbmNvbnN0IEdSSURfTElORV9PUFRJT05TID0geyBzdHJva2U6ICdncmF5JywgbGluZVdpZHRoOiAxLCBsaW5lRGFzaDogWyA0LCA0IF0gfTtcclxuXHJcbmNsYXNzIFdhdmVBcmVhR3JhcGhOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggbW9kZWwsIHdhdmVBcmVhQm91bmRzLCBvcHRpb25zICkge1xyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICBjb25zdCBncmFwaFdpZHRoID0gV2F2ZUludGVyZmVyZW5jZUNvbnN0YW50cy5XQVZFX0FSRUFfV0lEVEg7XHJcblxyXG4gICAgLy8gTWFudWFsbHkgdHVuZWQgc28gdGhlIGdyYXBoIGlzIHRoZSBhcHByb3ByaWF0ZSBoZWlnaHQuICBOb3RlIGlmIHlvdSBhZGp1c3QgZ3JhcGhIZWlnaHQsIHlvdSB3aWxsXHJcbiAgICAvLyBuZWVkIHRvIGFkanVzdCB0aGUgdmFsdWUgb2YgZHkgKGFyZ3VtZW50IHRvIGdldFdhdGVyU2lkZVNoYXBlKSBhY2NvcmRpbmdseS5cclxuICAgIGNvbnN0IGdyYXBoSGVpZ2h0ID0gV2F2ZUludGVyZmVyZW5jZUNvbnN0YW50cy5XQVZFX0FSRUFfV0lEVEggKiAwLjM4MzMzMzMzMzMzMzMzMzM7XHJcblxyXG4gICAgLy8gSG9yaXpvbnRhbCBBeGlzIExhYmVsLCB3aGljaCB1cGRhdGVzIHdoZW4gdGhlIHNjZW5lIGNoYW5nZXMuICBVc2VzIHZpc2liaWxpdHkgaW5zdGVhZCBvZiBzZXRDaGlsZHJlbiBzbyB0aGF0XHJcbiAgICAvLyB0aGUgYm90dG9tIHRhYiB3aWxsIGZpdCB0aGUgbGFyZ2VzdCBsYWJlbC5cclxuICAgIGNvbnN0IGhvcml6b250YWxBeGlzTGFiZWwgPSBuZXcgU2NlbmVUb2dnbGVOb2RlKFxyXG4gICAgICBtb2RlbCxcclxuICAgICAgc2NlbmUgPT4gbmV3IFdhdmVJbnRlcmZlcmVuY2VUZXh0KCBzY2VuZS5ncmFwaEhvcml6b250YWxBeGlzTGFiZWwgKVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBTY2VuZS1zcGVjaWZpYyB0aXRsZSBvZiB0aGUgY2hhcnQuXHJcbiAgICBjb25zdCB0aXRsZU5vZGUgPSBuZXcgU2NlbmVUb2dnbGVOb2RlKCBtb2RlbCwgc2NlbmUgPT4gbmV3IFdhdmVJbnRlcmZlcmVuY2VUZXh0KCBzY2VuZS5ncmFwaFRpdGxlICkgKTtcclxuXHJcbiAgICBjb25zdCBIT1JJWk9OVEFMX0xBQkVMX1ZFUlRJQ0FMX01BUkdJTiA9IDI7XHJcbiAgICBjb25zdCBzYW1wbGVUZXh0ID0gbmV3IFdhdmVJbnRlcmZlcmVuY2VUZXh0KCAnMScgKTtcclxuICAgIGNvbnN0IGhvcml6b250YWxMaW5lWSA9IGdyYXBoSGVpZ2h0IC0gc2FtcGxlVGV4dC5oZWlnaHQgLSBIT1JJWk9OVEFMX0xBQkVMX1ZFUlRJQ0FMX01BUkdJTiAqIDI7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRpY2sgbGFiZWxzIGFuZCBncmlkIGxpbmVzXHJcbiAgICBjb25zdCBob3Jpem9udGFsQXhpc1RpY2tMYWJlbHMgPSBbXTtcclxuICAgIGNvbnN0IHZlcnRpY2FsR3JpZExpbmVzID0gW107XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPD0gMTA7IGkrKyApIHtcclxuICAgICAgY29uc3QgeCA9IFV0aWxzLmxpbmVhciggMCwgMTAsIDAsIGdyYXBoV2lkdGgsIGkgKTtcclxuXHJcbiAgICAgIC8vIEZpbmQgdGhlIHBvc2l0aW9uIG9mIHRoZSB0aWNrIG1hcmsgaW4gdGhlIHVuaXRzIG9mIHRoZSBzY2VuZVxyXG4gICAgICBjb25zdCBob3Jpem9udGFsQXhpc1RpY2tMYWJlbCA9IG5ldyBTY2VuZVRvZ2dsZU5vZGUoXHJcbiAgICAgICAgbW9kZWwsXHJcbiAgICAgICAgc2NlbmUgPT4gbmV3IFdhdmVJbnRlcmZlcmVuY2VUZXh0KCBVdGlscy50b0ZpeGVkKCBzY2VuZS53YXZlQXJlYVdpZHRoICogeCAvIGdyYXBoV2lkdGgsIDAgKSwge1xyXG4gICAgICAgICAgY2VudGVyWDogeCxcclxuICAgICAgICAgIHRvcDogaG9yaXpvbnRhbExpbmVZICsgSE9SSVpPTlRBTF9MQUJFTF9WRVJUSUNBTF9NQVJHSU5cclxuICAgICAgICB9IClcclxuICAgICAgKTtcclxuICAgICAgaG9yaXpvbnRhbEF4aXNUaWNrTGFiZWxzLnB1c2goIGhvcml6b250YWxBeGlzVGlja0xhYmVsICk7XHJcbiAgICAgIHZlcnRpY2FsR3JpZExpbmVzLnB1c2goIG5ldyBMaW5lKCB4LCBob3Jpem9udGFsTGluZVksIHgsIDAsIEdSSURfTElORV9PUFRJT05TICkgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0b3BUYWJCb3VuZHMgPSBuZXcgQm91bmRzMihcclxuICAgICAgZ3JhcGhXaWR0aCAvIDIgLSB0aXRsZU5vZGUud2lkdGggLyAyIC0gVEVYVF9NQVJHSU5fWCxcclxuICAgICAgLVRFWFRfTUFSR0lOX1kgLSB0aXRsZU5vZGUuaGVpZ2h0LFxyXG4gICAgICBncmFwaFdpZHRoIC8gMiArIHRpdGxlTm9kZS53aWR0aCAvIDIgKyBURVhUX01BUkdJTl9YLFxyXG4gICAgICAwXHJcbiAgICApO1xyXG4gICAgY29uc3QgYm90dG9tVGFiQm91bmRzID0gbmV3IEJvdW5kczIoXHJcbiAgICAgIGdyYXBoV2lkdGggLyAyIC0gaG9yaXpvbnRhbEF4aXNMYWJlbC53aWR0aCAvIDIgLSBURVhUX01BUkdJTl9YLFxyXG4gICAgICBncmFwaEhlaWdodCxcclxuICAgICAgZ3JhcGhXaWR0aCAvIDIgKyBob3Jpem9udGFsQXhpc0xhYmVsLndpZHRoIC8gMiArIFRFWFRfTUFSR0lOX1gsXHJcbiAgICAgIGdyYXBoSGVpZ2h0ICsgVEVYVF9NQVJHSU5fWSArIGhvcml6b250YWxBeGlzTGFiZWwuaGVpZ2h0XHJcbiAgICApO1xyXG4gICAgY29uc3QgbGFzdFRpY2tMYWJlbCA9IGhvcml6b250YWxBeGlzVGlja0xhYmVsc1sgaG9yaXpvbnRhbEF4aXNUaWNrTGFiZWxzLmxlbmd0aCAtIDEgXTtcclxuICAgIGNvbnN0IHRpY2tCdWJibGVYTWFyZ2luID0gMjtcclxuXHJcbiAgICBjb25zdCB2ZXJ0aWNhbEF4aXNMYWJlbCA9IG5ldyBTY2VuZVRvZ2dsZU5vZGUoXHJcbiAgICAgIG1vZGVsLFxyXG4gICAgICBzY2VuZSA9PiBuZXcgV2F2ZUludGVyZmVyZW5jZVRleHQoIHNjZW5lLmdyYXBoVmVydGljYWxBeGlzTGFiZWwgKSwge1xyXG4gICAgICAgIHJvdGF0aW9uOiAzICogTWF0aC5QSSAvIDIsXHJcbiAgICAgICAgcmlnaHQ6IC1URVhUX01BUkdJTl9ZLFxyXG4gICAgICAgIGNlbnRlclk6IGdyYXBoSGVpZ2h0IC8gMlxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIE5pY2tuYW1lcyB0byBzaW1wbGlmeSB0aGUgcm91bmRlZCBjb3JuZXJzIGluIHRoZSBjaGFydFxyXG4gICAgY29uc3QgVVAgPSAzICogTWF0aC5QSSAvIDI7XHJcbiAgICBjb25zdCBET1dOID0gTWF0aC5QSSAvIDI7XHJcbiAgICBjb25zdCBSSUdIVCA9IDA7XHJcbiAgICBjb25zdCBMRUZUID0gTWF0aC5QSTtcclxuICAgIGNvbnN0IENMT0NLV0lTRSA9IGZhbHNlO1xyXG4gICAgY29uc3QgQU5USUNMT0NLV0lTRSA9IHRydWU7XHJcblxyXG4gICAgY29uc3Qgb3V0bGluZSA9IG5ldyBTaGFwZSgpXHJcblxyXG4gICAgICAubW92ZVRvKCBSQURJVVMsIDAgKSAgLy8gc3RhcnQgYXQgdGhlIHRvcCBsZWZ0XHJcblxyXG4gICAgICAvLyBUb3AgdGFiIHdpdGggdGl0bGVcclxuICAgICAgLmxpbmVUbyggdG9wVGFiQm91bmRzLm1pblggLSBSQURJVVMsIHRvcFRhYkJvdW5kcy5tYXhZIClcclxuICAgICAgLmFyYyggdG9wVGFiQm91bmRzLm1pblggLSBSQURJVVMsIHRvcFRhYkJvdW5kcy5tYXhZIC0gUkFESVVTLCBSQURJVVMsIERPV04sIFJJR0hULCBBTlRJQ0xPQ0tXSVNFIClcclxuICAgICAgLmxpbmVUbyggdG9wVGFiQm91bmRzLm1pblgsIHRvcFRhYkJvdW5kcy5taW5ZICsgUkFESVVTIClcclxuICAgICAgLmFyYyggdG9wVGFiQm91bmRzLm1pblggKyBSQURJVVMsIHRvcFRhYkJvdW5kcy5taW5ZICsgUkFESVVTLCBSQURJVVMsIExFRlQsIFVQLCBDTE9DS1dJU0UgKVxyXG4gICAgICAubGluZVRvKCB0b3BUYWJCb3VuZHMubWF4WCAtIFJBRElVUywgdG9wVGFiQm91bmRzLm1pblkgKVxyXG4gICAgICAuYXJjKCB0b3BUYWJCb3VuZHMubWF4WCAtIFJBRElVUywgdG9wVGFiQm91bmRzLm1pblkgKyBSQURJVVMsIFJBRElVUywgVVAsIFJJR0hULCBDTE9DS1dJU0UgKVxyXG4gICAgICAubGluZVRvKCB0b3BUYWJCb3VuZHMubWF4WCwgdG9wVGFiQm91bmRzLm1heFkgLSBSQURJVVMgKVxyXG4gICAgICAuYXJjKCB0b3BUYWJCb3VuZHMubWF4WCArIFJBRElVUywgdG9wVGFiQm91bmRzLm1heFkgLSBSQURJVVMsIFJBRElVUywgTEVGVCwgRE9XTiwgQU5USUNMT0NLV0lTRSApXHJcblxyXG4gICAgICAvLyBSaWdodCBlZGdlLCBhbmQgYnViYmxlIG91dCBhcm91bmQgdGhlIGxhc3QgaG9yaXpvbnRhbCBheGlzIHRpY2sgbGFiZWxcclxuICAgICAgLmxpbmVUbyggbGFzdFRpY2tMYWJlbC5yaWdodCArIHRpY2tCdWJibGVYTWFyZ2luIC0gUkFESVVTLCAwIClcclxuICAgICAgLmFyYyggbGFzdFRpY2tMYWJlbC5yaWdodCArIHRpY2tCdWJibGVYTWFyZ2luIC0gUkFESVVTLCBSQURJVVMsIFJBRElVUywgVVAsIFJJR0hULCBDTE9DS1dJU0UgKVxyXG4gICAgICAubGluZVRvKCBsYXN0VGlja0xhYmVsLnJpZ2h0ICsgdGlja0J1YmJsZVhNYXJnaW4sIGdyYXBoSGVpZ2h0IC0gUkFESVVTIClcclxuICAgICAgLmFyYyggbGFzdFRpY2tMYWJlbC5yaWdodCArIHRpY2tCdWJibGVYTWFyZ2luIC0gUkFESVVTLCBncmFwaEhlaWdodCAtIFJBRElVUywgUkFESVVTLCBSSUdIVCwgRE9XTiwgQ0xPQ0tXSVNFIClcclxuXHJcbiAgICAgIC8vIEJvdHRvbSB0YWIgd2l0aCBob3Jpem9udGFsIGF4aXMgbGFiZWxcclxuICAgICAgLmxpbmVUbyggYm90dG9tVGFiQm91bmRzLm1heFggKyBSQURJVVMsIGJvdHRvbVRhYkJvdW5kcy5taW5ZIClcclxuICAgICAgLmFyYyggYm90dG9tVGFiQm91bmRzLm1heFggKyBSQURJVVMsIGJvdHRvbVRhYkJvdW5kcy5taW5ZICsgUkFESVVTLCBSQURJVVMsIFVQLCBMRUZULCBBTlRJQ0xPQ0tXSVNFIClcclxuICAgICAgLmxpbmVUbyggYm90dG9tVGFiQm91bmRzLm1heFgsIGJvdHRvbVRhYkJvdW5kcy5tYXhZIC0gUkFESVVTIClcclxuICAgICAgLmFyYyggYm90dG9tVGFiQm91bmRzLm1heFggLSBSQURJVVMsIGJvdHRvbVRhYkJvdW5kcy5tYXhZIC0gUkFESVVTLCBSQURJVVMsIFJJR0hULCBET1dOLCBDTE9DS1dJU0UgKVxyXG4gICAgICAubGluZVRvKCBib3R0b21UYWJCb3VuZHMubWluWCArIFJBRElVUywgYm90dG9tVGFiQm91bmRzLm1heFkgKVxyXG4gICAgICAuYXJjKCBib3R0b21UYWJCb3VuZHMubWluWCArIFJBRElVUywgYm90dG9tVGFiQm91bmRzLm1heFkgLSBSQURJVVMsIFJBRElVUywgRE9XTiwgTEVGVCwgQ0xPQ0tXSVNFIClcclxuICAgICAgLmxpbmVUbyggYm90dG9tVGFiQm91bmRzLm1pblgsIGJvdHRvbVRhYkJvdW5kcy5taW5ZICsgUkFESVVTIClcclxuICAgICAgLmFyYyggYm90dG9tVGFiQm91bmRzLm1pblggLSBSQURJVVMsIGJvdHRvbVRhYkJvdW5kcy5taW5ZICsgUkFESVVTLCBSQURJVVMsIFJJR0hULCBVUCwgQU5USUNMT0NLV0lTRSApXHJcblxyXG4gICAgICAvLyBMZWZ0IGVkZ2UsIGFuZCBidWJibGUgb3V0IGFyb3VuZCB0aGUgZmlyc3QgaG9yaXpvbnRhbCBheGlzIHRpY2sgbGFiZWxcclxuICAgICAgLmxpbmVUbyggdmVydGljYWxBeGlzTGFiZWwubGVmdCAtIFRFWFRfTUFSR0lOX1kgKyBSQURJVVMsIGdyYXBoSGVpZ2h0IClcclxuICAgICAgLmFyYyggdmVydGljYWxBeGlzTGFiZWwubGVmdCAtIFRFWFRfTUFSR0lOX1kgKyBSQURJVVMsIGdyYXBoSGVpZ2h0IC0gUkFESVVTLCBSQURJVVMsIERPV04sIExFRlQsIENMT0NLV0lTRSApXHJcbiAgICAgIC5saW5lVG8oIHZlcnRpY2FsQXhpc0xhYmVsLmxlZnQgLSBURVhUX01BUkdJTl9ZLCBSQURJVVMgKVxyXG4gICAgICAuYXJjKCB2ZXJ0aWNhbEF4aXNMYWJlbC5sZWZ0IC0gVEVYVF9NQVJHSU5fWSArIFJBRElVUywgUkFESVVTLCBSQURJVVMsIExFRlQsIFVQLCBDTE9DS1dJU0UgKVxyXG4gICAgICAuY2xvc2UoKTtcclxuXHJcbiAgICBjb25zdCBvdXRsaW5lUGF0aCA9IG5ldyBQYXRoKCBvdXRsaW5lLCB7IGxpbmVXaWR0aDogMSwgc3Ryb2tlOiAnYmxhY2snLCBmaWxsOiAncmdiYSgyMzAsMjMwLDIzMCwwLjYpJyB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBvdXRsaW5lUGF0aCApO1xyXG4gICAgaG9yaXpvbnRhbEF4aXNUaWNrTGFiZWxzLmZvckVhY2goIGxhYmVsID0+IHRoaXMuYWRkQ2hpbGQoIGxhYmVsICkgKTtcclxuICAgIHZlcnRpY2FsR3JpZExpbmVzLmZvckVhY2goIGxhYmVsID0+IHRoaXMuYWRkQ2hpbGQoIGxhYmVsICkgKTtcclxuXHJcbiAgICB0aXRsZU5vZGUuY2VudGVyWCA9IGdyYXBoV2lkdGggLyAyO1xyXG4gICAgdGl0bGVOb2RlLmJvdHRvbSA9IDA7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aXRsZU5vZGUgKTtcclxuXHJcbiAgICBob3Jpem9udGFsQXhpc0xhYmVsLmNlbnRlclggPSBncmFwaFdpZHRoIC8gMjtcclxuICAgIGhvcml6b250YWxBeGlzTGFiZWwuYm90dG9tID0gb3V0bGluZVBhdGguYm90dG9tIC0gVEVYVF9NQVJHSU5fWTtcclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKCBob3Jpem9udGFsQXhpc0xhYmVsICk7XHJcblxyXG4gICAgY29uc3QgaG9yaXpvbnRhbEF4aXNMaW5lID0gbmV3IExpbmUoIDAsIGhvcml6b250YWxMaW5lWSwgZ3JhcGhXaWR0aCwgaG9yaXpvbnRhbExpbmVZLCB7IHN0cm9rZTogJ2RhcmtHcmF5JyB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBob3Jpem9udGFsQXhpc0xpbmUgKTtcclxuXHJcbiAgICAvLyBUaGUgcGFydCB0aGF0IGRpc3BsYXlzIHRoZSB2YWx1ZXMgKGRvZXNuJ3QgaW5jbHVkZSBheGlzIGxhYmVscylcclxuICAgIGNvbnN0IHBsb3RIZWlnaHQgPSBob3Jpem9udGFsTGluZVk7XHJcblxyXG4gICAgdGhpcy5hZGRDaGlsZCggbmV3IERhc2hlZExpbmVOb2RlKCB7XHJcbiAgICAgIGNlbnRlclk6IHBsb3RIZWlnaHQgLyAyXHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBEaXNwbGF5IGEgbWlub3IgZ3JpZCBsaW5lIGluIHRoZSBjZW50ZXIgb2YgdGhlIGxvd2VyIGFuZCB1cHBlciBoYWx2ZXMgb2YgdGhlIGNoYXJ0LlxyXG4gICAgWyAxIC8gNCwgMyAvIDQgXS5mb3JFYWNoKCBob3Jpem9udGFsR3JpZExpbmVGcmFjdGlvbiA9PiB7XHJcbiAgICAgIHRoaXMuYWRkQ2hpbGQoIG5ldyBMaW5lKFxyXG4gICAgICAgIDAsIGhvcml6b250YWxHcmlkTGluZUZyYWN0aW9uICogcGxvdEhlaWdodCxcclxuICAgICAgICBncmFwaFdpZHRoLCBob3Jpem9udGFsR3JpZExpbmVGcmFjdGlvbiAqIHBsb3RIZWlnaHQsXHJcbiAgICAgICAgR1JJRF9MSU5FX09QVElPTlNcclxuICAgICAgKSApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuYWRkQ2hpbGQoIHZlcnRpY2FsQXhpc0xhYmVsICk7XHJcblxyXG4gICAgLy8gVGhlIHBhdGggdGhhdCBzaG93cyB0aGUgY3VydmUgaW4gdGhlIGNoYXJ0LlxyXG4gICAgY29uc3QgcGF0aENsaXBBcmVhID0gU2hhcGUucmVjdCggMCwgMCwgZ3JhcGhXaWR0aCwgaG9yaXpvbnRhbExpbmVZICk7XHJcbiAgICBjb25zdCBwYXRoID0gbmV3IFBhdGgoIG5ldyBTaGFwZSgpLCB7XHJcbiAgICAgIHN0cm9rZTogJ2JsYWNrJyxcclxuICAgICAgbGluZVdpZHRoOiAyLFxyXG4gICAgICBsaW5lSm9pbjogV2F2ZUludGVyZmVyZW5jZUNvbnN0YW50cy5DSEFSVF9MSU5FX0pPSU4sIC8vIFByZXZlbnRzIGFydGlmYWN0cyBhdCB0aGUgd2F2ZSBzb3VyY2VcclxuXHJcbiAgICAgIC8vIHByZXZlbnQgdGhlIHNoYXBlIGZyb20gZ29pbmcgb3V0c2lkZSBvZiB0aGUgY2hhcnQgYXJlYVxyXG4gICAgICBjbGlwQXJlYTogcGF0aENsaXBBcmVhLFxyXG5cclxuICAgICAgLy8gcHJldmVudCBib3VuZHMgY29tcHV0YXRpb25zIGR1cmluZyBtYWluIGxvb3BcclxuICAgICAgYm91bmRzTWV0aG9kOiAnbm9uZScsXHJcbiAgICAgIGxvY2FsQm91bmRzOiBwYXRoQ2xpcEFyZWEuYm91bmRzXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBwYXRoICk7XHJcblxyXG4gICAgLy8gRm9yIGRlYnVnZ2luZywgc2hvdyB0aGUgcGVha3NcclxuICAgIGNvbnN0IGRlcml2YXRpdmVQYXRoID0gbmV3IFBhdGgoIG5ldyBTaGFwZSgpLCB7XHJcbiAgICAgIHN0cm9rZTogJ3JlZCcsXHJcbiAgICAgIGxpbmVXaWR0aDogMixcclxuICAgICAgbGluZUpvaW46IFdhdmVJbnRlcmZlcmVuY2VDb25zdGFudHMuQ0hBUlRfTElORV9KT0lOLCAvLyBQcmV2ZW50cyBhcnRpZmFjdHMgYXQgdGhlIHdhdmUgc291cmNlXHJcblxyXG4gICAgICAvLyBwcmV2ZW50IHRoZSBzaGFwZSBmcm9tIGdvaW5nIG91dHNpZGUgb2YgdGhlIGNoYXJ0IGFyZWFcclxuICAgICAgY2xpcEFyZWE6IHBhdGhDbGlwQXJlYSxcclxuXHJcbiAgICAgIC8vIHByZXZlbnQgYm91bmRzIGNvbXB1dGF0aW9ucyBkdXJpbmcgbWFpbiBsb29wXHJcbiAgICAgIGJvdW5kc01ldGhvZDogJ25vbmUnLFxyXG4gICAgICBsb2NhbEJvdW5kczogcGF0aENsaXBBcmVhLmJvdW5kc1xyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggZGVyaXZhdGl2ZVBhdGggKTtcclxuXHJcbiAgICAvLyBDcmVhdGVkIG9uY2UgYW5kIHJldXNlZCB0byBhdm9pZCBhbGxvY2F0aW9uc1xyXG4gICAgY29uc3Qgc2FtcGxlQXJyYXkgPSBbXTtcclxuXHJcbiAgICAvLyBNYW51YWxseSB0dW5lZCB0byBjZW50ZXIgdGhlIGxpbmUgaW4gdGhlIGdyYXBoLCBkeSBtdXN0IGJlIHN5bmNocm9uaXplZCB3aXRoIGdyYXBoSGVpZ2h0XHJcbiAgICBjb25zdCBkeCA9IC1vcHRpb25zLng7XHJcbiAgICBjb25zdCBkeSA9IC1vcHRpb25zLmNlbnRlclkgLyAyICsgNy41O1xyXG5cclxuICAgIGNvbnN0IHVwZGF0ZVNoYXBlID0gKCkgPT4ge1xyXG4gICAgICBjb25zdCBzaGFwZSA9IGdldFdhdGVyU2lkZVNoYXBlKCBzYW1wbGVBcnJheSwgbW9kZWwuc2NlbmVQcm9wZXJ0eS52YWx1ZS5sYXR0aWNlLCB3YXZlQXJlYUJvdW5kcywgZHgsIGR5ICk7XHJcbiAgICAgIHBhdGguc2V0U2hhcGUoIHNoYXBlICk7XHJcbiAgICB9O1xyXG4gICAgbW9kZWwuc2NlbmVzLmZvckVhY2goIHNjZW5lID0+IHNjZW5lLmxhdHRpY2UuY2hhbmdlZEVtaXR0ZXIuYWRkTGlzdGVuZXIoIHVwZGF0ZVNoYXBlICkgKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIGN1cnZlIHdoZW4gdGhlIHNjZW5lIGlzIGNoYW5nZWRcclxuICAgIG1vZGVsLnNjZW5lUHJvcGVydHkubGluayggdXBkYXRlU2hhcGUgKTtcclxuXHJcbiAgICB0aGlzLm11dGF0ZSggb3B0aW9ucyApO1xyXG4gIH1cclxufVxyXG5cclxud2F2ZUludGVyZmVyZW5jZS5yZWdpc3RlciggJ1dhdmVBcmVhR3JhcGhOb2RlJywgV2F2ZUFyZWFHcmFwaE5vZGUgKTtcclxuZXhwb3J0IGRl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