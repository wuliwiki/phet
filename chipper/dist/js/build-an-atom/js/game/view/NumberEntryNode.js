// Copyright 2013-2023, University of Colorado Boulder

/**
 * Node that allows a user to enter a numerical value using up/down arrow
 * buttons.
 *
 * @author John Blanco
 */

import { Shape } from '../../../../kite/js/imports.js';
import merge from '../../../../phet-core/js/merge.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import ArrowButton from '../../../../sun/js/buttons/ArrowButton.js';
import buildAnAtom from '../../buildAnAtom.js';

// constants
const NUMBER_BOX_SIZE = {
  width: 55,
  height: 48
}; // Size empirically determined.
const NUMBER_FONT = new PhetFont(28);
class NumberEntryNode extends Node {
  /**
   * @param {Property.<number>} numberProperty
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(numberProperty, tandem, options) {
    super();
    options = merge({
      // {boolean} - A flag that controls whether the plus sign is shown for positive numbers.  This is generally on
      // when depicting charge, off for other things like mass number or atomic number.  Off (false) means that no sign
      // is depicted.
      showPlusForPositive: false,
      // {boolean} - Controls whether the sign (i.e. +/-) is shown before or after the numeric value.  For charge, the
      // sign is generally shown after, which is the most common use case for this, and hence the default.
      signAfterValue: true,
      // {function} - A function that can be used to change the color used to depict the value based on the value.
      getTextColor: () => 'black',
      // {number} - min and max supported values
      minValue: Number.NEGATIVE_INFINITY,
      maxValue: Number.POSITIVE_INFINITY
    }, options);

    // Node creation
    const arrowButtonOptions = {
      arrowHeight: 12,
      arrowWidth: 15,
      fireOnHoldDelay: 200
    };
    const upArrowButton = new ArrowButton('up', () => {
      numberProperty.value = numberProperty.value + 1;
    }, merge({
      tandem: tandem.createTandem('upArrowButton')
    }, arrowButtonOptions));
    this.addChild(upArrowButton);
    const downArrowButton = new ArrowButton('down', () => {
      numberProperty.value = numberProperty.value - 1;
    }, merge({
      tandem: tandem.createTandem('downArrowButton')
    }, arrowButtonOptions));
    this.addChild(downArrowButton);
    const answerValueBackground = new Rectangle(0, 0, NUMBER_BOX_SIZE.width, NUMBER_BOX_SIZE.height, 4, 4, {
      fill: 'white',
      stroke: 'black',
      lineWidth: 1
    });
    this.addChild(answerValueBackground);
    const numberPropertyListener = newValue => {
      answerValueBackground.removeAllChildren();
      const minusSign = options.signAfterValue ? MathSymbols.MINUS : MathSymbols.UNARY_MINUS;
      const plusSign = options.signAfterValue ? MathSymbols.PLUS : MathSymbols.UNARY_PLUS;
      const sign = newValue < 0 ? minusSign : newValue > 0 && options.showPlusForPositive ? plusSign : '';
      const absoluteValueString = Math.abs(newValue).toString();
      const valueText = options.signAfterValue ? `${absoluteValueString}${sign}` : `${sign}${absoluteValueString}`;
      const textNode = new Text(valueText, {
        font: NUMBER_FONT,
        fill: options.getTextColor(newValue)
      });
      textNode.scale(Math.min(1, Math.min(answerValueBackground.width * 0.8 / textNode.width, answerValueBackground.height * 0.9 / textNode.height)));
      textNode.centerX = answerValueBackground.width / 2;
      textNode.centerY = answerValueBackground.height / 2;
      answerValueBackground.addChild(textNode);
      upArrowButton.enabled = newValue < options.maxValue;
      downArrowButton.enabled = newValue > options.minValue;
    };
    numberProperty.link(numberPropertyListener);

    // Layout.  Upper left corner of overall node will be at (0,0).
    const interNodeSpacing = upArrowButton.height * 0.2;
    const totalHeight = Math.max(answerValueBackground.height, upArrowButton.height + downArrowButton.height + interNodeSpacing);
    answerValueBackground.left = 0;
    answerValueBackground.centerY = totalHeight / 2;
    upArrowButton.left = answerValueBackground.right + interNodeSpacing;
    upArrowButton.bottom = totalHeight / 2 - interNodeSpacing / 2;
    downArrowButton.top = totalHeight / 2 + interNodeSpacing / 2;
    downArrowButton.left = answerValueBackground.right + interNodeSpacing;

    // Set up extended touch areas for the up/down buttons.  The areas are
    // set up such that they don't overlap with one another.
    const touchAreaXDilation = upArrowButton.width * 2.5;
    const touchAreaYDilation = upArrowButton.height * 1.45; // Tweaked for minimal overlap in most layouts that use this.
    upArrowButton.touchArea = Shape.rectangle(-touchAreaXDilation / 2 + upArrowButton.width / 2, -touchAreaYDilation + upArrowButton.height, touchAreaXDilation, touchAreaYDilation);
    downArrowButton.touchArea = Shape.rectangle(-touchAreaXDilation / 2 + upArrowButton.width / 2, 0, touchAreaXDilation, touchAreaYDilation);

    // @private called by dispose
    this.disposeNumberEntryNode = () => {
      numberProperty.unlink(numberPropertyListener);
      upArrowButton.dispose();
      downArrowButton.dispose();
    };
    this.mutate(options);
  }

  /**
   * release references
   * @public
   */
  dispose() {
    this.disposeNumberEntryNode();
    super.dispose();
  }
}
buildAnAtom.register('NumberEntryNode', NumberEntryNode);
export default NumberEntryNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaGFwZSIsIm1lcmdlIiwiTWF0aFN5bWJvbHMiLCJQaGV0Rm9udCIsIk5vZGUiLCJSZWN0YW5nbGUiLCJUZXh0IiwiQXJyb3dCdXR0b24iLCJidWlsZEFuQXRvbSIsIk5VTUJFUl9CT1hfU0laRSIsIndpZHRoIiwiaGVpZ2h0IiwiTlVNQkVSX0ZPTlQiLCJOdW1iZXJFbnRyeU5vZGUiLCJjb25zdHJ1Y3RvciIsIm51bWJlclByb3BlcnR5IiwidGFuZGVtIiwib3B0aW9ucyIsInNob3dQbHVzRm9yUG9zaXRpdmUiLCJzaWduQWZ0ZXJWYWx1ZSIsImdldFRleHRDb2xvciIsIm1pblZhbHVlIiwiTnVtYmVyIiwiTkVHQVRJVkVfSU5GSU5JVFkiLCJtYXhWYWx1ZSIsIlBPU0lUSVZFX0lORklOSVRZIiwiYXJyb3dCdXR0b25PcHRpb25zIiwiYXJyb3dIZWlnaHQiLCJhcnJvd1dpZHRoIiwiZmlyZU9uSG9sZERlbGF5IiwidXBBcnJvd0J1dHRvbiIsInZhbHVlIiwiY3JlYXRlVGFuZGVtIiwiYWRkQ2hpbGQiLCJkb3duQXJyb3dCdXR0b24iLCJhbnN3ZXJWYWx1ZUJhY2tncm91bmQiLCJmaWxsIiwic3Ryb2tlIiwibGluZVdpZHRoIiwibnVtYmVyUHJvcGVydHlMaXN0ZW5lciIsIm5ld1ZhbHVlIiwicmVtb3ZlQWxsQ2hpbGRyZW4iLCJtaW51c1NpZ24iLCJNSU5VUyIsIlVOQVJZX01JTlVTIiwicGx1c1NpZ24iLCJQTFVTIiwiVU5BUllfUExVUyIsInNpZ24iLCJhYnNvbHV0ZVZhbHVlU3RyaW5nIiwiTWF0aCIsImFicyIsInRvU3RyaW5nIiwidmFsdWVUZXh0IiwidGV4dE5vZGUiLCJmb250Iiwic2NhbGUiLCJtaW4iLCJjZW50ZXJYIiwiY2VudGVyWSIsImVuYWJsZWQiLCJsaW5rIiwiaW50ZXJOb2RlU3BhY2luZyIsInRvdGFsSGVpZ2h0IiwibWF4IiwibGVmdCIsInJpZ2h0IiwiYm90dG9tIiwidG9wIiwidG91Y2hBcmVhWERpbGF0aW9uIiwidG91Y2hBcmVhWURpbGF0aW9uIiwidG91Y2hBcmVhIiwicmVjdGFuZ2xlIiwiZGlzcG9zZU51bWJlckVudHJ5Tm9kZSIsInVubGluayIsImRpc3Bvc2UiLCJtdXRhdGUiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIk51bWJlckVudHJ5Tm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBOb2RlIHRoYXQgYWxsb3dzIGEgdXNlciB0byBlbnRlciBhIG51bWVyaWNhbCB2YWx1ZSB1c2luZyB1cC9kb3duIGFycm93XHJcbiAqIGJ1dHRvbnMuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY29cclxuICovXHJcblxyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgTWF0aFN5bWJvbHMgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL01hdGhTeW1ib2xzLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IE5vZGUsIFJlY3RhbmdsZSwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBBcnJvd0J1dHRvbiBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvYnV0dG9ucy9BcnJvd0J1dHRvbi5qcyc7XHJcbmltcG9ydCBidWlsZEFuQXRvbSBmcm9tICcuLi8uLi9idWlsZEFuQXRvbS5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgTlVNQkVSX0JPWF9TSVpFID0geyB3aWR0aDogNTUsIGhlaWdodDogNDggfTsgLy8gU2l6ZSBlbXBpcmljYWxseSBkZXRlcm1pbmVkLlxyXG5jb25zdCBOVU1CRVJfRk9OVCA9IG5ldyBQaGV0Rm9udCggMjggKTtcclxuXHJcbmNsYXNzIE51bWJlckVudHJ5Tm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5LjxudW1iZXI+fSBudW1iZXJQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSB7VGFuZGVtfSB0YW5kZW1cclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG51bWJlclByb3BlcnR5LCB0YW5kZW0sIG9wdGlvbnMgKSB7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuXHJcbiAgICAgIC8vIHtib29sZWFufSAtIEEgZmxhZyB0aGF0IGNvbnRyb2xzIHdoZXRoZXIgdGhlIHBsdXMgc2lnbiBpcyBzaG93biBmb3IgcG9zaXRpdmUgbnVtYmVycy4gIFRoaXMgaXMgZ2VuZXJhbGx5IG9uXHJcbiAgICAgIC8vIHdoZW4gZGVwaWN0aW5nIGNoYXJnZSwgb2ZmIGZvciBvdGhlciB0aGluZ3MgbGlrZSBtYXNzIG51bWJlciBvciBhdG9taWMgbnVtYmVyLiAgT2ZmIChmYWxzZSkgbWVhbnMgdGhhdCBubyBzaWduXHJcbiAgICAgIC8vIGlzIGRlcGljdGVkLlxyXG4gICAgICBzaG93UGx1c0ZvclBvc2l0aXZlOiBmYWxzZSxcclxuXHJcbiAgICAgIC8vIHtib29sZWFufSAtIENvbnRyb2xzIHdoZXRoZXIgdGhlIHNpZ24gKGkuZS4gKy8tKSBpcyBzaG93biBiZWZvcmUgb3IgYWZ0ZXIgdGhlIG51bWVyaWMgdmFsdWUuICBGb3IgY2hhcmdlLCB0aGVcclxuICAgICAgLy8gc2lnbiBpcyBnZW5lcmFsbHkgc2hvd24gYWZ0ZXIsIHdoaWNoIGlzIHRoZSBtb3N0IGNvbW1vbiB1c2UgY2FzZSBmb3IgdGhpcywgYW5kIGhlbmNlIHRoZSBkZWZhdWx0LlxyXG4gICAgICBzaWduQWZ0ZXJWYWx1ZTogdHJ1ZSxcclxuXHJcbiAgICAgIC8vIHtmdW5jdGlvbn0gLSBBIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2hhbmdlIHRoZSBjb2xvciB1c2VkIHRvIGRlcGljdCB0aGUgdmFsdWUgYmFzZWQgb24gdGhlIHZhbHVlLlxyXG4gICAgICBnZXRUZXh0Q29sb3I6ICgpID0+ICdibGFjaycsXHJcblxyXG4gICAgICAvLyB7bnVtYmVyfSAtIG1pbiBhbmQgbWF4IHN1cHBvcnRlZCB2YWx1ZXNcclxuICAgICAgbWluVmFsdWU6IE51bWJlci5ORUdBVElWRV9JTkZJTklUWSxcclxuICAgICAgbWF4VmFsdWU6IE51bWJlci5QT1NJVElWRV9JTkZJTklUWVxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIE5vZGUgY3JlYXRpb25cclxuICAgIGNvbnN0IGFycm93QnV0dG9uT3B0aW9ucyA9IHsgYXJyb3dIZWlnaHQ6IDEyLCBhcnJvd1dpZHRoOiAxNSwgZmlyZU9uSG9sZERlbGF5OiAyMDAgfTtcclxuICAgIGNvbnN0IHVwQXJyb3dCdXR0b24gPSBuZXcgQXJyb3dCdXR0b24oICd1cCcsICgpID0+IHtcclxuICAgICAgbnVtYmVyUHJvcGVydHkudmFsdWUgPSBudW1iZXJQcm9wZXJ0eS52YWx1ZSArIDE7XHJcbiAgICB9LCBtZXJnZSgge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICd1cEFycm93QnV0dG9uJyApXHJcbiAgICB9LCBhcnJvd0J1dHRvbk9wdGlvbnMgKSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdXBBcnJvd0J1dHRvbiApO1xyXG4gICAgY29uc3QgZG93bkFycm93QnV0dG9uID0gbmV3IEFycm93QnV0dG9uKCAnZG93bicsICgpID0+IHtcclxuICAgICAgbnVtYmVyUHJvcGVydHkudmFsdWUgPSBudW1iZXJQcm9wZXJ0eS52YWx1ZSAtIDE7XHJcbiAgICB9LCBtZXJnZSgge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdkb3duQXJyb3dCdXR0b24nIClcclxuICAgIH0sIGFycm93QnV0dG9uT3B0aW9ucyApICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBkb3duQXJyb3dCdXR0b24gKTtcclxuICAgIGNvbnN0IGFuc3dlclZhbHVlQmFja2dyb3VuZCA9IG5ldyBSZWN0YW5nbGUoIDAsIDAsIE5VTUJFUl9CT1hfU0laRS53aWR0aCwgTlVNQkVSX0JPWF9TSVpFLmhlaWdodCwgNCwgNCwge1xyXG4gICAgICBmaWxsOiAnd2hpdGUnLFxyXG4gICAgICBzdHJva2U6ICdibGFjaycsXHJcbiAgICAgIGxpbmVXaWR0aDogMVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggYW5zd2VyVmFsdWVCYWNrZ3JvdW5kICk7XHJcblxyXG4gICAgY29uc3QgbnVtYmVyUHJvcGVydHlMaXN0ZW5lciA9IG5ld1ZhbHVlID0+IHtcclxuICAgICAgYW5zd2VyVmFsdWVCYWNrZ3JvdW5kLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgIGNvbnN0IG1pbnVzU2lnbiA9IG9wdGlvbnMuc2lnbkFmdGVyVmFsdWUgPyBNYXRoU3ltYm9scy5NSU5VUyA6IE1hdGhTeW1ib2xzLlVOQVJZX01JTlVTO1xyXG4gICAgICBjb25zdCBwbHVzU2lnbiA9IG9wdGlvbnMuc2lnbkFmdGVyVmFsdWUgPyBNYXRoU3ltYm9scy5QTFVTIDogTWF0aFN5bWJvbHMuVU5BUllfUExVUztcclxuICAgICAgY29uc3Qgc2lnbiA9IG5ld1ZhbHVlIDwgMCA/IG1pbnVzU2lnbiA6XHJcbiAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA+IDAgJiYgb3B0aW9ucy5zaG93UGx1c0ZvclBvc2l0aXZlID8gcGx1c1NpZ24gOlxyXG4gICAgICAgICAgICAgICAgICAgJyc7XHJcbiAgICAgIGNvbnN0IGFic29sdXRlVmFsdWVTdHJpbmcgPSBNYXRoLmFicyggbmV3VmFsdWUgKS50b1N0cmluZygpO1xyXG4gICAgICBjb25zdCB2YWx1ZVRleHQgPSBvcHRpb25zLnNpZ25BZnRlclZhbHVlID8gYCR7YWJzb2x1dGVWYWx1ZVN0cmluZ30ke3NpZ259YCA6IGAke3NpZ259JHthYnNvbHV0ZVZhbHVlU3RyaW5nfWA7XHJcbiAgICAgIGNvbnN0IHRleHROb2RlID0gbmV3IFRleHQoIHZhbHVlVGV4dCwge1xyXG4gICAgICAgIGZvbnQ6IE5VTUJFUl9GT05ULFxyXG4gICAgICAgIGZpbGw6IG9wdGlvbnMuZ2V0VGV4dENvbG9yKCBuZXdWYWx1ZSApXHJcbiAgICAgIH0gKTtcclxuICAgICAgdGV4dE5vZGUuc2NhbGUoIE1hdGgubWluKCAxLCBNYXRoLm1pbiggKCBhbnN3ZXJWYWx1ZUJhY2tncm91bmQud2lkdGggKiAwLjggKSAvIHRleHROb2RlLndpZHRoLCAoIGFuc3dlclZhbHVlQmFja2dyb3VuZC5oZWlnaHQgKiAwLjkgKSAvIHRleHROb2RlLmhlaWdodCApICkgKTtcclxuICAgICAgdGV4dE5vZGUuY2VudGVyWCA9IGFuc3dlclZhbHVlQmFja2dyb3VuZC53aWR0aCAvIDI7XHJcbiAgICAgIHRleHROb2RlLmNlbnRlclkgPSBhbnN3ZXJWYWx1ZUJhY2tncm91bmQuaGVpZ2h0IC8gMjtcclxuICAgICAgYW5zd2VyVmFsdWVCYWNrZ3JvdW5kLmFkZENoaWxkKCB0ZXh0Tm9kZSApO1xyXG4gICAgICB1cEFycm93QnV0dG9uLmVuYWJsZWQgPSAoIG5ld1ZhbHVlIDwgb3B0aW9ucy5tYXhWYWx1ZSApO1xyXG4gICAgICBkb3duQXJyb3dCdXR0b24uZW5hYmxlZCA9ICggbmV3VmFsdWUgPiBvcHRpb25zLm1pblZhbHVlICk7XHJcbiAgICB9O1xyXG4gICAgbnVtYmVyUHJvcGVydHkubGluayggbnVtYmVyUHJvcGVydHlMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIExheW91dC4gIFVwcGVyIGxlZnQgY29ybmVyIG9mIG92ZXJhbGwgbm9kZSB3aWxsIGJlIGF0ICgwLDApLlxyXG4gICAgY29uc3QgaW50ZXJOb2RlU3BhY2luZyA9IHVwQXJyb3dCdXR0b24uaGVpZ2h0ICogMC4yO1xyXG4gICAgY29uc3QgdG90YWxIZWlnaHQgPSBNYXRoLm1heCggYW5zd2VyVmFsdWVCYWNrZ3JvdW5kLmhlaWdodCwgdXBBcnJvd0J1dHRvbi5oZWlnaHQgKyBkb3duQXJyb3dCdXR0b24uaGVpZ2h0ICsgaW50ZXJOb2RlU3BhY2luZyApO1xyXG4gICAgYW5zd2VyVmFsdWVCYWNrZ3JvdW5kLmxlZnQgPSAwO1xyXG4gICAgYW5zd2VyVmFsdWVCYWNrZ3JvdW5kLmNlbnRlclkgPSB0b3RhbEhlaWdodCAvIDI7XHJcbiAgICB1cEFycm93QnV0dG9uLmxlZnQgPSBhbnN3ZXJWYWx1ZUJhY2tncm91bmQucmlnaHQgKyBpbnRlck5vZGVTcGFjaW5nO1xyXG4gICAgdXBBcnJvd0J1dHRvbi5ib3R0b20gPSB0b3RhbEhlaWdodCAvIDIgLSBpbnRlck5vZGVTcGFjaW5nIC8gMjtcclxuICAgIGRvd25BcnJvd0J1dHRvbi50b3AgPSB0b3RhbEhlaWdodCAvIDIgKyBpbnRlck5vZGVTcGFjaW5nIC8gMjtcclxuICAgIGRvd25BcnJvd0J1dHRvbi5sZWZ0ID0gYW5zd2VyVmFsdWVCYWNrZ3JvdW5kLnJpZ2h0ICsgaW50ZXJOb2RlU3BhY2luZztcclxuXHJcbiAgICAvLyBTZXQgdXAgZXh0ZW5kZWQgdG91Y2ggYXJlYXMgZm9yIHRoZSB1cC9kb3duIGJ1dHRvbnMuICBUaGUgYXJlYXMgYXJlXHJcbiAgICAvLyBzZXQgdXAgc3VjaCB0aGF0IHRoZXkgZG9uJ3Qgb3ZlcmxhcCB3aXRoIG9uZSBhbm90aGVyLlxyXG4gICAgY29uc3QgdG91Y2hBcmVhWERpbGF0aW9uID0gdXBBcnJvd0J1dHRvbi53aWR0aCAqIDIuNTtcclxuICAgIGNvbnN0IHRvdWNoQXJlYVlEaWxhdGlvbiA9IHVwQXJyb3dCdXR0b24uaGVpZ2h0ICogMS40NTsgLy8gVHdlYWtlZCBmb3IgbWluaW1hbCBvdmVybGFwIGluIG1vc3QgbGF5b3V0cyB0aGF0IHVzZSB0aGlzLlxyXG4gICAgdXBBcnJvd0J1dHRvbi50b3VjaEFyZWEgPSBTaGFwZS5yZWN0YW5nbGUoXHJcbiAgICAgIC10b3VjaEFyZWFYRGlsYXRpb24gLyAyICsgdXBBcnJvd0J1dHRvbi53aWR0aCAvIDIsXHJcbiAgICAgIC10b3VjaEFyZWFZRGlsYXRpb24gKyB1cEFycm93QnV0dG9uLmhlaWdodCxcclxuICAgICAgdG91Y2hBcmVhWERpbGF0aW9uLFxyXG4gICAgICB0b3VjaEFyZWFZRGlsYXRpb25cclxuICAgICk7XHJcbiAgICBkb3duQXJyb3dCdXR0b24udG91Y2hBcmVhID0gU2hhcGUucmVjdGFuZ2xlKFxyXG4gICAgICAtdG91Y2hBcmVhWERpbGF0aW9uIC8gMiArIHVwQXJyb3dCdXR0b24ud2lkdGggLyAyLFxyXG4gICAgICAwLFxyXG4gICAgICB0b3VjaEFyZWFYRGlsYXRpb24sXHJcbiAgICAgIHRvdWNoQXJlYVlEaWxhdGlvblxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSBjYWxsZWQgYnkgZGlzcG9zZVxyXG4gICAgdGhpcy5kaXNwb3NlTnVtYmVyRW50cnlOb2RlID0gKCkgPT4ge1xyXG4gICAgICBudW1iZXJQcm9wZXJ0eS51bmxpbmsoIG51bWJlclByb3BlcnR5TGlzdGVuZXIgKTtcclxuICAgICAgdXBBcnJvd0J1dHRvbi5kaXNwb3NlKCk7XHJcbiAgICAgIGRvd25BcnJvd0J1dHRvbi5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMubXV0YXRlKCBvcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiByZWxlYXNlIHJlZmVyZW5jZXNcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgZGlzcG9zZSgpIHtcclxuICAgIHRoaXMuZGlzcG9zZU51bWJlckVudHJ5Tm9kZSgpO1xyXG5cclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbmJ1aWxkQW5BdG9tLnJlZ2lzdGVyKCAnTnVtYmVyRW50cnlOb2RlJywgTnVtYmVyRW50cnlOb2RlICk7XHJcblxyXG5leHBvcnQgZGVm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