// Copyright 2013-2023, University of Colorado Boulder

/**
 * Node that represents an element symbol where each of the numbers on the
 * symbol, i.e. proton count, mass number, and charge, can be interactive.
 *
 * @author John Blanco
 */

import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import merge from '../../../../phet-core/js/merge.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import PhetColorScheme from '../../../../scenery-phet/js/PhetColorScheme.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import AtomIdentifier from '../../../../shred/js/AtomIdentifier.js';
import ShredConstants from '../../../../shred/js/ShredConstants.js';
import buildAnAtom from '../../buildAnAtom.js';
import NumberEntryNode from './NumberEntryNode.js';

// constants
const SYMBOL_BOX_WIDTH = 275; // In screen coords, which are roughly pixels.
const SYMBOL_BOX_HEIGHT = 300; // In screen coords, which are roughly pixels.
const NUMBER_FONT = new PhetFont(56);
const NUMBER_INSET = 15; // In screen coords, which are roughly pixels.
const NUMBER_ENTRY_NODE_SIDE_INSET = 10; // In screen coords, which are roughly pixels.

class InteractiveSymbolNode extends Node {
  /**
   * Constructor
   * @param {NumberAtom} numberAtom
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(numberAtom, tandem, options) {
    super(options);
    options = merge({
      // defaults
      interactiveProtonCount: false,
      interactiveMassNumber: false,
      interactiveCharge: false
    }, options);
    this.protonCountProperty = new NumberProperty(options.interactiveProtonCount ? 0 : numberAtom.protonCountProperty.get(), {
      tandem: tandem.createTandem('protonCountProperty'),
      numberType: 'Integer'
    });
    this.massNumberProperty = new NumberProperty(options.interactiveMassNumber ? 0 : numberAtom.massNumberProperty.get(), {
      tandem: tandem.createTandem('massNumberProperty'),
      numberType: 'Integer'
    });
    this.chargeProperty = new NumberProperty(options.interactiveCharge ? 0 : numberAtom.chargeProperty.get(), {
      tandem: tandem.createTandem('chargeProperty'),
      numberType: 'Integer'
    });

    // Add the bounding box, which is also the root node for everything else
    // that comprises this node.
    const boundingBox = new Rectangle(0, 0, SYMBOL_BOX_WIDTH, SYMBOL_BOX_HEIGHT, 0, 0, {
      stroke: 'black',
      lineWidth: 2,
      fill: 'white'
    });
    this.addChild(boundingBox);

    // Add the symbol text.
    const symbolText = new Text('', {
      font: new PhetFont(150),
      fill: 'black',
      center: new Vector2(SYMBOL_BOX_WIDTH / 2, SYMBOL_BOX_HEIGHT / 2)
    });
    boundingBox.addChild(symbolText);

    // Add the element caption.
    const elementCaption = new Text('', {
      font: new PhetFont(40),
      fill: PhetColorScheme.RED_COLORBLIND,
      top: SYMBOL_BOX_HEIGHT + 20,
      centerX: SYMBOL_BOX_WIDTH / 2,
      maxWidth: SYMBOL_BOX_WIDTH
    });
    boundingBox.addChild(elementCaption);

    // Define a function to update the symbol text and element caption.
    const updateElement = protonCount => {
      symbolText.string = protonCount > 0 ? AtomIdentifier.getSymbol(protonCount) : '';
      symbolText.center = new Vector2(SYMBOL_BOX_WIDTH / 2, SYMBOL_BOX_HEIGHT / 2);
      elementCaption.string = protonCount > 0 ? AtomIdentifier.getName(protonCount) : '';
      elementCaption.centerX = SYMBOL_BOX_WIDTH / 2;
    };

    // So that the interactive and non-interactive numbers are vertically
    // aligned, we need to create a dummy number and look at its height.
    const interactiveNumberCenterYOffset = new Text('8', {
      font: NUMBER_FONT
    }).height / 2;

    // Add the proton count display, either interactive or not.
    if (options.interactiveProtonCount) {
      boundingBox.addChild(new NumberEntryNode(this.protonCountProperty, tandem.createTandem('protonCountEntryNode'), {
        minValue: 0,
        maxValue: 99,
        getTextColor: () => PhetColorScheme.RED_COLORBLIND,
        left: NUMBER_ENTRY_NODE_SIDE_INSET,
        centerY: SYMBOL_BOX_HEIGHT - NUMBER_INSET - interactiveNumberCenterYOffset
      }));
      this.protonCountProperty.link(updateElement);
    } else {
      const protonCountDisplay = new Text(numberAtom.protonCountProperty.get(), {
        font: NUMBER_FONT,
        fill: PhetColorScheme.RED_COLORBLIND,
        left: NUMBER_INSET,
        bottom: SYMBOL_BOX_HEIGHT - NUMBER_INSET
      });
      boundingBox.addChild(protonCountDisplay);
      updateElement(numberAtom.protonCountProperty.get());
    }

    // Add the mass number display, either interactive or not.
    if (options.interactiveMassNumber) {
      boundingBox.addChild(new NumberEntryNode(this.massNumberProperty, tandem.createTandem('massNumberEntryNode'), {
        minValue: 0,
        maxValue: 99,
        left: NUMBER_ENTRY_NODE_SIDE_INSET,
        centerY: NUMBER_INSET + interactiveNumberCenterYOffset
      }));
    } else {
      const massNumberDisplay = new Text(numberAtom.massNumberProperty.get(), {
        font: NUMBER_FONT,
        fill: 'black',
        left: NUMBER_INSET,
        top: NUMBER_INSET
      });
      boundingBox.addChild(massNumberDisplay);
    }

    // Add the charge display, either interactive or not.
    if (options.interactiveCharge) {
      boundingBox.addChild(new NumberEntryNode(this.chargeProperty, tandem.createTandem('chargeEntryNode'), {
        minValue: -99,
        maxValue: 99,
        showPlusForPositive: true,
        getTextColor: ShredConstants.CHARGE_TEXT_COLOR,
        right: SYMBOL_BOX_WIDTH - NUMBER_ENTRY_NODE_SIDE_INSET,
        centerY: NUMBER_INSET + interactiveNumberCenterYOffset
      }));
    } else {
      const charge = numberAtom.chargeProperty.value;
      const chargeSign = charge > 0 ? MathSymbols.PLUS : charge < 0 ? MathSymbols.MINUS : '';
      const chargeDisplay = new Text(`${Math.abs(charge).toString()}${chargeSign}`, {
        font: NUMBER_FONT,
        fill: ShredConstants.CHARGE_TEXT_COLOR(numberAtom.chargeProperty.get()),
        right: SYMBOL_BOX_WIDTH - NUMBER_INSET,
        top: NUMBER_INSET
      });
      boundingBox.addChild(chargeDisplay);
    }

    // @private called by dispose
    this.disposeInteractiveSymbolNode = () => {
      if (this.protonCountProperty.hasListener(updateElement)) {
        this.protonCountProperty.unlink(updateElement);
      }
      boundingBox.children.forEach(child => {
        child.dispose();
      });
      this.protonCountProperty.dispose();
      this.massNumberProperty.dispose();
      this.chargeProperty.dispose();
    };
  }

  // @public
  reset() {
    this.protonCountProperty.reset();
    this.massNumberProperty.reset();
    this.chargeProperty.reset();
  }

  /**
   * release references
   * @public
   */
  dispose() {
    this.disposeInteractiveSymbolNode();
    super.dispose();
  }
}
buildAnAtom.register('InteractiveSymbolNode', InteractiveSymbolNode);
export default InteractiveSymbolNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOdW1iZXJQcm9wZXJ0eSIsIlZlY3RvcjIiLCJtZXJnZSIsIk1hdGhTeW1ib2xzIiwiUGhldENvbG9yU2NoZW1lIiwiUGhldEZvbnQiLCJOb2RlIiwiUmVjdGFuZ2xlIiwiVGV4dCIsIkF0b21JZGVudGlmaWVyIiwiU2hyZWRDb25zdGFudHMiLCJidWlsZEFuQXRvbSIsIk51bWJlckVudHJ5Tm9kZSIsIlNZTUJPTF9CT1hfV0lEVEgiLCJTWU1CT0xfQk9YX0hFSUdIVCIsIk5VTUJFUl9GT05UIiwiTlVNQkVSX0lOU0VUIiwiTlVNQkVSX0VOVFJZX05PREVfU0lERV9JTlNFVCIsIkludGVyYWN0aXZlU3ltYm9sTm9kZSIsImNvbnN0cnVjdG9yIiwibnVtYmVyQXRvbSIsInRhbmRlbSIsIm9wdGlvbnMiLCJpbnRlcmFjdGl2ZVByb3RvbkNvdW50IiwiaW50ZXJhY3RpdmVNYXNzTnVtYmVyIiwiaW50ZXJhY3RpdmVDaGFyZ2UiLCJwcm90b25Db3VudFByb3BlcnR5IiwiZ2V0IiwiY3JlYXRlVGFuZGVtIiwibnVtYmVyVHlwZSIsIm1hc3NOdW1iZXJQcm9wZXJ0eSIsImNoYXJnZVByb3BlcnR5IiwiYm91bmRpbmdCb3giLCJzdHJva2UiLCJsaW5lV2lkdGgiLCJmaWxsIiwiYWRkQ2hpbGQiLCJzeW1ib2xUZXh0IiwiZm9udCIsImNlbnRlciIsImVsZW1lbnRDYXB0aW9uIiwiUkVEX0NPTE9SQkxJTkQiLCJ0b3AiLCJjZW50ZXJYIiwibWF4V2lkdGgiLCJ1cGRhdGVFbGVtZW50IiwicHJvdG9uQ291bnQiLCJzdHJpbmciLCJnZXRTeW1ib2wiLCJnZXROYW1lIiwiaW50ZXJhY3RpdmVOdW1iZXJDZW50ZXJZT2Zmc2V0IiwiaGVpZ2h0IiwibWluVmFsdWUiLCJtYXhWYWx1ZSIsImdldFRleHRDb2xvciIsImxlZnQiLCJjZW50ZXJZIiwibGluayIsInByb3RvbkNvdW50RGlzcGxheSIsImJvdHRvbSIsIm1hc3NOdW1iZXJEaXNwbGF5Iiwic2hvd1BsdXNGb3JQb3NpdGl2ZSIsIkNIQVJHRV9URVhUX0NPTE9SIiwicmlnaHQiLCJjaGFyZ2UiLCJ2YWx1ZSIsImNoYXJnZVNpZ24iLCJQTFVTIiwiTUlOVVMiLCJjaGFyZ2VEaXNwbGF5IiwiTWF0aCIsImFicyIsInRvU3RyaW5nIiwiZGlzcG9zZUludGVyYWN0aXZlU3ltYm9sTm9kZSIsImhhc0xpc3RlbmVyIiwidW5saW5rIiwiY2hpbGRyZW4iLCJmb3JFYWNoIiwiY2hpbGQiLCJkaXNwb3NlIiwicmVzZXQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkludGVyYWN0aXZlU3ltYm9sTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBOb2RlIHRoYXQgcmVwcmVzZW50cyBhbiBlbGVtZW50IHN5bWJvbCB3aGVyZSBlYWNoIG9mIHRoZSBudW1iZXJzIG9uIHRoZVxyXG4gKiBzeW1ib2wsIGkuZS4gcHJvdG9uIGNvdW50LCBtYXNzIG51bWJlciwgYW5kIGNoYXJnZSwgY2FuIGJlIGludGVyYWN0aXZlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvXHJcbiAqL1xyXG5cclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgTWF0aFN5bWJvbHMgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL01hdGhTeW1ib2xzLmpzJztcclxuaW1wb3J0IFBoZXRDb2xvclNjaGVtZSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldENvbG9yU2NoZW1lLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IE5vZGUsIFJlY3RhbmdsZSwgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBBdG9tSWRlbnRpZmllciBmcm9tICcuLi8uLi8uLi8uLi9zaHJlZC9qcy9BdG9tSWRlbnRpZmllci5qcyc7XHJcbmltcG9ydCBTaHJlZENvbnN0YW50cyBmcm9tICcuLi8uLi8uLi8uLi9zaHJlZC9qcy9TaHJlZENvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBidWlsZEFuQXRvbSBmcm9tICcuLi8uLi9idWlsZEFuQXRvbS5qcyc7XHJcbmltcG9ydCBOdW1iZXJFbnRyeU5vZGUgZnJvbSAnLi9OdW1iZXJFbnRyeU5vZGUuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IFNZTUJPTF9CT1hfV0lEVEggPSAyNzU7IC8vIEluIHNjcmVlbiBjb29yZHMsIHdoaWNoIGFyZSByb3VnaGx5IHBpeGVscy5cclxuY29uc3QgU1lNQk9MX0JPWF9IRUlHSFQgPSAzMDA7IC8vIEluIHNjcmVlbiBjb29yZHMsIHdoaWNoIGFyZSByb3VnaGx5IHBpeGVscy5cclxuY29uc3QgTlVNQkVSX0ZPTlQgPSBuZXcgUGhldEZvbnQoIDU2ICk7XHJcbmNvbnN0IE5VTUJFUl9JTlNFVCA9IDE1OyAvLyBJbiBzY3JlZW4gY29vcmRzLCB3aGljaCBhcmUgcm91Z2hseSBwaXhlbHMuXHJcbmNvbnN0IE5VTUJFUl9FTlRSWV9OT0RFX1NJREVfSU5TRVQgPSAxMDsgLy8gSW4gc2NyZWVuIGNvb3Jkcywgd2hpY2ggYXJlIHJvdWdobHkgcGl4ZWxzLlxyXG5cclxuY2xhc3MgSW50ZXJhY3RpdmVTeW1ib2xOb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIENvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtOdW1iZXJBdG9tfSBudW1iZXJBdG9tXHJcbiAgICogQHBhcmFtIHtUYW5kZW19IHRhbmRlbVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbnVtYmVyQXRvbSwgdGFuZGVtLCBvcHRpb25zICkge1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7IC8vIGRlZmF1bHRzXHJcbiAgICAgIGludGVyYWN0aXZlUHJvdG9uQ291bnQ6IGZhbHNlLFxyXG4gICAgICBpbnRlcmFjdGl2ZU1hc3NOdW1iZXI6IGZhbHNlLFxyXG4gICAgICBpbnRlcmFjdGl2ZUNoYXJnZTogZmFsc2VcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLnByb3RvbkNvdW50UHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIG9wdGlvbnMuaW50ZXJhY3RpdmVQcm90b25Db3VudCA/IDAgOiBudW1iZXJBdG9tLnByb3RvbkNvdW50UHJvcGVydHkuZ2V0KCksIHtcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAncHJvdG9uQ291bnRQcm9wZXJ0eScgKSxcclxuICAgICAgbnVtYmVyVHlwZTogJ0ludGVnZXInXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLm1hc3NOdW1iZXJQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggb3B0aW9ucy5pbnRlcmFjdGl2ZU1hc3NOdW1iZXIgPyAwIDogbnVtYmVyQXRvbS5tYXNzTnVtYmVyUHJvcGVydHkuZ2V0KCksIHtcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnbWFzc051bWJlclByb3BlcnR5JyApLFxyXG4gICAgICBudW1iZXJUeXBlOiAnSW50ZWdlcidcclxuICAgIH0gKTtcclxuICAgIHRoaXMuY2hhcmdlUHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIG9wdGlvbnMuaW50ZXJhY3RpdmVDaGFyZ2UgPyAwIDogbnVtYmVyQXRvbS5jaGFyZ2VQcm9wZXJ0eS5nZXQoKSwge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdjaGFyZ2VQcm9wZXJ0eScgKSxcclxuICAgICAgbnVtYmVyVHlwZTogJ0ludGVnZXInXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBib3VuZGluZyBib3gsIHdoaWNoIGlzIGFsc28gdGhlIHJvb3Qgbm9kZSBmb3IgZXZlcnl0aGluZyBlbHNlXHJcbiAgICAvLyB0aGF0IGNvbXByaXNlcyB0aGlzIG5vZGUuXHJcbiAgICBjb25zdCBib3VuZGluZ0JveCA9IG5ldyBSZWN0YW5nbGUoIDAsIDAsIFNZTUJPTF9CT1hfV0lEVEgsIFNZTUJPTF9CT1hfSEVJR0hULCAwLCAwLCB7XHJcbiAgICAgIHN0cm9rZTogJ2JsYWNrJyxcclxuICAgICAgbGluZVdpZHRoOiAyLFxyXG4gICAgICBmaWxsOiAnd2hpdGUnXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBib3VuZGluZ0JveCApO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgc3ltYm9sIHRleHQuXHJcbiAgICBjb25zdCBzeW1ib2xUZXh0ID0gbmV3IFRleHQoICcnLCB7XHJcbiAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggMTUwICksXHJcbiAgICAgIGZpbGw6ICdibGFjaycsXHJcbiAgICAgIGNlbnRlcjogbmV3IFZlY3RvcjIoIFNZTUJPTF9CT1hfV0lEVEggLyAyLCBTWU1CT0xfQk9YX0hFSUdIVCAvIDIgKVxyXG4gICAgfSApO1xyXG4gICAgYm91bmRpbmdCb3guYWRkQ2hpbGQoIHN5bWJvbFRleHQgKTtcclxuXHJcbiAgICAvLyBBZGQgdGhlIGVsZW1lbnQgY2FwdGlvbi5cclxuICAgIGNvbnN0IGVsZW1lbnRDYXB0aW9uID0gbmV3IFRleHQoICcnLCB7XHJcbiAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggNDAgKSxcclxuICAgICAgZmlsbDogUGhldENvbG9yU2NoZW1lLlJFRF9DT0xPUkJMSU5ELFxyXG4gICAgICB0b3A6IFNZTUJPTF9CT1hfSEVJR0hUICsgMjAsXHJcbiAgICAgIGNlbnRlclg6IFNZTUJPTF9CT1hfV0lEVEggLyAyLFxyXG4gICAgICBtYXhXaWR0aDogU1lNQk9MX0JPWF9XSURUSFxyXG4gICAgfSApO1xyXG4gICAgYm91bmRpbmdCb3guYWRkQ2hpbGQoIGVsZW1lbnRDYXB0aW9uICk7XHJcblxyXG4gICAgLy8gRGVmaW5lIGEgZnVuY3Rpb24gdG8gdXBkYXRlIHRoZSBzeW1ib2wgdGV4dCBhbmQgZWxlbWVudCBjYXB0aW9uLlxyXG4gICAgY29uc3QgdXBkYXRlRWxlbWVudCA9IHByb3RvbkNvdW50ID0+IHtcclxuICAgICAgc3ltYm9sVGV4dC5zdHJpbmcgPSBwcm90b25Db3VudCA+IDAgPyBBdG9tSWRlbnRpZmllci5nZXRTeW1ib2woIHByb3RvbkNvdW50ICkgOiAnJztcclxuICAgICAgc3ltYm9sVGV4dC5jZW50ZXIgPSBuZXcgVmVjdG9yMiggU1lNQk9MX0JPWF9XSURUSCAvIDIsIFNZTUJPTF9CT1hfSEVJR0hUIC8gMiApO1xyXG4gICAgICBlbGVtZW50Q2FwdGlvbi5zdHJpbmcgPSBwcm90b25Db3VudCA+IDAgPyBBdG9tSWRlbnRpZmllci5nZXROYW1lKCBwcm90b25Db3VudCApIDogJyc7XHJcbiAgICAgIGVsZW1lbnRDYXB0aW9uLmNlbnRlclggPSBTWU1CT0xfQk9YX1dJRFRIIC8gMjtcclxuICAgIH07XHJcblxyXG4gICAgLy8gU28gdGhhdCB0aGUgaW50ZXJhY3RpdmUgYW5kIG5vbi1pbnRlcmFjdGl2ZSBudW1iZXJzIGFyZSB2ZXJ0aWNhbGx5XHJcbiAgICAvLyBhbGlnbmVkLCB3ZSBuZWVkIHRvIGNyZWF0ZSBhIGR1bW15IG51bWJlciBhbmQgbG9vayBhdCBpdHMgaGVpZ2h0LlxyXG4gICAgY29uc3QgaW50ZXJhY3RpdmVOdW1iZXJDZW50ZXJZT2Zmc2V0ID0gbmV3IFRleHQoICc4JywgeyBmb250OiBOVU1CRVJfRk9OVCB9ICkuaGVpZ2h0IC8gMjtcclxuXHJcbiAgICAvLyBBZGQgdGhlIHByb3RvbiBjb3VudCBkaXNwbGF5LCBlaXRoZXIgaW50ZXJhY3RpdmUgb3Igbm90LlxyXG4gICAgaWYgKCBvcHRpb25zLmludGVyYWN0aXZlUHJvdG9uQ291bnQgKSB7XHJcbiAgICAgIGJvdW5kaW5nQm94LmFkZENoaWxkKCBuZXcgTnVtYmVyRW50cnlOb2RlKFxyXG4gICAgICAgIHRoaXMucHJvdG9uQ291bnRQcm9wZXJ0eSxcclxuICAgICAgICB0YW5kZW0uY3JlYXRlVGFuZGVtKCAncHJvdG9uQ291bnRFbnRyeU5vZGUnICksIHtcclxuICAgICAgICAgIG1pblZhbHVlOiAwLFxyXG4gICAgICAgICAgbWF4VmFsdWU6IDk5LFxyXG4gICAgICAgICAgZ2V0VGV4dENvbG9yOiAoKSA9PiBQaGV0Q29sb3JTY2hlbWUuUkVEX0NPTE9SQkxJTkQsXHJcbiAgICAgICAgICBsZWZ0OiBOVU1CRVJfRU5UUllfTk9ERV9TSURFX0lOU0VULFxyXG4gICAgICAgICAgY2VudGVyWTogU1lNQk9MX0JPWF9IRUlHSFQgLSBOVU1CRVJfSU5TRVQgLSBpbnRlcmFjdGl2ZU51bWJlckNlbnRlcllPZmZzZXRcclxuICAgICAgICB9ICkgKTtcclxuICAgICAgdGhpcy5wcm90b25Db3VudFByb3BlcnR5LmxpbmsoIHVwZGF0ZUVsZW1lbnQgKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBjb25zdCBwcm90b25Db3VudERpc3BsYXkgPSBuZXcgVGV4dCggbnVtYmVyQXRvbS5wcm90b25Db3VudFByb3BlcnR5LmdldCgpLCB7XHJcbiAgICAgICAgZm9udDogTlVNQkVSX0ZPTlQsXHJcbiAgICAgICAgZmlsbDogUGhldENvbG9yU2NoZW1lLlJFRF9DT0xPUkJMSU5ELFxyXG4gICAgICAgIGxlZnQ6IE5VTUJFUl9JTlNFVCxcclxuICAgICAgICBib3R0b206IFNZTUJPTF9CT1hfSEVJR0hUIC0gTlVNQkVSX0lOU0VUXHJcbiAgICAgIH0gKTtcclxuICAgICAgYm91bmRpbmdCb3guYWRkQ2hpbGQoIHByb3RvbkNvdW50RGlzcGxheSApO1xyXG4gICAgICB1cGRhdGVFbGVtZW50KCBudW1iZXJBdG9tLnByb3RvbkNvdW50UHJvcGVydHkuZ2V0KCkgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBZGQgdGhlIG1hc3MgbnVtYmVyIGRpc3BsYXksIGVpdGhlciBpbnRlcmFjdGl2ZSBvciBub3QuXHJcbiAgICBpZiAoIG9wdGlvbnMuaW50ZXJhY3RpdmVNYXNzTnVtYmVyICkge1xyXG4gICAgICBib3VuZGluZ0JveC5hZGRDaGlsZCggbmV3IE51bWJlckVudHJ5Tm9kZShcclxuICAgICAgICB0aGlzLm1hc3NOdW1iZXJQcm9wZXJ0eSxcclxuICAgICAgICB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnbWFzc051bWJlckVudHJ5Tm9kZScgKSwge1xyXG4gICAgICAgICAgbWluVmFsdWU6IDAsXHJcbiAgICAgICAgICBtYXhWYWx1ZTogOTksXHJcbiAgICAgICAgICBsZWZ0OiBOVU1CRVJfRU5UUllfTk9ERV9TSURFX0lOU0VULFxyXG4gICAgICAgICAgY2VudGVyWTogTlVNQkVSX0lOU0VUICsgaW50ZXJhY3RpdmVOdW1iZXJDZW50ZXJZT2Zmc2V0XHJcbiAgICAgICAgfSApICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgY29uc3QgbWFzc051bWJlckRpc3BsYXkgPSBuZXcgVGV4dCggbnVtYmVyQXRvbS5tYXNzTnVtYmVyUHJvcGVydHkuZ2V0KCksIHtcclxuICAgICAgICBmb250OiBOVU1CRVJfRk9OVCxcclxuICAgICAgICBmaWxsOiAnYmxhY2snLFxyXG4gICAgICAgIGxlZnQ6IE5VTUJFUl9JTlNFVCxcclxuICAgICAgICB0b3A6IE5VTUJFUl9JTlNFVFxyXG4gICAgICB9ICk7XHJcbiAgICAgIGJvdW5kaW5nQm94LmFkZENoaWxkKCBtYXNzTnVtYmVyRGlzcGxheSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCB0aGUgY2hhcmdlIGRpc3BsYXksIGVpdGhlciBpbnRlcmFjdGl2ZSBvciBub3QuXHJcbiAgICBpZiAoIG9wdGlvbnMuaW50ZXJhY3RpdmVDaGFyZ2UgKSB7XHJcbiAgICAgIGJvdW5kaW5nQm94LmFkZENoaWxkKCBuZXcgTnVtYmVyRW50cnlOb2RlKFxyXG4gICAgICAgIHRoaXMuY2hhcmdlUHJvcGVydHksXHJcbiAgICAgICAgdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2NoYXJnZUVudHJ5Tm9kZScgKSwge1xyXG4gICAgICAgICAgbWluVmFsdWU6IC05OSxcclxuICAgICAgICAgIG1heFZhbHVlOiA5OSxcclxuICAgICAgICAgIHNob3dQbHVzRm9yUG9zaXRpdmU6IHRydWUsXHJcbiAgICAgICAgICBnZXRUZXh0Q29sb3I6IFNocmVkQ29uc3RhbnRzLkNIQVJHRV9URVhUX0NPTE9SLFxyXG4gICAgICAgICAgcmlnaHQ6IFNZTUJPTF9CT1hfV0lEVEggLSBOVU1CRVJfRU5UUllfTk9ERV9TSURFX0lOU0VULFxyXG4gICAgICAgICAgY2VudGVyWTogTlVNQkVSX0lOU0VUICsgaW50ZXJhY3RpdmVOdW1iZXJDZW50ZXJZT2Zmc2V0XHJcbiAgICAgICAgfSApICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgY29uc3QgY2hhcmdlID0gbnVtYmVyQXRvbS5jaGFyZ2VQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgY29uc3QgY2hhcmdlU2lnbiA9IGNoYXJnZSA+IDAgPyBNYXRoU3ltYm9scy5QTFVTIDogY2hhcmdlIDwgMCA/IE1hdGhTeW1ib2xzLk1JTlVTIDogJyc7XHJcbiAgICAgIGNvbnN0IGNoYXJnZURpc3BsYXkgPSBuZXcgVGV4dCggYCR7TWF0aC5hYnMoIGNoYXJnZSApLnRvU3RyaW5nKCl9JHtjaGFyZ2VTaWdufWAsIHtcclxuICAgICAgICBmb250OiBOVU1CRVJfRk9OVCxcclxuICAgICAgICBmaWxsOiBTaHJlZENvbnN0YW50cy5DSEFSR0VfVEVYVF9DT0xPUiggbnVtYmVyQXRvbS5jaGFyZ2VQcm9wZXJ0eS5nZXQoKSApLFxyXG4gICAgICAgIHJpZ2h0OiBTWU1CT0xfQk9YX1dJRFRIIC0gTlVNQkVSX0lOU0VULFxyXG4gICAgICAgIHRvcDogTlVNQkVSX0lOU0VUXHJcbiAgICAgIH0gKTtcclxuICAgICAgYm91bmRpbmdCb3guYWRkQ2hpbGQoIGNoYXJnZURpc3BsYXkgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBAcHJpdmF0ZSBjYWxsZWQgYnkgZGlzcG9zZVxyXG4gICAgdGhpcy5kaXNwb3NlSW50ZXJhY3RpdmVTeW1ib2xOb2RlID0gKCkgPT4ge1xyXG4gICAgICBpZiAoIHRoaXMucHJvdG9uQ291bnRQcm9wZXJ0eS5oYXNMaXN0ZW5lciggdXBkYXRlRWxlbWVudCApICkge1xyXG4gICAgICAgIHRoaXMucHJvdG9uQ291bnRQcm9wZXJ0eS51bmxpbmsoIHVwZGF0ZUVsZW1lbnQgKTtcclxuICAgICAgfVxyXG4gICAgICBib3VuZGluZ0JveC5jaGlsZHJlbi5mb3JFYWNoKCBjaGlsZCA9PiB7IGNoaWxkLmRpc3Bvc2UoKTsgfSApO1xyXG4gICAgICB0aGlzLnByb3RvbkNvdW50UHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgICB0aGlzLm1hc3NOdW1iZXJQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICAgIHRoaXMuY2hhcmdlUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIEBwdWJsaWNcclxuICByZXNldCgpIHtcclxuICAgIHRoaXMucHJvdG9uQ291bnRQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5tYXNzTnVtYmVyUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMuY2hhcmdlUHJvcGVydHkucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHJlbGVhc2UgcmVmZXJlbmNlc1xyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBkaXNwb3NlKCkge1xyXG4gICAgdGhpcy5kaXNwb3NlSW50ZXJhY3RpdmVTeW1ib2xOb2RlKCk7XHJcblxyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuYnVpbGRBbkF0b20ucmVnaXN0ZXIoICdJbnRlcmFjdGl2ZVN5bWJvbE5vZGUnLCBJbnRlcmFjdGl2ZVN5bWJvbE5vZGUgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEludGVyYWN0aXZlU3ltYm9sTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxjQUFjLE1BQU0sdUNBQXVDO0FBQ2xFLE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsT0FBT0MsS0FBSyxNQUFNLG1DQUFtQztBQUNyRCxPQUFPQyxXQUFXLE1BQU0sNENBQTRDO0FBQ3BFLE9BQU9DLGVBQWUsTUFBTSxnREFBZ0Q7QUFDNUUsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxTQUFTQyxJQUFJLEVBQUVDLFNBQVMsRUFBRUMsSUFBSSxRQUFRLG1DQUFtQztBQUN6RSxPQUFPQyxjQUFjLE1BQU0sd0NBQXdDO0FBQ25FLE9BQU9DLGNBQWMsTUFBTSx3Q0FBd0M7QUFDbkUsT0FBT0MsV0FBVyxNQUFNLHNCQUFzQjtBQUM5QyxPQUFPQyxlQUFlLE1BQU0sc0JBQXNCOztBQUVsRDtBQUNBLE1BQU1DLGdCQUFnQixHQUFHLEdBQUcsQ0FBQyxDQUFDO0FBQzlCLE1BQU1DLGlCQUFpQixHQUFHLEdBQUcsQ0FBQyxDQUFDO0FBQy9CLE1BQU1DLFdBQVcsR0FBRyxJQUFJVixRQUFRLENBQUUsRUFBRyxDQUFDO0FBQ3RDLE1BQU1XLFlBQVksR0FBRyxFQUFFLENBQUMsQ0FBQztBQUN6QixNQUFNQyw0QkFBNEIsR0FBRyxFQUFFLENBQUMsQ0FBQzs7QUFFekMsTUFBTUMscUJBQXFCLFNBQVNaLElBQUksQ0FBQztFQUV2QztBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRWEsV0FBV0EsQ0FBRUMsVUFBVSxFQUFFQyxNQUFNLEVBQUVDLE9BQU8sRUFBRztJQUV6QyxLQUFLLENBQUVBLE9BQVEsQ0FBQztJQUVoQkEsT0FBTyxHQUFHcEIsS0FB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