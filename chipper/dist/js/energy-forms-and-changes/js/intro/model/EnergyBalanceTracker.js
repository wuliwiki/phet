// Copyright 2019-2020, University of Colorado Boulder

/**
 * An object that is used to track energy that is exchanged between pairs of entities and accumulate the total balance.
 *
 * @author John Blanco
 */

import energyFormsAndChanges from '../../energyFormsAndChanges.js';
import EnergyBalanceRecord from './EnergyBalanceRecord.js';
class EnergyBalanceTracker {
  constructor() {
    // @private - array where the energy exchange records are kept
    this.energyBalanceRecords = [];
  }

  /**
   * log an amount of energy that was exchanged between to entities with the provided IDs
   * @param {string} fromID
   * @param {string} toID
   * @param {number} energyAmount
   * @public
   */
  logEnergyExchange(fromID, toID, energyAmount) {
    // for efficiency, bail out right away if the energy amount is zero, since it won't have any effect
    if (energyAmount === 0) {
      return;
    }
    let fromIDForEntry;
    let toIDForEntry;
    let energyAmountToLog;

    // So that we don't end up with multiple records for exchanges between a single pair of entities, reorder the
    // provided IDs and reverse the order of energy if necessary.
    if (fromID < toID) {
      fromIDForEntry = fromID;
      toIDForEntry = toID;
      energyAmountToLog = energyAmount;
    } else {
      fromIDForEntry = toID;
      toIDForEntry = fromID;
      energyAmountToLog = -energyAmount;
    }

    // look through the records for one that matches, use C-style loops for best performance
    let energyBalanceRecord = null;
    for (let i = 0; i < this.energyBalanceRecords.length; i++) {
      const tempRecord = this.energyBalanceRecords[i];
      if (tempRecord.fromID === fromIDForEntry && tempRecord.toID === toIDForEntry) {
        energyBalanceRecord = tempRecord;
        break;
      }
    }
    if (!energyBalanceRecord) {
      // create and add a new record
      this.energyBalanceRecords.push(new EnergyBalanceRecord(fromIDForEntry, toIDForEntry, energyAmountToLog));
    } else {
      // this pair has an entry already, adjust it by the provided amount
      energyBalanceRecord.energyBalance += energyAmountToLog;
      energyBalanceRecord.recentlyUpdated = true;
    }
  }

  /**
   * get all records whose energy balance magnitude exceeds the provided threshold
   * @param {number} threshold - amount of energy
   * @param {boolean} recentlyUpdatedOnly - indicates whether only recently updated records should be included
   * @param {Array} resultsArray - array where results are returned, this is done to reduce memory allocations
   * @returns {EnergyBalanceRecord[]}
   * @public
   */
  getBalancesOverThreshold(threshold, recentlyUpdatedOnly, resultsArray) {
    let currentRecord;

    // c-style loop for best performance
    for (let i = 0; i < this.energyBalanceRecords.length; i++) {
      currentRecord = this.energyBalanceRecords[i];
      if (Math.abs(currentRecord.energyBalance) > threshold && (currentRecord.recentlyUpdated || !recentlyUpdatedOnly)) {
        resultsArray.push(currentRecord);
      }
    }
    return resultsArray;
  }

  /**
   * get the balances between the provided ID and all other entities with whom balances are being tracked
   * @param {string} id - ID of the entity whose balances are requested
   * @param {boolean} recentlyUpdateOnly
   * @returns {EnergyBalanceRecord[]}
   * @public
   */
  getBalancesForID(id, recentlyUpdateOnly) {
    const resultsArray = [];

    // c-style loop for best performance
    for (let i = 0; i < this.energyBalanceRecords.length; i++) {
      const currentRecord = this.energyBalanceRecords[i];
      if ((currentRecord.fromID === id || currentRecord.toID === id) && (!recentlyUpdateOnly || currentRecord.recentlyUpdated)) {
        resultsArray.push(currentRecord);
      }
    }
    return resultsArray;
  }

  /**
   * clear the energy balance for all records
   * @public
   */
  clearAllBalances() {
    this.energyBalanceRecords.forEach(energyBalanceRecord => {
      energyBalanceRecord.energyBalance = 0;
    });
  }

  /**
   * clear the flags that are used to determine whether energy was recently transferred
   * @public
   */
  clearRecentlyUpdatedFlags() {
    this.energyBalanceRecords.forEach(energyBalanceRecord => {
      energyBalanceRecord.recentlyUpdated = false;
    });
  }
}
energyFormsAndChanges.register('EnergyBalanceTracker', EnergyBalanceTracker);
export default EnergyBalanceTracker;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJlbmVyZ3lGb3Jtc0FuZENoYW5nZXMiLCJFbmVyZ3lCYWxhbmNlUmVjb3JkIiwiRW5lcmd5QmFsYW5jZVRyYWNrZXIiLCJjb25zdHJ1Y3RvciIsImVuZXJneUJhbGFuY2VSZWNvcmRzIiwibG9nRW5lcmd5RXhjaGFuZ2UiLCJmcm9tSUQiLCJ0b0lEIiwiZW5lcmd5QW1vdW50IiwiZnJvbUlERm9yRW50cnkiLCJ0b0lERm9yRW50cnkiLCJlbmVyZ3lBbW91bnRUb0xvZyIsImVuZXJneUJhbGFuY2VSZWNvcmQiLCJpIiwibGVuZ3RoIiwidGVtcFJlY29yZCIsInB1c2giLCJlbmVyZ3lCYWxhbmNlIiwicmVjZW50bHlVcGRhdGVkIiwiZ2V0QmFsYW5jZXNPdmVyVGhyZXNob2xkIiwidGhyZXNob2xkIiwicmVjZW50bHlVcGRhdGVkT25seSIsInJlc3VsdHNBcnJheSIsImN1cnJlbnRSZWNvcmQiLCJNYXRoIiwiYWJzIiwiZ2V0QmFsYW5jZXNGb3JJRCIsImlkIiwicmVjZW50bHlVcGRhdGVPbmx5IiwiY2xlYXJBbGxCYWxhbmNlcyIsImZvckVhY2giLCJjbGVhclJlY2VudGx5VXBkYXRlZEZsYWdzIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJFbmVyZ3lCYWxhbmNlVHJhY2tlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDIwLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBbiBvYmplY3QgdGhhdCBpcyB1c2VkIHRvIHRyYWNrIGVuZXJneSB0aGF0IGlzIGV4Y2hhbmdlZCBiZXR3ZWVuIHBhaXJzIG9mIGVudGl0aWVzIGFuZCBhY2N1bXVsYXRlIHRoZSB0b3RhbCBiYWxhbmNlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvXHJcbiAqL1xyXG5cclxuaW1wb3J0IGVuZXJneUZvcm1zQW5kQ2hhbmdlcyBmcm9tICcuLi8uLi9lbmVyZ3lGb3Jtc0FuZENoYW5nZXMuanMnO1xyXG5pbXBvcnQgRW5lcmd5QmFsYW5jZVJlY29yZCBmcm9tICcuL0VuZXJneUJhbGFuY2VSZWNvcmQuanMnO1xyXG5cclxuY2xhc3MgRW5lcmd5QmFsYW5jZVRyYWNrZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSAtIGFycmF5IHdoZXJlIHRoZSBlbmVyZ3kgZXhjaGFuZ2UgcmVjb3JkcyBhcmUga2VwdFxyXG4gICAgdGhpcy5lbmVyZ3lCYWxhbmNlUmVjb3JkcyA9IFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogbG9nIGFuIGFtb3VudCBvZiBlbmVyZ3kgdGhhdCB3YXMgZXhjaGFuZ2VkIGJldHdlZW4gdG8gZW50aXRpZXMgd2l0aCB0aGUgcHJvdmlkZWQgSURzXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZyb21JRFxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0b0lEXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGVuZXJneUFtb3VudFxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBsb2dFbmVyZ3lFeGNoYW5nZSggZnJvbUlELCB0b0lELCBlbmVyZ3lBbW91bnQgKSB7XHJcblxyXG4gICAgLy8gZm9yIGVmZmljaWVuY3ksIGJhaWwgb3V0IHJpZ2h0IGF3YXkgaWYgdGhlIGVuZXJneSBhbW91bnQgaXMgemVybywgc2luY2UgaXQgd29uJ3QgaGF2ZSBhbnkgZWZmZWN0XHJcbiAgICBpZiAoIGVuZXJneUFtb3VudCA9PT0gMCApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBmcm9tSURGb3JFbnRyeTtcclxuICAgIGxldCB0b0lERm9yRW50cnk7XHJcbiAgICBsZXQgZW5lcmd5QW1vdW50VG9Mb2c7XHJcblxyXG4gICAgLy8gU28gdGhhdCB3ZSBkb24ndCBlbmQgdXAgd2l0aCBtdWx0aXBsZSByZWNvcmRzIGZvciBleGNoYW5nZXMgYmV0d2VlbiBhIHNpbmdsZSBwYWlyIG9mIGVudGl0aWVzLCByZW9yZGVyIHRoZVxyXG4gICAgLy8gcHJvdmlkZWQgSURzIGFuZCByZXZlcnNlIHRoZSBvcmRlciBvZiBlbmVyZ3kgaWYgbmVjZXNzYXJ5LlxyXG4gICAgaWYgKCBmcm9tSUQgPCB0b0lEICkge1xyXG4gICAgICBmcm9tSURGb3JFbnRyeSA9IGZyb21JRDtcclxuICAgICAgdG9JREZvckVudHJ5ID0gdG9JRDtcclxuICAgICAgZW5lcmd5QW1vdW50VG9Mb2cgPSBlbmVyZ3lBbW91bnQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgZnJvbUlERm9yRW50cnkgPSB0b0lEO1xyXG4gICAgICB0b0lERm9yRW50cnkgPSBmcm9tSUQ7XHJcbiAgICAgIGVuZXJneUFtb3VudFRvTG9nID0gLWVuZXJneUFtb3VudDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBsb29rIHRocm91Z2ggdGhlIHJlY29yZHMgZm9yIG9uZSB0aGF0IG1hdGNoZXMsIHVzZSBDLXN0eWxlIGxvb3BzIGZvciBiZXN0IHBlcmZvcm1hbmNlXHJcbiAgICBsZXQgZW5lcmd5QmFsYW5jZVJlY29yZCA9IG51bGw7XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmVuZXJneUJhbGFuY2VSZWNvcmRzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBjb25zdCB0ZW1wUmVjb3JkID0gdGhpcy5lbmVyZ3lCYWxhbmNlUmVjb3Jkc1sgaSBdO1xyXG4gICAgICBpZiAoIHRlbXBSZWNvcmQuZnJvbUlEID09PSBmcm9tSURGb3JFbnRyeSAmJiB0ZW1wUmVjb3JkLnRvSUQgPT09IHRvSURGb3JFbnRyeSApIHtcclxuICAgICAgICBlbmVyZ3lCYWxhbmNlUmVjb3JkID0gdGVtcFJlY29yZDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICggIWVuZXJneUJhbGFuY2VSZWNvcmQgKSB7XHJcblxyXG4gICAgICAvLyBjcmVhdGUgYW5kIGFkZCBhIG5ldyByZWNvcmRcclxuICAgICAgdGhpcy5lbmVyZ3lCYWxhbmNlUmVjb3Jkcy5wdXNoKCBuZXcgRW5lcmd5QmFsYW5jZVJlY29yZCggZnJvbUlERm9yRW50cnksIHRvSURGb3JFbnRyeSwgZW5lcmd5QW1vdW50VG9Mb2cgKSApO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcblxyXG4gICAgICAvLyB0aGlzIHBhaXIgaGFzIGFuIGVudHJ5IGFscmVhZHksIGFkanVzdCBpdCBieSB0aGUgcHJvdmlkZWQgYW1vdW50XHJcbiAgICAgIGVuZXJneUJhbGFuY2VSZWNvcmQuZW5lcmd5QmFsYW5jZSArPSBlbmVyZ3lBbW91bnRUb0xvZztcclxuICAgICAgZW5lcmd5QmFsYW5jZVJlY29yZC5yZWNlbnRseVVwZGF0ZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZ2V0IGFsbCByZWNvcmRzIHdob3NlIGVuZXJneSBiYWxhbmNlIG1hZ25pdHVkZSBleGNlZWRzIHRoZSBwcm92aWRlZCB0aHJlc2hvbGRcclxuICAgKiBAcGFyYW0ge251bWJlcn0gdGhyZXNob2xkIC0gYW1vdW50IG9mIGVuZXJneVxyXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gcmVjZW50bHlVcGRhdGVkT25seSAtIGluZGljYXRlcyB3aGV0aGVyIG9ubHkgcmVjZW50bHkgdXBkYXRlZCByZWNvcmRzIHNob3VsZCBiZSBpbmNsdWRlZFxyXG4gICAqIEBwYXJhbSB7QXJyYXl9IHJlc3VsdHNBcnJheSAtIGFycmF5IHdoZXJlIHJlc3VsdHMgYXJlIHJldHVybmVkLCB0aGlzIGlzIGRvbmUgdG8gcmVkdWNlIG1lbW9yeSBhbGxvY2F0aW9uc1xyXG4gICAqIEByZXR1cm5zIHtFbmVyZ3lCYWxhbmNlUmVjb3JkW119XHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIGdldEJhbGFuY2VzT3ZlclRocmVzaG9sZCggdGhyZXNob2xkLCByZWNlbnRseVVwZGF0ZWRPbmx5LCByZXN1bHRzQXJyYXkgKSB7XHJcblxyXG4gICAgbGV0IGN1cnJlbnRSZWNvcmQ7XHJcblxyXG4gICAgLy8gYy1zdHlsZSBsb29wIGZvciBiZXN0IHBlcmZvcm1hbmNlXHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmVuZXJneUJhbGFuY2VSZWNvcmRzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBjdXJyZW50UmVjb3JkID0gdGhpcy5lbmVyZ3lCYWxhbmNlUmVjb3Jkc1sgaSBdO1xyXG4gICAgICBpZiAoIE1hdGguYWJzKCBjdXJyZW50UmVjb3JkLmVuZXJneUJhbGFuY2UgKSA+IHRocmVzaG9sZCAmJiAoIGN1cnJlbnRSZWNvcmQucmVjZW50bHlVcGRhdGVkIHx8ICFyZWNlbnRseVVwZGF0ZWRPbmx5ICkgKSB7XHJcbiAgICAgICAgcmVzdWx0c0FycmF5LnB1c2goIGN1cnJlbnRSZWNvcmQgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdHNBcnJheTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIGdldCB0aGUgYmFsYW5jZXMgYmV0d2VlbiB0aGUgcHJvdmlkZWQgSUQgYW5kIGFsbCBvdGhlciBlbnRpdGllcyB3aXRoIHdob20gYmFsYW5jZXMgYXJlIGJlaW5nIHRyYWNrZWRcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSBJRCBvZiB0aGUgZW50aXR5IHdob3NlIGJhbGFuY2VzIGFyZSByZXF1ZXN0ZWRcclxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHJlY2VudGx5VXBkYXRlT25seVxyXG4gICAqIEByZXR1cm5zIHtFbmVyZ3lCYWxhbmNlUmVjb3JkW119XHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIGdldEJhbGFuY2VzRm9ySUQoIGlkLCByZWNlbnRseVVwZGF0ZU9ubHkgKSB7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0c0FycmF5ID0gW107XHJcblxyXG4gICAgLy8gYy1zdHlsZSBsb29wIGZvciBiZXN0IHBlcmZvcm1hbmNlXHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmVuZXJneUJhbGFuY2VSZWNvcmRzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBjb25zdCBjdXJyZW50UmVjb3JkID0gdGhpcy5lbmVyZ3lCYWxhbmNlUmVjb3Jkc1sgaSBdO1xyXG4gICAgICBpZiAoICggY3VycmVudFJlY29yZC5mcm9tSUQgPT09IGlkIHx8IGN1cnJlbnRSZWNvcmQudG9JRCA9PT0gaWQgKSAmJlxyXG4gICAgICAgICAgICggIXJlY2VudGx5VXBkYXRlT25seSB8fCBjdXJyZW50UmVjb3JkLnJlY2VudGx5VXBkYXRlZCApICkge1xyXG4gICAgICAgIHJlc3VsdHNBcnJheS5wdXNoKCBjdXJyZW50UmVjb3JkICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHRzQXJyYXk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBjbGVhciB0aGUgZW5lcmd5IGJhbGFuY2UgZm9yIGFsbCByZWNvcmRzXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIGNsZWFyQWxsQmFsYW5jZXMoKSB7XHJcbiAgICB0aGlzLmVuZXJneUJhbGFuY2VSZWNvcmRzLmZvckVhY2goIGVuZXJneUJhbGFuY2VSZWNvcmQgPT4ge1xyXG4gICAgICBlbmVyZ3lCYWxhbmNlUmVjb3JkLmVuZXJneUJhbGFuY2UgPSAwO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogY2xlYXIgdGhlIGZsYWdzIHRoYXQgYXJlIHVzZWQgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgZW5lcmd5IHdhcyByZWNlbnRseSB0cmFuc2ZlcnJlZFxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBjbGVhclJlY2VudGx5VXBkYXRlZEZsYWdzKCkge1xyXG4gICAgdGhpcy5lbmVyZ3lCYWxhbmNlUmVjb3Jkcy5mb3JFYWNoKCBlbmVyZ3lCYWxhbmNlUmVjb3JkID0+IHtcclxuICAgICAgZW5lcmd5QmFsYW5jZVJlY29yZC5yZWNlbnRseVVwZGF0ZWQgPSBmYWxzZTtcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbmVuZXJneUZvcm1zQW5kQ2hhbmdlcy5yZWdpc3RlciggJ0VuZXJneUJhbGFuY2VUcmFja2VyJywgRW5lcmd5QmFsYW5jZVRyYWNrZXIgKTtcclxuZXhwb3J0IGRlZmF1bHQgRW5lcmd5QmFsYW5jZVRyYWNrZXI7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLHFCQUFxQixNQUFNLGdDQUFnQztBQUNsRSxPQUFPQyxtQkFBbUIsTUFBTSwwQkFBMEI7QUFFMUQsTUFBTUMsb0JBQW9CLENBQUM7RUFFekJDLFdBQVdBLENBQUEsRUFBRztJQUVaO0lBQ0EsSUFBSSxDQUFDQyxvQkFBb0IsR0FBRyxFQUFFO0VBQ2hDOztFQUVBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0VDLGlCQUFpQkEsQ0FBRUMsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLFlBQVksRUFBRztJQUU5QztJQUNBLElBQUtBLFlBQVksS0FBSyxDQUFDLEVBQUc7TUFDeEI7SUFDRjtJQUVBLElBQUlDLGNBQWM7SUFDbEIsSUFBSUMsWUFBWTtJQUNoQixJQUFJQyxpQkFBaUI7O0lBRXJCO0lBQ0E7SUFDQSxJQUFLTCxNQUFNLEdBQUdDLElBQUksRUFBRztNQUNuQkUsY0FBYyxHQUFHSCxNQUFNO01BQ3ZCSSxZQUFZLEdBQUdILElBQUk7TUFDbkJJLGlCQUFpQixHQUFHSCxZQUFZO0lBQ2xDLENBQUMsTUFDSTtNQUNIQyxjQUFjLEdBQUdGLElBQUk7TUFDckJHLFlBQVksR0FBR0osTUFBTTtNQUNyQkssaUJBQWlCLEdBQUcsQ0FBQ0gsWUFBWTtJQUNuQzs7SUFFQTtJQUNBLElBQUlJLG1CQUFtQixHQUFHLElBQUk7SUFDOUIsS0FBTSxJQUFJQyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUcsSUFBSSxDQUFDVCxvQkFBb0IsQ0FBQ1UsTUFBTSxFQUFFRCxDQUFDLEVBQUUsRUFBRztNQUMzRCxNQUFNRSxVQUFVLEdBQUcsSUFBSSxDQUFDWCxvQkFBb0IsQ0FBRVMsQ0FBQyxDQUFFO01B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