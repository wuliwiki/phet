// Copyright 2016-2021, University of Colorado Boulder

/**
 * Common screen view for vectors screen.
 *
 * @author Matt Pennington (PhET Interactive Simulations)
 * @author Denzell Barnett (PhET Interactive Simulations)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import { VBox } from '../../../../scenery/js/imports.js';
import MassesAndSpringsConstants from '../../common/MassesAndSpringsConstants.js';
import ReferenceLineNode from '../../common/view/ReferenceLineNode.js';
import TwoSpringScreenView from '../../common/view/TwoSpringScreenView.js';
import massesAndSprings from '../../massesAndSprings.js';
import DisplacementArrowNode from './DisplacementArrowNode.js';
import VectorVisibilityControlNode from './VectorVisibilityControlNode.js';
class VectorsScreenView extends TwoSpringScreenView {
  /**
   * @param {VectorsModel} model
   * @param {Tandem} tandem
   */
  constructor(model, tandem) {
    super(model, tandem);
    // Displacement arrows added for each springs
    const firstDisplacementArrowNode = new DisplacementArrowNode(this.springNodes[0].nodeProperty.value.spring.displacementProperty, model.naturalLengthVisibleProperty, tandem, {
      modelViewTransform: this.modelViewTransform,
      left: this.springNodes[0].nodeProperty.value.right + 8,
      centerY: this.modelViewTransform.modelToViewY(this.springNodes[0].nodeProperty.value.spring.bottomProperty.value)
    });
    this.addChild(firstDisplacementArrowNode);
    const secondDisplacementArrowNode = new DisplacementArrowNode(this.springNodes[1].nodeProperty.value.spring.displacementProperty, model.naturalLengthVisibleProperty, tandem, {
      modelViewTransform: this.modelViewTransform,
      right: this.springNodes[1].nodeProperty.value.left + 14,
      centerY: this.modelViewTransform.modelToViewY(this.springNodes[1].nodeProperty.value.spring.bottomProperty.value)
    });
    this.addChild(secondDisplacementArrowNode);

    // Equilibrium of mass is dependent on the mass being attached and the visibility of the equilibrium line.
    const firstMassEquilibriumVisibilityProperty = new DerivedProperty([model.equilibriumPositionVisibleProperty, model.firstSpring.massAttachedProperty], (equilibriumPositionVisible, massAttached) => !!massAttached && equilibriumPositionVisible);
    const secondMassEquilibriumVisibilityProperty = new DerivedProperty([model.equilibriumPositionVisibleProperty, model.secondSpring.massAttachedProperty], (equilibriumPositionVisible, massAttached) => !!massAttached && equilibriumPositionVisible);

    // Initializes equilibrium line for first spring
    const firstMassEquilibriumLineNode = new ReferenceLineNode(this.modelViewTransform, model.firstSpring, model.firstSpring.massEquilibriumYPositionProperty, firstMassEquilibriumVisibilityProperty, {
      stroke: 'black'
    });

    // Initializes equilibrium line for second spring
    const secondMassEquilibriumLineNode = new ReferenceLineNode(this.modelViewTransform, model.secondSpring, model.secondSpring.massEquilibriumYPositionProperty, secondMassEquilibriumVisibilityProperty, {
      stroke: 'black'
    });

    // Adding system controls to scene graph
    this.addChild(this.springSystemControlsNode);

    // Reference lines from indicator visibility box
    this.addChild(this.firstNaturalLengthLineNode);
    this.addChild(this.secondNaturalLengthLineNode);
    this.addChild(firstMassEquilibriumLineNode);
    this.addChild(secondMassEquilibriumLineNode);
    this.addChild(this.movableLineNode);
    this.addChild(this.massLayer);
    this.addChild(this.toolsLayer);

    // Contains visibility options for the reference lines and displacement arrow
    const indicatorVisibilityControlNode = this.createIndicatorVisibilityPanel(model, false, tandem);

    // Contains all of the display options for the vectors and forces
    const vectorVisibilityControlNode = new VectorVisibilityControlNode(model, tandem.createTandem('vectorVisibilityControlNode'), {
      maxWidth: MassesAndSpringsConstants.PANEL_MAX_WIDTH + 30
    });

    // VBox that contains all of the panel's content
    const optionsVBox = new VBox({
      spacing: 10,
      children: [indicatorVisibilityControlNode, MassesAndSpringsConstants.LINE_SEPARATOR(165), this.gravityAndDampingControlNode, MassesAndSpringsConstants.LINE_SEPARATOR(165), vectorVisibilityControlNode]
    });

    // Panel that will display all the toggleable options.
    const optionsPanel = this.createOptionsPanel(optionsVBox, this.rightPanelAlignGroup, tandem);

    // Contains all of the options for the reference lines, gravity, damping, and toolbox
    const rightPanelsVBox = new VBox({
      children: [optionsPanel, this.toolboxPanel],
      spacing: this.spacing * 0.9
    });
    this.addChild(rightPanelsVBox);
    rightPanelsVBox.moveToBack();

    // Move this plane to the back of the scene graph
    this.backgroundDragPlane.moveToBack();
    this.visibleBoundsProperty.link(() => {
      rightPanelsVBox.rightTop = new Vector2(this.panelRightSpacing, this.springSystemControlsNode.top);
    });
  }
}
massesAndSprings.register('VectorsScreenView', VectorsScreenView);
export default VectorsScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJWZWN0b3IyIiwiVkJveCIsIk1hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMiLCJSZWZlcmVuY2VMaW5lTm9kZSIsIlR3b1NwcmluZ1NjcmVlblZpZXciLCJtYXNzZXNBbmRTcHJpbmdzIiwiRGlzcGxhY2VtZW50QXJyb3dOb2RlIiwiVmVjdG9yVmlzaWJpbGl0eUNvbnRyb2xOb2RlIiwiVmVjdG9yc1NjcmVlblZpZXciLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwidGFuZGVtIiwiZmlyc3REaXNwbGFjZW1lbnRBcnJvd05vZGUiLCJzcHJpbmdOb2RlcyIsIm5vZGVQcm9wZXJ0eSIsInZhbHVlIiwic3ByaW5nIiwiZGlzcGxhY2VtZW50UHJvcGVydHkiLCJuYXR1cmFsTGVuZ3RoVmlzaWJsZVByb3BlcnR5IiwibW9kZWxWaWV3VHJhbnNmb3JtIiwibGVmdCIsInJpZ2h0IiwiY2VudGVyWSIsIm1vZGVsVG9WaWV3WSIsImJvdHRvbVByb3BlcnR5IiwiYWRkQ2hpbGQiLCJzZWNvbmREaXNwbGFjZW1lbnRBcnJvd05vZGUiLCJmaXJzdE1hc3NFcXVpbGlicml1bVZpc2liaWxpdHlQcm9wZXJ0eSIsImVxdWlsaWJyaXVtUG9zaXRpb25WaXNpYmxlUHJvcGVydHkiLCJmaXJzdFNwcmluZyIsIm1hc3NBdHRhY2hlZFByb3BlcnR5IiwiZXF1aWxpYnJpdW1Qb3NpdGlvblZpc2libGUiLCJtYXNzQXR0YWNoZWQiLCJzZWNvbmRNYXNzRXF1aWxpYnJpdW1WaXNpYmlsaXR5UHJvcGVydHkiLCJzZWNvbmRTcHJpbmciLCJmaXJzdE1hc3NFcXVpbGlicml1bUxpbmVOb2RlIiwibWFzc0VxdWlsaWJyaXVtWVBvc2l0aW9uUHJvcGVydHkiLCJzdHJva2UiLCJzZWNvbmRNYXNzRXF1aWxpYnJpdW1MaW5lTm9kZSIsInNwcmluZ1N5c3RlbUNvbnRyb2xzTm9kZSIsImZpcnN0TmF0dXJhbExlbmd0aExpbmVOb2RlIiwic2Vjb25kTmF0dXJhbExlbmd0aExpbmVOb2RlIiwibW92YWJsZUxpbmVOb2RlIiwibWFzc0xheWVyIiwidG9vbHNMYXllciIsImluZGljYXRvclZpc2liaWxpdHlDb250cm9sTm9kZSIsImNyZWF0ZUluZGljYXRvclZpc2liaWxpdHlQYW5lbCIsInZlY3RvclZpc2liaWxpdHlDb250cm9sTm9kZSIsImNyZWF0ZVRhbmRlbSIsIm1heFdpZHRoIiwiUEFORUxfTUFYX1dJRFRIIiwib3B0aW9uc1ZCb3giLCJzcGFjaW5nIiwiY2hpbGRyZW4iLCJMSU5FX1NFUEFSQVRPUiIsImdyYXZpdHlBbmREYW1waW5nQ29udHJvbE5vZGUiLCJvcHRpb25zUGFuZWwiLCJjcmVhdGVPcHRpb25zUGFuZWwiLCJyaWdodFBhbmVsQWxpZ25Hcm91cCIsInJpZ2h0UGFuZWxzVkJveCIsInRvb2xib3hQYW5lbCIsIm1vdmVUb0JhY2siLCJiYWNrZ3JvdW5kRHJhZ1BsYW5lIiwidmlzaWJsZUJvdW5kc1Byb3BlcnR5IiwibGluayIsInJpZ2h0VG9wIiwicGFuZWxSaWdodFNwYWNpbmciLCJ0b3AiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlZlY3RvcnNTY3JlZW5WaWV3LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE2LTIwMjEsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIENvbW1vbiBzY3JlZW4gdmlldyBmb3IgdmVjdG9ycyBzY3JlZW4uXHJcbiAqXHJcbiAqIEBhdXRob3IgTWF0dCBQZW5uaW5ndG9uIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIERlbnplbGwgQmFybmV0dCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgeyBWQm94IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IE1hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMgZnJvbSAnLi4vLi4vY29tbW9uL01hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgUmVmZXJlbmNlTGluZU5vZGUgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvUmVmZXJlbmNlTGluZU5vZGUuanMnO1xyXG5pbXBvcnQgVHdvU3ByaW5nU2NyZWVuVmlldyBmcm9tICcuLi8uLi9jb21tb24vdmlldy9Ud29TcHJpbmdTY3JlZW5WaWV3LmpzJztcclxuaW1wb3J0IG1hc3Nlc0FuZFNwcmluZ3MgZnJvbSAnLi4vLi4vbWFzc2VzQW5kU3ByaW5ncy5qcyc7XHJcbmltcG9ydCBEaXNwbGFjZW1lbnRBcnJvd05vZGUgZnJvbSAnLi9EaXNwbGFjZW1lbnRBcnJvd05vZGUuanMnO1xyXG5pbXBvcnQgVmVjdG9yVmlzaWJpbGl0eUNvbnRyb2xOb2RlIGZyb20gJy4vVmVjdG9yVmlzaWJpbGl0eUNvbnRyb2xOb2RlLmpzJztcclxuXHJcbmNsYXNzIFZlY3RvcnNTY3JlZW5WaWV3IGV4dGVuZHMgVHdvU3ByaW5nU2NyZWVuVmlldyB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7VmVjdG9yc01vZGVsfSBtb2RlbFxyXG4gICAqIEBwYXJhbSB7VGFuZGVtfSB0YW5kZW1cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbW9kZWwsIHRhbmRlbSApIHtcclxuXHJcbiAgICBzdXBlciggbW9kZWwsIHRhbmRlbSApO1xyXG4gICAgLy8gRGlzcGxhY2VtZW50IGFycm93cyBhZGRlZCBmb3IgZWFjaCBzcHJpbmdzXHJcbiAgICBjb25zdCBmaXJzdERpc3BsYWNlbWVudEFycm93Tm9kZSA9IG5ldyBEaXNwbGFjZW1lbnRBcnJvd05vZGUoXHJcbiAgICAgIHRoaXMuc3ByaW5nTm9kZXNbIDAgXS5ub2RlUHJvcGVydHkudmFsdWUuc3ByaW5nLmRpc3BsYWNlbWVudFByb3BlcnR5LFxyXG4gICAgICBtb2RlbC5uYXR1cmFsTGVuZ3RoVmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICB0YW5kZW0sXHJcbiAgICAgIHtcclxuICAgICAgICBtb2RlbFZpZXdUcmFuc2Zvcm06IHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLFxyXG4gICAgICAgIGxlZnQ6IHRoaXMuc3ByaW5nTm9kZXNbIDAgXS5ub2RlUHJvcGVydHkudmFsdWUucmlnaHQgKyA4LFxyXG4gICAgICAgIGNlbnRlclk6IHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3WSggdGhpcy5zcHJpbmdOb2Rlc1sgMCBdLm5vZGVQcm9wZXJ0eS52YWx1ZS5zcHJpbmcuYm90dG9tUHJvcGVydHkudmFsdWUgKVxyXG4gICAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBmaXJzdERpc3BsYWNlbWVudEFycm93Tm9kZSApO1xyXG5cclxuICAgIGNvbnN0IHNlY29uZERpc3BsYWNlbWVudEFycm93Tm9kZSA9IG5ldyBEaXNwbGFjZW1lbnRBcnJvd05vZGUoXHJcbiAgICAgIHRoaXMuc3ByaW5nTm9kZXNbIDEgXS5ub2RlUHJvcGVydHkudmFsdWUuc3ByaW5nLmRpc3BsYWNlbWVudFByb3BlcnR5LFxyXG4gICAgICBtb2RlbC5uYXR1cmFsTGVuZ3RoVmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICB0YW5kZW0sXHJcbiAgICAgIHtcclxuICAgICAgICBtb2RlbFZpZXdUcmFuc2Zvcm06IHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLFxyXG4gICAgICAgIHJpZ2h0OiB0aGlzLnNwcmluZ05vZGVzWyAxIF0ubm9kZVByb3BlcnR5LnZhbHVlLmxlZnQgKyAxNCxcclxuICAgICAgICBjZW50ZXJZOiB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld1koIHRoaXMuc3ByaW5nTm9kZXNbIDEgXS5ub2RlUHJvcGVydHkudmFsdWUuc3ByaW5nLmJvdHRvbVByb3BlcnR5LnZhbHVlIClcclxuICAgICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggc2Vjb25kRGlzcGxhY2VtZW50QXJyb3dOb2RlICk7XHJcblxyXG4gICAgLy8gRXF1aWxpYnJpdW0gb2YgbWFzcyBpcyBkZXBlbmRlbnQgb24gdGhlIG1hc3MgYmVpbmcgYXR0YWNoZWQgYW5kIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBlcXVpbGlicml1bSBsaW5lLlxyXG4gICAgY29uc3QgZmlyc3RNYXNzRXF1aWxpYnJpdW1WaXNpYmlsaXR5UHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIG1vZGVsLmVxdWlsaWJyaXVtUG9zaXRpb25WaXNpYmxlUHJvcGVydHksIG1vZGVsLmZpcnN0U3ByaW5nLm1hc3NBdHRhY2hlZFByb3BlcnR5IF0sXHJcbiAgICAgICggZXF1aWxpYnJpdW1Qb3NpdGlvblZpc2libGUsIG1hc3NBdHRhY2hlZCApID0+ICEhbWFzc0F0dGFjaGVkICYmIGVxdWlsaWJyaXVtUG9zaXRpb25WaXNpYmxlICk7XHJcbiAgICBjb25zdCBzZWNvbmRNYXNzRXF1aWxpYnJpdW1WaXNpYmlsaXR5UHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIG1vZGVsLmVxdWlsaWJyaXVtUG9zaXRpb25WaXNpYmxlUHJvcGVydHksIG1vZGVsLnNlY29uZFNwcmluZy5tYXNzQXR0YWNoZWRQcm9wZXJ0eSBdLFxyXG4gICAgICAoIGVxdWlsaWJyaXVtUG9zaXRpb25WaXNpYmxlLCBtYXNzQXR0YWNoZWQgKSA9PiAhIW1hc3NBdHRhY2hlZCAmJiBlcXVpbGlicml1bVBvc2l0aW9uVmlzaWJsZSApO1xyXG5cclxuICAgIC8vIEluaXRpYWxpemVzIGVxdWlsaWJyaXVtIGxpbmUgZm9yIGZpcnN0IHNwcmluZ1xyXG4gICAgY29uc3QgZmlyc3RNYXNzRXF1aWxpYnJpdW1MaW5lTm9kZSA9IG5ldyBSZWZlcmVuY2VMaW5lTm9kZShcclxuICAgICAgdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0sXHJcbiAgICAgIG1vZGVsLmZpcnN0U3ByaW5nLFxyXG4gICAgICBtb2RlbC5maXJzdFNwcmluZy5tYXNzRXF1aWxpYnJpdW1ZUG9zaXRpb25Qcm9wZXJ0eSxcclxuICAgICAgZmlyc3RNYXNzRXF1aWxpYnJpdW1WaXNpYmlsaXR5UHJvcGVydHksIHtcclxuICAgICAgICBzdHJva2U6ICdibGFjaydcclxuICAgICAgfVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBJbml0aWFsaXplcyBlcXVpbGlicml1bSBsaW5lIGZvciBzZWNvbmQgc3ByaW5nXHJcbiAgICBjb25zdCBzZWNvbmRNYXNzRXF1aWxpYnJpdW1MaW5lTm9kZSA9IG5ldyBSZWZlcmVuY2VMaW5lTm9kZShcclxuICAgICAgdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0sXHJcbiAgICAgIG1vZGVsLnNlY29uZFNwcmluZyxcclxuICAgICAgbW9kZWwuc2Vjb25kU3ByaW5nLm1hc3NFcXVpbGlicml1bVlQb3NpdGlvblByb3BlcnR5LFxyXG4gICAgICBzZWNvbmRNYXNzRXF1aWxpYnJpdW1WaXNpYmlsaXR5UHJvcGVydHksIHtcclxuICAgICAgICBzdHJva2U6ICdibGFjaydcclxuICAgICAgfVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBBZGRpbmcgc3lzdGVtIGNvbnRyb2xzIHRvIHNjZW5lIGdyYXBoXHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLnNwcmluZ1N5c3RlbUNvbnRyb2xzTm9kZSApO1xyXG5cclxuICAgIC8vIFJlZmVyZW5jZSBsaW5lcyBmcm9tIGluZGljYXRvciB2aXNpYmlsaXR5IGJveFxyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5maXJzdE5hdHVyYWxMZW5ndGhMaW5lTm9kZSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5zZWNvbmROYXR1cmFsTGVuZ3RoTGluZU5vZGUgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGZpcnN0TWFzc0VxdWlsaWJyaXVtTGluZU5vZGUgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHNlY29uZE1hc3NFcXVpbGlicml1bUxpbmVOb2RlICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLm1vdmFibGVMaW5lTm9kZSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggdGhpcy5tYXNzTGF5ZXIgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMudG9vbHNMYXllciApO1xyXG5cclxuICAgIC8vIENvbnRhaW5zIHZpc2liaWxpdHkgb3B0aW9ucyBmb3IgdGhlIHJlZmVyZW5jZSBsaW5lcyBhbmQgZGlzcGxhY2VtZW50IGFycm93XHJcbiAgICBjb25zdCBpbmRpY2F0b3JWaXNpYmlsaXR5Q29udHJvbE5vZGUgPSB0aGlzLmNyZWF0ZUluZGljYXRvclZpc2liaWxpdHlQYW5lbCggbW9kZWwsIGZhbHNlLCB0YW5kZW0gKTtcclxuXHJcbiAgICAvLyBDb250YWlucyBhbGwgb2YgdGhlIGRpc3BsYXkgb3B0aW9ucyBmb3IgdGhlIHZlY3RvcnMgYW5kIGZvcmNlc1xyXG4gICAgY29uc3QgdmVjdG9yVmlzaWJpbGl0eUNvbnRyb2xOb2RlID0gbmV3IFZlY3RvclZpc2liaWxpdHlDb250cm9sTm9kZShcclxuICAgICAgbW9kZWwsXHJcbiAgICAgIHRhbmRlbS5jcmVhdGVUYW5kZW0oICd2ZWN0b3JWaXNpYmlsaXR5Q29udHJvbE5vZGUnICksIHtcclxuICAgICAgICBtYXhXaWR0aDogTWFzc2VzQW5kU3ByaW5nc0NvbnN0YW50cy5QQU5FTF9NQVhfV0lEVEggKyAzMFxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgLy8gVkJveCB0aGF0IGNvbnRhaW5zIGFsbCBvZiB0aGUgcGFuZWwncyBjb250ZW50XHJcbiAgICBjb25zdCBvcHRpb25zVkJveCA9IG5ldyBWQm94KCB7XHJcbiAgICAgIHNwYWNpbmc6IDEwLFxyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIGluZGljYXRvclZpc2liaWxpdHlDb250cm9sTm9kZSxcclxuICAgICAgICBNYXNzZXNBbmRTcHJpbmdzQ29uc3RhbnRzLkxJTkVfU0VQQVJBVE9SKCAxNjUgKSxcclxuICAgICAgICB0aGlzLmdyYXZpdHlBbmREYW1waW5nQ29udHJvbE5vZGUsXHJcbiAgICAgICAgTWFzc2VzQW5kU3ByaW5nc0NvbnN0YW50cy5MSU5FX1NFUEFSQVRPUiggMTY1ICksXHJcbiAgICAgICAgdmVjdG9yVmlzaWJpbGl0eUNvbnRyb2xOb2RlXHJcbiAgICAgIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBQYW5lbCB0aGF0IHdpbGwgZGlzcGxheSBhbGwgdGhlIHRvZ2dsZWFibGUgb3B0aW9ucy5cclxuICAgIGNvbnN0IG9wdGlvbnNQYW5lbCA9IHRoaXMuY3JlYXRlT3B0aW9uc1BhbmVsKCBvcHRpb25zVkJveCwgdGhpcy5yaWdodFBhbmVsQWxpZ25Hcm91cCwgdGFuZGVtICk7XHJcblxyXG4gICAgLy8gQ29udGFpbnMgYWxsIG9mIHRoZSBvcHRpb25zIGZvciB0aGUgcmVmZXJlbmNlIGxpbmVzLCBncmF2aXR5LCBkYW1waW5nLCBhbmQgdG9vbGJveFxyXG4gICAgY29uc3QgcmlnaHRQYW5lbHNWQm94ID0gbmV3IFZCb3goIHsgY2hpbGRyZW46IFsgb3B0aW9uc1BhbmVsLCB0aGlzLnRvb2xib3hQYW5lbCBdLCBzcGFjaW5nOiB0aGlzLnNwYWNpbmcgKiAwLjkgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggcmlnaHRQYW5lbHNWQm94ICk7XHJcbiAgICByaWdodFBhbmVsc1ZCb3gubW92ZVRvQmFjaygpO1xyXG5cclxuICAgIC8vIE1vdmUgdGhpcyBwbGFuZSB0byB0aGUgYmFjayBvZiB0aGUgc2NlbmUgZ3JhcGhcclxuICAgIHRoaXMuYmFja2dyb3VuZERyYWdQbGFuZS5tb3ZlVG9CYWNrKCk7XHJcblxyXG4gICAgdGhpcy52aXNpYmxlQm91bmRzUHJvcGVydHkubGluayggKCkgPT4ge1xyXG4gICAgICByaWdodFBhbmVsc1ZCb3gucmlnaHRUb3AgPSBuZXcgVmVjdG9yMiggdGhpcy5wYW5lbFJpZ2h0U3BhY2luZywgdGhpcy5zcHJpbmdTeXN0ZW1Db250cm9sc05vZGUudG9wICk7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG5tYXNzZXNBbmRTcHJpbmdzLnJlZ2lzdGVyKCAnVmVjdG9yc1NjcmVlblZpZXcnLCBWZWN0b3JzU2NyZWVuVmlldyApO1xyXG5leHBvcnQgZGVmYXVsdCBWZWN0b3JzU2NyZWVuVmlldzsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsU0FBU0MsSUFBSSxRQUFRLG1DQUFtQztBQUN4RCxPQUFPQyx5QkFBeUIsTUFBTSwyQ0FBMkM7QUFDakYsT0FBT0MsaUJBQWlCLE1BQU0sd0NBQXdDO0FBQ3RFLE9BQU9DLG1CQUFtQixNQUFNLDBDQUEwQztBQUMxRSxPQUFPQyxnQkFBZ0IsTUFBTSwyQkFBMkI7QUFDeEQsT0FBT0MscUJBQXFCLE1BQU0sNEJBQTRCO0FBQzlELE9BQU9DLDJCQUEyQixNQUFNLGtDQUFrQztBQUUxRSxNQUFNQyxpQkFBaUIsU0FBU0osbUJBQW1CLENBQUM7RUFFbEQ7QUFDRjtBQUNBO0FBQ0E7RUFDRUssV0FBV0EsQ0FBRUMsS0FBSyxFQUFFQyxNQUFNLEVBQUc7SUFFM0IsS0FBSyxDQUFFRCxLQUFLLEVBQUVDLE1BQU8sQ0FBQztJQUN0QjtJQUNBLE1BQU1DLDBCQUEwQixHQUFHLElBQUlOLHFCQUFxQixDQUMxRCxJQUFJLENBQUNPLFdBQVcsQ0FBRSxDQUFDLENBQUUsQ0FBQ0MsWUFBWSxDQUFDQyxLQUFLLENBQUNDLE1BQU0sQ0FBQ0Msb0JBQW9CLEVBQ3BFUCxLQUFLLENBQUNRLDRCQUE0QixFQUNsQ1AsTUFBTSxFQUNOO01BQ0VRLGtCQUFrQixFQUFFLElBQUksQ0FBQ0Esa0JBQWtCO01BQzNDQyxJQUFJLEVBQUUsSUFBSSxDQUFDUCxXQUFXLENBQUUsQ0FBQyxDQUFFLENBQUNDLFlBQVksQ0FBQ0MsS0FBSyxDQUFDTSxLQUFLLEdB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