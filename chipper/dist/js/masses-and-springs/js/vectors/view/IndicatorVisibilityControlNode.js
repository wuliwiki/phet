// Copyright 2017-2023, University of Colorado Boulder

/**
 * Panel that manages options for visibility of reference lines on vector screen.
 *
 * @author Denzell Barnett (PhET Interactive Simulations)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import merge from '../../../../phet-core/js/merge.js';
import BracketNode from '../../../../scenery-phet/js/BracketNode.js';
import { AlignBox, AlignGroup, HBox, Node, Text, VBox } from '../../../../scenery/js/imports.js';
import VerticalCheckboxGroup from '../../../../sun/js/VerticalCheckboxGroup.js';
import MassesAndSpringsConstants from '../../common/MassesAndSpringsConstants.js';
import massesAndSprings from '../../massesAndSprings.js';
import MassesAndSpringsStrings from '../../MassesAndSpringsStrings.js';
import DisplacementArrowNode from './DisplacementArrowNode.js';
const displacementString = MassesAndSpringsStrings.displacement;
const massEquilibriumString = MassesAndSpringsStrings.massEquilibrium;
const movableLineString = MassesAndSpringsStrings.movableLine;
const naturalLengthString = MassesAndSpringsStrings.naturalLength;
const periodTraceString = MassesAndSpringsStrings.periodTrace;

// constants
const DEFAULT_CONTENT_SPACING = 155;
const CONTENT_MAX_WIDTH = 115;
class IndicatorVisibilityControlNode extends Node {
  /**
   * @param {MassesAndSpringsModel} model
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(model, tandem, options) {
    options = merge({
      fill: MassesAndSpringsConstants.PANEL_FILL,
      tandem: tandem.createTandem('indicatorVisibilityControlNode'),
      minWidth: MassesAndSpringsConstants.PANEL_MIN_WIDTH + 10,
      periodTraceOption: false
    }, options);
    super(options);

    // Lines added for reference in panel
    const blackLine = MassesAndSpringsConstants.CREATE_LINE_ICON('black', tandem.createTandem('blackLine'));
    const blueLine = MassesAndSpringsConstants.CREATE_LINE_ICON('rgb( 65, 66, 232 )', tandem.createTandem('blueLine'));
    const redLine = MassesAndSpringsConstants.CREATE_LINE_ICON('red', tandem.createTandem('redLine'));
    const displacementSymbol = new DisplacementArrowNode(new NumberProperty(10), new BooleanProperty(true), tandem, {
      modelViewTransform: this.modelViewTransform,
      symbolRepresentation: true,
      scale: 0.65
    });
    const alignGroup = new AlignGroup({
      matchVertical: false
    });

    // Labels for the displacement arrow and natural length line
    const displacementLabels = new VBox({
      spacing: 8,
      align: 'left',
      children: [new Text(displacementString, {
        font: MassesAndSpringsConstants.TITLE_FONT,
        maxWidth: 110,
        tandem: tandem.createTandem('displacementText')
      }), new Text(naturalLengthString, {
        font: MassesAndSpringsConstants.TITLE_FONT,
        maxWidth: 110,
        tandem: tandem.createTandem('naturalLengthText')
      })]
    });

    // the bracket at the left - this is tweaked a bit for optimal appearance
    const bracket = new VBox({
      children: [new BracketNode({
        orientation: 'left',
        bracketLength: displacementLabels.height < 17 ? 17 : displacementLabels.height,
        bracketLineWidth: 2,
        bracketStroke: 'black',
        bracketTipPosition: 0.475,
        bracketEndRadius: 4,
        bracketTipRadius: 4
      })]
    });
    const componentDisplacement = new AlignBox(new HBox({
      spacing: 2,
      children: [bracket, displacementLabels]
    }), {
      xAlign: 'left',
      group: alignGroup
    });
    const massEquilibriumAlignBox = new AlignBox(new Text(massEquilibriumString, {
      font: MassesAndSpringsConstants.TITLE_FONT,
      maxWidth: CONTENT_MAX_WIDTH,
      tandem: tandem.createTandem('massEquilibriumText')
    }), {
      xAlign: 'left',
      group: alignGroup
    });
    const movableLineAlignBox = new AlignBox(new Text(movableLineString, {
      font: MassesAndSpringsConstants.TITLE_FONT,
      maxWidth: CONTENT_MAX_WIDTH,
      tandem: tandem.createTandem('movableLineText')
    }), {
      xAlign: 'left',
      group: alignGroup
    });

    // Max width must be set to the maxWidth of the alignGroup based on its content.
    const contentSpacing = DEFAULT_CONTENT_SPACING - alignGroup.getMaxWidth();

    // Create checkboxes using align boxes above
    const componentDisplacementVBox = new VBox({
      children: [displacementSymbol, blueLine]
    });
    componentDisplacementVBox.spacing = componentDisplacementVBox.height * 0.75;

    // Used for indicator visibility
    const checkboxContent = [{
      createNode: () => new HBox({
        children: [componentDisplacement, componentDisplacementVBox],
        spacing: contentSpacing
      }),
      property: model.naturalLengthVisibleProperty
    }, {
      createNode: () => new HBox({
        children: [massEquilibriumAlignBox, blackLine],
        spacing: contentSpacing
      }),
      property: model.equilibriumPositionVisibleProperty
    }, {
      createNode: () => new HBox({
        children: [movableLineAlignBox, redLine],
        spacing: contentSpacing
      }),
      property: model.movableLineVisibleProperty
    }];
    if (options.periodTraceOption) {
      // Push period trace content into checkboxContent
      checkboxContent.push({
        createNode: tandem => new Text(periodTraceString, {
          font: MassesAndSpringsConstants.TITLE_FONT,
          maxWidth: CONTENT_MAX_WIDTH,
          tandem: tandem.createTandem('periodTraceText')
        }),
        property: model.firstSpring.periodTraceVisibilityProperty
      });
    }
    const indicatorVisibilityCheckboxGroup = new VerticalCheckboxGroup(checkboxContent, {
      checkboxOptions: {
        boxWidth: 16,
        spacing: 8
      },
      tandem: tandem.createTandem('indicatorVisibilityCheckboxGroup')
    });
    const indicatorVisibilityControlsVBox = new VBox({
      children: [indicatorVisibilityCheckboxGroup],
      align: 'left',
      tandem: tandem.createTandem('indicatorVisibilityControlsVBox')
    });
    this.addChild(indicatorVisibilityControlsVBox);
  }
}
massesAndSprings.register('IndicatorVisibilityControlNode', IndicatorVisibilityControlNode);
export default IndicatorVisibilityControlNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJOdW1iZXJQcm9wZXJ0eSIsIm1lcmdlIiwiQnJhY2tldE5vZGUiLCJBbGlnbkJveCIsIkFsaWduR3JvdXAiLCJIQm94IiwiTm9kZSIsIlRleHQiLCJWQm94IiwiVmVydGljYWxDaGVja2JveEdyb3VwIiwiTWFzc2VzQW5kU3ByaW5nc0NvbnN0YW50cyIsIm1hc3Nlc0FuZFNwcmluZ3MiLCJNYXNzZXNBbmRTcHJpbmdzU3RyaW5ncyIsIkRpc3BsYWNlbWVudEFycm93Tm9kZSIsImRpc3BsYWNlbWVudFN0cmluZyIsImRpc3BsYWNlbWVudCIsIm1hc3NFcXVpbGlicml1bVN0cmluZyIsIm1hc3NFcXVpbGlicml1bSIsIm1vdmFibGVMaW5lU3RyaW5nIiwibW92YWJsZUxpbmUiLCJuYXR1cmFsTGVuZ3RoU3RyaW5nIiwibmF0dXJhbExlbmd0aCIsInBlcmlvZFRyYWNlU3RyaW5nIiwicGVyaW9kVHJhY2UiLCJERUZBVUxUX0NPTlRFTlRfU1BBQ0lORyIsIkNPTlRFTlRfTUFYX1dJRFRIIiwiSW5kaWNhdG9yVmlzaWJpbGl0eUNvbnRyb2xOb2RlIiwiY29uc3RydWN0b3IiLCJtb2RlbCIsInRhbmRlbSIsIm9wdGlvbnMiLCJmaWxsIiwiUEFORUxfRklMTCIsImNyZWF0ZVRhbmRlbSIsIm1pbldpZHRoIiwiUEFORUxfTUlOX1dJRFRIIiwicGVyaW9kVHJhY2VPcHRpb24iLCJibGFja0xpbmUiLCJDUkVBVEVfTElORV9JQ09OIiwiYmx1ZUxpbmUiLCJyZWRMaW5lIiwiZGlzcGxhY2VtZW50U3ltYm9sIiwibW9kZWxWaWV3VHJhbnNmb3JtIiwic3ltYm9sUmVwcmVzZW50YXRpb24iLCJzY2FsZSIsImFsaWduR3JvdXAiLCJtYXRjaFZlcnRpY2FsIiwiZGlzcGxhY2VtZW50TGFiZWxzIiwic3BhY2luZyIsImFsaWduIiwiY2hpbGRyZW4iLCJmb250IiwiVElUTEVfRk9OVCIsIm1heFdpZHRoIiwiYnJhY2tldCIsIm9yaWVudGF0aW9uIiwiYnJhY2tldExlbmd0aCIsImhlaWdodCIsImJyYWNrZXRMaW5lV2lkdGgiLCJicmFja2V0U3Ryb2tlIiwiYnJhY2tldFRpcFBvc2l0aW9uIiwiYnJhY2tldEVuZFJhZGl1cyIsImJyYWNrZXRUaXBSYWRpdXMiLCJjb21wb25lbnREaXNwbGFjZW1lbnQiLCJ4QWxpZ24iLCJncm91cCIsIm1hc3NFcXVpbGlicml1bUFsaWduQm94IiwibW92YWJsZUxpbmVBbGlnbkJveCIsImNvbnRlbnRTcGFjaW5nIiwiZ2V0TWF4V2lkdGgiLCJjb21wb25lbnREaXNwbGFjZW1lbnRWQm94IiwiY2hlY2tib3hDb250ZW50IiwiY3JlYXRlTm9kZSIsInByb3BlcnR5IiwibmF0dXJhbExlbmd0aFZpc2libGVQcm9wZXJ0eSIsImVxdWlsaWJyaXVtUG9zaXRpb25WaXNpYmxlUHJvcGVydHkiLCJtb3ZhYmxlTGluZVZpc2libGVQcm9wZXJ0eSIsInB1c2giLCJmaXJzdFNwcmluZyIsInBlcmlvZFRyYWNlVmlzaWJpbGl0eVByb3BlcnR5IiwiaW5kaWNhdG9yVmlzaWJpbGl0eUNoZWNrYm94R3JvdXAiLCJjaGVja2JveE9wdGlvbnMiLCJib3hXaWR0aCIsImluZGljYXRvclZpc2liaWxpdHlDb250cm9sc1ZCb3giLCJhZGRDaGlsZCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiSW5kaWNhdG9yVmlzaWJpbGl0eUNvbnRyb2xOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE3LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFBhbmVsIHRoYXQgbWFuYWdlcyBvcHRpb25zIGZvciB2aXNpYmlsaXR5IG9mIHJlZmVyZW5jZSBsaW5lcyBvbiB2ZWN0b3Igc2NyZWVuLlxyXG4gKlxyXG4gKiBAYXV0aG9yIERlbnplbGwgQmFybmV0dCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IEJyYWNrZXROb2RlIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9CcmFja2V0Tm9kZS5qcyc7XHJcbmltcG9ydCB7IEFsaWduQm94LCBBbGlnbkdyb3VwLCBIQm94LCBOb2RlLCBUZXh0LCBWQm94IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFZlcnRpY2FsQ2hlY2tib3hHcm91cCBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvVmVydGljYWxDaGVja2JveEdyb3VwLmpzJztcclxuaW1wb3J0IE1hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMgZnJvbSAnLi4vLi4vY29tbW9uL01hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgbWFzc2VzQW5kU3ByaW5ncyBmcm9tICcuLi8uLi9tYXNzZXNBbmRTcHJpbmdzLmpzJztcclxuaW1wb3J0IE1hc3Nlc0FuZFNwcmluZ3NTdHJpbmdzIGZyb20gJy4uLy4uL01hc3Nlc0FuZFNwcmluZ3NTdHJpbmdzLmpzJztcclxuaW1wb3J0IERpc3BsYWNlbWVudEFycm93Tm9kZSBmcm9tICcuL0Rpc3BsYWNlbWVudEFycm93Tm9kZS5qcyc7XHJcblxyXG5jb25zdCBkaXNwbGFjZW1lbnRTdHJpbmcgPSBNYXNzZXNBbmRTcHJpbmdzU3RyaW5ncy5kaXNwbGFjZW1lbnQ7XHJcbmNvbnN0IG1hc3NFcXVpbGlicml1bVN0cmluZyA9IE1hc3Nlc0FuZFNwcmluZ3NTdHJpbmdzLm1hc3NFcXVpbGlicml1bTtcclxuY29uc3QgbW92YWJsZUxpbmVTdHJpbmcgPSBNYXNzZXNBbmRTcHJpbmdzU3RyaW5ncy5tb3ZhYmxlTGluZTtcclxuY29uc3QgbmF0dXJhbExlbmd0aFN0cmluZyA9IE1hc3Nlc0FuZFNwcmluZ3NTdHJpbmdzLm5hdHVyYWxMZW5ndGg7XHJcbmNvbnN0IHBlcmlvZFRyYWNlU3RyaW5nID0gTWFzc2VzQW5kU3ByaW5nc1N0cmluZ3MucGVyaW9kVHJhY2U7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgREVGQVVMVF9DT05URU5UX1NQQUNJTkcgPSAxNTU7XHJcbmNvbnN0IENPTlRFTlRfTUFYX1dJRFRIID0gMTE1O1xyXG5cclxuY2xhc3MgSW5kaWNhdG9yVmlzaWJpbGl0eUNvbnRyb2xOb2RlIGV4dGVuZHMgTm9kZSB7XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtNYXNzZXNBbmRTcHJpbmdzTW9kZWx9IG1vZGVsXHJcbiAgICogQHBhcmFtIHtUYW5kZW19IHRhbmRlbVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbW9kZWwsIHRhbmRlbSwgb3B0aW9ucyApIHtcclxuICAgIG9wdGlvbnMgPSBtZXJnZSgge1xyXG4gICAgICBmaWxsOiBNYXNzZXNBbmRTcHJpbmdzQ29uc3RhbnRzLlBBTkVMX0ZJTEwsXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2luZGljYXRvclZpc2liaWxpdHlDb250cm9sTm9kZScgKSxcclxuICAgICAgbWluV2lkdGg6IE1hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMuUEFORUxfTUlOX1dJRFRIICsgMTAsXHJcbiAgICAgIHBlcmlvZFRyYWNlT3B0aW9uOiBmYWxzZVxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gTGluZXMgYWRkZWQgZm9yIHJlZmVyZW5jZSBpbiBwYW5lbFxyXG4gICAgY29uc3QgYmxhY2tMaW5lID0gTWFzc2VzQW5kU3ByaW5nc0NvbnN0YW50cy5DUkVBVEVfTElORV9JQ09OKCAnYmxhY2snLCB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnYmxhY2tMaW5lJyApICk7XHJcbiAgICBjb25zdCBibHVlTGluZSA9IE1hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMuQ1JFQVRFX0xJTkVfSUNPTiggJ3JnYiggNjUsIDY2LCAyMzIgKScsIHRhbmRlbS5jcmVhdGVUYW5kZW0oICdibHVlTGluZScgKSApO1xyXG4gICAgY29uc3QgcmVkTGluZSA9IE1hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMuQ1JFQVRFX0xJTkVfSUNPTiggJ3JlZCcsIHRhbmRlbS5jcmVhdGVUYW5kZW0oICdyZWRMaW5lJyApICk7XHJcblxyXG4gICAgY29uc3QgZGlzcGxhY2VtZW50U3ltYm9sID0gbmV3IERpc3BsYWNlbWVudEFycm93Tm9kZShcclxuICAgICAgbmV3IE51bWJlclByb3BlcnR5KCAxMCApLFxyXG4gICAgICBuZXcgQm9vbGVhblByb3BlcnR5KCB0cnVlICksXHJcbiAgICAgIHRhbmRlbSxcclxuICAgICAge1xyXG4gICAgICAgIG1vZGVsVmlld1RyYW5zZm9ybTogdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0sXHJcbiAgICAgICAgc3ltYm9sUmVwcmVzZW50YXRpb246IHRydWUsXHJcbiAgICAgICAgc2NhbGU6IDAuNjVcclxuICAgICAgfVxyXG4gICAgKTtcclxuICAgIGNvbnN0IGFsaWduR3JvdXAgPSBuZXcgQWxpZ25Hcm91cCggeyBtYXRjaFZlcnRpY2FsOiBmYWxzZSB9ICk7XHJcblxyXG4gICAgLy8gTGFiZWxzIGZvciB0aGUgZGlzcGxhY2VtZW50IGFycm93IGFuZCBuYXR1cmFsIGxlbmd0aCBsaW5lXHJcbiAgICBjb25zdCBkaXNwbGFjZW1lbnRMYWJlbHMgPSBuZXcgVkJveCgge1xyXG4gICAgICBzcGFjaW5nOiA4LFxyXG4gICAgICBhbGlnbjogJ2xlZnQnLFxyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIG5ldyBUZXh0KCBkaXNwbGFjZW1lbnRTdHJpbmcsIHtcclxuICAgICAgICAgIGZvbnQ6IE1hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMuVElUTEVfRk9OVCxcclxuICAgICAgICAgIG1heFdpZHRoOiAxMTAsXHJcbiAgICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdkaXNwbGFjZW1lbnRUZXh0JyApXHJcbiAgICAgICAgfSApLFxyXG4gICAgICAgIG5ldyBUZXh0KCBuYXR1cmFsTGVuZ3RoU3RyaW5nLCB7XHJcbiAgICAgICAgICBmb250OiBNYXNzZXNBbmRTcHJpbmdzQ29uc3RhbnRzLlRJVExFX0ZPTlQsXHJcbiAgICAgICAgICBtYXhXaWR0aDogMTEwLFxyXG4gICAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnbmF0dXJhbExlbmd0aFRleHQnIClcclxuICAgICAgICB9ICkgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHRoZSBicmFja2V0IGF0IHRoZSBsZWZ0IC0gdGhpcyBpcyB0d2Vha2VkIGEgYml0IGZvciBvcHRpbWFsIGFwcGVhcmFuY2VcclxuICAgIGNvbnN0IGJyYWNrZXQgPSBuZXcgVkJveCgge1xyXG4gICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgIG5ldyBCcmFja2V0Tm9kZSgge1xyXG4gICAgICAgICAgb3JpZW50YXRpb246ICdsZWZ0JyxcclxuICAgICAgICAgIGJyYWNrZXRMZW5ndGg6IGRpc3BsYWNlbWVudExhYmVscy5oZWlnaHQgPCAxNyA/IDE3IDogZGlzcGxhY2VtZW50TGFiZWxzLmhlaWdodCxcclxuICAgICAgICAgIGJyYWNrZXRMaW5lV2lkdGg6IDIsXHJcbiAgICAgICAgICBicmFja2V0U3Ryb2tlOiAnYmxhY2snLFxyXG4gICAgICAgICAgYnJhY2tldFRpcFBvc2l0aW9uOiAwLjQ3NSxcclxuICAgICAgICAgIGJyYWNrZXRFbmRSYWRpdXM6IDQsXHJcbiAgICAgICAgICBicmFja2V0VGlwUmFkaXVzOiA0XHJcbiAgICAgICAgfSApXHJcbiAgICAgIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBjb21wb25lbnREaXNwbGFjZW1lbnQgPSBuZXcgQWxpZ25Cb3goIG5ldyBIQm94KCB7XHJcbiAgICAgIHNwYWNpbmc6IDIsXHJcbiAgICAgIGNoaWxkcmVuOiBbIGJyYWNrZXQsIGRpc3BsYWNlbWVudExhYmVscyBdXHJcbiAgICB9ICksIHsgeEFsaWduOiAnbGVmdCcsIGdyb3VwOiBhbGlnbkdyb3VwIH0gKTtcclxuXHJcbiAgICBjb25zdCBtYXNzRXF1aWxpYnJpdW1BbGlnbkJveCA9IG5ldyBBbGlnbkJveCggbmV3IFRleHQoIG1hc3NFcXVpbGlicml1bVN0cmluZywge1xyXG4gICAgICBmb250OiBNYXNzZXNBbmRTcHJpbmdzQ29uc3RhbnRzLlRJVExFX0ZPTlQsXHJcbiAgICAgIG1heFdpZHRoOiBDT05URU5UX01BWF9XSURUSCxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnbWFzc0VxdWlsaWJyaXVtVGV4dCcgKVxyXG4gICAgfSApLCB7IHhBbGlnbjogJ2xlZnQnLCBncm91cDogYWxpZ25Hcm91cCB9ICk7XHJcbiAgICBjb25zdCBtb3ZhYmxlTGluZUFsaWduQm94ID0gbmV3IEFsaWduQm94KCBuZXcgVGV4dCggbW92YWJsZUxpbmVTdHJpbmcsIHtcclxuICAgICAgZm9udDogTWFzc2VzQW5kU3ByaW5nc0NvbnN0YW50cy5USVRMRV9GT05ULFxyXG4gICAgICBtYXhXaWR0aDogQ09OVEVOVF9NQVhfV0lEVEgsXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ21vdmFibGVMaW5lVGV4dCcgKVxyXG4gICAgfSApLCB7IHhBbGlnbjogJ2xlZnQnLCBncm91cDogYWxpZ25Hcm91cCB9ICk7XHJcblxyXG4gICAgLy8gTWF4IHdpZHRoIG11c3QgYmUgc2V0IHRvIHRoZSBtYXhXaWR0aCBvZiB0aGUgYWxpZ25Hcm91cCBiYXNlZCBvbiBpdHMgY29udGVudC5cclxuICAgIGNvbnN0IGNvbnRlbnRTcGFjaW5nID0gREVGQVVMVF9DT05URU5UX1NQQUNJTkcgLSBhbGlnbkdyb3VwLmdldE1heFdpZHRoKCk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGNoZWNrYm94ZXMgdXNpbmcgYWxpZ24gYm94ZXMgYWJvdmVcclxuICAgIGNvbnN0IGNvbXBvbmVudERpc3BsYWNlbWVudFZCb3ggPSBuZXcgVkJveCggeyBjaGlsZHJlbjogWyBkaXNwbGFjZW1lbnRTeW1ib2wsIGJsdWVMaW5lIF0gfSApO1xyXG4gICAgY29tcG9uZW50RGlzcGxhY2VtZW50VkJveC5zcGFjaW5nID0gY29tcG9uZW50RGlzcGxhY2VtZW50VkJveC5oZWlnaHQgKiAwLjc1O1xyXG5cclxuICAgIC8vIFVzZWQgZm9yIGluZGljYXRvciB2aXNpYmlsaXR5XHJcbiAgICBjb25zdCBjaGVja2JveENvbnRlbnQgPSBbIHtcclxuICAgICAgY3JlYXRlTm9kZTogKCkgPT4gbmV3IEhCb3goIHtcclxuICAgICAgICBjaGlsZHJlbjogWyBjb21wb25lbnREaXNwbGFjZW1lbnQsIGNvbXBvbmVudERpc3BsYWNlbWVudFZCb3ggXSxcclxuICAgICAgICBzcGFjaW5nOiBjb250ZW50U3BhY2luZ1xyXG4gICAgICB9ICksXHJcbiAgICAgIHByb3BlcnR5OiBtb2RlbC5uYXR1cmFsTGVuZ3RoVmlzaWJsZVByb3BlcnR5XHJcbiAgICB9LCB7XHJcbiAgICAgIGNyZWF0ZU5vZGU6ICgpID0+IG5ldyBIQm94KCB7IGNoaWxkcmVuOiBbIG1hc3NFcXVpbGlicml1bUFsaWduQm94LCBibGFja0xpbmUgXSwgc3BhY2luZzogY29udGVudFNwYWNpbmcgfSApLFxyXG4gICAgICBwcm9wZXJ0eTogbW9kZWwuZXF1aWxpYnJpdW1Qb3NpdGlvblZpc2libGVQcm9wZXJ0eVxyXG4gICAgfSwge1xyXG4gICAgICBjcmVhdGVOb2RlOiAoKSA9PiBuZXcgSEJveCggeyBjaGlsZHJlbjogWyBtb3ZhYmxlTGluZUFsaWduQm94LCByZWRMaW5lIF0sIHNwYWNpbmc6IGNvbnRlbnRTcGFjaW5nIH0gKSxcclxuICAgICAgcHJvcGVydHk6IG1vZGVsLm1vdmFibGVMaW5lVmlzaWJsZVByb3BlcnR5XHJcbiAgICB9IF07XHJcblxyXG4gICAgaWYgKCBvcHRpb25zLnBlcmlvZFRyYWNlT3B0aW9uICkge1xyXG5cclxuICAgICAgLy8gUHVzaCBwZXJpb2QgdHJhY2UgY29udGVudCBpbnRvIGNoZWNrYm94Q29udGVudFxyXG4gICAgICBjaGVja2JveENvbnRlbnQucHVzaCgge1xyXG4gICAgICAgIGNyZWF0ZU5vZGU6IHRhbmRlbSA9PiBuZXcgVGV4dCggcGVyaW9kVHJhY2VTdHJpbmcsIHtcclxuICAgICAgICAgIGZvbnQ6IE1hc3Nlc0FuZFNwcmluZ3NDb25zdGFudHMuVElUTEVfRk9OVCxcclxuICAgICAgICAgIG1heFdpZHRoOiBDT05URU5UX01BWF9XSURUSCxcclxuICAgICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3BlcmlvZFRyYWNlVGV4dCcgKVxyXG4gICAgICAgIH0gKSxcclxuICAgICAgICBwcm9wZXJ0eTogbW9kZWwuZmlyc3RTcHJpbmcucGVyaW9kVHJhY2VWaXNpYmlsaXR5UHJvcGVydHlcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaW5kaWNhdG9yVmlzaWJpbGl0eUNoZWNrYm94R3JvdXAgPSBuZXcgVmVydGljYWxDaGVja2JveEdyb3VwKCBjaGVja2JveENvbnRlbnQsIHtcclxuICAgICAgY2hlY2tib3hPcHRpb25zOiB7XHJcbiAgICAgICAgYm94V2lkdGg6IDE2LFxyXG4gICAgICAgIHNwYWNpbmc6IDhcclxuICAgICAgfSxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnaW5kaWNhdG9yVmlzaWJpbGl0eUNoZWNrYm94R3JvdXAnIClcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBpbmRpY2F0b3JWaXNpYmlsaXR5Q29udHJvbHNWQm94ID0gbmV3IFZCb3goIHtcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgaW5kaWNhdG9yVmlzaWJpbGl0eUNoZWNrYm94R3JvdXBcclxuICAgICAgICBdLFxyXG4gICAgICAgIGFsaWduOiAnbGVmdCcsXHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnaW5kaWNhdG9yVmlzaWJpbGl0eUNvbnRyb2xzVkJveCcgKVxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggaW5kaWNhdG9yVmlzaWJpbGl0eUNvbnRyb2xzVkJveCApO1xyXG4gIH1cclxufVxyXG5cclxubWFzc2VzQW5kU3ByaW5ncy5yZWdpc3RlciggJ0luZGljYXRvclZpc2liaWxpdHlDb250cm9sTm9kZScsIEluZGljYXRvclZpc2liaWxpdHlDb250cm9sTm9kZSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgSW5kaWNhdG9yVmlzaWJpbGl0eUNvbnRyb2xOb2RlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLGNBQWMsTUFBTSx1Q0FBdUM7QUFDbEUsT0FBT0MsS0FBSyxNQUFNLG1DQUFtQztBQUNyRCxPQUFPQyxXQUFXLE1BQU0sNENBQTRDO0FBQ3BFLFNBQVNDLFFBQVEsRUFBRUMsVUFBVSxFQUFFQyxJQUFJLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQ2hHLE9BQU9DLHFCQUFxQixNQUFNLDZDQUE2QztBQUMvRSxPQUFPQyx5QkFBeUIsTUFBTSwyQ0FBMkM7QUFDakYsT0FBT0MsZ0JBQWdCLE1BQU0sMkJBQTJCO0FBQ3hELE9BQU9DLHVCQUF1QixNQUFNLGtDQUFrQztBQUN0RSxPQUFPQyxxQkFBcUIsTUFBTSw0QkFBNEI7QUFFOUQsTUFBTUMsa0JBQWtCLEdBQUdGLHVCQUF1QixDQUFDRyxZQUFZO0FBQy9ELE1BQU1DLHFCQUFxQixHQUFHSix1QkFBdUIsQ0FBQ0ssZUFBZTtBQUNyRSxNQUFN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