// Copyright 2020-2022, University of Colorado Boulder

/**
 * BalanceSheetItemNode is the view representation of a ValueItem, which is the general term being used in this
 * sim for assets and debts.
 *
 * @author John Blanco (PhET Interactive Simulations)
 */

import Property from '../../../../axon/js/Property.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Color, DragListener, HBox, Image, Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import asset100_png from '../../../images/asset100_png.js';
import asset100Value_png from '../../../images/asset100Value_png.js';
import asset200_png from '../../../images/asset200_png.js';
import asset200Value_png from '../../../images/asset200Value_png.js';
import asset300_png from '../../../images/asset300_png.js';
import asset300Value_png from '../../../images/asset300Value_png.js';
import asset400_png from '../../../images/asset400_png.js';
import asset400Value_png from '../../../images/asset400Value_png.js';
import debt100_png from '../../../images/debt100_png.js';
import debt100Value_png from '../../../images/debt100Value_png.js';
import debt200_png from '../../../images/debt200_png.js';
import debt200Value_png from '../../../images/debt200Value_png.js';
import debt300_png from '../../../images/debt300_png.js';
import debt300Value_png from '../../../images/debt300Value_png.js';
import debt400_png from '../../../images/debt400_png.js';
import debt400Value_png from '../../../images/debt400Value_png.js';
import numberLineOperations from '../../numberLineOperations.js';
import NumberLineOperationsStrings from '../../NumberLineOperationsStrings.js';

//---------------------------------------------------------------------------------------------------------------------
// constants
//---------------------------------------------------------------------------------------------------------------------

// Dimensions of the icons used for the in-bag representations.  The images will be fit to this size.  This is done so
// that the in-bag items align well in the bags.
const IN_BAG_ICON_DIMENSIONS = new Dimension2(50, 37);

// Create a map of asset/debt values to the images, sizes, and other information necessary to create the node for a
// particular value.  Note that the width is the only size provided, and the aspect ratio of the image ends up defining
// the height in the view.
const MAP_OF_VALUES_TO_IMAGE_INFO = new Map([[100, {
  outOfBagImage: asset100Value_png,
  outOfBagWidth: 80,
  inBagImage: asset100_png
}], [200, {
  outOfBagImage: asset200Value_png,
  outOfBagWidth: 85,
  outOfBagLabelOffset: new Vector2(0, -3),
  inBagImage: asset200_png
}], [300, {
  outOfBagImage: asset300Value_png,
  outOfBagWidth: 100,
  outOfBagLabelOffset: new Vector2(0, 5),
  inBagImage: asset300_png
}], [400, {
  outOfBagImage: asset400Value_png,
  outOfBagWidth: 50,
  outOfBagLabelOffset: new Vector2(0, 7),
  inBagImage: asset400_png
}], [-100, {
  outOfBagImage: debt100Value_png,
  outOfBagWidth: 65,
  outOfBagLabelOffset: new Vector2(0, 2),
  inBagImage: debt100_png
}], [-200, {
  outOfBagImage: debt200Value_png,
  outOfBagWidth: 70,
  outOfBagLabelOffset: new Vector2(8, -2),
  inBagImage: debt200_png
}], [-300, {
  outOfBagImage: debt300Value_png,
  outOfBagWidth: 65,
  inBagImage: debt300_png
}], [-400, {
  outOfBagImage: debt400Value_png,
  outOfBagWidth: 70,
  outOfBagLabelOffset: new Vector2(8, -2),
  inBagImage: debt400_png
}]]);
class BalanceSheetItemNode extends Node {
  /**
   * @param {ValueItem} balanceSheetItem
   */
  constructor(balanceSheetItem) {
    // Get the imageInfo that is associated with this balance sheet item's value.
    const imageInfo = MAP_OF_VALUES_TO_IMAGE_INFO.get(balanceSheetItem.value);
    assert && assert(imageInfo, `no imageInfo found for value ${balanceSheetItem.value}`);

    // out-of-bag image - shown when the balance sheet item is not in a balance sheet item bag
    const outOfBagImageNode = new Image(imageInfo.outOfBagImage, {
      cursor: 'pointer',
      maxWidth: imageInfo.outOfBagWidth,
      center: Vector2.ZERO
    });

    // in-bag image - shown when the balance sheet item is in a balance sheet item bag
    const inBagImageNode = new Image(imageInfo.inBagImage, {
      cursor: 'pointer',
      maxWidth: IN_BAG_ICON_DIMENSIONS.width,
      maxHeight: IN_BAG_ICON_DIMENSIONS.height,
      centerX: IN_BAG_ICON_DIMENSIONS.width / 2,
      centerY: IN_BAG_ICON_DIMENSIONS.height / 2
    });

    // background for the in-bag icon, this keeps the icons the same size in the layout
    const inBagIconBackground = Rectangle.dimension(IN_BAG_ICON_DIMENSIONS, {
      fill: Color.TRANSPARENT,
      children: [inBagImageNode]
    });
    const currencyString = StringUtils.fillIn(NumberLineOperationsStrings.currencyValuePattern, {
      sign: '',
      // don't show minus sign for debts, since that would be a sort of double negative
      currencyUnits: NumberLineOperationsStrings.currencyUnits,
      value: Math.abs(balanceSheetItem.value)
    });
    const outOfBagLabelNode = new Text(currencyString, {
      font: new PhetFont(18),
      center: imageInfo.outOfBagLabelOffset || Vector2.ZERO,
      maxWidth: outOfBagImageNode.width * 0.75 // empirically determined such that the label fits on all artwork
    });

    const outOfBagRepresentationNode = new Node({
      children: [outOfBagImageNode, outOfBagLabelNode]
    });
    const inBagLabelNode = new Text(currencyString, {
      font: new PhetFont(20),
      maxWidth: 60
    });
    const inBagRepresentationNode = new HBox({
      children: [inBagIconBackground, inBagLabelNode],
      spacing: 10,
      center: outOfBagImageNode.center
    });

    // Special Case: There are two values that are loans, and the word "loan" appeared on the original artwork.  We
    // realized fairly late in the game that this word should be translatable, so the following code handles that case.
    // It's specific to the loan images, and is thus fairly fragile, but it was the most expedient way to handle the
    // situation.  If other labels are ever needed, this should be generalized instead of continuing to follow this
    // approach.
    if (balanceSheetItem.value === -100 || balanceSheetItem.value === -300) {
      // out-of-bag representation
      const outOfBagTextLabelNode = new Text(NumberLineOperationsStrings.loan, {
        font: new PhetFont({
          size: 11,
          family: 'serif',
          style: 'italic'
        }),
        centerX: 0,
        centerY: outOfBagImageNode.bottom - 15,
        // offset empirically determined
        maxWidth: outOfBagImageNode.width * 0.65
      });
      outOfBagRepresentationNode.addChild(outOfBagTextLabelNode);

      // in-bag representation
      const inBagTextLabelNode = new Text(NumberLineOperationsStrings.loan, {
        font: new PhetFont({
          size: 8,
          family: 'serif',
          style: 'italic'
        }),
        centerX: inBagImageNode.centerX,
        centerY: inBagImageNode.bottom - 8,
        // offset empirically determined
        maxWidth: inBagImageNode.width * 0.65
      });
      inBagIconBackground.addChild(inBagTextLabelNode);
    }
    super({
      children: [outOfBagRepresentationNode, inBagRepresentationNode],
      cursor: 'pointer'
    });

    // Prevent from being grabbed when animating, unlink not needed.
    balanceSheetItem.inProgressAnimationProperty.link(inProgressAnimation => {
      this.pickable = inProgressAnimation === null;
    });

    // Update the visibility of the representations based on whether this item is in a balance sheet item bag.  No
    // unlink is needed.
    balanceSheetItem.inBagProperty.link(inBag => {
      // adjust node visibility
      outOfBagRepresentationNode.visible = !inBag;
      inBagRepresentationNode.visible = inBag;

      // adjust touch and mouse areas, dilation amounts empirically determined, check for overlap if changed
      if (inBag) {
        this.touchArea = inBagRepresentationNode.bounds.dilatedXY(10, 4);
        this.mouseArea = inBagRepresentationNode.bounds;
      } else {
        this.touchArea = outOfBagRepresentationNode.bounds.dilatedXY(10, 6);
        this.mouseArea = outOfBagRepresentationNode.bounds;
      }
    });

    // drag handler
    let dragOffset = Vector2.ZERO;
    this.addInputListener(new DragListener({
      dragBoundsProperty: new Property(this.layoutBounds),
      start: event => {
        balanceSheetItem.isDraggingProperty.value = true;
        const dragStartPoint = this.globalToParentPoint(event.pointer.point); // point in parent frame
        dragOffset = balanceSheetItem.positionProperty.value.minus(dragStartPoint);
        this.moveToFront(); // move to the front of the z-order in whatever layer this node is in
      },

      drag: event => {
        const dragPoint = this.globalToParentPoint(event.pointer.point);
        balanceSheetItem.teleportTo(dragPoint.plus(dragOffset));
      },
      end: () => {
        balanceSheetItem.isDraggingProperty.value = false;
      }
    }));

    // Position this node based on the model element position.  Note that there is no model-view transform, since we are
    // using the same coordinate system in both the model and view.  No unlink is needed.
    balanceSheetItem.positionProperty.link(position => {
      this.center = position;
    });
  }
}
numberLineOperations.register('BalanceSheetItemNode', BalanceSheetItemNode);
export default BalanceSheetItemNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIkRpbWVuc2lvbjIiLCJWZWN0b3IyIiwiU3RyaW5nVXRpbHMiLCJQaGV0Rm9udCIsIkNvbG9yIiwiRHJhZ0xpc3RlbmVyIiwiSEJveCIsIkltYWdlIiwiTm9kZSIsIlJlY3RhbmdsZSIsIlRleHQiLCJhc3NldDEwMF9wbmciLCJhc3NldDEwMFZhbHVlX3BuZyIsImFzc2V0MjAwX3BuZyIsImFzc2V0MjAwVmFsdWVfcG5nIiwiYXNzZXQzMDBfcG5nIiwiYXNzZXQzMDBWYWx1ZV9wbmciLCJhc3NldDQwMF9wbmciLCJhc3NldDQwMFZhbHVlX3BuZyIsImRlYnQxMDBfcG5nIiwiZGVidDEwMFZhbHVlX3BuZyIsImRlYnQyMDBfcG5nIiwiZGVidDIwMFZhbHVlX3BuZyIsImRlYnQzMDBfcG5nIiwiZGVidDMwMFZhbHVlX3BuZyIsImRlYnQ0MDBfcG5nIiwiZGVidDQwMFZhbHVlX3BuZyIsIm51bWJlckxpbmVPcGVyYXRpb25zIiwiTnVtYmVyTGluZU9wZXJhdGlvbnNTdHJpbmdzIiwiSU5fQkFHX0lDT05fRElNRU5TSU9OUyIsIk1BUF9PRl9WQUxVRVNfVE9fSU1BR0VfSU5GTyIsIk1hcCIsIm91dE9mQmFnSW1hZ2UiLCJvdXRPZkJhZ1dpZHRoIiwiaW5CYWdJbWFnZSIsIm91dE9mQmFnTGFiZWxPZmZzZXQiLCJCYWxhbmNlU2hlZXRJdGVtTm9kZSIsImNvbnN0cnVjdG9yIiwiYmFsYW5jZVNoZWV0SXRlbSIsImltYWdlSW5mbyIsImdldCIsInZhbHVlIiwiYXNzZXJ0Iiwib3V0T2ZCYWdJbWFnZU5vZGUiLCJjdXJzb3IiLCJtYXhXaWR0aCIsImNlbnRlciIsIlpFUk8iLCJpbkJhZ0ltYWdlTm9kZSIsIndpZHRoIiwibWF4SGVpZ2h0IiwiaGVpZ2h0IiwiY2VudGVyWCIsImNlbnRlclkiLCJpbkJhZ0ljb25CYWNrZ3JvdW5kIiwiZGltZW5zaW9uIiwiZmlsbCIsIlRSQU5TUEFSRU5UIiwiY2hpbGRyZW4iLCJjdXJyZW5jeVN0cmluZyIsImZpbGxJbiIsImN1cnJlbmN5VmFsdWVQYXR0ZXJuIiwic2lnbiIsImN1cnJlbmN5VW5pdHMiLCJNYXRoIiwiYWJzIiwib3V0T2ZCYWdMYWJlbE5vZGUiLCJmb250Iiwib3V0T2ZCYWdSZXByZXNlbnRhdGlvbk5vZGUiLCJpbkJhZ0xhYmVsTm9kZSIsImluQmFnUmVwcmVzZW50YXRpb25Ob2RlIiwic3BhY2luZyIsIm91dE9mQmFnVGV4dExhYmVsTm9kZSIsImxvYW4iLCJzaXplIiwiZmFtaWx5Iiwic3R5bGUiLCJib3R0b20iLCJhZGRDaGlsZCIsImluQmFnVGV4dExhYmVsTm9kZSIsImluUHJvZ3Jlc3NBbmltYXRpb25Qcm9wZXJ0eSIsImxpbmsiLCJpblByb2dyZXNzQW5pbWF0aW9uIiwicGlja2FibGUiLCJpbkJhZ1Byb3BlcnR5IiwiaW5CYWciLCJ2aXNpYmxlIiwidG91Y2hBcmVhIiwiYm91bmRzIiwiZGlsYXRlZFhZIiwibW91c2VBcmVhIiwiZHJhZ09mZnNldCIsImFkZElucHV0TGlzdGVuZXIiLCJkcmFnQm91bmRzUHJvcGVydHkiLCJsYXlvdXRCb3VuZHMiLCJzdGFydCIsImV2ZW50IiwiaXNEcmFnZ2luZ1Byb3BlcnR5IiwiZHJhZ1N0YXJ0UG9pbnQiLCJnbG9iYWxUb1BhcmVudFBvaW50IiwicG9pbnRlciIsInBvaW50IiwicG9zaXRpb25Qcm9wZXJ0eSIsIm1pbnVzIiwibW92ZVRvRnJvbnQiLCJkcmFnIiwiZHJhZ1BvaW50IiwidGVsZXBvcnRUbyIsInBsdXMiLCJlbmQiLCJwb3NpdGlvbiIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiQmFsYW5jZVNoZWV0SXRlbU5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjAtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQmFsYW5jZVNoZWV0SXRlbU5vZGUgaXMgdGhlIHZpZXcgcmVwcmVzZW50YXRpb24gb2YgYSBWYWx1ZUl0ZW0sIHdoaWNoIGlzIHRoZSBnZW5lcmFsIHRlcm0gYmVpbmcgdXNlZCBpbiB0aGlzXHJcbiAqIHNpbSBmb3IgYXNzZXRzIGFuZCBkZWJ0cy5cclxuICpcclxuICogQGF1dGhvciBKb2huIEJsYW5jbyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBEaW1lbnNpb24yIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9EaW1lbnNpb24yLmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgU3RyaW5nVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy91dGlsL1N0cmluZ1V0aWxzLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IENvbG9yLCBEcmFnTGlzdGVuZXIsIEhCb3gsIEltYWdlLCBOb2RlLCBSZWN0YW5nbGUsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgYXNzZXQxMDBfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9hc3NldDEwMF9wbmcuanMnO1xyXG5pbXBvcnQgYXNzZXQxMDBWYWx1ZV9wbmcgZnJvbSAnLi4vLi4vLi4vaW1hZ2VzL2Fzc2V0MTAwVmFsdWVfcG5nLmpzJztcclxuaW1wb3J0IGFzc2V0MjAwX3BuZyBmcm9tICcuLi8uLi8uLi9pbWFnZXMvYXNzZXQyMDBfcG5nLmpzJztcclxuaW1wb3J0IGFzc2V0MjAwVmFsdWVfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9hc3NldDIwMFZhbHVlX3BuZy5qcyc7XHJcbmltcG9ydCBhc3NldDMwMF9wbmcgZnJvbSAnLi4vLi4vLi4vaW1hZ2VzL2Fzc2V0MzAwX3BuZy5qcyc7XHJcbmltcG9ydCBhc3NldDMwMFZhbHVlX3BuZyBmcm9tICcuLi8uLi8uLi9pbWFnZXMvYXNzZXQzMDBWYWx1ZV9wbmcuanMnO1xyXG5pbXBvcnQgYXNzZXQ0MDBfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9hc3NldDQwMF9wbmcuanMnO1xyXG5pbXBvcnQgYXNzZXQ0MDBWYWx1ZV9wbmcgZnJvbSAnLi4vLi4vLi4vaW1hZ2VzL2Fzc2V0NDAwVmFsdWVfcG5nLmpzJztcclxuaW1wb3J0IGRlYnQxMDBfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9kZWJ0MTAwX3BuZy5qcyc7XHJcbmltcG9ydCBkZWJ0MTAwVmFsdWVfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9kZWJ0MTAwVmFsdWVfcG5nLmpzJztcclxuaW1wb3J0IGRlYnQyMDBfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9kZWJ0MjAwX3BuZy5qcyc7XHJcbmltcG9ydCBkZWJ0MjAwVmFsdWVfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9kZWJ0MjAwVmFsdWVfcG5nLmpzJztcclxuaW1wb3J0IGRlYnQzMDBfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9kZWJ0MzAwX3BuZy5qcyc7XHJcbmltcG9ydCBkZWJ0MzAwVmFsdWVfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9kZWJ0MzAwVmFsdWVfcG5nLmpzJztcclxuaW1wb3J0IGRlYnQ0MDBfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9kZWJ0NDAwX3BuZy5qcyc7XHJcbmltcG9ydCBkZWJ0NDAwVmFsdWVfcG5nIGZyb20gJy4uLy4uLy4uL2ltYWdlcy9kZWJ0NDAwVmFsdWVfcG5nLmpzJztcclxuaW1wb3J0IG51bWJlckxpbmVPcGVyYXRpb25zIGZyb20gJy4uLy4uL251bWJlckxpbmVPcGVyYXRpb25zLmpzJztcclxuaW1wb3J0IE51bWJlckxpbmVPcGVyYXRpb25zU3RyaW5ncyBmcm9tICcuLi8uLi9OdW1iZXJMaW5lT3BlcmF0aW9uc1N0cmluZ3MuanMnO1xyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gY29uc3RhbnRzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyBEaW1lbnNpb25zIG9mIHRoZSBpY29ucyB1c2VkIGZvciB0aGUgaW4tYmFnIHJlcHJlc2VudGF0aW9ucy4gIFRoZSBpbWFnZXMgd2lsbCBiZSBmaXQgdG8gdGhpcyBzaXplLiAgVGhpcyBpcyBkb25lIHNvXHJcbi8vIHRoYXQgdGhlIGluLWJhZyBpdGVtcyBhbGlnbiB3ZWxsIGluIHRoZSBiYWdzLlxyXG5jb25zdCBJTl9CQUdfSUNPTl9ESU1FTlNJT05TID0gbmV3IERpbWVuc2lvbjIoIDUwLCAzNyApO1xyXG5cclxuLy8gQ3JlYXRlIGEgbWFwIG9mIGFzc2V0L2RlYnQgdmFsdWVzIHRvIHRoZSBpbWFnZXMsIHNpemVzLCBhbmQgb3RoZXIgaW5mb3JtYXRpb24gbmVjZXNzYXJ5IHRvIGNyZWF0ZSB0aGUgbm9kZSBmb3IgYVxyXG4vLyBwYXJ0aWN1bGFyIHZhbHVlLiAgTm90ZSB0aGF0IHRoZSB3aWR0aCBpcyB0aGUgb25seSBzaXplIHByb3ZpZGVkLCBhbmQgdGhlIGFzcGVjdCByYXRpbyBvZiB0aGUgaW1hZ2UgZW5kcyB1cCBkZWZpbmluZ1xyXG4vLyB0aGUgaGVpZ2h0IGluIHRoZSB2aWV3LlxyXG5jb25zdCBNQVBfT0ZfVkFMVUVTX1RPX0lNQUdFX0lORk8gPSBuZXcgTWFwKCBbXHJcbiAgW1xyXG4gICAgMTAwLFxyXG4gICAge1xyXG4gICAgICBvdXRPZkJhZ0ltYWdlOiBhc3NldDEwMFZhbHVlX3BuZyxcclxuICAgICAgb3V0T2ZCYWdXaWR0aDogODAsXHJcbiAgICAgIGluQmFnSW1hZ2U6IGFzc2V0MTAwX3BuZ1xyXG4gICAgfVxyXG4gIF0sXHJcbiAgW1xyXG4gICAgMjAwLFxyXG4gICAge1xyXG4gICAgICBvdXRPZkJhZ0ltYWdlOiBhc3NldDIwMFZhbHVlX3BuZyxcclxuICAgICAgb3V0T2ZCYWdXaWR0aDogODUsXHJcbiAgICAgIG91dE9mQmFnTGFiZWxPZmZzZXQ6IG5ldyBWZWN0b3IyKCAwLCAtMyApLFxyXG4gICAgICBpbkJhZ0ltYWdlOiBhc3NldDIwMF9wbmdcclxuICAgIH1cclxuICBdLFxyXG4gIFtcclxuICAgIDMwMCxcclxuICAgIHtcclxuICAgICAgb3V0T2ZCYWdJbWFnZTogYXNzZXQzMDBWYWx1ZV9wbmcsXHJcbiAgICAgIG91dE9mQmFnV2lkdGg6IDEwMCxcclxuICAgICAgb3V0T2ZCYWdMYWJlbE9mZnNldDogbmV3IFZlY3RvcjIoIDAsIDUgKSxcclxuICAgICAgaW5CYWdJbWFnZTogYXNzZXQzMDBfcG5nXHJcbiAgICB9XHJcbiAgXSxcclxuICBbXHJcbiAgICA0MDAsXHJcbiAgICB7XHJcbiAgICAgIG91dE9mQmFnSW1hZ2U6IGFzc2V0NDAwVmFsdWVfcG5nLFxyXG4gICAgICBvdXRPZkJhZ1dpZHRoOiA1MCxcclxuICAgICAgb3V0T2ZCYWdMYWJlbE9mZnNldDogbmV3IFZlY3RvcjIoIDAsIDcgKSxcclxuICAgICAgaW5CYWdJbWFnZTogYXNzZXQ0MDBfcG5nXHJcbiAgICB9XHJcbiAgXSxcclxuICBbXHJcbiAgICAtMTAwLFxyXG4gICAge1xyXG4gICAgICBvdXRPZkJhZ0ltYWdlOiBkZWJ0MTAwVmFsdWVfcG5nLFxyXG4gICAgICBvdXRPZkJhZ1dpZHRoOiA2NSxcclxuICAgICAgb3V0T2ZCYWdMYWJlbE9mZnNldDogbmV3IFZlY3RvcjIoIDAsIDIgKSxcclxuICAgICAgaW5CYWdJbWFnZTogZGVidDEwMF9wbmdcclxuICAgIH1cclxuICBdLFxyXG4gIFtcclxuICAgIC0yMDAsXHJcbiAgICB7XHJcbiAgICAgIG91dE9mQmFnSW1hZ2U6IGRlYnQyMDBWYWx1ZV9wbmcsXHJcbiAgICAgIG91dE9mQmFnV2lkdGg6IDcwLFxyXG4gICAgICBvdXRPZkJhZ0xhYmVsT2Zmc2V0OiBuZXcgVmVjdG9yMiggOCwgLTIgKSxcclxuICAgICAgaW5CYWdJbWFnZTogZGVidDIwMF9wbmdcclxuICAgIH1cclxuICBdLFxyXG4gIFtcclxuICAgIC0zMDAsXHJcbiAgICB7XHJcbiAgICAgIG91dE9mQmFnSW1hZ2U6IGRlYnQzMDBWYWx1ZV9wbmcsXHJcbiAgICAgIG91dE9mQmFnV2lkdGg6IDY1LFxyXG4gICAgICBpbkJhZ0ltYWdlOiBkZWJ0MzAwX3BuZ1xyXG4gICAgfVxyXG4gIF0sXHJcbiAgW1xyXG4gICAgLTQwMCxcclxuICAgIHtcclxuICAgICAgb3V0T2ZCYWdJbWFnZTogZGVidDQwMFZhbHVlX3BuZyxcclxuICAgICAgb3V0T2ZCYWdXaWR0aDogNzAsXHJcbiAgICAgIG91dE9mQmFnTGFiZWxPZmZzZXQ6IG5ldyBWZWN0b3IyKCA4LCAtMiApLFxyXG4gICAgICBpbkJhZ0ltYWdlOiBkZWJ0NDAwX3BuZ1xyXG4gICAgfVxyXG4gIF1cclxuXSApO1xyXG5cclxuY2xhc3MgQmFsYW5jZVNoZWV0SXRlbU5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtWYWx1ZUl0ZW19IGJhbGFuY2VTaGVldEl0ZW1cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggYmFsYW5jZVNoZWV0SXRlbSApIHtcclxuXHJcbiAgICAvLyBHZXQgdGhlIGltYWdlSW5mbyB0aGF0IGlzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGJhbGFuY2Ugc2hlZXQgaXRlbSdzIHZhbHVlLlxyXG4gICAgY29uc3QgaW1hZ2VJbmZvID0gTUFQX09GX1ZBTFVFU19UT19JTUFHRV9JTkZPLmdldCggYmFsYW5jZVNoZWV0SXRlbS52YWx1ZSApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggaW1hZ2VJbmZvLCBgbm8gaW1hZ2VJbmZvIGZvdW5kIGZvciB2YWx1ZSAke2JhbGFuY2VTaGVldEl0ZW0udmFsdWV9YCApO1xyXG5cclxuICAgIC8vIG91dC1vZi1iYWcgaW1hZ2UgLSBzaG93biB3aGVuIHRoZSBiYWxhbmNlIHNoZWV0IGl0ZW0gaXMgbm90IGluIGEgYmFsYW5jZSBzaGVldCBpdGVtIGJhZ1xyXG4gICAgY29uc3Qgb3V0T2ZCYWdJbWFnZU5vZGUgPSBuZXcgSW1hZ2UoIGltYWdlSW5mby5vdXRPZkJhZ0ltYWdlLCB7XHJcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG4gICAgICBtYXhXaWR0aDogaW1hZ2VJbmZvLm91dE9mQmFnV2lkdGgsXHJcbiAgICAgIGNlbnRlcjogVmVjdG9yMi5aRVJPXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gaW4tYmFnIGltYWdlIC0gc2hvd24gd2hlbiB0aGUgYmFsYW5jZSBzaGVldCBpdGVtIGlzIGluIGEgYmFsYW5jZSBzaGVldCBpdGVtIGJhZ1xyXG4gICAgY29uc3QgaW5CYWdJbWFnZU5vZGUgPSBuZXcgSW1hZ2UoIGltYWdlSW5mby5pbkJhZ0ltYWdlLCB7XHJcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG4gICAgICBtYXhXaWR0aDogSU5fQkFHX0lDT05fRElNRU5TSU9OUy53aWR0aCxcclxuICAgICAgbWF4SGVpZ2h0OiBJTl9CQUdfSUNPTl9ESU1FTlNJT05TLmhlaWdodCxcclxuICAgICAgY2VudGVyWDogSU5fQkFHX0lDT05fRElNRU5TSU9OUy53aWR0aCAvIDIsXHJcbiAgICAgIGNlbnRlclk6IElOX0JBR19JQ09OX0RJTUVOU0lPTlMuaGVpZ2h0IC8gMlxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGJhY2tncm91bmQgZm9yIHRoZSBpbi1iYWcgaWNvbiwgdGhpcyBrZWVwcyB0aGUgaWNvbnMgdGhlIHNhbWUgc2l6ZSBpbiB0aGUgbGF5b3V0XHJcbiAgICBjb25zdCBpbkJhZ0ljb25CYWNrZ3JvdW5kID0gUmVjdGFuZ2xlLmRpbWVuc2lvbiggSU5fQkFHX0lDT05fRElNRU5TSU9OUywge1xyXG4gICAgICBmaWxsOiBDb2xvci5UUkFOU1BBUkVOVCxcclxuICAgICAgY2hpbGRyZW46IFsgaW5CYWdJbWFnZU5vZGUgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGN1cnJlbmN5U3RyaW5nID0gU3RyaW5nVXRpbHMuZmlsbEluKCBOdW1iZXJMaW5lT3BlcmF0aW9uc1N0cmluZ3MuY3VycmVuY3lWYWx1ZVBhdHRlcm4sIHtcclxuICAgICAgc2lnbjogJycsIC8vIGRvbid0IHNob3cgbWludXMgc2lnbiBmb3IgZGVidHMsIHNpbmNlIHRoYXQgd291bGQgYmUgYSBzb3J0IG9mIGRvdWJsZSBuZWdhdGl2ZVxyXG4gICAgICBjdXJyZW5jeVVuaXRzOiBOdW1iZXJMaW5lT3BlcmF0aW9uc1N0cmluZ3MuY3VycmVuY3lVbml0cyxcclxuICAgICAgdmFsdWU6IE1hdGguYWJzKCBiYWxhbmNlU2hlZXRJdGVtLnZhbHVlIClcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBvdXRPZkJhZ0xhYmVsTm9kZSA9IG5ldyBUZXh0KCBjdXJyZW5jeVN0cmluZywge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIDE4ICksXHJcbiAgICAgIGNlbnRlcjogaW1hZ2VJbmZvLm91dE9mQmFnTGFiZWxPZmZzZXQgfHwgVmVjdG9yMi5aRVJPLFxyXG4gICAgICBtYXhXaWR0aDogb3V0T2ZCYWdJbWFnZU5vZGUud2lkdGggKiAwLjc1IC8vIGVtcGlyaWNhbGx5IGRldGVybWluZWQgc3VjaCB0aGF0IHRoZSBsYWJlbCBmaXRzIG9uIGFsbCBhcnR3b3JrXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBvdXRPZkJhZ1JlcHJlc2VudGF0aW9uTm9kZSA9IG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIG91dE9mQmFnSW1hZ2VOb2RlLCBvdXRPZkJhZ0xhYmVsTm9kZSBdIH0gKTtcclxuXHJcbiAgICBjb25zdCBpbkJhZ0xhYmVsTm9kZSA9IG5ldyBUZXh0KCBjdXJyZW5jeVN0cmluZywge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIDIwICksXHJcbiAgICAgIG1heFdpZHRoOiA2MFxyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IGluQmFnUmVwcmVzZW50YXRpb25Ob2RlID0gbmV3IEhCb3goIHtcclxuICAgICAgY2hpbGRyZW46IFsgaW5CYWdJY29uQmFja2dyb3VuZCwgaW5CYWdMYWJlbE5vZGUgXSxcclxuICAgICAgc3BhY2luZzogMTAsXHJcbiAgICAgIGNlbnRlcjogb3V0T2ZCYWdJbWFnZU5vZGUuY2VudGVyXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gU3BlY2lhbCBDYXNlOiBUaGVyZSBhcmUgdHdvIHZhbHVlcyB0aGF0IGFyZSBsb2FucywgYW5kIHRoZSB3b3JkIFwibG9hblwiIGFwcGVhcmVkIG9uIHRoZSBvcmlnaW5hbCBhcnR3b3JrLiAgV2VcclxuICAgIC8vIHJlYWxpemVkIGZhaXJseSBsYXRlIGluIHRoZSBnYW1lIHRoYXQgdGhpcyB3b3JkIHNob3VsZCBiZSB0cmFuc2xhdGFibGUsIHNvIHRoZSBmb2xsb3dpbmcgY29kZSBoYW5kbGVzIHRoYXQgY2FzZS5cclxuICAgIC8vIEl0J3Mgc3BlY2lmaWMgdG8gdGhlIGxvYW4gaW1hZ2VzLCBhbmQgaXMgdGh1cyBmYWlybHkgZnJhZ2lsZSwgYnV0IGl0IHdhcyB0aGUgbW9zdCBleHBlZGllbnQgd2F5IHRvIGhhbmRsZSB0aGVcclxuICAgIC8vIHNpdHVhdGlvbi4gIElmIG90aGVyIGxhYmVscyBhcmUgZXZlciBuZWVkZWQsIHRoaXMgc2hvdWxkIGJlIGdlbmVyYWxpemVkIGluc3RlYWQgb2YgY29udGludWluZyB0byBmb2xsb3cgdGhpc1xyXG4gICAgLy8gYXBwcm9hY2guXHJcbiAgICBpZiAoIGJhbGFuY2VTaGVldEl0ZW0udmFsdWUgPT09IC0xMDAgfHwgYmFsYW5jZVNoZWV0SXRlbS52YWx1ZSA9PT0gLTMwMCApIHtcclxuXHJcbiAgICAgIC8vIG91dC1vZi1iYWcgcmVwcmVzZW50YXRpb25cclxuICAgICAgY29uc3Qgb3V0T2ZCYWdUZXh0TGFiZWxOb2RlID0gbmV3IFRleHQoIE51bWJlckxpbmVPcGVyYXRpb25zU3RyaW5ncy5sb2FuLCB7XHJcbiAgICAgICAgZm9udDogbmV3IFBoZXRGb250KCB7IHNpemU6IDExLCBmYW1pbHk6ICdzZXJpZicsIHN0eWxlOiAnaXRhbGljJyB9ICksXHJcbiAgICAgICAgY2VudGVyWDogMCxcclxuICAgICAgICBjZW50ZXJZOiBvdXRPZkJhZ0ltYWdlTm9kZS5ib3R0b20gLSAxNSwgLy8gb2Zmc2V0IGVtcGlyaWNhbGx5IGRldGVybWluZWRcclxuICAgICAgICBtYXhXaWR0aDogb3V0T2ZCYWdJbWFnZU5vZGUud2lkdGggKiAwLjY1XHJcbiAgICAgIH0gKTtcclxuICAgICAgb3V0T2ZCYWdSZXByZXNlbnRhdGlvbk5vZGUuYWRkQ2hpbGQoIG91dE9mQmFnVGV4dExhYmVsTm9kZSApO1xyXG5cclxuICAgICAgLy8gaW4tYmFnIHJlcHJlc2VudGF0aW9uXHJcbiAgICAgIGNvbnN0IGluQmFnVGV4dExhYmVsTm9kZSA9IG5ldyBUZXh0KCBOdW1iZXJMaW5lT3BlcmF0aW9uc1N0cmluZ3MubG9hbiwge1xyXG4gICAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggeyBzaXplOiA4LCBmYW1pbHk6ICdzZXJpZicsIHN0eWxlOiAnaXRhbGljJyB9ICksXHJcbiAgICAgICAgY2VudGVyWDogaW5CYWdJbWFnZU5vZGUuY2VudGVyWCxcclxuICAgICAgICBjZW50ZXJZOiBpbkJhZ0ltYWdlTm9kZS5ib3R0b20gLSA4LCAvLyBvZmZzZXQgZW1waXJpY2FsbHkgZGV0ZXJtaW5lZFxyXG4gICAgICAgIG1heFdpZHRoOiBpbkJhZ0ltYWdlTm9kZS53aWR0aCAqIDAuNjVcclxuICAgICAgfSApO1xyXG4gICAgICBpbkJhZ0ljb25CYWNrZ3JvdW5kLmFkZENoaWxkKCBpbkJhZ1RleHRMYWJlbE5vZGUgKTtcclxuICAgIH1cclxuXHJcbiAgICBzdXBlcigge1xyXG4gICAgICBjaGlsZHJlbjogWyBvdXRPZkJhZ1JlcHJlc2VudGF0aW9uTm9kZSwgaW5CYWdSZXByZXNlbnRhdGlvbk5vZGUgXSxcclxuICAgICAgY3Vyc29yOiAncG9pbnRlcidcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBQcmV2ZW50IGZyb20gYmVpbmcgZ3JhYmJlZCB3aGVuIGFuaW1hdGluZywgdW5saW5rIG5vdCBuZWVkZWQuXHJcbiAgICBiYWxhbmNlU2hlZXRJdGVtLmluUHJvZ3Jlc3NBbmltYXRpb25Qcm9wZXJ0eS5saW5rKCBpblByb2dyZXNzQW5pbWF0aW9uID0+IHtcclxuICAgICAgdGhpcy5waWNrYWJsZSA9IGluUHJvZ3Jlc3NBbmltYXRpb24gPT09IG51bGw7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSByZXByZXNlbnRhdGlvbnMgYmFzZWQgb24gd2hldGhlciB0aGlzIGl0ZW0gaXMgaW4gYSBiYWxhbmNlIHNoZWV0IGl0ZW0gYmFnLiAgTm9cclxuICAgIC8vIHVubGluayBpcyBuZWVkZWQuXHJcbiAgICBiYWxhbmNlU2hlZXRJdGVtLmluQmFnUHJvcGVydHkubGluayggaW5CYWcgPT4ge1xyXG5cclxuICAgICAgLy8gYWRqdXN0IG5vZGUgdmlzaWJpbGl0eVxyXG4gICAgICBvdXRPZkJhZ1JlcHJlc2VudGF0aW9uTm9kZS52aXNpYmxlID0gIWluQmFnO1xyXG4gICAgICBpbkJhZ1JlcHJlc2VudGF0aW9uTm9kZS52aXNpYmxlID0gaW5CYWc7XHJcblxyXG4gICAgICAvLyBhZGp1c3QgdG91Y2ggYW5kIG1vdXNlIGFyZWFzLCBkaWxhdGlvbiBhbW91bnRzIGVtcGlyaWNhbGx5IGRldGVybWluZWQsIGNoZWNrIGZvciBvdmVybGFwIGlmIGNoYW5nZWRcclxuICAgICAgaWYgKCBpbkJhZyApIHtcclxuICAgICAgICB0aGlzLnRvdWNoQXJlYSA9IGluQmFnUmVwcmVzZW50YXRpb25Ob2RlLmJvdW5kcy5kaWxhdGVkWFkoIDEwLCA0ICk7XHJcbiAgICAgICAgdGhpcy5tb3VzZUFyZWEgPSBpbkJhZ1JlcHJlc2VudGF0aW9uTm9kZS5ib3VuZHM7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdGhpcy50b3VjaEFyZWEgPSBvdXRPZkJhZ1JlcHJlc2VudGF0aW9uTm9kZS5ib3VuZHMuZGlsYXRlZFhZKCAxMCwgNiApO1xyXG4gICAgICAgIHRoaXMubW91c2VBcmVhID0gb3V0T2ZCYWdSZXByZXNlbnRhdGlvbk5vZGUuYm91bmRzO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gZHJhZyBoYW5kbGVyXHJcbiAgICBsZXQgZHJhZ09mZnNldCA9IFZlY3RvcjIuWkVSTztcclxuICAgIHRoaXMuYWRkSW5wdXRMaXN0ZW5lciggbmV3IERyYWdMaXN0ZW5lcigge1xyXG5cclxuICAgICAgZHJhZ0JvdW5kc1Byb3BlcnR5OiBuZXcgUHJvcGVydHkoIHRoaXMubGF5b3V0Qm91bmRzICksXHJcblxyXG4gICAgICBzdGFydDogZXZlbnQgPT4ge1xyXG4gICAgICAgIGJhbGFuY2VTaGVldEl0ZW0uaXNEcmFnZ2luZ1Byb3BlcnR5LnZhbHVlID0gdHJ1ZTtcclxuICAgICAgICBjb25zdCBkcmFnU3RhcnRQb2ludCA9IHRoaXMuZ2xvYmFsVG9QYXJlbnRQb2ludCggZXZlbnQucG9pbnRlci5wb2ludCApOyAvLyBwb2ludCBpbiBwYXJlbnQgZnJhbWVcclxuICAgICAgICBkcmFnT2Zmc2V0ID0gYmFsYW5jZVNoZWV0SXRlbS5wb3NpdGlvblByb3BlcnR5LnZhbHVlLm1pbnVzKCBkcmFnU3RhcnRQb2ludCApO1xyXG4gICAgICAgIHRoaXMubW92ZVRvRnJvbnQoKTsgLy8gbW92ZSB0byB0aGUgZnJvbnQgb2YgdGhlIHotb3JkZXIgaW4gd2hhdGV2ZXIgbGF5ZXIgdGhpcyBub2RlIGlzIGluXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBkcmFnOiBldmVudCA9PiB7XHJcbiAgICAgICAgY29uc3QgZHJhZ1BvaW50ID0gdGhpcy5nbG9iYWxUb1BhcmVudFBvaW50KCBldmVudC5wb2ludGVyLnBvaW50ICk7XHJcbiAgICAgICAgYmFsYW5jZVNoZWV0SXRlbS50ZWxlcG9ydFRvKCBkcmFnUG9pbnQucGx1cyggZHJhZ09mZnNldCApICk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBlbmQ6ICgpID0+IHtcclxuICAgICAgICBiYWxhbmNlU2hlZXRJdGVtLmlzRHJhZ2dpbmdQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBQb3NpdGlvbiB0aGlzIG5vZGUgYmFzZWQgb24gdGhlIG1vZGVsIGVsZW1lbnQgcG9zaXRpb24uICBOb3RlIHRoYXQgdGhlcmUgaXMgbm8gbW9kZWwtdmlldyB0cmFuc2Zvcm0sIHNpbmNlIHdlIGFyZVxyXG4gICAgLy8gdXNpbmcgdGhlIHNhbWUgY29vcmRpbmF0ZSBzeXN0ZW0gaW4gYm90aCB0aGUgbW9kZWwgYW5kIHZpZXcuICBObyB1bmxpbmsgaXMgbmVlZGVkLlxyXG4gICAgYmFsYW5jZVNoZWV0SXRlbS5wb3NpdGlvblByb3BlcnR5LmxpbmsoIHBvc2l0aW9uID0+IHtcclxuICAgICAgdGhpcy5jZW50ZXIgPSBwb3NpdGlvbjtcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbm51bWJlckxpbmVPcGVyYXRpb25zLnJlZ2lzdGVyKCAnQmFsYW5jZVNoZWV0SXRlbU5vZGUnLCBCYWxhbmNlU2hlZXRJdGVtTm9kZSApO1xyXG5leHBvcnQgZGVmYXVsdCBCYWxhbmNlU2hlZXRJdGVtTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxRQUFRLE1BQU0saUNBQWlDO0FBQ3RELE9BQU9DLFVBQVUsTUFBTSxrQ0FBa0M7QUFDekQsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxXQUFXLE1BQU0sK0NBQStDO0FBQ3ZFLE9BQU9DLFFBQVEsTUFBTSx5Q0FBeUM7QUFD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