// Copyright 2020-2023, University of Colorado Boulder

/**
 * TotalValueIndicatorNode is a Scenery node that takes a background node and shows a total value over it, and fills
 * the total value node with different colors based on the total value.
 *
 * @author John Blanco (PhET Interactive Simulations)
 */

import Vector2 from '../../../../dot/js/Vector2.js';
import merge from '../../../../phet-core/js/merge.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import MathSymbols from '../../../../scenery-phet/js/MathSymbols.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Color, Node, Text } from '../../../../scenery/js/imports.js';
import numberLineOperations from '../../numberLineOperations.js';
import NumberLineOperationsStrings from '../../NumberLineOperationsStrings.js';
class TotalValueIndicatorNode extends Node {
  /**
   * @param {NumberProperty} totalValueProperty
   * @param {Node} fillableBackgroundNode - the node that will serve as the background to the value, must support setting fill
   * @param {Range} range
   * @param {Object} [options]
   */
  constructor(totalValueProperty, fillableBackgroundNode, range, options) {
    options = merge({
      // {Vector2} - offset of the label from the center of the background node
      labelCenterOffset: Vector2.ZERO,
      // {boolean} - if false, just shows the number, if true, uses a currency symbol and pattern
      isCurrency: false,
      // {Color} - color values used, and interpolated between, as the total value changes
      zeroFill: Color.WHITE,
      mostPositiveFill: new Color('#1fb493'),
      leastPositiveFill: new Color('#a5e1d4'),
      mostNegativeFill: new Color('#fb1d25'),
      leastNegativeFill: new Color('#fda5a8')
    }, options);

    // label that represents the value
    const labelNode = new Text('', {
      font: new PhetFont(20),
      fill: 'white',
      stroke: 'black',
      center: Vector2.ZERO,
      maxWidth: 65
    });
    super(merge({
      children: [fillableBackgroundNode, labelNode]
    }, options));

    // Update the fill and label as the total value changes.  Instances of this type are assumed to exist for the
    // duration of the sim, so no unlink is necessary.
    totalValueProperty.link(totalValue => {
      // Update the label text.
      const sign = totalValue < 0 ? MathSymbols.MINUS : '';
      if (options.isCurrency) {
        labelNode.string = StringUtils.fillIn(NumberLineOperationsStrings.currencyValuePattern, {
          sign: sign,
          currencyUnits: NumberLineOperationsStrings.currencyUnits,
          value: Math.abs(totalValue)
        });
      } else {
        labelNode.string = sign + Math.abs(totalValue).toString(10);
      }

      // Reposition the label.
      labelNode.center = fillableBackgroundNode.center.plus(options.labelCenterOffset);

      // Set the fill.
      let fill = options.zeroFill;
      if (totalValue < 0) {
        fill = Color.interpolateRGBA(options.leastNegativeFill, options.mostNegativeFill, totalValue / range.min);
      } else if (totalValue > 0) {
        fill = Color.interpolateRGBA(options.leastPositiveFill, options.mostPositiveFill, totalValue / range.max);
      }
      fillableBackgroundNode.fill = fill;
    });
  }
}
numberLineOperations.register('TotalValueIndicatorNode', TotalValueIndicatorNode);
export default TotalValueIndicatorNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWZWN0b3IyIiwibWVyZ2UiLCJTdHJpbmdVdGlscyIsIk1hdGhTeW1ib2xzIiwiUGhldEZvbnQiLCJDb2xvciIsIk5vZGUiLCJUZXh0IiwibnVtYmVyTGluZU9wZXJhdGlvbnMiLCJOdW1iZXJMaW5lT3BlcmF0aW9uc1N0cmluZ3MiLCJUb3RhbFZhbHVlSW5kaWNhdG9yTm9kZSIsImNvbnN0cnVjdG9yIiwidG90YWxWYWx1ZVByb3BlcnR5IiwiZmlsbGFibGVCYWNrZ3JvdW5kTm9kZSIsInJhbmdlIiwib3B0aW9ucyIsImxhYmVsQ2VudGVyT2Zmc2V0IiwiWkVSTyIsImlzQ3VycmVuY3kiLCJ6ZXJvRmlsbCIsIldISVRFIiwibW9zdFBvc2l0aXZlRmlsbCIsImxlYXN0UG9zaXRpdmVGaWxsIiwibW9zdE5lZ2F0aXZlRmlsbCIsImxlYXN0TmVnYXRpdmVGaWxsIiwibGFiZWxOb2RlIiwiZm9udCIsImZpbGwiLCJzdHJva2UiLCJjZW50ZXIiLCJtYXhXaWR0aCIsImNoaWxkcmVuIiwibGluayIsInRvdGFsVmFsdWUiLCJzaWduIiwiTUlOVVMiLCJzdHJpbmciLCJmaWxsSW4iLCJjdXJyZW5jeVZhbHVlUGF0dGVybiIsImN1cnJlbmN5VW5pdHMiLCJ2YWx1ZSIsIk1hdGgiLCJhYnMiLCJ0b1N0cmluZyIsInBsdXMiLCJpbnRlcnBvbGF0ZVJHQkEiLCJtaW4iLCJtYXgiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlRvdGFsVmFsdWVJbmRpY2F0b3JOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIwLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFRvdGFsVmFsdWVJbmRpY2F0b3JOb2RlIGlzIGEgU2NlbmVyeSBub2RlIHRoYXQgdGFrZXMgYSBiYWNrZ3JvdW5kIG5vZGUgYW5kIHNob3dzIGEgdG90YWwgdmFsdWUgb3ZlciBpdCwgYW5kIGZpbGxzXHJcbiAqIHRoZSB0b3RhbCB2YWx1ZSBub2RlIHdpdGggZGlmZmVyZW50IGNvbG9ycyBiYXNlZCBvbiB0aGUgdG90YWwgdmFsdWUuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY28gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IFN0cmluZ1V0aWxzIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdXRpbC9TdHJpbmdVdGlscy5qcyc7XHJcbmltcG9ydCBNYXRoU3ltYm9scyBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvTWF0aFN5bWJvbHMuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgQ29sb3IsIE5vZGUsIFRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgbnVtYmVyTGluZU9wZXJhdGlvbnMgZnJvbSAnLi4vLi4vbnVtYmVyTGluZU9wZXJhdGlvbnMuanMnO1xyXG5pbXBvcnQgTnVtYmVyTGluZU9wZXJhdGlvbnNTdHJpbmdzIGZyb20gJy4uLy4uL051bWJlckxpbmVPcGVyYXRpb25zU3RyaW5ncy5qcyc7XHJcblxyXG5jbGFzcyBUb3RhbFZhbHVlSW5kaWNhdG9yTm9kZSBleHRlbmRzIE5vZGUge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge051bWJlclByb3BlcnR5fSB0b3RhbFZhbHVlUHJvcGVydHlcclxuICAgKiBAcGFyYW0ge05vZGV9IGZpbGxhYmxlQmFja2dyb3VuZE5vZGUgLSB0aGUgbm9kZSB0aGF0IHdpbGwgc2VydmUgYXMgdGhlIGJhY2tncm91bmQgdG8gdGhlIHZhbHVlLCBtdXN0IHN1cHBvcnQgc2V0dGluZyBmaWxsXHJcbiAgICogQHBhcmFtIHtSYW5nZX0gcmFuZ2VcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHRvdGFsVmFsdWVQcm9wZXJ0eSwgZmlsbGFibGVCYWNrZ3JvdW5kTm9kZSwgcmFuZ2UsIG9wdGlvbnMgKSB7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcblxyXG4gICAgICAvLyB7VmVjdG9yMn0gLSBvZmZzZXQgb2YgdGhlIGxhYmVsIGZyb20gdGhlIGNlbnRlciBvZiB0aGUgYmFja2dyb3VuZCBub2RlXHJcbiAgICAgIGxhYmVsQ2VudGVyT2Zmc2V0OiBWZWN0b3IyLlpFUk8sXHJcblxyXG4gICAgICAvLyB7Ym9vbGVhbn0gLSBpZiBmYWxzZSwganVzdCBzaG93cyB0aGUgbnVtYmVyLCBpZiB0cnVlLCB1c2VzIGEgY3VycmVuY3kgc3ltYm9sIGFuZCBwYXR0ZXJuXHJcbiAgICAgIGlzQ3VycmVuY3k6IGZhbHNlLFxyXG5cclxuICAgICAgLy8ge0NvbG9yfSAtIGNvbG9yIHZhbHVlcyB1c2VkLCBhbmQgaW50ZXJwb2xhdGVkIGJldHdlZW4sIGFzIHRoZSB0b3RhbCB2YWx1ZSBjaGFuZ2VzXHJcbiAgICAgIHplcm9GaWxsOiBDb2xvci5XSElURSxcclxuICAgICAgbW9zdFBvc2l0aXZlRmlsbDogbmV3IENvbG9yKCAnIzFmYjQ5MycgKSxcclxuICAgICAgbGVhc3RQb3NpdGl2ZUZpbGw6IG5ldyBDb2xvciggJyNhNWUxZDQnICksXHJcbiAgICAgIG1vc3ROZWdhdGl2ZUZpbGw6IG5ldyBDb2xvciggJyNmYjFkMjUnICksXHJcbiAgICAgIGxlYXN0TmVnYXRpdmVGaWxsOiBuZXcgQ29sb3IoICcjZmRhNWE4JyApXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gbGFiZWwgdGhhdCByZXByZXNlbnRzIHRoZSB2YWx1ZVxyXG4gICAgY29uc3QgbGFiZWxOb2RlID0gbmV3IFRleHQoICcnLCB7XHJcbiAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggMjAgKSxcclxuICAgICAgZmlsbDogJ3doaXRlJyxcclxuICAgICAgc3Ryb2tlOiAnYmxhY2snLFxyXG4gICAgICBjZW50ZXI6IFZlY3RvcjIuWkVSTyxcclxuICAgICAgbWF4V2lkdGg6IDY1XHJcbiAgICB9ICk7XHJcblxyXG4gICAgc3VwZXIoIG1lcmdlKCB7IGNoaWxkcmVuOiBbIGZpbGxhYmxlQmFja2dyb3VuZE5vZGUsIGxhYmVsTm9kZSBdIH0sIG9wdGlvbnMgKSApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgZmlsbCBhbmQgbGFiZWwgYXMgdGhlIHRvdGFsIHZhbHVlIGNoYW5nZXMuICBJbnN0YW5jZXMgb2YgdGhpcyB0eXBlIGFyZSBhc3N1bWVkIHRvIGV4aXN0IGZvciB0aGVcclxuICAgIC8vIGR1cmF0aW9uIG9mIHRoZSBzaW0sIHNvIG5vIHVubGluayBpcyBuZWNlc3NhcnkuXHJcbiAgICB0b3RhbFZhbHVlUHJvcGVydHkubGluayggdG90YWxWYWx1ZSA9PiB7XHJcblxyXG4gICAgICAvLyBVcGRhdGUgdGhlIGxhYmVsIHRleHQuXHJcbiAgICAgIGNvbnN0IHNpZ24gPSB0b3RhbFZhbHVlIDwgMCA/IE1hdGhTeW1ib2xzLk1JTlVTIDogJyc7XHJcbiAgICAgIGlmICggb3B0aW9ucy5pc0N1cnJlbmN5ICkge1xyXG4gICAgICAgIGxhYmVsTm9kZS5zdHJpbmcgPSBTdHJpbmdVdGlscy5maWxsSW4oIE51bWJlckxpbmVPcGVyYXRpb25zU3RyaW5ncy5jdXJyZW5jeVZhbHVlUGF0dGVybiwge1xyXG4gICAgICAgICAgc2lnbjogc2lnbixcclxuICAgICAgICAgIGN1cnJlbmN5VW5pdHM6IE51bWJlckxpbmVPcGVyYXRpb25zU3RyaW5ncy5jdXJyZW5jeVVuaXRzLFxyXG4gICAgICAgICAgdmFsdWU6IE1hdGguYWJzKCB0b3RhbFZhbHVlIClcclxuICAgICAgICB9ICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgbGFiZWxOb2RlLnN0cmluZyA9IHNpZ24gKyBNYXRoLmFicyggdG90YWxWYWx1ZSApLnRvU3RyaW5nKCAxMCApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBSZXBvc2l0aW9uIHRoZSBsYWJlbC5cclxuICAgICAgbGFiZWxOb2RlLmNlbnRlciA9IGZpbGxhYmxlQmFja2dyb3VuZE5vZGUuY2VudGVyLnBsdXMoIG9wdGlvbnMubGFiZWxDZW50ZXJPZmZzZXQgKTtcclxuXHJcbiAgICAgIC8vIFNldCB0aGUgZmlsbC5cclxuICAgICAgbGV0IGZpbGwgPSBvcHRpb25zLnplcm9GaWxsO1xyXG4gICAgICBpZiAoIHRvdGFsVmFsdWUgPCAwICkge1xyXG4gICAgICAgIGZpbGwgPSBDb2xvci5pbnRlcnBvbGF0ZVJHQkEoXHJcbiAgICAgICAgICBvcHRpb25zLmxlYXN0TmVnYXRpdmVGaWxsLFxyXG4gICAgICAgICAgb3B0aW9ucy5tb3N0TmVnYXRpdmVGaWxsLFxyXG4gICAgICAgICAgdG90YWxWYWx1ZSAvIHJhbmdlLm1pblxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIHRvdGFsVmFsdWUgPiAwICkge1xyXG4gICAgICAgIGZpbGwgPSBDb2xvci5pbnRlcnBvbGF0ZVJHQkEoXHJcbiAgICAgICAgICBvcHRpb25zLmxlYXN0UG9zaXRpdmVGaWxsLFxyXG4gICAgICAgICAgb3B0aW9ucy5tb3N0UG9zaXRpdmVGaWxsLFxyXG4gICAgICAgICAgdG90YWxWYWx1ZSAvIHJhbmdlLm1heFxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgICAgZmlsbGFibGVCYWNrZ3JvdW5kTm9kZS5maWxsID0gZmlsbDtcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbm51bWJlckxpbmVPcGVyYXRpb25zLnJlZ2lzdGVyKCAnVG90YWxWYWx1ZUluZGljYXRvck5vZGUnLCBUb3RhbFZhbHVlSW5kaWNhdG9yTm9kZSApO1xyXG5leHBvcnQg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