// Copyright 2020-2021, University of Colorado Boulder

/**
 * NLOGenericModel is the primary model for the "Generic" screen.
 *
 * @author John Blanco (PhET Interactive Simulations)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import createObservableArray from '../../../../axon/js/createObservableArray.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Range from '../../../../dot/js/Range.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import LockToNumberLine from '../../../../number-line-common/js/common/model/LockToNumberLine.js';
import PointController from '../../../../number-line-common/js/common/model/PointController.js';
import merge from '../../../../phet-core/js/merge.js';
import { Color } from '../../../../scenery/js/imports.js';
import Animation from '../../../../twixt/js/Animation.js';
import Easing from '../../../../twixt/js/Easing.js';
import OperationTrackingNumberLine from '../../common/model/OperationTrackingNumberLine.js';
import NLOConstants from '../../common/NLOConstants.js';
import numberLineOperations from '../../numberLineOperations.js';

// constants
const NUMBER_LINE_RANGES = [new Range(-10, 10), new Range(-30, 30), new Range(-100, 100)];
const MODEL_BOUNDS = NLOConstants.LAYOUT_BOUNDS;
const NUMBER_LINE_CENTER_X = MODEL_BOUNDS.centerX; // matches design doc layout
const PRIMARY_NUMBER_LINE_LOWER_POSITION = new Vector2(NUMBER_LINE_CENTER_X, MODEL_BOUNDS.centerY);
const PRIMARY_NUMBER_LINE_UPPER_POSITION = PRIMARY_NUMBER_LINE_LOWER_POSITION.minusXY(0, MODEL_BOUNDS.height * 0.15);
const COMMON_NUMBER_LINE_OPTIONS = {
  numberOfOperationsTracked: 2,
  initialDisplayedRange: NUMBER_LINE_RANGES[0],
  tickMarksInitiallyVisible: true,
  preventOverlap: false,
  labelsInitiallyVisible: true,
  operationDescriptionsInitiallyVisible: false,
  widthInModelSpace: NLOConstants.NUMBER_LINE_WIDTH,
  operationOptionsArray: [{
    initialAmount: 1
  }, {
    initialAmount: 1
  }]
};
class NLOGenericModel {
  /**
   * @param {Tandem} tandem
   */
  constructor(tandem) {
    // @public (read-write) - whether or not the 2nd number line is visible to the user
    this.secondNumberLineVisibleProperty = new BooleanProperty(false);

    // @public - the primary operation-tracking number line, which is always visible
    this.primaryNumberLine = new OperationTrackingNumberLine(PRIMARY_NUMBER_LINE_LOWER_POSITION, merge({
      startingValueProperty: new NumberProperty(1),
      pointColorList: [NLOConstants.DARK_BLUE_POINT_COLOR, NLOConstants.MEDIUM_BLUE_POINT_COLOR, NLOConstants.LIGHT_BLUE_POINT_COLOR]
    }, COMMON_NUMBER_LINE_OPTIONS));

    // @public (read-only) - Associate a point controller with the point that represents the initial value on the
    // operation tracking number line.  This point controller will always be present on the number line, whereas there
    // are others that can come and go.
    assert && assert(this.primaryNumberLine.residentPoints.length === 1, 'expected only one point on the number line');
    this.primaryLineInitialValuePointController = new PointController({
      color: this.primaryNumberLine.startingPoint.colorProperty.value,
      numberLines: [this.primaryNumberLine],
      numberLinePoints: [this.primaryNumberLine.startingPoint],
      lockToNumberLine: LockToNumberLine.ALWAYS
    });

    // @public (read-only) {ObservableArrayDef.<PointController>} - A list of the point controllers for the primary
    // number line. These come and go as points come and go.
    this.primaryNumberLinePointControllers = createObservableArray();
    this.primaryNumberLine.residentPoints.addItemAddedListener(addedPoint => {
      // Add a point controller for the newly added point.
      const pointController = new PointController({
        color: addedPoint.colorProperty.value,
        numberLines: [this.primaryNumberLine],
        numberLinePoints: [addedPoint],
        lockToNumberLine: LockToNumberLine.ALWAYS
      });
      this.primaryNumberLinePointControllers.push(pointController);

      // Remove the point controller when the associated point goes away.
      const removalListener = removedPoint => {
        if (removedPoint === addedPoint) {
          this.primaryNumberLinePointControllers.remove(pointController);
          pointController.dispose();
          this.primaryNumberLine.residentPoints.removeItemRemovedListener(removalListener);
        }
      };
      this.primaryNumberLine.residentPoints.addItemRemovedListener(removalListener);
    });

    // @public - the secondary operation-tracking number line, which is only visible when enabled by the user
    this.secondaryNumberLine = new OperationTrackingNumberLine(this.primaryNumberLine.centerPositionProperty.value.plusXY(0, 62), merge({
      startingValueProperty: new NumberProperty(1),
      pointColorList: [new Color('#a400cc'), new Color('#ef29ff'), new Color('#fb71ff')]
    }, COMMON_NUMBER_LINE_OPTIONS));

    // Link the view control properties from the primary number line to those in the secondary number line.  Calls to
    // unlink are not needed.
    this.primaryNumberLine.showPointLabelsProperty.link(showPointLabels => this.secondaryNumberLine.showPointLabelsProperty.set(showPointLabels));
    this.primaryNumberLine.showOperationLabelsProperty.link(showPointLabels => this.secondaryNumberLine.showOperationLabelsProperty.set(showPointLabels));
    this.primaryNumberLine.showTickMarksProperty.link(showPointLabels => this.secondaryNumberLine.showTickMarksProperty.set(showPointLabels));

    // @public (read-only) - Associate a point controller with the point that represents the initial value on the
    // operation tracking number line.  This point controller will always be present on the number line, whereas there
    // are others that can come and go.
    assert && assert(this.secondaryNumberLine.residentPoints.length === 1, 'expected only one point on the number line');
    this.secondaryLineInitialValuePointController = new PointController({
      color: this.secondaryNumberLine.startingPoint.colorProperty.value,
      numberLines: [this.secondaryNumberLine],
      numberLinePoints: [this.secondaryNumberLine.startingPoint],
      lockToNumberLine: LockToNumberLine.ALWAYS
    });

    // @public (read-only) {ObservableArrayDef.<PointController>} - A list of the point controllers for the secondary number
    // line. These come and go as points come and go.
    this.secondaryNumberLinePointControllers = createObservableArray();
    this.secondaryNumberLine.residentPoints.addItemAddedListener(addedPoint => {
      // Add a point controller for the newly added point.
      const pointController = new PointController({
        color: addedPoint.colorProperty.value,
        numberLines: [this.secondaryNumberLine],
        numberLinePoints: [addedPoint],
        lockToNumberLine: LockToNumberLine.ALWAYS
      });
      this.secondaryNumberLinePointControllers.push(pointController);

      // Remove the point controller when the associated point goes away.
      const removalListener = removedPoint => {
        if (removedPoint === addedPoint) {
          this.secondaryNumberLinePointControllers.remove(pointController);
          pointController.dispose();
          this.secondaryNumberLine.residentPoints.removeItemRemovedListener(removalListener);
        }
      };
      this.secondaryNumberLine.residentPoints.addItemRemovedListener(removalListener);
    });

    // animation to move the primary number line around based on with the secondary is being shown
    this.primaryNumberLineAnimation = null;

    // Position the primary number line based on whether the secondary number line is visible.  No unlink is needed.
    this.secondNumberLineVisibleProperty.link(secondNumberLineVisible => {
      const destination = secondNumberLineVisible ? PRIMARY_NUMBER_LINE_UPPER_POSITION : PRIMARY_NUMBER_LINE_LOWER_POSITION;
      if (!this.primaryNumberLine.centerPositionProperty.value.equals(destination)) {
        // Stop any previous animation.
        if (this.primaryNumberLineAnimation) {
          this.primaryNumberLineAnimation.stop();
        }

        // Start an animation to move the number line to the desired position.
        this.primaryNumberLineAnimation = new Animation({
          duration: 0.5,
          targets: [{
            property: this.primaryNumberLine.centerPositionProperty,
            easing: Easing.CUBIC_IN_OUT,
            to: destination
          }]
        });
        this.primaryNumberLineAnimation.start();
        this.primaryNumberLineAnimation.endedEmitter.addListener(() => {
          this.primaryNumberLineAnimation = null;
        });
      }
    });
  }

  /**
   * Resets the model.
   * @public
   */
  reset() {
    this.primaryNumberLine.reset();
    this.secondaryNumberLine.reset();
    this.secondNumberLineVisibleProperty.reset();
  }
}

// statics
NLOGenericModel.NUMBER_LINE_RANGES = NUMBER_LINE_RANGES;
numberLineOperations.register('NLOGenericModel', NLOGenericModel);
export default NLOGenericModel;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJjcmVhdGVPYnNlcnZhYmxlQXJyYXkiLCJOdW1iZXJQcm9wZXJ0eSIsIlJhbmdlIiwiVmVjdG9yMiIsIkxvY2tUb051bWJlckxpbmUiLCJQb2ludENvbnRyb2xsZXIiLCJtZXJnZSIsIkNvbG9yIiwiQW5pbWF0aW9uIiwiRWFzaW5nIiwiT3BlcmF0aW9uVHJhY2tpbmdOdW1iZXJMaW5lIiwiTkxPQ29uc3RhbnRzIiwibnVtYmVyTGluZU9wZXJhdGlvbnMiLCJOVU1CRVJfTElORV9SQU5HRVMiLCJNT0RFTF9CT1VORFMiLCJMQVlPVVRfQk9VTkRTIiwiTlVNQkVSX0xJTkVfQ0VOVEVSX1giLCJjZW50ZXJYIiwiUFJJTUFSWV9OVU1CRVJfTElORV9MT1dFUl9QT1NJVElPTiIsImNlbnRlclkiLCJQUklNQVJZX05VTUJFUl9MSU5FX1VQUEVSX1BPU0lUSU9OIiwibWludXNYWSIsImhlaWdodCIsIkNPTU1PTl9OVU1CRVJfTElORV9PUFRJT05TIiwibnVtYmVyT2ZPcGVyYXRpb25zVHJhY2tlZCIsImluaXRpYWxEaXNwbGF5ZWRSYW5nZSIsInRpY2tNYXJrc0luaXRpYWxseVZpc2libGUiLCJwcmV2ZW50T3ZlcmxhcCIsImxhYmVsc0luaXRpYWxseVZpc2libGUiLCJvcGVyYXRpb25EZXNjcmlwdGlvbnNJbml0aWFsbHlWaXNpYmxlIiwid2lkdGhJbk1vZGVsU3BhY2UiLCJOVU1CRVJfTElORV9XSURUSCIsIm9wZXJhdGlvbk9wdGlvbnNBcnJheSIsImluaXRpYWxBbW91bnQiLCJOTE9HZW5lcmljTW9kZWwiLCJjb25zdHJ1Y3RvciIsInRhbmRlbSIsInNlY29uZE51bWJlckxpbmVWaXNpYmxlUHJvcGVydHkiLCJwcmltYXJ5TnVtYmVyTGluZSIsInN0YXJ0aW5nVmFsdWVQcm9wZXJ0eSIsInBvaW50Q29sb3JMaXN0IiwiREFSS19CTFVFX1BPSU5UX0NPTE9SIiwiTUVESVVNX0JMVUVfUE9JTlRfQ09MT1IiLCJMSUdIVF9CTFVFX1BPSU5UX0NPTE9SIiwiYXNzZXJ0IiwicmVzaWRlbnRQb2ludHMiLCJsZW5ndGgiLCJwcmltYXJ5TGluZUluaXRpYWxWYWx1ZVBvaW50Q29udHJvbGxlciIsImNvbG9yIiwic3RhcnRpbmdQb2ludCIsImNvbG9yUHJvcGVydHkiLCJ2YWx1ZSIsIm51bWJlckxpbmVzIiwibnVtYmVyTGluZVBvaW50cyIsImxvY2tUb051bWJlckxpbmUiLCJBTFdBWVMiLCJwcmltYXJ5TnVtYmVyTGluZVBvaW50Q29udHJvbGxlcnMiLCJhZGRJdGVtQWRkZWRMaXN0ZW5lciIsImFkZGVkUG9pbnQiLCJwb2ludENvbnRyb2xsZXIiLCJwdXNoIiwicmVtb3ZhbExpc3RlbmVyIiwicmVtb3ZlZFBvaW50IiwicmVtb3ZlIiwiZGlzcG9zZSIsInJlbW92ZUl0ZW1SZW1vdmVkTGlzdGVuZXIiLCJhZGRJdGVtUmVtb3ZlZExpc3RlbmVyIiwic2Vjb25kYXJ5TnVtYmVyTGluZSIsImNlbnRlclBvc2l0aW9uUHJvcGVydHkiLCJwbHVzWFkiLCJzaG93UG9pbnRMYWJlbHNQcm9wZXJ0eSIsImxpbmsiLCJzaG93UG9pbnRMYWJlbHMiLCJzZXQiLCJzaG93T3BlcmF0aW9uTGFiZWxzUHJvcGVydHkiLCJzaG93VGlja01hcmtzUHJvcGVydHkiLCJzZWNvbmRhcnlMaW5lSW5pdGlhbFZhbHVlUG9pbnRDb250cm9sbGVyIiwic2Vjb25kYXJ5TnVtYmVyTGluZVBvaW50Q29udHJvbGxlcnMiLCJwcmltYXJ5TnVtYmVyTGluZUFuaW1hdGlvbiIsInNlY29uZE51bWJlckxpbmVWaXNpYmxlIiwiZGVzdGluYXRpb24iLCJlcXVhbHMiLCJzdG9wIiwiZHVyYXRpb24iLCJ0YXJnZXRzIiwicHJvcGVydHkiLCJlYXNpbmciLCJDVUJJQ19JTl9PVVQiLCJ0byIsInN0YXJ0IiwiZW5kZWRFbWl0dGVyIiwiYWRkTGlzdGVuZXIiLCJyZXNldCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiTkxPR2VuZXJpY01vZGVsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIwLTIwMjEsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIE5MT0dlbmVyaWNNb2RlbCBpcyB0aGUgcHJpbWFyeSBtb2RlbCBmb3IgdGhlIFwiR2VuZXJpY1wiIHNjcmVlbi5cclxuICpcclxuICogQGF1dGhvciBKb2huIEJsYW5jbyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IGNyZWF0ZU9ic2VydmFibGVBcnJheSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL2NyZWF0ZU9ic2VydmFibGVBcnJheS5qcyc7XHJcbmltcG9ydCBOdW1iZXJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL051bWJlclByb3BlcnR5LmpzJztcclxuaW1wb3J0IFJhbmdlIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9SYW5nZS5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IExvY2tUb051bWJlckxpbmUgZnJvbSAnLi4vLi4vLi4vLi4vbnVtYmVyLWxpbmUtY29tbW9uL2pzL2NvbW1vbi9tb2RlbC9Mb2NrVG9OdW1iZXJMaW5lLmpzJztcclxuaW1wb3J0IFBvaW50Q29udHJvbGxlciBmcm9tICcuLi8uLi8uLi8uLi9udW1iZXItbGluZS1jb21tb24vanMvY29tbW9uL21vZGVsL1BvaW50Q29udHJvbGxlci5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgeyBDb2xvciB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBBbmltYXRpb24gZnJvbSAnLi4vLi4vLi4vLi4vdHdpeHQvanMvQW5pbWF0aW9uLmpzJztcclxuaW1wb3J0IEVhc2luZyBmcm9tICcuLi8uLi8uLi8uLi90d2l4dC9qcy9FYXNpbmcuanMnO1xyXG5pbXBvcnQgT3BlcmF0aW9uVHJhY2tpbmdOdW1iZXJMaW5lIGZyb20gJy4uLy4uL2NvbW1vbi9tb2RlbC9PcGVyYXRpb25UcmFja2luZ051bWJlckxpbmUuanMnO1xyXG5pbXBvcnQgTkxPQ29uc3RhbnRzIGZyb20gJy4uLy4uL2NvbW1vbi9OTE9Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgbnVtYmVyTGluZU9wZXJhdGlvbnMgZnJvbSAnLi4vLi4vbnVtYmVyTGluZU9wZXJhdGlvbnMuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IE5VTUJFUl9MSU5FX1JBTkdFUyA9IFtcclxuICBuZXcgUmFuZ2UoIC0xMCwgMTAgKSxcclxuICBuZXcgUmFuZ2UoIC0zMCwgMzAgKSxcclxuICBuZXcgUmFuZ2UoIC0xMDAsIDEwMCApXHJcbl07XHJcbmNvbnN0IE1PREVMX0JPVU5EUyA9IE5MT0NvbnN0YW50cy5MQVlPVVRfQk9VTkRTO1xyXG5jb25zdCBOVU1CRVJfTElORV9DRU5URVJfWCA9IE1PREVMX0JPVU5EUy5jZW50ZXJYOyAvLyBtYXRjaGVzIGRlc2lnbiBkb2MgbGF5b3V0XHJcbmNvbnN0IFBSSU1BUllfTlVNQkVSX0xJTkVfTE9XRVJfUE9TSVRJT04gPSBuZXcgVmVjdG9yMiggTlVNQkVSX0xJTkVfQ0VOVEVSX1gsIE1PREVMX0JPVU5EUy5jZW50ZXJZICk7XHJcbmNvbnN0IFBSSU1BUllfTlVNQkVSX0xJTkVfVVBQRVJfUE9TSVRJT04gPSBQUklNQVJZX05VTUJFUl9MSU5FX0xPV0VSX1BPU0lUSU9OLm1pbnVzWFkoIDAsIE1PREVMX0JPVU5EUy5oZWlnaHQgKiAwLjE1ICk7XHJcblxyXG5jb25zdCBDT01NT05fTlVNQkVSX0xJTkVfT1BUSU9OUyA9IHtcclxuICBudW1iZXJPZk9wZXJhdGlvbnNUcmFja2VkOiAyLFxyXG4gIGluaXRpYWxEaXNwbGF5ZWRSYW5nZTogTlVNQkVSX0xJTkVfUkFOR0VTWyAwIF0sXHJcbiAgdGlja01hcmtzSW5pdGlhbGx5VmlzaWJsZTogdHJ1ZSxcclxuICBwcmV2ZW50T3ZlcmxhcDogZmFsc2UsXHJcbiAgbGFiZWxzSW5pdGlhbGx5VmlzaWJsZTogdHJ1ZSxcclxuICBvcGVyYXRpb25EZXNjcmlwdGlvbnNJbml0aWFsbHlWaXNpYmxlOiBmYWxzZSxcclxuICB3aWR0aEluTW9kZWxTcGFjZTogTkxPQ29uc3RhbnRzLk5VTUJFUl9MSU5FX1dJRFRILFxyXG4gIG9wZXJhdGlvbk9wdGlvbnNBcnJheTogWyB7IGluaXRpYWxBbW91bnQ6IDEgfSwgeyBpbml0aWFsQW1vdW50OiAxIH0gXVxyXG59O1xyXG5cclxuY2xhc3MgTkxPR2VuZXJpY01vZGVsIHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtUYW5kZW19IHRhbmRlbVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCB0YW5kZW0gKSB7XHJcblxyXG4gICAgLy8gQHB1YmxpYyAocmVhZC13cml0ZSkgLSB3aGV0aGVyIG9yIG5vdCB0aGUgMm5kIG51bWJlciBsaW5lIGlzIHZpc2libGUgdG8gdGhlIHVzZXJcclxuICAgIHRoaXMuc2Vjb25kTnVtYmVyTGluZVZpc2libGVQcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIGZhbHNlICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyAtIHRoZSBwcmltYXJ5IG9wZXJhdGlvbi10cmFja2luZyBudW1iZXIgbGluZSwgd2hpY2ggaXMgYWx3YXlzIHZpc2libGVcclxuICAgIHRoaXMucHJpbWFyeU51bWJlckxpbmUgPSBuZXcgT3BlcmF0aW9uVHJhY2tpbmdOdW1iZXJMaW5lKFxyXG4gICAgICBQUklNQVJZX05VTUJFUl9MSU5FX0xPV0VSX1BPU0lUSU9OLFxyXG4gICAgICBtZXJnZSgge1xyXG4gICAgICAgIHN0YXJ0aW5nVmFsdWVQcm9wZXJ0eTogbmV3IE51bWJlclByb3BlcnR5KCAxICksXHJcbiAgICAgICAgcG9pbnRDb2xvckxpc3Q6IFtcclxuICAgICAgICAgIE5MT0NvbnN0YW50cy5EQVJLX0JMVUVfUE9JTlRfQ09MT1IsXHJcbiAgICAgICAgICBOTE9Db25zdGFudHMuTUVESVVNX0JMVUVfUE9JTlRfQ09MT1IsXHJcbiAgICAgICAgICBOTE9Db25zdGFudHMuTElHSFRfQkxVRV9QT0lOVF9DT0xPUlxyXG4gICAgICAgIF1cclxuICAgICAgfSwgQ09NTU9OX05VTUJFUl9MSU5FX09QVElPTlMgKVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIChyZWFkLW9ubHkpIC0gQXNzb2NpYXRlIGEgcG9pbnQgY29udHJvbGxlciB3aXRoIHRoZSBwb2ludCB0aGF0IHJlcHJlc2VudHMgdGhlIGluaXRpYWwgdmFsdWUgb24gdGhlXHJcbiAgICAvLyBvcGVyYXRpb24gdHJhY2tpbmcgbnVtYmVyIGxpbmUuICBUaGlzIHBvaW50IGNvbnRyb2xsZXIgd2lsbCBhbHdheXMgYmUgcHJlc2VudCBvbiB0aGUgbnVtYmVyIGxpbmUsIHdoZXJlYXMgdGhlcmVcclxuICAgIC8vIGFyZSBvdGhlcnMgdGhhdCBjYW4gY29tZSBhbmQgZ28uXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLnByaW1hcnlOdW1iZXJMaW5lLnJlc2lkZW50UG9pbnRzLmxlbmd0aCA9PT0gMSwgJ2V4cGVjdGVkIG9ubHkgb25lIHBvaW50IG9uIHRoZSBudW1iZXIgbGluZScgKTtcclxuICAgIHRoaXMucHJpbWFyeUxpbmVJbml0aWFsVmFsdWVQb2ludENvbnRyb2xsZXIgPSBuZXcgUG9pbnRDb250cm9sbGVyKCB7XHJcbiAgICAgIGNvbG9yOiB0aGlzLnByaW1hcnlOdW1iZXJMaW5lLnN0YXJ0aW5nUG9pbnQuY29sb3JQcm9wZXJ0eS52YWx1ZSxcclxuICAgICAgbnVtYmVyTGluZXM6IFsgdGhpcy5wcmltYXJ5TnVtYmVyTGluZSBdLFxyXG4gICAgICBudW1iZXJMaW5lUG9pbnRzOiBbIHRoaXMucHJpbWFyeU51bWJlckxpbmUuc3RhcnRpbmdQb2ludCBdLFxyXG4gICAgICBsb2NrVG9OdW1iZXJMaW5lOiBMb2NrVG9OdW1iZXJMaW5lLkFMV0FZU1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMgKHJlYWQtb25seSkge09ic2VydmFibGVBcnJheURlZi48UG9pbnRDb250cm9sbGVyPn0gLSBBIGxpc3Qgb2YgdGhlIHBvaW50IGNvbnRyb2xsZXJzIGZvciB0aGUgcHJpbWFyeVxyXG4gICAgLy8gbnVtYmVyIGxpbmUuIFRoZXNlIGNvbWUgYW5kIGdvIGFzIHBvaW50cyBjb21lIGFuZCBnby5cclxuICAgIHRoaXMucHJpbWFyeU51bWJlckxpbmVQb2ludENvbnRyb2xsZXJzID0gY3JlYXRlT2JzZXJ2YWJsZUFycmF5KCk7XHJcbiAgICB0aGlzLnByaW1hcnlOdW1iZXJMaW5lLnJlc2lkZW50UG9pbnRzLmFkZEl0ZW1BZGRlZExpc3RlbmVyKCBhZGRlZFBvaW50ID0+IHtcclxuXHJcbiAgICAgIC8vIEFkZCBhIHBvaW50IGNvbnRyb2xsZXIgZm9yIHRoZSBuZXdseSBhZGRlZCBwb2ludC5cclxuICAgICAgY29uc3QgcG9pbnRDb250cm9sbGVyID0gbmV3IFBvaW50Q29udHJvbGxlcigge1xyXG4gICAgICAgIGNvbG9yOiBhZGRlZFBvaW50LmNvbG9yUHJvcGVydHkudmFsdWUsXHJcbiAgICAgICAgbnVtYmVyTGluZXM6IFsgdGhpcy5wcmltYXJ5TnVtYmVyTGluZSBdLFxyXG4gICAgICAgIG51bWJlckxpbmVQb2ludHM6IFsgYWRkZWRQb2ludCBdLFxyXG4gICAgICAgIGxvY2tUb051bWJlckxpbmU6IExvY2tUb051bWJlckxpbmUuQUxXQVlTXHJcbiAgICAgIH0gKTtcclxuICAgICAgdGhpcy5wcmltYXJ5TnVtYmVyTGluZVBvaW50Q29udHJvbGxlcnMucHVzaCggcG9pbnRDb250cm9sbGVyICk7XHJcblxyXG4gICAgICAvLyBSZW1vdmUgdGhlIHBvaW50IGNvbnRyb2xsZXIgd2hlbiB0aGUgYXNzb2NpYXRlZCBwb2ludCBnb2VzIGF3YXkuXHJcbiAgICAgIGNvbnN0IHJlbW92YWxMaXN0ZW5lciA9IHJlbW92ZWRQb2ludCA9PiB7XHJcbiAgICAgICAgaWYgKCByZW1vdmVkUG9pbnQgPT09IGFkZGVkUG9pbnQgKSB7XHJcbiAgICAgICAgICB0aGlzLnByaW1hcnlOdW1iZXJMaW5lUG9pbnRDb250cm9sbGVycy5yZW1vdmUoIHBvaW50Q29udHJvbGxlciApO1xyXG4gICAgICAgICAgcG9pbnRDb250cm9sbGVyLmRpc3Bvc2UoKTtcclxuICAgICAgICAgIHRoaXMucHJpbWFyeU51bWJlckxpbmUucmVzaWRlbnRQb2ludHMucmVtb3ZlSXRlbVJlbW92ZWRMaXN0ZW5lciggcmVtb3ZhbExpc3RlbmVyICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICB0aGlzLnByaW1hcnlOdW1iZXJMaW5lLnJlc2lkZW50UG9pbnRzLmFkZEl0ZW1SZW1vdmVkTGlzdGVuZXIoIHJlbW92YWxMaXN0ZW5lciApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMgLSB0aGUgc2Vjb25kYXJ5IG9wZXJhdGlvbi10cmFja2luZyBudW1iZXIgbGluZSwgd2hpY2ggaXMgb25seSB2aXNpYmxlIHdoZW4gZW5hYmxlZCBieSB0aGUgdXNlclxyXG4gICAgdGhpcy5zZWNvbmRhcnlOdW1iZXJMaW5lID0gbmV3IE9wZXJhdGlvblRyYWNraW5nTnVtYmVyTGluZShcclxuICAgICAgdGhpcy5wcmltYXJ5TnVtYmVyTGluZS5jZW50ZXJQb3NpdGlvblByb3BlcnR5LnZhbHVlLnBsdXNYWSggMCwgNjIgKSxcclxuICAgICAgbWVyZ2UoIHtcclxuICAgICAgICBzdGFydGluZ1ZhbHVlUHJvcGVydHk6IG5ldyBOdW1iZXJQcm9wZXJ0eSggMSApLFxyXG4gICAgICAgIHBvaW50Q29sb3JMaXN0OiBbIG5ldyBDb2xvciggJyNhNDAwY2MnICksIG5ldyBDb2xvciggJyNlZjI5ZmYnICksIG5ldyBDb2xvciggJyNmYjcxZmYnICkgXVxyXG4gICAgICB9LCBDT01NT05fTlVNQkVSX0xJTkVfT1BUSU9OUyApXHJcbiAgICApO1xyXG5cclxuICAgIC8vIExpbmsgdGhlIHZpZXcgY29udHJvbCBwcm9wZXJ0aWVzIGZyb20gdGhlIHByaW1hcnkgbnVtYmVyIGxpbmUgdG8gdGhvc2UgaW4gdGhlIHNlY29uZGFyeSBudW1iZXIgbGluZS4gIENhbGxzIHRvXHJcbiAgICAvLyB1bmxpbmsgYXJlIG5vdCBuZWVkZWQuXHJcbiAgICB0aGlzLnByaW1hcnlOdW1iZXJMaW5lLnNob3dQb2ludExhYmVsc1Byb3BlcnR5LmxpbmsoXHJcbiAgICAgIHNob3dQb2ludExhYmVscyA9PiB0aGlzLnNlY29uZGFyeU51bWJlckxpbmUuc2hvd1BvaW50TGFiZWxzUHJvcGVydHkuc2V0KCBzaG93UG9pbnRMYWJlbHMgKVxyXG4gICAgKTtcclxuICAgIHRoaXMucHJpbWFyeU51bWJlckxpbmUuc2hvd09wZXJhdGlvbkxhYmVsc1Byb3BlcnR5LmxpbmsoXHJcbiAgICAgIHNob3dQb2ludExhYmVscyA9PiB0aGlzLnNlY29uZGFyeU51bWJlckxpbmUuc2hvd09wZXJhdGlvbkxhYmVsc1Byb3BlcnR5LnNldCggc2hvd1BvaW50TGFiZWxzIClcclxuICAgICk7XHJcbiAgICB0aGlzLnByaW1hcnlOdW1iZXJMaW5lLnNob3dUaWNrTWFya3NQcm9wZXJ0eS5saW5rKFxyXG4gICAgICBzaG93UG9pbnRMYWJlbHMgPT4gdGhpcy5zZWNvbmRhcnlOdW1iZXJMaW5lLnNob3dUaWNrTWFya3NQcm9wZXJ0eS5zZXQoIHNob3dQb2ludExhYmVscyApXHJcbiAgICApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMgKHJlYWQtb25seSkgLSBBc3NvY2lhdGUgYSBwb2ludCBjb250cm9sbGVyIHdpdGggdGhlIHBvaW50IHRoYXQgcmVwcmVzZW50cyB0aGUgaW5pdGlhbCB2YWx1ZSBvbiB0aGVcclxuICAgIC8vIG9wZXJhdGlvbiB0cmFja2luZyBudW1iZXIgbGluZS4gIFRoaXMgcG9pbnQgY29udHJvbGxlciB3aWxsIGFsd2F5cyBiZSBwcmVzZW50IG9uIHRoZSBudW1iZXIgbGluZSwgd2hlcmVhcyB0aGVyZVxyXG4gICAgLy8gYXJlIG90aGVycyB0aGF0IGNhbiBjb21lIGFuZCBnby5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMuc2Vjb25kYXJ5TnVtYmVyTGluZS5yZXNpZGVudFBvaW50cy5sZW5ndGggPT09IDEsICdleHBlY3RlZCBvbmx5IG9uZSBwb2ludCBvbiB0aGUgbnVtYmVyIGxpbmUnICk7XHJcbiAgICB0aGlzLnNlY29uZGFyeUxpbmVJbml0aWFsVmFsdWVQb2ludENvbnRyb2xsZXIgPSBuZXcgUG9pbnRDb250cm9sbGVyKCB7XHJcbiAgICAgIGNvbG9yOiB0aGlzLnNlY29uZGFyeU51bWJlckxpbmUuc3RhcnRpbmdQb2ludC5jb2xvclByb3BlcnR5LnZhbHVlLFxyXG4gICAgICBudW1iZXJMaW5lczogWyB0aGlzLnNlY29uZGFyeU51bWJlckxpbmUgXSxcclxuICAgICAgbnVtYmVyTGluZVBvaW50czogWyB0aGlzLnNlY29uZGFyeU51bWJlckxpbmUuc3RhcnRpbmdQb2ludCBdLFxyXG4gICAgICBsb2NrVG9OdW1iZXJMaW5lOiBMb2NrVG9OdW1iZXJMaW5lLkFMV0FZU1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEBwdWJsaWMgKHJlYWQtb25seSkge09ic2VydmFibGVBcnJheURlZi48UG9pbnRDb250cm9sbGVyPn0gLSBBIGxpc3Qgb2YgdGhlIHBvaW50IGNvbnRyb2xsZXJzIGZvciB0aGUgc2Vjb25kYXJ5IG51bWJlclxyXG4gICAgLy8gbGluZS4gVGhlc2UgY29tZSBhbmQgZ28gYXMgcG9pbnRzIGNvbWUgYW5kIGdvLlxyXG4gICAgdGhpcy5zZWNvbmRhcnlOdW1iZXJMaW5lUG9pbnRDb250cm9sbGVycyA9IGNyZWF0ZU9ic2VydmFibGVBcnJheSgpO1xyXG4gICAgdGhpcy5zZWNvbmRhcnlOdW1iZXJMaW5lLnJlc2lkZW50UG9pbnRzLmFkZEl0ZW1BZGRlZExpc3RlbmVyKCBhZGRlZFBvaW50ID0+IHtcclxuXHJcbiAgICAgIC8vIEFkZCBhIHBvaW50IGNvbnRyb2xsZXIgZm9yIHRoZSBuZXdseSBhZGRlZCBwb2ludC5cclxuICAgICAgY29uc3QgcG9pbnRDb250cm9sbGVyID0gbmV3IFBvaW50Q29udHJvbGxlcigge1xyXG4gICAgICAgIGNvbG9yOiBhZGRlZFBvaW50LmNvbG9yUHJvcGVydHkudmFsdWUsXHJcbiAgICAgICAgbnVtYmVyTGluZXM6IFsgdGhpcy5zZWNvbmRhcnlOdW1iZXJMaW5lIF0sXHJcbiAgICAgICAgbnVtYmVyTGluZVBvaW50czogWyBhZGRlZFBvaW50IF0sXHJcbiAgICAgICAgbG9ja1RvTnVtYmVyTGluZTogTG9ja1RvTnVtYmVyTGluZS5BTFdBWVNcclxuICAgICAgfSApO1xyXG4gICAgICB0aGlzLnNlY29uZGFyeU51bWJlckxpbmVQb2ludENvbnRyb2xsZXJzLnB1c2goIHBvaW50Q29udHJvbGxlciApO1xyXG5cclxuICAgICAgLy8gUmVtb3ZlIHRoZSBwb2ludCBjb250cm9sbGVyIHdoZW4gdGhlIGFzc29jaWF0ZWQgcG9pbnQgZ29lcyBhd2F5LlxyXG4gICAgICBjb25zdCByZW1vdmFsTGlzdGVuZXIgPSByZW1vdmVkUG9pbnQgPT4ge1xyXG4gICAgICAgIGlmICggcmVtb3ZlZFBvaW50ID09PSBhZGRlZFBvaW50ICkge1xyXG4gICAgICAgICAgdGhpcy5zZWNvbmRhcnlOdW1iZXJMaW5lUG9pbnRDb250cm9sbGVycy5yZW1vdmUoIHBvaW50Q29udHJvbGxlciApO1xyXG4gICAgICAgICAgcG9pbnRDb250cm9sbGVyLmRpc3Bvc2UoKTtcclxuICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5TnVtYmVyTGluZS5yZXNpZGVudFBvaW50cy5yZW1vdmVJdGVtUmVtb3ZlZExpc3RlbmVyKCByZW1vdmFsTGlzdGVuZXIgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIHRoaXMuc2Vjb25kYXJ5TnVtYmVyTGluZS5yZXNpZGVudFBvaW50cy5hZGRJdGVtUmVtb3ZlZExpc3RlbmVyKCByZW1vdmFsTGlzdGVuZXIgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBhbmltYXRpb24gdG8gbW92ZSB0aGUgcHJpbWFyeSBudW1iZXIgbGluZSBhcm91bmQgYmFzZWQgb24gd2l0aCB0aGUgc2Vjb25kYXJ5IGlzIGJlaW5nIHNob3duXHJcbiAgICB0aGlzLnByaW1hcnlOdW1iZXJMaW5lQW5pbWF0aW9uID0gbnVsbDtcclxuXHJcbiAgICAvLyBQb3NpdGlvbiB0aGUgcHJpbWFyeSBudW1iZXIgbGluZSBiYXNlZCBvbiB3aGV0aGVyIHRoZSBzZWNvbmRhcnkgbnVtYmVyIGxpbmUgaXMgdmlzaWJsZS4gIE5vIHVubGluayBpcyBuZWVkZWQuXHJcbiAgICB0aGlzLnNlY29uZE51bWJlckxpbmVWaXNpYmxlUHJvcGVydHkubGluayggc2Vjb25kTnVtYmVyTGluZVZpc2libGUgPT4ge1xyXG4gICAgICBjb25zdCBkZXN0aW5hdGlvbiA9IHNlY29uZE51bWJlckxpbmVWaXNpYmxlID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZX05VTUJFUl9MSU5FX1VQUEVSX1BPU0lUSU9OIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZX05VTUJFUl9MSU5FX0xPV0VSX1BPU0lUSU9OO1xyXG4gICAgICBpZiAoICF0aGlzLnByaW1hcnlOdW1iZXJMaW5lLmNlbnRlclBvc2l0aW9uUHJvcGVydHkudmFsdWUuZXF1YWxzKCBkZXN0aW5hdGlvbiApICkge1xyXG5cclxuICAgICAgICAvLyBTdG9wIGFueSBwcmV2aW91cyBhbmltYXRpb24uXHJcbiAgICAgICAgaWYgKCB0aGlzLnByaW1hcnlOdW1iZXJMaW5lQW5pbWF0aW9uICkge1xyXG4gICAgICAgICAgdGhpcy5wcmltYXJ5TnVtYmVyTGluZUFuaW1hdGlvbi5zdG9wKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTdGFydCBhbiBhbmltYXRpb24gdG8gbW92ZSB0aGUgbnVtYmVyIGxpbmUgdG8gdGhlIGRlc2lyZWQgcG9zaXRpb24uXHJcbiAgICAgICAgdGhpcy5wcmltYXJ5TnVtYmVyTGluZUFuaW1hdGlvbiA9IG5ldyBBbmltYXRpb24oIHtcclxuICAgICAgICAgIGR1cmF0aW9uOiAwLjUsXHJcbiAgICAgICAgICB0YXJnZXRzOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBwcm9wZXJ0eTogdGhpcy5wcmltYXJ5TnVtYmVyTGluZS5jZW50ZXJQb3NpdGlvblByb3BlcnR5LFxyXG4gICAgICAgICAgICAgIGVhc2luZzogRWFzaW5nLkNVQklDX0lOX09VVCxcclxuICAgICAgICAgICAgICB0bzogZGVzdGluYXRpb25cclxuICAgICAgICAgICAgfSBdXHJcbiAgICAgICAgfSApO1xyXG4gICAgICAgIHRoaXMucHJpbWFyeU51bWJlckxpbmVBbmltYXRpb24uc3RhcnQoKTtcclxuICAgICAgICB0aGlzLnByaW1hcnlOdW1iZXJMaW5lQW5pbWF0aW9uLmVuZGVkRW1pdHRlci5hZGRMaXN0ZW5lciggKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wcmltYXJ5TnVtYmVyTGluZUFuaW1hdGlvbiA9IG51bGw7XHJcbiAgICAgICAgfSApO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNldHMgdGhlIG1vZGVsLlxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICByZXNldCgpIHtcclxuICAgIHRoaXMucHJpbWFyeU51bWJlckxpbmUucmVzZXQoKTtcclxuICAgIHRoaXMuc2Vjb25kYXJ5TnVtYmVyTGluZS5yZXNldCgpO1xyXG4gICAgdGhpcy5zZWNvbmROdW1iZXJMaW5lVmlzaWJsZVByb3BlcnR5LnJlc2V0KCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBzdGF0aWNzXHJcbk5MT0dlbmVyaWNNb2RlbC5OVU1CRVJfTElORV9SQU5HRVMgPSBOVU1CRVJfTElORV9SQU5HRVM7XHJcblxyXG5udW1iZXJMaW5lT3BlcmF0aW9ucy5yZWdpc3RlciggJ05MT0dlbmVyaWNNb2RlbCcsIE5MT0dlbmVyaWNNb2RlbCApO1xyXG5leHBvcnQgZGVmYXVsdCBOTE9HZW5lcmljTW9kZWw7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MscUJBQXFCLE1BQU0sOENBQThDO0FBQ2hGLE9BQU9DLGNBQWMsTUFBTSx1Q0FBdUM7QUFDbEUsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxPQUFPLE1BQU0sK0JBQStCO0FBQ25ELE9BQU9DLGdCQUFnQixNQUFNLG9FQUFvRTtBQUNqRyxPQUFPQyxlQUFlLE1BQU0sbUVBQW1FO0FBQy9GLE9BQU9DLEtBQUssTUFBTSxtQ0FBbUM7QUFDckQsU0FBU0MsS0FBSyxRQUFRLG1DQUFtQztBQUN6RCxPQUFPQyxTQUFTLE1BQU0sbUNBQW1DO0FBQ3pELE9BQU9DLE1BQU0sTUFBTSxnQ0FBZ0M7QUFDbkQsT0FBT0MsMkJBQTJCLE1BQU0sbURBQW1EO0FBQzNGLE9BQU9DLFlBQVksTUFBTSw4QkFBOEI7QUFDdkQsT0FBT0Msb0JBQW9CLE1BQU0sK0JBQStCOztBQUVoRTtBQUNBLE1BQU1DLGtCQUFrQixHQUFHLENBQ3pCLElBQUlYLEtBQUssQ0FBRSxDQUFDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFDcEIsSUFBSUEsS0FBSyxDQUFFLENBQUMsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUNwQixJQUFJQSxLQUFLLENBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBSSxDQUFDLENBQ3ZCO0FBQ0QsTUFBTVksWUFBWSxHQUFHSCxZQUFZLENBQUNJLGFBQWE7QUFDL0MsTUFBTUMsb0JBQW9CLEdBQUdGLFlBQVksQ0FBQ0csT0FBTyxDQUFDLENBQUM7QUFDbkQsTUFBTUMsa0NBQWtDLEdBQUcsSUFBSWYsT0FBTyxDQUFFYSxvQkFBb0IsRUFBRUYsWUFBWSxDQUFDSyxPQUFRLENBQUM7QUFDcEcsTUFBTUMsa0NBQWtDLEdBQUdGLGtDQUFrQyxDQUFDRyxPQUFPLENBQUUsQ0FBQyxFQUFFUCxZQUFZLENBQUNRLE1BQU0sR0FBRyxJQUFLLENBQUM7QUFFdEgsTUFBTUMsMEJBQTBCLEdBQUc7RUFDakNDLHlCQUF5QixFQUFFLENBQUM7RUFDNUJDLHFCQUFxQixFQUFFWixrQkFBa0IsQ0FBRSxDQUFDLENBQUU7RUFDOUNhLHlCQUF5QixFQUFFLElBQUk7RUFDL0JDLGNBQWMsRUFBRSxLQUFLO0VBQ3JCQyxzQkFBc0IsRUFBRSxJQUFJO0VBQzVCQyxxQ0FBcUMsRUFBRSxLQUFLO0VBQzVDQyxpQkFBaUIsRUFBRW5CLFlBQVksQ0FBQ29CLGlCQUFpQjtFQUNqREMscUJBQXFCLEVBQUUsQ0FBRTtJQUFFQyxhQUFhLEVBQUU7RUFBRSxDQUFDLEVBQUU7SUFBRUEsYUFBYSxFQUFFO0VBQUUsQ0FBQztBQUNyRSxDQUFDO0FBRUQsTUFBTUMsZUFBZSxDQUFDO0VBRXBCO0FBQ0Y7QUFDQTtFQUNFQyxXQUFXQSxDQUFFQyxNQUFNLEVBQUc7SUFFcEI7SUFDQSxJQUFJLENBQUNDLCtCQUErQixHQUFHLElBQUl0QyxlQUFlLENBQUUsS0FBTSxDQUFDOztJQUVuRTtJQUNBLElBQUksQ0FBQ3VDLGlCQUFpQixHQUFHLElBQUk1QiwyQkFBMkIsQ0FDdERRLGtDQUFrQyxFQUNsQ1osS0FBSyxDQUFFO01BQ0xpQyxxQkFBcUIsRUFBRSxJQUFJdEMsY0FBYyxDQUFFLENBQUUsQ0FBQztNQUM5Q3VDLGNBQWMsRUFBRSxDQUNkN0IsWUFBWSxDQUFDOEIscUJBQXFCLEVBQ2xDOUIsWUFBWSxDQUFDK0IsdUJBQXVCLEVBQ3BDL0IsWUFBWSxDQUFDZ0Msc0JBQXNCO0lBRXZDLENBQUMsRUFBRXBCLDBCQUEyQixDQUNoQyxDQUFDOztJQUVEO0lBQ0E7SUFDQTtJQUNBcUIsTUFBTSxJQUFJQSxNQUFNLENBQUUsSUFBSSxDQUFDTixpQkFBaUIsQ0FBQ08sY0FBYyxDQUFDQyxNQUFNLEtBQUssQ0FBQyxFQUFFLDRDQUE2QyxDQUFDO0lBQ3BILElBQUksQ0FBQ0Msc0NBQXNDLEdBQUcsSUFBSTFDLGVBQWUsQ0FBRTtNQUNqRTJDLEtBQUssRUFBRSxJQUFJLENBQUNWLGlCQUFpQixDQUFDVyxhQUFhLENBQUNDLGFBQWEsQ0FBQ0MsS0FBSztNQUMvREMsV0FBVyxFQUFFLENBQUUsSUFBSSxDQUFDZCxpQkFBaUIsQ0FBRTtNQUN2Q2UsZ0JBQWdCLEVBQUUsQ0FBRSxJQUFJLENBQUNmLGlCQUFpQixDQUFDVyxhQUFhLENBQUU7TUFDMURLLGdCQUFnQixFQUFFbEQsZ0JBQWdCLENBQUNtRDtJQUNyQyxDQUFFLENBQUM7O0lBRUg7SUFDQTtJQUNBLElBQUksQ0FBQ0MsaUNBQWlDLEdBQUd4RCxxQkFBcUIsQ0FBQyxDQUFDO0lBQ2hFLElBQUksQ0FBQ3NDLGlCQUFpQixDQUFDTyxjQUFjLENBQUNZLG9CQUFvQixDQUFFQyxVQUFVLElBQUk7TUFFeEU7TUFDQSxNQUFNQyxlQUFlLEdBQUcsSUFBSXRELGVBQWUsQ0FBRTtRQUMzQzJDLEtBQUssRUFBRVUsVUFBVSxDQUFDUixhQUFhLENBQUNDLEtBQUs7UUFDckNDLFdBQVcsRUFBRSxDQUFFLElBQUksQ0FBQ2QsaUJBQWlCLENBQUU7UUFDdkNlLGdCQUFnQixFQUFFLENBQUVLLFVBQVUsQ0FBRTtRQUNoQ0osZ0JBQWdCLEVBQUVsRCxnQkFBZ0IsQ0FBQ21EO01BQ3JDLENBQUUsQ0FBQztNQUNILElBQUksQ0FBQ0MsaUNBQWlDLENBQUNJLElBQUksQ0FBRUQsZUFBZ0IsQ0FBQzs7TUFFOUQ7TUFDQSxNQUFNRSxlQUFlLEdBQUdDLFlBQVksSUFBSTtRQUN0QyxJQUFLQSxZQUFZLEtBQUtKLFVBQVUsRUFBRztVQUNqQyxJQUFJLENBQUNGLGlDQUFpQyxDQUFDTyxNQUFNLENBQUVKLGVBQWdCLENBQUM7VUFDaEVBLGVBQWUsQ0FBQ0ssT0FBTyxDQUFDLENBQUM7VUFDekIsSUFBSSxDQUFDMUIsaUJBQWlCLENBQUNPLGNBQWMsQ0FBQ29CLHlCQUF5QixDQUFFSixlQUFnQixDQUFDO1FBQ3BGO01BQ0YsQ0FBQztNQUNELElBQUksQ0FBQ3ZCLGlCQUFpQixDQUFDTyxjQUFjLENBQUNxQixzQkFBc0IsQ0FBRUwsZUFBZ0IsQ0FBQztJQUNqRixDQUFFLENBQUM7O0lBRUg7SUFDQSxJQUFJLENBQUNNLG1CQUFtQixHQUFHLElBQUl6RCwyQkFBMkIsQ0FDeEQsSUFBSSxDQUFDNEIsaUJBQWlCLENBQUM4QixzQkFBc0IsQ0FBQ2pCLEtBQUssQ0FBQ2tCLE1BQU0sQ0FBRSxDQUFDLEVBQUUsRUFBRyxDQUFDLEVBQ25FL0QsS0FBSyxDQUFFO01BQ0xpQyxxQkFBcUIsRUFBRSxJQUFJdEMsY0FBYyxDQUFFLENBQUUsQ0FBQztNQUM5Q3VDLGNBQWMsRUFBRSxDQUFFLElBQUlqQyxLQUFLLENBQUUsU0FBVSxDQUFDLEVBQUUsSUFBSUEsS0FBSyxDQUFFLFNBQVUsQ0FBQyxFQUFFLElBQUlBLEtBQUssQ0FBRSxTQUFVLENBQUM7SUFDMUYsQ0FBQyxFQUFFZ0IsMEJBQTJCLENBQ2hDLENBQUM7O0lBRUQ7SUFDQTtJQUNBLElBQUksQ0FBQ2UsaUJBQWlCLENBQUNnQyx1QkFBdUIsQ0FBQ0MsSUFBSSxDQUNqREMsZUFBZSxJQUFJLElBQUksQ0FBQ0wsbUJBQW1CLENBQUNHLHVCQUF1QixDQUFDRyxHQUFHLENBQUVELGVBQWdCLENBQzNGLENBQUM7SUFDRCxJQUFJLENBQUNsQyxpQkFBaUIsQ0FBQ29DLDJCQUEyQixDQUFDSCxJQUFJLENBQ3JEQyxlQUFlLElBQUksSUFBSSxDQUFDTCxtQkFBbUIsQ0FBQ08sMkJBQTJCLENBQUNELEdBQUcsQ0FBRUQsZUFBZ0IsQ0FDL0YsQ0FBQztJQUNELElBQUksQ0FBQ2xDLGlCQUFpQixDQUFDcUMscUJBQXFCLENBQUNKLElBQUksQ0FDL0NDLGVBQWUsSUFBSSxJQUFJLENBQUNMLG1CQUFtQixDQUFDUSxxQkFBcUIsQ0FBQ0YsR0FBRyxDQUFFRCxlQUFnQixDQUN6RixDQUFDOztJQUVEO0lBQ0E7SUFDQTtJQUNBNUIsTUFBTSxJQUFJQSxNQUFNLENBQUUsSUFBSSxDQUFDdUIsbUJBQW1CLENBQUN0QixjQUFjLENBQUNDLE1BQU0sS0FBSyxDQUFDLEVBQUUsNENBQTZDLENBQUM7SUFDdEgsSUFBSSxDQUFDOEIsd0NBQXdDLEdBQUcsSUFBSXZFLGVBQWUsQ0FBRTtNQUNuRTJDLEtBQUssRUFBRSxJQUFJLENBQUNtQixtQkFBbUIsQ0FBQ2xCLGFBQWEsQ0FBQ0MsYUFBYSxDQUFDQyxLQUFLO01BQ2pFQyxXQUFXLEVBQUUsQ0FBRSxJQUFJLENBQUNlLG1CQUFtQixDQUFFO01BQ3pDZCxnQkFBZ0IsRUFBRSxDQUFFLElBQUksQ0FBQ2MsbUJBQW1CLENBQUNsQixhQUFhLENBQUU7TUFDNURLLGdCQUFnQixFQUFFbEQsZ0JBQWdCLENBQUNtRDtJQUNyQyxDQUFFLENBQUM7O0lBRUg7SUFDQTtJQUNBLElBQUksQ0FBQ3NCLG1DQUFtQyxHQUFHN0UscUJBQXFCLENBQUMsQ0FBQztJQUNsRSxJQUFJLENBQUNtRSxtQkFBbUIsQ0FBQ3RCLGNBQWMsQ0FBQ1ksb0JBQW9CLENBQUVDLFVBQVUsSUFBSTtNQUUxRTtNQUNBLE1BQU1DLGVBQWUsR0FBRyxJQUFJdEQsZUFBZSxDQUFFO1FBQzNDMkMsS0FBSyxFQUFFVSxVQUFVLENBQUNSLGFBQWEsQ0FBQ0MsS0FBSztRQUNyQ0MsV0FBVyxFQUFFLENBQUUsSUFBSSxDQUFDZSxtQkFBbUIsQ0FBRTtRQUN6Q2QsZ0JBQWdCLEVBQUUsQ0FBRUssVUFBVSxDQUFFO1FBQ2hDSixnQkFBZ0IsRUFBRWxELGdCQUFnQixDQUFDbUQ7TUFDckMsQ0FBRSxDQUFDO01BQ0gsSUFBSSxDQUFDc0IsbUNBQW1DLENBQUNqQixJQUFJLENBQUVELGVBQWdCLENBQUM7O01BRWhFO01BQ0EsTUFBTUUsZUFBZSxHQUFHQyxZQUFZLElBQUk7UUFDdEMsSUFBS0EsWUFBWSxLQUFLSixVQUFVLEVBQUc7VUFDakMsSUFBSSxDQUFDbUIsbUNBQW1DLENBQUNkLE1BQU0sQ0FBRUosZUFBZ0IsQ0FBQztVQUNsRUEsZUFBZSxDQUFDSyxPQUFPLENBQUMsQ0FBQztVQUN6QixJQUFJLENBQUNHLG1CQUFtQixDQUFDdEIsY0FBYyxDQUFDb0IseUJBQXlCLENBQUVKLGVBQWdCLENBQUM7UUFDdEY7TUFDRixDQUFDO01BQ0QsSUFBSSxDQUFDTSxtQkFBbUIsQ0FBQ3RCLGNBQWMsQ0FBQ3FCLHNCQUFzQixDQUFFTCxlQUFnQixDQUFDO0lBQ25GLENBQUUsQ0FBQzs7SUFFSDtJQUNBLElBQUksQ0FBQ2lCLDBCQUEwQixHQUFHLElBQUk7O0lBRXRDO0lBQ0EsSUFBSSxDQUFDekMsK0JBQStCLENBQUNrQyxJQUFJLENBQUVRLHVCQUF1QixJQUFJO01BQ3BFLE1BQU1DLFdBQVcsR0FBR0QsdUJBQXVCLEdBQ3ZCM0Qsa0NBQWtDLEdBQ2xDRixrQ0FBa0M7TUFDdEQsSUFBSyxDQUFDLElBQUksQ0FBQ29CLGlCQUFpQixDQUFDOEIsc0JBQXNCLENBQUNqQixLQUFLLENBQUM4QixNQUFNLENBQUVELFdBQVksQ0FBQyxFQUFHO1FBRWhGO1FBQ0EsSUFBSyxJQUFJLENBQUNGLDBCQUEwQixFQUFHO1VBQ3JDLElBQUksQ0FBQ0EsMEJBQTBCLENBQUNJLElBQUksQ0FBQyxDQUFDO1FBQ3hDOztRQUVBO1FBQ0EsSUFBSSxDQUFDSiwwQkFBMEIsR0FBRyxJQUFJdEUsU0FBUyxDQUFFO1VBQy9DMkUsUUFBUSxFQUFFLEdBQUc7VUFDYkMsT0FBTyxFQUFFLENBQ1A7WUFDRUMsUUFBUSxFQUFFLElBQUksQ0FBQy9DLGlCQUFpQixDQUFDOEIsc0JBQXNCO1lBQ3ZEa0IsTUFBTSxFQUFFN0UsTUFBTSxDQUFDOEUsWUFBWTtZQUMzQkMsRUFBRSxFQUFFUjtVQUNOLENBQUM7UUFDTCxDQUFFLENBQUM7UUFDSCxJQUFJLENBQUNGLDBCQUEwQixDQUFDVyxLQUFLLENBQUMsQ0FBQztRQUN2QyxJQUFJLENBQUNYLDBCQUEwQixDQUFDWSxZQUFZLENBQUNDLFdBQVcsQ0FBRSxNQUFNO1VBQzlELElBQUksQ0FBQ2IsMEJBQTBCLEdBQUcsSUFBSTtRQUN4QyxDQUFFLENBQUM7TUFDTDtJQUNGLENBQUUsQ0FBQztFQUNMOztFQUVBO0FBQ0Y7QUFDQTtBQUNBO0VBQ0VjLEtBQUtBLENBQUEsRUFBRztJQUNOLElBQUksQ0FBQ3RELGlCQUFpQixDQUFDc0QsS0FBSyxDQUFDLENBQUM7SUFDOUIsSUFBSSxDQUFDekIsbUJBQW1CLENBQUN5QixLQUFLLENBQUMsQ0FBQztJQUNoQyxJQUFJLENBQUN2RCwrQkFBK0IsQ0FBQ3VELEtBQUssQ0FBQyxDQUFDO0VBQzlDO0FBQ0Y7O0FBRUE7QUFDQTFELGVBQWUsQ0FBQ3JCLGtCQUFrQixHQUFHQSxrQkFBa0I7QUFFdkRELG9CQUFvQixDQUFDaUYsUUFBUSxDQUFFLGlCQUFpQixFQUFFM0QsZUFBZ0IsQ0FBQztBQUNuRSxlQUFlQSxlQUFlIn0=