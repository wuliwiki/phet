// Copyright 2017-2023, University of Colorado Boulder

/**
 * Unit tests for PhetioObject
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import PhetioObject from './PhetioObject.js';
import Tandem from './Tandem.js';
import IOType from './types/IOType.js';
QUnit.module('PhetioObject');
const MockTypeIO = new IOType('MockTypeIO', {
  isValidValue: () => true,
  documentation: 'mock type',
  events: ['hello']
});
QUnit.test('PhetioObject start/start', assert => {
  assert.ok(true, 'initial test');
  const obj = new PhetioObject({
    tandem: Tandem.ROOT_TEST,
    phetioType: MockTypeIO,
    phetioState: false
  });
  obj.phetioStartEvent('hello');
});
QUnit.test('PhetioObject start/end', assert => {
  assert.ok(true, 'initial test');
  const obj = new PhetioObject({
    tandem: Tandem.ROOT_TEST.createTandem('test1'),
    phetioType: MockTypeIO,
    phetioState: false
  });
  obj.phetioStartEvent('hello');
  obj.phetioEndEvent();
});
QUnit.test('PhetioObject end without start', assert => {
  assert.ok(true, 'initial test');
  const obj = new PhetioObject({
    tandem: Tandem.ROOT_TEST.createTandem('test2'),
    phetioType: MockTypeIO,
    phetioState: false
  });
  if (Tandem.PHET_IO_ENABLED) {
    window.assert && assert.throws(() => {
      obj.phetioEndEvent();
    }, 'Should throw an assertion error when Ending an unstarted event');
  }
});
QUnit.test('PhetioObject is a Disposable', assert => {
  const object1 = new PhetioObject();
  assert.ok(!!object1.disposeEmitter, 'disposeEmitter needed');
  const object2 = new PhetioObject();
  object1.disposeEmitter.addListener(() => object2.dispose());
  assert.ok(!object1.isDisposed, '1 is not disposed');
  assert.ok(!object2.isDisposed, '2 is not disposed');
  object1.dispose();
  assert.ok(object1.isDisposed, '1 is disposed');
  assert.ok(object2.isDisposed, '2 is disposed');
});
Tandem.PHET_IO_ENABLED && QUnit.test('no calling addLinkedElement before instrumentation', assert => {
  assert.ok(true, 'always run one test');
  const obj = new PhetioObject();
  obj.addLinkedElement(new PhetioObject());
  window.assert && assert.throws(() => {
    obj['initializePhetioObject']({}, {
      tandem: Tandem.ROOT_TEST.createTandem('myObject')
    });
  }, 'Should throw an assertion because you should not link elements before instrumentation');
});
if (Tandem.PHET_IO_ENABLED) {
  QUnit.test('archetype bugginess when Tandem is not launched yet', assert => {
    // reset Tandem launch status to make sure that nothing goes through to phetioEngine in this test until launched again.
    Tandem.unlaunch();
    assert.ok(true, 'initial test');
    const object1Tandem = Tandem.ROOT_TEST.createTandem('object1');
    const phetioObject1 = new PhetioObject({
      tandem: object1Tandem
    });
    assert.ok(!phetioObject1.phetioIsArchetype, 'should not be an archetype before marking');
    const phetioObject1Child = new PhetioObject({
      tandem: object1Tandem.createTandem('child')
    });
    phetioObject1.markDynamicElementArchetype();
    assert.ok(phetioObject1.phetioIsArchetype, 'should be an archetype after marking');

    // This should actually automatically take effect when we hit markDynamicElementArchetype!
    assert.ok(phetioObject1Child.phetioIsArchetype, 'should look in the tandem buffered elements when it is not in the map');

    // launch to make sure tandem registration fires listeners
    Tandem.launch();
    assert.ok(phetioObject1.phetioIsArchetype, 'phetioIsArchetype should not have changed after launching');
    assert.ok(phetioObject1Child.phetioIsArchetype, 'phetioIsArchetype should not have changed after launching for child');
  });

  // isDynamicElement is not set in phet brand
  QUnit.test('PhetioObject.isDynamicElement', assert => {
    const test1 = Tandem.ROOT_TEST.createTandem('test1');
    const parentTandem = test1.createTandem('parent');
    const child1Tandem = parentTandem.createTandem('child1');
    const child2Tandem = parentTandem.createTandem('child2');
    const child1 = new PhetioObject({
      tandem: child1Tandem
    });
    const grandChild1 = new PhetioObject({
      tandem: child1Tandem.createTandem('grandChild')
    });
    assert.ok(!child1.phetioDynamicElement, 'direct child not dynamic before parent created');
    assert.ok(!grandChild1.phetioDynamicElement, 'grandchild not dynamic before parent created');
    const parent = new PhetioObject({
      tandem: parentTandem,
      phetioDynamicElement: true
    });
    assert.ok(parent.phetioDynamicElement, 'parent should be dynamic when marked dynamic');

    // This will only happen in phet-io brand
    if (Tandem.PHET_IO_ENABLED) {
      assert.ok(child1.phetioDynamicElement, 'direct child before parent creation');
      assert.ok(grandChild1.phetioDynamicElement, 'descendant child before parent creation');
      const child2 = new PhetioObject({
        tandem: parentTandem.createTandem('child2')
      });
      const grandChild2 = new PhetioObject({
        tandem: child2Tandem.createTandem('grandChild')
      });
      assert.ok(child2.phetioDynamicElement, 'direct child after parent creation');
      assert.ok(grandChild2.phetioDynamicElement, 'descendant child after parent creation');
      child2.markDynamicElementArchetype();
      assert.ok(!child2.phetioDynamicElement, 'Not dynamic if archetype: direct child after parent creation');
      assert.ok(!grandChild2.phetioDynamicElement, 'Not dynamic if archetype: descendant child after parent creation');
    }
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQaGV0aW9PYmplY3QiLCJUYW5kZW0iLCJJT1R5cGUiLCJRVW5pdCIsIm1vZHVsZSIsIk1vY2tUeXBlSU8iLCJpc1ZhbGlkVmFsdWUiLCJkb2N1bWVudGF0aW9uIiwiZXZlbnRzIiwidGVzdCIsImFzc2VydCIsIm9rIiwib2JqIiwidGFuZGVtIiwiUk9PVF9URVNUIiwicGhldGlvVHlwZSIsInBoZXRpb1N0YXRlIiwicGhldGlvU3RhcnRFdmVudCIsImNyZWF0ZVRhbmRlbSIsInBoZXRpb0VuZEV2ZW50IiwiUEhFVF9JT19FTkFCTEVEIiwid2luZG93IiwidGhyb3dzIiwib2JqZWN0MSIsImRpc3Bvc2VFbWl0dGVyIiwib2JqZWN0MiIsImFkZExpc3RlbmVyIiwiZGlzcG9zZSIsImlzRGlzcG9zZWQiLCJhZGRMaW5rZWRFbGVtZW50IiwidW5sYXVuY2giLCJvYmplY3QxVGFuZGVtIiwicGhldGlvT2JqZWN0MSIsInBoZXRpb0lzQXJjaGV0eXBlIiwicGhldGlvT2JqZWN0MUNoaWxkIiwibWFya0R5bmFtaWNFbGVtZW50QXJjaGV0eXBlIiwibGF1bmNoIiwidGVzdDEiLCJwYXJlbnRUYW5kZW0iLCJjaGlsZDFUYW5kZW0iLCJjaGlsZDJUYW5kZW0iLCJjaGlsZDEiLCJncmFuZENoaWxkMSIsInBoZXRpb0R5bmFtaWNFbGVtZW50IiwicGFyZW50IiwiY2hpbGQyIiwiZ3JhbmRDaGlsZDIiXSwic291cmNlcyI6WyJQaGV0aW9PYmplY3RUZXN0cy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBVbml0IHRlc3RzIGZvciBQaGV0aW9PYmplY3RcclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgUGhldGlvT2JqZWN0IGZyb20gJy4vUGhldGlvT2JqZWN0LmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBJT1R5cGUgZnJvbSAnLi90eXBlcy9JT1R5cGUuanMnO1xyXG5cclxuUVVuaXQubW9kdWxlKCAnUGhldGlvT2JqZWN0JyApO1xyXG5cclxuY29uc3QgTW9ja1R5cGVJTyA9IG5ldyBJT1R5cGUoICdNb2NrVHlwZUlPJywge1xyXG4gIGlzVmFsaWRWYWx1ZTogKCkgPT4gdHJ1ZSxcclxuICBkb2N1bWVudGF0aW9uOiAnbW9jayB0eXBlJyxcclxuICBldmVudHM6IFsgJ2hlbGxvJyBdXHJcbn0gKTtcclxuXHJcblFVbml0LnRlc3QoICdQaGV0aW9PYmplY3Qgc3RhcnQvc3RhcnQnLCBhc3NlcnQgPT4ge1xyXG4gIGFzc2VydC5vayggdHJ1ZSwgJ2luaXRpYWwgdGVzdCcgKTtcclxuXHJcbiAgY29uc3Qgb2JqID0gbmV3IFBoZXRpb09iamVjdCgge1xyXG4gICAgdGFuZGVtOiBUYW5kZW0uUk9PVF9URVNULFxyXG4gICAgcGhldGlvVHlwZTogTW9ja1R5cGVJTyxcclxuICAgIHBoZXRpb1N0YXRlOiBmYWxzZVxyXG4gIH0gKTtcclxuICBvYmoucGhldGlvU3RhcnRFdmVudCggJ2hlbGxvJyApO1xyXG59ICk7XHJcblxyXG5RVW5pdC50ZXN0KCAnUGhldGlvT2JqZWN0IHN0YXJ0L2VuZCcsIGFzc2VydCA9PiB7XHJcbiAgYXNzZXJ0Lm9rKCB0cnVlLCAnaW5pdGlhbCB0ZXN0JyApO1xyXG5cclxuICBjb25zdCBvYmogPSBuZXcgUGhldGlvT2JqZWN0KCB7XHJcbiAgICB0YW5kZW06IFRhbmRlbS5ST09UX1RFU1QuY3JlYXRlVGFuZGVtKCAndGVzdDEnICksXHJcbiAgICBwaGV0aW9UeXBlOiBNb2NrVHlwZUlPLFxyXG4gICAgcGhldGlvU3RhdGU6IGZhbHNlXHJcbiAgfSApO1xyXG4gIG9iai5waGV0aW9TdGFydEV2ZW50KCAnaGVsbG8nICk7XHJcbiAgb2JqLnBoZXRpb0VuZEV2ZW50KCk7XHJcbn0gKTtcclxuXHJcblFVbml0LnRlc3QoICdQaGV0aW9PYmplY3QgZW5kIHdpdGhvdXQgc3RhcnQnLCBhc3NlcnQgPT4ge1xyXG4gIGFzc2VydC5vayggdHJ1ZSwgJ2luaXRpYWwgdGVzdCcgKTtcclxuXHJcbiAgY29uc3Qgb2JqID0gbmV3IFBoZXRpb09iamVjdCgge1xyXG4gICAgdGFuZGVtOiBUYW5kZW0uUk9PVF9URVNULmNyZWF0ZVRhbmRlbSggJ3Rlc3QyJyApLFxyXG4gICAgcGhldGlvVHlwZTogTW9ja1R5cGVJTyxcclxuICAgIHBoZXRpb1N0YXRlOiBmYWxzZVxyXG4gIH0gKTtcclxuXHJcbiAgaWYgKCBUYW5kZW0uUEhFVF9JT19FTkFCTEVEICkge1xyXG4gICAgd2luZG93LmFzc2VydCAmJiBhc3NlcnQudGhyb3dzKCAoKSA9PiB7XHJcbiAgICAgIG9iai5waGV0aW9FbmRFdmVudCgpO1xyXG4gICAgfSwgJ1Nob3VsZCB0aHJvdyBhbiBhc3NlcnRpb24gZXJyb3Igd2hlbiBFbmRpbmcgYW4gdW5zdGFydGVkIGV2ZW50JyApO1xyXG4gIH1cclxufSApO1xyXG5cclxuUVVuaXQudGVzdCggJ1BoZXRpb09iamVjdCBpcyBhIERpc3Bvc2FibGUnLCBhc3NlcnQgPT4ge1xyXG4gIGNvbnN0IG9iamVjdDEgPSBuZXcgUGhldGlvT2JqZWN0KCk7XHJcblxyXG4gIGFzc2VydC5vayggISFvYmplY3QxLmRpc3Bvc2VFbWl0dGVyLCAnZGlzcG9zZUVtaXR0ZXIgbmVlZGVkJyApO1xyXG5cclxuICBjb25zdCBvYmplY3QyID0gbmV3IFBoZXRpb09iamVjdCgpO1xyXG5cclxuICBvYmplY3QxLmRpc3Bvc2VFbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiBvYmplY3QyLmRpc3Bvc2UoKSApO1xyXG5cclxuICBhc3NlcnQub2soICFvYmplY3QxLmlzRGlzcG9zZWQsICcxIGlzIG5vdCBkaXNwb3NlZCcgKTtcclxuICBhc3NlcnQub2soICFvYmplY3QyLmlzRGlzcG9zZWQsICcyIGlzIG5vdCBkaXNwb3NlZCcgKTtcclxuXHJcbiAgb2JqZWN0MS5kaXNwb3NlKCk7XHJcbiAgYXNzZXJ0Lm9rKCBvYmplY3QxLmlzRGlzcG9zZWQsICcxIGlzIGRpc3Bvc2VkJyApO1xyXG4gIGFzc2VydC5vayggb2JqZWN0Mi5pc0Rpc3Bvc2VkLCAnMiBpcyBkaXNwb3NlZCcgKTtcclxufSApO1xyXG5cclxuVGFuZGVtLlBIRVRfSU9fRU5BQkxFRCAmJiBRVW5pdC50ZXN0KCAnbm8gY2FsbGluZyBhZGRMaW5rZWRFbGVtZW50IGJlZm9yZSBpbnN0cnVtZW50YXRpb24nLCBhc3NlcnQgPT4ge1xyXG4gIGFzc2VydC5vayggdHJ1ZSwgJ2Fsd2F5cyBydW4gb25lIHRlc3QnICk7XHJcblxyXG4gIGNvbnN0IG9iaiA9IG5ldyBQaGV0aW9PYmplY3QoKTtcclxuICBvYmouYWRkTGlua2VkRWxlbWVudCggbmV3IFBoZXRpb09iamVjdCgpICk7XHJcblxyXG4gIHdpbmRvdy5hc3NlcnQgJiYgYXNzZXJ0LnRocm93cyggKCkgPT4ge1xyXG4gICAgb2JqWyAnaW5pdGlhbGl6ZVBoZXRpb09iamVjdCcgXSgge30sIHtcclxuICAgICAgdGFuZGVtOiBUYW5kZW0uUk9PVF9URVNULmNyZWF0ZVRhbmRlbSggJ215T2JqZWN0JyApXHJcbiAgICB9ICk7XHJcbiAgfSwgJ1Nob3VsZCB0aHJvdyBhbiBhc3NlcnRpb24gYmVjYXVzZSB5b3Ugc2hvdWxkIG5vdCBsaW5rIGVsZW1lbnRzIGJlZm9yZSBpbnN0cnVtZW50YXRpb24nICk7XHJcbn0gKTtcclxuXHJcbmlmICggVGFuZGVtLlBIRVRfSU9fRU5BQkxFRCApIHtcclxuXHJcbiAgUVVuaXQudGVzdCggJ2FyY2hldHlwZSBidWdnaW5lc3Mgd2hlbiBUYW5kZW0gaXMgbm90IGxhdW5jaGVkIHlldCcsIGFzc2VydCA9PiB7XHJcblxyXG4gICAgLy8gcmVzZXQgVGFuZGVtIGxhdW5jaCBzdGF0dXMgdG8gbWFrZSBzdXJlIHRoYXQgbm90aGluZyBnb2VzIHRocm91Z2ggdG8gcGhldGlvRW5naW5lIGluIHRoaXMgdGVzdCB1bnRpbCBsYXVuY2hlZCBhZ2Fpbi5cclxuICAgIFRhbmRlbS51bmxhdW5jaCgpO1xyXG5cclxuICAgIGFzc2VydC5vayggdHJ1ZSwgJ2luaXRpYWwgdGVzdCcgKTtcclxuXHJcbiAgICBjb25zdCBvYmplY3QxVGFuZGVtID0gVGFuZGVtLlJPT1RfVEVTVC5jcmVhdGVUYW5kZW0oICdvYmplY3QxJyApO1xyXG4gICAgY29uc3QgcGhldGlvT2JqZWN0MSA9IG5ldyBQaGV0aW9PYmplY3QoIHsgdGFuZGVtOiBvYmplY3QxVGFuZGVtIH0gKTtcclxuICAgIGFzc2VydC5vayggIXBoZXRpb09iamVjdDEucGhldGlvSXNBcmNoZXR5cGUsICdzaG91bGQgbm90IGJlIGFuIGFyY2hldHlwZSBiZWZvcmUgbWFya2luZycgKTtcclxuXHJcbiAgICBjb25zdCBwaGV0aW9PYmplY3QxQ2hpbGQgPSBuZXcgUGhldGlvT2JqZWN0KCB7IHRhbmRlbTogb2JqZWN0MVRhbmRlbS5jcmVhdGVUYW5kZW0oICdjaGlsZCcgKSB9ICk7XHJcblxyXG4gICAgcGhldGlvT2JqZWN0MS5tYXJrRHluYW1pY0VsZW1lbnRBcmNoZXR5cGUoKTtcclxuXHJcbiAgICBhc3NlcnQub2soIHBoZXRpb09iamVjdDEucGhldGlvSXNBcmNoZXR5cGUsICdzaG91bGQgYmUgYW4gYXJjaGV0eXBlIGFmdGVyIG1hcmtpbmcnICk7XHJcblxyXG4gICAgLy8gVGhpcyBzaG91bGQgYWN0dWFsbHkgYXV0b21hdGljYWxseSB0YWtlIGVmZmVjdCB3aGVuIHdlIGhpdCBtYXJrRHluYW1pY0VsZW1lbnRBcmNoZXR5cGUhXHJcbiAgICBhc3NlcnQub2soIHBoZXRpb09iamVjdDFDaGlsZC5waGV0aW9Jc0FyY2hldHlwZSwgJ3Nob3VsZCBsb29rIGluIHRoZSB0YW5kZW0gYnVmZmVyZWQgZWxlbWVudHMgd2hlbiBpdCBpcyBub3QgaW4gdGhlIG1hcCcgKTtcclxuXHJcbiAgICAvLyBsYXVuY2ggdG8gbWFrZSBzdXJlIHRhbmRlbSByZWdpc3RyYXRpb24gZmlyZXMgbGlzdGVuZXJzXHJcbiAgICBUYW5kZW0ubGF1bmNoKCk7XHJcblxyXG4gICAgYXNzZXJ0Lm9rKCBwaGV0aW9PYmplY3QxLnBoZXRpb0lzQXJjaGV0eXBlLCAncGhldGlvSXNBcmNoZXR5cGUgc2hvdWxkIG5vdCBoYXZlIGNoYW5nZWQgYWZ0ZXIgbGF1bmNoaW5nJyApO1xyXG4gICAgYXNzZXJ0Lm9rKCBwaGV0aW9PYmplY3QxQ2hpbGQucGhldGlvSXNBcmNoZXR5cGUsICdwaGV0aW9Jc0FyY2hldHlwZSBzaG91bGQgbm90IGhhdmUgY2hhbmdlZCBhZnRlciBsYXVuY2hpbmcgZm9yIGNoaWxkJyApO1xyXG4gIH0gKTtcclxuXHJcbiAgLy8gaXNEeW5hbWljRWxlbWVudCBpcyBub3Qgc2V0IGluIHBoZXQgYnJhbmRcclxuICBRVW5pdC50ZXN0KCAnUGhldGlvT2JqZWN0LmlzRHluYW1pY0VsZW1lbnQnLCBhc3NlcnQgPT4ge1xyXG4gICAgY29uc3QgdGVzdDEgPSBUYW5kZW0uUk9PVF9URVNULmNyZWF0ZVRhbmRlbSggJ3Rlc3QxJyApO1xyXG4gICAgY29uc3QgcGFyZW50VGFuZGVtID0gdGVzdDEuY3JlYXRlVGFuZGVtKCAncGFyZW50JyApO1xyXG4gICAgY29uc3QgY2hpbGQxVGFuZGVtID0gcGFyZW50VGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2NoaWxkMScgKTtcclxuICAgIGNvbnN0IGNoaWxkMlRhbmRlbSA9IHBhcmVudFRhbmRlbS5jcmVhdGVUYW5kZW0oICdjaGlsZDInICk7XHJcbiAgICBjb25zdCBjaGlsZDEgPSBuZXcgUGhldGlvT2JqZWN0KCB7XHJcbiAgICAgIHRhbmRlbTogY2hpbGQxVGFuZGVtXHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBncmFuZENoaWxkMSA9IG5ldyBQaGV0aW9PYmplY3QoIHtcclxuICAgICAgdGFuZGVtOiBjaGlsZDFUYW5kZW0uY3JlYXRlVGFuZGVtKCAnZ3JhbmRDaGlsZCcgKVxyXG4gICAgfSApO1xyXG4gICAgYXNzZXJ0Lm9rKCAhY2hpbGQxLnBoZXRpb0R5bmFtaWNFbGVtZW50LCAnZGlyZWN0IGNoaWxkIG5vdCBkeW5hbWljIGJlZm9yZSBwYXJlbnQgY3JlYXRlZCcgKTtcclxuICAgIGFzc2VydC5vayggIWdyYW5kQ2hpbGQxLnBoZXRpb0R5bmFtaWNFbGVtZW50LCAnZ3JhbmRjaGlsZCBub3QgZHluYW1pYyBiZWZvcmUgcGFyZW50IGNyZWF0ZWQnICk7XHJcblxyXG4gICAgY29uc3QgcGFyZW50ID0gbmV3IFBoZXRpb09iamVjdCgge1xyXG4gICAgICB0YW5kZW06IHBhcmVudFRhbmRlbSxcclxuICAgICAgcGhldGlvRHluYW1pY0VsZW1lbnQ6IHRydWVcclxuICAgIH0gKTtcclxuICAgIGFzc2VydC5vayggcGFyZW50LnBoZXRpb0R5bmFtaWNFbGVtZW50LCAncGFyZW50IHNob3VsZCBiZSBkeW5hbWljIHdoZW4gbWFya2VkIGR5bmFtaWMnICk7XHJcblxyXG4gICAgLy8gVGhpcyB3aWxsIG9ubHkgaGFwcGVuIGluIHBoZXQtaW8gYnJhbmRcclxuICAgIGlmICggVGFuZGVtLlBIRVRfSU9fRU5BQkxFRCApIHtcclxuXHJcbiAgICAgIGFzc2VydC5vayggY2hpbGQxLnBoZXRpb0R5bmFtaWNFbGVtZW50LCAnZGlyZWN0IGNoaWxkIGJlZm9yZSBwYXJlbnQgY3JlYXRpb24nICk7XHJcbiAgICAgIGFzc2VydC5vayggZ3JhbmRDaGlsZDEucGhldGlvRHluYW1pY0VsZW1lbnQsICdkZXNjZW5kYW50IGNoaWxkIGJlZm9yZSBwYXJlbnQgY3JlYXRpb24nICk7XHJcblxyXG4gICAgICBjb25zdCBjaGlsZDIgPSBuZXcgUGhldGlvT2JqZWN0KCB7XHJcbiAgICAgICAgdGFuZGVtOiBwYXJlbnRUYW5kZW0uY3JlYXRlVGFuZGVtKCAnY2hpbGQyJyApXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAgIGNvbnN0IGdyYW5kQ2hpbGQyID0gbmV3IFBoZXRpb09iamVjdCgge1xyXG4gICAgICAgIHRhbmRlbTogY2hpbGQyVGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2dyYW5kQ2hpbGQnIClcclxuICAgICAgfSApO1xyXG5cclxuICAgICAgYXNzZXJ0Lm9rKCBjaGlsZDIucGhldGlvRHluYW1pY0VsZW1lbnQsICdkaXJlY3QgY2hpbGQgYWZ0ZXIgcGFyZW50IGNyZWF0aW9uJyApO1xyXG4gICAgICBhc3NlcnQub2soIGdyYW5kQ2hpbGQyLnBoZXRpb0R5bmFtaWNFbGVtZW50LCAnZGVzY2VuZGFudCBjaGlsZCBhZnRlciBwYXJlbnQgY3JlYXRpb24nICk7XHJcblxyXG4gICAgICBjaGlsZDIubWFya0R5bmFtaWNFbGVtZW50QXJjaGV0eXBlKCk7XHJcblxyXG4gICAgICBhc3NlcnQub2soICFjaGlsZDIucGhldGlvRHluYW1pY0VsZW1lbnQsICdOb3QgZHluYW1pYyBpZiBhcmNoZXR5cGU6IGRpcmVjdCBjaGlsZCBhZnRlciBwYXJlbnQgY3JlYXRpb24nICk7XHJcbiAgICAgIGFzc2VydC5vayggIWdyYW5kQ2hpbGQyLnBoZXRpb0R5bmFtaWNFbGVtZW50LCAnTm90IGR5bmFtaWMgaWYgYXJjaGV0eXBlOiBkZXNjZW5kYW50IGNoaWxkIGFmdGVyIHBhcmVudCBjcmVhdGlvbicgKTtcclxuICAgIH1cclxuICB9ICk7XHJcbn0iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsWUFBWSxNQUFNLG1CQUFtQjtBQUM1QyxPQUFPQyxNQUFNLE1BQU0sYUFBYTtBQUNoQyxPQUFPQyxNQUFNLE1BQU0sbUJBQW1CO0FBRXRDQyxLQUFLLENBQUNDLE1BQU0sQ0FBRSxjQUFlLENBQUM7QUFFOUIsTUFBTUMsVUFBVSxHQUFHLElBQUlILE1BQU0sQ0FBRSxZQUFZLEVBQUU7RUFDM0NJLFlBQVksRUFBRUEsQ0FBQSxLQUFNLElBQUk7RUFDeEJDLGFBQWEsRUFBRSxXQUFXO0VBQzFCQyxNQUFNLEVBQUUsQ0FBRSxPQUFPO0FBQ25CLENBQUUsQ0FBQztBQUVITCxLQUFLLENBQUNNLElBQUksQ0FBRSwwQkFBMEIsRUFBRUMsTUFBTSxJ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