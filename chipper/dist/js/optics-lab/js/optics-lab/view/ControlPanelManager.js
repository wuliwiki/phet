// Copyright 2015-2021, University of Colorado Boulder

/**
 * Control panel for a particular source (fan or beam) or a particular component (lens, mirror, or mask)
 * contains sliders to set height or spread of source or diameter, focal length (if lens or mirror) and index (if lens) of refraction of component
 * Piece:  Controls
 * fan_source: spread in degrees
 * beam_source: height in cm
 * converging_lens: diameter in cm,/radius of curvature in cm/index of refraction (no units)
 * diverging_lens: diameter/radius/index
 * converging_mirror: diameter/radius
 * diverging_mirror: diameter/radius
 * plane_mirror: diameter
 * simple_mask: diameter
 * slit_mask: diameter/ slit width
 *
 * @author Michael Dubson (PhET Interactive Simulations)
 */

import createObservableArray from '../../../../axon/js/createObservableArray.js';
import Utils from '../../../../dot/js/Utils.js';
import { Node } from '../../../../scenery/js/imports.js';
import opticsLab from '../../opticsLab.js';
import Type from '../model/Type.js';
import ControlPanel from './ControlPanel.js';
class ControlPanelManager extends Node {
  /**
   * @param {OpticsLabScreenView} mainView
   */
  constructor(mainView) {
    super();
    this.mainView = mainView;
    this.controlPanels = []; //one display for each piece on the stage, only display of selected piece is visible
    this.pieces = createObservableArray();
    this.selectedPiece = new Node();
    this.previousRaysUpdate;
    this.previousSpreadUpdate;
    this.previousColorUpdate;
    this.previousDiameterUpdate;
    this.previousRadiusOfCurvatureUpdate;
    this.previousIndexOfRefractionUpdate;
    this.previousShowFocalPointsUpdate;
    this.previousDisplayFocalLengthUpdate;
    //this.expandedProperty = new Property( true );
    this.typeArray = [Type.FAN_SOURCE, Type.BEAM_SOURCE, Type.CONVERGING_LENS, Type.DIVERGING_LENS, Type.CONVERGING_MIRROR, Type.PLANE_MIRROR, Type.DIVERGING_MIRROR, Type.SIMPLE_MASK, Type.SLIT_MASK];
    for (let i = 0; i < this.typeArray.length; i++) {
      const newControlPanel = new ControlPanel(mainView, this.typeArray[i]);
      this.controlPanels[i] = newControlPanel;
      this.addChild(newControlPanel);
    }
    this.mainView.selectedPieceProperty.lazyLink(piece => {
      this.selectedPiece = piece;
      this.linkControls();
    });

    // All controls are placed on display node, with visibility set by accordionBox button
  } //end constructor

  /**
   *
   * @param {Type} type
   * @returns {number}
   * @public
   */
  getIndex(type) {
    let index;
    for (let i = 0; i < this.typeArray.length; i++) {
      if (this.controlPanels[i].type === type) {
        index = i;
      }
    }
    return index;
  }

  /**
   * @private
   */
  linkControls() {
    const piece = this.selectedPiece;
    const controlPanel = this.controlPanels[this.getIndex(piece.type)];
    const raysUpdate = nbrOfRays => {
      piece.pieceModel.nbrOfRaysProperty.value = Utils.roundSymmetric(nbrOfRays);
    };
    const spreadUpdate = spread => {
      piece.pieceModel.spreadProperty.value = Utils.roundSymmetric(spread);
    };
    const colorUpdate = colorString => {
      piece.colorProperty.value = colorString;
    };
    const widthUpdate = width => {
      piece.pieceModel.widthProperty.value = width;
    };
    const diameterUpdate = diameter => {
      piece.pieceModel.diameterProperty.value = diameter;
    };
    const radiusOfCurvatureUpdate = radius => {
      piece.pieceModel.radiusProperty.value = radius;
    };
    const indexOfRefractionUpdate = index => {
      piece.pieceModel.indexProperty.value = index;
    };
    const showFocalPointsUpdate = tOrF => {
      piece.showFocalPointsProperty.value = tOrF;
    };
    const unlinkAll = () => {
      controlPanel.nbrOfRaysProperty.hasListener(this.previousRaysUpdate) && controlPanel.nbrOfRaysProperty.unlink(this.previousRaysUpdate);
      controlPanel.spreadProperty.hasListener(this.previousSpreadUpdate) && controlPanel.spreadProperty.unlink(this.previousSpreadUpdate);
      controlPanel.colorProperty.hasListener(this.previousColorUpdate) && controlPanel.colorProperty.unlink(this.previousColorUpdate);
      controlPanel.widthProperty.hasListener(this.previousWidthUpdate) && controlPanel.widthProperty.unlink(this.previousWidthUpdate);
      controlPanel.diameterProperty.hasListener(this.previousDiameterUpdate) && controlPanel.diameterProperty.unlink(this.previousDiameterUpdate);
      controlPanel.radiusOfCurvatureProperty.hasListener(this.previousRadiusOfCurvatureUpdate) && controlPanel.radiusOfCurvatureProperty.unlink(this.previousRadiusOfCurvatureUpdate);
      controlPanel.indexOfRefractionProperty.hasListener(this.previousIndexOfRefractionUpdate) && controlPanel.indexOfRefractionProperty.unlink(this.previousIndexOfRefractionUpdate);
      controlPanel.showFocalPointsProperty.hasListener(this.previousShowFocalPointsUpdate) && controlPanel.showFocalPointsProperty.unlink(this.previousShowFocalPointsUpdate);
    };
    const setAllPanelsAndLinkAll = () => {
      if (piece.pieceModel.nbrOfRaysProperty !== undefined) {
        controlPanel.nbrOfRaysProperty.value = piece.pieceModel.nbrOfRaysProperty.value;
        controlPanel.nbrOfRaysProperty.link(raysUpdate);
      }
      if (piece.pieceModel.spreadProperty !== undefined) {
        controlPanel.spreadProperty.value = piece.pieceModel.spreadProperty.value;
        controlPanel.spreadProperty.link(spreadUpdate);
      }
      if (piece.colorProperty !== undefined) {
        controlPanel.colorProperty.value = piece.colorProperty.value;
        controlPanel.colorProperty.link(colorUpdate);
      }
      if (piece.pieceModel.widthProperty !== undefined) {
        controlPanel.widthProperty.value = piece.pieceModel.widthProperty.value;
        controlPanel.widthProperty.link(widthUpdate);
      }
      if (piece.pieceModel.diameterProperty !== undefined && piece.pieceModel.diameterProperty.value !== undefined) {
        controlPanel.diameterProperty.value = piece.pieceModel.diameterProperty.value;
        controlPanel.diameterProperty.link(diameterUpdate);
      }
      if (piece.pieceModel.radiusProperty !== undefined && piece.pieceModel.radiusProperty.value !== undefined) {
        controlPanel.radiusOfCurvatureProperty.value = piece.pieceModel.radiusProperty.value;
        controlPanel.radiusOfCurvatureProperty.link(radiusOfCurvatureUpdate);
      }
      if (piece.pieceModel.indexProperty !== undefined && piece.pieceModel.indexProperty.value !== undefined) {
        controlPanel.indexOfRefractionProperty.value = piece.pieceModel.indexProperty.value;
        controlPanel.indexOfRefractionProperty.link(indexOfRefractionUpdate);
      }
      if (piece.showFocalPointsProperty !== undefined) {
        controlPanel.showFocalPointsProperty.value = piece.showFocalPointsProperty.value;
        controlPanel.showFocalPointsProperty.link(showFocalPointsUpdate);
      }
    };
    const setPreviousUpdates = () => {
      this.previousRaysUpdate = raysUpdate;
      this.previousSpreadUpdate = spreadUpdate;
      this.previousColorUpdate = colorUpdate;
      this.previousWidthUpdate = widthUpdate;
      this.previousDiameterUpdate = diameterUpdate;
      this.previousRadiusOfCurvatureUpdate = radiusOfCurvatureUpdate;
      this.previousIndexOfRefractionUpdate = indexOfRefractionUpdate;
      this.previousShowFocalPointsUpdate = showFocalPointsUpdate;
    };
    unlinkAll();
    setAllPanelsAndLinkAll();
    //linkAll();
    setPreviousUpdates();
  } //end linkControls()
}

opticsLab.register('ControlPanelManager', ControlPanelManager);
export default ControlPanelManager;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjcmVhdGVPYnNlcnZhYmxlQXJyYXkiLCJVdGlscyIsIk5vZGUiLCJvcHRpY3NMYWIiLCJUeXBlIiwiQ29udHJvbFBhbmVsIiwiQ29udHJvbFBhbmVsTWFuYWdlciIsImNvbnN0cnVjdG9yIiwibWFpblZpZXciLCJjb250cm9sUGFuZWxzIiwicGllY2VzIiwic2VsZWN0ZWRQaWVjZSIsInByZXZpb3VzUmF5c1VwZGF0ZSIsInByZXZpb3VzU3ByZWFkVXBkYXRlIiwicHJldmlvdXNDb2xvclVwZGF0ZSIsInByZXZpb3VzRGlhbWV0ZXJVcGRhdGUiLCJwcmV2aW91c1JhZGl1c09mQ3VydmF0dXJlVXBkYXRlIiwicHJldmlvdXNJbmRleE9mUmVmcmFjdGlvblVwZGF0ZSIsInByZXZpb3VzU2hvd0ZvY2FsUG9pbnRzVXBkYXRlIiwicHJldmlvdXNEaXNwbGF5Rm9jYWxMZW5ndGhVcGRhdGUiLCJ0eXBlQXJyYXkiLCJGQU5fU09VUkNFIiwiQkVBTV9TT1VSQ0UiLCJDT05WRVJHSU5HX0xFTlMiLCJESVZFUkdJTkdfTEVOUyIsIkNPTlZFUkdJTkdfTUlSUk9SIiwiUExBTkVfTUlSUk9SIiwiRElWRVJHSU5HX01JUlJPUiIsIlNJTVBMRV9NQVNLIiwiU0xJVF9NQVNLIiwiaSIsImxlbmd0aCIsIm5ld0NvbnRyb2xQYW5lbCIsImFkZENoaWxkIiwic2VsZWN0ZWRQaWVjZVByb3BlcnR5IiwibGF6eUxpbmsiLCJwaWVjZSIsImxpbmtDb250cm9scyIsImdldEluZGV4IiwidHlwZSIsImluZGV4IiwiY29udHJvbFBhbmVsIiwicmF5c1VwZGF0ZSIsIm5ick9mUmF5cyIsInBpZWNlTW9kZWwiLCJuYnJPZlJheXNQcm9wZXJ0eSIsInZhbHVlIiwicm91bmRTeW1tZXRyaWMiLCJzcHJlYWRVcGRhdGUiLCJzcHJlYWQiLCJzcHJlYWRQcm9wZXJ0eSIsImNvbG9yVXBkYXRlIiwiY29sb3JTdHJpbmciLCJjb2xvclByb3BlcnR5Iiwid2lkdGhVcGRhdGUiLCJ3aWR0aCIsIndpZHRoUHJvcGVydHkiLCJkaWFtZXRlclVwZGF0ZSIsImRpYW1ldGVyIiwiZGlhbWV0ZXJQcm9wZXJ0eSIsInJhZGl1c09mQ3VydmF0dXJlVXBkYXRlIiwicmFkaXVzIiwicmFkaXVzUHJvcGVydHkiLCJpbmRleE9mUmVmcmFjdGlvblVwZGF0ZSIsImluZGV4UHJvcGVydHkiLCJzaG93Rm9jYWxQb2ludHNVcGRhdGUiLCJ0T3JGIiwic2hvd0ZvY2FsUG9pbnRzUHJvcGVydHkiLCJ1bmxpbmtBbGwiLCJoYXNMaXN0ZW5lciIsInVubGluayIsInByZXZpb3VzV2lkdGhVcGRhdGUiLCJyYWRpdXNPZkN1cnZhdHVyZVByb3BlcnR5IiwiaW5kZXhPZlJlZnJhY3Rpb25Qcm9wZXJ0eSIsInNldEFsbFBhbmVsc0FuZExpbmtBbGwiLCJ1bmRlZmluZWQiLCJsaW5rIiwic2V0UHJldmlvdXNVcGRhdGVzIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJDb250cm9sUGFuZWxNYW5hZ2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE1LTIwMjEsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIENvbnRyb2wgcGFuZWwgZm9yIGEgcGFydGljdWxhciBzb3VyY2UgKGZhbiBvciBiZWFtKSBvciBhIHBhcnRpY3VsYXIgY29tcG9uZW50IChsZW5zLCBtaXJyb3IsIG9yIG1hc2spXHJcbiAqIGNvbnRhaW5zIHNsaWRlcnMgdG8gc2V0IGhlaWdodCBvciBzcHJlYWQgb2Ygc291cmNlIG9yIGRpYW1ldGVyLCBmb2NhbCBsZW5ndGggKGlmIGxlbnMgb3IgbWlycm9yKSBhbmQgaW5kZXggKGlmIGxlbnMpIG9mIHJlZnJhY3Rpb24gb2YgY29tcG9uZW50XHJcbiAqIFBpZWNlOiAgQ29udHJvbHNcclxuICogZmFuX3NvdXJjZTogc3ByZWFkIGluIGRlZ3JlZXNcclxuICogYmVhbV9zb3VyY2U6IGhlaWdodCBpbiBjbVxyXG4gKiBjb252ZXJnaW5nX2xlbnM6IGRpYW1ldGVyIGluIGNtLC9yYWRpdXMgb2YgY3VydmF0dXJlIGluIGNtL2luZGV4IG9mIHJlZnJhY3Rpb24gKG5vIHVuaXRzKVxyXG4gKiBkaXZlcmdpbmdfbGVuczogZGlhbWV0ZXIvcmFkaXVzL2luZGV4XHJcbiAqIGNvbnZlcmdpbmdfbWlycm9yOiBkaWFtZXRlci9yYWRpdXNcclxuICogZGl2ZXJnaW5nX21pcnJvcjogZGlhbWV0ZXIvcmFkaXVzXHJcbiAqIHBsYW5lX21pcnJvcjogZGlhbWV0ZXJcclxuICogc2ltcGxlX21hc2s6IGRpYW1ldGVyXHJcbiAqIHNsaXRfbWFzazogZGlhbWV0ZXIvIHNsaXQgd2lkdGhcclxuICpcclxuICogQGF1dGhvciBNaWNoYWVsIER1YnNvbiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgY3JlYXRlT2JzZXJ2YWJsZUFycmF5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvY3JlYXRlT2JzZXJ2YWJsZUFycmF5LmpzJztcclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCB7IE5vZGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgb3B0aWNzTGFiIGZyb20gJy4uLy4uL29wdGljc0xhYi5qcyc7XHJcbmltcG9ydCBUeXBlIGZyb20gJy4uL21vZGVsL1R5cGUuanMnO1xyXG5pbXBvcnQgQ29udHJvbFBhbmVsIGZyb20gJy4vQ29udHJvbFBhbmVsLmpzJztcclxuXHJcbmNsYXNzIENvbnRyb2xQYW5lbE1hbmFnZXIgZXh0ZW5kcyBOb2RlIHtcclxuICAvKipcclxuICAgKiBAcGFyYW0ge09wdGljc0xhYlNjcmVlblZpZXd9IG1haW5WaWV3XHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG1haW5WaWV3ICkge1xyXG5cclxuICAgIHN1cGVyKCk7XHJcbiAgICB0aGlzLm1haW5WaWV3ID0gbWFpblZpZXc7XHJcbiAgICB0aGlzLmNvbnRyb2xQYW5lbHMgPSBbXTsgICAgIC8vb25lIGRpc3BsYXkgZm9yIGVhY2ggcGllY2Ugb24gdGhlIHN0YWdlLCBvbmx5IGRpc3BsYXkgb2Ygc2VsZWN0ZWQgcGllY2UgaXMgdmlzaWJsZVxyXG4gICAgdGhpcy5waWVjZXMgPSBjcmVhdGVPYnNlcnZhYmxlQXJyYXkoKTtcclxuICAgIHRoaXMuc2VsZWN0ZWRQaWVjZSA9IG5ldyBOb2RlKCk7XHJcbiAgICB0aGlzLnByZXZpb3VzUmF5c1VwZGF0ZTtcclxuICAgIHRoaXMucHJldmlvdXNTcHJlYWRVcGRhdGU7XHJcbiAgICB0aGlzLnByZXZpb3VzQ29sb3JVcGRhdGU7XHJcbiAgICB0aGlzLnByZXZpb3VzRGlhbWV0ZXJVcGRhdGU7XHJcbiAgICB0aGlzLnByZXZpb3VzUmFkaXVzT2ZDdXJ2YXR1cmVVcGRhdGU7XHJcbiAgICB0aGlzLnByZXZpb3VzSW5kZXhPZlJlZnJhY3Rpb25VcGRhdGU7XHJcbiAgICB0aGlzLnByZXZpb3VzU2hvd0ZvY2FsUG9pbnRzVXBkYXRlO1xyXG4gICAgdGhpcy5wcmV2aW91c0Rpc3BsYXlGb2NhbExlbmd0aFVwZGF0ZTtcclxuICAgIC8vdGhpcy5leHBhbmRlZFByb3BlcnR5ID0gbmV3IFByb3BlcnR5KCB0cnVlICk7XHJcbiAgICB0aGlzLnR5cGVBcnJheSA9IFtcclxuICAgICAgVHlwZS5GQU5fU09VUkNFLFxyXG4gICAgICBUeXBlLkJFQU1fU09VUkNFLFxyXG4gICAgICBUeXBlLkNPTlZFUkdJTkdfTEVOUyxcclxuICAgICAgVHlwZS5ESVZFUkdJTkdfTEVOUyxcclxuICAgICAgVHlwZS5DT05WRVJHSU5HX01JUlJPUixcclxuICAgICAgVHlwZS5QTEFORV9NSVJST1IsXHJcbiAgICAgIFR5cGUuRElWRVJHSU5HX01JUlJPUixcclxuICAgICAgVHlwZS5TSU1QTEVfTUFTSyxcclxuICAgICAgVHlwZS5TTElUX01BU0tcclxuICAgIF07XHJcblxyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgdGhpcy50eXBlQXJyYXkubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgIGNvbnN0IG5ld0NvbnRyb2xQYW5lbCA9IG5ldyBDb250cm9sUGFuZWwoIG1haW5WaWV3LCB0aGlzLnR5cGVBcnJheVsgaSBdICk7XHJcbiAgICAgIHRoaXMuY29udHJvbFBhbmVsc1sgaSBdID0gbmV3Q29udHJvbFBhbmVsO1xyXG4gICAgICB0aGlzLmFkZENoaWxkKCBuZXdDb250cm9sUGFuZWwgKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLm1haW5WaWV3LnNlbGVjdGVkUGllY2VQcm9wZXJ0eS5sYXp5TGluayggcGllY2UgPT4ge1xyXG4gICAgICB0aGlzLnNlbGVjdGVkUGllY2UgPSBwaWVjZTtcclxuICAgICAgdGhpcy5saW5rQ29udHJvbHMoKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBBbGwgY29udHJvbHMgYXJlIHBsYWNlZCBvbiBkaXNwbGF5IG5vZGUsIHdpdGggdmlzaWJpbGl0eSBzZXQgYnkgYWNjb3JkaW9uQm94IGJ1dHRvblxyXG5cclxuICB9Ly9lbmQgY29uc3RydWN0b3JcclxuXHJcbiAgLyoqXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge1R5cGV9IHR5cGVcclxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBnZXRJbmRleCggdHlwZSApIHtcclxuICAgIGxldCBpbmRleDtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHRoaXMudHlwZUFycmF5Lmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBpZiAoIHRoaXMuY29udHJvbFBhbmVsc1sgaSBdLnR5cGUgPT09IHR5cGUgKSB7XHJcbiAgICAgICAgaW5kZXggPSBpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaW5kZXg7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIGxpbmtDb250cm9scygpIHtcclxuICAgIGNvbnN0IHBpZWNlID0gdGhpcy5zZWxlY3RlZFBpZWNlO1xyXG4gICAgY29uc3QgY29udHJvbFBhbmVsID0gdGhpcy5jb250cm9sUGFuZWxzWyB0aGlzLmdldEluZGV4KCBwaWVjZS50eXBlICkgXTtcclxuXHJcbiAgICBjb25zdCByYXlzVXBkYXRlID0gbmJyT2ZSYXlzID0+IHtcclxuICAgICAgcGllY2UucGllY2VNb2RlbC5uYnJPZlJheXNQcm9wZXJ0eS52YWx1ZSA9IFV0aWxzLnJvdW5kU3ltbWV0cmljKCBuYnJPZlJheXMgKTtcclxuICAgIH07XHJcblxyXG4gICAgY29uc3Qgc3ByZWFkVXBkYXRlID0gc3ByZWFkID0+IHtcclxuICAgICAgcGllY2UucGllY2VNb2RlbC5zcHJlYWRQcm9wZXJ0eS52YWx1ZSA9IFV0aWxzLnJvdW5kU3ltbWV0cmljKCBzcHJlYWQgKTtcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgY29sb3JVcGRhdGUgPSBjb2xvclN0cmluZyA9PiB7XHJcbiAgICAgIHBpZWNlLmNvbG9yUHJvcGVydHkudmFsdWUgPSBjb2xvclN0cmluZztcclxuICAgIH07XHJcblxyXG4gICAgY29uc3Qgd2lkdGhVcGRhdGUgPSB3aWR0aCA9PiB7XHJcbiAgICAgIHBpZWNlLnBpZWNlTW9kZWwud2lkdGhQcm9wZXJ0eS52YWx1ZSA9IHdpZHRoO1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBkaWFtZXRlclVwZGF0ZSA9IGRpYW1ldGVyID0+IHtcclxuICAgICAgcGllY2UucGllY2VNb2RlbC5kaWFtZXRlclByb3BlcnR5LnZhbHVlID0gZGlhbWV0ZXI7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHJhZGl1c09mQ3VydmF0dXJlVXBkYXRlID0gcmFkaXVzID0+IHtcclxuICAgICAgcGllY2UucGllY2VNb2RlbC5yYWRpdXNQcm9wZXJ0eS52YWx1ZSA9IHJhZGl1cztcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgaW5kZXhPZlJlZnJhY3Rpb25VcGRhdGUgPSBpbmRleCA9PiB7XHJcbiAgICAgIHBpZWNlLnBpZWNlTW9kZWwuaW5kZXhQcm9wZXJ0eS52YWx1ZSA9IGluZGV4O1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBzaG93Rm9jYWxQb2ludHNVcGRhdGUgPSB0T3JGID0+IHtcclxuICAgICAgcGllY2Uuc2hvd0ZvY2FsUG9pbnRzUHJvcGVydHkudmFsdWUgPSB0T3JGO1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCB1bmxpbmtBbGwgPSAoKSA9PiB7XHJcbiAgICAgIGNvbnRyb2xQYW5lbC5uYnJPZlJheXNQcm9wZXJ0eS5oYXNMaXN0ZW5lciggdGhpcy5wcmV2aW91c1JheXNVcGRhdGUgKSAmJiBjb250cm9sUGFuZWwubmJyT2ZSYXlzUHJvcGVydHkudW5saW5rKCB0aGlzLnByZXZpb3VzUmF5c1VwZGF0ZSApO1xyXG4gICAgICBjb250cm9sUGFuZWwuc3ByZWFkUHJvcGVydHkuaGFzTGlzdGVuZXIoIHRoaXMucHJldmlvdXNTcHJlYWRVcGRhdGUgKSAmJiBjb250cm9sUGFuZWwuc3ByZWFkUHJvcGVydHkudW5saW5rKCB0aGlzLnByZXZpb3VzU3ByZWFkVXBkYXRlICk7XHJcbiAgICAgIGNvbnRyb2xQYW5lbC5jb2xvclByb3BlcnR5Lmhhc0xpc3RlbmVyKCB0aGlzLnByZXZpb3VzQ29sb3JVcGRhdGUgKSAmJiBjb250cm9sUGFuZWwuY29sb3JQcm9wZXJ0eS51bmxpbmsoIHRoaXMucHJldmlvdXNDb2xvclVwZGF0ZSApO1xyXG4gICAgICBjb250cm9sUGFuZWwud2lkdGhQcm9wZXJ0eS5oYXNMaXN0ZW5lciggdGhpcy5wcmV2aW91c1dpZHRoVXBkYXRlICkgJiYgY29udHJvbFBhbmVsLndpZHRoUHJvcGVydHkudW5saW5rKCB0aGlzLnByZXZpb3VzV2lkdGhVcGRhdGUgKTtcclxuICAgICAgY29udHJvbFBhbmVsLmRpYW1ldGVyUHJvcGVydHkuaGFzTGlzdGVuZXIoIHRoaXMucHJldmlvdXNEaWFtZXRlclVwZGF0ZSApICYmIGNvbnRyb2xQYW5lbC5kaWFtZXRlclByb3BlcnR5LnVubGluayggdGhpcy5wcmV2aW91c0RpYW1ldGVyVXBkYXRlICk7XHJcbiAgICAgIGNvbnRyb2xQYW5lbC5yYWRpdXNPZkN1cnZhdHVyZVByb3BlcnR5Lmhhc0xpc3RlbmVyKCB0aGlzLnByZXZpb3VzUmFkaXVzT2ZDdXJ2YXR1cmVVcGRhdGUgKSAmJiBjb250cm9sUGFuZWwucmFkaXVzT2ZDdXJ2YXR1cmVQcm9wZXJ0eS51bmxpbmsoIHRoaXMucHJldmlvdXNSYWRpdXNPZkN1cnZhdHVyZVVwZGF0ZSApO1xyXG4gICAgICBjb250cm9sUGFuZWwuaW5kZXhPZlJlZnJhY3Rpb25Qcm9wZXJ0eS5oYXNMaXN0ZW5lciggdGhpcy5wcmV2aW91c0luZGV4T2ZSZWZyYWN0aW9uVXBkYXRlICkgJiYgY29udHJvbFBhbmVsLmluZGV4T2ZSZWZyYWN0aW9uUHJvcGVydHkudW5saW5rKCB0aGlzLnByZXZpb3VzSW5kZXhPZlJlZnJhY3Rpb25VcGRhdGUgKTtcclxuICAgICAgY29udHJvbFBhbmVsLnNob3dGb2NhbFBvaW50c1Byb3BlcnR5Lmhhc0xpc3RlbmVyKCB0aGlzLnByZXZpb3VzU2hvd0ZvY2FsUG9pbnRzVXBkYXRlICkgJiYgY29udHJvbFBhbmVsLnNob3dGb2NhbFBvaW50c1Byb3BlcnR5LnVubGluayggdGhpcy5wcmV2aW91c1Nob3dGb2NhbFBvaW50c1VwZGF0ZSApO1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBzZXRBbGxQYW5lbHNBbmRMaW5rQWxsID0gKCkgPT4ge1xyXG4gICAgICBpZiAoIHBpZWNlLnBpZWNlTW9kZWwubmJyT2ZSYXlzUHJvcGVydHkgIT09IHVuZGVmaW5lZCApIHtcclxuICAgICAgICBjb250cm9sUGFuZWwubmJyT2ZSYXlzUHJvcGVydHkudmFsdWUgPSBwaWVjZS5waWVjZU1vZGVsLm5ick9mUmF5c1Byb3BlcnR5LnZhbHVlO1xyXG4gICAgICAgIGNvbnRyb2xQYW5lbC5uYnJPZlJheXNQcm9wZXJ0eS5saW5rKCByYXlzVXBkYXRlICk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCBwaWVjZS5waWVjZU1vZGVsLnNwcmVhZFByb3BlcnR5ICE9PSB1bmRlZmluZWQgKSB7XHJcbiAgICAgICAgY29udHJvbFBhbmVsLnNwcmVhZFByb3BlcnR5LnZhbHVlID0gcGllY2UucGllY2VNb2RlbC5zcHJlYWRQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb250cm9sUGFuZWwuc3ByZWFkUHJvcGVydHkubGluayggc3ByZWFkVXBkYXRlICk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCBwaWVjZS5jb2xvclByb3BlcnR5ICE9PSB1bmRlZmluZWQgKSB7XHJcbiAgICAgICAgY29udHJvbFBhbmVsLmNvbG9yUHJvcGVydHkudmFsdWUgPSBwaWVjZS5jb2xvclByb3BlcnR5LnZhbHVlO1xyXG4gICAgICAgIGNvbnRyb2xQYW5lbC5jb2xvclByb3BlcnR5LmxpbmsoIGNvbG9yVXBkYXRlICk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCBwaWVjZS5waWVjZU1vZGVsLndpZHRoUHJvcGVydHkgIT09IHVuZGVmaW5lZCApIHtcclxuICAgICAgICBjb250cm9sUGFuZWwud2lkdGhQcm9wZXJ0eS52YWx1ZSA9IHBpZWNlLnBpZWNlTW9kZWwud2lkdGhQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb250cm9sUGFuZWwud2lkdGhQcm9wZXJ0eS5saW5rKCB3aWR0aFVwZGF0ZSApO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICggcGllY2UucGllY2VNb2RlbC5kaWFtZXRlclByb3BlcnR5ICE9PSB1bmRlZmluZWQgJiZcclxuICAgICAgICAgICBwaWVjZS5waWVjZU1vZGVsLmRpYW1ldGVyUHJvcGVydHkudmFsdWUgIT09IHVuZGVmaW5lZCApIHtcclxuICAgICAgICBjb250cm9sUGFuZWwuZGlhbWV0ZXJQcm9wZXJ0eS52YWx1ZSA9IHBpZWNlLnBpZWNlTW9kZWwuZGlhbWV0ZXJQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb250cm9sUGFuZWwuZGlhbWV0ZXJQcm9wZXJ0eS5saW5rKCBkaWFtZXRlclVwZGF0ZSApO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICggcGllY2UucGllY2VNb2RlbC5yYWRpdXNQcm9wZXJ0eSAhPT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgcGllY2UucGllY2VNb2RlbC5yYWRpdXNQcm9wZXJ0eS52YWx1ZSAhPT0gdW5kZWZpbmVkICkge1xyXG4gICAgICAgIGNvbnRyb2xQYW5lbC5yYWRpdXNPZkN1cnZhdHVyZVByb3BlcnR5LnZhbHVlID0gcGllY2UucGllY2VNb2RlbC5yYWRpdXNQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb250cm9sUGFuZWwucmFkaXVzT2ZDdXJ2YXR1cmVQcm9wZXJ0eS5saW5rKCByYWRpdXNPZkN1cnZhdHVyZVVwZGF0ZSApO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICggcGllY2UucGllY2VNb2RlbC5pbmRleFByb3BlcnR5ICE9PSB1bmRlZmluZWQgJiZcclxuICAgICAgICAgICBwaWVjZS5waWVjZU1vZGVsLmluZGV4UHJvcGVydHkudmFsdWUgIT09IHVuZGVmaW5lZCApIHtcclxuICAgICAgICBjb250cm9sUGFuZWwuaW5kZXhPZlJlZnJhY3Rpb25Qcm9wZXJ0eS52YWx1ZSA9IHBpZWNlLnBpZWNlTW9kZWwuaW5kZXhQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb250cm9sUGFuZWwuaW5kZXhPZlJlZnJhY3Rpb25Qcm9wZXJ0eS5saW5rKCBpbmRleE9mUmVmcmFjdGlvblVwZGF0ZSApO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICggcGllY2Uuc2hvd0ZvY2FsUG9pbnRzUHJvcGVydHkgIT09IHVuZGVmaW5lZCApIHtcclxuICAgICAgICBjb250cm9sUGFuZWwuc2hvd0ZvY2FsUG9pbnRzUHJvcGVydHkudmFsdWUgPSBwaWVjZS5zaG93Rm9jYWxQb2ludHNQcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb250cm9sUGFuZWwuc2hvd0ZvY2FsUG9pbnRzUHJvcGVydHkubGluayggc2hvd0ZvY2FsUG9pbnRzVXBkYXRlICk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY29uc3Qgc2V0UHJldmlvdXNVcGRhdGVzID0gKCkgPT4ge1xyXG4gICAgICB0aGlzLnByZXZpb3VzUmF5c1VwZGF0ZSA9IHJheXNVcGRhdGU7XHJcbiAgICAgIHRoaXMucHJldmlvdXNTcHJlYWRVcGRhdGUgPSBzcHJlYWRVcGRhdGU7XHJcbiAgICAgIHRoaXMucHJldmlvdXNDb2xvclVwZGF0ZSA9IGNvbG9yVXBkYXRlO1xyXG4gICAgICB0aGlzLnByZXZpb3VzV2lkdGhVcGRhdGUgPSB3aWR0aFVwZGF0ZTtcclxuICAgICAgdGhpcy5wcmV2aW91c0RpYW1ldGVyVXBkYXRlID0gZGlhbWV0ZXJVcGRhdGU7XHJcbiAgICAgIHRoaXMucHJldmlvdXNSYWRpdXNPZkN1cnZhdHVyZVVwZGF0ZSA9IHJhZGl1c09mQ3VydmF0dXJlVXBkYXRlO1xyXG4gICAgICB0aGlzLnByZXZpb3VzSW5kZXhPZlJlZnJhY3Rpb25VcGRhdGUgPSBpbmRleE9mUmVmcmFjdGlvblVwZGF0ZTtcclxuICAgICAgdGhpcy5wcmV2aW91c1Nob3dGb2NhbFBvaW50c1VwZGF0ZSA9IHNob3dGb2NhbFBvaW50c1VwZGF0ZTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHVubGlua0FsbCgpO1xyXG4gICAgc2V0QWxsUGFuZWxzQW5kTGlua0FsbCgpO1xyXG4gICAgLy9saW5rQWxsKCk7XHJcbiAgICBzZXRQcmV2aW91c1VwZGF0ZXMoKTtcclxuXHJcbiAgfS8vZW5kIGxpbmtDb250cm9scygpXHJcblxyXG59XHJcblxyXG5vcHRpY3NMYWIucmVnaXN0ZXIoICdDb250cm9sUGFuZWxNYW5hZ2VyJywgQ29udHJvbFBhbmVsTWFuYWdlciApO1xyXG5leHBvcnQgZGVmYXVsdCBDb250cm9sUGFuZWxNYW5hZ2VyOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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