// Copyright 2015-2022, University of Colorado Boulder

/**
 * Control that shows a spectrum and lets the user choose the color for monochromatic light.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import Property from '../../../../axon/js/Property.js';
import Bounds2 from '../../../../dot/js/Bounds2.js';
import Utils from '../../../../dot/js/Utils.js';
import StringUtils from '../../../../phetcommon/js/util/StringUtils.js';
import WavelengthSlider from '../../../../scenery-phet/js/WavelengthSlider.js';
import { Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import ArrowButton from '../../../../sun/js/buttons/ArrowButton.js';
import BendingLightStrings from '../../BendingLightStrings.js';
import bendingLight from '../../bendingLight.js';
import BendingLightConstants from '../BendingLightConstants.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
const unitsNmStringProperty = BendingLightStrings.units_nmStringProperty;
const wavelengthPatternStringProperty = BendingLightStrings.wavelengthPatternStringProperty;

// constants
const PLUS_MINUS_SPACING = 4;
class WavelengthControl extends Node {
  constructor(wavelengthProperty, enabledProperty, trackWidth) {
    const wavelengthPropertyNMProperty = new Property(wavelengthProperty.value * 1E9, {
      // See https://github.com/phetsims/bending-light/issues/378
      reentrant: true
    });
    wavelengthProperty.link(wavelength => {
      wavelengthPropertyNMProperty.value = wavelength * 1E9;
    });
    // Add WavelengthSlider node
    const wavelengthSlider = new WavelengthSlider(wavelengthPropertyNMProperty, {
      cursorStroke: 'white',
      maxWavelength: BendingLightConstants.LASER_MAX_WAVELENGTH,
      thumbWidth: 20,
      thumbHeight: 20,
      trackWidth: trackWidth,
      trackHeight: 20,
      tweakersVisible: false,
      valueVisible: false,
      thumbTouchAreaYDilation: 4
    });
    const formattedStringProperty = new DerivedProperty([wavelengthPatternStringProperty, wavelengthPropertyNMProperty], (wavelengthPatternString, wavelength) => StringUtils.format(wavelengthPatternStringProperty.value, Utils.roundSymmetric(wavelengthPropertyNMProperty.value)));

    // Prevent the i18n strings from making the wavelength slider too wide, see #311
    const maxWidth = 50;
    const wavelengthValueText = new Text(formattedStringProperty, {
      maxWidth: maxWidth
    });
    const wavelengthBoxShape = new Rectangle(0, 0, new Text(unitsNmStringProperty, {
      maxWidth: maxWidth
    }).width + 36, 18, 2, 2, {
      fill: 'white',
      stroke: 'black'
    });

    // add plus button
    const plusButton = new ArrowButton('right', () => {
      wavelengthPropertyNMProperty.set(Math.min(wavelengthPropertyNMProperty.value + 1, BendingLightConstants.LASER_MAX_WAVELENGTH));
    }, {
      scale: 0.6
    });

    // touch area
    plusButton.touchArea = new Bounds2(plusButton.localBounds.minX - 20, plusButton.localBounds.minY - 5, plusButton.localBounds.maxX + 20, plusButton.localBounds.maxY + 8);

    // add minus button
    const minusButton = new ArrowButton('left', () => {
      wavelengthPropertyNMProperty.set(Math.max(wavelengthPropertyNMProperty.value - 1, BendingLightConstants.LASER_MIN_WAVELENGTH));
    }, {
      scale: 0.6
    });

    // disable the minus button at minimum wavelength and plus button at max wavelength
    wavelengthPropertyNMProperty.link(wavelength => {
      plusButton.enabled = wavelength < BendingLightConstants.LASER_MAX_WAVELENGTH;
      minusButton.enabled = wavelength > BendingLightConstants.LASER_MIN_WAVELENGTH;
    });

    // touch area
    minusButton.touchArea = new Bounds2(minusButton.localBounds.minX - 20, minusButton.localBounds.minY - 5, minusButton.localBounds.maxX + 20, minusButton.localBounds.maxY + 8);

    // set the position of the wavelength text box
    wavelengthBoxShape.centerX = wavelengthSlider.centerX;
    wavelengthBoxShape.bottom = wavelengthSlider.top - 5;

    // set the position of the wavelength value in the center of text box
    wavelengthValueText.centerX = wavelengthBoxShape.centerX;
    wavelengthValueText.centerY = wavelengthBoxShape.centerY;

    // Plus button to the right of the value
    plusButton.left = wavelengthBoxShape.right + PLUS_MINUS_SPACING;
    plusButton.centerY = wavelengthBoxShape.centerY;

    // Minus button to the left of the value
    minusButton.right = wavelengthBoxShape.left - PLUS_MINUS_SPACING;
    minusButton.centerY = wavelengthBoxShape.centerY;
    super({
      children: [minusButton, wavelengthBoxShape, wavelengthValueText, plusButton, wavelengthSlider]
    });
    enabledProperty.link(enabled => {
      // set the opacity when not selected
      this.setPickable(enabled);
      this.opacity = enabled ? 1 : 0.4;
    });
    wavelengthPropertyNMProperty.link(wavelength => {
      // set the laser wavelength according to the slider wavelength
      wavelengthProperty.set(wavelength / 1E9);
    });
  }
}
bendingLight.register('WavelengthControl', WavelengthControl);
export default WavelengthControl;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIkJvdW5kczIiLCJVdGlscyIsIlN0cmluZ1V0aWxzIiwiV2F2ZWxlbmd0aFNsaWRlciIsIk5vZGUiLCJSZWN0YW5nbGUiLCJUZXh0IiwiQXJyb3dCdXR0b24iLCJCZW5kaW5nTGlnaHRTdHJpbmdzIiwiYmVuZGluZ0xpZ2h0IiwiQmVuZGluZ0xpZ2h0Q29uc3RhbnRzIiwiRGVyaXZlZFByb3BlcnR5IiwidW5pdHNObVN0cmluZ1Byb3BlcnR5IiwidW5pdHNfbm1TdHJpbmdQcm9wZXJ0eSIsIndhdmVsZW5ndGhQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJQTFVTX01JTlVTX1NQQUNJTkciLCJXYXZlbGVuZ3RoQ29udHJvbCIsImNvbnN0cnVjdG9yIiwid2F2ZWxlbmd0aFByb3BlcnR5IiwiZW5hYmxlZFByb3BlcnR5IiwidHJhY2tXaWR0aCIsIndhdmVsZW5ndGhQcm9wZXJ0eU5NUHJvcGVydHkiLCJ2YWx1ZSIsInJlZW50cmFudCIsImxpbmsiLCJ3YXZlbGVuZ3RoIiwid2F2ZWxlbmd0aFNsaWRlciIsImN1cnNvclN0cm9rZSIsIm1heFdhdmVsZW5ndGgiLCJMQVNFUl9NQVhfV0FWRUxFTkdUSCIsInRodW1iV2lkdGgiLCJ0aHVtYkhlaWdodCIsInRyYWNrSGVpZ2h0IiwidHdlYWtlcnNWaXNpYmxlIiwidmFsdWVWaXNpYmxlIiwidGh1bWJUb3VjaEFyZWFZRGlsYXRpb24iLCJmb3JtYXR0ZWRTdHJpbmdQcm9wZXJ0eSIsIndhdmVsZW5ndGhQYXR0ZXJuU3RyaW5nIiwiZm9ybWF0Iiwicm91bmRTeW1tZXRyaWMiLCJtYXhXaWR0aCIsIndhdmVsZW5ndGhWYWx1ZVRleHQiLCJ3YXZlbGVuZ3RoQm94U2hhcGUiLCJ3aWR0aCIsImZpbGwiLCJzdHJva2UiLCJwbHVzQnV0dG9uIiwic2V0IiwiTWF0aCIsIm1pbiIsInNjYWxlIiwidG91Y2hBcmVhIiwibG9jYWxCb3VuZHMiLCJtaW5YIiwibWluWSIsIm1heFgiLCJtYXhZIiwibWludXNCdXR0b24iLCJtYXgiLCJMQVNFUl9NSU5fV0FWRUxFTkdUSCIsImVuYWJsZWQiLCJjZW50ZXJYIiwiYm90dG9tIiwidG9wIiwiY2VudGVyWSIsImxlZnQiLCJyaWdodCIsImNoaWxkcmVuIiwic2V0UGlja2FibGUiLCJvcGFjaXR5IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJXYXZlbGVuZ3RoQ29udHJvbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNS0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBDb250cm9sIHRoYXQgc2hvd3MgYSBzcGVjdHJ1bSBhbmQgbGV0cyB0aGUgdXNlciBjaG9vc2UgdGhlIGNvbG9yIGZvciBtb25vY2hyb21hdGljIGxpZ2h0LlxyXG4gKlxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1V0aWxzLmpzJztcclxuaW1wb3J0IFN0cmluZ1V0aWxzIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdXRpbC9TdHJpbmdVdGlscy5qcyc7XHJcbmltcG9ydCBXYXZlbGVuZ3RoU2xpZGVyIGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9XYXZlbGVuZ3RoU2xpZGVyLmpzJztcclxuaW1wb3J0IHsgTm9kZSwgUmVjdGFuZ2xlLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEFycm93QnV0dG9uIGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9idXR0b25zL0Fycm93QnV0dG9uLmpzJztcclxuaW1wb3J0IEJlbmRpbmdMaWdodFN0cmluZ3MgZnJvbSAnLi4vLi4vQmVuZGluZ0xpZ2h0U3RyaW5ncy5qcyc7XHJcbmltcG9ydCBiZW5kaW5nTGlnaHQgZnJvbSAnLi4vLi4vYmVuZGluZ0xpZ2h0LmpzJztcclxuaW1wb3J0IEJlbmRpbmdMaWdodENvbnN0YW50cyBmcm9tICcuLi9CZW5kaW5nTGlnaHRDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuXHJcbmNvbnN0IHVuaXRzTm1TdHJpbmdQcm9wZXJ0eSA9IEJlbmRpbmdMaWdodFN0cmluZ3MudW5pdHNfbm1TdHJpbmdQcm9wZXJ0eTtcclxuY29uc3Qgd2F2ZWxlbmd0aFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSA9IEJlbmRpbmdMaWdodFN0cmluZ3Mud2F2ZWxlbmd0aFBhdHRlcm5TdHJpbmdQcm9wZXJ0eTtcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBQTFVTX01JTlVTX1NQQUNJTkcgPSA0O1xyXG5cclxuY2xhc3MgV2F2ZWxlbmd0aENvbnRyb2wgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCB3YXZlbGVuZ3RoUHJvcGVydHk6IFByb3BlcnR5PG51bWJlcj4sIGVuYWJsZWRQcm9wZXJ0eTogUHJvcGVydHk8Ym9vbGVhbj4sIHRyYWNrV2lkdGg6IG51bWJlciApIHtcclxuICAgIGNvbnN0IHdhdmVsZW5ndGhQcm9wZXJ0eU5NUHJvcGVydHkgPSBuZXcgUHJvcGVydHk8bnVtYmVyPiggd2F2ZWxlbmd0aFByb3BlcnR5LnZhbHVlICogMUU5LCB7XHJcblxyXG4gICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2JlbmRpbmctbGlnaHQvaXNzdWVzLzM3OFxyXG4gICAgICByZWVudHJhbnQ6IHRydWVcclxuICAgIH0gKTtcclxuXHJcbiAgICB3YXZlbGVuZ3RoUHJvcGVydHkubGluayggd2F2ZWxlbmd0aCA9PiB7XHJcbiAgICAgIHdhdmVsZW5ndGhQcm9wZXJ0eU5NUHJvcGVydHkudmFsdWUgPSB3YXZlbGVuZ3RoICogMUU5O1xyXG4gICAgfSApO1xyXG4gICAgLy8gQWRkIFdhdmVsZW5ndGhTbGlkZXIgbm9kZVxyXG4gICAgY29uc3Qgd2F2ZWxlbmd0aFNsaWRlciA9IG5ldyBXYXZlbGVuZ3RoU2xpZGVyKCB3YXZlbGVuZ3RoUHJvcGVydHlOTVByb3BlcnR5LCB7XHJcbiAgICAgIGN1cnNvclN0cm9rZTogJ3doaXRlJyxcclxuICAgICAgbWF4V2F2ZWxlbmd0aDogQmVuZGluZ0xpZ2h0Q29uc3RhbnRzLkxBU0VSX01BWF9XQVZFTEVOR1RILFxyXG4gICAgICB0aHVtYldpZHRoOiAyMCxcclxuICAgICAgdGh1bWJIZWlnaHQ6IDIwLFxyXG4gICAgICB0cmFja1dpZHRoOiB0cmFja1dpZHRoLFxyXG4gICAgICB0cmFja0hlaWdodDogMjAsXHJcbiAgICAgIHR3ZWFrZXJzVmlzaWJsZTogZmFsc2UsXHJcbiAgICAgIHZhbHVlVmlzaWJsZTogZmFsc2UsXHJcbiAgICAgIHRodW1iVG91Y2hBcmVhWURpbGF0aW9uOiA0XHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgZm9ybWF0dGVkU3RyaW5nUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHdhdmVsZW5ndGhQYXR0ZXJuU3RyaW5nUHJvcGVydHksIHdhdmVsZW5ndGhQcm9wZXJ0eU5NUHJvcGVydHkgXSxcclxuICAgICAgKCB3YXZlbGVuZ3RoUGF0dGVyblN0cmluZywgd2F2ZWxlbmd0aCApID0+IFN0cmluZ1V0aWxzLmZvcm1hdCggd2F2ZWxlbmd0aFBhdHRlcm5TdHJpbmdQcm9wZXJ0eS52YWx1ZSwgVXRpbHMucm91bmRTeW1tZXRyaWMoIHdhdmVsZW5ndGhQcm9wZXJ0eU5NUHJvcGVydHkudmFsdWUgKSApICk7XHJcblxyXG4gICAgLy8gUHJldmVudCB0aGUgaTE4biBzdHJpbmdzIGZyb20gbWFraW5nIHRoZSB3YXZlbGVuZ3RoIHNsaWRlciB0b28gd2lkZSwgc2VlICMzMTFcclxuICAgIGNvbnN0IG1heFdpZHRoID0gNTA7XHJcbiAgICBjb25zdCB3YXZlbGVuZ3RoVmFsdWVUZXh0ID0gbmV3IFRleHQoIGZvcm1hdHRlZFN0cmluZ1Byb3BlcnR5LCB7IG1heFdpZHRoOiBtYXhXaWR0aCB9ICk7XHJcbiAgICBjb25zdCB3YXZlbGVuZ3RoQm94U2hhcGUgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCBuZXcgVGV4dCggdW5pdHNObVN0cmluZ1Byb3BlcnR5LCB7IG1heFdpZHRoOiBtYXhXaWR0aCB9ICkud2lkdGggKyAzNiwgMTgsIDIsIDIsIHtcclxuICAgICAgZmlsbDogJ3doaXRlJyxcclxuICAgICAgc3Ryb2tlOiAnYmxhY2snXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gYWRkIHBsdXMgYnV0dG9uXHJcbiAgICBjb25zdCBwbHVzQnV0dG9uID0gbmV3IEFycm93QnV0dG9uKCAncmlnaHQnLCAoKSA9PiB7XHJcbiAgICAgIHdhdmVsZW5ndGhQcm9wZXJ0eU5NUHJvcGVydHkuc2V0KFxyXG4gICAgICAgIE1hdGgubWluKCB3YXZlbGVuZ3RoUHJvcGVydHlOTVByb3BlcnR5LnZhbHVlICsgMSwgQmVuZGluZ0xpZ2h0Q29uc3RhbnRzLkxBU0VSX01BWF9XQVZFTEVOR1RIICkgKTtcclxuICAgIH0sIHtcclxuICAgICAgc2NhbGU6IDAuNlxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHRvdWNoIGFyZWFcclxuICAgIHBsdXNCdXR0b24udG91Y2hBcmVhID0gbmV3IEJvdW5kczIoIHBsdXNCdXR0b24ubG9jYWxCb3VuZHMubWluWCAtIDIwLCBwbHVzQnV0dG9uLmxvY2FsQm91bmRzLm1pblkgLSA1LFxyXG4gICAgICBwbHVzQnV0dG9uLmxvY2FsQm91bmRzLm1heFggKyAyMCwgcGx1c0J1dHRvbi5sb2NhbEJvdW5kcy5tYXhZICsgOCApO1xyXG5cclxuICAgIC8vIGFkZCBtaW51cyBidXR0b25cclxuICAgIGNvbnN0IG1pbnVzQnV0dG9uID0gbmV3IEFycm93QnV0dG9uKCAnbGVmdCcsICgpID0+IHtcclxuICAgICAgd2F2ZWxlbmd0aFByb3BlcnR5Tk1Qcm9wZXJ0eS5zZXQoXHJcbiAgICAgICAgTWF0aC5tYXgoIHdhdmVsZW5ndGhQcm9wZXJ0eU5NUHJvcGVydHkudmFsdWUgLSAxLCBCZW5kaW5nTGlnaHRDb25zdGFudHMuTEFTRVJfTUlOX1dBVkVMRU5HVEggKSApO1xyXG4gICAgfSwge1xyXG4gICAgICBzY2FsZTogMC42XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gZGlzYWJsZSB0aGUgbWludXMgYnV0dG9uIGF0IG1pbmltdW0gd2F2ZWxlbmd0aCBhbmQgcGx1cyBidXR0b24gYXQgbWF4IHdhdmVsZW5ndGhcclxuICAgIHdhdmVsZW5ndGhQcm9wZXJ0eU5NUHJvcGVydHkubGluayggd2F2ZWxlbmd0aCA9PiB7XHJcbiAgICAgIHBsdXNCdXR0b24uZW5hYmxlZCA9ICggd2F2ZWxlbmd0aCA8IEJlbmRpbmdMaWdodENvbnN0YW50cy5MQVNFUl9NQVhfV0FWRUxFTkdUSCApO1xyXG4gICAgICBtaW51c0J1dHRvbi5lbmFibGVkID0gKCB3YXZlbGVuZ3RoID4gQmVuZGluZ0xpZ2h0Q29uc3RhbnRzLkxBU0VSX01JTl9XQVZFTEVOR1RIICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gdG91Y2ggYXJlYVxyXG4gICAgbWludXNCdXR0b24udG91Y2hBcmVhID0gbmV3IEJvdW5kczIoIG1pbnVzQnV0dG9uLmxvY2FsQm91bmRzLm1pblggLSAyMCwgbWludXNCdXR0b24ubG9jYWxCb3VuZHMubWluWSAtIDUsXHJcbiAgICAgIG1pbnVzQnV0dG9uLmxvY2FsQm91bmRzLm1heFggKyAyMCwgbWludXNCdXR0b24ubG9jYWxCb3VuZHMubWF4WSArIDggKTtcclxuXHJcbiAgICAvLyBzZXQgdGhlIHBvc2l0aW9uIG9mIHRoZSB3YXZlbGVuZ3RoIHRleHQgYm94XHJcbiAgICB3YXZlbGVuZ3RoQm94U2hhcGUuY2VudGVyWCA9IHdhdmVsZW5ndGhTbGlkZXIuY2VudGVyWDtcclxuICAgIHdhdmVsZW5ndGhCb3hTaGFwZS5ib3R0b20gPSB3YXZlbGVuZ3RoU2xpZGVyLnRvcCAtIDU7XHJcblxyXG4gICAgLy8gc2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgd2F2ZWxlbmd0aCB2YWx1ZSBpbiB0aGUgY2VudGVyIG9mIHRleHQgYm94XHJcbiAgICB3YXZlbGVuZ3RoVmFsdWVUZXh0LmNlbnRlclggPSB3YXZlbGVuZ3RoQm94U2hhcGUuY2VudGVyWDtcclxuICAgIHdhdmVsZW5ndGhWYWx1ZVRleHQuY2VudGVyWSA9IHdhdmVsZW5ndGhCb3hTaGFwZS5jZW50ZXJZO1xyXG5cclxuICAgIC8vIFBsdXMgYnV0dG9uIHRvIHRoZSByaWdodCBvZiB0aGUgdmFsdWVcclxuICAgIHBsdXNCdXR0b24ubGVmdCA9IHdhdmVsZW5ndGhCb3hTaGFwZS5yaWdodCArIFBMVVNfTUlOVVNfU1BBQ0lORztcclxuICAgIHBsdXNCdXR0b24uY2VudGVyWSA9IHdhdmVsZW5ndGhCb3hTaGFwZS5jZW50ZXJZO1xyXG5cclxuICAgIC8vIE1pbnVzIGJ1dHRvbiB0byB0aGUgbGVmdCBvZiB0aGUgdmFsdWVcclxuICAgIG1pbnVzQnV0dG9uLnJpZ2h0ID0gd2F2ZWxlbmd0aEJveFNoYXBlLmxlZnQgLSBQTFVTX01JTlVTX1NQQUNJTkc7XHJcbiAgICBtaW51c0J1dHRvbi5jZW50ZXJZID0gd2F2ZWxlbmd0aEJveFNoYXBlLmNlbnRlclk7XHJcblxyXG4gICAgc3VwZXIoIHtcclxuICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICBtaW51c0J1dHRvbixcclxuICAgICAgICB3YXZlbGVuZ3RoQm94U2hhcGUsXHJcbiAgICAgICAgd2F2ZWxlbmd0aFZhbHVlVGV4dCxcclxuICAgICAgICBwbHVzQnV0dG9uLFxyXG4gICAgICAgIHdhdmVsZW5ndGhTbGlkZXJcclxuICAgICAgXVxyXG4gICAgfSApO1xyXG4gICAgZW5hYmxlZFByb3BlcnR5LmxpbmsoIGVuYWJsZWQgPT4ge1xyXG5cclxuICAgICAgLy8gc2V0IHRoZSBvcGFjaXR5IHdoZW4gbm90IHNlbGVjdGVkXHJcbiAgICAgIHRoaXMuc2V0UGlja2FibGUoIGVuYWJsZWQgKTtcclxuICAgICAgdGhpcy5vcGFjaXR5ID0gZW5hYmxlZCA/IDEgOiAwLjQ7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgd2F2ZWxlbmd0aFByb3BlcnR5Tk1Qcm9wZXJ0eS5saW5rKCB3YXZlbGVuZ3RoID0+IHtcclxuXHJcbiAgICAgIC8vIHNldCB0aGUgbGFzZXIgd2F2ZWxlbmd0aCBhY2NvcmRpbmcgdG8gdGhlIHNsaWRlciB3YXZlbGVuZ3RoXHJcbiAgICAgIHdhdmVsZW5ndGhQcm9wZXJ0eS5zZXQoIHdhdmVsZW5ndGggLyAxRTkgKTtcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbmJlbmRpbmdMaWdodC5yZWdpc3RlciggJ1dhdmVsZW5ndGhDb250cm9sJywgV2F2ZWxlbmd0aENvbnRyb2wgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFdhdmVsZW5ndGhDb250cm9sOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxRQUFRLE1BQU0saUNBQWlDO0FBQ3RELE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxXQUFXLE1BQU0sK0NBQStDO0FBQ3ZFLE9BQU9DLGdCQUFnQixNQUFNLGlEQUFpRDtBQUM5RSxTQUFTQyxJQUFJLEVBQUVDLFNBQVMsRUFBRUMsSUFBSSxRQUFRLG1DQUFtQztBQUN6RSxPQUFPQyxXQUFXLE1BQU0sMkNBQTJDO0FBQ25FLE9BQU9DLG1CQUFtQixNQUFNLDhCQUE4QjtBQUM5RCxPQUFPQyxZQUFZLE1BQU0sdUJBQXVCO0FBQ2hELE9BQU9DLHFCQUFxQixNQUFNLDZCQUE2QjtBQUMvRCxPQUFPQyxlQUFlLE1BQU0sd0NBQXdDO0FBRXBFLE1BQU1DLHFCQUFxQixHQUFH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