// Copyright 2020-2023, University of Colorado Boulder

/**
 * The DogNode is a ResistorNode that barks
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import SoundClip from '../../../tambo/js/sound-generators/SoundClip.js';
import soundManager from '../../../tambo/js/soundManager.js';
import dogBark_mp3 from '../../sounds/dogBark_mp3.js';
import circuitConstructionKitCommon from '../circuitConstructionKitCommon.js';
import BarkNode from './BarkNode.js';
import ResistorNode from './ResistorNode.js';
export default class DogNode extends ResistorNode {
  /**
   * @param screenView - main screen view, null for isIcon
   * @param circuitNode, null for isIcon
   * @param dog
   * @param viewTypeProperty
   * @param tandem
   * @param [providedOptions]
   */
  constructor(screenView, circuitNode, dog, viewTypeProperty, tandem, providedOptions) {
    super(screenView, circuitNode, dog, viewTypeProperty, tandem, providedOptions);
    const soundClip = new SoundClip(dogBark_mp3);
    soundManager.addSoundGenerator(soundClip);
    this.barkNode = new BarkNode({
      maxWidth: 60
    });
    this.addChild(this.barkNode);
    const positionBark = () => {
      if (dog.isBarkingProperty.value) {
        const startPosition = this.circuitElement.startVertexProperty.value.positionProperty.value;
        const endPosition = this.circuitElement.endVertexProperty.value.positionProperty.value;
        const angle = endPosition.minus(startPosition).getAngle();
        const unitVector = endPosition.minus(startPosition).normalized();
        const normalVector = unitVector.getPerpendicular();
        const translation = startPosition.plus(normalVector.timesScalar(100)).plus(unitVector.timesScalar(12));
        this.barkNode.setRotation(angle);
        this.barkNode.setTranslation(translation);
      }
    };
    this.boundsListener = () => positionBark();
    this.contentNode.boundsProperty.link(this.boundsListener);
    this.dog = dog;
    this.isBarkingListener = isBarking => {
      // Position next to the dog's mouth
      positionBark();
      this.barkNode.visible = isBarking;
      isBarking && soundClip.play();
    };
    dog.isBarkingProperty.link(this.isBarkingListener);
  }
  dispose() {
    super.dispose();
    this.dog.isBarkingProperty.unlink(this.isBarkingListener);
    this.contentNode.boundsProperty.unlink(this.boundsListener);
  }
}
circuitConstructionKitCommon.register('DogNode', DogNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTb3VuZENsaXAiLCJzb3VuZE1hbmFnZXIiLCJkb2dCYXJrX21wMyIsImNpcmN1aXRDb25zdHJ1Y3Rpb25LaXRDb21tb24iLCJCYXJrTm9kZSIsIlJlc2lzdG9yTm9kZSIsIkRvZ05vZGUiLCJjb25zdHJ1Y3RvciIsInNjcmVlblZpZXciLCJjaXJjdWl0Tm9kZSIsImRvZyIsInZpZXdUeXBlUHJvcGVydHkiLCJ0YW5kZW0iLCJwcm92aWRlZE9wdGlvbnMiLCJzb3VuZENsaXAiLCJhZGRTb3VuZEdlbmVyYXRvciIsImJhcmtOb2RlIiwibWF4V2lkdGgiLCJhZGRDaGlsZCIsInBvc2l0aW9uQmFyayIsImlzQmFya2luZ1Byb3BlcnR5IiwidmFsdWUiLCJzdGFydFBvc2l0aW9uIiwiY2lyY3VpdEVsZW1lbnQiLCJzdGFydFZlcnRleFByb3BlcnR5IiwicG9zaXRpb25Qcm9wZXJ0eSIsImVuZFBvc2l0aW9uIiwiZW5kVmVydGV4UHJvcGVydHkiLCJhbmdsZSIsIm1pbnVzIiwiZ2V0QW5nbGUiLCJ1bml0VmVjdG9yIiwibm9ybWFsaXplZCIsIm5vcm1hbFZlY3RvciIsImdldFBlcnBlbmRpY3VsYXIiLCJ0cmFuc2xhdGlvbiIsInBsdXMiLCJ0aW1lc1NjYWxhciIsInNldFJvdGF0aW9uIiwic2V0VHJhbnNsYXRpb24iLCJib3VuZHNMaXN0ZW5lciIsImNvbnRlbnROb2RlIiwiYm91bmRzUHJvcGVydHkiLCJsaW5rIiwiaXNCYXJraW5nTGlzdGVuZXIiLCJpc0JhcmtpbmciLCJ2aXNpYmxlIiwicGxheSIsImRpc3Bvc2UiLCJ1bmxpbmsiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkRvZ05vZGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjAtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogVGhlIERvZ05vZGUgaXMgYSBSZXNpc3Rvck5vZGUgdGhhdCBiYXJrc1xyXG4gKlxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFNvdW5kQ2xpcCBmcm9tICcuLi8uLi8uLi90YW1iby9qcy9zb3VuZC1nZW5lcmF0b3JzL1NvdW5kQ2xpcC5qcyc7XHJcbmltcG9ydCBzb3VuZE1hbmFnZXIgZnJvbSAnLi4vLi4vLi4vdGFtYm8vanMvc291bmRNYW5hZ2VyLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IGRvZ0JhcmtfbXAzIGZyb20gJy4uLy4uL3NvdW5kcy9kb2dCYXJrX21wMy5qcyc7XHJcbmltcG9ydCBjaXJjdWl0Q29uc3RydWN0aW9uS2l0Q29tbW9uIGZyb20gJy4uL2NpcmN1aXRDb25zdHJ1Y3Rpb25LaXRDb21tb24uanMnO1xyXG5pbXBvcnQgQ2lyY3VpdEVsZW1lbnRWaWV3VHlwZSBmcm9tICcuLi9tb2RlbC9DaXJjdWl0RWxlbWVudFZpZXdUeXBlLmpzJztcclxuaW1wb3J0IEJhcmtOb2RlIGZyb20gJy4vQmFya05vZGUuanMnO1xyXG5pbXBvcnQgQ0NLQ1NjcmVlblZpZXcgZnJvbSAnLi9DQ0tDU2NyZWVuVmlldy5qcyc7XHJcbmltcG9ydCBDaXJjdWl0Tm9kZSBmcm9tICcuL0NpcmN1aXROb2RlLmpzJztcclxuaW1wb3J0IFJlc2lzdG9yTm9kZSBmcm9tICcuL1Jlc2lzdG9yTm9kZS5qcyc7XHJcbmltcG9ydCBEb2cgZnJvbSAnLi4vbW9kZWwvRG9nLmpzJztcclxuaW1wb3J0IHsgRml4ZWRDaXJjdWl0RWxlbWVudE5vZGVPcHRpb25zIH0gZnJvbSAnLi9GaXhlZENpcmN1aXRFbGVtZW50Tm9kZS5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEb2dOb2RlIGV4dGVuZHMgUmVzaXN0b3JOb2RlIHtcclxuICBwcml2YXRlIHJlYWRvbmx5IGJhcmtOb2RlOiBCYXJrTm9kZTtcclxuICBwcml2YXRlIHJlYWRvbmx5IGlzQmFya2luZ0xpc3RlbmVyOiAoIGlzQmFya2luZzogYm9vbGVhbiApID0+IHZvaWQ7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBkb2c6IERvZztcclxuICBwcml2YXRlIHJlYWRvbmx5IGJvdW5kc0xpc3RlbmVyOiAoKSA9PiB2b2lkO1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0gc2NyZWVuVmlldyAtIG1haW4gc2NyZWVuIHZpZXcsIG51bGwgZm9yIGlzSWNvblxyXG4gICAqIEBwYXJhbSBjaXJjdWl0Tm9kZSwgbnVsbCBmb3IgaXNJY29uXHJcbiAgICogQHBhcmFtIGRvZ1xyXG4gICAqIEBwYXJhbSB2aWV3VHlwZVByb3BlcnR5XHJcbiAgICogQHBhcmFtIHRhbmRlbVxyXG4gICAqIEBwYXJhbSBbcHJvdmlkZWRPcHRpb25zXVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggc2NyZWVuVmlldzogQ0NLQ1NjcmVlblZpZXcgfCBudWxsLCBjaXJjdWl0Tm9kZTogQ2lyY3VpdE5vZGUgfCBudWxsLCBkb2c6IERvZyxcclxuICAgICAgICAgICAgICAgICAgICAgIHZpZXdUeXBlUHJvcGVydHk6IFByb3BlcnR5PENpcmN1aXRFbGVtZW50Vmlld1R5cGU+LCB0YW5kZW06IFRhbmRlbSwgcHJvdmlkZWRPcHRpb25zPzogRml4ZWRDaXJjdWl0RWxlbWVudE5vZGVPcHRpb25zICkge1xyXG4gICAgc3VwZXIoIHNjcmVlblZpZXcsIGNpcmN1aXROb2RlLCBkb2csIHZpZXdUeXBlUHJvcGVydHksIHRhbmRlbSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgY29uc3Qgc291bmRDbGlwID0gbmV3IFNvdW5kQ2xpcCggZG9nQmFya19tcDMgKTtcclxuICAgIHNvdW5kTWFuYWdlci5hZGRTb3VuZEdlbmVyYXRvciggc291bmRDbGlwICk7XHJcblxyXG4gICAgdGhpcy5iYXJrTm9kZSA9IG5ldyBCYXJrTm9kZSgge1xyXG4gICAgICBtYXhXaWR0aDogNjBcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMuYmFya05vZGUgKTtcclxuXHJcbiAgICBjb25zdCBwb3NpdGlvbkJhcmsgPSAoKSA9PiB7XHJcbiAgICAgIGlmICggZG9nLmlzQmFya2luZ1Byb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0UG9zaXRpb24gPSB0aGlzLmNpcmN1aXRFbGVtZW50LnN0YXJ0VmVydGV4UHJvcGVydHkudmFsdWUucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb25zdCBlbmRQb3NpdGlvbiA9IHRoaXMuY2lyY3VpdEVsZW1lbnQuZW5kVmVydGV4UHJvcGVydHkudmFsdWUucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBjb25zdCBhbmdsZSA9IGVuZFBvc2l0aW9uLm1pbnVzKCBzdGFydFBvc2l0aW9uICkuZ2V0QW5nbGUoKTtcclxuICAgICAgICBjb25zdCB1bml0VmVjdG9yID0gZW5kUG9zaXRpb24ubWludXMoIHN0YXJ0UG9zaXRpb24gKS5ub3JtYWxpemVkKCk7XHJcbiAgICAgICAgY29uc3Qgbm9ybWFsVmVjdG9yID0gdW5pdFZlY3Rvci5nZXRQZXJwZW5kaWN1bGFyKCk7XHJcbiAgICAgICAgY29uc3QgdHJhbnNsYXRpb24gPSBzdGFydFBvc2l0aW9uLnBsdXMoIG5vcm1hbFZlY3Rvci50aW1lc1NjYWxhciggMTAwICkgKS5wbHVzKCB1bml0VmVjdG9yLnRpbWVzU2NhbGFyKCAxMiApICk7XHJcblxyXG4gICAgICAgIHRoaXMuYmFya05vZGUuc2V0Um90YXRpb24oIGFuZ2xlICk7XHJcbiAgICAgICAgdGhpcy5iYXJrTm9kZS5zZXRUcmFuc2xhdGlvbiggdHJhbnNsYXRpb24gKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmJvdW5kc0xpc3RlbmVyID0gKCkgPT4gcG9zaXRpb25CYXJrKCk7XHJcbiAgICB0aGlzLmNvbnRlbnROb2RlLmJvdW5kc1Byb3BlcnR5LmxpbmsoIHRoaXMuYm91bmRzTGlzdGVuZXIgKTtcclxuXHJcbiAgICB0aGlzLmRvZyA9IGRvZztcclxuICAgIHRoaXMuaXNCYXJraW5nTGlzdGVuZXIgPSBpc0JhcmtpbmcgPT4ge1xyXG5cclxuICAgICAgLy8gUG9zaXRpb24gbmV4dCB0byB0aGUgZG9nJ3MgbW91dGhcclxuICAgICAgcG9zaXRpb25CYXJrKCk7XHJcblxyXG4gICAgICB0aGlzLmJhcmtOb2RlLnZpc2libGUgPSBpc0Jhcmtpbmc7XHJcblxyXG4gICAgICBpc0JhcmtpbmcgJiYgc291bmRDbGlwLnBsYXkoKTtcclxuICAgIH07XHJcbiAgICBkb2cuaXNCYXJraW5nUHJvcGVydHkubGluayggdGhpcy5pc0JhcmtpbmdMaXN0ZW5lciApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgICB0aGlzLmRvZy5pc0JhcmtpbmdQcm9wZXJ0eS51bmxpbmsoIHRoaXMuaXNCYXJraW5nTGlzdGVuZXIgKTtcclxuICAgIHRoaXMuY29udGVudE5vZGUuYm91bmRzUHJvcGVydHkudW5saW5rKCB0aGlzLmJvdW5kc0xpc3RlbmVyICk7XHJcbiAgfVxyXG59XHJcblxyXG5jaXJjdWl0Q29uc3RydWN0aW9uS2l0Q29tbW9uLnJlZ2lzdGVyKCAnRG9nTm9kZScsIERvZ05vZGUgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0EsT0FBT0EsU0FBUyxNQUFNLGlEQUFpRDtBQUN2RSxPQUFPQyxZQUFZLE1BQU0sbUNBQW1DO0FBRTVELE9BQU9DLFdBQVcsTUFBTSw2QkFBNkI7QUFDckQsT0FBT0MsNEJBQTRCLE1BQU0sb0NBQW9DO0FBRTdFLE9BQU9DLFFBQVEsTUFBTSxlQUFlO0FBR3BDLE9BQU9DLFlBQVksTUFBTSxtQkFBbUI7QUFJNUMsZUFBZSxNQUFN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