// Copyright 2019-2023, University of Colorado Boulder

/**
 * Button that clears the magnetic field from an inductor or electric field from a capacitor.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import { m3 } from '../../../dot/js/Matrix3.js';
import Vector2 from '../../../dot/js/Vector2.js';
import { Shape } from '../../../kite/js/imports.js';
import BannedNode from '../../../scenery-phet/js/BannedNode.js';
import { Color, Node, Path } from '../../../scenery/js/imports.js';
import circuitConstructionKitCommon from '../circuitConstructionKitCommon.js';
import DynamicCircuitElement from '../model/DynamicCircuitElement.js';
import CCKCRoundPushButton from './CCKCRoundPushButton.js';
import optionize from '../../../phet-core/js/optionize.js';
// constants
const SCALE = 0.032;
const SHAPE_MATRIX = m3(SCALE, 0, 0, 0, -SCALE, 0, 0, 0, 1); // to create a unity-scale icon

export default class ClearDynamicsButton extends CCKCRoundPushButton {
  constructor(circuit, providedOptions) {
    // This SVG data was exported from assets/flip_battery_icon.ai, which was created by @arouinfar.  Using illustrator,
    // save the AI file as SVG, then inspect the file to get the path declaration.
    const icon = new Path(new Shape('M885 970q18 -20 7 -44l-540 -1157q-13 -25 -42 -25q-4 0 -14 2q-17 5 -25.5 19t-4.5 30l197 808l-406 -101q-4 -1 -12 -1q-18 0 -31 11q-18 15 -13 39l201 825q4 14 16 23t28 9h328q19 0 32 -12.5t13 -29.5q0 -8 -5 -18l-171 -463l396 98q8 2 12 2q19 0 34 -15z').transformed(SHAPE_MATRIX), {
      scale: 0.45,
      fill: Color.BLACK,
      center: Vector2.ZERO
    });
    const options = optionize()({
      touchAreaDilation: 5,
      // radius dilation for touch area
      content: new Node({
        children: [icon, new BannedNode({
          lineWidth: 3,
          radius: 17
        })]
      }),
      listener: () => {
        const dynamicCircuitElement = circuit.selectionProperty.value;
        if (dynamicCircuitElement instanceof DynamicCircuitElement) {
          dynamicCircuitElement.clear();
        }
      }
    }, providedOptions);
    super(options);
    const isClearableListener = isClearable => {
      this.visible = isClearable;
    };

    // This is reused across all batteries.  The button itself can be hidden by PhET-iO customization, but the parent
    // node is another gate for the visibility.
    circuit.selectionProperty.link((newCircuitElement, oldCircuitElement) => {
      oldCircuitElement instanceof DynamicCircuitElement && oldCircuitElement.isClearableProperty.unlink(isClearableListener);
      newCircuitElement instanceof DynamicCircuitElement && newCircuitElement.isClearableProperty.link(isClearableListener);
    });
  }
  dispose() {
    assert && assert(false, 'should not be disposed');
  }
}
circuitConstructionKitCommon.register('ClearDynamicsButton', ClearDynamicsButton);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtMyIsIlZlY3RvcjIiLCJTaGFwZSIsIkJhbm5lZE5vZGUiLCJDb2xvciIsIk5vZGUiLCJQYXRoIiwiY2lyY3VpdENvbnN0cnVjdGlvbktpdENvbW1vbiIsIkR5bmFtaWNDaXJjdWl0RWxlbWVudCIsIkNDS0NSb3VuZFB1c2hCdXR0b24iLCJvcHRpb25pemUiLCJTQ0FMRSIsIlNIQVBFX01BVFJJWCIsIkNsZWFyRHluYW1pY3NCdXR0b24iLCJjb25zdHJ1Y3RvciIsImNpcmN1aXQiLCJwcm92aWRlZE9wdGlvbnMiLCJpY29uIiwidHJhbnNmb3JtZWQiLCJzY2FsZSIsImZpbGwiLCJCTEFDSyIsImNlbnRlciIsIlpFUk8iLCJvcHRpb25zIiwidG91Y2hBcmVhRGlsYXRpb24iLCJjb250ZW50IiwiY2hpbGRyZW4iLCJsaW5lV2lkdGgiLCJyYWRpdXMiLCJsaXN0ZW5lciIsImR5bmFtaWNDaXJjdWl0RWxlbWVudCIsInNlbGVjdGlvblByb3BlcnR5IiwidmFsdWUiLCJjbGVhciIsImlzQ2xlYXJhYmxlTGlzdGVuZXIiLCJpc0NsZWFyYWJsZSIsInZpc2libGUiLCJsaW5rIiwibmV3Q2lyY3VpdEVsZW1lbnQiLCJvbGRDaXJjdWl0RWxlbWVudCIsImlzQ2xlYXJhYmxlUHJvcGVydHkiLCJ1bmxpbmsiLCJkaXNwb3NlIiwiYXNzZXJ0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJDbGVhckR5bmFtaWNzQnV0dG9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE5LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEJ1dHRvbiB0aGF0IGNsZWFycyB0aGUgbWFnbmV0aWMgZmllbGQgZnJvbSBhbiBpbmR1Y3RvciBvciBlbGVjdHJpYyBmaWVsZCBmcm9tIGEgY2FwYWNpdG9yLlxyXG4gKlxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IG0zIH0gZnJvbSAnLi4vLi4vLi4vZG90L2pzL01hdHJpeDMuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEJhbm5lZE5vZGUgZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL0Jhbm5lZE5vZGUuanMnO1xyXG5pbXBvcnQgeyBDb2xvciwgTm9kZSwgUGF0aCB9IGZyb20gJy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBjaXJjdWl0Q29uc3RydWN0aW9uS2l0Q29tbW9uIGZyb20gJy4uL2NpcmN1aXRDb25zdHJ1Y3Rpb25LaXRDb21tb24uanMnO1xyXG5pbXBvcnQgRHluYW1pY0NpcmN1aXRFbGVtZW50IGZyb20gJy4uL21vZGVsL0R5bmFtaWNDaXJjdWl0RWxlbWVudC5qcyc7XHJcbmltcG9ydCBDQ0tDUm91bmRQdXNoQnV0dG9uIGZyb20gJy4vQ0NLQ1JvdW5kUHVzaEJ1dHRvbi5qcyc7XHJcbmltcG9ydCBDaXJjdWl0IGZyb20gJy4uL21vZGVsL0NpcmN1aXQuanMnO1xyXG5pbXBvcnQgQ2lyY3VpdEVsZW1lbnQgZnJvbSAnLi4vbW9kZWwvQ2lyY3VpdEVsZW1lbnQuanMnO1xyXG5pbXBvcnQgVmVydGV4IGZyb20gJy4uL21vZGVsL1ZlcnRleC5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgeyBSb3VuZFB1c2hCdXR0b25PcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vc3VuL2pzL2J1dHRvbnMvUm91bmRQdXNoQnV0dG9uLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBTQ0FMRSA9IDAuMDMyO1xyXG5cclxuY29uc3QgU0hBUEVfTUFUUklYID0gbTMoIFNDQUxFLCAwLCAwLCAwLCAtU0NBTEUsIDAsIDAsIDAsIDEgKTsgLy8gdG8gY3JlYXRlIGEgdW5pdHktc2NhbGUgaWNvblxyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcbnR5cGUgQ2xlYXJEeW5hbWljc0J1dHRvbk9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFJvdW5kUHVzaEJ1dHRvbk9wdGlvbnM7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDbGVhckR5bmFtaWNzQnV0dG9uIGV4dGVuZHMgQ0NLQ1JvdW5kUHVzaEJ1dHRvbiB7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggY2lyY3VpdDogQ2lyY3VpdCwgcHJvdmlkZWRPcHRpb25zPzogQ2xlYXJEeW5hbWljc0J1dHRvbk9wdGlvbnMgKSB7XHJcblxyXG4gICAgLy8gVGhpcyBTVkcgZGF0YSB3YXMgZXhwb3J0ZWQgZnJvbSBhc3NldHMvZmxpcF9iYXR0ZXJ5X2ljb24uYWksIHdoaWNoIHdhcyBjcmVhdGVkIGJ5IEBhcm91aW5mYXIuICBVc2luZyBpbGx1c3RyYXRvcixcclxuICAgIC8vIHNhdmUgdGhlIEFJIGZpbGUgYXMgU1ZHLCB0aGVuIGluc3BlY3QgdGhlIGZpbGUgdG8gZ2V0IHRoZSBwYXRoIGRlY2xhcmF0aW9uLlxyXG4gICAgY29uc3QgaWNvbiA9IG5ldyBQYXRoKCBuZXcgU2hhcGUoICdNODg1IDk3MHExOCAtMjAgNyAtNDRsLTU0MCAtMTE1N3EtMTMgLTI1IC00MiAtMjVxLTQgMCAtMTQgMnEtMTcgNSAtMjUuNSAxOXQtNC41IDMwbDE5NyA4MDhsLTQwNiAtMTAxcS00IC0xIC0xMiAtMXEtMTggMCAtMzEgMTFxLTE4IDE1IC0xMyAzOWwyMDEgODI1cTQgMTQgMTYgMjN0MjggOWgzMjhxMTkgMCAzMiAtMTIuNXQxMyAtMjkuNXEwIC04IC01IC0xOGwtMTcxIC00NjNsMzk2IDk4cTggMiAxMiAycTE5IDAgMzQgLTE1eicgKS50cmFuc2Zvcm1lZCggU0hBUEVfTUFUUklYICksIHtcclxuICAgICAgc2NhbGU6IDAuNDUsXHJcbiAgICAgIGZpbGw6IENvbG9yLkJMQUNLLFxyXG4gICAgICBjZW50ZXI6IFZlY3RvcjIuWkVST1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8Q2xlYXJEeW5hbWljc0J1dHRvbk9wdGlvbnMsIFNlbGZPcHRpb25zLCBSb3VuZFB1c2hCdXR0b25PcHRpb25zPigpKCB7XHJcbiAgICAgIHRvdWNoQXJlYURpbGF0aW9uOiA1LCAvLyByYWRpdXMgZGlsYXRpb24gZm9yIHRvdWNoIGFyZWFcclxuICAgICAgY29udGVudDogbmV3IE5vZGUoIHtcclxuICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgaWNvbixcclxuICAgICAgICAgIG5ldyBCYW5uZWROb2RlKCB7XHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDogMyxcclxuICAgICAgICAgICAgcmFkaXVzOiAxN1xyXG4gICAgICAgICAgfSApXHJcbiAgICAgICAgXVxyXG4gICAgICB9ICksXHJcbiAgICAgIGxpc3RlbmVyOiAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZHluYW1pY0NpcmN1aXRFbGVtZW50ID0gY2lyY3VpdC5zZWxlY3Rpb25Qcm9wZXJ0eS52YWx1ZTtcclxuICAgICAgICBpZiAoIGR5bmFtaWNDaXJjdWl0RWxlbWVudCBpbnN0YW5jZW9mIER5bmFtaWNDaXJjdWl0RWxlbWVudCApIHtcclxuICAgICAgICAgIGR5bmFtaWNDaXJjdWl0RWxlbWVudC5jbGVhcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICBjb25zdCBpc0NsZWFyYWJsZUxpc3RlbmVyID0gKCBpc0NsZWFyYWJsZTogYm9vbGVhbiApID0+IHtcclxuICAgICAgdGhpcy52aXNpYmxlID0gaXNDbGVhcmFibGU7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFRoaXMgaXMgcmV1c2VkIGFjcm9zcyBhbGwgYmF0dGVyaWVzLiAgVGhlIGJ1dHRvbiBpdHNlbGYgY2FuIGJlIGhpZGRlbiBieSBQaEVULWlPIGN1c3RvbWl6YXRpb24sIGJ1dCB0aGUgcGFyZW50XHJcbiAgICAvLyBub2RlIGlzIGFub3RoZXIgZ2F0ZSBmb3IgdGhlIHZpc2liaWxpdHkuXHJcbiAgICBjaXJjdWl0LnNlbGVjdGlvblByb3BlcnR5LmxpbmsoICggbmV3Q2lyY3VpdEVsZW1lbnQ6IENpcmN1aXRFbGVtZW50IHwgVmVydGV4IHwgbnVsbCwgb2xkQ2lyY3VpdEVsZW1lbnQ6IENpcmN1aXRFbGVtZW50IHwgVmVydGV4IHwgbnVsbCApID0+IHtcclxuICAgICAgb2xkQ2lyY3VpdEVsZW1lbnQgaW5zdGFuY2VvZiBEeW5hbWljQ2lyY3VpdEVsZW1lbnQgJiYgb2xkQ2lyY3VpdEVsZW1lbnQuaXNDbGVhcmFibGVQcm9wZXJ0eS51bmxpbmsoIGlzQ2xlYXJhYmxlTGlzdGVuZXIgKTtcclxuICAgICAgbmV3Q2lyY3VpdEVsZW1lbnQgaW5zdGFuY2VvZiBEeW5hbWljQ2lyY3VpdEVsZW1lbnQgJiYgbmV3Q2lyY3VpdEVsZW1lbnQuaXNDbGVhcmFibGVQcm9wZXJ0eS5saW5rKCBpc0NsZWFyYWJsZUxpc3RlbmVyICk7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlLCAnc2hvdWxkIG5vdCBiZSBkaXNwb3NlZCcgKTtcclxuICB9XHJcbn1cclxuXHJcbmNpcmN1aXRDb25zdHJ1Y3Rpb25LaXRDb21tb24ucmVnaXN0ZXIoICdDbGVhckR5bmFtaWNzQnV0dG9uJywgQ2xlYXJEeW5hbWljc0J1dHRvbiApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTQSxFQUFFLFFBQVEsNEJBQTRCO0FBQy9DLE9BQU9D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