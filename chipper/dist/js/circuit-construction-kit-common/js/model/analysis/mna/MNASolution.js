// Copyright 2015-2022, University of Colorado Boulder

/**
 * Sparse solution containing the solved variables from MNACircuit. * No listeners are attached and hence no dispose implementation is necessary.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import circuitConstructionKitCommon from '../../../circuitConstructionKitCommon.js';
export default class MNASolution {
  // the solved node voltages. keys are {number} indicating the node id, values are {number} for the voltage at the node

  // circuit elements in the solution

  constructor(nodeVoltages, elements) {
    this.nodeVoltages = nodeVoltages;
    this.elements = elements;
  }
  getSolvedCurrent(circuitElement) {
    assert && assert(this.elements.has(circuitElement));
    return this.elements.get(circuitElement);
  }

  // Compare two solutions, and provide detailed qunit equal test if equal is provided.
  approxEquals(modifiedNodalAnalysisSolution, qassert) {
    const keys = Array.from(this.nodeVoltages.keys());
    const otherKeys = Array.from(modifiedNodalAnalysisSolution.nodeVoltages.keys());
    const keyDifference = _.difference(keys, otherKeys);
    assert && assert(keyDifference.length === 0, 'wrong keys in compared solution');
    for (let i = 0; i < keys.length; i++) {
      const key = keys[i];
      const closeEnough = approximatelyEquals(this.getNodeVoltage(key), modifiedNodalAnalysisSolution.getNodeVoltage(key));
      qassert && qassert.equal(closeEnough, true, `node voltages[${i}] should match. ${this.getNodeVoltage(key)}!==${modifiedNodalAnalysisSolution.getNodeVoltage(key)}`);
      if (!closeEnough) {
        return false;
      }
    }
    if (!this.hasAllCurrents(modifiedNodalAnalysisSolution)) {
      return false;
    }
    if (!modifiedNodalAnalysisSolution.hasAllCurrents(this)) {
      return false;
    }
    return true;
  }

  /**
   * For equality testing, make sure all of the specified elements and currents match ours
   */
  hasAllCurrents(modifiedNodalAnalysisSolution) {
    const keys = Array.from(modifiedNodalAnalysisSolution.elements.keys());
    for (let i = 0; i < keys.length; i++) {
      const element = keys[i];
      if (!this.hasMatchingElement(element)) {
        return false;
      }
    }
    return true;
  }

  /**
   * Returns true if this solution has an element that matches the provided element.
   */
  hasMatchingElement(element) {
    const elements = Array.from(this.elements.keys());
    for (let i = 0; i < elements.length; i++) {
      const proposedElement = elements[i];
      if (proposedElement.nodeId0 === element.nodeId0 && proposedElement.nodeId1 === element.nodeId1 && approximatelyEquals(this.elements.get(proposedElement), this.elements.get(element))) {
        return true;
      }
    }
    return false;
  }

  /**
   * Use Ohm's law to compute the current for a resistor with resistance>0
   */
  getCurrentForResistor(resistor) {
    assert && assert(resistor.resistance > 0, 'resistor must have resistance to use Ohms Law');

    // To help understand the minus sign here:
    // Imagine a resistor that goes from node r0 to r1, with a conventional current flowing from r0 to r1.  Then
    // the voltage drop is v1-v0.  Assuming for the sake of discussion that v1>v0 (and hence the voltage is positive),
    // the current sign should be negative since conventional current flows from high to low potential.
    // Conversely, if v0>v1, then voltage is negative, so for the conventional current to flow to the right we must
    // multiply it by a negative.
    // Same sign as Java, see https://github.com/phetsims/circuit-construction-kit-common/issues/758
    return -this.getVoltage(resistor) / resistor.resistance;
  }

  /**
   * Returns the voltage of the specified node.
   */
  getNodeVoltage(nodeIndex) {
    return this.nodeVoltages.get(nodeIndex);
  }

  /**
   * Returns the voltage across a circuit element.
   * @param element - a circuit element with {nodeId1:{number},node2:{number}}
   * @returns - the voltage
   */
  getVoltage(element) {
    const voltage = this.nodeVoltages.get(element.nodeId1) - this.nodeVoltages.get(element.nodeId0);
    assert && assert(!isNaN(voltage));
    return voltage;
  }
}

/**
 * Returns true if the numbers are approximately equal.
 *
 * @param a - a number
 * @param b - another number
 * @returns true if the numbers are approximately equal
 */
const approximatelyEquals = (a, b) => Math.abs(a - b) < 1E-4;
circuitConstructionKitCommon.register('MNASolution', MNASolution);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjaXJjdWl0Q29uc3RydWN0aW9uS2l0Q29tbW9uIiwiTU5BU29sdXRpb24iLCJjb25zdHJ1Y3RvciIsIm5vZGVWb2x0YWdlcyIsImVsZW1lbnRzIiwiZ2V0U29sdmVkQ3VycmVudCIsImNpcmN1aXRFbGVtZW50IiwiYXNzZXJ0IiwiaGFzIiwiZ2V0IiwiYXBwcm94RXF1YWxzIiwibW9kaWZpZWROb2RhbEFuYWx5c2lzU29sdXRpb24iLCJxYXNzZXJ0Iiwia2V5cyIsIkFycmF5IiwiZnJvbSIsIm90aGVyS2V5cyIsImtleURpZmZlcmVuY2UiLCJfIiwiZGlmZmVyZW5jZSIsImxlbmd0aCIsImkiLCJrZXkiLCJjbG9zZUVub3VnaCIsImFwcHJveGltYXRlbHlFcXVhbHMiLCJnZXROb2RlVm9sdGFnZSIsImVxdWFsIiwiaGFzQWxsQ3VycmVudHMiLCJlbGVtZW50IiwiaGFzTWF0Y2hpbmdFbGVtZW50IiwicHJvcG9zZWRFbGVtZW50Iiwibm9kZUlkMCIsIm5vZGVJZDEiLCJnZXRDdXJyZW50Rm9yUmVzaXN0b3IiLCJyZXNpc3RvciIsInJlc2lzdGFuY2UiLCJnZXRWb2x0YWdlIiwibm9kZUluZGV4Iiwidm9sdGFnZSIsImlzTmFOIiwiYSIsImIiLCJNYXRoIiwiYWJzIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJNTkFTb2x1dGlvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNS0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBTcGFyc2Ugc29sdXRpb24gY29udGFpbmluZyB0aGUgc29sdmVkIHZhcmlhYmxlcyBmcm9tIE1OQUNpcmN1aXQuICogTm8gbGlzdGVuZXJzIGFyZSBhdHRhY2hlZCBhbmQgaGVuY2Ugbm8gZGlzcG9zZSBpbXBsZW1lbnRhdGlvbiBpcyBuZWNlc3NhcnkuXHJcbiAqXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IGNpcmN1aXRDb25zdHJ1Y3Rpb25LaXRDb21tb24gZnJvbSAnLi4vLi4vLi4vY2lyY3VpdENvbnN0cnVjdGlvbktpdENvbW1vbi5qcyc7XHJcbmltcG9ydCBNTkFDaXJjdWl0RWxlbWVudCBmcm9tICcuL01OQUNpcmN1aXRFbGVtZW50LmpzJztcclxuaW1wb3J0IE1OQVJlc2lzdG9yIGZyb20gJy4vTU5BUmVzaXN0b3IuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTU5BU29sdXRpb24ge1xyXG5cclxuICAvLyB0aGUgc29sdmVkIG5vZGUgdm9sdGFnZXMuIGtleXMgYXJlIHtudW1iZXJ9IGluZGljYXRpbmcgdGhlIG5vZGUgaWQsIHZhbHVlcyBhcmUge251bWJlcn0gZm9yIHRoZSB2b2x0YWdlIGF0IHRoZSBub2RlXHJcbiAgcHJpdmF0ZSByZWFkb25seSBub2RlVm9sdGFnZXM6IE1hcDxzdHJpbmcsIG51bWJlcj47XHJcbiAgcHJpdmF0ZSByZWFkb25seSBlbGVtZW50czogTWFwPE1OQUNpcmN1aXRFbGVtZW50LCBudW1iZXI+OyAvLyBjaXJjdWl0IGVsZW1lbnRzIGluIHRoZSBzb2x1dGlvblxyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIG5vZGVWb2x0YWdlczogTWFwPHN0cmluZywgbnVtYmVyPiwgZWxlbWVudHM6IE1hcDxNTkFDaXJjdWl0RWxlbWVudCwgbnVtYmVyPiApIHtcclxuICAgIHRoaXMubm9kZVZvbHRhZ2VzID0gbm9kZVZvbHRhZ2VzO1xyXG4gICAgdGhpcy5lbGVtZW50cyA9IGVsZW1lbnRzO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldFNvbHZlZEN1cnJlbnQoIGNpcmN1aXRFbGVtZW50OiBNTkFDaXJjdWl0RWxlbWVudCApOiBudW1iZXIge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5lbGVtZW50cy5oYXMoIGNpcmN1aXRFbGVtZW50ICkgKTtcclxuICAgIHJldHVybiB0aGlzLmVsZW1lbnRzLmdldCggY2lyY3VpdEVsZW1lbnQgKSE7XHJcbiAgfVxyXG5cclxuICAvLyBDb21wYXJlIHR3byBzb2x1dGlvbnMsIGFuZCBwcm92aWRlIGRldGFpbGVkIHF1bml0IGVxdWFsIHRlc3QgaWYgZXF1YWwgaXMgcHJvdmlkZWQuXHJcbiAgcHVibGljIGFwcHJveEVxdWFscyggbW9kaWZpZWROb2RhbEFuYWx5c2lzU29sdXRpb246IE1OQVNvbHV0aW9uLCBxYXNzZXJ0OiBBc3NlcnQgfCBudWxsICk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3Qga2V5cyA9IEFycmF5LmZyb20oIHRoaXMubm9kZVZvbHRhZ2VzLmtleXMoKSApO1xyXG4gICAgY29uc3Qgb3RoZXJLZXlzID0gQXJyYXkuZnJvbSggbW9kaWZpZWROb2RhbEFuYWx5c2lzU29sdXRpb24ubm9kZVZvbHRhZ2VzLmtleXMoKSApO1xyXG4gICAgY29uc3Qga2V5RGlmZmVyZW5jZSA9IF8uZGlmZmVyZW5jZSgga2V5cywgb3RoZXJLZXlzICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBrZXlEaWZmZXJlbmNlLmxlbmd0aCA9PT0gMCwgJ3dyb25nIGtleXMgaW4gY29tcGFyZWQgc29sdXRpb24nICk7XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBjb25zdCBrZXkgPSBrZXlzWyBpIF07XHJcbiAgICAgIGNvbnN0IGNsb3NlRW5vdWdoID0gYXBwcm94aW1hdGVseUVxdWFscyhcclxuICAgICAgICB0aGlzLmdldE5vZGVWb2x0YWdlKCBrZXkgKSxcclxuICAgICAgICBtb2RpZmllZE5vZGFsQW5hbHlzaXNTb2x1dGlvbi5nZXROb2RlVm9sdGFnZSgga2V5IClcclxuICAgICAgKTtcclxuICAgICAgcWFzc2VydCAmJiBxYXNzZXJ0LmVxdWFsKCBjbG9zZUVub3VnaCwgdHJ1ZSwgYG5vZGUgdm9sdGFnZXNbJHtpfV0gc2hvdWxkIG1hdGNoLiAke1xyXG4gICAgICAgIHRoaXMuZ2V0Tm9kZVZvbHRhZ2UoIGtleSApfSE9PSR7XHJcbiAgICAgICAgbW9kaWZpZWROb2RhbEFuYWx5c2lzU29sdXRpb24uZ2V0Tm9kZVZvbHRhZ2UoIGtleSApfWAgKTtcclxuXHJcbiAgICAgIGlmICggIWNsb3NlRW5vdWdoICkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICggIXRoaXMuaGFzQWxsQ3VycmVudHMoIG1vZGlmaWVkTm9kYWxBbmFseXNpc1NvbHV0aW9uICkgKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmICggIW1vZGlmaWVkTm9kYWxBbmFseXNpc1NvbHV0aW9uLmhhc0FsbEN1cnJlbnRzKCB0aGlzICkgKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRm9yIGVxdWFsaXR5IHRlc3RpbmcsIG1ha2Ugc3VyZSBhbGwgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50cyBhbmQgY3VycmVudHMgbWF0Y2ggb3Vyc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgaGFzQWxsQ3VycmVudHMoIG1vZGlmaWVkTm9kYWxBbmFseXNpc1NvbHV0aW9uOiBNTkFTb2x1dGlvbiApOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGtleXMgPSBBcnJheS5mcm9tKCBtb2RpZmllZE5vZGFsQW5hbHlzaXNTb2x1dGlvbi5lbGVtZW50cy5rZXlzKCkgKTtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSBrZXlzWyBpIF07XHJcbiAgICAgIGlmICggIXRoaXMuaGFzTWF0Y2hpbmdFbGVtZW50KCBlbGVtZW50ICkgKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIHNvbHV0aW9uIGhhcyBhbiBlbGVtZW50IHRoYXQgbWF0Y2hlcyB0aGUgcHJvdmlkZWQgZWxlbWVudC5cclxuICAgKi9cclxuICBwcml2YXRlIGhhc01hdGNoaW5nRWxlbWVudCggZWxlbWVudDogTU5BQ2lyY3VpdEVsZW1lbnQgKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBlbGVtZW50cyA9IEFycmF5LmZyb20oIHRoaXMuZWxlbWVudHMua2V5cygpICk7XHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgY29uc3QgcHJvcG9zZWRFbGVtZW50ID0gZWxlbWVudHNbIGkgXTtcclxuICAgICAgaWYgKCBwcm9wb3NlZEVsZW1lbnQubm9kZUlkMCA9PT0gZWxlbWVudC5ub2RlSWQwICYmXHJcbiAgICAgICAgICAgcHJvcG9zZWRFbGVtZW50Lm5vZGVJZDEgPT09IGVsZW1lbnQubm9kZUlkMSAmJlxyXG4gICAgICAgICAgIGFwcHJveGltYXRlbHlFcXVhbHMoIHRoaXMuZWxlbWVudHMuZ2V0KCBwcm9wb3NlZEVsZW1lbnQgKSEsIHRoaXMuZWxlbWVudHMuZ2V0KCBlbGVtZW50ICkhICkgKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVzZSBPaG0ncyBsYXcgdG8gY29tcHV0ZSB0aGUgY3VycmVudCBmb3IgYSByZXNpc3RvciB3aXRoIHJlc2lzdGFuY2U+MFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRDdXJyZW50Rm9yUmVzaXN0b3IoIHJlc2lzdG9yOiBNTkFSZXNpc3RvciApOiBudW1iZXIge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggcmVzaXN0b3IucmVzaXN0YW5jZSA+IDAsICdyZXNpc3RvciBtdXN0IGhhdmUgcmVzaXN0YW5jZSB0byB1c2UgT2htcyBMYXcnICk7XHJcblxyXG4gICAgLy8gVG8gaGVscCB1bmRlcnN0YW5kIHRoZSBtaW51cyBzaWduIGhlcmU6XHJcbiAgICAvLyBJbWFnaW5lIGEgcmVzaXN0b3IgdGhhdCBnb2VzIGZyb20gbm9kZSByMCB0byByMSwgd2l0aCBhIGNvbnZlbnRpb25hbCBjdXJyZW50IGZsb3dpbmcgZnJvbSByMCB0byByMS4gIFRoZW5cclxuICAgIC8vIHRoZSB2b2x0YWdlIGRyb3AgaXMgdjEtdjAuICBBc3N1bWluZyBmb3IgdGhlIHNha2Ugb2YgZGlzY3Vzc2lvbiB0aGF0IHYxPnYwIChhbmQgaGVuY2UgdGhlIHZvbHRhZ2UgaXMgcG9zaXRpdmUpLFxyXG4gICAgLy8gdGhlIGN1cnJlbnQgc2lnbiBzaG91bGQgYmUgbmVnYXRpdmUgc2luY2UgY29udmVudGlvbmFsIGN1cnJlbnQgZmxvd3MgZnJvbSBoaWdoIHRvIGxvdyBwb3RlbnRpYWwuXHJcbiAgICAvLyBDb252ZXJzZWx5LCBpZiB2MD52MSwgdGhlbiB2b2x0YWdlIGlzIG5lZ2F0aXZlLCBzbyBmb3IgdGhlIGNvbnZlbnRpb25hbCBjdXJyZW50IHRvIGZsb3cgdG8gdGhlIHJpZ2h0IHdlIG11c3RcclxuICAgIC8vIG11bHRpcGx5IGl0IGJ5IGEgbmVnYXRpdmUuXHJcbiAgICAvLyBTYW1lIHNpZ24gYXMgSmF2YSwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9jaXJjdWl0LWNvbnN0cnVjdGlvbi1raXQtY29tbW9uL2lzc3Vlcy83NThcclxuICAgIHJldHVybiAtdGhpcy5nZXRWb2x0YWdlKCByZXNpc3RvciApIC8gcmVzaXN0b3IucmVzaXN0YW5jZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIHZvbHRhZ2Ugb2YgdGhlIHNwZWNpZmllZCBub2RlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXROb2RlVm9sdGFnZSggbm9kZUluZGV4OiBzdHJpbmcgKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLm5vZGVWb2x0YWdlcy5nZXQoIG5vZGVJbmRleCApITtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIHZvbHRhZ2UgYWNyb3NzIGEgY2lyY3VpdCBlbGVtZW50LlxyXG4gICAqIEBwYXJhbSBlbGVtZW50IC0gYSBjaXJjdWl0IGVsZW1lbnQgd2l0aCB7bm9kZUlkMTp7bnVtYmVyfSxub2RlMjp7bnVtYmVyfX1cclxuICAgKiBAcmV0dXJucyAtIHRoZSB2b2x0YWdlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRWb2x0YWdlKCBlbGVtZW50OiBNTkFDaXJjdWl0RWxlbWVudCApOiBudW1iZXIge1xyXG4gICAgY29uc3Qgdm9sdGFnZSA9IHRoaXMubm9kZVZvbHRhZ2VzLmdldCggZWxlbWVudC5ub2RlSWQxICkhIC0gdGhpcy5ub2RlVm9sdGFnZXMuZ2V0KCBlbGVtZW50Lm5vZGVJZDAgKSE7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCAhaXNOYU4oIHZvbHRhZ2UgKSApO1xyXG4gICAgcmV0dXJuIHZvbHRhZ2U7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBudW1iZXJzIGFyZSBhcHByb3hpbWF0ZWx5IGVxdWFsLlxyXG4gKlxyXG4gKiBAcGFyYW0gYSAtIGEgbnVtYmVyXHJcbiAqIEBwYXJhbSBiIC0gYW5vdGhlciBudW1iZXJcclxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgbnVtYmVycyBhcmUgYXBwcm94aW1hdGVseSBlcXVhbFxyXG4gKi9cclxuY29uc3QgYXBwcm94aW1hdGVseUVxdWFscyA9ICggYTogbnVtYmVyLCBiOiBudW1iZXIgKSA9PiBNYXRoLmFicyggYSAtIGIgKSA8IDFFLTQ7XHJcblxyXG5jaXJjdWl0Q29uc3RydWN0aW9uS2l0Q29tbW9uLnJlZ2lzdGVyKCAnTU5BU29sdXRpb24nLCBNTkFTb2x1dGlvbiApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSw0QkFBNEIsTUFBTSww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