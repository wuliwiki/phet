// Copyright 2015-2022, University of Colorado Boulder

/**
 * Model of a spring, contains purely model Properties.
 * The left end is attached to something like a wall or another spring.
 * A force is applied to the right end, by something like a robotic arm or another spring.
 *
 * Model equations:
 *
 * F = k * x
 * E = ( k * x * x ) / 2
 *
 * where:
 *
 * F = applied force, N
 * k = spring constant, N/m
 * x = displacement from equilibrium position, m
 * E = potential energy, J
 *
 * Either displacement range or applied force range must be specified, but not both.
 * The unspecified range is computed, and whichever range is not specified is the
 * quantity that changes when spring constant is modified. For example, if applied force
 * range is specified, then displacement range is computed, and changing spring constant
 * will modify displacement. Here's how that applies to this sim's screens:
 *
 * Intro and Systems screens (appliedForceRange specified):
 *
 * F change => compute x
 * k change => compute x
 * x change => compute F
 *
 * Energy screen (displacementRange specified):
 *
 * F change => compute x
 * k change => compute F
 * x change => compute F
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Range from '../../../../dot/js/Range.js';
import RangeWithValue from '../../../../dot/js/RangeWithValue.js';
import optionize from '../../../../phet-core/js/optionize.js';
import PhetioObject from '../../../../tandem/js/PhetioObject.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import hookesLaw from '../../hookesLaw.js';
export default class Spring extends PhetioObject {
  // applied force (F)
  // spring constant (k)
  // displacement from equilibrium position (x)
  // position of the left end of the spring

  // spring force opposes the applied force (-F)
  // equilibrium x position
  // x position of the right end of the spring
  // Range of the right end of the spring
  // length of the spring
  // potential energy, E

  constructor(providedOptions) {
    const options = optionize()({
      // SelfOptions
      logName: null,
      left: 0,
      equilibriumLength: 1.5,
      springConstantRange: new RangeWithValue(100, 1000, 200),
      appliedForceRange: null,
      displacementRange: null,
      phetioState: false // since this type has no inherent state to save, to avoid circular JSON error
    }, providedOptions);
    super(options);

    // validate and save options
    assert && assert(options.equilibriumLength > 0, `equilibriumLength must be > 0 : ${options.equilibriumLength}`);
    this.equilibriumLength = options.equilibriumLength;
    assert && assert(options.springConstantRange.min > 0, `minimum spring constant must be positive : ${options.springConstantRange.min}`);
    this.springConstantRange = options.springConstantRange;

    // Either appliedForceRange or displacementRange must be specified, and the other is computed.
    // Intro and Systems screens specify appliedForceRange. Energy screen specifies displacementRange.
    assert && assert(options.appliedForceRange && !options.displacementRange || !options.appliedForceRange && options.displacementRange, 'specify either appliedForceRange or displacementRange, but not both');
    if (options.appliedForceRange) {
      this.appliedForceRange = options.appliedForceRange;

      // x = F/k, read-only
      this.displacementRange = new RangeWithValue(this.appliedForceRange.min / this.springConstantRange.min, this.appliedForceRange.max / this.springConstantRange.min, this.appliedForceRange.defaultValue / this.springConstantRange.defaultValue);
    } else {
      this.displacementRange = options.displacementRange;
      assert && assert(this.displacementRange);

      // F = kx, read-only
      this.appliedForceRange = new RangeWithValue(this.springConstantRange.max * this.displacementRange.min, this.springConstantRange.max * this.displacementRange.max, this.springConstantRange.defaultValue * this.displacementRange.defaultValue);
    }

    //------------------------------------------------
    // Properties

    this.appliedForceProperty = new NumberProperty(this.appliedForceRange.defaultValue, {
      // Applied force (F) and displacement (x) participate in a 2-way relationship, where changing
      // one of them results in recalculation of the other.  For some values, this results in floating-point
      // error that causes reentrant behavior.  See #63.
      reentrant: true,
      range: this.appliedForceRange,
      units: 'N',
      tandem: options.tandem.createTandem('appliedForceProperty')
    });
    phet.log && this.appliedForceProperty.link(appliedForce => phet.log(`${options.logName} appliedForce=${appliedForce}`));
    this.springConstantProperty = new NumberProperty(this.springConstantRange.defaultValue, {
      range: this.springConstantRange,
      units: 'N/m',
      tandem: options.tandem.createTandem('springConstantProperty')
    });
    phet.log && this.springConstantProperty.link(springConstant => phet.log(`${options.logName} springConstant= ${springConstant}`));
    this.displacementProperty = new NumberProperty(this.displacementRange.defaultValue, {
      // Applied force (F) and displacement (x) participate in a 2-way relationship, where changing
      // one of them results in recalculation of the other.  For some values, this results in floating-point
      // error that causes reentrant behavior.  See #63.
      reentrant: true,
      range: this.displacementRange,
      units: 'm',
      tandem: options.tandem.createTandem('displacementProperty')
    });
    phet.log && this.displacementProperty.link(displacement => phet.log(`${options.logName} displacement=${displacement}`));
    this.leftProperty = new NumberProperty(options.left);
    phet.log && this.leftProperty.link(left => phet.log(`${options.logName} left=${left}`));

    //------------------------------------------------
    // Property observers

    // F: When applied force changes, maintain spring constant, change displacement.
    this.appliedForceProperty.link(appliedForce => {
      assert && assert(this.appliedForceRange.contains(appliedForce), `appliedForce is out of range: ${appliedForce}`);

      // x = F/k
      this.displacementProperty.value = appliedForce / this.springConstantProperty.value;
    });

    // k: When spring constant changes, adjust either applied force or displacement.
    this.springConstantProperty.link(springConstant => {
      assert && assert(this.springConstantRange.contains(springConstant), `springConstant is out of range: ${springConstant}`);
      if (options.appliedForceRange) {
        // If the applied force range was specified via options, then maintain the applied force, change displacement.
        // This applies to the Intro and Systems screens.
        // x = F/k
        this.displacementProperty.value = this.appliedForceProperty.value / springConstant;
      } else {
        // If displacement range was specified via options, maintain the displacement, change applied force.
        // This applies to the Energy screen.
        // F = kx
        this.appliedForceProperty.value = springConstant * this.displacementProperty.value;
      }
    });

    // x: When displacement changes, maintain the spring constant, change applied force.
    this.displacementProperty.link(displacement => {
      assert && assert(this.displacementRange.contains(displacement), `displacement is out of range: ${displacement}`);

      // F = kx
      let appliedForce = this.springConstantProperty.value * displacement;

      // Constrain to range, needed due to floating-point error.
      appliedForce = this.appliedForceRange.constrainValue(appliedForce);
      this.appliedForceProperty.value = appliedForce;
    });

    //------------------------------------------------
    // Derived properties

    // spring force opposes the applied force (-F)
    this.springForceProperty = new DerivedProperty([this.appliedForceProperty], appliedForce => -appliedForce, {
      units: 'N',
      phetioValueType: NumberIO,
      tandem: options.tandem.createTandem('springForceProperty')
    });
    phet.log && this.springForceProperty.link(springForce => phet.log(`${options.logName} springForce=${springForce}`));

    // This must be a Property to support systems of springs. For example, for 2 springs in series,
    // equilibriumXProperty changes for the right spring, whose left end moves.
    this.equilibriumXProperty = new DerivedProperty([this.leftProperty], left => left + this.equilibriumLength);
    phet.log && this.equilibriumXProperty.link(equilibriumX => phet.log(`${options.logName} equilibriumX=${equilibriumX}`));
    this.rightProperty = new DerivedProperty([this.equilibriumXProperty, this.displacementProperty], (equilibriumX, displacement) => {
      const left = this.leftProperty.value;
      const right = equilibriumX + displacement;
      assert && assert(right - left > 0, `right must be > left, right=${right}, left=${left}`);
      return right;
    });
    phet.log && this.rightProperty.link(right => phet.log(`${options.logName} right=${right}`));

    // Derivation differs depending on whether changing spring constant modifies applied force or displacement.
    if (options.appliedForceRange) {
      this.rightRangeProperty = new DerivedProperty([this.springConstantProperty, this.equilibriumXProperty], (springConstant, equilibriumX) => {
        const minDisplacement = this.appliedForceRange.min / springConstant;
        const maxDisplacement = this.appliedForceRange.max / springConstant;
        return new Range(equilibriumX + minDisplacement, equilibriumX + maxDisplacement);
      });
    } else {
      this.rightRangeProperty = new DerivedProperty([this.equilibriumXProperty], equilibriumX => new Range(equilibriumX + this.displacementRange.min, equilibriumX + this.displacementRange.max));
    }
    phet.log && this.rightRangeProperty.link(rightRange => phet.log(`${options.logName} rightRange=${rightRange}`));
    this.lengthProperty = new DerivedProperty([this.leftProperty, this.rightProperty], (left, right) => Math.abs(right - left));
    phet.log && this.lengthProperty.link(length => phet.log(`${options.logName} length=${length}`));

    // potential energy, E = ( k1 * x1 * x1 ) / 2
    // To avoid intermediate values, define this *after* the listeners that update its dependencies.
    this.potentialEnergyProperty = new DerivedProperty([this.springConstantProperty, this.displacementProperty], (springConstant, displacement) => springConstant * displacement * displacement / 2, {
      units: 'J',
      phetioValueType: NumberIO,
      tandem: options.tandem.createTandem('potentialEnergyProperty')
    });
    phet.log && this.potentialEnergyProperty.link(potentialEnergy => phet.log(`${options.logName} potentialEnergy=${potentialEnergy}`));
  }
  dispose() {
    assert && assert(false, 'dispose is not supported, exists for the lifetime of the sim');
    super.dispose();
  }
  reset() {
    this.appliedForceProperty.reset();
    this.springConstantProperty.reset();
    this.displacementProperty.reset();
    this.leftProperty.reset();
  }
}
hookesLaw.register('Spring', Spring);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJOdW1iZXJQcm9wZXJ0eSIsIlJhbmdlIiwiUmFuZ2VXaXRoVmFsdWUiLCJvcHRpb25pemUiLCJQaGV0aW9PYmplY3QiLCJOdW1iZXJJTyIsImhvb2tlc0xhdyIsIlNwcmluZyIsImNvbnN0cnVjdG9yIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsImxvZ05hbWUiLCJsZWZ0IiwiZXF1aWxpYnJpdW1MZW5ndGgiLCJzcHJpbmdDb25zdGFudFJhbmdlIiwiYXBwbGllZEZvcmNlUmFuZ2UiLCJkaXNwbGFjZW1lbnRSYW5nZSIsInBoZXRpb1N0YXRlIiwiYXNzZXJ0IiwibWluIiwibWF4IiwiZGVmYXVsdFZhbHVlIiwiYXBwbGllZEZvcmNlUHJvcGVydHkiLCJyZWVudHJhbnQiLCJyYW5nZSIsInVuaXRzIiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwicGhldCIsImxvZyIsImxpbmsiLCJhcHBsaWVkRm9yY2UiLCJzcHJpbmdDb25zdGFudFByb3BlcnR5Iiwic3ByaW5nQ29uc3RhbnQiLCJkaXNwbGFjZW1lbnRQcm9wZXJ0eSIsImRpc3BsYWNlbWVudCIsImxlZnRQcm9wZXJ0eSIsImNvbnRhaW5zIiwidmFsdWUiLCJjb25zdHJhaW5WYWx1ZSIsInNwcmluZ0ZvcmNlUHJvcGVydHkiLCJwaGV0aW9WYWx1ZVR5cGUiLCJzcHJpbmdGb3JjZSIsImVxdWlsaWJyaXVtWFByb3BlcnR5IiwiZXF1aWxpYnJpdW1YIiwicmlnaHRQcm9wZXJ0eSIsInJpZ2h0IiwicmlnaHRSYW5nZVByb3BlcnR5IiwibWluRGlzcGxhY2VtZW50IiwibWF4RGlzcGxhY2VtZW50IiwicmlnaHRSYW5nZSIsImxlbmd0aFByb3BlcnR5IiwiTWF0aCIsImFicyIsImxlbmd0aCIsInBvdGVudGlhbEVuZXJneVByb3BlcnR5IiwicG90ZW50aWFsRW5lcmd5IiwiZGlzcG9zZSIsInJlc2V0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJTcHJpbmcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTUtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogTW9kZWwgb2YgYSBzcHJpbmcsIGNvbnRhaW5zIHB1cmVseSBtb2RlbCBQcm9wZXJ0aWVzLlxyXG4gKiBUaGUgbGVmdCBlbmQgaXMgYXR0YWNoZWQgdG8gc29tZXRoaW5nIGxpa2UgYSB3YWxsIG9yIGFub3RoZXIgc3ByaW5nLlxyXG4gKiBBIGZvcmNlIGlzIGFwcGxpZWQgdG8gdGhlIHJpZ2h0IGVuZCwgYnkgc29tZXRoaW5nIGxpa2UgYSByb2JvdGljIGFybSBvciBhbm90aGVyIHNwcmluZy5cclxuICpcclxuICogTW9kZWwgZXF1YXRpb25zOlxyXG4gKlxyXG4gKiBGID0gayAqIHhcclxuICogRSA9ICggayAqIHggKiB4ICkgLyAyXHJcbiAqXHJcbiAqIHdoZXJlOlxyXG4gKlxyXG4gKiBGID0gYXBwbGllZCBmb3JjZSwgTlxyXG4gKiBrID0gc3ByaW5nIGNvbnN0YW50LCBOL21cclxuICogeCA9IGRpc3BsYWNlbWVudCBmcm9tIGVxdWlsaWJyaXVtIHBvc2l0aW9uLCBtXHJcbiAqIEUgPSBwb3RlbnRpYWwgZW5lcmd5LCBKXHJcbiAqXHJcbiAqIEVpdGhlciBkaXNwbGFjZW1lbnQgcmFuZ2Ugb3IgYXBwbGllZCBmb3JjZSByYW5nZSBtdXN0IGJlIHNwZWNpZmllZCwgYnV0IG5vdCBib3RoLlxyXG4gKiBUaGUgdW5zcGVjaWZpZWQgcmFuZ2UgaXMgY29tcHV0ZWQsIGFuZCB3aGljaGV2ZXIgcmFuZ2UgaXMgbm90IHNwZWNpZmllZCBpcyB0aGVcclxuICogcXVhbnRpdHkgdGhhdCBjaGFuZ2VzIHdoZW4gc3ByaW5nIGNvbnN0YW50IGlzIG1vZGlmaWVkLiBGb3IgZXhhbXBsZSwgaWYgYXBwbGllZCBmb3JjZVxyXG4gKiByYW5nZSBpcyBzcGVjaWZpZWQsIHRoZW4gZGlzcGxhY2VtZW50IHJhbmdlIGlzIGNvbXB1dGVkLCBhbmQgY2hhbmdpbmcgc3ByaW5nIGNvbnN0YW50XHJcbiAqIHdpbGwgbW9kaWZ5IGRpc3BsYWNlbWVudC4gSGVyZSdzIGhvdyB0aGF0IGFwcGxpZXMgdG8gdGhpcyBzaW0ncyBzY3JlZW5zOlxyXG4gKlxyXG4gKiBJbnRybyBhbmQgU3lzdGVtcyBzY3JlZW5zIChhcHBsaWVkRm9yY2VSYW5nZSBzcGVjaWZpZWQpOlxyXG4gKlxyXG4gKiBGIGNoYW5nZSA9PiBjb21wdXRlIHhcclxuICogayBjaGFuZ2UgPT4gY29tcHV0ZSB4XHJcbiAqIHggY2hhbmdlID0+IGNvbXB1dGUgRlxyXG4gKlxyXG4gKiBFbmVyZ3kgc2NyZWVuIChkaXNwbGFjZW1lbnRSYW5nZSBzcGVjaWZpZWQpOlxyXG4gKlxyXG4gKiBGIGNoYW5nZSA9PiBjb21wdXRlIHhcclxuICogayBjaGFuZ2UgPT4gY29tcHV0ZSBGXHJcbiAqIHggY2hhbmdlID0+IGNvbXB1dGUgRlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgTnVtYmVyUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9OdW1iZXJQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBUUmVhZE9ubHlQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IFJhbmdlIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9SYW5nZS5qcyc7XHJcbmltcG9ydCBSYW5nZVdpdGhWYWx1ZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2VXaXRoVmFsdWUuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgUGlja09wdGlvbmFsIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrT3B0aW9uYWwuanMnO1xyXG5pbXBvcnQgUGlja1JlcXVpcmVkIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy90eXBlcy9QaWNrUmVxdWlyZWQuanMnO1xyXG5pbXBvcnQgUGhldGlvT2JqZWN0LCB7IFBoZXRpb09iamVjdE9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvUGhldGlvT2JqZWN0LmpzJztcclxuaW1wb3J0IE51bWJlcklPIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy90eXBlcy9OdW1iZXJJTy5qcyc7XHJcbmltcG9ydCBob29rZXNMYXcgZnJvbSAnLi4vLi4vaG9va2VzTGF3LmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgbG9nTmFtZT86IHN0cmluZyB8IG51bGw7IC8vIG5hbWUgdGhhdCBhcHBlYXJzIGluIGxvZyBtZXNzYWdlc1xyXG4gIGxlZnQ/OiBudW1iZXI7IC8vIHggcG9zaXRpb24gb2YgdGhlIGxlZnQgZW5kIG9mIHRoZSBzcHJpbmcsIHVuaXRzID0gbVxyXG4gIGVxdWlsaWJyaXVtTGVuZ3RoPzogbnVtYmVyOyAvLyBsZW5ndGggb2YgdGhlIHNwcmluZyBhdCBlcXVpbGlicml1bSwgdW5pdHMgPSBtXHJcbiAgc3ByaW5nQ29uc3RhbnRSYW5nZT86IFJhbmdlV2l0aFZhbHVlOyAvLyB7c3ByaW5nIGNvbnN0YW50IHJhbmdlIGFuZCBpbml0aWFsIHZhbHVlLCB1bml0cyA9IE4vbVxyXG4gIGFwcGxpZWRGb3JjZVJhbmdlPzogUmFuZ2VXaXRoVmFsdWUgfCBudWxsOyAvLyBhcHBsaWVkIGZvcmNlIHJhbmdlIGFuZCBpbml0aWFsIHZhbHVlLCB1bml0cyA9IE5cclxuICBkaXNwbGFjZW1lbnRSYW5nZT86IFJhbmdlV2l0aFZhbHVlIHwgbnVsbDsgIC8vIGRpc3BsYWNlbWVudCByYW5nZSBhbmQgaW5pdGlhbCB2YWx1ZSwgdW5pdHMgPSBtXHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBTcHJpbmdPcHRpb25zID0gU2VsZk9wdGlvbnMgJlxyXG4gIFBpY2tPcHRpb25hbDxQaGV0aW9PYmplY3RPcHRpb25zLCAncGhldGlvRG9jdW1lbnRhdGlvbic+ICZcclxuICBQaWNrUmVxdWlyZWQ8UGhldGlvT2JqZWN0T3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3ByaW5nIGV4dGVuZHMgUGhldGlvT2JqZWN0IHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IGVxdWlsaWJyaXVtTGVuZ3RoOiBudW1iZXI7XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBzcHJpbmdDb25zdGFudFJhbmdlOiBSYW5nZVdpdGhWYWx1ZTtcclxuICBwdWJsaWMgcmVhZG9ubHkgYXBwbGllZEZvcmNlUmFuZ2U6IFJhbmdlV2l0aFZhbHVlO1xyXG4gIHB1YmxpYyByZWFkb25seSBkaXNwbGFjZW1lbnRSYW5nZTogUmFuZ2VXaXRoVmFsdWU7XHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBhcHBsaWVkRm9yY2VQcm9wZXJ0eTogTnVtYmVyUHJvcGVydHk7IC8vIGFwcGxpZWQgZm9yY2UgKEYpXHJcbiAgcHVibGljIHJlYWRvbmx5IHNwcmluZ0NvbnN0YW50UHJvcGVydHk6IE51bWJlclByb3BlcnR5OyAvLyBzcHJpbmcgY29uc3RhbnQgKGspXHJcbiAgcHVibGljIHJlYWRvbmx5IGRpc3BsYWNlbWVudFByb3BlcnR5OiBOdW1iZXJQcm9wZXJ0eTsgLy8gZGlzcGxhY2VtZW50IGZyb20gZXF1aWxpYnJpdW0gcG9zaXRpb24gKHgpXHJcbiAgcHVibGljIHJlYWRvbmx5IGxlZnRQcm9wZXJ0eTogTnVtYmVyUHJvcGVydHk7IC8vIHBvc2l0aW9uIG9mIHRoZSBsZWZ0IGVuZCBvZiB0aGUgc3ByaW5nXHJcblxyXG4gIHB1YmxpYyByZWFkb25seSBzcHJpbmdGb3JjZVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+OyAvLyBzcHJpbmcgZm9yY2Ugb3Bwb3NlcyB0aGUgYXBwbGllZCBmb3JjZSAoLUYpXHJcbiAgcHVibGljIHJlYWRvbmx5IGVxdWlsaWJyaXVtWFByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+OyAvLyBlcXVpbGlicml1bSB4IHBvc2l0aW9uXHJcbiAgcHVibGljIHJlYWRvbmx5IHJpZ2h0UHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47IC8vIHggcG9zaXRpb24gb2YgdGhlIHJpZ2h0IGVuZCBvZiB0aGUgc3ByaW5nXHJcbiAgcHVibGljIHJlYWRvbmx5IHJpZ2h0UmFuZ2VQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8UmFuZ2U+OyAvLyBSYW5nZSBvZiB0aGUgcmlnaHQgZW5kIG9mIHRoZSBzcHJpbmdcclxuICBwdWJsaWMgcmVhZG9ubHkgbGVuZ3RoUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj47IC8vIGxlbmd0aCBvZiB0aGUgc3ByaW5nXHJcbiAgcHVibGljIHJlYWRvbmx5IHBvdGVudGlhbEVuZXJneVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+OyAvLyBwb3RlbnRpYWwgZW5lcmd5LCBFXHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcHJvdmlkZWRPcHRpb25zOiBTcHJpbmdPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8U3ByaW5nT3B0aW9ucywgU2VsZk9wdGlvbnMsIFBoZXRpb09iamVjdE9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIFNlbGZPcHRpb25zXHJcbiAgICAgIGxvZ05hbWU6IG51bGwsXHJcbiAgICAgIGxlZnQ6IDAsXHJcbiAgICAgIGVxdWlsaWJyaXVtTGVuZ3RoOiAxLjUsXHJcbiAgICAgIHNwcmluZ0NvbnN0YW50UmFuZ2U6IG5ldyBSYW5nZVdpdGhWYWx1ZSggMTAwLCAxMDAwLCAyMDAgKSxcclxuICAgICAgYXBwbGllZEZvcmNlUmFuZ2U6IG51bGwsXHJcbiAgICAgIGRpc3BsYWNlbWVudFJhbmdlOiBudWxsLFxyXG4gICAgICBwaGV0aW9TdGF0ZTogZmFsc2UgLy8gc2luY2UgdGhpcyB0eXBlIGhhcyBubyBpbmhlcmVudCBzdGF0ZSB0byBzYXZlLCB0byBhdm9pZCBjaXJjdWxhciBKU09OIGVycm9yXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIHZhbGlkYXRlIGFuZCBzYXZlIG9wdGlvbnNcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG9wdGlvbnMuZXF1aWxpYnJpdW1MZW5ndGggPiAwLCBgZXF1aWxpYnJpdW1MZW5ndGggbXVzdCBiZSA+IDAgOiAke29wdGlvbnMuZXF1aWxpYnJpdW1MZW5ndGh9YCApO1xyXG4gICAgdGhpcy5lcXVpbGlicml1bUxlbmd0aCA9IG9wdGlvbnMuZXF1aWxpYnJpdW1MZW5ndGg7XHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy5zcHJpbmdDb25zdGFudFJhbmdlLm1pbiA+IDAsXHJcbiAgICAgIGBtaW5pbXVtIHNwcmluZyBjb25zdGFudCBtdXN0IGJlIHBvc2l0aXZlIDogJHtvcHRpb25zLnNwcmluZ0NvbnN0YW50UmFuZ2UubWlufWAgKTtcclxuICAgIHRoaXMuc3ByaW5nQ29uc3RhbnRSYW5nZSA9IG9wdGlvbnMuc3ByaW5nQ29uc3RhbnRSYW5nZTtcclxuXHJcbiAgICAvLyBFaXRoZXIgYXBwbGllZEZvcmNlUmFuZ2Ugb3IgZGlzcGxhY2VtZW50UmFuZ2UgbXVzdCBiZSBzcGVjaWZpZWQsIGFuZCB0aGUgb3RoZXIgaXMgY29tcHV0ZWQuXHJcbiAgICAvLyBJbnRybyBhbmQgU3lzdGVtcyBzY3JlZW5zIHNwZWNpZnkgYXBwbGllZEZvcmNlUmFuZ2UuIEVuZXJneSBzY3JlZW4gc3BlY2lmaWVzIGRpc3BsYWNlbWVudFJhbmdlLlxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggKCBvcHRpb25zLmFwcGxpZWRGb3JjZVJhbmdlICYmICFvcHRpb25zLmRpc3BsYWNlbWVudFJhbmdlICkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICggIW9wdGlvbnMuYXBwbGllZEZvcmNlUmFuZ2UgJiYgb3B0aW9ucy5kaXNwbGFjZW1lbnRSYW5nZSApLFxyXG4gICAgICAnc3BlY2lmeSBlaXRoZXIgYXBwbGllZEZvcmNlUmFuZ2Ugb3IgZGlzcGxhY2VtZW50UmFuZ2UsIGJ1dCBub3QgYm90aCcgKTtcclxuICAgIGlmICggb3B0aW9ucy5hcHBsaWVkRm9yY2VSYW5nZSApIHtcclxuICAgICAgdGhpcy5hcHBsaWVkRm9yY2VSYW5nZSA9IG9wdGlvbnMuYXBwbGllZEZvcmNlUmFuZ2U7XHJcblxyXG4gICAgICAvLyB4ID0gRi9rLCByZWFkLW9ubHlcclxuICAgICAgdGhpcy5kaXNwbGFjZW1lbnRSYW5nZSA9IG5ldyBSYW5nZVdpdGhWYWx1ZShcclxuICAgICAgICB0aGlzLmFwcGxpZWRGb3JjZVJhbmdlLm1pbiAvIHRoaXMuc3ByaW5nQ29uc3RhbnRSYW5nZS5taW4sXHJcbiAgICAgICAgdGhpcy5hcHBsaWVkRm9yY2VSYW5nZS5tYXggLyB0aGlzLnNwcmluZ0NvbnN0YW50UmFuZ2UubWluLFxyXG4gICAgICAgIHRoaXMuYXBwbGllZEZvcmNlUmFuZ2UuZGVmYXVsdFZhbHVlIC8gdGhpcy5zcHJpbmdDb25zdGFudFJhbmdlLmRlZmF1bHRWYWx1ZSApO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRoaXMuZGlzcGxhY2VtZW50UmFuZ2UgPSBvcHRpb25zLmRpc3BsYWNlbWVudFJhbmdlITtcclxuICAgICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5kaXNwbGFjZW1lbnRSYW5nZSApO1xyXG5cclxuICAgICAgLy8gRiA9IGt4LCByZWFkLW9ubHlcclxuICAgICAgdGhpcy5hcHBsaWVkRm9yY2VSYW5nZSA9IG5ldyBSYW5nZVdpdGhWYWx1ZShcclxuICAgICAgICB0aGlzLnNwcmluZ0NvbnN0YW50UmFuZ2UubWF4ICogdGhpcy5kaXNwbGFjZW1lbnRSYW5nZS5taW4sXHJcbiAgICAgICAgdGhpcy5zcHJpbmdDb25zdGFudFJhbmdlLm1heCAqIHRoaXMuZGlzcGxhY2VtZW50UmFuZ2UubWF4LFxyXG4gICAgICAgIHRoaXMuc3ByaW5nQ29uc3RhbnRSYW5nZS5kZWZhdWx0VmFsdWUgKiB0aGlzLmRpc3BsYWNlbWVudFJhbmdlLmRlZmF1bHRWYWx1ZSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBQcm9wZXJ0aWVzXHJcblxyXG4gICAgdGhpcy5hcHBsaWVkRm9yY2VQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggdGhpcy5hcHBsaWVkRm9yY2VSYW5nZS5kZWZhdWx0VmFsdWUsIHtcclxuXHJcbiAgICAgIC8vIEFwcGxpZWQgZm9yY2UgKEYpIGFuZCBkaXNwbGFjZW1lbnQgKHgpIHBhcnRpY2lwYXRlIGluIGEgMi13YXkgcmVsYXRpb25zaGlwLCB3aGVyZSBjaGFuZ2luZ1xyXG4gICAgICAvLyBvbmUgb2YgdGhlbSByZXN1bHRzIGluIHJlY2FsY3VsYXRpb24gb2YgdGhlIG90aGVyLiAgRm9yIHNvbWUgdmFsdWVzLCB0aGlzIHJlc3VsdHMgaW4gZmxvYXRpbmctcG9pbnRcclxuICAgICAgLy8gZXJyb3IgdGhhdCBjYXVzZXMgcmVlbnRyYW50IGJlaGF2aW9yLiAgU2VlICM2My5cclxuICAgICAgcmVlbnRyYW50OiB0cnVlLFxyXG4gICAgICByYW5nZTogdGhpcy5hcHBsaWVkRm9yY2VSYW5nZSxcclxuICAgICAgdW5pdHM6ICdOJyxcclxuICAgICAgdGFuZGVtOiBvcHRpb25zLnRhbmRlbS5jcmVhdGVUYW5kZW0oICdhcHBsaWVkRm9yY2VQcm9wZXJ0eScgKVxyXG4gICAgfSApO1xyXG4gICAgcGhldC5sb2cgJiYgdGhpcy5hcHBsaWVkRm9yY2VQcm9wZXJ0eS5saW5rKCBhcHBsaWVkRm9yY2UgPT4gcGhldC5sb2coIGAke29wdGlvbnMubG9nTmFtZX0gYXBwbGllZEZvcmNlPSR7YXBwbGllZEZvcmNlfWAgKSApO1xyXG5cclxuICAgIHRoaXMuc3ByaW5nQ29uc3RhbnRQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggdGhpcy5zcHJpbmdDb25zdGFudFJhbmdlLmRlZmF1bHRWYWx1ZSwge1xyXG4gICAgICByYW5nZTogdGhpcy5zcHJpbmdDb25zdGFudFJhbmdlLFxyXG4gICAgICB1bml0czogJ04vbScsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnc3ByaW5nQ29uc3RhbnRQcm9wZXJ0eScgKVxyXG4gICAgfSApO1xyXG4gICAgcGhldC5sb2cgJiYgdGhpcy5zcHJpbmdDb25zdGFudFByb3BlcnR5LmxpbmsoIHNwcmluZ0NvbnN0YW50ID0+IHBoZXQubG9nKCBgJHtvcHRpb25zLmxvZ05hbWV9IHNwcmluZ0NvbnN0YW50PSAke3NwcmluZ0NvbnN0YW50fWAgKSApO1xyXG5cclxuICAgIHRoaXMuZGlzcGxhY2VtZW50UHJvcGVydHkgPSBuZXcgTnVtYmVyUHJvcGVydHkoIHRoaXMuZGlzcGxhY2VtZW50UmFuZ2UuZGVmYXVsdFZhbHVlLCB7XHJcblxyXG4gICAgICAvLyBBcHBsaWVkIGZvcmNlIChGKSBhbmQgZGlzcGxhY2VtZW50ICh4KSBwYXJ0aWNpcGF0ZSBpbiBhIDItd2F5IHJlbGF0aW9uc2hpcCwgd2hlcmUgY2hhbmdpbmdcclxuICAgICAgLy8gb25lIG9mIHRoZW0gcmVzdWx0cyBpbiByZWNhbGN1bGF0aW9uIG9mIHRoZSBvdGhlci4gIEZvciBzb21lIHZhbHVlcywgdGhpcyByZXN1bHRzIGluIGZsb2F0aW5nLXBvaW50XHJcbiAgICAgIC8vIGVycm9yIHRoYXQgY2F1c2VzIHJlZW50cmFudCBiZWhhdmlvci4gIFNlZSAjNjMuXHJcbiAgICAgIHJlZW50cmFudDogdHJ1ZSxcclxuICAgICAgcmFuZ2U6IHRoaXMuZGlzcGxhY2VtZW50UmFuZ2UsXHJcbiAgICAgIHVuaXRzOiAnbScsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZGlzcGxhY2VtZW50UHJvcGVydHknIClcclxuICAgIH0gKTtcclxuICAgIHBoZXQubG9nICYmIHRoaXMuZGlzcGxhY2VtZW50UHJvcGVydHkubGluayggZGlzcGxhY2VtZW50ID0+IHBoZXQubG9nKCBgJHtvcHRpb25zLmxvZ05hbWV9IGRpc3BsYWNlbWVudD0ke2Rpc3BsYWNlbWVudH1gICkgKTtcclxuXHJcbiAgICB0aGlzLmxlZnRQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggb3B0aW9ucy5sZWZ0ICk7XHJcbiAgICBwaGV0LmxvZyAmJiB0aGlzLmxlZnRQcm9wZXJ0eS5saW5rKCBsZWZ0ID0+IHBoZXQubG9nKCBgJHtvcHRpb25zLmxvZ05hbWV9IGxlZnQ9JHtsZWZ0fWAgKSApO1xyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBQcm9wZXJ0eSBvYnNlcnZlcnNcclxuXHJcbiAgICAvLyBGOiBXaGVuIGFwcGxpZWQgZm9yY2UgY2hhbmdlcywgbWFpbnRhaW4gc3ByaW5nIGNvbnN0YW50LCBjaGFuZ2UgZGlzcGxhY2VtZW50LlxyXG4gICAgdGhpcy5hcHBsaWVkRm9yY2VQcm9wZXJ0eS5saW5rKCBhcHBsaWVkRm9yY2UgPT4ge1xyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLmFwcGxpZWRGb3JjZVJhbmdlLmNvbnRhaW5zKCBhcHBsaWVkRm9yY2UgKSxcclxuICAgICAgICBgYXBwbGllZEZvcmNlIGlzIG91dCBvZiByYW5nZTogJHthcHBsaWVkRm9yY2V9YCApO1xyXG5cclxuICAgICAgLy8geCA9IEYva1xyXG4gICAgICB0aGlzLmRpc3BsYWNlbWVudFByb3BlcnR5LnZhbHVlID0gKCBhcHBsaWVkRm9yY2UgLyB0aGlzLnNwcmluZ0NvbnN0YW50UHJvcGVydHkudmFsdWUgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBrOiBXaGVuIHNwcmluZyBjb25zdGFudCBjaGFuZ2VzLCBhZGp1c3QgZWl0aGVyIGFwcGxpZWQgZm9yY2Ugb3IgZGlzcGxhY2VtZW50LlxyXG4gICAgdGhpcy5zcHJpbmdDb25zdGFudFByb3BlcnR5LmxpbmsoIHNwcmluZ0NvbnN0YW50ID0+IHtcclxuICAgICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5zcHJpbmdDb25zdGFudFJhbmdlLmNvbnRhaW5zKCBzcHJpbmdDb25zdGFudCApLFxyXG4gICAgICAgIGBzcHJpbmdDb25zdGFudCBpcyBvdXQgb2YgcmFuZ2U6ICR7c3ByaW5nQ29uc3RhbnR9YCApO1xyXG5cclxuICAgICAgaWYgKCBvcHRpb25zLmFwcGxpZWRGb3JjZVJhbmdlICkge1xyXG5cclxuICAgICAgICAvLyBJZiB0aGUgYXBwbGllZCBmb3JjZSByYW5nZSB3YXMgc3BlY2lmaWVkIHZpYSBvcHRpb25zLCB0aGVuIG1haW50YWluIHRoZSBhcHBsaWVkIGZvcmNlLCBjaGFuZ2UgZGlzcGxhY2VtZW50LlxyXG4gICAgICAgIC8vIFRoaXMgYXBwbGllcyB0byB0aGUgSW50cm8gYW5kIFN5c3RlbXMgc2NyZWVucy5cclxuICAgICAgICAvLyB4ID0gRi9rXHJcbiAgICAgICAgdGhpcy5kaXNwbGFjZW1lbnRQcm9wZXJ0eS52YWx1ZSA9ICggdGhpcy5hcHBsaWVkRm9yY2VQcm9wZXJ0eS52YWx1ZSAvIHNwcmluZ0NvbnN0YW50ICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgIC8vIElmIGRpc3BsYWNlbWVudCByYW5nZSB3YXMgc3BlY2lmaWVkIHZpYSBvcHRpb25zLCBtYWludGFpbiB0aGUgZGlzcGxhY2VtZW50LCBjaGFuZ2UgYXBwbGllZCBmb3JjZS5cclxuICAgICAgICAvLyBUaGlzIGFwcGxpZXMgdG8gdGhlIEVuZXJneSBzY3JlZW4uXHJcbiAgICAgICAgLy8gRiA9IGt4XHJcbiAgICAgICAgdGhpcy5hcHBsaWVkRm9yY2VQcm9wZXJ0eS52YWx1ZSA9ICggc3ByaW5nQ29uc3RhbnQgKiB0aGlzLmRpc3BsYWNlbWVudFByb3BlcnR5LnZhbHVlICk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB4OiBXaGVuIGRpc3BsYWNlbWVudCBjaGFuZ2VzLCBtYWludGFpbiB0aGUgc3ByaW5nIGNvbnN0YW50LCBjaGFuZ2UgYXBwbGllZCBmb3JjZS5cclxuICAgIHRoaXMuZGlzcGxhY2VtZW50UHJvcGVydHkubGluayggZGlzcGxhY2VtZW50ID0+IHtcclxuICAgICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5kaXNwbGFjZW1lbnRSYW5nZS5jb250YWlucyggZGlzcGxhY2VtZW50ICksXHJcbiAgICAgICAgYGRpc3BsYWNlbWVudCBpcyBvdXQgb2YgcmFuZ2U6ICR7ZGlzcGxhY2VtZW50fWAgKTtcclxuXHJcbiAgICAgIC8vIEYgPSBreFxyXG4gICAgICBsZXQgYXBwbGllZEZvcmNlID0gdGhpcy5zcHJpbmdDb25zdGFudFByb3BlcnR5LnZhbHVlICogZGlzcGxhY2VtZW50O1xyXG5cclxuICAgICAgLy8gQ29uc3RyYWluIHRvIHJhbmdlLCBuZWVkZWQgZHVlIHRvIGZsb2F0aW5nLXBvaW50IGVycm9yLlxyXG4gICAgICBhcHBsaWVkRm9yY2UgPSB0aGlzLmFwcGxpZWRGb3JjZVJhbmdlLmNvbnN0cmFpblZhbHVlKCBhcHBsaWVkRm9yY2UgKTtcclxuXHJcbiAgICAgIHRoaXMuYXBwbGllZEZvcmNlUHJvcGVydHkudmFsdWUgPSBhcHBsaWVkRm9yY2U7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIERlcml2ZWQgcHJvcGVydGllc1xyXG5cclxuICAgIC8vIHNwcmluZyBmb3JjZSBvcHBvc2VzIHRoZSBhcHBsaWVkIGZvcmNlICgtRilcclxuICAgIHRoaXMuc3ByaW5nRm9yY2VQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5hcHBsaWVkRm9yY2VQcm9wZXJ0eSBdLFxyXG4gICAgICBhcHBsaWVkRm9yY2UgPT4gLWFwcGxpZWRGb3JjZSwge1xyXG4gICAgICAgIHVuaXRzOiAnTicsXHJcbiAgICAgICAgcGhldGlvVmFsdWVUeXBlOiBOdW1iZXJJTyxcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3NwcmluZ0ZvcmNlUHJvcGVydHknIClcclxuICAgICAgfSApO1xyXG4gICAgcGhldC5sb2cgJiYgdGhpcy5zcHJpbmdGb3JjZVByb3BlcnR5LmxpbmsoIHNwcmluZ0ZvcmNlID0+IHBoZXQubG9nKCBgJHtvcHRpb25zLmxvZ05hbWV9IHNwcmluZ0ZvcmNlPSR7c3ByaW5nRm9yY2V9YCApICk7XHJcblxyXG4gICAgLy8gVGhpcyBtdXN0IGJlIGEgUHJvcGVydHkgdG8gc3VwcG9ydCBzeXN0ZW1zIG9mIHNwcmluZ3MuIEZvciBleGFtcGxlLCBmb3IgMiBzcHJpbmdzIGluIHNlcmllcyxcclxuICAgIC8vIGVxdWlsaWJyaXVtWFByb3BlcnR5IGNoYW5nZXMgZm9yIHRoZSByaWdodCBzcHJpbmcsIHdob3NlIGxlZnQgZW5kIG1vdmVzLlxyXG4gICAgdGhpcy5lcXVpbGlicml1bVhQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5sZWZ0UHJvcGVydHkgXSxcclxuICAgICAgbGVmdCA9PiBsZWZ0ICsgdGhpcy5lcXVpbGlicml1bUxlbmd0aFxyXG4gICAgKTtcclxuICAgIHBoZXQubG9nICYmIHRoaXMuZXF1aWxpYnJpdW1YUHJvcGVydHkubGluayggZXF1aWxpYnJpdW1YID0+IHBoZXQubG9nKCBgJHtvcHRpb25zLmxvZ05hbWV9IGVxdWlsaWJyaXVtWD0ke2VxdWlsaWJyaXVtWH1gICkgKTtcclxuXHJcbiAgICB0aGlzLnJpZ2h0UHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHRoaXMuZXF1aWxpYnJpdW1YUHJvcGVydHksIHRoaXMuZGlzcGxhY2VtZW50UHJvcGVydHkgXSxcclxuICAgICAgKCBlcXVpbGlicml1bVgsIGRpc3BsYWNlbWVudCApID0+IHtcclxuICAgICAgICBjb25zdCBsZWZ0ID0gdGhpcy5sZWZ0UHJvcGVydHkudmFsdWU7XHJcbiAgICAgICAgY29uc3QgcmlnaHQgPSBlcXVpbGlicml1bVggKyBkaXNwbGFjZW1lbnQ7XHJcbiAgICAgICAgYXNzZXJ0ICYmIGFzc2VydCggcmlnaHQgLSBsZWZ0ID4gMCwgYHJpZ2h0IG11c3QgYmUgPiBsZWZ0LCByaWdodD0ke3JpZ2h0fSwgbGVmdD0ke2xlZnR9YCApO1xyXG4gICAgICAgIHJldHVybiByaWdodDtcclxuICAgICAgfSApO1xyXG4gICAgcGhldC5sb2cgJiYgdGhpcy5yaWdodFByb3BlcnR5LmxpbmsoIHJpZ2h0ID0+IHBoZXQubG9nKCBgJHtvcHRpb25zLmxvZ05hbWV9IHJpZ2h0PSR7cmlnaHR9YCApICk7XHJcblxyXG4gICAgLy8gRGVyaXZhdGlvbiBkaWZmZXJzIGRlcGVuZGluZyBvbiB3aGV0aGVyIGNoYW5naW5nIHNwcmluZyBjb25zdGFudCBtb2RpZmllcyBhcHBsaWVkIGZvcmNlIG9yIGRpc3BsYWNlbWVudC5cclxuICAgIGlmICggb3B0aW9ucy5hcHBsaWVkRm9yY2VSYW5nZSApIHtcclxuICAgICAgdGhpcy5yaWdodFJhbmdlUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICAgIFsgdGhpcy5zcHJpbmdDb25zdGFudFByb3BlcnR5LCB0aGlzLmVxdWlsaWJyaXVtWFByb3BlcnR5IF0sXHJcbiAgICAgICAgKCBzcHJpbmdDb25zdGFudCwgZXF1aWxpYnJpdW1YICkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgbWluRGlzcGxhY2VtZW50ID0gdGhpcy5hcHBsaWVkRm9yY2VSYW5nZS5taW4gLyBzcHJpbmdDb25zdGFudDtcclxuICAgICAgICAgIGNvbnN0IG1heERpc3BsYWNlbWVudCA9IHRoaXMuYXBwbGllZEZvcmNlUmFuZ2UubWF4IC8gc3ByaW5nQ29uc3RhbnQ7XHJcbiAgICAgICAgICByZXR1cm4gbmV3IFJhbmdlKCBlcXVpbGlicml1bVggKyBtaW5EaXNwbGFjZW1lbnQsIGVxdWlsaWJyaXVtWCArIG1heERpc3BsYWNlbWVudCApO1xyXG4gICAgICAgIH0gKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICB0aGlzLnJpZ2h0UmFuZ2VQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgICAgWyB0aGlzLmVxdWlsaWJyaXVtWFByb3BlcnR5IF0sXHJcbiAgICAgICAgZXF1aWxpYnJpdW1YID0+IG5ldyBSYW5nZSggZXF1aWxpYnJpdW1YICsgdGhpcy5kaXNwbGFjZW1lbnRSYW5nZS5taW4sIGVxdWlsaWJyaXVtWCArIHRoaXMuZGlzcGxhY2VtZW50UmFuZ2UubWF4IClcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIHBoZXQubG9nICYmIHRoaXMucmlnaHRSYW5nZVByb3BlcnR5LmxpbmsoIHJpZ2h0UmFuZ2UgPT4gcGhldC5sb2coIGAke29wdGlvbnMubG9nTmFtZX0gcmlnaHRSYW5nZT0ke3JpZ2h0UmFuZ2V9YCApICk7XHJcblxyXG4gICAgdGhpcy5sZW5ndGhQcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIFsgdGhpcy5sZWZ0UHJvcGVydHksIHRoaXMucmlnaHRQcm9wZXJ0eSBdLFxyXG4gICAgICAoIGxlZnQsIHJpZ2h0ICkgPT4gTWF0aC5hYnMoIHJpZ2h0IC0gbGVmdCApXHJcbiAgICApO1xyXG4gICAgcGhldC5sb2cgJiYgdGhpcy5sZW5ndGhQcm9wZXJ0eS5saW5rKCBsZW5ndGggPT4gcGhldC5sb2coIGAke29wdGlvbnMubG9nTmFtZX0gbGVuZ3RoPSR7bGVuZ3RofWAgKSApO1xyXG5cclxuICAgIC8vIHBvdGVudGlhbCBlbmVyZ3ksIEUgPSAoIGsxICogeDEgKiB4MSApIC8gMlxyXG4gICAgLy8gVG8gYXZvaWQgaW50ZXJtZWRpYXRlIHZhbHVlcywgZGVmaW5lIHRoaXMgKmFmdGVyKiB0aGUgbGlzdGVuZXJzIHRoYXQgdXBkYXRlIGl0cyBkZXBlbmRlbmNpZXMuXHJcbiAgICB0aGlzLnBvdGVudGlhbEVuZXJneVByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyB0aGlzLnNwcmluZ0NvbnN0YW50UHJvcGVydHksIHRoaXMuZGlzcGxhY2VtZW50UHJvcGVydHkgXSxcclxuICAgICAgKCBzcHJpbmdDb25zdGFudCwgZGlzcGxhY2VtZW50ICkgPT4gKCBzcHJpbmdDb25zdGFudCAqIGRpc3BsYWNlbWVudCAqIGRpc3BsYWNlbWVudCApIC8gMiwge1xyXG4gICAgICAgIHVuaXRzOiAnSicsXHJcbiAgICAgICAgcGhldGlvVmFsdWVUeXBlOiBOdW1iZXJJTyxcclxuICAgICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3BvdGVudGlhbEVuZXJneVByb3BlcnR5JyApXHJcbiAgICAgIH0gKTtcclxuICAgIHBoZXQubG9nICYmIHRoaXMucG90ZW50aWFsRW5lcmd5UHJvcGVydHkubGluayggcG90ZW50aWFsRW5lcmd5ID0+IHBoZXQubG9nKCBgJHtvcHRpb25zLmxvZ05hbWV9IHBvdGVudGlhbEVuZXJneT0ke3BvdGVudGlhbEVuZXJneX1gICkgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggZmFsc2UsICdkaXNwb3NlIGlzIG5vdCBzdXBwb3J0ZWQsIGV4aXN0cyBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBzaW0nICk7XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcmVzZXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmFwcGxpZWRGb3JjZVByb3BlcnR5LnJlc2V0KCk7XHJcbiAgICB0aGlzLnNwcmluZ0NvbnN0YW50UHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMuZGlzcGxhY2VtZW50UHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMubGVmdFByb3BlcnR5LnJlc2V0KCk7XHJcbiAgfVxyXG59XHJcblxyXG5ob29rZXNMYXcucmVnaXN0ZXIoICdTcHJpbmcnLCBTcHJpbmcgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsY0FBYyxNQUFNLHVDQUF1QztBQUVsRSxPQUFPQyxLQUFLLE1BQU0sNkJBQTZCO0FBQy9DLE9BQU9DLGNBQWMsTUFBTSxzQ0FBc0M7QUFDakUsT0FBT0MsU0FBUyxNQUFNLHVDQUF1QztBQUc3RCxPQUFPQyxZQUFZLE1BQStCLHVDQUF1QztBQUN6RixPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELE9BQU9DLFNBQVMsTUFBTSxvQkFBb0I7QUFlMUMsZUFBZSxNQUFNQyxNQUFNLFNBQVNILFlBQVksQ0FBQztFQVFPO0VBQ0U7RUFDRjtFQUNSOztFQUVrQjtFQUNDO0VBQ1A7RUFDSTtFQUNIO0VBQ1M7O0VBRTdESSxXQUFXQSxDQUFFQyxlQUE4QixFQUFHO0lBRW5ELE1BQU1DLE9BQU8sR0FBR1AsU0FBUyxDQUFrRCxDQUFDLENBQUU7TUFFNUU7TUFDQVEsT0FBTyxFQUFFLElBQUk7TUFDYkMsSUFBSSxFQUFFLENBQUM7TUFDUEMsaUJBQWlCLEVBQUUsR0FBRztNQUN0QkMsbUJBQW1CLEVBQUUsSUFBSVosY0FBYyxDQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBSSxDQUFDO01BQ3pEYSxpQkFBaUIsRUFBRSxJQUFJO01BQ3ZCQyxp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