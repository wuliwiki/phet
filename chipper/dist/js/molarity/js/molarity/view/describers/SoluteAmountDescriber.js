// Copyright 2019-2022, University of Colorado Boulder

/**
 * SoluteAmountDescriber is responsible for generating strings about Solution.soluteAmountProperty.
 *
 * @author Michael Kauzmann (PhET Interactive Simulations)
 * @author Taylor Want (PhET Interactive Simulations)
 */

import Utils from '../../../../../dot/js/Utils.js';
import StringUtils from '../../../../../phetcommon/js/util/StringUtils.js';
import molarity from '../../../molarity.js';
import MolarityStrings from '../../../MolarityStrings.js';
import MolarityConstants from '../../MolarityConstants.js';
import SolutionQuantityDescriber from './SolutionQuantityDescriber.js';
const beakerSoluteAmountPatternString = MolarityStrings.a11y.beaker.soluteAmountPattern;
const quantitativeSoluteAmountAndUnitPatternString = MolarityStrings.a11y.quantitative.soluteAmountAndUnitPattern;
const quantityChangeSoluteAmountChangedPatternString = MolarityStrings.a11y.quantityChange.soluteAmountChangedPattern;
const quantityChangeColorChangePatternString = MolarityStrings.a11y.quantityChange.colorChangePattern;
const qualitativeSoluteAmountStatePatternString = MolarityStrings.a11y.qualitative.soluteAmountStatePattern;

// solute amount regions capitalized strings
const soluteAmountRegionsNoString = MolarityStrings.a11y.soluteAmountRegions.no;
const soluteAmountRegionsATinyBitOfString = MolarityStrings.a11y.soluteAmountRegions.aTinyBitOf;
const soluteAmountRegionsALittleString = MolarityStrings.a11y.soluteAmountRegions.aLittle;
const soluteAmountRegionsSomeString = MolarityStrings.a11y.soluteAmountRegions.some;
const soluteAmountRegionsALotOfString = MolarityStrings.a11y.soluteAmountRegions.aLotOf;
const soluteAmountRegionsABunchOfString = MolarityStrings.a11y.soluteAmountRegions.aBunchOf;
const soluteAmountRegionsMaxAmountOfString = MolarityStrings.a11y.soluteAmountRegions.maxAmountOf;

// change strings
const lessCapitalizedString = MolarityStrings.a11y.less.capitalized;
const moreCapitalizedString = MolarityStrings.a11y.more.capitalized;
const quantityChangeLighterString = MolarityStrings.a11y.quantityChange.lighter;
const quantityChangeDarkerString = MolarityStrings.a11y.quantityChange.darker;

// constants
const SOLUTE_AMOUNT_STRINGS = [soluteAmountRegionsNoString, soluteAmountRegionsATinyBitOfString, soluteAmountRegionsALittleString, soluteAmountRegionsSomeString, soluteAmountRegionsABunchOfString, soluteAmountRegionsALotOfString, soluteAmountRegionsMaxAmountOfString];
class SoluteAmountDescriber extends SolutionQuantityDescriber {
  /**
   * @param {Property.<number>} soluteAmountProperty - from model.
   * @param {SoluteDescriber} soluteDescriber
   * @param {Property.<boolean>} useQuantitativeDescriptionsProperty
   */
  constructor(soluteAmountProperty, soluteDescriber, useQuantitativeDescriptionsProperty) {
    super();

    // @private
    this.soluteAmountProperty = soluteAmountProperty;
    this.soluteDescriber = soluteDescriber;
    this.useQuantitativeDescriptionsProperty = useQuantitativeDescriptionsProperty;

    // @private
    // {number} - the index of the descriptive region from SOLUTE_AMOUNT_STRINGS arrays.
    let currentRegion = soluteAmountToIndex(this.soluteAmountProperty.value);

    // @private
    // {boolean} - tracks whether the descriptive solute amount region has just changed.
    this.soluteAmountRegionChanged = false;

    // @private
    // {boolean|null} - tracks whether solute amount has just increased. null when simulation starts or resets.
    this.soluteAmountIncreased = null;
    this.soluteAmountProperty.link((newValue, oldValue) => {
      assert && oldValue && assert(currentRegion === soluteAmountToIndex(oldValue), 'current solute amount region not tracking the previous region as expected');
      const oldRegion = currentRegion;
      currentRegion = soluteAmountToIndex(newValue);
      this.soluteAmountRegionChanged = currentRegion !== oldRegion;
      this.soluteAmountIncreased = newValue > oldValue;
    });
  }

  /**
   * Note: this getter name must be the same as its counterpart in VolumeDescriber
   * @public
   * @returns {boolean}
   * @override
   */
  getRegionChanged() {
    return this.soluteAmountRegionChanged;
  }

  /**
   * Creates a string that qualitatively or quantitatively describes the solute amount in the beaker.
   * @public
   * @returns {string} - e.g. 'contains a lot of potassium permanganate" or "contains 3.400 moles of drink mix"
   */
  getBeakerSoluteAmountString() {
    return StringUtils.fillIn(beakerSoluteAmountPatternString, {
      soluteAmount: this.getCurrentSoluteAmount(),
      solute: this.soluteDescriber.getCurrentSoluteName()
    });
  }

  /**
   * Creates the substrings to describe the change in solute amount and the resulting change in solution color.
   * This function must have the same name as its counterpart in VolumeDescriber. This function should only be called
   * as a result of the soluteAmountProperty changing (hence usage of `this.soluteAmountIncreased`.
   * @public
   * @returns {StringsFromSliderChange} - contains two strings.
   * @override
   */
  getStringsFromSliderChange() {
    return {
      // "quantity" meaning "solute amount" here
      quantityChangeString: StringUtils.fillIn(quantityChangeSoluteAmountChangedPatternString, {
        moreLess: this.soluteAmountIncreased ? moreCapitalizedString : lessCapitalizedString
      }),
      colorChangeString: StringUtils.fillIn(quantityChangeColorChangePatternString, {
        lighterDarker: this.soluteAmountIncreased ? quantityChangeDarkerString : quantityChangeLighterString
      })
    };
  }

  /**
   * Gets the current value of soluteAmount either quantitatively or quantitatively to plug into descriptions.
   * Examples: "0.800 Moles" for quantitative or "A lot of" for qualitative
   * @param [isCapitalized] {boolean} - ignored if using quantitative descriptions
   * @public
   * @returns {string} - quantitative or qualitative description of current soluteAmount.
   */
  getCurrentSoluteAmount() {
    if (this.useQuantitativeDescriptionsProperty.value) {
      const soluteAmountMin = MolarityConstants.SOLUTE_AMOUNT_RANGE.min;
      const soluteAmountMax = MolarityConstants.SOLUTE_AMOUNT_RANGE.max;
      const clampedSoluteAmount = Utils.clamp(this.soluteAmountProperty.value, soluteAmountMin, soluteAmountMax);
      return StringUtils.fillIn(quantitativeSoluteAmountAndUnitPatternString, {
        soluteAmount: Utils.toFixed(clampedSoluteAmount, MolarityConstants.SOLUTE_AMOUNT_DECIMAL_PLACES)
      });
    } else {
      return SOLUTE_AMOUNT_STRINGS[soluteAmountToIndex(this.soluteAmountProperty.value)];
    }
  }

  /**
   * Generates the aria-value text for the solute amount slider
   * @public
   * @returns {string}
   */
  getSoluteAmountValueText() {
    return this.useQuantitativeDescriptionsProperty.value ? this.getCurrentSoluteAmount() : StringUtils.fillIn(qualitativeSoluteAmountStatePatternString, {
      soluteAmount: this.getCurrentSoluteAmount(),
      solute: this.soluteDescriber.getCurrentSoluteName()
    });
  }
}

/**
 * Calculates which item to use from the SOLUTE_AMOUNT_STRINGS arrays. Region cutoff numbers are based on keypress
 * balances, which are documented here: https://github.com/phetsims/molarity/issues/128
 * @param {number} soluteAmount
 * @returns {number} - index (integer) to pull from SOLUTE_AMOUNT_STRINGS arrays.
 */
const soluteAmountToIndex = soluteAmount => {
  // normalize in case the range changes in the future.
  const normalizedSoluteAmount = MolarityConstants.SOLUTE_AMOUNT_RANGE.getNormalizedValue(soluteAmount);
  if (normalizedSoluteAmount < 0.001) {
    return 0;
  } else if (normalizedSoluteAmount <= 0.151) {
    return 1;
  } else if (normalizedSoluteAmount <= 0.351) {
    return 2;
  } else if (normalizedSoluteAmount <= 0.601) {
    return 3;
  } else if (normalizedSoluteAmount <= 0.801) {
    return 4;
  } else if (normalizedSoluteAmount <= 0.999) {
    return 5;
  } else {
    assert && assert(soluteAmount <= MolarityConstants.SOLUTE_AMOUNT_RANGE.max, 'unexpected solute amount provided');
    return 6;
  }
};
molarity.register('SoluteAmountDescriber', SoluteAmountDescriber);
export default SoluteAmountDescriber;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIlN0cmluZ1V0aWxzIiwibW9sYXJpdHkiLCJNb2xhcml0eVN0cmluZ3MiLCJNb2xhcml0eUNvbnN0YW50cyIsIlNvbHV0aW9uUXVhbnRpdHlEZXNjcmliZXIiLCJiZWFrZXJTb2x1dGVBbW91bnRQYXR0ZXJuU3RyaW5nIiwiYTExeSIsImJlYWtlciIsInNvbHV0ZUFtb3VudFBhdHRlcm4iLCJxdWFudGl0YXRpdmVTb2x1dGVBbW91bnRBbmRVbml0UGF0dGVyblN0cmluZyIsInF1YW50aXRhdGl2ZSIsInNvbHV0ZUFtb3VudEFuZFVuaXRQYXR0ZXJuIiwicXVhbnRpdHlDaGFuZ2VTb2x1dGVBbW91bnRDaGFuZ2VkUGF0dGVyblN0cmluZyIsInF1YW50aXR5Q2hhbmdlIiwic29sdXRlQW1vdW50Q2hhbmdlZFBhdHRlcm4iLCJxdWFudGl0eUNoYW5nZUNvbG9yQ2hhbmdlUGF0dGVyblN0cmluZyIsImNvbG9yQ2hhbmdlUGF0dGVybiIsInF1YWxpdGF0aXZlU29sdXRlQW1vdW50U3RhdGVQYXR0ZXJuU3RyaW5nIiwicXVhbGl0YXRpdmUiLCJzb2x1dGVBbW91bnRTdGF0ZVBhdHRlcm4iLCJzb2x1dGVBbW91bnRSZWdpb25zTm9TdHJpbmciLCJzb2x1dGVBbW91bnRSZWdpb25zIiwibm8iLCJzb2x1dGVBbW91bnRSZWdpb25zQVRpbnlCaXRPZlN0cmluZyIsImFUaW55Qml0T2YiLCJzb2x1dGVBbW91bnRSZWdpb25zQUxpdHRsZVN0cmluZyIsImFMaXR0bGUiLCJzb2x1dGVBbW91bnRSZWdpb25zU29tZVN0cmluZyIsInNvbWUiLCJzb2x1dGVBbW91bnRSZWdpb25zQUxvdE9mU3RyaW5nIiwiYUxvdE9mIiwic29sdXRlQW1vdW50UmVnaW9uc0FCdW5jaE9mU3RyaW5nIiwiYUJ1bmNoT2YiLCJzb2x1dGVBbW91bnRSZWdpb25zTWF4QW1vdW50T2ZTdHJpbmciLCJtYXhBbW91bnRPZiIsImxlc3NDYXBpdGFsaXplZFN0cmluZyIsImxlc3MiLCJjYXBpdGFsaXplZCIsIm1vcmVDYXBpdGFsaXplZFN0cmluZyIsIm1vcmUiLCJxdWFudGl0eUNoYW5nZUxpZ2h0ZXJTdHJpbmciLCJsaWdodGVyIiwicXVhbnRpdHlDaGFuZ2VEYXJrZXJTdHJpbmciLCJkYXJrZXIiLCJTT0xVVEVfQU1PVU5UX1NUUklOR1MiLCJTb2x1dGVBbW91bnREZXNjcmliZXIiLCJjb25zdHJ1Y3RvciIsInNvbHV0ZUFtb3VudFByb3BlcnR5Iiwic29sdXRlRGVzY3JpYmVyIiwidXNlUXVhbnRpdGF0aXZlRGVzY3JpcHRpb25zUHJvcGVydHkiLCJjdXJyZW50UmVnaW9uIiwic29sdXRlQW1vdW50VG9JbmRleCIsInZhbHVlIiwic29sdXRlQW1vdW50UmVnaW9uQ2hhbmdlZCIsInNvbHV0ZUFtb3VudEluY3JlYXNlZCIsImxpbmsiLCJuZXdWYWx1ZSIsIm9sZFZhbHVlIiwiYXNzZXJ0Iiwib2xkUmVnaW9uIiwiZ2V0UmVnaW9uQ2hhbmdlZCIsImdldEJlYWtlclNvbHV0ZUFtb3VudFN0cmluZyIsImZpbGxJbiIsInNvbHV0ZUFtb3VudCIsImdldEN1cnJlbnRTb2x1dGVBbW91bnQiLCJzb2x1dGUiLCJnZXRDdXJyZW50U29sdXRlTmFtZSIsImdldFN0cmluZ3NGcm9tU2xpZGVyQ2hhbmdlIiwicXVhbnRpdHlDaGFuZ2VTdHJpbmciLCJtb3JlTGVzcyIsImNvbG9yQ2hhbmdlU3RyaW5nIiwibGlnaHRlckRhcmtlciIsInNvbHV0ZUFtb3VudE1pbiIsIlNPTFVURV9BTU9VTlRfUkFOR0UiLCJtaW4iLCJzb2x1dGVBbW91bnRNYXgiLCJtYXgiLCJjbGFtcGVkU29sdXRlQW1vdW50IiwiY2xhbXAiLCJ0b0ZpeGVkIiwiU09MVVRFX0FNT1VOVF9ERUNJTUFMX1BMQUNFUyIsImdldFNvbHV0ZUFtb3VudFZhbHVlVGV4dCIsIm5vcm1hbGl6ZWRTb2x1dGVBbW91bnQiLCJnZXROb3JtYWxpemVkVmFsdWUiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlNvbHV0ZUFtb3VudERlc2NyaWJlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBTb2x1dGVBbW91bnREZXNjcmliZXIgaXMgcmVzcG9uc2libGUgZm9yIGdlbmVyYXRpbmcgc3RyaW5ncyBhYm91dCBTb2x1dGlvbi5zb2x1dGVBbW91bnRQcm9wZXJ0eS5cclxuICpcclxuICogQGF1dGhvciBNaWNoYWVsIEthdXptYW5uIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIFRheWxvciBXYW50IChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgU3RyaW5nVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy91dGlsL1N0cmluZ1V0aWxzLmpzJztcclxuaW1wb3J0IG1vbGFyaXR5IGZyb20gJy4uLy4uLy4uL21vbGFyaXR5LmpzJztcclxuaW1wb3J0IE1vbGFyaXR5U3RyaW5ncyBmcm9tICcuLi8uLi8uLi9Nb2xhcml0eVN0cmluZ3MuanMnO1xyXG5pbXBvcnQgTW9sYXJpdHlDb25zdGFudHMgZnJvbSAnLi4vLi4vTW9sYXJpdHlDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgU29sdXRpb25RdWFudGl0eURlc2NyaWJlciBmcm9tICcuL1NvbHV0aW9uUXVhbnRpdHlEZXNjcmliZXIuanMnO1xyXG5cclxuY29uc3QgYmVha2VyU29sdXRlQW1vdW50UGF0dGVyblN0cmluZyA9IE1vbGFyaXR5U3RyaW5ncy5hMTF5LmJlYWtlci5zb2x1dGVBbW91bnRQYXR0ZXJuO1xyXG5jb25zdCBxdWFudGl0YXRpdmVTb2x1dGVBbW91bnRBbmRVbml0UGF0dGVyblN0cmluZyA9IE1vbGFyaXR5U3RyaW5ncy5hMTF5LnF1YW50aXRhdGl2ZS5zb2x1dGVBbW91bnRBbmRVbml0UGF0dGVybjtcclxuY29uc3QgcXVhbnRpdHlDaGFuZ2VTb2x1dGVBbW91bnRDaGFuZ2VkUGF0dGVyblN0cmluZyA9IE1vbGFyaXR5U3RyaW5ncy5hMTF5LnF1YW50aXR5Q2hhbmdlLnNvbHV0ZUFtb3VudENoYW5nZWRQYXR0ZXJuO1xyXG5jb25zdCBxdWFudGl0eUNoYW5nZUNvbG9yQ2hhbmdlUGF0dGVyblN0cmluZyA9IE1vbGFyaXR5U3RyaW5ncy5hMTF5LnF1YW50aXR5Q2hhbmdlLmNvbG9yQ2hhbmdlUGF0dGVybjtcclxuY29uc3QgcXVhbGl0YXRpdmVTb2x1dGVBbW91bnRTdGF0ZVBhdHRlcm5TdHJpbmcgPSBNb2xhcml0eVN0cmluZ3MuYTExeS5xdWFsaXRhdGl2ZS5zb2x1dGVBbW91bnRTdGF0ZVBhdHRlcm47XHJcblxyXG4vLyBzb2x1dGUgYW1vdW50IHJlZ2lvbnMgY2FwaXRhbGl6ZWQgc3RyaW5nc1xyXG5jb25zdCBzb2x1dGVBbW91bnRSZWdpb25zTm9TdHJpbmcgPSBNb2xhcml0eVN0cmluZ3MuYTExeS5zb2x1dGVBbW91bnRSZWdpb25zLm5vO1xyXG5jb25zdCBzb2x1dGVBbW91bnRSZWdpb25zQVRpbnlCaXRPZlN0cmluZyA9IE1vbGFyaXR5U3RyaW5ncy5hMTF5LnNvbHV0ZUFtb3VudFJlZ2lvbnMuYVRpbnlCaXRPZjtcclxuY29uc3Qgc29sdXRlQW1vdW50UmVnaW9uc0FMaXR0bGVTdHJpbmcgPSBNb2xhcml0eVN0cmluZ3MuYTExeS5zb2x1dGVBbW91bnRSZWdpb25zLmFMaXR0bGU7XHJcbmNvbnN0IHNvbHV0ZUFtb3VudFJlZ2lvbnNTb21lU3RyaW5nID0gTW9sYXJpdHlTdHJpbmdzLmExMXkuc29sdXRlQW1vdW50UmVnaW9ucy5zb21lO1xyXG5jb25zdCBzb2x1dGVBbW91bnRSZWdpb25zQUxvdE9mU3RyaW5nID0gTW9sYXJpdHlTdHJpbmdzLmExMXkuc29sdXRlQW1vdW50UmVnaW9ucy5hTG90T2Y7XHJcbmNvbnN0IHNvbHV0ZUFtb3VudFJlZ2lvbnNBQnVuY2hPZlN0cmluZyA9IE1vbGFyaXR5U3RyaW5ncy5hMTF5LnNvbHV0ZUFtb3VudFJlZ2lvbnMuYUJ1bmNoT2Y7XHJcbmNvbnN0IHNvbHV0ZUFtb3VudFJlZ2lvbnNNYXhBbW91bnRPZlN0cmluZyA9IE1vbGFyaXR5U3RyaW5ncy5hMTF5LnNvbHV0ZUFtb3VudFJlZ2lvbnMubWF4QW1vdW50T2Y7XHJcblxyXG4vLyBjaGFuZ2Ugc3RyaW5nc1xyXG5jb25zdCBsZXNzQ2FwaXRhbGl6ZWRTdHJpbmcgPSBNb2xhcml0eVN0cmluZ3MuYTExeS5sZXNzLmNhcGl0YWxpemVkO1xyXG5jb25zdCBtb3JlQ2FwaXRhbGl6ZWRTdHJpbmcgPSBNb2xhcml0eVN0cmluZ3MuYTExeS5tb3JlLmNhcGl0YWxpemVkO1xyXG5jb25zdCBxdWFudGl0eUNoYW5nZUxpZ2h0ZXJTdHJpbmcgPSBNb2xhcml0eVN0cmluZ3MuYTExeS5xdWFudGl0eUNoYW5nZS5saWdodGVyO1xyXG5jb25zdCBxdWFudGl0eUNoYW5nZURhcmtlclN0cmluZyA9IE1vbGFyaXR5U3RyaW5ncy5hMTF5LnF1YW50aXR5Q2hhbmdlLmRhcmtlcjtcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBTT0xVVEVfQU1PVU5UX1NUUklOR1MgPSBbXHJcbiAgc29sdXRlQW1vdW50UmVnaW9uc05vU3RyaW5nLFxyXG4gIHNvbHV0ZUFtb3VudFJlZ2lvbnNBVGlueUJpdE9mU3RyaW5nLFxyXG4gIHNvbHV0ZUFtb3VudFJlZ2lvbnNBTGl0dGxlU3RyaW5nLFxyXG4gIHNvbHV0ZUFtb3VudFJlZ2lvbnNTb21lU3RyaW5nLFxyXG4gIHNvbHV0ZUFtb3VudFJlZ2lvbnNBQnVuY2hPZlN0cmluZyxcclxuICBzb2x1dGVBbW91bnRSZWdpb25zQUxvdE9mU3RyaW5nLFxyXG4gIHNvbHV0ZUFtb3VudFJlZ2lvbnNNYXhBbW91bnRPZlN0cmluZ1xyXG5dO1xyXG5cclxuY2xhc3MgU29sdXRlQW1vdW50RGVzY3JpYmVyIGV4dGVuZHMgU29sdXRpb25RdWFudGl0eURlc2NyaWJlciB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPG51bWJlcj59IHNvbHV0ZUFtb3VudFByb3BlcnR5IC0gZnJvbSBtb2RlbC5cclxuICAgKiBAcGFyYW0ge1NvbHV0ZURlc2NyaWJlcn0gc29sdXRlRGVzY3JpYmVyXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48Ym9vbGVhbj59IHVzZVF1YW50aXRhdGl2ZURlc2NyaXB0aW9uc1Byb3BlcnR5XHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHNvbHV0ZUFtb3VudFByb3BlcnR5LCBzb2x1dGVEZXNjcmliZXIsIHVzZVF1YW50aXRhdGl2ZURlc2NyaXB0aW9uc1Byb3BlcnR5ICkge1xyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZVxyXG4gICAgdGhpcy5zb2x1dGVBbW91bnRQcm9wZXJ0eSA9IHNvbHV0ZUFtb3VudFByb3BlcnR5O1xyXG4gICAgdGhpcy5zb2x1dGVEZXNjcmliZXIgPSBzb2x1dGVEZXNjcmliZXI7XHJcbiAgICB0aGlzLnVzZVF1YW50aXRhdGl2ZURlc2NyaXB0aW9uc1Byb3BlcnR5ID0gdXNlUXVhbnRpdGF0aXZlRGVzY3JpcHRpb25zUHJvcGVydHk7XHJcblxyXG4gICAgLy8gQHByaXZhdGVcclxuICAgIC8vIHtudW1iZXJ9IC0gdGhlIGluZGV4IG9mIHRoZSBkZXNjcmlwdGl2ZSByZWdpb24gZnJvbSBTT0xVVEVfQU1PVU5UX1NUUklOR1MgYXJyYXlzLlxyXG4gICAgbGV0IGN1cnJlbnRSZWdpb24gPSBzb2x1dGVBbW91bnRUb0luZGV4KCB0aGlzLnNvbHV0ZUFtb3VudFByb3BlcnR5LnZhbHVlICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGVcclxuICAgIC8vIHtib29sZWFufSAtIHRyYWNrcyB3aGV0aGVyIHRoZSBkZXNjcmlwdGl2ZSBzb2x1dGUgYW1vdW50IHJlZ2lvbiBoYXMganVzdCBjaGFuZ2VkLlxyXG4gICAgdGhpcy5zb2x1dGVBbW91bnRSZWdpb25DaGFuZ2VkID0gZmFsc2U7XHJcblxyXG4gICAgLy8gQHByaXZhdGVcclxuICAgIC8vIHtib29sZWFufG51bGx9IC0gdHJhY2tzIHdoZXRoZXIgc29sdXRlIGFtb3VudCBoYXMganVzdCBpbmNyZWFzZWQuIG51bGwgd2hlbiBzaW11bGF0aW9uIHN0YXJ0cyBvciByZXNldHMuXHJcbiAgICB0aGlzLnNvbHV0ZUFtb3VudEluY3JlYXNlZCA9IG51bGw7XHJcblxyXG4gICAgdGhpcy5zb2x1dGVBbW91bnRQcm9wZXJ0eS5saW5rKCAoIG5ld1ZhbHVlLCBvbGRWYWx1ZSApID0+IHtcclxuICAgICAgYXNzZXJ0ICYmIG9sZFZhbHVlICYmIGFzc2VydCggY3VycmVudFJlZ2lvbiA9PT0gc29sdXRlQW1vdW50VG9JbmRleCggb2xkVmFsdWUgKSxcclxuICAgICAgICAnY3VycmVudCBzb2x1dGUgYW1vdW50IHJlZ2lvbiBub3QgdHJhY2tpbmcgdGhlIHByZXZpb3VzIHJlZ2lvbiBhcyBleHBlY3RlZCcgKTtcclxuICAgICAgY29uc3Qgb2xkUmVnaW9uID0gY3VycmVudFJlZ2lvbjtcclxuICAgICAgY3VycmVudFJlZ2lvbiA9IHNvbHV0ZUFtb3VudFRvSW5kZXgoIG5ld1ZhbHVlICk7XHJcbiAgICAgIHRoaXMuc29sdXRlQW1vdW50UmVnaW9uQ2hhbmdlZCA9IGN1cnJlbnRSZWdpb24gIT09IG9sZFJlZ2lvbjtcclxuICAgICAgdGhpcy5zb2x1dGVBbW91bnRJbmNyZWFzZWQgPSBuZXdWYWx1ZSA+IG9sZFZhbHVlO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTm90ZTogdGhpcyBnZXR0ZXIgbmFtZSBtdXN0IGJlIHRoZSBzYW1lIGFzIGl0cyBjb3VudGVycGFydCBpbiBWb2x1bWVEZXNjcmliZXJcclxuICAgKiBAcHVibGljXHJcbiAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICogQG92ZXJyaWRlXHJcbiAgICovXHJcbiAgZ2V0UmVnaW9uQ2hhbmdlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLnNvbHV0ZUFtb3VudFJlZ2lvbkNoYW5nZWQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIGEgc3RyaW5nIHRoYXQgcXVhbGl0YXRpdmVseSBvciBxdWFudGl0YXRpdmVseSBkZXNjcmliZXMgdGhlIHNvbHV0ZSBhbW91bnQgaW4gdGhlIGJlYWtlci5cclxuICAgKiBAcHVibGljXHJcbiAgICogQHJldHVybnMge3N0cmluZ30gLSBlLmcuICdjb250YWlucyBhIGxvdCBvZiBwb3Rhc3NpdW0gcGVybWFuZ2FuYXRlXCIgb3IgXCJjb250YWlucyAzLjQwMCBtb2xlcyBvZiBkcmluayBtaXhcIlxyXG4gICAqL1xyXG4gIGdldEJlYWtlclNvbHV0ZUFtb3VudFN0cmluZygpIHtcclxuICAgIHJldHVybiBTdHJpbmdVdGlscy5maWxsSW4oIGJlYWtlclNvbHV0ZUFtb3VudFBhdHRlcm5TdHJpbmcsIHtcclxuICAgICAgc29sdXRlQW1vdW50OiB0aGlzLmdldEN1cnJlbnRTb2x1dGVBbW91bnQoKSxcclxuICAgICAgc29sdXRlOiB0aGlzLnNvbHV0ZURlc2NyaWJlci5nZXRDdXJyZW50U29sdXRlTmFtZSgpXHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyB0aGUgc3Vic3RyaW5ncyB0byBkZXNjcmliZSB0aGUgY2hhbmdlIGluIHNvbHV0ZSBhbW91bnQgYW5kIHRoZSByZXN1bHRpbmcgY2hhbmdlIGluIHNvbHV0aW9uIGNvbG9yLlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gbXVzdCBoYXZlIHRoZSBzYW1lIG5hbWUgYXMgaXRzIGNvdW50ZXJwYXJ0IGluIFZvbHVtZURlc2NyaWJlci4gVGhpcyBmdW5jdGlvbiBzaG91bGQgb25seSBiZSBjYWxsZWRcclxuICAgKiBhcyBhIHJlc3VsdCBvZiB0aGUgc29sdXRlQW1vdW50UHJvcGVydHkgY2hhbmdpbmcgKGhlbmNlIHVzYWdlIG9mIGB0aGlzLnNvbHV0ZUFtb3VudEluY3JlYXNlZGAuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqIEByZXR1cm5zIHtTdHJpbmdzRnJvbVNsaWRlckNoYW5nZX0gLSBjb250YWlucyB0d28gc3RyaW5ncy5cclxuICAgKiBAb3ZlcnJpZGVcclxuICAgKi9cclxuICBnZXRTdHJpbmdzRnJvbVNsaWRlckNoYW5nZSgpIHtcclxuICAgIHJldHVybiB7XHJcblxyXG4gICAgICAvLyBcInF1YW50aXR5XCIgbWVhbmluZyBcInNvbHV0ZSBhbW91bnRcIiBoZXJlXHJcbiAgICAgIHF1YW50aXR5Q2hhbmdlU3RyaW5nOiBTdHJpbmdVdGlscy5maWxsSW4oIHF1YW50aXR5Q2hhbmdlU29sdXRlQW1vdW50Q2hhbmdlZFBhdHRlcm5TdHJpbmcsIHtcclxuICAgICAgICBtb3JlTGVzczogdGhpcy5zb2x1dGVBbW91bnRJbmNyZWFzZWQgPyBtb3JlQ2FwaXRhbGl6ZWRTdHJpbmcgOiBsZXNzQ2FwaXRhbGl6ZWRTdHJpbmdcclxuICAgICAgfSApLFxyXG4gICAgICBjb2xvckNoYW5nZVN0cmluZzogU3RyaW5nVXRpbHMuZmlsbEluKCBxdWFudGl0eUNoYW5nZUNvbG9yQ2hhbmdlUGF0dGVyblN0cmluZywge1xyXG4gICAgICAgIGxpZ2h0ZXJEYXJrZXI6IHRoaXMuc29sdXRlQW1vdW50SW5jcmVhc2VkID8gcXVhbnRpdHlDaGFuZ2VEYXJrZXJTdHJpbmcgOiBxdWFudGl0eUNoYW5nZUxpZ2h0ZXJTdHJpbmdcclxuICAgICAgfSApXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyB0aGUgY3VycmVudCB2YWx1ZSBvZiBzb2x1dGVBbW91bnQgZWl0aGVyIHF1YW50aXRhdGl2ZWx5IG9yIHF1YW50aXRhdGl2ZWx5IHRvIHBsdWcgaW50byBkZXNjcmlwdGlvbnMuXHJcbiAgICogRXhhbXBsZXM6IFwiMC44MDAgTW9sZXNcIiBmb3IgcXVhbnRpdGF0aXZlIG9yIFwiQSBsb3Qgb2ZcIiBmb3IgcXVhbGl0YXRpdmVcclxuICAgKiBAcGFyYW0gW2lzQ2FwaXRhbGl6ZWRdIHtib29sZWFufSAtIGlnbm9yZWQgaWYgdXNpbmcgcXVhbnRpdGF0aXZlIGRlc2NyaXB0aW9uc1xyXG4gICAqIEBwdWJsaWNcclxuICAgKiBAcmV0dXJucyB7c3RyaW5nfSAtIHF1YW50aXRhdGl2ZSBvciBxdWFsaXRhdGl2ZSBkZXNjcmlwdGlvbiBvZiBjdXJyZW50IHNvbHV0ZUFtb3VudC5cclxuICAgKi9cclxuICBnZXRDdXJyZW50U29sdXRlQW1vdW50KCkge1xyXG4gICAgaWYgKCB0aGlzLnVzZVF1YW50aXRhdGl2ZURlc2NyaXB0aW9uc1Byb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICBjb25zdCBzb2x1dGVBbW91bnRNaW4gPSBNb2xhcml0eUNvbnN0YW50cy5TT0xVVEVfQU1PVU5UX1JBTkdFLm1pbjtcclxuICAgICAgY29uc3Qgc29sdXRlQW1vdW50TWF4ID0gTW9sYXJpdHlDb25zdGFudHMuU09MVVRFX0FNT1VOVF9SQU5HRS5tYXg7XHJcbiAgICAgIGNvbnN0IGNsYW1wZWRTb2x1dGVBbW91bnQgPSBVdGlscy5jbGFtcCggdGhpcy5zb2x1dGVBbW91bnRQcm9wZXJ0eS52YWx1ZSwgc29sdXRlQW1vdW50TWluLCBzb2x1dGVBbW91bnRNYXggKTtcclxuXHJcbiAgICAgIHJldHVybiBTdHJpbmdVdGlscy5maWxsSW4oIHF1YW50aXRhdGl2ZVNvbHV0ZUFtb3VudEFuZFVuaXRQYXR0ZXJuU3RyaW5nLCB7XHJcbiAgICAgICAgc29sdXRlQW1vdW50OiBVdGlscy50b0ZpeGVkKCBjbGFtcGVkU29sdXRlQW1vdW50LCBNb2xhcml0eUNvbnN0YW50cy5TT0xVVEVfQU1PVU5UX0RFQ0lNQUxfUExBQ0VTIClcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHJldHVybiBTT0xVVEVfQU1PVU5UX1NUUklOR1NbIHNvbHV0ZUFtb3VudFRvSW5kZXgoIHRoaXMuc29sdXRlQW1vdW50UHJvcGVydHkudmFsdWUgKSBdO1xyXG5cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdlbmVyYXRlcyB0aGUgYXJpYS12YWx1ZSB0ZXh0IGZvciB0aGUgc29sdXRlIGFtb3VudCBzbGlkZXJcclxuICAgKiBAcHVibGljXHJcbiAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgKi9cclxuICBnZXRTb2x1dGVBbW91bnRWYWx1ZVRleHQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy51c2VRdWFudGl0YXRpdmVEZXNjcmlwdGlvbnNQcm9wZXJ0eS52YWx1ZSA/XHJcbiAgICAgICAgICAgdGhpcy5nZXRDdXJyZW50U29sdXRlQW1vdW50KCkgOlxyXG4gICAgICAgICAgIFN0cmluZ1V0aWxzLmZpbGxJbiggcXVhbGl0YXRpdmVTb2x1dGVBbW91bnRTdGF0ZVBhdHRlcm5TdHJpbmcsIHtcclxuICAgICAgICAgICAgIHNvbHV0ZUFtb3VudDogdGhpcy5nZXRDdXJyZW50U29sdXRlQW1vdW50KCksXHJcbiAgICAgICAgICAgICBzb2x1dGU6IHRoaXMuc29sdXRlRGVzY3JpYmVyLmdldEN1cnJlbnRTb2x1dGVOYW1lKClcclxuICAgICAgICAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIENhbGN1bGF0ZXMgd2hpY2ggaXRlbSB0byB1c2UgZnJvbSB0aGUgU09MVVRFX0FNT1VOVF9TVFJJTkdTIGFycmF5cy4gUmVnaW9uIGN1dG9mZiBudW1iZXJzIGFyZSBiYXNlZCBvbiBrZXlwcmVzc1xyXG4gKiBiYWxhbmNlcywgd2hpY2ggYXJlIGRvY3VtZW50ZWQgaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL21vbGFyaXR5L2lzc3Vlcy8xMjhcclxuICogQHBhcmFtIHtudW1iZXJ9IHNvbHV0ZUFtb3VudFxyXG4gKiBAcmV0dXJucyB7bnVtYmVyfSAtIGluZGV4IChpbnRlZ2VyKSB0byBwdWxsIGZyb20gU09MVVRFX0FNT1VOVF9TVFJJTkdTIGFycmF5cy5cclxuICovXHJcbmNvbnN0IHNvbHV0ZUFtb3VudFRvSW5kZXggPSBzb2x1dGVBbW91bnQgPT4ge1xyXG5cclxuICAvLyBub3JtYWxpemUgaW4gY2FzZSB0aGUgcmFuZ2UgY2hhbmdlcyBpbiB0aGUgZnV0dXJlLlxyXG4gIGNvbnN0IG5vcm1hbGl6ZWRTb2x1dGVBbW91bnQgPSBNb2xhcml0eUNvbnN0YW50cy5TT0xVVEVfQU1PVU5UX1JBTkdFLmdldE5vcm1hbGl6ZWRWYWx1ZSggc29sdXRlQW1vdW50ICk7XHJcbiAgaWYgKCBub3JtYWxpemVkU29sdXRlQW1vdW50IDwgMC4wMDEgKSB7XHJcbiAgICByZXR1cm4gMDtcclxuICB9XHJcbiAgZWxzZSBpZiAoIG5vcm1hbGl6ZWRTb2x1dGVBbW91bnQgPD0gMC4xNTEgKSB7XHJcbiAgICByZXR1cm4gMTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIG5vcm1hbGl6ZWRTb2x1dGVBbW91bnQgPD0gMC4zNTEgKSB7XHJcbiAgICByZXR1cm4gMjtcclxuICB9XHJcbiAgZWxzZSBpZiAoIG5vcm1hbGl6ZWRTb2x1dGVBbW91bnQgPD0gMC42MDEgKSB7XHJcbiAgICByZXR1cm4gMztcclxuICB9XHJcbiAgZWxzZSBpZiAoIG5vcm1hbGl6ZWRTb2x1dGVBbW91bnQgPD0gMC44MDEgKSB7XHJcbiAgICByZXR1cm4gNDtcclxuICB9XHJcbiAgZWxzZSBpZiAoIG5vcm1hbGl6ZWRTb2x1dGVBbW91bnQgPD0gMC45OTkgKSB7XHJcbiAgICByZXR1cm4gNTtcclxuICB9XHJcbiAgZWxzZSB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBzb2x1dGVBbW91bnQgPD0gTW9sYXJpdHlDb25zdGFudHMuU09MVVRFX0FNT1VOVF9SQU5HRS5tYXgsICd1bmV4cGVjdGVkIHNvbHV0ZSBhbW91bnQgcHJvdmlkZWQnICk7XHJcbiAgICByZXR1cm4gNjtcclxuICB9XHJcbn07XHJcblxyXG5tb2xhcml0eS5yZWdpc3RlciggJ1NvbHV0ZUFtb3VudERlc2NyaWJlcicsIFNvbHV0ZUFtb3VudERlc2NyaWJlciApO1xyXG5leHBvcnQgZGVmYXVsdCBTb2x1dGVBbW91bnREZXNjcmliZXI7Il0s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