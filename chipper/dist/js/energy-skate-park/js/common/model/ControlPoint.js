// Copyright 2013-2023, University of Colorado Boulder

/**
 * Data structure for a control point, which will define the shape of a Track. The ControlPoint may be draggable
 * by the user, and dragging the control point will update the shape of the Track.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import Property from '../../../../axon/js/Property.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import Vector2Property from '../../../../dot/js/Vector2Property.js';
import merge from '../../../../phet-core/js/merge.js';
import PhetioObject from '../../../../tandem/js/PhetioObject.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import IOType from '../../../../tandem/js/types/IOType.js';
import NullableIO from '../../../../tandem/js/types/NullableIO.js';
import NumberIO from '../../../../tandem/js/types/NumberIO.js';
import energySkatePark from '../../energySkatePark.js';
class ControlPoint extends PhetioObject {
  /**
   * @param {number} x
   * @param {number} y
   * @param {Object} [options]
   */
  constructor(x, y, options) {
    options = merge({
      // {boolean} - if true, this control point will be displayed on the track
      visible: true,
      // {boolean} - can this control point specifically be dragged? If true, the control point is draggable,
      // changes opacity on over, and supports track splitting at the ControlPoint
      interactive: true,
      // {Bounds2|null} - if specified, the ControlPoint will also be constrained to these bounds during dragging, or
      // when the track is bumped above ground, in model coordinates
      limitBounds: null,
      tandem: Tandem.REQUIRED,
      phetioType: ControlPoint.ControlPointIO,
      phetioState: PhetioObject.DEFAULT_OPTIONS.phetioState
    }, options);
    const tandem = options.tandem;
    super(options);

    // @public (read-only) {Bounds2|null} - see option for information
    this.limitBounds = options.limitBounds;

    // @public (read-only) {boolean} - see options for information
    this.interactive = options.interactive;

    // @public (read-only) {boolean} - true if the ControlPoint is intended to be displayed visually
    this.visible = options.visible;

    // @public - where it would be if it hadn't snapped to another point during dragging
    this.sourcePositionProperty = new Vector2Property(new Vector2(x, y), {
      tandem: tandem.createTandem('sourcePositionProperty'),
      phetioState: options.phetioState // in state only if containing Track is
    });

    // @public {ControlPoint} - Another ControlPoint that this ControlPoint is going to 'snap' to if released.
    this.snapTargetProperty = new Property(null, {
      tandem: tandem.createTandem('snapTargetProperty'),
      phetioValueType: NullableIO(ControlPoint.ControlPointIO),
      phetioState: options.phetioState // in state only if containing Track is
    });

    // Where it is shown on the screen.  Same as sourcePosition (if not snapped) or snapTarget.position (if snapped).
    // Snapping means temporarily connecting to an adjacent open point before the tracks are joined, to indicate that a
    // connection is possible
    // @public {Vector2}
    this.positionProperty = new DerivedProperty([this.sourcePositionProperty, this.snapTargetProperty], (sourcePosition, snapTarget) => snapTarget ? snapTarget.positionProperty.value : sourcePosition, {
      tandem: tandem.createTandem('positionProperty'),
      phetioValueType: Vector2.Vector2IO,
      phetioState: options.phetioState
    });

    // @public {BooleanProperty} - whether the control point is currently being dragged
    this.draggingProperty = new BooleanProperty(false, {
      tandem: tandem.createTandem('draggingProperty'),
      phetioState: options.phetioState
    });

    // @private
    this.disposeControlPoint = () => {
      this.positionProperty.dispose();
      this.sourcePositionProperty.dispose();
      this.snapTargetProperty.dispose();
      this.draggingProperty.dispose();
    };
  }

  /**
   * @public
   */
  dispose() {
    this.disposeControlPoint();
    super.dispose();
  }

  /**
   * Reset to initial state.
   * @public
   */
  reset() {
    this.sourcePositionProperty.reset();
    this.snapTargetProperty.reset();
    this.draggingProperty.reset();
  }

  /**
   * Create a new control point, identical to this one.
   * TODO: https://github.com/phetsims/energy-skate-park/issues/123 is this reversed?  Maybe call on the model
   * @public
   *
   * @param {EnergySkateParkModel} model
   * @returns {ControlPoint}
   */
  copy(model) {
    return model.controlPointGroup.createNextElement(this.positionProperty.value.x, this.positionProperty.value.y);
  }
}
ControlPoint.ControlPointIO = new IOType('ControlPointIO', {
  valueType: ControlPoint,
  documentation: 'A control point that can manipulate the track.',
  toStateObject: controlPoint => {
    return {
      x: controlPoint.positionProperty.value.x,
      y: controlPoint.positionProperty.value.y
    };
  },
  stateSchema: {
    x: NumberIO,
    y: NumberIO
  },
  stateObjectToCreateElementArguments: stateObject => {
    assert && assert(typeof stateObject.x === 'number');
    return [stateObject.x, stateObject.y];
  }
});
energySkatePark.register('ControlPoint', ControlPoint);
export default ControlPoint;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJEZXJpdmVkUHJvcGVydHkiLCJQcm9wZXJ0eSIsIlZlY3RvcjIiLCJWZWN0b3IyUHJvcGVydHkiLCJtZXJnZSIsIlBoZXRpb09iamVjdCIsIlRhbmRlbSIsIklPVHlwZSIsIk51bGxhYmxlSU8iLCJOdW1iZXJJTyIsImVuZXJneVNrYXRlUGFyayIsIkNvbnRyb2xQb2ludCIsImNvbnN0cnVjdG9yIiwieCIsInkiLCJvcHRpb25zIiwidmlzaWJsZSIsImludGVyYWN0aXZlIiwibGltaXRCb3VuZHMiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsInBoZXRpb1R5cGUiLCJDb250cm9sUG9pbnRJTyIsInBoZXRpb1N0YXRlIiwiREVGQVVMVF9PUFRJT05TIiwic291cmNlUG9zaXRpb25Qcm9wZXJ0eSIsImNyZWF0ZVRhbmRlbSIsInNuYXBUYXJnZXRQcm9wZXJ0eSIsInBoZXRpb1ZhbHVlVHlwZSIsInBvc2l0aW9uUHJvcGVydHkiLCJzb3VyY2VQb3NpdGlvbiIsInNuYXBUYXJnZXQiLCJ2YWx1ZSIsIlZlY3RvcjJJTyIsImRyYWdnaW5nUHJvcGVydHkiLCJkaXNwb3NlQ29udHJvbFBvaW50IiwiZGlzcG9zZSIsInJlc2V0IiwiY29weSIsIm1vZGVsIiwiY29udHJvbFBvaW50R3JvdXAiLCJjcmVhdGVOZXh0RWxlbWVudCIsInZhbHVlVHlwZSIsImRvY3VtZW50YXRpb24iLCJ0b1N0YXRlT2JqZWN0IiwiY29udHJvbFBvaW50Iiwic3RhdGVTY2hlbWEiLCJzdGF0ZU9iamVjdFRvQ3JlYXRlRWxlbWVudEFyZ3VtZW50cyIsInN0YXRlT2JqZWN0IiwiYXNzZXJ0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJDb250cm9sUG9pbnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTMtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogRGF0YSBzdHJ1Y3R1cmUgZm9yIGEgY29udHJvbCBwb2ludCwgd2hpY2ggd2lsbCBkZWZpbmUgdGhlIHNoYXBlIG9mIGEgVHJhY2suIFRoZSBDb250cm9sUG9pbnQgbWF5IGJlIGRyYWdnYWJsZVxyXG4gKiBieSB0aGUgdXNlciwgYW5kIGRyYWdnaW5nIHRoZSBjb250cm9sIHBvaW50IHdpbGwgdXBkYXRlIHRoZSBzaGFwZSBvZiB0aGUgVHJhY2suXHJcbiAqXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBCb29sZWFuUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Cb29sZWFuUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCBWZWN0b3IyUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjJQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi8uLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgUGhldGlvT2JqZWN0IGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9QaGV0aW9PYmplY3QuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgSU9UeXBlIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy90eXBlcy9JT1R5cGUuanMnO1xyXG5pbXBvcnQgTnVsbGFibGVJTyBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvTnVsbGFibGVJTy5qcyc7XHJcbmltcG9ydCBOdW1iZXJJTyBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvTnVtYmVySU8uanMnO1xyXG5pbXBvcnQgZW5lcmd5U2thdGVQYXJrIGZyb20gJy4uLy4uL2VuZXJneVNrYXRlUGFyay5qcyc7XHJcblxyXG5jbGFzcyBDb250cm9sUG9pbnQgZXh0ZW5kcyBQaGV0aW9PYmplY3Qge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge251bWJlcn0geFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCB4LCB5LCBvcHRpb25zICkge1xyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcblxyXG4gICAgICAvLyB7Ym9vbGVhbn0gLSBpZiB0cnVlLCB0aGlzIGNvbnRyb2wgcG9pbnQgd2lsbCBiZSBkaXNwbGF5ZWQgb24gdGhlIHRyYWNrXHJcbiAgICAgIHZpc2libGU6IHRydWUsXHJcblxyXG4gICAgICAvLyB7Ym9vbGVhbn0gLSBjYW4gdGhpcyBjb250cm9sIHBvaW50IHNwZWNpZmljYWxseSBiZSBkcmFnZ2VkPyBJZiB0cnVlLCB0aGUgY29udHJvbCBwb2ludCBpcyBkcmFnZ2FibGUsXHJcbiAgICAgIC8vIGNoYW5nZXMgb3BhY2l0eSBvbiBvdmVyLCBhbmQgc3VwcG9ydHMgdHJhY2sgc3BsaXR0aW5nIGF0IHRoZSBDb250cm9sUG9pbnRcclxuICAgICAgaW50ZXJhY3RpdmU6IHRydWUsXHJcblxyXG4gICAgICAvLyB7Qm91bmRzMnxudWxsfSAtIGlmIHNwZWNpZmllZCwgdGhlIENvbnRyb2xQb2ludCB3aWxsIGFsc28gYmUgY29uc3RyYWluZWQgdG8gdGhlc2UgYm91bmRzIGR1cmluZyBkcmFnZ2luZywgb3JcclxuICAgICAgLy8gd2hlbiB0aGUgdHJhY2sgaXMgYnVtcGVkIGFib3ZlIGdyb3VuZCwgaW4gbW9kZWwgY29vcmRpbmF0ZXNcclxuICAgICAgbGltaXRCb3VuZHM6IG51bGwsXHJcblxyXG4gICAgICB0YW5kZW06IFRhbmRlbS5SRVFVSVJFRCxcclxuICAgICAgcGhldGlvVHlwZTogQ29udHJvbFBvaW50LkNvbnRyb2xQb2ludElPLFxyXG4gICAgICBwaGV0aW9TdGF0ZTogUGhldGlvT2JqZWN0LkRFRkFVTFRfT1BUSU9OUy5waGV0aW9TdGF0ZVxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG4gICAgY29uc3QgdGFuZGVtID0gb3B0aW9ucy50YW5kZW07XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIChyZWFkLW9ubHkpIHtCb3VuZHMyfG51bGx9IC0gc2VlIG9wdGlvbiBmb3IgaW5mb3JtYXRpb25cclxuICAgIHRoaXMubGltaXRCb3VuZHMgPSBvcHRpb25zLmxpbWl0Qm91bmRzO1xyXG5cclxuICAgIC8vIEBwdWJsaWMgKHJlYWQtb25seSkge2Jvb2xlYW59IC0gc2VlIG9wdGlvbnMgZm9yIGluZm9ybWF0aW9uXHJcbiAgICB0aGlzLmludGVyYWN0aXZlID0gb3B0aW9ucy5pbnRlcmFjdGl2ZTtcclxuXHJcbiAgICAvLyBAcHVibGljIChyZWFkLW9ubHkpIHtib29sZWFufSAtIHRydWUgaWYgdGhlIENvbnRyb2xQb2ludCBpcyBpbnRlbmRlZCB0byBiZSBkaXNwbGF5ZWQgdmlzdWFsbHlcclxuICAgIHRoaXMudmlzaWJsZSA9IG9wdGlvbnMudmlzaWJsZTtcclxuXHJcbiAgICAvLyBAcHVibGljIC0gd2hlcmUgaXQgd291bGQgYmUgaWYgaXQgaGFkbid0IHNuYXBwZWQgdG8gYW5vdGhlciBwb2ludCBkdXJpbmcgZHJhZ2dpbmdcclxuICAgIHRoaXMuc291cmNlUG9zaXRpb25Qcm9wZXJ0eSA9IG5ldyBWZWN0b3IyUHJvcGVydHkoIG5ldyBWZWN0b3IyKCB4LCB5ICksIHtcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnc291cmNlUG9zaXRpb25Qcm9wZXJ0eScgKSxcclxuICAgICAgcGhldGlvU3RhdGU6IG9wdGlvbnMucGhldGlvU3RhdGUgLy8gaW4gc3RhdGUgb25seSBpZiBjb250YWluaW5nIFRyYWNrIGlzXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyB7Q29udHJvbFBvaW50fSAtIEFub3RoZXIgQ29udHJvbFBvaW50IHRoYXQgdGhpcyBDb250cm9sUG9pbnQgaXMgZ29pbmcgdG8gJ3NuYXAnIHRvIGlmIHJlbGVhc2VkLlxyXG4gICAgdGhpcy5zbmFwVGFyZ2V0UHJvcGVydHkgPSBuZXcgUHJvcGVydHkoIG51bGwsIHtcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnc25hcFRhcmdldFByb3BlcnR5JyApLFxyXG4gICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bGxhYmxlSU8oIENvbnRyb2xQb2ludC5Db250cm9sUG9pbnRJTyApLFxyXG4gICAgICBwaGV0aW9TdGF0ZTogb3B0aW9ucy5waGV0aW9TdGF0ZSAvLyBpbiBzdGF0ZSBvbmx5IGlmIGNvbnRhaW5pbmcgVHJhY2sgaXNcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBXaGVyZSBpdCBpcyBzaG93biBvbiB0aGUgc2NyZWVuLiAgU2FtZSBhcyBzb3VyY2VQb3NpdGlvbiAoaWYgbm90IHNuYXBwZWQpIG9yIHNuYXBUYXJnZXQucG9zaXRpb24gKGlmIHNuYXBwZWQpLlxyXG4gICAgLy8gU25hcHBpbmcgbWVhbnMgdGVtcG9yYXJpbHkgY29ubmVjdGluZyB0byBhbiBhZGphY2VudCBvcGVuIHBvaW50IGJlZm9yZSB0aGUgdHJhY2tzIGFyZSBqb2luZWQsIHRvIGluZGljYXRlIHRoYXQgYVxyXG4gICAgLy8gY29ubmVjdGlvbiBpcyBwb3NzaWJsZVxyXG4gICAgLy8gQHB1YmxpYyB7VmVjdG9yMn1cclxuICAgIHRoaXMucG9zaXRpb25Qcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgdGhpcy5zb3VyY2VQb3NpdGlvblByb3BlcnR5LCB0aGlzLnNuYXBUYXJnZXRQcm9wZXJ0eSBdLFxyXG4gICAgICAoIHNvdXJjZVBvc2l0aW9uLCBzbmFwVGFyZ2V0ICkgPT4gc25hcFRhcmdldCA/IHNuYXBUYXJnZXQucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZSA6IHNvdXJjZVBvc2l0aW9uLCB7XHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAncG9zaXRpb25Qcm9wZXJ0eScgKSxcclxuICAgICAgICBwaGV0aW9WYWx1ZVR5cGU6IFZlY3RvcjIuVmVjdG9yMklPLFxyXG4gICAgICAgIHBoZXRpb1N0YXRlOiBvcHRpb25zLnBoZXRpb1N0YXRlXHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtCb29sZWFuUHJvcGVydHl9IC0gd2hldGhlciB0aGUgY29udHJvbCBwb2ludCBpcyBjdXJyZW50bHkgYmVpbmcgZHJhZ2dlZFxyXG4gICAgdGhpcy5kcmFnZ2luZ1Byb3BlcnR5ID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UsIHtcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnZHJhZ2dpbmdQcm9wZXJ0eScgKSxcclxuICAgICAgcGhldGlvU3RhdGU6IG9wdGlvbnMucGhldGlvU3RhdGVcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZVxyXG4gICAgdGhpcy5kaXNwb3NlQ29udHJvbFBvaW50ID0gKCkgPT4ge1xyXG4gICAgICB0aGlzLnBvc2l0aW9uUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgICB0aGlzLnNvdXJjZVBvc2l0aW9uUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgICB0aGlzLnNuYXBUYXJnZXRQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICAgIHRoaXMuZHJhZ2dpbmdQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIGRpc3Bvc2UoKSB7XHJcbiAgICB0aGlzLmRpc3Bvc2VDb250cm9sUG9pbnQoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc2V0IHRvIGluaXRpYWwgc3RhdGUuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqL1xyXG4gIHJlc2V0KCkge1xyXG4gICAgdGhpcy5zb3VyY2VQb3NpdGlvblByb3BlcnR5LnJlc2V0KCk7XHJcbiAgICB0aGlzLnNuYXBUYXJnZXRQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgdGhpcy5kcmFnZ2luZ1Byb3BlcnR5LnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGUgYSBuZXcgY29udHJvbCBwb2ludCwgaWRlbnRpY2FsIHRvIHRoaXMgb25lLlxyXG4gICAqIFRPRE86IGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9lbmVyZ3ktc2thdGUtcGFyay9pc3N1ZXMvMTIzIGlzIHRoaXMgcmV2ZXJzZWQ/ICBNYXliZSBjYWxsIG9uIHRoZSBtb2RlbFxyXG4gICAqIEBwdWJsaWNcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7RW5lcmd5U2thdGVQYXJrTW9kZWx9IG1vZGVsXHJcbiAgICogQHJldHVybnMge0NvbnRyb2xQb2ludH1cclxuICAgKi9cclxuICBjb3B5KCBtb2RlbCApIHtcclxuICAgIHJldHVybiBtb2RlbC5jb250cm9sUG9pbnRHcm91cC5jcmVhdGVOZXh0RWxlbWVudCggdGhpcy5wb3NpdGlvblByb3BlcnR5LnZhbHVlLngsIHRoaXMucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZS55ICk7XHJcbiAgfVxyXG59XHJcblxyXG5Db250cm9sUG9pbnQuQ29udHJvbFBvaW50SU8gPSBuZXcgSU9UeXBlKCAnQ29udHJvbFBvaW50SU8nLCB7XHJcbiAgdmFsdWVUeXBlOiBDb250cm9sUG9pbnQsXHJcbiAgZG9jdW1lbnRhdGlvbjogJ0EgY29udHJvbCBwb2ludCB0aGF0IGNhbiBtYW5pcHVsYXRlIHRoZSB0cmFjay4nLFxyXG4gIHRvU3RhdGVPYmplY3Q6IGNvbnRyb2xQb2ludCA9PiB7XHJcbiAgICByZXR1cm4geyB4OiBjb250cm9sUG9pbnQucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZS54LCB5OiBjb250cm9sUG9pbnQucG9zaXRpb25Qcm9wZXJ0eS52YWx1ZS55IH07XHJcbiAgfSxcclxuICBzdGF0ZVNjaGVtYToge1xyXG4gICAgeDogTnVtYmVySU8sXHJcbiAgICB5OiBOdW1iZXJJT1xyXG4gIH0sXHJcbiAgc3RhdGVPYmplY3RUb0NyZWF0ZUVsZW1lbnRBcmd1bWVudHM6IHN0YXRlT2JqZWN0ID0+IHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBzdGF0ZU9iamVjdC54ID09PSAnbnVtYmVyJyApO1xyXG4gICAgcmV0dXJuIFsgc3RhdGVPYmplY3QueCwgc3RhdGVPYmplY3QueSBdO1xyXG4gIH1cclxufSApO1xyXG5cclxuZW5lcmd5U2thdGVQYXJrLnJlZ2lzdGVyKCAnQ29udHJvbFBvaW50JywgQ29udHJvbFBvaW50ICk7XHJcbmV4cG9ydCBkZWZhdWx0IENvbnRyb2xQb2ludDsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsT0FBT0MsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxRQUFRLE1BQU0saUNBQWlDO0FBQ3RELE9BQU9DLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsT0FBT0MsZUFBZSxNQUFNLHVDQUF1QztBQUNuRSxPQUFPQyxLQUFLLE1BQU0sbUNBQW1DO0FBQ3JELE9BQU9DLFlBQVksTUFBTSx1Q0FBdUM7QUFDaEUsT0FBT0MsTUFBTSxNQUFNLGlDQUFpQztBQUNwRCxPQUFPQyxNQUFNLE1BQU0sdUNBQXVDO0FBQzFELE9BQU9DLFVBQVUsTUFBTSwyQ0FBMkM7QUFDbEUsT0FBT0MsUUFBUSxNQUFNLHlDQUF5QztBQUM5RCxPQUFPQyxlQUFlLE1B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