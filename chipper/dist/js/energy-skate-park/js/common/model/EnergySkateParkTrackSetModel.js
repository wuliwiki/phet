// Copyright 2018-2022, University of Colorado Boulder

/**
 * A model in Energy Skate park with a premade set of tracks. Does not include any configurable or movable tracks.
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import NumberProperty from '../../../../axon/js/NumberProperty.js';
import merge from '../../../../phet-core/js/merge.js';
import energySkatePark from '../../energySkatePark.js';
import EnergySkateParkSaveSampleModel from './EnergySkateParkSaveSampleModel.js';
import PremadeTracks from './PremadeTracks.js';
class EnergySkateParkTrackSetModel extends EnergySkateParkSaveSampleModel {
  /**
   * @param {EnergySkateParkPreferencesModel} preferencesModel
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(preferencesModel, tandem, options) {
    options = merge({
      // {PremadeTracks.TrackType[]} - list of the premade tracks used in this model. Currently,
      // the default list includes all of the possible premade tracks. Remove items from
      // this list to remove premade tracks from the model. This order will also be the
      // order of track selection buttons in the view.
      trackTypes: [PremadeTracks.TrackType.PARABOLA, PremadeTracks.TrackType.SLOPE, PremadeTracks.TrackType.DOUBLE_WELL, PremadeTracks.TrackType.LOOP],
      // {Object} Options passed to initializePremadeTracks, with options for control points and tracks for each of
      // the provided TrackType listed above. See initializePremadeTracks() for more information.
      initializePremadeTracksOptions: null
    }, options);
    super(preferencesModel, tandem.createTandem('trackSetModel'), options);

    // @public {number} - Indicates the currently selected scene. There can be any number of scenes, do we need
    // to pass this in as a param
    this.sceneProperty = new NumberProperty(0, {
      tandem: tandem.createTandem('sceneProperty'),
      validValues: [0, 1, 2, 3]
    });

    // When the scene changes, also change the tracks.
    this.sceneProperty.link(this.updateActiveTrack.bind(this));

    // @public - see options
    this.trackTypes = options.trackTypes;

    // initialize and add the desired tracks for this EnergySkateParkTrackSetModel
    this.initializePremadeTracks(tandem, options.initializePremadeTracksOptions);
  }

  /**
   * When the scene changes or tracks are added to the track set, update which track is visible and physically
   * interactive.
   * @private
   *
   * @param {number} sceneIndex - index identifying the scene
   */
  updateActiveTrack(sceneIndex) {
    for (let i = 0; i < this.tracks.length; i++) {
      const track = this.tracks.get(i);
      track.physicalProperty.value = i === sceneIndex;

      // Reset the skater position when the track is changed, see #179
      this.skater.resetPosition();

      // make sure that the entire track is above ground - points should be, but this makes sure that the
      // entire curve is fully above ground
      if (track.physicalProperty.get()) {
        // wait to bump until the model bounds are defined, which doesn't happen until the first view layout since
        // available model bounds are determined by the size of the screen for this sim
        const bumpListener = bounds => {
          if (bounds.hasNonzeroArea()) {
            // During state set, nodes can temporarily go below ground, but it will be above ground after the state is
            // fully set.
            if (!phet.joist.sim.isSettingPhetioStateProperty.value) {
              this.tracks.get(i).bumpAboveGround();
            }
            this.availableModelBoundsProperty.unlink(bumpListener);
          }
        };
        this.availableModelBoundsProperty.link(bumpListener);
      }
    }

    // The skater should detach from track when the scene changes.  Code elsewhere also resets the position of the skater.
    this.skater.trackProperty.value = null;
  }

  /**
   * Create and add the premade tracks for this model, tracks are defined by options for this class.
   * @private
   *
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  initializePremadeTracks(tandem, options) {
    const tracks = [];
    options = merge({
      parabolaControlPointOptions: null,
      parabolaTrackOptions: null,
      slopeControlPointOptions: null,
      slopeTrackOptions: null,
      doubleWellControlPointOptions: null,
      doubleWellTrackOptions: null,
      loopControlPointOptions: null,
      loopTrackOptions: null
    }, options);
    this.trackTypes.forEach(trackType => {
      if (trackType === PremadeTracks.TrackType.PARABOLA) {
        const parabolaControlPoints = PremadeTracks.createParabolaControlPoints(this, options.parabolaControlPointOptions);
        const parabolaTrack = EnergySkateParkTrackSetModel.createPremadeTrack(this, parabolaControlPoints, merge({
          tandem: tandem.createTandem('parabolaTrack')
        }, options.parabolaTrackOptions));
        tracks.push(parabolaTrack);
      } else if (trackType === PremadeTracks.TrackType.SLOPE) {
        const slopeControlPoints = PremadeTracks.createSlopeControlPoints(this, options.slopeControlPointOptions);
        const slopeTrack = EnergySkateParkTrackSetModel.createPremadeTrack(this, slopeControlPoints, merge({
          // Flag to indicate whether the skater transitions from the right edge of this track directly to the ground
          // see #164
          slopeToGround: true,
          tandem: tandem.createTandem('slopeTrack')
        }, options.slopeTrackOptions));
        tracks.push(slopeTrack);
      } else if (trackType === PremadeTracks.TrackType.DOUBLE_WELL) {
        const doubleWellControlPoints = PremadeTracks.createDoubleWellControlPoints(this, options.doubleWellControlPointOptions);
        const doubleWellTrack = EnergySkateParkTrackSetModel.createPremadeTrack(this, doubleWellControlPoints, merge({
          tandem: tandem.createTandem('doubleWellTrack')
        }, options.doubleWellTrackOptions));
        tracks.push(doubleWellTrack);
      } else if (trackType === PremadeTracks.TrackType.LOOP) {
        const loopControlPoints = PremadeTracks.createLoopControlPoints(this, options.loopControlPointOptions);
        const loopTrack = EnergySkateParkTrackSetModel.createPremadeTrack(this, loopControlPoints, merge({
          draggable: this.tracksDraggable,
          tandem: tandem.createTandem('loopTrack')
        }, options.loopTrackOptions));
        tracks.push(loopTrack);
      }
    });
    this.addTrackSet(tracks);
  }

  /**
   * Add all tracks in the set. In addition to adding all to the ObservableArrayDef, this will initialize which track
   * should be visible, physical, and interactive depending on the model sceneProperty.
   * @public
   *
   * @param {Track[]} tracks
   */
  addTrackSet(tracks) {
    this.tracks.addAll(tracks);
    this.updateActiveTrack(this.sceneProperty.get());
  }

  /**
   * Reset all of the tracks in this model's track set, if they are configurable. Otherwise, identical to
   * super function.
   * @public
   * @override
   */
  reset() {
    super.reset();
    this.tracks.forEach(track => {
      if (track.configurable) {
        track.reset();
      }
    });
    this.sceneProperty.reset();
    this.updateActiveTrack(this.sceneProperty.get());
  }

  /**
   * @private
   *
   * @param {EnergySkateParkTrackSetModel} model
   * @param {ControlPoint[]}controlPoints
   * @param {Object} [options]
   * @returns {Track}
   */
  static createPremadeTrack(model, controlPoints, options) {
    options = merge({
      configurable: model.tracksConfigurable,
      phetioState: false
    }, options);
    return PremadeTracks.createTrack(model, controlPoints, options);
  }
}
energySkatePark.register('EnergySkateParkTrackSetModel', EnergySkateParkTrackSetModel);
export default EnergySkateParkTrackSetModel;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOdW1iZXJQcm9wZXJ0eSIsIm1lcmdlIiwiZW5lcmd5U2thdGVQYXJrIiwiRW5lcmd5U2thdGVQYXJrU2F2ZVNhbXBsZU1vZGVsIiwiUHJlbWFkZVRyYWNrcyIsIkVuZXJneVNrYXRlUGFya1RyYWNrU2V0TW9kZWwiLCJjb25zdHJ1Y3RvciIsInByZWZlcmVuY2VzTW9kZWwiLCJ0YW5kZW0iLCJvcHRpb25zIiwidHJhY2tUeXBlcyIsIlRyYWNrVHlwZSIsIlBBUkFCT0xBIiwiU0xPUEUiLCJET1VCTEVfV0VMTCIsIkxPT1AiLCJpbml0aWFsaXplUHJlbWFkZVRyYWNrc09wdGlvbnMiLCJjcmVhdGVUYW5kZW0iLCJzY2VuZVByb3BlcnR5IiwidmFsaWRWYWx1ZXMiLCJsaW5rIiwidXBkYXRlQWN0aXZlVHJhY2siLCJiaW5kIiwiaW5pdGlhbGl6ZVByZW1hZGVUcmFja3MiLCJzY2VuZUluZGV4IiwiaSIsInRyYWNrcyIsImxlbmd0aCIsInRyYWNrIiwiZ2V0IiwicGh5c2ljYWxQcm9wZXJ0eSIsInZhbHVlIiwic2thdGVyIiwicmVzZXRQb3NpdGlvbiIsImJ1bXBMaXN0ZW5lciIsImJvdW5kcyIsImhhc05vbnplcm9BcmVhIiwicGhldCIsImpvaXN0Iiwic2ltIiwiaXNTZXR0aW5nUGhldGlvU3RhdGVQcm9wZXJ0eSIsImJ1bXBBYm92ZUdyb3VuZCIsImF2YWlsYWJsZU1vZGVsQm91bmRzUHJvcGVydHkiLCJ1bmxpbmsiLCJ0cmFja1Byb3BlcnR5IiwicGFyYWJvbGFDb250cm9sUG9pbnRPcHRpb25zIiwicGFyYWJvbGFUcmFja09wdGlvbnMiLCJzbG9wZUNvbnRyb2xQb2ludE9wdGlvbnMiLCJzbG9wZVRyYWNrT3B0aW9ucyIsImRvdWJsZVdlbGxDb250cm9sUG9pbnRPcHRpb25zIiwiZG91YmxlV2VsbFRyYWNrT3B0aW9ucyIsImxvb3BDb250cm9sUG9pbnRPcHRpb25zIiwibG9vcFRyYWNrT3B0aW9ucyIsImZvckVhY2giLCJ0cmFja1R5cGUiLCJwYXJhYm9sYUNvbnRyb2xQb2ludHMiLCJjcmVhdGVQYXJhYm9sYUNvbnRyb2xQb2ludHMiLCJwYXJhYm9sYVRyYWNrIiwiY3JlYXRlUHJlbWFkZVRyYWNrIiwicHVzaCIsInNsb3BlQ29udHJvbFBvaW50cyIsImNyZWF0ZVNsb3BlQ29udHJvbFBvaW50cyIsInNsb3BlVHJhY2siLCJzbG9wZVRvR3JvdW5kIiwiZG91YmxlV2VsbENvbnRyb2xQb2ludHMiLCJjcmVhdGVEb3VibGVXZWxsQ29udHJvbFBvaW50cyIsImRvdWJsZVdlbGxUcmFjayIsImxvb3BDb250cm9sUG9pbnRzIiwiY3JlYXRlTG9vcENvbnRyb2xQb2ludHMiLCJsb29wVHJhY2siLCJkcmFnZ2FibGUiLCJ0cmFja3NEcmFnZ2FibGUiLCJhZGRUcmFja1NldCIsImFkZEFsbCIsInJlc2V0IiwiY29uZmlndXJhYmxlIiwibW9kZWwiLCJjb250cm9sUG9pbnRzIiwidHJhY2tzQ29uZmlndXJhYmxlIiwicGhldGlvU3RhdGUiLCJjcmVhdGVUcmFjayIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRW5lcmd5U2thdGVQYXJrVHJhY2tTZXRNb2RlbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBIG1vZGVsIGluIEVuZXJneSBTa2F0ZSBwYXJrIHdpdGggYSBwcmVtYWRlIHNldCBvZiB0cmFja3MuIERvZXMgbm90IGluY2x1ZGUgYW55IGNvbmZpZ3VyYWJsZSBvciBtb3ZhYmxlIHRyYWNrcy5cclxuICogQGF1dGhvciBKZXNzZSBHcmVlbmJlcmcgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IE51bWJlclByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvTnVtYmVyUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IGVuZXJneVNrYXRlUGFyayBmcm9tICcuLi8uLi9lbmVyZ3lTa2F0ZVBhcmsuanMnO1xyXG5pbXBvcnQgRW5lcmd5U2thdGVQYXJrU2F2ZVNhbXBsZU1vZGVsIGZyb20gJy4vRW5lcmd5U2thdGVQYXJrU2F2ZVNhbXBsZU1vZGVsLmpzJztcclxuaW1wb3J0IFByZW1hZGVUcmFja3MgZnJvbSAnLi9QcmVtYWRlVHJhY2tzLmpzJztcclxuXHJcbmNsYXNzIEVuZXJneVNrYXRlUGFya1RyYWNrU2V0TW9kZWwgZXh0ZW5kcyBFbmVyZ3lTa2F0ZVBhcmtTYXZlU2FtcGxlTW9kZWwge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge0VuZXJneVNrYXRlUGFya1ByZWZlcmVuY2VzTW9kZWx9IHByZWZlcmVuY2VzTW9kZWxcclxuICAgKiBAcGFyYW0ge1RhbmRlbX0gdGFuZGVtXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBwcmVmZXJlbmNlc01vZGVsLCB0YW5kZW0sIG9wdGlvbnMgKSB7XHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuXHJcbiAgICAgIC8vIHtQcmVtYWRlVHJhY2tzLlRyYWNrVHlwZVtdfSAtIGxpc3Qgb2YgdGhlIHByZW1hZGUgdHJhY2tzIHVzZWQgaW4gdGhpcyBtb2RlbC4gQ3VycmVudGx5LFxyXG4gICAgICAvLyB0aGUgZGVmYXVsdCBsaXN0IGluY2x1ZGVzIGFsbCBvZiB0aGUgcG9zc2libGUgcHJlbWFkZSB0cmFja3MuIFJlbW92ZSBpdGVtcyBmcm9tXHJcbiAgICAgIC8vIHRoaXMgbGlzdCB0byByZW1vdmUgcHJlbWFkZSB0cmFja3MgZnJvbSB0aGUgbW9kZWwuIFRoaXMgb3JkZXIgd2lsbCBhbHNvIGJlIHRoZVxyXG4gICAgICAvLyBvcmRlciBvZiB0cmFjayBzZWxlY3Rpb24gYnV0dG9ucyBpbiB0aGUgdmlldy5cclxuICAgICAgdHJhY2tUeXBlczogW1xyXG4gICAgICAgIFByZW1hZGVUcmFja3MuVHJhY2tUeXBlLlBBUkFCT0xBLFxyXG4gICAgICAgIFByZW1hZGVUcmFja3MuVHJhY2tUeXBlLlNMT1BFLFxyXG4gICAgICAgIFByZW1hZGVUcmFja3MuVHJhY2tUeXBlLkRPVUJMRV9XRUxMLFxyXG4gICAgICAgIFByZW1hZGVUcmFja3MuVHJhY2tUeXBlLkxPT1BcclxuICAgICAgXSxcclxuXHJcbiAgICAgIC8vIHtPYmplY3R9IE9wdGlvbnMgcGFzc2VkIHRvIGluaXRpYWxpemVQcmVtYWRlVHJhY2tzLCB3aXRoIG9wdGlvbnMgZm9yIGNvbnRyb2wgcG9pbnRzIGFuZCB0cmFja3MgZm9yIGVhY2ggb2ZcclxuICAgICAgLy8gdGhlIHByb3ZpZGVkIFRyYWNrVHlwZSBsaXN0ZWQgYWJvdmUuIFNlZSBpbml0aWFsaXplUHJlbWFkZVRyYWNrcygpIGZvciBtb3JlIGluZm9ybWF0aW9uLlxyXG4gICAgICBpbml0aWFsaXplUHJlbWFkZVRyYWNrc09wdGlvbnM6IG51bGxcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggcHJlZmVyZW5jZXNNb2RlbCwgdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3RyYWNrU2V0TW9kZWwnICksIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBAcHVibGljIHtudW1iZXJ9IC0gSW5kaWNhdGVzIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgc2NlbmUuIFRoZXJlIGNhbiBiZSBhbnkgbnVtYmVyIG9mIHNjZW5lcywgZG8gd2UgbmVlZFxyXG4gICAgLy8gdG8gcGFzcyB0aGlzIGluIGFzIGEgcGFyYW1cclxuICAgIHRoaXMuc2NlbmVQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggMCwge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdzY2VuZVByb3BlcnR5JyApLFxyXG4gICAgICB2YWxpZFZhbHVlczogWyAwLCAxLCAyLCAzIF1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBXaGVuIHRoZSBzY2VuZSBjaGFuZ2VzLCBhbHNvIGNoYW5nZSB0aGUgdHJhY2tzLlxyXG4gICAgdGhpcy5zY2VuZVByb3BlcnR5LmxpbmsoIHRoaXMudXBkYXRlQWN0aXZlVHJhY2suYmluZCggdGhpcyApICk7XHJcblxyXG4gICAgLy8gQHB1YmxpYyAtIHNlZSBvcHRpb25zXHJcbiAgICB0aGlzLnRyYWNrVHlwZXMgPSBvcHRpb25zLnRyYWNrVHlwZXM7XHJcblxyXG4gICAgLy8gaW5pdGlhbGl6ZSBhbmQgYWRkIHRoZSBkZXNpcmVkIHRyYWNrcyBmb3IgdGhpcyBFbmVyZ3lTa2F0ZVBhcmtUcmFja1NldE1vZGVsXHJcbiAgICB0aGlzLmluaXRpYWxpemVQcmVtYWRlVHJhY2tzKCB0YW5kZW0sIG9wdGlvbnMuaW5pdGlhbGl6ZVByZW1hZGVUcmFja3NPcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXaGVuIHRoZSBzY2VuZSBjaGFuZ2VzIG9yIHRyYWNrcyBhcmUgYWRkZWQgdG8gdGhlIHRyYWNrIHNldCwgdXBkYXRlIHdoaWNoIHRyYWNrIGlzIHZpc2libGUgYW5kIHBoeXNpY2FsbHlcclxuICAgKiBpbnRlcmFjdGl2ZS5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNjZW5lSW5kZXggLSBpbmRleCBpZGVudGlmeWluZyB0aGUgc2NlbmVcclxuICAgKi9cclxuICB1cGRhdGVBY3RpdmVUcmFjayggc2NlbmVJbmRleCApIHtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHRoaXMudHJhY2tzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBjb25zdCB0cmFjayA9IHRoaXMudHJhY2tzLmdldCggaSApO1xyXG4gICAgICB0cmFjay5waHlzaWNhbFByb3BlcnR5LnZhbHVlID0gKCBpID09PSBzY2VuZUluZGV4ICk7XHJcblxyXG4gICAgICAvLyBSZXNldCB0aGUgc2thdGVyIHBvc2l0aW9uIHdoZW4gdGhlIHRyYWNrIGlzIGNoYW5nZWQsIHNlZSAjMTc5XHJcbiAgICAgIHRoaXMuc2thdGVyLnJlc2V0UG9zaXRpb24oKTtcclxuXHJcbiAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSBlbnRpcmUgdHJhY2sgaXMgYWJvdmUgZ3JvdW5kIC0gcG9pbnRzIHNob3VsZCBiZSwgYnV0IHRoaXMgbWFrZXMgc3VyZSB0aGF0IHRoZVxyXG4gICAgICAvLyBlbnRpcmUgY3VydmUgaXMgZnVsbHkgYWJvdmUgZ3JvdW5kXHJcbiAgICAgIGlmICggdHJhY2sucGh5c2ljYWxQcm9wZXJ0eS5nZXQoKSApIHtcclxuXHJcbiAgICAgICAgLy8gd2FpdCB0byBidW1wIHVudGlsIHRoZSBtb2RlbCBib3VuZHMgYXJlIGRlZmluZWQsIHdoaWNoIGRvZXNuJ3QgaGFwcGVuIHVudGlsIHRoZSBmaXJzdCB2aWV3IGxheW91dCBzaW5jZVxyXG4gICAgICAgIC8vIGF2YWlsYWJsZSBtb2RlbCBib3VuZHMgYXJlIGRldGVybWluZWQgYnkgdGhlIHNpemUgb2YgdGhlIHNjcmVlbiBmb3IgdGhpcyBzaW1cclxuICAgICAgICBjb25zdCBidW1wTGlzdGVuZXIgPSBib3VuZHMgPT4ge1xyXG4gICAgICAgICAgaWYgKCBib3VuZHMuaGFzTm9uemVyb0FyZWEoKSApIHtcclxuXHJcbiAgICAgICAgICAgIC8vIER1cmluZyBzdGF0ZSBzZXQsIG5vZGVzIGNhbiB0ZW1wb3JhcmlseSBnbyBiZWxvdyBncm91bmQsIGJ1dCBpdCB3aWxsIGJlIGFib3ZlIGdyb3VuZCBhZnRlciB0aGUgc3RhdGUgaXNcclxuICAgICAgICAgICAgLy8gZnVsbHkgc2V0LlxyXG4gICAgICAgICAgICBpZiAoICFwaGV0LmpvaXN0LnNpbS5pc1NldHRpbmdQaGV0aW9TdGF0ZVByb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICAgICAgICAgIHRoaXMudHJhY2tzLmdldCggaSApLmJ1bXBBYm92ZUdyb3VuZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYXZhaWxhYmxlTW9kZWxCb3VuZHNQcm9wZXJ0eS51bmxpbmsoIGJ1bXBMaXN0ZW5lciApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hdmFpbGFibGVNb2RlbEJvdW5kc1Byb3BlcnR5LmxpbmsoIGJ1bXBMaXN0ZW5lciApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVGhlIHNrYXRlciBzaG91bGQgZGV0YWNoIGZyb20gdHJhY2sgd2hlbiB0aGUgc2NlbmUgY2hhbmdlcy4gIENvZGUgZWxzZXdoZXJlIGFsc28gcmVzZXRzIHRoZSBwb3NpdGlvbiBvZiB0aGUgc2thdGVyLlxyXG4gICAgdGhpcy5za2F0ZXIudHJhY2tQcm9wZXJ0eS52YWx1ZSA9IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGUgYW5kIGFkZCB0aGUgcHJlbWFkZSB0cmFja3MgZm9yIHRoaXMgbW9kZWwsIHRyYWNrcyBhcmUgZGVmaW5lZCBieSBvcHRpb25zIGZvciB0aGlzIGNsYXNzLlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge1RhbmRlbX0gdGFuZGVtXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAqL1xyXG4gIGluaXRpYWxpemVQcmVtYWRlVHJhY2tzKCB0YW5kZW0sIG9wdGlvbnMgKSB7XHJcbiAgICBjb25zdCB0cmFja3MgPSBbXTtcclxuXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgcGFyYWJvbGFDb250cm9sUG9pbnRPcHRpb25zOiBudWxsLFxyXG4gICAgICBwYXJhYm9sYVRyYWNrT3B0aW9uczogbnVsbCxcclxuXHJcbiAgICAgIHNsb3BlQ29udHJvbFBvaW50T3B0aW9uczogbnVsbCxcclxuICAgICAgc2xvcGVUcmFja09wdGlvbnM6IG51bGwsXHJcblxyXG4gICAgICBkb3VibGVXZWxsQ29udHJvbFBvaW50T3B0aW9uczogbnVsbCxcclxuICAgICAgZG91YmxlV2VsbFRyYWNrT3B0aW9uczogbnVsbCxcclxuXHJcbiAgICAgIGxvb3BDb250cm9sUG9pbnRPcHRpb25zOiBudWxsLFxyXG4gICAgICBsb29wVHJhY2tPcHRpb25zOiBudWxsXHJcbiAgICB9LCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy50cmFja1R5cGVzLmZvckVhY2goIHRyYWNrVHlwZSA9PiB7XHJcbiAgICAgIGlmICggdHJhY2tUeXBlID09PSBQcmVtYWRlVHJhY2tzLlRyYWNrVHlwZS5QQVJBQk9MQSApIHtcclxuICAgICAgICBjb25zdCBwYXJhYm9sYUNvbnRyb2xQb2ludHMgPSBQcmVtYWRlVHJhY2tzLmNyZWF0ZVBhcmFib2xhQ29udHJvbFBvaW50cyggdGhpcywgb3B0aW9ucy5wYXJhYm9sYUNvbnRyb2xQb2ludE9wdGlvbnMgKTtcclxuICAgICAgICBjb25zdCBwYXJhYm9sYVRyYWNrID0gRW5lcmd5U2thdGVQYXJrVHJhY2tTZXRNb2RlbC5jcmVhdGVQcmVtYWRlVHJhY2soIHRoaXMsIHBhcmFib2xhQ29udHJvbFBvaW50cywgbWVyZ2UoIHtcclxuICAgICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3BhcmFib2xhVHJhY2snIClcclxuICAgICAgICB9LCBvcHRpb25zLnBhcmFib2xhVHJhY2tPcHRpb25zICkgKTtcclxuXHJcbiAgICAgICAgdHJhY2tzLnB1c2goIHBhcmFib2xhVHJhY2sgKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggdHJhY2tUeXBlID09PSBQcmVtYWRlVHJhY2tzLlRyYWNrVHlwZS5TTE9QRSApIHtcclxuICAgICAgICBjb25zdCBzbG9wZUNvbnRyb2xQb2ludHMgPSBQcmVtYWRlVHJhY2tzLmNyZWF0ZVNsb3BlQ29udHJvbFBvaW50cyggdGhpcywgb3B0aW9ucy5zbG9wZUNvbnRyb2xQb2ludE9wdGlvbnMgKTtcclxuICAgICAgICBjb25zdCBzbG9wZVRyYWNrID0gRW5lcmd5U2thdGVQYXJrVHJhY2tTZXRNb2RlbC5jcmVhdGVQcmVtYWRlVHJhY2soIHRoaXMsIHNsb3BlQ29udHJvbFBvaW50cywgbWVyZ2UoIHtcclxuXHJcbiAgICAgICAgICAvLyBGbGFnIHRvIGluZGljYXRlIHdoZXRoZXIgdGhlIHNrYXRlciB0cmFuc2l0aW9ucyBmcm9tIHRoZSByaWdodCBlZGdlIG9mIHRoaXMgdHJhY2sgZGlyZWN0bHkgdG8gdGhlIGdyb3VuZFxyXG4gICAgICAgICAgLy8gc2VlICMxNjRcclxuICAgICAgICAgIHNsb3BlVG9Hcm91bmQ6IHRydWUsXHJcbiAgICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdzbG9wZVRyYWNrJyApXHJcbiAgICAgICAgfSwgb3B0aW9ucy5zbG9wZVRyYWNrT3B0aW9ucyApICk7XHJcbiAgICAgICAgdHJhY2tzLnB1c2goIHNsb3BlVHJhY2sgKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggdHJhY2tUeXBlID09PSBQcmVtYWRlVHJhY2tzLlRyYWNrVHlwZS5ET1VCTEVfV0VMTCApIHtcclxuICAgICAgICBjb25zdCBkb3VibGVXZWxsQ29udHJvbFBvaW50cyA9IFByZW1hZGVUcmFja3MuY3JlYXRlRG91YmxlV2VsbENvbnRyb2xQb2ludHMoIHRoaXMsIG9wdGlvbnMuZG91YmxlV2VsbENvbnRyb2xQb2ludE9wdGlvbnMgKTtcclxuICAgICAgICBjb25zdCBkb3VibGVXZWxsVHJhY2sgPSBFbmVyZ3lTa2F0ZVBhcmtUcmFja1NldE1vZGVsLmNyZWF0ZVByZW1hZGVUcmFjayggdGhpcywgZG91YmxlV2VsbENvbnRyb2xQb2ludHMsIG1lcmdlKCB7XHJcbiAgICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdkb3VibGVXZWxsVHJhY2snIClcclxuICAgICAgICB9LCBvcHRpb25zLmRvdWJsZVdlbGxUcmFja09wdGlvbnMgKSApO1xyXG4gICAgICAgIHRyYWNrcy5wdXNoKCBkb3VibGVXZWxsVHJhY2sgKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggdHJhY2tUeXBlID09PSBQcmVtYWRlVHJhY2tzLlRyYWNrVHlwZS5MT09QICkge1xyXG4gICAgICAgIGNvbnN0IGxvb3BDb250cm9sUG9pbnRzID0gUHJlbWFkZVRyYWNrcy5jcmVhdGVMb29wQ29udHJvbFBvaW50cyggdGhpcywgb3B0aW9ucy5sb29wQ29udHJvbFBvaW50T3B0aW9ucyApO1xyXG4gICAgICAgIGNvbnN0IGxvb3BUcmFjayA9IEVuZXJneVNrYXRlUGFya1RyYWNrU2V0TW9kZWwuY3JlYXRlUHJlbWFkZVRyYWNrKCB0aGlzLCBsb29wQ29udHJvbFBvaW50cywgbWVyZ2UoIHtcclxuICAgICAgICAgIGRyYWdnYWJsZTogdGhpcy50cmFja3NEcmFnZ2FibGUsXHJcbiAgICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdsb29wVHJhY2snIClcclxuICAgICAgICB9LCBvcHRpb25zLmxvb3BUcmFja09wdGlvbnMgKSApO1xyXG4gICAgICAgIHRyYWNrcy5wdXNoKCBsb29wVHJhY2sgKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuYWRkVHJhY2tTZXQoIHRyYWNrcyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkIGFsbCB0cmFja3MgaW4gdGhlIHNldC4gSW4gYWRkaXRpb24gdG8gYWRkaW5nIGFsbCB0byB0aGUgT2JzZXJ2YWJsZUFycmF5RGVmLCB0aGlzIHdpbGwgaW5pdGlhbGl6ZSB3aGljaCB0cmFja1xyXG4gICAqIHNob3VsZCBiZSB2aXNpYmxlLCBwaHlzaWNhbCwgYW5kIGludGVyYWN0aXZlIGRlcGVuZGluZyBvbiB0aGUgbW9kZWwgc2NlbmVQcm9wZXJ0eS5cclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge1RyYWNrW119IHRyYWNrc1xyXG4gICAqL1xyXG4gIGFkZFRyYWNrU2V0KCB0cmFja3MgKSB7XHJcbiAgICB0aGlzLnRyYWNrcy5hZGRBbGwoIHRyYWNrcyApO1xyXG4gICAgdGhpcy51cGRhdGVBY3RpdmVUcmFjayggdGhpcy5zY2VuZVByb3BlcnR5LmdldCgpICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNldCBhbGwgb2YgdGhlIHRyYWNrcyBpbiB0aGlzIG1vZGVsJ3MgdHJhY2sgc2V0LCBpZiB0aGV5IGFyZSBjb25maWd1cmFibGUuIE90aGVyd2lzZSwgaWRlbnRpY2FsIHRvXHJcbiAgICogc3VwZXIgZnVuY3Rpb24uXHJcbiAgICogQHB1YmxpY1xyXG4gICAqIEBvdmVycmlkZVxyXG4gICAqL1xyXG4gIHJlc2V0KCkge1xyXG4gICAgc3VwZXIucmVzZXQoKTtcclxuICAgIHRoaXMudHJhY2tzLmZvckVhY2goIHRyYWNrID0+IHtcclxuICAgICAgaWYgKCB0cmFjay5jb25maWd1cmFibGUgKSB7XHJcbiAgICAgICAgdHJhY2sucmVzZXQoKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuc2NlbmVQcm9wZXJ0eS5yZXNldCgpO1xyXG5cclxuICAgIHRoaXMudXBkYXRlQWN0aXZlVHJhY2soIHRoaXMuc2NlbmVQcm9wZXJ0eS5nZXQoKSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHByaXZhdGVcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7RW5lcmd5U2thdGVQYXJrVHJhY2tTZXRNb2RlbH0gbW9kZWxcclxuICAgKiBAcGFyYW0ge0NvbnRyb2xQb2ludFtdfWNvbnRyb2xQb2ludHNcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICogQHJldHVybnMge1RyYWNrfVxyXG4gICAqL1xyXG4gIHN0YXRpYyBjcmVhdGVQcmVtYWRlVHJhY2soIG1vZGVsLCBjb250cm9sUG9pbnRzLCBvcHRpb25zICkge1xyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogbW9kZWwudHJhY2tzQ29uZmlndXJhYmxlLFxyXG4gICAgICBwaGV0aW9TdGF0ZTogZmFsc2VcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICByZXR1cm4gUHJlbWFkZVRyYWNrcy5jcmVhdGVUcmFjayggbW9kZWwsIGNvbnRyb2xQb2ludHMsIG9wdGlvbnMgKTtcclxuICB9XHJcbn1cclxuXHJcbmVuZXJneVNrYXRlUGFyay5yZWdpc3RlciggJ0VuZXJneVNrYXRlUGFya1RyYWNrU2V0TW9kZWwnLCBFbmVyZ3lTa2F0ZVBhcmtUcmFja1NldE1vZGVsICk7XHJcbmV4cG9ydCBkZWZhdWx0IEVuZXJneVNrYXRlUGFya1RyYWNrU2V0TW9kZWw7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxjQUFjLE1BQU0sdUNBQXVDO0FBQ2xFLE9BQU9DLEtBQUssTUFBTSxtQ0FBbUM7QUFDckQsT0FBT0MsZUFBZSxNQUFNLDBCQUEwQjtBQUN0RCxPQUFPQyw4QkFBOEIsTUFBTSxxQ0FBcUM7QUFDaEYsT0FBT0MsYUFBYSxNQUFNLG9CQUFvQjtBQUU5QyxNQUFNQyw0QkFBNEIsU0FBU0YsOEJBQThCLENBQUM7RUFFeEU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtFQUNFRyxXQUFXQSxDQUFFQyxnQkFBZ0IsRUFBRUMsTUFBTSxFQUFFQyxPQUFPLEVBQUc7SUFDL0NBLE9BQU8sR0FBR1IsS0FBSyxDQUFFO01BRWY7TUFDQTtNQUNBO01BQ0E7TUFDQVMsVUFBVSxFQUFFLENBQ1ZOLGFBQWEsQ0FBQ08sU0FBUyxDQUFDQyxRQUFRLEVBQ2hDUixhQUFhLENBQUNPLFNBQVMsQ0FBQ0UsS0FBSyxFQUM3QlQsYUFBYSxDQUFDTyxTQUFTLENBQUNHLFdBQVcsRUFDbkNWLGFBQWEsQ0FBQ08sU0FBUyxDQUFDSSxJQUFJLENBQzdCO01BRUQ7TUFDQTtNQUNBQyw4QkFBOEIsRUFBRTtJQUNsQyxDQUFDLEVBQUVQLE9BQVEsQ0FBQztJQUVaLEtBQUssQ0FBRUYsZ0JBQWdCLEVBQUVDLE1BQU0sQ0FBQ1MsWUFBWSxDQUFFLGVBQWdCLENBQUMsRUFBRVIsT0FBUSxDQUFDOztJQUUxRTtJQUNBO0lBQ0EsSUFBSSxDQUFDUyxhQUFhLEdBQUcsSUFBSWxCLGNBQWMs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