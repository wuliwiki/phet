// Copyright 2019-2022, University of Colorado Boulder

/**
 * A NumberControl that controls a physical value of the model in Energy Skate Park.
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import Utils from '../../../../dot/js/Utils.js';
import merge from '../../../../phet-core/js/merge.js';
import NumberControl from '../../../../scenery-phet/js/NumberControl.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Text } from '../../../../scenery/js/imports.js';
import energySkatePark from '../../energySkatePark.js';
import EnergySkateParkConstants from '../EnergySkateParkConstants.js';
class PhysicalNumberControl extends NumberControl {
  /**
   * @param {string} titleString
   * @param {NumberProperty} property
   * @param {Range} valueRange
   * @param {BooleanProperty} userControlledProperty
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(titleString, property, valueRange, userControlledProperty, tandem, options) {
    options = options || {};
    assert && assert(options.layoutFunction === undefined, 'PhysicalNumberControl sets layoutFunction');
    assert && assert(options.tandem === undefined, 'PhysicalNumberControl shouldn\'t set tandem in options');
    assert && assert(options.arrowButtonOptions === undefined, 'PhysicalNumberControl sets arrowButtonOptions');
    assert && assert(options.titleFont === undefined, 'PhysicalNumberControl sets title font');
    if (options.numberDisplayOptions) {
      if (options.numberDisplayOptions.textOptions) {
        assert && assert(options.numberDisplayOptions.textOptions.font === undefined, 'PhysicalNumberControl sets font');
      }
      assert && assert(options.numberDisplayOptions.xMargin === undefined, 'PhysicalNumberControl sets xMargin');
      assert && assert(options.numberDisplayOptions.yMargin === undefined, 'PhysicalNumberControl sets yMargin');
    }

    // slider options are passed directly to the Slider in NumberControl
    options = merge({
      // decimal places for the ticks and (by default) the NumberControl's NumberDisplay
      decimalPlaces: 0,
      startCallback: () => {
        userControlledProperty.set(true);
      },
      endCallback: () => {
        userControlledProperty.set(false);
      },
      // {boolean} - if true, the tweaker buttons and number display will be hidden (but rest of NumberControl title
      // and layout will be preserved)
      sliderOnly: false,
      // {*|null} - passed to the Slider of NumberControl, extended below
      sliderOptions: null,
      // {*|null} - passed to the NumberDisplay of NumberControl, extended below
      numberDisplayOptions: null
    }, options);
    options.sliderOptions = merge({
      majorTicks: [{
        value: valueRange.min,
        label: new Text(Utils.toFixed(valueRange.min, options.decimalPlaces), EnergySkateParkConstants.CONTROL_TICK_LABEL_OPTIONS)
      }, {
        value: valueRange.max,
        label: new Text(Utils.toFixed(valueRange.max, options.decimalPlaces), EnergySkateParkConstants.CONTROL_TICK_LABEL_OPTIONS)
      }]
    }, EnergySkateParkConstants.SLIDER_OPTIONS, options.sliderOptions);
    if (options.sliderOnly) {
      // if we are not including tweaker buttons, don't constrain slider value to tweaker deltas
      options.sliderOptions.constrainValue = options.sliderOptions.constrainValue || _.identity;
    }
    options.numberDisplayOptions = merge({
      decimalPlaces: options.decimalPlaces
    }, options.numberDisplayOptions);

    // look and feel for all PhysicalNumberControls (not set in normal options extend calls because they cannot be
    // changed with options!)
    merge(options, {
      arrowButtonOptions: {
        scale: 0.61
      },
      /**
       * Custom layout for the NumberControl - if the slider is the only form of input for the control the tweaker
       * and number display are hidden. But we still have the same layout for the title so that this matches other
       * NumberControls used in energy-skate-park.
       *
       * @param {Node} titleNode
       * @param {NumberDisplay} numberDisplay
       * @param {Slider} slider
       * @param {ArrowButton} leftArrowButton
       * @param {ArrowButton} rightArrowButton
       * @returns {Node}
       */
      layoutFunction: (titleNode, numberDisplay, slider, leftArrowButton, rightArrowButton) => {
        // default layout, once done we will hide extra components if this is only meant to display the slider
        const defaultLayoutFunction = NumberControl.createLayoutFunction4({
          // arrow buttons a bit tighter than default to provide more room for content in screens
          arrowButtonSpacing: 2,
          // can be multiple physical controls in a panel, need to make some extra space
          verticalSpacing: 2,
          layoutInvisibleButtons: true
        });
        const children = defaultLayoutFunction(titleNode, numberDisplay, slider, leftArrowButton, rightArrowButton);
        if (options.sliderOnly) {
          leftArrowButton.visible = false;
          rightArrowButton.visible = false;
          numberDisplay.visible = false;
        }
        return children;
      },
      sliderOptions: options.sliderOptions,
      numberDisplayOptions: merge(options.numberDisplayOptions, {
        xMargin: 2,
        yMargin: 2,
        textOptions: {
          font: new PhetFont(12),
          maxWidth: 61
        }
      }),
      titleNodeOptions: {
        font: EnergySkateParkConstants.CONTROL_TITLE_FONT,
        maxWidth: 61
      },
      // phet-io
      tandem: tandem
    });
    super(titleString, property, valueRange, options);
  }
}
energySkatePark.register('PhysicalNumberControl', PhysicalNumberControl);
export default PhysicalNumberControl;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIm1lcmdlIiwiTnVtYmVyQ29udHJvbCIsIlBoZXRGb250IiwiVGV4dCIsImVuZXJneVNrYXRlUGFyayIsIkVuZXJneVNrYXRlUGFya0NvbnN0YW50cyIsIlBoeXNpY2FsTnVtYmVyQ29udHJvbCIsImNvbnN0cnVjdG9yIiwidGl0bGVTdHJpbmciLCJwcm9wZXJ0eSIsInZhbHVlUmFuZ2UiLCJ1c2VyQ29udHJvbGxlZFByb3BlcnR5IiwidGFuZGVtIiwib3B0aW9ucyIsImFzc2VydCIsImxheW91dEZ1bmN0aW9uIiwidW5kZWZpbmVkIiwiYXJyb3dCdXR0b25PcHRpb25zIiwidGl0bGVGb250IiwibnVtYmVyRGlzcGxheU9wdGlvbnMiLCJ0ZXh0T3B0aW9ucyIsImZvbnQiLCJ4TWFyZ2luIiwieU1hcmdpbiIsImRlY2ltYWxQbGFjZXMiLCJzdGFydENhbGxiYWNrIiwic2V0IiwiZW5kQ2FsbGJhY2siLCJzbGlkZXJPbmx5Iiwic2xpZGVyT3B0aW9ucyIsIm1ham9yVGlja3MiLCJ2YWx1ZSIsIm1pbiIsImxhYmVsIiwidG9GaXhlZCIsIkNPTlRST0xfVElDS19MQUJFTF9PUFRJT05TIiwibWF4IiwiU0xJREVSX09QVElPTlMiLCJjb25zdHJhaW5WYWx1ZSIsIl8iLCJpZGVudGl0eSIsInNjYWxlIiwidGl0bGVOb2RlIiwibnVtYmVyRGlzcGxheSIsInNsaWRlciIsImxlZnRBcnJvd0J1dHRvbiIsInJpZ2h0QXJyb3dCdXR0b24iLCJkZWZhdWx0TGF5b3V0RnVuY3Rpb24iLCJjcmVhdGVMYXlvdXRGdW5jdGlvbjQiLCJhcnJvd0J1dHRvblNwYWNpbmciLCJ2ZXJ0aWNhbFNwYWNpbmciLCJsYXlvdXRJbnZpc2libGVCdXR0b25zIiwiY2hpbGRyZW4iLCJ2aXNpYmxlIiwibWF4V2lkdGgiLCJ0aXRsZU5vZGVPcHRpb25zIiwiQ09OVFJPTF9USVRMRV9GT05UIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJQaHlzaWNhbE51bWJlckNvbnRyb2wuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTktMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQSBOdW1iZXJDb250cm9sIHRoYXQgY29udHJvbHMgYSBwaHlzaWNhbCB2YWx1ZSBvZiB0aGUgbW9kZWwgaW4gRW5lcmd5IFNrYXRlIFBhcmsuXHJcbiAqXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgbWVyZ2UgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL21lcmdlLmpzJztcclxuaW1wb3J0IE51bWJlckNvbnRyb2wgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL051bWJlckNvbnRyb2wuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgVGV4dCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBlbmVyZ3lTa2F0ZVBhcmsgZnJvbSAnLi4vLi4vZW5lcmd5U2thdGVQYXJrLmpzJztcclxuaW1wb3J0IEVuZXJneVNrYXRlUGFya0NvbnN0YW50cyBmcm9tICcuLi9FbmVyZ3lTa2F0ZVBhcmtDb25zdGFudHMuanMnO1xyXG5cclxuY2xhc3MgUGh5c2ljYWxOdW1iZXJDb250cm9sIGV4dGVuZHMgTnVtYmVyQ29udHJvbCB7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0aXRsZVN0cmluZ1xyXG4gICAqIEBwYXJhbSB7TnVtYmVyUHJvcGVydHl9IHByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtSYW5nZX0gdmFsdWVSYW5nZVxyXG4gICAqIEBwYXJhbSB7Qm9vbGVhblByb3BlcnR5fSB1c2VyQ29udHJvbGxlZFByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtUYW5kZW19IHRhbmRlbVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggdGl0bGVTdHJpbmcsIHByb3BlcnR5LCB2YWx1ZVJhbmdlLCB1c2VyQ29udHJvbGxlZFByb3BlcnR5LCB0YW5kZW0sIG9wdGlvbnMgKSB7XHJcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG9wdGlvbnMubGF5b3V0RnVuY3Rpb24gPT09IHVuZGVmaW5lZCwgJ1BoeXNpY2FsTnVtYmVyQ29udHJvbCBzZXRzIGxheW91dEZ1bmN0aW9uJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy50YW5kZW0gPT09IHVuZGVmaW5lZCwgJ1BoeXNpY2FsTnVtYmVyQ29udHJvbCBzaG91bGRuXFwndCBzZXQgdGFuZGVtIGluIG9wdGlvbnMnICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvcHRpb25zLmFycm93QnV0dG9uT3B0aW9ucyA9PT0gdW5kZWZpbmVkLCAnUGh5c2ljYWxOdW1iZXJDb250cm9sIHNldHMgYXJyb3dCdXR0b25PcHRpb25zJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy50aXRsZUZvbnQgPT09IHVuZGVmaW5lZCwgJ1BoeXNpY2FsTnVtYmVyQ29udHJvbCBzZXRzIHRpdGxlIGZvbnQnICk7XHJcblxyXG4gICAgaWYgKCBvcHRpb25zLm51bWJlckRpc3BsYXlPcHRpb25zICkge1xyXG4gICAgICBpZiAoIG9wdGlvbnMubnVtYmVyRGlzcGxheU9wdGlvbnMudGV4dE9wdGlvbnMgKSB7XHJcbiAgICAgICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy5udW1iZXJEaXNwbGF5T3B0aW9ucy50ZXh0T3B0aW9ucy5mb250ID09PSB1bmRlZmluZWQsICdQaHlzaWNhbE51bWJlckNvbnRyb2wgc2V0cyBmb250JyApO1xyXG4gICAgICB9XHJcbiAgICAgIGFzc2VydCAmJiBhc3NlcnQoIG9wdGlvbnMubnVtYmVyRGlzcGxheU9wdGlvbnMueE1hcmdpbiA9PT0gdW5kZWZpbmVkLCAnUGh5c2ljYWxOdW1iZXJDb250cm9sIHNldHMgeE1hcmdpbicgKTtcclxuICAgICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy5udW1iZXJEaXNwbGF5T3B0aW9ucy55TWFyZ2luID09PSB1bmRlZmluZWQsICdQaHlzaWNhbE51bWJlckNvbnRyb2wgc2V0cyB5TWFyZ2luJyApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHNsaWRlciBvcHRpb25zIGFyZSBwYXNzZWQgZGlyZWN0bHkgdG8gdGhlIFNsaWRlciBpbiBOdW1iZXJDb250cm9sXHJcbiAgICBvcHRpb25zID0gbWVyZ2UoIHtcclxuXHJcbiAgICAgIC8vIGRlY2ltYWwgcGxhY2VzIGZvciB0aGUgdGlja3MgYW5kIChieSBkZWZhdWx0KSB0aGUgTnVtYmVyQ29udHJvbCdzIE51bWJlckRpc3BsYXlcclxuICAgICAgZGVjaW1hbFBsYWNlczogMCxcclxuXHJcbiAgICAgIHN0YXJ0Q2FsbGJhY2s6ICgpID0+IHtcclxuICAgICAgICB1c2VyQ29udHJvbGxlZFByb3BlcnR5LnNldCggdHJ1ZSApO1xyXG4gICAgICB9LFxyXG4gICAgICBlbmRDYWxsYmFjazogKCkgPT4ge1xyXG4gICAgICAgIHVzZXJDb250cm9sbGVkUHJvcGVydHkuc2V0KCBmYWxzZSApO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8ge2Jvb2xlYW59IC0gaWYgdHJ1ZSwgdGhlIHR3ZWFrZXIgYnV0dG9ucyBhbmQgbnVtYmVyIGRpc3BsYXkgd2lsbCBiZSBoaWRkZW4gKGJ1dCByZXN0IG9mIE51bWJlckNvbnRyb2wgdGl0bGVcclxuICAgICAgLy8gYW5kIGxheW91dCB3aWxsIGJlIHByZXNlcnZlZClcclxuICAgICAgc2xpZGVyT25seTogZmFsc2UsXHJcblxyXG4gICAgICAvLyB7KnxudWxsfSAtIHBhc3NlZCB0byB0aGUgU2xpZGVyIG9mIE51bWJlckNvbnRyb2wsIGV4dGVuZGVkIGJlbG93XHJcbiAgICAgIHNsaWRlck9wdGlvbnM6IG51bGwsXHJcblxyXG4gICAgICAvLyB7KnxudWxsfSAtIHBhc3NlZCB0byB0aGUgTnVtYmVyRGlzcGxheSBvZiBOdW1iZXJDb250cm9sLCBleHRlbmRlZCBiZWxvd1xyXG4gICAgICBudW1iZXJEaXNwbGF5T3B0aW9uczogbnVsbFxyXG4gICAgfSwgb3B0aW9ucyApO1xyXG5cclxuICAgIG9wdGlvbnMuc2xpZGVyT3B0aW9ucyA9IG1lcmdlKCB7XHJcbiAgICAgIG1ham9yVGlja3M6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICB2YWx1ZTogdmFsdWVSYW5nZS5taW4sXHJcbiAgICAgICAgICBsYWJlbDogbmV3IFRleHQoIFV0aWxzLnRvRml4ZWQoIHZhbHVlUmFuZ2UubWluLCBvcHRpb25zLmRlY2ltYWxQbGFjZXMgKSwgRW5lcmd5U2thdGVQYXJrQ29uc3RhbnRzLkNPTlRST0xfVElDS19MQUJFTF9PUFRJT05TIClcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHZhbHVlOiB2YWx1ZVJhbmdlLm1heCxcclxuICAgICAgICAgIGxhYmVsOiBuZXcgVGV4dCggVXRpbHMudG9GaXhlZCggdmFsdWVSYW5nZS5tYXgsIG9wdGlvbnMuZGVjaW1hbFBsYWNlcyApLCBFbmVyZ3lTa2F0ZVBhcmtDb25zdGFudHMuQ09OVFJPTF9USUNLX0xBQkVMX09QVElPTlMgKVxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG4gICAgfSwgRW5lcmd5U2thdGVQYXJrQ29uc3RhbnRzLlNMSURFUl9PUFRJT05TLCBvcHRpb25zLnNsaWRlck9wdGlvbnMgKTtcclxuXHJcbiAgICBpZiAoIG9wdGlvbnMuc2xpZGVyT25seSApIHtcclxuXHJcbiAgICAgIC8vIGlmIHdlIGFyZSBub3QgaW5jbHVkaW5nIHR3ZWFrZXIgYnV0dG9ucywgZG9uJ3QgY29uc3RyYWluIHNsaWRlciB2YWx1ZSB0byB0d2Vha2VyIGRlbHRhc1xyXG4gICAgICBvcHRpb25zLnNsaWRlck9wdGlvbnMuY29uc3RyYWluVmFsdWUgPSBvcHRpb25zLnNsaWRlck9wdGlvbnMuY29uc3RyYWluVmFsdWUgfHwgXy5pZGVudGl0eTtcclxuICAgIH1cclxuXHJcbiAgICBvcHRpb25zLm51bWJlckRpc3BsYXlPcHRpb25zID0gbWVyZ2UoIHtcclxuICAgICAgZGVjaW1hbFBsYWNlczogb3B0aW9ucy5kZWNpbWFsUGxhY2VzXHJcbiAgICB9LCBvcHRpb25zLm51bWJlckRpc3BsYXlPcHRpb25zICk7XHJcblxyXG4gICAgLy8gbG9vayBhbmQgZmVlbCBmb3IgYWxsIFBoeXNpY2FsTnVtYmVyQ29udHJvbHMgKG5vdCBzZXQgaW4gbm9ybWFsIG9wdGlvbnMgZXh0ZW5kIGNhbGxzIGJlY2F1c2UgdGhleSBjYW5ub3QgYmVcclxuICAgIC8vIGNoYW5nZWQgd2l0aCBvcHRpb25zISlcclxuICAgIG1lcmdlKCBvcHRpb25zLCB7XHJcbiAgICAgIGFycm93QnV0dG9uT3B0aW9uczoge1xyXG4gICAgICAgIHNjYWxlOiAwLjYxXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogQ3VzdG9tIGxheW91dCBmb3IgdGhlIE51bWJlckNvbnRyb2wgLSBpZiB0aGUgc2xpZGVyIGlzIHRoZSBvbmx5IGZvcm0gb2YgaW5wdXQgZm9yIHRoZSBjb250cm9sIHRoZSB0d2Vha2VyXHJcbiAgICAgICAqIGFuZCBudW1iZXIgZGlzcGxheSBhcmUgaGlkZGVuLiBCdXQgd2Ugc3RpbGwgaGF2ZSB0aGUgc2FtZSBsYXlvdXQgZm9yIHRoZSB0aXRsZSBzbyB0aGF0IHRoaXMgbWF0Y2hlcyBvdGhlclxyXG4gICAgICAgKiBOdW1iZXJDb250cm9scyB1c2VkIGluIGVuZXJneS1za2F0ZS1wYXJrLlxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAcGFyYW0ge05vZGV9IHRpdGxlTm9kZVxyXG4gICAgICAgKiBAcGFyYW0ge051bWJlckRpc3BsYXl9IG51bWJlckRpc3BsYXlcclxuICAgICAgICogQHBhcmFtIHtTbGlkZXJ9IHNsaWRlclxyXG4gICAgICAgKiBAcGFyYW0ge0Fycm93QnV0dG9ufSBsZWZ0QXJyb3dCdXR0b25cclxuICAgICAgICogQHBhcmFtIHtBcnJvd0J1dHRvbn0gcmlnaHRBcnJvd0J1dHRvblxyXG4gICAgICAgKiBAcmV0dXJucyB7Tm9kZX1cclxuICAgICAgICovXHJcbiAgICAgIGxheW91dEZ1bmN0aW9uOiAoIHRpdGxlTm9kZSwgbnVtYmVyRGlzcGxheSwgc2xpZGVyLCBsZWZ0QXJyb3dCdXR0b24sIHJpZ2h0QXJyb3dCdXR0b24gKSA9PiB7XHJcblxyXG4gICAgICAgIC8vIGRlZmF1bHQgbGF5b3V0LCBvbmNlIGRvbmUgd2Ugd2lsbCBoaWRlIGV4dHJhIGNvbXBvbmVudHMgaWYgdGhpcyBpcyBvbmx5IG1lYW50IHRvIGRpc3BsYXkgdGhlIHNsaWRlclxyXG4gICAgICAgIGNvbnN0IGRlZmF1bHRMYXlvdXRGdW5jdGlvbiA9IE51bWJlckNvbnRyb2wuY3JlYXRlTGF5b3V0RnVuY3Rpb240KCB7XHJcblxyXG4gICAgICAgICAgLy8gYXJyb3cgYnV0dG9ucyBhIGJpdCB0aWdodGVyIHRoYW4gZGVmYXVsdCB0byBwcm92aWRlIG1vcmUgcm9vbSBmb3IgY29udGVudCBpbiBzY3JlZW5zXHJcbiAgICAgICAgICBhcnJvd0J1dHRvblNwYWNpbmc6IDIsXHJcblxyXG4gICAgICAgICAgLy8gY2FuIGJlIG11bHRpcGxlIHBoeXNpY2FsIGNvbnRyb2xzIGluIGEgcGFuZWwsIG5lZWQgdG8gbWFrZSBzb21lIGV4dHJhIHNwYWNlXHJcbiAgICAgICAgICB2ZXJ0aWNhbFNwYWNpbmc6IDIsXHJcblxyXG4gICAgICAgICAgbGF5b3V0SW52aXNpYmxlQnV0dG9uczogdHJ1ZVxyXG4gICAgICAgIH0gKTtcclxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGRlZmF1bHRMYXlvdXRGdW5jdGlvbiggdGl0bGVOb2RlLCBudW1iZXJEaXNwbGF5LCBzbGlkZXIsIGxlZnRBcnJvd0J1dHRvbiwgcmlnaHRBcnJvd0J1dHRvbiApO1xyXG5cclxuICAgICAgICBpZiAoIG9wdGlvbnMuc2xpZGVyT25seSApIHtcclxuICAgICAgICAgIGxlZnRBcnJvd0J1dHRvbi52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICByaWdodEFycm93QnV0dG9uLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgIG51bWJlckRpc3BsYXkudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xyXG4gICAgICB9LFxyXG4gICAgICBzbGlkZXJPcHRpb25zOiBvcHRpb25zLnNsaWRlck9wdGlvbnMsXHJcbiAgICAgIG51bWJlckRpc3BsYXlPcHRpb25zOiBtZXJnZSggb3B0aW9ucy5udW1iZXJEaXNwbGF5T3B0aW9ucywge1xyXG4gICAgICAgIHhNYXJnaW46IDIsXHJcbiAgICAgICAgeU1hcmdpbjogMixcclxuICAgICAgICB0ZXh0T3B0aW9uczoge1xyXG4gICAgICAgICAgZm9udDogbmV3IFBoZXRGb250KCAxMiApLFxyXG4gICAgICAgICAgbWF4V2lkdGg6IDYxXHJcbiAgICAgICAgfVxyXG4gICAgICB9ICksXHJcbiAgICAgIHRpdGxlTm9kZU9wdGlvbnM6IHtcclxuICAgICAgICBmb250OiBFbmVyZ3lTa2F0ZVBhcmtDb25zdGFudHMuQ09OVFJPTF9USVRMRV9GT05ULFxyXG4gICAgICAgIG1heFdpZHRoOiA2MVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gcGhldC1pb1xyXG4gICAgICB0YW5kZW06IHRhbmRlbVxyXG4gICAgfSApO1xyXG5cclxuICAgIHN1cGVyKCB0aXRsZVN0cmluZywgcHJvcGVydHksIHZhbHVlUmFuZ2UsIG9wdGlvbnMgKTtcclxuICB9XHJcbn1cclxuXHJcbmVuZXJneVNrYXRlUGFyay5yZWdpc3RlciggJ1BoeXNpY2FsTnVtYmVyQ29udHJvbCcsIFBoeXNpY2FsTnVtYmVyQ29udHJvbCApO1xyXG5leHBvcnQgZGVmYXVsdCBQaHlzaWNhbE51bWJlckNvbnRyb2w7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLEtBQUssTUFBTSw2QkFBNkI7QUFDL0MsT0FBT0MsS0FBSyxNQUFNLG1DQUFtQztBQUNyRCxPQUFPQyxhQUFhLE1BQU0sOENBQThDO0FBQ3hFLE9BQU9DLFFBQVEsTUFBTSx5Q0FBeUM7QUFDOUQsU0FBU0MsSUFBSSxRQUFRLG1DQUFtQztBQUN4RCxPQUFPQyxlQUFlLE1BQU0sMEJBQTBCO0FBQ3RELE9BQU9DLHdCQUF3QixNQUFNLGdDQUFnQztBQUVyRSxNQUFNQyxxQkFBcUIsU0FBU0wsYUFBYSxDQUFDO0VBRWhEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRU0sV0FBV0EsQ0FBRUMsV0FBVyxFQUFFQyxRQUFRLEVBQUVDLFVBQVUsRUFBRUMsc0JBQXNCLEVBQUVDLE1BQU0sRUFBRUMsT0FBTyxFQUFHO0lBQ3hGQSxPQUFPLEdBQUdBLE9BQU8sSUFBSSxDQUFDLENBQUM7SUFDdkJDLE1BQU0sSUFBSUEsTUFBTSxDQUFFRCxPQUFPLENBQUNFLGNBQWMsS0FBS0MsU0FBUyxFQUFFLDJDQUE0QyxDQUFDO0lBQ3JHRixNQUFNLElBQUlBLE1BQU0sQ0FBRUQsT0FBTyxDQUFDRCxNQUFNLEtBQUtJLFNBQVMsRUFBRSx3REFBeUQsQ0FBQztJQUMxR0YsTUFBTSxJQUFJQSxNQUFNLENBQUVELE9BQU8sQ0FBQ0ksa0JBQWtCLEtBQUtELFNBQVMsRUFBRSwrQ0FBZ0QsQ0FBQztJQUM3R0YsTUFBTSxJQUFJQSxNQUFNLENBQUVELE9BQU8sQ0FBQ0ssU0FBUyxLQUFLRixTQUFTLEVBQUUsdUNBQXdDLENBQUM7SUFFNUYsSUFBS0gsT0FBTyxDQUFDTSxvQkFBb0IsRUFBRztNQUNsQyxJQUFLTixPQUFPLENBQUNNLG9CQUFvQixDQUFDQyxXQUFXLEVBQUc7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