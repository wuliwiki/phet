// Copyright 2013-2023, University of Colorado Boulder

/**
 * Radio button group for choosing one of the tracks, used in a "Track Set" screen of EnergySkatePark. This changes
 * the "scene" of the sim.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import Property from '../../../../axon/js/Property.js';
import Bounds2 from '../../../../dot/js/Bounds2.js';
import merge from '../../../../phet-core/js/merge.js';
import { AlignGroup, Node } from '../../../../scenery/js/imports.js';
import RectangularRadioButtonGroup from '../../../../sun/js/buttons/RectangularRadioButtonGroup.js';
import energySkatePark from '../../energySkatePark.js';
import EnergySkateParkConstants from '../EnergySkateParkConstants.js';
import EnergySkateParkTrackSetModel from '../model/EnergySkateParkTrackSetModel.js';
import PremadeTracks from '../model/PremadeTracks.js';
import BackgroundNode from './BackgroundNode.js';
import EnergySkateParkColorScheme from './EnergySkateParkColorScheme.js';
import TrackNode from './TrackNode.js';
class SceneSelectionRadioButtonGroup extends RectangularRadioButtonGroup {
  /**
   * Construct a SceneSelectionRadioButtonGroup.  Pass the entire model since it is used to create TrackNode
   *
   * @param {EnergySkateParkModel} model the main model for the entire screen
   * @param {EnergySkateParkScreenView} view the main view for the entire screen
   * @param {Tandem} tandem
   * @param {Object} [options]
   */
  constructor(model, view, tandem, options) {
    assert && assert(model.sceneProperty !== undefined, 'model does not support a scene');
    options = merge({
      // specific and passed to RectangularRadioButtonGroup
      orientation: 'horizontal',
      radioButtonOptions: {
        xMargin: EnergySkateParkConstants.RADIO_BUTTON_CONTENT_MARGIN,
        yMargin: EnergySkateParkConstants.RADIO_BUTTON_CONTENT_MARGIN,
        cornerRadius: EnergySkateParkConstants.RADIO_BUTTON_CORNER_RADIUS,
        baseColor: EnergySkateParkColorScheme.radioButtonBaseColor,
        buttonAppearanceStrategyOptions: {
          selectedStroke: EnergySkateParkColorScheme.radioButtonSelectedStroke
        }
      },
      tandem: tandem,
      // {boolean} - should mountains, background, and sky be included in the icon for track buttons?
      includeBackground: false
    }, options);

    // produces spacing of ~5 when there are 4 premade tracks which is the usual case and looks nice, and provides
    // more spacing if there are fewer tracks
    assert && assert(options.spacing === undefined, 'SceneSelectionRadioButtonGroup sets spacing from number of premade tracks');
    options.spacing = 20 / model.tracks.length;

    // Create a track to be used specifically for an icon - must be one of the premade tracks defined in
    // PremadeTracks.TrackType. These Tracks are a bit different from the actual tracks used in the model
    // because their sizing and dimensions need to be different to look better as icons for radio buttons
    const createIconTrack = trackType => {
      // all tracks have the same width and height so they take up the same dimensions in a radio button, so one
      // doesn't get scaled down more than another and look more thin
      const controlPointOptions = {
        trackWidth: 6,
        trackHeight: 6
      };
      let track = null;
      if (trackType === PremadeTracks.TrackType.PARABOLA) {
        const parabolaControlPoints = PremadeTracks.createParabolaControlPoints(model, merge({
          trackMidHeight: 1
        }, controlPointOptions));
        track = EnergySkateParkTrackSetModel.createPremadeTrack(model, parabolaControlPoints, {
          tandem: tandem.createTandem('parabolaTrackIcon')
        });
      } else if (trackType === PremadeTracks.TrackType.SLOPE) {
        const slopeControlPoints = PremadeTracks.createSlopeControlPoints(model, controlPointOptions);
        track = EnergySkateParkTrackSetModel.createPremadeTrack(model, slopeControlPoints, {
          tandem: tandem.createTandem('slopeTrackIcon')
        });
      } else if (trackType === PremadeTracks.TrackType.DOUBLE_WELL) {
        const doubleWellControlPoints = PremadeTracks.createDoubleWellControlPoints(model, controlPointOptions);
        track = EnergySkateParkTrackSetModel.createPremadeTrack(model, doubleWellControlPoints, {
          tandem: tandem.createTandem('doubleWellTrackIcon')
        });
      } else if (trackType === PremadeTracks.TrackType.LOOP) {
        const loopControlPoints = PremadeTracks.createLoopControlPoints(model, merge({
          innerLoopWidth: 2.5,
          innerLoopTop: 3.5
        }, controlPointOptions));
        track = EnergySkateParkTrackSetModel.createPremadeTrack(model, loopControlPoints, {
          tandem: tandem.createTandem('loopTrackIcon')
        });
      } else {
        throw new Error(`unsupported TrackType: ${trackType}`);
      }
      return track;
    };

    // Create a button with a scene like the track in the index
    const createNode = index => {
      const children = [];
      if (options.includeBackground) {
        const background = new BackgroundNode(view.layoutBounds, tandem.createTandem(`backgroundNode${index}`));
        background.layout(new Bounds2(0, 0, view.layoutBounds.width, view.layoutBounds.height), 1);
        children.push(background);
      }
      const track = createIconTrack(model.trackTypes[index]);
      const trackNode = new TrackNode(track, view.modelViewTransform, new Property(), tandem.createTandem(`trackNode${index}`), {
        isIcon: true
      });

      // use a rasterized version of the node so that the icon doesn't change with the model for configurable tracks
      const iconNode = trackNode.rasterized();
      children.push(iconNode);

      // Fixes: Cursor turns into a hand over the track in the track selection panel, see #204
      iconNode.pickable = false;
      return new Node({
        tandem: tandem.createTandem(`contentNode${index}`),
        children: children
      });
    };

    // create the contents for the radio buttons
    const contents = [];
    _.forEach(model.tracks, (track, i) => {
      const contentNode = createNode(i);
      contents.push(contentNode);
    });
    const minWidth = _.minBy(contents, node => node.width).width;
    const buttonAlignGroup = new AlignGroup();
    const radioButtonContent = [];
    _.forEach(contents, (node, i) => {
      // scalar chosen so that buttons are appropriately sized in the control panel
      const contentScale = 27 / minWidth;

      // if there isn't a background, scale the tracks so that they are all the same width
      if (!options.includeBackground) {
        node.setScaleMagnitude(contentScale * (minWidth / node.width));
      } else {
        node.scale(contentScale);
      }

      // place in an align group and add margins so that the buttons are always square
      const alignedNode = buttonAlignGroup.createBox(node);
      const margin = Math.abs(alignedNode.width - alignedNode.height) / 2;
      if (margin !== 0) {
        const setterFunction = alignedNode.height < alignedNode.width ? alignedNode.setYMargin : alignedNode.setXMargin;
        setterFunction.call(alignedNode, margin);
      }
      radioButtonContent.push({
        value: i,
        createNode: () => alignedNode,
        tandemName: `scene${i + 1}RadioButton`
      });
    });
    super(model.sceneProperty, radioButtonContent, options);
  }
}
energySkatePark.register('SceneSelectionRadioButtonGroup', SceneSelectionRadioButtonGroup);
export default SceneSelectionRadioButtonGroup;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIkJvdW5kczIiLCJtZXJnZSIsIkFsaWduR3JvdXAiLCJOb2RlIiwiUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwIiwiZW5lcmd5U2thdGVQYXJrIiwiRW5lcmd5U2thdGVQYXJrQ29uc3RhbnRzIiwiRW5lcmd5U2thdGVQYXJrVHJhY2tTZXRNb2RlbCIsIlByZW1hZGVUcmFja3MiLCJCYWNrZ3JvdW5kTm9kZSIsIkVuZXJneVNrYXRlUGFya0NvbG9yU2NoZW1lIiwiVHJhY2tOb2RlIiwiU2NlbmVTZWxlY3Rpb25SYWRpb0J1dHRvbkdyb3VwIiwiY29uc3RydWN0b3IiLCJtb2RlbCIsInZpZXciLCJ0YW5kZW0iLCJvcHRpb25zIiwiYXNzZXJ0Iiwic2NlbmVQcm9wZXJ0eSIsInVuZGVmaW5lZCIsIm9yaWVudGF0aW9uIiwicmFkaW9CdXR0b25PcHRpb25zIiwieE1hcmdpbiIsIlJBRElPX0JVVFRPTl9DT05URU5UX01BUkdJTiIsInlNYXJnaW4iLCJjb3JuZXJSYWRpdXMiLCJSQURJT19CVVRUT05fQ09STkVSX1JBRElVUyIsImJhc2VDb2xvciIsInJhZGlvQnV0dG9uQmFzZUNvbG9yIiwiYnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5T3B0aW9ucyIsInNlbGVjdGVkU3Ryb2tlIiwicmFkaW9CdXR0b25TZWxlY3RlZFN0cm9rZSIsImluY2x1ZGVCYWNrZ3JvdW5kIiwic3BhY2luZyIsInRyYWNrcyIsImxlbmd0aCIsImNyZWF0ZUljb25UcmFjayIsInRyYWNrVHlwZSIsImNvbnRyb2xQb2ludE9wdGlvbnMiLCJ0cmFja1dpZHRoIiwidHJhY2tIZWlnaHQiLCJ0cmFjayIsIlRyYWNrVHlwZSIsIlBBUkFCT0xBIiwicGFyYWJvbGFDb250cm9sUG9pbnRzIiwiY3JlYXRlUGFyYWJvbGFDb250cm9sUG9pbnRzIiwidHJhY2tNaWRIZWlnaHQiLCJjcmVhdGVQcmVtYWRlVHJhY2siLCJjcmVhdGVUYW5kZW0iLCJTTE9QRSIsInNsb3BlQ29udHJvbFBvaW50cyIsImNyZWF0ZVNsb3BlQ29udHJvbFBvaW50cyIsIkRPVUJMRV9XRUxMIiwiZG91YmxlV2VsbENvbnRyb2xQb2ludHMiLCJjcmVhdGVEb3VibGVXZWxsQ29udHJvbFBvaW50cyIsIkxPT1AiLCJsb29wQ29udHJvbFBvaW50cyIsImNyZWF0ZUxvb3BDb250cm9sUG9pbnRzIiwiaW5uZXJMb29wV2lkdGgiLCJpbm5lckxvb3BUb3AiLCJFcnJvciIsImNyZWF0ZU5vZGUiLCJpbmRleCIsImNoaWxkcmVuIiwiYmFja2dyb3VuZCIsImxheW91dEJvdW5kcyIsImxheW91dCIsIndpZHRoIiwiaGVpZ2h0IiwicHVzaCIsInRyYWNrVHlwZXMiLCJ0cmFja05vZGUiLCJtb2RlbFZpZXdUcmFuc2Zvcm0iLCJpc0ljb24iLCJpY29uTm9kZSIsInJhc3Rlcml6ZWQiLCJwaWNrYWJsZSIsImNvbnRlbnRzIiwiXyIsImZvckVhY2giLCJpIiwiY29udGVudE5vZGUiLCJtaW5XaWR0aCIsIm1pbkJ5Iiwibm9kZSIsImJ1dHRvbkFsaWduR3JvdXAiLCJyYWRpb0J1dHRvbkNvbnRlbnQiLCJjb250ZW50U2NhbGUiLCJzZXRTY2FsZU1hZ25pdHVkZSIsInNjYWxlIiwiYWxpZ25lZE5vZGUiLCJjcmVhdGVCb3giLCJtYXJnaW4iLCJNYXRoIiwiYWJzIiwic2V0dGVyRnVuY3Rpb24iLCJzZXRZTWFyZ2luIiwic2V0WE1hcmdpbiIsImNhbGwiLCJ2YWx1ZSIsInRhbmRlbU5hbWUiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlNjZW5lU2VsZWN0aW9uUmFkaW9CdXR0b25Hcm91cC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxMy0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBSYWRpbyBidXR0b24gZ3JvdXAgZm9yIGNob29zaW5nIG9uZSBvZiB0aGUgdHJhY2tzLCB1c2VkIGluIGEgXCJUcmFjayBTZXRcIiBzY3JlZW4gb2YgRW5lcmd5U2thdGVQYXJrLiBUaGlzIGNoYW5nZXNcclxuICogdGhlIFwic2NlbmVcIiBvZiB0aGUgc2ltLlxyXG4gKlxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBCb3VuZHMyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9Cb3VuZHMyLmpzJztcclxuaW1wb3J0IG1lcmdlIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9tZXJnZS5qcyc7XHJcbmltcG9ydCB7IEFsaWduR3JvdXAsIE5vZGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwIGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9idXR0b25zL1JlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cC5qcyc7XHJcbmltcG9ydCBlbmVyZ3lTa2F0ZVBhcmsgZnJvbSAnLi4vLi4vZW5lcmd5U2thdGVQYXJrLmpzJztcclxuaW1wb3J0IEVuZXJneVNrYXRlUGFya0NvbnN0YW50cyBmcm9tICcuLi9FbmVyZ3lTa2F0ZVBhcmtDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgRW5lcmd5U2thdGVQYXJrVHJhY2tTZXRNb2RlbCBmcm9tICcuLi9tb2RlbC9FbmVyZ3lTa2F0ZVBhcmtUcmFja1NldE1vZGVsLmpzJztcclxuaW1wb3J0IFByZW1hZGVUcmFja3MgZnJvbSAnLi4vbW9kZWwvUHJlbWFkZVRyYWNrcy5qcyc7XHJcbmltcG9ydCBCYWNrZ3JvdW5kTm9kZSBmcm9tICcuL0JhY2tncm91bmROb2RlLmpzJztcclxuaW1wb3J0IEVuZXJneVNrYXRlUGFya0NvbG9yU2NoZW1lIGZyb20gJy4vRW5lcmd5U2thdGVQYXJrQ29sb3JTY2hlbWUuanMnO1xyXG5pbXBvcnQgVHJhY2tOb2RlIGZyb20gJy4vVHJhY2tOb2RlLmpzJztcclxuXHJcbmNsYXNzIFNjZW5lU2VsZWN0aW9uUmFkaW9CdXR0b25Hcm91cCBleHRlbmRzIFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cCB7XHJcblxyXG4gIC8qKlxyXG4gICAqIENvbnN0cnVjdCBhIFNjZW5lU2VsZWN0aW9uUmFkaW9CdXR0b25Hcm91cC4gIFBhc3MgdGhlIGVudGlyZSBtb2RlbCBzaW5jZSBpdCBpcyB1c2VkIHRvIGNyZWF0ZSBUcmFja05vZGVcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7RW5lcmd5U2thdGVQYXJrTW9kZWx9IG1vZGVsIHRoZSBtYWluIG1vZGVsIGZvciB0aGUgZW50aXJlIHNjcmVlblxyXG4gICAqIEBwYXJhbSB7RW5lcmd5U2thdGVQYXJrU2NyZWVuVmlld30gdmlldyB0aGUgbWFpbiB2aWV3IGZvciB0aGUgZW50aXJlIHNjcmVlblxyXG4gICAqIEBwYXJhbSB7VGFuZGVtfSB0YW5kZW1cclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG1vZGVsLCB2aWV3LCB0YW5kZW0sIG9wdGlvbnMgKSB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBtb2RlbC5zY2VuZVByb3BlcnR5ICE9PSB1bmRlZmluZWQsICdtb2RlbCBkb2VzIG5vdCBzdXBwb3J0IGEgc2NlbmUnICk7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcblxyXG4gICAgICAvLyBzcGVjaWZpYyBhbmQgcGFzc2VkIHRvIFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cFxyXG4gICAgICBvcmllbnRhdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICByYWRpb0J1dHRvbk9wdGlvbnM6IHtcclxuICAgICAgICB4TWFyZ2luOiBFbmVyZ3lTa2F0ZVBhcmtDb25zdGFudHMuUkFESU9fQlVUVE9OX0NPTlRFTlRfTUFSR0lOLFxyXG4gICAgICAgIHlNYXJnaW46IEVuZXJneVNrYXRlUGFya0NvbnN0YW50cy5SQURJT19CVVRUT05fQ09OVEVOVF9NQVJHSU4sXHJcbiAgICAgICAgY29ybmVyUmFkaXVzOiBFbmVyZ3lTa2F0ZVBhcmtDb25zdGFudHMuUkFESU9fQlVUVE9OX0NPUk5FUl9SQURJVVMsXHJcbiAgICAgICAgYmFzZUNvbG9yOiBFbmVyZ3lTa2F0ZVBhcmtDb2xvclNjaGVtZS5yYWRpb0J1dHRvbkJhc2VDb2xvcixcclxuICAgICAgICBidXR0b25BcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zOiB7XHJcbiAgICAgICAgICBzZWxlY3RlZFN0cm9rZTogRW5lcmd5U2thdGVQYXJrQ29sb3JTY2hlbWUucmFkaW9CdXR0b25TZWxlY3RlZFN0cm9rZVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0sXHJcblxyXG4gICAgICAvLyB7Ym9vbGVhbn0gLSBzaG91bGQgbW91bnRhaW5zLCBiYWNrZ3JvdW5kLCBhbmQgc2t5IGJlIGluY2x1ZGVkIGluIHRoZSBpY29uIGZvciB0cmFjayBidXR0b25zP1xyXG4gICAgICBpbmNsdWRlQmFja2dyb3VuZDogZmFsc2VcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBwcm9kdWNlcyBzcGFjaW5nIG9mIH41IHdoZW4gdGhlcmUgYXJlIDQgcHJlbWFkZSB0cmFja3Mgd2hpY2ggaXMgdGhlIHVzdWFsIGNhc2UgYW5kIGxvb2tzIG5pY2UsIGFuZCBwcm92aWRlc1xyXG4gICAgLy8gbW9yZSBzcGFjaW5nIGlmIHRoZXJlIGFyZSBmZXdlciB0cmFja3NcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG9wdGlvbnMuc3BhY2luZyA9PT0gdW5kZWZpbmVkLCAnU2NlbmVTZWxlY3Rpb25SYWRpb0J1dHRvbkdyb3VwIHNldHMgc3BhY2luZyBmcm9tIG51bWJlciBvZiBwcmVtYWRlIHRyYWNrcycgKTtcclxuICAgIG9wdGlvbnMuc3BhY2luZyA9IDIwIC8gbW9kZWwudHJhY2tzLmxlbmd0aDtcclxuXHJcbiAgICAvLyBDcmVhdGUgYSB0cmFjayB0byBiZSB1c2VkIHNwZWNpZmljYWxseSBmb3IgYW4gaWNvbiAtIG11c3QgYmUgb25lIG9mIHRoZSBwcmVtYWRlIHRyYWNrcyBkZWZpbmVkIGluXHJcbiAgICAvLyBQcmVtYWRlVHJhY2tzLlRyYWNrVHlwZS4gVGhlc2UgVHJhY2tzIGFyZSBhIGJpdCBkaWZmZXJlbnQgZnJvbSB0aGUgYWN0dWFsIHRyYWNrcyB1c2VkIGluIHRoZSBtb2RlbFxyXG4gICAgLy8gYmVjYXVzZSB0aGVpciBzaXppbmcgYW5kIGRpbWVuc2lvbnMgbmVlZCB0byBiZSBkaWZmZXJlbnQgdG8gbG9vayBiZXR0ZXIgYXMgaWNvbnMgZm9yIHJhZGlvIGJ1dHRvbnNcclxuICAgIGNvbnN0IGNyZWF0ZUljb25UcmFjayA9IHRyYWNrVHlwZSA9PiB7XHJcblxyXG4gICAgICAvLyBhbGwgdHJhY2tzIGhhdmUgdGhlIHNhbWUgd2lkdGggYW5kIGhlaWdodCBzbyB0aGV5IHRha2UgdXAgdGhlIHNhbWUgZGltZW5zaW9ucyBpbiBhIHJhZGlvIGJ1dHRvbiwgc28gb25lXHJcbiAgICAgIC8vIGRvZXNuJ3QgZ2V0IHNjYWxlZCBkb3duIG1vcmUgdGhhbiBhbm90aGVyIGFuZCBsb29rIG1vcmUgdGhpblxyXG4gICAgICBjb25zdCBjb250cm9sUG9pbnRPcHRpb25zID0ge1xyXG4gICAgICAgIHRyYWNrV2lkdGg6IDYsXHJcbiAgICAgICAgdHJhY2tIZWlnaHQ6IDZcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGxldCB0cmFjayA9IG51bGw7XHJcbiAgICAgIGlmICggdHJhY2tUeXBlID09PSBQcmVtYWRlVHJhY2tzLlRyYWNrVHlwZS5QQVJBQk9MQSApIHtcclxuICAgICAgICBjb25zdCBwYXJhYm9sYUNvbnRyb2xQb2ludHMgPSBQcmVtYWRlVHJhY2tzLmNyZWF0ZVBhcmFib2xhQ29udHJvbFBvaW50cyggbW9kZWwsIG1lcmdlKCB7XHJcbiAgICAgICAgICB0cmFja01pZEhlaWdodDogMVxyXG4gICAgICAgIH0sIGNvbnRyb2xQb2ludE9wdGlvbnMgKSApO1xyXG4gICAgICAgIHRyYWNrID0gRW5lcmd5U2thdGVQYXJrVHJhY2tTZXRNb2RlbC5jcmVhdGVQcmVtYWRlVHJhY2soIG1vZGVsLCBwYXJhYm9sYUNvbnRyb2xQb2ludHMsIHtcclxuICAgICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3BhcmFib2xhVHJhY2tJY29uJyApXHJcbiAgICAgICAgfSApO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCB0cmFja1R5cGUgPT09IFByZW1hZGVUcmFja3MuVHJhY2tUeXBlLlNMT1BFICkge1xyXG4gICAgICAgIGNvbnN0IHNsb3BlQ29udHJvbFBvaW50cyA9IFByZW1hZGVUcmFja3MuY3JlYXRlU2xvcGVDb250cm9sUG9pbnRzKCBtb2RlbCwgY29udHJvbFBvaW50T3B0aW9ucyApO1xyXG4gICAgICAgIHRyYWNrID0gRW5lcmd5U2thdGVQYXJrVHJhY2tTZXRNb2RlbC5jcmVhdGVQcmVtYWRlVHJhY2soIG1vZGVsLCBzbG9wZUNvbnRyb2xQb2ludHMsIHtcclxuICAgICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3Nsb3BlVHJhY2tJY29uJyApXHJcbiAgICAgICAgfSApO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCB0cmFja1R5cGUgPT09IFByZW1hZGVUcmFja3MuVHJhY2tUeXBlLkRPVUJMRV9XRUxMICkge1xyXG4gICAgICAgIGNvbnN0IGRvdWJsZVdlbGxDb250cm9sUG9pbnRzID0gUHJlbWFkZVRyYWNrcy5jcmVhdGVEb3VibGVXZWxsQ29udHJvbFBvaW50cyggbW9kZWwsIGNvbnRyb2xQb2ludE9wdGlvbnMgKTtcclxuICAgICAgICB0cmFjayA9IEVuZXJneVNrYXRlUGFya1RyYWNrU2V0TW9kZWwuY3JlYXRlUHJlbWFkZVRyYWNrKCBtb2RlbCwgZG91YmxlV2VsbENvbnRyb2xQb2ludHMsIHtcclxuICAgICAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2RvdWJsZVdlbGxUcmFja0ljb24nIClcclxuICAgICAgICB9ICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIHRyYWNrVHlwZSA9PT0gUHJlbWFkZVRyYWNrcy5UcmFja1R5cGUuTE9PUCApIHtcclxuICAgICAgICBjb25zdCBsb29wQ29udHJvbFBvaW50cyA9IFByZW1hZGVUcmFja3MuY3JlYXRlTG9vcENvbnRyb2xQb2ludHMoIG1vZGVsLCBtZXJnZSgge1xyXG4gICAgICAgICAgaW5uZXJMb29wV2lkdGg6IDIuNSxcclxuICAgICAgICAgIGlubmVyTG9vcFRvcDogMy41XHJcbiAgICAgICAgfSwgY29udHJvbFBvaW50T3B0aW9ucyApICk7XHJcbiAgICAgICAgdHJhY2sgPSBFbmVyZ3lTa2F0ZVBhcmtUcmFja1NldE1vZGVsLmNyZWF0ZVByZW1hZGVUcmFjayggbW9kZWwsIGxvb3BDb250cm9sUG9pbnRzLCB7XHJcbiAgICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdsb29wVHJhY2tJY29uJyApXHJcbiAgICAgICAgfSApO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvciggYHVuc3VwcG9ydGVkIFRyYWNrVHlwZTogJHt0cmFja1R5cGV9YCApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gdHJhY2s7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIENyZWF0ZSBhIGJ1dHRvbiB3aXRoIGEgc2NlbmUgbGlrZSB0aGUgdHJhY2sgaW4gdGhlIGluZGV4XHJcbiAgICBjb25zdCBjcmVhdGVOb2RlID0gaW5kZXggPT4ge1xyXG4gICAgICBjb25zdCBjaGlsZHJlbiA9IFtdO1xyXG5cclxuICAgICAgaWYgKCBvcHRpb25zLmluY2x1ZGVCYWNrZ3JvdW5kICkge1xyXG4gICAgICAgIGNvbnN0IGJhY2tncm91bmQgPSBuZXcgQmFja2dyb3VuZE5vZGUoIHZpZXcubGF5b3V0Qm91bmRzLCB0YW5kZW0uY3JlYXRlVGFuZGVtKCBgYmFja2dyb3VuZE5vZGUke2luZGV4fWAgKSApO1xyXG4gICAgICAgIGJhY2tncm91bmQubGF5b3V0KCBuZXcgQm91bmRzMiggMCwgMCwgdmlldy5sYXlvdXRCb3VuZHMud2lkdGgsIHZpZXcubGF5b3V0Qm91bmRzLmhlaWdodCApLCAxICk7XHJcbiAgICAgICAgY2hpbGRyZW4ucHVzaCggYmFja2dyb3VuZCApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB0cmFjayA9IGNyZWF0ZUljb25UcmFjayggbW9kZWwudHJhY2tUeXBlc1sgaW5kZXggXSApO1xyXG4gICAgICBjb25zdCB0cmFja05vZGUgPSBuZXcgVHJhY2tOb2RlKCB0cmFjaywgdmlldy5tb2RlbFZpZXdUcmFuc2Zvcm0sIG5ldyBQcm9wZXJ0eSgpLCB0YW5kZW0uY3JlYXRlVGFuZGVtKCBgdHJhY2tOb2RlJHtpbmRleH1gICksIHtcclxuICAgICAgICBpc0ljb246IHRydWVcclxuICAgICAgfSApO1xyXG5cclxuICAgICAgLy8gdXNlIGEgcmFzdGVyaXplZCB2ZXJzaW9uIG9mIHRoZSBub2RlIHNvIHRoYXQgdGhlIGljb24gZG9lc24ndCBjaGFuZ2Ugd2l0aCB0aGUgbW9kZWwgZm9yIGNvbmZpZ3VyYWJsZSB0cmFja3NcclxuICAgICAgY29uc3QgaWNvbk5vZGUgPSB0cmFja05vZGUucmFzdGVyaXplZCgpO1xyXG4gICAgICBjaGlsZHJlbi5wdXNoKCBpY29uTm9kZSApO1xyXG5cclxuICAgICAgLy8gRml4ZXM6IEN1cnNvciB0dXJucyBpbnRvIGEgaGFuZCBvdmVyIHRoZSB0cmFjayBpbiB0aGUgdHJhY2sgc2VsZWN0aW9uIHBhbmVsLCBzZWUgIzIwNFxyXG4gICAgICBpY29uTm9kZS5waWNrYWJsZSA9IGZhbHNlO1xyXG5cclxuICAgICAgcmV0dXJuIG5ldyBOb2RlKCB7XHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCBgY29udGVudE5vZGUke2luZGV4fWAgKSxcclxuICAgICAgICBjaGlsZHJlbjogY2hpbGRyZW5cclxuICAgICAgfSApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBjcmVhdGUgdGhlIGNvbnRlbnRzIGZvciB0aGUgcmFkaW8gYnV0dG9uc1xyXG4gICAgY29uc3QgY29udGVudHMgPSBbXTtcclxuICAgIF8uZm9yRWFjaCggbW9kZWwudHJhY2tzLCAoIHRyYWNrLCBpICkgPT4ge1xyXG4gICAgICBjb25zdCBjb250ZW50Tm9kZSA9IGNyZWF0ZU5vZGUoIGkgKTtcclxuICAgICAgY29udGVudHMucHVzaCggY29udGVudE5vZGUgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBtaW5XaWR0aCA9IF8ubWluQnkoIGNvbnRlbnRzLCBub2RlID0+IG5vZGUud2lkdGggKS53aWR0aDtcclxuXHJcbiAgICBjb25zdCBidXR0b25BbGlnbkdyb3VwID0gbmV3IEFsaWduR3JvdXAoKTtcclxuXHJcbiAgICBjb25zdCByYWRpb0J1dHRvbkNvbnRlbnQgPSBbXTtcclxuICAgIF8uZm9yRWFjaCggY29udGVudHMsICggbm9kZSwgaSApID0+IHtcclxuXHJcbiAgICAgIC8vIHNjYWxhciBjaG9zZW4gc28gdGhhdCBidXR0b25zIGFyZSBhcHByb3ByaWF0ZWx5IHNpemVkIGluIHRoZSBjb250cm9sIHBhbmVsXHJcbiAgICAgIGNvbnN0IGNvbnRlbnRTY2FsZSA9ICggMjcgLyBtaW5XaWR0aCApO1xyXG5cclxuICAgICAgLy8gaWYgdGhlcmUgaXNuJ3QgYSBiYWNrZ3JvdW5kLCBzY2FsZSB0aGUgdHJhY2tzIHNvIHRoYXQgdGhleSBhcmUgYWxsIHRoZSBzYW1lIHdpZHRoXHJcbiAgICAgIGlmICggIW9wdGlvbnMuaW5jbHVkZUJhY2tncm91bmQgKSB7XHJcbiAgICAgICAgbm9kZS5zZXRTY2FsZU1hZ25pdHVkZSggY29udGVudFNjYWxlICogKCBtaW5XaWR0aCAvIG5vZGUud2lkdGggKSApO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIG5vZGUuc2NhbGUoIGNvbnRlbnRTY2FsZSApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBwbGFjZSBpbiBhbiBhbGlnbiBncm91cCBhbmQgYWRkIG1hcmdpbnMgc28gdGhhdCB0aGUgYnV0dG9ucyBhcmUgYWx3YXlzIHNxdWFyZVxyXG4gICAgICBjb25zdCBhbGlnbmVkTm9kZSA9IGJ1dHRvbkFsaWduR3JvdXAuY3JlYXRlQm94KCBub2RlICk7XHJcbiAgICAgIGNvbnN0IG1hcmdpbiA9IE1hdGguYWJzKCBhbGlnbmVkTm9kZS53aWR0aCAtIGFsaWduZWROb2RlLmhlaWdodCApIC8gMjtcclxuICAgICAgaWYgKCBtYXJnaW4gIT09IDAgKSB7XHJcbiAgICAgICAgY29uc3Qgc2V0dGVyRnVuY3Rpb24gPSBhbGlnbmVkTm9kZS5oZWlnaHQgPCBhbGlnbmVkTm9kZS53aWR0aCA/IGFsaWduZWROb2RlLnNldFlNYXJnaW4gOiBhbGlnbmVkTm9kZS5zZXRYTWFyZ2luO1xyXG4gICAgICAgIHNldHRlckZ1bmN0aW9uLmNhbGwoIGFsaWduZWROb2RlLCBtYXJnaW4gKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmFkaW9CdXR0b25Db250ZW50LnB1c2goIHtcclxuICAgICAgICB2YWx1ZTogaSxcclxuICAgICAgICBjcmVhdGVOb2RlOiAoKSA9PiBhbGlnbmVkTm9kZSxcclxuICAgICAgICB0YW5kZW1OYW1lOiBgc2NlbmUke2kgKyAxfVJhZGlvQnV0dG9uYFxyXG4gICAgICB9ICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgc3VwZXIoIG1vZGVsLnNjZW5lUHJvcGVydHksIHJhZGlvQnV0dG9uQ29udGVudCwgb3B0aW9ucyApO1xyXG4gIH1cclxufVxyXG5cclxuZW5lcmd5U2thdGVQYXJrLnJlZ2lzdGVyKCAnU2NlbmVTZWxlY3Rpb25SYWRpb0J1dHRvbkdyb3VwJywgU2NlbmVTZWxlY3Rpb25SYWRpb0J1dHRvbkdyb3VwICk7XHJcbmV4cG9ydCBkZWZhdWx0IFNjZW5lU2VsZWN0aW9uUmFkaW9CdXR0b25Hcm91cDsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFFBQVEsTUFBTSxpQ0FBaUM7QUFDdEQsT0FBT0MsT0FBTyxNQUFNLCtCQUErQjtBQUNuRCxPQUFPQyxLQUFLLE1BQU0sbUNBQW1DO0FBQ3JELFNBQVNDLFVBQVUsRUFBRUMsSUFBSSxRQUFRLG1DQUFtQztBQUNwRSxPQUFPQywyQkFBMkIsTUFBTSwyREFBMkQ7QUFDbkcsT0FBT0MsZUFBZSxNQUFNLDBCQUEwQjtBQUN0RCxPQUFPQyx3QkFBd0IsTUFBTSxnQ0FBZ0M7QUFDckUsT0FBT0MsNEJBQTRCLE1BQU0sMENBQTBDO0FBQ25GLE9BQU9DLGFBQWEsTUFBTSwyQkFBMkI7QUFDckQsT0FBT0MsY0FBYyxNQUFNLHFCQUFxQjtBQUNoRCxPQUFPQywwQkFBMEIsTUFBTSxpQ0FBaUM7QUFDeEUsT0FBT0MsU0FBUyxNQUFNLGdCQUFnQjtBQUV0QyxNQUFNQyw4QkFBOEIsU0FBU1IsMkJBQTJCLENBQUM7RUFFdkU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNFUyxXQUFXQSxDQUFFQyxLQUFLLEVBQUVDLElBQUksRUFBRUMsTUFBTSxFQUFFQyxPQUFPLEVBQUc7SUFDMUNDLE1BQU0sSUFBSUEsTUFBTSxDQUFFSixLQUFLLENBQUNLLGFBQWEsS0FBS0MsU0FBUyxFQUFFLGdDQUFpQyxDQUFDO0lBRXZGSCxPQUFPLEdBQUdoQixLQUFLLENBQUU7TUFFZjtNQUNBb0IsV0FBVyxFQUFFLFlBQVk7TUFDekJDLGtCQUFrQixFQUFFO1FBQ2xCQyxPQUFPLEVBQUVqQix3QkFBd0IsQ0FBQ2tCLDJCQUEyQjtRQUM3REMsT0FBTyxFQUFFbkIsd0JBQXdCLENBQUNrQiwyQkFBMkI7UUFDN0RFLFlBQVksRUFBRXBCLHdCQUF3QixDQUFDcUIsMEJBQTBCO1FBQ2pF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