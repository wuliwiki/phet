// Copyright 2022, University of Colorado Boulder

/**
 * IrWavesSoundGenerator is used to produce sounds that represent the actions of the infrared waves as they interact
 * with the atmosphere.
 *
 * @author John Blanco (PhET Interactive Simulations)
 */

import optionize from '../../../../phet-core/js/optionize.js';
import SoundClip from '../../../../tambo/js/sound-generators/SoundClip.js';
import SoundGenerator from '../../../../tambo/js/sound-generators/SoundGenerator.js';
import greenhouseEffectWavesIrReemissionLoop_mp3 from '../../../sounds/greenhouseEffectWavesIrReemissionLoop_mp3.js';
import greenhouseEffectWavesIrReemissionStartingSound_mp3 from '../../../sounds/greenhouseEffectWavesIrReemissionStartingSound_mp3.js';
import greenhouseEffect from '../../greenhouseEffect.js';
// constants
const MAX_IR_WAVES_FROM_ATMOSPHERE = 3;
const WAVE_LOOP_MAX_OUTPUT_LEVEL = 0.04;
const NEW_WAVE_EMITTED_OUTPUT_LEVEL = 0.02;

// types for options

class IrWavesSoundGenerator extends SoundGenerator {
  constructor(wavesModel, wavesView, providedOptions) {
    const options = optionize()({}, providedOptions);
    super(options);

    // Create a sound generator for each of the IR waves that can originate from the atmosphere.
    const irWaveRadiatingFromAtmosphereSoundGenerators = [];
    _.times(MAX_IR_WAVES_FROM_ATMOSPHERE, () => {
      const soundGenerator = new SoundClip(greenhouseEffectWavesIrReemissionLoop_mp3, {
        initialOutputLevel: WAVE_LOOP_MAX_OUTPUT_LEVEL,
        loop: true,
        enableControlProperties: [wavesModel.isPlayingProperty]
      });
      soundGenerator.connect(this.masterGainNode);
      irWaveRadiatingFromAtmosphereSoundGenerators.push(soundGenerator);
    });

    // Create the sound clip that will be played when a new IR wave starts to emanate from the atmosphere.
    const irWaveEmittedFromAtmosphereSoundGenerator = new SoundClip(greenhouseEffectWavesIrReemissionStartingSound_mp3, {
      initialOutputLevel: NEW_WAVE_EMITTED_OUTPUT_LEVEL
    });
    irWaveEmittedFromAtmosphereSoundGenerator.connect(this.masterGainNode);

    // Play the sounds related to IR interactions with the atmosphere.
    const irWaveChangeListener = (numberOfInteractions, previousNumberOfInteractions) => {
      // Play a one-shot sound each time a new interaction starts.
      if (numberOfInteractions > previousNumberOfInteractions) {
        irWaveEmittedFromAtmosphereSoundGenerator.play();
      }

      // Make sure that the number of sound generators playing is equal to the number of waves coming from the atmosphere.
      irWaveRadiatingFromAtmosphereSoundGenerators.forEach((soundGenerator, index) => {
        if (!soundGenerator.isPlaying && numberOfInteractions > index) {
          soundGenerator.play();
        } else if (soundGenerator.isPlaying && numberOfInteractions <= index) {
          soundGenerator.stop();
        }
      });
    };
    wavesModel.waveAtmosphereInteractions.lengthProperty.lazyLink(irWaveChangeListener);

    // A function that is intended to be called during stepping to update the output levels of the loops to match the
    // intensities of the waves to which they correspond.
    this.updateSoundLoopLevels = () => {
      let wavesFromAtmosphereOutputLevel = WAVE_LOOP_MAX_OUTPUT_LEVEL;
      wavesModel.waveGroup.forEach(wave => {
        // Only provide sound for the IR waves that are moving down.  This is done to draw more attention to these
        // waves, since understanding that IR comes back from the atmosphere is a big learning goal.
        if (wave.isInfrared && wave.propagationDirection.y < 0) {
          wavesFromAtmosphereOutputLevel = WAVE_LOOP_MAX_OUTPUT_LEVEL * wave.intensityAtStart;
        }
      });
      irWaveRadiatingFromAtmosphereSoundGenerators.forEach(soundGenerator => {
        if (soundGenerator.isPlaying && soundGenerator.getOutputLevel() !== wavesFromAtmosphereOutputLevel) {
          soundGenerator.setOutputLevel(wavesFromAtmosphereOutputLevel);
        }
      });
    };
    this.disposeIrWavesSoundGenerator = () => {
      wavesModel.waveAtmosphereInteractions.lengthProperty.unlink(irWaveChangeListener);
    };
  }

  /**
   * Step forward in time by the provided amount.
   * @param dt - delta time, in seconds
   */
  step(dt) {
    this.updateSoundLoopLevels();
  }
  dispose() {
    this.disposeIrWavesSoundGenerator();
    super.dispose();
  }
}
greenhouseEffect.register('IrWavesSoundGenerator', IrWavesSoundGenerator);
export default IrWavesSoundGenerator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25pemUiLCJTb3VuZENsaXAiLCJTb3VuZEdlbmVyYXRvciIsImdyZWVuaG91c2VFZmZlY3RXYXZlc0lyUmVlbWlzc2lvbkxvb3BfbXAzIiwiZ3JlZW5ob3VzZUVmZmVjdFdhdmVzSXJSZWVtaXNzaW9uU3RhcnRpbmdTb3VuZF9tcDMiLCJncmVlbmhvdXNlRWZmZWN0IiwiTUFYX0lSX1dBVkVTX0ZST01fQVRNT1NQSEVSRSIsIldBVkVfTE9PUF9NQVhfT1VUUFVUX0xFVkVMIiwiTkVXX1dBVkVfRU1JVFRFRF9PVVRQVVRfTEVWRUwiLCJJcldhdmVzU291bmRHZW5lcmF0b3IiLCJjb25zdHJ1Y3RvciIsIndhdmVzTW9kZWwiLCJ3YXZlc1ZpZXciLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwiaXJXYXZlUmFkaWF0aW5nRnJvbUF0bW9zcGhlcmVTb3VuZEdlbmVyYXRvcnMiLCJfIiwidGltZXMiLCJzb3VuZEdlbmVyYXRvciIsImluaXRpYWxPdXRwdXRMZXZlbCIsImxvb3AiLCJlbmFibGVDb250cm9sUHJvcGVydGllcyIsImlzUGxheWluZ1Byb3BlcnR5IiwiY29ubmVjdCIsIm1hc3RlckdhaW5Ob2RlIiwicHVzaCIsImlyV2F2ZUVtaXR0ZWRGcm9tQXRtb3NwaGVyZVNvdW5kR2VuZXJhdG9yIiwiaXJXYXZlQ2hhbmdlTGlzdGVuZXIiLCJudW1iZXJPZkludGVyYWN0aW9ucyIsInByZXZpb3VzTnVtYmVyT2ZJbnRlcmFjdGlvbnMiLCJwbGF5IiwiZm9yRWFjaCIsImluZGV4IiwiaXNQbGF5aW5nIiwic3RvcCIsIndhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25zIiwibGVuZ3RoUHJvcGVydHkiLCJsYXp5TGluayIsInVwZGF0ZVNvdW5kTG9vcExldmVscyIsIndhdmVzRnJvbUF0bW9zcGhlcmVPdXRwdXRMZXZlbCIsIndhdmVHcm91cCIsIndhdmUiLCJpc0luZnJhcmVkIiwicHJvcGFnYXRpb25EaXJlY3Rpb24iLCJ5IiwiaW50ZW5zaXR5QXRTdGFydCIsImdldE91dHB1dExldmVsIiwic2V0T3V0cHV0TGV2ZWwiLCJkaXNwb3NlSXJXYXZlc1NvdW5kR2VuZXJhdG9yIiwidW5saW5rIiwic3RlcCIsImR0IiwiZGlzcG9zZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiSXJXYXZlc1NvdW5kR2VuZXJhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBJcldhdmVzU291bmRHZW5lcmF0b3IgaXMgdXNlZCB0byBwcm9kdWNlIHNvdW5kcyB0aGF0IHJlcHJlc2VudCB0aGUgYWN0aW9ucyBvZiB0aGUgaW5mcmFyZWQgd2F2ZXMgYXMgdGhleSBpbnRlcmFjdFxyXG4gKiB3aXRoIHRoZSBhdG1vc3BoZXJlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgU291bmRDbGlwLCB7IFNvdW5kQ2xpcE9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi90YW1iby9qcy9zb3VuZC1nZW5lcmF0b3JzL1NvdW5kQ2xpcC5qcyc7XHJcbmltcG9ydCBTb3VuZEdlbmVyYXRvciwgeyBTb3VuZEdlbmVyYXRvck9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi90YW1iby9qcy9zb3VuZC1nZW5lcmF0b3JzL1NvdW5kR2VuZXJhdG9yLmpzJztcclxuaW1wb3J0IGdyZWVuaG91c2VFZmZlY3RXYXZlc0lyUmVlbWlzc2lvbkxvb3BfbXAzIGZyb20gJy4uLy4uLy4uL3NvdW5kcy9ncmVlbmhvdXNlRWZmZWN0V2F2ZXNJclJlZW1pc3Npb25Mb29wX21wMy5qcyc7XHJcbmltcG9ydCBncmVlbmhvdXNlRWZmZWN0V2F2ZXNJclJlZW1pc3Npb25TdGFydGluZ1NvdW5kX21wMyBmcm9tICcuLi8uLi8uLi9zb3VuZHMvZ3JlZW5ob3VzZUVmZmVjdFdhdmVzSXJSZWVtaXNzaW9uU3RhcnRpbmdTb3VuZF9tcDMuanMnO1xyXG5pbXBvcnQgZ3JlZW5ob3VzZUVmZmVjdCBmcm9tICcuLi8uLi9ncmVlbmhvdXNlRWZmZWN0LmpzJztcclxuaW1wb3J0IFdhdmVzTW9kZWwgZnJvbSAnLi4vbW9kZWwvV2F2ZXNNb2RlbC5qcyc7XHJcbmltcG9ydCBXYXZlc1NjcmVlblZpZXcgZnJvbSAnLi9XYXZlc1NjcmVlblZpZXcuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IE1BWF9JUl9XQVZFU19GUk9NX0FUTU9TUEhFUkUgPSAzO1xyXG5jb25zdCBXQVZFX0xPT1BfTUFYX09VVFBVVF9MRVZFTCA9IDAuMDQ7XHJcbmNvbnN0IE5FV19XQVZFX0VNSVRURURfT1VUUFVUX0xFVkVMID0gMC4wMjtcclxuXHJcbi8vIHR5cGVzIGZvciBvcHRpb25zXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBFbXB0eVNlbGZPcHRpb25zO1xyXG50eXBlIElyV2F2ZXNTb3VuZEdlbmVyYXRvck9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFNvdW5kR2VuZXJhdG9yT3B0aW9ucztcclxuXHJcbmNsYXNzIElyV2F2ZXNTb3VuZEdlbmVyYXRvciBleHRlbmRzIFNvdW5kR2VuZXJhdG9yIHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlSXJXYXZlc1NvdW5kR2VuZXJhdG9yOiAoKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgdXBkYXRlU291bmRMb29wTGV2ZWxzOiAoKSA9PiB2b2lkO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHdhdmVzTW9kZWw6IFdhdmVzTW9kZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICB3YXZlc1ZpZXc6IFdhdmVzU2NyZWVuVmlldyxcclxuICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVkT3B0aW9ucz86IElyV2F2ZXNTb3VuZEdlbmVyYXRvck9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxJcldhdmVzU291bmRHZW5lcmF0b3JPcHRpb25zLCBTZWxmT3B0aW9ucywgU291bmRDbGlwT3B0aW9ucz4oKSgge30sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGEgc291bmQgZ2VuZXJhdG9yIGZvciBlYWNoIG9mIHRoZSBJUiB3YXZlcyB0aGF0IGNhbiBvcmlnaW5hdGUgZnJvbSB0aGUgYXRtb3NwaGVyZS5cclxuICAgIGNvbnN0IGlyV2F2ZVJhZGlhdGluZ0Zyb21BdG1vc3BoZXJlU291bmRHZW5lcmF0b3JzOiBTb3VuZENsaXBbXSA9IFtdO1xyXG4gICAgXy50aW1lcyggTUFYX0lSX1dBVkVTX0ZST01fQVRNT1NQSEVSRSwgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzb3VuZEdlbmVyYXRvciA9IG5ldyBTb3VuZENsaXAoIGdyZWVuaG91c2VFZmZlY3RXYXZlc0lyUmVlbWlzc2lvbkxvb3BfbXAzLCB7XHJcbiAgICAgICAgaW5pdGlhbE91dHB1dExldmVsOiBXQVZFX0xPT1BfTUFYX09VVFBVVF9MRVZFTCxcclxuICAgICAgICBsb29wOiB0cnVlLFxyXG4gICAgICAgIGVuYWJsZUNvbnRyb2xQcm9wZXJ0aWVzOiBbXHJcbiAgICAgICAgICB3YXZlc01vZGVsLmlzUGxheWluZ1Byb3BlcnR5XHJcbiAgICAgICAgXVxyXG4gICAgICB9ICk7XHJcbiAgICAgIHNvdW5kR2VuZXJhdG9yLmNvbm5lY3QoIHRoaXMubWFzdGVyR2Fpbk5vZGUgKTtcclxuICAgICAgaXJXYXZlUmFkaWF0aW5nRnJvbUF0bW9zcGhlcmVTb3VuZEdlbmVyYXRvcnMucHVzaCggc291bmRHZW5lcmF0b3IgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIHNvdW5kIGNsaXAgdGhhdCB3aWxsIGJlIHBsYXllZCB3aGVuIGEgbmV3IElSIHdhdmUgc3RhcnRzIHRvIGVtYW5hdGUgZnJvbSB0aGUgYXRtb3NwaGVyZS5cclxuICAgIGNvbnN0IGlyV2F2ZUVtaXR0ZWRGcm9tQXRtb3NwaGVyZVNvdW5kR2VuZXJhdG9yID0gbmV3IFNvdW5kQ2xpcCggZ3JlZW5ob3VzZUVmZmVjdFdhdmVzSXJSZWVtaXNzaW9uU3RhcnRpbmdTb3VuZF9tcDMsIHtcclxuICAgICAgaW5pdGlhbE91dHB1dExldmVsOiBORVdfV0FWRV9FTUlUVEVEX09VVFBVVF9MRVZFTFxyXG4gICAgfSApO1xyXG4gICAgaXJXYXZlRW1pdHRlZEZyb21BdG1vc3BoZXJlU291bmRHZW5lcmF0b3IuY29ubmVjdCggdGhpcy5tYXN0ZXJHYWluTm9kZSApO1xyXG5cclxuICAgIC8vIFBsYXkgdGhlIHNvdW5kcyByZWxhdGVkIHRvIElSIGludGVyYWN0aW9ucyB3aXRoIHRoZSBhdG1vc3BoZXJlLlxyXG4gICAgY29uc3QgaXJXYXZlQ2hhbmdlTGlzdGVuZXIgPSAoIG51bWJlck9mSW50ZXJhY3Rpb25zOiBudW1iZXIsIHByZXZpb3VzTnVtYmVyT2ZJbnRlcmFjdGlvbnM6IG51bWJlciApID0+IHtcclxuXHJcbiAgICAgIC8vIFBsYXkgYSBvbmUtc2hvdCBzb3VuZCBlYWNoIHRpbWUgYSBuZXcgaW50ZXJhY3Rpb24gc3RhcnRzLlxyXG4gICAgICBpZiAoIG51bWJlck9mSW50ZXJhY3Rpb25zID4gcHJldmlvdXNOdW1iZXJPZkludGVyYWN0aW9ucyApIHtcclxuICAgICAgICBpcldhdmVFbWl0dGVkRnJvbUF0bW9zcGhlcmVTb3VuZEdlbmVyYXRvci5wbGF5KCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBudW1iZXIgb2Ygc291bmQgZ2VuZXJhdG9ycyBwbGF5aW5nIGlzIGVxdWFsIHRvIHRoZSBudW1iZXIgb2Ygd2F2ZXMgY29taW5nIGZyb20gdGhlIGF0bW9zcGhlcmUuXHJcbiAgICAgIGlyV2F2ZVJhZGlhdGluZ0Zyb21BdG1vc3BoZXJlU291bmRHZW5lcmF0b3JzLmZvckVhY2goICggc291bmRHZW5lcmF0b3IsIGluZGV4ICkgPT4ge1xyXG4gICAgICAgIGlmICggIXNvdW5kR2VuZXJhdG9yLmlzUGxheWluZyAmJiBudW1iZXJPZkludGVyYWN0aW9ucyA+IGluZGV4ICkge1xyXG4gICAgICAgICAgc291bmRHZW5lcmF0b3IucGxheSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICggc291bmRHZW5lcmF0b3IuaXNQbGF5aW5nICYmIG51bWJlck9mSW50ZXJhY3Rpb25zIDw9IGluZGV4ICkge1xyXG4gICAgICAgICAgc291bmRHZW5lcmF0b3Iuc3RvcCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG4gICAgfTtcclxuXHJcbiAgICB3YXZlc01vZGVsLndhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25zLmxlbmd0aFByb3BlcnR5LmxhenlMaW5rKCBpcldhdmVDaGFuZ2VMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIEEgZnVuY3Rpb24gdGhhdCBpcyBpbnRlbmRlZCB0byBiZSBjYWxsZWQgZHVyaW5nIHN0ZXBwaW5nIHRvIHVwZGF0ZSB0aGUgb3V0cHV0IGxldmVscyBvZiB0aGUgbG9vcHMgdG8gbWF0Y2ggdGhlXHJcbiAgICAvLyBpbnRlbnNpdGllcyBvZiB0aGUgd2F2ZXMgdG8gd2hpY2ggdGhleSBjb3JyZXNwb25kLlxyXG4gICAgdGhpcy51cGRhdGVTb3VuZExvb3BMZXZlbHMgPSAoKSA9PiB7XHJcbiAgICAgIGxldCB3YXZlc0Zyb21BdG1vc3BoZXJlT3V0cHV0TGV2ZWwgPSBXQVZFX0xPT1BfTUFYX09VVFBVVF9MRVZFTDtcclxuXHJcbiAgICAgIHdhdmVzTW9kZWwud2F2ZUdyb3VwLmZvckVhY2goIHdhdmUgPT4ge1xyXG5cclxuICAgICAgICAvLyBPbmx5IHByb3ZpZGUgc291bmQgZm9yIHRoZSBJUiB3YXZlcyB0aGF0IGFyZSBtb3ZpbmcgZG93bi4gIFRoaXMgaXMgZG9uZSB0byBkcmF3IG1vcmUgYXR0ZW50aW9uIHRvIHRoZXNlXHJcbiAgICAgICAgLy8gd2F2ZXMsIHNpbmNlIHVuZGVyc3RhbmRpbmcgdGhhdCBJUiBjb21lcyBiYWNrIGZyb20gdGhlIGF0bW9zcGhlcmUgaXMgYSBiaWcgbGVhcm5pbmcgZ29hbC5cclxuICAgICAgICBpZiAoIHdhdmUuaXNJbmZyYXJlZCAmJiB3YXZlLnByb3BhZ2F0aW9uRGlyZWN0aW9uLnkgPCAwICkge1xyXG4gICAgICAgICAgd2F2ZXNGcm9tQXRtb3NwaGVyZU91dHB1dExldmVsID0gV0FWRV9MT09QX01BWF9PVVRQVVRfTEVWRUwgKiB3YXZlLmludGVuc2l0eUF0U3RhcnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICBpcldhdmVSYWRpYXRpbmdGcm9tQXRtb3NwaGVyZVNvdW5kR2VuZXJhdG9ycy5mb3JFYWNoKCBzb3VuZEdlbmVyYXRvciA9PiB7XHJcbiAgICAgICAgaWYgKCBzb3VuZEdlbmVyYXRvci5pc1BsYXlpbmcgJiYgc291bmRHZW5lcmF0b3IuZ2V0T3V0cHV0TGV2ZWwoKSAhPT0gd2F2ZXNGcm9tQXRtb3NwaGVyZU91dHB1dExldmVsICkge1xyXG4gICAgICAgICAgc291bmRHZW5lcmF0b3Iuc2V0T3V0cHV0TGV2ZWwoIHdhdmVzRnJvbUF0bW9zcGhlcmVPdXRwdXRMZXZlbCApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSApO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VJcldhdmVzU291bmRHZW5lcmF0b3IgPSAoKSA9PiB7XHJcbiAgICAgIHdhdmVzTW9kZWwud2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbnMubGVuZ3RoUHJvcGVydHkudW5saW5rKCBpcldhdmVDaGFuZ2VMaXN0ZW5lciApO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0ZXAgZm9yd2FyZCBpbiB0aW1lIGJ5IHRoZSBwcm92aWRlZCBhbW91bnQuXHJcbiAgICogQHBhcmFtIGR0IC0gZGVsdGEgdGltZSwgaW4gc2Vjb25kc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGVwKCBkdDogbnVtYmVyICk6IHZvaWQge1xyXG4gICAgdGhpcy51cGRhdGVTb3VuZExvb3BMZXZlbHMoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5kaXNwb3NlSXJXYXZlc1NvdW5kR2VuZXJhdG9yKCk7XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5ncmVlbmhvdXNlRWZmZWN0LnJlZ2lzdGVyKCAnSXJXYXZlc1NvdW5kR2VuZXJhdG9yJywgSXJXYXZlc1NvdW5kR2VuZXJhdG9yICk7XHJcbmV4cG9ydCBkZWZhdWx0IElyV2F2ZXNTb3VuZEdlbmVyYXRvcjsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxTQUFTLE1BQTRCLHVDQUF1QztBQUNuRixPQUFPQyxTQUFTLE1BQTRCLG9EQUFvRDtBQUNoRyxPQUFPQyxjQUFjLE1BQWlDLHlEQUF5RDtBQUMvRyxPQUFPQyx5Q0FBeUMsTUFBTSw4REFBOEQ7QUFDcEgsT0FBT0Msa0RBQWtELE1BQU0sdUVBQXVFO0FBQ3RJLE9BQU9DLGdCQUFnQixNQUFNLDJCQUEyQjtBQUl4RDtBQUNBLE1BQU1DLDRCQUE0QixHQUFHLENBQUM7QUFDdEMsTUFBTUMsMEJBQTBCLEdBQUcsSUFBSTtBQUN2QyxNQUFNQyw2QkFBNkIsR0FBRyxJQUFJOztBQUUxQzs7QUFJQSxNQUFNQyxxQkFBcUIsU0FBU1AsY0FBYyxDQUFDO0VBSzFDUSxXQUFXQSxDQUFFQyxVQUFzQixFQUN0QkMsU0FBMEIsRUFDMUJDLGVBQThDLEVBQUc7SUFFbkUsTUFBTUMsT0FBTyxHQUFHZCxTQUFTLENBQThELENBQUMsQ0FBRSxDQUFDLENBQUMsRUFBRWEsZUFBZ0IsQ0FBQztJQUUvRyxLQUFLLENBQUVDLE9BQVEsQ0FBQzs7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