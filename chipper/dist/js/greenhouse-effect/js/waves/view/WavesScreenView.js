// Copyright 2020-2023, University of Colorado Boulder

/**
 * Main view class for the Waves screen.
 *
 * @author John Blanco (PhET Interactive Simulations)
 * @author Sam Reid (PhET Interactive Simulations)
 */

import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import { VBox } from '../../../../scenery/js/imports.js';
import soundManager from '../../../../tambo/js/soundManager.js';
import GreenhouseEffectConstants from '../../common/GreenhouseEffectConstants.js';
import { ConcentrationControlMode } from '../../common/model/ConcentrationModel.js';
import ConcentrationControlPanel from '../../common/view/ConcentrationControlPanel.js';
import RadiationDescriber from '../../common/view/describers/RadiationDescriber.js';
import EnergyLegend from '../../common/view/EnergyLegend.js';
import GreenhouseEffectScreenView from '../../common/view/GreenhouseEffectScreenView.js';
import LayersModelTimeControlNode from '../../common/view/LayersModelTimeControlNode.js';
import SurfaceThermometerCheckbox from '../../common/view/SurfaceThermometerCheckbox.js';
import greenhouseEffect from '../../greenhouseEffect.js';
import GreenhouseEffectStrings from '../../GreenhouseEffectStrings.js';
import CloudCheckbox from './CloudCheckbox.js';
import IrWavesSoundGenerator from './IrWavesSoundGenerator.js';
import SurfaceTemperatureCheckbox from './SurfaceTemperatureCheckbox.js';
import WaveLandscapeObservationWindow from './WaveLandscapeObservationWindow.js';
import WavesScreenSummaryContentNode from './WavesScreenSummaryContentNode.js';
class WavesScreenView extends GreenhouseEffectScreenView {
  constructor(model, tandem) {
    // Create the observation window that will depict the ground, sky, light waves, etc.
    const observationWindow = new WaveLandscapeObservationWindow(model, {
      // phet-io
      tandem: tandem.createTandem('observationWindow')
    });
    const timeControlNode = new LayersModelTimeControlNode(model, {
      // Requested in https://github.com/phetsims/greenhouse-effect/issues/158 that the TimeControlNode
      // for this screen does not have speed radio buttons or a step forward button
      timeSpeedProperty: null,
      playPauseStepButtonOptions: {
        includeStepForwardButton: false,
        // unique description about the observation window since there are no speed or step buttons in this case
        playingDescription: GreenhouseEffectStrings.a11y.timeControls.playPauseButtonPlayingDescriptionStringProperty,
        pausedDescription: GreenhouseEffectStrings.a11y.timeControls.playPauseButtonPausedDescriptionStringProperty
      },
      tandem: tandem.createTandem('timeControlNode')
    });
    super(model, observationWindow, timeControlNode, {
      energyLegendOptions: {
        energyRepresentation: EnergyLegend.EnergyRepresentation.WAVE
      },
      // phet-io
      tandem: tandem,
      // pdom
      screenSummaryContent: new WavesScreenSummaryContentNode(model)
    });
    const surfaceThermometerCheckbox = new SurfaceThermometerCheckbox(model.surfaceThermometerVisibleProperty, model.surfaceTemperatureKelvinProperty, model.temperatureUnitsProperty, tandem.createTandem('surfaceThermometerCheckbox'));
    const surfaceTemperatureCheckbox = new SurfaceTemperatureCheckbox(model.surfaceTemperatureVisibleProperty, model, tandem.createTandem('surfaceTemperatureCheckbox'));

    // Create the cloud-control checkbox.  This is only shown in manually-controlled-concentration mode.
    const cloudCheckbox = new CloudCheckbox(model.cloudEnabledProperty, model.sunEnergySource.isShiningProperty, {
      visibleProperty: new DerivedProperty([model.concentrationControlModeProperty], mode => mode === ConcentrationControlMode.BY_VALUE),
      tandem: tandem.createTandem('cloudCheckbox')
    });

    // Responsible for generating descriptions about the changing radiation.
    const radiationDescriber = new RadiationDescriber(model);
    const concentrationControls = new ConcentrationControlPanel(this.energyLegend.width, model, radiationDescriber, {
      // phet-io
      tandem: tandem.createTandem('concentrationControlPanel')
    });

    // Add the concentration controls.  It goes into a VBox to support dynamic layout.
    this.legendAndControlsVBox.addChild(concentrationControls);

    // cloud checkbox
    cloudCheckbox.leftBottom = this.observationWindow.rightBottom.plusXY(GreenhouseEffectConstants.OBSERVATION_WINDOW_RIGHT_SPACING, 0);
    this.addChild(cloudCheckbox);

    // layout code
    const visibilityBox = new VBox({
      children: [surfaceThermometerCheckbox, surfaceTemperatureCheckbox],
      spacing: 5,
      align: 'left'
    });
    visibilityBox.left = this.observationWindow.left + 5;
    visibilityBox.centerY = this.timeControlNode.centerY;
    concentrationControls.leftTop = this.energyLegend.leftBottom.plusXY(0, GreenhouseEffectConstants.SCREEN_VIEW_Y_MARGIN);
    this.addChild(visibilityBox);

    // sound generation
    const irWavesSoundGenerator = new IrWavesSoundGenerator(model, this);
    soundManager.addSoundGenerator(irWavesSoundGenerator, {
      associatedViewNode: this
    });

    // Update this sound generator when the model is stepped.  No need to unlink since this view is never disposed.
    model.steppedEmitter.addListener(irWavesSoundGenerator.step.bind(irWavesSoundGenerator));

    // pdom - override the pdomOrders for the supertype to insert subtype components
    this.pdomPlayAreaNode.pdomOrder = [this.observationWindow, this.energyLegend, concentrationControls, observationWindow.surfaceThermometer, observationWindow.instrumentVisibilityControls, cloudCheckbox];
    this.pdomControlAreaNode.pdomOrder = [visibilityBox, this.timeControlNode, this.resetAllButton];
  }
  reset() {
    super.reset();
  }
}
greenhouseEffect.register('WavesScreenView', WavesScreenView);
export default WavesScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJWQm94Iiwic291bmRNYW5hZ2VyIiwiR3JlZW5ob3VzZUVmZmVjdENvbnN0YW50cyIsIkNvbmNlbnRyYXRpb25Db250cm9sTW9kZSIsIkNvbmNlbnRyYXRpb25Db250cm9sUGFuZWwiLCJSYWRpYXRpb25EZXNjcmliZXIiLCJFbmVyZ3lMZWdlbmQiLCJHcmVlbmhvdXNlRWZmZWN0U2NyZWVuVmlldyIsIkxheWVyc01vZGVsVGltZUNvbnRyb2xOb2RlIiwiU3VyZmFjZVRoZXJtb21ldGVyQ2hlY2tib3giLCJncmVlbmhvdXNlRWZmZWN0IiwiR3JlZW5ob3VzZUVmZmVjdFN0cmluZ3MiLCJDbG91ZENoZWNrYm94IiwiSXJXYXZlc1NvdW5kR2VuZXJhdG9yIiwiU3VyZmFjZVRlbXBlcmF0dXJlQ2hlY2tib3giLCJXYXZlTGFuZHNjYXBlT2JzZXJ2YXRpb25XaW5kb3ciLCJXYXZlc1NjcmVlblN1bW1hcnlDb250ZW50Tm9kZSIsIldhdmVzU2NyZWVuVmlldyIsImNvbnN0cnVjdG9yIiwibW9kZWwiLCJ0YW5kZW0iLCJvYnNlcnZhdGlvbldpbmRvdyIsImNyZWF0ZVRhbmRlbSIsInRpbWVDb250cm9sTm9kZSIsInRpbWVTcGVlZFByb3BlcnR5IiwicGxheVBhdXNlU3RlcEJ1dHRvbk9wdGlvbnMiLCJpbmNsdWRlU3RlcEZvcndhcmRCdXR0b24iLCJwbGF5aW5nRGVzY3JpcHRpb24iLCJhMTF5IiwidGltZUNvbnRyb2xzIiwicGxheVBhdXNlQnV0dG9uUGxheWluZ0Rlc2NyaXB0aW9uU3RyaW5nUHJvcGVydHkiLCJwYXVzZWREZXNjcmlwdGlvbiIsInBsYXlQYXVzZUJ1dHRvblBhdXNlZERlc2NyaXB0aW9uU3RyaW5nUHJvcGVydHkiLCJlbmVyZ3lMZWdlbmRPcHRpb25zIiwiZW5lcmd5UmVwcmVzZW50YXRpb24iLCJFbmVyZ3lSZXByZXNlbnRhdGlvbiIsIldBVkUiLCJzY3JlZW5TdW1tYXJ5Q29udGVudCIsInN1cmZhY2VUaGVybW9tZXRlckNoZWNrYm94Iiwic3VyZmFjZVRoZXJtb21ldGVyVmlzaWJsZVByb3BlcnR5Iiwic3VyZmFjZVRlbXBlcmF0dXJlS2VsdmluUHJvcGVydHkiLCJ0ZW1wZXJhdHVyZVVuaXRzUHJvcGVydHkiLCJzdXJmYWNlVGVtcGVyYXR1cmVDaGVja2JveCIsInN1cmZhY2VUZW1wZXJhdHVyZVZpc2libGVQcm9wZXJ0eSIsImNsb3VkQ2hlY2tib3giLCJjbG91ZEVuYWJsZWRQcm9wZXJ0eSIsInN1bkVuZXJneVNvdXJjZSIsImlzU2hpbmluZ1Byb3BlcnR5IiwidmlzaWJsZVByb3BlcnR5IiwiY29uY2VudHJhdGlvbkNvbnRyb2xNb2RlUHJvcGVydHkiLCJtb2RlIiwiQllfVkFMVUUiLCJyYWRpYXRpb25EZXNjcmliZXIiLCJjb25jZW50cmF0aW9uQ29udHJvbHMiLCJlbmVyZ3lMZWdlbmQiLCJ3aWR0aCIsImxlZ2VuZEFuZENvbnRyb2xzVkJveCIsImFkZENoaWxkIiwibGVmdEJvdHRvbSIsInJpZ2h0Qm90dG9tIiwicGx1c1hZIiwiT0JTRVJWQVRJT05fV0lORE9XX1JJR0hUX1NQQUNJTkciLCJ2aXNpYmlsaXR5Qm94IiwiY2hpbGRyZW4iLCJzcGFjaW5nIiwiYWxpZ24iLCJsZWZ0IiwiY2VudGVyWSIsImxlZnRUb3AiLCJTQ1JFRU5fVklFV19ZX01BUkdJTiIsImlyV2F2ZXNTb3VuZEdlbmVyYXRvciIsImFkZFNvdW5kR2VuZXJhdG9yIiwiYXNzb2NpYXRlZFZpZXdOb2RlIiwic3RlcHBlZEVtaXR0ZXIiLCJhZGRMaXN0ZW5lciIsInN0ZXAiLCJiaW5kIiwicGRvbVBsYXlBcmVhTm9kZSIsInBkb21PcmRlciIsInN1cmZhY2VUaGVybW9tZXRlciIsImluc3RydW1lbnRWaXNpYmlsaXR5Q29udHJvbHMiLCJwZG9tQ29udHJvbEFyZWFOb2RlIiwicmVzZXRBbGxCdXR0b24iLCJyZXNldCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiV2F2ZXNTY3JlZW5WaWV3LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIwLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIE1haW4gdmlldyBjbGFzcyBmb3IgdGhlIFdhdmVzIHNjcmVlbi5cclxuICpcclxuICogQGF1dGhvciBKb2huIEJsYW5jbyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuaW1wb3J0IHsgVkJveCB9IGZyb20gJy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBzb3VuZE1hbmFnZXIgZnJvbSAnLi4vLi4vLi4vLi4vdGFtYm8vanMvc291bmRNYW5hZ2VyLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IEdyZWVuaG91c2VFZmZlY3RDb25zdGFudHMgZnJvbSAnLi4vLi4vY29tbW9uL0dyZWVuaG91c2VFZmZlY3RDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgeyBDb25jZW50cmF0aW9uQ29udHJvbE1vZGUgfSBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvQ29uY2VudHJhdGlvbk1vZGVsLmpzJztcclxuaW1wb3J0IENvbmNlbnRyYXRpb25Db250cm9sUGFuZWwgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvQ29uY2VudHJhdGlvbkNvbnRyb2xQYW5lbC5qcyc7XHJcbmltcG9ydCBSYWRpYXRpb25EZXNjcmliZXIgZnJvbSAnLi4vLi4vY29tbW9uL3ZpZXcvZGVzY3JpYmVycy9SYWRpYXRpb25EZXNjcmliZXIuanMnO1xyXG5pbXBvcnQgRW5lcmd5TGVnZW5kIGZyb20gJy4uLy4uL2NvbW1vbi92aWV3L0VuZXJneUxlZ2VuZC5qcyc7XHJcbmltcG9ydCBHcmVlbmhvdXNlRWZmZWN0U2NyZWVuVmlldyBmcm9tICcuLi8uLi9jb21tb24vdmlldy9HcmVlbmhvdXNlRWZmZWN0U2NyZWVuVmlldy5qcyc7XHJcbmltcG9ydCBMYXllcnNNb2RlbFRpbWVDb250cm9sTm9kZSBmcm9tICcuLi8uLi9jb21tb24vdmlldy9MYXllcnNNb2RlbFRpbWVDb250cm9sTm9kZS5qcyc7XHJcbmltcG9ydCBTdXJmYWNlVGhlcm1vbWV0ZXJDaGVja2JveCBmcm9tICcuLi8uLi9jb21tb24vdmlldy9TdXJmYWNlVGhlcm1vbWV0ZXJDaGVja2JveC5qcyc7XHJcbmltcG9ydCBncmVlbmhvdXNlRWZmZWN0IGZyb20gJy4uLy4uL2dyZWVuaG91c2VFZmZlY3QuanMnO1xyXG5pbXBvcnQgR3JlZW5ob3VzZUVmZmVjdFN0cmluZ3MgZnJvbSAnLi4vLi4vR3JlZW5ob3VzZUVmZmVjdFN0cmluZ3MuanMnO1xyXG5pbXBvcnQgV2F2ZXNNb2RlbCBmcm9tICcuLi9tb2RlbC9XYXZlc01vZGVsLmpzJztcclxuaW1wb3J0IENsb3VkQ2hlY2tib3ggZnJvbSAnLi9DbG91ZENoZWNrYm94LmpzJztcclxuaW1wb3J0IElyV2F2ZXNTb3VuZEdlbmVyYXRvciBmcm9tICcuL0lyV2F2ZXNTb3VuZEdlbmVyYXRvci5qcyc7XHJcbmltcG9ydCBTdXJmYWNlVGVtcGVyYXR1cmVDaGVja2JveCBmcm9tICcuL1N1cmZhY2VUZW1wZXJhdHVyZUNoZWNrYm94LmpzJztcclxuaW1wb3J0IFdhdmVMYW5kc2NhcGVPYnNlcnZhdGlvbldpbmRvdyBmcm9tICcuL1dhdmVMYW5kc2NhcGVPYnNlcnZhdGlvbldpbmRvdy5qcyc7XHJcbmltcG9ydCBXYXZlc1NjcmVlblN1bW1hcnlDb250ZW50Tm9kZSBmcm9tICcuL1dhdmVzU2NyZWVuU3VtbWFyeUNvbnRlbnROb2RlLmpzJztcclxuXHJcbmNsYXNzIFdhdmVzU2NyZWVuVmlldyBleHRlbmRzIEdyZWVuaG91c2VFZmZlY3RTY3JlZW5WaWV3IHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBtb2RlbDogV2F2ZXNNb2RlbCwgdGFuZGVtOiBUYW5kZW0gKSB7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRoZSBvYnNlcnZhdGlvbiB3aW5kb3cgdGhhdCB3aWxsIGRlcGljdCB0aGUgZ3JvdW5kLCBza3ksIGxpZ2h0IHdhdmVzLCBldGMuXHJcbiAgICBjb25zdCBvYnNlcnZhdGlvbldpbmRvdyA9IG5ldyBXYXZlTGFuZHNjYXBlT2JzZXJ2YXRpb25XaW5kb3coIG1vZGVsLCB7XHJcblxyXG4gICAgICAvLyBwaGV0LWlvXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ29ic2VydmF0aW9uV2luZG93JyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3QgdGltZUNvbnRyb2xOb2RlID0gbmV3IExheWVyc01vZGVsVGltZUNvbnRyb2xOb2RlKCBtb2RlbCwge1xyXG5cclxuICAgICAgLy8gUmVxdWVzdGVkIGluIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9ncmVlbmhvdXNlLWVmZmVjdC9pc3N1ZXMvMTU4IHRoYXQgdGhlIFRpbWVDb250cm9sTm9kZVxyXG4gICAgICAvLyBmb3IgdGhpcyBzY3JlZW4gZG9lcyBub3QgaGF2ZSBzcGVlZCByYWRpbyBidXR0b25zIG9yIGEgc3RlcCBmb3J3YXJkIGJ1dHRvblxyXG4gICAgICB0aW1lU3BlZWRQcm9wZXJ0eTogbnVsbCxcclxuICAgICAgcGxheVBhdXNlU3RlcEJ1dHRvbk9wdGlvbnM6IHtcclxuICAgICAgICBpbmNsdWRlU3RlcEZvcndhcmRCdXR0b246IGZhbHNlLFxyXG5cclxuICAgICAgICAvLyB1bmlxdWUgZGVzY3JpcHRpb24gYWJvdXQgdGhlIG9ic2VydmF0aW9uIHdpbmRvdyBzaW5jZSB0aGVyZSBhcmUgbm8gc3BlZWQgb3Igc3RlcCBidXR0b25zIGluIHRoaXMgY2FzZVxyXG4gICAgICAgIHBsYXlpbmdEZXNjcmlwdGlvbjogR3JlZW5ob3VzZUVmZmVjdFN0cmluZ3MuYTExeS50aW1lQ29udHJvbHMucGxheVBhdXNlQnV0dG9uUGxheWluZ0Rlc2NyaXB0aW9uU3RyaW5nUHJvcGVydHksXHJcbiAgICAgICAgcGF1c2VkRGVzY3JpcHRpb246IEdyZWVuaG91c2VFZmZlY3RTdHJpbmdzLmExMXkudGltZUNvbnRyb2xzLnBsYXlQYXVzZUJ1dHRvblBhdXNlZERlc2NyaXB0aW9uU3RyaW5nUHJvcGVydHlcclxuICAgICAgfSxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAndGltZUNvbnRyb2xOb2RlJyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgc3VwZXIoIG1vZGVsLCBvYnNlcnZhdGlvbldpbmRvdywgdGltZUNvbnRyb2xOb2RlLCB7XHJcbiAgICAgIGVuZXJneUxlZ2VuZE9wdGlvbnM6IHtcclxuICAgICAgICBlbmVyZ3lSZXByZXNlbnRhdGlvbjogRW5lcmd5TGVnZW5kLkVuZXJneVJlcHJlc2VudGF0aW9uLldBVkVcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIHBoZXQtaW9cclxuICAgICAgdGFuZGVtOiB0YW5kZW0sXHJcblxyXG4gICAgICAvLyBwZG9tXHJcbiAgICAgIHNjcmVlblN1bW1hcnlDb250ZW50OiBuZXcgV2F2ZXNTY3JlZW5TdW1tYXJ5Q29udGVudE5vZGUoIG1vZGVsIClcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBzdXJmYWNlVGhlcm1vbWV0ZXJDaGVja2JveCA9IG5ldyBTdXJmYWNlVGhlcm1vbWV0ZXJDaGVja2JveChcclxuICAgICAgbW9kZWwuc3VyZmFjZVRoZXJtb21ldGVyVmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICBtb2RlbC5zdXJmYWNlVGVtcGVyYXR1cmVLZWx2aW5Qcm9wZXJ0eSxcclxuICAgICAgbW9kZWwudGVtcGVyYXR1cmVVbml0c1Byb3BlcnR5LFxyXG4gICAgICB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnc3VyZmFjZVRoZXJtb21ldGVyQ2hlY2tib3gnIClcclxuICAgICk7XHJcbiAgICBjb25zdCBzdXJmYWNlVGVtcGVyYXR1cmVDaGVja2JveCA9IG5ldyBTdXJmYWNlVGVtcGVyYXR1cmVDaGVja2JveChcclxuICAgICAgbW9kZWwuc3VyZmFjZVRlbXBlcmF0dXJlVmlzaWJsZVByb3BlcnR5LFxyXG4gICAgICBtb2RlbCxcclxuICAgICAgdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3N1cmZhY2VUZW1wZXJhdHVyZUNoZWNrYm94JyApXHJcbiAgICApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgY2xvdWQtY29udHJvbCBjaGVja2JveC4gIFRoaXMgaXMgb25seSBzaG93biBpbiBtYW51YWxseS1jb250cm9sbGVkLWNvbmNlbnRyYXRpb24gbW9kZS5cclxuICAgIGNvbnN0IGNsb3VkQ2hlY2tib3ggPSBuZXcgQ2xvdWRDaGVja2JveChcclxuICAgICAgbW9kZWwuY2xvdWRFbmFibGVkUHJvcGVydHksXHJcbiAgICAgIG1vZGVsLnN1bkVuZXJneVNvdXJjZS5pc1NoaW5pbmdQcm9wZXJ0eSxcclxuICAgICAge1xyXG4gICAgICAgIHZpc2libGVQcm9wZXJ0eTogbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgICAgIFsgbW9kZWwuY29uY2VudHJhdGlvbkNvbnRyb2xNb2RlUHJvcGVydHkgXSxcclxuICAgICAgICAgIG1vZGUgPT4gbW9kZSA9PT0gQ29uY2VudHJhdGlvbkNvbnRyb2xNb2RlLkJZX1ZBTFVFXHJcbiAgICAgICAgKSxcclxuICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdjbG91ZENoZWNrYm94JyApXHJcbiAgICAgIH1cclxuICAgICk7XHJcblxyXG4gICAgLy8gUmVzcG9uc2libGUgZm9yIGdlbmVyYXRpbmcgZGVzY3JpcHRpb25zIGFib3V0IHRoZSBjaGFuZ2luZyByYWRpYXRpb24uXHJcbiAgICBjb25zdCByYWRpYXRpb25EZXNjcmliZXIgPSBuZXcgUmFkaWF0aW9uRGVzY3JpYmVyKCBtb2RlbCApO1xyXG5cclxuICAgIGNvbnN0IGNvbmNlbnRyYXRpb25Db250cm9scyA9IG5ldyBDb25jZW50cmF0aW9uQ29udHJvbFBhbmVsKFxyXG4gICAgICB0aGlzLmVuZXJneUxlZ2VuZC53aWR0aCxcclxuICAgICAgbW9kZWwsXHJcbiAgICAgIHJhZGlhdGlvbkRlc2NyaWJlcixcclxuICAgICAge1xyXG5cclxuICAgICAgICAvLyBwaGV0LWlvXHJcbiAgICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnY29uY2VudHJhdGlvbkNvbnRyb2xQYW5lbCcgKVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgY29uY2VudHJhdGlvbiBjb250cm9scy4gIEl0IGdvZXMgaW50byBhIFZCb3ggdG8gc3VwcG9ydCBkeW5hbWljIGxheW91dC5cclxuICAgIHRoaXMubGVnZW5kQW5kQ29udHJvbHNWQm94LmFkZENoaWxkKCBjb25jZW50cmF0aW9uQ29udHJvbHMgKTtcclxuXHJcbiAgICAvLyBjbG91ZCBjaGVja2JveFxyXG4gICAgY2xvdWRDaGVja2JveC5sZWZ0Qm90dG9tID0gdGhpcy5vYnNlcnZhdGlvbldpbmRvdy5yaWdodEJvdHRvbS5wbHVzWFkoXHJcbiAgICAgIEdyZWVuaG91c2VFZmZlY3RDb25zdGFudHMuT0JTRVJWQVRJT05fV0lORE9XX1JJR0hUX1NQQUNJTkcsXHJcbiAgICAgIDBcclxuICAgICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBjbG91ZENoZWNrYm94ICk7XHJcblxyXG4gICAgLy8gbGF5b3V0IGNvZGVcclxuICAgIGNvbnN0IHZpc2liaWxpdHlCb3ggPSBuZXcgVkJveCgge1xyXG4gICAgICBjaGlsZHJlbjogWyBzdXJmYWNlVGhlcm1vbWV0ZXJDaGVja2JveCwgc3VyZmFjZVRlbXBlcmF0dXJlQ2hlY2tib3ggXSxcclxuICAgICAgc3BhY2luZzogNSxcclxuICAgICAgYWxpZ246ICdsZWZ0J1xyXG4gICAgfSApO1xyXG4gICAgdmlzaWJpbGl0eUJveC5sZWZ0ID0gdGhpcy5vYnNlcnZhdGlvbldpbmRvdy5sZWZ0ICsgNTtcclxuICAgIHZpc2liaWxpdHlCb3guY2VudGVyWSA9IHRoaXMudGltZUNvbnRyb2xOb2RlLmNlbnRlclk7XHJcblxyXG4gICAgY29uY2VudHJhdGlvbkNvbnRyb2xzLmxlZnRUb3AgPSB0aGlzLmVuZXJneUxlZ2VuZC5sZWZ0Qm90dG9tLnBsdXNYWShcclxuICAgICAgMCxcclxuICAgICAgR3JlZW5ob3VzZUVmZmVjdENvbnN0YW50cy5TQ1JFRU5fVklFV19ZX01BUkdJTlxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKCB2aXNpYmlsaXR5Qm94ICk7XHJcblxyXG4gICAgLy8gc291bmQgZ2VuZXJhdGlvblxyXG4gICAgY29uc3QgaXJXYXZlc1NvdW5kR2VuZXJhdG9yID0gbmV3IElyV2F2ZXNTb3VuZEdlbmVyYXRvciggbW9kZWwsIHRoaXMgKTtcclxuICAgIHNvdW5kTWFuYWdlci5hZGRTb3VuZEdlbmVyYXRvciggaXJXYXZlc1NvdW5kR2VuZXJhdG9yLCB7IGFzc29jaWF0ZWRWaWV3Tm9kZTogdGhpcyB9ICk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHRoaXMgc291bmQgZ2VuZXJhdG9yIHdoZW4gdGhlIG1vZGVsIGlzIHN0ZXBwZWQuICBObyBuZWVkIHRvIHVubGluayBzaW5jZSB0aGlzIHZpZXcgaXMgbmV2ZXIgZGlzcG9zZWQuXHJcbiAgICBtb2RlbC5zdGVwcGVkRW1pdHRlci5hZGRMaXN0ZW5lciggaXJXYXZlc1NvdW5kR2VuZXJhdG9yLnN0ZXAuYmluZCggaXJXYXZlc1NvdW5kR2VuZXJhdG9yICkgKTtcclxuXHJcbiAgICAvLyBwZG9tIC0gb3ZlcnJpZGUgdGhlIHBkb21PcmRlcnMgZm9yIHRoZSBzdXBlcnR5cGUgdG8gaW5zZXJ0IHN1YnR5cGUgY29tcG9uZW50c1xyXG4gICAgdGhpcy5wZG9tUGxheUFyZWFOb2RlLnBkb21PcmRlciA9IFtcclxuICAgICAgdGhpcy5vYnNlcnZhdGlvbldpbmRvdyxcclxuICAgICAgdGhpcy5lbmVyZ3lMZWdlbmQsXHJcbiAgICAgIGNvbmNlbnRyYXRpb25Db250cm9scyxcclxuICAgICAgb2JzZXJ2YXRpb25XaW5kb3cuc3VyZmFjZVRoZXJtb21ldGVyLFxyXG4gICAgICBvYnNlcnZhdGlvbldpbmRvdy5pbnN0cnVtZW50VmlzaWJpbGl0eUNvbnRyb2xzLFxyXG4gICAgICBjbG91ZENoZWNrYm94XHJcbiAgICBdO1xyXG4gICAgdGhpcy5wZG9tQ29udHJvbEFyZWFOb2RlLnBkb21PcmRlciA9IFtcclxuICAgICAgdmlzaWJpbGl0eUJveCxcclxuICAgICAgdGhpcy50aW1lQ29udHJvbE5vZGUsXHJcbiAgICAgIHRoaXMucmVzZXRBbGxCdXR0b25cclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgcmVzZXQoKTogdm9pZCB7XHJcbiAgICBzdXBlci5yZXNldCgpO1xyXG4gIH1cclxufVxyXG5cclxuZ3JlZW5ob3VzZUVmZmVjdC5yZWdpc3RlciggJ1dhdmVzU2NyZWVuVmlldycsIFdhdmVzU2NyZWVuVmlldyApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgV2F2ZXNTY3JlZW5WaWV3OyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSx3Q0FBd0M7QUFDcEUsU0FBU0MsSUFBSSxRQUFRLG1DQUFtQztBQUN4RCxPQUFPQyxZQUFZLE1BQU0sc0NBQXNDO0FBRS9ELE9BQU9DLHlCQUF5QixNQUFNLDJDQUEyQztBQUNqRixTQUFTQyx3QkFBd0IsUUFBUSwwQ0FBMEM7QUFDbkYsT0FBT0MseUJBQXlCLE1BQU0sZ0RBQWdEO0FBQ3RGLE9BQU9DLGtCQUFrQixNQUFNLG9EQUFvRDtBQUNuRixPQUFPQyxZQUFZLE1BQU0sbUNBQW1DO0FBQzVELE9BQU9DLDBCQUEwQixNQUFNLGlEQUFpRDtBQUN4RixPQUFPQywwQkFBMEIsTUFBTSxpREFBaUQ7QUFDeEYsT0FBT0MsMEJBQTBCLE1BQU0saURBQWlEO0FB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