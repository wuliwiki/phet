// Copyright 2020-2023, University of Colorado Boulder

/**
 * WavesModel uses a layer model for simulating temperature changes due to changes in the concentration of greenhouse
 * gases, and also creates and moves light waves that interact with the ground and atmosphere in a way that simulates
 * that behavior in Earth's atmosphere.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author John Blanco (PhET Interactive Simulations)
 */

import createObservableArray from '../../../../axon/js/createObservableArray.js';
import Emitter from '../../../../axon/js/Emitter.js';
import Range from '../../../../dot/js/Range.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import { Line } from '../../../../kite/js/imports.js';
import { combineOptions } from '../../../../phet-core/js/optionize.js';
import PhetioGroup from '../../../../tandem/js/PhetioGroup.js';
import IOType from '../../../../tandem/js/types/IOType.js';
import MapIO from '../../../../tandem/js/types/MapIO.js';
import ReferenceIO from '../../../../tandem/js/types/ReferenceIO.js';
import GreenhouseEffectConstants from '../../common/GreenhouseEffectConstants.js';
import ConcentrationModel from '../../common/model/ConcentrationModel.js';
import GroundLayer from '../../common/model/GroundLayer.js';
import LayersModel from '../../common/model/LayersModel.js';
import greenhouseEffect from '../../greenhouseEffect.js';
import EMWaveSource from './EMWaveSource.js';
import GroundWaveSource from './GroundWaveSource.js';
import SunWaveSource from './SunWaveSource.js';
import Wave from './Wave.js';

// constants
const MAX_ATMOSPHERIC_INTERACTION_PROPORTION = 0.75; // max proportion of IR wave that can go back to Earth
const TWO_PI = Math.PI * 2;

// Wavelength values used when depicting the waves, in meters.  Far from real life.  Can be adjusted for desired look.
const REAL_TO_RENDERING_WAVELENGTH_MAP = new Map([[GreenhouseEffectConstants.VISIBLE_WAVELENGTH, 8000], [GreenhouseEffectConstants.INFRARED_WAVELENGTH, 12000]]);
const WAVE_AMPLITUDE_FOR_RENDERING = 2000;
class WavesModel extends ConcentrationModel {
  constructor(tandem) {
    super(tandem, {
      // phet-io
      phetioType: WavesModel.WavesModelIO,
      phetioState: true
    });

    // (read-only) {PhetioGroup.<Wave>} - the waves that are currently active in the model
    this.waveGroup = new PhetioGroup((tandem, wavelength, origin, propagationDirection, propagationLimit, providedOptions) => {
      const options = combineOptions({
        tandem: tandem
      }, providedOptions);
      return new Wave(wavelength, origin, propagationDirection, propagationLimit, options);
    }, [GreenhouseEffectConstants.INFRARED_WAVELENGTH, Vector2.ZERO, GreenhouseEffectConstants.STRAIGHT_UP_NORMALIZED_VECTOR, LayersModel.HEIGHT_OF_ATMOSPHERE, {}], {
      tandem: tandem.createTandem('waveGroup'),
      phetioType: PhetioGroup.PhetioGroupIO(Wave.WaveIO)
    });

    // signals when the waves have changed so that the view can update them
    this.wavesChangedEmitter = new Emitter();

    // the source of the waves of visible light that come from the sun
    this.sunWaveSource = new SunWaveSource(this.waveGroup, this.sunEnergySource.isShiningProperty, LayersModel.HEIGHT_OF_ATMOSPHERE, 0, {
      tandem: tandem.createTandem('sunWaveSource')
    });

    // the source of the waves of infrared light (i.e. the ones that come from the ground)
    this.groundWaveSource = new GroundWaveSource(this.waveGroup, 0, LayersModel.HEIGHT_OF_ATMOSPHERE, this.surfaceTemperatureKelvinProperty, {
      tandem: tandem.createTandem('groundWaveSource')
    });

    // map of waves from the sun to waves reflected off of clouds
    this.cloudReflectedWavesMap = new Map();

    // map of waves from the sun to waves reflected off of the glacier
    this.glacierReflectedWavesMap = new Map();

    // A Map containing atmospheric layers and ranges that define the x coordinate within which IR waves should
    // interact with that layer.
    this.atmosphereLayerToXRangeMap = new Map([
    // leftmost interaction area
    [this.atmosphereLayers[4], new Range(-LayersModel.SUNLIGHT_SPAN.width / 2, -LayersModel.SUNLIGHT_SPAN.width / 4)],
    // central interaction area
    [this.atmosphereLayers[6], new Range(-LayersModel.SUNLIGHT_SPAN.width / 4, LayersModel.SUNLIGHT_SPAN.width / 4)],
    // rightmost interaction area
    [this.atmosphereLayers[3], new Range(LayersModel.SUNLIGHT_SPAN.width * 0.25, LayersModel.SUNLIGHT_SPAN.width)]]);

    // (read-only) {ObservableArrayDef.<WaveAtmosphereInteraction>} - An array of the interactions that are
    // currently occurring between IR waves and the atmosphere.
    this.waveAtmosphereInteractions = createObservableArray({
      tandem: tandem.createTandem('waveAtmosphereInteractions'),
      phetioType: createObservableArray.ObservableArrayIO(WaveAtmosphereInteraction.WaveAtmosphereInteractionIO),
      phetioDocumentation: 'Interactions between IR waves coming from the ground and the atmosphere'
    });

    // Pre-allocated vectors and lines used for testing whether waves are crossing through interactive areas of the
    // atmosphere, reused by methods in order to reduce memory allocations.
    this.waveLineStart = new Vector2(0, 0);
    this.waveLineEnd = new Vector2(0, 1);
    this.waveLine = new Line(this.waveLineStart, this.waveLineEnd);
    this.atmosphereLineStart = new Vector2(0, 0);
    this.atmosphereLineEnd = new Vector2(0, 1);
    this.atmosphereLine = new Line(this.atmosphereLineStart, this.atmosphereLineEnd);
  }

  /**
   * Step the model forward by the provided time.
   * @param dt - delta time, in seconds
   */
  stepModel(dt) {
    const numberOfWavesAtStartOfStep = this.waveGroup.count;
    super.stepModel(dt);
    this.sunWaveSource.step(dt);
    this.groundWaveSource.step(dt);
    this.waveGroup.forEach(wave => wave.step(dt));
    this.updateWaveCloudInteractions();
    this.updateWaveAtmosphereInteractions();
    this.updateWaveGlacierInteractions();

    // Remove any waves that have finished propagating.
    this.waveGroup.filter(wave => wave.isCompletelyPropagated).forEach(wave => {
      this.waveGroup.disposeElement(wave);
    });

    // Emit a notification if anything has changed about the waves during this step so that the view can be updated.
    if (this.waveGroup.count > 0 || numberOfWavesAtStartOfStep > 0) {
      this.wavesChangedEmitter.emit();
    }
  }

  /**
   * Update the interactions between light waves and the cloud.
   */
  updateWaveCloudInteractions() {
    if (this.cloud) {
      const cloud = this.cloud; // convenience var

      // The reflectivity value used visually is NOT the actual value used in the cloud model.  This is because the actual
      // value didn't produce enough of a visible wave.  In other words, this value is "Hollywooded" to get the look we
      // wanted.  See https://github.com/phetsims/greenhouse-effect/issues/82.
      const visualCloudReflectivity = 0.5;

      // See if any of the currently reflected waves should stop reflecting.
      this.cloudReflectedWavesMap.forEach((reflectedWave, sourceWave) => {
        if (!cloud.enabledProperty.value || sourceWave.startPoint.y < cloud.position.y) {
          // Either the cloud has disappeared or the wave from the sun that was being reflected has gone all the way
          // through the cloud.  In either case, it's time to stop reflecting the wave.
          reflectedWave.isSourced = false;
          this.cloudReflectedWavesMap.delete(sourceWave);
        }
      });
      if (cloud.enabledProperty.value) {
        // Make a list of waves that originated from the sun and are currently passing through the cloud.
        const wavesCrossingTheCloud = this.waveGroup.filter(wave => wave.isVisible && wave.origin.y === this.sunWaveSource.waveStartAltitude && wave.propagationDirection.y < 0 && wave.startPoint.y > cloud.position.y && wave.startPoint.y - wave.length < cloud.position.y && wave.startPoint.x > cloud.position.x - cloud.width / 2 && wave.startPoint.x < cloud.position.x + cloud.width / 2);

        // Check if reflected waves and attenuators are in place for this cloud and, if not, add them.
        wavesCrossingTheCloud.forEach(incidentWave => {
          // If there is no reflected wave for this incident wave, create one.
          if (!this.cloudReflectedWavesMap.has(incidentWave)) {
            const direction = incidentWave.origin.x > cloud.position.x ? GreenhouseEffectConstants.STRAIGHT_UP_NORMALIZED_VECTOR.rotated(-Math.PI * 0.1) : GreenhouseEffectConstants.STRAIGHT_UP_NORMALIZED_VECTOR.rotated(Math.PI * 0.1);
            const reflectedWave = this.waveGroup.createNextElement(incidentWave.wavelength, new Vector2(incidentWave.origin.x, cloud.position.y), direction, LayersModel.HEIGHT_OF_ATMOSPHERE, {
              intensityAtStart: incidentWave.intensityAtStart * visualCloudReflectivity,
              initialPhaseOffset: (incidentWave.getPhaseAt(incidentWave.origin.y - cloud.position.y) + Math.PI) % (2 * Math.PI)
            });
            this.cloudReflectedWavesMap.set(incidentWave, reflectedWave);
          }

          // If there is no attenuation of this wave as it passes through the cloud, create it.
          if (!incidentWave.hasAttenuator(cloud)) {
            incidentWave.addAttenuator(incidentWave.startPoint.y - cloud.position.y, visualCloudReflectivity, cloud);
          }
        });
      } else {
        // The cloud is not enabled, so if there are any waves that were being attenuated because of the cloud, stop that
        // from happening.
        this.waveGroup.forEach(wave => {
          if (wave.hasAttenuator(cloud)) {
            wave.removeAttenuator(cloud);
          }
        });
      }
    }
  }

  /**
   * Update the interactions between IR waves and the atmosphere.
   */
  updateWaveAtmosphereInteractions() {
    // Calculate how much of each wave should go back towards the Earth and how much should continue on its way given
    // the current concentration of greenhouse gases.
    const irWaveAttenuation = mapGasConcentrationToAttenuation(this.concentrationProperty.value);

    // Update the existing interactions between the light waves and the atmosphere.
    this.waveAtmosphereInteractions.forEach(interaction => {
      // If the gas concentration has gone to zero or the source wave have moved all the way through this interaction
      // location, the interaction should end.
      if (this.concentrationProperty.value === 0 || interaction.sourceWave.startPoint.y > interaction.atmosphereLayer.altitude) {
        // Free the wave that was being emitted to propagate on its own.
        interaction.emittedWave.isSourced = false;

        // Remove the attenuator that was associated with this interaction from the wave (if it hasn't happened
        // automatically yet).
        if (interaction.sourceWave.hasAttenuator(interaction.atmosphereLayer)) {
          interaction.sourceWave.removeAttenuator(interaction.atmosphereLayer);
        }

        // Remove this interaction from our list.
        this.waveAtmosphereInteractions.remove(interaction);
      } else {
        // Make sure the attenuation on the source wave is correct.
        interaction.sourceWave.setAttenuation(interaction.atmosphereLayer, irWaveAttenuation);

        // Set the intensity of the emitted wave.
        const sourceWaveIntensityAtInteraction = interaction.sourceWave.getIntensityAtAltitude(interaction.atmosphereLayer.altitude);
        const emittedWaveIntensity = sourceWaveIntensityAtInteraction * irWaveAttenuation;
        if (interaction.emittedWave.intensityAtStart !== emittedWaveIntensity) {
          interaction.emittedWave.setIntensityAtStart(emittedWaveIntensity);
        }
      }
    });

    // Make a list of all IR waves that are currently emanating from the ground.
    const wavesFromTheGround = this.waveGroup.filter(wave => wave.isInfrared && wave.origin.y === 0);

    // For each IR wave from the ground, check to see if there are any interactions with the atmosphere that should
    // exist but don't yet.
    wavesFromTheGround.forEach(waveFromTheGround => {
      const hasActiveInteraction = this.waveAtmosphereInteractions.reduce((found, interaction) => found || interaction.sourceWave === waveFromTheGround, false);

      // If there is already an atmospheric interaction that is driven by this wave, stop here and don't create a new
      // one.  This is a design choice, not a physical one.  If there is ever a need to have multiple interactions
      // driven by the same wave, this will need to change.
      if (!hasActiveInteraction) {
        // Get a line that represents where the wave starts and ends.  Use pre-allocated components to reduce
        // allocations.
        this.waveLine.setStart(waveFromTheGround.startPoint);
        waveFromTheGround.getEndPoint(this.waveLineEnd);
        this.waveLine.setEnd(this.waveLineEnd);

        // Check if this wave is crossing any of the atmosphere interaction areas.
        this.atmosphereLayerToXRangeMap.forEach((xRange, layer) => {
          if (layer.energyAbsorptionProportionProperty.value > 0) {
            // Establish the line in the atmosphere against which the wave is to be tested.
            this.atmosphereLineStart.setXY(xRange.min, layer.altitude);
            this.atmosphereLineEnd.setXY(xRange.max, layer.altitude);
            this.atmosphereLine.setStart(this.atmosphereLineStart);
            this.atmosphereLine.setEnd(this.atmosphereLineEnd);

            // See if there is an intersection and create a new wave if so.
            const intersection = Line.intersect(this.waveLine, this.atmosphereLine);
            if (intersection.length > 0) {
              assert && assert(intersection.length === 1, 'multiple intersections are not expected');
              const waveStartToIntersectionLength = (this.atmosphereLine.start.y - waveFromTheGround.startPoint.y) / waveFromTheGround.propagationDirection.y;
              const waveOriginToIntersectionLength = (this.atmosphereLine.start.y - waveFromTheGround.origin.y) / waveFromTheGround.propagationDirection.y;

              // Create the new emitted wave.
              const waveFromAtmosphericInteraction = this.waveGroup.createNextElement(waveFromTheGround.wavelength, intersection[0].point, new Vector2(waveFromTheGround.propagationDirection.x, -waveFromTheGround.propagationDirection.y), 0, {
                // The emitted wave's intensity is a proportion of the wave that causes the interaction.
                intensityAtStart: waveFromTheGround.intensityAtStart * irWaveAttenuation,
                // Align the phase offsets because it looks better in the view.
                initialPhaseOffset: (waveFromTheGround.getPhaseAt(waveOriginToIntersectionLength) + Math.PI) % (2 * Math.PI)
              });

              // Add an attenuator on the source wave.
              waveFromTheGround.addAttenuator(waveStartToIntersectionLength, this.concentrationProperty.value * MAX_ATMOSPHERIC_INTERACTION_PROPORTION, layer);

              // Add the wave-atmosphere interaction to our list.
              this.waveAtmosphereInteractions.push(new WaveAtmosphereInteraction(layer, waveFromTheGround, waveFromAtmosphericInteraction));
            }
          }
        });
      }
    });
  }

  /**
   * update the interactions between light waves and the glacier
   */
  updateWaveGlacierInteractions() {
    // See if any of the currently reflected waves should stop reflecting.
    this.glacierReflectedWavesMap.forEach((reflectedWave, sourceWave) => {
      if (this.groundLayer.albedoProperty.value < GroundLayer.PARTIALLY_GLACIATED_LAND_ALBEDO || !this.waveGroup.includes(sourceWave)) {
        // Either the albedo has gone below that of the ice age or the wave from the sun that was being reflected has
        // gone away.  In either case, free this wave to finish propagating on its own.
        reflectedWave.isSourced = false;
        this.glacierReflectedWavesMap.delete(sourceWave);
      }
    });

    // See if any new waves should be created.
    if (this.groundLayer.albedoProperty.value >= GroundLayer.PARTIALLY_GLACIATED_LAND_ALBEDO) {
      // Make a list of waves that originated from the sun and are reaching the glacier.
      // TODO: This is using a fixed position and should be adjusted when we know exactly where the glacier will be,
      //       see https://github.com/phetsims/greenhouse-effect/issues/73.
      const wavesHittingTheGlacier = this.waveGroup.filter(wave => wave.isVisible && wave.origin.x > 0 && wave.origin.y === this.sunWaveSource.waveStartAltitude && wave.propagationDirection.y < 0 && wave.getEndPoint().y === 0);

      // Check if reflected waves are in place for these and, if not, add them.
      wavesHittingTheGlacier.forEach(incidentWave => {
        // If there is no reflected wave for this incident wave, create one.
        if (!this.glacierReflectedWavesMap.has(incidentWave)) {
          const direction = GreenhouseEffectConstants.STRAIGHT_UP_NORMALIZED_VECTOR.rotated(Math.PI * 0.05);
          const reflectedWave = this.waveGroup.createNextElement(incidentWave.wavelength, new Vector2(incidentWave.origin.x, 0), direction, LayersModel.HEIGHT_OF_ATMOSPHERE, {
            intensityAtStart: 0.25,
            // arbitrarily chose to look good
            initialPhaseOffset: (incidentWave.getPhaseAt(LayersModel.HEIGHT_OF_ATMOSPHERE) + Math.PI) % TWO_PI
          });
          this.glacierReflectedWavesMap.set(incidentWave, reflectedWave);
        }
      });
    }
  }

  /**
   */
  reset() {
    const numberOfWavesBeforeReset = this.waveGroup.count;
    super.reset();
    this.waveGroup.clear();
    this.surfaceTemperatureVisibleProperty.reset();
    this.cloudReflectedWavesMap.clear();
    this.glacierReflectedWavesMap.clear();
    this.sunWaveSource.reset();
    this.groundWaveSource.reset();
    this.waveAtmosphereInteractions.clear();
    if (numberOfWavesBeforeReset > 0) {
      this.wavesChangedEmitter.emit();
    }
  }

  /**
   * for phet-io
   */
  toStateObject() {
    return combineOptions(super.toStateObject(), {
      sunWaveSource: EMWaveSource.EMWaveSourceIO.toStateObject(this.sunWaveSource),
      groundWaveSource: EMWaveSource.EMWaveSourceIO.toStateObject(this.groundWaveSource),
      cloudReflectedWavesMap: MapIO(ReferenceIO(Wave.WaveIO), ReferenceIO(Wave.WaveIO)).toStateObject(this.cloudReflectedWavesMap),
      glacierReflectedWavesMap: MapIO(ReferenceIO(Wave.WaveIO), ReferenceIO(Wave.WaveIO)).toStateObject(this.glacierReflectedWavesMap)
    });
  }

  /**
   * for phet-io
   */
  applyState(stateObject) {
    this.sunWaveSource.applyState(stateObject.sunWaveSource);
    this.groundWaveSource.applyState(stateObject.groundWaveSource);
    this.cloudReflectedWavesMap = MapIO(ReferenceIO(Wave.WaveIO), ReferenceIO(Wave.WaveIO)).fromStateObject(stateObject.cloudReflectedWavesMap);
    this.glacierReflectedWavesMap = MapIO(ReferenceIO(Wave.WaveIO), ReferenceIO(Wave.WaveIO)).fromStateObject(stateObject.glacierReflectedWavesMap);
    super.applyState(stateObject);
  }

  /**
   * WavesModelIO handles PhET-iO serialization of the WavesModel. Because serialization involves accessing private
   * members, it delegates to WavesModel. The methods that WavesModelIO overrides are typical of 'Dynamic element
   * serialization', as described in the Serialization section of
   * https://github.com/phetsims/phet-io/blob/master/doc/phet-io-instrumentation-technical-guide.md#serialization
   */
  static WavesModelIO = new IOType('WavesModelIO', {
    valueType: WavesModel,
    toStateObject: wavesModel => wavesModel.toStateObject(),
    applyState: (wavesModel, stateObject) => wavesModel.applyState(stateObject),
    stateSchema: {
      sunWaveSource: EMWaveSource.EMWaveSourceIO,
      groundWaveSource: EMWaveSource.EMWaveSourceIO,
      cloudReflectedWavesMap: MapIO(ReferenceIO(Wave.WaveIO), ReferenceIO(Wave.WaveIO)),
      glacierReflectedWavesMap: MapIO(ReferenceIO(Wave.WaveIO), ReferenceIO(Wave.WaveIO)),
      ...LayersModel.STATE_SCHEMA
    }
  });

  // other static values
  static REAL_TO_RENDERING_WAVELENGTH_MAP = REAL_TO_RENDERING_WAVELENGTH_MAP;
  static WAVE_AMPLITUDE_FOR_RENDERING = WAVE_AMPLITUDE_FOR_RENDERING;
}
/**
 * Helper function for calculating an attenuation value that should be used in an atmospheric interaction based on the
 * concentration of greenhouse gases.
 */
const mapGasConcentrationToAttenuation = concentration => {
  // This equation was empirically determined, and will only work if the wave intensity coming from the ground doesn't
  // change.  In other words, this is a touchy part of the whole system, so update as needed but be careful about it.
  return -0.84 * Math.pow(concentration, 2) + 1.66 * concentration;
};

/**
 * A simple inner class for tracking interactions between the IR waves and the atmosphere.
 */
class WaveAtmosphereInteraction {
  constructor(atmosphereLayer, sourceWave, emittedWave) {
    this.atmosphereLayer = atmosphereLayer;
    this.sourceWave = sourceWave;
    this.emittedWave = emittedWave;
  }
  toStateObject() {
    return {
      atmosphereLayer: ReferenceIO(IOType.ObjectIO).toStateObject(this.atmosphereLayer),
      sourceWave: ReferenceIO(Wave.WaveIO).toStateObject(this.sourceWave),
      emittedWave: ReferenceIO(Wave.WaveIO).toStateObject(this.emittedWave)
    };
  }
  static WaveAtmosphereInteractionIO = new IOType('WaveAtmosphereInteractionIO', {
    valueType: WaveAtmosphereInteraction,
    stateSchema: {
      atmosphereLayer: ReferenceIO(IOType.ObjectIO),
      sourceWave: ReferenceIO(Wave.WaveIO),
      emittedWave: ReferenceIO(Wave.WaveIO)
    },
    toStateObject: waveAtmosphereInteraction => waveAtmosphereInteraction.toStateObject(),
    fromStateObject: stateObject => new WaveAtmosphereInteraction(ReferenceIO(IOType.ObjectIO).fromStateObject(stateObject.atmosphereLayer), ReferenceIO(Wave.WaveIO).fromStateObject(stateObject.sourceWave), ReferenceIO(Wave.WaveIO).fromStateObject(stateObject.emittedWave))
  });
}
greenhouseEffect.register('WavesModel', WavesModel);
export default WavesModel;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjcmVhdGVPYnNlcnZhYmxlQXJyYXkiLCJFbWl0dGVyIiwiUmFuZ2UiLCJWZWN0b3IyIiwiTGluZSIsImNvbWJpbmVPcHRpb25zIiwiUGhldGlvR3JvdXAiLCJJT1R5cGUiLCJNYXBJTyIsIlJlZmVyZW5jZUlPIiwiR3JlZW5ob3VzZUVmZmVjdENvbnN0YW50cyIsIkNvbmNlbnRyYXRpb25Nb2RlbCIsIkdyb3VuZExheWVyIiwiTGF5ZXJzTW9kZWwiLCJncmVlbmhvdXNlRWZmZWN0IiwiRU1XYXZlU291cmNlIiwiR3JvdW5kV2F2ZVNvdXJjZSIsIlN1bldhdmVTb3VyY2UiLCJXYXZlIiwiTUFYX0FUTU9TUEhFUklDX0lOVEVSQUNUSU9OX1BST1BPUlRJT04iLCJUV09fUEkiLCJNYXRoIiwiUEkiLCJSRUFMX1RPX1JFTkRFUklOR19XQVZFTEVOR1RIX01BUCIsIk1hcCIsIlZJU0lCTEVfV0FWRUxFTkdUSCIsIklORlJBUkVEX1dBVkVMRU5HVEgiLCJXQVZFX0FNUExJVFVERV9GT1JfUkVOREVSSU5HIiwiV2F2ZXNNb2RlbCIsImNvbnN0cnVjdG9yIiwidGFuZGVtIiwicGhldGlvVHlwZSIsIldhdmVzTW9kZWxJTyIsInBoZXRpb1N0YXRlIiwid2F2ZUdyb3VwIiwid2F2ZWxlbmd0aCIsIm9yaWdpbiIsInByb3BhZ2F0aW9uRGlyZWN0aW9uIiwicHJvcGFnYXRpb25MaW1pdCIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJaRVJPIiwiU1RSQUlHSFRfVVBfTk9STUFMSVpFRF9WRUNUT1IiLCJIRUlHSFRfT0ZfQVRNT1NQSEVSRSIsImNyZWF0ZVRhbmRlbSIsIlBoZXRpb0dyb3VwSU8iLCJXYXZlSU8iLCJ3YXZlc0NoYW5nZWRFbWl0dGVyIiwic3VuV2F2ZVNvdXJjZSIsInN1bkVuZXJneVNvdXJjZSIsImlzU2hpbmluZ1Byb3BlcnR5IiwiZ3JvdW5kV2F2ZVNvdXJjZSIsInN1cmZhY2VUZW1wZXJhdHVyZUtlbHZpblByb3BlcnR5IiwiY2xvdWRSZWZsZWN0ZWRXYXZlc01hcCIsImdsYWNpZXJSZWZsZWN0ZWRXYXZlc01hcCIsImF0bW9zcGhlcmVMYXllclRvWFJhbmdlTWFwIiwiYXRtb3NwaGVyZUxheWVycyIsIlNVTkxJR0hUX1NQQU4iLCJ3aWR0aCIsIndhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25zIiwiT2JzZXJ2YWJsZUFycmF5SU8iLCJXYXZlQXRtb3NwaGVyZUludGVyYWN0aW9uIiwiV2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbklPIiwicGhldGlvRG9jdW1lbnRhdGlvbiIsIndhdmVMaW5lU3RhcnQiLCJ3YXZlTGluZUVuZCIsIndhdmVMaW5lIiwiYXRtb3NwaGVyZUxpbmVTdGFydCIsImF0bW9zcGhlcmVMaW5lRW5kIiwiYXRtb3NwaGVyZUxpbmUiLCJzdGVwTW9kZWwiLCJkdCIsIm51bWJlck9mV2F2ZXNBdFN0YXJ0T2ZTdGVwIiwiY291bnQiLCJzdGVwIiwiZm9yRWFjaCIsIndhdmUiLCJ1cGRhdGVXYXZlQ2xvdWRJbnRlcmFjdGlvbnMiLCJ1cGRhdGVXYXZlQXRtb3NwaGVyZUludGVyYWN0aW9ucyIsInVwZGF0ZVdhdmVHbGFjaWVySW50ZXJhY3Rpb25zIiwiZmlsdGVyIiwiaXNDb21wbGV0ZWx5UHJvcGFnYXRlZCIsImRpc3Bvc2VFbGVtZW50IiwiZW1pdCIsImNsb3VkIiwidmlzdWFsQ2xvdWRSZWZsZWN0aXZpdHkiLCJyZWZsZWN0ZWRXYXZlIiwic291cmNlV2F2ZSIsImVuYWJsZWRQcm9wZXJ0eSIsInZhbHVlIiwic3RhcnRQb2ludCIsInkiLCJwb3NpdGlvbiIsImlzU291cmNlZCIsImRlbGV0ZSIsIndhdmVzQ3Jvc3NpbmdUaGVDbG91ZCIsImlzVmlzaWJsZSIsIndhdmVTdGFydEFsdGl0dWRlIiwibGVuZ3RoIiwieCIsImluY2lkZW50V2F2ZSIsImhhcyIsImRpcmVjdGlvbiIsInJvdGF0ZWQiLCJjcmVhdGVOZXh0RWxlbWVudCIsImludGVuc2l0eUF0U3RhcnQiLCJpbml0aWFsUGhhc2VPZmZzZXQiLCJnZXRQaGFzZUF0Iiwic2V0IiwiaGFzQXR0ZW51YXRvciIsImFkZEF0dGVudWF0b3IiLCJyZW1vdmVBdHRlbnVhdG9yIiwiaXJXYXZlQXR0ZW51YXRpb24iLCJtYXBHYXNDb25jZW50cmF0aW9uVG9BdHRlbnVhdGlvbiIsImNvbmNlbnRyYXRpb25Qcm9wZXJ0eSIsImludGVyYWN0aW9uIiwiYXRtb3NwaGVyZUxheWVyIiwiYWx0aXR1ZGUiLCJlbWl0dGVkV2F2ZSIsInJlbW92ZSIsInNldEF0dGVudWF0aW9uIiwic291cmNlV2F2ZUludGVuc2l0eUF0SW50ZXJhY3Rpb24iLCJnZXRJbnRlbnNpdHlBdEFsdGl0dWRlIiwiZW1pdHRlZFdhdmVJbnRlbnNpdHkiLCJzZXRJbnRlbnNpdHlBdFN0YXJ0Iiwid2F2ZXNGcm9tVGhlR3JvdW5kIiwiaXNJbmZyYXJlZCIsIndhdmVGcm9tVGhlR3JvdW5kIiwiaGFzQWN0aXZlSW50ZXJhY3Rpb24iLCJyZWR1Y2UiLCJmb3VuZCIsInNldFN0YXJ0IiwiZ2V0RW5kUG9pbnQiLCJzZXRFbmQiLCJ4UmFuZ2UiLCJsYXllciIsImVuZXJneUFic29ycHRpb25Qcm9wb3J0aW9uUHJvcGVydHkiLCJzZXRYWSIsIm1pbiIsIm1heCIsImludGVyc2VjdGlvbiIsImludGVyc2VjdCIsImFzc2VydCIsIndhdmVTdGFydFRvSW50ZXJzZWN0aW9uTGVuZ3RoIiwic3RhcnQiLCJ3YXZlT3JpZ2luVG9JbnRlcnNlY3Rpb25MZW5ndGgiLCJ3YXZlRnJvbUF0bW9zcGhlcmljSW50ZXJhY3Rpb24iLCJwb2ludCIsInB1c2giLCJncm91bmRMYXllciIsImFsYmVkb1Byb3BlcnR5IiwiUEFSVElBTExZX0dMQUNJQVRFRF9MQU5EX0FMQkVETyIsImluY2x1ZGVzIiwid2F2ZXNIaXR0aW5nVGhlR2xhY2llciIsInJlc2V0IiwibnVtYmVyT2ZXYXZlc0JlZm9yZVJlc2V0IiwiY2xlYXIiLCJzdXJmYWNlVGVtcGVyYXR1cmVWaXNpYmxlUHJvcGVydHkiLCJ0b1N0YXRlT2JqZWN0IiwiRU1XYXZlU291cmNlSU8iLCJhcHBseVN0YXRlIiwic3RhdGVPYmplY3QiLCJmcm9tU3RhdGVPYmplY3QiLCJ2YWx1ZVR5cGUiLCJ3YXZlc01vZGVsIiwic3RhdGVTY2hlbWEiLCJTVEFURV9TQ0hFTUEiLCJjb25jZW50cmF0aW9uIiwicG93IiwiT2JqZWN0SU8iLCJ3YXZlQXRtb3NwaGVyZUludGVyYWN0aW9uIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJXYXZlc01vZGVsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIwLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFdhdmVzTW9kZWwgdXNlcyBhIGxheWVyIG1vZGVsIGZvciBzaW11bGF0aW5nIHRlbXBlcmF0dXJlIGNoYW5nZXMgZHVlIHRvIGNoYW5nZXMgaW4gdGhlIGNvbmNlbnRyYXRpb24gb2YgZ3JlZW5ob3VzZVxyXG4gKiBnYXNlcywgYW5kIGFsc28gY3JlYXRlcyBhbmQgbW92ZXMgbGlnaHQgd2F2ZXMgdGhhdCBpbnRlcmFjdCB3aXRoIHRoZSBncm91bmQgYW5kIGF0bW9zcGhlcmUgaW4gYSB3YXkgdGhhdCBzaW11bGF0ZXNcclxuICogdGhhdCBiZWhhdmlvciBpbiBFYXJ0aCdzIGF0bW9zcGhlcmUuXHJcbiAqXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY28gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IGNyZWF0ZU9ic2VydmFibGVBcnJheSwgeyBPYnNlcnZhYmxlQXJyYXkgfSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL2NyZWF0ZU9ic2VydmFibGVBcnJheS5qcyc7XHJcbmltcG9ydCBFbWl0dGVyIGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRW1pdHRlci5qcyc7XHJcbmltcG9ydCBURW1pdHRlciBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1RFbWl0dGVyLmpzJztcclxuaW1wb3J0IFJhbmdlIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9SYW5nZS5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IHsgTGluZSB9IGZyb20gJy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCB7IGNvbWJpbmVPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBQaGV0aW9Hcm91cCBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvUGhldGlvR3JvdXAuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgSU9UeXBlIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy90eXBlcy9JT1R5cGUuanMnO1xyXG5pbXBvcnQgTWFwSU8sIHsgTWFwU3RhdGVPYmplY3QgfSBmcm9tICcuLi8uLi8uLi8uLi90YW5kZW0vanMvdHlwZXMvTWFwSU8uanMnO1xyXG5pbXBvcnQgUmVmZXJlbmNlSU8sIHsgUmVmZXJlbmNlSU9TdGF0ZSB9IGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy90eXBlcy9SZWZlcmVuY2VJTy5qcyc7XHJcbmltcG9ydCBHcmVlbmhvdXNlRWZmZWN0Q29uc3RhbnRzIGZyb20gJy4uLy4uL2NvbW1vbi9HcmVlbmhvdXNlRWZmZWN0Q29uc3RhbnRzLmpzJztcclxuaW1wb3J0IENvbmNlbnRyYXRpb25Nb2RlbCBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvQ29uY2VudHJhdGlvbk1vZGVsLmpzJztcclxuaW1wb3J0IEVuZXJneUFic29yYmluZ0VtaXR0aW5nTGF5ZXIgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0VuZXJneUFic29yYmluZ0VtaXR0aW5nTGF5ZXIuanMnO1xyXG5pbXBvcnQgR3JvdW5kTGF5ZXIgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0dyb3VuZExheWVyLmpzJztcclxuaW1wb3J0IExheWVyc01vZGVsLCB7IExheWVyc01vZGVsU3RhdGVPYmplY3QgfSBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvTGF5ZXJzTW9kZWwuanMnO1xyXG5pbXBvcnQgZ3JlZW5ob3VzZUVmZmVjdCBmcm9tICcuLi8uLi9ncmVlbmhvdXNlRWZmZWN0LmpzJztcclxuaW1wb3J0IEVNV2F2ZVNvdXJjZSwgeyBFTVdhdmVTb3VyY2VTdGF0ZU9iamVjdCB9IGZyb20gJy4vRU1XYXZlU291cmNlLmpzJztcclxuaW1wb3J0IEdyb3VuZFdhdmVTb3VyY2UgZnJvbSAnLi9Hcm91bmRXYXZlU291cmNlLmpzJztcclxuaW1wb3J0IFN1bldhdmVTb3VyY2UgZnJvbSAnLi9TdW5XYXZlU291cmNlLmpzJztcclxuaW1wb3J0IFdhdmUsIHsgV2F2ZUNyZWF0b3JBcmd1bWVudHMsIFdhdmVPcHRpb25zIH0gZnJvbSAnLi9XYXZlLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBNQVhfQVRNT1NQSEVSSUNfSU5URVJBQ1RJT05fUFJPUE9SVElPTiA9IDAuNzU7IC8vIG1heCBwcm9wb3J0aW9uIG9mIElSIHdhdmUgdGhhdCBjYW4gZ28gYmFjayB0byBFYXJ0aFxyXG5jb25zdCBUV09fUEkgPSBNYXRoLlBJICogMjtcclxuXHJcbi8vIFdhdmVsZW5ndGggdmFsdWVzIHVzZWQgd2hlbiBkZXBpY3RpbmcgdGhlIHdhdmVzLCBpbiBtZXRlcnMuICBGYXIgZnJvbSByZWFsIGxpZmUuICBDYW4gYmUgYWRqdXN0ZWQgZm9yIGRlc2lyZWQgbG9vay5cclxuY29uc3QgUkVBTF9UT19SRU5ERVJJTkdfV0FWRUxFTkdUSF9NQVAgPSBuZXcgTWFwKCBbXHJcbiAgWyBHcmVlbmhvdXNlRWZmZWN0Q29uc3RhbnRzLlZJU0lCTEVfV0FWRUxFTkdUSCwgODAwMCBdLFxyXG4gIFsgR3JlZW5ob3VzZUVmZmVjdENvbnN0YW50cy5JTkZSQVJFRF9XQVZFTEVOR1RILCAxMjAwMCBdXHJcbl0gKTtcclxuXHJcbmNvbnN0IFdBVkVfQU1QTElUVURFX0ZPUl9SRU5ERVJJTkcgPSAyMDAwO1xyXG5cclxuY2xhc3MgV2F2ZXNNb2RlbCBleHRlbmRzIENvbmNlbnRyYXRpb25Nb2RlbCB7XHJcbiAgcHVibGljIHJlYWRvbmx5IHdhdmVHcm91cDogUGhldGlvR3JvdXA8V2F2ZSwgV2F2ZUNyZWF0b3JBcmd1bWVudHM+O1xyXG4gIHB1YmxpYyByZWFkb25seSB3YXZlc0NoYW5nZWRFbWl0dGVyOiBURW1pdHRlcjtcclxuICBwcml2YXRlIHJlYWRvbmx5IHN1bldhdmVTb3VyY2U6IFN1bldhdmVTb3VyY2U7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBncm91bmRXYXZlU291cmNlOiBHcm91bmRXYXZlU291cmNlO1xyXG4gIHByaXZhdGUgY2xvdWRSZWZsZWN0ZWRXYXZlc01hcDogTWFwPFdhdmUsIFdhdmU+O1xyXG4gIHByaXZhdGUgZ2xhY2llclJlZmxlY3RlZFdhdmVzTWFwOiBNYXA8V2F2ZSwgV2F2ZT47XHJcbiAgcHJpdmF0ZSByZWFkb25seSBhdG1vc3BoZXJlTGF5ZXJUb1hSYW5nZU1hcDogTWFwPEVuZXJneUFic29yYmluZ0VtaXR0aW5nTGF5ZXIsIFJhbmdlPjtcclxuICBwdWJsaWMgcmVhZG9ubHkgd2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbnM6IE9ic2VydmFibGVBcnJheTxXYXZlQXRtb3NwaGVyZUludGVyYWN0aW9uPjtcclxuICBwcml2YXRlIHJlYWRvbmx5IHdhdmVMaW5lU3RhcnQ6IFZlY3RvcjI7XHJcbiAgcHJpdmF0ZSByZWFkb25seSB3YXZlTGluZUVuZDogVmVjdG9yMjtcclxuICBwcml2YXRlIHJlYWRvbmx5IHdhdmVMaW5lOiBMaW5lO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgYXRtb3NwaGVyZUxpbmVTdGFydDogVmVjdG9yMjtcclxuICBwcml2YXRlIHJlYWRvbmx5IGF0bW9zcGhlcmVMaW5lRW5kOiBWZWN0b3IyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgYXRtb3NwaGVyZUxpbmU6IExpbmU7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggdGFuZGVtOiBUYW5kZW0gKSB7XHJcbiAgICBzdXBlciggdGFuZGVtLCB7XHJcblxyXG4gICAgICAvLyBwaGV0LWlvXHJcbiAgICAgIHBoZXRpb1R5cGU6IFdhdmVzTW9kZWwuV2F2ZXNNb2RlbElPLFxyXG4gICAgICBwaGV0aW9TdGF0ZTogdHJ1ZVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIChyZWFkLW9ubHkpIHtQaGV0aW9Hcm91cC48V2F2ZT59IC0gdGhlIHdhdmVzIHRoYXQgYXJlIGN1cnJlbnRseSBhY3RpdmUgaW4gdGhlIG1vZGVsXHJcbiAgICB0aGlzLndhdmVHcm91cCA9IG5ldyBQaGV0aW9Hcm91cChcclxuICAgICAgKCB0YW5kZW0sIHdhdmVsZW5ndGgsIG9yaWdpbiwgcHJvcGFnYXRpb25EaXJlY3Rpb24sIHByb3BhZ2F0aW9uTGltaXQsIHByb3ZpZGVkT3B0aW9ucyApID0+IHtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0gY29tYmluZU9wdGlvbnM8V2F2ZU9wdGlvbnM+KCB7IHRhbmRlbTogdGFuZGVtIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG4gICAgICAgIHJldHVybiBuZXcgV2F2ZSggd2F2ZWxlbmd0aCwgb3JpZ2luLCBwcm9wYWdhdGlvbkRpcmVjdGlvbiwgcHJvcGFnYXRpb25MaW1pdCwgb3B0aW9ucyApO1xyXG4gICAgICB9LFxyXG4gICAgICBbXHJcbiAgICAgICAgR3JlZW5ob3VzZUVmZmVjdENvbnN0YW50cy5JTkZSQVJFRF9XQVZFTEVOR1RILFxyXG4gICAgICAgIFZlY3RvcjIuWkVSTyxcclxuICAgICAgICBHcmVlbmhvdXNlRWZmZWN0Q29uc3RhbnRzLlNUUkFJR0hUX1VQX05PUk1BTElaRURfVkVDVE9SLFxyXG4gICAgICAgIExheWVyc01vZGVsLkhFSUdIVF9PRl9BVE1PU1BIRVJFLFxyXG4gICAgICAgIHt9XHJcbiAgICAgIF0sXHJcbiAgICAgIHtcclxuICAgICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICd3YXZlR3JvdXAnICksXHJcbiAgICAgICAgcGhldGlvVHlwZTogUGhldGlvR3JvdXAuUGhldGlvR3JvdXBJTyggV2F2ZS5XYXZlSU8gKVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIHNpZ25hbHMgd2hlbiB0aGUgd2F2ZXMgaGF2ZSBjaGFuZ2VkIHNvIHRoYXQgdGhlIHZpZXcgY2FuIHVwZGF0ZSB0aGVtXHJcbiAgICB0aGlzLndhdmVzQ2hhbmdlZEVtaXR0ZXIgPSBuZXcgRW1pdHRlcigpO1xyXG5cclxuICAgIC8vIHRoZSBzb3VyY2Ugb2YgdGhlIHdhdmVzIG9mIHZpc2libGUgbGlnaHQgdGhhdCBjb21lIGZyb20gdGhlIHN1blxyXG4gICAgdGhpcy5zdW5XYXZlU291cmNlID0gbmV3IFN1bldhdmVTb3VyY2UoXHJcbiAgICAgIHRoaXMud2F2ZUdyb3VwLFxyXG4gICAgICB0aGlzLnN1bkVuZXJneVNvdXJjZS5pc1NoaW5pbmdQcm9wZXJ0eSxcclxuICAgICAgTGF5ZXJzTW9kZWwuSEVJR0hUX09GX0FUTU9TUEhFUkUsXHJcbiAgICAgIDAsXHJcbiAgICAgIHsgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnc3VuV2F2ZVNvdXJjZScgKSB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIHRoZSBzb3VyY2Ugb2YgdGhlIHdhdmVzIG9mIGluZnJhcmVkIGxpZ2h0IChpLmUuIHRoZSBvbmVzIHRoYXQgY29tZSBmcm9tIHRoZSBncm91bmQpXHJcbiAgICB0aGlzLmdyb3VuZFdhdmVTb3VyY2UgPSBuZXcgR3JvdW5kV2F2ZVNvdXJjZShcclxuICAgICAgdGhpcy53YXZlR3JvdXAsXHJcbiAgICAgIDAsXHJcbiAgICAgIExheWVyc01vZGVsLkhFSUdIVF9PRl9BVE1PU1BIRVJFLFxyXG4gICAgICB0aGlzLnN1cmZhY2VUZW1wZXJhdHVyZUtlbHZpblByb3BlcnR5LFxyXG4gICAgICB7IHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2dyb3VuZFdhdmVTb3VyY2UnICkgfVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBtYXAgb2Ygd2F2ZXMgZnJvbSB0aGUgc3VuIHRvIHdhdmVzIHJlZmxlY3RlZCBvZmYgb2YgY2xvdWRzXHJcbiAgICB0aGlzLmNsb3VkUmVmbGVjdGVkV2F2ZXNNYXAgPSBuZXcgTWFwPFdhdmUsIFdhdmU+KCk7XHJcblxyXG4gICAgLy8gbWFwIG9mIHdhdmVzIGZyb20gdGhlIHN1biB0byB3YXZlcyByZWZsZWN0ZWQgb2ZmIG9mIHRoZSBnbGFjaWVyXHJcbiAgICB0aGlzLmdsYWNpZXJSZWZsZWN0ZWRXYXZlc01hcCA9IG5ldyBNYXA8V2F2ZSwgV2F2ZT4oKTtcclxuXHJcbiAgICAvLyBBIE1hcCBjb250YWluaW5nIGF0bW9zcGhlcmljIGxheWVycyBhbmQgcmFuZ2VzIHRoYXQgZGVmaW5lIHRoZSB4IGNvb3JkaW5hdGUgd2l0aGluIHdoaWNoIElSIHdhdmVzIHNob3VsZFxyXG4gICAgLy8gaW50ZXJhY3Qgd2l0aCB0aGF0IGxheWVyLlxyXG4gICAgdGhpcy5hdG1vc3BoZXJlTGF5ZXJUb1hSYW5nZU1hcCA9IG5ldyBNYXAoXHJcbiAgICAgIFtcclxuICAgICAgICAvLyBsZWZ0bW9zdCBpbnRlcmFjdGlvbiBhcmVhXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgdGhpcy5hdG1vc3BoZXJlTGF5ZXJzWyA0IF0sXHJcbiAgICAgICAgICBuZXcgUmFuZ2UoIC1MYXllcnNNb2RlbC5TVU5MSUdIVF9TUEFOLndpZHRoIC8gMiwgLUxheWVyc01vZGVsLlNVTkxJR0hUX1NQQU4ud2lkdGggLyA0IClcclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICAvLyBjZW50cmFsIGludGVyYWN0aW9uIGFyZWFcclxuICAgICAgICBbXHJcbiAgICAgICAgICB0aGlzLmF0bW9zcGhlcmVMYXllcnNbIDYgXSxcclxuICAgICAgICAgIG5ldyBSYW5nZSggLUxheWVyc01vZGVsLlNVTkxJR0hUX1NQQU4ud2lkdGggLyA0LCBMYXllcnNNb2RlbC5TVU5MSUdIVF9TUEFOLndpZHRoIC8gNCApXHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgLy8gcmlnaHRtb3N0IGludGVyYWN0aW9uIGFyZWFcclxuICAgICAgICBbXHJcbiAgICAgICAgICB0aGlzLmF0bW9zcGhlcmVMYXllcnNbIDMgXSxcclxuICAgICAgICAgIG5ldyBSYW5nZSggTGF5ZXJzTW9kZWwuU1VOTElHSFRfU1BBTi53aWR0aCAqIDAuMjUsIExheWVyc01vZGVsLlNVTkxJR0hUX1NQQU4ud2lkdGggKVxyXG4gICAgICAgIF1cclxuICAgICAgXVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyAocmVhZC1vbmx5KSB7T2JzZXJ2YWJsZUFycmF5RGVmLjxXYXZlQXRtb3NwaGVyZUludGVyYWN0aW9uPn0gLSBBbiBhcnJheSBvZiB0aGUgaW50ZXJhY3Rpb25zIHRoYXQgYXJlXHJcbiAgICAvLyBjdXJyZW50bHkgb2NjdXJyaW5nIGJldHdlZW4gSVIgd2F2ZXMgYW5kIHRoZSBhdG1vc3BoZXJlLlxyXG4gICAgdGhpcy53YXZlQXRtb3NwaGVyZUludGVyYWN0aW9ucyA9IGNyZWF0ZU9ic2VydmFibGVBcnJheSgge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICd3YXZlQXRtb3NwaGVyZUludGVyYWN0aW9ucycgKSxcclxuICAgICAgcGhldGlvVHlwZTogY3JlYXRlT2JzZXJ2YWJsZUFycmF5Lk9ic2VydmFibGVBcnJheUlPKCBXYXZlQXRtb3NwaGVyZUludGVyYWN0aW9uLldhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25JTyApLFxyXG4gICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnSW50ZXJhY3Rpb25zIGJldHdlZW4gSVIgd2F2ZXMgY29taW5nIGZyb20gdGhlIGdyb3VuZCBhbmQgdGhlIGF0bW9zcGhlcmUnXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gUHJlLWFsbG9jYXRlZCB2ZWN0b3JzIGFuZCBsaW5lcyB1c2VkIGZvciB0ZXN0aW5nIHdoZXRoZXIgd2F2ZXMgYXJlIGNyb3NzaW5nIHRocm91Z2ggaW50ZXJhY3RpdmUgYXJlYXMgb2YgdGhlXHJcbiAgICAvLyBhdG1vc3BoZXJlLCByZXVzZWQgYnkgbWV0aG9kcyBpbiBvcmRlciB0byByZWR1Y2UgbWVtb3J5IGFsbG9jYXRpb25zLlxyXG4gICAgdGhpcy53YXZlTGluZVN0YXJ0ID0gbmV3IFZlY3RvcjIoIDAsIDAgKTtcclxuICAgIHRoaXMud2F2ZUxpbmVFbmQgPSBuZXcgVmVjdG9yMiggMCwgMSApO1xyXG4gICAgdGhpcy53YXZlTGluZSA9IG5ldyBMaW5lKCB0aGlzLndhdmVMaW5lU3RhcnQsIHRoaXMud2F2ZUxpbmVFbmQgKTtcclxuICAgIHRoaXMuYXRtb3NwaGVyZUxpbmVTdGFydCA9IG5ldyBWZWN0b3IyKCAwLCAwICk7XHJcbiAgICB0aGlzLmF0bW9zcGhlcmVMaW5lRW5kID0gbmV3IFZlY3RvcjIoIDAsIDEgKTtcclxuICAgIHRoaXMuYXRtb3NwaGVyZUxpbmUgPSBuZXcgTGluZSggdGhpcy5hdG1vc3BoZXJlTGluZVN0YXJ0LCB0aGlzLmF0bW9zcGhlcmVMaW5lRW5kICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdGVwIHRoZSBtb2RlbCBmb3J3YXJkIGJ5IHRoZSBwcm92aWRlZCB0aW1lLlxyXG4gICAqIEBwYXJhbSBkdCAtIGRlbHRhIHRpbWUsIGluIHNlY29uZHNcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgc3RlcE1vZGVsKCBkdDogbnVtYmVyICk6IHZvaWQge1xyXG4gICAgY29uc3QgbnVtYmVyT2ZXYXZlc0F0U3RhcnRPZlN0ZXAgPSB0aGlzLndhdmVHcm91cC5jb3VudDtcclxuICAgIHN1cGVyLnN0ZXBNb2RlbCggZHQgKTtcclxuICAgIHRoaXMuc3VuV2F2ZVNvdXJjZS5zdGVwKCBkdCApO1xyXG4gICAgdGhpcy5ncm91bmRXYXZlU291cmNlLnN0ZXAoIGR0ICk7XHJcbiAgICB0aGlzLndhdmVHcm91cC5mb3JFYWNoKCB3YXZlID0+IHdhdmUuc3RlcCggZHQgKSApO1xyXG4gICAgdGhpcy51cGRhdGVXYXZlQ2xvdWRJbnRlcmFjdGlvbnMoKTtcclxuICAgIHRoaXMudXBkYXRlV2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbnMoKTtcclxuICAgIHRoaXMudXBkYXRlV2F2ZUdsYWNpZXJJbnRlcmFjdGlvbnMoKTtcclxuXHJcbiAgICAvLyBSZW1vdmUgYW55IHdhdmVzIHRoYXQgaGF2ZSBmaW5pc2hlZCBwcm9wYWdhdGluZy5cclxuICAgIHRoaXMud2F2ZUdyb3VwLmZpbHRlciggd2F2ZSA9PiB3YXZlLmlzQ29tcGxldGVseVByb3BhZ2F0ZWQgKS5mb3JFYWNoKCB3YXZlID0+IHtcclxuICAgICAgdGhpcy53YXZlR3JvdXAuZGlzcG9zZUVsZW1lbnQoIHdhdmUgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBFbWl0IGEgbm90aWZpY2F0aW9uIGlmIGFueXRoaW5nIGhhcyBjaGFuZ2VkIGFib3V0IHRoZSB3YXZlcyBkdXJpbmcgdGhpcyBzdGVwIHNvIHRoYXQgdGhlIHZpZXcgY2FuIGJlIHVwZGF0ZWQuXHJcbiAgICBpZiAoIHRoaXMud2F2ZUdyb3VwLmNvdW50ID4gMCB8fCBudW1iZXJPZldhdmVzQXRTdGFydE9mU3RlcCA+IDAgKSB7XHJcbiAgICAgIHRoaXMud2F2ZXNDaGFuZ2VkRW1pdHRlci5lbWl0KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgdGhlIGludGVyYWN0aW9ucyBiZXR3ZWVuIGxpZ2h0IHdhdmVzIGFuZCB0aGUgY2xvdWQuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB1cGRhdGVXYXZlQ2xvdWRJbnRlcmFjdGlvbnMoKTogdm9pZCB7XHJcblxyXG4gICAgaWYgKCB0aGlzLmNsb3VkICkge1xyXG5cclxuICAgICAgY29uc3QgY2xvdWQgPSB0aGlzLmNsb3VkOyAvLyBjb252ZW5pZW5jZSB2YXJcclxuXHJcbiAgICAgIC8vIFRoZSByZWZsZWN0aXZpdHkgdmFsdWUgdXNlZCB2aXN1YWxseSBpcyBOT1QgdGhlIGFjdHVhbCB2YWx1ZSB1c2VkIGluIHRoZSBjbG91ZCBtb2RlbC4gIFRoaXMgaXMgYmVjYXVzZSB0aGUgYWN0dWFsXHJcbiAgICAgIC8vIHZhbHVlIGRpZG4ndCBwcm9kdWNlIGVub3VnaCBvZiBhIHZpc2libGUgd2F2ZS4gIEluIG90aGVyIHdvcmRzLCB0aGlzIHZhbHVlIGlzIFwiSG9sbHl3b29kZWRcIiB0byBnZXQgdGhlIGxvb2sgd2VcclxuICAgICAgLy8gd2FudGVkLiAgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9ncmVlbmhvdXNlLWVmZmVjdC9pc3N1ZXMvODIuXHJcbiAgICAgIGNvbnN0IHZpc3VhbENsb3VkUmVmbGVjdGl2aXR5ID0gMC41O1xyXG5cclxuICAgICAgLy8gU2VlIGlmIGFueSBvZiB0aGUgY3VycmVudGx5IHJlZmxlY3RlZCB3YXZlcyBzaG91bGQgc3RvcCByZWZsZWN0aW5nLlxyXG4gICAgICB0aGlzLmNsb3VkUmVmbGVjdGVkV2F2ZXNNYXAuZm9yRWFjaCggKCByZWZsZWN0ZWRXYXZlLCBzb3VyY2VXYXZlICkgPT4ge1xyXG4gICAgICAgIGlmICggIWNsb3VkLmVuYWJsZWRQcm9wZXJ0eS52YWx1ZSB8fCBzb3VyY2VXYXZlLnN0YXJ0UG9pbnQueSA8IGNsb3VkLnBvc2l0aW9uLnkgKSB7XHJcblxyXG4gICAgICAgICAgLy8gRWl0aGVyIHRoZSBjbG91ZCBoYXMgZGlzYXBwZWFyZWQgb3IgdGhlIHdhdmUgZnJvbSB0aGUgc3VuIHRoYXQgd2FzIGJlaW5nIHJlZmxlY3RlZCBoYXMgZ29uZSBhbGwgdGhlIHdheVxyXG4gICAgICAgICAgLy8gdGhyb3VnaCB0aGUgY2xvdWQuICBJbiBlaXRoZXIgY2FzZSwgaXQncyB0aW1lIHRvIHN0b3AgcmVmbGVjdGluZyB0aGUgd2F2ZS5cclxuICAgICAgICAgIHJlZmxlY3RlZFdhdmUuaXNTb3VyY2VkID0gZmFsc2U7XHJcbiAgICAgICAgICB0aGlzLmNsb3VkUmVmbGVjdGVkV2F2ZXNNYXAuZGVsZXRlKCBzb3VyY2VXYXZlICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9ICk7XHJcblxyXG4gICAgICBpZiAoIGNsb3VkLmVuYWJsZWRQcm9wZXJ0eS52YWx1ZSApIHtcclxuXHJcbiAgICAgICAgLy8gTWFrZSBhIGxpc3Qgb2Ygd2F2ZXMgdGhhdCBvcmlnaW5hdGVkIGZyb20gdGhlIHN1biBhbmQgYXJlIGN1cnJlbnRseSBwYXNzaW5nIHRocm91Z2ggdGhlIGNsb3VkLlxyXG4gICAgICAgIGNvbnN0IHdhdmVzQ3Jvc3NpbmdUaGVDbG91ZCA9IHRoaXMud2F2ZUdyb3VwLmZpbHRlciggd2F2ZSA9PlxyXG4gICAgICAgICAgd2F2ZS5pc1Zpc2libGUgJiZcclxuICAgICAgICAgIHdhdmUub3JpZ2luLnkgPT09IHRoaXMuc3VuV2F2ZVNvdXJjZS53YXZlU3RhcnRBbHRpdHVkZSAmJlxyXG4gICAgICAgICAgd2F2ZS5wcm9wYWdhdGlvbkRpcmVjdGlvbi55IDwgMCAmJlxyXG4gICAgICAgICAgd2F2ZS5zdGFydFBvaW50LnkgPiBjbG91ZC5wb3NpdGlvbi55ICYmXHJcbiAgICAgICAgICB3YXZlLnN0YXJ0UG9pbnQueSAtIHdhdmUubGVuZ3RoIDwgY2xvdWQucG9zaXRpb24ueSAmJlxyXG4gICAgICAgICAgd2F2ZS5zdGFydFBvaW50LnggPiBjbG91ZC5wb3NpdGlvbi54IC0gY2xvdWQud2lkdGggLyAyICYmXHJcbiAgICAgICAgICB3YXZlLnN0YXJ0UG9pbnQueCA8IGNsb3VkLnBvc2l0aW9uLnggKyBjbG91ZC53aWR0aCAvIDJcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiByZWZsZWN0ZWQgd2F2ZXMgYW5kIGF0dGVudWF0b3JzIGFyZSBpbiBwbGFjZSBmb3IgdGhpcyBjbG91ZCBhbmQsIGlmIG5vdCwgYWRkIHRoZW0uXHJcbiAgICAgICAgd2F2ZXNDcm9zc2luZ1RoZUNsb3VkLmZvckVhY2goIGluY2lkZW50V2F2ZSA9PiB7XHJcblxyXG4gICAgICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gcmVmbGVjdGVkIHdhdmUgZm9yIHRoaXMgaW5jaWRlbnQgd2F2ZSwgY3JlYXRlIG9uZS5cclxuICAgICAgICAgIGlmICggIXRoaXMuY2xvdWRSZWZsZWN0ZWRXYXZlc01hcC5oYXMoIGluY2lkZW50V2F2ZSApICkge1xyXG4gICAgICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBpbmNpZGVudFdhdmUub3JpZ2luLnggPiBjbG91ZC5wb3NpdGlvbi54ID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR3JlZW5ob3VzZUVmZmVjdENvbnN0YW50cy5TVFJBSUdIVF9VUF9OT1JNQUxJWkVEX1ZFQ1RPUi5yb3RhdGVkKCAtTWF0aC5QSSAqIDAuMSApIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR3JlZW5ob3VzZUVmZmVjdENvbnN0YW50cy5TVFJBSUdIVF9VUF9OT1JNQUxJWkVEX1ZFQ1RPUi5yb3RhdGVkKCBNYXRoLlBJICogMC4xICk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlZmxlY3RlZFdhdmUgPSB0aGlzLndhdmVHcm91cC5jcmVhdGVOZXh0RWxlbWVudChcclxuICAgICAgICAgICAgICBpbmNpZGVudFdhdmUud2F2ZWxlbmd0aCxcclxuICAgICAgICAgICAgICBuZXcgVmVjdG9yMiggaW5jaWRlbnRXYXZlLm9yaWdpbi54LCBjbG91ZC5wb3NpdGlvbi55ICksXHJcbiAgICAgICAgICAgICAgZGlyZWN0aW9uLFxyXG4gICAgICAgICAgICAgIExheWVyc01vZGVsLkhFSUdIVF9PRl9BVE1PU1BIRVJFLCB7XHJcbiAgICAgICAgICAgICAgICBpbnRlbnNpdHlBdFN0YXJ0OiBpbmNpZGVudFdhdmUuaW50ZW5zaXR5QXRTdGFydCAqIHZpc3VhbENsb3VkUmVmbGVjdGl2aXR5LFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbFBoYXNlT2Zmc2V0OiAoIGluY2lkZW50V2F2ZS5nZXRQaGFzZUF0KCBpbmNpZGVudFdhdmUub3JpZ2luLnkgLSBjbG91ZC5wb3NpdGlvbi55ICkgKyBNYXRoLlBJICkgJVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIDIgKiBNYXRoLlBJIClcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvdWRSZWZsZWN0ZWRXYXZlc01hcC5zZXQoIGluY2lkZW50V2F2ZSwgcmVmbGVjdGVkV2F2ZSApO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIElmIHRoZXJlIGlzIG5vIGF0dGVudWF0aW9uIG9mIHRoaXMgd2F2ZSBhcyBpdCBwYXNzZXMgdGhyb3VnaCB0aGUgY2xvdWQsIGNyZWF0ZSBpdC5cclxuICAgICAgICAgIGlmICggIWluY2lkZW50V2F2ZS5oYXNBdHRlbnVhdG9yKCBjbG91ZCApICkge1xyXG4gICAgICAgICAgICBpbmNpZGVudFdhdmUuYWRkQXR0ZW51YXRvcihcclxuICAgICAgICAgICAgICBpbmNpZGVudFdhdmUuc3RhcnRQb2ludC55IC0gY2xvdWQucG9zaXRpb24ueSxcclxuICAgICAgICAgICAgICB2aXN1YWxDbG91ZFJlZmxlY3Rpdml0eSxcclxuICAgICAgICAgICAgICBjbG91ZFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgLy8gVGhlIGNsb3VkIGlzIG5vdCBlbmFibGVkLCBzbyBpZiB0aGVyZSBhcmUgYW55IHdhdmVzIHRoYXQgd2VyZSBiZWluZyBhdHRlbnVhdGVkIGJlY2F1c2Ugb2YgdGhlIGNsb3VkLCBzdG9wIHRoYXRcclxuICAgICAgICAvLyBmcm9tIGhhcHBlbmluZy5cclxuICAgICAgICB0aGlzLndhdmVHcm91cC5mb3JFYWNoKCB3YXZlID0+IHtcclxuICAgICAgICAgIGlmICggd2F2ZS5oYXNBdHRlbnVhdG9yKCBjbG91ZCApICkge1xyXG4gICAgICAgICAgICB3YXZlLnJlbW92ZUF0dGVudWF0b3IoIGNsb3VkICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgdGhlIGludGVyYWN0aW9ucyBiZXR3ZWVuIElSIHdhdmVzIGFuZCB0aGUgYXRtb3NwaGVyZS5cclxuICAgKi9cclxuICBwcml2YXRlIHVwZGF0ZVdhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25zKCk6IHZvaWQge1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBob3cgbXVjaCBvZiBlYWNoIHdhdmUgc2hvdWxkIGdvIGJhY2sgdG93YXJkcyB0aGUgRWFydGggYW5kIGhvdyBtdWNoIHNob3VsZCBjb250aW51ZSBvbiBpdHMgd2F5IGdpdmVuXHJcbiAgICAvLyB0aGUgY3VycmVudCBjb25jZW50cmF0aW9uIG9mIGdyZWVuaG91c2UgZ2FzZXMuXHJcbiAgICBjb25zdCBpcldhdmVBdHRlbnVhdGlvbiA9IG1hcEdhc0NvbmNlbnRyYXRpb25Ub0F0dGVudWF0aW9uKCB0aGlzLmNvbmNlbnRyYXRpb25Qcm9wZXJ0eS52YWx1ZSApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgZXhpc3RpbmcgaW50ZXJhY3Rpb25zIGJldHdlZW4gdGhlIGxpZ2h0IHdhdmVzIGFuZCB0aGUgYXRtb3NwaGVyZS5cclxuICAgIHRoaXMud2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbnMuZm9yRWFjaCggaW50ZXJhY3Rpb24gPT4ge1xyXG5cclxuICAgICAgLy8gSWYgdGhlIGdhcyBjb25jZW50cmF0aW9uIGhhcyBnb25lIHRvIHplcm8gb3IgdGhlIHNvdXJjZSB3YXZlIGhhdmUgbW92ZWQgYWxsIHRoZSB3YXkgdGhyb3VnaCB0aGlzIGludGVyYWN0aW9uXHJcbiAgICAgIC8vIGxvY2F0aW9uLCB0aGUgaW50ZXJhY3Rpb24gc2hvdWxkIGVuZC5cclxuICAgICAgaWYgKCB0aGlzLmNvbmNlbnRyYXRpb25Qcm9wZXJ0eS52YWx1ZSA9PT0gMCB8fFxyXG4gICAgICAgICAgIGludGVyYWN0aW9uLnNvdXJjZVdhdmUuc3RhcnRQb2ludC55ID4gaW50ZXJhY3Rpb24uYXRtb3NwaGVyZUxheWVyLmFsdGl0dWRlICkge1xyXG5cclxuICAgICAgICAvLyBGcmVlIHRoZSB3YXZlIHRoYXQgd2FzIGJlaW5nIGVtaXR0ZWQgdG8gcHJvcGFnYXRlIG9uIGl0cyBvd24uXHJcbiAgICAgICAgaW50ZXJhY3Rpb24uZW1pdHRlZFdhdmUuaXNTb3VyY2VkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgYXR0ZW51YXRvciB0aGF0IHdhcyBhc3NvY2lhdGVkIHdpdGggdGhpcyBpbnRlcmFjdGlvbiBmcm9tIHRoZSB3YXZlIChpZiBpdCBoYXNuJ3QgaGFwcGVuZWRcclxuICAgICAgICAvLyBhdXRvbWF0aWNhbGx5IHlldCkuXHJcbiAgICAgICAgaWYgKCBpbnRlcmFjdGlvbi5zb3VyY2VXYXZlLmhhc0F0dGVudWF0b3IoIGludGVyYWN0aW9uLmF0bW9zcGhlcmVMYXllciApICkge1xyXG4gICAgICAgICAgaW50ZXJhY3Rpb24uc291cmNlV2F2ZS5yZW1vdmVBdHRlbnVhdG9yKCBpbnRlcmFjdGlvbi5hdG1vc3BoZXJlTGF5ZXIgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFJlbW92ZSB0aGlzIGludGVyYWN0aW9uIGZyb20gb3VyIGxpc3QuXHJcbiAgICAgICAgdGhpcy53YXZlQXRtb3NwaGVyZUludGVyYWN0aW9ucy5yZW1vdmUoIGludGVyYWN0aW9uICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgYXR0ZW51YXRpb24gb24gdGhlIHNvdXJjZSB3YXZlIGlzIGNvcnJlY3QuXHJcbiAgICAgICAgaW50ZXJhY3Rpb24uc291cmNlV2F2ZS5zZXRBdHRlbnVhdGlvbiggaW50ZXJhY3Rpb24uYXRtb3NwaGVyZUxheWVyLCBpcldhdmVBdHRlbnVhdGlvbiApO1xyXG5cclxuICAgICAgICAvLyBTZXQgdGhlIGludGVuc2l0eSBvZiB0aGUgZW1pdHRlZCB3YXZlLlxyXG4gICAgICAgIGNvbnN0IHNvdXJjZVdhdmVJbnRlbnNpdHlBdEludGVyYWN0aW9uID1cclxuICAgICAgICAgIGludGVyYWN0aW9uLnNvdXJjZVdhdmUuZ2V0SW50ZW5zaXR5QXRBbHRpdHVkZSggaW50ZXJhY3Rpb24uYXRtb3NwaGVyZUxheWVyLmFsdGl0dWRlICk7XHJcbiAgICAgICAgY29uc3QgZW1pdHRlZFdhdmVJbnRlbnNpdHkgPSBzb3VyY2VXYXZlSW50ZW5zaXR5QXRJbnRlcmFjdGlvbiAqIGlyV2F2ZUF0dGVudWF0aW9uO1xyXG4gICAgICAgIGlmICggaW50ZXJhY3Rpb24uZW1pdHRlZFdhdmUuaW50ZW5zaXR5QXRTdGFydCAhPT0gZW1pdHRlZFdhdmVJbnRlbnNpdHkgKSB7XHJcbiAgICAgICAgICBpbnRlcmFjdGlvbi5lbWl0dGVkV2F2ZS5zZXRJbnRlbnNpdHlBdFN0YXJ0KCBlbWl0dGVkV2F2ZUludGVuc2l0eSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIE1ha2UgYSBsaXN0IG9mIGFsbCBJUiB3YXZlcyB0aGF0IGFyZSBjdXJyZW50bHkgZW1hbmF0aW5nIGZyb20gdGhlIGdyb3VuZC5cclxuICAgIGNvbnN0IHdhdmVzRnJvbVRoZUdyb3VuZCA9IHRoaXMud2F2ZUdyb3VwLmZpbHRlciggd2F2ZSA9PiB3YXZlLmlzSW5mcmFyZWQgJiYgd2F2ZS5vcmlnaW4ueSA9PT0gMCApO1xyXG5cclxuICAgIC8vIEZvciBlYWNoIElSIHdhdmUgZnJvbSB0aGUgZ3JvdW5kLCBjaGVjayB0byBzZWUgaWYgdGhlcmUgYXJlIGFueSBpbnRlcmFjdGlvbnMgd2l0aCB0aGUgYXRtb3NwaGVyZSB0aGF0IHNob3VsZFxyXG4gICAgLy8gZXhpc3QgYnV0IGRvbid0IHlldC5cclxuICAgIHdhdmVzRnJvbVRoZUdyb3VuZC5mb3JFYWNoKCB3YXZlRnJvbVRoZUdyb3VuZCA9PiB7XHJcblxyXG4gICAgICBjb25zdCBoYXNBY3RpdmVJbnRlcmFjdGlvbiA9IHRoaXMud2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbnMucmVkdWNlKFxyXG4gICAgICAgICggZm91bmQsIGludGVyYWN0aW9uICkgPT4gZm91bmQgfHwgaW50ZXJhY3Rpb24uc291cmNlV2F2ZSA9PT0gd2F2ZUZyb21UaGVHcm91bmQsXHJcbiAgICAgICAgZmFsc2VcclxuICAgICAgKTtcclxuXHJcbiAgICAgIC8vIElmIHRoZXJlIGlzIGFscmVhZHkgYW4gYXRtb3NwaGVyaWMgaW50ZXJhY3Rpb24gdGhhdCBpcyBkcml2ZW4gYnkgdGhpcyB3YXZlLCBzdG9wIGhlcmUgYW5kIGRvbid0IGNyZWF0ZSBhIG5ld1xyXG4gICAgICAvLyBvbmUuICBUaGlzIGlzIGEgZGVzaWduIGNob2ljZSwgbm90IGEgcGh5c2ljYWwgb25lLiAgSWYgdGhlcmUgaXMgZXZlciBhIG5lZWQgdG8gaGF2ZSBtdWx0aXBsZSBpbnRlcmFjdGlvbnNcclxuICAgICAgLy8gZHJpdmVuIGJ5IHRoZSBzYW1lIHdhdmUsIHRoaXMgd2lsbCBuZWVkIHRvIGNoYW5nZS5cclxuICAgICAgaWYgKCAhaGFzQWN0aXZlSW50ZXJhY3Rpb24gKSB7XHJcblxyXG4gICAgICAgIC8vIEdldCBhIGxpbmUgdGhhdCByZXByZXNlbnRzIHdoZXJlIHRoZSB3YXZlIHN0YXJ0cyBhbmQgZW5kcy4gIFVzZSBwcmUtYWxsb2NhdGVkIGNvbXBvbmVudHMgdG8gcmVkdWNlXHJcbiAgICAgICAgLy8gYWxsb2NhdGlvbnMuXHJcbiAgICAgICAgdGhpcy53YXZlTGluZS5zZXRTdGFydCggd2F2ZUZyb21UaGVHcm91bmQuc3RhcnRQb2ludCApO1xyXG4gICAgICAgIHdhdmVGcm9tVGhlR3JvdW5kLmdldEVuZFBvaW50KCB0aGlzLndhdmVMaW5lRW5kICk7XHJcbiAgICAgICAgdGhpcy53YXZlTGluZS5zZXRFbmQoIHRoaXMud2F2ZUxpbmVFbmQgKTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyB3YXZlIGlzIGNyb3NzaW5nIGFueSBvZiB0aGUgYXRtb3NwaGVyZSBpbnRlcmFjdGlvbiBhcmVhcy5cclxuICAgICAgICB0aGlzLmF0bW9zcGhlcmVMYXllclRvWFJhbmdlTWFwLmZvckVhY2goICggeFJhbmdlLCBsYXllciApID0+IHtcclxuXHJcbiAgICAgICAgICBpZiAoIGxheWVyLmVuZXJneUFic29ycHRpb25Qcm9wb3J0aW9uUHJvcGVydHkudmFsdWUgPiAwICkge1xyXG5cclxuICAgICAgICAgICAgLy8gRXN0YWJsaXNoIHRoZSBsaW5lIGluIHRoZSBhdG1vc3BoZXJlIGFnYWluc3Qgd2hpY2ggdGhlIHdhdmUgaXMgdG8gYmUgdGVzdGVkLlxyXG4gICAgICAgICAgICB0aGlzLmF0bW9zcGhlcmVMaW5lU3RhcnQuc2V0WFkoIHhSYW5nZS5taW4sIGxheWVyLmFsdGl0dWRlICk7XHJcbiAgICAgICAgICAgIHRoaXMuYXRtb3NwaGVyZUxpbmVFbmQuc2V0WFkoIHhSYW5nZS5tYXgsIGxheWVyLmFsdGl0dWRlICk7XHJcbiAgICAgICAgICAgIHRoaXMuYXRtb3NwaGVyZUxpbmUuc2V0U3RhcnQoIHRoaXMuYXRtb3NwaGVyZUxpbmVTdGFydCApO1xyXG4gICAgICAgICAgICB0aGlzLmF0bW9zcGhlcmVMaW5lLnNldEVuZCggdGhpcy5hdG1vc3BoZXJlTGluZUVuZCApO1xyXG5cclxuICAgICAgICAgICAgLy8gU2VlIGlmIHRoZXJlIGlzIGFuIGludGVyc2VjdGlvbiBhbmQgY3JlYXRlIGEgbmV3IHdhdmUgaWYgc28uXHJcbiAgICAgICAgICAgIGNvbnN0IGludGVyc2VjdGlvbiA9IExpbmUuaW50ZXJzZWN0KCB0aGlzLndhdmVMaW5lLCB0aGlzLmF0bW9zcGhlcmVMaW5lICk7XHJcbiAgICAgICAgICAgIGlmICggaW50ZXJzZWN0aW9uLmxlbmd0aCA+IDAgKSB7XHJcblxyXG4gICAgICAgICAgICAgIGFzc2VydCAmJiBhc3NlcnQoIGludGVyc2VjdGlvbi5sZW5ndGggPT09IDEsICdtdWx0aXBsZSBpbnRlcnNlY3Rpb25zIGFyZSBub3QgZXhwZWN0ZWQnICk7XHJcblxyXG4gICAgICAgICAgICAgIGNvbnN0IHdhdmVTdGFydFRvSW50ZXJzZWN0aW9uTGVuZ3RoID0gKCB0aGlzLmF0bW9zcGhlcmVMaW5lLnN0YXJ0LnkgLSB3YXZlRnJvbVRoZUdyb3VuZC5zdGFydFBvaW50LnkgKSAvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXZlRnJvbVRoZUdyb3VuZC5wcm9wYWdhdGlvbkRpcmVjdGlvbi55O1xyXG4gICAgICAgICAgICAgIGNvbnN0IHdhdmVPcmlnaW5Ub0ludGVyc2VjdGlvbkxlbmd0aCA9ICggdGhpcy5hdG1vc3BoZXJlTGluZS5zdGFydC55IC0gd2F2ZUZyb21UaGVHcm91bmQub3JpZ2luLnkgKSAvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F2ZUZyb21UaGVHcm91bmQucHJvcGFnYXRpb25EaXJlY3Rpb24ueTtcclxuXHJcbiAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBuZXcgZW1pdHRlZCB3YXZlLlxyXG4gICAgICAgICAgICAgIGNvbnN0IHdhdmVGcm9tQXRtb3NwaGVyaWNJbnRlcmFjdGlvbiA9IHRoaXMud2F2ZUdyb3VwLmNyZWF0ZU5leHRFbGVtZW50KFxyXG4gICAgICAgICAgICAgICAgd2F2ZUZyb21UaGVHcm91bmQud2F2ZWxlbmd0aCxcclxuICAgICAgICAgICAgICAgIGludGVyc2VjdGlvblsgMCBdLnBvaW50LFxyXG4gICAgICAgICAgICAgICAgbmV3IFZlY3RvcjIoIHdhdmVGcm9tVGhlR3JvdW5kLnByb3BhZ2F0aW9uRGlyZWN0aW9uLngsIC13YXZlRnJvbVRoZUdyb3VuZC5wcm9wYWdhdGlvbkRpcmVjdGlvbi55ICksXHJcbiAgICAgICAgICAgICAgICAwLFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAvLyBUaGUgZW1pdHRlZCB3YXZlJ3MgaW50ZW5zaXR5IGlzIGEgcHJvcG9ydGlvbiBvZiB0aGUgd2F2ZSB0aGF0IGNhdXNlcyB0aGUgaW50ZXJhY3Rpb24uXHJcbiAgICAgICAgICAgICAgICAgIGludGVuc2l0eUF0U3RhcnQ6IHdhdmVGcm9tVGhlR3JvdW5kLmludGVuc2l0eUF0U3RhcnQgKiBpcldhdmVBdHRlbnVhdGlvbixcclxuXHJcbiAgICAgICAgICAgICAgICAgIC8vIEFsaWduIHRoZSBwaGFzZSBvZmZzZXRzIGJlY2F1c2UgaXQgbG9va3MgYmV0dGVyIGluIHRoZSB2aWV3LlxyXG4gICAgICAgICAgICAgICAgICBpbml0aWFsUGhhc2VPZmZzZXQ6ICggd2F2ZUZyb21UaGVHcm91bmQuZ2V0UGhhc2VBdCggd2F2ZU9yaWdpblRvSW50ZXJzZWN0aW9uTGVuZ3RoICkgKyBNYXRoLlBJICkgJVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICggMiAqIE1hdGguUEkgKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgIC8vIEFkZCBhbiBhdHRlbnVhdG9yIG9uIHRoZSBzb3VyY2Ugd2F2ZS5cclxuICAgICAgICAgICAgICB3YXZlRnJvbVRoZUdyb3VuZC5hZGRBdHRlbnVhdG9yKFxyXG4gICAgICAgICAgICAgICAgd2F2ZVN0YXJ0VG9JbnRlcnNlY3Rpb25MZW5ndGgsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmNlbnRyYXRpb25Qcm9wZXJ0eS52YWx1ZSAqIE1BWF9BVE1PU1BIRVJJQ19JTlRFUkFDVElPTl9QUk9QT1JUSU9OLFxyXG4gICAgICAgICAgICAgICAgbGF5ZXJcclxuICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAvLyBBZGQgdGhlIHdhdmUtYXRtb3NwaGVyZSBpbnRlcmFjdGlvbiB0byBvdXIgbGlzdC5cclxuICAgICAgICAgICAgICB0aGlzLndhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25zLnB1c2goIG5ldyBXYXZlQXRtb3NwaGVyZUludGVyYWN0aW9uKFxyXG4gICAgICAgICAgICAgICAgbGF5ZXIsXHJcbiAgICAgICAgICAgICAgICB3YXZlRnJvbVRoZUdyb3VuZCxcclxuICAgICAgICAgICAgICAgIHdhdmVGcm9tQXRtb3NwaGVyaWNJbnRlcmFjdGlvblxyXG4gICAgICAgICAgICAgICkgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdXBkYXRlIHRoZSBpbnRlcmFjdGlvbnMgYmV0d2VlbiBsaWdodCB3YXZlcyBhbmQgdGhlIGdsYWNpZXJcclxuICAgKi9cclxuICBwcml2YXRlIHVwZGF0ZVdhdmVHbGFjaWVySW50ZXJhY3Rpb25zKCk6IHZvaWQge1xyXG5cclxuICAgIC8vIFNlZSBpZiBhbnkgb2YgdGhlIGN1cnJlbnRseSByZWZsZWN0ZWQgd2F2ZXMgc2hvdWxkIHN0b3AgcmVmbGVjdGluZy5cclxuICAgIHRoaXMuZ2xhY2llclJlZmxlY3RlZFdhdmVzTWFwLmZvckVhY2goICggcmVmbGVjdGVkV2F2ZSwgc291cmNlV2F2ZSApID0+IHtcclxuICAgICAgaWYgKCB0aGlzLmdyb3VuZExheWVyLmFsYmVkb1Byb3BlcnR5LnZhbHVlIDwgR3JvdW5kTGF5ZXIuUEFSVElBTExZX0dMQUNJQVRFRF9MQU5EX0FMQkVETyB8fFxyXG4gICAgICAgICAgICF0aGlzLndhdmVHcm91cC5pbmNsdWRlcyggc291cmNlV2F2ZSApICkge1xyXG5cclxuICAgICAgICAvLyBFaXRoZXIgdGhlIGFsYmVkbyBoYXMgZ29uZSBiZWxvdyB0aGF0IG9mIHRoZSBpY2UgYWdlIG9yIHRoZSB3YXZlIGZyb20gdGhlIHN1biB0aGF0IHdhcyBiZWluZyByZWZsZWN0ZWQgaGFzXHJcbiAgICAgICAgLy8gZ29uZSBhd2F5LiAgSW4gZWl0aGVyIGNhc2UsIGZyZWUgdGhpcyB3YXZlIHRvIGZpbmlzaCBwcm9wYWdhdGluZyBvbiBpdHMgb3duLlxyXG4gICAgICAgIHJlZmxlY3RlZFdhdmUuaXNTb3VyY2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5nbGFjaWVyUmVmbGVjdGVkV2F2ZXNNYXAuZGVsZXRlKCBzb3VyY2VXYXZlICk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBTZWUgaWYgYW55IG5ldyB3YXZlcyBzaG91bGQgYmUgY3JlYXRlZC5cclxuICAgIGlmICggdGhpcy5ncm91bmRMYXllci5hbGJlZG9Qcm9wZXJ0eS52YWx1ZSA+PSBHcm91bmRMYXllci5QQVJUSUFMTFlfR0xBQ0lBVEVEX0xBTkRfQUxCRURPICkge1xyXG5cclxuICAgICAgLy8gTWFrZSBhIGxpc3Qgb2Ygd2F2ZXMgdGhhdCBvcmlnaW5hdGVkIGZyb20gdGhlIHN1biBhbmQgYXJlIHJlYWNoaW5nIHRoZSBnbGFjaWVyLlxyXG4gICAgICAvLyBUT0RPOiBUaGlzIGlzIHVzaW5nIGEgZml4ZWQgcG9zaXRpb24gYW5kIHNob3VsZCBiZSBhZGp1c3RlZCB3aGVuIHdlIGtub3cgZXhhY3RseSB3aGVyZSB0aGUgZ2xhY2llciB3aWxsIGJlLFxyXG4gICAgICAvLyAgICAgICBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2dyZWVuaG91c2UtZWZmZWN0L2lzc3Vlcy83My5cclxuICAgICAgY29uc3Qgd2F2ZXNIaXR0aW5nVGhlR2xhY2llciA9IHRoaXMud2F2ZUdyb3VwLmZpbHRlciggd2F2ZSA9PlxyXG4gICAgICAgIHdhdmUuaXNWaXNpYmxlICYmXHJcbiAgICAgICAgd2F2ZS5vcmlnaW4ueCA+IDAgJiZcclxuICAgICAgICB3YXZlLm9yaWdpbi55ID09PSB0aGlzLnN1bldhdmVTb3VyY2Uud2F2ZVN0YXJ0QWx0aXR1ZGUgJiZcclxuICAgICAgICB3YXZlLnByb3BhZ2F0aW9uRGlyZWN0aW9uLnkgPCAwICYmXHJcbiAgICAgICAgd2F2ZS5nZXRFbmRQb2ludCgpLnkgPT09IDBcclxuICAgICAgKTtcclxuXHJcbiAgICAgIC8vIENoZWNrIGlmIHJlZmxlY3RlZCB3YXZlcyBhcmUgaW4gcGxhY2UgZm9yIHRoZXNlIGFuZCwgaWYgbm90LCBhZGQgdGhlbS5cclxuICAgICAgd2F2ZXNIaXR0aW5nVGhlR2xhY2llci5mb3JFYWNoKCBpbmNpZGVudFdhdmUgPT4ge1xyXG5cclxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBubyByZWZsZWN0ZWQgd2F2ZSBmb3IgdGhpcyBpbmNpZGVudCB3YXZlLCBjcmVhdGUgb25lLlxyXG4gICAgICAgIGlmICggIXRoaXMuZ2xhY2llclJlZmxlY3RlZFdhdmVzTWFwLmhhcyggaW5jaWRlbnRXYXZlICkgKSB7XHJcbiAgICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBHcmVlbmhvdXNlRWZmZWN0Q29uc3RhbnRzLlNUUkFJR0hUX1VQX05PUk1BTElaRURfVkVDVE9SLnJvdGF0ZWQoIE1hdGguUEkgKiAwLjA1ICk7XHJcbiAgICAgICAgICBjb25zdCByZWZsZWN0ZWRXYXZlID0gdGhpcy53YXZlR3JvdXAuY3JlYXRlTmV4dEVsZW1lbnQoXHJcbiAgICAgICAgICAgIGluY2lkZW50V2F2ZS53YXZlbGVuZ3RoLFxyXG4gICAgICAgICAgICBuZXcgVmVjdG9yMiggaW5jaWRlbnRXYXZlLm9yaWdpbi54LCAwICksXHJcbiAgICAgICAgICAgIGRpcmVjdGlvbixcclxuICAgICAgICAgICAgTGF5ZXJzTW9kZWwuSEVJR0hUX09GX0FUTU9TUEhFUkUsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBpbnRlbnNpdHlBdFN0YXJ0OiAwLjI1LCAvLyBhcmJpdHJhcmlseSBjaG9zZSB0byBsb29rIGdvb2RcclxuICAgICAgICAgICAgICBpbml0aWFsUGhhc2VPZmZzZXQ6ICggaW5jaWRlbnRXYXZlLmdldFBoYXNlQXQoIExheWVyc01vZGVsLkhFSUdIVF9PRl9BVE1PU1BIRVJFICkgKyBNYXRoLlBJICkgJSBUV09fUElcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgKTtcclxuICAgICAgICAgIHRoaXMuZ2xhY2llclJlZmxlY3RlZFdhdmVzTWFwLnNldCggaW5jaWRlbnRXYXZlLCByZWZsZWN0ZWRXYXZlICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgcmVzZXQoKTogdm9pZCB7XHJcbiAgICBjb25zdCBudW1iZXJPZldhdmVzQmVmb3JlUmVzZXQgPSB0aGlzLndhdmVHcm91cC5jb3VudDtcclxuICAgIHN1cGVyLnJlc2V0KCk7XHJcbiAgICB0aGlzLndhdmVHcm91cC5jbGVhcigpO1xyXG4gICAgdGhpcy5zdXJmYWNlVGVtcGVyYXR1cmVWaXNpYmxlUHJvcGVydHkucmVzZXQoKTtcclxuICAgIHRoaXMuY2xvdWRSZWZsZWN0ZWRXYXZlc01hcC5jbGVhcigpO1xyXG4gICAgdGhpcy5nbGFjaWVyUmVmbGVjdGVkV2F2ZXNNYXAuY2xlYXIoKTtcclxuICAgIHRoaXMuc3VuV2F2ZVNvdXJjZS5yZXNldCgpO1xyXG4gICAgdGhpcy5ncm91bmRXYXZlU291cmNlLnJlc2V0KCk7XHJcbiAgICB0aGlzLndhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25zLmNsZWFyKCk7XHJcbiAgICBpZiAoIG51bWJlck9mV2F2ZXNCZWZvcmVSZXNldCA+IDAgKSB7XHJcbiAgICAgIHRoaXMud2F2ZXNDaGFuZ2VkRW1pdHRlci5lbWl0KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBmb3IgcGhldC1pb1xyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSB0b1N0YXRlT2JqZWN0KCk6IFdhdmVzTW9kZWxTdGF0ZU9iamVjdCB7XHJcbiAgICByZXR1cm4gY29tYmluZU9wdGlvbnM8V2F2ZXNNb2RlbFN0YXRlT2JqZWN0Piggc3VwZXIudG9TdGF0ZU9iamVjdCgpLCB7XHJcbiAgICAgIHN1bldhdmVTb3VyY2U6IEVNV2F2ZVNvdXJjZS5FTVdhdmVTb3VyY2VJTy50b1N0YXRlT2JqZWN0KCB0aGlzLnN1bldhdmVTb3VyY2UgKSxcclxuICAgICAgZ3JvdW5kV2F2ZVNvdXJjZTogRU1XYXZlU291cmNlLkVNV2F2ZVNvdXJjZUlPLnRvU3RhdGVPYmplY3QoIHRoaXMuZ3JvdW5kV2F2ZVNvdXJjZSApLFxyXG4gICAgICBjbG91ZFJlZmxlY3RlZFdhdmVzTWFwOiBNYXBJTyggUmVmZXJlbmNlSU8oIFdhdmUuV2F2ZUlPICksIFJlZmVyZW5jZUlPKCBXYXZlLldhdmVJTyApICkudG9TdGF0ZU9iamVjdCggdGhpcy5jbG91ZFJlZmxlY3RlZFdhdmVzTWFwICksXHJcbiAgICAgIGdsYWNpZXJSZWZsZWN0ZWRXYXZlc01hcDogTWFwSU8oIFJlZmVyZW5jZUlPKCBXYXZlLldhdmVJTyApLCBSZWZlcmVuY2VJTyggV2F2ZS5XYXZlSU8gKSApLnRvU3RhdGVPYmplY3QoIHRoaXMuZ2xhY2llclJlZmxlY3RlZFdhdmVzTWFwIClcclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIGZvciBwaGV0LWlvXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIGFwcGx5U3RhdGUoIHN0YXRlT2JqZWN0OiBXYXZlc01vZGVsU3RhdGVPYmplY3QgKTogdm9pZCB7XHJcbiAgICB0aGlzLnN1bldhdmVTb3VyY2UuYXBwbHlTdGF0ZSggc3RhdGVPYmplY3Quc3VuV2F2ZVNvdXJjZSApO1xyXG4gICAgdGhpcy5ncm91bmRXYXZlU291cmNlLmFwcGx5U3RhdGUoIHN0YXRlT2JqZWN0Lmdyb3VuZFdhdmVTb3VyY2UgKTtcclxuICAgIHRoaXMuY2xvdWRSZWZsZWN0ZWRXYXZlc01hcCA9IE1hcElPKCBSZWZlcmVuY2VJTyggV2F2ZS5XYXZlSU8gKSwgUmVmZXJlbmNlSU8oIFdhdmUuV2F2ZUlPICkgKS5mcm9tU3RhdGVPYmplY3QoIHN0YXRlT2JqZWN0LmNsb3VkUmVmbGVjdGVkV2F2ZXNNYXBcclxuICAgICk7XHJcbiAgICB0aGlzLmdsYWNpZXJSZWZsZWN0ZWRXYXZlc01hcCA9IE1hcElPKCBSZWZlcmVuY2VJTyggV2F2ZS5XYXZlSU8gKSwgUmVmZXJlbmNlSU8oIFdhdmUuV2F2ZUlPICkgKS5mcm9tU3RhdGVPYmplY3QoIHN0YXRlT2JqZWN0LmdsYWNpZXJSZWZsZWN0ZWRXYXZlc01hcFxyXG4gICAgKTtcclxuICAgIHN1cGVyLmFwcGx5U3RhdGUoIHN0YXRlT2JqZWN0ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXYXZlc01vZGVsSU8gaGFuZGxlcyBQaEVULWlPIHNlcmlhbGl6YXRpb24gb2YgdGhlIFdhdmVzTW9kZWwuIEJlY2F1c2Ugc2VyaWFsaXphdGlvbiBpbnZvbHZlcyBhY2Nlc3NpbmcgcHJpdmF0ZVxyXG4gICAqIG1lbWJlcnMsIGl0IGRlbGVnYXRlcyB0byBXYXZlc01vZGVsLiBUaGUgbWV0aG9kcyB0aGF0IFdhdmVzTW9kZWxJTyBvdmVycmlkZXMgYXJlIHR5cGljYWwgb2YgJ0R5bmFtaWMgZWxlbWVudFxyXG4gICAqIHNlcmlhbGl6YXRpb24nLCBhcyBkZXNjcmliZWQgaW4gdGhlIFNlcmlhbGl6YXRpb24gc2VjdGlvbiBvZlxyXG4gICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9waGV0LWlvL2Jsb2IvbWFzdGVyL2RvYy9waGV0LWlvLWluc3RydW1lbnRhdGlvbi10ZWNobmljYWwtZ3VpZGUubWQjc2VyaWFsaXphdGlvblxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgV2F2ZXNNb2RlbElPID0gbmV3IElPVHlwZSggJ1dhdmVzTW9kZWxJTycsIHtcclxuICAgICAgdmFsdWVUeXBlOiBXYXZlc01vZGVsLFxyXG4gICAgICB0b1N0YXRlT2JqZWN0OiAoIHdhdmVzTW9kZWw6IFdhdmVzTW9kZWwgKSA9PiB3YXZlc01vZGVsLnRvU3RhdGVPYmplY3QoKSxcclxuICAgICAgYXBwbHlTdGF0ZTogKCB3YXZlc01vZGVsOiBXYXZlc01vZGVsLCBzdGF0ZU9iamVjdDogV2F2ZXNNb2RlbFN0YXRlT2JqZWN0ICkgPT4gd2F2ZXNNb2RlbC5hcHBseVN0YXRlKCBzdGF0ZU9iamVjdCApLFxyXG4gICAgICBzdGF0ZVNjaGVtYToge1xyXG4gICAgICAgIHN1bldhdmVTb3VyY2U6IEVNV2F2ZVNvdXJjZS5FTVdhdmVTb3VyY2VJTyxcclxuICAgICAgICBncm91bmRXYXZlU291cmNlOiBFTVdhdmVTb3VyY2UuRU1XYXZlU291cmNlSU8sXHJcbiAgICAgICAgY2xvdWRSZWZsZWN0ZWRXYXZlc01hcDogTWFwSU8oIFJlZmVyZW5jZUlPKCBXYXZlLldhdmVJTyApLCBSZWZlcmVuY2VJTyggV2F2ZS5XYXZlSU8gKSApLFxyXG4gICAgICAgIGdsYWNpZXJSZWZsZWN0ZWRXYXZlc01hcDogTWFwSU8oIFJlZmVyZW5jZUlPKCBXYXZlLldhdmVJTyApLCBSZWZlcmVuY2VJTyggV2F2ZS5XYXZlSU8gKSApLFxyXG4gICAgICAgIC4uLkxheWVyc01vZGVsLlNUQVRFX1NDSEVNQVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKTtcclxuXHJcbiAgLy8gb3RoZXIgc3RhdGljIHZhbHVlc1xyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgUkVBTF9UT19SRU5ERVJJTkdfV0FWRUxFTkdUSF9NQVAgPSBSRUFMX1RPX1JFTkRFUklOR19XQVZFTEVOR1RIX01BUDtcclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFdBVkVfQU1QTElUVURFX0ZPUl9SRU5ERVJJTkcgPSBXQVZFX0FNUExJVFVERV9GT1JfUkVOREVSSU5HO1xyXG59XHJcblxyXG50eXBlIFdhdmVzTW9kZWxTdGF0ZU9iamVjdCA9IHtcclxuICBzdW5XYXZlU291cmNlOiBFTVdhdmVTb3VyY2VTdGF0ZU9iamVjdDtcclxuICBncm91bmRXYXZlU291cmNlOiBFTVdhdmVTb3VyY2VTdGF0ZU9iamVjdDtcclxuICBjbG91ZFJlZmxlY3RlZFdhdmVzTWFwOiBNYXBTdGF0ZU9iamVjdDxSZWZlcmVuY2VJT1N0YXRlLCBSZWZlcmVuY2VJT1N0YXRlPjtcclxuICBnbGFjaWVyUmVmbGVjdGVkV2F2ZXNNYXA6IE1hcFN0YXRlT2JqZWN0PFJlZmVyZW5jZUlPU3RhdGUsIFJlZmVyZW5jZUlPU3RhdGU+O1xyXG59ICYgTGF5ZXJzTW9kZWxTdGF0ZU9iamVjdDtcclxuXHJcbi8qKlxyXG4gKiBIZWxwZXIgZnVuY3Rpb24gZm9yIGNhbGN1bGF0aW5nIGFuIGF0dGVudWF0aW9uIHZhbHVlIHRoYXQgc2hvdWxkIGJlIHVzZWQgaW4gYW4gYXRtb3NwaGVyaWMgaW50ZXJhY3Rpb24gYmFzZWQgb24gdGhlXHJcbiAqIGNvbmNlbnRyYXRpb24gb2YgZ3JlZW5ob3VzZSBnYXNlcy5cclxuICovXHJcbmNvbnN0IG1hcEdhc0NvbmNlbnRyYXRpb25Ub0F0dGVudWF0aW9uID0gKCBjb25jZW50cmF0aW9uOiBudW1iZXIgKTogbnVtYmVyID0+IHtcclxuXHJcbiAgLy8gVGhpcyBlcXVhdGlvbiB3YXMgZW1waXJpY2FsbHkgZGV0ZXJtaW5lZCwgYW5kIHdpbGwgb25seSB3b3JrIGlmIHRoZSB3YXZlIGludGVuc2l0eSBjb21pbmcgZnJvbSB0aGUgZ3JvdW5kIGRvZXNuJ3RcclxuICAvLyBjaGFuZ2UuICBJbiBvdGhlciB3b3JkcywgdGhpcyBpcyBhIHRvdWNoeSBwYXJ0IG9mIHRoZSB3aG9sZSBzeXN0ZW0sIHNvIHVwZGF0ZSBhcyBuZWVkZWQgYnV0IGJlIGNhcmVmdWwgYWJvdXQgaXQuXHJcbiAgcmV0dXJuIC0wLjg0ICogTWF0aC5wb3coIGNvbmNlbnRyYXRpb24sIDIgKSArIDEuNjYgKiBjb25jZW50cmF0aW9uO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEEgc2ltcGxlIGlubmVyIGNsYXNzIGZvciB0cmFja2luZyBpbnRlcmFjdGlvbnMgYmV0d2VlbiB0aGUgSVIgd2F2ZXMgYW5kIHRoZSBhdG1vc3BoZXJlLlxyXG4gKi9cclxuY2xhc3MgV2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbiB7XHJcbiAgcHVibGljIHJlYWRvbmx5IGF0bW9zcGhlcmVMYXllcjogRW5lcmd5QWJzb3JiaW5nRW1pdHRpbmdMYXllcjtcclxuICBwdWJsaWMgcmVhZG9ubHkgc291cmNlV2F2ZTogV2F2ZTtcclxuICBwdWJsaWMgcmVhZG9ubHkgZW1pdHRlZFdhdmU6IFdhdmU7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggYXRtb3NwaGVyZUxheWVyOiBFbmVyZ3lBYnNvcmJpbmdFbWl0dGluZ0xheWVyLCBzb3VyY2VXYXZlOiBXYXZlLCBlbWl0dGVkV2F2ZTogV2F2ZSApIHtcclxuICAgIHRoaXMuYXRtb3NwaGVyZUxheWVyID0gYXRtb3NwaGVyZUxheWVyO1xyXG4gICAgdGhpcy5zb3VyY2VXYXZlID0gc291cmNlV2F2ZTtcclxuICAgIHRoaXMuZW1pdHRlZFdhdmUgPSBlbWl0dGVkV2F2ZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyB0b1N0YXRlT2JqZWN0KCk6IFdhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25TdGF0ZU9iamVjdCB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhdG1vc3BoZXJlTGF5ZXI6IFJlZmVyZW5jZUlPKCBJT1R5cGUuT2JqZWN0SU8gKS50b1N0YXRlT2JqZWN0KCB0aGlzLmF0bW9zcGhlcmVMYXllciApLFxyXG4gICAgICBzb3VyY2VXYXZlOiBSZWZlcmVuY2VJTyggV2F2ZS5XYXZlSU8gKS50b1N0YXRlT2JqZWN0KCB0aGlzLnNvdXJjZVdhdmUgKSxcclxuICAgICAgZW1pdHRlZFdhdmU6IFJlZmVyZW5jZUlPKCBXYXZlLldhdmVJTyApLnRvU3RhdGVPYmplY3QoIHRoaXMuZW1pdHRlZFdhdmUgKVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgV2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbklPID0gbmV3IElPVHlwZSggJ1dhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25JTycsIHtcclxuICAgIHZhbHVlVHlwZTogV2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbixcclxuICAgIHN0YXRlU2NoZW1hOiB7XHJcbiAgICAgIGF0bW9zcGhlcmVMYXllcjogUmVmZXJlbmNlSU8oIElPVHlwZS5PYmplY3RJTyApLFxyXG4gICAgICBzb3VyY2VXYXZlOiBSZWZlcmVuY2VJTyggV2F2ZS5XYXZlSU8gKSxcclxuICAgICAgZW1pdHRlZFdhdmU6IFJlZmVyZW5jZUlPKCBXYXZlLldhdmVJTyApXHJcbiAgICB9LFxyXG4gICAgdG9TdGF0ZU9iamVjdDogKCB3YXZlQXRtb3NwaGVyZUludGVyYWN0aW9uOiBXYXZlQXRtb3NwaGVyZUludGVyYWN0aW9uICkgPT4gd2F2ZUF0bW9zcGhlcmVJbnRlcmFjdGlvbi50b1N0YXRlT2JqZWN0KCksXHJcbiAgICBmcm9tU3RhdGVPYmplY3Q6ICggc3RhdGVPYmplY3Q6IFdhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25TdGF0ZU9iamVjdCApID0+IG5ldyBXYXZlQXRtb3NwaGVyZUludGVyYWN0aW9uKFxyXG4gICAgICBSZWZlcmVuY2VJTyggSU9UeXBlLk9iamVjdElPICkuZnJvbVN0YXRlT2JqZWN0KCBzdGF0ZU9iamVjdC5hdG1vc3BoZXJlTGF5ZXIgKSxcclxuICAgICAgUmVmZXJlbmNlSU8oIFdhdmUuV2F2ZUlPICkuZnJvbVN0YXRlT2JqZWN0KCBzdGF0ZU9iamVjdC5zb3VyY2VXYXZlICksXHJcbiAgICAgIFJlZmVyZW5jZUlPKCBXYXZlLldhdmVJTyApLmZyb21TdGF0ZU9iamVjdCggc3RhdGVPYmplY3QuZW1pdHRlZFdhdmUgKSApXHJcbiAgfSApO1xyXG59XHJcblxyXG50eXBlIFdhdmVBdG1vc3BoZXJlSW50ZXJhY3Rpb25TdGF0ZU9iamVjdCA9IHtcclxuICBhdG1vc3BoZXJlTGF5ZXI6IFJlZmVyZW5jZUlPU3RhdGU7XHJcbiAgc291cmNlV2F2ZTogUmVmZXJlbmNlSU9TdGF0ZTtcclxuICBlbWl0dGVkV2F2ZTogUmVmZXJlbmNlSU9TdGF0ZTtcclxufTtcclxuXHJcbmdyZWVuaG91c2VFZmZlY3QucmVnaXN0ZXIoICdXYXZlc01vZGVsJywgV2F2ZXNNb2RlbCApO1xyXG5leHBvcnQgZGVmYXVsdCBXYXZlc01vZGVsOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxxQkFBcUIsTUFBMkIsOENBQThDO0FBQ3JHLE9BQU9DLE9BQU8sTUFBTSxnQ0FBZ0M7QUFFcEQsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxPQUFPLE1BQU0sK0JBQStCO0FBQ25ELFNBQVNDLElBQUksUUFBUSxnQ0FBZ0M7QUFDckQsU0FBU0MsY0FBYyxRQUFRLHVDQUF1QztBQUN0RSxPQUFPQyxXQUFXLE1BQU0sc0NBQXNDO0FBRTlELE9BQU9DLE1BQU0sTUFBTSx1Q0FBdUM7QUFDMUQsT0FBT0MsS0FBSyxNQUEwQixzQ0FBc0M7QUFDNUUsT0FBT0MsV0FBVyxNQUE0Qiw0Q0FBNEM7QUFDMUYsT0FBT0MseUJBQXlCLE1BQU0sMkNBQTJDO0FBQ2pGLE9BQU9DLGtCQUFrQixNQUFNLDBDQUEwQztBQUV6RSxPQUFPQyxXQUFXLE1BQU0sbUNBQW1DO0FBQzNELE9BQU9DLFdBQVcsTUFBa0MsbUNBQW1DO0FBQ3ZGLE9BQU9DLGdCQUFnQixNQUFNLDJCQUEyQjtBQUN4RCxPQUFPQyxZQUFZLE1BQW1DLG1CQUFtQjtBQUN6RSxPQUFPQyxnQkFBZ0IsTUFBTSx1QkFBdUI7QUFDcEQsT0FBT0MsYUFBYSxNQUFNLG9CQUFvQjtBQUM5QyxPQUFPQyxJQUFJLE1BQTZDLFdBQVc7O0FBRW5FO0FBQ0EsTUFBTUMsc0NBQXNDLEdBQUcsSUFBSSxDQUFDLENBQUM7QUFDckQsTUFBTUMsTUFBTSxHQUFHQyxJQUFJLENBQUNDLEVBQUUsR0FBRyxDQUFDOztBQUUxQjtBQUNBLE1BQU1DLGdDQUFnQyxHQUFHLElBQUlDLEdBQUcsQ0FBRSxDQUNoRCxDQUFFZCx5QkFBeUIsQ0FBQ2Usa0JBQWtCLEVBQUUsSUFBSSxDQUFFLEVBQ3RELENBQUVmLHlCQUF5QixDQUFDZ0IsbUJBQW1CLEVBQUUsS0FBSyxDQUFFLENBQ3hELENBQUM7QUFFSCxNQUFNQyw0QkFBNEIsR0FBRyxJQUFJO0FBRXpDLE1BQU1DLFVBQVUsU0FBU2pCLGtCQUFrQixDQUFDO0VBZ0JuQ2tCLFdBQVdBLENBQUVDLE1BQWMsRUFBRztJQUNuQyxLQUFLLENBQUVBLE1BQU0sRUFBRTtNQUViO01BQ0FDLFVBQVUsRUFBRUgsVUFBVSxDQUFDSSxZQUFZO01BQ25DQyxXQUFXLEVBQUU7SUFDZixDQUFFLENBQUM7O0lBRUg7SUFDQSxJQUFJLENBQUNDLFNBQVMsR0FBRyxJQUFJNUIsV0FBVyxDQUM5QixDQUFFd0IsTUFBTSxFQUFFSyxVQUFVLEVBQUVDLE1BQU0sRUFBRUMsb0JBQW9CLEVBQUVDLGdCQUFnQixFQUFFQyxlQUFlLEtBQU07TUFDekYsTUFBTUMsT0FBTyxHQUFHbkMsY0FBYyxDQUFlO1FBQUV5QixNQUFNLEVBQUVBO01BQU8sQ0FBQyxFQUFFUyxlQUFnQixDQUFDO01BQ2xGLE9BQU8sSUFBSXJCLElBQUksQ0FBRWlCLFVBQVUsRUFBRUMsTUFBTSxFQUFFQyxvQkFBb0IsRUFBRUMsZ0JBQWdCLEVBQUVFLE9BQVEsQ0FBQztJQUN4RixDQUFDLEVBQ0QsQ0FDRTlCLHlCQUF5QixDQUFDZ0IsbUJBQW1CLEVBQzdDdkIsT0FBTyxDQUFDc0MsSUFBSSxFQUNaL0IseUJBQXlCLENBQUNnQyw2QkFBNkIsRUFDdkQ3QixXQUFXLENBQUM4QixvQkFBb0IsRUFDaEMsQ0FBQyxDQUFDLENBQ0gsRUFDRDtNQUNFYixNQUFNLEVBQUVBLE1BQU0sQ0FBQ2MsWUFBWSxDQUFFLFdBQVksQ0FBQztNQUMxQ2IsVUFBVSxFQUFFekIsV0FBVyxDQUFDdUMsYUFBYSxDQUFFM0IsSUFBSSxDQUFDNEIsTUFBTztJQUNyRCxDQUNGLENBQUM7O0lBRUQ7SUFDQSxJQUFJLENBQUNDLG1CQUFtQixHQUFHLElBQUk5QyxPQUFPLENBQUMsQ0FBQzs7SUFFeEM7SUFDQSxJQUFJLENBQUMrQyxhQUFhLEdBQUcsSUFBSS9CLGFBQWEsQ0FDcEMsSUFBSSxDQUFDaUIsU0FBUyxFQUNkLElBQUksQ0FBQ2UsZUFBZSxDQUFDQyxpQkFBaUIsRUFDdENyQyxXQUFXLENBQUM4QixvQkFBb0IsRUFDaEMsQ0FBQyxFQUNEO01BQUViLE1BQU0sRUFBRUEsTUFBTSxDQUFDYyxZQUFZLENBQUUsZUFBZ0I7SUFBRSxDQUNuRCxDQUFDOztJQUVEO0lBQ0EsSUFBSSxDQUFDTyxnQkFBZ0IsR0FBRyxJQUFJbkMsZ0JBQWdCLENBQzFDLElBQUksQ0FBQ2tCLFNBQVMsRUFDZCxDQUFDLEVBQ0RyQixXQUFXLENBQUM4QixvQkFBb0IsRUFDaEMsSUFBSSxDQUFDUyxnQ0FBZ0MsRUFDckM7TUFBRXRCLE1BQU0sRUFBRUEsTUFBTSxDQUFDYyxZQUFZLENBQUUsa0JBQW1CO0lBQUUsQ0FDdEQsQ0FBQzs7SUFFRDtJQUNBLElBQUksQ0FBQ1Msc0JBQXNCLEdBQUcsSUFBSTdCLEdBQUcsQ0FBYSxDQUFDOztJQUVuRDtJQUNBLElBQUksQ0FBQzhCLHdCQUF3QixHQUFHLElBQUk5QixHQUFHLENBQWEsQ0FBQzs7SUFFckQ7SUFDQTtJQUNBLElBQUksQ0FBQytCLDBCQUEwQixHQUFHLElBQUkvQixHQUFHLENBQ3ZDO0lBQ0U7SUFDQSxDQUNFLElBQUksQ0FBQ2dDLGdCQUFnQixDQUFFLENBQUMsQ0FBRSxFQUMxQixJQUFJdEQsS0FBSyxDQUFFLENBQUNXLFdBQVcsQ0FBQzRDLGFBQWEsQ0FBQ0MsS0FBSyxHQUFHLENBQUMsRUFBRSxDQUFDN0MsV0FBVyxDQUFDNEMsYUFBYSxDQUFDQyxLQUFLLEdBQUcsQ0FBRSxDQUFDLENBQ3hGO0lBRUQ7SUFDQSxDQUNFLElBQUksQ0FBQ0YsZ0JBQWdCLENBQUUsQ0FBQyxDQUFFLEVBQzFCLElBQUl0RCxLQUFLLENBQUUsQ0FBQ1csV0FBVyxDQUFDNEMsYUFBYSxDQUFDQyxLQUFLLEdBQUcsQ0FBQyxFQUFFN0MsV0FBVyxDQUFDNEMsYUFBYSxDQUFDQyxLQUFLLEdBQUcsQ0FBRSxDQUFDLENBQ3ZGO0lBRUQ7SUFDQSxDQUNFLElBQUksQ0FBQ0YsZ0JBQWdCLENBQUUsQ0FBQyxDQUFFLEVBQzFCLElBQUl0RCxLQUFLLENBQUVXLFdBQVcsQ0FBQzRDLGFBQWEsQ0FBQ0MsS0FBSyxHQUFHLElBQUksRUFBRTdDLFdBQVcsQ0FBQzRDLGFBQWEsQ0FBQ0MsS0FBTSxDQUFDLENBQ3JGLENBRUwsQ0FBQzs7SUFFRDtJQUNBO0lBQ0EsSUFBSSxDQUFDQywwQkFBMEIsR0FBRzNELHFCQUFxQixDQUFFO01BQ3ZEOEIsTUFBTSxFQUFFQSxNQUFNLENBQUNjLFlBQVksQ0FBRSw0QkFBNkIsQ0FBQztNQUMzRGIsVUFBVSxFQUFFL0IscUJBQXFCLENBQUM0RCxpQkFBaUIsQ0FBRUMseUJBQXlCLENBQUNDLDJCQUE0QixDQUFDO01BQzVHQyxtQkFBbUIsRUFBRTtJQUN2QixDQUFFLENBQUM7O0lBRUg7SUFDQTtJQUNBLElBQUksQ0FBQ0MsYUFBYSxHQUFHLElBQUk3RCxPQUFPLENBQUUsQ0FBQyxFQUFFLENBQUUsQ0FBQztJQUN4QyxJQUFJLENBQUM4RCxXQUFXLEdBQUcsSUFBSTlELE9BQU8sQ0FBRSxDQUFDLEVBQUUsQ0FBRSxDQUFDO0lBQ3RDLElBQUksQ0FBQytELFFBQVEsR0FBRyxJQUFJOUQsSUFBSSxDQUFFLElBQUksQ0FBQzRELGFBQWEsRUFBRSxJQUFJLENBQUNDLFdBQVksQ0FBQztJQUNoRSxJQUFJLENBQUNFLG1CQUFtQixHQUFHLElBQUloRSxPQUFPLENBQUUsQ0FBQyxFQUFFLENBQUUsQ0FBQztJQUM5QyxJQUFJLENBQUNpRSxpQkFBaUIsR0FBRyxJQUFJakUsT0FBTyxDQUFFLENBQUMsRUFBRSxDQUFFLENBQUM7SUFDNUMsSUFBSSxDQUFDa0UsY0FBYyxHQUFHLElBQUlqRSxJQUFJLENBQUUsSUFBSSxDQUFDK0QsbUJBQW1CLEVBQUUsSUFBSSxDQUFDQyxpQkFBa0IsQ0FBQztFQUNwRjs7RUFFQTtBQUNGO0FBQ0E7QUFDQTtFQUNrQkUsU0FBU0EsQ0FBRUMsRUFBVSxFQUFTO0lBQzVDLE1BQU1DLDBCQUEwQixHQUFHLElBQUksQ0FBQ3RDLFNBQVMsQ0FBQ3VDLEtBQUs7SUFDdkQsS0FBSyxDQUFDSCxTQUFTLENBQUVDLEVBQUcsQ0FBQztJQUNyQixJQUFJLENBQUN2QixhQUFhLENBQUMwQixJQUFJLENBQUVILEVBQUcsQ0FBQztJQUM3QixJQUFJLENBQUNwQixnQkFBZ0IsQ0FBQ3VCLElBQUksQ0FBRUgsRUFBRyxDQUFDO0lBQ2hDLElBQUksQ0FBQ3JDLFNBQVMsQ0FBQ3lDLE9BQU8sQ0FBRUMsSUFBSSxJQUFJQSxJQUFJLENBQUNGLElBQUksQ0FBRUgsRUFBRyxDQUFFLENBQUM7SUFDakQsSUFBSSxDQUFDTSwyQkFBMkIsQ0FBQyxDQUFDO0lBQ2xDLElBQUksQ0FBQ0MsZ0NBQWdDLENBQUMsQ0FBQztJQUN2QyxJQUFJLENBQUNDLDZCQUE2QixDQUFDLENBQUM7O0lBRXBDO0lBQ0EsSUFBSSxDQUFDN0MsU0FBUyxDQUFDOEMsTUFBTSxDQUFFSixJQUFJLElBQUlBLElBQUksQ0FBQ0ssc0JBQXVCLENBQUMsQ0FBQ04sT0FBTyxDQUFFQyxJQUFJLElBQUk7TUFDNUUsSUFBSSxDQUFDMUMsU0FBUyxDQUFDZ0QsY0FBYyxDQUFFTixJQUFLLENBQUM7SUFDdkMsQ0FBRSxDQUFDOztJQUVIO0lBQ0EsSUFBSyxJQUFJLENBQUMxQyxTQUFTLENBQUN1QyxLQUFLLEdBQUcsQ0FBQyxJQUFJRCwwQkFBMEIsR0FBRyxDQUFDLEVBQUc7TUFDaEUsSUFBSSxDQUFDekIsbUJBQW1CLENBQUNvQyxJQUFJLENBQUMsQ0FBQztJQUNqQztFQUNGOztFQUVBO0FBQ0Y7QUFDQTtFQUNVTiwyQkFBMkJBLENBQUEsRUFBUztJQUUxQyxJQUFLLElBQUksQ0FBQ08sS0FBSyxFQUFHO01BRWhCLE1BQU1BLEtBQUssR0FBRyxJQUFJLENBQUNBLEtBQUssQ0FBQyxDQUFDOztNQUUxQjtNQUNBO01BQ0E7TUFDQSxNQUFNQyx1QkFBdUIsR0FBRyxHQUFHOztNQUVuQztNQUNBLElBQUksQ0FBQ2hDLHNCQUFzQixDQUFDc0IsT0FBTyxDQUFFLENBQUVXLGFBQWEsRUFBRUMsVUFBVSxLQUFNO1FBQ3BFLElBQUssQ0FBQ0gsS0FBSyxDQUFDSSxlQUFlLENBQUNDLEtBQUssSUFBSUYsVUFBVSxDQUFDRyxVQUFVLENBQUNDLENBQUMsR0FBR1AsS0FBSyxDQUFDUSxRQUFRLENBQUNELENBQUMsRUFBRztVQUVoRjtVQUNBO1VBQ0FMLGFBQWEsQ0FBQ08sU0FBUyxHQUFHLEtBQUs7VUFDL0IsSUFBSSxDQUFDeEMsc0JBQXNCLENBQUN5QyxNQUFNLENBQUVQLFVBQVcsQ0FBQztRQUNsRDtNQUNGLENBQUUsQ0FBQztNQUVILElBQUtILEtBQUssQ0FBQ0ksZUFBZSxDQUFDQyxLQUFLLEVBQUc7UUFFakM7UUFDQSxNQUFNTSxxQkFBcUIsR0FBRyxJQUFJLENBQUM3RCxTQUFTLENBQUM4QyxNQUFNLENBQUVKLElBQUksSUFDdkRBLElBQUksQ0FBQ29CLFNBQVMsSUFDZHBCLElBQUksQ0FBQ3hDLE1BQU0sQ0FBQ3VELENBQUMsS0FBSyxJQUFJLENBQUMzQyxhQUFhLENBQUNpRCxpQkFBaUIsSUFDdERyQixJQUFJLENBQUN2QyxvQkFBb0IsQ0FBQ3NELENBQUMsR0FBRyxDQUFDLElBQy9CZixJQUFJLENBQUNjLFVBQVUsQ0FBQ0MsQ0FBQyxHQUFHUCxLQUFLLENBQUNRLFFBQVEsQ0FBQ0QsQ0FBQyxJQUNwQ2YsSUFBSSxDQUFDYyxVQUFVLENBQUNDLENBQUMsR0FBR2YsSUFBSSxDQUFDc0IsTUFBTSxHQUFHZCxLQUFLLENBQUNRLFFBQVEsQ0FBQ0QsQ0FBQyxJQUNsRGYsSUFBSSxDQUFDYyxVQUFVLENBQUNTLENBQUMsR0FBR2YsS0FBSyxDQUFDUSxRQUFRLENBQUNPLENBQUMsR0FBR2YsS0FBSyxDQUFDMUIsS0FBSyxHQUFHLENBQUMsSUFDdERrQixJQUFJLENBQUNjLFVBQVUsQ0FBQ1MsQ0FBQyxHQUFHZixLQUFLLENBQUNRLFFBQVEsQ0FBQ08sQ0FBQyxHQUFHZixLQUFLLENBQUMxQixLQUFLLEdBQUcsQ0FDdkQsQ0FBQzs7UUFFRDtRQUNBcUMscUJBQXFCLENBQUNwQixPQUFPLENBQUV5QixZQUFZLElBQUk7VUFFN0M7VUFDQSxJQUFLLENBQUMsSUFBSSxDQUFDL0Msc0JBQXNCLENBQUNnRCxHQUFHLENBQUVELFlBQWEsQ0FBQyxFQUFHO1lBQ3RELE1BQU1FLFNBQVMsR0FBR0YsWUFBWSxDQUFDaEUsTUFBTSxDQUFDK0QsQ0FBQyxHQUFHZixLQUFLLENBQUNRLFFBQVEsQ0FBQ08sQ0FBQyxHQUN4Q3pGLHlCQUF5QixDQUFDZ0MsNkJBQTZCLENBQUM2RCxPQUFPLENBQUUsQ0FBQ2xGLElBQUksQ0FBQ0MsRUFBRSxHQUFHLEdBQUksQ0FBQyxHQUNqRloseUJBQXlCLENBQUNnQyw2QkFBNkIsQ0FBQzZELE9BQU8sQ0FBRWxGLElBQUksQ0FBQ0MsRUFBRSxHQUFHLEdBQUksQ0FBQztZQUNsRyxNQUFNZ0UsYUFBYSxHQUFHLElBQUksQ0FBQ3BELFNBQVMsQ0FBQ3NFLGlCQUFpQixDQUNwREosWUFBWSxDQUFDakUsVUFBVSxFQUN2QixJQUFJaEMsT0FBTyxDQUFFaUcsWUFBWSxDQUFDaEUsTUFBTSxDQUFDK0QsQ0FBQyxFQUFFZixLQUFLLENBQUNRLFFBQVEsQ0FBQ0QsQ0FBRSxDQUFDLEVBQ3REVyxTQUFTLEVBQ1R6RixXQUFXLENBQUM4QixvQkFBb0IsRUFBRTtjQUNoQzhELGdCQUFnQixFQUFFTCxZQUFZLENBQUNLLGdCQUFnQixHQUFHcEIsdUJBQXVCO2NBQ3pFcUIsa0JBQWtCLEVBQUUsQ0FBRU4sWUFBWSxDQUFDTyxVQUFVLENBQUVQLFlBQVksQ0FBQ2hFLE1BQU0sQ0FBQ3VELENBQUMsR0FBR1AsS0FBSyxDQUFDUSxRQUFRLENBQUNELENBQUUsQ0FBQyxHQUFHdEUsSUFBSSxDQUFDQyxFQUFFLEtBQzdFLENBQUMsR0FBR0QsSUFBSSxDQUFDQyxFQUFFO1lBQ25DLENBQ0YsQ0FBQztZQUNELElBQUksQ0FBQytCLHNCQUFzQixDQUFDdUQsR0FBRyxDQUFFUixZQUFZLEVBQUVkLGFBQWMsQ0FBQztVQUNoRTs7VUFFQTtVQUNBLElBQUssQ0FBQ2MsWUFBWSxDQUFDUyxhQUFhLENBQUV6QixLQUFNLENBQUMsRUFBRztZQUMxQ2dCLFlBQVksQ0FBQ1UsYUFBYSxDQUN4QlYsWUFBWSxDQUFDVixVQUFVLENBQUNDLENBQUMsR0FBR1AsS0FBSyxDQUFDUSxRQUFRLENBQUNELENBQUMsRUFDNUNOLHVCQUF1QixFQUN2QkQsS0FDRixDQUFDO1VBQ0g7UUFDRixDQUFFLENBQUM7TUFDTCxDQUFDLE1BQ0k7UUFFSDtRQUNBO1FBQ0EsSUFBSSxDQUFDbEQsU0FBUyxDQUFDeUMsT0FBTyxDQUFFQyxJQUFJLElBQUk7VUFDOUIsSUFBS0EsSUFBSSxDQUFDaUMsYUFBYSxDQUFFekIsS0FBTSxDQUFDLEVBQUc7WUFDakNSLElBQUksQ0FBQ21DLGdCQUFnQixDQUFFM0IsS0FBTSxDQUFDO1VBQ2hDO1FBQ0YsQ0FBRSxDQUFDO01BQ0w7SUFDRjtFQUNGOztFQUVBO0FBQ0Y7QUFDQTtFQUNVTixnQ0FBZ0NBLENBQUEsRUFBUztJQUUvQztJQUNBO0lBQ0EsTUFBTWtDLGlCQUFpQixHQUFHQyxnQ0FBZ0MsQ0FBRSxJQUFJLENBQUNDLHFCQUFxQixDQUFDekIsS0FBTSxDQUFDOztJQUU5RjtJQUNBLElBQUksQ0FBQzlCLDBCQUEwQixDQUFDZ0IsT0FBTyxDQUFFd0MsV0FBVyxJQUFJO01BRXREO01BQ0E7TUFDQSxJQUFLLElBQUksQ0FBQ0QscUJBQXFCLENBQUN6QixLQUFLLEtBQUssQ0FBQyxJQUN0QzBCLFdBQVcsQ0FBQzVCLFVBQVUsQ0FBQ0csVUFBVSxDQUFDQyxDQUFDLEdBQUd3QixXQUFXLENBQUNDLGVBQWUsQ0FBQ0MsUUFBUSxFQUFHO1FBRWhGO1FBQ0FGLFdBQVcsQ0FBQ0csV0FBVyxDQUFDekIsU0FBUyxHQUFHLEtBQUs7O1FBRXpDO1FBQ0E7UUFDQSxJQUFLc0IsV0FBVyxDQUFDNUIsVUFBVSxDQUFDc0IsYUFBYSxDQUFFTSxXQUFXLENBQUNDLGVBQWdCLENBQUMsRUFBRztVQUN6RUQsV0FBVyxDQUFDNUIsVUFBVSxDQUFDd0IsZ0JBQWdCLENBQUVJLFdBQVcsQ0FBQ0MsZUFBZ0IsQ0FBQztRQUN4RTs7UUFFQTtRQUNBLElBQUksQ0FBQ3pELDBCQUEwQixDQUFDNEQsTUFBTSxDQUFFSixXQUFZLENBQUM7TUFDdkQsQ0FBQyxNQUNJO1FBRUg7UUFDQUEsV0FBVyxDQUFDNUIsVUFBVSxDQUFDaUMsY0FBYyxDQUFFTCxXQUFXLENBQUNDLGVBQWUsRUFBRUosaUJBQWtCLENBQUM7O1FBRXZGO1FBQ0EsTUFBTVMsZ0NBQWdDLEdBQ3BDTixXQUFXLENBQUM1QixVQUFVLENBQUNtQyxzQkFBc0IsQ0FBRVAsV0FBVyxDQUFDQyxlQUFlLENBQUNDLFFBQVMsQ0FBQztRQUN2RixNQUFNTSxvQkFBb0IsR0FBR0YsZ0NBQWdDLEdBQUdULGlCQUFpQjtRQUNqRixJQUFLRyxXQUFXLENBQUNHLFdBQVcsQ0FBQ2IsZ0JBQWdCLEtBQUtrQixvQkFBb0IsRUFBRztVQUN2RVIsV0FBVyxDQUFDRyxXQUFXLENBQUNNLG1CQUFtQixDQUFFRCxvQkFBcUIsQ0FBQztRQUNyRTtNQUNGO0lBQ0YsQ0FBRSxDQUFDOztJQUVIO0lBQ0EsTUFBTUUsa0JBQWtCLEdBQUcsSUFBSSxDQUFDM0YsU0FBUyxDQUFDOEMsTUFBTSxDQUFFSixJQUFJLElBQUlBLElBQUksQ0FBQ2tELFVBQVUsSUFBSWxELElBQUksQ0FBQ3hDLE1BQU0sQ0FBQ3VELENBQUMsS0FBSyxDQUFFLENBQUM7O0lBRWxHO0lBQ0E7SUFDQWtDLGtCQUFrQixDQUFDbEQsT0FBTyxDQUFFb0QsaUJBQWlCLElBQUk7TUFFL0MsTUFBTUMsb0JBQW9CLEdBQUcsSUFBSSxDQUFDckUsMEJBQTBCLENBQUNzRSxNQUFNLENBQ2pFLENBQUVDLEtBQUssRUFBRWYsV0FBVyxLQUFNZSxLQUFLLElBQUlmLFdBQVcsQ0FBQzVCLFVBQVUsS0FBS3dDLGlCQUFpQixFQUMvRSxLQUNGLENBQUM7O01BRUQ7TUFDQTtNQUNBO01BQ0EsSUFBSyxDQUFDQyxvQkFBb0IsRUFBRztRQUUzQjtRQUNBO1FBQ0EsSUFBSSxDQUFDOUQsUUFBUSxDQUFDaUUsUUFBUSxDQUFFSixpQkFBaUIsQ0FBQ3JDLFVBQVcsQ0FBQztRQUN0RHFDLGlCQUFpQixDQUFDSyxXQUFXLENBQUUsSUFBSSxDQUFDbkUsV0FBWSxDQUFDO1FBQ2pELElBQUksQ0FBQ0MsUUFBUSxDQUFDbUUsTUFBTSxDQUFFLElBQUksQ0FBQ3BFLFdBQVksQ0FBQzs7UUFFeEM7UUFDQSxJQUFJLENBQUNWLDBCQUEwQixDQUFDb0IsT0FBTyxDQUFFLENBQUUyRCxNQUFNLEVBQUVDLEtBQUssS0FBTTtVQUU1RCxJQUFLQSxLQUFLLENBQUNDLGtDQUFrQyxDQUFDL0MsS0FBSyxHQUFHLENBQUMsRUFBRztZQUV4RDtZQUNBLElBQUksQ0FBQ3RCLG1CQUFtQixDQUFDc0UsS0FBSyxDQUFFSCxNQUFNLENBQUNJLEdBQUcsRUFBRUgsS0FBSyxDQUFDbEIsUUFBUyxDQUFDO1lBQzVELElBQUksQ0FBQ2pELGlCQUFpQixDQUFDcUUsS0FBSyxDQUFFSCxNQUFNLENBQUNLLEdBQUcsRUFBRUosS0FBSyxDQUFDbEIsUUFBUyxDQUFDO1lBQzFELElBQUksQ0FBQ2hELGNBQWMsQ0FBQzhELFFBQVEsQ0FBRSxJQUFJLENBQUNoRSxtQkFBb0IsQ0FBQztZQUN4RCxJQUFJLENBQUNFLGNBQWMsQ0FBQ2dFLE1BQU0sQ0FBRSxJQUFJLENBQUNqRSxpQkFBa0IsQ0FBQzs7WUFFcEQ7WUFDQSxNQUFNd0UsWUFBWSxHQUFHeEksSUFBSSxDQUFDeUksU0FBUyxDQUFFLElBQUksQ0FBQzNFLFFBQVEsRUFBRSxJQUFJLENBQUNHLGNBQWUsQ0FBQztZQUN6RSxJQUFLdUUsWUFBWSxDQUFDMUMsTUFBTSxHQUFHLENBQUMsRUFBRztjQUU3QjRDLE1BQU0sSUFBSUEsTUFBTSxDQUFFRixZQUFZLENBQUMxQyxNQUFNLEtBQUssQ0FBQyxFQUFFLHlDQUEwQyxDQUFDO2NBRXhGLE1BQU02Qyw2QkFBNkIsR0FBRyxDQUFFLElBQUksQ0FBQzFFLGNBQWMsQ0FBQzJFLEtBQUssQ0FBQ3JELENBQUMsR0FBR29DLGlCQUFpQixDQUFDckMsVUFBVSxDQUFDQyxDQUFDLElBQzlEb0MsaUJBQWlCLENBQUMxRixvQkFBb0IsQ0FBQ3NELENBQUM7Y0FDOUUsTUFBTXNELDhCQUE4QixHQUFHLENBQUUsSUFBSSxDQUFDNUUsY0FBYyxDQUFDMkUsS0FBSyxDQUFDckQsQ0FBQyxHQUFHb0MsaUJBQWlCLENBQUMzRixNQUFNLENBQUN1RCxDQUFDLElBQzFEb0MsaUJBQWlCLENBQUMxRixvQkFBb0IsQ0FBQ3NELENBQUM7O2NBRS9FO2NBQ0EsTUFBTXVELDhCQUE4QixHQUFHLElBQUksQ0FBQ2hILFNBQVMsQ0FBQ3NFLGlCQUFpQixDQUNyRXVCLGlCQUFpQixDQUFDNUYsVUFBVSxFQUM1QnlHLFlBQVksQ0FBRSxDQUFDLENBQUUsQ0FBQ08sS0FBSyxFQUN2QixJQUFJaEosT0FBTyxDQUFFNEgsaUJBQWlCLENBQUMxRixvQkFBb0IsQ0FBQzhELENBQUMsRUFBRSxDQUFDNEIsaUJBQWlCLENBQUMxRixvQkFBb0IsQ0FBQ3NELENBQUUsQ0FBQyxFQUNsRyxDQUFDLEVBQ0Q7Z0JBQ0U7Z0JBQ0FjLGdCQUFnQixFQUFFc0IsaUJBQWlCLENBQUN0QixnQkFBZ0IsR0FBR08saUJBQWlCO2dCQUV4RTtnQkFDQU4sa0JBQWtCLEVBQUUsQ0FBRXFCLGlCQUFpQixDQUFDcEIsVUFBVSxDQUFFc0MsOEJBQStCLENBQUMsR0FBRzVILElBQUksQ0FBQ0MsRUFBRSxLQUN4RSxDQUFDLEdBQUdELElBQUksQ0FBQ0MsRUFBRTtjQUNuQyxDQUNGLENBQUM7O2NBRUQ7Y0FDQXlHLGlCQUFpQixDQUFDakIsYUFBYSxDQUM3QmlDLDZCQUE2QixFQUM3QixJQUFJLENBQUM3QixxQkFBcUIsQ0FBQ3pCLEtBQUssR0FBR3RFLHNDQUFzQyxFQUN6RW9ILEtBQ0YsQ0FBQzs7Y0FFRDtjQUNBLElBQUksQ0FBQzVFLDBCQUEwQixDQUFDeUYsSUFBSSxDQUFFLElBQUl2Rix5QkFBeUIsQ0FDakUwRSxLQUFLLEVBQ0xSLGlCQUFpQixFQUNqQm1CLDhCQUNGLENBQUUsQ0FBQztZQUNMO1VBQ0Y7UUFDRixDQUFFLENBQUM7TUFDTDtJQUNGLENBQUUsQ0FBQztFQUNMOztFQUVBO0FBQ0Y7QUFDQTtFQUNVbkUsNkJBQTZCQSxDQUFBLEVBQVM7SUFFNUM7SUFDQSxJQUFJLENBQUN6Qix3QkFBd0IsQ0FBQ3FCLE9BQU8sQ0FBRSxDQUFFVyxhQUFhLEVBQUVDLFVBQVUsS0FBTTtNQUN0RSxJQUFLLElBQUksQ0FBQzhELFdBQVcsQ0FBQ0MsY0FBYyxDQUFDN0QsS0FBSyxHQUFHN0UsV0FBVyxDQUFDMkksK0JBQStCLElBQ25GLENBQUMsSUFBSSxDQUFDckgsU0FBUyxDQUFDc0gsUUFBUSxDQUFFakUsVUFBVyxDQUFDLEVBQUc7UUFFNUM7UUFDQTtRQUNBRCxhQUFhLENBQUNPLFNBQVMsR0FBRyxLQUFLO1FBQy9CLElBQUksQ0FBQ3ZDLHdCQUF3QixDQUFDd0MsTUFBTSxDQUFFUCxVQUFXLENBQUM7TUFDcEQ7SUFDRixDQUFFLENBQUM7O0lBRUg7SUFDQSxJQUFLLElBQUksQ0FBQzhELFdBQVcsQ0FBQ0MsY0FBYyxDQUFDN0QsS0FBSyxJQUFJN0UsV0FBVyxDQUFDMkksK0JBQStCLEVBQUc7TUFFMUY7TUFDQTtNQUNBO01BQ0EsTUFBTUUsc0JBQXNCLEdBQUcsSUFBSSxDQUFDdkgsU0FBUyxDQUFDOEMsTUFBTSxDQUFFSixJQUFJLElBQ3hEQSxJQUFJLENBQUNvQixTQUFTLElBQ2RwQixJQUFJLENBQUN4QyxNQUFNLENBQUMrRCxDQUFDLEdBQUcsQ0FBQyxJQUNqQnZCLElBQUksQ0FBQ3hDLE1BQU0sQ0FBQ3VELENBQUMsS0FBSyxJQUFJLENBQUMzQyxhQUFhLENBQUNpRCxpQkFBaUIsSUFDdERyQixJQUFJLENBQUN2QyxvQkFBb0IsQ0FBQ3NELENBQUMsR0FBRyxDQUFDLElBQy9CZixJQUFJLENBQUN3RCxXQUFXLENBQUMsQ0FBQyxDQUFDekMsQ0FBQyxLQUFLLENBQzNCLENBQUM7O01BRUQ7TUFDQThELHNCQUFzQixDQUFDOUUsT0FBTyxDQUFFeUIsWUFBWSxJQUFJO1FBRTlDO1FBQ0EsSUFBSyxDQUFDLElBQUksQ0FBQzlDLHdCQUF3QixDQUFDK0MsR0FBRyxDQUFFRCxZQUFhLENBQUMsRUFBRztVQUN4RCxNQUFNRSxTQUFTLEdBQUc1Rix5QkFBeUIsQ0FBQ2dDLDZCQUE2QixDQUFDNkQsT0FBTyxDQUFFbEYsSUFBSSxDQUFDQyxFQUFFLEdBQUcsSUFBSyxDQUFDO1VBQ25HLE1BQU1nRSxhQUFhLEdBQUcsSUFBSSxDQUFDcEQsU0FBUyxDQUFDc0UsaUJBQWlCLENBQ3BESixZQUFZLENBQUNqRSxVQUFVLEVBQ3ZCLElBQUloQyxPQUFPLENBQUVpRyxZQUFZLENBQUNoRSxNQUFNLENBQUMrRCxDQUFDLEVBQUUsQ0FBRSxDQUFDLEVBQ3ZDRyxTQUFTLEVBQ1R6RixXQUFXLENBQUM4QixvQkFBb0IsRUFDaEM7WUFDRThELGdCQUFnQixFQUFFLElBQUk7WUFBRTtZQUN4QkMsa0JBQWtCLEVBQUUsQ0FBRU4sWUFBWSxDQUFDTyxVQUFVLENBQUU5RixXQUFXLENBQUM4QixvQkFBcUIsQ0FBQyxHQUFHdEIsSUFBSSxDQUFDQyxFQUFFLElBQUtGO1VBQ2xHLENBQ0YsQ0FBQztVQUNELElBQUksQ0FBQ2tDLHdCQUF3QixDQUFDc0QsR0FBRyxDQUFFUixZQUFZLEVBQUVkLGFBQWMsQ0FBQztRQUNsRTtNQUNGLENBQUUsQ0FBQztJQUNMO0VBQ0Y7O0VBRUE7QUFDRjtFQUNrQm9FLEtBQUtBLENBQUEsRUFBUztJQUM1QixNQUFNQyx3QkFBd0IsR0FBRyxJQUFJLENBQUN6SCxTQUFTLENBQUN1QyxLQUFLO0lBQ3JELEtBQUssQ0FBQ2lGLEtBQUssQ0FBQyxDQUFDO0lBQ2IsSUFBSSxDQUFDeEgsU0FBUyxDQUFDMEgsS0FBSyxDQUFDLENBQUM7SUFDdEIsSUFBSSxDQUFDQyxpQ0FBaUMsQ0FBQ0gsS0FBSyxDQUFDLENBQUM7SUFDOUMsSUFBSSxDQUFDckcsc0JBQXNCLENBQUN1RyxLQUFLLENBQUMsQ0FBQztJQUNuQyxJQUFJLENBQUN0Ryx3QkFBd0IsQ0FBQ3NHLEtBQUssQ0FBQyxDQUFDO0lBQ3JDLElBQUksQ0FBQzVHLGFBQWEsQ0FBQzBHLEtBQUssQ0FBQyxDQUFDO0lBQzFCLElBQUksQ0FBQ3ZHLGdCQUFnQixDQUFDdUcsS0FBSyxDQUFDLENBQUM7SUFDN0IsSUFBSSxDQUFDL0YsMEJBQTBCLENBQUNpRyxLQUFLLENBQUMsQ0FBQztJQUN2QyxJQUFLRCx3QkFBd0IsR0FBRyxDQUFDLEVBQUc7TUFDbEMsSUFBSSxDQUFDNUcsbUJBQW1CLENBQUNvQyxJQUFJLENBQUMsQ0FBQztJQUNqQztFQUNGOztFQUVBO0FBQ0Y7QUFDQTtFQUNrQjJFLGFBQWFBLENBQUEsRUFBMEI7SUFDckQsT0FBT3pKLGNBQWMsQ0FBeUIsS0FBSyxDQUFDeUosYUFBYSxDQUFDLENBQUMsRUFBRTtNQUNuRTlHLGFBQWEsRUFBRWpDLFlBQVksQ0FBQ2dKLGNBQWMsQ0FBQ0QsYUFBYSxDQUFFLElBQUksQ0FBQzlHLGFBQWMsQ0FBQztNQUM5RUcsZ0JBQWdCLEVBQUVwQyxZQUFZLENBQUNnSixjQUFjLENBQUNELGFBQWEsQ0FBRSxJQUFJLENBQUMzRyxnQkFBaUIsQ0FBQztNQUNwRkUsc0JBQXNCLEVBQUU3QyxLQUFLLENBQUVDLFdBQVcsQ0FBRVMsSUFBSSxDQUFDNEIsTUFBTyxDQUFDLEVBQUVyQyxXQUFXLENBQUVTLElBQUksQ0FBQzRCLE1BQU8sQ0FBRSxDQUFDLENBQUNnSCxhQUFhLENBQUUsSUFBSSxDQUFDekcsc0JBQXVCLENBQUM7TUFDcElDLHdCQUF3QixFQUFFOUMsS0FBSyxDQUFFQyxXQUFXLENBQUVTLElBQUksQ0FBQzRCLE1BQU8sQ0FBQyxFQUFFckMsV0FBVyxDQUFFUyxJQUFJLENBQUM0QixNQUFPLENBQUUsQ0FBQyxDQUFDZ0gsYUFBYSxDQUFFLElBQUksQ0FBQ3hHLHdCQUF5QjtJQUN6SSxDQUFFLENBQUM7RUFDTDs7RUFFQTtBQUNGO0FBQ0E7RUFDa0IwRyxVQUFVQSxDQUFFQyxXQUFrQyxFQUFTO0lBQ3JFLElBQUksQ0FBQ2pILGFBQWEsQ0FBQ2dILFVBQVUsQ0FBRUMsV0FBVyxDQUFDakgsYUFBYyxDQUFDO0lBQzFELElBQUksQ0FBQ0csZ0JBQWdCLENBQUM2RyxVQUFVLENBQUVDLFdBQVcsQ0FBQzlHLGdCQUFpQixDQUFDO0lBQ2hFLElBQUksQ0FBQ0Usc0JBQXNCLEdBQUc3QyxLQUFLLENBQUVDLFdBQVcsQ0FBRVMsSUFBSSxDQUFDNEIsTUFBTyxDQUFDLEVBQUVyQyxXQUFXLENBQUVTLElBQUksQ0FBQzRCLE1BQU8sQ0FBRSxDQUFDLENBQUNvSCxlQUFlLENBQUVELFdBQVcsQ0FBQzVHLHNCQUMzSCxDQUFDO0lBQ0QsSUFBSSxDQUFDQyx3QkFBd0IsR0FBRzlDLEtBQUssQ0FBRUMsV0FBVyxDQUFFUyxJQUFJLENBQUM0QixNQUFPLENBQUMsRUFBRXJDLFdBQVcsQ0FBRVMsSUFBSSxDQUFDNEIsTUFBTyxDQUFFLENBQUMsQ0FBQ29ILGVBQWUsQ0FBRUQsV0FBVyxDQUFDM0csd0JBQzdILENBQUM7SUFDRCxLQUFLLENBQUMwRyxVQUFVLENBQUVDLFdBQVksQ0FBQztFQUNqQzs7RUFFQTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRSxPQUF1QmpJLFlBQVksR0FBRyxJQUFJekIsTUFBTSxDQUFFLGNBQWMsRUFBRTtJQUM5RDRKLFNBQVMsRUFBRXZJLFVBQVU7SUFDckJrSSxhQUFhLEVBQUlNLFVBQXNCLElBQU1BLFVBQVUsQ0FBQ04sYUFBYSxDQUFDLENBQUM7SUFDdkVFLFVBQVUsRUFBRUEsQ0FBRUksVUFBc0IsRUFBRUgsV0FBa0MsS0FBTUcsVUFBVSxDQUFDSixVQUFVLENBQUVDLFdBQVksQ0FBQztJQUNsSEksV0FBVyxFQUFFO01BQ1hySCxhQUFhLEVBQUVqQyxZQUFZLENBQUNnSixjQUFjO01BQzFDNUcsZ0JBQWdCLEVBQUVwQyxZQUFZLENBQUNnSixjQUFjO01BQzdDMUcsc0JBQXNCLEVBQUU3QyxLQUFLLENBQUVDLFdBQVcsQ0FBRVMsSUFBSSxDQUFDNEIsTUFBTyxDQUFDLEVBQUVyQyxXQUFXLENBQUVTLElBQUksQ0FBQzRCLE1BQU8sQ0FBRSxDQUFDO01BQ3ZGUSx3QkFBd0IsRUFBRTlDLEtBQUssQ0FBRUMsV0FBVyxDQUFFUyxJQUFJLENBQUM0QixNQUFPLENBQUMsRUFBRXJDLFdBQVcsQ0FBRVMsSUFBSSxDQUFDNEIsTUFBTyxDQUFFLENBQUM7TUFDekYsR0FBR2pDLFdBQVcsQ0FBQ3lKO0lBQ2pCO0VBQ0YsQ0FDRixDQUFDOztFQUVEO0VBQ0EsT0FBdUIvSSxnQ0FBZ0MsR0FBR0EsZ0NBQWdDO0VBQzFGLE9BQXVCSSw0QkFBNEIsR0FBR0EsNEJBQTRCO0FBQ3BGO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNc0YsZ0NBQWdDLEdBQUtzRCxhQUFxQixJQUFjO0VBRTVFO0VBQ0E7RUFDQSxPQUFPLENBQUMsSUFBSSxHQUFHbEosSUFBSSxDQUFDbUosR0FBRyxDQUFFRCxhQUFhLEVBQUUsQ0FBRSxDQUFDLEdBQUcsSUFBSSxHQUFHQSxhQUFhO0FBQ3BFLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsTUFBTTFHLHlCQUF5QixDQUFDO0VBS3ZCaEMsV0FBV0EsQ0FBRXVGLGVBQTZDLEVBQUU3QixVQUFnQixFQUFFK0IsV0FBaUIsRUFBRztJQUN2RyxJQUFJLENBQUNGLGVBQWUsR0FBR0EsZUFBZTtJQUN0QyxJQUFJLENBQUM3QixVQUFVLEdBQUdBLFVBQVU7SUFDNUIsSUFBSSxDQUFDK0IsV0FBVyxHQUFHQSxXQUFXO0VBQ2hDO0VBRU93QyxhQUFhQSxDQUFBLEVBQXlDO0lBQzNELE9BQU87TUFDTDFDLGVBQWUsRUFBRTNHLFdBQVcsQ0FBRUYsTUFBTSxDQUFDa0ssUUFBUyxDQUFDLENBQUNYLGFBQWEsQ0FBRSxJQUFJLENBQUMxQyxlQUFnQixDQUFDO01BQ3JGN0IsVUFBVSxFQUFFOUUsV0FBVyxDQUFFUyxJQUFJLENBQUM0QixNQUFPLENBQUMsQ0FBQ2dILGFBQWEsQ0FBRSxJQUFJLENBQUN2RSxVQUFXLENBQUM7TUFDdkUrQixXQUFXLEVBQUU3RyxXQUFXLENBQUVTLElBQUksQ0FBQzRCLE1BQU8sQ0FBQyxDQUFDZ0gsYUFBYSxDQUFFLElBQUksQ0FBQ3hDLFdBQVk7SUFDMUUsQ0FBQztFQUNIO0VBRUEsT0FBdUJ4RCwyQkFBMkIsR0FBRyxJQUFJdkQsTUFBTSxDQUFFLDZCQUE2QixFQUFFO0lBQzlGNEosU0FBUyxFQUFFdEcseUJBQXlCO0lBQ3BDd0csV0FBVyxFQUFFO01BQ1hqRCxlQUFlLEVBQUUzRyxXQUFXLENBQUVGLE1BQU0sQ0FBQ2tLLFFBQVMsQ0FBQztNQUMvQ2xGLFVBQVUsRUFBRTlFLFdBQVcsQ0FBRVMsSUFBSSxDQUFDNEIsTUFBTyxDQUFDO01BQ3RDd0UsV0FBVyxFQUFFN0csV0FBVyxDQUFFUyxJQUFJLENBQUM0QixNQUFPO0lBQ3hDLENBQUM7SUFDRGdILGFBQWEsRUFBSVkseUJBQW9ELElBQU1BLHlCQUF5QixDQUFDWixhQUFhLENBQUMsQ0FBQztJQUNwSEksZUFBZSxFQUFJRCxXQUFpRCxJQUFNLElBQUlwRyx5QkFBeUIsQ0FDckdwRCxXQUFXLENBQUVGLE1BQU0sQ0FBQ2tLLFFBQVMsQ0FBQyxDQUFDUCxlQUFlLENBQUVELFdBQVcsQ0FBQzdDLGVBQWdCLENBQUMsRUFDN0UzRyxXQUFXLENBQUVTLElBQUksQ0FBQzRCLE1BQU8sQ0FBQyxDQUFDb0gsZUFBZSxDQUFFRCxXQUFXLENBQUMxRSxVQUFXLENBQUMsRUFDcEU5RSxXQUFXLENBQUVTLElBQUksQ0FBQzRCLE1BQU8sQ0FBQyxDQUFDb0gsZUFBZSxDQUFFRCxXQUFXLENBQUMzQyxXQUFZLENBQUU7RUFDMUUsQ0FBRSxDQUFDO0FBQ0w7QUFRQXhHLGdCQUFnQixDQUFDNkosUUFBUSxDQUFFLFlBQVksRUFBRS9JLFVBQVcsQ0FBQztBQUNyRCxlQUFlQSxVQUFVIn0=