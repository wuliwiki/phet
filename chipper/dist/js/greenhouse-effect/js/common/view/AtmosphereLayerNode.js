// Copyright 2021-2023, University of Colorado Boulder

/**
 * Node that represents a layer in the atmosphere that absorbs and emits energy.
 *
 * @author John Blanco
 */

import BooleanProperty from '../../../../axon/js/BooleanProperty.js';
import DerivedProperty from '../../../../axon/js/DerivedProperty.js';
import PatternStringProperty from '../../../../axon/js/PatternStringProperty.js';
import Range from '../../../../dot/js/Range.js';
import optionize from '../../../../phet-core/js/optionize.js';
import NumberDisplay from '../../../../scenery-phet/js/NumberDisplay.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import { Color, HBox, Node, Rectangle } from '../../../../scenery/js/imports.js';
import greenhouseEffect from '../../greenhouseEffect.js';
import GreenhouseEffectStrings from '../../GreenhouseEffectStrings.js';
import ShowTemperatureCheckbox from '../../layer-model/view/ShowTemperatureCheckbox.js';
import GreenhouseEffectUtils from '../GreenhouseEffectUtils.js';
import EnergyAbsorbingEmittingLayer from '../model/EnergyAbsorbingEmittingLayer.js';
import TemperatureUnits from '../model/TemperatureUnits.js';

// constants
const DEFAULT_LAYER_THICKNESS = 26; // in screen coordinates, empirically determined to match design spec
const LAYER_RECTANGLE_STROKE_BASE_COLOR = Color.DARK_GRAY;
const LAYER_RECTANGLE_FILL_BASE_COLOR = Color.LIGHT_GRAY;
const MINIMUM_OPACITY = 0.4;
const MAXIMUM_OPACITY = 0.85;
const TEMPERATURE_DISPLAY_DEFAULT_INDENT = 20; // Y offset for the temperature control, in screen coordinates

class AtmosphereLayerNode extends Node {
  // the checkbox, icon, and readout for displaying the temperature of the layer

  // the readout portion of the temperature display

  constructor(atmosphereLayer, temperatureUnitsProperty, modelViewTransform, providedOptions) {
    const options = optionize()({
      layerThickness: DEFAULT_LAYER_THICKNESS,
      numberDisplayEnabledProperty: null
    }, providedOptions);

    // If there is an option provided to enable the display, use it, otherwise create an always-true Property.
    const numberDisplayEnabledProperty = options.numberDisplayEnabledProperty || new BooleanProperty(true);

    // If a thickness value is provided, use the model-view transform to convert it to view coordinates, otherwise use
    // the default.
    let layerThickness = DEFAULT_LAYER_THICKNESS;
    if (options && options.layerThickness) {
      layerThickness = -modelViewTransform.modelToViewDeltaY(options.layerThickness);
    }
    const mainBody = new Rectangle(0, -layerThickness / 2, modelViewTransform.modelToViewDeltaX(EnergyAbsorbingEmittingLayer.WIDTH), layerThickness, {
      stroke: LAYER_RECTANGLE_STROKE_BASE_COLOR,
      fill: LAYER_RECTANGLE_FILL_BASE_COLOR,
      centerY: modelViewTransform.modelToViewY(atmosphereLayer.altitude)
    });

    // Adjust the opacity of the stroke and fill based on the absorbance.
    atmosphereLayer.energyAbsorptionProportionProperty.link(energyAbsorptionProportion => {
      // Map the proportion to an opacity.  We don't want to go 100% opaque or the photons would be obscured when they
      // pass through the layer, so this mapping was empirically determined to look decent.
      const opacity = MINIMUM_OPACITY + energyAbsorptionProportion * (MAXIMUM_OPACITY - MINIMUM_OPACITY);
      mainBody.fill = LAYER_RECTANGLE_FILL_BASE_COLOR.withAlpha(opacity);
      mainBody.stroke = LAYER_RECTANGLE_STROKE_BASE_COLOR.withAlpha(opacity);
    });

    // Create the property and associated checkbox that will control whether the temperature readout is visible.
    const showTemperatureProperty = new BooleanProperty(true, {
      tandem: options.tandem.createTandem('showTemperatureProperty')
    });
    const showTemperatureCheckbox = new ShowTemperatureCheckbox(showTemperatureProperty, {
      tandem: options.tandem.createTandem('showTemperatureCheckbox')
    });

    // Create a derived property for the value that will be displayed as the temperature.
    const temperatureValueProperty = new DerivedProperty([atmosphereLayer.temperatureProperty, temperatureUnitsProperty, numberDisplayEnabledProperty], (temperature, temperatureUnits, numberDisplayEnabled) => {
      let temperatureValue = null;
      if (numberDisplayEnabled) {
        temperatureValue = temperatureUnits === TemperatureUnits.KELVIN ? temperature : temperatureUnits === TemperatureUnits.CELSIUS ? GreenhouseEffectUtils.kelvinToCelsius(temperature) : GreenhouseEffectUtils.kelvinToFahrenheit(temperature);
      }
      return temperatureValue;
    });

    // Create the temperature readout.
    const temperatureReadout = new NumberDisplay(temperatureValueProperty, new Range(0, 999), {
      visibleProperty: showTemperatureProperty,
      backgroundStroke: Color.BLACK,
      minBackgroundWidth: 70,
      // empirically determined to fit largest number
      valuePattern: new PatternStringProperty(GreenhouseEffectStrings.temperature.units.valueUnitsPatternStringProperty, {
        units: new DerivedProperty([temperatureUnitsProperty, numberDisplayEnabledProperty, GreenhouseEffectStrings.temperature.units.kelvinStringProperty, GreenhouseEffectStrings.temperature.units.celsiusStringProperty, GreenhouseEffectStrings.temperature.units.fahrenheitStringProperty], (temperatureUnits, numberDisplayEnabled, kelvinString, celsiusString, fahrenheitString) => {
          return !numberDisplayEnabled ? '' : temperatureUnits === TemperatureUnits.KELVIN ? kelvinString : temperatureUnits === TemperatureUnits.CELSIUS ? celsiusString : fahrenheitString;
        })
      }),
      decimalPlaces: 1,
      cornerRadius: 3,
      noValueAlign: 'center',
      textOptions: {
        font: new PhetFont(14),
        maxWidth: 120
      }
    });
    const temperatureDisplay = new HBox({
      children: [showTemperatureCheckbox, temperatureReadout],
      spacing: 15,
      centerY: mainBody.centerY,
      left: TEMPERATURE_DISPLAY_DEFAULT_INDENT
    });

    // supertype constructor
    super({
      children: [mainBody, temperatureDisplay]
    });

    // This node should only be visible when the atmosphere layer is active.
    atmosphereLayer.isActiveProperty.linkAttribute(this, 'visible');

    // Make the temperature property available for reset.
    this.showTemperatureProperty = showTemperatureProperty;

    // Make the temperature display available externally so that external nodes can be aligned with it.
    this.temperatureDisplay = temperatureDisplay;

    // Make the temperature readout available to a method that needs it.
    this.temperatureReadout = temperatureReadout;
  }

  /**
   * Get the center X position in global coordinate space of the temperature readout.  This is an oddly specific piece
   * of information, but is needed for alignment of some visual elements.
   */
  getTemperatureReadoutCenter() {
    return this.temperatureReadout.parentToGlobalPoint(this.temperatureReadout.getCenter());
  }

  /**
   * Restore initial state.
   */
  reset() {
    this.showTemperatureProperty.reset();
  }
  static TEMPERATURE_DISPLAY_DEFAULT_INDENT = TEMPERATURE_DISPLAY_DEFAULT_INDENT;
}
greenhouseEffect.register('AtmosphereLayerNode', AtmosphereLayerNode);
export default AtmosphereLayerNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJEZXJpdmVkUHJvcGVydHkiLCJQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJSYW5nZSIsIm9wdGlvbml6ZSIsIk51bWJlckRpc3BsYXkiLCJQaGV0Rm9udCIsIkNvbG9yIiwiSEJveCIsIk5vZGUiLCJSZWN0YW5nbGUiLCJncmVlbmhvdXNlRWZmZWN0IiwiR3JlZW5ob3VzZUVmZmVjdFN0cmluZ3MiLCJTaG93VGVtcGVyYXR1cmVDaGVja2JveCIsIkdyZWVuaG91c2VFZmZlY3RVdGlscyIsIkVuZXJneUFic29yYmluZ0VtaXR0aW5nTGF5ZXIiLCJUZW1wZXJhdHVyZVVuaXRzIiwiREVGQVVMVF9MQVlFUl9USElDS05FU1MiLCJMQVlFUl9SRUNUQU5HTEVfU1RST0tFX0JBU0VfQ09MT1IiLCJEQVJLX0dSQVkiLCJMQVlFUl9SRUNUQU5HTEVfRklMTF9CQVNFX0NPTE9SIiwiTElHSFRfR1JBWSIsIk1JTklNVU1fT1BBQ0lUWSIsIk1BWElNVU1fT1BBQ0lUWSIsIlRFTVBFUkFUVVJFX0RJU1BMQVlfREVGQVVMVF9JTkRFTlQiLCJBdG1vc3BoZXJlTGF5ZXJOb2RlIiwiY29uc3RydWN0b3IiLCJhdG1vc3BoZXJlTGF5ZXIiLCJ0ZW1wZXJhdHVyZVVuaXRzUHJvcGVydHkiLCJtb2RlbFZpZXdUcmFuc2Zvcm0iLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwibGF5ZXJUaGlja25lc3MiLCJudW1iZXJEaXNwbGF5RW5hYmxlZFByb3BlcnR5IiwibW9kZWxUb1ZpZXdEZWx0YVkiLCJtYWluQm9keSIsIm1vZGVsVG9WaWV3RGVsdGFYIiwiV0lEVEgiLCJzdHJva2UiLCJmaWxsIiwiY2VudGVyWSIsIm1vZGVsVG9WaWV3WSIsImFsdGl0dWRlIiwiZW5lcmd5QWJzb3JwdGlvblByb3BvcnRpb25Qcm9wZXJ0eSIsImxpbmsiLCJlbmVyZ3lBYnNvcnB0aW9uUHJvcG9ydGlvbiIsIm9wYWNpdHkiLCJ3aXRoQWxwaGEiLCJzaG93VGVtcGVyYXR1cmVQcm9wZXJ0eSIsInRhbmRlbSIsImNyZWF0ZVRhbmRlbSIsInNob3dUZW1wZXJhdHVyZUNoZWNrYm94IiwidGVtcGVyYXR1cmVWYWx1ZVByb3BlcnR5IiwidGVtcGVyYXR1cmVQcm9wZXJ0eSIsInRlbXBlcmF0dXJlIiwidGVtcGVyYXR1cmVVbml0cyIsIm51bWJlckRpc3BsYXlFbmFibGVkIiwidGVtcGVyYXR1cmVWYWx1ZSIsIktFTFZJTiIsIkNFTFNJVVMiLCJrZWx2aW5Ub0NlbHNpdXMiLCJrZWx2aW5Ub0ZhaHJlbmhlaXQiLCJ0ZW1wZXJhdHVyZVJlYWRvdXQiLCJ2aXNpYmxlUHJvcGVydHkiLCJiYWNrZ3JvdW5kU3Ryb2tlIiwiQkxBQ0siLCJtaW5CYWNrZ3JvdW5kV2lkdGgiLCJ2YWx1ZVBhdHRlcm4iLCJ1bml0cyIsInZhbHVlVW5pdHNQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJrZWx2aW5TdHJpbmdQcm9wZXJ0eSIsImNlbHNpdXNTdHJpbmdQcm9wZXJ0eSIsImZhaHJlbmhlaXRTdHJpbmdQcm9wZXJ0eSIsImtlbHZpblN0cmluZyIsImNlbHNpdXNTdHJpbmciLCJmYWhyZW5oZWl0U3RyaW5nIiwiZGVjaW1hbFBsYWNlcyIsImNvcm5lclJhZGl1cyIsIm5vVmFsdWVBbGlnbiIsInRleHRPcHRpb25zIiwiZm9udCIsIm1heFdpZHRoIiwidGVtcGVyYXR1cmVEaXNwbGF5IiwiY2hpbGRyZW4iLCJzcGFjaW5nIiwibGVmdCIsImlzQWN0aXZlUHJvcGVydHkiLCJsaW5rQXR0cmlidXRlIiwiZ2V0VGVtcGVyYXR1cmVSZWFkb3V0Q2VudGVyIiwicGFyZW50VG9HbG9iYWxQb2ludCIsImdldENlbnRlciIsInJlc2V0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJBdG1vc3BoZXJlTGF5ZXJOb2RlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIxLTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIE5vZGUgdGhhdCByZXByZXNlbnRzIGEgbGF5ZXIgaW4gdGhlIGF0bW9zcGhlcmUgdGhhdCBhYnNvcmJzIGFuZCBlbWl0cyBlbmVyZ3kuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY29cclxuICovXHJcblxyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBQYXR0ZXJuU3RyaW5nUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9QYXR0ZXJuU3RyaW5nUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBSYW5nZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2UuanMnO1xyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBNb2RlbFZpZXdUcmFuc2Zvcm0yIGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvdmlldy9Nb2RlbFZpZXdUcmFuc2Zvcm0yLmpzJztcclxuaW1wb3J0IE51bWJlckRpc3BsYXkgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL051bWJlckRpc3BsYXkuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgQ29sb3IsIEhCb3gsIE5vZGUsIE5vZGVPcHRpb25zLCBSZWN0YW5nbGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgZ3JlZW5ob3VzZUVmZmVjdCBmcm9tICcuLi8uLi9ncmVlbmhvdXNlRWZmZWN0LmpzJztcclxuaW1wb3J0IEdyZWVuaG91c2VFZmZlY3RTdHJpbmdzIGZyb20gJy4uLy4uL0dyZWVuaG91c2VFZmZlY3RTdHJpbmdzLmpzJztcclxuaW1wb3J0IFNob3dUZW1wZXJhdHVyZUNoZWNrYm94IGZyb20gJy4uLy4uL2xheWVyLW1vZGVsL3ZpZXcvU2hvd1RlbXBlcmF0dXJlQ2hlY2tib3guanMnO1xyXG5pbXBvcnQgR3JlZW5ob3VzZUVmZmVjdFV0aWxzIGZyb20gJy4uL0dyZWVuaG91c2VFZmZlY3RVdGlscy5qcyc7XHJcbmltcG9ydCBBdG1vc3BoZXJlTGF5ZXIgZnJvbSAnLi4vbW9kZWwvQXRtb3NwaGVyZUxheWVyLmpzJztcclxuaW1wb3J0IEVuZXJneUFic29yYmluZ0VtaXR0aW5nTGF5ZXIgZnJvbSAnLi4vbW9kZWwvRW5lcmd5QWJzb3JiaW5nRW1pdHRpbmdMYXllci5qcyc7XHJcbmltcG9ydCBUZW1wZXJhdHVyZVVuaXRzIGZyb20gJy4uL21vZGVsL1RlbXBlcmF0dXJlVW5pdHMuanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IERFRkFVTFRfTEFZRVJfVEhJQ0tORVNTID0gMjY7IC8vIGluIHNjcmVlbiBjb29yZGluYXRlcywgZW1waXJpY2FsbHkgZGV0ZXJtaW5lZCB0byBtYXRjaCBkZXNpZ24gc3BlY1xyXG5jb25zdCBMQVlFUl9SRUNUQU5HTEVfU1RST0tFX0JBU0VfQ09MT1IgPSBDb2xvci5EQVJLX0dSQVk7XHJcbmNvbnN0IExBWUVSX1JFQ1RBTkdMRV9GSUxMX0JBU0VfQ09MT1IgPSBDb2xvci5MSUdIVF9HUkFZO1xyXG5jb25zdCBNSU5JTVVNX09QQUNJVFkgPSAwLjQ7XHJcbmNvbnN0IE1BWElNVU1fT1BBQ0lUWSA9IDAuODU7XHJcbmNvbnN0IFRFTVBFUkFUVVJFX0RJU1BMQVlfREVGQVVMVF9JTkRFTlQgPSAyMDsgLy8gWSBvZmZzZXQgZm9yIHRoZSB0ZW1wZXJhdHVyZSBjb250cm9sLCBpbiBzY3JlZW4gY29vcmRpbmF0ZXNcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgbnVtYmVyRGlzcGxheUVuYWJsZWRQcm9wZXJ0eT86IEJvb2xlYW5Qcm9wZXJ0eSB8IG51bGw7XHJcbiAgbGF5ZXJUaGlja25lc3M/OiBudW1iZXI7XHJcbn07XHJcbmV4cG9ydCB0eXBlIEF0bW9zcGhlcmVMYXllck5vZGVPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBOb2RlT3B0aW9ucztcclxuXHJcbmNsYXNzIEF0bW9zcGhlcmVMYXllck5vZGUgZXh0ZW5kcyBOb2RlIHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBzaG93VGVtcGVyYXR1cmVQcm9wZXJ0eTogQm9vbGVhblByb3BlcnR5O1xyXG5cclxuICAvLyB0aGUgY2hlY2tib3gsIGljb24sIGFuZCByZWFkb3V0IGZvciBkaXNwbGF5aW5nIHRoZSB0ZW1wZXJhdHVyZSBvZiB0aGUgbGF5ZXJcclxuICBwdWJsaWMgcmVhZG9ubHkgdGVtcGVyYXR1cmVEaXNwbGF5OiBOb2RlO1xyXG5cclxuICAvLyB0aGUgcmVhZG91dCBwb3J0aW9uIG9mIHRoZSB0ZW1wZXJhdHVyZSBkaXNwbGF5XHJcbiAgcHJpdmF0ZSByZWFkb25seSB0ZW1wZXJhdHVyZVJlYWRvdXQ6IE51bWJlckRpc3BsYXk7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggYXRtb3NwaGVyZUxheWVyOiBBdG1vc3BoZXJlTGF5ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZVVuaXRzUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PFRlbXBlcmF0dXJlVW5pdHM+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgbW9kZWxWaWV3VHJhbnNmb3JtOiBNb2RlbFZpZXdUcmFuc2Zvcm0yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZWRPcHRpb25zPzogQXRtb3NwaGVyZUxheWVyTm9kZU9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxBdG1vc3BoZXJlTGF5ZXJOb2RlT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcbiAgICAgIGxheWVyVGhpY2tuZXNzOiBERUZBVUxUX0xBWUVSX1RISUNLTkVTUyxcclxuICAgICAgbnVtYmVyRGlzcGxheUVuYWJsZWRQcm9wZXJ0eTogbnVsbFxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gSWYgdGhlcmUgaXMgYW4gb3B0aW9uIHByb3ZpZGVkIHRvIGVuYWJsZSB0aGUgZGlzcGxheSwgdXNlIGl0LCBvdGhlcndpc2UgY3JlYXRlIGFuIGFsd2F5cy10cnVlIFByb3BlcnR5LlxyXG4gICAgY29uc3QgbnVtYmVyRGlzcGxheUVuYWJsZWRQcm9wZXJ0eSA9IG9wdGlvbnMubnVtYmVyRGlzcGxheUVuYWJsZWRQcm9wZXJ0eSB8fCBuZXcgQm9vbGVhblByb3BlcnR5KCB0cnVlICk7XHJcblxyXG4gICAgLy8gSWYgYSB0aGlja25lc3MgdmFsdWUgaXMgcHJvdmlkZWQsIHVzZSB0aGUgbW9kZWwtdmlldyB0cmFuc2Zvcm0gdG8gY29udmVydCBpdCB0byB2aWV3IGNvb3JkaW5hdGVzLCBvdGhlcndpc2UgdXNlXHJcbiAgICAvLyB0aGUgZGVmYXVsdC5cclxuICAgIGxldCBsYXllclRoaWNrbmVzcyA9IERFRkFVTFRfTEFZRVJfVEhJQ0tORVNTO1xyXG4gICAgaWYgKCBvcHRpb25zICYmIG9wdGlvbnMubGF5ZXJUaGlja25lc3MgKSB7XHJcbiAgICAgIGxheWVyVGhpY2tuZXNzID0gLW1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld0RlbHRhWSggb3B0aW9ucy5sYXllclRoaWNrbmVzcyApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG1haW5Cb2R5ID0gbmV3IFJlY3RhbmdsZShcclxuICAgICAgMCxcclxuICAgICAgLWxheWVyVGhpY2tuZXNzIC8gMixcclxuICAgICAgbW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3RGVsdGFYKCBFbmVyZ3lBYnNvcmJpbmdFbWl0dGluZ0xheWVyLldJRFRIICksXHJcbiAgICAgIGxheWVyVGhpY2tuZXNzLFxyXG4gICAgICB7XHJcbiAgICAgICAgc3Ryb2tlOiBMQVlFUl9SRUNUQU5HTEVfU1RST0tFX0JBU0VfQ09MT1IsXHJcbiAgICAgICAgZmlsbDogTEFZRVJfUkVDVEFOR0xFX0ZJTExfQkFTRV9DT0xPUixcclxuICAgICAgICBjZW50ZXJZOiBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdZKCBhdG1vc3BoZXJlTGF5ZXIuYWx0aXR1ZGUgKVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIEFkanVzdCB0aGUgb3BhY2l0eSBvZiB0aGUgc3Ryb2tlIGFuZCBmaWxsIGJhc2VkIG9uIHRoZSBhYnNvcmJhbmNlLlxyXG4gICAgYXRtb3NwaGVyZUxheWVyLmVuZXJneUFic29ycHRpb25Qcm9wb3J0aW9uUHJvcGVydHkubGluayggZW5lcmd5QWJzb3JwdGlvblByb3BvcnRpb24gPT4ge1xyXG5cclxuICAgICAgLy8gTWFwIHRoZSBwcm9wb3J0aW9uIHRvIGFuIG9wYWNpdHkuICBXZSBkb24ndCB3YW50IHRvIGdvIDEwMCUgb3BhcXVlIG9yIHRoZSBwaG90b25zIHdvdWxkIGJlIG9ic2N1cmVkIHdoZW4gdGhleVxyXG4gICAgICAvLyBwYXNzIHRocm91Z2ggdGhlIGxheWVyLCBzbyB0aGlzIG1hcHBpbmcgd2FzIGVtcGlyaWNhbGx5IGRldGVybWluZWQgdG8gbG9vayBkZWNlbnQuXHJcbiAgICAgIGNvbnN0IG9wYWNpdHkgPSBNSU5JTVVNX09QQUNJVFkgKyAoIGVuZXJneUFic29ycHRpb25Qcm9wb3J0aW9uICogKCBNQVhJTVVNX09QQUNJVFkgLSBNSU5JTVVNX09QQUNJVFkgKSApO1xyXG4gICAgICBtYWluQm9keS5maWxsID0gTEFZRVJfUkVDVEFOR0xFX0ZJTExfQkFTRV9DT0xPUi53aXRoQWxwaGEoIG9wYWNpdHkgKTtcclxuICAgICAgbWFpbkJvZHkuc3Ryb2tlID0gTEFZRVJfUkVDVEFOR0xFX1NUUk9LRV9CQVNFX0NPTE9SLndpdGhBbHBoYSggb3BhY2l0eSApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgcHJvcGVydHkgYW5kIGFzc29jaWF0ZWQgY2hlY2tib3ggdGhhdCB3aWxsIGNvbnRyb2wgd2hldGhlciB0aGUgdGVtcGVyYXR1cmUgcmVhZG91dCBpcyB2aXNpYmxlLlxyXG4gICAgY29uc3Qgc2hvd1RlbXBlcmF0dXJlUHJvcGVydHkgPSBuZXcgQm9vbGVhblByb3BlcnR5KCB0cnVlLCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnc2hvd1RlbXBlcmF0dXJlUHJvcGVydHknIClcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IHNob3dUZW1wZXJhdHVyZUNoZWNrYm94ID0gbmV3IFNob3dUZW1wZXJhdHVyZUNoZWNrYm94KCBzaG93VGVtcGVyYXR1cmVQcm9wZXJ0eSwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3Nob3dUZW1wZXJhdHVyZUNoZWNrYm94JyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGEgZGVyaXZlZCBwcm9wZXJ0eSBmb3IgdGhlIHZhbHVlIHRoYXQgd2lsbCBiZSBkaXNwbGF5ZWQgYXMgdGhlIHRlbXBlcmF0dXJlLlxyXG4gICAgY29uc3QgdGVtcGVyYXR1cmVWYWx1ZVByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eShcclxuICAgICAgWyBhdG1vc3BoZXJlTGF5ZXIudGVtcGVyYXR1cmVQcm9wZXJ0eSwgdGVtcGVyYXR1cmVVbml0c1Byb3BlcnR5LCBudW1iZXJEaXNwbGF5RW5hYmxlZFByb3BlcnR5IF0sXHJcbiAgICAgICggdGVtcGVyYXR1cmUsIHRlbXBlcmF0dXJlVW5pdHMsIG51bWJlckRpc3BsYXlFbmFibGVkICkgPT4ge1xyXG4gICAgICAgIGxldCB0ZW1wZXJhdHVyZVZhbHVlID0gbnVsbDtcclxuICAgICAgICBpZiAoIG51bWJlckRpc3BsYXlFbmFibGVkICkge1xyXG4gICAgICAgICAgdGVtcGVyYXR1cmVWYWx1ZSA9IHRlbXBlcmF0dXJlVW5pdHMgPT09IFRlbXBlcmF0dXJlVW5pdHMuS0VMVklOID8gdGVtcGVyYXR1cmUgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlVW5pdHMgPT09IFRlbXBlcmF0dXJlVW5pdHMuQ0VMU0lVUyA/IEdyZWVuaG91c2VFZmZlY3RVdGlscy5rZWx2aW5Ub0NlbHNpdXMoIHRlbXBlcmF0dXJlICkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdyZWVuaG91c2VFZmZlY3RVdGlscy5rZWx2aW5Ub0ZhaHJlbmhlaXQoIHRlbXBlcmF0dXJlICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0ZW1wZXJhdHVyZVZhbHVlO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgdGVtcGVyYXR1cmUgcmVhZG91dC5cclxuICAgIGNvbnN0IHRlbXBlcmF0dXJlUmVhZG91dCA9IG5ldyBOdW1iZXJEaXNwbGF5KCB0ZW1wZXJhdHVyZVZhbHVlUHJvcGVydHksIG5ldyBSYW5nZSggMCwgOTk5ICksIHtcclxuICAgICAgdmlzaWJsZVByb3BlcnR5OiBzaG93VGVtcGVyYXR1cmVQcm9wZXJ0eSxcclxuICAgICAgYmFja2dyb3VuZFN0cm9rZTogQ29sb3IuQkxBQ0ssXHJcbiAgICAgIG1pbkJhY2tncm91bmRXaWR0aDogNzAsIC8vIGVtcGlyaWNhbGx5IGRldGVybWluZWQgdG8gZml0IGxhcmdlc3QgbnVtYmVyXHJcbiAgICAgIHZhbHVlUGF0dGVybjogbmV3IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eShcclxuICAgICAgICBHcmVlbmhvdXNlRWZmZWN0U3RyaW5ncy50ZW1wZXJhdHVyZS51bml0cy52YWx1ZVVuaXRzUGF0dGVyblN0cmluZ1Byb3BlcnR5LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHVuaXRzOiBuZXcgRGVyaXZlZFByb3BlcnR5KFxyXG4gICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgdGVtcGVyYXR1cmVVbml0c1Byb3BlcnR5LFxyXG4gICAgICAgICAgICAgIG51bWJlckRpc3BsYXlFbmFibGVkUHJvcGVydHksXHJcbiAgICAgICAgICAgICAgR3JlZW5ob3VzZUVmZmVjdFN0cmluZ3MudGVtcGVyYXR1cmUudW5pdHMua2VsdmluU3RyaW5nUHJvcGVydHksXHJcbiAgICAgICAgICAgICAgR3JlZW5ob3VzZUVmZmVjdFN0cmluZ3MudGVtcGVyYXR1cmUudW5pdHMuY2Vsc2l1c1N0cmluZ1Byb3BlcnR5LFxyXG4gICAgICAgICAgICAgIEdyZWVuaG91c2VFZmZlY3RTdHJpbmdzLnRlbXBlcmF0dXJlLnVuaXRzLmZhaHJlbmhlaXRTdHJpbmdQcm9wZXJ0eVxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAoIHRlbXBlcmF0dXJlVW5pdHMsIG51bWJlckRpc3BsYXlFbmFibGVkLCBrZWx2aW5TdHJpbmcsIGNlbHNpdXNTdHJpbmcsIGZhaHJlbmhlaXRTdHJpbmcgKSA9PiB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuICFudW1iZXJEaXNwbGF5RW5hYmxlZCA/ICcnIDpcclxuICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmVVbml0cyA9PT0gVGVtcGVyYXR1cmVVbml0cy5LRUxWSU4gPyBrZWx2aW5TdHJpbmcgOlxyXG4gICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZVVuaXRzID09PSBUZW1wZXJhdHVyZVVuaXRzLkNFTFNJVVMgPyBjZWxzaXVzU3RyaW5nIDpcclxuICAgICAgICAgICAgICAgICAgICAgZmFocmVuaGVpdFN0cmluZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgIH1cclxuICAgICAgKSxcclxuICAgICAgZGVjaW1hbFBsYWNlczogMSxcclxuICAgICAgY29ybmVyUmFkaXVzOiAzLFxyXG4gICAgICBub1ZhbHVlQWxpZ246ICdjZW50ZXInLFxyXG4gICAgICB0ZXh0T3B0aW9uczoge1xyXG4gICAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggMTQgKSxcclxuICAgICAgICBtYXhXaWR0aDogMTIwXHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCB0ZW1wZXJhdHVyZURpc3BsYXkgPSBuZXcgSEJveCgge1xyXG4gICAgICBjaGlsZHJlbjogWyBzaG93VGVtcGVyYXR1cmVDaGVja2JveCwgdGVtcGVyYXR1cmVSZWFkb3V0IF0sXHJcbiAgICAgIHNwYWNpbmc6IDE1LFxyXG4gICAgICBjZW50ZXJZOiBtYWluQm9keS5jZW50ZXJZLFxyXG4gICAgICBsZWZ0OiBURU1QRVJBVFVSRV9ESVNQTEFZX0RFRkFVTFRfSU5ERU5UXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gc3VwZXJ0eXBlIGNvbnN0cnVjdG9yXHJcbiAgICBzdXBlciggeyBjaGlsZHJlbjogWyBtYWluQm9keSwgdGVtcGVyYXR1cmVEaXNwbGF5IF0gfSApO1xyXG5cclxuICAgIC8vIFRoaXMgbm9kZSBzaG91bGQgb25seSBiZSB2aXNpYmxlIHdoZW4gdGhlIGF0bW9zcGhlcmUgbGF5ZXIgaXMgYWN0aXZlLlxyXG4gICAgYXRtb3NwaGVyZUxheWVyLmlzQWN0aXZlUHJvcGVydHkubGlua0F0dHJpYnV0ZSggdGhpcywgJ3Zpc2libGUnICk7XHJcblxyXG4gICAgLy8gTWFrZSB0aGUgdGVtcGVyYXR1cmUgcHJvcGVydHkgYXZhaWxhYmxlIGZvciByZXNldC5cclxuICAgIHRoaXMuc2hvd1RlbXBlcmF0dXJlUHJvcGVydHkgPSBzaG93VGVtcGVyYXR1cmVQcm9wZXJ0eTtcclxuXHJcbiAgICAvLyBNYWtlIHRoZSB0ZW1wZXJhdHVyZSBkaXNwbGF5IGF2YWlsYWJsZSBleHRlcm5hbGx5IHNvIHRoYXQgZXh0ZXJuYWwgbm9kZXMgY2FuIGJlIGFsaWduZWQgd2l0aCBpdC5cclxuICAgIHRoaXMudGVtcGVyYXR1cmVEaXNwbGF5ID0gdGVtcGVyYXR1cmVEaXNwbGF5O1xyXG5cclxuICAgIC8vIE1ha2UgdGhlIHRlbXBlcmF0dXJlIHJlYWRvdXQgYXZhaWxhYmxlIHRvIGEgbWV0aG9kIHRoYXQgbmVlZHMgaXQuXHJcbiAgICB0aGlzLnRlbXBlcmF0dXJlUmVhZG91dCA9IHRlbXBlcmF0dXJlUmVhZG91dDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgY2VudGVyIFggcG9zaXRpb24gaW4gZ2xvYmFsIGNvb3JkaW5hdGUgc3BhY2Ugb2YgdGhlIHRlbXBlcmF0dXJlIHJlYWRvdXQuICBUaGlzIGlzIGFuIG9kZGx5IHNwZWNpZmljIHBpZWNlXHJcbiAgICogb2YgaW5mb3JtYXRpb24sIGJ1dCBpcyBuZWVkZWQgZm9yIGFsaWdubWVudCBvZiBzb21lIHZpc3VhbCBlbGVtZW50cy5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0VGVtcGVyYXR1cmVSZWFkb3V0Q2VudGVyKCk6IFZlY3RvcjIge1xyXG4gICAgcmV0dXJuIHRoaXMudGVtcGVyYXR1cmVSZWFkb3V0LnBhcmVudFRvR2xvYmFsUG9pbnQoIHRoaXMudGVtcGVyYXR1cmVSZWFkb3V0LmdldENlbnRlcigpICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0b3JlIGluaXRpYWwgc3RhdGUuXHJcbiAgICovXHJcbiAgcHVibGljIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5zaG93VGVtcGVyYXR1cmVQcm9wZXJ0eS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBURU1QRVJBVFVSRV9ESVNQTEFZX0RFRkFVTFRfSU5ERU5UID0gVEVNUEVSQVRVUkVfRElTUExBWV9ERUZBVUxUX0lOREVOVDtcclxufVxyXG5cclxuZ3JlZW5ob3VzZUVmZmVjdC5yZWdpc3RlciggJ0F0bW9zcGhlcmVMYXllck5vZGUnLCBBdG1vc3BoZXJlTGF5ZXJOb2RlICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBdG1vc3BoZXJlTGF5ZXJOb2RlO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZUFBZSxNQUFNLHdDQUF3QztBQUNwRSxPQUFPQyxlQUFlLE1BQU0sd0NBQXdDO0FBQ3BFLE9BQU9DLHFCQUFxQixNQUFNLDhDQUE4QztBQUVoRixPQUFPQyxLQUFLLE1BQU0sNkJBQTZCO0FBRS9DLE9BQU9DLFNBQVMsTUFBTSx1Q0FBdUM7QUFFN0QsT0FBT0MsYUFBYSxNQUFNLDhDQUE4QztBQUN4RSxPQUFPQyxRQUFRLE1BQU0seUNBQXlDO0FBQzlELFNBQVNDLEtBQUssRUFBRUMsSUFBSSxFQUFFQyxJQUFJLEVBQWVDLFNBQVMsUUFBUSxtQ0FBbUM7QUFDN0YsT0FBT0MsZ0JBQWdCLE1BQU0sMkJBQTJCO0FBQ3hELE9BQU9DLHVCQUF1QixNQUFNLGtDQUFrQztBQUN0RSxPQUFPQyx1QkFBdUIsTUFBTSxtREFBbUQ7QUFDdkYsT0FBT0MscUJBQXFCLE1BQU0sNkJBQTZCO0FBRS9ELE9BQU9DLDRCQUE0QixNQUFNLDBDQUEwQztBQUNuRixPQUFPQyxnQkFBZ0IsTUFBTSw4QkFBOEI7O0FBRTNEO0FBQ0EsTUFBTUMsdUJBQXVCLEdBQUcsRUFBRSxDQUFDLENBQUM7QUFDcEMsTUFBTUMsaUNBQWlDLEdBQUdYLEtBQUssQ0FBQ1ksU0FBUztBQUN6RCxNQUFNQywrQkFBK0IsR0FBR2IsS0FBSyxDQUFDYyxVQUFVO0FBQ3hELE1BQU1DLGVBQWUsR0FBRyxHQUFHO0FBQzNCLE1BQU1DLGVBQWUsR0FBRyxJQUFJO0FBQzVCLE1BQU1DLGtDQUFrQyxHQUFHLEVBQUUsQ0FBQyxDQUFDOztBQVEvQyxNQUFNQyxtQkFBbUIsU0FBU2hCLElBQUksQ0FBQztFQUlyQzs7RUFHQTs7RUFHT2lCLFdBQVdBLENBQUVDLGVBQWdDLEVBQ2hDQyx3QkFBNkQsRUFDN0RDLGtCQUF1QyxFQUN2Q0MsZUFBNEMsRUFB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