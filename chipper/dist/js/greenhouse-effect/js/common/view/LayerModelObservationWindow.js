// Copyright 2021-2023, University of Colorado Boulder

/**
 * LayerModelObservationWindow is a Scenery Node that presents an enclosed background with a view of a sky and ground.
 * It is generally used as a base class, and additional functionality is added in subclasses.
 *
 * @author John Blanco (PhET Interactive Simulations)
 */

import optionize from '../../../../phet-core/js/optionize.js';
import { Color, LinearGradient, ManualConstraint, Path } from '../../../../scenery/js/imports.js';
import soundManager from '../../../../tambo/js/soundManager.js';
import Tandem from '../../../../tandem/js/Tandem.js';
import greenhouseEffect from '../../greenhouseEffect.js';
import ShowTemperatureCheckbox from '../../layer-model/view/ShowTemperatureCheckbox.js';
import PhotonSprites from '../PhotonSprites.js';
import AtmosphereLayerNode from './AtmosphereLayerNode.js';
import AtmosphericPhotonsSoundGenerator from './AtmosphericPhotonsSoundGenerator.js';
import GreenhouseEffectObservationWindow from './GreenhouseEffectObservationWindow.js';
import ThermometerAndReadout from './ThermometerAndReadout.js';
class LayerModelObservationWindow extends GreenhouseEffectObservationWindow {
  atmosphereLayerNodes = [];
  constructor(model, providedOptions) {
    const options = optionize()({
      fluxMeterNodeOptions: {
        includeZoomButtons: true
      },
      // phet-io
      tandem: Tandem.REQUIRED
    }, providedOptions);
    super(model, options);

    // Add the node that will render the photons.
    this.photonsNode = new PhotonSprites(model.photonCollection, this.modelViewTransform);
    this.presentationLayer.addChild(this.photonsNode);

    // Add the visual representations of the atmosphere layers.
    model.atmosphereLayers.forEach((atmosphereLayer, index) => {
      const correspondingPhotonAbsorbingLayer = model.photonCollection.photonAbsorbingEmittingLayers[index];
      const atmosphereLayerNodeOptions = {
        numberDisplayEnabledProperty: correspondingPhotonAbsorbingLayer.atLeastOnePhotonAbsorbedProperty,
        layerThickness: correspondingPhotonAbsorbingLayer.thickness,
        tandem: options.tandem.createTandem(`atmosphereLayer${index}`)
      };
      const atmosphereLayerNode = new AtmosphereLayerNode(atmosphereLayer, model.temperatureUnitsProperty, this.modelViewTransform, atmosphereLayerNodeOptions);

      // For the top layer, add a constraint that will update the temperature display's left position based on the
      // bounds and visibility of the energyBalancePanel.
      if (index === model.atmosphereLayers.length - 1) {
        ManualConstraint.create(this, [this.energyBalancePanel, atmosphereLayerNode.temperatureDisplay], (energyBalancePanelProxy, temperatureDisplayProxy) => {
          temperatureDisplayProxy.left = AtmosphereLayerNode.TEMPERATURE_DISPLAY_DEFAULT_INDENT + (model.energyBalanceVisibleProperty.value ? energyBalancePanelProxy.right : 0);
        });
      }
      this.presentationLayer.addChild(atmosphereLayerNode);
      this.atmosphereLayerNodes.push(atmosphereLayerNode);
    });

    // checkbox for thermometer visibility
    this.showThermometerCheckbox = new ShowTemperatureCheckbox(model.surfaceThermometerVisibleProperty, {
      left: this.atmosphereLayerNodes[0].temperatureDisplay.left,
      bottom: GreenhouseEffectObservationWindow.SIZE.height - GreenhouseEffectObservationWindow.CONTROL_AND_INSTRUMENT_INSET,
      tandem: options.tandem.createTandem('showTemperatureCheckbox')
    });
    this.controlsLayer.addChild(this.showThermometerCheckbox);

    // Get the X position of the surface thermometer based on the position of a similar display in the layer nodes.
    // This allows them to line up nicely.
    const surfaceThermometerCenterX = this.globalToLocalPoint(this.atmosphereLayerNodes[0].getTemperatureReadoutCenter()).x;

    // surface thermometer
    const surfaceThermometer = new ThermometerAndReadout(model, {
      minTemperature: model.groundLayer.minimumTemperature - 5,
      maxTemperature: 475,
      // empirically determined

      thermometerNodeOptions: {
        bulbDiameter: 25,
        tubeHeight: 80,
        tubeWidth: 14,
        lineWidth: 1.5,
        tickSpacing: 8,
        majorTickLength: 7,
        minorTickLength: 4
      },
      readoutType: ThermometerAndReadout.ReadoutType.FIXED,
      visibleProperty: model.surfaceThermometerVisibleProperty,
      centerX: surfaceThermometerCenterX,
      bottom: GreenhouseEffectObservationWindow.SIZE.height - GreenhouseEffectObservationWindow.CONTROL_AND_INSTRUMENT_INSET,
      // phet-io
      tandem: options.tandem.createTandem('surfaceThermometer')
    });
    this.controlsLayer.addChild(surfaceThermometer);

    // sound generation
    soundManager.addSoundGenerator(new AtmosphericPhotonsSoundGenerator(model.photonCollection, {
      // output level is pretty low, since a lot of these can be happening at once
      initialOutputLevel: 0.03
    }));
  }
  step(dt) {
    this.photonsNode.update();
    super.step(dt);
  }
  reset() {
    this.atmosphereLayerNodes.forEach(aln => {
      aln.reset();
    });
    this.fluxMeterNode?.reset();
  }

  /**
   * Create a ground node that is a shape whose color will change with the albedo.
   */
  createGroundNode(model) {
    // ground shape
    const groundShape = GreenhouseEffectObservationWindow.createGroundShape();

    // Create a node to represent the ground based on the created shape.
    const groundNodePath = new Path(groundShape, {
      bottom: GreenhouseEffectObservationWindow.SIZE.height
    });

    // Adjust the color of the ground as the albedo changes.
    model.groundLayer.albedoProperty.link(albedo => {
      const colorBaseValue = Math.min(255 * albedo / 0.9, 255);
      const baseColor = new Color(colorBaseValue, colorBaseValue, colorBaseValue);
      const bounds = groundNodePath.localBounds;
      groundNodePath.fill = new LinearGradient(0, bounds.minY, 0, bounds.maxY).addColorStop(0, baseColor.colorUtilsDarker(0.2)).addColorStop(1, baseColor.colorUtilsBrighter(0.4));
    });
    return groundNodePath;
  }
}
greenhouseEffect.register('LayerModelObservationWindow', LayerModelObservationWindow);
export default LayerModelObservationWindow;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25pemUiLCJDb2xvciIsIkxpbmVhckdyYWRpZW50IiwiTWFudWFsQ29uc3RyYWludCIsIlBhdGgiLCJzb3VuZE1hbmFnZXIiLCJUYW5kZW0iLCJncmVlbmhvdXNlRWZmZWN0IiwiU2hvd1RlbXBlcmF0dXJlQ2hlY2tib3giLCJQaG90b25TcHJpdGVzIiwiQXRtb3NwaGVyZUxheWVyTm9kZSIsIkF0bW9zcGhlcmljUGhvdG9uc1NvdW5kR2VuZXJhdG9yIiwiR3JlZW5ob3VzZUVmZmVjdE9ic2VydmF0aW9uV2luZG93IiwiVGhlcm1vbWV0ZXJBbmRSZWFkb3V0IiwiTGF5ZXJNb2RlbE9ic2VydmF0aW9uV2luZG93IiwiYXRtb3NwaGVyZUxheWVyTm9kZXMiLCJjb25zdHJ1Y3RvciIsIm1vZGVsIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsImZsdXhNZXRlck5vZGVPcHRpb25zIiwiaW5jbHVkZVpvb21CdXR0b25zIiwidGFuZGVtIiwiUkVRVUlSRUQiLCJwaG90b25zTm9kZSIsInBob3RvbkNvbGxlY3Rpb24iLCJtb2RlbFZpZXdUcmFuc2Zvcm0iLCJwcmVzZW50YXRpb25MYXllciIsImFkZENoaWxkIiwiYXRtb3NwaGVyZUxheWVycyIsImZvckVhY2giLCJhdG1vc3BoZXJlTGF5ZXIiLCJpbmRleCIsImNvcnJlc3BvbmRpbmdQaG90b25BYnNvcmJpbmdMYXllciIsInBob3RvbkFic29yYmluZ0VtaXR0aW5nTGF5ZXJzIiwiYXRtb3NwaGVyZUxheWVyTm9kZU9wdGlvbnMiLCJudW1iZXJEaXNwbGF5RW5hYmxlZFByb3BlcnR5IiwiYXRMZWFzdE9uZVBob3RvbkFic29yYmVkUHJvcGVydHkiLCJsYXllclRoaWNrbmVzcyIsInRoaWNrbmVzcyIsImNyZWF0ZVRhbmRlbSIsImF0bW9zcGhlcmVMYXllck5vZGUiLCJ0ZW1wZXJhdHVyZVVuaXRzUHJvcGVydHkiLCJsZW5ndGgiLCJjcmVhdGUiLCJlbmVyZ3lCYWxhbmNlUGFuZWwiLCJ0ZW1wZXJhdHVyZURpc3BsYXkiLCJlbmVyZ3lCYWxhbmNlUGFuZWxQcm94eSIsInRlbXBlcmF0dXJlRGlzcGxheVByb3h5IiwibGVmdCIsIlRFTVBFUkFUVVJFX0RJU1BMQVlfREVGQVVMVF9JTkRFTlQiLCJlbmVyZ3lCYWxhbmNlVmlzaWJsZVByb3BlcnR5IiwidmFsdWUiLCJyaWdodCIsInB1c2giLCJzaG93VGhlcm1vbWV0ZXJDaGVja2JveCIsInN1cmZhY2VUaGVybW9tZXRlclZpc2libGVQcm9wZXJ0eSIsImJvdHRvbSIsIlNJWkUiLCJoZWlnaHQiLCJDT05UUk9MX0FORF9JTlNUUlVNRU5UX0lOU0VUIiwiY29udHJvbHNMYXllciIsInN1cmZhY2VUaGVybW9tZXRlckNlbnRlclgiLCJnbG9iYWxUb0xvY2FsUG9pbnQiLCJnZXRUZW1wZXJhdHVyZVJlYWRvdXRDZW50ZXIiLCJ4Iiwic3VyZmFjZVRoZXJtb21ldGVyIiwibWluVGVtcGVyYXR1cmUiLCJncm91bmRMYXllciIsIm1pbmltdW1UZW1wZXJhdHVyZSIsIm1heFRlbXBlcmF0dXJlIiwidGhlcm1vbWV0ZXJOb2RlT3B0aW9ucyIsImJ1bGJEaWFtZXRlciIsInR1YmVIZWlnaHQiLCJ0dWJlV2lkdGgiLCJsaW5lV2lkdGgiLCJ0aWNrU3BhY2luZyIsIm1ham9yVGlja0xlbmd0aCIsIm1pbm9yVGlja0xlbmd0aCIsInJlYWRvdXRUeXBlIiwiUmVhZG91dFR5cGUiLCJGSVhFRCIsInZpc2libGVQcm9wZXJ0eSIsImNlbnRlclgiLCJhZGRTb3VuZEdlbmVyYXRvciIsImluaXRpYWxPdXRwdXRMZXZlbCIsInN0ZXAiLCJkdCIsInVwZGF0ZSIsInJlc2V0IiwiYWxuIiwiZmx1eE1ldGVyTm9kZSIsImNyZWF0ZUdyb3VuZE5vZGUiLCJncm91bmRTaGFwZSIsImNyZWF0ZUdyb3VuZFNoYXBlIiwiZ3JvdW5kTm9kZVBhdGgiLCJhbGJlZG9Qcm9wZXJ0eSIsImxpbmsiLCJhbGJlZG8iLCJjb2xvckJhc2VWYWx1ZSIsIk1hdGgiLCJtaW4iLCJiYXNlQ29sb3IiLCJib3VuZHMiLCJsb2NhbEJvdW5kcyIsImZpbGwiLCJtaW5ZIiwibWF4WSIsImFkZENvbG9yU3RvcCIsImNvbG9yVXRpbHNEYXJrZXIiLCJjb2xvclV0aWxzQnJpZ2h0ZXIiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkxheWVyTW9kZWxPYnNlcnZhdGlvbldpbmRvdy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMS0yMDIzLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBMYXllck1vZGVsT2JzZXJ2YXRpb25XaW5kb3cgaXMgYSBTY2VuZXJ5IE5vZGUgdGhhdCBwcmVzZW50cyBhbiBlbmNsb3NlZCBiYWNrZ3JvdW5kIHdpdGggYSB2aWV3IG9mIGEgc2t5IGFuZCBncm91bmQuXHJcbiAqIEl0IGlzIGdlbmVyYWxseSB1c2VkIGFzIGEgYmFzZSBjbGFzcywgYW5kIGFkZGl0aW9uYWwgZnVuY3Rpb25hbGl0eSBpcyBhZGRlZCBpbiBzdWJjbGFzc2VzLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgeyBDb2xvciwgTGluZWFyR3JhZGllbnQsIE1hbnVhbENvbnN0cmFpbnQsIE5vZGUsIFBhdGggfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgc291bmRNYW5hZ2VyIGZyb20gJy4uLy4uLy4uLy4uL3RhbWJvL2pzL3NvdW5kTWFuYWdlci5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBncmVlbmhvdXNlRWZmZWN0IGZyb20gJy4uLy4uL2dyZWVuaG91c2VFZmZlY3QuanMnO1xyXG5pbXBvcnQgTGF5ZXJNb2RlbE1vZGVsIGZyb20gJy4uLy4uL2xheWVyLW1vZGVsL21vZGVsL0xheWVyTW9kZWxNb2RlbC5qcyc7XHJcbmltcG9ydCBTaG93VGVtcGVyYXR1cmVDaGVja2JveCBmcm9tICcuLi8uLi9sYXllci1tb2RlbC92aWV3L1Nob3dUZW1wZXJhdHVyZUNoZWNrYm94LmpzJztcclxuaW1wb3J0IExheWVyc01vZGVsIGZyb20gJy4uL21vZGVsL0xheWVyc01vZGVsLmpzJztcclxuaW1wb3J0IFBob3RvblNwcml0ZXMgZnJvbSAnLi4vUGhvdG9uU3ByaXRlcy5qcyc7XHJcbmltcG9ydCBBdG1vc3BoZXJlTGF5ZXJOb2RlLCB7IEF0bW9zcGhlcmVMYXllck5vZGVPcHRpb25zIH0gZnJvbSAnLi9BdG1vc3BoZXJlTGF5ZXJOb2RlLmpzJztcclxuaW1wb3J0IEF0bW9zcGhlcmljUGhvdG9uc1NvdW5kR2VuZXJhdG9yIGZyb20gJy4vQXRtb3NwaGVyaWNQaG90b25zU291bmRHZW5lcmF0b3IuanMnO1xyXG5pbXBvcnQgR3JlZW5ob3VzZUVmZmVjdE9ic2VydmF0aW9uV2luZG93LCB7IEdyZWVuaG91c2VFZmZlY3RPYnNlcnZhdGlvbldpbmRvd09wdGlvbnMgfSBmcm9tICcuL0dyZWVuaG91c2VFZmZlY3RPYnNlcnZhdGlvbldpbmRvdy5qcyc7XHJcbmltcG9ydCBUaGVybW9tZXRlckFuZFJlYWRvdXQgZnJvbSAnLi9UaGVybW9tZXRlckFuZFJlYWRvdXQuanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcbmV4cG9ydCB0eXBlIExheWVyTW9kZWxPYnNlcnZhdGlvbldpbmRvd09wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIEdyZWVuaG91c2VFZmZlY3RPYnNlcnZhdGlvbldpbmRvd09wdGlvbnM7XHJcblxyXG5jbGFzcyBMYXllck1vZGVsT2JzZXJ2YXRpb25XaW5kb3cgZXh0ZW5kcyBHcmVlbmhvdXNlRWZmZWN0T2JzZXJ2YXRpb25XaW5kb3cge1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcGhvdG9uc05vZGU6IFBob3RvblNwcml0ZXM7XHJcbiAgcHVibGljIHJlYWRvbmx5IGF0bW9zcGhlcmVMYXllck5vZGVzOiBBdG1vc3BoZXJlTGF5ZXJOb2RlW10gPSBbXTtcclxuICBwdWJsaWMgcmVhZG9ubHkgc2hvd1RoZXJtb21ldGVyQ2hlY2tib3g6IFNob3dUZW1wZXJhdHVyZUNoZWNrYm94O1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIG1vZGVsOiBMYXllck1vZGVsTW9kZWwsIHByb3ZpZGVkT3B0aW9uczogR3JlZW5ob3VzZUVmZmVjdE9ic2VydmF0aW9uV2luZG93T3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPExheWVyTW9kZWxPYnNlcnZhdGlvbldpbmRvd09wdGlvbnMsIFNlbGZPcHRpb25zLCBHcmVlbmhvdXNlRWZmZWN0T2JzZXJ2YXRpb25XaW5kb3dPcHRpb25zPigpKCB7XHJcbiAgICAgIGZsdXhNZXRlck5vZGVPcHRpb25zOiB7XHJcbiAgICAgICAgaW5jbHVkZVpvb21CdXR0b25zOiB0cnVlXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBwaGV0LWlvXHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVEXHJcblxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIG1vZGVsLCBvcHRpb25zICk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBub2RlIHRoYXQgd2lsbCByZW5kZXIgdGhlIHBob3RvbnMuXHJcbiAgICB0aGlzLnBob3RvbnNOb2RlID0gbmV3IFBob3RvblNwcml0ZXMoIG1vZGVsLnBob3RvbkNvbGxlY3Rpb24sIHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtICk7XHJcbiAgICB0aGlzLnByZXNlbnRhdGlvbkxheWVyLmFkZENoaWxkKCB0aGlzLnBob3RvbnNOb2RlICk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSB2aXN1YWwgcmVwcmVzZW50YXRpb25zIG9mIHRoZSBhdG1vc3BoZXJlIGxheWVycy5cclxuICAgIG1vZGVsLmF0bW9zcGhlcmVMYXllcnMuZm9yRWFjaCggKCBhdG1vc3BoZXJlTGF5ZXIsIGluZGV4ICkgPT4ge1xyXG4gICAgICBjb25zdCBjb3JyZXNwb25kaW5nUGhvdG9uQWJzb3JiaW5nTGF5ZXIgPSBtb2RlbC5waG90b25Db2xsZWN0aW9uLnBob3RvbkFic29yYmluZ0VtaXR0aW5nTGF5ZXJzWyBpbmRleCBdO1xyXG4gICAgICBjb25zdCBhdG1vc3BoZXJlTGF5ZXJOb2RlT3B0aW9uczogQXRtb3NwaGVyZUxheWVyTm9kZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgbnVtYmVyRGlzcGxheUVuYWJsZWRQcm9wZXJ0eTogY29ycmVzcG9uZGluZ1Bob3RvbkFic29yYmluZ0xheWVyLmF0TGVhc3RPbmVQaG90b25BYnNvcmJlZFByb3BlcnR5LFxyXG4gICAgICAgIGxheWVyVGhpY2tuZXNzOiBjb3JyZXNwb25kaW5nUGhvdG9uQWJzb3JiaW5nTGF5ZXIudGhpY2tuZXNzLFxyXG4gICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCBgYXRtb3NwaGVyZUxheWVyJHtpbmRleH1gIClcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IGF0bW9zcGhlcmVMYXllck5vZGUgPSBuZXcgQXRtb3NwaGVyZUxheWVyTm9kZShcclxuICAgICAgICBhdG1vc3BoZXJlTGF5ZXIsXHJcbiAgICAgICAgbW9kZWwudGVtcGVyYXR1cmVVbml0c1Byb3BlcnR5LFxyXG4gICAgICAgIHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLFxyXG4gICAgICAgIGF0bW9zcGhlcmVMYXllck5vZGVPcHRpb25zXHJcbiAgICAgICk7XHJcblxyXG4gICAgICAvLyBGb3IgdGhlIHRvcCBsYXllciwgYWRkIGEgY29uc3RyYWludCB0aGF0IHdpbGwgdXBkYXRlIHRoZSB0ZW1wZXJhdHVyZSBkaXNwbGF5J3MgbGVmdCBwb3NpdGlvbiBiYXNlZCBvbiB0aGVcclxuICAgICAgLy8gYm91bmRzIGFuZCB2aXNpYmlsaXR5IG9mIHRoZSBlbmVyZ3lCYWxhbmNlUGFuZWwuXHJcbiAgICAgIGlmICggaW5kZXggPT09IG1vZGVsLmF0bW9zcGhlcmVMYXllcnMubGVuZ3RoIC0gMSApIHtcclxuICAgICAgICBNYW51YWxDb25zdHJhaW50LmNyZWF0ZShcclxuICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICBbIHRoaXMuZW5lcmd5QmFsYW5jZVBhbmVsLCBhdG1vc3BoZXJlTGF5ZXJOb2RlLnRlbXBlcmF0dXJlRGlzcGxheSBdLFxyXG4gICAgICAgICAgKCBlbmVyZ3lCYWxhbmNlUGFuZWxQcm94eSwgdGVtcGVyYXR1cmVEaXNwbGF5UHJveHkgKSA9PiB7XHJcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlRGlzcGxheVByb3h5LmxlZnQgPSBBdG1vc3BoZXJlTGF5ZXJOb2RlLlRFTVBFUkFUVVJFX0RJU1BMQVlfREVGQVVMVF9JTkRFTlQgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCBtb2RlbC5lbmVyZ3lCYWxhbmNlVmlzaWJsZVByb3BlcnR5LnZhbHVlID8gZW5lcmd5QmFsYW5jZVBhbmVsUHJveHkucmlnaHQgOiAwICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5wcmVzZW50YXRpb25MYXllci5hZGRDaGlsZCggYXRtb3NwaGVyZUxheWVyTm9kZSApO1xyXG4gICAgICB0aGlzLmF0bW9zcGhlcmVMYXllck5vZGVzLnB1c2goIGF0bW9zcGhlcmVMYXllck5vZGUgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBjaGVja2JveCBmb3IgdGhlcm1vbWV0ZXIgdmlzaWJpbGl0eVxyXG4gICAgdGhpcy5zaG93VGhlcm1vbWV0ZXJDaGVja2JveCA9IG5ldyBTaG93VGVtcGVyYXR1cmVDaGVja2JveCggbW9kZWwuc3VyZmFjZVRoZXJtb21ldGVyVmlzaWJsZVByb3BlcnR5LCB7XHJcbiAgICAgIGxlZnQ6IHRoaXMuYXRtb3NwaGVyZUxheWVyTm9kZXNbIDAgXS50ZW1wZXJhdHVyZURpc3BsYXkubGVmdCxcclxuICAgICAgYm90dG9tOiBHcmVlbmhvdXNlRWZmZWN0T2JzZXJ2YXRpb25XaW5kb3cuU0laRS5oZWlnaHQgLVxyXG4gICAgICAgICAgICAgIEdyZWVuaG91c2VFZmZlY3RPYnNlcnZhdGlvbldpbmRvdy5DT05UUk9MX0FORF9JTlNUUlVNRU5UX0lOU0VULFxyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3Nob3dUZW1wZXJhdHVyZUNoZWNrYm94JyApXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmNvbnRyb2xzTGF5ZXIuYWRkQ2hpbGQoIHRoaXMuc2hvd1RoZXJtb21ldGVyQ2hlY2tib3ggKTtcclxuXHJcbiAgICAvLyBHZXQgdGhlIFggcG9zaXRpb24gb2YgdGhlIHN1cmZhY2UgdGhlcm1vbWV0ZXIgYmFzZWQgb24gdGhlIHBvc2l0aW9uIG9mIGEgc2ltaWxhciBkaXNwbGF5IGluIHRoZSBsYXllciBub2Rlcy5cclxuICAgIC8vIFRoaXMgYWxsb3dzIHRoZW0gdG8gbGluZSB1cCBuaWNlbHkuXHJcbiAgICBjb25zdCBzdXJmYWNlVGhlcm1vbWV0ZXJDZW50ZXJYID1cclxuICAgICAgdGhpcy5nbG9iYWxUb0xvY2FsUG9pbnQoIHRoaXMuYXRtb3NwaGVyZUxheWVyTm9kZXNbIDAgXS5nZXRUZW1wZXJhdHVyZVJlYWRvdXRDZW50ZXIoKSApLng7XHJcblxyXG4gICAgLy8gc3VyZmFjZSB0aGVybW9tZXRlclxyXG4gICAgY29uc3Qgc3VyZmFjZVRoZXJtb21ldGVyID0gbmV3IFRoZXJtb21ldGVyQW5kUmVhZG91dCggbW9kZWwsIHtcclxuXHJcbiAgICAgIG1pblRlbXBlcmF0dXJlOiBtb2RlbC5ncm91bmRMYXllci5taW5pbXVtVGVtcGVyYXR1cmUgLSA1LFxyXG4gICAgICBtYXhUZW1wZXJhdHVyZTogNDc1LCAvLyBlbXBpcmljYWxseSBkZXRlcm1pbmVkXHJcblxyXG4gICAgICB0aGVybW9tZXRlck5vZGVPcHRpb25zOiB7XHJcbiAgICAgICAgYnVsYkRpYW1ldGVyOiAyNSxcclxuICAgICAgICB0dWJlSGVpZ2h0OiA4MCxcclxuICAgICAgICB0dWJlV2lkdGg6IDE0LFxyXG4gICAgICAgIGxpbmVXaWR0aDogMS41LFxyXG4gICAgICAgIHRpY2tTcGFjaW5nOiA4LFxyXG4gICAgICAgIG1ham9yVGlja0xlbmd0aDogNyxcclxuICAgICAgICBtaW5vclRpY2tMZW5ndGg6IDRcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHJlYWRvdXRUeXBlOiBUaGVybW9tZXRlckFuZFJlYWRvdXQuUmVhZG91dFR5cGUuRklYRUQsXHJcblxyXG4gICAgICB2aXNpYmxlUHJvcGVydHk6IG1vZGVsLnN1cmZhY2VUaGVybW9tZXRlclZpc2libGVQcm9wZXJ0eSxcclxuICAgICAgY2VudGVyWDogc3VyZmFjZVRoZXJtb21ldGVyQ2VudGVyWCxcclxuICAgICAgYm90dG9tOiBHcmVlbmhvdXNlRWZmZWN0T2JzZXJ2YXRpb25XaW5kb3cuU0laRS5oZWlnaHQgLVxyXG4gICAgICAgICAgICAgIEdyZWVuaG91c2VFZmZlY3RPYnNlcnZhdGlvbldpbmRvdy5DT05UUk9MX0FORF9JTlNUUlVNRU5UX0lOU0VULFxyXG5cclxuICAgICAgLy8gcGhldC1pb1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3N1cmZhY2VUaGVybW9tZXRlcicgKVxyXG4gICAgfSApO1xyXG4gICAgdGhpcy5jb250cm9sc0xheWVyLmFkZENoaWxkKCBzdXJmYWNlVGhlcm1vbWV0ZXIgKTtcclxuXHJcbiAgICAvLyBzb3VuZCBnZW5lcmF0aW9uXHJcbiAgICBzb3VuZE1hbmFnZXIuYWRkU291bmRHZW5lcmF0b3IoIG5ldyBBdG1vc3BoZXJpY1Bob3RvbnNTb3VuZEdlbmVyYXRvciggbW9kZWwucGhvdG9uQ29sbGVjdGlvbiwge1xyXG5cclxuICAgICAgLy8gb3V0cHV0IGxldmVsIGlzIHByZXR0eSBsb3csIHNpbmNlIGEgbG90IG9mIHRoZXNlIGNhbiBiZSBoYXBwZW5pbmcgYXQgb25jZVxyXG4gICAgICBpbml0aWFsT3V0cHV0TGV2ZWw6IDAuMDNcclxuICAgIH0gKSApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIHN0ZXAoIGR0OiBudW1iZXIgKTogdm9pZCB7XHJcbiAgICB0aGlzLnBob3RvbnNOb2RlLnVwZGF0ZSgpO1xyXG4gICAgc3VwZXIuc3RlcCggZHQgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNldCgpOiB2b2lkIHtcclxuICAgIHRoaXMuYXRtb3NwaGVyZUxheWVyTm9kZXMuZm9yRWFjaCggYWxuID0+IHsgYWxuLnJlc2V0KCk7IH0gKTtcclxuICAgIHRoaXMuZmx1eE1ldGVyTm9kZT8ucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBhIGdyb3VuZCBub2RlIHRoYXQgaXMgYSBzaGFwZSB3aG9zZSBjb2xvciB3aWxsIGNoYW5nZSB3aXRoIHRoZSBhbGJlZG8uXHJcbiAgICovXHJcbiAgcHJvdGVjdGVkIG92ZXJyaWRlIGNyZWF0ZUdyb3VuZE5vZGUoIG1vZGVsOiBMYXllcnNNb2RlbCApOiBOb2RlIHtcclxuXHJcbiAgICAvLyBncm91bmQgc2hhcGVcclxuICAgIGNvbnN0IGdyb3VuZFNoYXBlID0gR3JlZW5ob3VzZUVmZmVjdE9ic2VydmF0aW9uV2luZG93LmNyZWF0ZUdyb3VuZFNoYXBlKCk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGEgbm9kZSB0byByZXByZXNlbnQgdGhlIGdyb3VuZCBiYXNlZCBvbiB0aGUgY3JlYXRlZCBzaGFwZS5cclxuICAgIGNvbnN0IGdyb3VuZE5vZGVQYXRoID0gbmV3IFBhdGgoIGdyb3VuZFNoYXBlLCB7XHJcbiAgICAgIGJvdHRvbTogR3JlZW5ob3VzZUVmZmVjdE9ic2VydmF0aW9uV2luZG93LlNJWkUuaGVpZ2h0XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQWRqdXN0IHRoZSBjb2xvciBvZiB0aGUgZ3JvdW5kIGFzIHRoZSBhbGJlZG8gY2hhbmdlcy5cclxuICAgIG1vZGVsLmdyb3VuZExheWVyLmFsYmVkb1Byb3BlcnR5LmxpbmsoIGFsYmVkbyA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbG9yQmFzZVZhbHVlID0gTWF0aC5taW4oIDI1NSAqIGFsYmVkbyAvIDAuOSwgMjU1ICk7XHJcbiAgICAgIGNvbnN0IGJhc2VDb2xvciA9IG5ldyBDb2xvciggY29sb3JCYXNlVmFsdWUsIGNvbG9yQmFzZVZhbHVlLCBjb2xvckJhc2VWYWx1ZSApO1xyXG4gICAgICBjb25zdCBib3VuZHMgPSBncm91bmROb2RlUGF0aC5sb2NhbEJvdW5kcztcclxuICAgICAgZ3JvdW5kTm9kZVBhdGguZmlsbCA9IG5ldyBMaW5lYXJHcmFkaWVudCggMCwgYm91bmRzLm1pblksIDAsIGJvdW5kcy5tYXhZIClcclxuICAgICAgICAuYWRkQ29sb3JTdG9wKCAwLCBiYXNlQ29sb3IuY29sb3JVdGlsc0RhcmtlciggMC4yICkgKVxyXG4gICAgICAgIC5hZGRDb2xvclN0b3AoIDEsIGJhc2VDb2xvci5jb2xvclV0aWxzQnJpZ2h0ZXIoIDAuNCApICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgcmV0dXJuIGdyb3VuZE5vZGVQYXRoO1xyXG4gIH1cclxufVxyXG5cclxuZ3JlZW5ob3VzZUVmZmVjdC5yZWdpc3RlciggJ0xheWVyTW9kZWxPYnNlcnZhdGlvbldpbmRvdycsIExheWVyTW9kZWxPYnNlcnZhdGlvbldpbmRvdyApO1xyXG5leHBvcnQgZGVmYXVsdCBMYXllck1vZGVsT2JzZXJ2YXRpb25XaW5kb3c7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsU0FBUyxNQUE0Qix1Q0FBdUM7QUFDbkYsU0FBU0MsS0FBSyxFQUFFQyxjQUFjLEVBQUVDLGdCQUFnQixFQUFR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