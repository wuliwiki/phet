// Copyright 2021-2022, University of Colorado Boulder

/**
 * Class that represents an atomic bond in the view.
 *
 * @author John Blanco
 * @author Jesse Greenberg
 */

import Vector2 from '../../../../dot/js/Vector2.js';
import { Line, Node } from '../../../../scenery/js/imports.js';
import greenhouseEffect from '../../greenhouseEffect.js';

// constants that control the width of the bond representation with with respect to the average atom radius.
const BOND_WIDTH_PROPORTION_SINGLE = 0.45;
const BOND_WIDTH_PROPORTION_DOUBLE = 0.28;
const BOND_WIDTH_PROPORTION_TRIPLE = 0.24;
const BOND_COLOR = 'rgb(0, 200, 0)';
class AtomicBondNode extends Node {
  /**
   * Constructor for an atomic bond node.
   *
   * @param {AtomicBond} atomicBond
   * @param {ModelViewTransform2} modelViewTransform
   */
  constructor(atomicBond, modelViewTransform) {
    assert && assert(atomicBond.bondCount > 0 && atomicBond.bondCount <= 3); // Only single through triple bonds currently supported.

    // supertype constructor
    super();

    // @private
    this.atomicBond = atomicBond;
    this.modelViewTransform = modelViewTransform;
    this.atomicBonds = []; // Array which holds the lines for the atomicBonds.

    // Carry this node through the scope in nested functions.

    // Calculate the width to use for the bond representation(s) // @private

    this.averageAtomRadius = modelViewTransform.modelToViewDeltaX((atomicBond.atom1.radius + atomicBond.atom2.radius) / 2);

    // Create the initial representation.
    this.initializeRepresentation();

    // Link the atomic bond view node to the model.  Atomic bonds must be updated when either atom changes position.
    this.atomicBond.atom1.positionProperty.link(() => {
      this.updateRepresentation();
    });
    this.atomicBond.atom2.positionProperty.link(() => {
      this.updateRepresentation();
    });
  }

  /**
   * Draw the initial lines which represent the atomic bonds.  This function should only be called once.  Drawing the
   * lines a single time should provide a performance benefit.  This will also set the bond width for the lines for
   * each case of 1, 2, or 3 atomic bonds.
   * @private
   */
  initializeRepresentation() {
    let bondWidth; // Width of the line representing this bond.  Dependent on the number of bonds between the atoms.
    let bond1; // First bond shared by the atoms.
    let bond2; // Second bond shared by the atoms.
    let bond3; // Third bond shared by the atoms.

    switch (this.atomicBond.bondCount) {
      case 1:
        bondWidth = BOND_WIDTH_PROPORTION_SINGLE * this.averageAtomRadius;
        bond1 = new Line({
          lineWidth: bondWidth,
          stroke: BOND_COLOR
        });
        this.atomicBonds.push(bond1);
        this.addChild(bond1);
        break;
      case 2:
        bondWidth = BOND_WIDTH_PROPORTION_DOUBLE * this.averageAtomRadius;
        bond1 = new Line({
          lineWidth: bondWidth,
          stroke: BOND_COLOR
        });
        bond2 = new Line({
          lineWidth: bondWidth,
          stroke: BOND_COLOR
        });
        this.atomicBonds.push(bond1, bond2);
        this.addChild(bond1);
        this.addChild(bond2);
        break;
      case 3:
        // Draw the bonds.
        bondWidth = BOND_WIDTH_PROPORTION_TRIPLE * this.averageAtomRadius;
        bond1 = new Line({
          lineWidth: bondWidth,
          stroke: BOND_COLOR
        });
        bond2 = new Line({
          lineWidth: bondWidth,
          stroke: BOND_COLOR
        });
        bond3 = new Line({
          lineWidth: bondWidth,
          stroke: BOND_COLOR
        });
        this.atomicBonds.push(bond1, bond2, bond3);
        this.addChild(bond1);
        this.addChild(bond2);
        this.addChild(bond3);
        break;
      default:
        console.error(` - Error: Can't represent bond number, value = ${this.atomicBond.getBondCount()}`);
        assert && assert(false);
        break;
    }
  }

  /**
   * Update the atomic bond positions by setting the end points of line to the positions of the
   * atoms which share the bond.
   * @private
   */
  updateRepresentation() {
    // centers of the atoms in view coordinates
    const atom1Position = this.modelViewTransform.modelToViewPosition(this.atomicBond.atom1.positionProperty.get());
    const atom2Position = this.modelViewTransform.modelToViewPosition(this.atomicBond.atom2.positionProperty.get());

    // bond position offsets in view coordinates
    const p1BondOffset = this.modelViewTransform.modelToViewDelta(this.atomicBond.atom1PositionOffset);
    const p2BondOffset = this.modelViewTransform.modelToViewDelta(this.atomicBond.atom2PositionOffset);

    // Point describing position of one end of the line representing this atomic bond.
    const p1 = atom1Position.plus(p1BondOffset);

    // Point describing position of the other end of the line representing the atomic bond.
    const p2 = atom2Position.plus(p2BondOffset);
    let offsetVector; // Vector which places the atomic bonds an offset away from the center between the atoms.
    let angle; // An angle used to describe the offset vector.
    let transformedRadius; // A position required to calculate the offset vector.

    switch (this.atomicBond.bondCount) {
      case 1:
        // Single bond, so connect it from the center of one atom to the center of the other
        this.atomicBonds[0].setLine(p1.x, p1.y, p2.x, p2.y);
        break;
      case 2:
        // Double bond.
        transformedRadius = this.modelViewTransform.modelToViewDeltaX(Math.min(this.atomicBond.atom1.radius, this.atomicBond.atom2.radius));
        // Get the center points of the two atoms.
        angle = Math.atan2(p1.x - p2.x, p1.y - p2.y);
        // Create a vector that will act as the offset from the center point to the origin of the bond line.
        offsetVector = Vector2.createPolar(transformedRadius / 3, angle);

        // Draw the bonds.
        this.atomicBonds[0].setLine(p1.x + offsetVector.x, p1.y - offsetVector.y, p2.x + offsetVector.x, p2.y - offsetVector.y);
        offsetVector.rotate(Math.PI);
        this.atomicBonds[1].setLine(p1.x + offsetVector.x, p1.y - offsetVector.y, p2.x + offsetVector.x, p2.y - offsetVector.y);
        break;
      case 3:
        // Triple bond.
        transformedRadius = this.modelViewTransform.modelToViewDeltaX(Math.min(this.atomicBond.atom1.radius, this.atomicBond.atom2.radius));
        // Get the center points of the two atoms.
        angle = Math.atan2(p1.x - p2.x, p1.y - p2.y);
        // Create a vector that will act as the offset from the center point to the origin of the bond line.
        offsetVector = Vector2.createPolar(transformedRadius * 0.6, angle);

        // Draw the bonds.
        this.atomicBonds[0].setLine(p1.x, p1.y, p2.x, p2.y);
        this.atomicBonds[1].setLine(p1.x + offsetVector.x, p1.y - offsetVector.y, p2.x + offsetVector.x, p2.y - offsetVector.y);
        offsetVector.rotate(Math.PI);
        this.atomicBonds[2].setLine(p1.x + offsetVector.x, p1.y - offsetVector.y, p2.x + offsetVector.x, p2.y - offsetVector.y);
        break;
      default:
        console.error(` - Error: Can't represent bond number, value = ${this.atomicBond.bondCount}`);
        assert && assert(false);
        break;
    }
  }
}
greenhouseEffect.register('AtomicBondNode', AtomicBondNode);
export default AtomicBondNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWZWN0b3IyIiwiTGluZSIsIk5vZGUiLCJncmVlbmhvdXNlRWZmZWN0IiwiQk9ORF9XSURUSF9QUk9QT1JUSU9OX1NJTkdMRSIsIkJPTkRfV0lEVEhfUFJPUE9SVElPTl9ET1VCTEUiLCJCT05EX1dJRFRIX1BST1BPUlRJT05fVFJJUExFIiwiQk9ORF9DT0xPUiIsIkF0b21pY0JvbmROb2RlIiwiY29uc3RydWN0b3IiLCJhdG9taWNCb25kIiwibW9kZWxWaWV3VHJhbnNmb3JtIiwiYXNzZXJ0IiwiYm9uZENvdW50IiwiYXRvbWljQm9uZHMiLCJhdmVyYWdlQXRvbVJhZGl1cyIsIm1vZGVsVG9WaWV3RGVsdGFYIiwiYXRvbTEiLCJyYWRpdXMiLCJhdG9tMiIsImluaXRpYWxpemVSZXByZXNlbnRhdGlvbiIsInBvc2l0aW9uUHJvcGVydHkiLCJsaW5rIiwidXBkYXRlUmVwcmVzZW50YXRpb24iLCJib25kV2lkdGgiLCJib25kMSIsImJvbmQyIiwiYm9uZDMiLCJsaW5lV2lkdGgiLCJzdHJva2UiLCJwdXNoIiwiYWRkQ2hpbGQiLCJjb25zb2xlIiwiZXJyb3IiLCJnZXRCb25kQ291bnQiLCJhdG9tMVBvc2l0aW9uIiwibW9kZWxUb1ZpZXdQb3NpdGlvbiIsImdldCIsImF0b20yUG9zaXRpb24iLCJwMUJvbmRPZmZzZXQiLCJtb2RlbFRvVmlld0RlbHRhIiwiYXRvbTFQb3NpdGlvbk9mZnNldCIsInAyQm9uZE9mZnNldCIsImF0b20yUG9zaXRpb25PZmZzZXQiLCJwMSIsInBsdXMiLCJwMiIsIm9mZnNldFZlY3RvciIsImFuZ2xlIiwidHJhbnNmb3JtZWRSYWRpdXMiLCJzZXRMaW5lIiwieCIsInkiLCJNYXRoIiwibWluIiwiYXRhbjIiLCJjcmVhdGVQb2xhciIsInJvdGF0ZSIsIlBJIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJBdG9taWNCb25kTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMS0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBDbGFzcyB0aGF0IHJlcHJlc2VudHMgYW4gYXRvbWljIGJvbmQgaW4gdGhlIHZpZXcuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY29cclxuICogQGF1dGhvciBKZXNzZSBHcmVlbmJlcmdcclxuICovXHJcblxyXG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XHJcbmltcG9ydCB7IExpbmUsIE5vZGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgZ3JlZW5ob3VzZUVmZmVjdCBmcm9tICcuLi8uLi9ncmVlbmhvdXNlRWZmZWN0LmpzJztcclxuXHJcbi8vIGNvbnN0YW50cyB0aGF0IGNvbnRyb2wgdGhlIHdpZHRoIG9mIHRoZSBib25kIHJlcHJlc2VudGF0aW9uIHdpdGggd2l0aCByZXNwZWN0IHRvIHRoZSBhdmVyYWdlIGF0b20gcmFkaXVzLlxyXG5jb25zdCBCT05EX1dJRFRIX1BST1BPUlRJT05fU0lOR0xFID0gMC40NTtcclxuY29uc3QgQk9ORF9XSURUSF9QUk9QT1JUSU9OX0RPVUJMRSA9IDAuMjg7XHJcbmNvbnN0IEJPTkRfV0lEVEhfUFJPUE9SVElPTl9UUklQTEUgPSAwLjI0O1xyXG5jb25zdCBCT05EX0NPTE9SID0gJ3JnYigwLCAyMDAsIDApJztcclxuXHJcbmNsYXNzIEF0b21pY0JvbmROb2RlIGV4dGVuZHMgTm9kZSB7XHJcblxyXG4gIC8qKlxyXG4gICAqIENvbnN0cnVjdG9yIGZvciBhbiBhdG9taWMgYm9uZCBub2RlLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtBdG9taWNCb25kfSBhdG9taWNCb25kXHJcbiAgICogQHBhcmFtIHtNb2RlbFZpZXdUcmFuc2Zvcm0yfSBtb2RlbFZpZXdUcmFuc2Zvcm1cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggYXRvbWljQm9uZCwgbW9kZWxWaWV3VHJhbnNmb3JtICkge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggYXRvbWljQm9uZC5ib25kQ291bnQgPiAwICYmIGF0b21pY0JvbmQuYm9uZENvdW50IDw9IDMgKTsgIC8vIE9ubHkgc2luZ2xlIHRocm91Z2ggdHJpcGxlIGJvbmRzIGN1cnJlbnRseSBzdXBwb3J0ZWQuXHJcblxyXG4gICAgLy8gc3VwZXJ0eXBlIGNvbnN0cnVjdG9yXHJcbiAgICBzdXBlcigpO1xyXG5cclxuICAgIC8vIEBwcml2YXRlXHJcbiAgICB0aGlzLmF0b21pY0JvbmQgPSBhdG9taWNCb25kO1xyXG4gICAgdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0gPSBtb2RlbFZpZXdUcmFuc2Zvcm07XHJcbiAgICB0aGlzLmF0b21pY0JvbmRzID0gW107IC8vIEFycmF5IHdoaWNoIGhvbGRzIHRoZSBsaW5lcyBmb3IgdGhlIGF0b21pY0JvbmRzLlxyXG5cclxuICAgIC8vIENhcnJ5IHRoaXMgbm9kZSB0aHJvdWdoIHRoZSBzY29wZSBpbiBuZXN0ZWQgZnVuY3Rpb25zLlxyXG5cclxuICAgIC8vIENhbGN1bGF0ZSB0aGUgd2lkdGggdG8gdXNlIGZvciB0aGUgYm9uZCByZXByZXNlbnRhdGlvbihzKSAvLyBAcHJpdmF0ZVxyXG5cclxuICAgIHRoaXMuYXZlcmFnZUF0b21SYWRpdXMgPSBtb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdEZWx0YVgoICggYXRvbWljQm9uZC5hdG9tMS5yYWRpdXMgKyBhdG9taWNCb25kLmF0b20yLnJhZGl1cyApIC8gMiApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgaW5pdGlhbCByZXByZXNlbnRhdGlvbi5cclxuICAgIHRoaXMuaW5pdGlhbGl6ZVJlcHJlc2VudGF0aW9uKCk7XHJcblxyXG4gICAgLy8gTGluayB0aGUgYXRvbWljIGJvbmQgdmlldyBub2RlIHRvIHRoZSBtb2RlbC4gIEF0b21pYyBib25kcyBtdXN0IGJlIHVwZGF0ZWQgd2hlbiBlaXRoZXIgYXRvbSBjaGFuZ2VzIHBvc2l0aW9uLlxyXG4gICAgdGhpcy5hdG9taWNCb25kLmF0b20xLnBvc2l0aW9uUHJvcGVydHkubGluayggKCkgPT4ge1xyXG4gICAgICB0aGlzLnVwZGF0ZVJlcHJlc2VudGF0aW9uKCk7XHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmF0b21pY0JvbmQuYXRvbTIucG9zaXRpb25Qcm9wZXJ0eS5saW5rKCAoKSA9PiB7XHJcbiAgICAgIHRoaXMudXBkYXRlUmVwcmVzZW50YXRpb24oKTtcclxuICAgIH0gKTtcclxuXHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogRHJhdyB0aGUgaW5pdGlhbCBsaW5lcyB3aGljaCByZXByZXNlbnQgdGhlIGF0b21pYyBib25kcy4gIFRoaXMgZnVuY3Rpb24gc2hvdWxkIG9ubHkgYmUgY2FsbGVkIG9uY2UuICBEcmF3aW5nIHRoZVxyXG4gICAqIGxpbmVzIGEgc2luZ2xlIHRpbWUgc2hvdWxkIHByb3ZpZGUgYSBwZXJmb3JtYW5jZSBiZW5lZml0LiAgVGhpcyB3aWxsIGFsc28gc2V0IHRoZSBib25kIHdpZHRoIGZvciB0aGUgbGluZXMgZm9yXHJcbiAgICogZWFjaCBjYXNlIG9mIDEsIDIsIG9yIDMgYXRvbWljIGJvbmRzLlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgaW5pdGlhbGl6ZVJlcHJlc2VudGF0aW9uKCkge1xyXG5cclxuICAgIGxldCBib25kV2lkdGg7IC8vIFdpZHRoIG9mIHRoZSBsaW5lIHJlcHJlc2VudGluZyB0aGlzIGJvbmQuICBEZXBlbmRlbnQgb24gdGhlIG51bWJlciBvZiBib25kcyBiZXR3ZWVuIHRoZSBhdG9tcy5cclxuICAgIGxldCBib25kMTsgLy8gRmlyc3QgYm9uZCBzaGFyZWQgYnkgdGhlIGF0b21zLlxyXG4gICAgbGV0IGJvbmQyOyAvLyBTZWNvbmQgYm9uZCBzaGFyZWQgYnkgdGhlIGF0b21zLlxyXG4gICAgbGV0IGJvbmQzOyAvLyBUaGlyZCBib25kIHNoYXJlZCBieSB0aGUgYXRvbXMuXHJcblxyXG4gICAgc3dpdGNoKCB0aGlzLmF0b21pY0JvbmQuYm9uZENvdW50ICkge1xyXG4gICAgICBjYXNlIDE6XHJcbiAgICAgICAgYm9uZFdpZHRoID0gQk9ORF9XSURUSF9QUk9QT1JUSU9OX1NJTkdMRSAqIHRoaXMuYXZlcmFnZUF0b21SYWRpdXM7XHJcbiAgICAgICAgYm9uZDEgPSBuZXcgTGluZSggeyBsaW5lV2lkdGg6IGJvbmRXaWR0aCwgc3Ryb2tlOiBCT05EX0NPTE9SIH0gKTtcclxuICAgICAgICB0aGlzLmF0b21pY0JvbmRzLnB1c2goIGJvbmQxICk7XHJcbiAgICAgICAgdGhpcy5hZGRDaGlsZCggYm9uZDEgKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgMjpcclxuICAgICAgICBib25kV2lkdGggPSBCT05EX1dJRFRIX1BST1BPUlRJT05fRE9VQkxFICogdGhpcy5hdmVyYWdlQXRvbVJhZGl1cztcclxuICAgICAgICBib25kMSA9IG5ldyBMaW5lKCB7IGxpbmVXaWR0aDogYm9uZFdpZHRoLCBzdHJva2U6IEJPTkRfQ09MT1IgfSApO1xyXG4gICAgICAgIGJvbmQyID0gbmV3IExpbmUoIHsgbGluZVdpZHRoOiBib25kV2lkdGgsIHN0cm9rZTogQk9ORF9DT0xPUiB9ICk7XHJcbiAgICAgICAgdGhpcy5hdG9taWNCb25kcy5wdXNoKCBib25kMSwgYm9uZDIgKTtcclxuICAgICAgICB0aGlzLmFkZENoaWxkKCBib25kMSApO1xyXG4gICAgICAgIHRoaXMuYWRkQ2hpbGQoIGJvbmQyICk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIDM6XHJcblxyXG4gICAgICAgIC8vIERyYXcgdGhlIGJvbmRzLlxyXG4gICAgICAgIGJvbmRXaWR0aCA9IEJPTkRfV0lEVEhfUFJPUE9SVElPTl9UUklQTEUgKiB0aGlzLmF2ZXJhZ2VBdG9tUmFkaXVzO1xyXG4gICAgICAgIGJvbmQxID0gbmV3IExpbmUoIHsgbGluZVdpZHRoOiBib25kV2lkdGgsIHN0cm9rZTogQk9ORF9DT0xPUiB9ICk7XHJcbiAgICAgICAgYm9uZDIgPSBuZXcgTGluZSggeyBsaW5lV2lkdGg6IGJvbmRXaWR0aCwgc3Ryb2tlOiBCT05EX0NPTE9SIH0gKTtcclxuICAgICAgICBib25kMyA9IG5ldyBMaW5lKCB7IGxpbmVXaWR0aDogYm9uZFdpZHRoLCBzdHJva2U6IEJPTkRfQ09MT1IgfSApO1xyXG4gICAgICAgIHRoaXMuYXRvbWljQm9uZHMucHVzaCggYm9uZDEsIGJvbmQyLCBib25kMyApO1xyXG4gICAgICAgIHRoaXMuYWRkQ2hpbGQoIGJvbmQxICk7XHJcbiAgICAgICAgdGhpcy5hZGRDaGlsZCggYm9uZDIgKTtcclxuICAgICAgICB0aGlzLmFkZENoaWxkKCBib25kMyApO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBjb25zb2xlLmVycm9yKCBgIC0gRXJyb3I6IENhbid0IHJlcHJlc2VudCBib25kIG51bWJlciwgdmFsdWUgPSAke3RoaXMuYXRvbWljQm9uZC5nZXRCb25kQ291bnQoKX1gICk7XHJcbiAgICAgICAgYXNzZXJ0ICYmIGFzc2VydCggZmFsc2UgKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSB0aGUgYXRvbWljIGJvbmQgcG9zaXRpb25zIGJ5IHNldHRpbmcgdGhlIGVuZCBwb2ludHMgb2YgbGluZSB0byB0aGUgcG9zaXRpb25zIG9mIHRoZVxyXG4gICAqIGF0b21zIHdoaWNoIHNoYXJlIHRoZSBib25kLlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgdXBkYXRlUmVwcmVzZW50YXRpb24oKSB7XHJcblxyXG4gICAgLy8gY2VudGVycyBvZiB0aGUgYXRvbXMgaW4gdmlldyBjb29yZGluYXRlc1xyXG4gICAgY29uc3QgYXRvbTFQb3NpdGlvbiA9IHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3UG9zaXRpb24oIHRoaXMuYXRvbWljQm9uZC5hdG9tMS5wb3NpdGlvblByb3BlcnR5LmdldCgpICk7XHJcbiAgICBjb25zdCBhdG9tMlBvc2l0aW9uID0gdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdQb3NpdGlvbiggdGhpcy5hdG9taWNCb25kLmF0b20yLnBvc2l0aW9uUHJvcGVydHkuZ2V0KCkgKTtcclxuXHJcbiAgICAvLyBib25kIHBvc2l0aW9uIG9mZnNldHMgaW4gdmlldyBjb29yZGluYXRlc1xyXG4gICAgY29uc3QgcDFCb25kT2Zmc2V0ID0gdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdEZWx0YSggdGhpcy5hdG9taWNCb25kLmF0b20xUG9zaXRpb25PZmZzZXQgKTtcclxuICAgIGNvbnN0IHAyQm9uZE9mZnNldCA9IHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3RGVsdGEoIHRoaXMuYXRvbWljQm9uZC5hdG9tMlBvc2l0aW9uT2Zmc2V0ICk7XHJcblxyXG4gICAgLy8gUG9pbnQgZGVzY3JpYmluZyBwb3NpdGlvbiBvZiBvbmUgZW5kIG9mIHRoZSBsaW5lIHJlcHJlc2VudGluZyB0aGlzIGF0b21pYyBib25kLlxyXG4gICAgY29uc3QgcDEgPSBhdG9tMVBvc2l0aW9uLnBsdXMoIHAxQm9uZE9mZnNldCApO1xyXG5cclxuICAgIC8vIFBvaW50IGRlc2NyaWJpbmcgcG9zaXRpb24gb2YgdGhlIG90aGVyIGVuZCBvZiB0aGUgbGluZSByZXByZXNlbnRpbmcgdGhlIGF0b21pYyBib25kLlxyXG4gICAgY29uc3QgcDIgPSBhdG9tMlBvc2l0aW9uLnBsdXMoIHAyQm9uZE9mZnNldCApO1xyXG5cclxuICAgIGxldCBvZmZzZXRWZWN0b3I7IC8vIFZlY3RvciB3aGljaCBwbGFjZXMgdGhlIGF0b21pYyBib25kcyBhbiBvZmZzZXQgYXdheSBmcm9tIHRoZSBjZW50ZXIgYmV0d2VlbiB0aGUgYXRvbXMuXHJcbiAgICBsZXQgYW5nbGU7IC8vIEFuIGFuZ2xlIHVzZWQgdG8gZGVzY3JpYmUgdGhlIG9mZnNldCB2ZWN0b3IuXHJcbiAgICBsZXQgdHJhbnNmb3JtZWRSYWRpdXM7IC8vIEEgcG9zaXRpb24gcmVxdWlyZWQgdG8gY2FsY3VsYXRlIHRoZSBvZmZzZXQgdmVjdG9yLlxyXG5cclxuICAgIHN3aXRjaCggdGhpcy5hdG9taWNCb25kLmJvbmRDb3VudCApIHtcclxuXHJcbiAgICAgIGNhc2UgMTpcclxuXHJcbiAgICAgICAgLy8gU2luZ2xlIGJvbmQsIHNvIGNvbm5lY3QgaXQgZnJvbSB0aGUgY2VudGVyIG9mIG9uZSBhdG9tIHRvIHRoZSBjZW50ZXIgb2YgdGhlIG90aGVyXHJcbiAgICAgICAgdGhpcy5hdG9taWNCb25kc1sgMCBdLnNldExpbmUoIHAxLngsIHAxLnksIHAyLngsIHAyLnkgKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgMjpcclxuXHJcbiAgICAgICAgLy8gRG91YmxlIGJvbmQuXHJcbiAgICAgICAgdHJhbnNmb3JtZWRSYWRpdXMgPSB0aGlzLm1vZGVsVmlld1RyYW5zZm9ybS5tb2RlbFRvVmlld0RlbHRhWCggTWF0aC5taW4oIHRoaXMuYXRvbWljQm9uZC5hdG9tMS5yYWRpdXMsXHJcbiAgICAgICAgICB0aGlzLmF0b21pY0JvbmQuYXRvbTIucmFkaXVzICkgKTtcclxuICAgICAgICAvLyBHZXQgdGhlIGNlbnRlciBwb2ludHMgb2YgdGhlIHR3byBhdG9tcy5cclxuICAgICAgICBhbmdsZSA9IE1hdGguYXRhbjIoIHAxLnggLSBwMi54LCBwMS55IC0gcDIueSApO1xyXG4gICAgICAgIC8vIENyZWF0ZSBhIHZlY3RvciB0aGF0IHdpbGwgYWN0IGFzIHRoZSBvZmZzZXQgZnJvbSB0aGUgY2VudGVyIHBvaW50IHRvIHRoZSBvcmlnaW4gb2YgdGhlIGJvbmQgbGluZS5cclxuICAgICAgICBvZmZzZXRWZWN0b3IgPSBWZWN0b3IyLmNyZWF0ZVBvbGFyKCB0cmFuc2Zvcm1lZFJhZGl1cyAvIDMsIGFuZ2xlICk7XHJcblxyXG4gICAgICAgIC8vIERyYXcgdGhlIGJvbmRzLlxyXG4gICAgICAgIHRoaXMuYXRvbWljQm9uZHNbIDAgXS5zZXRMaW5lKCBwMS54ICsgb2Zmc2V0VmVjdG9yLngsIHAxLnkgLSBvZmZzZXRWZWN0b3IueSwgcDIueCArIG9mZnNldFZlY3Rvci54LCBwMi55IC0gb2Zmc2V0VmVjdG9yLnkgKTtcclxuICAgICAgICBvZmZzZXRWZWN0b3Iucm90YXRlKCBNYXRoLlBJICk7XHJcbiAgICAgICAgdGhpcy5hdG9taWNCb25kc1sgMSBdLnNldExpbmUoIHAxLnggKyBvZmZzZXRWZWN0b3IueCwgcDEueSAtIG9mZnNldFZlY3Rvci55LCBwMi54ICsgb2Zmc2V0VmVjdG9yLngsIHAyLnkgLSBvZmZzZXRWZWN0b3IueSApO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAzOlxyXG5cclxuICAgICAgICAvLyBUcmlwbGUgYm9uZC5cclxuICAgICAgICB0cmFuc2Zvcm1lZFJhZGl1cyA9IHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtLm1vZGVsVG9WaWV3RGVsdGFYKCBNYXRoLm1pbiggdGhpcy5hdG9taWNCb25kLmF0b20xLnJhZGl1cyxcclxuICAgICAgICAgIHRoaXMuYXRvbWljQm9uZC5hdG9tMi5yYWRpdXMgKSApO1xyXG4gICAgICAgIC8vIEdldCB0aGUgY2VudGVyIHBvaW50cyBvZiB0aGUgdHdvIGF0b21zLlxyXG4gICAgICAgIGFuZ2xlID0gTWF0aC5hdGFuMiggcDEueCAtIHAyLngsIHAxLnkgLSBwMi55ICk7XHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgdmVjdG9yIHRoYXQgd2lsbCBhY3QgYXMgdGhlIG9mZnNldCBmcm9tIHRoZSBjZW50ZXIgcG9pbnQgdG8gdGhlIG9yaWdpbiBvZiB0aGUgYm9uZCBsaW5lLlxyXG4gICAgICAgIG9mZnNldFZlY3RvciA9IFZlY3RvcjIuY3JlYXRlUG9sYXIoIHRyYW5zZm9ybWVkUmFkaXVzICogMC42LCBhbmdsZSApO1xyXG5cclxuICAgICAgICAvLyBEcmF3IHRoZSBib25kcy5cclxuICAgICAgICB0aGlzLmF0b21pY0JvbmRzWyAwIF0uc2V0TGluZSggcDEueCwgcDEueSwgcDIueCwgcDIueSApO1xyXG4gICAgICAgIHRoaXMuYXRvbWljQm9uZHNbIDEgXS5zZXRMaW5lKCBwMS54ICsgb2Zmc2V0VmVjdG9yLngsIHAxLnkgLSBvZmZzZXRWZWN0b3IueSwgcDIueCArIG9mZnNldFZlY3Rvci54LCBwMi55IC0gb2Zmc2V0VmVjdG9yLnkgKTtcclxuICAgICAgICBvZmZzZXRWZWN0b3Iucm90YXRlKCBNYXRoLlBJICk7XHJcbiAgICAgICAgdGhpcy5hdG9taWNCb25kc1sgMiBdLnNldExpbmUoIHAxLnggKyBvZmZzZXRWZWN0b3IueCwgcDEueSAtIG9mZnNldFZlY3Rvci55LCBwMi54ICsgb2Zmc2V0VmVjdG9yLngsIHAyLnkgLSBvZmZzZXRWZWN0b3IueSApO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBjb25zb2xlLmVycm9yKCBgIC0gRXJyb3I6IENhbid0IHJlcHJlc2VudCBib25kIG51bWJlciwgdmFsdWUgPSAke3RoaXMuYXRvbWljQm9uZC5ib25kQ291bnR9YCApO1xyXG4gICAgICAgIGFzc2VydCAmJiBhc3NlcnQoIGZhbHNlICk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZ3JlZW5ob3VzZUVmZmVjdC5yZWdpc3RlciggJ0F0b21pY0JvbmROb2RlJywgQXRvbWljQm9uZE5vZGUgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEF0b21pY0JvbmROb2RlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLE9BQU8sTUFBTSwrQkFBK0I7QUFDbkQsU0FBU0MsSUFBSSxFQUFFQyxJQUFJLFFBQVEsbUNBQW1DO0FBQzlELE9BQU9DLGdCQUFnQixNQUFNLDJCQUEyQjs7QUFFeEQ7QUFDQSxNQUFNQyw0QkFBNEIsR0FBRyxJQUFJO0FBQ3pDLE1BQU1DLDRCQUE0QixHQUFHLElBQUk7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