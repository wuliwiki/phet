// Copyright 2020-2023, University of Colorado Boulder

/**
 * View for Molecules and Light
 *
 * @author Jesse Greenberg (PhET Interactive Simulations)
 * @author Sam Reid (PhET Interactive Simulations)
 * @author John Blanco
 *
 */

import Bounds2 from '../../../../dot/js/Bounds2.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
import Utils from '../../../../dot/js/Utils.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import ScreenView from '../../../../joist/js/ScreenView.js';
import ModelViewTransform2 from '../../../../phetcommon/js/view/ModelViewTransform2.js';
import ResetAllButton from '../../../../scenery-phet/js/buttons/ResetAllButton.js';
import PhetFont from '../../../../scenery-phet/js/PhetFont.js';
import TimeControlNode from '../../../../scenery-phet/js/TimeControlNode.js';
import { AriaHasPopUpMutator, KeyboardListener, Node, Rectangle, Text } from '../../../../scenery/js/imports.js';
import RectangularPushButton from '../../../../sun/js/buttons/RectangularPushButton.js';
import Dialog from '../../../../sun/js/Dialog.js';
import nullSoundPlayer from '../../../../tambo/js/shared-sound-players/nullSoundPlayer.js';
import stepForwardSoundPlayer from '../../../../tambo/js/shared-sound-players/stepForwardSoundPlayer.js';
import soundManager from '../../../../tambo/js/soundManager.js';
import PhetioCapsule from '../../../../tandem/js/PhetioCapsule.js';
import GreenhouseEffectQueryParameters from '../../common/GreenhouseEffectQueryParameters.js';
import greenhouseEffect from '../../greenhouseEffect.js';
import GreenhouseEffectStrings from '../../GreenhouseEffectStrings.js';
import Molecule from '../model/Molecule.js';
import PhotonAbsorptionModel from '../model/PhotonAbsorptionModel.js';
import LightSpectrumDialog from './LightSpectrumDialog.js';
import MicroObservationWindow from './MicroObservationWindow.js';
import MicroScreenSummaryNode from './MicroScreenSummaryNode.js';
import MoleculeActionSoundGenerator from './MoleculeActionSoundGenerator.js';
import MoleculeSelectionPanel from './MoleculeSelectionPanel.js';
import PhotonEmissionSoundGenerator from './PhotonEmissionSoundGenerator.js';
import QuadEmissionFrequencyControlPanel from './QuadEmissionFrequencyControlPanel.js';
import SpectrumDiagram from './SpectrumDiagram.js';
import WindowFrameNode from './WindowFrameNode.js';
const spectrumWindowButtonCaptionStringProperty = GreenhouseEffectStrings.SpectrumWindow.buttonCaptionStringProperty;
const spectrumButtonLabelStringProperty = GreenhouseEffectStrings.a11y.spectrumButtonLabelStringProperty;
const spectrumButtonDescriptionStringProperty = GreenhouseEffectStrings.a11y.spectrumButtonDescriptionStringProperty;

// constants
// Model-view transform for intermediate coordinates.
const INTERMEDIATE_RENDERING_SIZE = new Dimension2(500, 300);

// Position for the top left corner of the observation window.
const OBSERVATION_WINDOW_POSITION = new Vector2(15, 15);

// Corner radius of the observation window.
const CORNER_RADIUS = 7;

// Line width of the observation window frame
const FRAME_LINE_WIDTH = 5;
class MicroScreenView extends ScreenView {
  /**
   * @param {PhotonAbsorptionModel} photonAbsorptionModel
   * @param {Tandem} tandem
   */
  constructor(photonAbsorptionModel, tandem) {
    const modelViewTransform = ModelViewTransform2.createSinglePointScaleInvertedYMapping(Vector2.ZERO, new Vector2(Utils.roundSymmetric(INTERMEDIATE_RENDERING_SIZE.width * 0.55), Utils.roundSymmetric(INTERMEDIATE_RENDERING_SIZE.height * 0.50)), 0.10); // Scale factor - Smaller number zooms out, bigger number zooms in.

    // Create the observation window. This will hold all photons, molecules, and photonEmitters for this photon
    // absorption model.
    const observationWindow = new MicroObservationWindow(photonAbsorptionModel, modelViewTransform, tandem.createTandem('observationWindow'));
    super({
      layoutBounds: new Bounds2(0, 0, 768, 504),
      tandem: tandem,
      screenSummaryContent: new MicroScreenSummaryNode(photonAbsorptionModel, observationWindow.returnMoleculeButtonVisibleProperty)
    });

    // @private
    this.observationWindow = observationWindow;
    this.addChild(this.observationWindow);

    // This rectangle hides photons that are outside the observation window.
    // TODO: This rectangle is a temporary workaround that replaces the clipping area in MicroObservationWindow because of a
    // Safari specific SVG bug caused by clipping.  See https://github.com/phetsims/molecules-and-light/issues/105 and
    // https://github.com/phetsims/scenery/issues/412.
    const clipRectangle = new Rectangle(this.observationWindow.bounds.copy().dilate(4 * FRAME_LINE_WIDTH), CORNER_RADIUS, CORNER_RADIUS, {
      stroke: '#C5D6E8',
      lineWidth: 8 * FRAME_LINE_WIDTH,
      pickable: false
    });
    this.addChild(clipRectangle);

    // Create the window frame node that borders the observation window.
    const windowFrameNode = new WindowFrameNode(this.observationWindow, '#BED0E7', '#4070CE');
    this.addChild(windowFrameNode);

    // Set positions of the observation window and window frame.
    this.observationWindow.translate(OBSERVATION_WINDOW_POSITION);
    clipRectangle.translate(OBSERVATION_WINDOW_POSITION);
    windowFrameNode.translate(OBSERVATION_WINDOW_POSITION);

    // Create the control panel for photon emission frequency.
    const photonEmissionControlPanel = new QuadEmissionFrequencyControlPanel(photonAbsorptionModel, tandem.createTandem('photonEmissionControlPanel'));
    photonEmissionControlPanel.leftTop = new Vector2(OBSERVATION_WINDOW_POSITION.x, 350);

    // Create the molecule control panel
    const moleculeControlPanel = new MoleculeSelectionPanel(photonAbsorptionModel, tandem.createTandem('moleculeControlPanel'));
    moleculeControlPanel.leftTop = new Vector2(530, windowFrameNode.top);

    // Add reset all button.
    const resetAllButton = new ResetAllButton({
      listener: () => {
        photonAbsorptionModel.reset();
      },
      bottom: this.layoutBounds.bottom - 15,
      right: this.layoutBounds.right - 15,
      radius: 18,
      tandem: tandem.createTandem('resetAllButton')
    });
    this.addChild(resetAllButton);
    const timeControlNode = new TimeControlNode(photonAbsorptionModel.runningProperty, {
      timeSpeedProperty: photonAbsorptionModel.timeSpeedProperty,
      speedRadioButtonGroupOnLeft: true,
      playPauseStepButtonOptions: {
        // pdom
        playingDescription: GreenhouseEffectStrings.a11y.timeControls.playPauseButtonPlayingWithSpeedDescription,
        pausedDescription: GreenhouseEffectStrings.a11y.timeControls.playPauseButtonPausedWithSpeedDescription,
        playPauseButtonOptions: {
          radius: 23
        },
        stepForwardButtonOptions: {
          radius: 15,
          // assuming 60 frames per second
          listener: () => {
            photonAbsorptionModel.manualStep(1 / 60);
          }
        }
      },
      speedRadioButtonGroupOptions: {
        labelOptions: {
          maxWidth: 100 // i18n
        }
      },

      buttonGroupXSpacing: 25,
      centerBottom: moleculeControlPanel.centerBottom.plusXY(0, 65),
      tandem: tandem.createTandem('timeControlNode')
    });
    this.addChild(timeControlNode);

    // Content for the window that displays the EM spectrum upon request.  Constructed once here so that time is not
    // waisted drawing a new spectrum window every time the user presses the 'Show Light Spectrum' button.
    // @private
    const spectrumButtonLabelText = new SpectrumDiagram(tandem.createTandem('spectrumButtonLabelText'));
    const lightSpectrumDialogCapsule = new PhetioCapsule(tandem => {
      // Wrap in a node to prevent DAG problems if archetypes are also created
      return new LightSpectrumDialog(new Node({
        children: [spectrumButtonLabelText]
      }), tandem);
    }, [], {
      tandem: tandem.createTandem('lightSpectrumDialogCapsule'),
      phetioType: PhetioCapsule.PhetioCapsuleIO(Dialog.DialogIO)
    });

    // Add the button for displaying the electromagnetic spectrum. Scale down the button content when it gets too
    // large.  This is done to support translations.  Max width of this button is the width of the molecule control
    // panel minus twice the default x margin of a rectangular push button.
    const buttonContent = new Text(spectrumWindowButtonCaptionStringProperty, {
      font: new PhetFont(18)
    });
    if (buttonContent.width > moleculeControlPanel.width - 16) {
      buttonContent.scale((moleculeControlPanel.width - 16) / buttonContent.width);
    }
    const showLightSpectrumButton = new RectangularPushButton({
      content: buttonContent,
      baseColor: 'rgb(98, 173, 205)',
      touchAreaXDilation: 7,
      touchAreaYDilation: 7,
      listener: () => {
        const dialog = lightSpectrumDialogCapsule.getElement();
        dialog.show();
      },
      tandem: tandem.createTandem('showLightSpectrumButton'),
      // turn off default sound generation since dialog makes a sound when it opens
      soundPlayer: nullSoundPlayer,
      // pdom
      innerContent: spectrumButtonLabelStringProperty.value,
      descriptionContent: spectrumButtonDescriptionStringProperty.value,
      appendDescription: true,
      containerTagName: 'div'
    });

    // pdom - add an attribute that lets the user know the button opens a menu
    AriaHasPopUpMutator.mutateNode(showLightSpectrumButton, true);
    showLightSpectrumButton.centerTop = new Vector2(moleculeControlPanel.centerX, timeControlNode.bottom + 13);
    this.addChild(showLightSpectrumButton);

    // Add the nodes in the order necessary for correct layering.
    this.addChild(photonEmissionControlPanel);
    this.addChild(moleculeControlPanel);

    // pdom - the accessible order for contents in each PDOM section
    this.pdomPlayAreaNode.pdomOrder = [this.observationWindow, photonEmissionControlPanel, moleculeControlPanel];
    this.pdomControlAreaNode.pdomOrder = [timeControlNode, showLightSpectrumButton, resetAllButton];

    // Alternative Input - no matter where focus is in the document, pressing Alt+L will manually step forward
    // in time
    const keyboardListener = new KeyboardListener({
      keys: ['alt+l'],
      global: true,
      listenerFireTrigger: 'up',
      callback: (event, listener) => {
        if (!photonAbsorptionModel.runningProperty.get()) {
          // The global hotkey step has a larger time step so that it is easier for the photon to reach the molecule
          // and provide feedback for a non-visual experience. The timeStep is calculated so that a photon can never
          // move farther than the absorption window of a molecule in a single step and pass over the molecule without
          // checking for absorption.
          const timeStep = 2 * Molecule.PHOTON_ABSORPTION_DISTANCE / PhotonAbsorptionModel.PHOTON_VELOCITY;
          photonAbsorptionModel.manualStep(timeStep);
          stepForwardSoundPlayer.play();
        }
      }
    });
    timeControlNode.addInputListener(keyboardListener);

    // the light spectrum dialog and emission frequency control panel are removed in the
    // Open Sci Ed version
    if (GreenhouseEffectQueryParameters.openSciEd) {
      this.removeChild(showLightSpectrumButton);
      this.removeChild(photonEmissionControlPanel);
    }

    //-----------------------------------------------------------------------------------------------------------------
    // sound generation
    //-----------------------------------------------------------------------------------------------------------------

    // add the sound generator that will produce sound for the molecule actions, such as vibration, rotation, etc.
    soundManager.addSoundGenerator(new MoleculeActionSoundGenerator(photonAbsorptionModel.activeMolecules, photonAbsorptionModel.runningProperty, photonAbsorptionModel.slowMotionProperty));

    // add the sound generator that will produce the sounds when photons are emitted by the lamps or the active molecule
    soundManager.addSoundGenerator(new PhotonEmissionSoundGenerator(photonAbsorptionModel.photonGroup));
  }

  /**
   * View step, called by joist.
   * @param {number} dt
   * @public
   */
  step(dt) {
    this.observationWindow.step(dt);
  }
}
greenhouseEffect.register('MicroScreenView', MicroScreenView);
export default MicroScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb3VuZHMyIiwiRGltZW5zaW9uMiIsIlV0aWxzIiwiVmVjdG9yMiIsIlNjcmVlblZpZXciLCJNb2RlbFZpZXdUcmFuc2Zvcm0yIiwiUmVzZXRBbGxCdXR0b24iLCJQaGV0Rm9udCIsIlRpbWVDb250cm9sTm9kZSIsIkFyaWFIYXNQb3BVcE11dGF0b3IiLCJLZXlib2FyZExpc3RlbmVyIiwiTm9kZSIsIlJlY3RhbmdsZSIsIlRleHQiLCJSZWN0YW5ndWxhclB1c2hCdXR0b24iLCJEaWFsb2ciLCJudWxsU291bmRQbGF5ZXIiLCJzdGVwRm9yd2FyZFNvdW5kUGxheWVyIiwic291bmRNYW5hZ2VyIiwiUGhldGlvQ2Fwc3VsZSIsIkdyZWVuaG91c2VFZmZlY3RRdWVyeVBhcmFtZXRlcnMiLCJncmVlbmhvdXNlRWZmZWN0IiwiR3JlZW5ob3VzZUVmZmVjdFN0cmluZ3MiLCJNb2xlY3VsZSIsIlBob3RvbkFic29ycHRpb25Nb2RlbCIsIkxpZ2h0U3BlY3RydW1EaWFsb2ciLCJNaWNyb09ic2VydmF0aW9uV2luZG93IiwiTWljcm9TY3JlZW5TdW1tYXJ5Tm9kZSIsIk1vbGVjdWxlQWN0aW9uU291bmRHZW5lcmF0b3IiLCJNb2xlY3VsZVNlbGVjdGlvblBhbmVsIiwiUGhvdG9uRW1pc3Npb25Tb3VuZEdlbmVyYXRvciIsIlF1YWRFbWlzc2lvbkZyZXF1ZW5jeUNvbnRyb2xQYW5lbCIsIlNwZWN0cnVtRGlhZ3JhbSIsIldpbmRvd0ZyYW1lTm9kZSIsInNwZWN0cnVtV2luZG93QnV0dG9uQ2FwdGlvblN0cmluZ1Byb3BlcnR5IiwiU3BlY3RydW1XaW5kb3ciLCJidXR0b25DYXB0aW9uU3RyaW5nUHJvcGVydHkiLCJzcGVjdHJ1bUJ1dHRvbkxhYmVsU3RyaW5nUHJvcGVydHkiLCJhMTF5Iiwic3BlY3RydW1CdXR0b25EZXNjcmlwdGlvblN0cmluZ1Byb3BlcnR5IiwiSU5URVJNRURJQVRFX1JFTkRFUklOR19TSVpFIiwiT0JTRVJWQVRJT05fV0lORE9XX1BPU0lUSU9OIiwiQ09STkVSX1JBRElVUyIsIkZSQU1FX0xJTkVfV0lEVEgiLCJNaWNyb1NjcmVlblZpZXciLCJjb25zdHJ1Y3RvciIsInBob3RvbkFic29ycHRpb25Nb2RlbCIsInRhbmRlbSIsIm1vZGVsVmlld1RyYW5zZm9ybSIsImNyZWF0ZVNpbmdsZVBvaW50U2NhbGVJbnZlcnRlZFlNYXBwaW5nIiwiWkVSTyIsInJvdW5kU3ltbWV0cmljIiwid2lkdGgiLCJoZWlnaHQiLCJvYnNlcnZhdGlvbldpbmRvdyIsImNyZWF0ZVRhbmRlbSIsImxheW91dEJvdW5kcyIsInNjcmVlblN1bW1hcnlDb250ZW50IiwicmV0dXJuTW9sZWN1bGVCdXR0b25WaXNpYmxlUHJvcGVydHkiLCJhZGRDaGlsZCIsImNsaXBSZWN0YW5nbGUiLCJib3VuZHMiLCJjb3B5IiwiZGlsYXRlIiwic3Ryb2tlIiwibGluZVdpZHRoIiwicGlja2FibGUiLCJ3aW5kb3dGcmFtZU5vZGUiLCJ0cmFuc2xhdGUiLCJwaG90b25FbWlzc2lvbkNvbnRyb2xQYW5lbCIsImxlZnRUb3AiLCJ4IiwibW9sZWN1bGVDb250cm9sUGFuZWwiLCJ0b3AiLCJyZXNldEFsbEJ1dHRvbiIsImxpc3RlbmVyIiwicmVzZXQiLCJib3R0b20iLCJyaWdodCIsInJhZGl1cyIsInRpbWVDb250cm9sTm9kZSIsInJ1bm5pbmdQcm9wZXJ0eSIsInRpbWVTcGVlZFByb3BlcnR5Iiwic3BlZWRSYWRpb0J1dHRvbkdyb3VwT25MZWZ0IiwicGxheVBhdXNlU3RlcEJ1dHRvbk9wdGlvbnMiLCJwbGF5aW5nRGVzY3JpcHRpb24iLCJ0aW1lQ29udHJvbHMiLCJwbGF5UGF1c2VCdXR0b25QbGF5aW5nV2l0aFNwZWVkRGVzY3JpcHRpb24iLCJwYXVzZWREZXNjcmlwdGlvbiIsInBsYXlQYXVzZUJ1dHRvblBhdXNlZFdpdGhTcGVlZERlc2NyaXB0aW9uIiwicGxheVBhdXNlQnV0dG9uT3B0aW9ucyIsInN0ZXBGb3J3YXJkQnV0dG9uT3B0aW9ucyIsIm1hbnVhbFN0ZXAiLCJzcGVlZFJhZGlvQnV0dG9uR3JvdXBPcHRpb25zIiwibGFiZWxPcHRpb25zIiwibWF4V2lkdGgiLCJidXR0b25Hcm91cFhTcGFjaW5nIiwiY2VudGVyQm90dG9tIiwicGx1c1hZIiwic3BlY3RydW1CdXR0b25MYWJlbFRleHQiLCJsaWdodFNwZWN0cnVtRGlhbG9nQ2Fwc3VsZSIsImNoaWxkcmVuIiwicGhldGlvVHlwZSIsIlBoZXRpb0NhcHN1bGVJTyIsIkRpYWxvZ0lPIiwiYnV0dG9uQ29udGVudCIsImZvbnQiLCJzY2FsZSIsInNob3dMaWdodFNwZWN0cnVtQnV0dG9uIiwiY29udGVudCIsImJhc2VDb2xvciIsInRvdWNoQXJlYVhEaWxhdGlvbiIsInRvdWNoQXJlYVlEaWxhdGlvbiIsImRpYWxvZyIsImdldEVsZW1lbnQiLCJzaG93Iiwic291bmRQbGF5ZXIiLCJpbm5lckNvbnRlbnQiLCJ2YWx1ZSIsImRlc2NyaXB0aW9uQ29udGVudCIsImFwcGVuZERlc2NyaXB0aW9uIiwiY29udGFpbmVyVGFnTmFtZSIsIm11dGF0ZU5vZGUiLCJjZW50ZXJUb3AiLCJjZW50ZXJYIiwicGRvbVBsYXlBcmVhTm9kZSIsInBkb21PcmRlciIsInBkb21Db250cm9sQXJlYU5vZGUiLCJrZXlib2FyZExpc3RlbmVyIiwia2V5cyIsImdsb2JhbCIsImxpc3RlbmVyRmlyZVRyaWdnZXIiLCJjYWxsYmFjayIsImV2ZW50IiwiZ2V0IiwidGltZVN0ZXAiLCJQSE9UT05fQUJTT1JQVElPTl9ESVNUQU5DRSIsIlBIT1RPTl9WRUxPQ0lUWSIsInBsYXkiLCJhZGRJbnB1dExpc3RlbmVyIiwib3BlblNjaUVkIiwicmVtb3ZlQ2hpbGQiLCJhZGRTb3VuZEdlbmVyYXRvciIsImFjdGl2ZU1vbGVjdWxlcyIsInNsb3dNb3Rpb25Qcm9wZXJ0eSIsInBob3Rvbkdyb3VwIiwic3RlcCIsImR0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJNaWNyb1NjcmVlblZpZXcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjAtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogVmlldyBmb3IgTW9sZWN1bGVzIGFuZCBMaWdodFxyXG4gKlxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBKb2huIEJsYW5jb1xyXG4gKlxyXG4gKi9cclxuXHJcbmltcG9ydCBCb3VuZHMyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9Cb3VuZHMyLmpzJztcclxuaW1wb3J0IERpbWVuc2lvbjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL0RpbWVuc2lvbjIuanMnO1xyXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1V0aWxzLmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgU2NyZWVuVmlldyBmcm9tICcuLi8uLi8uLi8uLi9qb2lzdC9qcy9TY3JlZW5WaWV3LmpzJztcclxuaW1wb3J0IE1vZGVsVmlld1RyYW5zZm9ybTIgZnJvbSAnLi4vLi4vLi4vLi4vcGhldGNvbW1vbi9qcy92aWV3L01vZGVsVmlld1RyYW5zZm9ybTIuanMnO1xyXG5pbXBvcnQgUmVzZXRBbGxCdXR0b24gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL2J1dHRvbnMvUmVzZXRBbGxCdXR0b24uanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IFRpbWVDb250cm9sTm9kZSBmcm9tICcuLi8uLi8uLi8uLi9zY2VuZXJ5LXBoZXQvanMvVGltZUNvbnRyb2xOb2RlLmpzJztcclxuaW1wb3J0IHsgQXJpYUhhc1BvcFVwTXV0YXRvciwgS2V5Ym9hcmRMaXN0ZW5lciwgTm9kZSwgUmVjdGFuZ2xlLCBUZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbiBmcm9tICcuLi8uLi8uLi8uLi9zdW4vanMvYnV0dG9ucy9SZWN0YW5ndWxhclB1c2hCdXR0b24uanMnO1xyXG5pbXBvcnQgRGlhbG9nIGZyb20gJy4uLy4uLy4uLy4uL3N1bi9qcy9EaWFsb2cuanMnO1xyXG5pbXBvcnQgbnVsbFNvdW5kUGxheWVyIGZyb20gJy4uLy4uLy4uLy4uL3RhbWJvL2pzL3NoYXJlZC1zb3VuZC1wbGF5ZXJzL251bGxTb3VuZFBsYXllci5qcyc7XHJcbmltcG9ydCBzdGVwRm9yd2FyZFNvdW5kUGxheWVyIGZyb20gJy4uLy4uLy4uLy4uL3RhbWJvL2pzL3NoYXJlZC1zb3VuZC1wbGF5ZXJzL3N0ZXBGb3J3YXJkU291bmRQbGF5ZXIuanMnO1xyXG5pbXBvcnQgc291bmRNYW5hZ2VyIGZyb20gJy4uLy4uLy4uLy4uL3RhbWJvL2pzL3NvdW5kTWFuYWdlci5qcyc7XHJcbmltcG9ydCBQaGV0aW9DYXBzdWxlIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9QaGV0aW9DYXBzdWxlLmpzJztcclxuaW1wb3J0IEdyZWVuaG91c2VFZmZlY3RRdWVyeVBhcmFtZXRlcnMgZnJvbSAnLi4vLi4vY29tbW9uL0dyZWVuaG91c2VFZmZlY3RRdWVyeVBhcmFtZXRlcnMuanMnO1xyXG5pbXBvcnQgZ3JlZW5ob3VzZUVmZmVjdCBmcm9tICcuLi8uLi9ncmVlbmhvdXNlRWZmZWN0LmpzJztcclxuaW1wb3J0IEdyZWVuaG91c2VFZmZlY3RTdHJpbmdzIGZyb20gJy4uLy4uL0dyZWVuaG91c2VFZmZlY3RTdHJpbmdzLmpzJztcclxuaW1wb3J0IE1vbGVjdWxlIGZyb20gJy4uL21vZGVsL01vbGVjdWxlLmpzJztcclxuaW1wb3J0IFBob3RvbkFic29ycHRpb25Nb2RlbCBmcm9tICcuLi9tb2RlbC9QaG90b25BYnNvcnB0aW9uTW9kZWwuanMnO1xyXG5pbXBvcnQgTGlnaHRTcGVjdHJ1bURpYWxvZyBmcm9tICcuL0xpZ2h0U3BlY3RydW1EaWFsb2cuanMnO1xyXG5pbXBvcnQgTWljcm9PYnNlcnZhdGlvbldpbmRvdyBmcm9tICcuL01pY3JvT2JzZXJ2YXRpb25XaW5kb3cuanMnO1xyXG5pbXBvcnQgTWljcm9TY3JlZW5TdW1tYXJ5Tm9kZSBmcm9tICcuL01pY3JvU2NyZWVuU3VtbWFyeU5vZGUuanMnO1xyXG5pbXBvcnQgTW9sZWN1bGVBY3Rpb25Tb3VuZEdlbmVyYXRvciBmcm9tICcuL01vbGVjdWxlQWN0aW9uU291bmRHZW5lcmF0b3IuanMnO1xyXG5pbXBvcnQgTW9sZWN1bGVTZWxlY3Rpb25QYW5lbCBmcm9tICcuL01vbGVjdWxlU2VsZWN0aW9uUGFuZWwuanMnO1xyXG5pbXBvcnQgUGhvdG9uRW1pc3Npb25Tb3VuZEdlbmVyYXRvciBmcm9tICcuL1Bob3RvbkVtaXNzaW9uU291bmRHZW5lcmF0b3IuanMnO1xyXG5pbXBvcnQgUXVhZEVtaXNzaW9uRnJlcXVlbmN5Q29udHJvbFBhbmVsIGZyb20gJy4vUXVhZEVtaXNzaW9uRnJlcXVlbmN5Q29udHJvbFBhbmVsLmpzJztcclxuaW1wb3J0IFNwZWN0cnVtRGlhZ3JhbSBmcm9tICcuL1NwZWN0cnVtRGlhZ3JhbS5qcyc7XHJcbmltcG9ydCBXaW5kb3dGcmFtZU5vZGUgZnJvbSAnLi9XaW5kb3dGcmFtZU5vZGUuanMnO1xyXG5cclxuY29uc3Qgc3BlY3RydW1XaW5kb3dCdXR0b25DYXB0aW9uU3RyaW5nUHJvcGVydHkgPSBHcmVlbmhvdXNlRWZmZWN0U3RyaW5ncy5TcGVjdHJ1bVdpbmRvdy5idXR0b25DYXB0aW9uU3RyaW5nUHJvcGVydHk7XHJcbmNvbnN0IHNwZWN0cnVtQnV0dG9uTGFiZWxTdHJpbmdQcm9wZXJ0eSA9IEdyZWVuaG91c2VFZmZlY3RTdHJpbmdzLmExMXkuc3BlY3RydW1CdXR0b25MYWJlbFN0cmluZ1Byb3BlcnR5O1xyXG5jb25zdCBzcGVjdHJ1bUJ1dHRvbkRlc2NyaXB0aW9uU3RyaW5nUHJvcGVydHkgPSBHcmVlbmhvdXNlRWZmZWN0U3RyaW5ncy5hMTF5LnNwZWN0cnVtQnV0dG9uRGVzY3JpcHRpb25TdHJpbmdQcm9wZXJ0eTtcclxuXHJcbi8vIGNvbnN0YW50c1xyXG4vLyBNb2RlbC12aWV3IHRyYW5zZm9ybSBmb3IgaW50ZXJtZWRpYXRlIGNvb3JkaW5hdGVzLlxyXG5jb25zdCBJTlRFUk1FRElBVEVfUkVOREVSSU5HX1NJWkUgPSBuZXcgRGltZW5zaW9uMiggNTAwLCAzMDAgKTtcclxuXHJcbi8vIFBvc2l0aW9uIGZvciB0aGUgdG9wIGxlZnQgY29ybmVyIG9mIHRoZSBvYnNlcnZhdGlvbiB3aW5kb3cuXHJcbmNvbnN0IE9CU0VSVkFUSU9OX1dJTkRPV19QT1NJVElPTiA9IG5ldyBWZWN0b3IyKCAxNSwgMTUgKTtcclxuXHJcbi8vIENvcm5lciByYWRpdXMgb2YgdGhlIG9ic2VydmF0aW9uIHdpbmRvdy5cclxuY29uc3QgQ09STkVSX1JBRElVUyA9IDc7XHJcblxyXG4vLyBMaW5lIHdpZHRoIG9mIHRoZSBvYnNlcnZhdGlvbiB3aW5kb3cgZnJhbWVcclxuY29uc3QgRlJBTUVfTElORV9XSURUSCA9IDU7XHJcblxyXG5jbGFzcyBNaWNyb1NjcmVlblZpZXcgZXh0ZW5kcyBTY3JlZW5WaWV3IHtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtQaG90b25BYnNvcnB0aW9uTW9kZWx9IHBob3RvbkFic29ycHRpb25Nb2RlbFxyXG4gICAqIEBwYXJhbSB7VGFuZGVtfSB0YW5kZW1cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggcGhvdG9uQWJzb3JwdGlvbk1vZGVsLCB0YW5kZW0gKSB7XHJcblxyXG4gICAgY29uc3QgbW9kZWxWaWV3VHJhbnNmb3JtID0gTW9kZWxWaWV3VHJhbnNmb3JtMi5jcmVhdGVTaW5nbGVQb2ludFNjYWxlSW52ZXJ0ZWRZTWFwcGluZyhcclxuICAgICAgVmVjdG9yMi5aRVJPLFxyXG4gICAgICBuZXcgVmVjdG9yMiggVXRpbHMucm91bmRTeW1tZXRyaWMoIElOVEVSTUVESUFURV9SRU5ERVJJTkdfU0laRS53aWR0aCAqIDAuNTUgKSxcclxuICAgICAgICBVdGlscy5yb3VuZFN5bW1ldHJpYyggSU5URVJNRURJQVRFX1JFTkRFUklOR19TSVpFLmhlaWdodCAqIDAuNTAgKSApLFxyXG4gICAgICAwLjEwICk7IC8vIFNjYWxlIGZhY3RvciAtIFNtYWxsZXIgbnVtYmVyIHpvb21zIG91dCwgYmlnZ2VyIG51bWJlciB6b29tcyBpbi5cclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIG9ic2VydmF0aW9uIHdpbmRvdy4gVGhpcyB3aWxsIGhvbGQgYWxsIHBob3RvbnMsIG1vbGVjdWxlcywgYW5kIHBob3RvbkVtaXR0ZXJzIGZvciB0aGlzIHBob3RvblxyXG4gICAgLy8gYWJzb3JwdGlvbiBtb2RlbC5cclxuICAgIGNvbnN0IG9ic2VydmF0aW9uV2luZG93ID0gbmV3IE1pY3JvT2JzZXJ2YXRpb25XaW5kb3coXHJcbiAgICAgIHBob3RvbkFic29ycHRpb25Nb2RlbCxcclxuICAgICAgbW9kZWxWaWV3VHJhbnNmb3JtLFxyXG4gICAgICB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnb2JzZXJ2YXRpb25XaW5kb3cnIClcclxuICAgICk7XHJcblxyXG4gICAgc3VwZXIoIHtcclxuICAgICAgbGF5b3V0Qm91bmRzOiBuZXcgQm91bmRzMiggMCwgMCwgNzY4LCA1MDQgKSxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0sXHJcbiAgICAgIHNjcmVlblN1bW1hcnlDb250ZW50OiBuZXcgTWljcm9TY3JlZW5TdW1tYXJ5Tm9kZSggcGhvdG9uQWJzb3JwdGlvbk1vZGVsLCBvYnNlcnZhdGlvbldpbmRvdy5yZXR1cm5Nb2xlY3VsZUJ1dHRvblZpc2libGVQcm9wZXJ0eSApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQHByaXZhdGVcclxuICAgIHRoaXMub2JzZXJ2YXRpb25XaW5kb3cgPSBvYnNlcnZhdGlvbldpbmRvdztcclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLm9ic2VydmF0aW9uV2luZG93ICk7XHJcblxyXG4gICAgLy8gVGhpcyByZWN0YW5nbGUgaGlkZXMgcGhvdG9ucyB0aGF0IGFyZSBvdXRzaWRlIHRoZSBvYnNlcnZhdGlvbiB3aW5kb3cuXHJcbiAgICAvLyBUT0RPOiBUaGlzIHJlY3RhbmdsZSBpcyBhIHRlbXBvcmFyeSB3b3JrYXJvdW5kIHRoYXQgcmVwbGFjZXMgdGhlIGNsaXBwaW5nIGFyZWEgaW4gTWljcm9PYnNlcnZhdGlvbldpbmRvdyBiZWNhdXNlIG9mIGFcclxuICAgIC8vIFNhZmFyaSBzcGVjaWZpYyBTVkcgYnVnIGNhdXNlZCBieSBjbGlwcGluZy4gIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvbW9sZWN1bGVzLWFuZC1saWdodC9pc3N1ZXMvMTA1IGFuZFxyXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3NjZW5lcnkvaXNzdWVzLzQxMi5cclxuICAgIGNvbnN0IGNsaXBSZWN0YW5nbGUgPSBuZXcgUmVjdGFuZ2xlKCB0aGlzLm9ic2VydmF0aW9uV2luZG93LmJvdW5kcy5jb3B5KCkuZGlsYXRlKCA0ICogRlJBTUVfTElORV9XSURUSCApLFxyXG4gICAgICBDT1JORVJfUkFESVVTLCBDT1JORVJfUkFESVVTLCB7XHJcbiAgICAgICAgc3Ryb2tlOiAnI0M1RDZFOCcsXHJcbiAgICAgICAgbGluZVdpZHRoOiA4ICogRlJBTUVfTElORV9XSURUSCxcclxuICAgICAgICBwaWNrYWJsZTogZmFsc2VcclxuICAgICAgfSApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggY2xpcFJlY3RhbmdsZSApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgd2luZG93IGZyYW1lIG5vZGUgdGhhdCBib3JkZXJzIHRoZSBvYnNlcnZhdGlvbiB3aW5kb3cuXHJcbiAgICBjb25zdCB3aW5kb3dGcmFtZU5vZGUgPSBuZXcgV2luZG93RnJhbWVOb2RlKCB0aGlzLm9ic2VydmF0aW9uV2luZG93LCAnI0JFRDBFNycsICcjNDA3MENFJyApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCggd2luZG93RnJhbWVOb2RlICk7XHJcblxyXG4gICAgLy8gU2V0IHBvc2l0aW9ucyBvZiB0aGUgb2JzZXJ2YXRpb24gd2luZG93IGFuZCB3aW5kb3cgZnJhbWUuXHJcbiAgICB0aGlzLm9ic2VydmF0aW9uV2luZG93LnRyYW5zbGF0ZSggT0JTRVJWQVRJT05fV0lORE9XX1BPU0lUSU9OICk7XHJcbiAgICBjbGlwUmVjdGFuZ2xlLnRyYW5zbGF0ZSggT0JTRVJWQVRJT05fV0lORE9XX1BPU0lUSU9OICk7XHJcbiAgICB3aW5kb3dGcmFtZU5vZGUudHJhbnNsYXRlKCBPQlNFUlZBVElPTl9XSU5ET1dfUE9TSVRJT04gKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIGNvbnRyb2wgcGFuZWwgZm9yIHBob3RvbiBlbWlzc2lvbiBmcmVxdWVuY3kuXHJcbiAgICBjb25zdCBwaG90b25FbWlzc2lvbkNvbnRyb2xQYW5lbCA9IG5ldyBRdWFkRW1pc3Npb25GcmVxdWVuY3lDb250cm9sUGFuZWwoXHJcbiAgICAgIHBob3RvbkFic29ycHRpb25Nb2RlbCxcclxuICAgICAgdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3Bob3RvbkVtaXNzaW9uQ29udHJvbFBhbmVsJyApXHJcbiAgICApO1xyXG4gICAgcGhvdG9uRW1pc3Npb25Db250cm9sUGFuZWwubGVmdFRvcCA9ICggbmV3IFZlY3RvcjIoIE9CU0VSVkFUSU9OX1dJTkRPV19QT1NJVElPTi54LCAzNTAgKSApO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgbW9sZWN1bGUgY29udHJvbCBwYW5lbFxyXG4gICAgY29uc3QgbW9sZWN1bGVDb250cm9sUGFuZWwgPSBuZXcgTW9sZWN1bGVTZWxlY3Rpb25QYW5lbChcclxuICAgICAgcGhvdG9uQWJzb3JwdGlvbk1vZGVsLFxyXG4gICAgICB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnbW9sZWN1bGVDb250cm9sUGFuZWwnIClcclxuICAgICk7XHJcbiAgICBtb2xlY3VsZUNvbnRyb2xQYW5lbC5sZWZ0VG9wID0gKCBuZXcgVmVjdG9yMiggNTMwLCB3aW5kb3dGcmFtZU5vZGUudG9wICkgKTtcclxuXHJcbiAgICAvLyBBZGQgcmVzZXQgYWxsIGJ1dHRvbi5cclxuICAgIGNvbnN0IHJlc2V0QWxsQnV0dG9uID0gbmV3IFJlc2V0QWxsQnV0dG9uKCB7XHJcbiAgICAgIGxpc3RlbmVyOiAoKSA9PiB7IHBob3RvbkFic29ycHRpb25Nb2RlbC5yZXNldCgpOyB9LFxyXG4gICAgICBib3R0b206IHRoaXMubGF5b3V0Qm91bmRzLmJvdHRvbSAtIDE1LFxyXG4gICAgICByaWdodDogdGhpcy5sYXlvdXRCb3VuZHMucmlnaHQgLSAxNSxcclxuICAgICAgcmFkaXVzOiAxOCxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAncmVzZXRBbGxCdXR0b24nIClcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHJlc2V0QWxsQnV0dG9uICk7XHJcblxyXG4gICAgY29uc3QgdGltZUNvbnRyb2xOb2RlID0gbmV3IFRpbWVDb250cm9sTm9kZSggcGhvdG9uQWJzb3JwdGlvbk1vZGVsLnJ1bm5pbmdQcm9wZXJ0eSwge1xyXG4gICAgICB0aW1lU3BlZWRQcm9wZXJ0eTogcGhvdG9uQWJzb3JwdGlvbk1vZGVsLnRpbWVTcGVlZFByb3BlcnR5LFxyXG4gICAgICBzcGVlZFJhZGlvQnV0dG9uR3JvdXBPbkxlZnQ6IHRydWUsXHJcbiAgICAgIHBsYXlQYXVzZVN0ZXBCdXR0b25PcHRpb25zOiB7XHJcblxyXG4gICAgICAgIC8vIHBkb21cclxuICAgICAgICBwbGF5aW5nRGVzY3JpcHRpb246IEdyZWVuaG91c2VFZmZlY3RTdHJpbmdzLmExMXkudGltZUNvbnRyb2xzLnBsYXlQYXVzZUJ1dHRvblBsYXlpbmdXaXRoU3BlZWREZXNjcmlwdGlvbixcclxuICAgICAgICBwYXVzZWREZXNjcmlwdGlvbjogR3JlZW5ob3VzZUVmZmVjdFN0cmluZ3MuYTExeS50aW1lQ29udHJvbHMucGxheVBhdXNlQnV0dG9uUGF1c2VkV2l0aFNwZWVkRGVzY3JpcHRpb24sXHJcblxyXG4gICAgICAgIHBsYXlQYXVzZUJ1dHRvbk9wdGlvbnM6IHtcclxuICAgICAgICAgIHJhZGl1czogMjNcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN0ZXBGb3J3YXJkQnV0dG9uT3B0aW9uczoge1xyXG4gICAgICAgICAgcmFkaXVzOiAxNSxcclxuXHJcbiAgICAgICAgICAvLyBhc3N1bWluZyA2MCBmcmFtZXMgcGVyIHNlY29uZFxyXG4gICAgICAgICAgbGlzdGVuZXI6ICgpID0+IHsgcGhvdG9uQWJzb3JwdGlvbk1vZGVsLm1hbnVhbFN0ZXAoIDEgLyA2MCApOyB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBzcGVlZFJhZGlvQnV0dG9uR3JvdXBPcHRpb25zOiB7XHJcbiAgICAgICAgbGFiZWxPcHRpb25zOiB7XHJcbiAgICAgICAgICBtYXhXaWR0aDogMTAwIC8vIGkxOG5cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGJ1dHRvbkdyb3VwWFNwYWNpbmc6IDI1LFxyXG5cclxuICAgICAgY2VudGVyQm90dG9tOiBtb2xlY3VsZUNvbnRyb2xQYW5lbC5jZW50ZXJCb3R0b20ucGx1c1hZKCAwLCA2NSApLFxyXG5cclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAndGltZUNvbnRyb2xOb2RlJyApXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aW1lQ29udHJvbE5vZGUgKTtcclxuXHJcbiAgICAvLyBDb250ZW50IGZvciB0aGUgd2luZG93IHRoYXQgZGlzcGxheXMgdGhlIEVNIHNwZWN0cnVtIHVwb24gcmVxdWVzdC4gIENvbnN0cnVjdGVkIG9uY2UgaGVyZSBzbyB0aGF0IHRpbWUgaXMgbm90XHJcbiAgICAvLyB3YWlzdGVkIGRyYXdpbmcgYSBuZXcgc3BlY3RydW0gd2luZG93IGV2ZXJ5IHRpbWUgdGhlIHVzZXIgcHJlc3NlcyB0aGUgJ1Nob3cgTGlnaHQgU3BlY3RydW0nIGJ1dHRvbi5cclxuICAgIC8vIEBwcml2YXRlXHJcbiAgICBjb25zdCBzcGVjdHJ1bUJ1dHRvbkxhYmVsVGV4dCA9IG5ldyBTcGVjdHJ1bURpYWdyYW0oIHRhbmRlbS5jcmVhdGVUYW5kZW0oICdzcGVjdHJ1bUJ1dHRvbkxhYmVsVGV4dCcgKSApO1xyXG5cclxuICAgIGNvbnN0IGxpZ2h0U3BlY3RydW1EaWFsb2dDYXBzdWxlID0gbmV3IFBoZXRpb0NhcHN1bGUoIHRhbmRlbSA9PiB7XHJcblxyXG4gICAgICAvLyBXcmFwIGluIGEgbm9kZSB0byBwcmV2ZW50IERBRyBwcm9ibGVtcyBpZiBhcmNoZXR5cGVzIGFyZSBhbHNvIGNyZWF0ZWRcclxuICAgICAgcmV0dXJuIG5ldyBMaWdodFNwZWN0cnVtRGlhbG9nKCBuZXcgTm9kZSggeyBjaGlsZHJlbjogWyBzcGVjdHJ1bUJ1dHRvbkxhYmVsVGV4dCBdIH0gKSwgdGFuZGVtICk7XHJcbiAgICB9LCBbXSwge1xyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdsaWdodFNwZWN0cnVtRGlhbG9nQ2Fwc3VsZScgKSxcclxuICAgICAgcGhldGlvVHlwZTogUGhldGlvQ2Fwc3VsZS5QaGV0aW9DYXBzdWxlSU8oIERpYWxvZy5EaWFsb2dJTyApXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBidXR0b24gZm9yIGRpc3BsYXlpbmcgdGhlIGVsZWN0cm9tYWduZXRpYyBzcGVjdHJ1bS4gU2NhbGUgZG93biB0aGUgYnV0dG9uIGNvbnRlbnQgd2hlbiBpdCBnZXRzIHRvb1xyXG4gICAgLy8gbGFyZ2UuICBUaGlzIGlzIGRvbmUgdG8gc3VwcG9ydCB0cmFuc2xhdGlvbnMuICBNYXggd2lkdGggb2YgdGhpcyBidXR0b24gaXMgdGhlIHdpZHRoIG9mIHRoZSBtb2xlY3VsZSBjb250cm9sXHJcbiAgICAvLyBwYW5lbCBtaW51cyB0d2ljZSB0aGUgZGVmYXVsdCB4IG1hcmdpbiBvZiBhIHJlY3Rhbmd1bGFyIHB1c2ggYnV0dG9uLlxyXG4gICAgY29uc3QgYnV0dG9uQ29udGVudCA9IG5ldyBUZXh0KCBzcGVjdHJ1bVdpbmRvd0J1dHRvbkNhcHRpb25TdHJpbmdQcm9wZXJ0eSwgeyBmb250OiBuZXcgUGhldEZvbnQoIDE4ICkgfSApO1xyXG4gICAgaWYgKCBidXR0b25Db250ZW50LndpZHRoID4gbW9sZWN1bGVDb250cm9sUGFuZWwud2lkdGggLSAxNiApIHtcclxuICAgICAgYnV0dG9uQ29udGVudC5zY2FsZSggKCBtb2xlY3VsZUNvbnRyb2xQYW5lbC53aWR0aCAtIDE2ICkgLyBidXR0b25Db250ZW50LndpZHRoICk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBzaG93TGlnaHRTcGVjdHJ1bUJ1dHRvbiA9IG5ldyBSZWN0YW5ndWxhclB1c2hCdXR0b24oIHtcclxuICAgICAgY29udGVudDogYnV0dG9uQ29udGVudCxcclxuICAgICAgYmFzZUNvbG9yOiAncmdiKDk4LCAxNzMsIDIwNSknLFxyXG4gICAgICB0b3VjaEFyZWFYRGlsYXRpb246IDcsXHJcbiAgICAgIHRvdWNoQXJlYVlEaWxhdGlvbjogNyxcclxuICAgICAgbGlzdGVuZXI6ICgpID0+IHtcclxuICAgICAgICBjb25zdCBkaWFsb2cgPSBsaWdodFNwZWN0cnVtRGlhbG9nQ2Fwc3VsZS5nZXRFbGVtZW50KCk7XHJcbiAgICAgICAgZGlhbG9nLnNob3coKTtcclxuICAgICAgfSxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnc2hvd0xpZ2h0U3BlY3RydW1CdXR0b24nICksXHJcblxyXG4gICAgICAvLyB0dXJuIG9mZiBkZWZhdWx0IHNvdW5kIGdlbmVyYXRpb24gc2luY2UgZGlhbG9nIG1ha2VzIGEgc291bmQgd2hlbiBpdCBvcGVuc1xyXG4gICAgICBzb3VuZFBsYXllcjogbnVsbFNvdW5kUGxheWVyLFxyXG5cclxuICAgICAgLy8gcGRvbVxyXG4gICAgICBpbm5lckNvbnRlbnQ6IHNwZWN0cnVtQnV0dG9uTGFiZWxTdHJpbmdQcm9wZXJ0eS52YWx1ZSxcclxuICAgICAgZGVzY3JpcHRpb25Db250ZW50OiBzcGVjdHJ1bUJ1dHRvbkRlc2NyaXB0aW9uU3RyaW5nUHJvcGVydHkudmFsdWUsXHJcbiAgICAgIGFwcGVuZERlc2NyaXB0aW9uOiB0cnVlLFxyXG4gICAgICBjb250YWluZXJUYWdOYW1lOiAnZGl2J1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHBkb20gLSBhZGQgYW4gYXR0cmlidXRlIHRoYXQgbGV0cyB0aGUgdXNlciBrbm93IHRoZSBidXR0b24gb3BlbnMgYSBtZW51XHJcbiAgICBBcmlhSGFzUG9wVXBNdXRhdG9yLm11dGF0ZU5vZGUoIHNob3dMaWdodFNwZWN0cnVtQnV0dG9uLCB0cnVlICk7XHJcblxyXG4gICAgc2hvd0xpZ2h0U3BlY3RydW1CdXR0b24uY2VudGVyVG9wID0gKCBuZXcgVmVjdG9yMiggbW9sZWN1bGVDb250cm9sUGFuZWwuY2VudGVyWCwgdGltZUNvbnRyb2xOb2RlLmJvdHRvbSArIDEzICkgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHNob3dMaWdodFNwZWN0cnVtQnV0dG9uICk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBub2RlcyBpbiB0aGUgb3JkZXIgbmVjZXNzYXJ5IGZvciBjb3JyZWN0IGxheWVyaW5nLlxyXG4gICAgdGhpcy5hZGRDaGlsZCggcGhvdG9uRW1pc3Npb25Db250cm9sUGFuZWwgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIG1vbGVjdWxlQ29udHJvbFBhbmVsICk7XHJcblxyXG4gICAgLy8gcGRvbSAtIHRoZSBhY2Nlc3NpYmxlIG9yZGVyIGZvciBjb250ZW50cyBpbiBlYWNoIFBET00gc2VjdGlvblxyXG4gICAgdGhpcy5wZG9tUGxheUFyZWFOb2RlLnBkb21PcmRlciA9IFsgdGhpcy5vYnNlcnZhdGlvbldpbmRvdywgcGhvdG9uRW1pc3Npb25Db250cm9sUGFuZWwsIG1vbGVjdWxlQ29udHJvbFBhbmVsIF07XHJcbiAgICB0aGlzLnBkb21Db250cm9sQXJlYU5vZGUucGRvbU9yZGVyID0gWyB0aW1lQ29udHJvbE5vZGUsIHNob3dMaWdodFNwZWN0cnVtQnV0dG9uLCByZXNldEFsbEJ1dHRvbiBdO1xyXG5cclxuICAgIC8vIEFsdGVybmF0aXZlIElucHV0IC0gbm8gbWF0dGVyIHdoZXJlIGZvY3VzIGlzIGluIHRoZSBkb2N1bWVudCwgcHJlc3NpbmcgQWx0K0wgd2lsbCBtYW51YWxseSBzdGVwIGZvcndhcmRcclxuICAgIC8vIGluIHRpbWVcclxuICAgIGNvbnN0IGtleWJvYXJkTGlzdGVuZXIgPSBuZXcgS2V5Ym9hcmRMaXN0ZW5lcigge1xyXG4gICAgICBrZXlzOiBbICdhbHQrbCcgXSxcclxuICAgICAgZ2xvYmFsOiB0cnVlLFxyXG4gICAgICBsaXN0ZW5lckZpcmVUcmlnZ2VyOiAndXAnLFxyXG4gICAgICBjYWxsYmFjazogKCBldmVudCwgbGlzdGVuZXIgKSA9PiB7XHJcbiAgICAgICAgaWYgKCAhcGhvdG9uQWJzb3JwdGlvbk1vZGVsLnJ1bm5pbmdQcm9wZXJ0eS5nZXQoKSApIHtcclxuXHJcbiAgICAgICAgICAvLyBUaGUgZ2xvYmFsIGhvdGtleSBzdGVwIGhhcyBhIGxhcmdlciB0aW1lIHN0ZXAgc28gdGhhdCBpdCBpcyBlYXNpZXIgZm9yIHRoZSBwaG90b24gdG8gcmVhY2ggdGhlIG1vbGVjdWxlXHJcbiAgICAgICAgICAvLyBhbmQgcHJvdmlkZSBmZWVkYmFjayBmb3IgYSBub24tdmlzdWFsIGV4cGVyaWVuY2UuIFRoZSB0aW1lU3RlcCBpcyBjYWxjdWxhdGVkIHNvIHRoYXQgYSBwaG90b24gY2FuIG5ldmVyXHJcbiAgICAgICAgICAvLyBtb3ZlIGZhcnRoZXIgdGhhbiB0aGUgYWJzb3JwdGlvbiB3aW5kb3cgb2YgYSBtb2xlY3VsZSBpbiBhIHNpbmdsZSBzdGVwIGFuZCBwYXNzIG92ZXIgdGhlIG1vbGVjdWxlIHdpdGhvdXRcclxuICAgICAgICAgIC8vIGNoZWNraW5nIGZvciBhYnNvcnB0aW9uLlxyXG4gICAgICAgICAgY29uc3QgdGltZVN0ZXAgPSAyICogTW9sZWN1bGUuUEhPVE9OX0FCU09SUFRJT05fRElTVEFOQ0UgLyBQaG90b25BYnNvcnB0aW9uTW9kZWwuUEhPVE9OX1ZFTE9DSVRZO1xyXG4gICAgICAgICAgcGhvdG9uQWJzb3JwdGlvbk1vZGVsLm1hbnVhbFN0ZXAoIHRpbWVTdGVwICk7XHJcblxyXG4gICAgICAgICAgc3RlcEZvcndhcmRTb3VuZFBsYXllci5wbGF5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcbiAgICB0aW1lQ29udHJvbE5vZGUuYWRkSW5wdXRMaXN0ZW5lcigga2V5Ym9hcmRMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIHRoZSBsaWdodCBzcGVjdHJ1bSBkaWFsb2cgYW5kIGVtaXNzaW9uIGZyZXF1ZW5jeSBjb250cm9sIHBhbmVsIGFyZSByZW1vdmVkIGluIHRoZVxyXG4gICAgLy8gT3BlbiBTY2kgRWQgdmVyc2lvblxyXG4gICAgaWYgKCBHcmVlbmhvdXNlRWZmZWN0UXVlcnlQYXJhbWV0ZXJzLm9wZW5TY2lFZCApIHtcclxuICAgICAgdGhpcy5yZW1vdmVDaGlsZCggc2hvd0xpZ2h0U3BlY3RydW1CdXR0b24gKTtcclxuICAgICAgdGhpcy5yZW1vdmVDaGlsZCggcGhvdG9uRW1pc3Npb25Db250cm9sUGFuZWwgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBzb3VuZCBnZW5lcmF0aW9uXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgLy8gYWRkIHRoZSBzb3VuZCBnZW5lcmF0b3IgdGhhdCB3aWxsIHByb2R1Y2Ugc291bmQgZm9yIHRoZSBtb2xlY3VsZSBhY3Rpb25zLCBzdWNoIGFzIHZpYnJhdGlvbiwgcm90YXRpb24sIGV0Yy5cclxuICAgIHNvdW5kTWFuYWdlci5hZGRTb3VuZEdlbmVyYXRvciggbmV3IE1vbGVjdWxlQWN0aW9uU291bmRHZW5lcmF0b3IoXHJcbiAgICAgIHBob3RvbkFic29ycHRpb25Nb2RlbC5hY3RpdmVNb2xlY3VsZXMsXHJcbiAgICAgIHBob3RvbkFic29ycHRpb25Nb2RlbC5ydW5uaW5nUHJvcGVydHksXHJcbiAgICAgIHBob3RvbkFic29ycHRpb25Nb2RlbC5zbG93TW90aW9uUHJvcGVydHlcclxuICAgICkgKTtcclxuXHJcbiAgICAvLyBhZGQgdGhlIHNvdW5kIGdlbmVyYXRvciB0aGF0IHdpbGwgcHJvZHVjZSB0aGUgc291bmRzIHdoZW4gcGhvdG9ucyBhcmUgZW1pdHRlZCBieSB0aGUgbGFtcHMgb3IgdGhlIGFjdGl2ZSBtb2xlY3VsZVxyXG4gICAgc291bmRNYW5hZ2VyLmFkZFNvdW5kR2VuZXJhdG9yKCBuZXcgUGhvdG9uRW1pc3Npb25Tb3VuZEdlbmVyYXRvciggcGhvdG9uQWJzb3JwdGlvbk1vZGVsLnBob3Rvbkdyb3VwICkgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZpZXcgc3RlcCwgY2FsbGVkIGJ5IGpvaXN0LlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkdFxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICBzdGVwKCBkdCApIHtcclxuICAgIHRoaXMub2JzZXJ2YXRpb25XaW5kb3cuc3RlcCggZHQgKTtcclxuICB9XHJcbn1cclxuXHJcbmdyZWVuaG91c2VFZmZlY3QucmVnaXN0ZXIoICdNaWNyb1NjcmVlblZpZXcnLCBNaWNyb1NjcmVlblZpZXcgKTtcclxuZXhwb3J0IGRlZmF1bHQgTWljcm9TY3JlZW5WaWV3O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtB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