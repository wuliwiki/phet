// Copyright 2021, University of Colorado Boulder

/**
 * Class that represents NO2 ( nitrogen dioxide ) in the model.
 *
 * @author John Blanco
 * @author Jesse Greenberg
 */

import dotRandom from '../../../../../dot/js/dotRandom.js';
import Vector2 from '../../../../../dot/js/Vector2.js';
import greenhouseEffect from '../../../greenhouseEffect.js';
import Atom from '../atoms/Atom.js';
import AtomicBond from '../atoms/AtomicBond.js';
import BreakApartStrategy from '../BreakApartStrategy.js';
import ExcitationStrategy from '../ExcitationStrategy.js';
import Molecule from '../Molecule.js';
import RotationStrategy from '../RotationStrategy.js';
import VibrationStrategy from '../VibrationStrategy.js';
import WavelengthConstants from '../WavelengthConstants.js';
import NO from './NO.js';
import O from './O.js';

// Model data for the NO2 molecule
// These constants define the initial shape of the NO2 atom.  The angle between the atoms is intended to be correct,
// and the bond is somewhat longer than real life.  The algebraic calculations are intended to make it so that the
// bond length and/or the angle could be changed and the correct center of gravity will be maintained.
const NITROGEN_OXYGEN_BOND_LENGTH = 180;
const INITIAL_OXYGEN_NITROGEN_OXYGEN_ANGLE = 120 * Math.PI / 180; // In radians.
const INITIAL_MOLECULE_HEIGHT = NITROGEN_OXYGEN_BOND_LENGTH * Math.cos(INITIAL_OXYGEN_NITROGEN_OXYGEN_ANGLE / 2);
const BREAK_APART_VELOCITY = 3000;

//Random boolean generator.  Used to control the side on which the delocalized bond is depicted.
const RAND = {
  nextBoolean: () => dotRandom.nextDouble() < 0.50
};
class NO2 extends Molecule {
  /**
   * Constructor for a nitrogen dioxide molecule.
   *
   * @param {Object} [options]
   */
  constructor(options) {
    // Supertype constructor
    super(options);

    // Instance Data
    // @private
    this.nitrogenAtom = Atom.nitrogen();
    this.rightOxygenAtom = Atom.oxygen();
    this.leftOxygenAtom = Atom.oxygen();
    this.totalMoleculeMass = this.nitrogenAtom.mass + 2 * this.rightOxygenAtom.mass;
    this.initialNitrogenVerticalOffset = INITIAL_MOLECULE_HEIGHT * (2 * this.rightOxygenAtom.mass / this.totalMoleculeMass);
    this.initialOxygenVerticalOffset = -(INITIAL_MOLECULE_HEIGHT - this.initialNitrogenVerticalOffset);
    this.initialOxygenHorizontalOffset = NITROGEN_OXYGEN_BOND_LENGTH * Math.sin(INITIAL_OXYGEN_NITROGEN_OXYGEN_ANGLE / 2);

    // Tracks the side on which the double bond is shown.  More on this where it is initialized.
    // @private
    this.doubleBondOnRight = RAND.nextBoolean();

    // Configure the base class.
    this.addAtom(this.nitrogenAtom);
    this.addAtom(this.rightOxygenAtom);
    this.addAtom(this.leftOxygenAtom);

    // Create the bond structure.  NO2 has a type of bond where each N-O has essentially 1.5 bonds, so we randomly
    // choose one side to show two bonds and another to show one.
    if (this.doubleBondOnRight) {
      this.addAtomicBond(new AtomicBond(this.nitrogenAtom, this.rightOxygenAtom, {
        bondCount: 2
      }));
      this.addAtomicBond(new AtomicBond(this.nitrogenAtom, this.leftOxygenAtom, {
        bondCount: 1
      }));
    } else {
      this.addAtomicBond(new AtomicBond(this.nitrogenAtom, this.rightOxygenAtom, {
        bondCount: 1
      }));
      this.addAtomicBond(new AtomicBond(this.nitrogenAtom, this.leftOxygenAtom, {
        bondCount: 2
      }));
    }

    // Set up the photon wavelengths to absorb.
    this.setPhotonAbsorptionStrategy(WavelengthConstants.MICRO_WAVELENGTH, new RotationStrategy(this));
    this.setPhotonAbsorptionStrategy(WavelengthConstants.IR_WAVELENGTH, new VibrationStrategy(this));
    this.setPhotonAbsorptionStrategy(WavelengthConstants.VISIBLE_WAVELENGTH, new ExcitationStrategy(this));
    this.setPhotonAbsorptionStrategy(WavelengthConstants.UV_WAVELENGTH, new BreakApartStrategy(this));

    // Set the initial offsets.
    this.initializeAtomOffsets();
  }

  /**
   * Initialize and set the COG positions for each atom in this molecule.  These are the atom positions when the
   * molecule is at rest (not rotating or vibrating).
   * @private
   */
  initializeAtomOffsets() {
    this.addInitialAtomCogOffset(this.nitrogenAtom, new Vector2(0, this.initialNitrogenVerticalOffset));
    this.addInitialAtomCogOffset(this.rightOxygenAtom, new Vector2(this.initialOxygenHorizontalOffset, this.initialOxygenVerticalOffset));
    this.addInitialAtomCogOffset(this.leftOxygenAtom, new Vector2(-this.initialOxygenHorizontalOffset, this.initialOxygenVerticalOffset));
    this.updateAtomPositions();
  }

  /**
   * Set the vibration behavior for this NO2 molecule.  Sets the NO2 molecule to a vibrating state then calculates
   * and sets the new position for each atom in the molecule.
   * @public
   *
   * @param {number} vibrationRadians - Where this molecule is in its vibration cycle in radians.
   */
  setVibration(vibrationRadians) {
    this.currentVibrationRadiansProperty.set(vibrationRadians);
    const multFactor = Math.sin(vibrationRadians);
    const maxNitrogenDisplacement = 30;
    const maxOxygenDisplacement = 15;
    this.addInitialAtomCogOffset(this.nitrogenAtom, new Vector2(0, this.initialNitrogenVerticalOffset - multFactor * maxNitrogenDisplacement));
    this.addInitialAtomCogOffset(this.rightOxygenAtom, new Vector2(this.initialOxygenHorizontalOffset + multFactor * maxOxygenDisplacement, this.initialOxygenVerticalOffset + multFactor * maxOxygenDisplacement));
    this.addInitialAtomCogOffset(this.leftOxygenAtom, new Vector2(-this.initialOxygenHorizontalOffset - multFactor * maxOxygenDisplacement, this.initialOxygenVerticalOffset + multFactor * maxOxygenDisplacement));
    this.updateAtomPositions();
  }

  /**
   * Define the break apart behavior for the NO2 molecule.  Initializes and sets the velocity of constituent
   * molecules.
   * @protected
   */
  breakApart() {
    // Create the constituent molecules that result from breaking apart and add them to the activeMolecules observable array.
    const nitrogenMonoxideMolecule = new NO();
    const singleOxygenMolecule = new O();
    this.brokeApartEmitter.emit(nitrogenMonoxideMolecule, singleOxygenMolecule);

    // Set up the direction and velocity of the constituent molecules. These are set up mostly to look good, and their
    // directions and velocities have little if anything to do with any physical rules of atomic dissociation.  If
    // the molecule happens to have been rotated before breaking apart, it is rotated back to the initial orientation
    // before dissociation.  This keeps things simple, and makes the products go off the top and bottom of the window
    // instead of potentially going back towards the photon source.  See issue #110.
    const diatomicMoleculeRotationAngle = Math.PI / 2 - INITIAL_OXYGEN_NITROGEN_OXYGEN_ANGLE / 2;
    let breakApartAngle;
    if (this.doubleBondOnRight) {
      nitrogenMonoxideMolecule.rotate(-diatomicMoleculeRotationAngle);
      nitrogenMonoxideMolecule.setCenterOfGravityPos((this.getInitialAtomCogOffset(this.nitrogenAtom).x + this.getInitialAtomCogOffset(this.rightOxygenAtom).x) / 2, (this.getInitialAtomCogOffset(this.nitrogenAtom).y + this.getInitialAtomCogOffset(this.rightOxygenAtom).y) / 2);
      breakApartAngle = Math.PI / 4 + dotRandom.nextDouble() * Math.PI / 4;
      singleOxygenMolecule.setCenterOfGravityPos(-this.initialOxygenHorizontalOffset, this.initialOxygenVerticalOffset);
    } else {
      nitrogenMonoxideMolecule.rotate(Math.PI + diatomicMoleculeRotationAngle);
      breakApartAngle = Math.PI / 2 + dotRandom.nextDouble() * Math.PI / 4;
      nitrogenMonoxideMolecule.setCenterOfGravityPos((this.getInitialAtomCogOffset(this.nitrogenAtom).x + this.getInitialAtomCogOffset(this.leftOxygenAtom).x) / 2, (this.getInitialAtomCogOffset(this.nitrogenAtom).y + this.getInitialAtomCogOffset(this.leftOxygenAtom).y) / 2);
      singleOxygenMolecule.setCenterOfGravityPos(this.initialOxygenHorizontalOffset, this.initialOxygenVerticalOffset);
    }
    nitrogenMonoxideMolecule.velocity.set(new Vector2(BREAK_APART_VELOCITY * 0.33 * Math.cos(breakApartAngle), BREAK_APART_VELOCITY * 0.33 * Math.sin(breakApartAngle)));
    singleOxygenMolecule.velocity.set(new Vector2(-BREAK_APART_VELOCITY * 0.67 * Math.cos(breakApartAngle), -BREAK_APART_VELOCITY * 0.67 * Math.sin(breakApartAngle)));
  }
}
greenhouseEffect.register('NO2', NO2);
export default NO2;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkb3RSYW5kb20iLCJWZWN0b3IyIiwiZ3JlZW5ob3VzZUVmZmVjdCIsIkF0b20iLCJBdG9taWNCb25kIiwiQnJlYWtBcGFydFN0cmF0ZWd5IiwiRXhjaXRhdGlvblN0cmF0ZWd5IiwiTW9sZWN1bGUiLCJSb3RhdGlvblN0cmF0ZWd5IiwiVmlicmF0aW9uU3RyYXRlZ3kiLCJXYXZlbGVuZ3RoQ29uc3RhbnRzIiwiTk8iLCJPIiwiTklUUk9HRU5fT1hZR0VOX0JPTkRfTEVOR1RIIiwiSU5JVElBTF9PWFlHRU5fTklUUk9HRU5fT1hZR0VOX0FOR0xFIiwiTWF0aCIsIlBJIiwiSU5JVElBTF9NT0xFQ1VMRV9IRUlHSFQiLCJjb3MiLCJCUkVBS19BUEFSVF9WRUxPQ0lUWSIsIlJBTkQiLCJuZXh0Qm9vbGVhbiIsIm5leHREb3VibGUiLCJOTzIiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJuaXRyb2dlbkF0b20iLCJuaXRyb2dlbiIsInJpZ2h0T3h5Z2VuQXRvbSIsIm94eWdlbiIsImxlZnRPeHlnZW5BdG9tIiwidG90YWxNb2xlY3VsZU1hc3MiLCJtYXNzIiwiaW5pdGlhbE5pdHJvZ2VuVmVydGljYWxPZmZzZXQiLCJpbml0aWFsT3h5Z2VuVmVydGljYWxPZmZzZXQiLCJpbml0aWFsT3h5Z2VuSG9yaXpvbnRhbE9mZnNldCIsInNpbiIsImRvdWJsZUJvbmRPblJpZ2h0IiwiYWRkQXRvbSIsImFkZEF0b21pY0JvbmQiLCJib25kQ291bnQiLCJzZXRQaG90b25BYnNvcnB0aW9uU3RyYXRlZ3kiLCJNSUNST19XQVZFTEVOR1RIIiwiSVJfV0FWRUxFTkdUSCIsIlZJU0lCTEVfV0FWRUxFTkdUSCIsIlVWX1dBVkVMRU5HVEgiLCJpbml0aWFsaXplQXRvbU9mZnNldHMiLCJhZGRJbml0aWFsQXRvbUNvZ09mZnNldCIsInVwZGF0ZUF0b21Qb3NpdGlvbnMiLCJzZXRWaWJyYXRpb24iLCJ2aWJyYXRpb25SYWRpYW5zIiwiY3VycmVudFZpYnJhdGlvblJhZGlhbnNQcm9wZXJ0eSIsInNldCIsIm11bHRGYWN0b3IiLCJtYXhOaXRyb2dlbkRpc3BsYWNlbWVudCIsIm1heE94eWdlbkRpc3BsYWNlbWVudCIsImJyZWFrQXBhcnQiLCJuaXRyb2dlbk1vbm94aWRlTW9sZWN1bGUiLCJzaW5nbGVPeHlnZW5Nb2xlY3VsZSIsImJyb2tlQXBhcnRFbWl0dGVyIiwiZW1pdCIsImRpYXRvbWljTW9sZWN1bGVSb3RhdGlvbkFuZ2xlIiwiYnJlYWtBcGFydEFuZ2xlIiwicm90YXRlIiwic2V0Q2VudGVyT2ZHcmF2aXR5UG9zIiwiZ2V0SW5pdGlhbEF0b21Db2dPZmZzZXQiLCJ4IiwieSIsInZlbG9jaXR5IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJOTzIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjEsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIENsYXNzIHRoYXQgcmVwcmVzZW50cyBOTzIgKCBuaXRyb2dlbiBkaW94aWRlICkgaW4gdGhlIG1vZGVsLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnXHJcbiAqL1xyXG5cclxuaW1wb3J0IGRvdFJhbmRvbSBmcm9tICcuLi8uLi8uLi8uLi8uLi9kb3QvanMvZG90UmFuZG9tLmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgZ3JlZW5ob3VzZUVmZmVjdCBmcm9tICcuLi8uLi8uLi9ncmVlbmhvdXNlRWZmZWN0LmpzJztcclxuaW1wb3J0IEF0b20gZnJvbSAnLi4vYXRvbXMvQXRvbS5qcyc7XHJcbmltcG9ydCBBdG9taWNCb25kIGZyb20gJy4uL2F0b21zL0F0b21pY0JvbmQuanMnO1xyXG5pbXBvcnQgQnJlYWtBcGFydFN0cmF0ZWd5IGZyb20gJy4uL0JyZWFrQXBhcnRTdHJhdGVneS5qcyc7XHJcbmltcG9ydCBFeGNpdGF0aW9uU3RyYXRlZ3kgZnJvbSAnLi4vRXhjaXRhdGlvblN0cmF0ZWd5LmpzJztcclxuaW1wb3J0IE1vbGVjdWxlIGZyb20gJy4uL01vbGVjdWxlLmpzJztcclxuaW1wb3J0IFJvdGF0aW9uU3RyYXRlZ3kgZnJvbSAnLi4vUm90YXRpb25TdHJhdGVneS5qcyc7XHJcbmltcG9ydCBWaWJyYXRpb25TdHJhdGVneSBmcm9tICcuLi9WaWJyYXRpb25TdHJhdGVneS5qcyc7XHJcbmltcG9ydCBXYXZlbGVuZ3RoQ29uc3RhbnRzIGZyb20gJy4uL1dhdmVsZW5ndGhDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgTk8gZnJvbSAnLi9OTy5qcyc7XHJcbmltcG9ydCBPIGZyb20gJy4vTy5qcyc7XHJcblxyXG4vLyBNb2RlbCBkYXRhIGZvciB0aGUgTk8yIG1vbGVjdWxlXHJcbi8vIFRoZXNlIGNvbnN0YW50cyBkZWZpbmUgdGhlIGluaXRpYWwgc2hhcGUgb2YgdGhlIE5PMiBhdG9tLiAgVGhlIGFuZ2xlIGJldHdlZW4gdGhlIGF0b21zIGlzIGludGVuZGVkIHRvIGJlIGNvcnJlY3QsXHJcbi8vIGFuZCB0aGUgYm9uZCBpcyBzb21ld2hhdCBsb25nZXIgdGhhbiByZWFsIGxpZmUuICBUaGUgYWxnZWJyYWljIGNhbGN1bGF0aW9ucyBhcmUgaW50ZW5kZWQgdG8gbWFrZSBpdCBzbyB0aGF0IHRoZVxyXG4vLyBib25kIGxlbmd0aCBhbmQvb3IgdGhlIGFuZ2xlIGNvdWxkIGJlIGNoYW5nZWQgYW5kIHRoZSBjb3JyZWN0IGNlbnRlciBvZiBncmF2aXR5IHdpbGwgYmUgbWFpbnRhaW5lZC5cclxuY29uc3QgTklUUk9HRU5fT1hZR0VOX0JPTkRfTEVOR1RIID0gMTgwO1xyXG5jb25zdCBJTklUSUFMX09YWUdFTl9OSVRST0dFTl9PWFlHRU5fQU5HTEUgPSAxMjAgKiBNYXRoLlBJIC8gMTgwOyAvLyBJbiByYWRpYW5zLlxyXG5jb25zdCBJTklUSUFMX01PTEVDVUxFX0hFSUdIVCA9IE5JVFJPR0VOX09YWUdFTl9CT05EX0xFTkdUSCAqIE1hdGguY29zKCBJTklUSUFMX09YWUdFTl9OSVRST0dFTl9PWFlHRU5fQU5HTEUgLyAyICk7XHJcbmNvbnN0IEJSRUFLX0FQQVJUX1ZFTE9DSVRZID0gMzAwMDtcclxuXHJcbi8vUmFuZG9tIGJvb2xlYW4gZ2VuZXJhdG9yLiAgVXNlZCB0byBjb250cm9sIHRoZSBzaWRlIG9uIHdoaWNoIHRoZSBkZWxvY2FsaXplZCBib25kIGlzIGRlcGljdGVkLlxyXG5jb25zdCBSQU5EID0ge1xyXG4gIG5leHRCb29sZWFuOiAoKSA9PiBkb3RSYW5kb20ubmV4dERvdWJsZSgpIDwgMC41MFxyXG59O1xyXG5cclxuY2xhc3MgTk8yIGV4dGVuZHMgTW9sZWN1bGUge1xyXG4gIC8qKlxyXG4gICAqIENvbnN0cnVjdG9yIGZvciBhIG5pdHJvZ2VuIGRpb3hpZGUgbW9sZWN1bGUuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIG9wdGlvbnMgKSB7XHJcblxyXG4gICAgLy8gU3VwZXJ0eXBlIGNvbnN0cnVjdG9yXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIEluc3RhbmNlIERhdGFcclxuICAgIC8vIEBwcml2YXRlXHJcbiAgICB0aGlzLm5pdHJvZ2VuQXRvbSA9IEF0b20ubml0cm9nZW4oKTtcclxuICAgIHRoaXMucmlnaHRPeHlnZW5BdG9tID0gQXRvbS5veHlnZW4oKTtcclxuICAgIHRoaXMubGVmdE94eWdlbkF0b20gPSBBdG9tLm94eWdlbigpO1xyXG4gICAgdGhpcy50b3RhbE1vbGVjdWxlTWFzcyA9IHRoaXMubml0cm9nZW5BdG9tLm1hc3MgKyAoIDIgKiB0aGlzLnJpZ2h0T3h5Z2VuQXRvbS5tYXNzICk7XHJcbiAgICB0aGlzLmluaXRpYWxOaXRyb2dlblZlcnRpY2FsT2Zmc2V0ID0gSU5JVElBTF9NT0xFQ1VMRV9IRUlHSFQgKiAoICggMiAqIHRoaXMucmlnaHRPeHlnZW5BdG9tLm1hc3MgKSAvIHRoaXMudG90YWxNb2xlY3VsZU1hc3MgKTtcclxuICAgIHRoaXMuaW5pdGlhbE94eWdlblZlcnRpY2FsT2Zmc2V0ID0gLSggSU5JVElBTF9NT0xFQ1VMRV9IRUlHSFQgLSB0aGlzLmluaXRpYWxOaXRyb2dlblZlcnRpY2FsT2Zmc2V0ICk7XHJcbiAgICB0aGlzLmluaXRpYWxPeHlnZW5Ib3Jpem9udGFsT2Zmc2V0ID0gTklUUk9HRU5fT1hZR0VOX0JPTkRfTEVOR1RIICogTWF0aC5zaW4oIElOSVRJQUxfT1hZR0VOX05JVFJPR0VOX09YWUdFTl9BTkdMRSAvIDIgKTtcclxuXHJcbiAgICAvLyBUcmFja3MgdGhlIHNpZGUgb24gd2hpY2ggdGhlIGRvdWJsZSBib25kIGlzIHNob3duLiAgTW9yZSBvbiB0aGlzIHdoZXJlIGl0IGlzIGluaXRpYWxpemVkLlxyXG4gICAgLy8gQHByaXZhdGVcclxuICAgIHRoaXMuZG91YmxlQm9uZE9uUmlnaHQgPSBSQU5ELm5leHRCb29sZWFuKCk7XHJcblxyXG4gICAgLy8gQ29uZmlndXJlIHRoZSBiYXNlIGNsYXNzLlxyXG4gICAgdGhpcy5hZGRBdG9tKCB0aGlzLm5pdHJvZ2VuQXRvbSApO1xyXG4gICAgdGhpcy5hZGRBdG9tKCB0aGlzLnJpZ2h0T3h5Z2VuQXRvbSApO1xyXG4gICAgdGhpcy5hZGRBdG9tKCB0aGlzLmxlZnRPeHlnZW5BdG9tICk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRoZSBib25kIHN0cnVjdHVyZS4gIE5PMiBoYXMgYSB0eXBlIG9mIGJvbmQgd2hlcmUgZWFjaCBOLU8gaGFzIGVzc2VudGlhbGx5IDEuNSBib25kcywgc28gd2UgcmFuZG9tbHlcclxuICAgIC8vIGNob29zZSBvbmUgc2lkZSB0byBzaG93IHR3byBib25kcyBhbmQgYW5vdGhlciB0byBzaG93IG9uZS5cclxuICAgIGlmICggdGhpcy5kb3VibGVCb25kT25SaWdodCApIHtcclxuICAgICAgdGhpcy5hZGRBdG9taWNCb25kKCBuZXcgQXRvbWljQm9uZCggdGhpcy5uaXRyb2dlbkF0b20sIHRoaXMucmlnaHRPeHlnZW5BdG9tLCB7IGJvbmRDb3VudDogMiB9ICkgKTtcclxuICAgICAgdGhpcy5hZGRBdG9taWNCb25kKCBuZXcgQXRvbWljQm9uZCggdGhpcy5uaXRyb2dlbkF0b20sIHRoaXMubGVmdE94eWdlbkF0b20sIHsgYm9uZENvdW50OiAxIH0gKSApO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRoaXMuYWRkQXRvbWljQm9uZCggbmV3IEF0b21pY0JvbmQoIHRoaXMubml0cm9nZW5BdG9tLCB0aGlzLnJpZ2h0T3h5Z2VuQXRvbSwgeyBib25kQ291bnQ6IDEgfSApICk7XHJcbiAgICAgIHRoaXMuYWRkQXRvbWljQm9uZCggbmV3IEF0b21pY0JvbmQoIHRoaXMubml0cm9nZW5BdG9tLCB0aGlzLmxlZnRPeHlnZW5BdG9tLCB7IGJvbmRDb3VudDogMiB9ICkgKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gU2V0IHVwIHRoZSBwaG90b24gd2F2ZWxlbmd0aHMgdG8gYWJzb3JiLlxyXG4gICAgdGhpcy5zZXRQaG90b25BYnNvcnB0aW9uU3RyYXRlZ3koIFdhdmVsZW5ndGhDb25zdGFudHMuTUlDUk9fV0FWRUxFTkdUSCwgbmV3IFJvdGF0aW9uU3RyYXRlZ3koIHRoaXMgKSApO1xyXG4gICAgdGhpcy5zZXRQaG90b25BYnNvcnB0aW9uU3RyYXRlZ3koIFdhdmVsZW5ndGhDb25zdGFudHMuSVJfV0FWRUxFTkdUSCwgbmV3IFZpYnJhdGlvblN0cmF0ZWd5KCB0aGlzICkgKTtcclxuICAgIHRoaXMuc2V0UGhvdG9uQWJzb3JwdGlvblN0cmF0ZWd5KCBXYXZlbGVuZ3RoQ29uc3RhbnRzLlZJU0lCTEVfV0FWRUxFTkdUSCwgbmV3IEV4Y2l0YXRpb25TdHJhdGVneSggdGhpcyApICk7XHJcbiAgICB0aGlzLnNldFBob3RvbkFic29ycHRpb25TdHJhdGVneSggV2F2ZWxlbmd0aENvbnN0YW50cy5VVl9XQVZFTEVOR1RILCBuZXcgQnJlYWtBcGFydFN0cmF0ZWd5KCB0aGlzICkgKTtcclxuXHJcbiAgICAvLyBTZXQgdGhlIGluaXRpYWwgb2Zmc2V0cy5cclxuICAgIHRoaXMuaW5pdGlhbGl6ZUF0b21PZmZzZXRzKCk7XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemUgYW5kIHNldCB0aGUgQ09HIHBvc2l0aW9ucyBmb3IgZWFjaCBhdG9tIGluIHRoaXMgbW9sZWN1bGUuICBUaGVzZSBhcmUgdGhlIGF0b20gcG9zaXRpb25zIHdoZW4gdGhlXHJcbiAgICogbW9sZWN1bGUgaXMgYXQgcmVzdCAobm90IHJvdGF0aW5nIG9yIHZpYnJhdGluZykuXHJcbiAgICogQHByaXZhdGVcclxuICAgKi9cclxuICBpbml0aWFsaXplQXRvbU9mZnNldHMoKSB7XHJcblxyXG4gICAgdGhpcy5hZGRJbml0aWFsQXRvbUNvZ09mZnNldCggdGhpcy5uaXRyb2dlbkF0b20sIG5ldyBWZWN0b3IyKCAwLCB0aGlzLmluaXRpYWxOaXRyb2dlblZlcnRpY2FsT2Zmc2V0ICkgKTtcclxuICAgIHRoaXMuYWRkSW5pdGlhbEF0b21Db2dPZmZzZXQoIHRoaXMucmlnaHRPeHlnZW5BdG9tLCBuZXcgVmVjdG9yMiggdGhpcy5pbml0aWFsT3h5Z2VuSG9yaXpvbnRhbE9mZnNldCwgdGhpcy5pbml0aWFsT3h5Z2VuVmVydGljYWxPZmZzZXQgKSApO1xyXG4gICAgdGhpcy5hZGRJbml0aWFsQXRvbUNvZ09mZnNldCggdGhpcy5sZWZ0T3h5Z2VuQXRvbSwgbmV3IFZlY3RvcjIoIC10aGlzLmluaXRpYWxPeHlnZW5Ib3Jpem9udGFsT2Zmc2V0LCB0aGlzLmluaXRpYWxPeHlnZW5WZXJ0aWNhbE9mZnNldCApICk7XHJcblxyXG4gICAgdGhpcy51cGRhdGVBdG9tUG9zaXRpb25zKCk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHRoZSB2aWJyYXRpb24gYmVoYXZpb3IgZm9yIHRoaXMgTk8yIG1vbGVjdWxlLiAgU2V0cyB0aGUgTk8yIG1vbGVjdWxlIHRvIGEgdmlicmF0aW5nIHN0YXRlIHRoZW4gY2FsY3VsYXRlc1xyXG4gICAqIGFuZCBzZXRzIHRoZSBuZXcgcG9zaXRpb24gZm9yIGVhY2ggYXRvbSBpbiB0aGUgbW9sZWN1bGUuXHJcbiAgICogQHB1YmxpY1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHZpYnJhdGlvblJhZGlhbnMgLSBXaGVyZSB0aGlzIG1vbGVjdWxlIGlzIGluIGl0cyB2aWJyYXRpb24gY3ljbGUgaW4gcmFkaWFucy5cclxuICAgKi9cclxuICBzZXRWaWJyYXRpb24oIHZpYnJhdGlvblJhZGlhbnMgKSB7XHJcblxyXG4gICAgdGhpcy5jdXJyZW50VmlicmF0aW9uUmFkaWFuc1Byb3BlcnR5LnNldCggdmlicmF0aW9uUmFkaWFucyApO1xyXG4gICAgY29uc3QgbXVsdEZhY3RvciA9IE1hdGguc2luKCB2aWJyYXRpb25SYWRpYW5zICk7XHJcbiAgICBjb25zdCBtYXhOaXRyb2dlbkRpc3BsYWNlbWVudCA9IDMwO1xyXG4gICAgY29uc3QgbWF4T3h5Z2VuRGlzcGxhY2VtZW50ID0gMTU7XHJcbiAgICB0aGlzLmFkZEluaXRpYWxBdG9tQ29nT2Zmc2V0KCB0aGlzLm5pdHJvZ2VuQXRvbSwgbmV3IFZlY3RvcjIoIDAsIHRoaXMuaW5pdGlhbE5pdHJvZ2VuVmVydGljYWxPZmZzZXQgLSBtdWx0RmFjdG9yICogbWF4Tml0cm9nZW5EaXNwbGFjZW1lbnQgKSApO1xyXG4gICAgdGhpcy5hZGRJbml0aWFsQXRvbUNvZ09mZnNldCggdGhpcy5yaWdodE94eWdlbkF0b20sIG5ldyBWZWN0b3IyKCB0aGlzLmluaXRpYWxPeHlnZW5Ib3Jpem9udGFsT2Zmc2V0ICsgbXVsdEZhY3RvciAqIG1heE94eWdlbkRpc3BsYWNlbWVudCxcclxuICAgICAgdGhpcy5pbml0aWFsT3h5Z2VuVmVydGljYWxPZmZzZXQgKyBtdWx0RmFjdG9yICogbWF4T3h5Z2VuRGlzcGxhY2VtZW50ICkgKTtcclxuICAgIHRoaXMuYWRkSW5pdGlhbEF0b21Db2dPZmZzZXQoIHRoaXMubGVmdE94eWdlbkF0b20sIG5ldyBWZWN0b3IyKCAtdGhpcy5pbml0aWFsT3h5Z2VuSG9yaXpvbnRhbE9mZnNldCAtIG11bHRGYWN0b3IgKiBtYXhPeHlnZW5EaXNwbGFjZW1lbnQsXHJcbiAgICAgIHRoaXMuaW5pdGlhbE94eWdlblZlcnRpY2FsT2Zmc2V0ICsgbXVsdEZhY3RvciAqIG1heE94eWdlbkRpc3BsYWNlbWVudCApICk7XHJcbiAgICB0aGlzLnVwZGF0ZUF0b21Qb3NpdGlvbnMoKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZWZpbmUgdGhlIGJyZWFrIGFwYXJ0IGJlaGF2aW9yIGZvciB0aGUgTk8yIG1vbGVjdWxlLiAgSW5pdGlhbGl6ZXMgYW5kIHNldHMgdGhlIHZlbG9jaXR5IG9mIGNvbnN0aXR1ZW50XHJcbiAgICogbW9sZWN1bGVzLlxyXG4gICAqIEBwcm90ZWN0ZWRcclxuICAgKi9cclxuICBicmVha0FwYXJ0KCkge1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgY29uc3RpdHVlbnQgbW9sZWN1bGVzIHRoYXQgcmVzdWx0IGZyb20gYnJlYWtpbmcgYXBhcnQgYW5kIGFkZCB0aGVtIHRvIHRoZSBhY3RpdmVNb2xlY3VsZXMgb2JzZXJ2YWJsZSBhcnJheS5cclxuICAgIGNvbnN0IG5pdHJvZ2VuTW9ub3hpZGVNb2xlY3VsZSA9IG5ldyBOTygpO1xyXG4gICAgY29uc3Qgc2luZ2xlT3h5Z2VuTW9sZWN1bGUgPSBuZXcgTygpO1xyXG4gICAgdGhpcy5icm9rZUFwYXJ0RW1pdHRlci5lbWl0KCBuaXRyb2dlbk1vbm94aWRlTW9sZWN1bGUsIHNpbmdsZU94eWdlbk1vbGVjdWxlICk7XHJcblxyXG4gICAgLy8gU2V0IHVwIHRoZSBkaXJlY3Rpb24gYW5kIHZlbG9jaXR5IG9mIHRoZSBjb25zdGl0dWVudCBtb2xlY3VsZXMuIFRoZXNlIGFyZSBzZXQgdXAgbW9zdGx5IHRvIGxvb2sgZ29vZCwgYW5kIHRoZWlyXHJcbiAgICAvLyBkaXJlY3Rpb25zIGFuZCB2ZWxvY2l0aWVzIGhhdmUgbGl0dGxlIGlmIGFueXRoaW5nIHRvIGRvIHdpdGggYW55IHBoeXNpY2FsIHJ1bGVzIG9mIGF0b21pYyBkaXNzb2NpYXRpb24uICBJZlxyXG4gICAgLy8gdGhlIG1vbGVjdWxlIGhhcHBlbnMgdG8gaGF2ZSBiZWVuIHJvdGF0ZWQgYmVmb3JlIGJyZWFraW5nIGFwYXJ0LCBpdCBpcyByb3RhdGVkIGJhY2sgdG8gdGhlIGluaXRpYWwgb3JpZW50YXRpb25cclxuICAgIC8vIGJlZm9yZSBkaXNzb2NpYXRpb24uICBUaGlzIGtlZXBzIHRoaW5ncyBzaW1wbGUsIGFuZCBtYWtlcyB0aGUgcHJvZHVjdHMgZ28gb2ZmIHRoZSB0b3AgYW5kIGJvdHRvbSBvZiB0aGUgd2luZG93XHJcbiAgICAvLyBpbnN0ZWFkIG9mIHBvdGVudGlhbGx5IGdvaW5nIGJhY2sgdG93YXJkcyB0aGUgcGhvdG9uIHNvdXJjZS4gIFNlZSBpc3N1ZSAjMTEwLlxyXG4gICAgY29uc3QgZGlhdG9taWNNb2xlY3VsZVJvdGF0aW9uQW5nbGUgPSAoICggTWF0aC5QSSAvIDIgKSAtICggSU5JVElBTF9PWFlHRU5fTklUUk9HRU5fT1hZR0VOX0FOR0xFIC8gMiApICk7XHJcbiAgICBsZXQgYnJlYWtBcGFydEFuZ2xlO1xyXG4gICAgaWYgKCB0aGlzLmRvdWJsZUJvbmRPblJpZ2h0ICkge1xyXG4gICAgICBuaXRyb2dlbk1vbm94aWRlTW9sZWN1bGUucm90YXRlKCAtZGlhdG9taWNNb2xlY3VsZVJvdGF0aW9uQW5nbGUgKTtcclxuICAgICAgbml0cm9nZW5Nb25veGlkZU1vbGVjdWxlLnNldENlbnRlck9mR3Jhdml0eVBvcyggKCB0aGlzLmdldEluaXRpYWxBdG9tQ29nT2Zmc2V0KCB0aGlzLm5pdHJvZ2VuQXRvbSApLnggKyB0aGlzLmdldEluaXRpYWxBdG9tQ29nT2Zmc2V0KCB0aGlzLnJpZ2h0T3h5Z2VuQXRvbSApLnggKSAvIDIsXHJcbiAgICAgICAgKCB0aGlzLmdldEluaXRpYWxBdG9tQ29nT2Zmc2V0KCB0aGlzLm5pdHJvZ2VuQXRvbSApLnkgKyB0aGlzLmdldEluaXRpYWxBdG9tQ29nT2Zmc2V0KCB0aGlzLnJpZ2h0T3h5Z2VuQXRvbSApLnkgKSAvIDIgKTtcclxuICAgICAgYnJlYWtBcGFydEFuZ2xlID0gTWF0aC5QSSAvIDQgKyBkb3RSYW5kb20ubmV4dERvdWJsZSgpICogTWF0aC5QSSAvIDQ7XHJcbiAgICAgIHNpbmdsZU94eWdlbk1vbGVjdWxlLnNldENlbnRlck9mR3Jhdml0eVBvcyggLXRoaXMuaW5pdGlhbE94eWdlbkhvcml6b250YWxPZmZzZXQsIHRoaXMuaW5pdGlhbE94eWdlblZlcnRpY2FsT2Zmc2V0ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgbml0cm9nZW5Nb25veGlkZU1vbGVjdWxlLnJvdGF0ZSggTWF0aC5QSSArIGRpYXRvbWljTW9sZWN1bGVSb3RhdGlvbkFuZ2xlICk7XHJcbiAgICAgIGJyZWFrQXBhcnRBbmdsZSA9IE1hdGguUEkgLyAyICsgZG90UmFuZG9tLm5leHREb3VibGUoKSAqIE1hdGguUEkgLyA0O1xyXG4gICAgICBuaXRyb2dlbk1vbm94aWRlTW9sZWN1bGUuc2V0Q2VudGVyT2ZHcmF2aXR5UG9zKCAoIHRoaXMuZ2V0SW5pdGlhbEF0b21Db2dPZmZzZXQoIHRoaXMubml0cm9nZW5BdG9tICkueCArIHRoaXMuZ2V0SW5pdGlhbEF0b21Db2dPZmZzZXQoIHRoaXMubGVmdE94eWdlbkF0b20gKS54ICkgLyAyLFxyXG4gICAgICAgICggdGhpcy5nZXRJbml0aWFsQXRvbUNvZ09mZnNldCggdGhpcy5uaXRyb2dlbkF0b20gKS55ICsgdGhpcy5nZXRJbml0aWFsQXRvbUNvZ09mZnNldCggdGhpcy5sZWZ0T3h5Z2VuQXRvbSApLnkgKSAvIDIgKTtcclxuICAgICAgc2luZ2xlT3h5Z2VuTW9sZWN1bGUuc2V0Q2VudGVyT2ZHcmF2aXR5UG9zKCB0aGlzLmluaXRpYWxPeHlnZW5Ib3Jpem9udGFsT2Zmc2V0LCB0aGlzLmluaXRpYWxPeHlnZW5WZXJ0aWNhbE9mZnNldCApO1xyXG4gICAgfVxyXG4gICAgbml0cm9nZW5Nb25veGlkZU1vbGVjdWxlLnZlbG9jaXR5LnNldCggbmV3IFZlY3RvcjIoIEJSRUFLX0FQQVJUX1ZFTE9DSVRZICogMC4zMyAqIE1hdGguY29zKCBicmVha0FwYXJ0QW5nbGUgKSwgQlJFQUtfQVBBUlRfVkVMT0NJVFkgKiAwLjMzICogTWF0aC5zaW4oIGJyZWFrQXBhcnRBbmdsZSApICkgKTtcclxuICAgIHNpbmdsZU94eWdlbk1vbGVjdWxlLnZlbG9jaXR5LnNldCggbmV3IFZlY3RvcjIoIC1CUkVBS19BUEFSVF9WRUxPQ0lUWSAqIDAuNjcgKiBNYXRoLmNvcyggYnJlYWtBcGFydEFuZ2xlICksIC1CUkVBS19BUEFSVF9WRUxPQ0lUWSAqIDAuNjcgKiBNYXRoLnNpbiggYnJlYWtBcGFydEFuZ2xlICkgKSApO1xyXG4gIH1cclxufVxyXG5cclxuZ3JlZW5ob3VzZUVmZmVjdC5yZWdpc3RlciggJ05PMicsIE5PMiApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTk8yOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLFNBQVMsTUFBTSxvQ0FBb0M7QUFDMUQsT0FBT0MsT0FBTyxNQUFNLGtDQUFrQztBQUN0RCxPQUFPQyxnQkFBZ0IsTUFBTSw4QkFBOEI7QUFDM0QsT0FBT0MsSUFBSSxNQUFNLGtCQUFrQjtBQUNuQyxPQUFPQyxVQUFVLE1BQU0sd0JBQXdCO0FBQy9DLE9BQU9DLGtCQUFrQixNQUFNLDBCQUEwQjtBQUN6RCxPQUFPQyxrQkFBa0IsTUFBTSwwQkFBMEI7QUFDekQsT0FBT0MsUUFBUSxNQUFNLGdCQUFnQjtBQUNyQyxPQUFPQyxnQkFBZ0IsTUFBTSx3QkFBd0I7QUFDckQsT0FBT0MsaUJBQWlCLE1BQU0seUJBQXlCO0FBQ3ZELE9BQU9DLG1CQUFtQixNQUFNLDJCQUEyQjtBQUMzRCxPQUFPQyxFQUFFLE1BQU0sU0FBUztBQUN4QixPQUFPQyxDQUFDLE1BQU0sUUFBUTs7QUFFdEI7QUFDQTtB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