// Copyright 2020-2022, University of Colorado Boulder

/**
 * @author John Blanco
 */

import greenhouseEffect from '../../greenhouseEffect.js';
import NumberProperty from '../../../../axon/js/NumberProperty.js';
import Range from '../../../../dot/js/Range.js';
import LayersModel from '../../common/model/LayersModel.js';
import PhotonCollection from '../../common/model/PhotonCollection.js';

// constants
const INITIAL_ABSORPTION_PROPORTION = 1.0;
const IR_ABSORBANCE_RANGE = new Range(0.1, 1);

// This value, which is in Kelvin, is the minimum value that the ground is allowed to get to.  It was calculated by
// using 50% sun and 0.9 albedo, since these are the values that are allowed in the UI design that would lead to the
// lowest temperature.  This value was calculated, and then some margin was added.
const MINIMUM_GROUND_TEMPERATURE = 125;

/**
 * @constructor
 */
class LayerModelModel extends LayersModel {
  constructor(tandem) {
    super(tandem, {
      numberOfAtmosphereLayers: 3,
      minimumGroundTemperature: MINIMUM_GROUND_TEMPERATURE,
      initialAtmosphereLayerAbsorptionProportion: INITIAL_ABSORPTION_PROPORTION,
      atmosphereLayersInitiallyActive: false,
      fluxMeterPresent: true,
      fluxMeterOptions: {
        moveSensorOffLayers: true
      }
    });

    // the collection of visible and IR photons that move around and interact with the ground and atmosphere
    this.photonCollection = new PhotonCollection(this.sunEnergySource, this.groundLayer, this.atmosphereLayers, {
      photonAbsorbingEmittingLayerOptions: {
        photonMaxLateralJumpProportion: 0,
        photonAbsorptionTime: 0,
        thickness: 2800 // empirically determined to look good in the view
      },

      tandem: tandem.createTandem('photonCollection')
    });

    // This Property is used to set the absorbance value used for all layers in this model.  It is part of the API for
    // this class.
    this.layersInfraredAbsorbanceProperty = new NumberProperty(INITIAL_ABSORPTION_PROPORTION, {
      range: IR_ABSORBANCE_RANGE,
      tandem: tandem.createTandem('layersInfraredAbsorbanceProperty')
    });

    // Monitor the absorbance setting and update the layers when changes occur.
    this.layersInfraredAbsorbanceProperty.lazyLink(absorbance => {
      this.atmosphereLayers.forEach(layer => {
        layer.energyAbsorptionProportionProperty.set(absorbance);
      });
    });
    const numberOfActiveLayers = this.atmosphereLayers.reduce((previousValue, layer) => {
      return previousValue + (layer.isActiveProperty.value ? 1 : 0);
    }, 0);

    // This Property sets the number of active layers in the atmosphere.  It is part of the API for this class, and can
    // be used by clients to activate and deactivate layers.
    this.numberOfActiveAtmosphereLayersProperty = new NumberProperty(numberOfActiveLayers, {
      range: new Range(0, this.atmosphereLayers.length),
      tandem: tandem.createTandem('numberOfAtmosphereLayersProperty'),
      phetioReadOnly: true
    });

    // Activate and deactivate layers as the desired number changes.  Layers are activated from the bottom up.
    this.numberOfActiveAtmosphereLayersProperty.lazyLink(numberOfActiveLayers => {
      this.atmosphereLayers.forEach((layer, index) => {
        layer.isActiveProperty.set(numberOfActiveLayers > index);
      });
    });
  }

  /**
   * Step the model forward in time.
   */
  stepModel(dt) {
    this.photonCollection.step(dt);
    super.stepModel(dt);
  }

  /**
   * Return to initial conditions.
   */
  reset() {
    this.numberOfActiveAtmosphereLayersProperty.reset();
    this.layersInfraredAbsorbanceProperty.reset();
    this.photonCollection.reset();
    super.reset();
  }

  // static values
  static IR_ABSORBANCE_RANGE = IR_ABSORBANCE_RANGE;
}
greenhouseEffect.register('LayerModelModel', LayerModelModel);
export default LayerModelModel;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJncmVlbmhvdXNlRWZmZWN0IiwiTnVtYmVyUHJvcGVydHkiLCJSYW5nZSIsIkxheWVyc01vZGVsIiwiUGhvdG9uQ29sbGVjdGlvbiIsIklOSVRJQUxfQUJTT1JQVElPTl9QUk9QT1JUSU9OIiwiSVJfQUJTT1JCQU5DRV9SQU5HRSIsIk1JTklNVU1fR1JPVU5EX1RFTVBFUkFUVVJFIiwiTGF5ZXJNb2RlbE1vZGVsIiwiY29uc3RydWN0b3IiLCJ0YW5kZW0iLCJudW1iZXJPZkF0bW9zcGhlcmVMYXllcnMiLCJtaW5pbXVtR3JvdW5kVGVtcGVyYXR1cmUiLCJpbml0aWFsQXRtb3NwaGVyZUxheWVyQWJzb3JwdGlvblByb3BvcnRpb24iLCJhdG1vc3BoZXJlTGF5ZXJzSW5pdGlhbGx5QWN0aXZlIiwiZmx1eE1ldGVyUHJlc2VudCIsImZsdXhNZXRlck9wdGlvbnMiLCJtb3ZlU2Vuc29yT2ZmTGF5ZXJzIiwicGhvdG9uQ29sbGVjdGlvbiIsInN1bkVuZXJneVNvdXJjZSIsImdyb3VuZExheWVyIiwiYXRtb3NwaGVyZUxheWVycyIsInBob3RvbkFic29yYmluZ0VtaXR0aW5nTGF5ZXJPcHRpb25zIiwicGhvdG9uTWF4TGF0ZXJhbEp1bXBQcm9wb3J0aW9uIiwicGhvdG9uQWJzb3JwdGlvblRpbWUiLCJ0aGlja25lc3MiLCJjcmVhdGVUYW5kZW0iLCJsYXllcnNJbmZyYXJlZEFic29yYmFuY2VQcm9wZXJ0eSIsInJhbmdlIiwibGF6eUxpbmsiLCJhYnNvcmJhbmNlIiwiZm9yRWFjaCIsImxheWVyIiwiZW5lcmd5QWJzb3JwdGlvblByb3BvcnRpb25Qcm9wZXJ0eSIsInNldCIsIm51bWJlck9mQWN0aXZlTGF5ZXJzIiwicmVkdWNlIiwicHJldmlvdXNWYWx1ZSIsImlzQWN0aXZlUHJvcGVydHkiLCJ2YWx1ZSIsIm51bWJlck9mQWN0aXZlQXRtb3NwaGVyZUxheWVyc1Byb3BlcnR5IiwibGVuZ3RoIiwicGhldGlvUmVhZE9ubHkiLCJpbmRleCIsInN0ZXBNb2RlbCIsImR0Iiwic3RlcCIsInJlc2V0IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJMYXllck1vZGVsTW9kZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjAtMjAyMiwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQGF1dGhvciBKb2huIEJsYW5jb1xyXG4gKi9cclxuXHJcbmltcG9ydCBncmVlbmhvdXNlRWZmZWN0IGZyb20gJy4uLy4uL2dyZWVuaG91c2VFZmZlY3QuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgTnVtYmVyUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9OdW1iZXJQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBSYW5nZSBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvUmFuZ2UuanMnO1xyXG5pbXBvcnQgTGF5ZXJzTW9kZWwgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0xheWVyc01vZGVsLmpzJztcclxuaW1wb3J0IFBob3RvbkNvbGxlY3Rpb24gZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL1Bob3RvbkNvbGxlY3Rpb24uanMnO1xyXG5cclxuLy8gY29uc3RhbnRzXHJcbmNvbnN0IElOSVRJQUxfQUJTT1JQVElPTl9QUk9QT1JUSU9OID0gMS4wO1xyXG5jb25zdCBJUl9BQlNPUkJBTkNFX1JBTkdFID0gbmV3IFJhbmdlKCAwLjEsIDEgKTtcclxuXHJcbi8vIFRoaXMgdmFsdWUsIHdoaWNoIGlzIGluIEtlbHZpbiwgaXMgdGhlIG1pbmltdW0gdmFsdWUgdGhhdCB0aGUgZ3JvdW5kIGlzIGFsbG93ZWQgdG8gZ2V0IHRvLiAgSXQgd2FzIGNhbGN1bGF0ZWQgYnlcclxuLy8gdXNpbmcgNTAlIHN1biBhbmQgMC45IGFsYmVkbywgc2luY2UgdGhlc2UgYXJlIHRoZSB2YWx1ZXMgdGhhdCBhcmUgYWxsb3dlZCBpbiB0aGUgVUkgZGVzaWduIHRoYXQgd291bGQgbGVhZCB0byB0aGVcclxuLy8gbG93ZXN0IHRlbXBlcmF0dXJlLiAgVGhpcyB2YWx1ZSB3YXMgY2FsY3VsYXRlZCwgYW5kIHRoZW4gc29tZSBtYXJnaW4gd2FzIGFkZGVkLlxyXG5jb25zdCBNSU5JTVVNX0dST1VORF9URU1QRVJBVFVSRSA9IDEyNTtcclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmNsYXNzIExheWVyTW9kZWxNb2RlbCBleHRlbmRzIExheWVyc01vZGVsIHtcclxuICBwdWJsaWMgcmVhZG9ubHkgbnVtYmVyT2ZBY3RpdmVBdG1vc3BoZXJlTGF5ZXJzUHJvcGVydHk6IE51bWJlclByb3BlcnR5O1xyXG4gIHB1YmxpYyByZWFkb25seSBsYXllcnNJbmZyYXJlZEFic29yYmFuY2VQcm9wZXJ0eTogTnVtYmVyUHJvcGVydHk7XHJcbiAgcHVibGljIHJlYWRvbmx5IHBob3RvbkNvbGxlY3Rpb246IFBob3RvbkNvbGxlY3Rpb247XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggdGFuZGVtOiBUYW5kZW0gKSB7XHJcbiAgICBzdXBlciggdGFuZGVtLCB7XHJcbiAgICAgIG51bWJlck9mQXRtb3NwaGVyZUxheWVyczogMyxcclxuICAgICAgbWluaW11bUdyb3VuZFRlbXBlcmF0dXJlOiBNSU5JTVVNX0dST1VORF9URU1QRVJBVFVSRSxcclxuICAgICAgaW5pdGlhbEF0bW9zcGhlcmVMYXllckFic29ycHRpb25Qcm9wb3J0aW9uOiBJTklUSUFMX0FCU09SUFRJT05fUFJPUE9SVElPTixcclxuICAgICAgYXRtb3NwaGVyZUxheWVyc0luaXRpYWxseUFjdGl2ZTogZmFsc2UsXHJcbiAgICAgIGZsdXhNZXRlclByZXNlbnQ6IHRydWUsXHJcbiAgICAgIGZsdXhNZXRlck9wdGlvbnM6IHtcclxuICAgICAgICBtb3ZlU2Vuc29yT2ZmTGF5ZXJzOiB0cnVlXHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB0aGUgY29sbGVjdGlvbiBvZiB2aXNpYmxlIGFuZCBJUiBwaG90b25zIHRoYXQgbW92ZSBhcm91bmQgYW5kIGludGVyYWN0IHdpdGggdGhlIGdyb3VuZCBhbmQgYXRtb3NwaGVyZVxyXG4gICAgdGhpcy5waG90b25Db2xsZWN0aW9uID0gbmV3IFBob3RvbkNvbGxlY3Rpb24oIHRoaXMuc3VuRW5lcmd5U291cmNlLCB0aGlzLmdyb3VuZExheWVyLCB0aGlzLmF0bW9zcGhlcmVMYXllcnMsIHtcclxuICAgICAgcGhvdG9uQWJzb3JiaW5nRW1pdHRpbmdMYXllck9wdGlvbnM6IHtcclxuICAgICAgICBwaG90b25NYXhMYXRlcmFsSnVtcFByb3BvcnRpb246IDAsXHJcbiAgICAgICAgcGhvdG9uQWJzb3JwdGlvblRpbWU6IDAsXHJcbiAgICAgICAgdGhpY2tuZXNzOiAyODAwIC8vIGVtcGlyaWNhbGx5IGRldGVybWluZWQgdG8gbG9vayBnb29kIGluIHRoZSB2aWV3XHJcbiAgICAgIH0sXHJcbiAgICAgIHRhbmRlbTogdGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3Bob3RvbkNvbGxlY3Rpb24nIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBUaGlzIFByb3BlcnR5IGlzIHVzZWQgdG8gc2V0IHRoZSBhYnNvcmJhbmNlIHZhbHVlIHVzZWQgZm9yIGFsbCBsYXllcnMgaW4gdGhpcyBtb2RlbC4gIEl0IGlzIHBhcnQgb2YgdGhlIEFQSSBmb3JcclxuICAgIC8vIHRoaXMgY2xhc3MuXHJcbiAgICB0aGlzLmxheWVyc0luZnJhcmVkQWJzb3JiYW5jZVByb3BlcnR5ID0gbmV3IE51bWJlclByb3BlcnR5KCBJTklUSUFMX0FCU09SUFRJT05fUFJPUE9SVElPTiwge1xyXG4gICAgICByYW5nZTogSVJfQUJTT1JCQU5DRV9SQU5HRSxcclxuICAgICAgdGFuZGVtOiB0YW5kZW0uY3JlYXRlVGFuZGVtKCAnbGF5ZXJzSW5mcmFyZWRBYnNvcmJhbmNlUHJvcGVydHknIClcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBNb25pdG9yIHRoZSBhYnNvcmJhbmNlIHNldHRpbmcgYW5kIHVwZGF0ZSB0aGUgbGF5ZXJzIHdoZW4gY2hhbmdlcyBvY2N1ci5cclxuICAgIHRoaXMubGF5ZXJzSW5mcmFyZWRBYnNvcmJhbmNlUHJvcGVydHkubGF6eUxpbmsoIGFic29yYmFuY2UgPT4ge1xyXG4gICAgICB0aGlzLmF0bW9zcGhlcmVMYXllcnMuZm9yRWFjaCggbGF5ZXIgPT4ge1xyXG4gICAgICAgIGxheWVyLmVuZXJneUFic29ycHRpb25Qcm9wb3J0aW9uUHJvcGVydHkuc2V0KCBhYnNvcmJhbmNlICk7XHJcbiAgICAgIH0gKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBudW1iZXJPZkFjdGl2ZUxheWVycyA9IHRoaXMuYXRtb3NwaGVyZUxheWVycy5yZWR1Y2UoICggcHJldmlvdXNWYWx1ZSwgbGF5ZXIgKSA9PiB7XHJcbiAgICAgIHJldHVybiBwcmV2aW91c1ZhbHVlICsgKCBsYXllci5pc0FjdGl2ZVByb3BlcnR5LnZhbHVlID8gMSA6IDAgKTtcclxuICAgIH0sIDAgKTtcclxuXHJcbiAgICAvLyBUaGlzIFByb3BlcnR5IHNldHMgdGhlIG51bWJlciBvZiBhY3RpdmUgbGF5ZXJzIGluIHRoZSBhdG1vc3BoZXJlLiAgSXQgaXMgcGFydCBvZiB0aGUgQVBJIGZvciB0aGlzIGNsYXNzLCBhbmQgY2FuXHJcbiAgICAvLyBiZSB1c2VkIGJ5IGNsaWVudHMgdG8gYWN0aXZhdGUgYW5kIGRlYWN0aXZhdGUgbGF5ZXJzLlxyXG4gICAgdGhpcy5udW1iZXJPZkFjdGl2ZUF0bW9zcGhlcmVMYXllcnNQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggbnVtYmVyT2ZBY3RpdmVMYXllcnMsIHtcclxuICAgICAgcmFuZ2U6IG5ldyBSYW5nZSggMCwgdGhpcy5hdG1vc3BoZXJlTGF5ZXJzLmxlbmd0aCApLFxyXG4gICAgICB0YW5kZW06IHRhbmRlbS5jcmVhdGVUYW5kZW0oICdudW1iZXJPZkF0bW9zcGhlcmVMYXllcnNQcm9wZXJ0eScgKSxcclxuICAgICAgcGhldGlvUmVhZE9ubHk6IHRydWVcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBBY3RpdmF0ZSBhbmQgZGVhY3RpdmF0ZSBsYXllcnMgYXMgdGhlIGRlc2lyZWQgbnVtYmVyIGNoYW5nZXMuICBMYXllcnMgYXJlIGFjdGl2YXRlZCBmcm9tIHRoZSBib3R0b20gdXAuXHJcbiAgICB0aGlzLm51bWJlck9mQWN0aXZlQXRtb3NwaGVyZUxheWVyc1Byb3BlcnR5LmxhenlMaW5rKCBudW1iZXJPZkFjdGl2ZUxheWVycyA9PiB7XHJcbiAgICAgIHRoaXMuYXRtb3NwaGVyZUxheWVycy5mb3JFYWNoKCAoIGxheWVyLCBpbmRleCApID0+IHtcclxuICAgICAgICBsYXllci5pc0FjdGl2ZVByb3BlcnR5LnNldCggbnVtYmVyT2ZBY3RpdmVMYXllcnMgPiBpbmRleCApO1xyXG4gICAgICB9ICk7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdGVwIHRoZSBtb2RlbCBmb3J3YXJkIGluIHRpbWUuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHN0ZXBNb2RlbCggZHQ6IG51bWJlciApOiB2b2lkIHtcclxuICAgIHRoaXMucGhvdG9uQ29sbGVjdGlvbi5zdGVwKCBkdCApO1xyXG4gICAgc3VwZXIuc3RlcE1vZGVsKCBkdCApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJuIHRvIGluaXRpYWwgY29uZGl0aW9ucy5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgcmVzZXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLm51bWJlck9mQWN0aXZlQXRtb3NwaGVyZUxheWVyc1Byb3BlcnR5LnJlc2V0KCk7XHJcbiAgICB0aGlzLmxheWVyc0luZnJhcmVkQWJzb3JiYW5jZVByb3BlcnR5LnJlc2V0KCk7XHJcbiAgICB0aGlzLnBob3RvbkNvbGxlY3Rpb24ucmVzZXQoKTtcclxuICAgIHN1cGVyLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICAvLyBzdGF0aWMgdmFsdWVzXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBJUl9BQlNPUkJBTkNFX1JBTkdFID0gSVJfQUJTT1JCQU5DRV9SQU5HRTtcclxufVxyXG5cclxuZ3JlZW5ob3VzZUVmZmVjdC5yZWdpc3RlciggJ0xheWVyTW9kZWxNb2RlbCcsIExheWVyTW9kZWxNb2RlbCApO1xyXG5leHBvcnQgZGVmYXVsdCBMYXllck1vZGVsTW9kZWw7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsZ0JBQWdCLE1BQU0sMkJBQTJCO0FBRXhELE9BQU9DLGNBQWMsTUFBTSx1Q0FBdUM7QUFDbEUsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxXQUFXLE1BQU0sbUNBQW1DO0FBQzNELE9BQU9DLGdCQUFnQixNQUFNLHdDQUF3Qzs7QUFFckU7QUFDQSxNQUFNQyw2QkFBNkIsR0FBRyxHQUFHO0FBQ3pDLE1BQU1DLG1CQUFtQixHQUFHLElBQUlKLEtBQUssQ0FBRSxHQUFHLEVBQUUsQ0FBRSxDQUFDOztBQUUvQztBQUNBO0FBQ0E7QUFDQSxNQUFNSywwQkFBMEIsR0FBRyxHQUFHOztBQUV0QztBQUNBO0FBQ0E7QUFDQSxNQUFNQyxlQUFlLFNBQVNMLFdBQVcsQ0FBQztFQUtqQ00sV0FBV0EsQ0FBRUMsTUFBYyxFQUFHO0lBQ25DLEtBQUssQ0FBRUEsTUFBTSxFQUFFO01BQ2JDLHdCQUF3QixFQUFFLENBQUM7TUFDM0JDLHdCQUF3QixFQUFFTCwwQkFBMEI7TUFDcERNLDBDQUEwQyxFQUFFUiw2QkFBNkI7TUFDekVTLCtCQUErQixFQUFFLEtBQUs7TUFDdENDLGdCQUFnQixFQUFFLElBQUk7TUFDdEJDLGdCQUFnQixFQUFFO1FBQ2hCQyxtQkFBbUIsRUFBRTtNQUN2QjtJQUNGLENBQUUsQ0FBQzs7SUFFSDtJQUNBLElBQUksQ0FBQ0MsZ0JBQWdCLEdBQUcsSUFBSWQsZ0JBQWdCLENBQUUsSUFBSSxDQUFDZSxlQUFlLEVBQUUsSUFBSSxDQUFDQyxXQUFXLEVBQUUsSUFBSSxDQUFDQyxn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