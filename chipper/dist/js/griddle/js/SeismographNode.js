// Copyright 2020-2022, University of Colorado Boulder

/**
 * A XYChartNode which is set up to behave like a Seismograph. The modelViewTransform for this chart
 * is set such that data streams onto the chart from the right side. The default size is currently small so that
 * it can fit into a small draggable sensor, like the ones in Wave Interference, Bending Light, Circuit Construction
 * Kit: AC. IT is typicall embedded in a Panel.
 *
 * Please see the demo in http://localhost/griddle/griddle_en.html
 *
 * @author Jesse Greenberg
 */

import Multilink from '../../axon/js/Multilink.js';
import Property from '../../axon/js/Property.js';
import Bounds2 from '../../dot/js/Bounds2.js';
import Range from '../../dot/js/Range.js';
import deprecationWarning from '../../phet-core/js/deprecationWarning.js';
import merge from '../../phet-core/js/merge.js';
import ModelViewTransform2 from '../../phetcommon/js/view/ModelViewTransform2.js';
import Tandem from '../../tandem/js/Tandem.js';
import griddle from './griddle.js';
import SeismographDynamicSeriesNode from './SeismographDynamicSeriesNode.js';
import SpanNode from './SpanNode.js';
import XYChartNode from './XYChartNode.js';

// constants
const HORIZONTAL_AXIS_LABEL_MARGIN = 4;

/**
 * @deprecated - please use BAMBOO/GridLineSet
 */
class SeismographNode extends XYChartNode {
  /**
   * @param {NumberProperty} valueProperty - value along the horizontal axis, in model units
   * @param {DynamicSeries[]} dynamicSeriesArray - data to be plotted
   * @param spanLabelNode - label Node for the span, indicating units of value
   * @param options
   */
  constructor(valueProperty, dynamicSeriesArray, spanLabelNode, options) {
    assert && deprecationWarning('Please use bamboo');

    // the grid for a seismograph does not scroll with the data, so it will get its own transform (set below)
    const gridTransformProperty = new Property(ModelViewTransform2.createIdentity());
    options = merge({
      // {Range[]} - If there is more than one specified vertical range, zoom buttons are displayed - in model coordinates
      verticalRanges: [new Range(-1, 1)],
      // {number} - index of verticalRanges above to initially use
      initialVerticalRangeIndex: 0,
      verticalRangeProperty: new Property(new Range(-1, 1)),
      horizontalRangeProperty: new Property(new Range(0, 4)),
      // number of grid lines in the seismograph, including lines along the min and max (edges of the chart)
      numberHorizontalLines: 5,
      numberVerticalLines: 5,
      // {Node} - label for the horizontal axis, layout adjusted to accommodate the span Node of the Seismograph,
      // otherwise passed to supertype
      horizontalAxisLabelNode: null,
      // {boolean} - by default, there are no horizontal labels for the SeismographNode
      showHorizontalGridLabels: false,
      // {boolean} - if true, the GridNode will scroll with the data
      scrollGridNode: false,
      gridLabelOptions: {
        fill: 'white'
      },
      // passed along to the GridNode of XYChartNode
      gridNodeOptions: {
        majorLineOptions: {
          stroke: 'lightGray',
          lineDash: [5, 5],
          lineWidth: 0.8,
          lineDashOffset: 5 / 2
        }
      },
      // right margin of the chart, gives room for the "pen" of the DynamicSeriesNode
      rightMargin: 10,
      tandem: Tandem.OPTIONAL
    }, options);
    assert && assert(options.modelViewTransformProperty === undefined, 'SeismographNode sets ModelViewTransform');
    assert && assert(options.verticalRanges.length === 1, 'SeismographNode is deprecated and no longer supports multiple vertical ranges, please use bamboo');
    assert && assert(options.gridNodeOptions.modelViewTransformProperty === undefined, 'SeismographNode sets transform for GridNode');
    options.gridNodeOptions.modelViewTransformProperty = gridTransformProperty;
    super(options);

    // @private {number} - margin for the 'pen' circle on the seismograph
    this.rightMargin = options.rightMargin;

    // @public (listen-only)
    this.verticalRangeProperty = options.verticalRangeProperty;
    this.horizontalRangeProperty = options.horizontalRangeProperty;
    this.addDynamicSeriesArray(dynamicSeriesArray);
    const zoomLevelIndexProperty = new Property(options.initialVerticalRangeIndex, {
      isValidValue: v => v >= 0 && v < options.verticalRanges.length
    });
    const zoomListener = zoomLevelIndex => {
      this.verticalRangeProperty.set(options.verticalRanges[zoomLevelIndex]);
    };
    zoomLevelIndexProperty.link(zoomListener);
    const widthWithMargin = this.chartWidth - options.rightMargin;

    // update the transform if vertical ranges change
    const dataMappingLink = Multilink.multilink([valueProperty, this.verticalRangeProperty], (value, verticalRange) => {
      const transform = ModelViewTransform2.createRectangleInvertedYMapping(new Bounds2(value - 4, verticalRange.min, value, verticalRange.max), new Bounds2(0, 0, widthWithMargin, this.chartHeight));
      this.modelViewTransformProperty.set(transform);
      if (options.scrollGridNode) {
        // if scrolling the GridNode, it receives the same transform as the chart
        gridTransformProperty.set(transform);
      } else {
        // if grid isn't scrolling don't pan it with value variable, but still transform with vertical range
        const newTransform = ModelViewTransform2.createRectangleInvertedYMapping(new Bounds2(0, verticalRange.min, 4, verticalRange.max), new Bounds2(0, 0, widthWithMargin, this.chartHeight));

        // only redraw if vertical range has changed
        if (!newTransform.matrix.equals(gridTransformProperty.get().matrix)) {
          gridTransformProperty.set(newTransform);
        }
      }
    });
    const viewSpanWidth = gridTransformProperty.get().modelToViewDeltaX(this.majorVerticalLineSpacing);
    const spanNode = new SpanNode(spanLabelNode, viewSpanWidth, {
      left: this.chartPanel.left,
      top: this.chartPanel.bottom + 2
    });

    // make sure the horizontal label doesn't overlap with the spanNode
    if (options.horizontalAxisLabelNode) {
      if (options.horizontalAxisLabelNode.left < spanNode.right + HORIZONTAL_AXIS_LABEL_MARGIN) {
        options.horizontalAxisLabelNode.left = spanNode.right + HORIZONTAL_AXIS_LABEL_MARGIN;
        options.horizontalAxisLabelNode.maxWidth = this.chartWidth - spanNode.width - HORIZONTAL_AXIS_LABEL_MARGIN;
      }
    }
    this.addChild(spanNode);
    this.verticalRangeProperty.link(verticalRange => {
      const majorHorizontalLineSpacing = verticalRange.getLength() / (options.numberHorizontalLines - 1);
      const majorVerticalLineSpacing = this.horizontalRangeProperty.get().getLength() / (options.numberVerticalLines - 1);
      this.setLineSpacings({
        majorVerticalLineSpacing: majorVerticalLineSpacing,
        majorHorizontalLineSpacing: majorHorizontalLineSpacing
      });
    });

    // @private
    this.resetSeismographNode = () => {
      zoomLevelIndexProperty.reset();
    };

    // @private - called by dispose
    this.disposeSeismographNode = () => {
      zoomLevelIndexProperty.unlink(zoomListener);
      Multilink.unmultilink(dataMappingLink);
    };
  }

  /**
   * Adds a SeismographDynamicSeriesNode to represent the DynamicSeries.
   * @protected
   * @override
   *
   * @param {DynamicSeries} dynamicSeries
   */
  addDynamicSeries(dynamicSeries) {
    const dynamicSeriesNode = new SeismographDynamicSeriesNode(dynamicSeries, this.chartWidth - this.rightMargin, new Bounds2(0, 0, this.chartWidth, this.chartHeight), this.modelViewTransformProperty);
    this.chartPanel.addChild(dynamicSeriesNode);
    this.scrollingChartNodeDisposeEmitter.addListener(() => dynamicSeriesNode.dispose());
  }

  /**
   * @public - restore initial conditions
   */
  reset() {
    this.resetSeismographNode();
  }

  /**
   * @public
   */
  dispose() {
    this.disposeSeismographNode();
    super.dispose();
  }
}
griddle.register('SeismographNode', SeismographNode);
export default SeismographNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aWxpbmsiLCJQcm9wZXJ0eSIsIkJvdW5kczIiLCJSYW5nZSIsImRlcHJlY2F0aW9uV2FybmluZyIsIm1lcmdlIiwiTW9kZWxWaWV3VHJhbnNmb3JtMiIsIlRhbmRlbSIsImdyaWRkbGUiLCJTZWlzbW9ncmFwaER5bmFtaWNTZXJpZXNOb2RlIiwiU3Bhbk5vZGUiLCJYWUNoYXJ0Tm9kZSIsIkhPUklaT05UQUxfQVhJU19MQUJFTF9NQVJHSU4iLCJTZWlzbW9ncmFwaE5vZGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlUHJvcGVydHkiLCJkeW5hbWljU2VyaWVzQXJyYXkiLCJzcGFuTGFiZWxOb2RlIiwib3B0aW9ucyIsImFzc2VydCIsImdyaWRUcmFuc2Zvcm1Qcm9wZXJ0eSIsImNyZWF0ZUlkZW50aXR5IiwidmVydGljYWxSYW5nZXMiLCJpbml0aWFsVmVydGljYWxSYW5nZUluZGV4IiwidmVydGljYWxSYW5nZVByb3BlcnR5IiwiaG9yaXpvbnRhbFJhbmdlUHJvcGVydHkiLCJudW1iZXJIb3Jpem9udGFsTGluZXMiLCJudW1iZXJWZXJ0aWNhbExpbmVzIiwiaG9yaXpvbnRhbEF4aXNMYWJlbE5vZGUiLCJzaG93SG9yaXpvbnRhbEdyaWRMYWJlbHMiLCJzY3JvbGxHcmlkTm9kZSIsImdyaWRMYWJlbE9wdGlvbnMiLCJmaWxsIiwiZ3JpZE5vZGVPcHRpb25zIiwibWFqb3JMaW5lT3B0aW9ucyIsInN0cm9rZSIsImxpbmVEYXNoIiwibGluZVdpZHRoIiwibGluZURhc2hPZmZzZXQiLCJyaWdodE1hcmdpbiIsInRhbmRlbSIsIk9QVElPTkFMIiwibW9kZWxWaWV3VHJhbnNmb3JtUHJvcGVydHkiLCJ1bmRlZmluZWQiLCJsZW5ndGgiLCJhZGREeW5hbWljU2VyaWVzQXJyYXkiLCJ6b29tTGV2ZWxJbmRleFByb3BlcnR5IiwiaXNWYWxpZFZhbHVlIiwidiIsInpvb21MaXN0ZW5lciIsInpvb21MZXZlbEluZGV4Iiwic2V0IiwibGluayIsIndpZHRoV2l0aE1hcmdpbiIsImNoYXJ0V2lkdGgiLCJkYXRhTWFwcGluZ0xpbmsiLCJtdWx0aWxpbmsiLCJ2YWx1ZSIsInZlcnRpY2FsUmFuZ2UiLCJ0cmFuc2Zvcm0iLCJjcmVhdGVSZWN0YW5nbGVJbnZlcnRlZFlNYXBwaW5nIiwibWluIiwibWF4IiwiY2hhcnRIZWlnaHQiLCJuZXdUcmFuc2Zvcm0iLCJtYXRyaXgiLCJlcXVhbHMiLCJnZXQiLCJ2aWV3U3BhbldpZHRoIiwibW9kZWxUb1ZpZXdEZWx0YVgiLCJtYWpvclZlcnRpY2FsTGluZVNwYWNpbmciLCJzcGFuTm9kZSIsImxlZnQiLCJjaGFydFBhbmVsIiwidG9wIiwiYm90dG9tIiwicmlnaHQiLCJtYXhXaWR0aCIsIndpZHRoIiwiYWRkQ2hpbGQiLCJtYWpvckhvcml6b250YWxMaW5lU3BhY2luZyIsImdldExlbmd0aCIsInNldExpbmVTcGFjaW5ncyIsInJlc2V0U2Vpc21vZ3JhcGhOb2RlIiwicmVzZXQiLCJkaXNwb3NlU2Vpc21vZ3JhcGhOb2RlIiwidW5saW5rIiwidW5tdWx0aWxpbmsiLCJhZGREeW5hbWljU2VyaWVzIiwiZHluYW1pY1NlcmllcyIsImR5bmFtaWNTZXJpZXNOb2RlIiwic2Nyb2xsaW5nQ2hhcnROb2RlRGlzcG9zZUVtaXR0ZXIiLCJhZGRMaXN0ZW5lciIsImRpc3Bvc2UiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlNlaXNtb2dyYXBoTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBIFhZQ2hhcnROb2RlIHdoaWNoIGlzIHNldCB1cCB0byBiZWhhdmUgbGlrZSBhIFNlaXNtb2dyYXBoLiBUaGUgbW9kZWxWaWV3VHJhbnNmb3JtIGZvciB0aGlzIGNoYXJ0XHJcbiAqIGlzIHNldCBzdWNoIHRoYXQgZGF0YSBzdHJlYW1zIG9udG8gdGhlIGNoYXJ0IGZyb20gdGhlIHJpZ2h0IHNpZGUuIFRoZSBkZWZhdWx0IHNpemUgaXMgY3VycmVudGx5IHNtYWxsIHNvIHRoYXRcclxuICogaXQgY2FuIGZpdCBpbnRvIGEgc21hbGwgZHJhZ2dhYmxlIHNlbnNvciwgbGlrZSB0aGUgb25lcyBpbiBXYXZlIEludGVyZmVyZW5jZSwgQmVuZGluZyBMaWdodCwgQ2lyY3VpdCBDb25zdHJ1Y3Rpb25cclxuICogS2l0OiBBQy4gSVQgaXMgdHlwaWNhbGwgZW1iZWRkZWQgaW4gYSBQYW5lbC5cclxuICpcclxuICogUGxlYXNlIHNlZSB0aGUgZGVtbyBpbiBodHRwOi8vbG9jYWxob3N0L2dyaWRkbGUvZ3JpZGRsZV9lbi5odG1sXHJcbiAqXHJcbiAqIEBhdXRob3IgSmVzc2UgR3JlZW5iZXJnXHJcbiAqL1xyXG5cclxuaW1wb3J0IE11bHRpbGluayBmcm9tICcuLi8uLi9heG9uL2pzL011bHRpbGluay5qcyc7XHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IGRlcHJlY2F0aW9uV2FybmluZyBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvZGVwcmVjYXRpb25XYXJuaW5nLmpzJztcclxuaW1wb3J0IG1lcmdlIGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy9tZXJnZS5qcyc7XHJcbmltcG9ydCBNb2RlbFZpZXdUcmFuc2Zvcm0yIGZyb20gJy4uLy4uL3BoZXRjb21tb24vanMvdmlldy9Nb2RlbFZpZXdUcmFuc2Zvcm0yLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IGdyaWRkbGUgZnJvbSAnLi9ncmlkZGxlLmpzJztcclxuaW1wb3J0IFNlaXNtb2dyYXBoRHluYW1pY1Nlcmllc05vZGUgZnJvbSAnLi9TZWlzbW9ncmFwaER5bmFtaWNTZXJpZXNOb2RlLmpzJztcclxuaW1wb3J0IFNwYW5Ob2RlIGZyb20gJy4vU3Bhbk5vZGUuanMnO1xyXG5pbXBvcnQgWFlDaGFydE5vZGUgZnJvbSAnLi9YWUNoYXJ0Tm9kZS5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgSE9SSVpPTlRBTF9BWElTX0xBQkVMX01BUkdJTiA9IDQ7XHJcblxyXG4vKipcclxuICogQGRlcHJlY2F0ZWQgLSBwbGVhc2UgdXNlIEJBTUJPTy9HcmlkTGluZVNldFxyXG4gKi9cclxuY2xhc3MgU2Vpc21vZ3JhcGhOb2RlIGV4dGVuZHMgWFlDaGFydE5vZGUge1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge051bWJlclByb3BlcnR5fSB2YWx1ZVByb3BlcnR5IC0gdmFsdWUgYWxvbmcgdGhlIGhvcml6b250YWwgYXhpcywgaW4gbW9kZWwgdW5pdHNcclxuICAgKiBAcGFyYW0ge0R5bmFtaWNTZXJpZXNbXX0gZHluYW1pY1Nlcmllc0FycmF5IC0gZGF0YSB0byBiZSBwbG90dGVkXHJcbiAgICogQHBhcmFtIHNwYW5MYWJlbE5vZGUgLSBsYWJlbCBOb2RlIGZvciB0aGUgc3BhbiwgaW5kaWNhdGluZyB1bml0cyBvZiB2YWx1ZVxyXG4gICAqIEBwYXJhbSBvcHRpb25zXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHZhbHVlUHJvcGVydHksIGR5bmFtaWNTZXJpZXNBcnJheSwgc3BhbkxhYmVsTm9kZSwgb3B0aW9ucyApIHtcclxuICAgIGFzc2VydCAmJiBkZXByZWNhdGlvbldhcm5pbmcoICdQbGVhc2UgdXNlIGJhbWJvbycgKTtcclxuXHJcbiAgICAvLyB0aGUgZ3JpZCBmb3IgYSBzZWlzbW9ncmFwaCBkb2VzIG5vdCBzY3JvbGwgd2l0aCB0aGUgZGF0YSwgc28gaXQgd2lsbCBnZXQgaXRzIG93biB0cmFuc2Zvcm0gKHNldCBiZWxvdylcclxuICAgIGNvbnN0IGdyaWRUcmFuc2Zvcm1Qcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eSggTW9kZWxWaWV3VHJhbnNmb3JtMi5jcmVhdGVJZGVudGl0eSgpICk7XHJcblxyXG4gICAgb3B0aW9ucyA9IG1lcmdlKCB7XHJcblxyXG4gICAgICAvLyB7UmFuZ2VbXX0gLSBJZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIHNwZWNpZmllZCB2ZXJ0aWNhbCByYW5nZSwgem9vbSBidXR0b25zIGFyZSBkaXNwbGF5ZWQgLSBpbiBtb2RlbCBjb29yZGluYXRlc1xyXG4gICAgICB2ZXJ0aWNhbFJhbmdlczogWyBuZXcgUmFuZ2UoIC0xLCAxICkgXSxcclxuXHJcbiAgICAgIC8vIHtudW1iZXJ9IC0gaW5kZXggb2YgdmVydGljYWxSYW5nZXMgYWJvdmUgdG8gaW5pdGlhbGx5IHVzZVxyXG4gICAgICBpbml0aWFsVmVydGljYWxSYW5nZUluZGV4OiAwLFxyXG5cclxuICAgICAgdmVydGljYWxSYW5nZVByb3BlcnR5OiBuZXcgUHJvcGVydHkoIG5ldyBSYW5nZSggLTEsIDEgKSApLFxyXG4gICAgICBob3Jpem9udGFsUmFuZ2VQcm9wZXJ0eTogbmV3IFByb3BlcnR5KCBuZXcgUmFuZ2UoIDAsIDQgKSApLFxyXG5cclxuICAgICAgLy8gbnVtYmVyIG9mIGdyaWQgbGluZXMgaW4gdGhlIHNlaXNtb2dyYXBoLCBpbmNsdWRpbmcgbGluZXMgYWxvbmcgdGhlIG1pbiBhbmQgbWF4IChlZGdlcyBvZiB0aGUgY2hhcnQpXHJcbiAgICAgIG51bWJlckhvcml6b250YWxMaW5lczogNSxcclxuICAgICAgbnVtYmVyVmVydGljYWxMaW5lczogNSxcclxuXHJcbiAgICAgIC8vIHtOb2RlfSAtIGxhYmVsIGZvciB0aGUgaG9yaXpvbnRhbCBheGlzLCBsYXlvdXQgYWRqdXN0ZWQgdG8gYWNjb21tb2RhdGUgdGhlIHNwYW4gTm9kZSBvZiB0aGUgU2Vpc21vZ3JhcGgsXHJcbiAgICAgIC8vIG90aGVyd2lzZSBwYXNzZWQgdG8gc3VwZXJ0eXBlXHJcbiAgICAgIGhvcml6b250YWxBeGlzTGFiZWxOb2RlOiBudWxsLFxyXG5cclxuICAgICAgLy8ge2Jvb2xlYW59IC0gYnkgZGVmYXVsdCwgdGhlcmUgYXJlIG5vIGhvcml6b250YWwgbGFiZWxzIGZvciB0aGUgU2Vpc21vZ3JhcGhOb2RlXHJcbiAgICAgIHNob3dIb3Jpem9udGFsR3JpZExhYmVsczogZmFsc2UsXHJcblxyXG4gICAgICAvLyB7Ym9vbGVhbn0gLSBpZiB0cnVlLCB0aGUgR3JpZE5vZGUgd2lsbCBzY3JvbGwgd2l0aCB0aGUgZGF0YVxyXG4gICAgICBzY3JvbGxHcmlkTm9kZTogZmFsc2UsXHJcblxyXG4gICAgICBncmlkTGFiZWxPcHRpb25zOiB7XHJcbiAgICAgICAgZmlsbDogJ3doaXRlJ1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gcGFzc2VkIGFsb25nIHRvIHRoZSBHcmlkTm9kZSBvZiBYWUNoYXJ0Tm9kZVxyXG4gICAgICBncmlkTm9kZU9wdGlvbnM6IHtcclxuICAgICAgICBtYWpvckxpbmVPcHRpb25zOiB7XHJcbiAgICAgICAgICBzdHJva2U6ICdsaWdodEdyYXknLFxyXG4gICAgICAgICAgbGluZURhc2g6IFsgNSwgNSBdLFxyXG4gICAgICAgICAgbGluZVdpZHRoOiAwLjgsXHJcbiAgICAgICAgICBsaW5lRGFzaE9mZnNldDogNSAvIDJcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyByaWdodCBtYXJnaW4gb2YgdGhlIGNoYXJ0LCBnaXZlcyByb29tIGZvciB0aGUgXCJwZW5cIiBvZiB0aGUgRHluYW1pY1Nlcmllc05vZGVcclxuICAgICAgcmlnaHRNYXJnaW46IDEwLFxyXG5cclxuICAgICAgdGFuZGVtOiBUYW5kZW0uT1BUSU9OQUxcclxuICAgIH0sIG9wdGlvbnMgKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvcHRpb25zLm1vZGVsVmlld1RyYW5zZm9ybVByb3BlcnR5ID09PSB1bmRlZmluZWQsICdTZWlzbW9ncmFwaE5vZGUgc2V0cyBNb2RlbFZpZXdUcmFuc2Zvcm0nICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvcHRpb25zLnZlcnRpY2FsUmFuZ2VzLmxlbmd0aCA9PT0gMSwgJ1NlaXNtb2dyYXBoTm9kZSBpcyBkZXByZWNhdGVkIGFuZCBubyBsb25nZXIgc3VwcG9ydHMgbXVsdGlwbGUgdmVydGljYWwgcmFuZ2VzLCBwbGVhc2UgdXNlIGJhbWJvbycgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG9wdGlvbnMuZ3JpZE5vZGVPcHRpb25zLm1vZGVsVmlld1RyYW5zZm9ybVByb3BlcnR5ID09PSB1bmRlZmluZWQsICdTZWlzbW9ncmFwaE5vZGUgc2V0cyB0cmFuc2Zvcm0gZm9yIEdyaWROb2RlJyApO1xyXG4gICAgb3B0aW9ucy5ncmlkTm9kZU9wdGlvbnMubW9kZWxWaWV3VHJhbnNmb3JtUHJvcGVydHkgPSBncmlkVHJhbnNmb3JtUHJvcGVydHk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSB7bnVtYmVyfSAtIG1hcmdpbiBmb3IgdGhlICdwZW4nIGNpcmNsZSBvbiB0aGUgc2Vpc21vZ3JhcGhcclxuICAgIHRoaXMucmlnaHRNYXJnaW4gPSBvcHRpb25zLnJpZ2h0TWFyZ2luO1xyXG5cclxuICAgIC8vIEBwdWJsaWMgKGxpc3Rlbi1vbmx5KVxyXG4gICAgdGhpcy52ZXJ0aWNhbFJhbmdlUHJvcGVydHkgPSBvcHRpb25zLnZlcnRpY2FsUmFuZ2VQcm9wZXJ0eTtcclxuICAgIHRoaXMuaG9yaXpvbnRhbFJhbmdlUHJvcGVydHkgPSBvcHRpb25zLmhvcml6b250YWxSYW5nZVByb3BlcnR5O1xyXG5cclxuICAgIHRoaXMuYWRkRHluYW1pY1Nlcmllc0FycmF5KCBkeW5hbWljU2VyaWVzQXJyYXkgKTtcclxuXHJcbiAgICBjb25zdCB6b29tTGV2ZWxJbmRleFByb3BlcnR5ID0gbmV3IFByb3BlcnR5KCBvcHRpb25zLmluaXRpYWxWZXJ0aWNhbFJhbmdlSW5kZXgsIHtcclxuICAgICAgaXNWYWxpZFZhbHVlOiB2ID0+IHYgPj0gMCAmJiB2IDwgb3B0aW9ucy52ZXJ0aWNhbFJhbmdlcy5sZW5ndGhcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCB6b29tTGlzdGVuZXIgPSB6b29tTGV2ZWxJbmRleCA9PiB7XHJcbiAgICAgIHRoaXMudmVydGljYWxSYW5nZVByb3BlcnR5LnNldCggb3B0aW9ucy52ZXJ0aWNhbFJhbmdlc1sgem9vbUxldmVsSW5kZXggXSApO1xyXG4gICAgfTtcclxuICAgIHpvb21MZXZlbEluZGV4UHJvcGVydHkubGluayggem9vbUxpc3RlbmVyICk7XHJcblxyXG4gICAgY29uc3Qgd2lkdGhXaXRoTWFyZ2luID0gdGhpcy5jaGFydFdpZHRoIC0gb3B0aW9ucy5yaWdodE1hcmdpbjtcclxuXHJcbiAgICAvLyB1cGRhdGUgdGhlIHRyYW5zZm9ybSBpZiB2ZXJ0aWNhbCByYW5nZXMgY2hhbmdlXHJcbiAgICBjb25zdCBkYXRhTWFwcGluZ0xpbmsgPSBNdWx0aWxpbmsubXVsdGlsaW5rKCBbIHZhbHVlUHJvcGVydHksIHRoaXMudmVydGljYWxSYW5nZVByb3BlcnR5IF0sICggdmFsdWUsIHZlcnRpY2FsUmFuZ2UgKSA9PiB7XHJcbiAgICAgIGNvbnN0IHRyYW5zZm9ybSA9IE1vZGVsVmlld1RyYW5zZm9ybTIuY3JlYXRlUmVjdGFuZ2xlSW52ZXJ0ZWRZTWFwcGluZyhcclxuICAgICAgICBuZXcgQm91bmRzMiggdmFsdWUgLSA0LCB2ZXJ0aWNhbFJhbmdlLm1pbiwgdmFsdWUsIHZlcnRpY2FsUmFuZ2UubWF4ICksXHJcbiAgICAgICAgbmV3IEJvdW5kczIoIDAsIDAsIHdpZHRoV2l0aE1hcmdpbiwgdGhpcy5jaGFydEhlaWdodCApXHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMubW9kZWxWaWV3VHJhbnNmb3JtUHJvcGVydHkuc2V0KCB0cmFuc2Zvcm0gKTtcclxuXHJcbiAgICAgIGlmICggb3B0aW9ucy5zY3JvbGxHcmlkTm9kZSApIHtcclxuXHJcbiAgICAgICAgLy8gaWYgc2Nyb2xsaW5nIHRoZSBHcmlkTm9kZSwgaXQgcmVjZWl2ZXMgdGhlIHNhbWUgdHJhbnNmb3JtIGFzIHRoZSBjaGFydFxyXG4gICAgICAgIGdyaWRUcmFuc2Zvcm1Qcm9wZXJ0eS5zZXQoIHRyYW5zZm9ybSApO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG5cclxuICAgICAgICAvLyBpZiBncmlkIGlzbid0IHNjcm9sbGluZyBkb24ndCBwYW4gaXQgd2l0aCB2YWx1ZSB2YXJpYWJsZSwgYnV0IHN0aWxsIHRyYW5zZm9ybSB3aXRoIHZlcnRpY2FsIHJhbmdlXHJcbiAgICAgICAgY29uc3QgbmV3VHJhbnNmb3JtID0gTW9kZWxWaWV3VHJhbnNmb3JtMi5jcmVhdGVSZWN0YW5nbGVJbnZlcnRlZFlNYXBwaW5nKFxyXG4gICAgICAgICAgbmV3IEJvdW5kczIoIDAsIHZlcnRpY2FsUmFuZ2UubWluLCA0LCB2ZXJ0aWNhbFJhbmdlLm1heCApLFxyXG4gICAgICAgICAgbmV3IEJvdW5kczIoIDAsIDAsIHdpZHRoV2l0aE1hcmdpbiwgdGhpcy5jaGFydEhlaWdodCApXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gb25seSByZWRyYXcgaWYgdmVydGljYWwgcmFuZ2UgaGFzIGNoYW5nZWRcclxuICAgICAgICBpZiAoICFuZXdUcmFuc2Zvcm0ubWF0cml4LmVxdWFscyggZ3JpZFRyYW5zZm9ybVByb3BlcnR5LmdldCgpLm1hdHJpeCApICkge1xyXG4gICAgICAgICAgZ3JpZFRyYW5zZm9ybVByb3BlcnR5LnNldCggbmV3VHJhbnNmb3JtICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29uc3Qgdmlld1NwYW5XaWR0aCA9IGdyaWRUcmFuc2Zvcm1Qcm9wZXJ0eS5nZXQoKS5tb2RlbFRvVmlld0RlbHRhWCggdGhpcy5tYWpvclZlcnRpY2FsTGluZVNwYWNpbmcgKTtcclxuICAgIGNvbnN0IHNwYW5Ob2RlID0gbmV3IFNwYW5Ob2RlKCBzcGFuTGFiZWxOb2RlLCB2aWV3U3BhbldpZHRoLCB7XHJcbiAgICAgIGxlZnQ6IHRoaXMuY2hhcnRQYW5lbC5sZWZ0LFxyXG4gICAgICB0b3A6IHRoaXMuY2hhcnRQYW5lbC5ib3R0b20gKyAyXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gbWFrZSBzdXJlIHRoZSBob3Jpem9udGFsIGxhYmVsIGRvZXNuJ3Qgb3ZlcmxhcCB3aXRoIHRoZSBzcGFuTm9kZVxyXG4gICAgaWYgKCBvcHRpb25zLmhvcml6b250YWxBeGlzTGFiZWxOb2RlICkge1xyXG4gICAgICBpZiAoIG9wdGlvbnMuaG9yaXpvbnRhbEF4aXNMYWJlbE5vZGUubGVmdCA8IHNwYW5Ob2RlLnJpZ2h0ICsgSE9SSVpPTlRBTF9BWElTX0xBQkVMX01BUkdJTiApIHtcclxuICAgICAgICBvcHRpb25zLmhvcml6b250YWxBeGlzTGFiZWxOb2RlLmxlZnQgPSBzcGFuTm9kZS5yaWdodCArIEhPUklaT05UQUxfQVhJU19MQUJFTF9NQVJHSU47XHJcbiAgICAgICAgb3B0aW9ucy5ob3Jpem9udGFsQXhpc0xhYmVsTm9kZS5tYXhXaWR0aCA9IHRoaXMuY2hhcnRXaWR0aCAtIHNwYW5Ob2RlLndpZHRoIC0gSE9SSVpPTlRBTF9BWElTX0xBQkVMX01BUkdJTjtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYWRkQ2hpbGQoIHNwYW5Ob2RlICk7XHJcblxyXG4gICAgdGhpcy52ZXJ0aWNhbFJhbmdlUHJvcGVydHkubGluayggdmVydGljYWxSYW5nZSA9PiB7XHJcbiAgICAgIGNvbnN0IG1ham9ySG9yaXpvbnRhbExpbmVTcGFjaW5nID0gKCB2ZXJ0aWNhbFJhbmdlLmdldExlbmd0aCgpICkgLyAoIG9wdGlvbnMubnVtYmVySG9yaXpvbnRhbExpbmVzIC0gMSApO1xyXG4gICAgICBjb25zdCBtYWpvclZlcnRpY2FsTGluZVNwYWNpbmcgPSB0aGlzLmhvcml6b250YWxSYW5nZVByb3BlcnR5LmdldCgpLmdldExlbmd0aCgpIC8gKCBvcHRpb25zLm51bWJlclZlcnRpY2FsTGluZXMgLSAxICk7XHJcbiAgICAgIHRoaXMuc2V0TGluZVNwYWNpbmdzKCB7XHJcbiAgICAgICAgbWFqb3JWZXJ0aWNhbExpbmVTcGFjaW5nOiBtYWpvclZlcnRpY2FsTGluZVNwYWNpbmcsXHJcbiAgICAgICAgbWFqb3JIb3Jpem9udGFsTGluZVNwYWNpbmc6IG1ham9ySG9yaXpvbnRhbExpbmVTcGFjaW5nXHJcbiAgICAgIH0gKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZVxyXG4gICAgdGhpcy5yZXNldFNlaXNtb2dyYXBoTm9kZSA9ICgpID0+IHtcclxuICAgICAgem9vbUxldmVsSW5kZXhQcm9wZXJ0eS5yZXNldCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBAcHJpdmF0ZSAtIGNhbGxlZCBieSBkaXNwb3NlXHJcbiAgICB0aGlzLmRpc3Bvc2VTZWlzbW9ncmFwaE5vZGUgPSAoKSA9PiB7XHJcbiAgICAgIHpvb21MZXZlbEluZGV4UHJvcGVydHkudW5saW5rKCB6b29tTGlzdGVuZXIgKTtcclxuICAgICAgTXVsdGlsaW5rLnVubXVsdGlsaW5rKCBkYXRhTWFwcGluZ0xpbmsgKTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBZGRzIGEgU2Vpc21vZ3JhcGhEeW5hbWljU2VyaWVzTm9kZSB0byByZXByZXNlbnQgdGhlIER5bmFtaWNTZXJpZXMuXHJcbiAgICogQHByb3RlY3RlZFxyXG4gICAqIEBvdmVycmlkZVxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtEeW5hbWljU2VyaWVzfSBkeW5hbWljU2VyaWVzXHJcbiAgICovXHJcbiAgYWRkRHluYW1pY1NlcmllcyggZHluYW1pY1NlcmllcyApIHtcclxuICAgIGNvbnN0IGR5bmFtaWNTZXJpZXNOb2RlID0gbmV3IFNlaXNtb2dyYXBoRHluYW1pY1Nlcmllc05vZGUoXHJcbiAgICAgIGR5bmFtaWNTZXJpZXMsXHJcbiAgICAgIHRoaXMuY2hhcnRXaWR0aCAtIHRoaXMucmlnaHRNYXJnaW4sXHJcbiAgICAgIG5ldyBCb3VuZHMyKCAwLCAwLCB0aGlzLmNoYXJ0V2lkdGgsIHRoaXMuY2hhcnRIZWlnaHQgKSxcclxuICAgICAgdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm1Qcm9wZXJ0eVxyXG4gICAgKTtcclxuICAgIHRoaXMuY2hhcnRQYW5lbC5hZGRDaGlsZCggZHluYW1pY1Nlcmllc05vZGUgKTtcclxuICAgIHRoaXMuc2Nyb2xsaW5nQ2hhcnROb2RlRGlzcG9zZUVtaXR0ZXIuYWRkTGlzdGVuZXIoICgpID0+IGR5bmFtaWNTZXJpZXNOb2RlLmRpc3Bvc2UoKSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHB1YmxpYyAtIHJlc3RvcmUgaW5pdGlhbCBjb25kaXRpb25zXHJcbiAgICovXHJcbiAgcmVzZXQoKSB7XHJcbiAgICB0aGlzLnJlc2V0U2Vpc21vZ3JhcGhOb2RlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgZGlzcG9zZSgpIHtcclxuICAgIHRoaXMuZGlzcG9zZVNlaXNtb2dyYXBoTm9kZSgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZ3JpZGRsZS5yZWdpc3RlciggJ1NlaXNtb2dyYXBoTm9kZScsIFNlaXNtb2dyYXBoTm9kZSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgU2Vpc21vZ3JhcGhOb2RlOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsU0FBUyxNQUFNLDRCQUE0QjtBQUNsRCxPQUFPQyxRQUFRLE1BQU0sMkJBQTJCO0FBQ2hELE9BQU9DLE9BQU8sTUFBTSx5QkFBeUI7QUFDN0MsT0FBT0MsS0FBSyxNQUFNLHVCQUF1QjtBQUN6QyxPQUFPQyxrQkFBa0IsTUFBTSwwQ0FBMEM7QUFDekUsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxtQkFBbUIsTUFBTSxpREFBaUQ7QUFDakYsT0FBT0MsTUFBTSxNQUFNLDJCQUEyQjtBQUM5QyxPQUFP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