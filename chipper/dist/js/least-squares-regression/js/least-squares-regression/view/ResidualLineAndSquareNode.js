// Copyright 2014-2022, University of Colorado Boulder

/**
 * Type that represents a residual Line and Square in the view.
 *
 * @author John Blanco
 * @author Martin Veillette (Berea College)
 */

import { Shape } from '../../../../kite/js/imports.js';
import Poolable from '../../../../phet-core/js/Poolable.js';
import { Line, Node, Rectangle } from '../../../../scenery/js/imports.js';
import leastSquaresRegression from '../../leastSquaresRegression.js';
import LeastSquaresRegressionConstants from '../LeastSquaresRegressionConstants.js';
class ResidualLineAndSquareNode extends Node {
  /**
   * @param {Property.<Residual>} residualProperty
   * @param {Object} lineColor - Object that defines all color properties of residual, squared residuals, line, etc.
   * @param {Bounds2} viewBounds
   * @param {ModelViewTransform2} modelViewTransform
   * @param {Property.<boolean>} lineVisibilityProperty
   * @param {Property.<boolean>} squareVisibilityProperty
   */
  constructor(residualProperty, lineColor, viewBounds, modelViewTransform, lineVisibilityProperty, squareVisibilityProperty) {
    super();

    // create line and square residual with nominal values, will set the correct value later
    this.squareResidual = new Rectangle(0, 0, 1, 1);
    this.lineResidual = new Line(0, 0, 1, 1, {
      lineWidth: LeastSquaresRegressionConstants.RESIDUAL_LINE_WIDTH
    });

    // Add the square residual and line residual
    this.addChild(this.squareResidual);
    this.addChild(this.lineResidual);

    // Add listeners
    this.lineVisibilityPropertyListener = visible => {
      this.lineResidual.visible = visible;
    };
    this.squareVisibilityPropertyListener = visible => {
      this.squareResidual.visible = visible;
    };
    this.updateLineAndSquareListener = this.updateLineAndSquare.bind(this);
    this.set(residualProperty, lineColor, viewBounds, modelViewTransform, lineVisibilityProperty, squareVisibilityProperty);
  }

  /**
   * Update the Line and Square Residual
   * @public
   */
  updateLineAndSquare() {
    const point1 = this.modelViewTransform.modelToViewPosition(this.residualProperty.value.point1);
    const point2 = this.modelViewTransform.modelToViewPosition(this.residualProperty.value.point2);

    // Update line residual
    this.lineResidual.setPoint1(point1);
    this.lineResidual.setPoint2(point2);
    // the line residual should not show outside the graph.
    this.lineResidual.clipArea = Shape.bounds(this.viewBounds);

    // Update square residual
    const top = Math.min(point1.y, point2.y);
    const height = Math.abs(point1.y - point2.y);
    // we want a square
    const width = height;

    // the square residual can be on the left or on the right of point1 (the dataPoint position)
    // however the square residual should not overlap with the y = m x + b line:
    const left = this.residualProperty.value.isSquaredResidualToTheLeft ? point1.x - width : point1.x;
    this.squareResidual.setRect(left, top, width, height);
    // the squareResidual should not show outside the graph.
    this.squareResidual.clipArea = Shape.bounds(this.viewBounds);
  }

  /**
   * Was dispose, see https://github.com/phetsims/scenery/issues/601
   * @public
   */
  release() {
    // unlink listeners
    this.lineVisibilityProperty.unlink(this.lineVisibilityPropertyListener);
    this.squareVisibilityProperty.unlink(this.squareVisibilityPropertyListener);
    this.residualProperty.unlink(this.updateLineAndSquareListener);
    this.freeToPool(); // will throw ResidualLineAndSquareNode into the pool
  }

  /**
   * @public
   *
   * @param {Property.<Residual>} residualProperty
   * @param {ColorDef} lineColor
   * @param {Bounds2} viewBounds
   * @param {ModelViewTransform2} modelViewTransform
   * @param {Property.<boolean>} lineVisibilityProperty
   * @param {Property.<boolean>} squareVisibilityProperty
   * @returns {ResidualLineAndSquareNode}
   */
  set(residualProperty, lineColor, viewBounds, modelViewTransform, lineVisibilityProperty, squareVisibilityProperty) {
    this.lineVisibilityProperty = lineVisibilityProperty;
    this.squareVisibilityProperty = squareVisibilityProperty;
    this.residualProperty = residualProperty;
    this.viewBounds = viewBounds;
    this.modelViewTransform = modelViewTransform;

    // link the listeners
    this.lineVisibilityProperty.link(this.lineVisibilityPropertyListener);
    this.squareVisibilityProperty.link(this.squareVisibilityPropertyListener);
    this.residualProperty.link(this.updateLineAndSquareListener);

    // set the appropriate color for the square and line residuals
    this.squareResidual.fill = lineColor.SQUARED_RESIDUAL_COLOR;
    this.lineResidual.stroke = lineColor.RESIDUAL_COLOR;
    return this; // for chaining
  }
}

leastSquaresRegression.register('ResidualLineAndSquareNode', ResidualLineAndSquareNode);
Poolable.mixInto(ResidualLineAndSquareNode, {
  initialize: ResidualLineAndSquareNode.prototype.set
});
export default ResidualLineAndSquareNode;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaGFwZSIsIlBvb2xhYmxlIiwiTGluZSIsIk5vZGUiLCJSZWN0YW5nbGUiLCJsZWFzdFNxdWFyZXNSZWdyZXNzaW9uIiwiTGVhc3RTcXVhcmVzUmVncmVzc2lvbkNvbnN0YW50cyIsIlJlc2lkdWFsTGluZUFuZFNxdWFyZU5vZGUiLCJjb25zdHJ1Y3RvciIsInJlc2lkdWFsUHJvcGVydHkiLCJsaW5lQ29sb3IiLCJ2aWV3Qm91bmRzIiwibW9kZWxWaWV3VHJhbnNmb3JtIiwibGluZVZpc2liaWxpdHlQcm9wZXJ0eSIsInNxdWFyZVZpc2liaWxpdHlQcm9wZXJ0eSIsInNxdWFyZVJlc2lkdWFsIiwibGluZVJlc2lkdWFsIiwibGluZVdpZHRoIiwiUkVTSURVQUxfTElORV9XSURUSCIsImFkZENoaWxkIiwibGluZVZpc2liaWxpdHlQcm9wZXJ0eUxpc3RlbmVyIiwidmlzaWJsZSIsInNxdWFyZVZpc2liaWxpdHlQcm9wZXJ0eUxpc3RlbmVyIiwidXBkYXRlTGluZUFuZFNxdWFyZUxpc3RlbmVyIiwidXBkYXRlTGluZUFuZFNxdWFyZSIsImJpbmQiLCJzZXQiLCJwb2ludDEiLCJtb2RlbFRvVmlld1Bvc2l0aW9uIiwidmFsdWUiLCJwb2ludDIiLCJzZXRQb2ludDEiLCJzZXRQb2ludDIiLCJjbGlwQXJlYSIsImJvdW5kcyIsInRvcCIsIk1hdGgiLCJtaW4iLCJ5IiwiaGVpZ2h0IiwiYWJzIiwid2lkdGgiLCJsZWZ0IiwiaXNTcXVhcmVkUmVzaWR1YWxUb1RoZUxlZnQiLCJ4Iiwic2V0UmVjdCIsInJlbGVhc2UiLCJ1bmxpbmsiLCJmcmVlVG9Qb29sIiwibGluayIsImZpbGwiLCJTUVVBUkVEX1JFU0lEVUFMX0NPTE9SIiwic3Ryb2tlIiwiUkVTSURVQUxfQ09MT1IiLCJyZWdpc3RlciIsIm1peEludG8iLCJpbml0aWFsaXplIiwicHJvdG90eXBlIl0sInNvdXJjZXMiOlsiUmVzaWR1YWxMaW5lQW5kU3F1YXJlTm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNC0yMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBUeXBlIHRoYXQgcmVwcmVzZW50cyBhIHJlc2lkdWFsIExpbmUgYW5kIFNxdWFyZSBpbiB0aGUgdmlldy5cclxuICpcclxuICogQGF1dGhvciBKb2huIEJsYW5jb1xyXG4gKiBAYXV0aG9yIE1hcnRpbiBWZWlsbGV0dGUgKEJlcmVhIENvbGxlZ2UpXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgUG9vbGFibGUgZnJvbSAnLi4vLi4vLi4vLi4vcGhldC1jb3JlL2pzL1Bvb2xhYmxlLmpzJztcclxuaW1wb3J0IHsgTGluZSwgTm9kZSwgUmVjdGFuZ2xlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IGxlYXN0U3F1YXJlc1JlZ3Jlc3Npb24gZnJvbSAnLi4vLi4vbGVhc3RTcXVhcmVzUmVncmVzc2lvbi5qcyc7XHJcbmltcG9ydCBMZWFzdFNxdWFyZXNSZWdyZXNzaW9uQ29uc3RhbnRzIGZyb20gJy4uL0xlYXN0U3F1YXJlc1JlZ3Jlc3Npb25Db25zdGFudHMuanMnO1xyXG5cclxuY2xhc3MgUmVzaWR1YWxMaW5lQW5kU3F1YXJlTm9kZSBleHRlbmRzIE5vZGUge1xyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPFJlc2lkdWFsPn0gcmVzaWR1YWxQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBsaW5lQ29sb3IgLSBPYmplY3QgdGhhdCBkZWZpbmVzIGFsbCBjb2xvciBwcm9wZXJ0aWVzIG9mIHJlc2lkdWFsLCBzcXVhcmVkIHJlc2lkdWFscywgbGluZSwgZXRjLlxyXG4gICAqIEBwYXJhbSB7Qm91bmRzMn0gdmlld0JvdW5kc1xyXG4gICAqIEBwYXJhbSB7TW9kZWxWaWV3VHJhbnNmb3JtMn0gbW9kZWxWaWV3VHJhbnNmb3JtXHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48Ym9vbGVhbj59IGxpbmVWaXNpYmlsaXR5UHJvcGVydHlcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5Ljxib29sZWFuPn0gc3F1YXJlVmlzaWJpbGl0eVByb3BlcnR5XHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHJlc2lkdWFsUHJvcGVydHksIGxpbmVDb2xvciwgdmlld0JvdW5kcywgbW9kZWxWaWV3VHJhbnNmb3JtLCBsaW5lVmlzaWJpbGl0eVByb3BlcnR5LCBzcXVhcmVWaXNpYmlsaXR5UHJvcGVydHkgKSB7XHJcbiAgICBzdXBlcigpO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBsaW5lIGFuZCBzcXVhcmUgcmVzaWR1YWwgd2l0aCBub21pbmFsIHZhbHVlcywgd2lsbCBzZXQgdGhlIGNvcnJlY3QgdmFsdWUgbGF0ZXJcclxuICAgIHRoaXMuc3F1YXJlUmVzaWR1YWwgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCAxLCAxICk7XHJcbiAgICB0aGlzLmxpbmVSZXNpZHVhbCA9IG5ldyBMaW5lKCAwLCAwLCAxLCAxLCB7XHJcbiAgICAgIGxpbmVXaWR0aDogTGVhc3RTcXVhcmVzUmVncmVzc2lvbkNvbnN0YW50cy5SRVNJRFVBTF9MSU5FX1dJRFRIXHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBzcXVhcmUgcmVzaWR1YWwgYW5kIGxpbmUgcmVzaWR1YWxcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMuc3F1YXJlUmVzaWR1YWwgKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRoaXMubGluZVJlc2lkdWFsICk7XHJcblxyXG4gICAgLy8gQWRkIGxpc3RlbmVyc1xyXG4gICAgdGhpcy5saW5lVmlzaWJpbGl0eVByb3BlcnR5TGlzdGVuZXIgPSB2aXNpYmxlID0+IHtcclxuICAgICAgdGhpcy5saW5lUmVzaWR1YWwudmlzaWJsZSA9IHZpc2libGU7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuc3F1YXJlVmlzaWJpbGl0eVByb3BlcnR5TGlzdGVuZXIgPSB2aXNpYmxlID0+IHtcclxuICAgICAgdGhpcy5zcXVhcmVSZXNpZHVhbC52aXNpYmxlID0gdmlzaWJsZTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy51cGRhdGVMaW5lQW5kU3F1YXJlTGlzdGVuZXIgPSB0aGlzLnVwZGF0ZUxpbmVBbmRTcXVhcmUuYmluZCggdGhpcyApO1xyXG5cclxuICAgIHRoaXMuc2V0KCByZXNpZHVhbFByb3BlcnR5LCBsaW5lQ29sb3IsIHZpZXdCb3VuZHMsIG1vZGVsVmlld1RyYW5zZm9ybSwgbGluZVZpc2liaWxpdHlQcm9wZXJ0eSwgc3F1YXJlVmlzaWJpbGl0eVByb3BlcnR5ICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgdGhlIExpbmUgYW5kIFNxdWFyZSBSZXNpZHVhbFxyXG4gICAqIEBwdWJsaWNcclxuICAgKi9cclxuICB1cGRhdGVMaW5lQW5kU3F1YXJlKCkge1xyXG4gICAgY29uc3QgcG9pbnQxID0gdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdQb3NpdGlvbiggdGhpcy5yZXNpZHVhbFByb3BlcnR5LnZhbHVlLnBvaW50MSApO1xyXG4gICAgY29uc3QgcG9pbnQyID0gdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0ubW9kZWxUb1ZpZXdQb3NpdGlvbiggdGhpcy5yZXNpZHVhbFByb3BlcnR5LnZhbHVlLnBvaW50MiApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSBsaW5lIHJlc2lkdWFsXHJcbiAgICB0aGlzLmxpbmVSZXNpZHVhbC5zZXRQb2ludDEoIHBvaW50MSApO1xyXG4gICAgdGhpcy5saW5lUmVzaWR1YWwuc2V0UG9pbnQyKCBwb2ludDIgKTtcclxuICAgIC8vIHRoZSBsaW5lIHJlc2lkdWFsIHNob3VsZCBub3Qgc2hvdyBvdXRzaWRlIHRoZSBncmFwaC5cclxuICAgIHRoaXMubGluZVJlc2lkdWFsLmNsaXBBcmVhID0gU2hhcGUuYm91bmRzKCB0aGlzLnZpZXdCb3VuZHMgKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgc3F1YXJlIHJlc2lkdWFsXHJcbiAgICBjb25zdCB0b3AgPSBNYXRoLm1pbiggcG9pbnQxLnksIHBvaW50Mi55ICk7XHJcbiAgICBjb25zdCBoZWlnaHQgPSBNYXRoLmFicyggcG9pbnQxLnkgLSBwb2ludDIueSApO1xyXG4gICAgLy8gd2Ugd2FudCBhIHNxdWFyZVxyXG4gICAgY29uc3Qgd2lkdGggPSBoZWlnaHQ7XHJcblxyXG4gICAgLy8gdGhlIHNxdWFyZSByZXNpZHVhbCBjYW4gYmUgb24gdGhlIGxlZnQgb3Igb24gdGhlIHJpZ2h0IG9mIHBvaW50MSAodGhlIGRhdGFQb2ludCBwb3NpdGlvbilcclxuICAgIC8vIGhvd2V2ZXIgdGhlIHNxdWFyZSByZXNpZHVhbCBzaG91bGQgbm90IG92ZXJsYXAgd2l0aCB0aGUgeSA9IG0geCArIGIgbGluZTpcclxuICAgIGNvbnN0IGxlZnQgPSAoIHRoaXMucmVzaWR1YWxQcm9wZXJ0eS52YWx1ZS5pc1NxdWFyZWRSZXNpZHVhbFRvVGhlTGVmdCApID8gcG9pbnQxLnggLSB3aWR0aCA6IHBvaW50MS54O1xyXG5cclxuICAgIHRoaXMuc3F1YXJlUmVzaWR1YWwuc2V0UmVjdCggbGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0ICk7XHJcbiAgICAvLyB0aGUgc3F1YXJlUmVzaWR1YWwgc2hvdWxkIG5vdCBzaG93IG91dHNpZGUgdGhlIGdyYXBoLlxyXG4gICAgdGhpcy5zcXVhcmVSZXNpZHVhbC5jbGlwQXJlYSA9IFNoYXBlLmJvdW5kcyggdGhpcy52aWV3Qm91bmRzICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXYXMgZGlzcG9zZSwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zY2VuZXJ5L2lzc3Vlcy82MDFcclxuICAgKiBAcHVibGljXHJcbiAgICovXHJcbiAgcmVsZWFzZSgpIHtcclxuICAgIC8vIHVubGluayBsaXN0ZW5lcnNcclxuICAgIHRoaXMubGluZVZpc2liaWxpdHlQcm9wZXJ0eS51bmxpbmsoIHRoaXMubGluZVZpc2liaWxpdHlQcm9wZXJ0eUxpc3RlbmVyICk7XHJcbiAgICB0aGlzLnNxdWFyZVZpc2liaWxpdHlQcm9wZXJ0eS51bmxpbmsoIHRoaXMuc3F1YXJlVmlzaWJpbGl0eVByb3BlcnR5TGlzdGVuZXIgKTtcclxuICAgIHRoaXMucmVzaWR1YWxQcm9wZXJ0eS51bmxpbmsoIHRoaXMudXBkYXRlTGluZUFuZFNxdWFyZUxpc3RlbmVyICk7XHJcblxyXG4gICAgdGhpcy5mcmVlVG9Qb29sKCk7IC8vIHdpbGwgdGhyb3cgUmVzaWR1YWxMaW5lQW5kU3F1YXJlTm9kZSBpbnRvIHRoZSBwb29sXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcHVibGljXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge1Byb3BlcnR5LjxSZXNpZHVhbD59IHJlc2lkdWFsUHJvcGVydHlcclxuICAgKiBAcGFyYW0ge0NvbG9yRGVmfSBsaW5lQ29sb3JcclxuICAgKiBAcGFyYW0ge0JvdW5kczJ9IHZpZXdCb3VuZHNcclxuICAgKiBAcGFyYW0ge01vZGVsVmlld1RyYW5zZm9ybTJ9IG1vZGVsVmlld1RyYW5zZm9ybVxyXG4gICAqIEBwYXJhbSB7UHJvcGVydHkuPGJvb2xlYW4+fSBsaW5lVmlzaWJpbGl0eVByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtQcm9wZXJ0eS48Ym9vbGVhbj59IHNxdWFyZVZpc2liaWxpdHlQcm9wZXJ0eVxyXG4gICAqIEByZXR1cm5zIHtSZXNpZHVhbExpbmVBbmRTcXVhcmVOb2RlfVxyXG4gICAqL1xyXG4gIHNldCggcmVzaWR1YWxQcm9wZXJ0eSwgbGluZUNvbG9yLCB2aWV3Qm91bmRzLCBtb2RlbFZpZXdUcmFuc2Zvcm0sIGxpbmVWaXNpYmlsaXR5UHJvcGVydHksIHNxdWFyZVZpc2liaWxpdHlQcm9wZXJ0eSApIHtcclxuICAgIHRoaXMubGluZVZpc2liaWxpdHlQcm9wZXJ0eSA9IGxpbmVWaXNpYmlsaXR5UHJvcGVydHk7XHJcbiAgICB0aGlzLnNxdWFyZVZpc2liaWxpdHlQcm9wZXJ0eSA9IHNxdWFyZVZpc2liaWxpdHlQcm9wZXJ0eTtcclxuICAgIHRoaXMucmVzaWR1YWxQcm9wZXJ0eSA9IHJlc2lkdWFsUHJvcGVydHk7XHJcbiAgICB0aGlzLnZpZXdCb3VuZHMgPSB2aWV3Qm91bmRzO1xyXG4gICAgdGhpcy5tb2RlbFZpZXdUcmFuc2Zvcm0gPSBtb2RlbFZpZXdUcmFuc2Zvcm07XHJcblxyXG4gICAgLy8gbGluayB0aGUgbGlzdGVuZXJzXHJcbiAgICB0aGlzLmxpbmVWaXNpYmlsaXR5UHJvcGVydHkubGluayggdGhpcy5saW5lVmlzaWJpbGl0eVByb3BlcnR5TGlzdGVuZXIgKTtcclxuICAgIHRoaXMuc3F1YXJlVmlzaWJpbGl0eVByb3BlcnR5LmxpbmsoIHRoaXMuc3F1YXJlVmlzaWJpbGl0eVByb3BlcnR5TGlzdGVuZXIgKTtcclxuICAgIHRoaXMucmVzaWR1YWxQcm9wZXJ0eS5saW5rKCB0aGlzLnVwZGF0ZUxpbmVBbmRTcXVhcmVMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIHNldCB0aGUgYXBwcm9wcmlhdGUgY29sb3IgZm9yIHRoZSBzcXVhcmUgYW5kIGxpbmUgcmVzaWR1YWxzXHJcbiAgICB0aGlzLnNxdWFyZVJlc2lkdWFsLmZpbGwgPSBsaW5lQ29sb3IuU1FVQVJFRF9SRVNJRFVBTF9DT0xPUjtcclxuICAgIHRoaXMubGluZVJlc2lkdWFsLnN0cm9rZSA9IGxpbmVDb2xvci5SRVNJRFVBTF9DT0xPUjtcclxuXHJcbiAgICByZXR1cm4gdGhpczsgLy8gZm9yIGNoYWluaW5nXHJcbiAgfVxyXG59XHJcblxyXG5sZWFzdFNxdWFyZXNSZWdyZXNzaW9uLnJlZ2lzdGVyKCAnUmVzaWR1YWxMaW5lQW5kU3F1YXJlTm9kZScsIFJlc2lkdWFsTGluZUFuZFNxdWFyZU5vZGUgKTtcclxuXHJcblBvb2xhYmxlLm1peEludG8oIFJlc2lkdWFsTGluZUFuZFNxdWFyZU5vZGUsIHtcclxuICBpbml0aWFsaXplOiBSZXNpZHVhbExpbmVBbmRTcXVhcmVOb2RlLnByb3RvdHlwZS5zZXRcclxufSApO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgUmVzaWR1YWxMaW5lQW5kU3F1YXJlTm9kZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTQSxLQUFLLFFBQVEsZ0NBQWdDO0FBQ3RELE9BQU9DLFFBQVEsTUFBTSxzQ0FBc0M7QUFDM0QsU0FBU0MsSUFBSSxFQUFFQyxJQUFJLEVBQUVDLFNBQVMsUUFBUSxtQ0FBbUM7QUFDekUsT0FBT0Msc0JBQXNCLE1BQU0saUNBQWlDO0FBQ3BFLE9BQU9DLCtCQUErQixNQUFNLHVDQUF1QztBQUVuRixNQUFNQyx5QkFBeUIsU0FBU0osSUFBSSxDQUFDO0VBQzNDO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDRUssV0FBV0EsQ0FBRUMsZ0JBQWdCLEVBQUVDLFNBQVMsRUFBRUMsVUFBVSxFQUFFQyxrQkFBa0IsRUFBRUMsc0JBQXNCLEVBQUVDLHdCQUF3QixFQUFHO0lBQzNILEtBQUssQ0FBQyxDQUFDOztJQUVQO0lBQ0EsSUFBSSxDQUFDQyxjQUFjLEdBQUcsSUFBSVgsU0FBUyxDQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUUsQ0FBQztJQUNqRCxJQUFJLENBQUNZLFlBQVksR0FBRyxJQUFJZCxJQUFJLENBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFO01BQ3hDZSxTQUFTLEVBQUVYLCtCQUErQixDQUFDWTtJQUM3QyxDQUFFLENBQUM7O0lBRUg7SUFDQSxJQUFJLENBQUNDLFFBQVEsQ0FBRSxJQUFJLENBQUNKLGNBQWUsQ0FBQztJQUNwQyxJQUFJLENBQUNJLFFBQVEsQ0FBRSxJQUFJLENBQUNILFlBQWEsQ0FBQzs7SUFFbEM7SUFDQSxJQUFJLENBQUNJLDhCQUE4QixHQUFHQyxPQUFPLElBQUk7TUFDL0MsSUFBSSxDQUFDTCxZQUFZLENBQUNLLE9BQU8sR0FBR0EsT0FBTztJQUNyQyxDQUFDO0lBRUQsSUFBSSxD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